<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Quick steps to display data in PivotViewer and Silverlight</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A PivotViewer control has recently been released from the Microsoft LiveLabs team. It is a Silverlight control that allows you to visualize informatio...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Quick steps to display data in PivotViewer and Silverlight</h1><div class="post__text post__text-html js-mediator-article"><img align="left" vspace="10" hspace="15" src="http://www.getpivot.com/images/logo-pivot.png"><br>  A <a rel="nofollow" href="http://silverlight.net/learn/pivotviewer/">PivotViewer</a> control has recently been released from the Microsoft LiveLabs team.  It is a <a rel="nofollow" href="http://www.silverlight.net/">Silverlight</a> control that allows you to visualize information using DeepZoom technology.  If you have not yet seen how it works, I advise you to go to <a rel="nofollow" href="http://silverlight.net/learn/pivotviewer/">the PivotViewer study department.</a> <br><br>  Last week I received a letter asking me to show a simpler ‚Äúhow to‚Äù example using this tool.  In the end, this is a Silverlight control and it requires a specific implementation.  And I thought to write down in my notes the creation of the simplest form of data and display using PivotViewer.  I say ‚Äúsimple‚Äù because you can get a much more complicated option, but I still want to just show the quick implementation steps. <br><br>  First, remember that the Pivot collections are a combination of image and metadata that describe the image.  If you visited the site of the <a rel="nofollow" href="http://memorabilia.hardrock.com/">Hard Rock Memorabilia</a> , then this is a simple concept implemented earlier in Silverlight. <br><a name="habracut"></a><br><h3>  Step 1 - Get a PivotViewer </h3><br>  I assume that you <em>already have Visual Studio 2010 and Silverlight 4 Tools.</em>  You can download the PivotViewer SDK in <a rel="nofollow" href="http://silverlight.net/learn/pivotviewer">the PivotViewer training section of</a> the Silverlight community site.  After running the installer, the installation will be done at% ProgramFiles% \ Microsoft SDKs \ Silverlight \ v4.0 \ PivotViewer \ &lt;RELEASE&gt;.  In the presence of a folder with examples of source codes, you can freely read them, but most likely you will not need your own actions and other features.  My steps below are ‚ÄúPivotViewer 101‚Äù for getting simple collections. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  Step 2 - Get a Pivot Collection Tool </h3><br>  In order to use the control, you must have a data source for the Pivot collection.  This is a specific XML data format that PivotViewer understands and is a full-fledged Pivot client.  XML schema documentation can be found here - <a rel="nofollow" href="http://www.silverlight.net/learn/pivotviewer/collection-xml-schema/">PivotViewer Collection XML Schema</a> .  As you can see, it is very simple.  You can make it completely with your hands, but why, if there are several tools that will help you! <br><br>  There are 3 ways to create a source for a collection: command line, code library, and Excel.  The first two are common in the case of a dynamic source.  These are several options in the form of code for various types of sources, adding metadata and creating dynamic ones on the fly or using JIT collections. <br><br>  The latter, Excel, is the simplest.  The LiveLabs team created a simple add-on to create a collection of data using a familiar interface, without requiring explicitly digging into the collection's schema.  Once you install it, you will have a new tab in Excel: <br><br><img title="Excel PivotViewer collection tool" alt="Excel PivotViewer collection tool" src="https://habrastorage.org/getpro/habr/post_images/b95/690/97a/b9569097a3398c712b99c503a1a77eb2.png"><br><br>  When you click on the <em>New Collection</em> button <em>,</em> you will get a simple table to start building your own data source for the collection. <br><br><h3>  Step 3 - Starting to create data for the collection </h3><br>  For my example, I am going to use the Bing wallpaper, from the latest Windows 7 theme ‚ÄúBing's Best‚Äù.  I already have Excel open and I clicked on New Collection.  Now I can use the <em>Import Images</em> feature to load a bunch of images.  But I will not do that.  I will add pictures selectively using <em>Choose Image.</em> <br><br>  Next, I want to spread everything in different columns so that the user can filter by category.  I used the <em>Inset Column</em> function, and passed it the Category header.  These columns were transformed into Facets and, according to the <a rel="nofollow" href="http://www.silverlight.net/learn/pivotviewer/collection-xml-schema/">diagram of the definition scheme,</a> they are visually transformed in the control element - filters. <br><br><img title="Building collection data" alt="Building collection data" src="https://habrastorage.org/getpro/habr/post_images/68d/c61/dbd/68dc61dbd0417acdb229de39b5b6962c.png"><br><br>  Add data until you are sure that the table displays everything you need.  I added just one column, but you can do more.  So, I completed the filling and now I‚Äôll select <em>Publish</em> to publish the collection. <br><br>  The result of the publication will be a CXML file and a folder with your images sliced ‚Äã‚Äãfor DeepZoom.  Remember the location of your data. <br><br><h3>  Step 4 - Create a Silverlight application with the implementation of PivotViewer </h3><br>  Considering that you have an SDK installed, run a new Silverlight project in Visual Studio.  After doing the simple steps: <br><br>  Add a link to <em>Systen.Windows.Pivot,</em> since <em>PivotViewer</em> is in this library. <br><br>  In MainPage.xaml, add XMLNS declarations for the namespace and control implementation: <br><blockquote><code><font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">UserControl</font> <font color="#ff0000">x:Class</font> <font color="#0000ff">="SilverlightApplication164.MainPage"</font> <br> <font color="#ff0000">xmlns</font> <font color="#0000ff">="http://schemas.microsoft.com/winfx/2006/xaml/presentation"</font> <br> <font color="#ff0000">xmlns:x</font> <font color="#0000ff">="http://schemas.microsoft.com/winfx/2006/xaml"</font> <br> <font color="#ff0000">xmlns:d</font> <font color="#0000ff">="http://schemas.microsoft.com/expression/blend/2008"</font> <br> <font color="#ff0000">xmlns:mc</font> <font color="#0000ff">="http://schemas.openxmlformats.org/markup-compatibility/2006"</font> <br> <font color="#ff0000">xmlns:pivot</font> <font color="#0000ff">="clr-namespace:System.Windows.Pivot;assembly=System.Windows.Pivot"</font> <br> <font color="#ff0000">mc:Ignorable</font> <font color="#0000ff">="d"</font> <br> <font color="#ff0000">d:DesignHeight</font> <font color="#0000ff">="300"</font> <font color="#ff0000">d:DesignWidth</font> <font color="#0000ff">="400"</font> <font color="#0000ff">&gt;</font> <br> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Grid</font> <font color="#ff0000">x:Name</font> <font color="#0000ff">="LayoutRoot"</font> <font color="#ff0000">Background</font> <font color="#0000ff">="White"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">pivot:PivotViewer</font> <font color="#ff0000">x:Name</font> <font color="#0000ff">="MainPivotViewer"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Grid</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">UserControl</font> <font color="#0000ff">&gt;</font></font></code> </blockquote> <br>  This is all that needs to be done by the user interface. <br><br>  The next task I want to do is to make the viewer dynamic.  I want the same XAP to use my data collection.  In my MainPage.xaml.cs file, in the Loaded event, I use the PivotViewer API and call the LoadCollection () function: <br><blockquote> <code><font color="black"><font color="#0000ff">public</font> MainPage() <br> { <br> InitializeComponent(); <br> Loaded += <font color="#0000ff">new</font> RoutedEventHandler(MainPage_Loaded); <br> } <br> <font color="#0000ff">void</font> MainPage_Loaded( <font color="#0000ff">object</font> sender, RoutedEventArgs e) <br> { <br> <font color="#0000ff">string</font> collection = App.Current.Host.InitParams[ <font color="#A31515">"collection"</font> ].ToString(); <br> MainPivotViewer.LoadCollection(collection, <font color="#0000ff">string</font> .Empty); <br> }</font></code> </blockquote> <br>  You probably noticed that I get the value from the Silverligt InitParams model.  This allows me to dynamically send collection URLs to an HTML page: <br><blockquote> <code><font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">object</font> <font color="#ff0000">data</font> <font color="#0000ff">="data:application/x-silverlight-2,"</font> <font color="#ff0000">type</font> <font color="#0000ff">="application/x-silverlight-2"</font> <font color="#ff0000">width</font> <font color="#0000ff">="100%"</font> <font color="#ff0000">height</font> <font color="#0000ff">="100%"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">param</font> <font color="#ff0000">name</font> <font color="#0000ff">="source"</font> <font color="#ff0000">value</font> <font color="#0000ff">="ClientBin/SilverlightApplication164.xap"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">param</font> <font color="#ff0000">name</font> <font color="#0000ff">="onError"</font> <font color="#ff0000">value</font> <font color="#0000ff">="onSilverlightError"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">param</font> <font color="#ff0000">name</font> <font color="#0000ff">="background"</font> <font color="#ff0000">value</font> <font color="#0000ff">="white"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">param</font> <font color="#ff0000">name</font> <font color="#0000ff">="minRuntimeVersion"</font> <font color="#ff0000">value</font> <font color="#0000ff">="4.0.50424.0"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">param</font> <font color="#ff0000">name</font> <font color="#0000ff">="autoUpgrade"</font> <font color="#ff0000">value</font> <font color="#0000ff">="true"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">param</font> <font color="#ff0000">name</font> <font color="#0000ff">="initParams"</font> <font color="#ff0000">value</font> <font color="#0000ff">="collection=URL_TO_CXML"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">a</font> <font color="#ff0000">href</font> <font color="#0000ff">="http://go.microsoft.com/fwlink/?LinkID=149156&amp;v=4.0.50424.0"</font> <font color="#ff0000">rel</font> <font color="#0000ff">="nofollow"</font> <font color="#ff0000">style</font> <font color="#0000ff">="text-decoration: none"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">img</font> <font color="#ff0000">src</font> <font color="#0000ff">="http://go.microsoft.com/fwlink/?LinkId=161376"</font> <font color="#ff0000">__bxsrc</font> <font color="#0000ff">="http://go.microsoft.com/fwlink/?LinkId=161376"</font> <font color="#ff0000">alt</font> <font color="#0000ff">="Get Microsoft Silverlight"</font> <font color="#ff0000">border</font> <font color="#0000ff">="0"</font> <font color="#ff0000">style</font> <font color="#0000ff">="border-style: none"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">a</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">object</font> <font color="#0000ff">&gt;</font></font></code> </blockquote> <br>  So I can reuse XAP in different places and only change the value of initParams in the &lt;object&gt; tag.  I ended up with XAP and now I can post it anywhere. <br><br><h3>  Step 5 - Publish the result </h3><br>  The final step is publishing.  Remember the CXML file and image folder?  They should be located somewhere.  And here are two very important points: <br><ul><li>  If the CXMK file and images are not located next to the XAP file, then cross-domain security policies (clientaccesspolicy.xml) should be specified.  Otherwise, nothing will work.  PivotViewer makes a network request and this policy is needed by Silverlight for cross-domain situations. </li><li>  You may have to add a MIME type binding on your server to run CXML files.  I had to (on Windows 2003).  I just added a MIME type binding for .cxml and set the <em>text / xml</em> content type <em>,</em> it worked. </li></ul><br><br>  As soon as I have done all the necessary actions, I can proceed to placing the XAP on the HTML page and targeting to work with my data collection.  As an example, admire the result - <a rel="nofollow" href="http://timheuer.com/silverlight/bingbest">Bing's Best Pivot Collection</a> .  Notice how the Category column is displayed as a filter on the left.  Would do more columns, see more filters.  I could also add more metadata and set the HREF parameter to refer to certain data. <br><br>  You can find more examples of schemas on the <a rel="nofollow" href="http://www.getpivot.com/developer-info/">GetPivot</a> site: <br><ul><li>  <a rel="nofollow" href="">http://content.getpivot.com/Collections/dogbreeds/dogbreeds.cxml</a> </li><li>  <a rel="nofollow" href="">http://content.getpivot.com/Collections/sportsillustrated/sportsillustrated.cxml</a> </li><li>  <a rel="nofollow" href="">http://content.getpivot.com/Collections/2009nflteams/2009nflteams.cxml</a> </li></ul>  Using my project, I can simply enter the URL in initParams to change the collection to which I want.  I can also use the <a rel="nofollow" href="http://www.liveside.net/main/archive/2009/11/29/creating-the-microsoft-executive-pivot-we-play-and-you-can-too.aspx">Microsoft Organization Pivot Collection</a> , which I created LiveSide, without changing anything: <a rel="nofollow" href="http://timheuer.com/silverlight/msorgpivot/">MSFT Organization Pivot in Silverlight</a> . <br><br><h3>  Summarize </h3><br>  Spending just a few minutes on the control, you get the simplest scenario of displaying data.  In fact, the creation of a data source for a collection is the most difficult, to determine all the metadata, etc‚Ä¶. <br><br>  You can download my example from here - <a rel="nofollow" href="">PivotViewerSimpleSample.zip</a> </div><p>Source: <a href="https://habr.com/ru/post/99174/">https://habr.com/ru/post/99174/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../99165/index.html">Cement for castles in the ‚Äúclouds‚Äù: how we learned to sell SaaS</a></li>
<li><a href="../99167/index.html">Competition "System Administrator - 2010"</a></li>
<li><a href="../99168/index.html">Copper Wire Braided Characters</a></li>
<li><a href="../99169/index.html">A small story about the study of a single botnet</a></li>
<li><a href="../99170/index.html">Apple iOS 4.1 beta 1</a></li>
<li><a href="../99178/index.html">What do I miss in Yandex.Direct?</a></li>
<li><a href="../99179/index.html">Video glasses from "Masterkita"</a></li>
<li><a href="../99182/index.html">Writing a desktop widget under Maemo5 on Qt. Part two and final</a></li>
<li><a href="../99183/index.html">@earlybird - The Bird of Twitter Ad Campaigns</a></li>
<li><a href="../99186/index.html">We are writing a technical book</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>