<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Modification of games on the example of Arcanoid</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day! 

 Introduction 
 For some time I watched the Assembler blog on Habr√© due to the fact that more than excellent articles on the analysis of v...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Modification of games on the example of Arcanoid</h1><div class="post__text post__text-html js-mediator-article">  Good day! <br><br><h4>  Introduction </h4><br>  For some time I watched the <a href="http://habrahabr.ru/blogs/asm/">Assembler</a> blog on Habr√© due to the fact that more than excellent articles on the analysis of various keygens and "reverse engineering" began to appear there.  I have long wanted to do something similar and modify some game on J2ME.  I have been wandering around the Internet for a long time in search of a good, but at the same time easy to understand (in terms of analysis) game.  Once, I was digging on the site of my friend programmer (by the way, he also writes programs for J2ME. Who used <b>ProPaintMobile</b> - he knows who I am talking about. And I found it - it was a simple Arkanoid. Apparently, it was someone's homework , or it was written simply ‚Äújust for fun‚Äù, but nevertheless this game turned out to be exactly what it needs. <br><a name="habracut"></a><br><br><h4>  What we need </h4><br>  In order to make a modification, we need the following components: <br><ol><li>  A decompiler that would give us the source code to make it easier to navigate in the process of changing the bytecode.  Personally, I use <b>Java Decompiler</b> for this purpose, which you can download <a href="">here</a> ; </li><li>  The disassembler of the virtual machine bytecode, which will be issued to us by this same byte code - <b>JavaByte</b> , which can be downloaded <a href="">here</a> ; </li><li>  Experiment itself - <a href=""><b>Arcanoid</b></a> ; </li><li>  Well, it would also be nice to get acquainted with the specification, which sets out the instructions of the virtual machine, which you can read <a href="http://java.sun.com/docs/books/jvms/second_edition/html/VMSpecTOC.doc.html">here</a> . </li></ol><br>  Perhaps everything.  In fact, the choice of software is an individual matter, and, I would say intimate.  Therefore, you can easily use, for example, <b>Jasmin</b> instead of <b>Java Decompiler</b> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  What do we do now </h4><br><h5>  Step one </h5><br>  First we need to open the <s>enemy machine</s> this very game and see what can be modified there.  Since we do not have the original jar file, but there are converted classes and MANIFEST.MF, then let's pack our game.  No sooner said than done. <br><br><img src="https://habrastorage.org/storage2/2f7/7ff/4e1/2f77ff4e127c7245082ab3171894d3e8.png"><br>  The structure of our archive should look exactly as indicated above.  It remains only to redo the extension - from <i>zip</i> to <i>jar</i> and ... <br><br><h5>  Step Two </h5><br>  And run our game.  Let's play a little bit. <br><br><img src="https://habrastorage.org/storage2/6f6/298/4d3/6f62984d318b31d503f7ff8f07eeb900.png"><br>  We continue to play ... <br><br><img src="https://habrastorage.org/storage2/aa7/e75/5d7/aa7e755d76b879d6c43d0e49948de367.png"><br>  Oops.  Okay, two more lives left.  We play on. <br><br><img src="https://habrastorage.org/storage2/ff8/83a/2c0/ff883a2c0d8f8323985e102b11ee84eb.png"><br>  Everything, finished badly.  We must do something about it. <br><br><h5>  Step Three </h5><br>  We do something with it, namely we decompile.  No problems.  We rummage in source codes and we understand that the most interesting is stored in the <b>GCanvas.java</b> file.  Let's take a closer look at what's what: <br><br><img src="https://habrastorage.org/storage2/e13/4ca/dc7/e134cadc702fddbbcabb48ed232ed1d7.png"><br><br>  Here we see the constructor, variables and methods. <br><br>  It is worth recalling that we are looking for with you where our lives are diminished.  Let's look for <i>live</i> or <i>lives</i> .  Here we are lucky.  Since the game is not obfuscated, we see with you variables and methods with more or less real names.  And here our vzgyad immediately rushes to such a line at the very beginning of the source file: <br><br><pre><code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> m_m_LivesII;</code> </pre> <br><br>  Comments are superfluous.  This is the counter of our lives.  It remains only to find where this variable decreases.  And here, as the decompiler points out, this is line 170: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.m_m_LivesII -= <span class="hljs-number"><span class="hljs-number">1</span></span>;</code> </pre><br><br>  Let's examine this section of code: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.m_m_goGameZZ) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.m_m_playGameZZ) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.m_m_boomZZ) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.m_m_ballcBallcBall.setVisible(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); _AnimateBoomcGraphicsV(g); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.platform.setVisible(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.m_m_LivesII -= <span class="hljs-number"><span class="hljs-number">1</span></span>;</code> </pre><br><br>  Here, we can say, we are given a complete instruction: if the variable <b>m_m_goGameZZ</b> , which is Boolean, is <i>true</i> , then the game is on.  When a collision is also a Boolean variable named <b>m_m_playGameZZ,</b> it becomes <i>false</i> , then the platform explosion is animated ( <b>_AnimateBoomGraphics</b> ), then the platform becomes invisible ( <b>platform.setVisible (false)</b> ) and then life is taken away from us, which you can see in the code which is above.  Of course, the first thing that comes to mind is instead of subtracting one from the <b>m_m_LivesII</b> variable, you need to modify the code to add it.  But it is not for Feng Shui somehow.  Then we simply equate the variable to one.  And recompile?  It needs to be recompiled, converted classes, and then re-assemble everything into the archive.  No, I'm lazy.  But there is a way to just fix the byte code of the class and then we will not need to perform the first two steps.  Moving on ... <br><br><h5>  What is our step?  Oh yes fourth </h5><br>  In order to edit the byte code we have <b>JavaBite</b> .  What we use it. <br>  Open our class ( <b>Classes</b> -&gt; <b>Add Java Class</b> and see the following picture: <br><br><img src="https://habrastorage.org/storage2/c86/b60/879/c86b60879193c89417198d41d379b403.png"><br><br>  I hope you remember where the piece of code that interests you is located?  Exactly, this is the <b>run</b> method.  Let's look at it: <br><br><img src="https://habrastorage.org/storage2/280/d76/ead/280d76eaddd118e05c03d97bb22aced1.png"><br><br>  Let's run through the instructions from the start.  Stop!  Nothing like? <br><br><img src="https://habrastorage.org/storage2/ade/4bf/f8d/ade4bff8defb1961a790407cd6a60343.png"><br><br>  Yes, this is exactly what we need.  Through the instruction down you will notice the <b>isub</b> instruction - this is it! <br>  Generally speaking, in Russian, this instruction means that we are subtracting something from the <i>m_m_LivesII</i> variable.  We need this variable to always be equal to one.  This is very easy to achieve.  Let's change the <b>isub</b> instruction to <b>nop</b> .  Click the right mouse button and select <i>Edit Instructions</i> .  Here even screenshots are not necessary.  As a result, the instructions will look like this: <br><br><img src="https://habrastorage.org/storage2/b97/c5f/06d/b97c5f06dc099e716f1ec71fa9e31fde.png"><br><br>  Let's leave our already non-original class with the replacement of the old one and try to open our game, but instead of playing it, we will get the following error message: <br><br><img src="https://habrastorage.org/storage2/aec/394/5a0/aec3945a01ad12a1525d75ab638f96f4.png"><br><br><h5>  Debriefing </h5><br>  From this message, we can understand with you that the class contains an error.  Yes, cap! <br>  But which one?  The thing is that <b>nop</b> in this case will cause an imbalance in the <s>stomach of the</s> stack and, in order for us to solve the problem, we also need to <b>nop</b> for <b>instruction</b> and <b>iconst_1</b> .  Why?  This I will leave you as a homework.  This instruction is at <s>arm's length</s> immediately after our <b>nop</b> .  By the way, here it is: <br><br><img src="https://habrastorage.org/storage2/27b/c1b/1c2/27bc1b1c2f429a302b8e3514883834db.png"><br><br>  Actually, we are doing what we should have done with it <s>yesterday</s> .  Voila! <br><br><img src="https://habrastorage.org/storage2/29c/216/954/29c216954ae443187d495c5a358e5dfa.png"><br><br>  Now we will rebuild our game.  Finally, let's play it. <br><br><img src="https://habrastorage.org/storage2/a93/542/e8b/a93542e8bed5e6223483f174cc1dd1af.png"><br><img src="https://habrastorage.org/storage2/d81/ba1/2df/d81ba12dfdd76941332bf619f4b21860.png"><br><br>  Now, when we miss our ball beyond the platform, we will always see: <br><br><img src="https://habrastorage.org/storage2/2bc/380/46d/2bc38046d9c4a1e33d5a4df5601da44d.png"><br><br>  <s>We are not afraid of the gray wolf.</s>  Now you can safely play the game before losing the pulse (although it will bore you after a minute, because there are only two levels) and not be afraid of death! <br><br><h4>  Conclusion </h4><br>  In fact, I was doing this experience a long time ago when I was a newbie and was just getting used to all these instructions.  Once for me they, and the assembler itself, was a terrible dream.  However, time passes ‚Äî views change, we change.  I hope that this lesson was useful for you. <br><br>  See you soon! <br><br>  <b>PS</b> When conducting this experience, no Arkanoid was hurt! </div><p>Source: <a href="https://habr.com/ru/post/135967/">https://habr.com/ru/post/135967/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../135961/index.html">IPv6 support</a></li>
<li><a href="../135962/index.html">Calendar of this programmer 2012</a></li>
<li><a href="../135964/index.html">Siclum supports DrupalCafe first this year.</a></li>
<li><a href="../135965/index.html">CES 2012 // At Sony (Ericsson) again the ‚Äúesochka‚Äù</a></li>
<li><a href="../135966/index.html">Clustered index in InnoDB and query optimization</a></li>
<li><a href="../135968/index.html">Sketch - 100 seconds about CES</a></li>
<li><a href="../135969/index.html">Theory and Practice of Job Search in Canada (Part One)</a></li>
<li><a href="../135971/index.html">Read text in iPod nano 6g</a></li>
<li><a href="../135972/index.html">New budget 3D printer</a></li>
<li><a href="../135973/index.html">Evernote Partners: ifttt will connect Evernote with your other services</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>