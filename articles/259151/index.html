<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Unicorn in search of extraterrestrial intelligence: an analysis of the SETI @ home code</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="There are two possibilities: either we are alone in the universe, or not. Both are equally terrible. (c) Arthur Charles Clark 

 Discussions about whe...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Unicorn in search of extraterrestrial intelligence: an analysis of the SETI @ home code</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/a46/deb/4e7/a46deb4e744297bad3a0886245818614.png" align="left">  <i>There are two possibilities: either we are alone in the universe, or not.</i>  <i>Both are equally terrible.</i>  <i>(c) Arthur Charles Clark</i> <br><br>  Discussions about whether we are alone in the Universe excite people‚Äôs minds for more than a dozen years.  The <a href="http://www.viva64.com/go.php%3Furl%3D1615">SETI</a> project dealing with the search for extraterrestrial civilizations and the possibility of entering into contact with them has a serious attitude to this issue.  The analysis of the source code of one of the projects of this program, SETI @ home, will be discussed in this article. <br><a name="habracut"></a><br><h2>  More about the project </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/a6c/d8d/331/a6cd8d3314914b9e67ddad8f02eb1a3d.png"><br><br>  <a href="http://www.viva64.com/go.php%3Furl%3D1616">SETI @ home</a> is a scientific non-commercial voluntary computing project that uses free resources on volunteer computers to search for radio signals from extraterrestrial civilizations.  The project is based on an open software platform for distributed computing - <a href="http://www.viva64.com/go.php%3Furl%3D1617">BOINC</a> , written in C ++. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      A static analyzer of C / C ++ code - <a href="http://www.viva64.com/ru/pvs-studio/">PVS-Studio was</a> used as an analysis tool.  The source code for the SETI @ home project is available on the official website.  Instructions on how to build a project are also not difficult to find, so, having collected everything you need and preparing a cup of coffee, I got down to business. <br><br><h2>  Test results </h2><br>  I admit that before analyzing the project, I was in anticipation of how many problem areas could be detected.  But to my surprise, really interesting code fragments (problem) turned out to be not very much, which speaks of its quality. <br><br>  However, there were suspicious places, and some of them I would like to consider. <br><br><h3>  To warm up </h3><br>  The code examples in this section cannot be brought under any one category, such as ‚Äúpointers‚Äù or ‚Äúcycles‚Äù, as they have different themes, but they are interesting in their own way. <br><br>  Therefore, I propose to move closer to the point: <br><br><pre><code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SETI_WU_INFO</span></span></span><span class="hljs-class"> :</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> track_mem&lt;SETI_WU_INFO&gt; { .... <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> splitter_version; .... }; SETI_WU_INFO::SETI_WU_INFO(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> workunit &amp;w):.... { .... splitter_version=(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)<span class="hljs-built_in"><span class="hljs-built_in">floor</span></span>(w.group_info-&gt; splitter_cfg-&gt;version)*<span class="hljs-number"><span class="hljs-number">0x100</span></span>; splitter_version+=(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)((w.group_info-&gt;splitter_cfg-&gt;version)*<span class="hljs-number"><span class="hljs-number">0x100</span></span>) &amp;&amp; <span class="hljs-number"><span class="hljs-number">0xff</span></span>; .... }</code> </pre> <br>  Analyzer warning: <a href="http://www.viva64.com/ru/d/0153/">V560</a> A part of conditional expression is always true: 0xff.  seti_header.cpp 96 <br><br>  Suspicious is the '&amp;&amp;' operator, which is used to get an integer value.  Perhaps, in this case, the '&amp;' operator was necessary, since otherwise the variable 'splitter_version' will always take one of two values: 0 or 1. <br><br>  Of course, there is a probability that the addition to 'splitter_version' is 0 or 1, but I think you will agree that it is not very large, and in this case you could use more understandable code (for example, the ternary operator). <br><br>  The next suspicious code snippet is the methods that should return a value but, nevertheless, do not return anything.  Moreover, they have empty bodies.  Such a code at least looks suspicious.  I propose to take a look for yourself: <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">struct</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">float4</span></span></span><span class="hljs-class"> {</span></span> .... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">inline</span></span></span><span class="hljs-function"> float4 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">rsqrt</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">inline</span></span></span><span class="hljs-function"> float4 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sqrt</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">inline</span></span></span><span class="hljs-function"> float4 </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">recip</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">const</span></span></span><span class="hljs-function"> </span></span>{ } .... };</code> </pre> <br>  Analyzer Warnings: <ul><li>  <a href="http://www.viva64.com/ru/d/0195/">V591</a> Non-void function should return a value.  x86_float4.h 237 </li><li>  <a href="http://www.viva64.com/ru/d/0195/">V591</a> Non-void function should return a value.  x86_float4.h 239 </li><li>  <a href="http://www.viva64.com/ru/d/0195/">V591</a> Non-void function should return a value.  x86_float4.h 241 </li></ul>  As can be seen from this fragment, none of the methods returns anything.  I specifically wrote out this particular section of code separately, and was somewhat surprised to see that the compilation was successful.  There were no compiler warnings either.  But only until these methods are invoked.  Attempting to do this still produces a compilation error. <br><br>  What it was: a reserve for the future or a mistake is difficult to say, since there were no comments on this code.  Just keep in mind what I wrote above. <br><br>  But let's not dwell on this example, it‚Äôs better to see what else was found. <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> T&gt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">vector</span></span>&lt;T&gt; xml_decode_field(<span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span> &amp;input, ....) { .... <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>::size_type start,endt,enc,len; .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((len=input.find(<span class="hljs-string"><span class="hljs-string">"length="</span></span>,start)!=<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span>::npos)) length=atoi(&amp;(input.c_str()[len+<span class="hljs-built_in"><span class="hljs-built_in">strlen</span></span>(<span class="hljs-string"><span class="hljs-string">"length="</span></span>)])); .... }</code> </pre> <br>  Analyzer warning: Consider reviewing the expression of the A = B! = C 'kind.  The expression is calculated as the following: 'A = (B! = C)'.  xml_util.h 891 <br><br>  As is clear from the code, during the parsing of the input data, it was necessary to obtain the length value (the 'length' variable). <br><br>  What was meant?  The string searches for the substring ‚Äúlength =‚Äù; if it is found, the index of the beginning of the substring is written to the variable 'len'.  After that, the original string is converted to a C-string, from which the required length value is extracted using the indexing operator.  As a calculation of the index of the character storing the length value, the substring index ‚Äúlength =‚Äù and its length are used. <br><br>  However, due to the priority of operations (or incorrectly placed brackets in the condition, it is clear that they are duplicated) everything goes wrong.  First, a comparison with the value of 'npos' will be performed, and the result of this comparison (0 or 1) will be written into the variable 'len', which will lead to an incorrect calculation of the array index. <br><br>  While viewing the analysis log, I came across a couple of interesting macros.  I propose to take a look and you: <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> FORCE_FRAME_POINTER (0) #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">define</span></span></span><span class="hljs-meta"> SETIERROR( err, errmsg ) do { \ FORCE_FRAME_POINTER; \ throw seti_error( err, __FILE__, __LINE__, errmsg ); \ } while (0)</span></span></code> </pre> <br>  Analyzer Warning: <a href="http://www.viva64.com/ru/d/0221/">V606</a> Ownerless token '0'.  analyzefuncs.cpp 212 <br><br>  Just want to say that this macro has been met several times in the course of the code.  It is not clear why not just generate an exception.  Instead, the code contains an incomprehensible token and there is a loop for which only one iteration is performed.  The approach is interesting, but why such a bike is unclear. <br><br><h3>  Pointers and memory management </h3><br>  For a change, sample code with pointers.  As a rule, in code fragments containing work with pointers or addresses, the probability of stepping on a rake increases in order.  Therefore, they cause more interest. <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">size_t</span></span> GenChirpFftPairs(....) { .... <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> * ChirpSteps; .... ChirpSteps = (<span class="hljs-keyword"><span class="hljs-keyword">double</span></span> *)<span class="hljs-built_in"><span class="hljs-built_in">calloc</span></span>(swi.num_fft_lengths, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">double</span></span>)); .... CRate+=ChirpSteps[j]; .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ChirpSteps) <span class="hljs-built_in"><span class="hljs-built_in">free</span></span> (ChirpSteps); .... }</code> </pre> <br>  Analyzer Warning: <a href="http://www.viva64.com/ru/d/0205/">V595</a> The ChirpSteps' pointer was used against nullptr.  Check lines: 138, 166. chirpfft.cpp 138 <br><br>  The analyzer warns that the pointer is used before the check is performed, on whether it is zero.  If the memory cannot be allocated and the function 'calloc' returns the value 'NULL', a null pointer dereference will be performed, which, as we all know very well, is not very good. <br><br>  Another point is that the function 'free' is called only if the pointer is not equal to 'NULL'.  This check is redundant since the free function handles null pointers without any problems. <br><br>  Another piece of code with suspicious use of the 'memset' function.  Let's get a look: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ReportTripletEvent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(....)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> * inv; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!inv) inv = (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>*)calloc_a(swi.analysis_cfg.triplet_pot_length, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>), MEM_ALIGN); <span class="hljs-built_in"><span class="hljs-built_in">memset</span></span>(inv, <span class="hljs-number"><span class="hljs-number">-1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(inv)); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;swi.analysis_cfg.triplet_pot_length;i++) { j = (i*pot_len)/swi.analysis_cfg.triplet_pot_length; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (inv[j] &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) inv[j] = i; .... } .... }</code> </pre> <br>  Analyzer Warning: <a href="http://www.viva64.com/ru/d/0181/">V579</a>  It is possibly a mistake.  Inspect the third argument.  analyzereport.cpp 271 <br><br>  From this code fragment, it is clear that the memory is first allocated for the array, after which its elements are filled with the value '-1', and after that work is done with them.  But in the 'memset' function, the third parameter is passed not the size of the array, but the size of the pointer.  To correctly fill the array with the required characters, the third argument should be the buffer size. <br><br><h3>  Cycles </h3><br>  In many projects, there are cycles, the body of which either runs infinitely or not at all.  SETI @ home is no exception.  On the other hand, the consequences here are not as critical as in some other projects. <br><br><pre> <code class="cpp hljs"><span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-built_in"><span class="hljs-built_in">string</span></span> hotpix::update_format() <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> { <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::<span class="hljs-function"><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-built_in">ostringstream</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">rv</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">""</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i=<span class="hljs-number"><span class="hljs-number">2</span></span>;i&lt;<span class="hljs-number"><span class="hljs-number">2</span></span>;i++) rv &lt;&lt; <span class="hljs-string"><span class="hljs-string">"?,"</span></span>; rv &lt;&lt; <span class="hljs-string"><span class="hljs-string">"?"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> rv.str(); }</code> </pre> <br>  Analyzer Warning: Consider <a href="http://www.viva64.com/ru/d/0238/">Inspecting</a> the 'for' operator.  It is possible that you will not be executed at all.  schema_master.cpp 9535 <br><br>  The error is very trivial.  As we all know, the body of the 'for' loop is executed as long as its conditional expression is true.  Here, on the first iteration, the condition will be false, so that the loop will be immediately exited.  Personally, I cannot understand what was meant here, but nevertheless the body of this cycle will never be executed. <br><br>  A similar code snippet met again, but in a different method of another class: <br><br>  <a href="http://www.viva64.com/ru/d/0238/">V621</a> Consider inspecting the 'for' operator.  It is possible that you will not be executed at all.  schema_master.cpp 11633 <br><br>  Not so transparent, but potentially erroneous example: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">template</span></span> &lt;<span class="hljs-keyword"><span class="hljs-keyword">typename</span></span> T&gt; <span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::istream &amp;<span class="hljs-keyword"><span class="hljs-keyword">operator</span></span> &gt;&gt;(<span class="hljs-built_in"><span class="hljs-built_in">std</span></span>::istream &amp;i, sqlblob&lt;T&gt; &amp;b) { .... <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (!i.eof()) { i &gt;&gt; tmp; buf+=(tmp+<span class="hljs-string"><span class="hljs-string">' '</span></span>); } .... }</code> </pre> <br>  Analyzer Warning: <a href="http://www.viva64.com/ru/d/0289/">V663</a> Infinite loop is possible.  The 'cin.eof ()' condition is not a loop from the loop.  Consider adding the 'cin.fail ()' function call to the conditional expression.  sqlblob.h 58 <br><br>  Since we are considering cycles, it is easy to guess that the error is in the condition for exiting the 'while' loop.  Although many probably will not find anything suspicious, since the method used here looks quite standard.  But there is an underwater rock, otherwise this article would not exist in the article. <br><br>  The fact is that in the event of a failure to read the data, such a check will not be enough.  In this case, the 'eof ()' method will constantly return 'false', as a result - an infinite loop. <br><br>  To correct the error, add an additional condition.  Then the loop will look like this: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(!i.eof() &amp;&amp; !i.fail()) { <span class="hljs-comment"><span class="hljs-comment">//do something }</span></span></code> </pre> <br><h3>  Other suspicious places </h3><br>  You need to be careful with bit operations.  During the analysis, a code segment was encountered, leading to undefined behavior: <br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">seti_analyze</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ANALYSIS_STATE&amp; state)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> last_chirp_ind = - <span class="hljs-number"><span class="hljs-number">1</span></span> &lt;&lt; <span class="hljs-number"><span class="hljs-number">20</span></span>, chirprateind; .... }</code> </pre> <br>  Analyzer warning: <a href="http://www.viva64.com/ru/d/0225/">V610</a> Undefined behavior.  Check the shift operator '&lt;&lt;'.  The left operand '-1' is negative.  analyzefuncs.cpp 177 <br><br>  As can be seen from the code, the variable is initialized with the value obtained as a result of the bit shift.  And everything would be fine, but the left operand is negative, and according to the C ++ 11 standard, this operation leads to undefined behavior. <br><br>  There is a double-edged sword.  On the one hand, a similar code has been used for a long time and repeatedly, on the other hand, the standard still states that this code leads to undefined behavior. <br><br>  The final decision remains for the programmer, but pay attention to it. <br><br>  The code was repeatedly encountered, where different values ‚Äã‚Äãwere assigned twice to the same variable, and no other variable operations were performed between these assignments.  One example of such a code: <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">checkpoint</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(BOOLEAN force_checkpoint)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> retval=<span class="hljs-number"><span class="hljs-number">0</span></span>, i, l=xml_indent_level; .... retval = (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)state_file.write(str.c_str(), str.size(), <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-comment"><span class="hljs-comment">// ancillary data retval = state_file.printf( "&lt;bs_score&gt;%f&lt;/bs_score&gt;\n" "&lt;bs_bin&gt;%d&lt;/bs_bin&gt;\n" "&lt;bs_fft_ind&gt;%d&lt;/bs_fft_ind&gt;\n", best_spike-&gt;score, best_spike-&gt;bin, best_spike-&gt;fft_ind); .... }</span></span></code> </pre> <br>  Analyzer Warning: <a href="http://www.viva64.com/ru/d/0108/">V519</a> The 'retval' variable is assigned values ‚Äã‚Äãtwice successively.  Perhaps this is a mistake.  Check lines: 450, 452. seti.cpp 452 <br><br>  In this situation, it is difficult to say what was meant or how it should be corrected.  But the programmer who wrote the code may understand the reason for this use of the variable.  We can only wonder and speculate. <br><br>  Four more similar code sections were met.  Relevant analyzer messages: <ul><li>  <a href="http://www.viva64.com/ru/d/0108/">V519</a> The 'retval' variable is assigned values ‚Äã‚Äãtwice successively.  Perhaps this is a mistake.  Check lines: 470, 472. seti.cpp 472 </li><li>  <a href="http://www.viva64.com/ru/d/0108/">V519</a> The 'retval' variable is assigned values ‚Äã‚Äãtwice successively.  Perhaps this is a mistake.  Check lines: 490, 492. seti.cpp 492 </li><li>  <a href="http://www.viva64.com/ru/d/0108/">V519</a> The 'retval' variable is assigned values ‚Äã‚Äãtwice successively.  Perhaps this is a mistake.  Check lines: 513, 515. seti.cpp 515 </li><li>  <a href="http://www.viva64.com/ru/d/0108/">V519</a> The 'retval' variable is assigned values ‚Äã‚Äãtwice successively.  Perhaps this is a mistake.  Check lines: 533, 536. seti.cpp 536 </li><li>  <a href="http://www.viva64.com/ru/d/0108/">V519</a> The 'lReturnValue' variable is assigned values ‚Äã‚Äãtwice successively.  Perhaps this is a mistake.  Check lines: 85, 97. win_util.cpp 97 </li></ul><br>  Perhaps these variables were used simply to view the values ‚Äã‚Äãthat the functions return when debugging code.  Then there is nothing dangerous and these warnings can be ignored or suppressed in one of the many ways that the PVS-Studio analyzer provides. <br><br>  Finally, I will give an example where the 'strlen' function is somewhat irrational: <br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">parse_state_file</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ANALYSIS_STATE&amp; as)</span></span></span><span class="hljs-function"> </span></span>{ .... <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(fgets(p, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(buf)-(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)<span class="hljs-built_in"><span class="hljs-built_in">strlen</span></span>(buf), state_file)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (xml_match_tag(buf, <span class="hljs-string"><span class="hljs-string">"&lt;/bt_pot_min"</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; p += <span class="hljs-built_in"><span class="hljs-built_in">strlen</span></span>(p); } .... }</code> </pre> <br>  Analyzer Warning: <a href="http://www.viva64.com/ru/d/0309/">V814</a> Decreased performance.  Calls to the 'strlen' function for the loop's continuation was calculated.  seti.cpp 770 <br><br>  Since the buffer (variable 'buf') does not change during the execution of the loop, there is no need to calculate its length at each iteration.  Perhaps it would be more expedient to create for this a separate variable with which to make a comparison.  This is not so noticeable with small buffer sizes, but with large ones, when the number of iterations is significantly larger, it can be much more noticeable. <br><br>  This code has been met several times, here are some more similar messages: <ul><li>  <a href="http://www.viva64.com/ru/d/0309/">V814</a> Decreased performance.  Calls to the 'strlen' function for the loop's continuation was calculated.  seti.cpp 784 </li><li>  <a href="http://www.viva64.com/ru/d/0309/">V814</a> Decreased performance.  The 'strlen' function of the loop.  xml_util.cpp 663 </li><li>  <a href="http://www.viva64.com/ru/d/0309/">V814</a> Decreased performance.  The 'strlen' function of the loop.  xml_util.cpp 686 </li></ul><br><h2>  What else could I find? </h2><br>  There were other warnings of the analyzer, but I found the code fragments are not so interesting as to write them out and analyze them separately.  You can just read this section and find out what else was encountered during the test. <br><br>  For example, there came across "hanging" arrays, which are declared but not used at all.  Fortunately, their size was fixed and small.  However, the stack memory was allocated for them, which is inexpedient. <br><br>  Also, pointer dereference has been encountered several times, followed by its increase (* p ++).  At the same time, the value stored in the index was not used in any way.  From the examples it was clear that the change was simply to the pointer itself, but for some reason it was still dereferenced.  This code is potentially erroneous, as it can sometimes be implied to change the value stored in the pointer, and not its own.  Therefore, to treat with distrust these warnings are not worth it. <br><br>  The function 'fprintf' was repeatedly encountered, the format string of which did not match the actual arguments passed to the function.  This leads to indefinite behavior and may cause, for example, displaying nonsense on the screen. <br><br><h2>  Conclusion </h2><br>  After checking, I left a double impression.  On the one hand, I was somewhat upset that there were fewer errors in the code than expected, therefore, there was less material for the article.  On the other hand, the project was verified, and it was interesting.  A small number of errors indicates the quality of the code, which is also good. <br><br>  What else to add?  Install the <a href="http://www.viva64.com/go.php%3Furl%3D1616">SETI @ home</a> client - help in the search for extraterrestrial civilizations, install <a href="http://www.viva64.com/ru/pvs-studio/">PVS-Studio</a> - it will help you in finding errors in the source codes written in C / C ++. <br><br><h2>  This article is in English. </h2><br>  If you want to share this article with an English-speaking audience, then please use the link to the translation: Sergey Vasiliev.  <a href="http://www.viva64.com/en/b/0327/">A Unicorn Seeking Extraterrestrial Life: Analyzing SETI @ home's Source Code</a> . <br><br><div class="spoiler">  <b class="spoiler_title">Read the article and have a question?</b> <div class="spoiler_text">  Often our articles are asked the same questions.  We collected answers to them here: <a href="http://www.viva64.com/ru/a/0085/">Answers to questions from readers of articles about PVS-Studio, version 2015</a> .  Please review the list. <br></div></div></div><p>Source: <a href="https://habr.com/ru/post/259151/">https://habr.com/ru/post/259151/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../259141/index.html">Russification and multilingual OpenStreetMap cards</a></li>
<li><a href="../259143/index.html">Yukon: 1st Annual Software Developer Conference</a></li>
<li><a href="../259145/index.html">Prototype OOP for Lua</a></li>
<li><a href="../259147/index.html">Network Evolution - New 25/50/100 GbE Standard</a></li>
<li><a href="../259149/index.html">SonarQube. We check the code for quality</a></li>
<li><a href="../259153/index.html">A few tips on OpenMP</a></li>
<li><a href="../259155/index.html">LINQ for PHP: speed matters</a></li>
<li><a href="../259161/index.html">How to make a portable repair server</a></li>
<li><a href="../259163/index.html">DevConf 2015: Interview with the author - there will be no PHP6! Meet PHP7</a></li>
<li><a href="../259165/index.html">Making a Callback from the site using Askozia PBX</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>