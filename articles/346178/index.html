<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>640 KB is really enough for everyone</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Never give up 
 Did Bill Gates really say ‚Äú640 KB should be enough for everyone‚Äù? Her story is rather vague, but most often it is attributed to Bill, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>640 KB is really enough for everyone</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/52e/5d7/ebc/52e5d7ebceca840eb2174402edfc9c20.png" alt="image"></div><br><h3>  Never give up </h3><br>  Did Bill Gates really say ‚Äú640 KB should be enough for everyone‚Äù?  Her story is rather vague, but most often it is attributed to Bill, so perhaps he did say that. <br><br>  He was often ridiculed for it.  The idea of ‚Äã‚Äãa total memory space of only 640 KB in size is ridiculous by modern standards.  Even the executable files of most installers will not fit in this size. <br><br>  For comparison: the calculator in Windows 10 takes up 16.2 MB of RAM in idle state - almost 26 times more than the amount of memory available to DOS programs in the 1980s. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  Strange things </h3><br>  Would you believe me if I say that there is still an active community using this outdated platform and developing software for it? <br><br>  Probably your first question will be ‚ÄúBut why?‚Äù And I understand you well.  Let's take a look at some groups that are still interested in investing in DOS. <br><a name="habracut"></a><br>  <strong>Legacy systems developers</strong> <br><br>  Today, there are still many programs that run in DOS.  Industrial control programs, point-of-sale systems and scientific tools are just some of the examples of applications that use DOS even today.  Over time, most of these programs have been ported to other systems or completely rewritten, but some are still preserved. <br><br>  <strong>Real time non-cost systems</strong> <br><br>  DOS is essentially a real-time operating system (RTOS).  She was not specifically designed for this purpose, but her minimalistic design allows her to be attributed to other similar systems. <br><br>  RTOS are characterized by a predictable delay in software and hardware queries.  Since DOS has a minimal API without internal multitasking, the stability of operating system call delays is quite high. <br><br>  Although there are already more advanced examples of real-time systems with improved design and developed specifically for this purpose, the thinnest DOS interface between the application and the equipment gives it an advantage in this area of ‚Äã‚Äãuse.  Since systems such as FreeDOS (which I will discuss below) are open source and distributed free of charge, they are a good alternative to other RTOS. <br><br>  <strong>Nostalgic video games</strong> <br><br>  Modern video games are awesome.  They require immense power of 3D, but the graphics, sound and gameplay are sometimes so realistic that they can be confused with reality.  Virtual reality equipment further enhances this feeling, allowing players to fully immerse themselves in the game environment. <br><br>  But despite all this progress, many gamers who were children in the 80s and early 90s remember fondly the times when primitive (by modern standards) graphics and synth sounds made them fill in the gaps with their own imaginations. <br><br>  Despite the fact that the hardware has left the limitations of the DOS era far behind, there is still an active scene for DOS gamers.  Driven by nostalgia and a love for programming, developers write games that run on older systems, including PCs, which were originally shipped with DOS. <br><br>  If you think that this market is limited to a handful of retirees trying to return to their technological childhood, then you are mistaken.  <a href="http://www.the8bitguy.com/" rel="noopener">David Murray</a> , better known on YouTube as <a href="https://www.youtube.com/user/adric22">The 8-bit Guy</a> , has more than half a million subscribers who weekly explore the territory of nostalgic computer hardware.  He even wrote a real-time strategy for Commodore 64 called <a href="http://www.the8bitguy.com/planet-x2-announced/">PlanetX2</a> .  The project was such a success that David sold out all the physical reserves of the carriers with the game and plans to create a sequel for the DOS platform. <br><br><h3>  Run DOS </h3><br>  There are many ways to start DOS.  You may even have a computer where you can run it right now.  But since we want to work closely with this operating system, we will use the way in which free software is used that runs on almost any computer. <br><br>  First, let's talk a little about the license.  According to some reports, Microsoft made MS-DOS 6.22 public domain, but I could not find confirmation of this.  Since the software can be easily downloaded from fairly secure online sources, I am not in favor of installing something that could violate copying rights.  Even if you have a legally acquired copy (and I suspect that many have it), installing it on a virtual machine can be a legally risky act. <br><br>  To simplify installation, we will use FreeDOS.  FreeDOS is an open source clone of DOS written by Jim Hall.  Jim began development in June 1994, when Microsoft announced that it would no longer sell and support MS-DOS.  A few weeks later, Pat Willini and Tim Norman joined the project.  In just a few months, version 0.01 appeared.  Today, we are using version 1.2 released on Christmas Day 2016. <br><br>  First we go to the <a href="http://www.freedos.org/">FreeDOS website</a> and download the ISO image of the standard installer on CD-ROM.  You can also download the USB version, but taking into account differences in hardware, BIOS, etc.  we will not consider this method here.  Instead, we will use virtualization. <br><br>  I tested FreeDOS with both <a href="https://www.virtualbox.org/">VirtualBox Oracle</a> and <a href="https://www.vmware.com/products/workstation-pro.html">VMware Workstation / Player</a> .  Both products work well, but VMware provides slightly better BIOS emulation and emulates the PC speaker used in many DOS games.  In the examples below, I will use VMware Workstation, but in principle any system will do. <br><br>  The default installation options for FreeDOS are VirtualBox and VMware.  It may surprise you how little RAM and disk space are allocated.  I usually create a two GB drive for DOS, but the default 512 MB will be enough. <br><br>  Installing FreeDOS is simple; all you have to do is boot into a virtual machine from an ISO image (an ISO file request will be issued at startup or when creating a virtual machine) and follow the on-screen prompts.  After FreeDOS splits the disk and reboots, choose Install to Hard Disk again.  Choose "Full Installation" or "Full Installation with Sources" if you like to see how everything works.  You are reading this article, so most likely it is, then why not install the source? <br><br>  After installation, you will need to reboot.  This time, instead of selecting ‚ÄúInstall to Hard Disk‚Äù in the CD boot menu, select ‚ÄúBoot from System Hard Disk‚Äù.  The default Jemmex (with no EMS) is quite suitable for standard downloads, especially if you want to develop. <br><br>  Technically, the FreeDOS system is ready to work, but still completely "naked."  In this state, it is convenient to run games and DOS programs, but it is not entirely suitable for development, because we do not have important tools. <br><br><h3>  Cute fdimples </h3><br>  Now it‚Äôs time to install some software in FreeDOS.  The OS contains a wonderful FDimples package management system.  To use it, enter: <br><br><pre><code class="dos">fdimples</code></pre><br>
       .       ‚Äî    ,    .     ,  ,           ,       .<br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/101/f55/b37/101f55b37b2f08bc882ee298acba1262.png"></div><br>
<i>     .</i><br>
<br>
          .    , ENTER ‚Äî  .      ,    Development.     TAB,      OK,   ENTER.<br>
<br>
<h3> C++  </h3><br>
    ,   ? C++ ,         GNU Compiler Collection     DOS.<br>
<br>
 ,       DOS CWSDPMI         32-     .     640    . ,  !<br>
<br>
    ,       :<br>
<br>
<pre><code class="dos">mkdir C:\src
mkdir c:\src\hello
rhide c:\src\hello\hello.cpp</code></pre><br>
     RHIDE.      Visual Studio,       .     Borland Turbo-C,      .<br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/5f5/f43/05f/5f5f4305f9ce806cf0f680a910279815.png"></div><br>
<i>         .</i><br>
<br>
   :<br>
<br>
<pre><code class="cpp">#include &lt;iostream&gt;
using namespace std;

int main() {
  cout &lt;&lt; ‚ÄúHello, World!\n‚Äù;
  return 0;
}</code></pre><br>
       ¬´Run¬ª (  ALT+R,   R  CTRL+F9).  ,       .   ,     ,       .  -   RHIDE,           !<br>
<br>
<h3>  </h3><br>
  -  .      :<br>
<br>
<pre><code class="dos">mkdir c:\src\example
rhide c:\src\example\example.cpp</code></pre><br>
    ,   ,         VGA 320x200x256.<br>
<br>
<pre><code class="cpp">#include &lt;iostream&gt;
#include &lt;dpmi.h&gt;
#include &lt;unistd.h&gt;
#include &lt;go32.h&gt;
#include &lt;sys/farptr.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;dos.h&gt;
 
#define COLOR_WHITE 15
#define MAX_WIDTH 320
#define MAX_HEIGHT 200

using namespace std;

void set_video_mode(int mode) {
  //    
  __dpmi_regs r;
 
  //  AX  
  r.x.ax = mode;
 
  //  int 10 (  BIOS)
  __dpmi_int(0x10, &amp;r);
}

void put_pixel(int x, int y, int c) {
  //  VGA    A000,      .
  _farpokeb(_dos_ds, 0xA0000+y*320+x, c);
}

void clear_pixel(int x, int y) {
  //     0,   
  _farpokeb(_dos_ds, 0xA0000+y*320+x, 0);
}

void draw_effect() {
  //   x  y
  int x = 0;
  int y = 0;

  //    y_max  
  for (y = 0; y &lt; MAX_HEIGHT, y++) {
    for (x=0; x &lt; MAX_WIDTH, x++) {
      put_pixel(x, y, rand()%(15+1));
    }
  }
}

int main() {
  //   13h (320x200x256)
  set_video_mode(0x13);

  //  
  draw_effect();

  //    ENTER
  cin.ignore();

  //    
  set_video_mode(3);

  return 0;
}</code></pre><br>
<h3>  </h3><br>
           .      ,     .    ,     .<br>
<br>
<pre><code class="cpp">#include &lt;iostream&gt;
#include &lt;dpmi.h&gt;
#include &lt;unistd.h&gt;
#include &lt;go32.h&gt;
#include &lt;sys/farptr.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;dos.h&gt;

#define COLOR_WHITE 15
#define MAX_WIDTH 320
#define MAX_HEIGHT 200

#define KEY_ESC 283
#define KEY_UP 18432
#define KEY_DOWN 20480
#define KEY_LEFT 19200
#define KEY_RIGHT 19712

using namespace std;

void set_video_mode(int mode) {
  //    s
  __dpmi_regs r;
 
  //  AX  
  r.x.ax = mode;
 
  //  int 10 (  BIOS)
  __dpmi_int(0x10, &amp;r);
}

void put_pixel(int x, int y, int c) {
  //  VGA    A000,      .
  _farpokeb(_dos_ds, 0xA0000+y*320+x, c);
}

void clear_pixel(int x, int y) {
  //     0,   
  _farpokeb(_dos_ds, 0xA0000+y*320+x, 0);
}

int get_key() {
  //    
  __dpmi_regs r;
  //  AH  00h   BIOS
  r.x.ax = 0x0000;
  //  int 16 (  BIOS)
  __dpmi_int(0x16, &amp;r);
  //   AX ( -)
  return r.x.ax;
}

int main() {

  //   13h (320x200x256)
  set_video_mode(0x13);

  //  
  int running = 1;
  int curkey;
  //    
  int char_x = MAX_WIDTH / 2;
  int char_y = MAX_WIDTH / 2;
  while (running) {
    //   
    curkey = get_key();
    //    ,      
    clear_pixel(char_x, char_y);
    switch (curkey) {
      case KEY_ESC:
        //   ESC,   
        running = 0;
        break;
      case KEY_UP:
        char_y--;
        break;
      case KEY_DOWN:
        char_y++;
        break;
      case KEY_LEFT:
        char_x--;
        break;
      case KEY_RIGHT:
        char_x++;
        break;
    }
    //  ""  
    put_pixel(char_x, char_y, COLOR_WHITE);
  }
  
  //    
  set_video_mode(3);
  return 0;
}</code></pre><br>
,       ,         .    .<br>
<br>
,       INT 16.   ,    ,    .        INT 16 AH = 01          ,     .        .      ,              .<br>
<br>
 , put_pixel  clear_pixel   ,      ,        .             memcpy().      - :<br>
<br>
<pre><code class="cpp">#include &lt;sys/movedata.h&gt;

char buffer[320x200];
int i;
 
//   ,    
 
//     
dosmemput(buffer, 320*200, 0xA0000);</code></pre><br>
      / ,     .  ,        ,        ‚Äî  ,      .<br>
<br>
<h3>   </h3><br>
   ,  C++ ‚Äî  ,   ,          .    .      DOS  BASIC      ,     .<br>
<br>
      .  ,     ,             C++,           ,   DJGPP.<br>
<br>
 ,    ,  ,      ,    .    DOS   ,     640 .    ,      640 .   DOS-     TSR ( )   600  .<br>
<br>
     ,       ,    DOS  EMS ( ).       600 ,            ,    1    .  DOS  CWSDPMI   !<br>
<br>
<h3> </h3><br>
,       .   DOS ‚Äî    .            ¬´¬ª,    DJGPP       .<br>
<br>
,           .        .      DOS,    VGA (,     , -     )     C.<br>
<br>
 C++        ,    (,    ,   )        .      4    (  , ),            JPG  .          .<br>
<br>
     ,       .      ,        .<br>
<br>
   ‚Äî     .      .</div><p>Source: <a href="https://habr.com/ru/post/346178/">https://habr.com/ru/post/346178/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../346168/index.html">Top 10 universities in Europe to study IT</a></li>
<li><a href="../346170/index.html">Divide users by role in FeathersJs</a></li>
<li><a href="../346172/index.html">Moving to Japan</a></li>
<li><a href="../346174/index.html">Analyzing local functions in C # 7</a></li>
<li><a href="../346176/index.html">Defer: from Go to PHP</a></li>
<li><a href="../346180/index.html">Algorithm Paccos. Understandable article on consensus in a distributed system</a></li>
<li><a href="../346184/index.html">Bioinformatic Pipeline with Docker</a></li>
<li><a href="../346186/index.html">Practice writing tests. Yandex lecture</a></li>
<li><a href="../346188/index.html">Web messengers and the event 'beforeunload': how to save a million messages when you close the page</a></li>
<li><a href="../346190/index.html">Choosing a data center in St. Petersburg, practical experience of choice</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>