<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Creating plug-ins for AutoCAD using the .NET API (Part 2 - Working with Ribbon [Ribbon])</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In my last article, I promised that I would write a few more short notes on the development of plug-ins for AutoCAD. On Habr√© information on this topi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Creating plug-ins for AutoCAD using the .NET API (Part 2 - Working with Ribbon [Ribbon])</h1><div class="post__text post__text-html js-mediator-article">  In my <u><a href="http://habrahabr.ru/post/235723/">last article,</a></u> I promised that I would write a few more short notes on the development of plug-ins for AutoCAD.  On Habr√© information on this topic is extremely small - perhaps you can add a couple of materials to the clip.  In this article I will give an example of creating a new tab on the AutoCAD ribbon with several controls. <br><br><pre><code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> disclaimer = <span class="hljs-string"><span class="hljs-string">"          AutoCAD.   ‚Äì      ."</span></span>;</code> </pre> <a name="habracut"></a><br><h4>  Introduction </h4><br>  When I once started working with a tape, the example I gave <u><a href="http://forums.autodesk.com/t5/net/create-custom-ribbon-tab-and-buttons-for-autocad-mechanical-2011/m-p/2836143/highlight/true">here</a></u> most helped me.  Basically, I will rely on him. <br>  In addition, some information can be gathered from <u><a href="http://through-the-interface.typepad.com/through_the_interface/2008/04/the-new-ribbonb.html">this post by</a></u> Kean Walmsley. <br><br>  First, let's remember how the ribbon looks in AutoCAD: <br><img src="https://habrastorage.org/files/0aa/b5f/778/0aab5f77862a4845973866da328ea443.png"><br>  In the upper part there is a list of ribbon tabs ( <i>Home, Mesh Modeling, Render ...</i> ).  When you select a tab on the ribbon, the controls on this tab are displayed, grouped in panels ( <i>Modeling, Mesh, Solid Editing ...</i> ). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Well, let's get started. <br><br><h4>  1. Creating a new plugin project </h4><br>  This was the <u><a href="http://habrahabr.ru/post/235723/">last article</a></u> .  The following examples specify <b>.NET Framework 3.5</b> as the required version of the .NET Framework. <br><br><div class="spoiler">  <b class="spoiler_title">You can immediately add a code framework:</b> <div class="spoiler_text"><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Autodesk.AutoCAD.Runtime; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Autodesk.Windows; namespace MyAutoCADDll { <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> Commands : IExtensionApplication { //        AutoCAD  "TestCommand" [CommandMethod("TestCommand")] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> MyCommand() { } //  Initialize()  Terminate() ,    IExtensionApplication <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> Initialize() { } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> Terminate() { } } }</code> </pre></div></div><br><h4>  2. Adding links to the necessary libraries </h4><br>  In this case, useful libraries AutoCAD .NET API with the names <b>AcMgd.dll</b> , <b>AcDbMgd.dll</b> and <b>AdWindows.dll</b> (do not forget to disable <code>CopyLocal</code> !).  In addition, you need to add links to the three assemblies of .NET itself: <b>Presentation Core</b> , <b>Presentation Framework,</b> and <b>WindowsBase</b> . <br><br><h4>  3. Actually writing code to create a new tab. </h4><br>  From the point of view of the code, everything looks very simple.  The AutoCAD .NET API already has classes that are responsible for working with the tape.  They are in the <code>Autodesk.Windows</code> namespace (it contains the <b>AdWindows.dll</b> container). <br><br>  To create a new tab on the ribbon, you must: <br><ol><li>  create interface elements; </li><li>  group these items into containers; </li><li>  create panels on which these containers will be placed; </li><li>  create a tab on which these panels will be placed; </li><li>  Add the created tab to the AutoCAD feed. </li></ol><br><div class="spoiler">  <b class="spoiler_title">Code:</b> <div class="spoiler_text"><pre> <code class="hljs pgsql">//        AutoCAD  ¬´TestCommand¬ª [CommandMethod("TestCommand")] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> MyCommand() { //    Autodesk.Windows.RibbonCombo comboBox1 = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> RibbonCombo(); comboBox1.Id = "_combobox1"; //   Autodesk.Windows.RibbonButton button1 = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Autodesk.Windows.RibbonButton(); button1.Id = "_button1"; //     Autodesk.Windows.RibbonPanelSource rbPanelSource = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Autodesk.Windows.RibbonPanelSource(); rbPanelSource.Title = "  "; //      rbPanelSource.Items.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(comboBox1); rbPanelSource.Items.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> RibbonSeparator()); rbPanelSource.Items.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(button1); //   RibbonPanel rbPanel = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> RibbonPanel(); //       rbPanel.Source = rbPanelSource; //   RibbonTab rbTab = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> RibbonTab(); rbTab.Title = " "; rbTab.Id = "HabrRibbon"; //     rbTab.Panels.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(rbPanel); //     AutoCAD Autodesk.Windows.RibbonControl rbCtrl = ComponentManager.Ribbon; //     rbCtrl.Tabs.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(rbTab); //     ("") rbTab.IsActive = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; }</code> </pre></div></div><br>  We assemble the project, launch AutoCAD, load our plugin with the NETLOAD command, execute the TestCommand command ... <br><img src="https://habrastorage.org/files/63c/e4b/b12/63ce4bb1246a4763a2743bdcb40b321f.PNG"><br><br>  Yes, not the most impressive result.  :) <br>  But never mind, a little later we'll make the tab more fun.  In the meantime, let's deal with what is already there. <br><br><h4>  4. Search for items on the tape </h4><br>  You can use the <code>ComponentManager.Ribbon.FindTab(string id)</code> method to search for a tab on a ribbon.  As an argument, you must specify the tab <code>Id</code> specified when it was created. <br><br>  There are similar methods for searching the panel ( <code>ComponentManager.Ribbon.FindPanel(string id, bool SearchActiveTabOnly)</code> ) and other controls ( <code>ComponentManager.Ribbon.FindItem(string id, bool SearchActiveTabOnly)</code> ). <br><br>  If the element is successfully found, the above functions will return the corresponding object, otherwise the value <code>null</code> will be returned. <br><br><h4>  5. Handle button processing </h4><br>  To bind a button click handler, use the <code>CommandHandler</code> class's <code>RibbonButton</code> .  In this property, you must specify a method that implements the <code>System.Windows.Input.ICommand</code> interface. <br><br>  As part of the <code>ICommand</code> interface, the class must implement the <code>CanExecuteChanged</code> event, as well as the <code>CanExecute</code> and <code>Execute</code> functions. <br><br><div class="spoiler">  <b class="spoiler_title">Example code with a button click handler:</b> <div class="spoiler_text"><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Autodesk.AutoCAD.Runtime; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Autodesk.Windows; namespace MyAutoCADDll { <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> Commands : IExtensionApplication { //        AutoCAD  "TestCommand" [CommandMethod("TestCommand")] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> MyCommand() { //    Autodesk.Windows.RibbonCombo comboBox1 = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> RibbonCombo(); comboBox1.Id = "_combobox1"; //   Autodesk.Windows.RibbonButton button1 = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Autodesk.Windows.RibbonButton(); button1.Id = "_button1"; //      button1.CommandHandler = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> CommandHandler_Button1(); //     Autodesk.Windows.RibbonPanelSource rbPanelSource = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Autodesk.Windows.RibbonPanelSource(); rbPanelSource.Title = "  "; //      rbPanelSource.Items.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(comboBox1); rbPanelSource.Items.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> RibbonSeparator()); rbPanelSource.Items.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(button1); //   RibbonPanel rbPanel = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> RibbonPanel(); //       rbPanel.Source = rbPanelSource; //   RibbonTab rbTab = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> RibbonTab(); rbTab.Title = " "; rbTab.Id = "HabrRibbon"; //     rbTab.Panels.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(rbPanel); //     AutoCAD Autodesk.Windows.RibbonControl rbCtrl = ComponentManager.Ribbon; //     rbCtrl.Tabs.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(rbTab); //     ("") rbTab.IsActive = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } //  Initialize()  Terminate() ,    IExtensionApplication <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> Initialize() { } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> Terminate() { } } //    <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> CommandHandler_Button1 : <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Windows.<span class="hljs-keyword"><span class="hljs-keyword">Input</span></span>.ICommand { <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> event EventHandler CanExecuteChanged; <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">bool</span></span> CanExecute(<span class="hljs-keyword"><span class="hljs-keyword">object</span></span> param) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Execute</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">object</span></span> parameter) { <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Windows.MessageBox.<span class="hljs-keyword"><span class="hljs-keyword">Show</span></span>("Habr!"); } } }</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Nb:</b> <div class="spoiler_text">  The <code>CanExecuteChanged</code> event notifies users of a team about a possible change in its availability for execution (in short, it works or does not work).  The <code>CanExecute</code> function allows <code>CanExecute</code> to find out if a command is available for execution at a given point in time.  And the <code>Execute</code> function is actually those actions that the command should perform when it was called. <br><br>  In this example, the command is always available, and this state does not change.  In my real-life task, too, I never needed to somehow use the first two parameters.) <br></div></div></div></div><br>  Now, after pressing the button, a message box will appear on the screen. <br><img src="https://habrastorage.org/files/3df/553/be2/3df553be2cd74cc48106a32d473279f7.PNG"><br><br><h4>  6. Interaction with the drop-down list ( <code>RibbonCombo</code> ) </h4><br><h5>  6.1 Adding, Modifying, Deleting List Items </h5><br>  All items in the <code>RibbonCombo</code> drop-down list <code>RibbonCombo</code> contained in its <code>Items</code> property.  It has the type <code>System.Collections.ObjectModel.ObservableCollection</code> , with <code>System.Object</code> acting as the content type.  Thus, a collection item can be an object of any class.  Unfortunately, if we simply add several text lines to this array, we will not get the desired effect: <br><pre> <code class="hljs pgsql">comboBox1.Items.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(""); comboBox1.Items.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(""); comboBox1.Items.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>("");</code> </pre><br><img src="https://habrastorage.org/files/c51/9a8/217/c519a821740a4ce981697781fa053ad7.PNG"><br><br>  To get a decent drop-down list, you can use instances of the <code>RibbonButton</code> class discussed above as its elements: <br><pre> <code class="hljs pgsql">Autodesk.Windows.RibbonButton tempRibBut1 = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Autodesk.Windows.RibbonButton(); tempRibBut1.Id = "_temp_button_1"; tempRibBut1.Text = " 1"; tempRibBut1.ShowText = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; Autodesk.Windows.RibbonButton tempRibBut2 = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Autodesk.Windows.RibbonButton(); tempRibBut2.Id = "_temp_button_2"; tempRibBut2.Text = " 2"; tempRibBut2.ShowText = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; comboBox1.Items.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(tempRibBut1); comboBox1.Items.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(tempRibBut2);</code> </pre><br>  As a result, we will see this: <br><img src="https://habrastorage.org/files/ae4/272/de4/ae4272de4ff040b88d96b5f8f30226c6.PNG"><br><br>  If necessary, you can use the properties and methods of <code>ObservableCollection</code> , in particular: <br><ul><li>  method <code>Remove(object item)</code> - to delete the specified item; </li><li>  <code>RemoveAt(int index)</code> method <code>RemoveAt(int index)</code> - to delete an element at a specified position; </li><li>  <code>Clear()</code> method <code>Clear()</code> - to remove all items from the collection; </li><li>  <code>Count</code> property - to get the number of items in the collection. </li></ul>  The current list item in the <code>RibbonButton</code> is stored in its <code>Current</code> property. <br><br><div class="spoiler">  <b class="spoiler_title">Nb:</b> <div class="spoiler_text">  Usually the list item corresponds with some kind of domain object.  To be able to quickly determine what a particular list item is associated with, you can use the <code>Tag</code> property of the <code>RibbonButton</code> class: <br><pre> <code class="hljs pgsql">Autodesk.Windows.RibbonButton tempRibBut1 = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Autodesk.Windows.RibbonButton(); tempRibBut1.Id = "_temp_button_1"; tempRibBut1.Text = " 1"; tempRibBut1.ShowText = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; tempRibBut1.Tag = "elementTag"; //   comboBox1.Items.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(tempRibBut1);</code> </pre><br>  Then, when processing the list item, you can see which tag was set: <br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">object</span></span> obj = comboBox1.Items[<span class="hljs-number"><span class="hljs-number">0</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> itemTag = (obj <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> RibbonButton).Tag; <span class="hljs-comment"><span class="hljs-comment">// "elementTag"</span></span></code> </pre><br>  You can go even further.  Since the <code>Tag</code> property is of type <code>System.Object</code> , an object of any class, including one created by the programmer itself, can act as a tag: <br><pre> <code class="hljs cs">tempRibBut1.Tag = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MyClass(<span class="hljs-string"><span class="hljs-string">"objectDecription"</span></span>);</code> </pre><br>  After that, you can refer to any property of this object: <br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">object</span></span> obj = comboBox1.Items[<span class="hljs-number"><span class="hljs-number">0</span></span>]; MyClass itemTag = (obj <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> RibbonButton).Tag <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> MyClass; <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> myClassDecription = itemTag.Description;</code> </pre><br>  <s>In the event of a strong desire to save the line there is an opportunity to write constructions</s> <br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">string</span></span> myClassDecription = ((comboBox1.Items[<span class="hljs-number"><span class="hljs-number">0</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> RibbonButton).Tag <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> MyClass).Description</code> </pre> <br>  Of course, in real code you need to make sure that the values ‚Äã‚Äãobtained are not equal to <code>null</code> . </div></div><br><h5>  6.2 Handling the event of selecting a list item </h5><br>  When you select the <code>RibbonCombo</code> list <code>RibbonCombo</code> , a <code>CurrentChanged</code> event is generated.  Here is a simple example of the event handler: <br><pre> <code class="hljs pgsql">//       <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static <span class="hljs-type"><span class="hljs-type">void</span></span> comboBox1_CurrentChanged(<span class="hljs-keyword"><span class="hljs-keyword">object</span></span> o, RibbonPropertyChangedEventArgs args) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (args.NewValue != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Windows.MessageBox.<span class="hljs-keyword"><span class="hljs-keyword">Show</span></span>((args.NewValue <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> RibbonButton).Text); } }</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Full sample code:</b> <div class="spoiler_text"><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Autodesk.AutoCAD.Runtime; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Autodesk.Windows; namespace MyAutoCADDll { <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> Commands : IExtensionApplication { //        AutoCAD  "TestCommand" [CommandMethod("TestCommand")] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> MyCommand() { //    Autodesk.Windows.RibbonCombo comboBox1 = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> RibbonCombo(); comboBox1.Id = "_combobox1"; //      Autodesk.Windows.RibbonButton tempRibBut1 = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Autodesk.Windows.RibbonButton(); tempRibBut1.Id = "_temp_button_1"; tempRibBut1.Text = " 1"; tempRibBut1.ShowText = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; tempRibBut1.Tag = "btn1"; Autodesk.Windows.RibbonButton tempRibBut2 = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Autodesk.Windows.RibbonButton(); tempRibBut2.Id = "_temp_button_2"; tempRibBut2.Text = " 2"; tempRibBut2.ShowText = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; tempRibBut2.Tag = "btn2"; comboBox1.Items.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(tempRibBut1); comboBox1.Items.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(tempRibBut2); //        comboBox1.CurrentChanged += comboBox1_CurrentChanged; //   Autodesk.Windows.RibbonButton button1 = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Autodesk.Windows.RibbonButton(); button1.Id = "_button1"; //      button1.CommandHandler = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> CommandHandler_Button1(); //     Autodesk.Windows.RibbonPanelSource rbPanelSource = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Autodesk.Windows.RibbonPanelSource(); rbPanelSource.Title = "  "; //      rbPanelSource.Items.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(comboBox1); rbPanelSource.Items.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> RibbonSeparator()); rbPanelSource.Items.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(button1); //   RibbonPanel rbPanel = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> RibbonPanel(); //       rbPanel.Source = rbPanelSource; //   RibbonTab rbTab = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> RibbonTab(); rbTab.Title = " "; rbTab.Id = "HabrRibbon"; //     rbTab.Panels.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(rbPanel); //     AutoCAD Autodesk.Windows.RibbonControl rbCtrl = ComponentManager.Ribbon; //     rbCtrl.Tabs.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(rbTab); //     ("") rbTab.IsActive = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } //       <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> static <span class="hljs-type"><span class="hljs-type">void</span></span> comboBox1_CurrentChanged(<span class="hljs-keyword"><span class="hljs-keyword">object</span></span> o, RibbonPropertyChangedEventArgs args) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (args.NewValue != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Windows.MessageBox.<span class="hljs-keyword"><span class="hljs-keyword">Show</span></span>((args.NewValue <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> RibbonButton).Text); } } //  Initialize()  Terminate() ,    IExtensionApplication <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> Initialize() { } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> Terminate() { } } //    <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> CommandHandler_Button1 : <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Windows.<span class="hljs-keyword"><span class="hljs-keyword">Input</span></span>.ICommand { <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> event EventHandler CanExecuteChanged; <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">bool</span></span> CanExecute(<span class="hljs-keyword"><span class="hljs-keyword">object</span></span> param) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Execute</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">object</span></span> parameter) { <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Windows.MessageBox.<span class="hljs-keyword"><span class="hljs-keyword">Show</span></span>("Habr!"); } } }</code> </pre></div></div><br>  Result: <br><img src="https://habrastorage.org/files/8ac/455/661/8ac45566168b413cb48f7f2ce8591f57.PNG"><br><br><h4>  7. Customize the appearance of controls </h4><br>  The classes available in AutoCAD .NET API, in my opinion, do not have the widest possibilities for customizing their appearance.  However, basic things are definitely there. <br><br>  First, the controls can be placed under each other - this is especially convenient if ‚Äúnarrow‚Äù elements like drop-down lists are used. <br><br>  Secondly, each control has properties that allow you to change its appearance.  For example, for the drop-down list, you can set the title and width, for the button - the size (large or small) and signature.  In addition, you can add tooltips (in the example it is added for the third button). <br><br><div class="spoiler">  <b class="spoiler_title">Code (note that a reference to the assembly and the System.Drawing namespace has been added):</b> <div class="spoiler_text"><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Drawing; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Autodesk.AutoCAD.Runtime; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Autodesk.Windows; namespace MyAutoCADDll { <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> Commands : IExtensionApplication { //        AutoCAD  "TestCommand" [CommandMethod("TestCommand")] <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> MyCommand() { //      (     ) Bitmap bmp = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Bitmap(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); bmp.SetPixel(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, Color.Aquamarine); bmp = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Bitmap(bmp, <span class="hljs-number"><span class="hljs-number">1024</span></span>, <span class="hljs-number"><span class="hljs-number">1024</span></span>); IntPtr hBitmap = bmp.GetHbitmap(); <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Windows.Media.Imaging.BitmapSource bs = <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Windows.Interop.Imaging.CreateBitmapSourceFromHBitmap( hBitmap, IntPtr.Zero, <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Windows.Int32Rect.Empty, <span class="hljs-keyword"><span class="hljs-keyword">System</span></span>.Windows.Media.Imaging.BitmapSizeOptions.FromEmptyOptions()); //    Autodesk.Windows.RibbonCombo comboBox1 = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> RibbonCombo(); comboBox1.Id = "_combobox1"; comboBox1.Width = <span class="hljs-number"><span class="hljs-number">200</span></span>; comboBox1.Text = " 1"; comboBox1.ShowText = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; Autodesk.Windows.RibbonCombo comboBox2 = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> RibbonCombo(); comboBox2.Id = "_combobox2"; comboBox2.Width = <span class="hljs-number"><span class="hljs-number">200</span></span>; comboBox2.Image = bs; comboBox2.ShowImage = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; //   Autodesk.Windows.RibbonButton button1 = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Autodesk.Windows.RibbonButton(); button1.Id = "_button1"; Autodesk.Windows.RibbonButton button2 = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Autodesk.Windows.RibbonButton(); button2.Id = "_button2"; //   ,            Autodesk.Windows.RibbonRowPanel RowPanel1 = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Autodesk.Windows.RibbonRowPanel(); Autodesk.Windows.RibbonRowPanel RowPanel2 = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Autodesk.Windows.RibbonRowPanel(); //         RowPanel1.Items.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(comboBox1); RowPanel1.Items.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> RibbonRowBreak()); RowPanel1.Items.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(comboBox2); RowPanel2.Items.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(button1); RowPanel2.Items.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> RibbonRowBreak()); RowPanel2.Items.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(button2); //     Autodesk.Windows.RibbonButton button3 = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Autodesk.Windows.RibbonButton(); button3.Id = "_button3"; button3.IsToolTipEnabled = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; button3.ToolTip = "  "; button3.Size = Autodesk.Windows.RibbonItemSize.<span class="hljs-keyword"><span class="hljs-keyword">Large</span></span>; button3.LargeImage = bs; Autodesk.Windows.RibbonButton button4 = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Autodesk.Windows.RibbonButton(); button4.Id = "_button4"; button4.Text = "^___^"; button4.ShowText = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; button4.Size = Autodesk.Windows.RibbonItemSize.<span class="hljs-keyword"><span class="hljs-keyword">Large</span></span>; button4.LargeImage = bs; //     Autodesk.Windows.RibbonPanelSource rbPanelSource1 = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Autodesk.Windows.RibbonPanelSource(); rbPanelSource1.Title = "  "; Autodesk.Windows.RibbonPanelSource rbPanelSource2 = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Autodesk.Windows.RibbonPanelSource(); rbPanelSource2.Title = "  "; //      rbPanelSource1.Items.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(RowPanel1); rbPanelSource1.Items.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(RowPanel2); rbPanelSource1.Items.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> RibbonSeparator()); rbPanelSource1.Items.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(button3); rbPanelSource2.Items.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(button4); //   RibbonPanel rbPanel1 = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> RibbonPanel(); RibbonPanel rbPanel2 = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> RibbonPanel(); //       rbPanel1.Source = rbPanelSource1; rbPanel2.Source = rbPanelSource2; //   RibbonTab rbTab = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> RibbonTab(); rbTab.Title = " "; rbTab.Id = "HabrRibbon"; //     rbTab.Panels.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(rbPanel1); rbTab.Panels.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(rbPanel2); //     AutoCAD Autodesk.Windows.RibbonControl rbCtrl = ComponentManager.Ribbon; //     rbCtrl.Tabs.<span class="hljs-keyword"><span class="hljs-keyword">Add</span></span>(rbTab); //     ("") rbTab.IsActive = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } //  Initialize()  Terminate() ,    IExtensionApplication <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> Initialize() { } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> Terminate() { } } }</code> </pre></div></div><br>  Result: <br><img src="https://habrastorage.org/files/314/6ce/165/3146ce16530f418d9ff5378cbe4f97ed.PNG"><br><br><img src="https://habrastorage.org/files/683/c6a/49d/683c6a49d960455d950e46c50a5373bc.PNG"><br><br>  This article comes to an end.  Next time I will write about working with layers and simple graphic objects. </div><p>Source: <a href="https://habr.com/ru/post/243305/">https://habr.com/ru/post/243305/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../243285/index.html">Likbez: image resize methods</a></li>
<li><a href="../243291/index.html">Java: IP telephony from scratch</a></li>
<li><a href="../243295/index.html">ReactOS 0.3.17 - ‚Äúnumerological‚Äù release of the operating system</a></li>
<li><a href="../243297/index.html">My first Eclipse plugin</a></li>
<li><a href="../243301/index.html">Loading Eloquent links using left join instead of additional requests</a></li>
<li><a href="../243307/index.html">Tips for a novice entrepreneur from Oliver Amberton</a></li>
<li><a href="../243309/index.html">The hacker group Sednit specializes in attacks against isolated air-gapped networks.</a></li>
<li><a href="../243311/index.html">Expressive javascript: javascript and browser</a></li>
<li><a href="../243313/index.html">7 reasons why Dropbox grows to $ 4 billion</a></li>
<li><a href="../243315/index.html">Stability as a result</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>