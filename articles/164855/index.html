<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Are they encrypted? We take out baytkod from JVM</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, Habr. I write in the Java language, I mainly work with the servers of MMORPG games. Server "assemblies" are produced by many teams working in this...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Are they encrypted? We take out baytkod from JVM</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/08b/38d/3fb/08b38d3fb2ca96bf90379e55d0e57ddf.png"><br><br>  Hi, Habr.  I write in the Java language, I mainly work with the servers of MMORPG games.  Server "assemblies" are produced by many teams working in this field.  Some are paid, and some even distribute their creations for free.  For some time now, the practice has become popular besides licensing systems to encrypt your product.  And, as usual, it all started with this, I was interested in (purely academic), how can this be circumvented. <br><habracut><br><h3>  How does this happen </h3><br>  To encrypt the server core (jar), the RC4 streaming algorithm was used, processing the already compiled classes in such a way that only the method body would remain encrypted.  Trying to decompile the class, we received either an unexpected completion of the decompiler itself, or this: <br><br><img src="http://screenshot.ru/screens/05.01.13/23:21:43_c19ea9ae.png" alt="image">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Decryption of all this stuff is done with the help of the native library.  (Yes, cross-platform. But the product is most often used on * nix systems, compiled for win and nix, this is enough).  In the classifier, the defineClass method is overridden, it calls the defineClass method in the native library via JNI, the bytecode is passed to it, the decryption takes place, and then the finished class is sent to the JVM.  There were several solutions: analyzing the library and then hooking it, recompiling Open-JDK and dragging classes with it.  I asked Google if there were any other ways to pull out the decoded bytecode directly from the JVM.  As it turned out, there is, and this is where the wonderful java.lang.instrument.Instrumentation class will help us, which is passed when the agent‚Äôs attachment has a useful method retransformClasses (Class [] classes).  What is he doing?  And what we want.  Or rather, what the implementation of the ClassFileTransformer interface will want.  Here is the only method that should implement the class that will implement this interface: <br><br><pre><code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] transform(ClassLoader loader, String className, Class&lt;?&gt; classBeingRedefined, ProtectionDomain protectionDomain, <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] classfileBuffer) <span class="hljs-keyword"><span class="hljs-keyword">throws</span></span> IllegalClassFormatException</code> </pre> <br><br>  Eureka!  byte [] classfileBuffer - what you need there!  This is already decrypted bytecode class, we can only save it. <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { className = className.replace(<span class="hljs-string"><span class="hljs-string">"/"</span></span>, File.separator); StringBuilder buf = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(); buf.append(dumpDir); buf.append(File.separatorChar); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> index = className.lastIndexOf(File.separatorChar); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (index != -<span class="hljs-number"><span class="hljs-number">1</span></span>) buf.append(className.substring(<span class="hljs-number"><span class="hljs-number">0</span></span>, index)); String dir = buf.toString(); <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> File(dir).mkdirs(); String fileName = dumpDir + File.separator + className + <span class="hljs-string"><span class="hljs-string">".class"</span></span>; FileOutputStream fos = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileOutputStream(fileName); fos.write(classBuf); fos.close(); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception exp) { exp.printStackTrace(); }</code> </pre><br><br>  Create an object of the transformer class and add it to our Instrumentation at the time of the agent's attachment: <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">agentmain</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String agentArgs, Instrumentation inst)</span></span></span><span class="hljs-function"> </span></span>{ inst.addTransformer(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ClassFileTransformerImpl(), <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); inst.retransformClasses(inst.getAllLoadedClasses()); <span class="hljs-comment"><span class="hljs-comment">//       }</span></span></code> </pre> <br><br>  We have found the leverage, now we need to put everything together and connect to our project.  We will load the agent into the target application.  It was possible to go a simple way and simply indicate the pid of our application for the attacker, but we want beauty and frustration!  Well, let's try to write a program with a GUI that will do everything for us. <br><br><h3>  To the point! </h3><br>  First, we want to select an application from the list of already running ones, so as not to figure out the pid we need using the standard jdk toolkit. <br><br>  At first, to get all the pids of running jvm, I used the com.sun.tools.attach.VirtualMachine.list () method, which returned a list of running jvm handles.  The method was written into an infinite loop in a separate thread and updated our GUI, displaying the running JVM and process id.  But this method is terrible, just shamelessly devoured memory.  Yes, and an illogical way, there must also be another method, like with, say, profilers.  And I turned to the standard profiler, which is included in the jdk kit, studied it, and found a curious fox box.  It was much more practical to use it, and this is what happened. <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sun.jvmstat.monitor.MonitoredHost; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sun.jvmstat.monitor.event.HostEvent; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sun.jvmstat.monitor.event.HostListener; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sun.jvmstat.monitor.event.VmStatusChangeEvent; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">VMUpdater</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> MonitoredHost MH; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">VMUpdater</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { MH = MonitoredHost.getMonitoredHost(<span class="hljs-string"><span class="hljs-string">"localhost"</span></span>); MH.addHostListener(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HostListenerAction()); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception e) {} } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HostListenerAction</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HostListener</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">vmStatusChanged</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(VmStatusChangeEvent vmStatusChangeEvent)</span></span></span><span class="hljs-function"> </span></span>{} <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">disconnected</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(HostEvent hostEvent)</span></span></span><span class="hljs-function"> </span></span>{} } }</code> </pre><br><br>  In the vmStatusChanged method, we implement a GUI update. <br><br>  So, the goal is selected, we load the agent. <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String PATH = getClass().getProtectionDomain().getCodeSource().getLocation().getPath(); <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> VirtualMachine vm; <span class="hljs-comment"><span class="hljs-comment">//   pid ,    GUI public static void attach(int pid) throws Exception { vm = VirtualMachine.attach(String.valueOf(pid)); vm.loadAgent(PATH); //  jar c  (  ,  ) AttachedGUI.getInstance().draw(); // GUI }</span></span></code> </pre><br><br>  What do we need?  Ideally, get an exact copy of the jar.  We carry out.  In the GUI, we specify the jar, which is used in the application and pass this information to the agent, who by then had already provided us with his own communication channel - RMI. <br>  Having received the jar path, we are looking for it, parse the insides, memorize its classes.  But not all classes are loaded into memory, you say!  And you will be absolutely right.  We implement our own classifier, which will forcefully load all the classes from jar and give them to our transformer, which will safely put everything in a handful. <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.BufferedInputStream; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.File; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.FileOutputStream; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.IOException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.Enumeration; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.Hashtable; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.jar.JarEntry; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.jar.JarFile; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">JarClassLoader</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ClassLoader</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Hashtable&lt;String, Class&lt;?&gt;&gt; classes = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Hashtable&lt;String, Class&lt;?&gt;&gt;(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">JarClassLoader</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ClassLoader parent)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(parent); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">synchronized</span></span> Class&lt;?&gt; loadClass(String className, <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> resolve) <span class="hljs-keyword"><span class="hljs-keyword">throws</span></span> ClassNotFoundException { Class&lt;?&gt; result = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; result = classes.get(className); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(result == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) result = <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.findSystemClass(className); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(result == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) result = <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.loadClass(className); classes.put(className, result); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> Hashtable&lt;String, Class&lt;?&gt;&gt; loadJar(String jarPath, String dumpPath) <span class="hljs-keyword"><span class="hljs-keyword">throws</span></span> IOException, ClassNotFoundException { classes.clear(); JarFile jar = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> JarFile(jarPath); Enumeration&lt;JarEntry&gt; entries = jar.entries(); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (entries.hasMoreElements()) { String name = entries.nextElement().getName(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(name.endsWith(<span class="hljs-string"><span class="hljs-string">".class"</span></span>)) { String className = name; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(name.contains(<span class="hljs-string"><span class="hljs-string">"."</span></span>)) className = name.substring(<span class="hljs-number"><span class="hljs-number">0</span></span>, name.lastIndexOf(<span class="hljs-string"><span class="hljs-string">"."</span></span>)).replace(<span class="hljs-string"><span class="hljs-string">"/"</span></span>, <span class="hljs-string"><span class="hljs-string">"."</span></span>); Class&lt;?&gt; c = loadClass(className); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(c != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) classes.put(className, c); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(jar.getEntry(name).isDirectory()) { name = slash2sep(name); <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> File(dumpPath + File.separator + name).mkdirs(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { FileOutputStream fos = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FileOutputStream(dumpPath + File.separator + name); BufferedInputStream bis = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BufferedInputStream(jar.getInputStream(jar.getEntry(name))); <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] data = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>) jar.getEntry(name).getSize()]; bis.read(data); fos.write(data); bis.close(); fos.close(); } } jar.close(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> classes; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">slash2sep</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String src)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i; <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>[] chDst = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">char</span></span>[src.length()]; String dst; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; src.length(); i++) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(src.charAt(i) == <span class="hljs-string"><span class="hljs-string">'/'</span></span>) chDst[i] = File.separatorChar; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> chDst[i] = src.charAt(i); } dst = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> String(chDst); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> dst; } }</code> </pre><br><br>  If we ask, it will archive (all settings are specified in gui, parameters are transferred via rmi). <br><br>  And yes, to resolve all this disgrace, we need to correct the manifest (even if our agent's main class is called ClassDumperAgent): <br><br><pre> <code class="java hljs">Premain-Class: ClassDumperAgent Agent-Class: ClassDumperAgent Can-Redefine-Classes: <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> Can-Retransform-Classes: <span class="hljs-keyword"><span class="hljs-keyword">true</span></span></code> </pre> <br><br>  Well, and finally, a couple of screenshots.  The ability to pull not all jar was added, but packages and a couple of nice chips, the implementation of which you can see in the source code. <br><br><img src="http://screenshot.ru/screens/06.01.13/02:05:05_aab91b69.png" alt="image"><br><img src="http://screenshot.ru/screens/06.01.13/02:04:19_40bc35dc.png" alt="image"><br><br>  Link to the <a href="https://bitbucket.org/ioexception/class-dumper/src">source</a> . </habracut></div><p>Source: <a href="https://habr.com/ru/post/164855/">https://habr.com/ru/post/164855/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../164837/index.html">Compressor head</a></li>
<li><a href="../164843/index.html">Cheat Sheet by Inkscape Filters</a></li>
<li><a href="../164845/index.html">The fan-cybersquatter will give the player a name domain if he fulfills his wish</a></li>
<li><a href="../164851/index.html">Calling an Alertdialog from a widget</a></li>
<li><a href="../164853/index.html">Programming for Android for beginners. Part 1</a></li>
<li><a href="../164857/index.html">Building a torus with WPF</a></li>
<li><a href="../164859/index.html">Problems with the form and content of the list of sites Roskomnadzor</a></li>
<li><a href="../164865/index.html">Creating an encrypted USB flash drive with Linux OS</a></li>
<li><a href="../164867/index.html">Development of power supply for energy-intensive portable device</a></li>
<li><a href="../164869/index.html">How to make friends Django and Sphinx?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>