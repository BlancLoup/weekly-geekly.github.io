<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Hesperbot - a new banking trojan discovered in-the-wild</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In mid-August, we discovered a malware distribution campaign that targeted the Czech Republic. She caught our attention because the malware files were...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Hesperbot - a new banking trojan discovered in-the-wild</h1><div class="post__text post__text-html js-mediator-article">  In mid-August, we discovered a malware distribution campaign that targeted the Czech Republic.  She caught our attention because the malware files were distributed via URLs that are very similar to the addresses of the Czech Post Office.  Further analysis of the files showed that we are dealing with banking malware, which is similar in its capabilities to Zeus and SpyEye, but differs from already known families in the technical implementation of its capabilities. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7f1/ac9/0bf/7f1ac90bf3e172c911742560ed811e3f.jpg"><br><br>  The new Trojan is called <b>Win32 / Spy.Hesperbot</b> and is a powerful tool to steal online banking data.  Hesperbot has the following features: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  interception of network traffic and HTML injections; </li><li>  keylogger; </li><li>  creating screenshots of the desktop; </li><li>  video capture; </li><li>  creating a remote proxy connection; </li><li>  create hidden VNC server. </li></ul><br><a name="habracut"></a>  In our collection, we discovered several earlier versions of this Trojan program, which we discovered as <b>Win32 / Agent.UXO</b> . <br><br>  The purpose of the attackers is to obtain the credentials that users use to log into their online banking system account.  In addition, the malicious code convinces the user to install their mobile component on a phone running Symbian, Blackberry or Android. <br><br>  The Czech campaign to spread this malware began on August 8, 2013. To do this, the attackers registered the domain ceskaposta.net, which resembles the website of the Czech Postal Service ceskaposta.cz. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/79d/67d/49d/79d67d49dab23ea8b3f44a1df9888f36.png"><br>  Fig.  Date the domain was created. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fc7/e1a/5a1/fc7e1a5a1c2ef7ea6e9ad7ac5bd7c20d.png"><br>  Fig.  The date the file was compiled. <br><br>  The domain was registered on August 7 of this year, and the first samples of Hesperbot, which were distributed in the Czech Republic, were compiled on the morning of August 8 and later captured by our LiveGrid system. <br><br>  In addition to the URL, which is very similar to the postal service of the Czech Republic, the attackers used the thematic content of the letters in order to be more convincing.  The letter contained information of the postal service on the status of the allegedly sent letter.  The names of the files themselves had corresponding names, for example, zasilka.pdf.exe.  The word "zasilka" is translated from Czech as "letter."  In the message, the attackers used ceskaposta.net address, disguising it as a legitimate ceskaposta.cz. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c6d/3a5/235/c6d3a5235eb4d63e50e5ad6b3f8848a0.png"><br>  Fig.  The message of the Czech postal service about the scam. <br><br>  Despite the fact that our attention was attracted by the Czech campaign, the country most affected by the activities of this banking Trojan was Turkey.  Hesperbot specimens from Turkey were compiled before August 8th.  The last peak of botnet activity was detected in Turkey back in July 2013, besides the older samples are dated April 2013. Some samples of the Trojan program send debug information to the command C &amp; C server, thus the attackers run through its intermediate versions and test their performance. <br><br>  The campaign, which was carried out by attackers in Turkey, has a similar nature of the Czech attack.  The attackers used a similar approach when sending emails that they sent to potential victims.  We later discovered that the same approach was used against targeted attacks on users in Portugal and England. <br><br>  In the course of our research, we stumbled upon an additional component that is used by Win32 / Spy.Hesperbot.  This is a malicious code <b>Win32 / Spy.Agent.OEC</b> , which is responsible for collecting email addresses on the infected machine and sending them to a remote server.  It is possible that the collected email addresses were then used in malware distribution campaigns. <br><br>  The configuration files used by the malware when intercepting HTTP traffic tell it which online banking sites should be intercepted.  Various botnets specialize in interception of certain sites.  Below are the addresses of websites of online banking systems that are tracking malicious code. <br><br>  Czech <br><img src="https://habrastorage.org/getpro/habr/post_images/6bf/185/790/6bf1857906ae04b47b4b82bb58acd693.png"><br><br>  Turkey <br><img src="https://habrastorage.org/getpro/habr/post_images/e05/b1b/2ad/e05b1b2add9392e392d7609ce5aded19.png"><br><br>  Portugal <br><img src="https://habrastorage.org/getpro/habr/post_images/027/c4f/073/027c4f0739608d812d5f66dfc8bd597e.png"><br><br>  In the case of Turkish and Portuguese botnets, configuration files include information about web izhektah, ie, portions of HTML-code that malicious code will insert into web pages.  No such code was found in the Czech configuration file.  This suggests that attackers could use simple keylogger functionality for this purpose. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/243/5a8/f2c/2435a8f2c62ce6598b6fedb64bd29e5c.png"><br><br>  With the use of the ESET LiveGrid telemetry system, hundreds of cases of user compromise in Turkey, the Czech Republic, the United Kingdom and Portugal have been recorded. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1a3/639/037/1a36390373bcf8450037ead882eb912f.png"></div><p>Source: <a href="https://habr.com/ru/post/192684/">https://habr.com/ru/post/192684/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../192666/index.html">Intel now has a multi-frequency LTE chip</a></li>
<li><a href="../192668/index.html">Cisco IOS Authentication</a></li>
<li><a href="../192670/index.html">And again the old man threw a net ... (parsing habr, continued)</a></li>
<li><a href="../192672/index.html">Started pre-order Tessel</a></li>
<li><a href="../192676/index.html">Unification of interfaces: the experience of e-commerce projects</a></li>
<li><a href="../192686/index.html">Expiration of certificates on Windows XP and Office 2003 as the reason for the future growth of sales of Microsoft products?</a></li>
<li><a href="../192690/index.html">Features of the calibrator i1 Display Pro</a></li>
<li><a href="../192698/index.html">Another plasmoid creation guide: configuration, events and notifications</a></li>
<li><a href="../192700/index.html">Lenovo's new products at IFA 2013</a></li>
<li><a href="../192704/index.html">How was the competition flying robots: flights and errors</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>