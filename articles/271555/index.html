<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Machine learning as a method of analyzing the microstructure of the market and its application in high-frequency trading</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article, we will look at how to use machine learning in high-frequency trading (HFT) and analyzing microstructural data. Machine learning is a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Machine learning as a method of analyzing the microstructure of the market and its application in high-frequency trading</h1><div class="post__text post__text-html js-mediator-article"> <a href="http://habrahabr.ru/company/itinvest/blog/271555/"><img src="https://habrastorage.org/files/69c/f07/334/69cf073343e34df8957c7111eea62a4c.png"></a> <br><br>  In this article, we will look at how to use machine learning in high-frequency trading (HFT) and analyzing microstructural data.  Machine learning is a wonderful section of computer science that uses models and methods from statistics, theory of algorithms, the theory of computational complexity, artificial intelligence, control theory, and a huge number of other disciplines.  The main object of the study of machine learning are effective algorithms that allow you to create good predictive models based on large data sets - this is why it is so well suited for solving high-frequency trading problems: making deals and calculating the alpha indicator. <br><a name="habracut"></a><br>  Since the phenomenon of ‚Äúhigh-frequency trading‚Äù appeared quite recently, there are few works devoted to the use of machine learning in this field.  However, we will consider three areas of its applicability: <br><br><ol><li>  Optimization of the process of making deals using reinforced learning; </li><li>  Prediction of price changes based on the state of the stock exchange; </li><li>  Optimization of the transaction process in dark pools based on the study of incomplete data. </li></ol><br><h4>  Optimizing the process of making deals using reinforced learning </h4><br>  Let's consider the possibility of using machine learning to solve the most fundamental algorithmic trading problem - optimizing the process of concluding transactions.  In the simplest case, the problem is determined by the stock of shares, say, AAPL, their number V, and the time or number of steps T. Thus, we must buy a certain number of shares V in T steps, minimizing the cost of the purchase. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The basic pricing algorithms, the weighted average volume, compare their current state (v; t) with the volume of shares, which must be acquired by step t, based on historical indicators of the stake of interest to us (the values ‚Äã‚Äãof the indicators may vary depending on the time of day and time of year ).  If the indicator v tells us that we are behind the schedule, then we should start trading more aggressively and more often buy stocks at the price of the seller.  If we are ahead of the schedule, then we can trade more passively, waiting for the price to improve.  Such comparisons are carried out continuously or at certain intervals, allowing us to adjust to the schedule and current conditions on the exchange. <br><br>  Training with reinforcements takes its beginning deep in control theory and is a machine learning subsection developed specifically for studying dynamic instructions.  We omit the technical details, however, we describe the main steps: <br><br><ol><li>  Determining the state of the environment (usually limited), whose elements are changing conditions, depending on which procedure is chosen.  In our case, the medium has two variables (v; t), as well as other components and features that describe the state of the stock exchange. </li><li>  Defining a set of actions for each state.  In our case, we will set a limit on orders for the remaining volume of shares (variable price). </li><li>  Definition of the model of the impact that our decisions have in the form of the probability of execution under certain conditions, which is formed on the basis of historical data. </li><li>  Determination of the cost function, reflecting the expected or average income when making a certain decision at a given point in time. </li><li>  Algorithms for the study of optimal rules - the transition from states to actions - minimizing the empirical value of shares (the cost of their purchase) on the basis of training data. </li><li>  Verification of the studied sequence of actions by assessing its performance outside the sample. </li></ol><br>  The potential of such a method can be observed in graphs (Figure 1).  The graph compares the performance of a one-time strategy and algorithms studied using reinforcement training.  One-time strategies at the beginning of the trading period fix the size of the limit of orders at a certain value p for the entire target volume V and do not change it throughout all T steps.  At the end of the trading period, if the entire volume V was not purchased, the market order is given on condition that the target volume is reached.  To normalize price differences for all blocks of shares, we measure performance by estimating the difference between the average amount paid (per share) and the average point of the spread at the beginning of the trading period - the smaller it is (the higher the average point of the spread), the better. <br><br><img src="https://habrastorage.org/files/7f0/390/d39/7f0390d3941d4fd18c6a3754e3402215.png"><br><br>  <i>Figure 1 - One-time method performance on the test set (black left column) and learning performance with reinforcement (gray and white columns) on AMZN, NVDA and QCOM shares.</i>  <i>The x-axis shows the target volume of shares and the period;</i>  <i>the target volume is divided into I levels, and the period is divided into T discrete steps, uniformly distributed in time</i> <br><br>  So far, we practically did not use microstructural information and did not reconstruct the stock exchange glass - we only determined the purchase price and estimated its impact on the quotes glass.  Machine learning allows you to improve performance if you pass more information to the algorithm.  What variables related to the stock exchange can we use?  Here are a few of them: <br><br><ol><li>  Bid-ask spread is a value that reflects the difference between the price of the buyer (bid) and the price of the seller (ask) in the current stock exchange; </li><li>  The imbalance of bid / ask volumes is an amount equal to the number of purchased shares minus sold shares in current stock markets; </li><li>  The transaction volume is a value that describes the number of shares purchased in the last 15 seconds, minus the number of shares sold during the same time period; </li><li>  The cost of executing a market order at the moment is the price we pay for the purchase of the remaining share of shares by placing a market order. </li></ol><br>  We conducted a series of similar experiments in our initial state (v; t), using the characteristics of the stock exchange described above.  The results obtained are summarized in table 1. <br><br>  <i>Table 1 - Reduced distribution costs, with the addition of new features</i> <br><br><table><tbody><tr><th>  Signs of </th><th>  Reduced handling costs </th></tr><tr><td>  Bid-ask spread </td><td>  7.97% </td></tr><tr><td>  Imbalance bid / ask <br>  volumes </td><td>  0.13% </td></tr><tr><td>  Volume <br>  transactions </td><td>  2.81% </td></tr><tr><td>  Cost of Market Order Execution <br>  currently </td><td>  4.26% </td></tr><tr><td>  All signs immediately </td><td>  12.85% </td></tr></tbody></table><br>  Three of the four signs resulted in significant improvements;  imbalance bid / ask volumes had the least impact.  The last row of the table reflects the increase in performance when using all signs at the same time - it is almost 13%. <br><br><h4>  Prediction of price changes based on the stock market state </h4><br>  It is worth noting that in the previous section we did not take into account many signs directly affecting the recent directional movements in the price of execution, which may be very important.  Therefore, in the following experiments we used: <br><br><ol><li>  Bid-ask spread - used in the previous paragraph; </li><li>  Price is a sign that reflects recent directional movements in execution prices; </li><li>  The smart price is the average between the bid price and the bid price, weighted according to the inverse of their volume; </li><li>  A trading indicator is a sign indicating how often buyers and sellers ‚Äúcrossed the spread‚Äù; </li><li>  Imbalance bid / ask volumes - used in the previous paragraph; </li><li>  Transaction amount - used in the previous paragraph. </li></ol><br>  In the first series of experiments, a short ten-second time interval was considered.  It is important to note that buying or selling at an average price assumes that one of the two actions is always profitable: buying and then selling if the average price has increased, and vice versa if the price has fallen.  In the real world, this approach does not work, so we will describe the methodology as follows: <br><br><ol><li>  For each of the 19 items, the stock exchange was restructured based on historical data; </li><li>  For each trading opportunity, the current state of the stock exchange and the profitability of both actions (buy / sell or sell / buy) were evaluated.  The results were recorded in the table of the stock exchange simulator, where the average point displacement was calculated; </li><li>  For each item, 2008 data was used as training data.  A function was calculated that determines which of the actions for a given ~ x state leads to the greatest performance increase; </li><li>  Testing the principles studied for each item was conducted using the 2009 data set.  For each state ~ x, the corresponding action learned by the algorithm was applied, after which the performance was calculated. </li></ol><br>  In Figure 2, for each of the 19 rules and each of the six signs, there is a bar showing the relationship between the value of the trait and the studied action.  We agreed that the value +1 means buy and sell, and -1 means buy and sell.  As in the last section, we see that the numerical values ‚Äã‚Äãof the correlation strongly depend on the chosen name. <br><br><img src="https://habrastorage.org/files/69c/f07/334/69cf073343e34df8957c7111eea62a4c.png"><br><br>  <i>Figure 2 - Correlation between the values ‚Äã‚Äãof attributes and the measures studied.</i>  <i>Here, 1 is the bid-ask spread, 2 is the price, 3 is the ‚Äúsmart‚Äù price, 4 is the trade indicator, 5 is the bid / ask volume imbalance, 6 is the transaction volume</i> <br><br>  The image shows that we studied the strategies based on the moment: for each of the signs with directional information (price, smart price, trading indicator, bid / ask volume imbalance and transaction volume), high values ‚Äã‚Äãcorrespond to a higher purchase frequency in studied rules. <br><br><img src="https://habrastorage.org/files/f13/545/6a7/f135456a729940279bd056a049c440fe.png"><br><br>  <i>Figure 3 - graphics for each of the six signs</i> <br><br>  Figure 3 shows the graphs for each of the six features.  The red bars are the same everywhere and show the profitability of the test set of rules learned for each of the 19 items, where all 6 signs were used.  The blue bars show the profitability of the test set of rules learned for each of the 19 items, but using only one feature.  From here we can draw conclusions: <br><br><ol><li>  The most advantageous to use immediately 6 signs; </li><li>  The ‚Äúsmart‚Äù price makes the greatest contribution to profitability.  It often happens that its use leads to a better result than using all six signs; </li><li>  Spread is the most useless sign, but for individual items it turns out to be the most profitable. </li></ol><br><h4>  Machine learning and smart systems routing applications in dark pools </h4><br>  The methodology of machine learning is applicable to newly-born areas that have less rich data volumes and new, unexplored mechanisms.  Let's look at the application of machine learning to solve the problem of routing applications in dark pools. <br><br>  Dark pools were initially viewed as locations for transactions where liquidity matters most.  With sufficient liquidity, you can easily pay the "current price". <br><br>  We assume that we have n separate dark pools available.  These pools are able to provide different liquidity profiles for a certain block of shares - for example, in one pool it is better to quickly carry out small orders, and the other brings greater profitability from fulfilling large orders. <br><br>  We assume that is a probability distribution describing the range of values ‚Äã‚Äãwith non-negative integers.  We assume that when confirming an order for shares for pool i, a random variable is chosen on the basis.  represents stocks available on the other side of the market (stocks available for purchase, provided that we sell, or for sale if we buy) at the time of confirmation of the order.  The problem of routing applications in dark pools can be formalized as follows: we have a given amount of V shares that we want to buy;  How do we divide V into subsets for n dark pools so that, while maximizing the number of shares purchased? <br><br>  Figure 4 shows what the real distribution of liquidity looks like.  Shown here are the subsets and data used to conduct DELL stock purchase and sale transactions in the American dark pool. <br><br><img src="https://habrastorage.org/files/387/467/fc4/387467fc4f8e4ffa844e51a64a01efeb.png"><br><br>  <i>Figure 4 - Distribution of liquidity for DELL shares</i> <br><br>  The problem of learning the intelligent application routing system arises because we do not have enough knowledge about the probability distribution - we must study approximations based on our own data on applications.  The details of the algorithm will remain outside the scope of this article, but, if we describe them in general terms, then: <br><br><ol><li>  The algorithm takes a certain approximation for each unknown liquidity distribution.  Prior to the algorithm, all approximations take default values. </li><li>  We use the Kaplan-Meier approximation, which estimates the similarity of closed data. </li><li>  For each V, the algorithm considers the distribution of approximations to be true and selects the placements according to the greedy algorithm applied to the approximations Pi. </li></ol><br>  With the receipt of fresh business data, you can update the approximate distributions and repeat the process for the next target volume of shares. <br><br><img src="https://habrastorage.org/files/d01/96f/146/d0196f14670d4acea2796d207a65b432.png"><br><br>  <i>Figure 5 - Performance curves of our learning algorithm (red) and simple adaptive heuristic algorithm (blue).</i>  <i>Black marks uniform placement, and green is perfect.</i> <br><br>  Some experimental estimates of the performance of the algorithm are presented in Figure 5. Here are simulations using incomplete operational data for US dark pools.  Each graph shows the performance change of our learning algorithm. <br><br><h4>  Conclusion </h4><br>  In this article, we introduced you to the possibilities of machine learning in the field of high-frequency trading and the microstructure of the market, as well as obstacles in its path.  We do not believe that machine learning should be used according to the ‚Äúblack box‚Äù principle or look for any ‚Äúamazing‚Äù trading strategies with it. <br><br>  In each of the cases examined, the learning outcome did not produce results radically different from the general concepts of the problems under consideration from the point of view of economics and the theory of markets - the point of using machine learning was to quantitatively optimize these qualitative strategies.  If this approach is applied carefully and in place, it can become a powerful and well-scalable tool that efficiently works with a huge amount of data currently available on the market microstructure. </div><p>Source: <a href="https://habr.com/ru/post/271555/">https://habr.com/ru/post/271555/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../271541/index.html">Tracking Notifications on Android 4.0-4.2</a></li>
<li><a href="../271543/index.html">Announcement of laboratory work on the development, testing and management of the life cycle of software for Visual Studio 2015</a></li>
<li><a href="../271545/index.html">Dinosaur Walking: How I Adapted a Web Application for IE 7</a></li>
<li><a href="../271547/index.html">Key Performance Indicator Analysis - Part 1</a></li>
<li><a href="../271549/index.html">Lock-free algorithms and stack implementation</a></li>
<li><a href="../271557/index.html">AndroCAD: Rise to Power. Electronics and Android</a></li>
<li><a href="../271559/index.html">Vector, open and easy to use: Inkscape 0.91</a></li>
<li><a href="../271561/index.html">How to make a website adaptive using MobilizeToday</a></li>
<li><a href="../271563/index.html">Neural network in 11 lines in Python</a></li>
<li><a href="../271565/index.html">Ruli24: perfect tuning for your company</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>