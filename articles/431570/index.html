<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Security Study of Parking Payment Systems</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article I want to talk about the security of automated parking payment systems. Approximately such as in this picture. 


 At the entrance is ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Security Study of Parking Payment Systems</h1><div class="post__text post__text-html js-mediator-article">  In this article I want to talk about the security of automated parking payment systems.  Approximately such as in this picture. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/pw/dg/zn/pwdgzn2hzdlicgac4kkt5t1bstw.jpeg" alt="image"></div><br>  At the entrance is issued a parking ticket, when leaving, he sticks back to the terminal.  Basically, coupons are of two types: paper with a bar code / QR code and plastic contactless cards, the latter will be discussed. <br><a name="habracut"></a><br>  As usual, I immediately want to make a reservation that all information is presented solely for informational purposes and does not carry the purpose of sponsoring terrorism and establishing world domination. <br><br>  Once, using the parking of one metropolitan shopping center, I, inspired by articles about <a href="https://habr.com/post/301832/">Troika</a> and <a href="https://habr.com/post/324040/">Plantain</a> , as well as out of pure curiosity, launched the <a href="https://play.google.com/store/apps/details%3Fid%3Dde.syss.MifareClassicTool">MifareClassicTool</a> application on <a href="https://play.google.com/store/apps/details%3Fid%3Dde.syss.MifareClassicTool">my</a> NFC-enabled <a href="https://play.google.com/store/apps/details%3Fid%3Dde.syss.MifareClassicTool">phone</a> and tried to read the card‚Äôs contents.  It would be logical to assume that the verification of the fact of payment is carried out online, and the card is used only as a user ID.  In this case, there would be nothing to do without access to the internal network, and this article simply would not exist, but the reality turned out to be more interesting.  Something like this appeared to my eyes: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div style="text-align:center;"><img src="https://habrastorage.org/webt/lz/ht/8p/lzht8pm7cw9ejyqy0gcqfq0f1sc.png"></div><br>  Screenshot slightly shortened for the convenience of readers.  The map is a Mifare Classic 1K, divided into 16 sectors.  In sectors 1-9 recorded some information and the keys to them are unknown.  The rest are empty and use the default keys.  Really curious.  Fortunately for us, the crypto1 proprietary encryption protocol used in these cards is well understood and has vulnerabilities. <br><br>  We need a laptop, a reader of contactless cards of the type ACR122U and an application <a href="https://github.com/nfc-tools/mfoc">mfoc</a> , which allows having only one key from any sector in a reasonable time to restore all the others.  We will skip the assembly step and adjust this good, let's get straight to the point.  Put the card on the reader, run the program, leave the laptop in the car and go shopping, because for this we came here.  An hour passed, all the keys were restored, try to read the card again. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/9m/d-/4z/9md-4zv-7xjtjnmkn0r36ntedao.png"></div><br>  It became even more curious, but so far it is not very clear what is written here.  We leave the parking lot and immediately check in again.  We already have the keys and you can immediately go over the comparison of dumps. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/4e/j7/yt/4ej7yt8ftwihhx1noe7meg-vh-4.png"></div><br>  There are not many differences, but what do they look like?  Yes, this is the time of entry into the BCD format, 11:25:47.  Next to it is the date 12/12/2018.  We change the date for a few days ago, go to the payment terminal and he happily reports that we owe him a lot of money.  We change the date back, set the current time and leave the parking for free. <br><br>  In principle, this could be stopped, but the love of research overpowers laziness, we go to another shopping center and repeat the operation there.  The keys are different, but the data format is similar.  Having visited several shopping centers and one station and having made several experiments it becomes clear what's what.  In the first sector, the validity period of the card is stored, in our example this is until 12/31/2050.  In the second - the time of entry, the time and amount of payment, the time until which exit is allowed.  The blocks of the third and subsequent sectors should be read as 4 numbers in little-endian.  Let's try to decrypt the data in our example. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/bk/sh/v1/bkshv1gbilxxlmxenib0is2aj2i.png"></div><br>  The blocks with the description of tariffs differ between parking lots, the first block of sector 3 is used as a heading, but its format remained unknown, it was not possible to find documentation in open access, and this is not so important anymore. <br><br>  Probably, it is necessary to draw some conclusions.  System developers could use online verification, could use Desfire / Ultralight C card types that do not have known vulnerabilities, but relied on the security of outdated technology.  On the other hand, this is not a bank card and the loss here is not significant, although the taxi drivers at the station will be happy. </div><p>Source: <a href="https://habr.com/ru/post/431570/">https://habr.com/ru/post/431570/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../431560/index.html">Access to SS7 signaling networks via radio subsystem - now it is possible</a></li>
<li><a href="../431562/index.html">How to taxi with legacy code when the project was needed for yesterday</a></li>
<li><a href="../431564/index.html">The greatest mistake in the history of physics</a></li>
<li><a href="../431566/index.html">MEMS accelerometers and gyroscopes - we understand the specification</a></li>
<li><a href="../431568/index.html">Fintech Digest: payment by phone number, ATMs are attacking again, institutionalization of the cryptosphere</a></li>
<li><a href="../431572/index.html">How to write functional requirements</a></li>
<li><a href="../431574/index.html">Neural Interfaces Today</a></li>
<li><a href="../431576/index.html">Background: Kepler Space Observatory - iron, communication with the Earth, software and work results</a></li>
<li><a href="../431582/index.html">The history of personal data protection: how did GDPR come about?</a></li>
<li><a href="../431584/index.html">Astronautics and testing: mix, but do not shake</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>