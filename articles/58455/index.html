<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Outlook: MS Exchange + Linux</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I want to talk about the future happiness for Linux users, in terms of supporting the native MS Exchange MAPI protocol, as well as what has already be...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Outlook: MS Exchange + Linux</h1><div class="post__text post__text-html js-mediator-article">  I want to talk about the future happiness for Linux users, in terms of supporting the native MS Exchange MAPI protocol, as well as what has already been implemented and with which you can already play. <br><br>  Many who tried to configure access to MS Exchange from Linux were probably always in their search for only one solution - Evolution + exchange plugin for it.  More curious.  they know HOW and with the help of which mother this support is realized.  And it always becomes sad, because Exchange is in many places, for example in the state.  bodies and ensures the joint work of people and Linux without the support of the Exchange access protocol, unfortunately, the road is closed there.  So it was before, but now ... <br><br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      There is a very good project, the name of which is openchange (http://openchange.org/).  According to the developers, this is the Open Source implementation of the MAPI protocol (http://ru.wikipedia.org/wiki/MAPI).  As Wikipedia says: MAPI is a program interface that works with e-mail in Microsoft Windows.  MAPI allows you to receive, read, create, send e-mail messages, attach files to them (or access attached files), etc. In addition, the protocol also provides features such as shared calendars.  contacts, shared directories, tasks, and notes.  In general, everything you need to work together. <br><br>  Until recently, for the most part, only Windows and MS Outlook users could use all this wealth.  But at the moment, Linux users have the first library that implements the mapi protocol itself (libmapi <a href="http://www.openchange.org/index.php%3Foption%3Dcom_content%26task%3Dview%26id%3D63%26Itemid%3D71">www.openchange.org/index.php?option=com_content&amp;task=view&amp;id=63&amp;Itemid=71</a> ), which is already available in many distributions, and secondly - a great KDE4, with its Akonadi.  In addition, Akonadi already has a resource, which is the interface between Akonadi and the libmapi library, already in kdepim (http://www.openchange.org/index.php?option=com_content&amp;task = view&amp;id=111&amp;Itemid=87).  There is only one catch - so far this resource is more a technological project than something completed and, as a result, is not yet available to users.  But what to do, if it really pushes?  As for me, for example, in the event of an acute production need =) <br><br>  Below is a small tutorial on "How to reach MS Exchange from under KDE4" =).  And if the assembly is not interested, you can immediately scroll through several of the following paragraphs and look at the result. <br><br>  First, let's define what we have.  We have, for example, as in my case, the Debian Lenny distribution, the KDE 4.2 window environment and libmapi 0.8 in the experimental repository.  What can we do about it?  To begin with, we will need to download the source code of libmapi, change them a bit, build packages from them and install them in the system.  To make it immediately clear why this is needed, I will say that kdepim uses C ++ wrapper over libmapi (as a set of headers), called libmapi ++.  In turn, the original sources of the library have these headers, but package builders, apparently deciding that for the time being, no one needs these headers to build the libmapi ++ - dev package.  Well, do it yourself. <br><br>  Create a directory in our home directory, for example ~ / kdepim / libmapi /: <br>  $ mkdir -p ~ / kdepim / libmapi / <br>  $ cd ~ / kdepim / libmapi / <br><br>  Now, add to our sources.list package source repository for debian and run sudo apt-get update.  For obvious reasons, this will not be described =) After that, being in the ~ / kdepim / libmapi / directory we execute the command <br>  $ apt-get source libmapi0 <br><br>  After that, we get three files and a directory with unpacked sources and a patch superimposed on them.  Go to the directory that appears, run dpkg-checkbuilddeps in it and install all the packages that are not enough to build, plus the libboost-dev package.  Attention: among other things, this package also requires the samba4-dev package, which in turn draws samba4 itself, and there is a possibility that the samba will simply stop working in the system. <br><br>  Next, we open the debian / rules file and comment on the line ‚Äúrm -rf $ (CURDIR) / debian / tmp / usr / include / libmapi ++‚Äù, and in the debian / control file, on the contrary, add a few new ones: <br>  Package: libmapi ++ - dev <br>  Section: libdevel <br>  Architecture: any <br>  Depends: libc6-dev, libmapi0 (= $ {binary: Version}), $ {misc: Depends} <br>  Description: Development files for the MAPI client library <br>  This library provides a MAPI protocol <br>  that is used by Microsoft Exchange and Outlook. <br>  . <br>  Received Received Mail <br>  enumerating the address book. <br>  . <br>  This package contains the development files. <br><br>  It remains only to assemble the library into packages using the dpkg-buildpackage -rfakeroot command.  True, in my case, there were several problems.  Firstly, in a samba, in some structures, the private field was suddenly changed to private_data and, therefore, we had to shamanize a bit more with the source code, and secondly, the samba headers are not where they are supposed to lie according to the same headers of other libraries.  that is, not in / usr / include, but hidden in /usr/include/samba-4.0, which creates some problems when compiling, when the title cannot be found by any means =).  By the way, all this is done only to build a new libmapi ++ - dev package containing a set of headers.  So if you are too lazy to compile the whole thing yourself, then you can pick up the finished package here: <a href="http://narod.ru/disk/8149428000/libmapi%252B%252B-dev_0.8-2_i386.deb.html">narod.ru/disk/8149428000/libmapi%2B%2B-dev_0.8-2_i386.deb.html</a> .  After downloading, install the package into the system and proceed to the next step - patching and assembling kdepim. <br><br>  Create another directory.  for example ~ / kdepim / kdepimOCresource / and move to it.  We execute apt-get source kdepim and get at our disposal the source code of all kdepim with patches from debian.  go to the source directory.  we install assembly dependences.  Then we go to the akonadi / resources directory and change the CMakeLists.txt file by typing in the line ‚Äúadd_subdirectory (openchange)‚Äù after the line ‚Äúadd_subdirectory (distlist)‚Äù, this is about 28 lines of the file.  Now open the debian / akonadi-kde.install file and add the lines to it: <br>  usr / bin / akonadi_oc_resource <br>  usr / share / akonadi / agents / ocresource.desktop <br><br>  In the file akonadi / resources / openchange / CMakeLists.txt, in the line ‚Äúset (CMAKE_CXX_FLAGS‚Äû $ {CMAKE_CXX_FLAGS} -I% {LIBMAPI_INCLUDE_DIRS} $ {KDE4_ENABLE_EXCEPTIONS} ‚Äù)‚Äù add "-lmapi". <br><br>  Finally, for everything to be human, let's add a new dependency for the akonadi-kde package to the control file.  Her name, of course, is libmapi0.  This is where the source change is complete, we start the build of binary packages and wait for its successful (hopefully) ending.  When everything is complete, you will need to install the akonadi-kde reassembled package into the system, after which a new one will appear in the list of its resources - OpenChange.  To do without rebuilding this package can also be downloaded here: <a href="http://narod.ru/disk/8149908000/akonadi-kde_4.2.2-1_i386.deb.html">narod.ru/disk/8149908000/akonadi-kde_4.2.2-1_i386.deb.html</a> .  The final touch is to create the directory ".openchange" in the user directory, otherwise the resource will always fall =) <br><br>  - end of assembly manual =) <br><br>  After all these ordeals, go to "System Settings -&gt; Configure Akonadi" and click on the "Add" button on the "Configure Akonadi sources" tab, OpenChange appears in the list of suggested resources, that is, exactly what we need =).  Select it, double click on it, create a new profile and make this profile the default.  After that, it will remain to run akonadiconsole via the console, go to the ‚ÄúResources‚Äù tab, click ‚ÄúSynchronize -&gt; Synchronize All‚Äù and go to the Browser tab, where you can already see that the folders are synchronized, everything works and is displayed ... But for now, without Cyrillic all this can fall at any time.  but none the less.  some progress is already visible and I would like to hope that by the release of kde 4.3 most of the errors will be corrected and the resource will be included in the distributive assemblies, one disturbs, the commits in its source files were quite long ... KDE / kdepim / akonadi / resources / openchange /) <br><br>  What else can you do?  So far, almost nothing, except maybe, try to start Kontact, which should certainly fall when trying to add a new Akonadi calendar =) In general, the developers have an excellent idea, the implementation at this stage is also not bad, although it is lame =) A lot of additional information can be find also on the links in the article, and especially on the resource <a href="http://www.openchange.org/">www.openchange.org</a> </div><p>Source: <a href="https://habr.com/ru/post/58455/">https://habr.com/ru/post/58455/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../58448/index.html">Anti-crisis measures. Sales increase</a></li>
<li><a href="../58449/index.html">Google social wikipoisk</a></li>
<li><a href="../58451/index.html">Taiwanese ISP will cut the channel P2P-users</a></li>
<li><a href="../58452/index.html">Published list of the most expensive brands in 2009</a></li>
<li><a href="../58454/index.html">Search and placement of vacancies for ruby-professionals</a></li>
<li><a href="../58456/index.html">Rifokib or aluminum accompaniment</a></li>
<li><a href="../58459/index.html">Infrastructure Support Tools for an Agile Java Project</a></li>
<li><a href="../58460/index.html">Staritsa</a></li>
<li><a href="../58461/index.html">Google has made its version of Digg-voting</a></li>
<li><a href="../58466/index.html">What size is your mouse?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>