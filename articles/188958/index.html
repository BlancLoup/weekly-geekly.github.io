<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Elliptical cryptography: theory</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi% username%! 
 Recently, a very controversial article titled ‚ÄúExperts call for preparation for crypto apocalypse‚Äù was published on Habr√© . Honestly,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Elliptical cryptography: theory</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/ef0/998/2a3/ef09982a31f43b7877a77784ded10711.jpg" align="left"><br>  Hi% username%! <br>  Recently, a very controversial article titled <a href="http://habrahabr.ru/post/188846/">‚ÄúExperts call for preparation for crypto apocalypse‚Äù</a> was published <a href="http://habrahabr.ru/post/188846/">on Habr√©</a> .  Honestly, I do not agree with the conclusions of the authors that the ‚Äúholtecco danger‚Äù, everyone will soon crack and buckwheat will rise in price.  However, I do not want to talk about it. <br>  In the comments to the article, I expressed the opinion that in some ways the speakers are right and it is high time to switch to elliptical cryptography.  Well, in fact, has anyone seen an ECDSA certificate on the Internet?  Although the standard is almost 13 years old, we continue to use the good old RSA in the old manner.  In general, I said this, and as it often happens, I wondered if it is necessary to switch to an ‚Äúelliptic‚Äù?  And what kind of animal is this elliptical cryptography?  Which has pros, cons, subtleties.  In a word, let's understand. <a name="habracut"></a><br><br><h4>  Elliptic curves </h4><br>  An elliptic curve is a set of points, described by the Weierstrass equation: <br><img src="https://habrastorage.org/getpro/habr/post_images/04d/94b/911/04d94b9114370a5c5fab166df84d765c.png"><br>  Typical options for graphs of elliptic curves you can see under the spoiler: <br><div class="spoiler">  <b class="spoiler_title">Charts (6 pieces)</b> <div class="spoiler_text"><img src="https://habrastorage.org/getpro/habr/post_images/518/1d7/35b/5181d735b48f91c10295318bc38615e2.png"></div></div><br>  Elliptic curves presented in the first 4 figures are called smooth.  While the two lower curves refer to the so-called.  <b>singular</b> elliptic curves. <br>  For smooth elliptic curves, the following inequality holds: <br><img src="https://habrastorage.org/getpro/habr/post_images/b69/234/f91/b69234f91932f51eeb83b726597d4c28.png"><br>  Whereas for singular curves this condition, surprise, does not hold. <br>  If you are going to independently develop a cryptographic product that supports the "elliptic" it is very important to remember the following fact: <br>  <b>It is impossible to use singular curves in EDS schemes.</b>  We will touch on this topic in detail, but now just say that using singular curves you risk significantly reducing the durability of the EDS scheme. <br>  Arithmetic operations in elliptical cryptography are performed on points of a curve.  The main operation is ‚Äúaddition‚Äù. <br>  Adding two points is easy to imagine graphically: <br><img src="https://habrastorage.org/getpro/habr/post_images/e41/7b8/690/e417b8690677e1dc5b8c804f99700cfd.png"><br>  As can be seen from the figure, to add the points P and Q, it is necessary to draw a straight line between them, which will necessarily cross the curve at any third point R. Reflect the point R relative to the horizontal coordinate axis and obtain the desired point P + Q. <br><br><h6>  Algebraic representation of "addition" </h6><br>  We write the addition of two points as a formula: <br><img src="https://habrastorage.org/getpro/habr/post_images/9ed/8eb/ba8/9ed8ebba8b183a27b7dc7bc4be5d238a.png"><br>  Let the coordinates of the point P be (x <sub>p</sub> , y <sub>p</sub> ), and the coordinates of the point Q, respectively, (x <sub>q</sub> , y <sub>q</sub> ).  Calculate <br><img src="https://habrastorage.org/getpro/habr/post_images/dd7/f27/c26/dd7f27c265c7a14d6897472e0d9f01f0.png"><br>  and then the coordinates of the point P + Q will be equal: <br><img src="https://habrastorage.org/getpro/habr/post_images/b00/1c5/42b/b001c542bc070e5dbaa05e0038c37402.png"><br><img src="https://habrastorage.org/getpro/habr/post_images/ccd/6c9/223/ccd6c9223dc88f4af845ee8a9f81bd99.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Elliptic curves in cryptography </h4><br>  It remains to clarify only one detail.  All the curves considered above refer to elliptic curves over real numbers.  And that brings us to the rounding problem.  That is, using curves over real numbers, we will not be able to get a bijection between the source text and the encrypted data.  In order not to bother with rounding in cryptography, only curves above finite fields are used.  This means that an elliptic curve is a set of points whose coordinates belong to a finite field. <br><br>  In cryptography, two types of elliptic curves are considered: over a finite field <img src="https://habrastorage.org/getpro/habr/post_images/f62/977/7d2/f629777d2ecfe09d92385bfa229b5462.png">  - residue ring modulo a prime number.  And over the field <img src="https://habrastorage.org/getpro/habr/post_images/be6/a64/a3c/be6a64a3c00569b4dbe817f6653ece63.png">  - binary finite field. <br>  Do elliptic curves over a field <img src="https://habrastorage.org/getpro/habr/post_images/be6/a64/a3c/be6a64a3c00569b4dbe817f6653ece63.png">  there is one important advantage, the elements of the field <img src="https://habrastorage.org/getpro/habr/post_images/be6/a64/a3c/be6a64a3c00569b4dbe817f6653ece63.png">  can be easily represented in the form of n-bit code words, this allows you to increase the speed of the hardware implementation of elliptic algorithms. <br><br>  All mathematical operations on elliptic curves over a finite field are performed according to the laws of a finite field over which an elliptic curve is constructed.  Those.  to calculate, for example, the sum of two points of the curve E over the residue ring <img src="https://habrastorage.org/getpro/habr/post_images/f62/977/7d2/f629777d2ecfe09d92385bfa229b5462.png">  all operations are performed modulo the number p. <br><br>  However, there are pitfalls.  If we add two identical elements from a binary finite field, we get 0 as a result, since  addition occurs modulo 2. This means that the characteristic of such a field is equal to 2. But an elliptic curve of the form <br><img src="https://habrastorage.org/getpro/habr/post_images/04d/94b/911/04d94b9114370a5c5fab166df84d765c.png"><br>  described above a field of characteristic 2 or 3 becomes singular, and as noted above, this is an unfortunate idea to use singular curves in cryptography. <br><br>  Therefore, the following curves are used over the binary finite field: <br><img src="https://habrastorage.org/getpro/habr/post_images/958/84e/03c/95884e03cf84998cac6dc02613821de0.png"><br><br>  Another important concept of elliptic cryptography is the <b>order of an elliptic curve</b> , which shows the number of points of a curve over a finite field. <br>  The Hasse theorem states that if N is the number of points of a curve defined over a field Zq with q elements, then the equality is true: <br><img src="https://habrastorage.org/getpro/habr/post_images/f75/a87/ae8/f75a87ae841364889b7f2b4700e46784.png"><br><br>  Since  binary finite field <img src="https://habrastorage.org/getpro/habr/post_images/96a/1ad/ca6/96a1adca6330254b8182135514b2080e.png">  consists of 2 <sup>n</sup> elements we can say that the order of the curve <img src="https://habrastorage.org/getpro/habr/post_images/429/37a/3be/42937a3be96a729ba83bd1d1a3198bd6.png">  equals <img src="https://habrastorage.org/getpro/habr/post_images/932/da4/3d3/932da43d3a7916c3dd3c4cf53c1ee57b.png">  where <img src="https://habrastorage.org/getpro/habr/post_images/c21/211/961/c21211961d9f36b841cc400a929e9a92.png">  . <br><br>  The following definition is related to number t: <br>  an elliptic curve over a binary finite field is called <b>super-singular</b> if t is divided by the characteristic field (in the case of a binary field, the characteristic is 2) without a remainder. <br>  Of course, all this I mean, that <b>it is impossible to use super singular curves in EDS schemes</b> .  The strict recommendation not to use singular and super singular curves for digital signatures has one very good reason, but more on that later. <br><br><h4>  Cryptography on elliptic curves </h4><br>  The points of an elliptic curve over a finite field are a group.  And as we noted above, the operation of addition is defined for this group. <br>  Accordingly, we can represent the multiplication of the number k by the point G as G + G + .. + G with k terms. <br><br>  Now imagine that we have the message M represented as an integer.  We can encrypt it using the expression <br>  C = M * G. <br>  The question is how difficult it is to recover M knowing the parameters of the curve E (a, b), the ciphertext C and the point G. <br>  This problem is called the discrete logarithm on an elliptic curve and does not have a quick solution.  Moreover, it is believed that the discrete logarithm problem on an elliptic curve is more difficult to solve than the discrete logarithm problem in finite fields. <br><br>  The fastest methods developed for finite fields turn out to be useless in the case of elliptic curves. <br>  So for solving the discrete logarithm there are sufficiently fast algorithms having complexity <img src="https://habrastorage.org/getpro/habr/post_images/6eb/d2f/38d/6ebd2f38df6ad717b6f674e2d5a03182.png">  , where c and d are some constants, and p is the size of the field.  Such algorithms are called subexponential and make it relatively easy to open the discrete logarithm in a finite field if the field size is not chosen very large, on the order of 2 <sup>1024</sup> . <br>  At the same time, the fastest methods for solving the discrete logarithm on an elliptic curve have the complexity <img src="https://habrastorage.org/getpro/habr/post_images/6c2/205/3fd/6c22053fdc2e65e2126cbe856b1bd56e.png">  where q is the number of points of the elliptic curve. <br>  Thus, to ensure a level of stability of 2 <sup>80</sup> operations, it is necessary that q = 2 <sup>160</sup> .  Let me remind you that in order to obtain a similar level of complexity in calculating a discrete logarithm in a finite field, a field of order q = 2 <sup>1024 is</sup> necessary. <br><br>  However, it should be noted that since the power of computing technology is constantly increasing, the value of q will constantly increase.  But since the graphics functions <img src="https://habrastorage.org/getpro/habr/post_images/6c2/205/3fd/6c22053fdc2e65e2126cbe856b1bd56e.png">  and <img src="https://habrastorage.org/getpro/habr/post_images/6eb/d2f/38d/6ebd2f38df6ad717b6f674e2d5a03182.png">  differ sharply from each other, in the group of points of the elliptic curve q will grow much slower than in an arbitrary finite field. <br><br><h4>  Attack options </h4><br><ol><li>  <b>Polig-Hellman algorithm</b> .  Algorithm for solving discrete logarithm.  Suppose that n is the number of points of an elliptic curve.  Let number n be decomposed into primes p <sub>1</sub> , p <sub>2</sub> , .., p <sub>n</sub> .  The essence of the method is to find discrete logarithms modulo the number p <sub>i</sub> , and then obtain a general solution using the <a href="http://ru.wikipedia.org/wiki/%25D0%259A%25D0%25B8%25D1%2582%25D0%25B0%25D0%25B9%25D1%2581%25D0%25BA%25D0%25B0%25D1%258F_%25D1%2582%25D0%25B5%25D0%25BE%25D1%2580%25D0%25B5%25D0%25BC%25D0%25B0_%25D0%25BE%25D0%25B1_%25D0%25BE%25D1%2581%25D1%2582%25D0%25B0%25D1%2582%25D0%25BA%25D0%25B0%25D1%2585">Chinese theorem on residuals</a> .  The attack reduces the problem of a discrete logarithm in a large field n to the same problem, but with a much smaller field p.  In order to resist the attack, <b>you just need to choose the curves, the number of points of which is divided by a very large prime number q‚âàn.</b> </li><li>  <b>The Shanks algorithm</b> , better known as baby steps / giant steps.  A typical example of time memory trade off.  For a group of size n, tables of size n <sup>1/2 are</sup> calculated, then the desired element is searched for by this table.  Algorithm complexity <img src="https://habrastorage.org/getpro/habr/post_images/6c2/205/3fd/6c22053fdc2e65e2126cbe856b1bd56e.png">  . </li><li>  <b>Vulnerability of singular and supersingular curves</b> .  I have already mentioned that there are no subexponential methods for solving the discrete logarithm problem.  In fact, there is one reservation: there are such methods, but only for a certain kind of curves: singular and super-singular.  The special properties of such curves allow us to reduce the problem of a discrete logarithm on an elliptic curve to the problem of a discrete logarithm in a finite field.  Accordingly, for such a class of curves, standard keys of 160-320 bits will be fatally vulnerable, which will allow attackers to unlock the secret key in a relatively short time. </li><li>  <b>Vulnerability of anomalous curves</b> Let me remind you that the number of points of an elliptic curve is calculated by the formula <br>  <b>n = q + 1-t</b> , where q is the size of the source field.  And that a curve is called super singular if t is divisible by 2. <br>  Therefore, at first glance it may seem like a good idea to use curves in which the number of points is q, i.e.  t = 1. <br>  However, such curves are called <b>anomalous,</b> and solving the discrete logarithm on anomalous elliptic curves is even simpler than for super-singular and singular curves. </li></ol><br><br><h4>  Summarize </h4><br>  Based on the foregoing, we write out the main advantages and disadvantages of elliptical cryptography: <br>  So, the main advantages: <br><ol><li>  The key length is much shorter compared to the ‚Äúclassical‚Äù asymmetric cryptography. </li><li>  The speed of the elliptic algorithms is much higher than that of the classical ones.  This is explained both by the size of the field and the use of a binary finite field structure that is closer to computers. </li><li>  Due to the short key length and high speed, asymmetric cryptography algorithms on elliptic curves can be used in smart cards and other devices with limited computing resources. </li></ol><br>  The main disadvantages of elliptical cryptography: <br><ol><li>  All the advantages of elliptical cryptography stem from one specific fact: <br>  For the discrete logarithm problem on elliptic curves, there are no subexponential solution algorithms.  This allows you to reduce the length of the key and increase productivity.  However, if such algorithms appear, it will mean the collapse of elliptical cryptography. </li><li>  Elliptical cryptography is very difficult.  Not that I considered ordinary asymmetric cryptography to be a very simple thing.  But "elliptic" is a huge amount of subtleties that need to be taken into account.  Starting with the choice of an elliptic curve and ending with the generation of keys.  When a mass transition to an elliptic is likely to be sure to be a large number of errors and vulnerabilities that have already been worked out for more familiar methods. </li></ol><br><br>  Based on the foregoing, I concluded for myself that the ubiquitous transition to an "elliptic" is not a necessity.  In the end, while the usual RSA, DSA peacefully coexist on the one hand, and GOST 34.10, ECDSA on the other, there is a false but soothing sense of alternative that we can lose by chasing the most modern cryptographic methods. <br><br><h4>  Used Books </h4><br><ol><li>  Don Johnson, Alfred Menezes, Scott Vanstone - The Elliptic Curve Digital Signature Algorithm. </li><li>  A. Bolotov, S. Gashkov, A. Frolov, A. Chasovskikh - An Elementary Introduction to Elliptical Cryptography. </li><li>  Lawrence Washington - Number theory and Number theory and Cryptography. </li></ol></div><p>Source: <a href="https://habr.com/ru/post/188958/">https://habr.com/ru/post/188958/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../188942/index.html">Prepros: an open-source file compiler for front-end development.</a></li>
<li><a href="../188944/index.html">Domestic phone with two screens: development history</a></li>
<li><a href="../188952/index.html">Course lectures "Startup". Peter Thiel. Stanford 2012. Session 18</a></li>
<li><a href="../188954/index.html">Maybe it's time to descend from the clouds?</a></li>
<li><a href="../188956/index.html">First Alpha Python 3.4.0 released</a></li>
<li><a href="../188962/index.html">Internet business in Russia: is it possible, is it necessary, is it gentle</a></li>
<li><a href="../188964/index.html">The history of running the game in social networks</a></li>
<li><a href="../188966/index.html">New type of attacks - attacks on cars</a></li>
<li><a href="../188968/index.html">EazyPhoto: a cozy photo hosting for your server</a></li>
<li><a href="../188972/index.html">Protection of equipment against surge voltage and switching noise</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>