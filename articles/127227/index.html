<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Quick and automatic launch of Django on IIS 7.x in a production environment (+ performance tests)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Django is a popular framework for building Python web applications. Its popularity is constantly growing due to the availability of rapid development ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Quick and automatic launch of Django on IIS 7.x in a production environment (+ performance tests)</h1><div class="post__text post__text-html js-mediator-article">  Django is a popular framework for building Python web applications.  Its popularity is constantly growing due to the availability of rapid development tools, integrated administrative interface and high speed of work.  There is a simple and reliable way to deploy and run django applications on the IIS web server using the <a href="http://www.microsoft.com/web/downloads/platform.aspx">Web Platform Installer</a> and the Helicon Zoo package repository. <br><br>  Helicon Zoo is a repository of popular web-frameworks and applications for Microsoft IIS.  It uses Microsoft Web Platform Installer (WebPI) technologies to deploy applications.  With their help, various dependencies are processed and the installation process itself takes the necessary components, such as Python, Django, various database drivers and modules.  Well, the module itself Helicon Zoo, which the whole thing sticks together with MS IIS 7. <br><br><a name="habracut"></a><h4>  How to use </h4><br>  In web development, there are two rather independent environments - development and production.  Helicon Zoo can be used both in production and on the developer‚Äôs machine, or both.  In any case, the sequence of actions is approximately as follows: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      First you need to download and install the Web Platform Installer from Microsoft - ( <a href="http://www.microsoft.com/web/downloads/platform.aspx">http://www.microsoft.com/web/downloads/platform.aspx</a> ).  WebPI already contains a large number of such frameworks and applications for IIS as PHP, ASP.NET, Wordpress, Drupal, phpBB.  To connect Helicon Zoo you need to add a new feed to WebPI: <ul><li>  We launch WebPI and we press Option <br><br><img title="clip_image002 [14]" alt="clip_image002[14]" src="https://habrastorage.org/getpro/habr/post_images/698/aca/6e4/698aca6e4a9531a0b2c0a78ea5bb19b7.jpg" width="454" height="190"></li><li>  In the field ‚ÄúDisplay additional scenarios‚Äù we insert <a href="http://www.helicontech.com/zoo/feed">http://www.helicontech.com/zoo/feed</a> and click Add feed <br><br><br><img title="clip_image004 [12]" alt="clip_image004[12]" src="https://habrastorage.org/getpro/habr/post_images/3d5/9ac/85c/3d59ac85ccc7dbf20c1e8d98af978805.jpg" width="453" height="176"></li></ul>  Now, if you select Applications, Tools in the WebPI interface, then at the end of the list you can see new applications: Blank Django Project, Blank Rails Project, Blank Perl Project, Blank Mojolicious Project: <br><br><img title="clip_image006 [12]" alt="clip_image006[12]" src="https://habrastorage.org/getpro/habr/post_images/21f/702/bcd/21f702bcdd8f4e32ed0a4405eca28b1c.jpg" width="450" height="226"><br><br>  The Blank Django Project is a simple ‚ÄúHello, World!‚Äù Application that is used to install all the dependencies required to run a Django application and, in fact, an empty Django project.  To install, click ‚ÄúAdd‚Äù and ‚ÄúInstall‚Äù, a form with a list of dependencies will appear: <br><br><img title="clip_image008 [12]" alt="clip_image008[12]" src="https://habrastorage.org/getpro/habr/post_images/6b7/59f/8e4/6b759f8e48c0f2e861cd56194a94539e.jpg" width="453" height="454"><br><br>  To accept the license and start downloading and installing, click ‚ÄúI Accept‚Äù.  After installing and downloading all dependencies, the installed project can be launched by clicking on ‚ÄúLaunch application in browser‚Äù: <br><br><img title="clip_image010 [12]" alt="clip_image010[12]" src="https://habrastorage.org/getpro/habr/post_images/8d6/5c5/dab/8d65c5dabd7cd7f279fa4841c628b70e.jpg" width="453" height="256"><br><br>  This window means that Python, Django, and everything you need to run the applications have just been installed on your computer.  Now, if this is a development machine, you can start developing with this empty ‚ÄúHello Worls‚Äù application.  After you do something with this application, you can upload it to the production server with all the files, directories, necessarily with the web.config file, and if the server has previously installed the Blank Django Project (no matter what directory, only dependencies), the application should earn there.  Every time you upload your changes to the server, you need to restart the Application Pool.  This is a feature of Django (and Rails), for other frameworks, restarting may not be necessary.  When restarting, data will be automatically migrated - <i>manage.py syncdb</i> .  This allows you to use the solution on shared hosting, where the user does not have access to the console. <br><br><h4>  Under the hood </h4><br>  The core of Helicon Zoo is a native IIS module, in fact, playing the role of a bridge between the IIS web server and frameworks on Ruby, Python, Perl, etc. web server.  The interaction between them occurs asynchronously, using technology I / O Completion Port.  The transport uses either named pipes or tcp sockets.  IIS 7, IIS 7.5, and IIS Express are supported. <br><br>  The basic configuration of the Helicon Zoo module is located in the &lt;heliconZooServer&gt; section of the applicationHost.config file.  This section describes all the FastCGI engines that will be worked through Zoo.  Here is an example of the description of the engine for running python wsgi applications (Django applications in particular), zoofcgi.py - this is a python worker that implements transport on named pipes (named pipes): <br><br><pre><code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">engine</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"python.2.7.pipe"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">fullPath</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"c:\python27\python.exe"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">arguments</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"-O %SystemDrive%\Zoo\Workers\python\zoofcgi.py"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">transport</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"pipe"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> </pre> <br><h5>  Web.config </h5><br>  Configuration of web applications that work through Zoo is done via the web.config file.  Here is an example of such a file for configuring a Django application to work in a 32-bit pool: <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">configuration</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">system.webServer</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">heliconZoo</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">application</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"django.project.x86"</span></span></span><span class="hljs-tag"> &gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">environmentVariables</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">add</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PYTHONPATH"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"%APPL_PHYSICAL_PATH%;%PYTHONPATH%"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">add</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"DJANGO_SETTINGS_MODULE"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"settings"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">add</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"DEPLOY_FILE"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"deploy.py"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">add</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"DEPLOY_LOG"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"log\deploy.log"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">environmentVariables</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">application</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">heliconZoo</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">handlers</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">add</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"django.project.x86"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">scriptProcessor</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"python.2.7.pipe"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">path</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">verb</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">modules</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"HeliconZoo_x86"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">preCondition</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bitness32"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">resourceType</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Unspecified"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">requireAccess</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Script"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">handlers</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">system.webServer</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">configuration</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  <font>Here are the important points:</font> <ul><li>  scriptProcess = "python.2.7.pipe" - link to the FastCGI engine defined in applicationHost.config; </li><li>  the PYTHONPATH environment variable ‚Äî the way in which python is looking for its modules;  in our case, we add the path to our django application to PYTHONPATH; </li><li>  environment variable DJANGO_SETTINGS_MODULE - python path to the Django application settings.py configuration file, for example, 'mysite.settings' </li><li>  The environment variable 'DEPLOY_FILE' is the path to the file inside the application that will be launched before the first request to the application is executed after the restart of the IIS application.  In this file you need to execute, for example, commands for database synchronization: 'manage.py syncdb ‚Äìnoinput'; </li><li>  the environment variable 'DEPLOY_LOG' is the path inside the application to the file where the output of the DEPLOY_FILE command for debugging purposes will be recorded.  The directory in which this log file is located must have write permissions for the user from whom the IIS application is running (usually the IIS_IUSRS group). </li></ul><br><h5>  Static content </h5><br>  The Django framework is not suitable for fast and secure processing of static files (images, scripts, style files).  Statics should be processed by the web server directly.  To do this, you need to put all the static files in a directory and turn off the request handler in the django application in it: <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">configuration</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">system.webServer</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">handlers</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">remove</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"django.project.x86"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">handlers</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">system.webServer</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">configuration</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><h5>  Sample Django Project on IIS 7 </h5><br>  Suppose our django project consists of three applications: <ul><li>  site - the site itself with templates, statics, urls.py and settings.py </li><li>  blog </li><li>  store </li></ul>  Static files located in site / media will be accessible via the / media / virtual directory (i.e. MEDIA_URL = '/ media /').  After installing the Blank Django Project to the root of the site and copying our django project, we get the following directory structure: <br><br><img title="clip_image012 [12]" alt="clip_image012[12]" src="https://habrastorage.org/getpro/habr/post_images/4a4/906/a81/4a4906a81f0190e690e1a2f28f8119bc.jpg" width="453" height="342"><br><br>  / media / is the virtual directory that points to site / media;  Zoo module is disabled in it as described above.  In the root web.config, PYTHONPATH points to the site root and DJANGO_SETTINGS_MODULE is set to 'site.settings': <br><br><pre> <code class="xml hljs">... <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">heliconZoo</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">application</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"django.project.x86"</span></span></span><span class="hljs-tag"> &gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">environmentVariables</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">add</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"PYTHONPATH"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"%APPL_PHYSICAL_PATH%"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">add</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"DJANGO_SETTINGS_MODULE"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"site.settings"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">environmentVariables</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><h4>  Performance </h4><br>  And finally, the most interesting - performance testing.  Deployed testing will be later, now while in a hurry, but it is quite possible to judge from these results.  Test machine as a server - Core 2 Quad 2.4 Ghz, 8 Gb RAM, gigabit network.  To generate the load, a more powerful computer with Apache Benchmark was used.  Ubuntu 11.04 Server x64 was used to test Apache and Nginx.  IIS 7 tests worked on Windows Server 2008 R2.  Any virtualok - honest iron.  The most advanced uwsgi as well as wsgi and fast_cgi were used as a transport for Nginx for comparison.  More on IIS 7 compared with PyISAPIe. <br><br>  Two small scripts were written as test pages.  The first one displays the current time in high resolution - this is done so that there is confidence that the pages are not taken from the cache.  The second does the same thing, but pre-stores the result in the database.  All this through a template to use the real infrastructure of Django, the database is MySQL.  The settings are everywhere by default, because  The goal is to test the most typical configurations.  So, the results (in queries per second): <br><br><img title="clip_image014 [12]" alt="clip_image014[12]" src="https://habrastorage.org/getpro/habr/post_images/5fb/b72/172/5fbb72172034a478c520bd341d85d4a9.gif" width="392" height="343"><br><br>  Here everything is more or less clear and stable.  Uwsgi is ahead, apparently due to closer integration with the Django code - you will need to smoke it ... PyISAPIe lags far behind, which is understandable. <br><br><img title="clip_image016 [12]" alt="clip_image016[12]" src="https://habrastorage.org/getpro/habr/post_images/05c/828/b30/05c828b305ce68aa4ae5e5de8881d5ea.gif" width="390" height="339"><br><br>  But with the database, the result is not as stable.  Why Nginx + fcgi + MySQL showed such strange 175 queries per second is not clear.  The result of MySQL on Windows is also depressing, although on a shared hosting the problem may not be so critical.  The fact is that the performance drops mainly due to some internal locks in MySQL, the server itself is almost not loaded, while it generates these 104 queries.  It can be assumed that with an increase in the number of sites on the server and, accordingly, an increase in the number of databases, if they are not blocked among themselves, the total capacity of the server will be sufficient. <br><br>  So we decided to add MS SQL Express to the tests.  Its result is also understandable - it all comes down to Python itself and the database driver for it, but overall it looks pretty decent.  PyISAPIe with MS SQL Express did not work. <br><br>  I would like to separately note the ability of IIS 7 to hold a large number of connections.  So IIS 7 + Helicon Zoo easily withstood thousands of simultaneous connections (more we just had nothing to generate), while Ubuntu, with the default settings, with the increase in the number of connections, quickly passed.  And Apache also turned out to be a very voracious memory.  So with the growing number of connections, Apache consumed about 3 GB of memory in 20 seconds of the test - they did not check further. <br><br><h4>  findings </h4><br>  The presented solution shows stable performance and decent performance.  It is quite ready for use both as a development environment and in production.  Especially important is the possibility of using Helicon Zoo by various Windows hosting services in order to provide Django services to its customers.  I would like to hope that with the growing number of Django servers on Windows, its developers will pay more attention to debugging and optimizing their code under the Windows platform.  Yes, and the army of existing Windows developers can be a good help for current open-source projects. </div><p>Source: <a href="https://habr.com/ru/post/127227/">https://habr.com/ru/post/127227/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../127220/index.html">Cocos2d-x: Building a project for Android</a></li>
<li><a href="../127222/index.html">ActionMailer_X509: Sign and Encrypt Emails Directly in Ruby On Rails</a></li>
<li><a href="../127223/index.html">Digest Wanted.VC # 12</a></li>
<li><a href="../127224/index.html">10 fabulous speeches by Steve Jobs</a></li>
<li><a href="../127225/index.html">LiveInternet.ru: how user passwords are stored</a></li>
<li><a href="../127229/index.html">We write letters from iOS applications</a></li>
<li><a href="../127230/index.html">Internetbank on iPhone and iPad from Bank24.ru</a></li>
<li><a href="../127231/index.html">Your mobile operator may be at fault for quickly discharging a smartphone's battery</a></li>
<li><a href="../127232/index.html">WebDav and Nginx</a></li>
<li><a href="../127233/index.html">3rd .NET Developer Conference</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>