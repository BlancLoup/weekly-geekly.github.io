<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Rogue AP - fake access points</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Most modern devices remember the name of the Wi-Fi network, to which they successfully connected at least once, and immediately connect to it if they ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Rogue AP - fake access points</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/62e/96f/dd9/62e96fdd93234a33a7b0ce60c5f325df.png"><br><br>  Most modern devices remember the name of the Wi-Fi network, to which they successfully connected at least once, and immediately connect to it if they ‚Äúsee‚Äù it in wireless.  This feature of wireless technologies is increasingly being used by attackers - they create so-called  rogue AP (fake access point).  Every year, such attacks are becoming increasingly large, given the ever-growing market for <abbr title="bring your own device, bring your own device - a term describing a situation when an employee of an organization instead of a corporate computer uses its own device for work - a personal laptop, smartphone or tablet">BYOD</abbr> devices and the amount of critical information contained in them. <br><a name="habracut"></a><br><h2>  Fake wifi </h2><br>  When setting up a wireless adapter to automatically connect to well-known wireless networks, the user exposes himself to the risk of falling victim to man-in-the-middle attacks.  An attacker could create a trusted Wi-Fi access point.  As a result, the client device will automatically connect to such an access point and work through it, and the attacker will be able to intercept the ‚Äúentire traffic‚Äù of his victim, or attack the device that is with him on the same network segment. <br><br>  To detect access points, a device equipped with a Wi-Fi module scans the radio for the presence of Beacon frames transmitted by the access point, which contain an indication of a known SSID.  Probe Request broadcast frames are sent across all channels, awaiting the response of a known access point.  The Probe-Request frames may or may not indicate the SSID of the network that the mobile device is looking for.  Responding to the Probe-Request, the access point sends Probe Response frames containing similar information as the Beacon packets. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Relying on the received data, such as the network name, signal-to-noise ratio, supported 802.11 standards, the device makes its decision to connect to one of the available known networks (access points). <br><br>  The attacker's task is to ‚Äúraise‚Äù a clone of the network, to which the potential victim can have access configured (with or without protection).  Also, if there is a legitimate access point nearby, an attacker can try to ‚Äúextinguish‚Äù it in order to redirect clients to their access point. <br><br>  Examples of fake access points: <br><br><ul><li>  name and / or model of the router: DIR-300, ASUS; </li><li>  default name: default,% provider_name%; </li><li>  Free Wi-Fi: MosMetro_Free, Beeline_Free_Wi-Fi; </li><li>  access points stitched by the operator: attwifi; </li><li>  Access points of various establishments:% airport_name_free%, McDonalds_WiFi_Free; </li><li>  access points with no encryption: h0lyava, MaminHackir, blondinka. </li></ul><br>  After successfully connecting to the access point, the attacker implements one or more attack vectors, including using social engineering tactics: <br><br><ul><li>  "Classic" Man in the Middle attacks, data interception; </li><li>  ‚ÄúComplex‚Äù Man in the Middle attacks - sslstrip, HSTS bypass and SSL pinning, etc .; </li><li>  traffic modification (URL and content spoofing); </li><li>  access page to the router / web panel to enter the password, captive-portal; </li><li>  fake Radius to intercept MS-CHAPv2 hashes (many of the users easily ‚Äúaccept‚Äù a fake or untrusted certificate); </li><li>  direct attacks on devices in one network segment. </li></ul><br><h2>  Attack examples </h2><br>  Avast employees on the eve of the international exhibition Mobile World Congress 2016 conducted a kind of experiment.  The day before the opening at Barcelona Airport, several Wi-Fi access points with SSID-identifiers Starbucks, Airport_Free_Wifi_AENA and MWC Free WiFi were deployed.  Avast's goal was to demonstrate how users put themselves at risk when using public Wi-Fi points. <br><br>  In just four hours, Avast experts intercepted more than 8 million data packets from more than two thousand users.  To preserve the privacy of users, all data was immediately deleted.  The company managed to collect the following statistics during the experiment: <br><br><ul><li>  50.1% of users used the Apple device, 43.4% - a gadget running Android, 6.5% - devices with Windows Phone; </li><li>  61.7% of visitors to the exhibition were searching Google and checking their Gmail mail; </li><li>  14.9% used Yahoo search; </li><li>  Facebook application was installed on 52.3% of devices, and Twitter was less popular - only 2.4%. </li></ul><br>  According to experts, many people know that an open Wi-Fi network is fraught with danger, but nevertheless continue to use them.  The success of the experiment is also due to the fact that many airports are roaming and cannot use the mobile Internet, so they are trying to find free networks. <br><br>  Often users are attacked the most common networks of hooliganism: <br><blockquote>  Hackers hacked the free Wi-Fi network of the Moscow metro around 11:30.  As a result of hooliganism, thousands of passengers saw porn on the screens of their phones and tablets instead of the usual start page and invitation to enter the network. </blockquote><blockquote>  When connecting to the WI-FI network, as it became known to REN TV journalists, an obscene inscription appeared on the mobile phones of the passengers: ‚ÄúGo to x ... bits and buckets!  X ... you, not the Internet. " <br><br>  MaksimaTelecom spokesman Ilya Grabovsky said that the possibility of hacking into their network is excluded.  According to him, one of the passengers created a WI-FI network without access to the Internet, called it with a similar name.  Grabovsky noted that some of the citizens had mistakenly connected to this network. <br></blockquote><br>  What can we say about ordinary users if even ‚Äúadvanced‚Äù visitors to information security conferences fall victim to such attacks: <br><br>  <a href="https://habrahabr.ru/users/bo0om/" class="user_link">Bo0oM</a> : <br><blockquote>  Therefore, I distributed a fake Wi-Fi point, and not just a simple one, but with ARP, DNS, NB, ANOTHER-ANY-ABBREVIATURA-spoofing, certificate substitution, HSTS bypass, and other fashionable things. <br><br>  This made it possible for all connected users' traffic to pass through themselves, hacking wings along the way (transferring from an encrypted connection to an unencrypted one).  Thus, I managed to connect 108 devices.  In most cases - mobile phones, a minority - laptops.  The standard mail client for iphone perfectly permits MiTM (apparently for this reason we managed to intercept 6 passwords from gmail accounts), icloud transmits a login and password in the header with each request (Basic Auth). </blockquote><br><h2>  Tools </h2><br>  To date, there are quite a few utilities for conducting such attacks, below is a brief description of the most popular of them. <br><br>  <b>Important: the use of some of them may be prohibited by law and prosecuted.</b> <br><br>  <b>Mdk3</b> is a utility containing several client deauthentication technologies and an access point attack technician, leading to its ‚Äúhanging‚Äù (DoS) or rebooting. <br><br>  <b><a href="https://defcon.ru/network-security/wireless-security/1696/">Mana toolkit</a></b> is a modified hostapd (software access point) and several scripts that allow you to create and use fake access points: <abbr title="Each client device in the standby mode constantly sends out so-called beacons trying to find one of the previously stored wireless networks next to it. A device running KARMA intercepts these beacons and appears to clients as the access point it is looking for. At the same time, it does not matter at all what security parameters, passwords and encryption type of the point memorized by the device - the connection will happen unnoticed and over an open channel.">KARMA-</abbr> attack;  various types of MitM attacks;  HSTS bypass;  cookies capture;  intercept EAP. <br><br>  <b>Wifi phisher</b> - designed for phishing attacks on WiFi networks in order to obtain passwords from the access point and other personal information.  This tool is based on the attack of social engineering. <br><br>  <b>Wifi pumpkin</b> - the tool creates a fake Wi-Fi access point, while affecting the legitimate access point (disables clients).  It can be used to capture credentials using Man in the Middle attacks, also uses such attacks as (including social): DHCP Starvation;  phishing;  Windows Update;  HSTS bypass;  transparent proxy, etc. <br><br>  <b>Linset</b> is a utility that combines a fake access point and a sociotechnical component.  The tool is interesting, but requires some improvements. <br><br>  <b>Bdfproxy</b> - the tool allows to modify binary files ‚Äúon the fly‚Äù, for example, for the introduction of malicious functionality or backdoors.  The functionality works great with all sorts of update-services that deliver updates in the form of executable files. <br><br>  <b><a href="https://defcon.ru/network-security/wireless-security/1471/">Waidps</a></b> - a tool for detecting attacks in Wi-Fi networks.  It is a multipurpose tool designed to audit networks, detect wireless intrusion (WEP / WPA / WPS attacks), and also prevent intrusion (stop communication of a station with an access point).  In addition, the program collects all information about the surrounding Wi-Fi networks and stores in the database. <br><br><h2>  Ways to protect </h2><br>  The most cardinal is to turn off the Wi-Fi adapter. <br><br>  Preventive - enable ‚Äúconnection confirmation‚Äù even to known networks;  use VPN;  monitor the air to detect anomalies;  Do not use critical programs (for example, bank-client) in open networks. <br><br>  <b>PS</b> <br>  Modern vectors of attack on Wi-Fi networks, as well as current tools and methods for analyzing the security of wireless networks, we demonstrate in practical exercises of <a href="https://www.pentestit.ru/study/zerosecurity-a">the Zero Security: A</a> course. <br>  For professionals who want to get professional training in the field of practical information security, exclusive courses from Pentestit, <a href="https://www.pentestit.ru/labs/corp-lab">Corporate Laboratories</a> , have been developed in Russia and the CIS. </div><p>Source: <a href="https://habr.com/ru/post/277793/">https://habr.com/ru/post/277793/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../277783/index.html">LTSP: Terminal Server on Linux</a></li>
<li><a href="../277785/index.html">A vulnerability was found in EMET</a></li>
<li><a href="../277787/index.html">Festive social project: share a solution - save your colleagues health</a></li>
<li><a href="../277789/index.html">Rummage in the "directing version" Wasteland 2: mechanics and interfaces</a></li>
<li><a href="../277791/index.html">Wash down with me CRM! About types of refinement</a></li>
<li><a href="../277799/index.html">0 March. Seymour Papert and body programming training (and unconscious)</a></li>
<li><a href="../277803/index.html">March 1 is the birthday of the personal computer. Xerox alto</a></li>
<li><a href="../277809/index.html">Working with email: How to reduce the number of incoming messages to zero</a></li>
<li><a href="../277811/index.html">Underground carders market. Translation of the book "KingPIN". Chapter 20. ‚ÄúThe Starlight Room‚Äù</a></li>
<li><a href="../277813/index.html">We catch everything with the help of CoordinatorLayout Behavior</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>