<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Jii - a JavaScript framework with architecture from Yii 2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 Hello to all habrovchanam, fans of Yii and Node.js. 
 I continue a series of articles about the Jii framework and its parts. In the pre...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Jii - a JavaScript framework with architecture from Yii 2</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/files/991/c3c/c6a/991c3cc6a78a434eab47ee7ab141a772.png"></div><br><h1>  Introduction </h1><br>  Hello to all habrovchanam, fans of Yii and Node.js. <br>  I continue a series of articles about the <a href="http://www.jiiframework.ru/">Jii</a> framework and its parts.  In the previous parts, we looked at parts of the framework that can be used without initializing the application, namely <a href="http://habrahabr.ru/post/260295/">Query Builder</a> and <a href="http://habrahabr.ru/post/260569/">Active Record</a> .  From the vote (as well as letters and comments), it became clear that it was worthwhile to continue.  And this time we will talk about the architecture and structural components of the Jii framework. <br><a name="habracut"></a><br><h1>  Ideology </h1><br><div style="text-align:center;"><img src="https://habrastorage.org/files/9e8/5d5/ca6/9e85d5ca6d49412e952ffa3ed85ba4af.jpg"></div><br>  Transferring the framework functionality from PHP to JavaScript is not a trivial task and cannot be performed by a robot.  Languages ‚Äã‚Äãhave very different features and differences, the main one being the asynchrony of JavaScript. <br>  Below is how these problems were solved and what practices I followed.  These same practices should be followed by other developers when developing Jii and its extensions. <br><br><h2>  Promise </h2><br>  Each asynchronous operation returns a Promise object implementing the ES6 standard.  For this, the <a href="https://github.com/cujojs/when">when</a> library is used. <br>  Methods starting with the prefix <i>load</i> (loadData ()) return Promise, methods with the prefix <i>get</i> (getUser (), get ('id')) - return data synchronously. <br><br><h2>  Saving API Yii 2 </h2><br>  The original idea of ‚Äã‚ÄãJii is to bring a beautiful and rich PHP framework to JavaScript.  So that php developers who want to try / go to node.js can quickly and easily master the framework on <br>  other programming language, even without reading reference class! 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Buildability </h2><br>  Jii is designed taking into account the fact that it should work wherever possible - browser, server, phonegap, node-webkit, etc. <br>  Despite the fact that <i>Yii</i> generates quite a few global constants ( <i>YII_ *</i> ), the class <i>Yii</i> and the naming <i>space yii</i> , <i>Jii</i> do not <i>clog up</i> <br>  global space.  Browsers have access to a single Jii object, which can be hidden by calling <i>Jii.noConflict ()</i> .  In the server part, nothing is written to global, and Jii is returned as a result. <br>  call <i>require ('jii')</i> . <br><br><h2>  Npm packages </h2><br>  Jii is distributed as a set of jii- * packages and does not have its own package managers (hello, Meteor).  This means that with Jii you can connect any other npm packages. <br>  Jii is broken into several packages, so it can be used in parts.  For example, if you want to start using only ActiveRecord, then you install jii-ar-sql and do not have controllers, views, http server, and other code that you do not need. <br>  If you have read the <a href="http://habrahabr.ru/post/260295/">previous</a> <a href="http://habrahabr.ru/post/260569/">articles</a> , you have already seen this one. <br>  The main packages for Jii at the moment are: <br><ul><li>  <a href="https://www.npmjs.com/package/jii">jii</a> </li><li>  <a href="https://www.npmjs.com/package/jii-model">jii-model</a> </li><li>  <a href="https://www.npmjs.com/package/jii-ar-sql">jii-ar-sql</a> </li><li>  <a href="httpserver">jii-httpserver</a> </li><li>  <a href="https://www.npmjs.com/package/jii-urlmanager">jii-urlmanager</a> </li><li>  <a href="https://www.npmjs.com/package/jii-assets">jii-assets</a> </li><li>  <a href="https://www.npmjs.com/package/jii-view">jii-view</a> </li></ul><br><h2>  Getters and Setters </h2><br>  One of the main features of <i>Yii</i> is the ease of accessing the properties and methods of objects through getters and setters, for example, by accessing <i>$ model-&gt; user,</i> you can get the model property, or call the <i>getUser ()</i> method, or even get the user relation, where DB - the magic is complete, but everyone likes it. <br>  In JavaScript, not all browsers support getters and setters, and many projects still need to support IE8, so in Jii they are implemented as <i>get ('user')</i> and <i>set ('user', 'Ivan')</i> methods.  This approach can be found in many libraries, for example in <a href="http://backbonejs.org/">Backbone</a> . <br>  In the future, when the need for old browsers disappears, then real getters and setters will be added in parallel with get / set methods that will work through them. <br><br><h2>  Classes and Neimspaces </h2><br>  As they say, every self-respecting programmer should write his own implementation of classes in JavaScript.  So here, for the implementation of classes, my <a href="http://github.com/affka/neatness">Neatness</a> library is used, which has already performed well in other internal projects. <br><br><h4>  Why not ES6 classes (and not CoffeeScript / TypeScript)? </h4><br><div style="text-align:center;"><img src="https://habrastorage.org/files/a98/bd1/626/a98bd16264fc4586b2b6ec477675ba21.jpeg"></div><br>  In the <a href="http://habrahabr.ru/post/260569/">comments</a> and on the <a href="https://github.com/jiisoft/jii/issues/1">githaba</a> there is already a small holivar about this. <br>  I will sound here the reasons for the absence of ES6 in Jii: <br><ol><li>  For node.js, you need preprocessing (io.js supports) </li><li>  In es6, there are no namespaces, but they are needed to repeat the features of Yii.  They can be implemented through modules, but it will be a crutch.  Change one crutch to another - it makes no sense. </li><li>  In ES6, you will want to use getters and setters, but they are not supported by older browsers, as mentioned above. </li><li>  Many developers do not know the format es6 / coffeescript / typescript and this will be an additional threshold of entry </li><li>  The difficulty of working with code of different formats (ES5 and ES6).  It is not always possible in an existing project to change all the code to es6, and you still need to inherit the es6 classes, and you still have to use Jii.defineClass () to create classes - the crutch does not go away. </li></ol><br>  Below I added a poll on this topic, vote, comment! <br><br><h2>  Middlewares </h2><br>  In Yii, the framework components are available globally via <i>Yii :: $ app-&gt; ...</i> However, in <i>Jii,</i> not all components can be arranged globally, since  some of them (Request, Response, WebUser, Session, ...) are bound to the context (request). <br>  Such components will be created in context ( <i>Jii.base.Context</i> ) and passed as a parameter to the action - an analogy with the transfer of request and response to <a href="http://expressjs.com/">express</a> . <br><br><pre><code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/** * @class app.controllers.SiteController * @extends Jii.base.Controller */</span></span> Jii.defineClass(<span class="hljs-string"><span class="hljs-string">'app.controllers.SiteController'</span></span>, <span class="hljs-comment"><span class="hljs-comment">/** @lends app.controllers.SiteController.prototype */</span></span>{ <span class="hljs-attr"><span class="hljs-attr">__extends</span></span>: Jii.base.Controller, <span class="hljs-comment"><span class="hljs-comment">/** * * @param {Jii.base.Context} context * @param {Jii.httpServer.Request} context.request * @param {Jii.httpServer.Response} context.response */</span></span> actionIndex: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">context</span></span></span><span class="hljs-function">) </span></span>{ context.response.data = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.render(<span class="hljs-string"><span class="hljs-string">'index'</span></span>); context.response.send(); } });</code> </pre> <br><h1>  Entities </h1><br><div style="text-align:center;"><img src="https://habrastorage.org/files/650/b38/11f/650b3811f5ec46389d3e897fd52f098c.jpg"></div><br>  Jii applications are organized according to the model-view-behavior design pattern (MVC) and have the following entities: <br><ul><li>  <b>applications</b> : these are globally accessible objects that perform the correct operation of the various components of the application and coordinate them to process the request; </li><li>  <b>application components</b> : these are objects registered in the application and providing various capabilities; </li><li>  <b>request components</b> : these are objects registered in the context of the request and providing various possibilities for processing the current request; </li><li>  <b>modules</b> : these are self-contained packages that include all the tools for MVC.  An application can be organized using several modules; </li></ul><br>  Examples of their use can be seen in the <a href="https://github.com/jiisoft/jii-boilerplate-hello">demo</a> . <br><br><h2>  Applications </h2><br>  Applications are objects that control the entire structure and life cycle of an application system Jii.  Usually on one worker (process) of Node.js comes one instance of the Jii application, which is accessible via Jii.app. <br>  When the input script creates an application, it loads the configuration and applies it to the application, for example: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> Jii = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'jii'</span></span>); <span class="hljs-comment"><span class="hljs-comment">//    var config = { application: { basePath: __dirname, components: { http: { className: 'Jii.httpServer.HttpServer' } } }, context: { components: { request: { baseUrl: '/myapp' } } } }; //       Jii.createWebApplication(config);</span></span></code> </pre><br>  <b>An important difference from Yii</b> is that the configuration is divided into two parts - the application configuration (application section) and the context (request) configuration (context section).  Application configuration creates and configures components, modules and configures the application itself (Jii.app) - all this happens when you start the worker.  In turn, the context configuration creates and configures components with each action call ‚Äî http request, console command call, etc.  The created components are passed as the first argument to the action method. <br><br>  Due to the fact that the configuration of the application is often very complex, it is put into files and broken into several configuration files. <br><br><h2>  Application Components </h2><br>  Applications store many application components that provide various means for the operation of the application.  For example, the components urlManager is responsible for routing web requests to the desired controller;  the db component provides tools for working with the database;  etc. <br><br>  Each component of the application has its own unique ID, which allows you to identify it among other various components in the same application.  You can access the component as follows: <br><br><pre> <code class="javascript hljs">Jii.app.ComponentID</code> </pre><br><h4>  Embedded Application Components </h4><br>  Jii has several built-in application components, with fixed IDs and default configurations. <br><br>  Below is a list of embedded components of the application.  You can configure them as well as other components of the application.  When you configure the embedded component of the application and do not specify the class of this component, the default value will be used. <br><ul><li>  <i><b>db</b> , Jii.sql.BaseConnection</i> : is a connection to a database through which you can perform queries.  Note that when you configure this component, you must specify the component class as well as the other necessary parameters. </li><li>  <i><b>urlManager</b> , Jii.urlManager.UrlManager</i> : used for parsing and creating URLs; </li><li>  <i><b>assetManager</b> , Jii.assets.AssetManager</i> : used to manage and publish application resources; </li><li>  <i><b>view</b> , Jii.view.View</i> : used to display views. </li></ul><br><h2>  Context components </h2><br>  The set of context components depends on where it is applied.  The most common option is the HTTP request of the user, for which we will consider the built-in set of components. <br><br>  As with application components, each application component has its own unique ID, which allows it to be identified among other various components in the same context.  You can access the component as follows: <br><br><pre> <code class="javascript hljs"> actionIndex: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">context</span></span></span><span class="hljs-function">) </span></span>{ context.ComponentID }</code> </pre><br><h4>  Built-in query components </h4><br>  Below is a list of embedded query components.  You can configure them as well as other components in the context section of the configuration file. <br><br><ul><li>  <i><b>response</b> , Jii.base.Response</i> : is the data from the server that will be sent to the user; </li><li>  <i><b>request</b> , Jii.base.Request</i> : is a request received from end users; </li><li>  <i><b>user</b> , Jii.user.WebUser</i> : is the information of the authenticated user; </li></ul><br><h2>  Controllers </h2><br>  Controllers are part of the <a href="https://ru.wikipedia.org/wiki/Model-View-Controller">MVC</a> architecture.  These are objects of the classes inherited from <i>Jii.base.Controller</i> and are responsible for processing the request and generating the response.  In essence, when processing the HTTP request by the server ( <i>Jii.httpServer.HttpServer</i> ), the controllers will analyze the input data, transmit it <br>  into models, insert model results into [views] (structure-views), and ultimately generate outgoing responses. <br><br><h4>  Actions </h4><br>  Controllers consist of <b>actions</b> that are basic units that the end user can access and request the execution of a particular <br>  functional.  The controller may have one or more actions. <br><br>  The following example shows a <i>post</i> controller with two actions: <i>view</i> and <i>create</i> : <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/** * @class app.controllers.PostController * @extends Jii.base.Controller */</span></span> Jii.defineClass(<span class="hljs-string"><span class="hljs-string">'app.controllers.PostController'</span></span>, <span class="hljs-comment"><span class="hljs-comment">/** @lends app.controllers.PostController.prototype */</span></span>{ <span class="hljs-attr"><span class="hljs-attr">__extends</span></span>: Jii.base.Controller, <span class="hljs-attr"><span class="hljs-attr">actionView</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">context</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> id = context.request.get(<span class="hljs-string"><span class="hljs-string">'id'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> app.models.Post.findOne(id).then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">model</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (model === <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { context.response.setStatusCode(<span class="hljs-number"><span class="hljs-number">404</span></span>); context.response.send(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } context.response.data = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.render(<span class="hljs-string"><span class="hljs-string">'view'</span></span>, { <span class="hljs-attr"><span class="hljs-attr">model</span></span>: model }); context.response.send(); }); }, <span class="hljs-attr"><span class="hljs-attr">actionCreate</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">context</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> model = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> app.models.Post(); Jii.when.resolve().then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// Save user if (context.request.isPost()) { model.setAttributes(context.request.post()); return model.save(); } return false; }).then(function(isSuccess) { if (isSuccess) { context.request.redirect(['view', {id: model.get('id')}]) } else { context.response.data = this.render('create', { model: model }); context.response.send(); } }); } });</span></span></code> </pre><br>  In the <i>view</i> action (defined by the <i>actionView ()</i> method), the code first loads the model according to the requested model ID;  If the model is successfully loaded, the code will display it using a view called <i>view</i> . <br><br>  In the <i>create</i> action (defined by the <i>actionCreate ()</i> method), the code is similar.  He first tries to load the model using the data from the query and save the model.  If everything went well, the code redirects the browser to the action <i>view</i> with the ID of the newly created model.  Otherwise, it displays the <i>create</i> view, through which the user can fill in the required data. <br><br><h4>  Routes </h4><br>  End users access actions via so-called * routes *.  The route is a string consisting of the following parts: <br><ul><li>  Module ID: it exists only if the controller belongs not to the application, but [to the module] (structure-modules); </li><li>  Controller ID: a string that uniquely identifies the controller among all other controllers of the same application (or the same module, if the controller belongs to the module); </li><li>  Action ID: A string that uniquely identifies an action among all other actions of the same controller. </li></ul><br>  Routes can be in the following format: <br><br><pre> <code class="javascript hljs">ControllerID/ActionID</code> </pre><br>  or the following format, if the controller belongs to the module: <br><br><pre> <code class="javascript hljs">ModuleID/ControllerID/ActionID</code> </pre><br><h4>  Creating action </h4><br>  Creating actions is not as difficult as declaring the so-called * action methods * in the controller class.  An action method is a method whose name begins with the word <i>action</i> .  The return value of the action method is the response data that will be sent to the end user.  The code below defines two actions, <i>index</i> and <i>hello-world</i> : <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/** * @class app.controllers.SiteController * @extends Jii.base.Controller */</span></span> Jii.defineClass(<span class="hljs-string"><span class="hljs-string">'app.controllers.SiteController'</span></span>, <span class="hljs-comment"><span class="hljs-comment">/** @lends app.controllers.SiteController.prototype */</span></span>{ <span class="hljs-attr"><span class="hljs-attr">__extends</span></span>: Jii.base.Controller, <span class="hljs-attr"><span class="hljs-attr">actionIndex</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">context</span></span></span><span class="hljs-function">) </span></span>{ context.response.data = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.render(<span class="hljs-string"><span class="hljs-string">'index'</span></span>); context.response.send(); }, <span class="hljs-attr"><span class="hljs-attr">actionHelloWorld</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">context</span></span></span><span class="hljs-function">) </span></span>{ context.response.data = <span class="hljs-string"><span class="hljs-string">'Hello World'</span></span>; context.response.send(); } });</code> </pre><br><h4>  Action classes </h4><br>  Actions can be defined as classes inherited from the <i>Jii.base.Action</i> or its descendants. <br><br>  To use such an action, you must specify it by overriding the <i>Jii.base.Controller.actions ()</i> method in your controller class, as follows: <br><br><pre> <code class="javascript hljs">actions: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> { <span class="hljs-comment"><span class="hljs-comment">//  "error"      error: 'app.actions.ErrorAction', //  "view"      view: { className: 'app.actions.ViewAction', viewPrefix: '' } }; }</span></span></code> </pre><br>  As you can see, the <i>actions ()</i> method should return an object whose keys are action IDs, and the values ‚Äã‚Äãare the corresponding action class names or [configuration] (concept-configurations).  Unlike inline actions, individual action IDs can contain arbitrary characters, as long as they are defined in the <i>actions ()</i> method. <br><br>  To create a separate action, you must inherit from the <i>Jii.base.Action</i> class or its descendants, and implement a public <i>run ()</i> method.  The role of the <i>run ()</i> method is similar to other action methods.  For example, <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/** * @class app.components.HelloWorldAction * @extends Jii.base.Action */</span></span> Jii.defineClass(<span class="hljs-string"><span class="hljs-string">'app.components.HelloWorldAction'</span></span>, <span class="hljs-comment"><span class="hljs-comment">/** @lends app.components.HelloWorldAction.prototype */</span></span>{ <span class="hljs-attr"><span class="hljs-attr">__extends</span></span>: Jii.base.Action, <span class="hljs-attr"><span class="hljs-attr">run</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">context</span></span></span><span class="hljs-function">) </span></span>{ context.response.data = <span class="hljs-string"><span class="hljs-string">'Hello World'</span></span>; context.response.send(); } });</code> </pre><br><h2>  Modules </h2><br>  Modules are self-sufficient program blocks consisting of models, views, controllers, and other auxiliary components.  When installing modules into an application, the end user gets access to their <br>  controllers.  For this reason, modules are often considered as miniature applications.  Unlike applications, modules cannot be created separately; they must be inside applications. <br><h4>  Creating modules </h4><br>  A module is placed in a directory called the <i>base</i> module <i>path</i> ( <i>Jii.base.Module.basePath</i> ).  As well as in the application directory, in this directory there are subdirectories <i>controllers</i> , <i>models</i> , <i>views</i> and others, in which controllers, models, views and other elements are located.  The following example shows the approximate contents of the module: <br><br><pre> <code class="javascript hljs">modules/ forum/ Module.js    controllers/     DefaultController.js      models/     views/       layouts/     <span class="hljs-keyword"><span class="hljs-keyword">default</span></span>/     DefaultController index.ejs   </code> </pre><br><h4>  Module Classes </h4><br>  Each module is declared using a unique class that inherits from <i>Jii.base.Module</i> .  This class must be placed in the root of the <i>base path of the</i> module.  During the launch of the application (worker) will be <br>  One instance of the corresponding module class has been created.  Like application instances, module instances are needed so that the module code can share data and components. <br><br>  Here is an example of what a module class might look like: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/** * @class app.modules.forum * @extends Jii.base.Module */</span></span> Jii.defineClass(<span class="hljs-string"><span class="hljs-string">'app.modules.forum.Module'</span></span>, <span class="hljs-comment"><span class="hljs-comment">/** @lends app.modules.forum.Module.prototype */</span></span>{ <span class="hljs-attr"><span class="hljs-attr">__extends</span></span>: Jii.base.Module, <span class="hljs-attr"><span class="hljs-attr">init</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">context</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.params.foo = <span class="hljs-string"><span class="hljs-string">'bar'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.__super(); } });</code> </pre><br><h4>  Module Controllers </h4><br>  When creating module controllers, it is customary to place controller classes in the controllers subspace of the module class namespace.  This also implies that the controller class files must be located in the <i>controllers</i> directory of the module's <i>base path</i> .  For example, to describe the <i>post</i> controller in the <i>forum</i> module from the previous example, the controller class is declared as follows: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> Jii = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'jii'</span></span>); <span class="hljs-comment"><span class="hljs-comment">/** * @class app.modules.forum.controllers.PostController * @extends Jii.base.Controller */</span></span> Jii.defineClass(<span class="hljs-string"><span class="hljs-string">'app.modules.forum.controllers.PostController'</span></span>, <span class="hljs-comment"><span class="hljs-comment">/** @lends app.modules.forum.controllers.PostController.prototype */</span></span>{ <span class="hljs-attr"><span class="hljs-attr">__extends</span></span>: Jii.base.Controller, <span class="hljs-comment"><span class="hljs-comment">// ... });</span></span></code> </pre><br>  You can change the namespace of controller classes by setting the <i>Jii.base.Module.controllerNamespace</i> property.  If any controllers fall out of this namespace, they can be accessed by setting the <i>Jii.base.Module.controllerMap</i> property, similar to how it is done in the application. <br><br><h4>  Using Modules </h4><br>  To use a module in an application, it is enough to include it in the <i>Jii.base.Application.modules</i> property in the application configuration.  The following code in the application configuration uses the <i>forum</i> module: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> config = { <span class="hljs-attr"><span class="hljs-attr">application</span></span>: { <span class="hljs-comment"><span class="hljs-comment">// ... modules: { forum: { className: 'app.modules.forum.Module', // ...    ... } } }, context: { // ... } };</span></span></code> </pre><br>  The Jii.base.Application.modules <i>property is</i> assigned an object containing the module configuration.  Each object key is a * module identifier *, which uniquely identifies a module among other application modules, and the corresponding object is a configuration for creating a module. <br><h4>  Access to modules </h4><br>  Access to the module instance can be obtained in the following way: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> <span class="hljs-built_in"><span class="hljs-built_in">module</span></span> = Jii.app.getModule(<span class="hljs-string"><span class="hljs-string">'forum'</span></span>);</code> </pre><br>  Having an instance of a module, you can access the parameters and components registered in the module.  For example, <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> maxPostCount = <span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.params.maxPostCount;</code> </pre><br><h1>  In custody </h1><br><div style="text-align:center;"><img src="https://habrastorage.org/files/a07/26c/01a/a0726c01a62a4d43bd0fa41603d8ee48.jpg"></div><br>  Below, I offer a survey about the format of the Jii code.  If you choose a non-JavaScript format, then indicate in the comments how you would solve the problems described in the section ‚ÄúWhy not ES6 classes (and not CoffeeScript / TypeScript)?‚Äù In this article. <br>  Let me remind you, Jii is an open source project, so I will be very happy if someone joins its development.  Write to affka@affka.ru. <br><br>  <a href="http://www.jiiframework.ru/">Framework</a> Site - <a href="http://www.jiiframework.ru/">jiiframework.ru</a> <br>  GitHub - <a href="https://github.com/jiisoft">https://github.com/jiisoft</a> <br>  Talk features on <a href="https://github.com/jiisoft/jii/issues/10">githab</a> <br><br>  Liked?  Put a <a href="https://github.com/jiisoft/jii/stargazers">star</a> on the githaba! <br><br><div class="spoiler">  <b class="spoiler_title">Article Navigation</b> <div class="spoiler_text"><ul><li>  <a href="http://habrahabr.ru/post/266929/">Jii: configuration and scaling</a> </li><li>  <a href="http://habrahabr.ru/post/260931/">Jii - a JavaScript framework with architecture from Yii 2</a> </li><li>  <a href="http://habrahabr.ru/post/260569/">Jii: Active Record for Node.js with API from Yii 2</a> </li><li>  <a href="http://habrahabr.ru/post/260295/">Jii: Full Query Builder for Node.js with API from Yii 2</a> </li></ul></div></div></div><p>Source: <a href="https://habr.com/ru/post/260931/">https://habr.com/ru/post/260931/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../260917/index.html">Ansible and ChatOps or how to manage 100+ servers from the chat</a></li>
<li><a href="../260919/index.html">The results of the distribution boards. Upgrade stock good</a></li>
<li><a href="../260923/index.html">Access rights - the owner can do anything</a></li>
<li><a href="../260927/index.html">What is Master Data and why is it needed?</a></li>
<li><a href="../260929/index.html">7 web design trends in the near future</a></li>
<li><a href="../260933/index.html">Zombie hunt from the cloud</a></li>
<li><a href="../260935/index.html">How to write a simple solver tsumego</a></li>
<li><a href="../260941/index.html">Google broke GCM in Chrome</a></li>
<li><a href="../260943/index.html">Intel Edison on guard of health. Experience "FRUIT MD"</a></li>
<li><a href="../260945/index.html">What you need to know about working with text preview emails</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>