<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Selection of the input mask by phone number</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This jQuery plugin allows you to automatically select the appropriate input mask based on the entered beginning of the phone number. This allows you t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Selection of the input mask by phone number</h1><div class="post__text post__text-html js-mediator-article">  This jQuery plugin allows you to automatically select the appropriate input mask based on the entered beginning of the phone number.  This allows you to make entering the phone number on the website page faster and more error-free.  In addition, the developed plugin can be used in other areas, if the input rules can be represented in the form of several input masks. <br><a name="habracut"></a><br><h4>  Introduction </h4><br>  Web sites require input of phone number information.  It so happened that each country has the right to set its own rules for dialing and the length of the number, resulting in confusion between residents of different countries: some are used to indicate the number with the leading number <code>8</code> , others with the leading number <code>0</code> , and still others with the <code>+</code> sign. <br><br><h4>  Review of existing solutions </h4><br>  In order to somehow resolve the arisen complexity and bring the numbers to a single format, there are 3 main solutions: <br><ol><li>  The user is prompted to enter the number using the input mask.  Advantage: the visual display of the number minimizes possible errors in the room.  Disadvantage: each country has its own spelling and number length. </li><li>  The user is prompted to select a country separately and separately enter the rest of the number;  possibly using an input mask.  Advantage: the ability to use different input masks for different countries (as well as regions within the country).  Disadvantages: the list of countries (and regions within each country) can be large;  the phone number ceases to exist as a whole (or preprocessing is required before storing and displaying the number). </li><li>  Put the <code>+</code> sign in front of the number (outside input) and allow only the input of numbers.  Advantages: ease of implementation.  Disadvantage: no visual display of the number. </li></ol><br><br><h4>  Proposed Solution </h4><br>  As a result, it was decided to modify the usual input mask so that it changed in accordance with the current value of the number.  In addition, as you enter the number, it is proposed to display the name of the determined country.  This approach, subjectively, should solve all the shortcomings of the above solutions. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Given that the number of countries in the world is relatively small, it was decided to compile a list of input masks for all countries.  As a source, <a href="http://www.itu.int/oth/T0202.aspx%3Fparent%3DT0202">information</a> published on the website of the International Telecommunication Union was used. <br><br>  The collection of this information gave a lot of surprises.  In the process of collecting information, it was necessary to take into account all possible variants of telephone numbers, including domestically.  However, due to the large amount of manually processed information, it is possible that there were inaccuracies in the collected database.  Over time, it is planned to make corrections to the initial set. <br><br><h4>  Software implementation </h4><br>  As the <code></code> of the input mask, the <a href="https://github.com/RobinHerbots/jquery.inputmask">jquery.inputmask</a> implementation was used, which was repeatedly mentioned in Habrahabr.  This plugin is now actively developing and, moreover, it is designed in such a way that it is enough for it to simply write extensions.  However, in this task, it was almost impossible to write such an extension.  I did not finish or rewrite the original plugin to fit my needs, because  its author continues to actively work on expanding the functionality, as a result of which the application of my edits can be problematic.  So I had to write a plugin add-on over the main core, which monitors (plus intercepts) external influences and modifies the data.  In order to implement their external impact handlers before the main plug-in <a href="https://github.com/private-face/jquery.bind-first">handlers, the jquery.bind-first</a> plugin library was <a href="https://github.com/private-face/jquery.bind-first">used</a> . <br><br><h5>  Sorting allowed input masks </h5><br>  To correctly select the most appropriate input mask, the entire set of masks must be pre-sorted in a special way.  In developing the rules for sorting, the following conventions were adopted: <br><ol><li>  All the characters in the input mask are divided into 2 types: meaningful characters (in my case it is the <code>#</code> symbol, meaning an arbitrary digit, and numbers 0-9) and decorator symbols (all the rest). </li><li>  Another division of characters in the input mask is template characters (in my case it is the <code>#</code> character) and all the others. </li></ol><br><br>  The result is the following sorting rules in the order in which they are applied: <br><ol><li>  When comparing 2 input masks character by character, only significant characters are taken into account (not decorators). </li><li>  Different wildcard characters are perceived as equal, and other significant characters are compared based on their code. </li><li>  Non-generic characters are always less patterned and as a result are placed higher. </li><li>  The shorter the length of significant characters in the input mask, the smaller the input mask is and is higher. </li></ol><br><br><h5>  Search for a suitable input mask </h5><br>  When comparing input text with a regular mask from a sorted list, only the significant characters of each mask are taken into account.  If the line is longer than the input mask, despite the fact that all previous characters have passed the test, this input mask is considered unsuitable.  If several input masks satisfy the input text, the first one is returned.  Then, in the found mask, all significant characters (including non-template ones) are replaced with wildcard characters, which is a combination of all the characters allowed by any of the wildcard characters. <br><br><h5>  Event Handling and Interception </h5><br>  In order to prevent conflicts with the event handlers of the main kernel of the input mask, the following events are intercepted: <br><ul><li>  <b>keydown</b> ‚Äî tracks Backspace and Delete are tracked ‚Äî in order to change the current input mask before the main processor removes one character from the text.  In addition, it tracks the keystroke Insert, which changes the text input mode for synchronization. </li><li>  <b>keypress</b> - since the input character may not be allowed by the original input mask (since all significant characters in it are replaced with wildcard characters), you need to check the new line for the satisfaction of one of the allowed masks.  If there are no such masks, the character input is discarded, otherwise, the input mask is updated, after which the event is passed to the kernel handler. </li><li>  <b>paste</b> , <b>input</b> - paste text from the clipboard.  Before transferring processing to the kernel, an input mask is selected for the line resulting from pasting text from the clipboard.  In case the input mask could not be picked up, a character reduction of the text from the end is performed ‚Äî until the text satisfies at least one input mask.  A similar operation is performed when correcting text in the input field by calling the function val (), as well as when initializing the input mask, if it is applied to a non-empty input field. </li><li>  <b>dragdrop</b> , <b>drop</b> - processing is similar to the paste event. </li><li>  <b>blur</b> - additional processing in case the text clearing mode is turned on when the focus is lost, if it does not satisfy the input mask.  This event is intercepted after the main handler, unlike the previous ones. </li></ul><br><br>  All events are <code></code> in the inputmask space.  This allows you to avoid incorrect behavior when calling inputmask after the add-in is initialized (since the kernel, during initialization, removes all previously installed handlers in the inputmask space). <br><br><h4>  Usage example </h4><br><h5>  The format of the list of masks </h5><br>  The list of masks is a JavaScript array of objects, preferably with the same set of properties.  At least one property that contains an input mask must be present for all objects in the array.  The name of the parameter containing the mask can be arbitrary.  Below is a fragment of such an array: <br><pre> <code class="javascript hljs">[ ‚Ä¶ { <span class="hljs-string"><span class="hljs-string">"mask"</span></span>: <span class="hljs-string"><span class="hljs-string">"+7(###)###-##-##"</span></span>, <span class="hljs-string"><span class="hljs-string">"cc"</span></span>: <span class="hljs-string"><span class="hljs-string">"RU"</span></span>, <span class="hljs-string"><span class="hljs-string">"name_en"</span></span>: <span class="hljs-string"><span class="hljs-string">"Russia"</span></span>, <span class="hljs-string"><span class="hljs-string">"desc_en"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"name_ru"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"desc_ru"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"mask"</span></span>: <span class="hljs-string"><span class="hljs-string">"+250(###)###-###"</span></span>, <span class="hljs-string"><span class="hljs-string">"cc"</span></span>: <span class="hljs-string"><span class="hljs-string">"RW"</span></span>, <span class="hljs-string"><span class="hljs-string">"name_en"</span></span>: <span class="hljs-string"><span class="hljs-string">"Rwanda"</span></span>, <span class="hljs-string"><span class="hljs-string">"desc_en"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"name_ru"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"desc_ru"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"mask"</span></span>: <span class="hljs-string"><span class="hljs-string">"+966-5-####-####"</span></span>, <span class="hljs-string"><span class="hljs-string">"cc"</span></span>: <span class="hljs-string"><span class="hljs-string">"SA"</span></span>, <span class="hljs-string"><span class="hljs-string">"name_en"</span></span>: <span class="hljs-string"><span class="hljs-string">"Saudi Arabia "</span></span>, <span class="hljs-string"><span class="hljs-string">"desc_en"</span></span>: <span class="hljs-string"><span class="hljs-string">"mobile"</span></span>, <span class="hljs-string"><span class="hljs-string">"name_ru"</span></span>: <span class="hljs-string"><span class="hljs-string">"  "</span></span>, <span class="hljs-string"><span class="hljs-string">"desc_ru"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span> }, { <span class="hljs-string"><span class="hljs-string">"mask"</span></span>: <span class="hljs-string"><span class="hljs-string">"+966-#-###-####"</span></span>, <span class="hljs-string"><span class="hljs-string">"cc"</span></span>: <span class="hljs-string"><span class="hljs-string">"SA"</span></span>, <span class="hljs-string"><span class="hljs-string">"name_en"</span></span>: <span class="hljs-string"><span class="hljs-string">"Saudi Arabia"</span></span>, <span class="hljs-string"><span class="hljs-string">"desc_en"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"name_ru"</span></span>: <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-string"><span class="hljs-string">"desc_ru"</span></span>: <span class="hljs-string"><span class="hljs-string">""</span></span> }, ‚Ä¶ ]</code> </pre><br><br><h5>  Plugin connection options </h5><br>  Before connecting you need to download and sort the list of masks.  This is done by performing the following function: <br><pre> <code class="javascript hljs">$.masksSort = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">maskList, defs, match, key</span></span></span><span class="hljs-function">)</span></span></code> </pre> <br><ul><li>  <b>maskList</b> - an array of objects that <b>contain</b> input masks (an object fragment, see above); </li><li>  <b>defs</b> - an array of <b>wildcard</b> characters (in my case it is the <code>#</code> character); </li><li>  <b>match</b> is a regular expression that describes significant characters (in my case, this is <code>/[0-9]|#/</code> ); </li><li>  <b>key</b> - the name of the parameter of the array object containing the input mask. </li></ul><br><br>  When connected, the plug-in is passed a special object that describes its operation.  This object contains the following set of parameters: <br><ul><li>  <b>inputmask</b> - an object containing parameters passed to the main inputmask plugin; </li><li>  <b>match</b> is a regular expression that describes significant characters, with the exception of wildcards; </li><li>  <b>replace</b> is a wildcard character to which all significant characters will be replaced;  may be missing in the inputmask definitions object; </li><li>  <b>list</b> - an array of objects describing input masks; </li><li>  <b>listKey</b> - the name of the parameter inside the object that stores the input mask; </li><li>  <b>onMaskChange</b> is a function that is called when the input mask is updated;  As the first parameter, an object is transferred from the array, the input mask of which corresponds to the entered text, and the second parameter is the mask definition accuracy: true - the input mask fully matches, false - for reliable mask definition, additional characters are required. </li></ul><br><br>  To initialize the plugin, you need to apply the inputmasks method to the input field: <br><pre> <code class="javascript hljs">$.fn.inputmasks = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">maskOpts, mode</span></span></span><span class="hljs-function">)</span></span></code> </pre> <br><ul><li>  <b>maskOpts</b> - an object that describes the operation of the plugin; </li><li>  <b>mode</b> is optional;  the <code>isCompleted</code> value is currently supported - as a result, the method returns <code>true</code> if the text corresponding to the matching mask is entered completely and <code>false</code> otherwise. </li></ul><br><br><h5>  Plugin connection example </h5><br><pre> <code class="javascript hljs">&lt;input type=<span class="hljs-string"><span class="hljs-string">"text"</span></span> id=<span class="hljs-string"><span class="hljs-string">"customer_phone"</span></span> value=<span class="hljs-string"><span class="hljs-string">"7"</span></span> size=<span class="hljs-string"><span class="hljs-string">"25"</span></span>&gt;&lt;br&gt; &lt;input type="checkbox" id="phone_mask" checked&gt; &lt;label id="descr" for="phone_mask"&gt; &lt;/label&gt; &lt;script&gt; var maskList = $.masksSort($.masksLoad("phone-codes.json"), ['#'], /[0-9]|#/, "mask"); var maskOpts = { inputmask: { definitions: { '#': { validator: "[0-9]", cardinality: 1 } }, //clearIncomplete: true, showMaskOnHover: false, autoUnmask: true }, match: /[0-9]/, replace: '#', list: maskList, listKey: "mask", onMaskChange: function(maskObj, completed) { if (completed) { var hint = maskObj.name_ru; if (maskObj.desc_ru &amp;&amp; maskObj.desc_ru != "") { hint += " (" + maskObj.desc_ru + ")"; } $("#descr").html(hint); } else { $("#descr").html(" "); } $(this).attr("placeholder", $(this).inputmask("getemptymask")); } }; $('#phone_mask').change(function() { if ($('#phone_mask').is(':checked')) { $('#customer_phone').inputmasks(maskOpts); } else { $('#customer_phone').inputmask("+[####################]", maskOpts.inputmask) .attr("placeholder", $('#customer_phone').inputmask("getemptymask")); $("#descr").html(" "); } }); $('#phone_mask').change(); &lt;/script&gt;</code> </pre><br><br><h4>  Demonstration </h4><br>  An example of a demonstration of the developed plugin is presented on <a href="http://andr-04.github.com/inputmask-multi/">the project page</a> . </div><p>Source: <a href="https://habr.com/ru/post/162537/">https://habr.com/ru/post/162537/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../162527/index.html">Year with Roomba</a></li>
<li><a href="../162529/index.html">Creating the perfect player</a></li>
<li><a href="../162531/index.html">Exporting polygons from Altium Designer to AutoCAD</a></li>
<li><a href="../162533/index.html">Urgent update of RVM (Ruby Version Manager)</a></li>
<li><a href="../162535/index.html">We write on php ... static</a></li>
<li><a href="../162539/index.html">How we reduced ping with OpenVPN</a></li>
<li><a href="../162541/index.html">NOOK for developers of children's mobile applications</a></li>
<li><a href="../162543/index.html">Frequency analysis of electrical network noise in forensics</a></li>
<li><a href="../162545/index.html">Official sales of iPad mini and iPhone 5 begin in Russia</a></li>
<li><a href="../162547/index.html">Ruby Science: thoughtbot's guide to creating quality applications in Ruby on Rails</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>