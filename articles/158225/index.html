<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Dynamic personalized reporting reporting tools Crystal Reports</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This post is for those who are faced with the task of dynamic personalized distribution of reports or any analytical materials. 

 Suppose your compan...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Dynamic personalized reporting reporting tools Crystal Reports</h1><div class="post__text post__text-html js-mediator-article">  This post is for those who are faced with the task of dynamic personalized distribution of reports or any analytical materials. <br><br>  Suppose your company has a network of branches and you need to adjust the weekly distribution of reports with the results of the work to branch managers.  The report should contain the results of the branch‚Äôs activity over the past week - tables, graphs, and analytical information.  Accordingly, for each branch the information in the report is unique. <br><br>  I'll tell you how this can be done quickly and easily. <br>  To solve the problem, we need <b>Crystal Reports 2008</b> and <b>Visual Studio 2010</b> (you can use earlier versions of the products). <a name="habracut"></a><br>  To automate the distribution of reports, it is necessary that all analytical information for the preparation of reports be contained in databases.  As a result, it is good to send data for each branch in one or several database queries before sending reports. <br>  Example query result: <br><img src="https://habrastorage.org/storage2/ca4/708/0cf/ca47080cf31994320c6310da215e286f.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Using Crystal Reports we can generate a report containing data on sales, expenses and other indicators for a separate branch.  We use the results of this query as the data source in the report, and in the Record Selection Formula we use a filter for one branch only.  For example, the branch number is 1: <pre><code class="cs hljs">{data.branch} = <span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> <br><br>  Since Crystal Reports is quite a flexible tool, using such tools as formulas and worksheets, you can create any document format: from a simple one-page report to a lengthy analytical study with tables and graphs. <br><br>  Further, by changing the Record Selection Formula, we can display information on any branch in the report. <br>  All we need to do next is to export the report to one of the formats (pdf, xls, rtf) and send it by email. <br><br><h5>  Consider how this can be automated. </h5><br>  First of all, we will need a table containing the numbers of the branches and the email of the recipient of the report.  We need to implement a cycle on the lines of this table.  Next, for each row, we take the branch number and substitute it in the Record Selection Formula of our report.  Next, export the report to a pdf file and attach this file to the letter.  We send the letter to the appropriate address. <br><br>  Crystal Reports not only provides a reporting development environment, but also development components for the NET platform. <br>  Below is a sample of Visual Basic code: <br><br><pre> <code class="cs hljs">Imports System.Net.Mail Imports System.IO Imports System.Net.<span class="hljs-function"><span class="hljs-function">NetworkCredential Imports CrystalDecisions Module Module1 Sub </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) '      Dim Rows1 As DataRow Dim Table1 As New myData.MailListDataSet.Query1DataTable Dim myDA As New myData.MailListDataSetTableAdapters.Query1TableAdapter Dim strDate</span></span> = Format(CDate(Today()), <span class="hljs-string"><span class="hljs-string">"ddMMyyyy"</span></span>) Dim myBranch As Integer Dim myBranchMail As String Dim myAppPath As String Dim myLogFilePath As String Dim myLogStr As String myAppPath = My.Application.Info.DirectoryPath <span class="hljs-string"><span class="hljs-string">' ,      Dim myDirInf As New DirectoryInfo(myAppPath + "\" + strDate) If Not myDirInf.Exists() Then myDirInf.Create() End If '</span></span>          myLogFilePath = myAppPath + <span class="hljs-string"><span class="hljs-string">"\" + strDate + "</span></span>\log.txt<span class="hljs-string"><span class="hljs-string">" Dim fs As StreamWriter = File.CreateText(myLogFilePath) '   ( ,   ) myDA.Fill(Table1) '  ReportDocument     Dim myReport As New CrystalDecisions.CrystalReports.Engine.ReportDocument myReport.FileName = myAppPath + "</span></span>\report1.rpt<span class="hljs-string"><span class="hljs-string">" '   For Each Rows1 In Table1.Rows '     myBranch = Rows1.Item(0) myBranchMail = Rows1.Item(1) ' Record Selection Formula myReport.RecordSelectionFormula = "</span></span>{data.branch} = <span class="hljs-string"><span class="hljs-string">" + CStr(myBranch) '  myReport.Refresh() Try '   pdf (   -    ) myReport.ExportToDisk([Shared].ExportFormatType.PortableDocFormat, myAppPath + "</span></span>\<span class="hljs-string"><span class="hljs-string">" + strDate + "</span></span>\Report <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> Branch <span class="hljs-string"><span class="hljs-string">" + CStr(myBranch) + "</span></span> <span class="hljs-string"><span class="hljs-string">" + strDate + "</span></span>.pdf<span class="hljs-string"><span class="hljs-string">") '       myLogStr = CStr(Now()) + "</span></span>: <span class="hljs-string"><span class="hljs-string">" + "</span></span>generate file <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> Branch <span class="hljs-string"><span class="hljs-string">" + CStr(myBranch) + Chr(13) + Chr(10) Console.Write(myLogStr) fs.Write(myLogStr) Catch exp As Exception '      Console.WriteLine("</span></span>Erorr:<span class="hljs-string"><span class="hljs-string">" &amp; exp.Message) myLogStr = CStr(Now()) + "</span></span>: Erorr<span class="hljs-string"><span class="hljs-string">" &amp; exp.Message &amp; "</span></span> when generate file <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> Branch <span class="hljs-string"><span class="hljs-string">" + CStr(myBranch) + Chr(13) + Chr(10) Console.Write(myLogStr) fs.Write(myLogStr) End Try ' Smtp Client      Dim mySmtp As New System.Net.Mail.SmtpClient("</span></span>company.com<span class="hljs-string"><span class="hljs-string">") mySmtp.Credentials = New System.Net.NetworkCredential("</span></span>user<span class="hljs-string"><span class="hljs-string">", "</span></span>password<span class="hljs-string"><span class="hljs-string">") ' ,     Dim myMsg As New System.Net.Mail.MailMessage("</span></span>mail@example.com<span class="hljs-string"><span class="hljs-string">", myBranchMail, "</span></span>   X<span class="hljs-string"><span class="hljs-string">", _ "</span></span>   <span class="hljs-string"><span class="hljs-string">" + CStr(myBranch) + "</span></span>,      .<span class="hljs-string"><span class="hljs-string">") '     pdf  Dim myAtt As New System.Net.Mail.Attachment(myAppPath + "</span></span>\<span class="hljs-string"><span class="hljs-string">" + strDate + "</span></span>\Report <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> Branch <span class="hljs-string"><span class="hljs-string">" + CStr(myBranch) + "</span></span> <span class="hljs-string"><span class="hljs-string">" + strDate + "</span></span>.pdf<span class="hljs-string"><span class="hljs-string">") myMsg.Attachments.Add(myAtt) Try '  mySmtp.Send(myMsg) '       myLogStr = CStr(Now()) + "</span></span>: <span class="hljs-string"><span class="hljs-string">" + "</span></span>sending file <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> Branch <span class="hljs-string"><span class="hljs-string">" + CStr(myBranch) + "</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> <span class="hljs-string"><span class="hljs-string">" + myBranchMail + Chr(13) + Chr(10) Console.Write(myLogStr) fs.Write(myLogStr) Catch exp As Exception '      Console.WriteLine("</span></span>Erorr:<span class="hljs-string"><span class="hljs-string">" &amp; exp.Message) myLogStr = CStr(Now()) + "</span></span>: Erorr<span class="hljs-string"><span class="hljs-string">" &amp; exp.Message &amp; "</span></span> when sending file <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> Branch <span class="hljs-string"><span class="hljs-string">" + CStr(myBranch) + Chr(13) + Chr(10) Console.Write(myLogStr) fs.Write(myLogStr) End Try Next Rows1 fs.Close() End Sub End Module</span></span></code> </pre><br><br>  Using code, you can make a console application and run it on a schedule, or you can use it in the ETL SSIS package (MS SQL Server Integration Services). </div><p>Source: <a href="https://habr.com/ru/post/158225/">https://habr.com/ru/post/158225/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../158213/index.html">Designing an application architecture using dependency inversion</a></li>
<li><a href="../158215/index.html">Freelance School</a></li>
<li><a href="../158217/index.html">DARPA is working on an intelligent crime prediction system.</a></li>
<li><a href="../158219/index.html">We work with SteamWorks. Part 3</a></li>
<li><a href="../158223/index.html">Life in the era of "dark" silicon. Part 1</a></li>
<li><a href="../158229/index.html">Experience developing a plugin for Yasca</a></li>
<li><a href="../158231/index.html">Pseudo-Holography Screen Technologies</a></li>
<li><a href="../158233/index.html">Karateka game remake</a></li>
<li><a href="../158235/index.html">Writing a plugin for jQuery</a></li>
<li><a href="../158239/index.html">About cameras and lenses</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>