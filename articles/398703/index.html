<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Google Neural Network arbitrarily styles images in real time</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The neural network from Google imposes on the photo any of the 32 styles taught (five are shown here). The program is undemanding to the gland and mem...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Google Neural Network arbitrarily styles images in real time</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/548/ad4/483/548ad4483bd749c9b1378f319b1abc95.jpg"><br>  <i>The neural network from Google imposes on the photo any of the 32 styles taught (five are shown here).</i>  <i>The program is undemanding to the gland and memory.</i>  <i>The code will be published soon</i> <br><br>  Synthesis of textures with transfer of style from one image to another is a well-known technique, which is 15 years old.  It was first described in the article <i>‚Äú <a href="http://mrl.nyu.edu/publications/image-analogies/">Analogies in Image</a> ‚Äù by a</i> group of researchers from Microsoft Research for the SIGGRAPH 2001 conference, as well as in the article <i>‚Äú <a href="http://mrl.nyu.edu/publications/image-analogies/">Embedding an image for texture synthesis and transfer</a> ‚Äù</i> from Mitsubishi Electric Research and the University of California at Berkeley in the same 2001  Now it is difficult to say which one appeared earlier. <br><br>  In 2015, the technique received a second life when neural networks connected to the synthesis of images with the transfer of style.  This happened after the release of the scientific work <i>" <a href="https://arxiv.org/abs/1508.06576">Neuroalgorithm of artistic style</a> "</i> Gatis, Ecker and Betge from Eberhard-Karl University in T√ºbingen, Germany ( <a href="https://geektimes.ru/post/261116/">article on Geektimes</a> ).  The work is so impressive that the described algorithm was soon implemented in several computer programs for the consumer market, including mobile applications like the Russian <a href="https://ru.wikipedia.org/wiki/Prisma">Prisma</a> (June 2016). <br><a name="habracut"></a><br>  The work of Gatis, Ecker and Betge is good because the authors taught the neural network on existing works of famous artists: Vincent Van Gogh, Pablo Picasso, Edvard Munch and others.  In this case, the neural network can continue to train on other data sets, so it is a universal tool.  Such a neural network works on the Prisma server and other companies that distribute mobile applications for styling user photos. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The Gatis, Ecker and Betge convolutional neural networks are based on the <a href="">19-layer Simonyan and Zisserman VGG neural networks</a> , and the processing of the original image takes place in several stages.  At each stage in the hierarchy, the number of filters increases.  Styling for a specific style occurs in the first stages of downsampling (broad strokes, cubist patterns, etc.), and the last layers of the neural network process the original image so that the objects remain recognizable ( <i>d</i> and <i>e</i> in the diagram).  The neural network starts working from a random position (or from the source image) until the result satisfies the specified requirements. <br><br><img src="https://habrastorage.org/files/27e/6d8/0bb/27e6d80bb8cc47a696cb67a73e251cc0.png"><br><br>  In a neural network, content and style representations are separated from each other.  Thus, they can be controlled independently of each other.  For example, to take content from one image, and style - from another. <br><br><img src="https://habrastorage.org/files/e52/0dc/1ee/e520dc1eea4b414d87e0060e53a449d0.jpg"><br>  <i>Examples of image styling in the Gatis, Ecker and Betge neural networks</i> <br><br>  <b>Original image: Old Town in T√ºbingen</b> <br><img src="https://habrastorage.org/getpro/geektimes/post_images/789/4fe/227/7894fe227ce77b511ff98b51dcbf1c57.jpg"><br><br>  <b>Sample style: the <a href="https://www.google.com/culturalinstitute/beta/u/0/asset/head-of-a-clown/CQHMqKf7DRo76w">painting "The head of a clown"</a> (1907-1908), Georges Rouault, style: expressionism</b> <br><img src="https://habrastorage.org/files/94d/c24/adc/94dc24adcdd04ec69039fc9e973f92c8.jpg"><br><br>  <b>The result of the neural network</b> <br><img src="https://habrastorage.org/getpro/geektimes/post_images/780/f74/f24/780f74f24cfd4af1a115a780779b99b5.png"><br><br>  This work is considered a fundamental breakthrough in depth learning technologies, because this is the first conceptual proof of the transfer of artistic style through a neural network.  What was considered artistic vision, the author's style and genre of art, successfully succumbs to formalization and is assimilated by the neural network.  Artificial intelligence first mastered the real creativity. <br><br>  The idea of ‚Äã‚Äãseparating the style and content of the picture created a variety of neural networks, including for <a href="https://geektimes.ru/post/281826/">generating frightening images</a> and for <a href="https://geektimes.ru/post/281714/">generating pornographic</a> <a href="https://geektimes.ru/post/281826/">images</a> . <br><br>  Unfortunately, the Gatis, Ecker and Betge neural networks have a drawback: such a neural network is too demanding of computational resources.  This became clear after the release of the first demo applications that were processed on the server for several minutes. <br><br>  In subsequent works, <a href="https://arxiv.org/abs/1603.03417">including Russian specialists</a> , the neural network was significantly optimized due to the limitation of functionality.  As a result, optimization has reached such an extent that instead of a few minutes, the stylization of the photo began to occur almost instantly.  So there was an opportunity to stylize <a href="https://geektimes.ru/post/275788/">even live video</a> ! <br><br>  But similar styling has a reverse side of the coin.  Ultra-fast styling is possible only if <i>one</i> image is taken as a sample.  This is a limitation of the original algorithm, because it is not tied to one style.  In other words, if you want to make a system capable of transmitting 100 different styles, then you will have to pre-train 100 different neural networks. <br><br>  Now Google has contributed to this research.  On October 24, 2016, Google Brain Team employees published <a href="https://arxiv.org/abs/1610.07629">an article</a> describing an algorithm that works as fast as the previous ones, but at the same time in a single universal neural network that can superimpose any learned styles. <br><br>  According <a href="https://research.googleblog.com/2016/10/supercharging-style-transfer.html">to the</a> developers, their algorithm is simple to implement and does not impose high requirements for RAM.  Moreover, after training in several styles, he is able to combine <b>several styles at the same time</b> and works in real time.  For example, here is a photo of the same Old Town in T√ºbingen, on which <i>four styles are</i> applied <i>simultaneously</i> . <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/0dd/8ef/737/0dd8ef737cf627f976d818c8a2ab187f.jpg"><br><br>  Researchers believe that their work opens up new opportunities for the creative use of neural network styling.  In the near future <a href="https://magenta.tensorflow.org/">on the Magenta blog,</a> they promise to publish the source code of the program for TensorFlow, so that everyone can run the demo on their computer. <br><br>  More information about the stylization of images in the neural network is described in the popular science <a href="https://www.youtube.com/watch%3Fv%3DWHmp26bh0tI">video</a> .  It was recorded by two Nat and Lo employees in 20% of their working time, which Google allocates for projects of its choice. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/WHmp26bh0tI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div><p>Source: <a href="https://habr.com/ru/post/398703/">https://habr.com/ru/post/398703/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../398685/index.html">Scientists have figured out which drugs you should not drink before implantation of teeth.</a></li>
<li><a href="../398689/index.html">Enterprise pagers are a source of critical information leaks.</a></li>
<li><a href="../398691/index.html">Difficult road to mars</a></li>
<li><a href="../398695/index.html">The Schiaparelli computer probably determined a successful landing at an altitude of 2-4 km</a></li>
<li><a href="../398701/index.html">My biohacking experience. Part 1: RFID</a></li>
<li><a href="../398705/index.html">Tesla Motors profit for the third quarter exceeded expectations despite the onset of Uber and Model X security problems</a></li>
<li><a href="../398707/index.html">Myths and Reality: What you need to know about modern audio systems</a></li>
<li><a href="../398711/index.html">Ultrasonic wireless technology allows you to monitor Internet users</a></li>
<li><a href="../398713/index.html">We print on a 3D printer magnets of a given shape</a></li>
<li><a href="../398715/index.html">Geek Halloween: Unusual DIY Halloween Costumes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>