<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How we integrated Teamlab with Google Drive and increased attendance 4 times</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The beginning of the year was marked for our team by many innovations promised at the end of 2013. The loudest, of course, was the release of the free...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How we integrated Teamlab with Google Drive and increased attendance 4 times</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/8e7/532/643/8e7532643ceed86498aa77483024f2cd.png"><br><br>  The beginning of the year was marked for our team by many innovations <a href="http://habrahabr.ru/company/teamlab/blog/207476/">promised</a> at the end of 2013.  The loudest, of course, was the release of the free office suite <a href="https://personal.teamlab.com/">Teamlab Personal</a> , which even won a <a href="http://techcrunch.com/2014/01/09/teamlab/">publication</a> on TechCrunch. <br><br>  Last week, we <a href="http://www.teamlab.com/blog/2014/04/teamlab-personal-integrirovalsya-s-google-drive-cherez-prilozhenie-dlya-chrome-store/%3Flang%3Dru">announced the</a> integration of Teamlab editors with Google Drive through an app in the Chrome Store.  In short, you can now work with documents from Google Drive in Teamlab editors. <br>  Under the cut, we will talk about the stages of implementation, the technical difficulties we faced, and of course, the results.  There will be several paragraphs for developers and one for marketers.  If you do not want to read, you can immediately install the <a href="https://chrome.google.com/webstore/detail/teamlab-personal/iohfebkcjhlelaoibebeohcgkohkcgpn%3Fhl%3Dru">application</a> from the Chrome Store and figure it all out on your own. <br><a name="habracut"></a><br><h4>  <b>Summary of the previous series</b> </h4><br>  In January, we added Teamlab Personal to the Chrome Store as a link to the app site.  In fact, this link did not have any practical benefits, however, we really really wanted to quickly get into the coveted Chrome Store.  Therefore, we added a minimal version (which miraculously gathered more than 2000 users), and began to think how to expand its functionality. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The only similar solution that exists today is <a href="https://chrome.google.com/webstore/detail/zoho-writer/jgaeidloagadfcohacebhbkkapgpiddj%3Fhl%3Den">Zoho</a> , which is also integrated with Google Drive and allows you to edit Google Maps in your applications.  We looked at this decision, criticized and decided to make our own, only with blackjack. <br><br><h4>  <b>Integration goals</b> </h4><br>  From a technical point of view, it was necessary to implement the following: <br><br><ul><li>  Integration of Teamlab Office viewing and editing tools into the Google Drive storage. </li><li>  Providing collaborative editing features in Teamlab Office. </li><li>  Convert files and create new ones in the standard Microsoft Office format. </li><li>  Using Google account information to authenticate to Teamlab Personal. </li></ul><br>  !  An important part of the implementation is that the files are not with us, but in the Google Drive storage.  On the Teamlab side, <b>only editors tools</b> are used. <br><br>  From the user's point of view, we offer the opportunity to work with documents in a full-featured editor, apply complex formatting, not worry about format conversion, <s>and finally forget about the heavy Microsoft Office,</s> without leaving your usual G-account. <br><br><h4>  <b>Stages of implementation</b> </h4><br><ol><li>  We register in <a href="https://console.developers.google.com/project">the developer console</a> , add the project and get the keys for authorization in the application.  Drive API and Drive SDK are connected to the application.  I would like to note that the Drive SDK settings interface is very outdated, unlike the rest of the functionality, and quite often there were difficulties with adding icons, which even wrote a cart to Google support (guess if an answer was received). </li><li>  Download the required file icons and application icons (5 sizes). </li><li>  For authorization, we specify the authorization key, the Osprey to receive email, account information and file information, and the address for processing the Google authorization request to personal.teamlab.com. </li><li>  Further we indicate the main file formats for opening in the application: docx, xlsx, pptx.  In the future, if you select our application in Google Drive by default, these files will open in one click.  We also added secondary formats: ppt, pps, odp, doc, odt, rtf, txt, xls, csv, ods, mht, html, htm, fb2, epub, pdf, djvu.  When you open a file of these formats, the application will create a converted copy of the Office Open Xml format in the same folder and open it in the editor.  The same action will be performed for the internal format of Google Drive. </li><li>  In the Google Chrome Web Store, we created the Teamlab Personal application, in the manifest of which the container for communication with Google Drive is specified: ‚Äúcontainer‚Äù: ‚ÄúGOOGLE_DRIVE‚Äù and the identifier of our application from the developer console. <br><pre><code class="javascript hljs"><span class="hljs-string"><span class="hljs-string">"container"</span></span> : <span class="hljs-string"><span class="hljs-string">"GOOGLE_DRIVE"</span></span>, <span class="hljs-string"><span class="hljs-string">"api_console_project_id"</span></span> : <span class="hljs-string"><span class="hljs-string">"YOUR_APP_ID"</span></span></code> </pre>  When installing Teamlab Personal from Webstore, the application will automatically be connected to Google Drive. </li><li>  When you open a file or create a new one, a request is sent to the address in personal.teamlab.com with information about the action and code necessary to obtain an authorization token using the OAuth 2.0 protocol.  The token is used when working with the Drive API.  The application accesses Google Drive in only two ways: file retrieval and saving. </li></ol><br><h4>  <b>Result.</b>  <b>How it works</b> </h4><br>  You install the <a href="https://chrome.google.com/webstore/detail/teamlab-personal/iohfebkcjhlelaoibebeohcgkohkcgpn%3Fhl%3Dru">Teamlab Personal</a> app from the Chrome Store ‚Äî the Teamlab icon automatically appears in your Google Drive account when creating new documents and editing existing documents.  When you click it, the document opens in the Teamlab editor, and at the end of the work it is saved back to Disk. <br><img src="https://habrastorage.org/getpro/habr/post_images/6a3/2bc/d66/6a32bcd669554cb26716c65dfcc95ece.jpg"><br>  If you configure the use of Teamlab Personal by default, then docx, xlsx and pptx will open in it immediately.  For other documents, a copy is created in the generally accepted format, which is stored here, next to the original Google account. <br><br><h4>  <b>How did we differ from Zoho</b> </h4><br><ol><li>  Zoho requires full access rights to your Drive, we are minimal. </li><li>  Zoho converts documents into its own zdoc format, we - into the generally accepted Office Open XML. </li><li>  Zoho provides separately editors of texts, tables and presentations - we have everything in one application. </li></ol><br><img src="https://habrastorage.org/getpro/habr/post_images/ea4/5c5/fe5/ea45c5fe546db0acfd5bba967ed43880.png"><img src="https://habrastorage.org/getpro/habr/post_images/a2c/00c/8f1/a2c00c8f154056164e476cf6f25bc601.png"><br>  Well, comparing editing capabilities in Zoho and Teamlab is generally a topic for a <a href="http://habrahabr.ru/company/teamlab/blog/141434/">separate post</a> :-) <br><br><h4>  <b>Unsolved problem</b> </h4><br>  The main difficulty we encountered in the implementation process was the ability to process Google Sheets of a <a href="http://habrahabr.ru/post/205720/">new format</a> .  When you try to access them for editing, an authorization error is issued.  The problem is solved quite simply: you need to ask the user for full access rights (as did Zoho).  But who wants to give so much information to a third-party application?  Google developers themselves a year ago at Staskkoverflow <a href="http://stackoverflow.com/questions/16273408/retrieving-google-doc-with-drive-api-has-stopped-working">promised to</a> fix the problem, but apparently, they didn‚Äôt roll out the updates. <br><br>  In general, we decided that it was not nice to demand full user rights, so the new tables in Teamlab are not available until Google fixes the error. <br><br><h4>  <b>Paragraph for marketers</b> </h4><br><img src="https://habrastorage.org/getpro/habr/post_images/249/529/55f/24952955feb439b2d206c10b63be44a1.png"><br>  <i>Chrome Store Chart Store</i> <br><br>  A small but very important detail that appears when you integrate your application with Google Drive is this icon: <img src="https://habrastorage.org/getpro/habr/post_images/f77/787/8fe/f777878feee6d96861d1381158cc13a1.png"><br><br>  She seems to be hinting that you are in the catalog of <a href="https://chrome.google.com/webstore/category/collection/drive_apps%3Futm_source%3Dchrome-ntp-icon">applications for the Disk</a> , and you are now an order of magnitude more likely to be noticed.  Well, in general, literally in 1 evening, the traffic to <a href="https://personal.teamlab.com/">Teamlab Personal</a> website jumped 4 times, the requisition curve from google accounts began to jerk hysterically, the number of hits in the chrome store went over the edge, and we are now among the first in some languages on the requests we need. <br><img src="https://habrastorage.org/getpro/habr/post_images/4d1/071/9f9/4d10719f9f8be672e20bcfd949379be0.png"><br><br>  Why all?  Because the application is useful and made with love. </div><p>Source: <a href="https://habr.com/ru/post/218889/">https://habr.com/ru/post/218889/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../218873/index.html">How to create and earn money on SaaS (Part 4 / StartTap Quickme - communication and collaboration of small teams)</a></li>
<li><a href="../218881/index.html">Launch of Brain Basket, April 15, NSC Olympic</a></li>
<li><a href="../218883/index.html">Development of sensors with Bluetooth low energy radio interface</a></li>
<li><a href="../218885/index.html">Navigator for the project: MS Project + formulas + indicators</a></li>
<li><a href="../218887/index.html">Analysis of the application protected by the virtual machine</a></li>
<li><a href="../218893/index.html">IT subsystems of the sports center: pre-reality, security, medicine, point accounting, etc.</a></li>
<li><a href="../218895/index.html">(For) what is feeding and watering developers in the office ?!</a></li>
<li><a href="../218897/index.html">Quadcopter control using Oculus Rift</a></li>
<li><a href="../218899/index.html">Yandex investigated how the Internet developed in the regions of Russia in 2013</a></li>
<li><a href="../218903/index.html">Open Terminal Client OTC-110 - we are already selling</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>