<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Date conversion to international format (UTC). Template for XSLT versions from 1.0</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It was necessary to translate the date in xml files from Moscow time to international time. Initially, the problem was solved by inserting Java squeak...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Date conversion to international format (UTC). Template for XSLT versions from 1.0</h1><div class="post__text post__text-html js-mediator-article">  It was necessary to translate the date in xml files from Moscow time to international time.  Initially, the problem was solved by inserting Java squeak, but it took to use only the built-in features of XSLT 1.0. <br>  Immediately I warn commenters that the XSLT 2.0 version, where there is a Date data type, is no good, it needs to be implemented exactly in 1.0. <br><br>  <a href="http://ifolder.ru/19775609">Download an example, template, result and parser here.</a> <br><br>  So, the steps to solve the problem: <br><ul><li>  Splitting the original date in our format into components. </li><li>  Determination of the time zone offset relative to UTC, taking into account the transition to winter / summer time, for Moscow in the summer offset -4, in winter -3.  Daylight saving time occurs at two o'clock in the morning on the last Sunday of March, transition to winter time at three in the morning on the last Sunday in October. </li><li>  Translation of all parts of the date in UTC time </li><li>  Collect dates in UTC format. </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Subtasks: <br><ul><li>  Search for the day of the week, using the Zeller formula </li><li>  Find the number of days in the month </li><li>  Leap year check </li></ul><br><br>  Original Date Pattern: <br>  DD.MM.YYYY hh: mm: ss <br>  You can easily correct the XSL for your format, just change the cutting sequence and specify the delimiters. <br><br>  UTC date format: <br>  YYYY-MM-DD hh: mm: ss <br>  Corrected even easier when collecting the final line. <br><br>  If other time zone offset values ‚Äã‚Äãare required, it is sufficient to correct them in the MoscowOffsetTime function. <br><br>  Template use: <br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">&lt;xsl:call-template name= <font color="#A31515">"GetTime"</font> &gt; <br> &lt;xsl:with-param name= <font color="#A31515">"time"</font> <font color="#0000ff">select</font> = <font color="#A31515">"10.15.2010 14:10:17"</font> &gt;&lt;/xsl:with-param&gt; <br> &lt;/xsl:call-template&gt;</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br><a name="habracut"></a><br>  Actually the template code itself: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">&lt;xsl:template name= <font color="#A31515">"GetTime"</font> &gt; <br> &lt;xsl:param name= <font color="#A31515">"time"</font> &gt;&lt;/xsl:param&gt; <br> &lt;xsl:call-template name= <font color="#A31515">"MoscowDataToUTC"</font> &gt; <br> &lt;xsl:with-param name= <font color="#A31515">"data"</font> <font color="#0000ff">select</font> = <font color="#A31515">"$time"</font> &gt;&lt;/xsl:with-param&gt; <br> &lt;/xsl:call-template&gt; <br> &lt;/xsl:template&gt; <br> <br> &lt;xsl:template name= <font color="#A31515">"MoscowDataToUTC"</font> &gt; <br> &lt;xsl:param name= <font color="#A31515">"data"</font> /&gt; <br> &lt;xsl:variable name= <font color="#A31515">"vData"</font> &gt; <br> &lt;xsl:call-template name= <font color="#A31515">"splitEqFirst"</font> &gt; <br> &lt;xsl:with-param name= <font color="#A31515">"str"</font> <font color="#0000ff">select</font> = <font color="#A31515">"$data"</font> &gt;&lt;/xsl:with-param&gt; <br> &lt;xsl:with-param name= <font color="#A31515">"worddiv"</font> <font color="#0000ff">select</font> = <font color="#A31515">"' '"</font> /&gt; <br> &lt;/xsl:call-template&gt; <br> &lt;/xsl:variable&gt; <br> &lt;xsl:variable name= <font color="#A31515">"vDataDD"</font> &gt; <br> &lt;xsl:call-template name= <font color="#A31515">"splitEqFirst"</font> &gt; <br> &lt;xsl:with-param name= <font color="#A31515">"str"</font> <font color="#0000ff">select</font> = <font color="#A31515">"$vData"</font> &gt;&lt;/xsl:with-param&gt; <br> &lt;xsl:with-param name= <font color="#A31515">"worddiv"</font> <font color="#0000ff">select</font> = <font color="#A31515">"'.'"</font> /&gt; <br> &lt;/xsl:call-template&gt; <br> &lt;/xsl:variable&gt; <br> &lt;xsl:variable name= <font color="#A31515">"vDataBuf"</font> &gt; <br> &lt;xsl:call-template name= <font color="#A31515">"splitEqSecond"</font> &gt; <br> &lt;xsl:with-param name= <font color="#A31515">"str"</font> <font color="#0000ff">select</font> = <font color="#A31515">"$vData"</font> &gt;&lt;/xsl:with-param&gt; <br> &lt;xsl:with-param name= <font color="#A31515">"worddiv"</font> <font color="#0000ff">select</font> = <font color="#A31515">"'.'"</font> /&gt; <br> &lt;/xsl:call-template&gt; <br> &lt;/xsl:variable&gt; <br> &lt;xsl:variable name= <font color="#A31515">"vDataMM"</font> &gt; <br> &lt;xsl:call-template name= <font color="#A31515">"splitEqFirst"</font> &gt; <br> &lt;xsl:with-param name= <font color="#A31515">"str"</font> <font color="#0000ff">select</font> = <font color="#A31515">"$vDataBuf"</font> &gt;&lt;/xsl:with-param&gt; <br> &lt;xsl:with-param name= <font color="#A31515">"worddiv"</font> <font color="#0000ff">select</font> = <font color="#A31515">"'.'"</font> /&gt; <br> &lt;/xsl:call-template&gt; <br> &lt;/xsl:variable&gt; <br> &lt;xsl:variable name= <font color="#A31515">"vDataYYYY"</font> &gt; <br> &lt;xsl:call-template name= <font color="#A31515">"splitEqSecond"</font> &gt; <br> &lt;xsl:with-param name= <font color="#A31515">"str"</font> <font color="#0000ff">select</font> = <font color="#A31515">"$vDataBuf"</font> &gt;&lt;/xsl:with-param&gt; <br> &lt;xsl:with-param name= <font color="#A31515">"worddiv"</font> <font color="#0000ff">select</font> = <font color="#A31515">"'.'"</font> /&gt; <br> &lt;/xsl:call-template&gt; <br> &lt;/xsl:variable&gt; <br> &lt;xsl:variable name= <font color="#A31515">"vTime"</font> &gt; <br> &lt;xsl:call-template name= <font color="#A31515">"splitEqSecond"</font> &gt; <br> &lt;xsl:with-param name= <font color="#A31515">"str"</font> <font color="#0000ff">select</font> = <font color="#A31515">"$data"</font> &gt;&lt;/xsl:with-param&gt; <br> &lt;xsl:with-param name= <font color="#A31515">"worddiv"</font> <font color="#0000ff">select</font> = <font color="#A31515">"' '"</font> /&gt; <br> &lt;/xsl:call-template&gt; <br> &lt;/xsl:variable&gt; <br> &lt;xsl:variable name= <font color="#A31515">"vTimeHH"</font> &gt; <br> &lt;xsl:call-template name= <font color="#A31515">"splitEqFirst"</font> &gt; <br> &lt;xsl:with-param name= <font color="#A31515">"str"</font> <font color="#0000ff">select</font> = <font color="#A31515">"$vTime"</font> &gt;&lt;/xsl:with-param&gt; <br> &lt;xsl:with-param name= <font color="#A31515">"worddiv"</font> <font color="#0000ff">select</font> = <font color="#A31515">"':'"</font> /&gt; <br> &lt;/xsl:call-template&gt; <br> &lt;/xsl:variable&gt; <br> &lt;xsl:variable name= <font color="#A31515">"vTimeBuf"</font> &gt; <br> &lt;xsl:call-template name= <font color="#A31515">"splitEqSecond"</font> &gt; <br> &lt;xsl:with-param name= <font color="#A31515">"str"</font> <font color="#0000ff">select</font> = <font color="#A31515">"$vTime"</font> &gt;&lt;/xsl:with-param&gt; <br> &lt;xsl:with-param name= <font color="#A31515">"worddiv"</font> <font color="#0000ff">select</font> = <font color="#A31515">"':'"</font> /&gt; <br> &lt;/xsl:call-template&gt; <br> &lt;/xsl:variable&gt; <br> &lt;xsl:variable name= <font color="#A31515">"vTimeMM"</font> &gt; <br> &lt;xsl:call-template name= <font color="#A31515">"splitEqFirst"</font> &gt; <br> &lt;xsl:with-param name= <font color="#A31515">"str"</font> <font color="#0000ff">select</font> = <font color="#A31515">"$vTimeBuf"</font> &gt;&lt;/xsl:with-param&gt; <br> &lt;xsl:with-param name= <font color="#A31515">"worddiv"</font> <font color="#0000ff">select</font> = <font color="#A31515">"':'"</font> /&gt; <br> &lt;/xsl:call-template&gt; <br> &lt;/xsl:variable&gt; <br> &lt;xsl:variable name= <font color="#A31515">"vTimeSS"</font> &gt; <br> &lt;xsl:call-template name= <font color="#A31515">"splitEqSecond"</font> &gt; <br> &lt;xsl:with-param name= <font color="#A31515">"str"</font> <font color="#0000ff">select</font> = <font color="#A31515">"$vTimeBuf"</font> &gt;&lt;/xsl:with-param&gt; <br> &lt;xsl:with-param name= <font color="#A31515">"worddiv"</font> <font color="#0000ff">select</font> = <font color="#A31515">"':'"</font> /&gt; <br> &lt;/xsl:call-template&gt; <br> &lt;/xsl:variable&gt; <br> &lt;!--   --&gt; <br> &lt;xsl:variable name= <font color="#A31515">"deltaTime"</font> &gt; <br> &lt;xsl:call-template name= <font color="#A31515">"MoscowOffsetTime"</font> &gt; <br> &lt;xsl:with-param name= <font color="#A31515">"day"</font> <font color="#0000ff">select</font> = <font color="#A31515">"$vDataDD"</font> &gt;&lt;/xsl:with-param&gt; <br> &lt;xsl:with-param name= <font color="#A31515">"hh"</font> <font color="#0000ff">select</font> = <font color="#A31515">"$vTimeHH"</font> &gt;&lt;/xsl:with-param&gt; <br> &lt;xsl:with-param name= <font color="#A31515">"month"</font> <font color="#0000ff">select</font> = <font color="#A31515">"$vDataMM"</font> &gt;&lt;/xsl:with-param&gt; <br> &lt;xsl:with-param name= <font color="#A31515">"year"</font> <font color="#0000ff">select</font> = <font color="#A31515">"$vDataYYYY"</font> &gt;&lt;/xsl:with-param&gt; <br> &lt;/xsl:call-template&gt; <br> &lt;/xsl:variable&gt; <br> &lt;!--  UTC  --&gt; <br> &lt;!-- ,         ,     1--&gt; <br> &lt;xsl:variable name= <font color="#A31515">"vDataYYYYUTC"</font> &gt; <br> &lt;xsl:call-template name= <font color="#A31515">"MoscowYearToUTCYear"</font> &gt; <br> &lt;xsl:with-param name= <font color="#A31515">"hh"</font> <font color="#0000ff">select</font> = <font color="#A31515">"$vTimeHH"</font> &gt;&lt;/xsl:with-param&gt; <br> &lt;xsl:with-param name= <font color="#A31515">"day"</font> <font color="#0000ff">select</font> = <font color="#A31515">"$vDataDD"</font> &gt;&lt;/xsl:with-param&gt; <br> &lt;xsl:with-param name= <font color="#A31515">"month"</font> <font color="#0000ff">select</font> = <font color="#A31515">"$vDataMM"</font> &gt;&lt;/xsl:with-param&gt; <br> &lt;xsl:with-param name= <font color="#A31515">"year"</font> <font color="#0000ff">select</font> = <font color="#A31515">"$vDataYYYY"</font> &gt;&lt;/xsl:with-param&gt; <br> &lt;xsl:with-param name= <font color="#A31515">"delta"</font> <font color="#0000ff">select</font> = <font color="#A31515">"$deltaTime"</font> &gt;&lt;/xsl:with-param&gt; <br> &lt;/xsl:call-template&gt; <br> &lt;/xsl:variable&gt; <br> &lt;!-- ,        ,    --&gt; <br> &lt;xsl:variable name= <font color="#A31515">"vDataMMUTC"</font> &gt; <br> &lt;xsl:call-template name= <font color="#A31515">"MoscowMonthToUTCMonth"</font> &gt; <br> &lt;xsl:with-param name= <font color="#A31515">"hh"</font> <font color="#0000ff">select</font> = <font color="#A31515">"$vTimeHH"</font> &gt;&lt;/xsl:with-param&gt; <br> &lt;xsl:with-param name= <font color="#A31515">"day"</font> <font color="#0000ff">select</font> = <font color="#A31515">"$vDataDD"</font> &gt;&lt;/xsl:with-param&gt; <br> &lt;xsl:with-param name= <font color="#A31515">"month"</font> <font color="#0000ff">select</font> = <font color="#A31515">"$vDataMM"</font> &gt;&lt;/xsl:with-param&gt; <br> &lt;xsl:with-param name= <font color="#A31515">"delta"</font> <font color="#0000ff">select</font> = <font color="#A31515">"$deltaTime"</font> &gt;&lt;/xsl:with-param&gt; <br> &lt;/xsl:call-template&gt; <br> &lt;/xsl:variable&gt; <br> &lt;!-- ,     ,   --&gt; <br> &lt;xsl:variable name= <font color="#A31515">"vDataDDUTC"</font> &gt; <br> &lt;xsl:call-template name= <font color="#A31515">"MoscowDayToUTCDay"</font> &gt; <br> &lt;xsl:with-param name= <font color="#A31515">"hh"</font> <font color="#0000ff">select</font> = <font color="#A31515">"$vTimeHH"</font> &gt;&lt;/xsl:with-param&gt; <br> &lt;xsl:with-param name= <font color="#A31515">"day"</font> <font color="#0000ff">select</font> = <font color="#A31515">"$vDataDD"</font> &gt;&lt;/xsl:with-param&gt; <br> &lt;xsl:with-param name= <font color="#A31515">"month"</font> <font color="#0000ff">select</font> = <font color="#A31515">"$vDataMM"</font> &gt;&lt;/xsl:with-param&gt; <br> &lt;xsl:with-param name= <font color="#A31515">"year"</font> <font color="#0000ff">select</font> = <font color="#A31515">"$vDataYYYY"</font> &gt;&lt;/xsl:with-param&gt; <br> &lt;xsl:with-param name= <font color="#A31515">"delta"</font> <font color="#0000ff">select</font> = <font color="#A31515">"$deltaTime"</font> &gt;&lt;/xsl:with-param&gt; <br> &lt;/xsl:call-template&gt; <br> &lt;/xsl:variable&gt; <br> &lt;!-- ,       delta,  ,  20--&gt; <br> &lt;xsl:variable name= <font color="#A31515">"vTimeHHUTC"</font> &gt; <br> &lt;xsl:call-template name= <font color="#A31515">"MoscowHoutToUTCHour"</font> &gt; <br> &lt;xsl:with-param name= <font color="#A31515">"hh"</font> <font color="#0000ff">select</font> = <font color="#A31515">"$vTimeHH"</font> &gt;&lt;/xsl:with-param&gt; <br> &lt;xsl:with-param name= <font color="#A31515">"hl"</font> <font color="#0000ff">select</font> = <font color="#A31515">"$deltaTime"</font> &gt;&lt;/xsl:with-param&gt; <br> &lt;/xsl:call-template&gt; <br> &lt;/xsl:variable&gt; <br> &lt;!--   ,  0     --&gt; <br> &lt;xsl:variable name= <font color="#A31515">"vTimeHHOUT"</font> &gt; <br> &lt;xsl:call-template name= <font color="#A31515">"ZeroBeforeOneNumber"</font> &gt; <br> &lt;xsl:with-param name= <font color="#A31515">"num"</font> <font color="#0000ff">select</font> = <font color="#A31515">"$vTimeHHUTC"</font> &gt;&lt;/xsl:with-param&gt; <br> &lt;/xsl:call-template&gt; <br> &lt;/xsl:variable&gt; <br> &lt;xsl:variable name= <font color="#A31515">"vDateDDOUT"</font> &gt; <br> &lt;xsl:call-template name= <font color="#A31515">"ZeroBeforeOneNumber"</font> &gt; <br> &lt;xsl:with-param name= <font color="#A31515">"num"</font> <font color="#0000ff">select</font> = <font color="#A31515">"$vDataDDUTC"</font> &gt;&lt;/xsl:with-param&gt; <br> &lt;/xsl:call-template&gt; <br> &lt;/xsl:variable&gt; <br> &lt;xsl:variable name= <font color="#A31515">"vDataMMOUT"</font> &gt; <br> &lt;xsl:call-template name= <font color="#A31515">"ZeroBeforeOneNumber"</font> &gt; <br> &lt;xsl:with-param name= <font color="#A31515">"num"</font> <font color="#0000ff">select</font> = <font color="#A31515">"$vDataMMUTC"</font> &gt;&lt;/xsl:with-param&gt; <br> &lt;/xsl:call-template&gt; <br> &lt;/xsl:variable&gt; <br> &lt;!--   UTC --&gt; <br> &lt;xsl: <font color="#0000ff">value</font> -of <font color="#0000ff">select</font> = <font color="#A31515">"$vDataYYYYUTC"</font> /&gt;-&lt;xsl: <font color="#0000ff">value</font> -of <font color="#0000ff">select</font> = <font color="#A31515">"$vDataMMOUT"</font> /&gt;-&lt;xsl: <font color="#0000ff">value</font> -of <font color="#0000ff">select</font> = <font color="#A31515">"$vDateDDOUT"</font> /&gt;&lt;xsl: <font color="#0000ff">value</font> -of <font color="#0000ff">select</font> = <font color="#A31515">"' '"</font> /&gt;&lt;xsl: <font color="#0000ff">value</font> -of <font color="#0000ff">select</font> = <font color="#A31515">"$vTimeHHOUT"</font> /&gt;:&lt;xsl: <font color="#0000ff">value</font> -of <font color="#0000ff">select</font> = <font color="#A31515">"$vTimeMM"</font> /&gt;:&lt;xsl: <font color="#0000ff">value</font> -of <font color="#0000ff">select</font> = <font color="#A31515">"$vTimeSS"</font> /&gt; <br> &lt;/xsl:template&gt; <br> &lt;!--    --&gt; <br> &lt;xsl:template name= <font color="#A31515">"ZeroBeforeOneNumber"</font> &gt; <br> &lt;xsl:param name= <font color="#A31515">"num"</font> &gt;&lt;/xsl:param&gt; <br> &lt;xsl:choose&gt; <br> &lt;xsl:when test= <font color="#A31515">"number($num) &lt; 10"</font> &gt;0&lt;xsl: <font color="#0000ff">value</font> -of <font color="#0000ff">select</font> = <font color="#A31515">"$num"</font> /&gt;&lt;/xsl:when&gt; <br> &lt;xsl:otherwise&gt;&lt;xsl: <font color="#0000ff">value</font> -of <font color="#0000ff">select</font> = <font color="#A31515">"$num"</font> /&gt;&lt;/xsl:otherwise&gt; <br> &lt;/xsl:choose&gt; <br> &lt;/xsl:template&gt; <br> &lt;!--      --&gt; <br> &lt;xsl:template name= <font color="#A31515">"MoscowYearToUTCYear"</font> &gt; <br> &lt;xsl:param name= <font color="#A31515">"hh"</font> &gt;&lt;/xsl:param&gt; <br> &lt;xsl:param name= <font color="#A31515">"day"</font> &gt;&lt;/xsl:param&gt; <br> &lt;xsl:param name= <font color="#A31515">"month"</font> &gt;&lt;/xsl:param&gt; <br> &lt;xsl:param name= <font color="#A31515">"year"</font> &gt;&lt;/xsl:param&gt; <br> &lt;xsl:param name= <font color="#A31515">"delta"</font> &gt;&lt;/xsl:param&gt; <br> &lt;xsl:choose&gt; <br> &lt;xsl:when test= <font color="#A31515">"(number($hh) + $delta) &lt; 0 and ($day = '01') and ($month='01')"</font> &gt; <br> &lt;xsl: <font color="#0000ff">value</font> -of <font color="#0000ff">select</font> = <font color="#A31515">"number($year)-number(1)"</font> /&gt; <br> &lt;/xsl:when&gt; <br> &lt;xsl:otherwise&gt; <br> &lt;xsl: <font color="#0000ff">value</font> -of <font color="#0000ff">select</font> = <font color="#A31515">"number($year)"</font> /&gt; <br> &lt;/xsl:otherwise&gt; <br> &lt;/xsl:choose&gt; <br> &lt;/xsl:template&gt; <br> &lt;!--      --&gt; <br> &lt;xsl:template name= <font color="#A31515">"MoscowMonthToUTCMonth"</font> &gt; <br> &lt;xsl:param name= <font color="#A31515">"hh"</font> &gt;&lt;/xsl:param&gt; <br> &lt;xsl:param name= <font color="#A31515">"day"</font> &gt;&lt;/xsl:param&gt; <br> &lt;xsl:param name= <font color="#A31515">"month"</font> &gt;&lt;/xsl:param&gt; <br> &lt;xsl:param name= <font color="#A31515">"delta"</font> &gt;&lt;/xsl:param&gt; <br> &lt;xsl:choose&gt; <br> &lt;xsl:when test= <font color="#A31515">"(number($hh) + $delta) &lt; 0 and ($day = '01')"</font> &gt; <br> &lt;xsl:choose&gt; <br> &lt;xsl:when test= <font color="#A31515">"number($month) = 1"</font> &gt;12&lt;/xsl:when&gt; <br> &lt;xsl:otherwise&gt;&lt;xsl: <font color="#0000ff">value</font> -of <font color="#0000ff">select</font> = <font color="#A31515">"number($month)-number(1)"</font> /&gt;&lt;/xsl:otherwise&gt; <br> &lt;/xsl:choose&gt; <br> &lt;/xsl:when&gt; <br> &lt;xsl:otherwise&gt; <br> &lt;xsl: <font color="#0000ff">value</font> -of <font color="#0000ff">select</font> = <font color="#A31515">"number($month)"</font> /&gt; <br> &lt;/xsl:otherwise&gt; <br> &lt;/xsl:choose&gt; <br> &lt;/xsl:template&gt; <br> &lt;!--      --&gt; <br> &lt;xsl:template name= <font color="#A31515">"MoscowDayToUTCDay"</font> &gt; <br> &lt;xsl:param name= <font color="#A31515">"hh"</font> &gt;&lt;/xsl:param&gt; <br> &lt;xsl:param name= <font color="#A31515">"day"</font> &gt;&lt;/xsl:param&gt; <br> &lt;xsl:param name= <font color="#A31515">"month"</font> &gt;&lt;/xsl:param&gt; <br> &lt;xsl:param name= <font color="#A31515">"year"</font> &gt;&lt;/xsl:param&gt; <br> &lt;xsl:param name= <font color="#A31515">"delta"</font> &gt;&lt;/xsl:param&gt; <br> &lt;xsl:choose&gt; <br> &lt;xsl:when test= <font color="#A31515">"(number($hh) + $delta) &lt; 0"</font> &gt; <br> &lt;xsl:choose&gt; <br> &lt;xsl:when test= <font color="#A31515">"number($day) = 1"</font> &gt; <br> &lt;xsl:call-template name= <font color="#A31515">"CountDaysInMonth"</font> &gt; <br> &lt;xsl:with-param name= <font color="#A31515">"month"</font> <font color="#0000ff">select</font> = <font color="#A31515">"number($month)-1"</font> &gt;&lt;/xsl:with-param&gt; <br> &lt;xsl:with-param name= <font color="#A31515">"year"</font> <font color="#0000ff">select</font> = <font color="#A31515">"$year"</font> &gt;&lt;/xsl:with-param&gt; <br> &lt;/xsl:call-template&gt; <br> &lt;/xsl:when&gt; <br> &lt;xsl:otherwise&gt;&lt;xsl: <font color="#0000ff">value</font> -of <font color="#0000ff">select</font> = <font color="#A31515">"number($day)-number(1)"</font> /&gt;&lt;/xsl:otherwise&gt; <br> &lt;/xsl:choose&gt; <br> &lt;/xsl:when&gt; <br> &lt;xsl:otherwise&gt;&lt;xsl: <font color="#0000ff">value</font> -of <font color="#0000ff">select</font> = <font color="#A31515">"$day"</font> /&gt;&lt;/xsl:otherwise&gt; <br> &lt;/xsl:choose&gt; <br> &lt;/xsl:template&gt; <br> &lt;!--    --&gt; <br> &lt;xsl:template name= <font color="#A31515">"CountDaysInMonth"</font> &gt; <br> &lt;xsl:param name= <font color="#A31515">"month"</font> &gt;&lt;/xsl:param&gt; <br> &lt;xsl:param name= <font color="#A31515">"year"</font> &gt;&lt;/xsl:param&gt; <br> &lt;xsl:choose&gt; <br> &lt;xsl:when test= <font color="#A31515">"($month = 1) or ($month = 3) or ($month = 5) or ($month = 7) or ($month = 8) or ($month = 10) or ($month = 12) or ($month = 0)"</font> &gt;31&lt;/xsl:when&gt; <br> &lt;xsl:when test= <font color="#A31515">"($month = 4) or ($month = 6) or ($month = 9) or ($month = 11)"</font> &gt;30&lt;/xsl:when&gt; <br> &lt;xsl:when test= <font color="#A31515">"($month = 2)"</font> &gt; <br> &lt;!--.    --&gt; <br> &lt;xsl:choose&gt; <br> &lt;xsl:when test= <font color="#A31515">"(number($year) mod 4 = 0) and (number($year) mod 100 != 0 or number($year) mod 400 = 0)"</font> &gt;29&lt;/xsl:when&gt; <br> &lt;xsl:otherwise&gt;28&lt;/xsl:otherwise&gt; <br> &lt;/xsl:choose&gt; <br> &lt;/xsl:when&gt; <br> &lt;xsl:otherwise&gt;30&lt;/xsl:otherwise&gt; <br> &lt;/xsl:choose&gt; <br> &lt;/xsl:template&gt; <br> &lt;!-- --&gt; <br> &lt;xsl:template name= <font color="#A31515">"MoscowHoutToUTCHour"</font> &gt; <br> &lt;xsl:param name= <font color="#A31515">"hh"</font> /&gt; <br> &lt;xsl:param name= <font color="#A31515">"hl"</font> /&gt; <br> &lt;xsl:variable name= <font color="#A31515">"t"</font> <font color="#0000ff">select</font> = <font color="#A31515">"(number($hh)+number($hl))"</font> &gt;&lt;/xsl:variable&gt; <br> &lt;xsl:choose&gt; <br> &lt;xsl:when test= <font color="#A31515">"number($t) &lt; 0"</font> &gt; <br> &lt;xsl: <font color="#0000ff">value</font> -of <font color="#0000ff">select</font> = <font color="#A31515">"number($t)+24"</font> /&gt; <br> &lt;/xsl:when&gt; <br> &lt;xsl:when test= <font color="#A31515">"number($t) &gt; 23"</font> &gt; <br> &lt;xsl: <font color="#0000ff">value</font> -of <font color="#0000ff">select</font> = <font color="#A31515">"number($t)-24"</font> /&gt; <br> &lt;/xsl:when&gt; <br> &lt;xsl:otherwise&gt; <br> &lt;xsl: <font color="#0000ff">value</font> -of <font color="#0000ff">select</font> = <font color="#A31515">"number($t)"</font> /&gt; <br> &lt;/xsl:otherwise&gt; <br> &lt;/xsl:choose&gt; <br> &lt;/xsl:template&gt; <br> &lt;!--    / --&gt; <br> &lt;xsl:template name= <font color="#A31515">"MoscowOffsetTime"</font> &gt; <br> &lt;xsl:param name= <font color="#A31515">"hh"</font> &gt;&lt;/xsl:param&gt; <br> &lt;xsl:param name= <font color="#A31515">"day"</font> &gt;&lt;/xsl:param&gt; <br> &lt;xsl:param name= <font color="#A31515">"month"</font> &gt;&lt;/xsl:param&gt; <br> &lt;xsl:param name= <font color="#A31515">"year"</font> &gt;&lt;/xsl:param&gt; <br> &lt;!-- --&gt; <br> &lt;xsl:variable name= <font color="#A31515">"dayOfWeek"</font> &gt; <br> &lt;xsl:call-template name= <font color="#A31515">"DayOfWeek"</font> &gt; <br> &lt;xsl:with-param name= <font color="#A31515">"day"</font> <font color="#0000ff">select</font> = <font color="#A31515">"$day"</font> &gt;&lt;/xsl:with-param&gt; <br> &lt;xsl:with-param name= <font color="#A31515">"month"</font> <font color="#0000ff">select</font> = <font color="#A31515">"$month"</font> &gt;&lt;/xsl:with-param&gt; <br> &lt;xsl:with-param name= <font color="#A31515">"year"</font> <font color="#0000ff">select</font> = <font color="#A31515">"$year"</font> &gt;&lt;/xsl:with-param&gt; <br> &lt;/xsl:call-template&gt; <br> &lt;/xsl:variable&gt; <br> &lt;!--    --&gt; <br> &lt;xsl:variable name= <font color="#A31515">"countDayOfMonth"</font> &gt; <br> &lt;xsl:call-template name= <font color="#A31515">"CountDaysInMonth"</font> &gt; <br> &lt;xsl:with-param name= <font color="#A31515">"month"</font> <font color="#0000ff">select</font> = <font color="#A31515">"$month"</font> &gt;&lt;/xsl:with-param&gt; <br> &lt;xsl:with-param name= <font color="#A31515">"year"</font> <font color="#0000ff">select</font> = <font color="#A31515">"$year"</font> &gt;&lt;/xsl:with-param&gt; <br> &lt;/xsl:call-template&gt; <br> &lt;/xsl:variable&gt; <br> &lt;!--      --&gt; <br> &lt;xsl:variable name= <font color="#A31515">"diffDay"</font> <font color="#0000ff">select</font> = <font color="#A31515">"number($countDayOfMonth)-number($day)"</font> /&gt; <br> &lt;!--   --&gt; <br> &lt;xsl:variable name= <font color="#A31515">"offsetToSun"</font> <font color="#0000ff">select</font> = <font color="#A31515">"6-number($dayOfWeek)"</font> /&gt; <br> &lt;!-- --&gt; <br> &lt;xsl:choose&gt; <br> &lt;xsl:when test= <font color="#A31515">"number($month) &gt; 3 and number($month) &lt; 10"</font> &gt;-4&lt;/xsl:when&gt; <br> &lt;!--      7 --&gt; <br> &lt;xsl:when test= <font color="#A31515">"number($month) = 3 and $diffDay &gt; 7"</font> &gt; <br> -3 <br> &lt;/xsl:when&gt; <br> &lt;xsl:when test= <font color="#A31515">"number($month) = 10 and $diffDay &gt; 7"</font> &gt; <br> -4 <br> &lt;/xsl:when&gt; <br> &lt;!--     7           --&gt; <br> &lt;xsl:when test= <font color="#A31515">"number($month) = 3 and $offsetToSun &gt; $diffDay "</font> &gt; <br> -4 <br> &lt;/xsl:when&gt; <br> &lt;xsl:when test= <font color="#A31515">"number($month) = 10 and $offsetToSun &gt; $diffDay "</font> &gt; <br> -3 <br> &lt;/xsl:when&gt; <br> &lt;!--    --&gt; <br> &lt;xsl:when test= <font color="#A31515">"number($month) = 3 and ($offsetToSun = 0) and ($diffDay &lt; 7)"</font> &gt; <br> &lt;xsl:choose&gt; <br> &lt;xsl:when test= <font color="#A31515">"$hh &gt;= 2"</font> &gt;-4&lt;/xsl:when&gt; <br> &lt;xsl:otherwise&gt;-3&lt;/xsl:otherwise&gt; <br> &lt;/xsl:choose&gt; <br> &lt;/xsl:when&gt; <br> &lt;xsl:when test= <font color="#A31515">"number($month) = 10 and ($offsetToSun = 0) and ($diffDay &lt; 7)"</font> &gt; <br> &lt;xsl:choose&gt; <br> &lt;xsl:when test= <font color="#A31515">"$hh &gt;= 3"</font> &gt;-3&lt;/xsl:when&gt; <br> &lt;xsl:otherwise&gt;-4&lt;/xsl:otherwise&gt; <br> &lt;/xsl:choose&gt; <br> &lt;/xsl:when&gt; <br> &lt;xsl:otherwise&gt;-3&lt;/xsl:otherwise&gt; <br> &lt;/xsl:choose&gt; <br> &lt;/xsl:template&gt; <br> &lt;!--    ( )--&gt; <br> &lt;xsl:template name= <font color="#A31515">"DayOfWeek"</font> &gt; <br> &lt;xsl:param name= <font color="#A31515">"day"</font> &gt;&lt;/xsl:param&gt; <br> &lt;xsl:param name= <font color="#A31515">"month"</font> &gt;&lt;/xsl:param&gt; <br> &lt;xsl:param name= <font color="#A31515">"year"</font> &gt;&lt;/xsl:param&gt; <br> &lt;xsl:variable name= <font color="#A31515">"gMonth"</font> &gt; <br> &lt;xsl:choose&gt; <br> &lt;xsl:when test= <font color="#A31515">"number($month) = 1"</font> &gt; <br> &lt;xsl: <font color="#0000ff">value</font> -of <font color="#0000ff">select</font> = <font color="#A31515">"number(13)"</font> /&gt; <br> &lt;/xsl:when&gt; <br> &lt;xsl:when test= <font color="#A31515">"number($month) = 2"</font> &gt; <br> &lt;xsl: <font color="#0000ff">value</font> -of <font color="#0000ff">select</font> = <font color="#A31515">"number(14)"</font> /&gt; <br> &lt;/xsl:when&gt; <br> &lt;xsl:otherwise&gt; <br> &lt;xsl: <font color="#0000ff">value</font> -of <font color="#0000ff">select</font> = <font color="#A31515">"number($month)"</font> /&gt; <br> &lt;/xsl:otherwise&gt; <br> &lt;/xsl:choose&gt; <br> &lt;/xsl:variable&gt; <br> &lt;xsl:variable name= <font color="#A31515">"Y"</font> <font color="#0000ff">select</font> = <font color="#A31515">"number($year) mod 100"</font> &gt;&lt;/xsl:variable&gt; <br> &lt;xsl:variable name= <font color="#A31515">"Ydiv4"</font> <font color="#0000ff">select</font> = <font color="#A31515">"floor($Y div 4)"</font> /&gt; <br> &lt;xsl:variable name= <font color="#A31515">"M26div10"</font> <font color="#0000ff">select</font> = <font color="#A31515">"floor(((number($gMonth)+1)*26) div 10)"</font> /&gt; <br> &lt;xsl:variable name= <font color="#A31515">"C"</font> <font color="#0000ff">select</font> = <font color="#A31515">"floor($year div 100)"</font> /&gt; <br> &lt;xsl:variable name= <font color="#A31515">"Cdiv4"</font> <font color="#0000ff">select</font> = <font color="#A31515">"floor($C div 4)"</font> /&gt; <br> &lt;xsl:variable name= <font color="#A31515">"F"</font> &gt; <br> &lt;xsl: <font color="#0000ff">value</font> -of <font color="#0000ff">select</font> = <font color="#A31515">"(number($day)+number($M26div10)+$Y+number($Ydiv4)+number($Cdiv4)+5*$C) mod 7"</font> &gt;&lt;/xsl: <font color="#0000ff">value</font> -of&gt; <br> &lt;/xsl:variable&gt; <br> &lt;!--     , =0, ..., =5, =6--&gt; <br> &lt;xsl:choose&gt; <br> &lt;xsl:when test= <font color="#A31515">"$F=0"</font> &gt;5&lt;/xsl:when&gt; <br> &lt;xsl:when test= <font color="#A31515">"$F=1"</font> &gt;6&lt;/xsl:when&gt; <br> &lt;xsl:otherwise&gt; <br> &lt;xsl: <font color="#0000ff">value</font> -of <font color="#0000ff">select</font> = <font color="#A31515">"number($F)-2"</font> /&gt; <br> &lt;/xsl:otherwise&gt; <br> &lt;/xsl:choose&gt; <br> &lt;/xsl:template&gt; <br> <br> &lt;!--   --&gt; <br> &lt;xsl:template name= <font color="#A31515">"tokenEq"</font> &gt; <br> &lt;xsl:param name= <font color="#A31515">"token"</font> /&gt; <br> &lt;xsl: <font color="#0000ff">value</font> -of <font color="#0000ff">select</font> = <font color="#A31515">"$token"</font> /&gt; <br> &lt;/xsl:template&gt; <br> <br> &lt;xsl:template name= <font color="#A31515">"splitEqFirst"</font> match= <font color="#A31515">"text()"</font> mode= <font color="#A31515">"splitEqFirst"</font> &gt; <br> &lt;xsl:param name= <font color="#A31515">"str"</font> <font color="#0000ff">select</font> = <font color="#A31515">"."</font> /&gt; <br> &lt;xsl:param name= <font color="#A31515">"worddiv"</font> <font color="#0000ff">select</font> = <font color="#A31515">"' '"</font> /&gt; <br> &lt;xsl: <font color="#0000ff">if</font> test= <font color="#A31515">"contains($str,$worddiv)"</font> &gt; <br> &lt;xsl:call-template name= <font color="#A31515">"tokenEq"</font> &gt; <br> &lt;xsl:with-param name= <font color="#A31515">"token"</font> <font color="#0000ff">select</font> = <font color="#A31515">"substring-before($str, $worddiv)"</font> /&gt; <br> &lt;/xsl:call-template&gt; <br> &lt;/xsl: <font color="#0000ff">if</font> &gt; <br> &lt;/xsl:template&gt; <br> <br> &lt;xsl:template name= <font color="#A31515">"splitEqSecond"</font> match= <font color="#A31515">"text()"</font> mode= <font color="#A31515">"splitEqSecond"</font> &gt; <br> &lt;xsl:param name= <font color="#A31515">"str"</font> <font color="#0000ff">select</font> = <font color="#A31515">"."</font> /&gt; <br> &lt;xsl:param name= <font color="#A31515">"worddiv"</font> <font color="#0000ff">select</font> = <font color="#A31515">"' '"</font> /&gt; <br> &lt;xsl: <font color="#0000ff">if</font> test= <font color="#A31515">"contains($str,$worddiv)"</font> &gt; <br> &lt;xsl:call-template name= <font color="#A31515">"tokenEq"</font> &gt; <br> &lt;xsl:with-param name= <font color="#A31515">"token"</font> <font color="#0000ff">select</font> = <font color="#A31515">"substring-after($str, $worddiv)"</font> /&gt; <br> &lt;/xsl:call-template&gt; <br> &lt;/xsl: <font color="#0000ff">if</font> &gt; <br> &lt;/xsl:template&gt; <br> &lt;!--‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî--&gt;</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> </div><p>Source: <a href="https://habr.com/ru/post/106216/">https://habr.com/ru/post/106216/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../106207/index.html">Recognition of email addresses</a></li>
<li><a href="../106208/index.html">Send Java / Python SDKs 1.3.8</a></li>
<li><a href="../106210/index.html">Mobile Filing Card for Android</a></li>
<li><a href="../106213/index.html">MobileMe Update</a></li>
<li><a href="../106214/index.html">Handwritten notes: Evernote and Livescribe integration</a></li>
<li><a href="../106218/index.html">New Zoomby app on Facebook for viewing legal videos</a></li>
<li><a href="../106219/index.html">Free software: ‚Äúlicense check‚Äù</a></li>
<li><a href="../106220/index.html">We listen to customers. Development of the service ‚ÄúShirt to order‚Äù (continued)</a></li>
<li><a href="../106221/index.html">And again about Resharper ...</a></li>
<li><a href="../106222/index.html">The revolution in evaluating advertising</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>