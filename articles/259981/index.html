<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>My approach to setting up the economy of the game: spreadsheets</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This post was written in response to Brenda Romero and Jan Schreiber’s suggestion that developers share their favorite Excel workflow methods. 

 I ha...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">🔎</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">📜</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">⬆️</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">⬇️</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>My approach to setting up the economy of the game: spreadsheets</h1><div class="post__text post__text-html js-mediator-article"> This post was written in response to Brenda Romero and Jan Schreiber’s suggestion that developers share their favorite Excel workflow methods. <br><br>  I have completed quite a lot of projects on the economics of games using Excel.  Today, when configuring and customizing the economy of games, most often I need to create a specific data column so that each cell value is automatically calculated based on a formula with one or several variables (for example, calculating the cost of each weapon based on how much damage it causes and what space takes in player inventory). <br><br><img src="https://habrastorage.org/files/bff/b58/a10/bffb58a10006441eb1727812b2e1acf7.jpg"><br><a name="habracut"></a><br>  As a rule, the variables that are in the formulas are different parameters of one object, each of which occupies its own row in the table, and the values ​​for the other properties of this object are located in the other columns of a specific row. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      And now I will tell you what methods of working with Excel I use in order to organize the economy of the game, as well as to provide simple changes and updates to the table. <br><br>  <b>Columns with color markers</b> <br><br>  In my spreadsheets, I mainly use three categories of columns.  I mark the top row of each column with colors, with the help of which it becomes clear to me whether the values ​​in this column need to be edited directly, or whether these values ​​are calculated by the formula.  I use the following color markers: <br><br>  1. <b>Green</b> - values ​​in these columns are edited manually.  In addition, such values ​​require more frequent changes. <br><br>  2. <b>Yellow</b> — in these columns, the values ​​are calculated based on the calculations of the values ​​of a specific area (usually the values ​​from the left column), and changing these values ​​affects a specific range of cells.  Formulas in these columns require adjustments, but changes are made to them less often than in the cells of the "green" columns. <br><br>  3. <b>White</b> - the values ​​in these columns are calculated using formulas that do not require any major changes, since the results of the calculations directly depend on the values ​​of the "yellow" columns, the associated control variables (for example, the minimum-maximum range) or significance factors (can be found in the general table of variables).  Thus, the formulas in these columns require changes in the most extreme cases. <br><br>  <b>Ranges of normalized values</b> <br><br>  For columns that contain data that may be subject to change, as well as affect the values ​​in other columns, I add new entries to my shared variable table to know the minimum and maximum values ​​in this column.  Then I add a new column to store the normalized values ​​for each corresponding cell in the original column. <br><br>  For example, say, column D is green in the Weapons table, and it contains information about the degree of damage each weapon inflicts.  After filling these values ​​manually, I would add a new variable to my variable table called “WeaponDamageMax” and set its value as “= MAX (Weapon [D: D])”, as well as another variable “WeaponDamageMin”, which is calculated by the formula “= MIN (Weapon [D: D]). <br><br>  Then I would create a new column in the Weapon table, column E, for storing normalized damage values ​​with the formula “= (D1 - WeaponDamageMin) / (WeaponDamageMax - WeaponDamageMin)”. <br><br>  <b>Distribution formulas</b> <br><br>  As I said, I use yellow for marking columns in which formulas use normalized input data, and also perform some mathematical operations in order to change the distribution of values ​​within the normalized range.  This is done in order to gain greater control over the distribution of values, and is also a way to destroy clusters of values ​​that sometimes appear. <br><br>  For example, if a developer adds a new, powerful weapon that damages 5,000,000, and the remaining damage values ​​of a weapon in column D are in the range 1-200, one such large value will distort other values ​​with lower rates in the range 0-1, when they will be distributed using WeaponDamageMax in order to get the normalized damage values ​​in column E. In some cases this is desirable, but it happens that you want to split these data clusters and distribute them more evenly across the entire range. <br><br>  This is where the distribution formula comes in handy.  The normalized values ​​can be easily converted to obtain the desired propagation value by applying the distribution curve to existing data.  In this case, we will create a new “yellow” column, column F, to store the modified values ​​from column D. <br><br>  Although this method is very powerful and flexible, it is still easier to visualize and generate curves using third-party tools.  These tasks can also be performed in Excel, but personally I prefer to use the following tools to visualize and modify my distribution formulas: <br><br>  <b>Visualization</b> - <a href="http://my.hrw.com/math06_07/nsmedia/tools/Graph_Calculator/graphCalc.html">graphing calculator</a> : <br><br>  1. Increase the axes to a range of 0-1 <br>  2. Copy the formula from the column where the curves are adjusted, in the field “y1 =” <br>  3. Replace the letter of the column with the normalized values ​​on the "x" <br>  4. Click the "Graph" button to see the transition curve. <br><br>  <b>Changes</b> - <a href="http://www.timotheegroleau.com/Flash/experiments/easing_function_generator.htm">smoothness function generator</a> <br><br>  1. Change the control points of the curve until it looks the way you want <br>  2. From the “function” field, copy the part after “b + c *” in the last line of the function (the part in brackets) <br>  3. Paste the copied formula into the column where the curve is adjusted. <br>  4. Replace the name “t” with the letter of the column with normalized values ​​(nvcID), the name “ts” with “nvcID ^ 2”, and “tc” with “nvcID ^ 3”. <br><br>  In the case of normalized damage from weapons in column E, we can try to stretch the cluster of values ​​to the lower part of our range using the initial formula of column F in the form “= (-6.885 * (1 ^ 3) * (1 ^ 2) + 19.885 * (E1 ^ 2) * (E1 ^ 2) + -18,395 * (E1 ^ 3) + 3.825 * (E1 ^ 2) + 2.57 * E1), ". <br><br>  This formula was originally obtained using the smoothness function generator, which I mentioned above, and can be changed if necessary to adjust the distribution.  Again, we apply this formula to the remaining rows in column F, using the typical method of dragging a cell with a formula down the remaining cells in the column, to modify E1 for each row. <br><br>  Regardless of which distribution formula you use, make sure that the values ​​you get remain within 0-1. <br><br><img src="https://habrastorage.org/files/c56/7c6/7be/c567c67be99b4762bb7a3c3bc6337386.png"><br>  <i>Just ... take what you need and leave some money ...</i> <br><br>  <b>Range control variables</b> <br><br>  For the values ​​that will be automatically calculated by the formula (in this example, the price of each weapon), I think it would be useful to be able to control the minimum and maximum values ​​of this parameter in order to keep them within the established range.  To do this, I add adjustable minimum / maximum variables that correspond to each “white” column (where calculations are made using the formula), which are filled in with automatically calculated values. <br><br>  In the case of the price of weapons, I would add two new variables to the general table of variables: WeaponCostMin and WeaponCostMax.  You can change them manually at any time — for example, if WeaponCostMax is 90000, but the player can collect a maximum of 50,000 coins, you can easily lower the upper limit of the range by setting the WeaponCostMax value to 50,000, in order to ensure that the game sooner or later but you can buy all the weapons. <br><br>  <b>Weighted average factors</b> <br><br>  Values ​​of properties calculated by the formula can be calculated using one or several initial values, which I call “factors”.  With their help, you can get the final generated value.  For example, when calculating the cost of a weapon, these factors are: <br><br>  The amount of damage that causes weapons (more damage = higher price) <br>  The amount of space that is required in the inventory (more space = lower price). <br><br>  At this stage, we believe that each factor has already been normalized and regulated using the distribution function (i.e., column D contains the initial damage values ​​of the weapon, column E contains the normalized damage values ​​from the weapon, and column F contains the final damage values from weapons, adjusted for distribution, which will be used in our value formula). <br><br>  Let's assume that the final values ​​of damage from weapons are contained in the “yellow” column F, and the final values ​​of the amount of space required in the inventory for a specific weapon are in the “yellow” column U. We want to create a formula for the “white” column C, where the automatically calculated price for each weapon will be stored.  One of the simplest formulas for column C, in which our desires and requirements are taken into account, is to find the arithmetic average of these two coefficients by: <br><br>  “= WeaponCostMin + ((WeaponCostMax - WeaponCostMin) * ((F1 + (1.0 - 1)) / 2.0))”. <br><br>  Note that in this case, again, you will need to drag the formula down in order to apply it to all the other cells in column C. <br><br>  So, this will show the cost of each weapon within the specified range, based on the level of damage and the space requirements in the inventory for that weapon.  However, it also means that both of these factors equally affect the determination of the final cost, which is not always desirable in the presence of several factors. <br><br>  In such a situation, a quick, simple, and flexible solution is to convert a formula to a weighted average and add a manually configured value factor for each factor to the general table of variables.  This will allow to regulate the importance of each individual factor at its discretion. <br><br>  In this case, we will add two new variables to the general variable table: WeaponCost_DamageFactorWeight and WeaponCost_SpaceFactorWeight.  These values ​​are only relative integer “weights”, so if I want the damage to be more important for calculating the cost of a weapon than the inventory requirements for this weapon, you can set the following values: WeaponCost_DamageFactorWeight - “= 5” and WeaponCost_SpaceFactorWeight - "= 1". <br><br>  In the end, our formula in column C for calculating the cost of a weapon using a weighted average will look like this: <br><br>  "= WeaponCostMin + ((WeaponCostMax - WeaponCostMin) * (((F1 * WeaponCost_DamageFactorWeight) + + ((1.0 - U1) * WeaponCost_SpaceFactorWeight))) / (WeaponCost_DamageFactorWeight + WeaponCost_SFactFactFactor <br><br>  Note that this formula works only if the initial values ​​for damage and inventory space are in the range of 0-1.  And this is another reason to normalize the original data before performing various additional operations with them. <br><br>  <b>findings</b> <br><br>  The method described above is by no means perfect, but I still talked about it in the hope that at least one of its elements would be useful to someone.  And although these methods are very easy, there is always an opportunity to make calculations even simpler, and I would like to see suggestions from other developers on how to simplify the calculation process. <br><br>  For example, I found that the process of adjusting distribution curves can be a stumbling block for developers who are trying to put such methods into practice without having proper experience with balancing and tuning games.  If you, working with curves, find that the calculations are very cumbersome, you can explore alternative methods: for example, the method of linear segment curves.  To learn about examples of using linear segment curves for balancing and adjusting the game, read the detailed analysis of time monetization formulas using the example of Clash of Clans written by Wolfgang Gröbner. </div><p>Source: <a href="https://habr.com/ru/post/259981/">https://habr.com/ru/post/259981/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../259961/index.html">Survey on search resources</a></li>
<li><a href="../259967/index.html">gb - dependency management for Go</a></li>
<li><a href="../259971/index.html">Microsoft TechDay 2015 Live Broadcast</a></li>
<li><a href="../259973/index.html">FlyElephant invites to the VI conference of experts in the field of web and mobile technologies WebCamp 2015</a></li>
<li><a href="../259975/index.html">WWDC15. Second day. Details</a></li>
<li><a href="../259983/index.html">Google Developers Launchpad - everything you need for a successful launch</a></li>
<li><a href="../259987/index.html">java.js for Java developers: first steps</a></li>
<li><a href="../259989/index.html">Webinars from the Centos-admin.ru team</a></li>
<li><a href="../259991/index.html">Getting ready for a PHP interview: pseudo-type "callable"</a></li>
<li><a href="../259993/index.html">Compare Nim and Rust</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>