<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Notes IoT provider. Case: we are making a LoRa network for TRK in Chelyabinsk</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello, dear lovers of the Internet of Things. 


 I will continue the series of articles about our network LoRaWAN. Today I will tell you about the re...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Notes IoT provider. Case: we are making a LoRa network for TRK in Chelyabinsk</h1><div class="post__text post__text-html js-mediator-article"><p>  Hello, dear lovers of the Internet of Things. </p><br><p>  I will continue the series of articles about our network LoRaWAN.  Today I will tell you about the real case.  This is a project for the largest shopping and entertainment complex in Chelyabinsk.  I will share with you the figures and decisions on the project. </p><br><p>  At the end of the article I will tell why we chose the LoRa transmission protocol, and not the zigbee.  Perhaps someone will argue with that.  The more interesting the discussion will be. </p><br><img src="https://habrastorage.org/webt/5u/mv/lt/5umvlto9omtdtgy5ajb-nax2wmu.jpeg"><br><a name="habracut"></a><br><br><p>  <strong>What we have:</strong> </p><br><p>  Request from the entertainment complex, which is located in the shopping center "Rodnik". </p><br><p>  Introductory: the complex has several points with their own electric meters on each.  It is necessary to establish a system for collecting testimony from metering devices and transferring them api to the client. </p><br><p>  What are the obvious difficulties for us in such a formulation of the problem? </p><br><p>  1 - No experience with TRK.  This is not really a difficulty, but rather a feature of this project for us.  Important. </p><br><p>  2 - The client needs data transfer via api, bypassing our interface. </p><br><p>  In previous articles I have already said that we were confused and developed our user-friendly interface, where we transmit data.  This is the usual format for us: we set up a project, load data into the interface and give access to it.  In this case, the client needed a permanent transfer of information to their side.  The task is simple, but non-standard.  Therefore, I refer to the difficulties - features. </p><br><br><p>  3 - Negative feedback from colleagues.  According to them, working with a dispenser is a sheer headache. </p><br><p>  4 - The uniqueness of the project, there is no example to follow. </p><br><p>  All dispensers are unique.  Each has its own interior layout, different materials for the facades and "dark corners".  There is no one model to follow and copy.  Everything needs to be done from scratch. </p><br><p>  <strong>What did:</strong> </p><br><p>  Started with radio coverage. </p><br><p>  TRK Rodnik is a large shopping center in Chelyabinsk.  The scale conveys the photo at the beginning of the article. </p><br><p>  The environment is a park area with a railway, forest, wasteland, a river and a multi-lane road junction. </p><br><p>  For administrative reasons, you can not put a base station inside the complex.  The nearest possible installation point is a kilometer from the complex itself.  And the equipment is already there.  Putting a new base station is not necessary. <br>  Between the complex and the base station - direct visibility. </p><br><p>  <strong>Characteristics of the building:</strong> </p><br><p>  TRC "Spring" - is a monolithic structure.  The facade is represented by a two-level parking.  It is fenced off from the building with a concrete wall and powerful doors.  Atrium covers a huge "cap" of glass and concrete.  From the client, we did not receive information about the characteristics of the glass and door material.  The complex is also equipped with loading gates at the side and behind.  There are windows, but they are few. </p>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <i>Facade:</i> <br><br><img src="https://habrastorage.org/webt/lq/2p/cn/lq2pcney6h5byk5ux_cvt6uyukk.jpeg"><br><br>  <i>Window:</i> <br><br><img src="https://habrastorage.org/webt/sx/n2/ym/sxn2ymek-l42yn8be8anw_cjysq.jpeg"><br><br>  <i>Doors inside the complex:</i> <br><br><img src="https://habrastorage.org/webt/9m/1e/6j/9m1e6j1u_htbdcofz0cmqoqz3ky.jpeg"><br><br>  <i>More doors:</i> <br><br><img src="https://habrastorage.org/webt/wv/uz/yq/wvuzyqpgjfk4kp00p6_ad3lhbjw.jpeg"><br><br><p>  Customer equipment stood in the technical room. </p><br><p>  It turns out that the radio wave needs to go a kilometer in a straight line, and then winding but wide corridors of the complex to get to the client. </p><br><p>  Is it possible? <br>  Practice has shown that quite. </p><br><p>  <strong>Survey:</strong> </p><br><p>  For work used the conventional radio module SI-11. <br>  The engineer simply walks and periodically activates it.  Next, the signal level (RSSI) and signal-to-noise (SNR) values ‚Äã‚Äãfrom the server are pulled up and evaluated. <br>  Vega has a specialized TC-1 device (network tester). <br><br><img src="https://habrastorage.org/webt/se/yt/_j/seyt_jdlinu-weln9suhbw4qlom.jpeg"><br><br>  We did not make friends with him.  The device does not see the network where it is, lying on the levels.  Perhaps, so far this is the only product of Vega that has not gone to us. </p><br><p>  The first survey took a day, we did not find ‚Äúdark corners‚Äù.  Communication was stable throughout the available space. </p><br><p>  For most of the premises, the installation of the SI-11 was enough. <br>  At 1 counter - 1 hour of work of a brigade of 2 people along with installation and configuration.  I cannot indicate the exact number of connected meters (trade secret), but there are many of them.  We were surprised by the quantity.  Score on dozens. </p><br><p>  At first, our radio modules were activated at SF = 12 (as the logic implies).  We observed with great interest their quality parameters, we thought that the connection would be on the verge.  But no, the packages went steadily and without loss.  RSSI in some places reached -100 dBm. </p><br><p>  When ADR was activated, some radio modules lowered SF from 12 to 10-11.  Radio conditions allowed it.  Communication parameters at SF = 10 are kept at RSSI = -110 dBm, SNR fluctuates around zero. </p><br><p>  <strong>About "dark corners":</strong> </p><br><p>  Not without them. <br>  In one place, the SI-11 stubbornly did not want to get in touch.  Then involved the SI-21. </p><br><br><img src="https://habrastorage.org/webt/ra/yx/xa/rayxxadjj5vryddzx6avnymtp98.jpeg"><br><br><p>  This is the same SI-11, only with an external antenna.  A very handy thing, comes bundled with a flat antenna with double-sided tape.  The method of selection found the best location of the antenna and just stuck it on the wall ... It works! </p><br><p>  Minus - communication parameters on the verge.  But this is the only sensor with this situation.  We assume that for these conditions we can afford it. </p><br><p>  <strong>What's next?</strong> </p><br><p>  We have achieved walking packages. </p><br><p>  Frankly, I was pleasantly surprised by the results.  In the opinion of colleagues, I heard that the project without an indoor base station will not work inside the shopping and entertainment center, but we succeeded.  It's nice. </p><br><p>  <strong>A few words about the API</strong> </p><br><p>  Client request for api decided simply.  The client receives server data through a web socket.  What he does with them further is not our business. <br>  The server allows you to configure the system in such a way that the client sees information only from their sensors. </p><br><p>  Our interface is, of course, universal, but customers may have specific needs.  Therefore, we are ready to transfer them raw data. </p><br><p>  <strong>Draw conclusions.</strong> <strong><br></strong>  <strong>Is all TRK on our shoulders?</strong> </p><br><p>  Our pilot is built on Vega, but in the future we plan to introduce devices from other manufacturers.  Another plus in the openness of the standard LoRaWAN. </p><br><p>  The first step was successful.  But working with other TRK showed that you should not relax. </p><br><p>  The main problems in my opinion: </p><br><p>  1) Each dispenser is unique.  Some may have pass-through underground parking with good access to shops and an atrium.  With such simple.  Others are real stone bags with tiny glasses and equipment in the basement.  This is already a problem. </p><br><p> 2) Large dispensers often occupy a large area, have huge parking lots and traffic intersections around them.  Of course, such a colossus is difficult to locate in the center of the city, so they are built on waste grounds, the territories of former factories and in other places that are unsuitable for installing a base station. </p><br><p>  In such cases, the correct solution is to place the indoor base station in the complex itself.  However, in our work we are guided not only by technical necessity, but also by administrative considerations.  The latter introduces significant difficulties. </p><br><br><p>  <strong>A zigbee did not suit us</strong> <br>  <strong>It happened because:</strong> </p><br><br><p>  1) We could not build a mesh network in this dispenser.  It was not possible to evenly distribute the sensors around the perimeter of the complex.  The radio modules were located in remote places.  Between them - glass and concrete.  Mesh network in such a situation is unlikely to rise. </p><br><p>  2) There is no network in the mall itself.  Contact with the nearest base station will not work because of its distance from the building. </p><br><p>  3) We wanted to make everything as simple as possible and at the lowest cost.  Therefore, we chose LoRa.  She went perfectly. </p><br><br><p>  That's all.  I told how we made a real project for the SEC.  He described the challenges, challenges and our experience in solving them.  I explained why they decided to work on the LoRa protocol. <br>  It will be interesting to hear an opinion about this case from experts and those who are in the subject of the Internet of Things. </p><br><br>  Archive of past articles: <br>  <a href="https://habr.com/post/359276">#one.</a>  <a href="https://habr.com/post/359276">Introduction</a> ‚Üí <a href="https://habr.com/post/359294"># 2.</a>  <a href="https://habr.com/post/359294">Coverage</a> ‚Üí <a href="https://habr.com/post/359429"># 3.</a>  <a href="https://habr.com/post/359429">Zoo of metering devices</a> ‚Üí <a href="https://habr.com/post/412807"># 4.</a>  <a href="https://habr.com/post/412807">Propriety</a> ‚Üí <a href="https://habr.com/post/413105"># 5.</a>  <a href="https://habr.com/post/413105">Activation and security in LoraWAN</a> ‚Üí <a href="https://habr.com/post/414159/"># 6.</a>  <a href="https://habr.com/post/414159/">LoRaWAN and RS-485</a> <br>  ‚Üí <a href="https://habr.com/post/421859/"># 7.</a>  <a href="https://habr.com/post/421859/">Devices and outbid</a> ‚Üí <a href="https://habr.com/post/422097/"># 8.</a>  <a href="https://habr.com/post/422097/">About frequency</a> </div><p>Source: <a href="https://habr.com/ru/post/423781/">https://habr.com/ru/post/423781/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../423771/index.html">Once again, the PVS-Studio analyzer was more attentive than a human</a></li>
<li><a href="../423773/index.html">Roskomnadzor threatens to send a letter to Facebook</a></li>
<li><a href="../423775/index.html">I wanted a beautiful piece of iron. Happened</a></li>
<li><a href="../423777/index.html">Keystone Project: Trusted Environment for Running Applications Based on RISC-V</a></li>
<li><a href="../423779/index.html">Cloud-to-cloud backup: what it is and why it is needed</a></li>
<li><a href="../423783/index.html">Splunk: Machine learning to a new level</a></li>
<li><a href="../423785/index.html">Build a web-based server farm for Kubernetes using LTSP</a></li>
<li><a href="../423787/index.html">TEST Labs 2018. Online MAP for testers. September 28 - 29</a></li>
<li><a href="../423791/index.html">We make a 3D configurator without programming and layout. Part two</a></li>
<li><a href="../423793/index.html">‚ÄúWe made this decision, damn it, on time!‚Äù - 10 questions to the programmer, issue 5</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>