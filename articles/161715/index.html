<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Suit up! Simple and easy WYSIWYG</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The article is divided into three parts: 


- Introduction 
- How to make the simplest editor yourself , and there will be no theory, only practice. I...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Suit up! Simple and easy WYSIWYG</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/2a8/d22/8dc/2a8d228dcf32a7bf805eac764a21b0ac.png"><br><br>  The article is divided into three parts: <br><ul><li>  <a href="http://habrahabr.ru/post/161715/">Introduction</a> </li><li>  <a href="http://habrahabr.ru/post/161715/">How to make the simplest editor yourself</a> , and there will be no theory, only practice.  I warn you, for many this part will seem simple and obvious, since the text is oriented, you can say, to yourself in the past (no, I do not travel in time :)); </li><li>  <a href="http://habrahabr.ru/post/161715/">Work description of a very lightweight editor ‚ÄúSuit Up‚Äù</a> (original code size: 5.97KB (1.87KB gzipped), minimized: 3.35KB (1.37KB gzipped) at the time of writing this article, not counting the sprite and styles). </li></ul>  <b>UPD</b> <a href="http://habrahabr.ru/post/161715/">Criticism</a> <br><br><a name="introduction"></a><br><h4>  Introduction </h4><br>  Not so long ago, or, more precisely, about two years ago, in the circle of developers with whom I had the honor of communicating (almost all are beginners), everyone who received the task to deliver WYSIWYG was assigned a monstrous TinyMCE.  For some reason, this editor was considered a standard by many web developers, although few people needed the large number of functions that were offered to programmers.  Here you and this and that.  Probably, in this way, the newbies tried to say to the client ‚Äúlook, we have written a word to your site‚Äù. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Once (I do not remember under what conditions), I wanted or needed to figure out how browser ‚Äúrich editors‚Äù work.  To my surprise, there was no limit when I, without having any deep knowledge of web development, made two buttons: Bold and Italic, which turned out to be a very simple task.  I wanted to know more about what to do next.  So I got acquainted with the series of articles <a href="http://habrahabr.ru/post/107829/">‚ÄúWYSIWYG HTML editor in the browser‚Äù</a> (click on the first article, I advise you to read it).  But the information at that time seemed to me somewhat complicated.  Therefore, I decided to use a spear method, advancing on a rake already trampled by someone, to write my simple editor. <br><br>  I made it as a jQuery plugin, and I think you shouldn‚Äôt answer why.  It turned out to somehow make it work in different browsers.  Then I got the idea to write an article on Habr, after some improvements.  Time passed, I put off finishing, put off ... Two years, hell, for two whole years.  But I will try to fix it. <br><br><a name="simplest_editor"></a><br><h4>  Simplest editor </h4><br>  In order to enable the user to change the contents of the block (in this case, the usual diva), simply give him (the block) the contenteditable attribute: <br><pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">contenteditable</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  The editor is ready! <br><a name="habracut"></a><br>  Just kidding :) <br><br>  In order to make some changes to the text (for example, to set the font color), there is a <code>document.execCommand</code> method that applies to the current selection or position of the caret.  The method takes three arguments: <br><ol><li>  The name of the command (for example, italic). </li><li>  Whether to show the standard dialog to get the value (correct if the definition is incorrect).  As a rule, no one uses it, so the value will always be false. </li><li>  Command value </li></ol><br><br>  Add a Bold button to the page that makes the text bold: <br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"bold"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  We write the simplest click handler: <br><pre> <code class="javascript hljs">$( <span class="hljs-string"><span class="hljs-string">'.bold'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.execCommand( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-literal"><span class="hljs-literal">null</span></span> ); });</code> </pre><br>  Is done.  Select the text in the diva, presses the button: op, text is bold.  Press again: hob, the text has become the same. <br><br>  Add two more buttons <br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"italic"</span></span></span><span class="hljs-tag">&gt;</span></span>italic<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"red"</span></span></span><span class="hljs-tag">&gt;</span></span>Red<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  The first will make the text oblique (italic, like bold does not require meaning, as it is in Africa italic), the second - to change the text color to red. <br><br><pre> <code class="javascript hljs">$( <span class="hljs-string"><span class="hljs-string">'.italic'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.execCommand( <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-literal"><span class="hljs-literal">null</span></span> ); }); $( <span class="hljs-string"><span class="hljs-string">'.red'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.execCommand( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>, <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-string"><span class="hljs-string">'red'</span></span> ); });</code> </pre><br><br>  The <code>forecolor</code> command, obviously, cannot do without a value, otherwise the browser will not understand exactly which color should be given to the text. <br><br>  Result: <a href="http://jsfiddle.net/6BkPu/">jsfiddle.net/6BkPu</a> <br><br>  That's it, now it's small: <br>  1. Take <code>.innerHTML</code> diva and do anything with it: send to server, insert into <code>textarea</code> , etc. <br>  2. By analogy, add more commands that you can look at <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">this link</a> . <br>  3. Add icons and play with fonts. <br><br>  To highlight a button (to check the current value of commands), use the <code>document.queryCommandValue</code> and <code>document.queryCommandState</code> methods.  I will not describe their behavior, since it depends on the browser.  Only the browser manufacturer decides whether to throw an exception or not, only the browser manufacturer decides what to return, so I suggest that, if you wish, find out what's what.  We'll have to, basically, to understand at random. <br><br>  Not to be unfounded, I will give an example. <br>  <code>document.queryCommandValue( 'formatblock' )</code> in FF and Chrome returns the following values: <code>h1, h2, p</code> ..., although the values ‚Äã‚Äãin <code>document.execCommand( 'formatblock', ... )</code> were framed in triangular brackets: <h1> <code><code>, ,     IE,        execCommand( 'formatblock' ... )   .   :     " ",       .   IE...    ?..     <code>queryCommandValue( 'formatblock' )</code>  <code>" 1", " 2", ""</code> , .     , , , ,         .     ,    IE10. ,  ,    IE10!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  SuitUp <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript">$( '.my-textarea' ).suitUp();</code> <br>       : <br> <code class="javascript">$( '.my-textarea' ).suitUp( 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' );</code> <br>       <br> <code class="javascript">$( '.my-textarea' ).suitUp([ 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , 'forecolor',      : <br> <br> 1. ,  :  forecolor    red: <br> <code class="javascript">$.suitUp.commands = { forecolor: 'red' }</code> <br>  <br> <code class="javascript">$.extend( jQuery.suitUp.commands, { forecolor: 'red' })</code> <br>  <br> <code class="javascript">$.suitUp.commands.forecolor = 'red' // ( ,  commands -  )</code> <br> : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> 2.   () <br> <code class="javascript">$.suitUp.commands.forecolor = { 'Make Red': 'red', 'Make Green': 'green' }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> 3. ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( ' ', '' ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript">$( 'textarea' ).suitUp( 'italic', 'bold', '|', 'link', 'formatblock#&lt;h1&gt;' );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> 1.  Bold. <br> 2.  . <br> 3. ,             "". <br> <br>  ,        . <br> <br> <code class="javascript">$.extend( $.suitUp.commands, { bold: null, //   ,        null fontname: { Arial: 'arial', Times: 'times', Verdana: 'verdana' }, forecolor: function( callback ){ var blackBackground = $( '&lt;div/&gt;' ).css({ background: 'black', position: 'absolute', top: 0, left:0, opacity: .5, width: '100%', height: '100%' }).on( 'click', function(){ popup.add( this ).remove(); }).appendTo('body'), popup = $( '&lt;div/&gt;' ).css({ padding: '10px 20px', width: 200, position: 'absolute', background: 'white', top: 200, left: $( window ).width()/2 - 110, zIndex: 100 }).appendTo('body'); $( '&lt;input/&gt;' ).appendTo( popup ); $( '&lt;button/&gt;' ).appendTo( popup ).text( 'Go!' ).on( 'click', function() { var val = popup.children( 'input' ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor' );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . Callback   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( 'forecolor', false, ' ' );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript">$.suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript">$.extend( jQuery.suitUp.custom, { helloWorld: function() { return $( '&lt;span/&gt;', { 'class': 'suitup-control' //    }).css( 'backgroundColor', 'red' ).on( 'click', function() { alert( 'Hello World!' ); }); } });</code> <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor', 'helloWorld' );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       "link",     ( "createlink"),      ( "unlink"). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( 'a', { className: 'suitup-control', href: '#' }).attr({ 'data-command': 'createlink' //         createlink }).on( 'click', function() { if( !$.suitUp.hasSelectedNodeParent( 'a' ) ) { document.execCommand( 'createlink', false, window.prompt( 'URL:', '' ) ); } else { document.execCommand( 'unlink', false, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor#red</code> )    : <br>  .   .  , ""  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript">$.suitUp.controls = [ 'bold', 'italic' ]; $( '.suitup-textarea' ).suitUp(); //    ,   $( '.suitup-textarea' ).suitUp( 'bold', 'italic' );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript">$.suitUp.controls.push( 'forecolor' ); $( '.suitup-textarea' ).suitUp();</code> <br>   : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( $.suitUp.controls.concat([ 'forecolor' ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   $.suitUp   .  ,            .      ,      ,  . <br> <br> <b>$.suitUp.getSelection</b> <br>   .          . <br> <br> <b>$.suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = $.suitUp.getSelection(); //  -,     $( '.suitup-editor' ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b>$.suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b>$.suitUp.hasSelectedNodeParent</b> <br>  ,      "link". ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( 'a' ); // true/false</code> <br> <br>    Chrome, Firefox, IE10 (+IE7 Mode) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/Suitup</a> <br> <br>   extended-commands.suitup.jquery.js     .    50        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b>UPD</b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> 1.          . ,  bold  Chrome     b,   IE   strong. <br> 2.          (      ). <br> 3.    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code></code> </h1><h2> <code><code>, ,     IE,        execCommand( 'formatblock' ... )</code>   .   :     " ",       .   IE...    ?..     <code>queryCommandValue( 'formatblock' )</code>  <code>" 1", " 2", ""</code> , .     , , , ,         .     ,    IE10. ,  ,    IE10!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  SuitUp <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript">$( '.my-textarea' ).suitUp();</code> <br>       : <br> <code class="javascript">$( '.my-textarea' ).suitUp( 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' );</code> <br>       <br> <code class="javascript">$( '.my-textarea' ).suitUp([ 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , 'forecolor',      : <br> <br> 1. ,  :  forecolor    red: <br> <code class="javascript">$.suitUp.commands = { forecolor: 'red' }</code> <br>  <br> <code class="javascript">$.extend( jQuery.suitUp.commands, { forecolor: 'red' })</code> <br>  <br> <code class="javascript">$.suitUp.commands.forecolor = 'red' // ( ,  commands -  )</code> <br> : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> 2.   () <br> <code class="javascript">$.suitUp.commands.forecolor = { 'Make Red': 'red', 'Make Green': 'green' }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> 3. ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( ' ', '' ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript">$( 'textarea' ).suitUp( 'italic', 'bold', '|', 'link', 'formatblock#&lt;h1&gt;' );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> 1.  Bold. <br> 2.  . <br> 3. ,             "". <br> <br>  ,        . <br> <br> <code class="javascript">$.extend( $.suitUp.commands, { bold: null, //   ,        null fontname: { Arial: 'arial', Times: 'times', Verdana: 'verdana' }, forecolor: function( callback ){ var blackBackground = $( '&lt;div/&gt;' ).css({ background: 'black', position: 'absolute', top: 0, left:0, opacity: .5, width: '100%', height: '100%' }).on( 'click', function(){ popup.add( this ).remove(); }).appendTo('body'), popup = $( '&lt;div/&gt;' ).css({ padding: '10px 20px', width: 200, position: 'absolute', background: 'white', top: 200, left: $( window ).width()/2 - 110, zIndex: 100 }).appendTo('body'); $( '&lt;input/&gt;' ).appendTo( popup ); $( '&lt;button/&gt;' ).appendTo( popup ).text( 'Go!' ).on( 'click', function() { var val = popup.children( 'input' ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor' );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . Callback   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( 'forecolor', false, ' ' );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript">$.suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript">$.extend( jQuery.suitUp.custom, { helloWorld: function() { return $( '&lt;span/&gt;', { 'class': 'suitup-control' //    }).css( 'backgroundColor', 'red' ).on( 'click', function() { alert( 'Hello World!' ); }); } });</code> <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor', 'helloWorld' );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       "link",     ( "createlink"),      ( "unlink"). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( 'a', { className: 'suitup-control', href: '#' }).attr({ 'data-command': 'createlink' //         createlink }).on( 'click', function() { if( !$.suitUp.hasSelectedNodeParent( 'a' ) ) { document.execCommand( 'createlink', false, window.prompt( 'URL:', '' ) ); } else { document.execCommand( 'unlink', false, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor#red</code> )    : <br>  .   .  , ""  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript">$.suitUp.controls = [ 'bold', 'italic' ]; $( '.suitup-textarea' ).suitUp(); //    ,   $( '.suitup-textarea' ).suitUp( 'bold', 'italic' );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript">$.suitUp.controls.push( 'forecolor' ); $( '.suitup-textarea' ).suitUp();</code> <br>   : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( $.suitUp.controls.concat([ 'forecolor' ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   $.suitUp   .  ,            .      ,      ,  . <br> <br> <b>$.suitUp.getSelection</b> <br>   .          . <br> <br> <b>$.suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = $.suitUp.getSelection(); //  -,     $( '.suitup-editor' ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b>$.suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b>$.suitUp.hasSelectedNodeParent</b> <br>  ,      "link". ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( 'a' ); // true/false</code> <br> <br>    Chrome, Firefox, IE10 (+IE7 Mode) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/Suitup</a> <br> <br>   extended-commands.suitup.jquery.js     .    50        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b>UPD</b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> 1.          . ,  bold  Chrome     b,   IE   strong. <br> 2.          (      ). <br> 3.    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> </h2><h4> <code><code>, ,     IE,        execCommand( 'formatblock' ... )</code>   .   :     " ",       .   IE...    ?..     <code>queryCommandValue( 'formatblock' )</code>  <code>" 1", " 2", ""</code> , .     , , , ,         .     ,    IE10. ,  ,    IE10!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  SuitUp <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript">$( '.my-textarea' ).suitUp();</code> <br>       : <br> <code class="javascript">$( '.my-textarea' ).suitUp( 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' );</code> <br>       <br> <code class="javascript">$( '.my-textarea' ).suitUp([ 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , 'forecolor',      : <br> <br> 1. ,  :  forecolor    red: <br> <code class="javascript">$.suitUp.commands = { forecolor: 'red' }</code> <br>  <br> <code class="javascript">$.extend( jQuery.suitUp.commands, { forecolor: 'red' })</code> <br>  <br> <code class="javascript">$.suitUp.commands.forecolor = 'red' // ( ,  commands -  )</code> <br> : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> 2.   () <br> <code class="javascript">$.suitUp.commands.forecolor = { 'Make Red': 'red', 'Make Green': 'green' }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> 3. ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( ' ', '' ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript">$( 'textarea' ).suitUp( 'italic', 'bold', '|', 'link', 'formatblock#&lt;h1&gt;' );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> 1.  Bold. <br> 2.  . <br> 3. ,             "". <br> <br>  ,        . <br> <br> <code class="javascript">$.extend( $.suitUp.commands, { bold: null, //   ,        null fontname: { Arial: 'arial', Times: 'times', Verdana: 'verdana' }, forecolor: function( callback ){ var blackBackground = $( '&lt;div/&gt;' ).css({ background: 'black', position: 'absolute', top: 0, left:0, opacity: .5, width: '100%', height: '100%' }).on( 'click', function(){ popup.add( this ).remove(); }).appendTo('body'), popup = $( '&lt;div/&gt;' ).css({ padding: '10px 20px', width: 200, position: 'absolute', background: 'white', top: 200, left: $( window ).width()/2 - 110, zIndex: 100 }).appendTo('body'); $( '&lt;input/&gt;' ).appendTo( popup ); $( '&lt;button/&gt;' ).appendTo( popup ).text( 'Go!' ).on( 'click', function() { var val = popup.children( 'input' ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor' );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . Callback   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( 'forecolor', false, ' ' );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript">$.suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript">$.extend( jQuery.suitUp.custom, { helloWorld: function() { return $( '&lt;span/&gt;', { 'class': 'suitup-control' //    }).css( 'backgroundColor', 'red' ).on( 'click', function() { alert( 'Hello World!' ); }); } });</code> <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor', 'helloWorld' );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       "link",     ( "createlink"),      ( "unlink"). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( 'a', { className: 'suitup-control', href: '#' }).attr({ 'data-command': 'createlink' //         createlink }).on( 'click', function() { if( !$.suitUp.hasSelectedNodeParent( 'a' ) ) { document.execCommand( 'createlink', false, window.prompt( 'URL:', '' ) ); } else { document.execCommand( 'unlink', false, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor#red</code> )    : <br>  .   .  , ""  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript">$.suitUp.controls = [ 'bold', 'italic' ]; $( '.suitup-textarea' ).suitUp(); //    ,   $( '.suitup-textarea' ).suitUp( 'bold', 'italic' );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript">$.suitUp.controls.push( 'forecolor' ); $( '.suitup-textarea' ).suitUp();</code> <br>   : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( $.suitUp.controls.concat([ 'forecolor' ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   $.suitUp   .  ,            .      ,      ,  . <br> <br> <b>$.suitUp.getSelection</b> <br>   .          . <br> <br> <b>$.suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = $.suitUp.getSelection(); //  -,     $( '.suitup-editor' ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b>$.suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b>$.suitUp.hasSelectedNodeParent</b> <br>  ,      "link". ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( 'a' ); // true/false</code> <br> <br>    Chrome, Firefox, IE10 (+IE7 Mode) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/Suitup</a> <br> <br>   extended-commands.suitup.jquery.js     .    50        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b>UPD</b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> 1.          . ,  bold  Chrome     b,   IE   strong. <br> 2.          (      ). <br> 3.    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> </h4> <code><code>, ,     IE,        execCommand( 'formatblock' ... )</code>   .   :     " ",       .   IE...    ?..     <code>queryCommandValue( 'formatblock' )</code>  <code>" 1", " 2", ""</code> , .     , , , ,         .     ,    IE10. ,  ,    IE10!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  SuitUp <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript">$( '.my-textarea' ).suitUp();</code> <br>       : <br> <code class="javascript">$( '.my-textarea' ).suitUp( 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' );</code> <br>       <br> <code class="javascript">$( '.my-textarea' ).suitUp([ 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , 'forecolor',      : <br> <br> 1. ,  :  forecolor    red: <br> <code class="javascript">$.suitUp.commands = { forecolor: 'red' }</code> <br>  <br> <code class="javascript">$.extend( jQuery.suitUp.commands, { forecolor: 'red' })</code> <br>  <br> <code class="javascript">$.suitUp.commands.forecolor = 'red' // ( ,  commands -  )</code> <br> : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> 2.   () <br> <code class="javascript">$.suitUp.commands.forecolor = { 'Make Red': 'red', 'Make Green': 'green' }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> 3. ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( ' ', '' ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript">$( 'textarea' ).suitUp( 'italic', 'bold', '|', 'link', 'formatblock#&lt;h1&gt;' );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> 1.  Bold. <br> 2.  . <br> 3. ,             "". <br> <br>  ,        . <br> <br> <code class="javascript">$.extend( $.suitUp.commands, { bold: null, //   ,        null fontname: { Arial: 'arial', Times: 'times', Verdana: 'verdana' }, forecolor: function( callback ){ var blackBackground = $( '&lt;div/&gt;' ).css({ background: 'black', position: 'absolute', top: 0, left:0, opacity: .5, width: '100%', height: '100%' }).on( 'click', function(){ popup.add( this ).remove(); }).appendTo('body'), popup = $( '&lt;div/&gt;' ).css({ padding: '10px 20px', width: 200, position: 'absolute', background: 'white', top: 200, left: $( window ).width()/2 - 110, zIndex: 100 }).appendTo('body'); $( '&lt;input/&gt;' ).appendTo( popup ); $( '&lt;button/&gt;' ).appendTo( popup ).text( 'Go!' ).on( 'click', function() { var val = popup.children( 'input' ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor' );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . Callback   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( 'forecolor', false, ' ' );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript">$.suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript">$.extend( jQuery.suitUp.custom, { helloWorld: function() { return $( '&lt;span/&gt;', { 'class': 'suitup-control' //    }).css( 'backgroundColor', 'red' ).on( 'click', function() { alert( 'Hello World!' ); }); } });</code> <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor', 'helloWorld' );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       "link",     ( "createlink"),      ( "unlink"). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( 'a', { className: 'suitup-control', href: '#' }).attr({ 'data-command': 'createlink' //         createlink }).on( 'click', function() { if( !$.suitUp.hasSelectedNodeParent( 'a' ) ) { document.execCommand( 'createlink', false, window.prompt( 'URL:', '' ) ); } else { document.execCommand( 'unlink', false, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor#red</code> )    : <br>  .   .  , ""  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript">$.suitUp.controls = [ 'bold', 'italic' ]; $( '.suitup-textarea' ).suitUp(); //    ,   $( '.suitup-textarea' ).suitUp( 'bold', 'italic' );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript">$.suitUp.controls.push( 'forecolor' ); $( '.suitup-textarea' ).suitUp();</code> <br>   : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( $.suitUp.controls.concat([ 'forecolor' ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   $.suitUp   .  ,            .      ,      ,  . <br> <br> <b>$.suitUp.getSelection</b> <br>   .          . <br> <br> <b>$.suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = $.suitUp.getSelection(); //  -,     $( '.suitup-editor' ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b>$.suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b>$.suitUp.hasSelectedNodeParent</b> <br>  ,      "link". ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( 'a' ); // true/false</code> <br> <br>    Chrome, Firefox, IE10 (+IE7 Mode) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/Suitup</a> <br> <br>   extended-commands.suitup.jquery.js     .    50        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b>UPD</b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> 1.          . ,  bold  Chrome     b,   IE   strong. <br> 2.          (      ). <br> 3.    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> <pre> <code class="hljs smalltalk"><code class="javascript"><code>, ,     <span class="hljs-type"><span class="hljs-type">IE</span></span>,        execCommand( <span class="hljs-string"><span class="hljs-string">'formatblock'</span></span> ... )</code>   .   :     <span class="hljs-comment"><span class="hljs-comment">" "</span></span>,       .   <span class="hljs-type"><span class="hljs-type">IE</span></span>...    ?..     <code>queryCommandValue( <span class="hljs-string"><span class="hljs-string">'formatblock'</span></span> )</code>  <code><span class="hljs-comment"><span class="hljs-comment">" 1"</span></span>, <span class="hljs-comment"><span class="hljs-comment">" 2"</span></span>, <span class="hljs-comment"><span class="hljs-comment">""</span></span></code> , .     , , , ,         .     ,    <span class="hljs-type"><span class="hljs-type">IE10</span></span>. ,  ,    <span class="hljs-type"><span class="hljs-type">IE10</span></span>!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  <span class="hljs-type"><span class="hljs-type">SuitUp</span></span> <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp(); <br>       : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> );</code> <br>       <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp([ <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>,      : <br> <br> <span class="hljs-number"><span class="hljs-number">1.</span></span> ,  :  forecolor    red: <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands = { forecolor: <span class="hljs-string"><span class="hljs-string">'red'</span></span> }</code> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( jQuery.suitUp.commands, { forecolor: <span class="hljs-string"><span class="hljs-string">'red'</span></span> })</code> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands.forecolor = <span class="hljs-string"><span class="hljs-string">'red'</span></span> // ( ,  commands -  )</code> <br> : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>   () <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands.forecolor = { <span class="hljs-string"><span class="hljs-string">'Make Red'</span></span>: <span class="hljs-string"><span class="hljs-string">'red'</span></span>, <span class="hljs-string"><span class="hljs-string">'Make Green'</span></span>: <span class="hljs-string"><span class="hljs-string">'green'</span></span> }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> <span class="hljs-number"><span class="hljs-number">3.</span></span> ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span> ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'link'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> <span class="hljs-number"><span class="hljs-number">1.</span></span>  <span class="hljs-type"><span class="hljs-type">Bold</span></span>. <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>  . <br> <span class="hljs-number"><span class="hljs-number">3.</span></span> ,             <span class="hljs-comment"><span class="hljs-comment">""</span></span>. <br> <br>  ,        . <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands, { bold: null, //   ,        null fontname: { <span class="hljs-type"><span class="hljs-type">Arial</span></span>: <span class="hljs-string"><span class="hljs-string">'arial'</span></span>, <span class="hljs-type"><span class="hljs-type">Times</span></span>: <span class="hljs-string"><span class="hljs-string">'times'</span></span>, <span class="hljs-type"><span class="hljs-type">Verdana</span></span>: <span class="hljs-string"><span class="hljs-string">'verdana'</span></span> }, forecolor: function( callback ){ var blackBackground = <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;div/&gt;'</span></span> ).css({ background: <span class="hljs-string"><span class="hljs-string">'black'</span></span>, position: <span class="hljs-string"><span class="hljs-string">'absolute'</span></span>, top: <span class="hljs-number"><span class="hljs-number">0</span></span>, left:<span class="hljs-number"><span class="hljs-number">0</span></span>, opacity: <span class="hljs-number"><span class="hljs-number">.5</span></span>, width: <span class="hljs-string"><span class="hljs-string">'100%'</span></span>, height: <span class="hljs-string"><span class="hljs-string">'100%'</span></span> }).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function(){ popup.add( this ).remove(); }).appendTo(<span class="hljs-string"><span class="hljs-string">'body'</span></span>), popup = <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;div/&gt;'</span></span> ).css({ padding: <span class="hljs-string"><span class="hljs-string">'10px 20px'</span></span>, width: <span class="hljs-number"><span class="hljs-number">200</span></span>, position: <span class="hljs-string"><span class="hljs-string">'absolute'</span></span>, background: <span class="hljs-string"><span class="hljs-string">'white'</span></span>, top: <span class="hljs-number"><span class="hljs-number">200</span></span>, left: <span class="hljs-string"><span class="hljs-string">$(</span></span> window ).width()/<span class="hljs-number"><span class="hljs-number">2</span></span> - <span class="hljs-number"><span class="hljs-number">110</span></span>, zIndex: <span class="hljs-number"><span class="hljs-number">100</span></span> }).appendTo(<span class="hljs-string"><span class="hljs-string">'body'</span></span>); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;input/&gt;'</span></span> ).appendTo( popup ); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;button/&gt;'</span></span> ).appendTo( popup ).text( <span class="hljs-string"><span class="hljs-string">'Go!'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { var val = popup.children( <span class="hljs-string"><span class="hljs-string">'input'</span></span> ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'fontname'</span></span>, <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . <span class="hljs-type"><span class="hljs-type">Callback</span></span>   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span> );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( jQuery.suitUp.custom, { helloWorld: function() { return <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;span/&gt;'</span></span>, { <span class="hljs-string"><span class="hljs-string">'class'</span></span>: <span class="hljs-string"><span class="hljs-string">'suitup-control'</span></span> //    }).css( <span class="hljs-string"><span class="hljs-string">'backgroundColor'</span></span>, <span class="hljs-string"><span class="hljs-string">'red'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { alert( <span class="hljs-string"><span class="hljs-string">'Hello World!'</span></span> ); }); } });</code> <br> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'fontname'</span></span>, <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>, <span class="hljs-string"><span class="hljs-string">'helloWorld'</span></span> );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       <span class="hljs-comment"><span class="hljs-comment">"link"</span></span>,     ( <span class="hljs-comment"><span class="hljs-comment">"createlink"</span></span>),      ( <span class="hljs-comment"><span class="hljs-comment">"unlink"</span></span>). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( <span class="hljs-string"><span class="hljs-string">'a'</span></span>, { className: <span class="hljs-string"><span class="hljs-string">'suitup-control'</span></span>, href: <span class="hljs-string"><span class="hljs-string">'#'</span></span> }).attr({ <span class="hljs-string"><span class="hljs-string">'data-command'</span></span>: <span class="hljs-string"><span class="hljs-string">'createlink'</span></span> //         createlink }).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { if( !<span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.hasSelectedNodeParent( <span class="hljs-string"><span class="hljs-string">'a'</span></span> ) ) { document.execCommand( <span class="hljs-string"><span class="hljs-string">'createlink'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, window.prompt( <span class="hljs-string"><span class="hljs-string">'URL:'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span> ) ); } else { document.execCommand( <span class="hljs-string"><span class="hljs-string">'unlink'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor<span class="hljs-symbol"><span class="hljs-symbol">#red</span></span></code> )    : <br>  .   .  , <span class="hljs-comment"><span class="hljs-comment">""</span></span>  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls = [ <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'italic'</span></span> ]; <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp(); //    ,   <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'italic'</span></span> );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls.push( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp();</code> <br>   : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls.concat([ <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp   .  ,            .      ,      ,  . <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelection</b> <br>   .          . <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelection(); //  -,     <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-editor'</span></span> ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.hasSelectedNodeParent</b> <br>  ,      <span class="hljs-comment"><span class="hljs-comment">"link"</span></span>. ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( <span class="hljs-string"><span class="hljs-string">'a'</span></span> ); // <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">false</span></span></code> <br> <br>    <span class="hljs-type"><span class="hljs-type">Chrome</span></span>, <span class="hljs-type"><span class="hljs-type">Firefox</span></span>, <span class="hljs-type"><span class="hljs-type">IE10</span></span> (+<span class="hljs-type"><span class="hljs-type">IE7</span></span> <span class="hljs-type"><span class="hljs-type">Mode</span></span>) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/<span class="hljs-type"><span class="hljs-type">Suitup</span></span></a> <br> <br>   extended-commands.suitup.jquery.js     .    <span class="hljs-number"><span class="hljs-number">50</span></span>        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b><span class="hljs-type"><span class="hljs-type">UPD</span></span></b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> <span class="hljs-number"><span class="hljs-number">1.</span></span>          . ,  bold  <span class="hljs-type"><span class="hljs-type">Chrome</span></span>     b,   <span class="hljs-type"><span class="hljs-type">IE</span></span>   strong. <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>          (      ). <br> <span class="hljs-number"><span class="hljs-number">3.</span></span>    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code></code> </pre> <code><code>, ,     IE,        execCommand( 'formatblock' ... )</code>   .   :     " ",       .   IE...    ?..     <code>queryCommandValue( 'formatblock' )</code>  <code>" 1", " 2", ""</code> , .     , , , ,         .     ,    IE10. ,  ,    IE10!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  SuitUp <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript">$( '.my-textarea' ).suitUp();</code> <br>       : <br> <code class="javascript">$( '.my-textarea' ).suitUp( 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' );</code> <br>       <br> <code class="javascript">$( '.my-textarea' ).suitUp([ 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , 'forecolor',      : <br> <br> 1. ,  :  forecolor    red: <br> <code class="javascript">$.suitUp.commands = { forecolor: 'red' }</code> <br>  <br> <code class="javascript">$.extend( jQuery.suitUp.commands, { forecolor: 'red' })</code> <br>  <br> <code class="javascript">$.suitUp.commands.forecolor = 'red' // ( ,  commands -  )</code> <br> : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> 2.   () <br> <code class="javascript">$.suitUp.commands.forecolor = { 'Make Red': 'red', 'Make Green': 'green' }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> 3. ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( ' ', '' ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript">$( 'textarea' ).suitUp( 'italic', 'bold', '|', 'link', 'formatblock#&lt;h1&gt;' );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> 1.  Bold. <br> 2.  . <br> 3. ,             "". <br> <br>  ,        . <br> <br> <code class="javascript">$.extend( $.suitUp.commands, { bold: null, //   ,        null fontname: { Arial: 'arial', Times: 'times', Verdana: 'verdana' }, forecolor: function( callback ){ var blackBackground = $( '&lt;div/&gt;' ).css({ background: 'black', position: 'absolute', top: 0, left:0, opacity: .5, width: '100%', height: '100%' }).on( 'click', function(){ popup.add( this ).remove(); }).appendTo('body'), popup = $( '&lt;div/&gt;' ).css({ padding: '10px 20px', width: 200, position: 'absolute', background: 'white', top: 200, left: $( window ).width()/2 - 110, zIndex: 100 }).appendTo('body'); $( '&lt;input/&gt;' ).appendTo( popup ); $( '&lt;button/&gt;' ).appendTo( popup ).text( 'Go!' ).on( 'click', function() { var val = popup.children( 'input' ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor' );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . Callback   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( 'forecolor', false, ' ' );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript">$.suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript">$.extend( jQuery.suitUp.custom, { helloWorld: function() { return $( '&lt;span/&gt;', { 'class': 'suitup-control' //    }).css( 'backgroundColor', 'red' ).on( 'click', function() { alert( 'Hello World!' ); }); } });</code> <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor', 'helloWorld' );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       "link",     ( "createlink"),      ( "unlink"). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( 'a', { className: 'suitup-control', href: '#' }).attr({ 'data-command': 'createlink' //         createlink }).on( 'click', function() { if( !$.suitUp.hasSelectedNodeParent( 'a' ) ) { document.execCommand( 'createlink', false, window.prompt( 'URL:', '' ) ); } else { document.execCommand( 'unlink', false, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor#red</code> )    : <br>  .   .  , ""  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript">$.suitUp.controls = [ 'bold', 'italic' ]; $( '.suitup-textarea' ).suitUp(); //    ,   $( '.suitup-textarea' ).suitUp( 'bold', 'italic' );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript">$.suitUp.controls.push( 'forecolor' ); $( '.suitup-textarea' ).suitUp();</code> <br>   : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( $.suitUp.controls.concat([ 'forecolor' ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   $.suitUp   .  ,            .      ,      ,  . <br> <br> <b>$.suitUp.getSelection</b> <br>   .          . <br> <br> <b>$.suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = $.suitUp.getSelection(); //  -,     $( '.suitup-editor' ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b>$.suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b>$.suitUp.hasSelectedNodeParent</b> <br>  ,      "link". ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( 'a' ); // true/false</code> <br> <br>    Chrome, Firefox, IE10 (+IE7 Mode) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/Suitup</a> <br> <br>   extended-commands.suitup.jquery.js     .    50        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b>UPD</b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> 1.          . ,  bold  Chrome     b,   IE   strong. <br> 2.          (      ). <br> 3.    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> <pre> <code class="hljs smalltalk"><code class="javascript"><code>, ,     <span class="hljs-type"><span class="hljs-type">IE</span></span>,        execCommand( <span class="hljs-string"><span class="hljs-string">'formatblock'</span></span> ... )</code>   .   :     <span class="hljs-comment"><span class="hljs-comment">" "</span></span>,       .   <span class="hljs-type"><span class="hljs-type">IE</span></span>...    ?..     <code>queryCommandValue( <span class="hljs-string"><span class="hljs-string">'formatblock'</span></span> )</code>  <code><span class="hljs-comment"><span class="hljs-comment">" 1"</span></span>, <span class="hljs-comment"><span class="hljs-comment">" 2"</span></span>, <span class="hljs-comment"><span class="hljs-comment">""</span></span></code> , .     , , , ,         .     ,    <span class="hljs-type"><span class="hljs-type">IE10</span></span>. ,  ,    <span class="hljs-type"><span class="hljs-type">IE10</span></span>!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  <span class="hljs-type"><span class="hljs-type">SuitUp</span></span> <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp();</code> <br>       : <br> <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> ); <br>       <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp([ <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>,      : <br> <br> <span class="hljs-number"><span class="hljs-number">1.</span></span> ,  :  forecolor    red: <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands = { forecolor: <span class="hljs-string"><span class="hljs-string">'red'</span></span> }</code> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( jQuery.suitUp.commands, { forecolor: <span class="hljs-string"><span class="hljs-string">'red'</span></span> })</code> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands.forecolor = <span class="hljs-string"><span class="hljs-string">'red'</span></span> // ( ,  commands -  )</code> <br> : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>   () <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands.forecolor = { <span class="hljs-string"><span class="hljs-string">'Make Red'</span></span>: <span class="hljs-string"><span class="hljs-string">'red'</span></span>, <span class="hljs-string"><span class="hljs-string">'Make Green'</span></span>: <span class="hljs-string"><span class="hljs-string">'green'</span></span> }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> <span class="hljs-number"><span class="hljs-number">3.</span></span> ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span> ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'link'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> <span class="hljs-number"><span class="hljs-number">1.</span></span>  <span class="hljs-type"><span class="hljs-type">Bold</span></span>. <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>  . <br> <span class="hljs-number"><span class="hljs-number">3.</span></span> ,             <span class="hljs-comment"><span class="hljs-comment">""</span></span>. <br> <br>  ,        . <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands, { bold: null, //   ,        null fontname: { <span class="hljs-type"><span class="hljs-type">Arial</span></span>: <span class="hljs-string"><span class="hljs-string">'arial'</span></span>, <span class="hljs-type"><span class="hljs-type">Times</span></span>: <span class="hljs-string"><span class="hljs-string">'times'</span></span>, <span class="hljs-type"><span class="hljs-type">Verdana</span></span>: <span class="hljs-string"><span class="hljs-string">'verdana'</span></span> }, forecolor: function( callback ){ var blackBackground = <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;div/&gt;'</span></span> ).css({ background: <span class="hljs-string"><span class="hljs-string">'black'</span></span>, position: <span class="hljs-string"><span class="hljs-string">'absolute'</span></span>, top: <span class="hljs-number"><span class="hljs-number">0</span></span>, left:<span class="hljs-number"><span class="hljs-number">0</span></span>, opacity: <span class="hljs-number"><span class="hljs-number">.5</span></span>, width: <span class="hljs-string"><span class="hljs-string">'100%'</span></span>, height: <span class="hljs-string"><span class="hljs-string">'100%'</span></span> }).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function(){ popup.add( this ).remove(); }).appendTo(<span class="hljs-string"><span class="hljs-string">'body'</span></span>), popup = <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;div/&gt;'</span></span> ).css({ padding: <span class="hljs-string"><span class="hljs-string">'10px 20px'</span></span>, width: <span class="hljs-number"><span class="hljs-number">200</span></span>, position: <span class="hljs-string"><span class="hljs-string">'absolute'</span></span>, background: <span class="hljs-string"><span class="hljs-string">'white'</span></span>, top: <span class="hljs-number"><span class="hljs-number">200</span></span>, left: <span class="hljs-string"><span class="hljs-string">$(</span></span> window ).width()/<span class="hljs-number"><span class="hljs-number">2</span></span> - <span class="hljs-number"><span class="hljs-number">110</span></span>, zIndex: <span class="hljs-number"><span class="hljs-number">100</span></span> }).appendTo(<span class="hljs-string"><span class="hljs-string">'body'</span></span>); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;input/&gt;'</span></span> ).appendTo( popup ); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;button/&gt;'</span></span> ).appendTo( popup ).text( <span class="hljs-string"><span class="hljs-string">'Go!'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { var val = popup.children( <span class="hljs-string"><span class="hljs-string">'input'</span></span> ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'fontname'</span></span>, <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . <span class="hljs-type"><span class="hljs-type">Callback</span></span>   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span> );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( jQuery.suitUp.custom, { helloWorld: function() { return <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;span/&gt;'</span></span>, { <span class="hljs-string"><span class="hljs-string">'class'</span></span>: <span class="hljs-string"><span class="hljs-string">'suitup-control'</span></span> //    }).css( <span class="hljs-string"><span class="hljs-string">'backgroundColor'</span></span>, <span class="hljs-string"><span class="hljs-string">'red'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { alert( <span class="hljs-string"><span class="hljs-string">'Hello World!'</span></span> ); }); } });</code> <br> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'fontname'</span></span>, <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>, <span class="hljs-string"><span class="hljs-string">'helloWorld'</span></span> );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       <span class="hljs-comment"><span class="hljs-comment">"link"</span></span>,     ( <span class="hljs-comment"><span class="hljs-comment">"createlink"</span></span>),      ( <span class="hljs-comment"><span class="hljs-comment">"unlink"</span></span>). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( <span class="hljs-string"><span class="hljs-string">'a'</span></span>, { className: <span class="hljs-string"><span class="hljs-string">'suitup-control'</span></span>, href: <span class="hljs-string"><span class="hljs-string">'#'</span></span> }).attr({ <span class="hljs-string"><span class="hljs-string">'data-command'</span></span>: <span class="hljs-string"><span class="hljs-string">'createlink'</span></span> //         createlink }).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { if( !<span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.hasSelectedNodeParent( <span class="hljs-string"><span class="hljs-string">'a'</span></span> ) ) { document.execCommand( <span class="hljs-string"><span class="hljs-string">'createlink'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, window.prompt( <span class="hljs-string"><span class="hljs-string">'URL:'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span> ) ); } else { document.execCommand( <span class="hljs-string"><span class="hljs-string">'unlink'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor<span class="hljs-symbol"><span class="hljs-symbol">#red</span></span></code> )    : <br>  .   .  , <span class="hljs-comment"><span class="hljs-comment">""</span></span>  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls = [ <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'italic'</span></span> ]; <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp(); //    ,   <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'italic'</span></span> );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls.push( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp();</code> <br>   : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls.concat([ <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp   .  ,            .      ,      ,  . <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelection</b> <br>   .          . <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelection(); //  -,     <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-editor'</span></span> ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.hasSelectedNodeParent</b> <br>  ,      <span class="hljs-comment"><span class="hljs-comment">"link"</span></span>. ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( <span class="hljs-string"><span class="hljs-string">'a'</span></span> ); // <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">false</span></span></code> <br> <br>    <span class="hljs-type"><span class="hljs-type">Chrome</span></span>, <span class="hljs-type"><span class="hljs-type">Firefox</span></span>, <span class="hljs-type"><span class="hljs-type">IE10</span></span> (+<span class="hljs-type"><span class="hljs-type">IE7</span></span> <span class="hljs-type"><span class="hljs-type">Mode</span></span>) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/<span class="hljs-type"><span class="hljs-type">Suitup</span></span></a> <br> <br>   extended-commands.suitup.jquery.js     .    <span class="hljs-number"><span class="hljs-number">50</span></span>        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b><span class="hljs-type"><span class="hljs-type">UPD</span></span></b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> <span class="hljs-number"><span class="hljs-number">1.</span></span>          . ,  bold  <span class="hljs-type"><span class="hljs-type">Chrome</span></span>     b,   <span class="hljs-type"><span class="hljs-type">IE</span></span>   strong. <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>          (      ). <br> <span class="hljs-number"><span class="hljs-number">3.</span></span>    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code></code> </pre> <code><code>, ,     IE,        execCommand( 'formatblock' ... )</code>   .   :     " ",       .   IE...    ?..     <code>queryCommandValue( 'formatblock' )</code>  <code>" 1", " 2", ""</code> , .     , , , ,         .     ,    IE10. ,  ,    IE10!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  SuitUp <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript">$( '.my-textarea' ).suitUp();</code> <br>       : <br> <code class="javascript">$( '.my-textarea' ).suitUp( 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' );</code> <br>       <br> <code class="javascript">$( '.my-textarea' ).suitUp([ 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , 'forecolor',      : <br> <br> 1. ,  :  forecolor    red: <br> <code class="javascript">$.suitUp.commands = { forecolor: 'red' }</code> <br>  <br> <code class="javascript">$.extend( jQuery.suitUp.commands, { forecolor: 'red' })</code> <br>  <br> <code class="javascript">$.suitUp.commands.forecolor = 'red' // ( ,  commands -  )</code> <br> : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> 2.   () <br> <code class="javascript">$.suitUp.commands.forecolor = { 'Make Red': 'red', 'Make Green': 'green' }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> 3. ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( ' ', '' ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript">$( 'textarea' ).suitUp( 'italic', 'bold', '|', 'link', 'formatblock#&lt;h1&gt;' );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> 1.  Bold. <br> 2.  . <br> 3. ,             "". <br> <br>  ,        . <br> <br> <code class="javascript">$.extend( $.suitUp.commands, { bold: null, //   ,        null fontname: { Arial: 'arial', Times: 'times', Verdana: 'verdana' }, forecolor: function( callback ){ var blackBackground = $( '&lt;div/&gt;' ).css({ background: 'black', position: 'absolute', top: 0, left:0, opacity: .5, width: '100%', height: '100%' }).on( 'click', function(){ popup.add( this ).remove(); }).appendTo('body'), popup = $( '&lt;div/&gt;' ).css({ padding: '10px 20px', width: 200, position: 'absolute', background: 'white', top: 200, left: $( window ).width()/2 - 110, zIndex: 100 }).appendTo('body'); $( '&lt;input/&gt;' ).appendTo( popup ); $( '&lt;button/&gt;' ).appendTo( popup ).text( 'Go!' ).on( 'click', function() { var val = popup.children( 'input' ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor' );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . Callback   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( 'forecolor', false, ' ' );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript">$.suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript">$.extend( jQuery.suitUp.custom, { helloWorld: function() { return $( '&lt;span/&gt;', { 'class': 'suitup-control' //    }).css( 'backgroundColor', 'red' ).on( 'click', function() { alert( 'Hello World!' ); }); } });</code> <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor', 'helloWorld' );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       "link",     ( "createlink"),      ( "unlink"). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( 'a', { className: 'suitup-control', href: '#' }).attr({ 'data-command': 'createlink' //         createlink }).on( 'click', function() { if( !$.suitUp.hasSelectedNodeParent( 'a' ) ) { document.execCommand( 'createlink', false, window.prompt( 'URL:', '' ) ); } else { document.execCommand( 'unlink', false, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor#red</code> )    : <br>  .   .  , ""  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript">$.suitUp.controls = [ 'bold', 'italic' ]; $( '.suitup-textarea' ).suitUp(); //    ,   $( '.suitup-textarea' ).suitUp( 'bold', 'italic' );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript">$.suitUp.controls.push( 'forecolor' ); $( '.suitup-textarea' ).suitUp();</code> <br>   : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( $.suitUp.controls.concat([ 'forecolor' ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   $.suitUp   .  ,            .      ,      ,  . <br> <br> <b>$.suitUp.getSelection</b> <br>   .          . <br> <br> <b>$.suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = $.suitUp.getSelection(); //  -,     $( '.suitup-editor' ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b>$.suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b>$.suitUp.hasSelectedNodeParent</b> <br>  ,      "link". ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( 'a' ); // true/false</code> <br> <br>    Chrome, Firefox, IE10 (+IE7 Mode) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/Suitup</a> <br> <br>   extended-commands.suitup.jquery.js     .    50        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b>UPD</b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> 1.          . ,  bold  Chrome     b,   IE   strong. <br> 2.          (      ). <br> 3.    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> <pre> <code class="hljs smalltalk"><code class="javascript"><code>, ,     <span class="hljs-type"><span class="hljs-type">IE</span></span>,        execCommand( <span class="hljs-string"><span class="hljs-string">'formatblock'</span></span> ... )</code>   .   :     <span class="hljs-comment"><span class="hljs-comment">" "</span></span>,       .   <span class="hljs-type"><span class="hljs-type">IE</span></span>...    ?..     <code>queryCommandValue( <span class="hljs-string"><span class="hljs-string">'formatblock'</span></span> )</code>  <code><span class="hljs-comment"><span class="hljs-comment">" 1"</span></span>, <span class="hljs-comment"><span class="hljs-comment">" 2"</span></span>, <span class="hljs-comment"><span class="hljs-comment">""</span></span></code> , .     , , , ,         .     ,    <span class="hljs-type"><span class="hljs-type">IE10</span></span>. ,  ,    <span class="hljs-type"><span class="hljs-type">IE10</span></span>!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  <span class="hljs-type"><span class="hljs-type">SuitUp</span></span> <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp();</code> <br>       : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> );</code> <br>       <br> <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp([ <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> ]); <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>,      : <br> <br> <span class="hljs-number"><span class="hljs-number">1.</span></span> ,  :  forecolor    red: <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands = { forecolor: <span class="hljs-string"><span class="hljs-string">'red'</span></span> }</code> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( jQuery.suitUp.commands, { forecolor: <span class="hljs-string"><span class="hljs-string">'red'</span></span> })</code> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands.forecolor = <span class="hljs-string"><span class="hljs-string">'red'</span></span> // ( ,  commands -  )</code> <br> : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>   () <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands.forecolor = { <span class="hljs-string"><span class="hljs-string">'Make Red'</span></span>: <span class="hljs-string"><span class="hljs-string">'red'</span></span>, <span class="hljs-string"><span class="hljs-string">'Make Green'</span></span>: <span class="hljs-string"><span class="hljs-string">'green'</span></span> }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> <span class="hljs-number"><span class="hljs-number">3.</span></span> ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span> ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'link'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> <span class="hljs-number"><span class="hljs-number">1.</span></span>  <span class="hljs-type"><span class="hljs-type">Bold</span></span>. <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>  . <br> <span class="hljs-number"><span class="hljs-number">3.</span></span> ,             <span class="hljs-comment"><span class="hljs-comment">""</span></span>. <br> <br>  ,        . <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands, { bold: null, //   ,        null fontname: { <span class="hljs-type"><span class="hljs-type">Arial</span></span>: <span class="hljs-string"><span class="hljs-string">'arial'</span></span>, <span class="hljs-type"><span class="hljs-type">Times</span></span>: <span class="hljs-string"><span class="hljs-string">'times'</span></span>, <span class="hljs-type"><span class="hljs-type">Verdana</span></span>: <span class="hljs-string"><span class="hljs-string">'verdana'</span></span> }, forecolor: function( callback ){ var blackBackground = <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;div/&gt;'</span></span> ).css({ background: <span class="hljs-string"><span class="hljs-string">'black'</span></span>, position: <span class="hljs-string"><span class="hljs-string">'absolute'</span></span>, top: <span class="hljs-number"><span class="hljs-number">0</span></span>, left:<span class="hljs-number"><span class="hljs-number">0</span></span>, opacity: <span class="hljs-number"><span class="hljs-number">.5</span></span>, width: <span class="hljs-string"><span class="hljs-string">'100%'</span></span>, height: <span class="hljs-string"><span class="hljs-string">'100%'</span></span> }).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function(){ popup.add( this ).remove(); }).appendTo(<span class="hljs-string"><span class="hljs-string">'body'</span></span>), popup = <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;div/&gt;'</span></span> ).css({ padding: <span class="hljs-string"><span class="hljs-string">'10px 20px'</span></span>, width: <span class="hljs-number"><span class="hljs-number">200</span></span>, position: <span class="hljs-string"><span class="hljs-string">'absolute'</span></span>, background: <span class="hljs-string"><span class="hljs-string">'white'</span></span>, top: <span class="hljs-number"><span class="hljs-number">200</span></span>, left: <span class="hljs-string"><span class="hljs-string">$(</span></span> window ).width()/<span class="hljs-number"><span class="hljs-number">2</span></span> - <span class="hljs-number"><span class="hljs-number">110</span></span>, zIndex: <span class="hljs-number"><span class="hljs-number">100</span></span> }).appendTo(<span class="hljs-string"><span class="hljs-string">'body'</span></span>); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;input/&gt;'</span></span> ).appendTo( popup ); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;button/&gt;'</span></span> ).appendTo( popup ).text( <span class="hljs-string"><span class="hljs-string">'Go!'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { var val = popup.children( <span class="hljs-string"><span class="hljs-string">'input'</span></span> ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'fontname'</span></span>, <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . <span class="hljs-type"><span class="hljs-type">Callback</span></span>   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span> );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( jQuery.suitUp.custom, { helloWorld: function() { return <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;span/&gt;'</span></span>, { <span class="hljs-string"><span class="hljs-string">'class'</span></span>: <span class="hljs-string"><span class="hljs-string">'suitup-control'</span></span> //    }).css( <span class="hljs-string"><span class="hljs-string">'backgroundColor'</span></span>, <span class="hljs-string"><span class="hljs-string">'red'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { alert( <span class="hljs-string"><span class="hljs-string">'Hello World!'</span></span> ); }); } });</code> <br> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'fontname'</span></span>, <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>, <span class="hljs-string"><span class="hljs-string">'helloWorld'</span></span> );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       <span class="hljs-comment"><span class="hljs-comment">"link"</span></span>,     ( <span class="hljs-comment"><span class="hljs-comment">"createlink"</span></span>),      ( <span class="hljs-comment"><span class="hljs-comment">"unlink"</span></span>). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( <span class="hljs-string"><span class="hljs-string">'a'</span></span>, { className: <span class="hljs-string"><span class="hljs-string">'suitup-control'</span></span>, href: <span class="hljs-string"><span class="hljs-string">'#'</span></span> }).attr({ <span class="hljs-string"><span class="hljs-string">'data-command'</span></span>: <span class="hljs-string"><span class="hljs-string">'createlink'</span></span> //         createlink }).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { if( !<span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.hasSelectedNodeParent( <span class="hljs-string"><span class="hljs-string">'a'</span></span> ) ) { document.execCommand( <span class="hljs-string"><span class="hljs-string">'createlink'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, window.prompt( <span class="hljs-string"><span class="hljs-string">'URL:'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span> ) ); } else { document.execCommand( <span class="hljs-string"><span class="hljs-string">'unlink'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor<span class="hljs-symbol"><span class="hljs-symbol">#red</span></span></code> )    : <br>  .   .  , <span class="hljs-comment"><span class="hljs-comment">""</span></span>  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls = [ <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'italic'</span></span> ]; <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp(); //    ,   <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'italic'</span></span> );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls.push( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp();</code> <br>   : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls.concat([ <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp   .  ,            .      ,      ,  . <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelection</b> <br>   .          . <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelection(); //  -,     <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-editor'</span></span> ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.hasSelectedNodeParent</b> <br>  ,      <span class="hljs-comment"><span class="hljs-comment">"link"</span></span>. ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( <span class="hljs-string"><span class="hljs-string">'a'</span></span> ); // <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">false</span></span></code> <br> <br>    <span class="hljs-type"><span class="hljs-type">Chrome</span></span>, <span class="hljs-type"><span class="hljs-type">Firefox</span></span>, <span class="hljs-type"><span class="hljs-type">IE10</span></span> (+<span class="hljs-type"><span class="hljs-type">IE7</span></span> <span class="hljs-type"><span class="hljs-type">Mode</span></span>) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/<span class="hljs-type"><span class="hljs-type">Suitup</span></span></a> <br> <br>   extended-commands.suitup.jquery.js     .    <span class="hljs-number"><span class="hljs-number">50</span></span>        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b><span class="hljs-type"><span class="hljs-type">UPD</span></span></b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> <span class="hljs-number"><span class="hljs-number">1.</span></span>          . ,  bold  <span class="hljs-type"><span class="hljs-type">Chrome</span></span>     b,   <span class="hljs-type"><span class="hljs-type">IE</span></span>   strong. <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>          (      ). <br> <span class="hljs-number"><span class="hljs-number">3.</span></span>    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code></code> </pre> <code><code>, ,     IE,        execCommand( 'formatblock' ... )</code>   .   :     " ",       .   IE...    ?..     <code>queryCommandValue( 'formatblock' )</code>  <code>" 1", " 2", ""</code> , .     , , , ,         .     ,    IE10. ,  ,    IE10!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  SuitUp <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript">$( '.my-textarea' ).suitUp();</code> <br>       : <br> <code class="javascript">$( '.my-textarea' ).suitUp( 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' );</code> <br>       <br> <code class="javascript">$( '.my-textarea' ).suitUp([ 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , 'forecolor',      : <br> <br> 1. ,  :  forecolor    red: <br> <code class="javascript">$.suitUp.commands = { forecolor: 'red' }</code> <br>  <br> <code class="javascript">$.extend( jQuery.suitUp.commands, { forecolor: 'red' })</code> <br>  <br> <code class="javascript">$.suitUp.commands.forecolor = 'red' // ( ,  commands -  )</code> <br> : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> 2.   () <br> <code class="javascript">$.suitUp.commands.forecolor = { 'Make Red': 'red', 'Make Green': 'green' }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> 3. ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( ' ', '' ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript">$( 'textarea' ).suitUp( 'italic', 'bold', '|', 'link', 'formatblock#&lt;h1&gt;' );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> 1.  Bold. <br> 2.  . <br> 3. ,             "". <br> <br>  ,        . <br> <br> <code class="javascript">$.extend( $.suitUp.commands, { bold: null, //   ,        null fontname: { Arial: 'arial', Times: 'times', Verdana: 'verdana' }, forecolor: function( callback ){ var blackBackground = $( '&lt;div/&gt;' ).css({ background: 'black', position: 'absolute', top: 0, left:0, opacity: .5, width: '100%', height: '100%' }).on( 'click', function(){ popup.add( this ).remove(); }).appendTo('body'), popup = $( '&lt;div/&gt;' ).css({ padding: '10px 20px', width: 200, position: 'absolute', background: 'white', top: 200, left: $( window ).width()/2 - 110, zIndex: 100 }).appendTo('body'); $( '&lt;input/&gt;' ).appendTo( popup ); $( '&lt;button/&gt;' ).appendTo( popup ).text( 'Go!' ).on( 'click', function() { var val = popup.children( 'input' ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor' );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . Callback   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( 'forecolor', false, ' ' );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript">$.suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript">$.extend( jQuery.suitUp.custom, { helloWorld: function() { return $( '&lt;span/&gt;', { 'class': 'suitup-control' //    }).css( 'backgroundColor', 'red' ).on( 'click', function() { alert( 'Hello World!' ); }); } });</code> <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor', 'helloWorld' );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       "link",     ( "createlink"),      ( "unlink"). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( 'a', { className: 'suitup-control', href: '#' }).attr({ 'data-command': 'createlink' //         createlink }).on( 'click', function() { if( !$.suitUp.hasSelectedNodeParent( 'a' ) ) { document.execCommand( 'createlink', false, window.prompt( 'URL:', '' ) ); } else { document.execCommand( 'unlink', false, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor#red</code> )    : <br>  .   .  , ""  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript">$.suitUp.controls = [ 'bold', 'italic' ]; $( '.suitup-textarea' ).suitUp(); //    ,   $( '.suitup-textarea' ).suitUp( 'bold', 'italic' );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript">$.suitUp.controls.push( 'forecolor' ); $( '.suitup-textarea' ).suitUp();</code> <br>   : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( $.suitUp.controls.concat([ 'forecolor' ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   $.suitUp   .  ,            .      ,      ,  . <br> <br> <b>$.suitUp.getSelection</b> <br>   .          . <br> <br> <b>$.suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = $.suitUp.getSelection(); //  -,     $( '.suitup-editor' ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b>$.suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b>$.suitUp.hasSelectedNodeParent</b> <br>  ,      "link". ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( 'a' ); // true/false</code> <br> <br>    Chrome, Firefox, IE10 (+IE7 Mode) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/Suitup</a> <br> <br>   extended-commands.suitup.jquery.js     .    50        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b>UPD</b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> 1.          . ,  bold  Chrome     b,   IE   strong. <br> 2.          (      ). <br> 3.    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> <h5> <code><code>, ,     IE,        execCommand( 'formatblock' ... )</code>   .   :     " ",       .   IE...    ?..     <code>queryCommandValue( 'formatblock' )</code>  <code>" 1", " 2", ""</code> , .     , , , ,         .     ,    IE10. ,  ,    IE10!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  SuitUp <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript">$( '.my-textarea' ).suitUp();</code> <br>       : <br> <code class="javascript">$( '.my-textarea' ).suitUp( 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' );</code> <br>       <br> <code class="javascript">$( '.my-textarea' ).suitUp([ 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , 'forecolor',      : <br> <br> 1. ,  :  forecolor    red: <br> <code class="javascript">$.suitUp.commands = { forecolor: 'red' }</code> <br>  <br> <code class="javascript">$.extend( jQuery.suitUp.commands, { forecolor: 'red' })</code> <br>  <br> <code class="javascript">$.suitUp.commands.forecolor = 'red' // ( ,  commands -  )</code> <br> : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> 2.   () <br> <code class="javascript">$.suitUp.commands.forecolor = { 'Make Red': 'red', 'Make Green': 'green' }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> 3. ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( ' ', '' ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript">$( 'textarea' ).suitUp( 'italic', 'bold', '|', 'link', 'formatblock#&lt;h1&gt;' );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> 1.  Bold. <br> 2.  . <br> 3. ,             "". <br> <br>  ,        . <br> <br> <code class="javascript">$.extend( $.suitUp.commands, { bold: null, //   ,        null fontname: { Arial: 'arial', Times: 'times', Verdana: 'verdana' }, forecolor: function( callback ){ var blackBackground = $( '&lt;div/&gt;' ).css({ background: 'black', position: 'absolute', top: 0, left:0, opacity: .5, width: '100%', height: '100%' }).on( 'click', function(){ popup.add( this ).remove(); }).appendTo('body'), popup = $( '&lt;div/&gt;' ).css({ padding: '10px 20px', width: 200, position: 'absolute', background: 'white', top: 200, left: $( window ).width()/2 - 110, zIndex: 100 }).appendTo('body'); $( '&lt;input/&gt;' ).appendTo( popup ); $( '&lt;button/&gt;' ).appendTo( popup ).text( 'Go!' ).on( 'click', function() { var val = popup.children( 'input' ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor' );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . Callback   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( 'forecolor', false, ' ' );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript">$.suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript">$.extend( jQuery.suitUp.custom, { helloWorld: function() { return $( '&lt;span/&gt;', { 'class': 'suitup-control' //    }).css( 'backgroundColor', 'red' ).on( 'click', function() { alert( 'Hello World!' ); }); } });</code> <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor', 'helloWorld' );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       "link",     ( "createlink"),      ( "unlink"). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( 'a', { className: 'suitup-control', href: '#' }).attr({ 'data-command': 'createlink' //         createlink }).on( 'click', function() { if( !$.suitUp.hasSelectedNodeParent( 'a' ) ) { document.execCommand( 'createlink', false, window.prompt( 'URL:', '' ) ); } else { document.execCommand( 'unlink', false, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor#red</code> )    : <br>  .   .  , ""  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript">$.suitUp.controls = [ 'bold', 'italic' ]; $( '.suitup-textarea' ).suitUp(); //    ,   $( '.suitup-textarea' ).suitUp( 'bold', 'italic' );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript">$.suitUp.controls.push( 'forecolor' ); $( '.suitup-textarea' ).suitUp();</code> <br>   : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( $.suitUp.controls.concat([ 'forecolor' ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   $.suitUp   .  ,            .      ,      ,  . <br> <br> <b>$.suitUp.getSelection</b> <br>   .          . <br> <br> <b>$.suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = $.suitUp.getSelection(); //  -,     $( '.suitup-editor' ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b>$.suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b>$.suitUp.hasSelectedNodeParent</b> <br>  ,      "link". ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( 'a' ); // true/false</code> <br> <br>    Chrome, Firefox, IE10 (+IE7 Mode) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/Suitup</a> <br> <br>   extended-commands.suitup.jquery.js     .    50        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b>UPD</b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> 1.          . ,  bold  Chrome     b,   IE   strong. <br> 2.          (      ). <br> 3.    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> </h5> <code><code>, ,     IE,        execCommand( 'formatblock' ... )</code>   .   :     " ",       .   IE...    ?..     <code>queryCommandValue( 'formatblock' )</code>  <code>" 1", " 2", ""</code> , .     , , , ,         .     ,    IE10. ,  ,    IE10!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  SuitUp <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript">$( '.my-textarea' ).suitUp();</code> <br>       : <br> <code class="javascript">$( '.my-textarea' ).suitUp( 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' );</code> <br>       <br> <code class="javascript">$( '.my-textarea' ).suitUp([ 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , 'forecolor',      : <br> <br> 1. ,  :  forecolor    red: <br> <code class="javascript">$.suitUp.commands = { forecolor: 'red' }</code> <br>  <br> <code class="javascript">$.extend( jQuery.suitUp.commands, { forecolor: 'red' })</code> <br>  <br> <code class="javascript">$.suitUp.commands.forecolor = 'red' // ( ,  commands -  )</code> <br> : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> 2.   () <br> <code class="javascript">$.suitUp.commands.forecolor = { 'Make Red': 'red', 'Make Green': 'green' }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> 3. ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( ' ', '' ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript">$( 'textarea' ).suitUp( 'italic', 'bold', '|', 'link', 'formatblock#&lt;h1&gt;' );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> 1.  Bold. <br> 2.  . <br> 3. ,             "". <br> <br>  ,        . <br> <br> <code class="javascript">$.extend( $.suitUp.commands, { bold: null, //   ,        null fontname: { Arial: 'arial', Times: 'times', Verdana: 'verdana' }, forecolor: function( callback ){ var blackBackground = $( '&lt;div/&gt;' ).css({ background: 'black', position: 'absolute', top: 0, left:0, opacity: .5, width: '100%', height: '100%' }).on( 'click', function(){ popup.add( this ).remove(); }).appendTo('body'), popup = $( '&lt;div/&gt;' ).css({ padding: '10px 20px', width: 200, position: 'absolute', background: 'white', top: 200, left: $( window ).width()/2 - 110, zIndex: 100 }).appendTo('body'); $( '&lt;input/&gt;' ).appendTo( popup ); $( '&lt;button/&gt;' ).appendTo( popup ).text( 'Go!' ).on( 'click', function() { var val = popup.children( 'input' ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor' );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . Callback   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( 'forecolor', false, ' ' );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript">$.suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript">$.extend( jQuery.suitUp.custom, { helloWorld: function() { return $( '&lt;span/&gt;', { 'class': 'suitup-control' //    }).css( 'backgroundColor', 'red' ).on( 'click', function() { alert( 'Hello World!' ); }); } });</code> <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor', 'helloWorld' );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       "link",     ( "createlink"),      ( "unlink"). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( 'a', { className: 'suitup-control', href: '#' }).attr({ 'data-command': 'createlink' //         createlink }).on( 'click', function() { if( !$.suitUp.hasSelectedNodeParent( 'a' ) ) { document.execCommand( 'createlink', false, window.prompt( 'URL:', '' ) ); } else { document.execCommand( 'unlink', false, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor#red</code> )    : <br>  .   .  , ""  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript">$.suitUp.controls = [ 'bold', 'italic' ]; $( '.suitup-textarea' ).suitUp(); //    ,   $( '.suitup-textarea' ).suitUp( 'bold', 'italic' );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript">$.suitUp.controls.push( 'forecolor' ); $( '.suitup-textarea' ).suitUp();</code> <br>   : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( $.suitUp.controls.concat([ 'forecolor' ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   $.suitUp   .  ,            .      ,      ,  . <br> <br> <b>$.suitUp.getSelection</b> <br>   .          . <br> <br> <b>$.suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = $.suitUp.getSelection(); //  -,     $( '.suitup-editor' ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b>$.suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b>$.suitUp.hasSelectedNodeParent</b> <br>  ,      "link". ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( 'a' ); // true/false</code> <br> <br>    Chrome, Firefox, IE10 (+IE7 Mode) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/Suitup</a> <br> <br>   extended-commands.suitup.jquery.js     .    50        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b>UPD</b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> 1.          . ,  bold  Chrome     b,   IE   strong. <br> 2.          (      ). <br> 3.    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> <pre> <code class="hljs smalltalk"><code>, ,     <span class="hljs-type"><span class="hljs-type">IE</span></span>,        execCommand( <span class="hljs-string"><span class="hljs-string">'formatblock'</span></span> ... )</code>   .   :     <span class="hljs-comment"><span class="hljs-comment">" "</span></span>,       .   <span class="hljs-type"><span class="hljs-type">IE</span></span>...    ?..     <code>queryCommandValue( <span class="hljs-string"><span class="hljs-string">'formatblock'</span></span> )</code>  <code><span class="hljs-comment"><span class="hljs-comment">" 1"</span></span>, <span class="hljs-comment"><span class="hljs-comment">" 2"</span></span>, <span class="hljs-comment"><span class="hljs-comment">""</span></span></code> , .     , , , ,         .     ,    <span class="hljs-type"><span class="hljs-type">IE10</span></span>. ,  ,    <span class="hljs-type"><span class="hljs-type">IE10</span></span>!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  <span class="hljs-type"><span class="hljs-type">SuitUp</span></span> <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp();</code> <br>       : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> );</code> <br>       <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp([ <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>,      : <br> <br> <span class="hljs-number"><span class="hljs-number">1.</span></span> ,  :  forecolor    red: <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands = { forecolor: <span class="hljs-string"><span class="hljs-string">'red'</span></span> }</code> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( jQuery.suitUp.commands, { forecolor: <span class="hljs-string"><span class="hljs-string">'red'</span></span> })</code> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands.forecolor = <span class="hljs-string"><span class="hljs-string">'red'</span></span> // ( ,  commands -  )</code> <br> : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>   () <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands.forecolor = { <span class="hljs-string"><span class="hljs-string">'Make Red'</span></span>: <span class="hljs-string"><span class="hljs-string">'red'</span></span>, <span class="hljs-string"><span class="hljs-string">'Make Green'</span></span>: <span class="hljs-string"><span class="hljs-string">'green'</span></span> }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> <span class="hljs-number"><span class="hljs-number">3.</span></span> ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span> ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'link'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> <span class="hljs-number"><span class="hljs-number">1.</span></span>  <span class="hljs-type"><span class="hljs-type">Bold</span></span>. <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>  . <br> <span class="hljs-number"><span class="hljs-number">3.</span></span> ,             <span class="hljs-comment"><span class="hljs-comment">""</span></span>. <br> <br>  ,        . <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands, { bold: null, //   ,        null fontname: { <span class="hljs-type"><span class="hljs-type">Arial</span></span>: <span class="hljs-string"><span class="hljs-string">'arial'</span></span>, <span class="hljs-type"><span class="hljs-type">Times</span></span>: <span class="hljs-string"><span class="hljs-string">'times'</span></span>, <span class="hljs-type"><span class="hljs-type">Verdana</span></span>: <span class="hljs-string"><span class="hljs-string">'verdana'</span></span> }, forecolor: function( callback ){ var blackBackground = <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;div/&gt;'</span></span> ).css({ background: <span class="hljs-string"><span class="hljs-string">'black'</span></span>, position: <span class="hljs-string"><span class="hljs-string">'absolute'</span></span>, top: <span class="hljs-number"><span class="hljs-number">0</span></span>, left:<span class="hljs-number"><span class="hljs-number">0</span></span>, opacity: <span class="hljs-number"><span class="hljs-number">.5</span></span>, width: <span class="hljs-string"><span class="hljs-string">'100%'</span></span>, height: <span class="hljs-string"><span class="hljs-string">'100%'</span></span> }).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function(){ popup.add( this ).remove(); }).appendTo(<span class="hljs-string"><span class="hljs-string">'body'</span></span>), popup = <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;div/&gt;'</span></span> ).css({ padding: <span class="hljs-string"><span class="hljs-string">'10px 20px'</span></span>, width: <span class="hljs-number"><span class="hljs-number">200</span></span>, position: <span class="hljs-string"><span class="hljs-string">'absolute'</span></span>, background: <span class="hljs-string"><span class="hljs-string">'white'</span></span>, top: <span class="hljs-number"><span class="hljs-number">200</span></span>, left: <span class="hljs-string"><span class="hljs-string">$(</span></span> window ).width()/<span class="hljs-number"><span class="hljs-number">2</span></span> - <span class="hljs-number"><span class="hljs-number">110</span></span>, zIndex: <span class="hljs-number"><span class="hljs-number">100</span></span> }).appendTo(<span class="hljs-string"><span class="hljs-string">'body'</span></span>); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;input/&gt;'</span></span> ).appendTo( popup ); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;button/&gt;'</span></span> ).appendTo( popup ).text( <span class="hljs-string"><span class="hljs-string">'Go!'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { var val = popup.children( <span class="hljs-string"><span class="hljs-string">'input'</span></span> ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'fontname'</span></span>, <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . <span class="hljs-type"><span class="hljs-type">Callback</span></span>   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span> );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( jQuery.suitUp.custom, { helloWorld: function() { return <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;span/&gt;'</span></span>, { <span class="hljs-string"><span class="hljs-string">'class'</span></span>: <span class="hljs-string"><span class="hljs-string">'suitup-control'</span></span> //    }).css( <span class="hljs-string"><span class="hljs-string">'backgroundColor'</span></span>, <span class="hljs-string"><span class="hljs-string">'red'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { alert( <span class="hljs-string"><span class="hljs-string">'Hello World!'</span></span> ); }); } });</code> <br> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'fontname'</span></span>, <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>, <span class="hljs-string"><span class="hljs-string">'helloWorld'</span></span> );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       <span class="hljs-comment"><span class="hljs-comment">"link"</span></span>,     ( <span class="hljs-comment"><span class="hljs-comment">"createlink"</span></span>),      ( <span class="hljs-comment"><span class="hljs-comment">"unlink"</span></span>). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( <span class="hljs-string"><span class="hljs-string">'a'</span></span>, { className: <span class="hljs-string"><span class="hljs-string">'suitup-control'</span></span>, href: <span class="hljs-string"><span class="hljs-string">'#'</span></span> }).attr({ <span class="hljs-string"><span class="hljs-string">'data-command'</span></span>: <span class="hljs-string"><span class="hljs-string">'createlink'</span></span> //         createlink }).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { if( !<span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.hasSelectedNodeParent( <span class="hljs-string"><span class="hljs-string">'a'</span></span> ) ) { document.execCommand( <span class="hljs-string"><span class="hljs-string">'createlink'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, window.prompt( <span class="hljs-string"><span class="hljs-string">'URL:'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span> ) ); } else { document.execCommand( <span class="hljs-string"><span class="hljs-string">'unlink'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor<span class="hljs-symbol"><span class="hljs-symbol">#red</span></span></code> )    : <br>  .   .  , <span class="hljs-comment"><span class="hljs-comment">""</span></span>  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls = [ <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'italic'</span></span> ]; <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp(); //    ,   <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'italic'</span></span> );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls.push( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp();</code> <br>   : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls.concat([ <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp   .  ,            .      ,      ,  . <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelection</b> <br>   .          . <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelection(); //  -,     <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-editor'</span></span> ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.hasSelectedNodeParent</b> <br>  ,      <span class="hljs-comment"><span class="hljs-comment">"link"</span></span>. ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( <span class="hljs-string"><span class="hljs-string">'a'</span></span> ); // <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">false</span></span></code> <br> <br>    <span class="hljs-type"><span class="hljs-type">Chrome</span></span>, <span class="hljs-type"><span class="hljs-type">Firefox</span></span>, <span class="hljs-type"><span class="hljs-type">IE10</span></span> (+<span class="hljs-type"><span class="hljs-type">IE7</span></span> <span class="hljs-type"><span class="hljs-type">Mode</span></span>) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/<span class="hljs-type"><span class="hljs-type">Suitup</span></span></a> <br> <br>   extended-commands.suitup.jquery.js     .    <span class="hljs-number"><span class="hljs-number">50</span></span>        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b><span class="hljs-type"><span class="hljs-type">UPD</span></span></b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> <span class="hljs-number"><span class="hljs-number">1.</span></span>          . ,  bold  <span class="hljs-type"><span class="hljs-type">Chrome</span></span>     b,   <span class="hljs-type"><span class="hljs-type">IE</span></span>   strong. <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>          (      ). <br> <span class="hljs-number"><span class="hljs-number">3.</span></span>    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> </pre> <code><code>, ,     IE,        execCommand( 'formatblock' ... )</code>   .   :     " ",       .   IE...    ?..     <code>queryCommandValue( 'formatblock' )</code>  <code>" 1", " 2", ""</code> , .     , , , ,         .     ,    IE10. ,  ,    IE10!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  SuitUp <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript">$( '.my-textarea' ).suitUp();</code> <br>       : <br> <code class="javascript">$( '.my-textarea' ).suitUp( 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' );</code> <br>       <br> <code class="javascript">$( '.my-textarea' ).suitUp([ 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , 'forecolor',      : <br> <br> 1. ,  :  forecolor    red: <br> <code class="javascript">$.suitUp.commands = { forecolor: 'red' }</code> <br>  <br> <code class="javascript">$.extend( jQuery.suitUp.commands, { forecolor: 'red' })</code> <br>  <br> <code class="javascript">$.suitUp.commands.forecolor = 'red' // ( ,  commands -  )</code> <br> : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> 2.   () <br> <code class="javascript">$.suitUp.commands.forecolor = { 'Make Red': 'red', 'Make Green': 'green' }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> 3. ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( ' ', '' ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript">$( 'textarea' ).suitUp( 'italic', 'bold', '|', 'link', 'formatblock#&lt;h1&gt;' );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> 1.  Bold. <br> 2.  . <br> 3. ,             "". <br> <br>  ,        . <br> <br> <code class="javascript">$.extend( $.suitUp.commands, { bold: null, //   ,        null fontname: { Arial: 'arial', Times: 'times', Verdana: 'verdana' }, forecolor: function( callback ){ var blackBackground = $( '&lt;div/&gt;' ).css({ background: 'black', position: 'absolute', top: 0, left:0, opacity: .5, width: '100%', height: '100%' }).on( 'click', function(){ popup.add( this ).remove(); }).appendTo('body'), popup = $( '&lt;div/&gt;' ).css({ padding: '10px 20px', width: 200, position: 'absolute', background: 'white', top: 200, left: $( window ).width()/2 - 110, zIndex: 100 }).appendTo('body'); $( '&lt;input/&gt;' ).appendTo( popup ); $( '&lt;button/&gt;' ).appendTo( popup ).text( 'Go!' ).on( 'click', function() { var val = popup.children( 'input' ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor' );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . Callback   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( 'forecolor', false, ' ' );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript">$.suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript">$.extend( jQuery.suitUp.custom, { helloWorld: function() { return $( '&lt;span/&gt;', { 'class': 'suitup-control' //    }).css( 'backgroundColor', 'red' ).on( 'click', function() { alert( 'Hello World!' ); }); } });</code> <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor', 'helloWorld' );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       "link",     ( "createlink"),      ( "unlink"). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( 'a', { className: 'suitup-control', href: '#' }).attr({ 'data-command': 'createlink' //         createlink }).on( 'click', function() { if( !$.suitUp.hasSelectedNodeParent( 'a' ) ) { document.execCommand( 'createlink', false, window.prompt( 'URL:', '' ) ); } else { document.execCommand( 'unlink', false, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor#red</code> )    : <br>  .   .  , ""  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript">$.suitUp.controls = [ 'bold', 'italic' ]; $( '.suitup-textarea' ).suitUp(); //    ,   $( '.suitup-textarea' ).suitUp( 'bold', 'italic' );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript">$.suitUp.controls.push( 'forecolor' ); $( '.suitup-textarea' ).suitUp();</code> <br>   : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( $.suitUp.controls.concat([ 'forecolor' ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   $.suitUp   .  ,            .      ,      ,  . <br> <br> <b>$.suitUp.getSelection</b> <br>   .          . <br> <br> <b>$.suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = $.suitUp.getSelection(); //  -,     $( '.suitup-editor' ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b>$.suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b>$.suitUp.hasSelectedNodeParent</b> <br>  ,      "link". ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( 'a' ); // true/false</code> <br> <br>    Chrome, Firefox, IE10 (+IE7 Mode) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/Suitup</a> <br> <br>   extended-commands.suitup.jquery.js     .    50        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b>UPD</b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> 1.          . ,  bold  Chrome     b,   IE   strong. <br> 2.          (      ). <br> 3.    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> <pre> <code class="hljs smalltalk"><code>, ,     <span class="hljs-type"><span class="hljs-type">IE</span></span>,        execCommand( <span class="hljs-string"><span class="hljs-string">'formatblock'</span></span> ... )</code>   .   :     <span class="hljs-comment"><span class="hljs-comment">" "</span></span>,       .   <span class="hljs-type"><span class="hljs-type">IE</span></span>...    ?..     <code>queryCommandValue( <span class="hljs-string"><span class="hljs-string">'formatblock'</span></span> )</code>  <code><span class="hljs-comment"><span class="hljs-comment">" 1"</span></span>, <span class="hljs-comment"><span class="hljs-comment">" 2"</span></span>, <span class="hljs-comment"><span class="hljs-comment">""</span></span></code> , .     , , , ,         .     ,    <span class="hljs-type"><span class="hljs-type">IE10</span></span>. ,  ,    <span class="hljs-type"><span class="hljs-type">IE10</span></span>!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  <span class="hljs-type"><span class="hljs-type">SuitUp</span></span> <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp();</code> <br>       : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> );</code> <br>       <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp([ <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>,      : <br> <br> <span class="hljs-number"><span class="hljs-number">1.</span></span> ,  :  forecolor    red: <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands = { forecolor: <span class="hljs-string"><span class="hljs-string">'red'</span></span> }</code> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( jQuery.suitUp.commands, { forecolor: <span class="hljs-string"><span class="hljs-string">'red'</span></span> })</code> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands.forecolor = <span class="hljs-string"><span class="hljs-string">'red'</span></span> // ( ,  commands -  )</code> <br> : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>   () <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands.forecolor = { <span class="hljs-string"><span class="hljs-string">'Make Red'</span></span>: <span class="hljs-string"><span class="hljs-string">'red'</span></span>, <span class="hljs-string"><span class="hljs-string">'Make Green'</span></span>: <span class="hljs-string"><span class="hljs-string">'green'</span></span> }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> <span class="hljs-number"><span class="hljs-number">3.</span></span> ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span> ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'link'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> <span class="hljs-number"><span class="hljs-number">1.</span></span>  <span class="hljs-type"><span class="hljs-type">Bold</span></span>. <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>  . <br> <span class="hljs-number"><span class="hljs-number">3.</span></span> ,             <span class="hljs-comment"><span class="hljs-comment">""</span></span>. <br> <br>  ,        . <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands, { bold: null, //   ,        null fontname: { <span class="hljs-type"><span class="hljs-type">Arial</span></span>: <span class="hljs-string"><span class="hljs-string">'arial'</span></span>, <span class="hljs-type"><span class="hljs-type">Times</span></span>: <span class="hljs-string"><span class="hljs-string">'times'</span></span>, <span class="hljs-type"><span class="hljs-type">Verdana</span></span>: <span class="hljs-string"><span class="hljs-string">'verdana'</span></span> }, forecolor: function( callback ){ var blackBackground = <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;div/&gt;'</span></span> ).css({ background: <span class="hljs-string"><span class="hljs-string">'black'</span></span>, position: <span class="hljs-string"><span class="hljs-string">'absolute'</span></span>, top: <span class="hljs-number"><span class="hljs-number">0</span></span>, left:<span class="hljs-number"><span class="hljs-number">0</span></span>, opacity: <span class="hljs-number"><span class="hljs-number">.5</span></span>, width: <span class="hljs-string"><span class="hljs-string">'100%'</span></span>, height: <span class="hljs-string"><span class="hljs-string">'100%'</span></span> }).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function(){ popup.add( this ).remove(); }).appendTo(<span class="hljs-string"><span class="hljs-string">'body'</span></span>), popup = <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;div/&gt;'</span></span> ).css({ padding: <span class="hljs-string"><span class="hljs-string">'10px 20px'</span></span>, width: <span class="hljs-number"><span class="hljs-number">200</span></span>, position: <span class="hljs-string"><span class="hljs-string">'absolute'</span></span>, background: <span class="hljs-string"><span class="hljs-string">'white'</span></span>, top: <span class="hljs-number"><span class="hljs-number">200</span></span>, left: <span class="hljs-string"><span class="hljs-string">$(</span></span> window ).width()/<span class="hljs-number"><span class="hljs-number">2</span></span> - <span class="hljs-number"><span class="hljs-number">110</span></span>, zIndex: <span class="hljs-number"><span class="hljs-number">100</span></span> }).appendTo(<span class="hljs-string"><span class="hljs-string">'body'</span></span>); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;input/&gt;'</span></span> ).appendTo( popup ); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;button/&gt;'</span></span> ).appendTo( popup ).text( <span class="hljs-string"><span class="hljs-string">'Go!'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { var val = popup.children( <span class="hljs-string"><span class="hljs-string">'input'</span></span> ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'fontname'</span></span>, <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . <span class="hljs-type"><span class="hljs-type">Callback</span></span>   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span> );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( jQuery.suitUp.custom, { helloWorld: function() { return <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;span/&gt;'</span></span>, { <span class="hljs-string"><span class="hljs-string">'class'</span></span>: <span class="hljs-string"><span class="hljs-string">'suitup-control'</span></span> //    }).css( <span class="hljs-string"><span class="hljs-string">'backgroundColor'</span></span>, <span class="hljs-string"><span class="hljs-string">'red'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { alert( <span class="hljs-string"><span class="hljs-string">'Hello World!'</span></span> ); }); } });</code> <br> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'fontname'</span></span>, <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>, <span class="hljs-string"><span class="hljs-string">'helloWorld'</span></span> );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       <span class="hljs-comment"><span class="hljs-comment">"link"</span></span>,     ( <span class="hljs-comment"><span class="hljs-comment">"createlink"</span></span>),      ( <span class="hljs-comment"><span class="hljs-comment">"unlink"</span></span>). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( <span class="hljs-string"><span class="hljs-string">'a'</span></span>, { className: <span class="hljs-string"><span class="hljs-string">'suitup-control'</span></span>, href: <span class="hljs-string"><span class="hljs-string">'#'</span></span> }).attr({ <span class="hljs-string"><span class="hljs-string">'data-command'</span></span>: <span class="hljs-string"><span class="hljs-string">'createlink'</span></span> //         createlink }).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { if( !<span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.hasSelectedNodeParent( <span class="hljs-string"><span class="hljs-string">'a'</span></span> ) ) { document.execCommand( <span class="hljs-string"><span class="hljs-string">'createlink'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, window.prompt( <span class="hljs-string"><span class="hljs-string">'URL:'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span> ) ); } else { document.execCommand( <span class="hljs-string"><span class="hljs-string">'unlink'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor<span class="hljs-symbol"><span class="hljs-symbol">#red</span></span></code> )    : <br>  .   .  , <span class="hljs-comment"><span class="hljs-comment">""</span></span>  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls = [ <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'italic'</span></span> ]; <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp(); //    ,   <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'italic'</span></span> );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls.push( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp();</code> <br>   : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls.concat([ <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp   .  ,            .      ,      ,  . <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelection</b> <br>   .          . <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelection(); //  -,     <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-editor'</span></span> ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.hasSelectedNodeParent</b> <br>  ,      <span class="hljs-comment"><span class="hljs-comment">"link"</span></span>. ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( <span class="hljs-string"><span class="hljs-string">'a'</span></span> ); // <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">false</span></span></code> <br> <br>    <span class="hljs-type"><span class="hljs-type">Chrome</span></span>, <span class="hljs-type"><span class="hljs-type">Firefox</span></span>, <span class="hljs-type"><span class="hljs-type">IE10</span></span> (+<span class="hljs-type"><span class="hljs-type">IE7</span></span> <span class="hljs-type"><span class="hljs-type">Mode</span></span>) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/<span class="hljs-type"><span class="hljs-type">Suitup</span></span></a> <br> <br>   extended-commands.suitup.jquery.js     .    <span class="hljs-number"><span class="hljs-number">50</span></span>        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b><span class="hljs-type"><span class="hljs-type">UPD</span></span></b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> <span class="hljs-number"><span class="hljs-number">1.</span></span>          . ,  bold  <span class="hljs-type"><span class="hljs-type">Chrome</span></span>     b,   <span class="hljs-type"><span class="hljs-type">IE</span></span>   strong. <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>          (      ). <br> <span class="hljs-number"><span class="hljs-number">3.</span></span>    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> </pre> <code><code>, ,     IE,        execCommand( 'formatblock' ... )</code>   .   :     " ",       .   IE...    ?..     <code>queryCommandValue( 'formatblock' )</code>  <code>" 1", " 2", ""</code> , .     , , , ,         .     ,    IE10. ,  ,    IE10!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  SuitUp <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript">$( '.my-textarea' ).suitUp();</code> <br>       : <br> <code class="javascript">$( '.my-textarea' ).suitUp( 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' );</code> <br>       <br> <code class="javascript">$( '.my-textarea' ).suitUp([ 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , 'forecolor',      : <br> <br> 1. ,  :  forecolor    red: <br> <code class="javascript">$.suitUp.commands = { forecolor: 'red' }</code> <br>  <br> <code class="javascript">$.extend( jQuery.suitUp.commands, { forecolor: 'red' })</code> <br>  <br> <code class="javascript">$.suitUp.commands.forecolor = 'red' // ( ,  commands -  )</code> <br> : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> 2.   () <br> <code class="javascript">$.suitUp.commands.forecolor = { 'Make Red': 'red', 'Make Green': 'green' }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> 3. ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( ' ', '' ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript">$( 'textarea' ).suitUp( 'italic', 'bold', '|', 'link', 'formatblock#&lt;h1&gt;' );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> 1.  Bold. <br> 2.  . <br> 3. ,             "". <br> <br>  ,        . <br> <br> <code class="javascript">$.extend( $.suitUp.commands, { bold: null, //   ,        null fontname: { Arial: 'arial', Times: 'times', Verdana: 'verdana' }, forecolor: function( callback ){ var blackBackground = $( '&lt;div/&gt;' ).css({ background: 'black', position: 'absolute', top: 0, left:0, opacity: .5, width: '100%', height: '100%' }).on( 'click', function(){ popup.add( this ).remove(); }).appendTo('body'), popup = $( '&lt;div/&gt;' ).css({ padding: '10px 20px', width: 200, position: 'absolute', background: 'white', top: 200, left: $( window ).width()/2 - 110, zIndex: 100 }).appendTo('body'); $( '&lt;input/&gt;' ).appendTo( popup ); $( '&lt;button/&gt;' ).appendTo( popup ).text( 'Go!' ).on( 'click', function() { var val = popup.children( 'input' ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor' );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . Callback   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( 'forecolor', false, ' ' );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript">$.suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript">$.extend( jQuery.suitUp.custom, { helloWorld: function() { return $( '&lt;span/&gt;', { 'class': 'suitup-control' //    }).css( 'backgroundColor', 'red' ).on( 'click', function() { alert( 'Hello World!' ); }); } });</code> <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor', 'helloWorld' );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       "link",     ( "createlink"),      ( "unlink"). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( 'a', { className: 'suitup-control', href: '#' }).attr({ 'data-command': 'createlink' //         createlink }).on( 'click', function() { if( !$.suitUp.hasSelectedNodeParent( 'a' ) ) { document.execCommand( 'createlink', false, window.prompt( 'URL:', '' ) ); } else { document.execCommand( 'unlink', false, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor#red</code> )    : <br>  .   .  , ""  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript">$.suitUp.controls = [ 'bold', 'italic' ]; $( '.suitup-textarea' ).suitUp(); //    ,   $( '.suitup-textarea' ).suitUp( 'bold', 'italic' );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript">$.suitUp.controls.push( 'forecolor' ); $( '.suitup-textarea' ).suitUp();</code> <br>   : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( $.suitUp.controls.concat([ 'forecolor' ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   $.suitUp   .  ,            .      ,      ,  . <br> <br> <b>$.suitUp.getSelection</b> <br>   .          . <br> <br> <b>$.suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = $.suitUp.getSelection(); //  -,     $( '.suitup-editor' ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b>$.suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b>$.suitUp.hasSelectedNodeParent</b> <br>  ,      "link". ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( 'a' ); // true/false</code> <br> <br>    Chrome, Firefox, IE10 (+IE7 Mode) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/Suitup</a> <br> <br>   extended-commands.suitup.jquery.js     .    50        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b>UPD</b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> 1.          . ,  bold  Chrome     b,   IE   strong. <br> 2.          (      ). <br> 3.    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> <pre> <code class="hljs smalltalk"><code class="javascript"><code>, ,     <span class="hljs-type"><span class="hljs-type">IE</span></span>,        execCommand( <span class="hljs-string"><span class="hljs-string">'formatblock'</span></span> ... )</code>   .   :     <span class="hljs-comment"><span class="hljs-comment">" "</span></span>,       .   <span class="hljs-type"><span class="hljs-type">IE</span></span>...    ?..     <code>queryCommandValue( <span class="hljs-string"><span class="hljs-string">'formatblock'</span></span> )</code>  <code><span class="hljs-comment"><span class="hljs-comment">" 1"</span></span>, <span class="hljs-comment"><span class="hljs-comment">" 2"</span></span>, <span class="hljs-comment"><span class="hljs-comment">""</span></span></code> , .     , , , ,         .     ,    <span class="hljs-type"><span class="hljs-type">IE10</span></span>. ,  ,    <span class="hljs-type"><span class="hljs-type">IE10</span></span>!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  <span class="hljs-type"><span class="hljs-type">SuitUp</span></span> <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp();</code> <br>       : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> );</code> <br>       <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp([ <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>,      : <br> <br> <span class="hljs-number"><span class="hljs-number">1.</span></span> ,  :  forecolor    red: <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands = { forecolor: <span class="hljs-string"><span class="hljs-string">'red'</span></span> }</code> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( jQuery.suitUp.commands, { forecolor: <span class="hljs-string"><span class="hljs-string">'red'</span></span> })</code> <br>  <br> <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands.forecolor = <span class="hljs-string"><span class="hljs-string">'red'</span></span> // ( ,  commands -  ) <br> : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>   () <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands.forecolor = { <span class="hljs-string"><span class="hljs-string">'Make Red'</span></span>: <span class="hljs-string"><span class="hljs-string">'red'</span></span>, <span class="hljs-string"><span class="hljs-string">'Make Green'</span></span>: <span class="hljs-string"><span class="hljs-string">'green'</span></span> }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> <span class="hljs-number"><span class="hljs-number">3.</span></span> ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span> ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'link'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> <span class="hljs-number"><span class="hljs-number">1.</span></span>  <span class="hljs-type"><span class="hljs-type">Bold</span></span>. <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>  . <br> <span class="hljs-number"><span class="hljs-number">3.</span></span> ,             <span class="hljs-comment"><span class="hljs-comment">""</span></span>. <br> <br>  ,        . <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands, { bold: null, //   ,        null fontname: { <span class="hljs-type"><span class="hljs-type">Arial</span></span>: <span class="hljs-string"><span class="hljs-string">'arial'</span></span>, <span class="hljs-type"><span class="hljs-type">Times</span></span>: <span class="hljs-string"><span class="hljs-string">'times'</span></span>, <span class="hljs-type"><span class="hljs-type">Verdana</span></span>: <span class="hljs-string"><span class="hljs-string">'verdana'</span></span> }, forecolor: function( callback ){ var blackBackground = <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;div/&gt;'</span></span> ).css({ background: <span class="hljs-string"><span class="hljs-string">'black'</span></span>, position: <span class="hljs-string"><span class="hljs-string">'absolute'</span></span>, top: <span class="hljs-number"><span class="hljs-number">0</span></span>, left:<span class="hljs-number"><span class="hljs-number">0</span></span>, opacity: <span class="hljs-number"><span class="hljs-number">.5</span></span>, width: <span class="hljs-string"><span class="hljs-string">'100%'</span></span>, height: <span class="hljs-string"><span class="hljs-string">'100%'</span></span> }).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function(){ popup.add( this ).remove(); }).appendTo(<span class="hljs-string"><span class="hljs-string">'body'</span></span>), popup = <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;div/&gt;'</span></span> ).css({ padding: <span class="hljs-string"><span class="hljs-string">'10px 20px'</span></span>, width: <span class="hljs-number"><span class="hljs-number">200</span></span>, position: <span class="hljs-string"><span class="hljs-string">'absolute'</span></span>, background: <span class="hljs-string"><span class="hljs-string">'white'</span></span>, top: <span class="hljs-number"><span class="hljs-number">200</span></span>, left: <span class="hljs-string"><span class="hljs-string">$(</span></span> window ).width()/<span class="hljs-number"><span class="hljs-number">2</span></span> - <span class="hljs-number"><span class="hljs-number">110</span></span>, zIndex: <span class="hljs-number"><span class="hljs-number">100</span></span> }).appendTo(<span class="hljs-string"><span class="hljs-string">'body'</span></span>); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;input/&gt;'</span></span> ).appendTo( popup ); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;button/&gt;'</span></span> ).appendTo( popup ).text( <span class="hljs-string"><span class="hljs-string">'Go!'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { var val = popup.children( <span class="hljs-string"><span class="hljs-string">'input'</span></span> ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'fontname'</span></span>, <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . <span class="hljs-type"><span class="hljs-type">Callback</span></span>   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span> );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( jQuery.suitUp.custom, { helloWorld: function() { return <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;span/&gt;'</span></span>, { <span class="hljs-string"><span class="hljs-string">'class'</span></span>: <span class="hljs-string"><span class="hljs-string">'suitup-control'</span></span> //    }).css( <span class="hljs-string"><span class="hljs-string">'backgroundColor'</span></span>, <span class="hljs-string"><span class="hljs-string">'red'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { alert( <span class="hljs-string"><span class="hljs-string">'Hello World!'</span></span> ); }); } });</code> <br> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'fontname'</span></span>, <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>, <span class="hljs-string"><span class="hljs-string">'helloWorld'</span></span> );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       <span class="hljs-comment"><span class="hljs-comment">"link"</span></span>,     ( <span class="hljs-comment"><span class="hljs-comment">"createlink"</span></span>),      ( <span class="hljs-comment"><span class="hljs-comment">"unlink"</span></span>). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( <span class="hljs-string"><span class="hljs-string">'a'</span></span>, { className: <span class="hljs-string"><span class="hljs-string">'suitup-control'</span></span>, href: <span class="hljs-string"><span class="hljs-string">'#'</span></span> }).attr({ <span class="hljs-string"><span class="hljs-string">'data-command'</span></span>: <span class="hljs-string"><span class="hljs-string">'createlink'</span></span> //         createlink }).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { if( !<span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.hasSelectedNodeParent( <span class="hljs-string"><span class="hljs-string">'a'</span></span> ) ) { document.execCommand( <span class="hljs-string"><span class="hljs-string">'createlink'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, window.prompt( <span class="hljs-string"><span class="hljs-string">'URL:'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span> ) ); } else { document.execCommand( <span class="hljs-string"><span class="hljs-string">'unlink'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor<span class="hljs-symbol"><span class="hljs-symbol">#red</span></span></code> )    : <br>  .   .  , <span class="hljs-comment"><span class="hljs-comment">""</span></span>  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls = [ <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'italic'</span></span> ]; <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp(); //    ,   <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'italic'</span></span> );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls.push( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp();</code> <br>   : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls.concat([ <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp   .  ,            .      ,      ,  . <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelection</b> <br>   .          . <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelection(); //  -,     <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-editor'</span></span> ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.hasSelectedNodeParent</b> <br>  ,      <span class="hljs-comment"><span class="hljs-comment">"link"</span></span>. ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( <span class="hljs-string"><span class="hljs-string">'a'</span></span> ); // <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">false</span></span></code> <br> <br>    <span class="hljs-type"><span class="hljs-type">Chrome</span></span>, <span class="hljs-type"><span class="hljs-type">Firefox</span></span>, <span class="hljs-type"><span class="hljs-type">IE10</span></span> (+<span class="hljs-type"><span class="hljs-type">IE7</span></span> <span class="hljs-type"><span class="hljs-type">Mode</span></span>) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/<span class="hljs-type"><span class="hljs-type">Suitup</span></span></a> <br> <br>   extended-commands.suitup.jquery.js     .    <span class="hljs-number"><span class="hljs-number">50</span></span>        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b><span class="hljs-type"><span class="hljs-type">UPD</span></span></b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> <span class="hljs-number"><span class="hljs-number">1.</span></span>          . ,  bold  <span class="hljs-type"><span class="hljs-type">Chrome</span></span>     b,   <span class="hljs-type"><span class="hljs-type">IE</span></span>   strong. <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>          (      ). <br> <span class="hljs-number"><span class="hljs-number">3.</span></span>    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code></code> </pre> <code><code>, ,     IE,        execCommand( 'formatblock' ... )</code>   .   :     " ",       .   IE...    ?..     <code>queryCommandValue( 'formatblock' )</code>  <code>" 1", " 2", ""</code> , .     , , , ,         .     ,    IE10. ,  ,    IE10!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  SuitUp <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript">$( '.my-textarea' ).suitUp();</code> <br>       : <br> <code class="javascript">$( '.my-textarea' ).suitUp( 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' );</code> <br>       <br> <code class="javascript">$( '.my-textarea' ).suitUp([ 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , 'forecolor',      : <br> <br> 1. ,  :  forecolor    red: <br> <code class="javascript">$.suitUp.commands = { forecolor: 'red' }</code> <br>  <br> <code class="javascript">$.extend( jQuery.suitUp.commands, { forecolor: 'red' })</code> <br>  <br> <code class="javascript">$.suitUp.commands.forecolor = 'red' // ( ,  commands -  )</code> <br> : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> 2.   () <br> <code class="javascript">$.suitUp.commands.forecolor = { 'Make Red': 'red', 'Make Green': 'green' }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> 3. ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( ' ', '' ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript">$( 'textarea' ).suitUp( 'italic', 'bold', '|', 'link', 'formatblock#&lt;h1&gt;' );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> 1.  Bold. <br> 2.  . <br> 3. ,             "". <br> <br>  ,        . <br> <br> <code class="javascript">$.extend( $.suitUp.commands, { bold: null, //   ,        null fontname: { Arial: 'arial', Times: 'times', Verdana: 'verdana' }, forecolor: function( callback ){ var blackBackground = $( '&lt;div/&gt;' ).css({ background: 'black', position: 'absolute', top: 0, left:0, opacity: .5, width: '100%', height: '100%' }).on( 'click', function(){ popup.add( this ).remove(); }).appendTo('body'), popup = $( '&lt;div/&gt;' ).css({ padding: '10px 20px', width: 200, position: 'absolute', background: 'white', top: 200, left: $( window ).width()/2 - 110, zIndex: 100 }).appendTo('body'); $( '&lt;input/&gt;' ).appendTo( popup ); $( '&lt;button/&gt;' ).appendTo( popup ).text( 'Go!' ).on( 'click', function() { var val = popup.children( 'input' ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor' );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . Callback   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( 'forecolor', false, ' ' );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript">$.suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript">$.extend( jQuery.suitUp.custom, { helloWorld: function() { return $( '&lt;span/&gt;', { 'class': 'suitup-control' //    }).css( 'backgroundColor', 'red' ).on( 'click', function() { alert( 'Hello World!' ); }); } });</code> <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor', 'helloWorld' );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       "link",     ( "createlink"),      ( "unlink"). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( 'a', { className: 'suitup-control', href: '#' }).attr({ 'data-command': 'createlink' //         createlink }).on( 'click', function() { if( !$.suitUp.hasSelectedNodeParent( 'a' ) ) { document.execCommand( 'createlink', false, window.prompt( 'URL:', '' ) ); } else { document.execCommand( 'unlink', false, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor#red</code> )    : <br>  .   .  , ""  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript">$.suitUp.controls = [ 'bold', 'italic' ]; $( '.suitup-textarea' ).suitUp(); //    ,   $( '.suitup-textarea' ).suitUp( 'bold', 'italic' );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript">$.suitUp.controls.push( 'forecolor' ); $( '.suitup-textarea' ).suitUp();</code> <br>   : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( $.suitUp.controls.concat([ 'forecolor' ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   $.suitUp   .  ,            .      ,      ,  . <br> <br> <b>$.suitUp.getSelection</b> <br>   .          . <br> <br> <b>$.suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = $.suitUp.getSelection(); //  -,     $( '.suitup-editor' ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b>$.suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b>$.suitUp.hasSelectedNodeParent</b> <br>  ,      "link". ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( 'a' ); // true/false</code> <br> <br>    Chrome, Firefox, IE10 (+IE7 Mode) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/Suitup</a> <br> <br>   extended-commands.suitup.jquery.js     .    50        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b>UPD</b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> 1.          . ,  bold  Chrome     b,   IE   strong. <br> 2.          (      ). <br> 3.    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> <pre> <code class="hljs smalltalk"><code class="javascript"><code>, ,     <span class="hljs-type"><span class="hljs-type">IE</span></span>,        execCommand( <span class="hljs-string"><span class="hljs-string">'formatblock'</span></span> ... )</code>   .   :     <span class="hljs-comment"><span class="hljs-comment">" "</span></span>,       .   <span class="hljs-type"><span class="hljs-type">IE</span></span>...    ?..     <code>queryCommandValue( <span class="hljs-string"><span class="hljs-string">'formatblock'</span></span> )</code>  <code><span class="hljs-comment"><span class="hljs-comment">" 1"</span></span>, <span class="hljs-comment"><span class="hljs-comment">" 2"</span></span>, <span class="hljs-comment"><span class="hljs-comment">""</span></span></code> , .     , , , ,         .     ,    <span class="hljs-type"><span class="hljs-type">IE10</span></span>. ,  ,    <span class="hljs-type"><span class="hljs-type">IE10</span></span>!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  <span class="hljs-type"><span class="hljs-type">SuitUp</span></span> <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp();</code> <br>       : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> );</code> <br>       <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp([ <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>,      : <br> <br> <span class="hljs-number"><span class="hljs-number">1.</span></span> ,  :  forecolor    red: <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands = { forecolor: <span class="hljs-string"><span class="hljs-string">'red'</span></span> }</code> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( jQuery.suitUp.commands, { forecolor: <span class="hljs-string"><span class="hljs-string">'red'</span></span> })</code> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands.forecolor = <span class="hljs-string"><span class="hljs-string">'red'</span></span> // ( ,  commands -  )</code> <br> : <br> <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ); <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>   () <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands.forecolor = { <span class="hljs-string"><span class="hljs-string">'Make Red'</span></span>: <span class="hljs-string"><span class="hljs-string">'red'</span></span>, <span class="hljs-string"><span class="hljs-string">'Make Green'</span></span>: <span class="hljs-string"><span class="hljs-string">'green'</span></span> }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> <span class="hljs-number"><span class="hljs-number">3.</span></span> ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span> ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'link'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> <span class="hljs-number"><span class="hljs-number">1.</span></span>  <span class="hljs-type"><span class="hljs-type">Bold</span></span>. <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>  . <br> <span class="hljs-number"><span class="hljs-number">3.</span></span> ,             <span class="hljs-comment"><span class="hljs-comment">""</span></span>. <br> <br>  ,        . <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands, { bold: null, //   ,        null fontname: { <span class="hljs-type"><span class="hljs-type">Arial</span></span>: <span class="hljs-string"><span class="hljs-string">'arial'</span></span>, <span class="hljs-type"><span class="hljs-type">Times</span></span>: <span class="hljs-string"><span class="hljs-string">'times'</span></span>, <span class="hljs-type"><span class="hljs-type">Verdana</span></span>: <span class="hljs-string"><span class="hljs-string">'verdana'</span></span> }, forecolor: function( callback ){ var blackBackground = <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;div/&gt;'</span></span> ).css({ background: <span class="hljs-string"><span class="hljs-string">'black'</span></span>, position: <span class="hljs-string"><span class="hljs-string">'absolute'</span></span>, top: <span class="hljs-number"><span class="hljs-number">0</span></span>, left:<span class="hljs-number"><span class="hljs-number">0</span></span>, opacity: <span class="hljs-number"><span class="hljs-number">.5</span></span>, width: <span class="hljs-string"><span class="hljs-string">'100%'</span></span>, height: <span class="hljs-string"><span class="hljs-string">'100%'</span></span> }).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function(){ popup.add( this ).remove(); }).appendTo(<span class="hljs-string"><span class="hljs-string">'body'</span></span>), popup = <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;div/&gt;'</span></span> ).css({ padding: <span class="hljs-string"><span class="hljs-string">'10px 20px'</span></span>, width: <span class="hljs-number"><span class="hljs-number">200</span></span>, position: <span class="hljs-string"><span class="hljs-string">'absolute'</span></span>, background: <span class="hljs-string"><span class="hljs-string">'white'</span></span>, top: <span class="hljs-number"><span class="hljs-number">200</span></span>, left: <span class="hljs-string"><span class="hljs-string">$(</span></span> window ).width()/<span class="hljs-number"><span class="hljs-number">2</span></span> - <span class="hljs-number"><span class="hljs-number">110</span></span>, zIndex: <span class="hljs-number"><span class="hljs-number">100</span></span> }).appendTo(<span class="hljs-string"><span class="hljs-string">'body'</span></span>); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;input/&gt;'</span></span> ).appendTo( popup ); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;button/&gt;'</span></span> ).appendTo( popup ).text( <span class="hljs-string"><span class="hljs-string">'Go!'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { var val = popup.children( <span class="hljs-string"><span class="hljs-string">'input'</span></span> ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'fontname'</span></span>, <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . <span class="hljs-type"><span class="hljs-type">Callback</span></span>   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span> );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( jQuery.suitUp.custom, { helloWorld: function() { return <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;span/&gt;'</span></span>, { <span class="hljs-string"><span class="hljs-string">'class'</span></span>: <span class="hljs-string"><span class="hljs-string">'suitup-control'</span></span> //    }).css( <span class="hljs-string"><span class="hljs-string">'backgroundColor'</span></span>, <span class="hljs-string"><span class="hljs-string">'red'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { alert( <span class="hljs-string"><span class="hljs-string">'Hello World!'</span></span> ); }); } });</code> <br> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'fontname'</span></span>, <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>, <span class="hljs-string"><span class="hljs-string">'helloWorld'</span></span> );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       <span class="hljs-comment"><span class="hljs-comment">"link"</span></span>,     ( <span class="hljs-comment"><span class="hljs-comment">"createlink"</span></span>),      ( <span class="hljs-comment"><span class="hljs-comment">"unlink"</span></span>). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( <span class="hljs-string"><span class="hljs-string">'a'</span></span>, { className: <span class="hljs-string"><span class="hljs-string">'suitup-control'</span></span>, href: <span class="hljs-string"><span class="hljs-string">'#'</span></span> }).attr({ <span class="hljs-string"><span class="hljs-string">'data-command'</span></span>: <span class="hljs-string"><span class="hljs-string">'createlink'</span></span> //         createlink }).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { if( !<span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.hasSelectedNodeParent( <span class="hljs-string"><span class="hljs-string">'a'</span></span> ) ) { document.execCommand( <span class="hljs-string"><span class="hljs-string">'createlink'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, window.prompt( <span class="hljs-string"><span class="hljs-string">'URL:'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span> ) ); } else { document.execCommand( <span class="hljs-string"><span class="hljs-string">'unlink'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor<span class="hljs-symbol"><span class="hljs-symbol">#red</span></span></code> )    : <br>  .   .  , <span class="hljs-comment"><span class="hljs-comment">""</span></span>  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls = [ <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'italic'</span></span> ]; <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp(); //    ,   <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'italic'</span></span> );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls.push( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp();</code> <br>   : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls.concat([ <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp   .  ,            .      ,      ,  . <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelection</b> <br>   .          . <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelection(); //  -,     <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-editor'</span></span> ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.hasSelectedNodeParent</b> <br>  ,      <span class="hljs-comment"><span class="hljs-comment">"link"</span></span>. ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( <span class="hljs-string"><span class="hljs-string">'a'</span></span> ); // <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">false</span></span></code> <br> <br>    <span class="hljs-type"><span class="hljs-type">Chrome</span></span>, <span class="hljs-type"><span class="hljs-type">Firefox</span></span>, <span class="hljs-type"><span class="hljs-type">IE10</span></span> (+<span class="hljs-type"><span class="hljs-type">IE7</span></span> <span class="hljs-type"><span class="hljs-type">Mode</span></span>) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/<span class="hljs-type"><span class="hljs-type">Suitup</span></span></a> <br> <br>   extended-commands.suitup.jquery.js     .    <span class="hljs-number"><span class="hljs-number">50</span></span>        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b><span class="hljs-type"><span class="hljs-type">UPD</span></span></b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> <span class="hljs-number"><span class="hljs-number">1.</span></span>          . ,  bold  <span class="hljs-type"><span class="hljs-type">Chrome</span></span>     b,   <span class="hljs-type"><span class="hljs-type">IE</span></span>   strong. <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>          (      ). <br> <span class="hljs-number"><span class="hljs-number">3.</span></span>    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code></code> </pre> <code><code>, ,     IE,        execCommand( 'formatblock' ... )</code>   .   :     " ",       .   IE...    ?..     <code>queryCommandValue( 'formatblock' )</code>  <code>" 1", " 2", ""</code> , .     , , , ,         .     ,    IE10. ,  ,    IE10!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  SuitUp <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript">$( '.my-textarea' ).suitUp();</code> <br>       : <br> <code class="javascript">$( '.my-textarea' ).suitUp( 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' );</code> <br>       <br> <code class="javascript">$( '.my-textarea' ).suitUp([ 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , 'forecolor',      : <br> <br> 1. ,  :  forecolor    red: <br> <code class="javascript">$.suitUp.commands = { forecolor: 'red' }</code> <br>  <br> <code class="javascript">$.extend( jQuery.suitUp.commands, { forecolor: 'red' })</code> <br>  <br> <code class="javascript">$.suitUp.commands.forecolor = 'red' // ( ,  commands -  )</code> <br> : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> 2.   () <br> <code class="javascript">$.suitUp.commands.forecolor = { 'Make Red': 'red', 'Make Green': 'green' }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> 3. ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( ' ', '' ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript">$( 'textarea' ).suitUp( 'italic', 'bold', '|', 'link', 'formatblock#&lt;h1&gt;' );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> 1.  Bold. <br> 2.  . <br> 3. ,             "". <br> <br>  ,        . <br> <br> <code class="javascript">$.extend( $.suitUp.commands, { bold: null, //   ,        null fontname: { Arial: 'arial', Times: 'times', Verdana: 'verdana' }, forecolor: function( callback ){ var blackBackground = $( '&lt;div/&gt;' ).css({ background: 'black', position: 'absolute', top: 0, left:0, opacity: .5, width: '100%', height: '100%' }).on( 'click', function(){ popup.add( this ).remove(); }).appendTo('body'), popup = $( '&lt;div/&gt;' ).css({ padding: '10px 20px', width: 200, position: 'absolute', background: 'white', top: 200, left: $( window ).width()/2 - 110, zIndex: 100 }).appendTo('body'); $( '&lt;input/&gt;' ).appendTo( popup ); $( '&lt;button/&gt;' ).appendTo( popup ).text( 'Go!' ).on( 'click', function() { var val = popup.children( 'input' ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor' );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . Callback   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( 'forecolor', false, ' ' );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript">$.suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript">$.extend( jQuery.suitUp.custom, { helloWorld: function() { return $( '&lt;span/&gt;', { 'class': 'suitup-control' //    }).css( 'backgroundColor', 'red' ).on( 'click', function() { alert( 'Hello World!' ); }); } });</code> <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor', 'helloWorld' );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       "link",     ( "createlink"),      ( "unlink"). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( 'a', { className: 'suitup-control', href: '#' }).attr({ 'data-command': 'createlink' //         createlink }).on( 'click', function() { if( !$.suitUp.hasSelectedNodeParent( 'a' ) ) { document.execCommand( 'createlink', false, window.prompt( 'URL:', '' ) ); } else { document.execCommand( 'unlink', false, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor#red</code> )    : <br>  .   .  , ""  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript">$.suitUp.controls = [ 'bold', 'italic' ]; $( '.suitup-textarea' ).suitUp(); //    ,   $( '.suitup-textarea' ).suitUp( 'bold', 'italic' );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript">$.suitUp.controls.push( 'forecolor' ); $( '.suitup-textarea' ).suitUp();</code> <br>   : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( $.suitUp.controls.concat([ 'forecolor' ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   $.suitUp   .  ,            .      ,      ,  . <br> <br> <b>$.suitUp.getSelection</b> <br>   .          . <br> <br> <b>$.suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = $.suitUp.getSelection(); //  -,     $( '.suitup-editor' ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b>$.suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b>$.suitUp.hasSelectedNodeParent</b> <br>  ,      "link". ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( 'a' ); // true/false</code> <br> <br>    Chrome, Firefox, IE10 (+IE7 Mode) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/Suitup</a> <br> <br>   extended-commands.suitup.jquery.js     .    50        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b>UPD</b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> 1.          . ,  bold  Chrome     b,   IE   strong. <br> 2.          (      ). <br> 3.    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> <pre> <code class="hljs smalltalk"><code>, ,     <span class="hljs-type"><span class="hljs-type">IE</span></span>,        execCommand( <span class="hljs-string"><span class="hljs-string">'formatblock'</span></span> ... )</code>   .   :     <span class="hljs-comment"><span class="hljs-comment">" "</span></span>,       .   <span class="hljs-type"><span class="hljs-type">IE</span></span>...    ?..     <code>queryCommandValue( <span class="hljs-string"><span class="hljs-string">'formatblock'</span></span> )</code>  <code><span class="hljs-comment"><span class="hljs-comment">" 1"</span></span>, <span class="hljs-comment"><span class="hljs-comment">" 2"</span></span>, <span class="hljs-comment"><span class="hljs-comment">""</span></span></code> , .     , , , ,         .     ,    <span class="hljs-type"><span class="hljs-type">IE10</span></span>. ,  ,    <span class="hljs-type"><span class="hljs-type">IE10</span></span>!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  <span class="hljs-type"><span class="hljs-type">SuitUp</span></span> <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp();</code> <br>       : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> );</code> <br>       <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp([ <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>,      : <br> <br> <span class="hljs-number"><span class="hljs-number">1.</span></span> ,  :  forecolor    red: <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands = { forecolor: <span class="hljs-string"><span class="hljs-string">'red'</span></span> }</code> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( jQuery.suitUp.commands, { forecolor: <span class="hljs-string"><span class="hljs-string">'red'</span></span> })</code> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands.forecolor = <span class="hljs-string"><span class="hljs-string">'red'</span></span> // ( ,  commands -  )</code> <br> : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>   () <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands.forecolor = { <span class="hljs-string"><span class="hljs-string">'Make Red'</span></span>: <span class="hljs-string"><span class="hljs-string">'red'</span></span>, <span class="hljs-string"><span class="hljs-string">'Make Green'</span></span>: <span class="hljs-string"><span class="hljs-string">'green'</span></span> }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> <span class="hljs-number"><span class="hljs-number">3.</span></span> ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span> ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'link'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> <span class="hljs-number"><span class="hljs-number">1.</span></span>  <span class="hljs-type"><span class="hljs-type">Bold</span></span>. <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>  . <br> <span class="hljs-number"><span class="hljs-number">3.</span></span> ,             <span class="hljs-comment"><span class="hljs-comment">""</span></span>. <br> <br>  ,        . <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands, { bold: null, //   ,        null fontname: { <span class="hljs-type"><span class="hljs-type">Arial</span></span>: <span class="hljs-string"><span class="hljs-string">'arial'</span></span>, <span class="hljs-type"><span class="hljs-type">Times</span></span>: <span class="hljs-string"><span class="hljs-string">'times'</span></span>, <span class="hljs-type"><span class="hljs-type">Verdana</span></span>: <span class="hljs-string"><span class="hljs-string">'verdana'</span></span> }, forecolor: function( callback ){ var blackBackground = <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;div/&gt;'</span></span> ).css({ background: <span class="hljs-string"><span class="hljs-string">'black'</span></span>, position: <span class="hljs-string"><span class="hljs-string">'absolute'</span></span>, top: <span class="hljs-number"><span class="hljs-number">0</span></span>, left:<span class="hljs-number"><span class="hljs-number">0</span></span>, opacity: <span class="hljs-number"><span class="hljs-number">.5</span></span>, width: <span class="hljs-string"><span class="hljs-string">'100%'</span></span>, height: <span class="hljs-string"><span class="hljs-string">'100%'</span></span> }).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function(){ popup.add( this ).remove(); }).appendTo(<span class="hljs-string"><span class="hljs-string">'body'</span></span>), popup = <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;div/&gt;'</span></span> ).css({ padding: <span class="hljs-string"><span class="hljs-string">'10px 20px'</span></span>, width: <span class="hljs-number"><span class="hljs-number">200</span></span>, position: <span class="hljs-string"><span class="hljs-string">'absolute'</span></span>, background: <span class="hljs-string"><span class="hljs-string">'white'</span></span>, top: <span class="hljs-number"><span class="hljs-number">200</span></span>, left: <span class="hljs-string"><span class="hljs-string">$(</span></span> window ).width()/<span class="hljs-number"><span class="hljs-number">2</span></span> - <span class="hljs-number"><span class="hljs-number">110</span></span>, zIndex: <span class="hljs-number"><span class="hljs-number">100</span></span> }).appendTo(<span class="hljs-string"><span class="hljs-string">'body'</span></span>); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;input/&gt;'</span></span> ).appendTo( popup ); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;button/&gt;'</span></span> ).appendTo( popup ).text( <span class="hljs-string"><span class="hljs-string">'Go!'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { var val = popup.children( <span class="hljs-string"><span class="hljs-string">'input'</span></span> ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'fontname'</span></span>, <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . <span class="hljs-type"><span class="hljs-type">Callback</span></span>   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span> );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( jQuery.suitUp.custom, { helloWorld: function() { return <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;span/&gt;'</span></span>, { <span class="hljs-string"><span class="hljs-string">'class'</span></span>: <span class="hljs-string"><span class="hljs-string">'suitup-control'</span></span> //    }).css( <span class="hljs-string"><span class="hljs-string">'backgroundColor'</span></span>, <span class="hljs-string"><span class="hljs-string">'red'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { alert( <span class="hljs-string"><span class="hljs-string">'Hello World!'</span></span> ); }); } });</code> <br> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'fontname'</span></span>, <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>, <span class="hljs-string"><span class="hljs-string">'helloWorld'</span></span> );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       <span class="hljs-comment"><span class="hljs-comment">"link"</span></span>,     ( <span class="hljs-comment"><span class="hljs-comment">"createlink"</span></span>),      ( <span class="hljs-comment"><span class="hljs-comment">"unlink"</span></span>). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( <span class="hljs-string"><span class="hljs-string">'a'</span></span>, { className: <span class="hljs-string"><span class="hljs-string">'suitup-control'</span></span>, href: <span class="hljs-string"><span class="hljs-string">'#'</span></span> }).attr({ <span class="hljs-string"><span class="hljs-string">'data-command'</span></span>: <span class="hljs-string"><span class="hljs-string">'createlink'</span></span> //         createlink }).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { if( !<span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.hasSelectedNodeParent( <span class="hljs-string"><span class="hljs-string">'a'</span></span> ) ) { document.execCommand( <span class="hljs-string"><span class="hljs-string">'createlink'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, window.prompt( <span class="hljs-string"><span class="hljs-string">'URL:'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span> ) ); } else { document.execCommand( <span class="hljs-string"><span class="hljs-string">'unlink'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor<span class="hljs-symbol"><span class="hljs-symbol">#red</span></span></code> )    : <br>  .   .  , <span class="hljs-comment"><span class="hljs-comment">""</span></span>  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls = [ <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'italic'</span></span> ]; <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp(); //    ,   <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'italic'</span></span> );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls.push( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp();</code> <br>   : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls.concat([ <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp   .  ,            .      ,      ,  . <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelection</b> <br>   .          . <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelection(); //  -,     <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-editor'</span></span> ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.hasSelectedNodeParent</b> <br>  ,      <span class="hljs-comment"><span class="hljs-comment">"link"</span></span>. ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( <span class="hljs-string"><span class="hljs-string">'a'</span></span> ); // <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">false</span></span></code> <br> <br>    <span class="hljs-type"><span class="hljs-type">Chrome</span></span>, <span class="hljs-type"><span class="hljs-type">Firefox</span></span>, <span class="hljs-type"><span class="hljs-type">IE10</span></span> (+<span class="hljs-type"><span class="hljs-type">IE7</span></span> <span class="hljs-type"><span class="hljs-type">Mode</span></span>) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/<span class="hljs-type"><span class="hljs-type">Suitup</span></span></a> <br> <br>   extended-commands.suitup.jquery.js     .    <span class="hljs-number"><span class="hljs-number">50</span></span>        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b><span class="hljs-type"><span class="hljs-type">UPD</span></span></b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> <span class="hljs-number"><span class="hljs-number">1.</span></span>          . ,  bold  <span class="hljs-type"><span class="hljs-type">Chrome</span></span>     b,   <span class="hljs-type"><span class="hljs-type">IE</span></span>   strong. <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>          (      ). <br> <span class="hljs-number"><span class="hljs-number">3.</span></span>    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> </pre> <code><code>, ,     IE,        execCommand( 'formatblock' ... )</code>   .   :     " ",       .   IE...    ?..     <code>queryCommandValue( 'formatblock' )</code>  <code>" 1", " 2", ""</code> , .     , , , ,         .     ,    IE10. ,  ,    IE10!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  SuitUp <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript">$( '.my-textarea' ).suitUp();</code> <br>       : <br> <code class="javascript">$( '.my-textarea' ).suitUp( 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' );</code> <br>       <br> <code class="javascript">$( '.my-textarea' ).suitUp([ 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , 'forecolor',      : <br> <br> 1. ,  :  forecolor    red: <br> <code class="javascript">$.suitUp.commands = { forecolor: 'red' }</code> <br>  <br> <code class="javascript">$.extend( jQuery.suitUp.commands, { forecolor: 'red' })</code> <br>  <br> <code class="javascript">$.suitUp.commands.forecolor = 'red' // ( ,  commands -  )</code> <br> : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> 2.   () <br> <code class="javascript">$.suitUp.commands.forecolor = { 'Make Red': 'red', 'Make Green': 'green' }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> 3. ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( ' ', '' ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript">$( 'textarea' ).suitUp( 'italic', 'bold', '|', 'link', 'formatblock#&lt;h1&gt;' );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> 1.  Bold. <br> 2.  . <br> 3. ,             "". <br> <br>  ,        . <br> <br> <code class="javascript">$.extend( $.suitUp.commands, { bold: null, //   ,        null fontname: { Arial: 'arial', Times: 'times', Verdana: 'verdana' }, forecolor: function( callback ){ var blackBackground = $( '&lt;div/&gt;' ).css({ background: 'black', position: 'absolute', top: 0, left:0, opacity: .5, width: '100%', height: '100%' }).on( 'click', function(){ popup.add( this ).remove(); }).appendTo('body'), popup = $( '&lt;div/&gt;' ).css({ padding: '10px 20px', width: 200, position: 'absolute', background: 'white', top: 200, left: $( window ).width()/2 - 110, zIndex: 100 }).appendTo('body'); $( '&lt;input/&gt;' ).appendTo( popup ); $( '&lt;button/&gt;' ).appendTo( popup ).text( 'Go!' ).on( 'click', function() { var val = popup.children( 'input' ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor' );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . Callback   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( 'forecolor', false, ' ' );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript">$.suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript">$.extend( jQuery.suitUp.custom, { helloWorld: function() { return $( '&lt;span/&gt;', { 'class': 'suitup-control' //    }).css( 'backgroundColor', 'red' ).on( 'click', function() { alert( 'Hello World!' ); }); } });</code> <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor', 'helloWorld' );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       "link",     ( "createlink"),      ( "unlink"). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( 'a', { className: 'suitup-control', href: '#' }).attr({ 'data-command': 'createlink' //         createlink }).on( 'click', function() { if( !$.suitUp.hasSelectedNodeParent( 'a' ) ) { document.execCommand( 'createlink', false, window.prompt( 'URL:', '' ) ); } else { document.execCommand( 'unlink', false, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor#red</code> )    : <br>  .   .  , ""  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript">$.suitUp.controls = [ 'bold', 'italic' ]; $( '.suitup-textarea' ).suitUp(); //    ,   $( '.suitup-textarea' ).suitUp( 'bold', 'italic' );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript">$.suitUp.controls.push( 'forecolor' ); $( '.suitup-textarea' ).suitUp();</code> <br>   : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( $.suitUp.controls.concat([ 'forecolor' ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   $.suitUp   .  ,            .      ,      ,  . <br> <br> <b>$.suitUp.getSelection</b> <br>   .          . <br> <br> <b>$.suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = $.suitUp.getSelection(); //  -,     $( '.suitup-editor' ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b>$.suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b>$.suitUp.hasSelectedNodeParent</b> <br>  ,      "link". ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( 'a' ); // true/false</code> <br> <br>    Chrome, Firefox, IE10 (+IE7 Mode) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/Suitup</a> <br> <br>   extended-commands.suitup.jquery.js     .    50        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b>UPD</b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> 1.          . ,  bold  Chrome     b,   IE   strong. <br> 2.          (      ). <br> 3.    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> <pre> <code class="hljs smalltalk"><code class="javascript"><code>, ,     <span class="hljs-type"><span class="hljs-type">IE</span></span>,        execCommand( <span class="hljs-string"><span class="hljs-string">'formatblock'</span></span> ... )</code>   .   :     <span class="hljs-comment"><span class="hljs-comment">" "</span></span>,       .   <span class="hljs-type"><span class="hljs-type">IE</span></span>...    ?..     <code>queryCommandValue( <span class="hljs-string"><span class="hljs-string">'formatblock'</span></span> )</code>  <code><span class="hljs-comment"><span class="hljs-comment">" 1"</span></span>, <span class="hljs-comment"><span class="hljs-comment">" 2"</span></span>, <span class="hljs-comment"><span class="hljs-comment">""</span></span></code> , .     , , , ,         .     ,    <span class="hljs-type"><span class="hljs-type">IE10</span></span>. ,  ,    <span class="hljs-type"><span class="hljs-type">IE10</span></span>!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  <span class="hljs-type"><span class="hljs-type">SuitUp</span></span> <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp();</code> <br>       : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> );</code> <br>       <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp([ <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>,      : <br> <br> <span class="hljs-number"><span class="hljs-number">1.</span></span> ,  :  forecolor    red: <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands = { forecolor: <span class="hljs-string"><span class="hljs-string">'red'</span></span> }</code> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( jQuery.suitUp.commands, { forecolor: <span class="hljs-string"><span class="hljs-string">'red'</span></span> })</code> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands.forecolor = <span class="hljs-string"><span class="hljs-string">'red'</span></span> // ( ,  commands -  )</code> <br> : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>   () <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands.forecolor = { <span class="hljs-string"><span class="hljs-string">'Make Red'</span></span>: <span class="hljs-string"><span class="hljs-string">'red'</span></span>, <span class="hljs-string"><span class="hljs-string">'Make Green'</span></span>: <span class="hljs-string"><span class="hljs-string">'green'</span></span> }</code> <br>      select,      ,      . <br> <br>  : <br> <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ); <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> <span class="hljs-number"><span class="hljs-number">3.</span></span> ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span> ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'link'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> <span class="hljs-number"><span class="hljs-number">1.</span></span>  <span class="hljs-type"><span class="hljs-type">Bold</span></span>. <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>  . <br> <span class="hljs-number"><span class="hljs-number">3.</span></span> ,             <span class="hljs-comment"><span class="hljs-comment">""</span></span>. <br> <br>  ,        . <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands, { bold: null, //   ,        null fontname: { <span class="hljs-type"><span class="hljs-type">Arial</span></span>: <span class="hljs-string"><span class="hljs-string">'arial'</span></span>, <span class="hljs-type"><span class="hljs-type">Times</span></span>: <span class="hljs-string"><span class="hljs-string">'times'</span></span>, <span class="hljs-type"><span class="hljs-type">Verdana</span></span>: <span class="hljs-string"><span class="hljs-string">'verdana'</span></span> }, forecolor: function( callback ){ var blackBackground = <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;div/&gt;'</span></span> ).css({ background: <span class="hljs-string"><span class="hljs-string">'black'</span></span>, position: <span class="hljs-string"><span class="hljs-string">'absolute'</span></span>, top: <span class="hljs-number"><span class="hljs-number">0</span></span>, left:<span class="hljs-number"><span class="hljs-number">0</span></span>, opacity: <span class="hljs-number"><span class="hljs-number">.5</span></span>, width: <span class="hljs-string"><span class="hljs-string">'100%'</span></span>, height: <span class="hljs-string"><span class="hljs-string">'100%'</span></span> }).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function(){ popup.add( this ).remove(); }).appendTo(<span class="hljs-string"><span class="hljs-string">'body'</span></span>), popup = <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;div/&gt;'</span></span> ).css({ padding: <span class="hljs-string"><span class="hljs-string">'10px 20px'</span></span>, width: <span class="hljs-number"><span class="hljs-number">200</span></span>, position: <span class="hljs-string"><span class="hljs-string">'absolute'</span></span>, background: <span class="hljs-string"><span class="hljs-string">'white'</span></span>, top: <span class="hljs-number"><span class="hljs-number">200</span></span>, left: <span class="hljs-string"><span class="hljs-string">$(</span></span> window ).width()/<span class="hljs-number"><span class="hljs-number">2</span></span> - <span class="hljs-number"><span class="hljs-number">110</span></span>, zIndex: <span class="hljs-number"><span class="hljs-number">100</span></span> }).appendTo(<span class="hljs-string"><span class="hljs-string">'body'</span></span>); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;input/&gt;'</span></span> ).appendTo( popup ); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;button/&gt;'</span></span> ).appendTo( popup ).text( <span class="hljs-string"><span class="hljs-string">'Go!'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { var val = popup.children( <span class="hljs-string"><span class="hljs-string">'input'</span></span> ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'fontname'</span></span>, <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . <span class="hljs-type"><span class="hljs-type">Callback</span></span>   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span> );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( jQuery.suitUp.custom, { helloWorld: function() { return <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;span/&gt;'</span></span>, { <span class="hljs-string"><span class="hljs-string">'class'</span></span>: <span class="hljs-string"><span class="hljs-string">'suitup-control'</span></span> //    }).css( <span class="hljs-string"><span class="hljs-string">'backgroundColor'</span></span>, <span class="hljs-string"><span class="hljs-string">'red'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { alert( <span class="hljs-string"><span class="hljs-string">'Hello World!'</span></span> ); }); } });</code> <br> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'fontname'</span></span>, <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>, <span class="hljs-string"><span class="hljs-string">'helloWorld'</span></span> );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       <span class="hljs-comment"><span class="hljs-comment">"link"</span></span>,     ( <span class="hljs-comment"><span class="hljs-comment">"createlink"</span></span>),      ( <span class="hljs-comment"><span class="hljs-comment">"unlink"</span></span>). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( <span class="hljs-string"><span class="hljs-string">'a'</span></span>, { className: <span class="hljs-string"><span class="hljs-string">'suitup-control'</span></span>, href: <span class="hljs-string"><span class="hljs-string">'#'</span></span> }).attr({ <span class="hljs-string"><span class="hljs-string">'data-command'</span></span>: <span class="hljs-string"><span class="hljs-string">'createlink'</span></span> //         createlink }).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { if( !<span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.hasSelectedNodeParent( <span class="hljs-string"><span class="hljs-string">'a'</span></span> ) ) { document.execCommand( <span class="hljs-string"><span class="hljs-string">'createlink'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, window.prompt( <span class="hljs-string"><span class="hljs-string">'URL:'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span> ) ); } else { document.execCommand( <span class="hljs-string"><span class="hljs-string">'unlink'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor<span class="hljs-symbol"><span class="hljs-symbol">#red</span></span></code> )    : <br>  .   .  , <span class="hljs-comment"><span class="hljs-comment">""</span></span>  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls = [ <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'italic'</span></span> ]; <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp(); //    ,   <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'italic'</span></span> );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls.push( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp();</code> <br>   : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls.concat([ <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp   .  ,            .      ,      ,  . <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelection</b> <br>   .          . <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelection(); //  -,     <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-editor'</span></span> ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.hasSelectedNodeParent</b> <br>  ,      <span class="hljs-comment"><span class="hljs-comment">"link"</span></span>. ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( <span class="hljs-string"><span class="hljs-string">'a'</span></span> ); // <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">false</span></span></code> <br> <br>    <span class="hljs-type"><span class="hljs-type">Chrome</span></span>, <span class="hljs-type"><span class="hljs-type">Firefox</span></span>, <span class="hljs-type"><span class="hljs-type">IE10</span></span> (+<span class="hljs-type"><span class="hljs-type">IE7</span></span> <span class="hljs-type"><span class="hljs-type">Mode</span></span>) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/<span class="hljs-type"><span class="hljs-type">Suitup</span></span></a> <br> <br>   extended-commands.suitup.jquery.js     .    <span class="hljs-number"><span class="hljs-number">50</span></span>        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b><span class="hljs-type"><span class="hljs-type">UPD</span></span></b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> <span class="hljs-number"><span class="hljs-number">1.</span></span>          . ,  bold  <span class="hljs-type"><span class="hljs-type">Chrome</span></span>     b,   <span class="hljs-type"><span class="hljs-type">IE</span></span>   strong. <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>          (      ). <br> <span class="hljs-number"><span class="hljs-number">3.</span></span>    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code></code> </pre> <code><code>, ,     IE,        execCommand( 'formatblock' ... )</code>   .   :     " ",       .   IE...    ?..     <code>queryCommandValue( 'formatblock' )</code>  <code>" 1", " 2", ""</code> , .     , , , ,         .     ,    IE10. ,  ,    IE10!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  SuitUp <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript">$( '.my-textarea' ).suitUp();</code> <br>       : <br> <code class="javascript">$( '.my-textarea' ).suitUp( 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' );</code> <br>       <br> <code class="javascript">$( '.my-textarea' ).suitUp([ 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , 'forecolor',      : <br> <br> 1. ,  :  forecolor    red: <br> <code class="javascript">$.suitUp.commands = { forecolor: 'red' }</code> <br>  <br> <code class="javascript">$.extend( jQuery.suitUp.commands, { forecolor: 'red' })</code> <br>  <br> <code class="javascript">$.suitUp.commands.forecolor = 'red' // ( ,  commands -  )</code> <br> : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> 2.   () <br> <code class="javascript">$.suitUp.commands.forecolor = { 'Make Red': 'red', 'Make Green': 'green' }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> 3. ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( ' ', '' ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript">$( 'textarea' ).suitUp( 'italic', 'bold', '|', 'link', 'formatblock#&lt;h1&gt;' );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> 1.  Bold. <br> 2.  . <br> 3. ,             "". <br> <br>  ,        . <br> <br> <code class="javascript">$.extend( $.suitUp.commands, { bold: null, //   ,        null fontname: { Arial: 'arial', Times: 'times', Verdana: 'verdana' }, forecolor: function( callback ){ var blackBackground = $( '&lt;div/&gt;' ).css({ background: 'black', position: 'absolute', top: 0, left:0, opacity: .5, width: '100%', height: '100%' }).on( 'click', function(){ popup.add( this ).remove(); }).appendTo('body'), popup = $( '&lt;div/&gt;' ).css({ padding: '10px 20px', width: 200, position: 'absolute', background: 'white', top: 200, left: $( window ).width()/2 - 110, zIndex: 100 }).appendTo('body'); $( '&lt;input/&gt;' ).appendTo( popup ); $( '&lt;button/&gt;' ).appendTo( popup ).text( 'Go!' ).on( 'click', function() { var val = popup.children( 'input' ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor' );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . Callback   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( 'forecolor', false, ' ' );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript">$.suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript">$.extend( jQuery.suitUp.custom, { helloWorld: function() { return $( '&lt;span/&gt;', { 'class': 'suitup-control' //    }).css( 'backgroundColor', 'red' ).on( 'click', function() { alert( 'Hello World!' ); }); } });</code> <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor', 'helloWorld' );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       "link",     ( "createlink"),      ( "unlink"). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( 'a', { className: 'suitup-control', href: '#' }).attr({ 'data-command': 'createlink' //         createlink }).on( 'click', function() { if( !$.suitUp.hasSelectedNodeParent( 'a' ) ) { document.execCommand( 'createlink', false, window.prompt( 'URL:', '' ) ); } else { document.execCommand( 'unlink', false, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor#red</code> )    : <br>  .   .  , ""  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript">$.suitUp.controls = [ 'bold', 'italic' ]; $( '.suitup-textarea' ).suitUp(); //    ,   $( '.suitup-textarea' ).suitUp( 'bold', 'italic' );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript">$.suitUp.controls.push( 'forecolor' ); $( '.suitup-textarea' ).suitUp();</code> <br>   : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( $.suitUp.controls.concat([ 'forecolor' ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   $.suitUp   .  ,            .      ,      ,  . <br> <br> <b>$.suitUp.getSelection</b> <br>   .          . <br> <br> <b>$.suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = $.suitUp.getSelection(); //  -,     $( '.suitup-editor' ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b>$.suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b>$.suitUp.hasSelectedNodeParent</b> <br>  ,      "link". ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( 'a' ); // true/false</code> <br> <br>    Chrome, Firefox, IE10 (+IE7 Mode) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/Suitup</a> <br> <br>   extended-commands.suitup.jquery.js     .    50        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b>UPD</b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> 1.          . ,  bold  Chrome     b,   IE   strong. <br> 2.          (      ). <br> 3.    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> <pre> <code class="hljs smalltalk"><code>, ,     <span class="hljs-type"><span class="hljs-type">IE</span></span>,        execCommand( <span class="hljs-string"><span class="hljs-string">'formatblock'</span></span> ... )</code>   .   :     <span class="hljs-comment"><span class="hljs-comment">" "</span></span>,       .   <span class="hljs-type"><span class="hljs-type">IE</span></span>...    ?..     <code>queryCommandValue( <span class="hljs-string"><span class="hljs-string">'formatblock'</span></span> )</code>  <code><span class="hljs-comment"><span class="hljs-comment">" 1"</span></span>, <span class="hljs-comment"><span class="hljs-comment">" 2"</span></span>, <span class="hljs-comment"><span class="hljs-comment">""</span></span></code> , .     , , , ,         .     ,    <span class="hljs-type"><span class="hljs-type">IE10</span></span>. ,  ,    <span class="hljs-type"><span class="hljs-type">IE10</span></span>!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  <span class="hljs-type"><span class="hljs-type">SuitUp</span></span> <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp();</code> <br>       : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> );</code> <br>       <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp([ <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>,      : <br> <br> <span class="hljs-number"><span class="hljs-number">1.</span></span> ,  :  forecolor    red: <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands = { forecolor: <span class="hljs-string"><span class="hljs-string">'red'</span></span> }</code> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( jQuery.suitUp.commands, { forecolor: <span class="hljs-string"><span class="hljs-string">'red'</span></span> })</code> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands.forecolor = <span class="hljs-string"><span class="hljs-string">'red'</span></span> // ( ,  commands -  )</code> <br> : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>   () <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands.forecolor = { <span class="hljs-string"><span class="hljs-string">'Make Red'</span></span>: <span class="hljs-string"><span class="hljs-string">'red'</span></span>, <span class="hljs-string"><span class="hljs-string">'Make Green'</span></span>: <span class="hljs-string"><span class="hljs-string">'green'</span></span> }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> <span class="hljs-number"><span class="hljs-number">3.</span></span> ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span> ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'link'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> <span class="hljs-number"><span class="hljs-number">1.</span></span>  <span class="hljs-type"><span class="hljs-type">Bold</span></span>. <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>  . <br> <span class="hljs-number"><span class="hljs-number">3.</span></span> ,             <span class="hljs-comment"><span class="hljs-comment">""</span></span>. <br> <br>  ,        . <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands, { bold: null, //   ,        null fontname: { <span class="hljs-type"><span class="hljs-type">Arial</span></span>: <span class="hljs-string"><span class="hljs-string">'arial'</span></span>, <span class="hljs-type"><span class="hljs-type">Times</span></span>: <span class="hljs-string"><span class="hljs-string">'times'</span></span>, <span class="hljs-type"><span class="hljs-type">Verdana</span></span>: <span class="hljs-string"><span class="hljs-string">'verdana'</span></span> }, forecolor: function( callback ){ var blackBackground = <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;div/&gt;'</span></span> ).css({ background: <span class="hljs-string"><span class="hljs-string">'black'</span></span>, position: <span class="hljs-string"><span class="hljs-string">'absolute'</span></span>, top: <span class="hljs-number"><span class="hljs-number">0</span></span>, left:<span class="hljs-number"><span class="hljs-number">0</span></span>, opacity: <span class="hljs-number"><span class="hljs-number">.5</span></span>, width: <span class="hljs-string"><span class="hljs-string">'100%'</span></span>, height: <span class="hljs-string"><span class="hljs-string">'100%'</span></span> }).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function(){ popup.add( this ).remove(); }).appendTo(<span class="hljs-string"><span class="hljs-string">'body'</span></span>), popup = <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;div/&gt;'</span></span> ).css({ padding: <span class="hljs-string"><span class="hljs-string">'10px 20px'</span></span>, width: <span class="hljs-number"><span class="hljs-number">200</span></span>, position: <span class="hljs-string"><span class="hljs-string">'absolute'</span></span>, background: <span class="hljs-string"><span class="hljs-string">'white'</span></span>, top: <span class="hljs-number"><span class="hljs-number">200</span></span>, left: <span class="hljs-string"><span class="hljs-string">$(</span></span> window ).width()/<span class="hljs-number"><span class="hljs-number">2</span></span> - <span class="hljs-number"><span class="hljs-number">110</span></span>, zIndex: <span class="hljs-number"><span class="hljs-number">100</span></span> }).appendTo(<span class="hljs-string"><span class="hljs-string">'body'</span></span>); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;input/&gt;'</span></span> ).appendTo( popup ); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;button/&gt;'</span></span> ).appendTo( popup ).text( <span class="hljs-string"><span class="hljs-string">'Go!'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { var val = popup.children( <span class="hljs-string"><span class="hljs-string">'input'</span></span> ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'fontname'</span></span>, <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . <span class="hljs-type"><span class="hljs-type">Callback</span></span>   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span> );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( jQuery.suitUp.custom, { helloWorld: function() { return <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;span/&gt;'</span></span>, { <span class="hljs-string"><span class="hljs-string">'class'</span></span>: <span class="hljs-string"><span class="hljs-string">'suitup-control'</span></span> //    }).css( <span class="hljs-string"><span class="hljs-string">'backgroundColor'</span></span>, <span class="hljs-string"><span class="hljs-string">'red'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { alert( <span class="hljs-string"><span class="hljs-string">'Hello World!'</span></span> ); }); } });</code> <br> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'fontname'</span></span>, <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>, <span class="hljs-string"><span class="hljs-string">'helloWorld'</span></span> );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       <span class="hljs-comment"><span class="hljs-comment">"link"</span></span>,     ( <span class="hljs-comment"><span class="hljs-comment">"createlink"</span></span>),      ( <span class="hljs-comment"><span class="hljs-comment">"unlink"</span></span>). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( <span class="hljs-string"><span class="hljs-string">'a'</span></span>, { className: <span class="hljs-string"><span class="hljs-string">'suitup-control'</span></span>, href: <span class="hljs-string"><span class="hljs-string">'#'</span></span> }).attr({ <span class="hljs-string"><span class="hljs-string">'data-command'</span></span>: <span class="hljs-string"><span class="hljs-string">'createlink'</span></span> //         createlink }).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { if( !<span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.hasSelectedNodeParent( <span class="hljs-string"><span class="hljs-string">'a'</span></span> ) ) { document.execCommand( <span class="hljs-string"><span class="hljs-string">'createlink'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, window.prompt( <span class="hljs-string"><span class="hljs-string">'URL:'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span> ) ); } else { document.execCommand( <span class="hljs-string"><span class="hljs-string">'unlink'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor<span class="hljs-symbol"><span class="hljs-symbol">#red</span></span></code> )    : <br>  .   .  , <span class="hljs-comment"><span class="hljs-comment">""</span></span>  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls = [ <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'italic'</span></span> ]; <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp(); //    ,   <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'italic'</span></span> );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls.push( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp();</code> <br>   : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls.concat([ <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp   .  ,            .      ,      ,  . <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelection</b> <br>   .          . <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelection(); //  -,     <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-editor'</span></span> ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.hasSelectedNodeParent</b> <br>  ,      <span class="hljs-comment"><span class="hljs-comment">"link"</span></span>. ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( <span class="hljs-string"><span class="hljs-string">'a'</span></span> ); // <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">false</span></span></code> <br> <br>    <span class="hljs-type"><span class="hljs-type">Chrome</span></span>, <span class="hljs-type"><span class="hljs-type">Firefox</span></span>, <span class="hljs-type"><span class="hljs-type">IE10</span></span> (+<span class="hljs-type"><span class="hljs-type">IE7</span></span> <span class="hljs-type"><span class="hljs-type">Mode</span></span>) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/<span class="hljs-type"><span class="hljs-type">Suitup</span></span></a> <br> <br>   extended-commands.suitup.jquery.js     .    <span class="hljs-number"><span class="hljs-number">50</span></span>        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b><span class="hljs-type"><span class="hljs-type">UPD</span></span></b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> <span class="hljs-number"><span class="hljs-number">1.</span></span>          . ,  bold  <span class="hljs-type"><span class="hljs-type">Chrome</span></span>     b,   <span class="hljs-type"><span class="hljs-type">IE</span></span>   strong. <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>          (      ). <br> <span class="hljs-number"><span class="hljs-number">3.</span></span>    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> </pre> <code><code>, ,     IE,        execCommand( 'formatblock' ... )</code>   .   :     " ",       .   IE...    ?..     <code>queryCommandValue( 'formatblock' )</code>  <code>" 1", " 2", ""</code> , .     , , , ,         .     ,    IE10. ,  ,    IE10!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  SuitUp <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript">$( '.my-textarea' ).suitUp();</code> <br>       : <br> <code class="javascript">$( '.my-textarea' ).suitUp( 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' );</code> <br>       <br> <code class="javascript">$( '.my-textarea' ).suitUp([ 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , 'forecolor',      : <br> <br> 1. ,  :  forecolor    red: <br> <code class="javascript">$.suitUp.commands = { forecolor: 'red' }</code> <br>  <br> <code class="javascript">$.extend( jQuery.suitUp.commands, { forecolor: 'red' })</code> <br>  <br> <code class="javascript">$.suitUp.commands.forecolor = 'red' // ( ,  commands -  )</code> <br> : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> 2.   () <br> <code class="javascript">$.suitUp.commands.forecolor = { 'Make Red': 'red', 'Make Green': 'green' }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> 3. ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( ' ', '' ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript">$( 'textarea' ).suitUp( 'italic', 'bold', '|', 'link', 'formatblock#&lt;h1&gt;' );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> 1.  Bold. <br> 2.  . <br> 3. ,             "". <br> <br>  ,        . <br> <br> <code class="javascript">$.extend( $.suitUp.commands, { bold: null, //   ,        null fontname: { Arial: 'arial', Times: 'times', Verdana: 'verdana' }, forecolor: function( callback ){ var blackBackground = $( '&lt;div/&gt;' ).css({ background: 'black', position: 'absolute', top: 0, left:0, opacity: .5, width: '100%', height: '100%' }).on( 'click', function(){ popup.add( this ).remove(); }).appendTo('body'), popup = $( '&lt;div/&gt;' ).css({ padding: '10px 20px', width: 200, position: 'absolute', background: 'white', top: 200, left: $( window ).width()/2 - 110, zIndex: 100 }).appendTo('body'); $( '&lt;input/&gt;' ).appendTo( popup ); $( '&lt;button/&gt;' ).appendTo( popup ).text( 'Go!' ).on( 'click', function() { var val = popup.children( 'input' ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor' );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . Callback   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( 'forecolor', false, ' ' );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript">$.suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript">$.extend( jQuery.suitUp.custom, { helloWorld: function() { return $( '&lt;span/&gt;', { 'class': 'suitup-control' //    }).css( 'backgroundColor', 'red' ).on( 'click', function() { alert( 'Hello World!' ); }); } });</code> <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor', 'helloWorld' );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       "link",     ( "createlink"),      ( "unlink"). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( 'a', { className: 'suitup-control', href: '#' }).attr({ 'data-command': 'createlink' //         createlink }).on( 'click', function() { if( !$.suitUp.hasSelectedNodeParent( 'a' ) ) { document.execCommand( 'createlink', false, window.prompt( 'URL:', '' ) ); } else { document.execCommand( 'unlink', false, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor#red</code> )    : <br>  .   .  , ""  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript">$.suitUp.controls = [ 'bold', 'italic' ]; $( '.suitup-textarea' ).suitUp(); //    ,   $( '.suitup-textarea' ).suitUp( 'bold', 'italic' );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript">$.suitUp.controls.push( 'forecolor' ); $( '.suitup-textarea' ).suitUp();</code> <br>   : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( $.suitUp.controls.concat([ 'forecolor' ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   $.suitUp   .  ,            .      ,      ,  . <br> <br> <b>$.suitUp.getSelection</b> <br>   .          . <br> <br> <b>$.suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = $.suitUp.getSelection(); //  -,     $( '.suitup-editor' ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b>$.suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b>$.suitUp.hasSelectedNodeParent</b> <br>  ,      "link". ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( 'a' ); // true/false</code> <br> <br>    Chrome, Firefox, IE10 (+IE7 Mode) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/Suitup</a> <br> <br>   extended-commands.suitup.jquery.js     .    50        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b>UPD</b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> 1.          . ,  bold  Chrome     b,   IE   strong. <br> 2.          (      ). <br> 3.    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> <pre> <code class="hljs smalltalk"><code class="javascript"><code>, ,     <span class="hljs-type"><span class="hljs-type">IE</span></span>,        execCommand( <span class="hljs-string"><span class="hljs-string">'formatblock'</span></span> ... )</code>   .   :     <span class="hljs-comment"><span class="hljs-comment">" "</span></span>,       .   <span class="hljs-type"><span class="hljs-type">IE</span></span>...    ?..     <code>queryCommandValue( <span class="hljs-string"><span class="hljs-string">'formatblock'</span></span> )</code>  <code><span class="hljs-comment"><span class="hljs-comment">" 1"</span></span>, <span class="hljs-comment"><span class="hljs-comment">" 2"</span></span>, <span class="hljs-comment"><span class="hljs-comment">""</span></span></code> , .     , , , ,         .     ,    <span class="hljs-type"><span class="hljs-type">IE10</span></span>. ,  ,    <span class="hljs-type"><span class="hljs-type">IE10</span></span>!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  <span class="hljs-type"><span class="hljs-type">SuitUp</span></span> <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp();</code> <br>       : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> );</code> <br>       <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp([ <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>,      : <br> <br> <span class="hljs-number"><span class="hljs-number">1.</span></span> ,  :  forecolor    red: <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands = { forecolor: <span class="hljs-string"><span class="hljs-string">'red'</span></span> }</code> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( jQuery.suitUp.commands, { forecolor: <span class="hljs-string"><span class="hljs-string">'red'</span></span> })</code> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands.forecolor = <span class="hljs-string"><span class="hljs-string">'red'</span></span> // ( ,  commands -  )</code> <br> : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>   () <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands.forecolor = { <span class="hljs-string"><span class="hljs-string">'Make Red'</span></span>: <span class="hljs-string"><span class="hljs-string">'red'</span></span>, <span class="hljs-string"><span class="hljs-string">'Make Green'</span></span>: <span class="hljs-string"><span class="hljs-string">'green'</span></span> }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> <span class="hljs-number"><span class="hljs-number">3.</span></span> ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span> ); //     callback( color ); //   }</code> <br>  : <br> <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ); <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'link'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> <span class="hljs-number"><span class="hljs-number">1.</span></span>  <span class="hljs-type"><span class="hljs-type">Bold</span></span>. <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>  . <br> <span class="hljs-number"><span class="hljs-number">3.</span></span> ,             <span class="hljs-comment"><span class="hljs-comment">""</span></span>. <br> <br>  ,        . <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands, { bold: null, //   ,        null fontname: { <span class="hljs-type"><span class="hljs-type">Arial</span></span>: <span class="hljs-string"><span class="hljs-string">'arial'</span></span>, <span class="hljs-type"><span class="hljs-type">Times</span></span>: <span class="hljs-string"><span class="hljs-string">'times'</span></span>, <span class="hljs-type"><span class="hljs-type">Verdana</span></span>: <span class="hljs-string"><span class="hljs-string">'verdana'</span></span> }, forecolor: function( callback ){ var blackBackground = <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;div/&gt;'</span></span> ).css({ background: <span class="hljs-string"><span class="hljs-string">'black'</span></span>, position: <span class="hljs-string"><span class="hljs-string">'absolute'</span></span>, top: <span class="hljs-number"><span class="hljs-number">0</span></span>, left:<span class="hljs-number"><span class="hljs-number">0</span></span>, opacity: <span class="hljs-number"><span class="hljs-number">.5</span></span>, width: <span class="hljs-string"><span class="hljs-string">'100%'</span></span>, height: <span class="hljs-string"><span class="hljs-string">'100%'</span></span> }).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function(){ popup.add( this ).remove(); }).appendTo(<span class="hljs-string"><span class="hljs-string">'body'</span></span>), popup = <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;div/&gt;'</span></span> ).css({ padding: <span class="hljs-string"><span class="hljs-string">'10px 20px'</span></span>, width: <span class="hljs-number"><span class="hljs-number">200</span></span>, position: <span class="hljs-string"><span class="hljs-string">'absolute'</span></span>, background: <span class="hljs-string"><span class="hljs-string">'white'</span></span>, top: <span class="hljs-number"><span class="hljs-number">200</span></span>, left: <span class="hljs-string"><span class="hljs-string">$(</span></span> window ).width()/<span class="hljs-number"><span class="hljs-number">2</span></span> - <span class="hljs-number"><span class="hljs-number">110</span></span>, zIndex: <span class="hljs-number"><span class="hljs-number">100</span></span> }).appendTo(<span class="hljs-string"><span class="hljs-string">'body'</span></span>); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;input/&gt;'</span></span> ).appendTo( popup ); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;button/&gt;'</span></span> ).appendTo( popup ).text( <span class="hljs-string"><span class="hljs-string">'Go!'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { var val = popup.children( <span class="hljs-string"><span class="hljs-string">'input'</span></span> ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'fontname'</span></span>, <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . <span class="hljs-type"><span class="hljs-type">Callback</span></span>   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span> );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( jQuery.suitUp.custom, { helloWorld: function() { return <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;span/&gt;'</span></span>, { <span class="hljs-string"><span class="hljs-string">'class'</span></span>: <span class="hljs-string"><span class="hljs-string">'suitup-control'</span></span> //    }).css( <span class="hljs-string"><span class="hljs-string">'backgroundColor'</span></span>, <span class="hljs-string"><span class="hljs-string">'red'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { alert( <span class="hljs-string"><span class="hljs-string">'Hello World!'</span></span> ); }); } });</code> <br> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'fontname'</span></span>, <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>, <span class="hljs-string"><span class="hljs-string">'helloWorld'</span></span> );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       <span class="hljs-comment"><span class="hljs-comment">"link"</span></span>,     ( <span class="hljs-comment"><span class="hljs-comment">"createlink"</span></span>),      ( <span class="hljs-comment"><span class="hljs-comment">"unlink"</span></span>). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( <span class="hljs-string"><span class="hljs-string">'a'</span></span>, { className: <span class="hljs-string"><span class="hljs-string">'suitup-control'</span></span>, href: <span class="hljs-string"><span class="hljs-string">'#'</span></span> }).attr({ <span class="hljs-string"><span class="hljs-string">'data-command'</span></span>: <span class="hljs-string"><span class="hljs-string">'createlink'</span></span> //         createlink }).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { if( !<span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.hasSelectedNodeParent( <span class="hljs-string"><span class="hljs-string">'a'</span></span> ) ) { document.execCommand( <span class="hljs-string"><span class="hljs-string">'createlink'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, window.prompt( <span class="hljs-string"><span class="hljs-string">'URL:'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span> ) ); } else { document.execCommand( <span class="hljs-string"><span class="hljs-string">'unlink'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor<span class="hljs-symbol"><span class="hljs-symbol">#red</span></span></code> )    : <br>  .   .  , <span class="hljs-comment"><span class="hljs-comment">""</span></span>  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls = [ <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'italic'</span></span> ]; <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp(); //    ,   <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'italic'</span></span> );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls.push( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp();</code> <br>   : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls.concat([ <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp   .  ,            .      ,      ,  . <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelection</b> <br>   .          . <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelection(); //  -,     <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-editor'</span></span> ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.hasSelectedNodeParent</b> <br>  ,      <span class="hljs-comment"><span class="hljs-comment">"link"</span></span>. ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( <span class="hljs-string"><span class="hljs-string">'a'</span></span> ); // <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">false</span></span></code> <br> <br>    <span class="hljs-type"><span class="hljs-type">Chrome</span></span>, <span class="hljs-type"><span class="hljs-type">Firefox</span></span>, <span class="hljs-type"><span class="hljs-type">IE10</span></span> (+<span class="hljs-type"><span class="hljs-type">IE7</span></span> <span class="hljs-type"><span class="hljs-type">Mode</span></span>) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/<span class="hljs-type"><span class="hljs-type">Suitup</span></span></a> <br> <br>   extended-commands.suitup.jquery.js     .    <span class="hljs-number"><span class="hljs-number">50</span></span>        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b><span class="hljs-type"><span class="hljs-type">UPD</span></span></b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> <span class="hljs-number"><span class="hljs-number">1.</span></span>          . ,  bold  <span class="hljs-type"><span class="hljs-type">Chrome</span></span>     b,   <span class="hljs-type"><span class="hljs-type">IE</span></span>   strong. <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>          (      ). <br> <span class="hljs-number"><span class="hljs-number">3.</span></span>    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code></code> </pre> <code><code>, ,     IE,        execCommand( 'formatblock' ... )</code>   .   :     " ",       .   IE...    ?..     <code>queryCommandValue( 'formatblock' )</code>  <code>" 1", " 2", ""</code> , .     , , , ,         .     ,    IE10. ,  ,    IE10!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  SuitUp <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript">$( '.my-textarea' ).suitUp();</code> <br>       : <br> <code class="javascript">$( '.my-textarea' ).suitUp( 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' );</code> <br>       <br> <code class="javascript">$( '.my-textarea' ).suitUp([ 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , 'forecolor',      : <br> <br> 1. ,  :  forecolor    red: <br> <code class="javascript">$.suitUp.commands = { forecolor: 'red' }</code> <br>  <br> <code class="javascript">$.extend( jQuery.suitUp.commands, { forecolor: 'red' })</code> <br>  <br> <code class="javascript">$.suitUp.commands.forecolor = 'red' // ( ,  commands -  )</code> <br> : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> 2.   () <br> <code class="javascript">$.suitUp.commands.forecolor = { 'Make Red': 'red', 'Make Green': 'green' }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> 3. ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( ' ', '' ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript">$( 'textarea' ).suitUp( 'italic', 'bold', '|', 'link', 'formatblock#&lt;h1&gt;' );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> 1.  Bold. <br> 2.  . <br> 3. ,             "". <br> <br>  ,        . <br> <br> <code class="javascript">$.extend( $.suitUp.commands, { bold: null, //   ,        null fontname: { Arial: 'arial', Times: 'times', Verdana: 'verdana' }, forecolor: function( callback ){ var blackBackground = $( '&lt;div/&gt;' ).css({ background: 'black', position: 'absolute', top: 0, left:0, opacity: .5, width: '100%', height: '100%' }).on( 'click', function(){ popup.add( this ).remove(); }).appendTo('body'), popup = $( '&lt;div/&gt;' ).css({ padding: '10px 20px', width: 200, position: 'absolute', background: 'white', top: 200, left: $( window ).width()/2 - 110, zIndex: 100 }).appendTo('body'); $( '&lt;input/&gt;' ).appendTo( popup ); $( '&lt;button/&gt;' ).appendTo( popup ).text( 'Go!' ).on( 'click', function() { var val = popup.children( 'input' ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor' );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . Callback   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( 'forecolor', false, ' ' );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript">$.suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript">$.extend( jQuery.suitUp.custom, { helloWorld: function() { return $( '&lt;span/&gt;', { 'class': 'suitup-control' //    }).css( 'backgroundColor', 'red' ).on( 'click', function() { alert( 'Hello World!' ); }); } });</code> <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor', 'helloWorld' );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       "link",     ( "createlink"),      ( "unlink"). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( 'a', { className: 'suitup-control', href: '#' }).attr({ 'data-command': 'createlink' //         createlink }).on( 'click', function() { if( !$.suitUp.hasSelectedNodeParent( 'a' ) ) { document.execCommand( 'createlink', false, window.prompt( 'URL:', '' ) ); } else { document.execCommand( 'unlink', false, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor#red</code> )    : <br>  .   .  , ""  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript">$.suitUp.controls = [ 'bold', 'italic' ]; $( '.suitup-textarea' ).suitUp(); //    ,   $( '.suitup-textarea' ).suitUp( 'bold', 'italic' );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript">$.suitUp.controls.push( 'forecolor' ); $( '.suitup-textarea' ).suitUp();</code> <br>   : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( $.suitUp.controls.concat([ 'forecolor' ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   $.suitUp   .  ,            .      ,      ,  . <br> <br> <b>$.suitUp.getSelection</b> <br>   .          . <br> <br> <b>$.suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = $.suitUp.getSelection(); //  -,     $( '.suitup-editor' ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b>$.suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b>$.suitUp.hasSelectedNodeParent</b> <br>  ,      "link". ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( 'a' ); // true/false</code> <br> <br>    Chrome, Firefox, IE10 (+IE7 Mode) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/Suitup</a> <br> <br>   extended-commands.suitup.jquery.js     .    50        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b>UPD</b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> 1.          . ,  bold  Chrome     b,   IE   strong. <br> 2.          (      ). <br> 3.    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> <pre> <code class="hljs smalltalk"><code class="javascript"><code>, ,     <span class="hljs-type"><span class="hljs-type">IE</span></span>,        execCommand( <span class="hljs-string"><span class="hljs-string">'formatblock'</span></span> ... )</code>   .   :     <span class="hljs-comment"><span class="hljs-comment">" "</span></span>,       .   <span class="hljs-type"><span class="hljs-type">IE</span></span>...    ?..     <code>queryCommandValue( <span class="hljs-string"><span class="hljs-string">'formatblock'</span></span> )</code>  <code><span class="hljs-comment"><span class="hljs-comment">" 1"</span></span>, <span class="hljs-comment"><span class="hljs-comment">" 2"</span></span>, <span class="hljs-comment"><span class="hljs-comment">""</span></span></code> , .     , , , ,         .     ,    <span class="hljs-type"><span class="hljs-type">IE10</span></span>. ,  ,    <span class="hljs-type"><span class="hljs-type">IE10</span></span>!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  <span class="hljs-type"><span class="hljs-type">SuitUp</span></span> <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp();</code> <br>       : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> );</code> <br>       <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp([ <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>,      : <br> <br> <span class="hljs-number"><span class="hljs-number">1.</span></span> ,  :  forecolor    red: <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands = { forecolor: <span class="hljs-string"><span class="hljs-string">'red'</span></span> }</code> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( jQuery.suitUp.commands, { forecolor: <span class="hljs-string"><span class="hljs-string">'red'</span></span> })</code> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands.forecolor = <span class="hljs-string"><span class="hljs-string">'red'</span></span> // ( ,  commands -  )</code> <br> : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>   () <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands.forecolor = { <span class="hljs-string"><span class="hljs-string">'Make Red'</span></span>: <span class="hljs-string"><span class="hljs-string">'red'</span></span>, <span class="hljs-string"><span class="hljs-string">'Make Green'</span></span>: <span class="hljs-string"><span class="hljs-string">'green'</span></span> }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> <span class="hljs-number"><span class="hljs-number">3.</span></span> ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span> ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'link'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> ); <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> <span class="hljs-number"><span class="hljs-number">1.</span></span>  <span class="hljs-type"><span class="hljs-type">Bold</span></span>. <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>  . <br> <span class="hljs-number"><span class="hljs-number">3.</span></span> ,             <span class="hljs-comment"><span class="hljs-comment">""</span></span>. <br> <br>  ,        . <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands, { bold: null, //   ,        null fontname: { <span class="hljs-type"><span class="hljs-type">Arial</span></span>: <span class="hljs-string"><span class="hljs-string">'arial'</span></span>, <span class="hljs-type"><span class="hljs-type">Times</span></span>: <span class="hljs-string"><span class="hljs-string">'times'</span></span>, <span class="hljs-type"><span class="hljs-type">Verdana</span></span>: <span class="hljs-string"><span class="hljs-string">'verdana'</span></span> }, forecolor: function( callback ){ var blackBackground = <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;div/&gt;'</span></span> ).css({ background: <span class="hljs-string"><span class="hljs-string">'black'</span></span>, position: <span class="hljs-string"><span class="hljs-string">'absolute'</span></span>, top: <span class="hljs-number"><span class="hljs-number">0</span></span>, left:<span class="hljs-number"><span class="hljs-number">0</span></span>, opacity: <span class="hljs-number"><span class="hljs-number">.5</span></span>, width: <span class="hljs-string"><span class="hljs-string">'100%'</span></span>, height: <span class="hljs-string"><span class="hljs-string">'100%'</span></span> }).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function(){ popup.add( this ).remove(); }).appendTo(<span class="hljs-string"><span class="hljs-string">'body'</span></span>), popup = <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;div/&gt;'</span></span> ).css({ padding: <span class="hljs-string"><span class="hljs-string">'10px 20px'</span></span>, width: <span class="hljs-number"><span class="hljs-number">200</span></span>, position: <span class="hljs-string"><span class="hljs-string">'absolute'</span></span>, background: <span class="hljs-string"><span class="hljs-string">'white'</span></span>, top: <span class="hljs-number"><span class="hljs-number">200</span></span>, left: <span class="hljs-string"><span class="hljs-string">$(</span></span> window ).width()/<span class="hljs-number"><span class="hljs-number">2</span></span> - <span class="hljs-number"><span class="hljs-number">110</span></span>, zIndex: <span class="hljs-number"><span class="hljs-number">100</span></span> }).appendTo(<span class="hljs-string"><span class="hljs-string">'body'</span></span>); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;input/&gt;'</span></span> ).appendTo( popup ); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;button/&gt;'</span></span> ).appendTo( popup ).text( <span class="hljs-string"><span class="hljs-string">'Go!'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { var val = popup.children( <span class="hljs-string"><span class="hljs-string">'input'</span></span> ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'fontname'</span></span>, <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . <span class="hljs-type"><span class="hljs-type">Callback</span></span>   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span> );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( jQuery.suitUp.custom, { helloWorld: function() { return <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;span/&gt;'</span></span>, { <span class="hljs-string"><span class="hljs-string">'class'</span></span>: <span class="hljs-string"><span class="hljs-string">'suitup-control'</span></span> //    }).css( <span class="hljs-string"><span class="hljs-string">'backgroundColor'</span></span>, <span class="hljs-string"><span class="hljs-string">'red'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { alert( <span class="hljs-string"><span class="hljs-string">'Hello World!'</span></span> ); }); } });</code> <br> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'fontname'</span></span>, <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>, <span class="hljs-string"><span class="hljs-string">'helloWorld'</span></span> );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       <span class="hljs-comment"><span class="hljs-comment">"link"</span></span>,     ( <span class="hljs-comment"><span class="hljs-comment">"createlink"</span></span>),      ( <span class="hljs-comment"><span class="hljs-comment">"unlink"</span></span>). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( <span class="hljs-string"><span class="hljs-string">'a'</span></span>, { className: <span class="hljs-string"><span class="hljs-string">'suitup-control'</span></span>, href: <span class="hljs-string"><span class="hljs-string">'#'</span></span> }).attr({ <span class="hljs-string"><span class="hljs-string">'data-command'</span></span>: <span class="hljs-string"><span class="hljs-string">'createlink'</span></span> //         createlink }).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { if( !<span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.hasSelectedNodeParent( <span class="hljs-string"><span class="hljs-string">'a'</span></span> ) ) { document.execCommand( <span class="hljs-string"><span class="hljs-string">'createlink'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, window.prompt( <span class="hljs-string"><span class="hljs-string">'URL:'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span> ) ); } else { document.execCommand( <span class="hljs-string"><span class="hljs-string">'unlink'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor<span class="hljs-symbol"><span class="hljs-symbol">#red</span></span></code> )    : <br>  .   .  , <span class="hljs-comment"><span class="hljs-comment">""</span></span>  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls = [ <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'italic'</span></span> ]; <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp(); //    ,   <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'italic'</span></span> );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls.push( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp();</code> <br>   : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls.concat([ <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp   .  ,            .      ,      ,  . <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelection</b> <br>   .          . <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelection(); //  -,     <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-editor'</span></span> ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.hasSelectedNodeParent</b> <br>  ,      <span class="hljs-comment"><span class="hljs-comment">"link"</span></span>. ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( <span class="hljs-string"><span class="hljs-string">'a'</span></span> ); // <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">false</span></span></code> <br> <br>    <span class="hljs-type"><span class="hljs-type">Chrome</span></span>, <span class="hljs-type"><span class="hljs-type">Firefox</span></span>, <span class="hljs-type"><span class="hljs-type">IE10</span></span> (+<span class="hljs-type"><span class="hljs-type">IE7</span></span> <span class="hljs-type"><span class="hljs-type">Mode</span></span>) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/<span class="hljs-type"><span class="hljs-type">Suitup</span></span></a> <br> <br>   extended-commands.suitup.jquery.js     .    <span class="hljs-number"><span class="hljs-number">50</span></span>        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b><span class="hljs-type"><span class="hljs-type">UPD</span></span></b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> <span class="hljs-number"><span class="hljs-number">1.</span></span>          . ,  bold  <span class="hljs-type"><span class="hljs-type">Chrome</span></span>     b,   <span class="hljs-type"><span class="hljs-type">IE</span></span>   strong. <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>          (      ). <br> <span class="hljs-number"><span class="hljs-number">3.</span></span>    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code></code> </pre> <code><code>, ,     IE,        execCommand( 'formatblock' ... )</code>   .   :     " ",       .   IE...    ?..     <code>queryCommandValue( 'formatblock' )</code>  <code>" 1", " 2", ""</code> , .     , , , ,         .     ,    IE10. ,  ,    IE10!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  SuitUp <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript">$( '.my-textarea' ).suitUp();</code> <br>       : <br> <code class="javascript">$( '.my-textarea' ).suitUp( 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' );</code> <br>       <br> <code class="javascript">$( '.my-textarea' ).suitUp([ 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , 'forecolor',      : <br> <br> 1. ,  :  forecolor    red: <br> <code class="javascript">$.suitUp.commands = { forecolor: 'red' }</code> <br>  <br> <code class="javascript">$.extend( jQuery.suitUp.commands, { forecolor: 'red' })</code> <br>  <br> <code class="javascript">$.suitUp.commands.forecolor = 'red' // ( ,  commands -  )</code> <br> : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> 2.   () <br> <code class="javascript">$.suitUp.commands.forecolor = { 'Make Red': 'red', 'Make Green': 'green' }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> 3. ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( ' ', '' ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript">$( 'textarea' ).suitUp( 'italic', 'bold', '|', 'link', 'formatblock#&lt;h1&gt;' );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> 1.  Bold. <br> 2.  . <br> 3. ,             "". <br> <br>  ,        . <br> <br> <code class="javascript">$.extend( $.suitUp.commands, { bold: null, //   ,        null fontname: { Arial: 'arial', Times: 'times', Verdana: 'verdana' }, forecolor: function( callback ){ var blackBackground = $( '&lt;div/&gt;' ).css({ background: 'black', position: 'absolute', top: 0, left:0, opacity: .5, width: '100%', height: '100%' }).on( 'click', function(){ popup.add( this ).remove(); }).appendTo('body'), popup = $( '&lt;div/&gt;' ).css({ padding: '10px 20px', width: 200, position: 'absolute', background: 'white', top: 200, left: $( window ).width()/2 - 110, zIndex: 100 }).appendTo('body'); $( '&lt;input/&gt;' ).appendTo( popup ); $( '&lt;button/&gt;' ).appendTo( popup ).text( 'Go!' ).on( 'click', function() { var val = popup.children( 'input' ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor' );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . Callback   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( 'forecolor', false, ' ' );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript">$.suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript">$.extend( jQuery.suitUp.custom, { helloWorld: function() { return $( '&lt;span/&gt;', { 'class': 'suitup-control' //    }).css( 'backgroundColor', 'red' ).on( 'click', function() { alert( 'Hello World!' ); }); } });</code> <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor', 'helloWorld' );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       "link",     ( "createlink"),      ( "unlink"). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( 'a', { className: 'suitup-control', href: '#' }).attr({ 'data-command': 'createlink' //         createlink }).on( 'click', function() { if( !$.suitUp.hasSelectedNodeParent( 'a' ) ) { document.execCommand( 'createlink', false, window.prompt( 'URL:', '' ) ); } else { document.execCommand( 'unlink', false, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor#red</code> )    : <br>  .   .  , ""  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript">$.suitUp.controls = [ 'bold', 'italic' ]; $( '.suitup-textarea' ).suitUp(); //    ,   $( '.suitup-textarea' ).suitUp( 'bold', 'italic' );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript">$.suitUp.controls.push( 'forecolor' ); $( '.suitup-textarea' ).suitUp();</code> <br>   : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( $.suitUp.controls.concat([ 'forecolor' ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   $.suitUp   .  ,            .      ,      ,  . <br> <br> <b>$.suitUp.getSelection</b> <br>   .          . <br> <br> <b>$.suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = $.suitUp.getSelection(); //  -,     $( '.suitup-editor' ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b>$.suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b>$.suitUp.hasSelectedNodeParent</b> <br>  ,      "link". ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( 'a' ); // true/false</code> <br> <br>    Chrome, Firefox, IE10 (+IE7 Mode) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/Suitup</a> <br> <br>   extended-commands.suitup.jquery.js     .    50        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b>UPD</b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> 1.          . ,  bold  Chrome     b,   IE   strong. <br> 2.          (      ). <br> 3.    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> <pre> <code class="hljs smalltalk"><code>, ,     <span class="hljs-type"><span class="hljs-type">IE</span></span>,        execCommand( <span class="hljs-string"><span class="hljs-string">'formatblock'</span></span> ... )</code>   .   :     <span class="hljs-comment"><span class="hljs-comment">" "</span></span>,       .   <span class="hljs-type"><span class="hljs-type">IE</span></span>...    ?..     <code>queryCommandValue( <span class="hljs-string"><span class="hljs-string">'formatblock'</span></span> )</code>  <code><span class="hljs-comment"><span class="hljs-comment">" 1"</span></span>, <span class="hljs-comment"><span class="hljs-comment">" 2"</span></span>, <span class="hljs-comment"><span class="hljs-comment">""</span></span></code> , .     , , , ,         .     ,    <span class="hljs-type"><span class="hljs-type">IE10</span></span>. ,  ,    <span class="hljs-type"><span class="hljs-type">IE10</span></span>!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  <span class="hljs-type"><span class="hljs-type">SuitUp</span></span> <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp();</code> <br>       : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> );</code> <br>       <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp([ <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>,      : <br> <br> <span class="hljs-number"><span class="hljs-number">1.</span></span> ,  :  forecolor    red: <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands = { forecolor: <span class="hljs-string"><span class="hljs-string">'red'</span></span> }</code> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( jQuery.suitUp.commands, { forecolor: <span class="hljs-string"><span class="hljs-string">'red'</span></span> })</code> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands.forecolor = <span class="hljs-string"><span class="hljs-string">'red'</span></span> // ( ,  commands -  )</code> <br> : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>   () <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands.forecolor = { <span class="hljs-string"><span class="hljs-string">'Make Red'</span></span>: <span class="hljs-string"><span class="hljs-string">'red'</span></span>, <span class="hljs-string"><span class="hljs-string">'Make Green'</span></span>: <span class="hljs-string"><span class="hljs-string">'green'</span></span> }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> <span class="hljs-number"><span class="hljs-number">3.</span></span> ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span> ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'link'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> <span class="hljs-number"><span class="hljs-number">1.</span></span>  <span class="hljs-type"><span class="hljs-type">Bold</span></span>. <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>  . <br> <span class="hljs-number"><span class="hljs-number">3.</span></span> ,             <span class="hljs-comment"><span class="hljs-comment">""</span></span>. <br> <br>  ,        . <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands, { bold: null, //   ,        null fontname: { <span class="hljs-type"><span class="hljs-type">Arial</span></span>: <span class="hljs-string"><span class="hljs-string">'arial'</span></span>, <span class="hljs-type"><span class="hljs-type">Times</span></span>: <span class="hljs-string"><span class="hljs-string">'times'</span></span>, <span class="hljs-type"><span class="hljs-type">Verdana</span></span>: <span class="hljs-string"><span class="hljs-string">'verdana'</span></span> }, forecolor: function( callback ){ var blackBackground = <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;div/&gt;'</span></span> ).css({ background: <span class="hljs-string"><span class="hljs-string">'black'</span></span>, position: <span class="hljs-string"><span class="hljs-string">'absolute'</span></span>, top: <span class="hljs-number"><span class="hljs-number">0</span></span>, left:<span class="hljs-number"><span class="hljs-number">0</span></span>, opacity: <span class="hljs-number"><span class="hljs-number">.5</span></span>, width: <span class="hljs-string"><span class="hljs-string">'100%'</span></span>, height: <span class="hljs-string"><span class="hljs-string">'100%'</span></span> }).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function(){ popup.add( this ).remove(); }).appendTo(<span class="hljs-string"><span class="hljs-string">'body'</span></span>), popup = <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;div/&gt;'</span></span> ).css({ padding: <span class="hljs-string"><span class="hljs-string">'10px 20px'</span></span>, width: <span class="hljs-number"><span class="hljs-number">200</span></span>, position: <span class="hljs-string"><span class="hljs-string">'absolute'</span></span>, background: <span class="hljs-string"><span class="hljs-string">'white'</span></span>, top: <span class="hljs-number"><span class="hljs-number">200</span></span>, left: <span class="hljs-string"><span class="hljs-string">$(</span></span> window ).width()/<span class="hljs-number"><span class="hljs-number">2</span></span> - <span class="hljs-number"><span class="hljs-number">110</span></span>, zIndex: <span class="hljs-number"><span class="hljs-number">100</span></span> }).appendTo(<span class="hljs-string"><span class="hljs-string">'body'</span></span>); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;input/&gt;'</span></span> ).appendTo( popup ); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;button/&gt;'</span></span> ).appendTo( popup ).text( <span class="hljs-string"><span class="hljs-string">'Go!'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { var val = popup.children( <span class="hljs-string"><span class="hljs-string">'input'</span></span> ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'fontname'</span></span>, <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . <span class="hljs-type"><span class="hljs-type">Callback</span></span>   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span> );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( jQuery.suitUp.custom, { helloWorld: function() { return <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;span/&gt;'</span></span>, { <span class="hljs-string"><span class="hljs-string">'class'</span></span>: <span class="hljs-string"><span class="hljs-string">'suitup-control'</span></span> //    }).css( <span class="hljs-string"><span class="hljs-string">'backgroundColor'</span></span>, <span class="hljs-string"><span class="hljs-string">'red'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { alert( <span class="hljs-string"><span class="hljs-string">'Hello World!'</span></span> ); }); } });</code> <br> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'fontname'</span></span>, <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>, <span class="hljs-string"><span class="hljs-string">'helloWorld'</span></span> );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       <span class="hljs-comment"><span class="hljs-comment">"link"</span></span>,     ( <span class="hljs-comment"><span class="hljs-comment">"createlink"</span></span>),      ( <span class="hljs-comment"><span class="hljs-comment">"unlink"</span></span>). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( <span class="hljs-string"><span class="hljs-string">'a'</span></span>, { className: <span class="hljs-string"><span class="hljs-string">'suitup-control'</span></span>, href: <span class="hljs-string"><span class="hljs-string">'#'</span></span> }).attr({ <span class="hljs-string"><span class="hljs-string">'data-command'</span></span>: <span class="hljs-string"><span class="hljs-string">'createlink'</span></span> //         createlink }).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { if( !<span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.hasSelectedNodeParent( <span class="hljs-string"><span class="hljs-string">'a'</span></span> ) ) { document.execCommand( <span class="hljs-string"><span class="hljs-string">'createlink'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, window.prompt( <span class="hljs-string"><span class="hljs-string">'URL:'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span> ) ); } else { document.execCommand( <span class="hljs-string"><span class="hljs-string">'unlink'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor<span class="hljs-symbol"><span class="hljs-symbol">#red</span></span></code> )    : <br>  .   .  , <span class="hljs-comment"><span class="hljs-comment">""</span></span>  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls = [ <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'italic'</span></span> ]; <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp(); //    ,   <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'italic'</span></span> );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls.push( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp();</code> <br>   : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls.concat([ <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp   .  ,            .      ,      ,  . <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelection</b> <br>   .          . <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelection(); //  -,     <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-editor'</span></span> ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.hasSelectedNodeParent</b> <br>  ,      <span class="hljs-comment"><span class="hljs-comment">"link"</span></span>. ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( <span class="hljs-string"><span class="hljs-string">'a'</span></span> ); // <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">false</span></span></code> <br> <br>    <span class="hljs-type"><span class="hljs-type">Chrome</span></span>, <span class="hljs-type"><span class="hljs-type">Firefox</span></span>, <span class="hljs-type"><span class="hljs-type">IE10</span></span> (+<span class="hljs-type"><span class="hljs-type">IE7</span></span> <span class="hljs-type"><span class="hljs-type">Mode</span></span>) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/<span class="hljs-type"><span class="hljs-type">Suitup</span></span></a> <br> <br>   extended-commands.suitup.jquery.js     .    <span class="hljs-number"><span class="hljs-number">50</span></span>        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b><span class="hljs-type"><span class="hljs-type">UPD</span></span></b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> <span class="hljs-number"><span class="hljs-number">1.</span></span>          . ,  bold  <span class="hljs-type"><span class="hljs-type">Chrome</span></span>     b,   <span class="hljs-type"><span class="hljs-type">IE</span></span>   strong. <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>          (      ). <br> <span class="hljs-number"><span class="hljs-number">3.</span></span>    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> </pre> <code><code>, ,     IE,        execCommand( 'formatblock' ... )</code>   .   :     " ",       .   IE...    ?..     <code>queryCommandValue( 'formatblock' )</code>  <code>" 1", " 2", ""</code> , .     , , , ,         .     ,    IE10. ,  ,    IE10!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  SuitUp <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript">$( '.my-textarea' ).suitUp();</code> <br>       : <br> <code class="javascript">$( '.my-textarea' ).suitUp( 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' );</code> <br>       <br> <code class="javascript">$( '.my-textarea' ).suitUp([ 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , 'forecolor',      : <br> <br> 1. ,  :  forecolor    red: <br> <code class="javascript">$.suitUp.commands = { forecolor: 'red' }</code> <br>  <br> <code class="javascript">$.extend( jQuery.suitUp.commands, { forecolor: 'red' })</code> <br>  <br> <code class="javascript">$.suitUp.commands.forecolor = 'red' // ( ,  commands -  )</code> <br> : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> 2.   () <br> <code class="javascript">$.suitUp.commands.forecolor = { 'Make Red': 'red', 'Make Green': 'green' }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> 3. ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( ' ', '' ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript">$( 'textarea' ).suitUp( 'italic', 'bold', '|', 'link', 'formatblock#&lt;h1&gt;' );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> 1.  Bold. <br> 2.  . <br> 3. ,             "". <br> <br>  ,        . <br> <br> <code class="javascript">$.extend( $.suitUp.commands, { bold: null, //   ,        null fontname: { Arial: 'arial', Times: 'times', Verdana: 'verdana' }, forecolor: function( callback ){ var blackBackground = $( '&lt;div/&gt;' ).css({ background: 'black', position: 'absolute', top: 0, left:0, opacity: .5, width: '100%', height: '100%' }).on( 'click', function(){ popup.add( this ).remove(); }).appendTo('body'), popup = $( '&lt;div/&gt;' ).css({ padding: '10px 20px', width: 200, position: 'absolute', background: 'white', top: 200, left: $( window ).width()/2 - 110, zIndex: 100 }).appendTo('body'); $( '&lt;input/&gt;' ).appendTo( popup ); $( '&lt;button/&gt;' ).appendTo( popup ).text( 'Go!' ).on( 'click', function() { var val = popup.children( 'input' ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor' );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . Callback   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( 'forecolor', false, ' ' );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript">$.suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript">$.extend( jQuery.suitUp.custom, { helloWorld: function() { return $( '&lt;span/&gt;', { 'class': 'suitup-control' //    }).css( 'backgroundColor', 'red' ).on( 'click', function() { alert( 'Hello World!' ); }); } });</code> <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor', 'helloWorld' );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       "link",     ( "createlink"),      ( "unlink"). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( 'a', { className: 'suitup-control', href: '#' }).attr({ 'data-command': 'createlink' //         createlink }).on( 'click', function() { if( !$.suitUp.hasSelectedNodeParent( 'a' ) ) { document.execCommand( 'createlink', false, window.prompt( 'URL:', '' ) ); } else { document.execCommand( 'unlink', false, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor#red</code> )    : <br>  .   .  , ""  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript">$.suitUp.controls = [ 'bold', 'italic' ]; $( '.suitup-textarea' ).suitUp(); //    ,   $( '.suitup-textarea' ).suitUp( 'bold', 'italic' );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript">$.suitUp.controls.push( 'forecolor' ); $( '.suitup-textarea' ).suitUp();</code> <br>   : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( $.suitUp.controls.concat([ 'forecolor' ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   $.suitUp   .  ,            .      ,      ,  . <br> <br> <b>$.suitUp.getSelection</b> <br>   .          . <br> <br> <b>$.suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = $.suitUp.getSelection(); //  -,     $( '.suitup-editor' ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b>$.suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b>$.suitUp.hasSelectedNodeParent</b> <br>  ,      "link". ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( 'a' ); // true/false</code> <br> <br>    Chrome, Firefox, IE10 (+IE7 Mode) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/Suitup</a> <br> <br>   extended-commands.suitup.jquery.js     .    50        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b>UPD</b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> 1.          . ,  bold  Chrome     b,   IE   strong. <br> 2.          (      ). <br> 3.    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> <pre> <code class="hljs smalltalk"><code class="javascript"><code>, ,     <span class="hljs-type"><span class="hljs-type">IE</span></span>,        execCommand( <span class="hljs-string"><span class="hljs-string">'formatblock'</span></span> ... )</code>   .   :     <span class="hljs-comment"><span class="hljs-comment">" "</span></span>,       .   <span class="hljs-type"><span class="hljs-type">IE</span></span>...    ?..     <code>queryCommandValue( <span class="hljs-string"><span class="hljs-string">'formatblock'</span></span> )</code>  <code><span class="hljs-comment"><span class="hljs-comment">" 1"</span></span>, <span class="hljs-comment"><span class="hljs-comment">" 2"</span></span>, <span class="hljs-comment"><span class="hljs-comment">""</span></span></code> , .     , , , ,         .     ,    <span class="hljs-type"><span class="hljs-type">IE10</span></span>. ,  ,    <span class="hljs-type"><span class="hljs-type">IE10</span></span>!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  <span class="hljs-type"><span class="hljs-type">SuitUp</span></span> <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp();</code> <br>       : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> );</code> <br>       <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp([ <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>,      : <br> <br> <span class="hljs-number"><span class="hljs-number">1.</span></span> ,  :  forecolor    red: <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands = { forecolor: <span class="hljs-string"><span class="hljs-string">'red'</span></span> }</code> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( jQuery.suitUp.commands, { forecolor: <span class="hljs-string"><span class="hljs-string">'red'</span></span> })</code> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands.forecolor = <span class="hljs-string"><span class="hljs-string">'red'</span></span> // ( ,  commands -  )</code> <br> : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>   () <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands.forecolor = { <span class="hljs-string"><span class="hljs-string">'Make Red'</span></span>: <span class="hljs-string"><span class="hljs-string">'red'</span></span>, <span class="hljs-string"><span class="hljs-string">'Make Green'</span></span>: <span class="hljs-string"><span class="hljs-string">'green'</span></span> }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> <span class="hljs-number"><span class="hljs-number">3.</span></span> ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span> ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'link'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> <span class="hljs-number"><span class="hljs-number">1.</span></span>  <span class="hljs-type"><span class="hljs-type">Bold</span></span>. <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>  . <br> <span class="hljs-number"><span class="hljs-number">3.</span></span> ,             <span class="hljs-comment"><span class="hljs-comment">""</span></span>. <br> <br>  ,        . <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands, { bold: null, //   ,        null fontname: { <span class="hljs-type"><span class="hljs-type">Arial</span></span>: <span class="hljs-string"><span class="hljs-string">'arial'</span></span>, <span class="hljs-type"><span class="hljs-type">Times</span></span>: <span class="hljs-string"><span class="hljs-string">'times'</span></span>, <span class="hljs-type"><span class="hljs-type">Verdana</span></span>: <span class="hljs-string"><span class="hljs-string">'verdana'</span></span> }, forecolor: function( callback ){ var blackBackground = <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;div/&gt;'</span></span> ).css({ background: <span class="hljs-string"><span class="hljs-string">'black'</span></span>, position: <span class="hljs-string"><span class="hljs-string">'absolute'</span></span>, top: <span class="hljs-number"><span class="hljs-number">0</span></span>, left:<span class="hljs-number"><span class="hljs-number">0</span></span>, opacity: <span class="hljs-number"><span class="hljs-number">.5</span></span>, width: <span class="hljs-string"><span class="hljs-string">'100%'</span></span>, height: <span class="hljs-string"><span class="hljs-string">'100%'</span></span> }).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function(){ popup.add( this ).remove(); }).appendTo(<span class="hljs-string"><span class="hljs-string">'body'</span></span>), popup = <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;div/&gt;'</span></span> ).css({ padding: <span class="hljs-string"><span class="hljs-string">'10px 20px'</span></span>, width: <span class="hljs-number"><span class="hljs-number">200</span></span>, position: <span class="hljs-string"><span class="hljs-string">'absolute'</span></span>, background: <span class="hljs-string"><span class="hljs-string">'white'</span></span>, top: <span class="hljs-number"><span class="hljs-number">200</span></span>, left: <span class="hljs-string"><span class="hljs-string">$(</span></span> window ).width()/<span class="hljs-number"><span class="hljs-number">2</span></span> - <span class="hljs-number"><span class="hljs-number">110</span></span>, zIndex: <span class="hljs-number"><span class="hljs-number">100</span></span> }).appendTo(<span class="hljs-string"><span class="hljs-string">'body'</span></span>); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;input/&gt;'</span></span> ).appendTo( popup ); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;button/&gt;'</span></span> ).appendTo( popup ).text( <span class="hljs-string"><span class="hljs-string">'Go!'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { var val = popup.children( <span class="hljs-string"><span class="hljs-string">'input'</span></span> ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'fontname'</span></span>, <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ); <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . <span class="hljs-type"><span class="hljs-type">Callback</span></span>   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span> );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( jQuery.suitUp.custom, { helloWorld: function() { return <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;span/&gt;'</span></span>, { <span class="hljs-string"><span class="hljs-string">'class'</span></span>: <span class="hljs-string"><span class="hljs-string">'suitup-control'</span></span> //    }).css( <span class="hljs-string"><span class="hljs-string">'backgroundColor'</span></span>, <span class="hljs-string"><span class="hljs-string">'red'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { alert( <span class="hljs-string"><span class="hljs-string">'Hello World!'</span></span> ); }); } });</code> <br> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'fontname'</span></span>, <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>, <span class="hljs-string"><span class="hljs-string">'helloWorld'</span></span> );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       <span class="hljs-comment"><span class="hljs-comment">"link"</span></span>,     ( <span class="hljs-comment"><span class="hljs-comment">"createlink"</span></span>),      ( <span class="hljs-comment"><span class="hljs-comment">"unlink"</span></span>). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( <span class="hljs-string"><span class="hljs-string">'a'</span></span>, { className: <span class="hljs-string"><span class="hljs-string">'suitup-control'</span></span>, href: <span class="hljs-string"><span class="hljs-string">'#'</span></span> }).attr({ <span class="hljs-string"><span class="hljs-string">'data-command'</span></span>: <span class="hljs-string"><span class="hljs-string">'createlink'</span></span> //         createlink }).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { if( !<span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.hasSelectedNodeParent( <span class="hljs-string"><span class="hljs-string">'a'</span></span> ) ) { document.execCommand( <span class="hljs-string"><span class="hljs-string">'createlink'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, window.prompt( <span class="hljs-string"><span class="hljs-string">'URL:'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span> ) ); } else { document.execCommand( <span class="hljs-string"><span class="hljs-string">'unlink'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor<span class="hljs-symbol"><span class="hljs-symbol">#red</span></span></code> )    : <br>  .   .  , <span class="hljs-comment"><span class="hljs-comment">""</span></span>  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls = [ <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'italic'</span></span> ]; <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp(); //    ,   <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'italic'</span></span> );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls.push( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp();</code> <br>   : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls.concat([ <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp   .  ,            .      ,      ,  . <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelection</b> <br>   .          . <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelection(); //  -,     <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-editor'</span></span> ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.hasSelectedNodeParent</b> <br>  ,      <span class="hljs-comment"><span class="hljs-comment">"link"</span></span>. ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( <span class="hljs-string"><span class="hljs-string">'a'</span></span> ); // <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">false</span></span></code> <br> <br>    <span class="hljs-type"><span class="hljs-type">Chrome</span></span>, <span class="hljs-type"><span class="hljs-type">Firefox</span></span>, <span class="hljs-type"><span class="hljs-type">IE10</span></span> (+<span class="hljs-type"><span class="hljs-type">IE7</span></span> <span class="hljs-type"><span class="hljs-type">Mode</span></span>) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/<span class="hljs-type"><span class="hljs-type">Suitup</span></span></a> <br> <br>   extended-commands.suitup.jquery.js     .    <span class="hljs-number"><span class="hljs-number">50</span></span>        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b><span class="hljs-type"><span class="hljs-type">UPD</span></span></b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> <span class="hljs-number"><span class="hljs-number">1.</span></span>          . ,  bold  <span class="hljs-type"><span class="hljs-type">Chrome</span></span>     b,   <span class="hljs-type"><span class="hljs-type">IE</span></span>   strong. <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>          (      ). <br> <span class="hljs-number"><span class="hljs-number">3.</span></span>    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code></code> </pre> <code><code>, ,     IE,        execCommand( 'formatblock' ... )</code>   .   :     " ",       .   IE...    ?..     <code>queryCommandValue( 'formatblock' )</code>  <code>" 1", " 2", ""</code> , .     , , , ,         .     ,    IE10. ,  ,    IE10!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  SuitUp <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript">$( '.my-textarea' ).suitUp();</code> <br>       : <br> <code class="javascript">$( '.my-textarea' ).suitUp( 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' );</code> <br>       <br> <code class="javascript">$( '.my-textarea' ).suitUp([ 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , 'forecolor',      : <br> <br> 1. ,  :  forecolor    red: <br> <code class="javascript">$.suitUp.commands = { forecolor: 'red' }</code> <br>  <br> <code class="javascript">$.extend( jQuery.suitUp.commands, { forecolor: 'red' })</code> <br>  <br> <code class="javascript">$.suitUp.commands.forecolor = 'red' // ( ,  commands -  )</code> <br> : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> 2.   () <br> <code class="javascript">$.suitUp.commands.forecolor = { 'Make Red': 'red', 'Make Green': 'green' }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> 3. ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( ' ', '' ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript">$( 'textarea' ).suitUp( 'italic', 'bold', '|', 'link', 'formatblock#&lt;h1&gt;' );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> 1.  Bold. <br> 2.  . <br> 3. ,             "". <br> <br>  ,        . <br> <br> <code class="javascript">$.extend( $.suitUp.commands, { bold: null, //   ,        null fontname: { Arial: 'arial', Times: 'times', Verdana: 'verdana' }, forecolor: function( callback ){ var blackBackground = $( '&lt;div/&gt;' ).css({ background: 'black', position: 'absolute', top: 0, left:0, opacity: .5, width: '100%', height: '100%' }).on( 'click', function(){ popup.add( this ).remove(); }).appendTo('body'), popup = $( '&lt;div/&gt;' ).css({ padding: '10px 20px', width: 200, position: 'absolute', background: 'white', top: 200, left: $( window ).width()/2 - 110, zIndex: 100 }).appendTo('body'); $( '&lt;input/&gt;' ).appendTo( popup ); $( '&lt;button/&gt;' ).appendTo( popup ).text( 'Go!' ).on( 'click', function() { var val = popup.children( 'input' ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor' );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . Callback   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( 'forecolor', false, ' ' );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript">$.suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript">$.extend( jQuery.suitUp.custom, { helloWorld: function() { return $( '&lt;span/&gt;', { 'class': 'suitup-control' //    }).css( 'backgroundColor', 'red' ).on( 'click', function() { alert( 'Hello World!' ); }); } });</code> <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor', 'helloWorld' );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       "link",     ( "createlink"),      ( "unlink"). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( 'a', { className: 'suitup-control', href: '#' }).attr({ 'data-command': 'createlink' //         createlink }).on( 'click', function() { if( !$.suitUp.hasSelectedNodeParent( 'a' ) ) { document.execCommand( 'createlink', false, window.prompt( 'URL:', '' ) ); } else { document.execCommand( 'unlink', false, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor#red</code> )    : <br>  .   .  , ""  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript">$.suitUp.controls = [ 'bold', 'italic' ]; $( '.suitup-textarea' ).suitUp(); //    ,   $( '.suitup-textarea' ).suitUp( 'bold', 'italic' );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript">$.suitUp.controls.push( 'forecolor' ); $( '.suitup-textarea' ).suitUp();</code> <br>   : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( $.suitUp.controls.concat([ 'forecolor' ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   $.suitUp   .  ,            .      ,      ,  . <br> <br> <b>$.suitUp.getSelection</b> <br>   .          . <br> <br> <b>$.suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = $.suitUp.getSelection(); //  -,     $( '.suitup-editor' ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b>$.suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b>$.suitUp.hasSelectedNodeParent</b> <br>  ,      "link". ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( 'a' ); // true/false</code> <br> <br>    Chrome, Firefox, IE10 (+IE7 Mode) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/Suitup</a> <br> <br>   extended-commands.suitup.jquery.js     .    50        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b>UPD</b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> 1.          . ,  bold  Chrome     b,   IE   strong. <br> 2.          (      ). <br> 3.    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> <pre> <code class="hljs smalltalk"><code class="javascript"><code>, ,     <span class="hljs-type"><span class="hljs-type">IE</span></span>,        execCommand( <span class="hljs-string"><span class="hljs-string">'formatblock'</span></span> ... )</code>   .   :     <span class="hljs-comment"><span class="hljs-comment">" "</span></span>,       .   <span class="hljs-type"><span class="hljs-type">IE</span></span>...    ?..     <code>queryCommandValue( <span class="hljs-string"><span class="hljs-string">'formatblock'</span></span> )</code>  <code><span class="hljs-comment"><span class="hljs-comment">" 1"</span></span>, <span class="hljs-comment"><span class="hljs-comment">" 2"</span></span>, <span class="hljs-comment"><span class="hljs-comment">""</span></span></code> , .     , , , ,         .     ,    <span class="hljs-type"><span class="hljs-type">IE10</span></span>. ,  ,    <span class="hljs-type"><span class="hljs-type">IE10</span></span>!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  <span class="hljs-type"><span class="hljs-type">SuitUp</span></span> <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp();</code> <br>       : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> );</code> <br>       <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp([ <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>,      : <br> <br> <span class="hljs-number"><span class="hljs-number">1.</span></span> ,  :  forecolor    red: <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands = { forecolor: <span class="hljs-string"><span class="hljs-string">'red'</span></span> }</code> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( jQuery.suitUp.commands, { forecolor: <span class="hljs-string"><span class="hljs-string">'red'</span></span> })</code> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands.forecolor = <span class="hljs-string"><span class="hljs-string">'red'</span></span> // ( ,  commands -  )</code> <br> : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>   () <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands.forecolor = { <span class="hljs-string"><span class="hljs-string">'Make Red'</span></span>: <span class="hljs-string"><span class="hljs-string">'red'</span></span>, <span class="hljs-string"><span class="hljs-string">'Make Green'</span></span>: <span class="hljs-string"><span class="hljs-string">'green'</span></span> }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> <span class="hljs-number"><span class="hljs-number">3.</span></span> ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span> ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'link'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> <span class="hljs-number"><span class="hljs-number">1.</span></span>  <span class="hljs-type"><span class="hljs-type">Bold</span></span>. <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>  . <br> <span class="hljs-number"><span class="hljs-number">3.</span></span> ,             <span class="hljs-comment"><span class="hljs-comment">""</span></span>. <br> <br>  ,        . <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands, { bold: null, //   ,        null fontname: { <span class="hljs-type"><span class="hljs-type">Arial</span></span>: <span class="hljs-string"><span class="hljs-string">'arial'</span></span>, <span class="hljs-type"><span class="hljs-type">Times</span></span>: <span class="hljs-string"><span class="hljs-string">'times'</span></span>, <span class="hljs-type"><span class="hljs-type">Verdana</span></span>: <span class="hljs-string"><span class="hljs-string">'verdana'</span></span> }, forecolor: function( callback ){ var blackBackground = <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;div/&gt;'</span></span> ).css({ background: <span class="hljs-string"><span class="hljs-string">'black'</span></span>, position: <span class="hljs-string"><span class="hljs-string">'absolute'</span></span>, top: <span class="hljs-number"><span class="hljs-number">0</span></span>, left:<span class="hljs-number"><span class="hljs-number">0</span></span>, opacity: <span class="hljs-number"><span class="hljs-number">.5</span></span>, width: <span class="hljs-string"><span class="hljs-string">'100%'</span></span>, height: <span class="hljs-string"><span class="hljs-string">'100%'</span></span> }).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function(){ popup.add( this ).remove(); }).appendTo(<span class="hljs-string"><span class="hljs-string">'body'</span></span>), popup = <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;div/&gt;'</span></span> ).css({ padding: <span class="hljs-string"><span class="hljs-string">'10px 20px'</span></span>, width: <span class="hljs-number"><span class="hljs-number">200</span></span>, position: <span class="hljs-string"><span class="hljs-string">'absolute'</span></span>, background: <span class="hljs-string"><span class="hljs-string">'white'</span></span>, top: <span class="hljs-number"><span class="hljs-number">200</span></span>, left: <span class="hljs-string"><span class="hljs-string">$(</span></span> window ).width()/<span class="hljs-number"><span class="hljs-number">2</span></span> - <span class="hljs-number"><span class="hljs-number">110</span></span>, zIndex: <span class="hljs-number"><span class="hljs-number">100</span></span> }).appendTo(<span class="hljs-string"><span class="hljs-string">'body'</span></span>); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;input/&gt;'</span></span> ).appendTo( popup ); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;button/&gt;'</span></span> ).appendTo( popup ).text( <span class="hljs-string"><span class="hljs-string">'Go!'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { var val = popup.children( <span class="hljs-string"><span class="hljs-string">'input'</span></span> ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'fontname'</span></span>, <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . <span class="hljs-type"><span class="hljs-type">Callback</span></span>   ,  ,        forecolor  . <br> <br> document.execCommand( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span> ); <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( jQuery.suitUp.custom, { helloWorld: function() { return <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;span/&gt;'</span></span>, { <span class="hljs-string"><span class="hljs-string">'class'</span></span>: <span class="hljs-string"><span class="hljs-string">'suitup-control'</span></span> //    }).css( <span class="hljs-string"><span class="hljs-string">'backgroundColor'</span></span>, <span class="hljs-string"><span class="hljs-string">'red'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { alert( <span class="hljs-string"><span class="hljs-string">'Hello World!'</span></span> ); }); } });</code> <br> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'fontname'</span></span>, <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>, <span class="hljs-string"><span class="hljs-string">'helloWorld'</span></span> );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       <span class="hljs-comment"><span class="hljs-comment">"link"</span></span>,     ( <span class="hljs-comment"><span class="hljs-comment">"createlink"</span></span>),      ( <span class="hljs-comment"><span class="hljs-comment">"unlink"</span></span>). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( <span class="hljs-string"><span class="hljs-string">'a'</span></span>, { className: <span class="hljs-string"><span class="hljs-string">'suitup-control'</span></span>, href: <span class="hljs-string"><span class="hljs-string">'#'</span></span> }).attr({ <span class="hljs-string"><span class="hljs-string">'data-command'</span></span>: <span class="hljs-string"><span class="hljs-string">'createlink'</span></span> //         createlink }).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { if( !<span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.hasSelectedNodeParent( <span class="hljs-string"><span class="hljs-string">'a'</span></span> ) ) { document.execCommand( <span class="hljs-string"><span class="hljs-string">'createlink'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, window.prompt( <span class="hljs-string"><span class="hljs-string">'URL:'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span> ) ); } else { document.execCommand( <span class="hljs-string"><span class="hljs-string">'unlink'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor<span class="hljs-symbol"><span class="hljs-symbol">#red</span></span></code> )    : <br>  .   .  , <span class="hljs-comment"><span class="hljs-comment">""</span></span>  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls = [ <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'italic'</span></span> ]; <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp(); //    ,   <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'italic'</span></span> );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls.push( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp();</code> <br>   : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls.concat([ <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp   .  ,            .      ,      ,  . <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelection</b> <br>   .          . <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelection(); //  -,     <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-editor'</span></span> ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.hasSelectedNodeParent</b> <br>  ,      <span class="hljs-comment"><span class="hljs-comment">"link"</span></span>. ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( <span class="hljs-string"><span class="hljs-string">'a'</span></span> ); // <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">false</span></span></code> <br> <br>    <span class="hljs-type"><span class="hljs-type">Chrome</span></span>, <span class="hljs-type"><span class="hljs-type">Firefox</span></span>, <span class="hljs-type"><span class="hljs-type">IE10</span></span> (+<span class="hljs-type"><span class="hljs-type">IE7</span></span> <span class="hljs-type"><span class="hljs-type">Mode</span></span>) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/<span class="hljs-type"><span class="hljs-type">Suitup</span></span></a> <br> <br>   extended-commands.suitup.jquery.js     .    <span class="hljs-number"><span class="hljs-number">50</span></span>        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b><span class="hljs-type"><span class="hljs-type">UPD</span></span></b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> <span class="hljs-number"><span class="hljs-number">1.</span></span>          . ,  bold  <span class="hljs-type"><span class="hljs-type">Chrome</span></span>     b,   <span class="hljs-type"><span class="hljs-type">IE</span></span>   strong. <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>          (      ). <br> <span class="hljs-number"><span class="hljs-number">3.</span></span>    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code></code> </pre> <code><code>, ,     IE,        execCommand( 'formatblock' ... )</code>   .   :     " ",       .   IE...    ?..     <code>queryCommandValue( 'formatblock' )</code>  <code>" 1", " 2", ""</code> , .     , , , ,         .     ,    IE10. ,  ,    IE10!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  SuitUp <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript">$( '.my-textarea' ).suitUp();</code> <br>       : <br> <code class="javascript">$( '.my-textarea' ).suitUp( 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' );</code> <br>       <br> <code class="javascript">$( '.my-textarea' ).suitUp([ 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , 'forecolor',      : <br> <br> 1. ,  :  forecolor    red: <br> <code class="javascript">$.suitUp.commands = { forecolor: 'red' }</code> <br>  <br> <code class="javascript">$.extend( jQuery.suitUp.commands, { forecolor: 'red' })</code> <br>  <br> <code class="javascript">$.suitUp.commands.forecolor = 'red' // ( ,  commands -  )</code> <br> : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> 2.   () <br> <code class="javascript">$.suitUp.commands.forecolor = { 'Make Red': 'red', 'Make Green': 'green' }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> 3. ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( ' ', '' ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript">$( 'textarea' ).suitUp( 'italic', 'bold', '|', 'link', 'formatblock#&lt;h1&gt;' );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> 1.  Bold. <br> 2.  . <br> 3. ,             "". <br> <br>  ,        . <br> <br> <code class="javascript">$.extend( $.suitUp.commands, { bold: null, //   ,        null fontname: { Arial: 'arial', Times: 'times', Verdana: 'verdana' }, forecolor: function( callback ){ var blackBackground = $( '&lt;div/&gt;' ).css({ background: 'black', position: 'absolute', top: 0, left:0, opacity: .5, width: '100%', height: '100%' }).on( 'click', function(){ popup.add( this ).remove(); }).appendTo('body'), popup = $( '&lt;div/&gt;' ).css({ padding: '10px 20px', width: 200, position: 'absolute', background: 'white', top: 200, left: $( window ).width()/2 - 110, zIndex: 100 }).appendTo('body'); $( '&lt;input/&gt;' ).appendTo( popup ); $( '&lt;button/&gt;' ).appendTo( popup ).text( 'Go!' ).on( 'click', function() { var val = popup.children( 'input' ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor' );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . Callback   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( 'forecolor', false, ' ' );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript">$.suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript">$.extend( jQuery.suitUp.custom, { helloWorld: function() { return $( '&lt;span/&gt;', { 'class': 'suitup-control' //    }).css( 'backgroundColor', 'red' ).on( 'click', function() { alert( 'Hello World!' ); }); } });</code> <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor', 'helloWorld' );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       "link",     ( "createlink"),      ( "unlink"). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( 'a', { className: 'suitup-control', href: '#' }).attr({ 'data-command': 'createlink' //         createlink }).on( 'click', function() { if( !$.suitUp.hasSelectedNodeParent( 'a' ) ) { document.execCommand( 'createlink', false, window.prompt( 'URL:', '' ) ); } else { document.execCommand( 'unlink', false, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor#red</code> )    : <br>  .   .  , ""  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript">$.suitUp.controls = [ 'bold', 'italic' ]; $( '.suitup-textarea' ).suitUp(); //    ,   $( '.suitup-textarea' ).suitUp( 'bold', 'italic' );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript">$.suitUp.controls.push( 'forecolor' ); $( '.suitup-textarea' ).suitUp();</code> <br>   : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( $.suitUp.controls.concat([ 'forecolor' ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   $.suitUp   .  ,            .      ,      ,  . <br> <br> <b>$.suitUp.getSelection</b> <br>   .          . <br> <br> <b>$.suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = $.suitUp.getSelection(); //  -,     $( '.suitup-editor' ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b>$.suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b>$.suitUp.hasSelectedNodeParent</b> <br>  ,      "link". ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( 'a' ); // true/false</code> <br> <br>    Chrome, Firefox, IE10 (+IE7 Mode) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/Suitup</a> <br> <br>   extended-commands.suitup.jquery.js     .    50        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b>UPD</b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> 1.          . ,  bold  Chrome     b,   IE   strong. <br> 2.          (      ). <br> 3.    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> <h5> <code><code>, ,     IE,        execCommand( 'formatblock' ... )</code>   .   :     " ",       .   IE...    ?..     <code>queryCommandValue( 'formatblock' )</code>  <code>" 1", " 2", ""</code> , .     , , , ,         .     ,    IE10. ,  ,    IE10!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  SuitUp <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript">$( '.my-textarea' ).suitUp();</code> <br>       : <br> <code class="javascript">$( '.my-textarea' ).suitUp( 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' );</code> <br>       <br> <code class="javascript">$( '.my-textarea' ).suitUp([ 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , 'forecolor',      : <br> <br> 1. ,  :  forecolor    red: <br> <code class="javascript">$.suitUp.commands = { forecolor: 'red' }</code> <br>  <br> <code class="javascript">$.extend( jQuery.suitUp.commands, { forecolor: 'red' })</code> <br>  <br> <code class="javascript">$.suitUp.commands.forecolor = 'red' // ( ,  commands -  )</code> <br> : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> 2.   () <br> <code class="javascript">$.suitUp.commands.forecolor = { 'Make Red': 'red', 'Make Green': 'green' }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> 3. ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( ' ', '' ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript">$( 'textarea' ).suitUp( 'italic', 'bold', '|', 'link', 'formatblock#&lt;h1&gt;' );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> 1.  Bold. <br> 2.  . <br> 3. ,             "". <br> <br>  ,        . <br> <br> <code class="javascript">$.extend( $.suitUp.commands, { bold: null, //   ,        null fontname: { Arial: 'arial', Times: 'times', Verdana: 'verdana' }, forecolor: function( callback ){ var blackBackground = $( '&lt;div/&gt;' ).css({ background: 'black', position: 'absolute', top: 0, left:0, opacity: .5, width: '100%', height: '100%' }).on( 'click', function(){ popup.add( this ).remove(); }).appendTo('body'), popup = $( '&lt;div/&gt;' ).css({ padding: '10px 20px', width: 200, position: 'absolute', background: 'white', top: 200, left: $( window ).width()/2 - 110, zIndex: 100 }).appendTo('body'); $( '&lt;input/&gt;' ).appendTo( popup ); $( '&lt;button/&gt;' ).appendTo( popup ).text( 'Go!' ).on( 'click', function() { var val = popup.children( 'input' ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor' );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . Callback   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( 'forecolor', false, ' ' );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript">$.suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript">$.extend( jQuery.suitUp.custom, { helloWorld: function() { return $( '&lt;span/&gt;', { 'class': 'suitup-control' //    }).css( 'backgroundColor', 'red' ).on( 'click', function() { alert( 'Hello World!' ); }); } });</code> <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor', 'helloWorld' );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       "link",     ( "createlink"),      ( "unlink"). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( 'a', { className: 'suitup-control', href: '#' }).attr({ 'data-command': 'createlink' //         createlink }).on( 'click', function() { if( !$.suitUp.hasSelectedNodeParent( 'a' ) ) { document.execCommand( 'createlink', false, window.prompt( 'URL:', '' ) ); } else { document.execCommand( 'unlink', false, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor#red</code> )    : <br>  .   .  , ""  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript">$.suitUp.controls = [ 'bold', 'italic' ]; $( '.suitup-textarea' ).suitUp(); //    ,   $( '.suitup-textarea' ).suitUp( 'bold', 'italic' );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript">$.suitUp.controls.push( 'forecolor' ); $( '.suitup-textarea' ).suitUp();</code> <br>   : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( $.suitUp.controls.concat([ 'forecolor' ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   $.suitUp   .  ,            .      ,      ,  . <br> <br> <b>$.suitUp.getSelection</b> <br>   .          . <br> <br> <b>$.suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = $.suitUp.getSelection(); //  -,     $( '.suitup-editor' ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b>$.suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b>$.suitUp.hasSelectedNodeParent</b> <br>  ,      "link". ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( 'a' ); // true/false</code> <br> <br>    Chrome, Firefox, IE10 (+IE7 Mode) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/Suitup</a> <br> <br>   extended-commands.suitup.jquery.js     .    50        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b>UPD</b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> 1.          . ,  bold  Chrome     b,   IE   strong. <br> 2.          (      ). <br> 3.    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> </h5> <code><code>, ,     IE,        execCommand( 'formatblock' ... )</code>   .   :     " ",       .   IE...    ?..     <code>queryCommandValue( 'formatblock' )</code>  <code>" 1", " 2", ""</code> , .     , , , ,         .     ,    IE10. ,  ,    IE10!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  SuitUp <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript">$( '.my-textarea' ).suitUp();</code> <br>       : <br> <code class="javascript">$( '.my-textarea' ).suitUp( 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' );</code> <br>       <br> <code class="javascript">$( '.my-textarea' ).suitUp([ 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , 'forecolor',      : <br> <br> 1. ,  :  forecolor    red: <br> <code class="javascript">$.suitUp.commands = { forecolor: 'red' }</code> <br>  <br> <code class="javascript">$.extend( jQuery.suitUp.commands, { forecolor: 'red' })</code> <br>  <br> <code class="javascript">$.suitUp.commands.forecolor = 'red' // ( ,  commands -  )</code> <br> : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> 2.   () <br> <code class="javascript">$.suitUp.commands.forecolor = { 'Make Red': 'red', 'Make Green': 'green' }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> 3. ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( ' ', '' ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript">$( 'textarea' ).suitUp( 'italic', 'bold', '|', 'link', 'formatblock#&lt;h1&gt;' );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> 1.  Bold. <br> 2.  . <br> 3. ,             "". <br> <br>  ,        . <br> <br> <code class="javascript">$.extend( $.suitUp.commands, { bold: null, //   ,        null fontname: { Arial: 'arial', Times: 'times', Verdana: 'verdana' }, forecolor: function( callback ){ var blackBackground = $( '&lt;div/&gt;' ).css({ background: 'black', position: 'absolute', top: 0, left:0, opacity: .5, width: '100%', height: '100%' }).on( 'click', function(){ popup.add( this ).remove(); }).appendTo('body'), popup = $( '&lt;div/&gt;' ).css({ padding: '10px 20px', width: 200, position: 'absolute', background: 'white', top: 200, left: $( window ).width()/2 - 110, zIndex: 100 }).appendTo('body'); $( '&lt;input/&gt;' ).appendTo( popup ); $( '&lt;button/&gt;' ).appendTo( popup ).text( 'Go!' ).on( 'click', function() { var val = popup.children( 'input' ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor' );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . Callback   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( 'forecolor', false, ' ' );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript">$.suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript">$.extend( jQuery.suitUp.custom, { helloWorld: function() { return $( '&lt;span/&gt;', { 'class': 'suitup-control' //    }).css( 'backgroundColor', 'red' ).on( 'click', function() { alert( 'Hello World!' ); }); } });</code> <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor', 'helloWorld' );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       "link",     ( "createlink"),      ( "unlink"). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( 'a', { className: 'suitup-control', href: '#' }).attr({ 'data-command': 'createlink' //         createlink }).on( 'click', function() { if( !$.suitUp.hasSelectedNodeParent( 'a' ) ) { document.execCommand( 'createlink', false, window.prompt( 'URL:', '' ) ); } else { document.execCommand( 'unlink', false, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor#red</code> )    : <br>  .   .  , ""  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript">$.suitUp.controls = [ 'bold', 'italic' ]; $( '.suitup-textarea' ).suitUp(); //    ,   $( '.suitup-textarea' ).suitUp( 'bold', 'italic' );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript">$.suitUp.controls.push( 'forecolor' ); $( '.suitup-textarea' ).suitUp();</code> <br>   : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( $.suitUp.controls.concat([ 'forecolor' ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   $.suitUp   .  ,            .      ,      ,  . <br> <br> <b>$.suitUp.getSelection</b> <br>   .          . <br> <br> <b>$.suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = $.suitUp.getSelection(); //  -,     $( '.suitup-editor' ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b>$.suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b>$.suitUp.hasSelectedNodeParent</b> <br>  ,      "link". ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( 'a' ); // true/false</code> <br> <br>    Chrome, Firefox, IE10 (+IE7 Mode) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/Suitup</a> <br> <br>   extended-commands.suitup.jquery.js     .    50        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b>UPD</b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> 1.          . ,  bold  Chrome     b,   IE   strong. <br> 2.          (      ). <br> 3.    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> <pre> <code class="hljs smalltalk"><code class="javascript"><code>, ,     <span class="hljs-type"><span class="hljs-type">IE</span></span>,        execCommand( <span class="hljs-string"><span class="hljs-string">'formatblock'</span></span> ... )</code>   .   :     <span class="hljs-comment"><span class="hljs-comment">" "</span></span>,       .   <span class="hljs-type"><span class="hljs-type">IE</span></span>...    ?..     <code>queryCommandValue( <span class="hljs-string"><span class="hljs-string">'formatblock'</span></span> )</code>  <code><span class="hljs-comment"><span class="hljs-comment">" 1"</span></span>, <span class="hljs-comment"><span class="hljs-comment">" 2"</span></span>, <span class="hljs-comment"><span class="hljs-comment">""</span></span></code> , .     , , , ,         .     ,    <span class="hljs-type"><span class="hljs-type">IE10</span></span>. ,  ,    <span class="hljs-type"><span class="hljs-type">IE10</span></span>!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  <span class="hljs-type"><span class="hljs-type">SuitUp</span></span> <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp();</code> <br>       : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> );</code> <br>       <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp([ <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>,      : <br> <br> <span class="hljs-number"><span class="hljs-number">1.</span></span> ,  :  forecolor    red: <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands = { forecolor: <span class="hljs-string"><span class="hljs-string">'red'</span></span> }</code> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( jQuery.suitUp.commands, { forecolor: <span class="hljs-string"><span class="hljs-string">'red'</span></span> })</code> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands.forecolor = <span class="hljs-string"><span class="hljs-string">'red'</span></span> // ( ,  commands -  )</code> <br> : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>   () <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands.forecolor = { <span class="hljs-string"><span class="hljs-string">'Make Red'</span></span>: <span class="hljs-string"><span class="hljs-string">'red'</span></span>, <span class="hljs-string"><span class="hljs-string">'Make Green'</span></span>: <span class="hljs-string"><span class="hljs-string">'green'</span></span> }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> <span class="hljs-number"><span class="hljs-number">3.</span></span> ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span> ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'link'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> <span class="hljs-number"><span class="hljs-number">1.</span></span>  <span class="hljs-type"><span class="hljs-type">Bold</span></span>. <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>  . <br> <span class="hljs-number"><span class="hljs-number">3.</span></span> ,             <span class="hljs-comment"><span class="hljs-comment">""</span></span>. <br> <br>  ,        . <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands, { bold: null, //   ,        null fontname: { <span class="hljs-type"><span class="hljs-type">Arial</span></span>: <span class="hljs-string"><span class="hljs-string">'arial'</span></span>, <span class="hljs-type"><span class="hljs-type">Times</span></span>: <span class="hljs-string"><span class="hljs-string">'times'</span></span>, <span class="hljs-type"><span class="hljs-type">Verdana</span></span>: <span class="hljs-string"><span class="hljs-string">'verdana'</span></span> }, forecolor: function( callback ){ var blackBackground = <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;div/&gt;'</span></span> ).css({ background: <span class="hljs-string"><span class="hljs-string">'black'</span></span>, position: <span class="hljs-string"><span class="hljs-string">'absolute'</span></span>, top: <span class="hljs-number"><span class="hljs-number">0</span></span>, left:<span class="hljs-number"><span class="hljs-number">0</span></span>, opacity: <span class="hljs-number"><span class="hljs-number">.5</span></span>, width: <span class="hljs-string"><span class="hljs-string">'100%'</span></span>, height: <span class="hljs-string"><span class="hljs-string">'100%'</span></span> }).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function(){ popup.add( this ).remove(); }).appendTo(<span class="hljs-string"><span class="hljs-string">'body'</span></span>), popup = <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;div/&gt;'</span></span> ).css({ padding: <span class="hljs-string"><span class="hljs-string">'10px 20px'</span></span>, width: <span class="hljs-number"><span class="hljs-number">200</span></span>, position: <span class="hljs-string"><span class="hljs-string">'absolute'</span></span>, background: <span class="hljs-string"><span class="hljs-string">'white'</span></span>, top: <span class="hljs-number"><span class="hljs-number">200</span></span>, left: <span class="hljs-string"><span class="hljs-string">$(</span></span> window ).width()/<span class="hljs-number"><span class="hljs-number">2</span></span> - <span class="hljs-number"><span class="hljs-number">110</span></span>, zIndex: <span class="hljs-number"><span class="hljs-number">100</span></span> }).appendTo(<span class="hljs-string"><span class="hljs-string">'body'</span></span>); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;input/&gt;'</span></span> ).appendTo( popup ); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;button/&gt;'</span></span> ).appendTo( popup ).text( <span class="hljs-string"><span class="hljs-string">'Go!'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { var val = popup.children( <span class="hljs-string"><span class="hljs-string">'input'</span></span> ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'fontname'</span></span>, <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . <span class="hljs-type"><span class="hljs-type">Callback</span></span>   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span> );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.custom = {}; <br>  ,         . <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( jQuery.suitUp.custom, { helloWorld: function() { return <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;span/&gt;'</span></span>, { <span class="hljs-string"><span class="hljs-string">'class'</span></span>: <span class="hljs-string"><span class="hljs-string">'suitup-control'</span></span> //    }).css( <span class="hljs-string"><span class="hljs-string">'backgroundColor'</span></span>, <span class="hljs-string"><span class="hljs-string">'red'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { alert( <span class="hljs-string"><span class="hljs-string">'Hello World!'</span></span> ); }); } });</code> <br> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'fontname'</span></span>, <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>, <span class="hljs-string"><span class="hljs-string">'helloWorld'</span></span> );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       <span class="hljs-comment"><span class="hljs-comment">"link"</span></span>,     ( <span class="hljs-comment"><span class="hljs-comment">"createlink"</span></span>),      ( <span class="hljs-comment"><span class="hljs-comment">"unlink"</span></span>). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( <span class="hljs-string"><span class="hljs-string">'a'</span></span>, { className: <span class="hljs-string"><span class="hljs-string">'suitup-control'</span></span>, href: <span class="hljs-string"><span class="hljs-string">'#'</span></span> }).attr({ <span class="hljs-string"><span class="hljs-string">'data-command'</span></span>: <span class="hljs-string"><span class="hljs-string">'createlink'</span></span> //         createlink }).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { if( !<span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.hasSelectedNodeParent( <span class="hljs-string"><span class="hljs-string">'a'</span></span> ) ) { document.execCommand( <span class="hljs-string"><span class="hljs-string">'createlink'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, window.prompt( <span class="hljs-string"><span class="hljs-string">'URL:'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span> ) ); } else { document.execCommand( <span class="hljs-string"><span class="hljs-string">'unlink'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor<span class="hljs-symbol"><span class="hljs-symbol">#red</span></span></code> )    : <br>  .   .  , <span class="hljs-comment"><span class="hljs-comment">""</span></span>  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls = [ <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'italic'</span></span> ]; <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp(); //    ,   <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'italic'</span></span> );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls.push( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp();</code> <br>   : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls.concat([ <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp   .  ,            .      ,      ,  . <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelection</b> <br>   .          . <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelection(); //  -,     <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-editor'</span></span> ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.hasSelectedNodeParent</b> <br>  ,      <span class="hljs-comment"><span class="hljs-comment">"link"</span></span>. ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( <span class="hljs-string"><span class="hljs-string">'a'</span></span> ); // <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">false</span></span></code> <br> <br>    <span class="hljs-type"><span class="hljs-type">Chrome</span></span>, <span class="hljs-type"><span class="hljs-type">Firefox</span></span>, <span class="hljs-type"><span class="hljs-type">IE10</span></span> (+<span class="hljs-type"><span class="hljs-type">IE7</span></span> <span class="hljs-type"><span class="hljs-type">Mode</span></span>) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/<span class="hljs-type"><span class="hljs-type">Suitup</span></span></a> <br> <br>   extended-commands.suitup.jquery.js     .    <span class="hljs-number"><span class="hljs-number">50</span></span>        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b><span class="hljs-type"><span class="hljs-type">UPD</span></span></b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> <span class="hljs-number"><span class="hljs-number">1.</span></span>          . ,  bold  <span class="hljs-type"><span class="hljs-type">Chrome</span></span>     b,   <span class="hljs-type"><span class="hljs-type">IE</span></span>   strong. <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>          (      ). <br> <span class="hljs-number"><span class="hljs-number">3.</span></span>    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code></code> </pre> <code><code>, ,     IE,        execCommand( 'formatblock' ... )</code>   .   :     " ",       .   IE...    ?..     <code>queryCommandValue( 'formatblock' )</code>  <code>" 1", " 2", ""</code> , .     , , , ,         .     ,    IE10. ,  ,    IE10!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  SuitUp <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript">$( '.my-textarea' ).suitUp();</code> <br>       : <br> <code class="javascript">$( '.my-textarea' ).suitUp( 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' );</code> <br>       <br> <code class="javascript">$( '.my-textarea' ).suitUp([ 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , 'forecolor',      : <br> <br> 1. ,  :  forecolor    red: <br> <code class="javascript">$.suitUp.commands = { forecolor: 'red' }</code> <br>  <br> <code class="javascript">$.extend( jQuery.suitUp.commands, { forecolor: 'red' })</code> <br>  <br> <code class="javascript">$.suitUp.commands.forecolor = 'red' // ( ,  commands -  )</code> <br> : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> 2.   () <br> <code class="javascript">$.suitUp.commands.forecolor = { 'Make Red': 'red', 'Make Green': 'green' }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> 3. ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( ' ', '' ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript">$( 'textarea' ).suitUp( 'italic', 'bold', '|', 'link', 'formatblock#&lt;h1&gt;' );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> 1.  Bold. <br> 2.  . <br> 3. ,             "". <br> <br>  ,        . <br> <br> <code class="javascript">$.extend( $.suitUp.commands, { bold: null, //   ,        null fontname: { Arial: 'arial', Times: 'times', Verdana: 'verdana' }, forecolor: function( callback ){ var blackBackground = $( '&lt;div/&gt;' ).css({ background: 'black', position: 'absolute', top: 0, left:0, opacity: .5, width: '100%', height: '100%' }).on( 'click', function(){ popup.add( this ).remove(); }).appendTo('body'), popup = $( '&lt;div/&gt;' ).css({ padding: '10px 20px', width: 200, position: 'absolute', background: 'white', top: 200, left: $( window ).width()/2 - 110, zIndex: 100 }).appendTo('body'); $( '&lt;input/&gt;' ).appendTo( popup ); $( '&lt;button/&gt;' ).appendTo( popup ).text( 'Go!' ).on( 'click', function() { var val = popup.children( 'input' ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor' );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . Callback   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( 'forecolor', false, ' ' );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript">$.suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript">$.extend( jQuery.suitUp.custom, { helloWorld: function() { return $( '&lt;span/&gt;', { 'class': 'suitup-control' //    }).css( 'backgroundColor', 'red' ).on( 'click', function() { alert( 'Hello World!' ); }); } });</code> <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor', 'helloWorld' );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       "link",     ( "createlink"),      ( "unlink"). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( 'a', { className: 'suitup-control', href: '#' }).attr({ 'data-command': 'createlink' //         createlink }).on( 'click', function() { if( !$.suitUp.hasSelectedNodeParent( 'a' ) ) { document.execCommand( 'createlink', false, window.prompt( 'URL:', '' ) ); } else { document.execCommand( 'unlink', false, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor#red</code> )    : <br>  .   .  , ""  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript">$.suitUp.controls = [ 'bold', 'italic' ]; $( '.suitup-textarea' ).suitUp(); //    ,   $( '.suitup-textarea' ).suitUp( 'bold', 'italic' );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript">$.suitUp.controls.push( 'forecolor' ); $( '.suitup-textarea' ).suitUp();</code> <br>   : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( $.suitUp.controls.concat([ 'forecolor' ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   $.suitUp   .  ,            .      ,      ,  . <br> <br> <b>$.suitUp.getSelection</b> <br>   .          . <br> <br> <b>$.suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = $.suitUp.getSelection(); //  -,     $( '.suitup-editor' ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b>$.suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b>$.suitUp.hasSelectedNodeParent</b> <br>  ,      "link". ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( 'a' ); // true/false</code> <br> <br>    Chrome, Firefox, IE10 (+IE7 Mode) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/Suitup</a> <br> <br>   extended-commands.suitup.jquery.js     .    50        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b>UPD</b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> 1.          . ,  bold  Chrome     b,   IE   strong. <br> 2.          (      ). <br> 3.    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> <pre> <code class="hljs smalltalk"><code>, ,     <span class="hljs-type"><span class="hljs-type">IE</span></span>,        execCommand( <span class="hljs-string"><span class="hljs-string">'formatblock'</span></span> ... )</code>   .   :     <span class="hljs-comment"><span class="hljs-comment">" "</span></span>,       .   <span class="hljs-type"><span class="hljs-type">IE</span></span>...    ?..     <code>queryCommandValue( <span class="hljs-string"><span class="hljs-string">'formatblock'</span></span> )</code>  <code><span class="hljs-comment"><span class="hljs-comment">" 1"</span></span>, <span class="hljs-comment"><span class="hljs-comment">" 2"</span></span>, <span class="hljs-comment"><span class="hljs-comment">""</span></span></code> , .     , , , ,         .     ,    <span class="hljs-type"><span class="hljs-type">IE10</span></span>. ,  ,    <span class="hljs-type"><span class="hljs-type">IE10</span></span>!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  <span class="hljs-type"><span class="hljs-type">SuitUp</span></span> <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp();</code> <br>       : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> );</code> <br>       <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp([ <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>,      : <br> <br> <span class="hljs-number"><span class="hljs-number">1.</span></span> ,  :  forecolor    red: <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands = { forecolor: <span class="hljs-string"><span class="hljs-string">'red'</span></span> }</code> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( jQuery.suitUp.commands, { forecolor: <span class="hljs-string"><span class="hljs-string">'red'</span></span> })</code> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands.forecolor = <span class="hljs-string"><span class="hljs-string">'red'</span></span> // ( ,  commands -  )</code> <br> : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>   () <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands.forecolor = { <span class="hljs-string"><span class="hljs-string">'Make Red'</span></span>: <span class="hljs-string"><span class="hljs-string">'red'</span></span>, <span class="hljs-string"><span class="hljs-string">'Make Green'</span></span>: <span class="hljs-string"><span class="hljs-string">'green'</span></span> }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> <span class="hljs-number"><span class="hljs-number">3.</span></span> ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span> ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'link'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> <span class="hljs-number"><span class="hljs-number">1.</span></span>  <span class="hljs-type"><span class="hljs-type">Bold</span></span>. <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>  . <br> <span class="hljs-number"><span class="hljs-number">3.</span></span> ,             <span class="hljs-comment"><span class="hljs-comment">""</span></span>. <br> <br>  ,        . <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands, { bold: null, //   ,        null fontname: { <span class="hljs-type"><span class="hljs-type">Arial</span></span>: <span class="hljs-string"><span class="hljs-string">'arial'</span></span>, <span class="hljs-type"><span class="hljs-type">Times</span></span>: <span class="hljs-string"><span class="hljs-string">'times'</span></span>, <span class="hljs-type"><span class="hljs-type">Verdana</span></span>: <span class="hljs-string"><span class="hljs-string">'verdana'</span></span> }, forecolor: function( callback ){ var blackBackground = <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;div/&gt;'</span></span> ).css({ background: <span class="hljs-string"><span class="hljs-string">'black'</span></span>, position: <span class="hljs-string"><span class="hljs-string">'absolute'</span></span>, top: <span class="hljs-number"><span class="hljs-number">0</span></span>, left:<span class="hljs-number"><span class="hljs-number">0</span></span>, opacity: <span class="hljs-number"><span class="hljs-number">.5</span></span>, width: <span class="hljs-string"><span class="hljs-string">'100%'</span></span>, height: <span class="hljs-string"><span class="hljs-string">'100%'</span></span> }).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function(){ popup.add( this ).remove(); }).appendTo(<span class="hljs-string"><span class="hljs-string">'body'</span></span>), popup = <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;div/&gt;'</span></span> ).css({ padding: <span class="hljs-string"><span class="hljs-string">'10px 20px'</span></span>, width: <span class="hljs-number"><span class="hljs-number">200</span></span>, position: <span class="hljs-string"><span class="hljs-string">'absolute'</span></span>, background: <span class="hljs-string"><span class="hljs-string">'white'</span></span>, top: <span class="hljs-number"><span class="hljs-number">200</span></span>, left: <span class="hljs-string"><span class="hljs-string">$(</span></span> window ).width()/<span class="hljs-number"><span class="hljs-number">2</span></span> - <span class="hljs-number"><span class="hljs-number">110</span></span>, zIndex: <span class="hljs-number"><span class="hljs-number">100</span></span> }).appendTo(<span class="hljs-string"><span class="hljs-string">'body'</span></span>); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;input/&gt;'</span></span> ).appendTo( popup ); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;button/&gt;'</span></span> ).appendTo( popup ).text( <span class="hljs-string"><span class="hljs-string">'Go!'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { var val = popup.children( <span class="hljs-string"><span class="hljs-string">'input'</span></span> ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'fontname'</span></span>, <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . <span class="hljs-type"><span class="hljs-type">Callback</span></span>   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span> );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( jQuery.suitUp.custom, { helloWorld: function() { return <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;span/&gt;'</span></span>, { <span class="hljs-string"><span class="hljs-string">'class'</span></span>: <span class="hljs-string"><span class="hljs-string">'suitup-control'</span></span> //    }).css( <span class="hljs-string"><span class="hljs-string">'backgroundColor'</span></span>, <span class="hljs-string"><span class="hljs-string">'red'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { alert( <span class="hljs-string"><span class="hljs-string">'Hello World!'</span></span> ); }); } });</code> <br> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'fontname'</span></span>, <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>, <span class="hljs-string"><span class="hljs-string">'helloWorld'</span></span> );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       <span class="hljs-comment"><span class="hljs-comment">"link"</span></span>,     ( <span class="hljs-comment"><span class="hljs-comment">"createlink"</span></span>),      ( <span class="hljs-comment"><span class="hljs-comment">"unlink"</span></span>). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( <span class="hljs-string"><span class="hljs-string">'a'</span></span>, { className: <span class="hljs-string"><span class="hljs-string">'suitup-control'</span></span>, href: <span class="hljs-string"><span class="hljs-string">'#'</span></span> }).attr({ <span class="hljs-string"><span class="hljs-string">'data-command'</span></span>: <span class="hljs-string"><span class="hljs-string">'createlink'</span></span> //         createlink }).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { if( !<span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.hasSelectedNodeParent( <span class="hljs-string"><span class="hljs-string">'a'</span></span> ) ) { document.execCommand( <span class="hljs-string"><span class="hljs-string">'createlink'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, window.prompt( <span class="hljs-string"><span class="hljs-string">'URL:'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span> ) ); } else { document.execCommand( <span class="hljs-string"><span class="hljs-string">'unlink'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor<span class="hljs-symbol"><span class="hljs-symbol">#red</span></span></code> )    : <br>  .   .  , <span class="hljs-comment"><span class="hljs-comment">""</span></span>  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls = [ <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'italic'</span></span> ]; <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp(); //    ,   <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'italic'</span></span> );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls.push( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp();</code> <br>   : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls.concat([ <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp   .  ,            .      ,      ,  . <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelection</b> <br>   .          . <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelection(); //  -,     <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-editor'</span></span> ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.hasSelectedNodeParent</b> <br>  ,      <span class="hljs-comment"><span class="hljs-comment">"link"</span></span>. ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( <span class="hljs-string"><span class="hljs-string">'a'</span></span> ); // <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">false</span></span></code> <br> <br>    <span class="hljs-type"><span class="hljs-type">Chrome</span></span>, <span class="hljs-type"><span class="hljs-type">Firefox</span></span>, <span class="hljs-type"><span class="hljs-type">IE10</span></span> (+<span class="hljs-type"><span class="hljs-type">IE7</span></span> <span class="hljs-type"><span class="hljs-type">Mode</span></span>) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/<span class="hljs-type"><span class="hljs-type">Suitup</span></span></a> <br> <br>   extended-commands.suitup.jquery.js     .    <span class="hljs-number"><span class="hljs-number">50</span></span>        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b><span class="hljs-type"><span class="hljs-type">UPD</span></span></b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> <span class="hljs-number"><span class="hljs-number">1.</span></span>          . ,  bold  <span class="hljs-type"><span class="hljs-type">Chrome</span></span>     b,   <span class="hljs-type"><span class="hljs-type">IE</span></span>   strong. <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>          (      ). <br> <span class="hljs-number"><span class="hljs-number">3.</span></span>    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> </pre> <code><code>, ,     IE,        execCommand( 'formatblock' ... )</code>   .   :     " ",       .   IE...    ?..     <code>queryCommandValue( 'formatblock' )</code>  <code>" 1", " 2", ""</code> , .     , , , ,         .     ,    IE10. ,  ,    IE10!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  SuitUp <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript">$( '.my-textarea' ).suitUp();</code> <br>       : <br> <code class="javascript">$( '.my-textarea' ).suitUp( 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' );</code> <br>       <br> <code class="javascript">$( '.my-textarea' ).suitUp([ 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , 'forecolor',      : <br> <br> 1. ,  :  forecolor    red: <br> <code class="javascript">$.suitUp.commands = { forecolor: 'red' }</code> <br>  <br> <code class="javascript">$.extend( jQuery.suitUp.commands, { forecolor: 'red' })</code> <br>  <br> <code class="javascript">$.suitUp.commands.forecolor = 'red' // ( ,  commands -  )</code> <br> : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> 2.   () <br> <code class="javascript">$.suitUp.commands.forecolor = { 'Make Red': 'red', 'Make Green': 'green' }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> 3. ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( ' ', '' ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript">$( 'textarea' ).suitUp( 'italic', 'bold', '|', 'link', 'formatblock#&lt;h1&gt;' );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> 1.  Bold. <br> 2.  . <br> 3. ,             "". <br> <br>  ,        . <br> <br> <code class="javascript">$.extend( $.suitUp.commands, { bold: null, //   ,        null fontname: { Arial: 'arial', Times: 'times', Verdana: 'verdana' }, forecolor: function( callback ){ var blackBackground = $( '&lt;div/&gt;' ).css({ background: 'black', position: 'absolute', top: 0, left:0, opacity: .5, width: '100%', height: '100%' }).on( 'click', function(){ popup.add( this ).remove(); }).appendTo('body'), popup = $( '&lt;div/&gt;' ).css({ padding: '10px 20px', width: 200, position: 'absolute', background: 'white', top: 200, left: $( window ).width()/2 - 110, zIndex: 100 }).appendTo('body'); $( '&lt;input/&gt;' ).appendTo( popup ); $( '&lt;button/&gt;' ).appendTo( popup ).text( 'Go!' ).on( 'click', function() { var val = popup.children( 'input' ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor' );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . Callback   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( 'forecolor', false, ' ' );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript">$.suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript">$.extend( jQuery.suitUp.custom, { helloWorld: function() { return $( '&lt;span/&gt;', { 'class': 'suitup-control' //    }).css( 'backgroundColor', 'red' ).on( 'click', function() { alert( 'Hello World!' ); }); } });</code> <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor', 'helloWorld' );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       "link",     ( "createlink"),      ( "unlink"). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( 'a', { className: 'suitup-control', href: '#' }).attr({ 'data-command': 'createlink' //         createlink }).on( 'click', function() { if( !$.suitUp.hasSelectedNodeParent( 'a' ) ) { document.execCommand( 'createlink', false, window.prompt( 'URL:', '' ) ); } else { document.execCommand( 'unlink', false, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor#red</code> )    : <br>  .   .  , ""  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript">$.suitUp.controls = [ 'bold', 'italic' ]; $( '.suitup-textarea' ).suitUp(); //    ,   $( '.suitup-textarea' ).suitUp( 'bold', 'italic' );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript">$.suitUp.controls.push( 'forecolor' ); $( '.suitup-textarea' ).suitUp();</code> <br>   : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( $.suitUp.controls.concat([ 'forecolor' ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   $.suitUp   .  ,            .      ,      ,  . <br> <br> <b>$.suitUp.getSelection</b> <br>   .          . <br> <br> <b>$.suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = $.suitUp.getSelection(); //  -,     $( '.suitup-editor' ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b>$.suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b>$.suitUp.hasSelectedNodeParent</b> <br>  ,      "link". ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( 'a' ); // true/false</code> <br> <br>    Chrome, Firefox, IE10 (+IE7 Mode) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/Suitup</a> <br> <br>   extended-commands.suitup.jquery.js     .    50        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b>UPD</b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> 1.          . ,  bold  Chrome     b,   IE   strong. <br> 2.          (      ). <br> 3.    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> <pre> <code class="hljs smalltalk"><code class="javascript"><code>, ,     <span class="hljs-type"><span class="hljs-type">IE</span></span>,        execCommand( <span class="hljs-string"><span class="hljs-string">'formatblock'</span></span> ... )</code>   .   :     <span class="hljs-comment"><span class="hljs-comment">" "</span></span>,       .   <span class="hljs-type"><span class="hljs-type">IE</span></span>...    ?..     <code>queryCommandValue( <span class="hljs-string"><span class="hljs-string">'formatblock'</span></span> )</code>  <code><span class="hljs-comment"><span class="hljs-comment">" 1"</span></span>, <span class="hljs-comment"><span class="hljs-comment">" 2"</span></span>, <span class="hljs-comment"><span class="hljs-comment">""</span></span></code> , .     , , , ,         .     ,    <span class="hljs-type"><span class="hljs-type">IE10</span></span>. ,  ,    <span class="hljs-type"><span class="hljs-type">IE10</span></span>!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  <span class="hljs-type"><span class="hljs-type">SuitUp</span></span> <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp();</code> <br>       : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> );</code> <br>       <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp([ <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>,      : <br> <br> <span class="hljs-number"><span class="hljs-number">1.</span></span> ,  :  forecolor    red: <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands = { forecolor: <span class="hljs-string"><span class="hljs-string">'red'</span></span> }</code> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( jQuery.suitUp.commands, { forecolor: <span class="hljs-string"><span class="hljs-string">'red'</span></span> })</code> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands.forecolor = <span class="hljs-string"><span class="hljs-string">'red'</span></span> // ( ,  commands -  )</code> <br> : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>   () <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands.forecolor = { <span class="hljs-string"><span class="hljs-string">'Make Red'</span></span>: <span class="hljs-string"><span class="hljs-string">'red'</span></span>, <span class="hljs-string"><span class="hljs-string">'Make Green'</span></span>: <span class="hljs-string"><span class="hljs-string">'green'</span></span> }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> <span class="hljs-number"><span class="hljs-number">3.</span></span> ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span> ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'link'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> <span class="hljs-number"><span class="hljs-number">1.</span></span>  <span class="hljs-type"><span class="hljs-type">Bold</span></span>. <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>  . <br> <span class="hljs-number"><span class="hljs-number">3.</span></span> ,             <span class="hljs-comment"><span class="hljs-comment">""</span></span>. <br> <br>  ,        . <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands, { bold: null, //   ,        null fontname: { <span class="hljs-type"><span class="hljs-type">Arial</span></span>: <span class="hljs-string"><span class="hljs-string">'arial'</span></span>, <span class="hljs-type"><span class="hljs-type">Times</span></span>: <span class="hljs-string"><span class="hljs-string">'times'</span></span>, <span class="hljs-type"><span class="hljs-type">Verdana</span></span>: <span class="hljs-string"><span class="hljs-string">'verdana'</span></span> }, forecolor: function( callback ){ var blackBackground = <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;div/&gt;'</span></span> ).css({ background: <span class="hljs-string"><span class="hljs-string">'black'</span></span>, position: <span class="hljs-string"><span class="hljs-string">'absolute'</span></span>, top: <span class="hljs-number"><span class="hljs-number">0</span></span>, left:<span class="hljs-number"><span class="hljs-number">0</span></span>, opacity: <span class="hljs-number"><span class="hljs-number">.5</span></span>, width: <span class="hljs-string"><span class="hljs-string">'100%'</span></span>, height: <span class="hljs-string"><span class="hljs-string">'100%'</span></span> }).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function(){ popup.add( this ).remove(); }).appendTo(<span class="hljs-string"><span class="hljs-string">'body'</span></span>), popup = <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;div/&gt;'</span></span> ).css({ padding: <span class="hljs-string"><span class="hljs-string">'10px 20px'</span></span>, width: <span class="hljs-number"><span class="hljs-number">200</span></span>, position: <span class="hljs-string"><span class="hljs-string">'absolute'</span></span>, background: <span class="hljs-string"><span class="hljs-string">'white'</span></span>, top: <span class="hljs-number"><span class="hljs-number">200</span></span>, left: <span class="hljs-string"><span class="hljs-string">$(</span></span> window ).width()/<span class="hljs-number"><span class="hljs-number">2</span></span> - <span class="hljs-number"><span class="hljs-number">110</span></span>, zIndex: <span class="hljs-number"><span class="hljs-number">100</span></span> }).appendTo(<span class="hljs-string"><span class="hljs-string">'body'</span></span>); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;input/&gt;'</span></span> ).appendTo( popup ); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;button/&gt;'</span></span> ).appendTo( popup ).text( <span class="hljs-string"><span class="hljs-string">'Go!'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { var val = popup.children( <span class="hljs-string"><span class="hljs-string">'input'</span></span> ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'fontname'</span></span>, <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . <span class="hljs-type"><span class="hljs-type">Callback</span></span>   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span> );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( jQuery.suitUp.custom, { helloWorld: function() { return <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;span/&gt;'</span></span>, { <span class="hljs-string"><span class="hljs-string">'class'</span></span>: <span class="hljs-string"><span class="hljs-string">'suitup-control'</span></span> //    }).css( <span class="hljs-string"><span class="hljs-string">'backgroundColor'</span></span>, <span class="hljs-string"><span class="hljs-string">'red'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { alert( <span class="hljs-string"><span class="hljs-string">'Hello World!'</span></span> ); }); } });</code> <br> <br>  : <br> <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'fontname'</span></span>, <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>, <span class="hljs-string"><span class="hljs-string">'helloWorld'</span></span> ); <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       <span class="hljs-comment"><span class="hljs-comment">"link"</span></span>,     ( <span class="hljs-comment"><span class="hljs-comment">"createlink"</span></span>),      ( <span class="hljs-comment"><span class="hljs-comment">"unlink"</span></span>). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( <span class="hljs-string"><span class="hljs-string">'a'</span></span>, { className: <span class="hljs-string"><span class="hljs-string">'suitup-control'</span></span>, href: <span class="hljs-string"><span class="hljs-string">'#'</span></span> }).attr({ <span class="hljs-string"><span class="hljs-string">'data-command'</span></span>: <span class="hljs-string"><span class="hljs-string">'createlink'</span></span> //         createlink }).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { if( !<span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.hasSelectedNodeParent( <span class="hljs-string"><span class="hljs-string">'a'</span></span> ) ) { document.execCommand( <span class="hljs-string"><span class="hljs-string">'createlink'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, window.prompt( <span class="hljs-string"><span class="hljs-string">'URL:'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span> ) ); } else { document.execCommand( <span class="hljs-string"><span class="hljs-string">'unlink'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor<span class="hljs-symbol"><span class="hljs-symbol">#red</span></span></code> )    : <br>  .   .  , <span class="hljs-comment"><span class="hljs-comment">""</span></span>  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls = [ <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'italic'</span></span> ]; <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp(); //    ,   <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'italic'</span></span> );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls.push( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp();</code> <br>   : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls.concat([ <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp   .  ,            .      ,      ,  . <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelection</b> <br>   .          . <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelection(); //  -,     <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-editor'</span></span> ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.hasSelectedNodeParent</b> <br>  ,      <span class="hljs-comment"><span class="hljs-comment">"link"</span></span>. ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( <span class="hljs-string"><span class="hljs-string">'a'</span></span> ); // <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">false</span></span></code> <br> <br>    <span class="hljs-type"><span class="hljs-type">Chrome</span></span>, <span class="hljs-type"><span class="hljs-type">Firefox</span></span>, <span class="hljs-type"><span class="hljs-type">IE10</span></span> (+<span class="hljs-type"><span class="hljs-type">IE7</span></span> <span class="hljs-type"><span class="hljs-type">Mode</span></span>) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/<span class="hljs-type"><span class="hljs-type">Suitup</span></span></a> <br> <br>   extended-commands.suitup.jquery.js     .    <span class="hljs-number"><span class="hljs-number">50</span></span>        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b><span class="hljs-type"><span class="hljs-type">UPD</span></span></b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> <span class="hljs-number"><span class="hljs-number">1.</span></span>          . ,  bold  <span class="hljs-type"><span class="hljs-type">Chrome</span></span>     b,   <span class="hljs-type"><span class="hljs-type">IE</span></span>   strong. <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>          (      ). <br> <span class="hljs-number"><span class="hljs-number">3.</span></span>    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code></code> </pre> <code><code>, ,     IE,        execCommand( 'formatblock' ... )</code>   .   :     " ",       .   IE...    ?..     <code>queryCommandValue( 'formatblock' )</code>  <code>" 1", " 2", ""</code> , .     , , , ,         .     ,    IE10. ,  ,    IE10!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  SuitUp <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript">$( '.my-textarea' ).suitUp();</code> <br>       : <br> <code class="javascript">$( '.my-textarea' ).suitUp( 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' );</code> <br>       <br> <code class="javascript">$( '.my-textarea' ).suitUp([ 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , 'forecolor',      : <br> <br> 1. ,  :  forecolor    red: <br> <code class="javascript">$.suitUp.commands = { forecolor: 'red' }</code> <br>  <br> <code class="javascript">$.extend( jQuery.suitUp.commands, { forecolor: 'red' })</code> <br>  <br> <code class="javascript">$.suitUp.commands.forecolor = 'red' // ( ,  commands -  )</code> <br> : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> 2.   () <br> <code class="javascript">$.suitUp.commands.forecolor = { 'Make Red': 'red', 'Make Green': 'green' }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> 3. ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( ' ', '' ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript">$( 'textarea' ).suitUp( 'italic', 'bold', '|', 'link', 'formatblock#&lt;h1&gt;' );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> 1.  Bold. <br> 2.  . <br> 3. ,             "". <br> <br>  ,        . <br> <br> <code class="javascript">$.extend( $.suitUp.commands, { bold: null, //   ,        null fontname: { Arial: 'arial', Times: 'times', Verdana: 'verdana' }, forecolor: function( callback ){ var blackBackground = $( '&lt;div/&gt;' ).css({ background: 'black', position: 'absolute', top: 0, left:0, opacity: .5, width: '100%', height: '100%' }).on( 'click', function(){ popup.add( this ).remove(); }).appendTo('body'), popup = $( '&lt;div/&gt;' ).css({ padding: '10px 20px', width: 200, position: 'absolute', background: 'white', top: 200, left: $( window ).width()/2 - 110, zIndex: 100 }).appendTo('body'); $( '&lt;input/&gt;' ).appendTo( popup ); $( '&lt;button/&gt;' ).appendTo( popup ).text( 'Go!' ).on( 'click', function() { var val = popup.children( 'input' ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor' );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . Callback   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( 'forecolor', false, ' ' );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript">$.suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript">$.extend( jQuery.suitUp.custom, { helloWorld: function() { return $( '&lt;span/&gt;', { 'class': 'suitup-control' //    }).css( 'backgroundColor', 'red' ).on( 'click', function() { alert( 'Hello World!' ); }); } });</code> <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor', 'helloWorld' );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       "link",     ( "createlink"),      ( "unlink"). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( 'a', { className: 'suitup-control', href: '#' }).attr({ 'data-command': 'createlink' //         createlink }).on( 'click', function() { if( !$.suitUp.hasSelectedNodeParent( 'a' ) ) { document.execCommand( 'createlink', false, window.prompt( 'URL:', '' ) ); } else { document.execCommand( 'unlink', false, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor#red</code> )    : <br>  .   .  , ""  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript">$.suitUp.controls = [ 'bold', 'italic' ]; $( '.suitup-textarea' ).suitUp(); //    ,   $( '.suitup-textarea' ).suitUp( 'bold', 'italic' );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript">$.suitUp.controls.push( 'forecolor' ); $( '.suitup-textarea' ).suitUp();</code> <br>   : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( $.suitUp.controls.concat([ 'forecolor' ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   $.suitUp   .  ,            .      ,      ,  . <br> <br> <b>$.suitUp.getSelection</b> <br>   .          . <br> <br> <b>$.suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = $.suitUp.getSelection(); //  -,     $( '.suitup-editor' ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b>$.suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b>$.suitUp.hasSelectedNodeParent</b> <br>  ,      "link". ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( 'a' ); // true/false</code> <br> <br>    Chrome, Firefox, IE10 (+IE7 Mode) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/Suitup</a> <br> <br>   extended-commands.suitup.jquery.js     .    50        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b>UPD</b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> 1.          . ,  bold  Chrome     b,   IE   strong. <br> 2.          (      ). <br> 3.    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> <pre> <code class="hljs smalltalk"><code>, ,     <span class="hljs-type"><span class="hljs-type">IE</span></span>,        execCommand( <span class="hljs-string"><span class="hljs-string">'formatblock'</span></span> ... )</code>   .   :     <span class="hljs-comment"><span class="hljs-comment">" "</span></span>,       .   <span class="hljs-type"><span class="hljs-type">IE</span></span>...    ?..     <code>queryCommandValue( <span class="hljs-string"><span class="hljs-string">'formatblock'</span></span> )</code>  <code><span class="hljs-comment"><span class="hljs-comment">" 1"</span></span>, <span class="hljs-comment"><span class="hljs-comment">" 2"</span></span>, <span class="hljs-comment"><span class="hljs-comment">""</span></span></code> , .     , , , ,         .     ,    <span class="hljs-type"><span class="hljs-type">IE10</span></span>. ,  ,    <span class="hljs-type"><span class="hljs-type">IE10</span></span>!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  <span class="hljs-type"><span class="hljs-type">SuitUp</span></span> <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp();</code> <br>       : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> );</code> <br>       <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp([ <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>,      : <br> <br> <span class="hljs-number"><span class="hljs-number">1.</span></span> ,  :  forecolor    red: <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands = { forecolor: <span class="hljs-string"><span class="hljs-string">'red'</span></span> }</code> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( jQuery.suitUp.commands, { forecolor: <span class="hljs-string"><span class="hljs-string">'red'</span></span> })</code> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands.forecolor = <span class="hljs-string"><span class="hljs-string">'red'</span></span> // ( ,  commands -  )</code> <br> : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>   () <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands.forecolor = { <span class="hljs-string"><span class="hljs-string">'Make Red'</span></span>: <span class="hljs-string"><span class="hljs-string">'red'</span></span>, <span class="hljs-string"><span class="hljs-string">'Make Green'</span></span>: <span class="hljs-string"><span class="hljs-string">'green'</span></span> }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> <span class="hljs-number"><span class="hljs-number">3.</span></span> ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span> ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'link'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> <span class="hljs-number"><span class="hljs-number">1.</span></span>  <span class="hljs-type"><span class="hljs-type">Bold</span></span>. <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>  . <br> <span class="hljs-number"><span class="hljs-number">3.</span></span> ,             <span class="hljs-comment"><span class="hljs-comment">""</span></span>. <br> <br>  ,        . <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands, { bold: null, //   ,        null fontname: { <span class="hljs-type"><span class="hljs-type">Arial</span></span>: <span class="hljs-string"><span class="hljs-string">'arial'</span></span>, <span class="hljs-type"><span class="hljs-type">Times</span></span>: <span class="hljs-string"><span class="hljs-string">'times'</span></span>, <span class="hljs-type"><span class="hljs-type">Verdana</span></span>: <span class="hljs-string"><span class="hljs-string">'verdana'</span></span> }, forecolor: function( callback ){ var blackBackground = <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;div/&gt;'</span></span> ).css({ background: <span class="hljs-string"><span class="hljs-string">'black'</span></span>, position: <span class="hljs-string"><span class="hljs-string">'absolute'</span></span>, top: <span class="hljs-number"><span class="hljs-number">0</span></span>, left:<span class="hljs-number"><span class="hljs-number">0</span></span>, opacity: <span class="hljs-number"><span class="hljs-number">.5</span></span>, width: <span class="hljs-string"><span class="hljs-string">'100%'</span></span>, height: <span class="hljs-string"><span class="hljs-string">'100%'</span></span> }).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function(){ popup.add( this ).remove(); }).appendTo(<span class="hljs-string"><span class="hljs-string">'body'</span></span>), popup = <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;div/&gt;'</span></span> ).css({ padding: <span class="hljs-string"><span class="hljs-string">'10px 20px'</span></span>, width: <span class="hljs-number"><span class="hljs-number">200</span></span>, position: <span class="hljs-string"><span class="hljs-string">'absolute'</span></span>, background: <span class="hljs-string"><span class="hljs-string">'white'</span></span>, top: <span class="hljs-number"><span class="hljs-number">200</span></span>, left: <span class="hljs-string"><span class="hljs-string">$(</span></span> window ).width()/<span class="hljs-number"><span class="hljs-number">2</span></span> - <span class="hljs-number"><span class="hljs-number">110</span></span>, zIndex: <span class="hljs-number"><span class="hljs-number">100</span></span> }).appendTo(<span class="hljs-string"><span class="hljs-string">'body'</span></span>); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;input/&gt;'</span></span> ).appendTo( popup ); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;button/&gt;'</span></span> ).appendTo( popup ).text( <span class="hljs-string"><span class="hljs-string">'Go!'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { var val = popup.children( <span class="hljs-string"><span class="hljs-string">'input'</span></span> ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'fontname'</span></span>, <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . <span class="hljs-type"><span class="hljs-type">Callback</span></span>   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span> );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( jQuery.suitUp.custom, { helloWorld: function() { return <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;span/&gt;'</span></span>, { <span class="hljs-string"><span class="hljs-string">'class'</span></span>: <span class="hljs-string"><span class="hljs-string">'suitup-control'</span></span> //    }).css( <span class="hljs-string"><span class="hljs-string">'backgroundColor'</span></span>, <span class="hljs-string"><span class="hljs-string">'red'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { alert( <span class="hljs-string"><span class="hljs-string">'Hello World!'</span></span> ); }); } });</code> <br> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'fontname'</span></span>, <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>, <span class="hljs-string"><span class="hljs-string">'helloWorld'</span></span> );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       <span class="hljs-comment"><span class="hljs-comment">"link"</span></span>,     ( <span class="hljs-comment"><span class="hljs-comment">"createlink"</span></span>),      ( <span class="hljs-comment"><span class="hljs-comment">"unlink"</span></span>). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( <span class="hljs-string"><span class="hljs-string">'a'</span></span>, { className: <span class="hljs-string"><span class="hljs-string">'suitup-control'</span></span>, href: <span class="hljs-string"><span class="hljs-string">'#'</span></span> }).attr({ <span class="hljs-string"><span class="hljs-string">'data-command'</span></span>: <span class="hljs-string"><span class="hljs-string">'createlink'</span></span> //         createlink }).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { if( !<span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.hasSelectedNodeParent( <span class="hljs-string"><span class="hljs-string">'a'</span></span> ) ) { document.execCommand( <span class="hljs-string"><span class="hljs-string">'createlink'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, window.prompt( <span class="hljs-string"><span class="hljs-string">'URL:'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span> ) ); } else { document.execCommand( <span class="hljs-string"><span class="hljs-string">'unlink'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor<span class="hljs-symbol"><span class="hljs-symbol">#red</span></span></code> )    : <br>  .   .  , <span class="hljs-comment"><span class="hljs-comment">""</span></span>  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls = [ <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'italic'</span></span> ]; <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp(); //    ,   <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'italic'</span></span> );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls.push( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp();</code> <br>   : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls.concat([ <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp   .  ,            .      ,      ,  . <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelection</b> <br>   .          . <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelection(); //  -,     <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-editor'</span></span> ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.hasSelectedNodeParent</b> <br>  ,      <span class="hljs-comment"><span class="hljs-comment">"link"</span></span>. ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( <span class="hljs-string"><span class="hljs-string">'a'</span></span> ); // <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">false</span></span></code> <br> <br>    <span class="hljs-type"><span class="hljs-type">Chrome</span></span>, <span class="hljs-type"><span class="hljs-type">Firefox</span></span>, <span class="hljs-type"><span class="hljs-type">IE10</span></span> (+<span class="hljs-type"><span class="hljs-type">IE7</span></span> <span class="hljs-type"><span class="hljs-type">Mode</span></span>) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/<span class="hljs-type"><span class="hljs-type">Suitup</span></span></a> <br> <br>   extended-commands.suitup.jquery.js     .    <span class="hljs-number"><span class="hljs-number">50</span></span>        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b><span class="hljs-type"><span class="hljs-type">UPD</span></span></b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> <span class="hljs-number"><span class="hljs-number">1.</span></span>          . ,  bold  <span class="hljs-type"><span class="hljs-type">Chrome</span></span>     b,   <span class="hljs-type"><span class="hljs-type">IE</span></span>   strong. <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>          (      ). <br> <span class="hljs-number"><span class="hljs-number">3.</span></span>    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> </pre> <code><code>, ,     IE,        execCommand( 'formatblock' ... )</code>   .   :     " ",       .   IE...    ?..     <code>queryCommandValue( 'formatblock' )</code>  <code>" 1", " 2", ""</code> , .     , , , ,         .     ,    IE10. ,  ,    IE10!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  SuitUp <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript">$( '.my-textarea' ).suitUp();</code> <br>       : <br> <code class="javascript">$( '.my-textarea' ).suitUp( 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' );</code> <br>       <br> <code class="javascript">$( '.my-textarea' ).suitUp([ 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , 'forecolor',      : <br> <br> 1. ,  :  forecolor    red: <br> <code class="javascript">$.suitUp.commands = { forecolor: 'red' }</code> <br>  <br> <code class="javascript">$.extend( jQuery.suitUp.commands, { forecolor: 'red' })</code> <br>  <br> <code class="javascript">$.suitUp.commands.forecolor = 'red' // ( ,  commands -  )</code> <br> : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> 2.   () <br> <code class="javascript">$.suitUp.commands.forecolor = { 'Make Red': 'red', 'Make Green': 'green' }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> 3. ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( ' ', '' ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript">$( 'textarea' ).suitUp( 'italic', 'bold', '|', 'link', 'formatblock#&lt;h1&gt;' );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> 1.  Bold. <br> 2.  . <br> 3. ,             "". <br> <br>  ,        . <br> <br> <code class="javascript">$.extend( $.suitUp.commands, { bold: null, //   ,        null fontname: { Arial: 'arial', Times: 'times', Verdana: 'verdana' }, forecolor: function( callback ){ var blackBackground = $( '&lt;div/&gt;' ).css({ background: 'black', position: 'absolute', top: 0, left:0, opacity: .5, width: '100%', height: '100%' }).on( 'click', function(){ popup.add( this ).remove(); }).appendTo('body'), popup = $( '&lt;div/&gt;' ).css({ padding: '10px 20px', width: 200, position: 'absolute', background: 'white', top: 200, left: $( window ).width()/2 - 110, zIndex: 100 }).appendTo('body'); $( '&lt;input/&gt;' ).appendTo( popup ); $( '&lt;button/&gt;' ).appendTo( popup ).text( 'Go!' ).on( 'click', function() { var val = popup.children( 'input' ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor' );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . Callback   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( 'forecolor', false, ' ' );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript">$.suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript">$.extend( jQuery.suitUp.custom, { helloWorld: function() { return $( '&lt;span/&gt;', { 'class': 'suitup-control' //    }).css( 'backgroundColor', 'red' ).on( 'click', function() { alert( 'Hello World!' ); }); } });</code> <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor', 'helloWorld' );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       "link",     ( "createlink"),      ( "unlink"). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( 'a', { className: 'suitup-control', href: '#' }).attr({ 'data-command': 'createlink' //         createlink }).on( 'click', function() { if( !$.suitUp.hasSelectedNodeParent( 'a' ) ) { document.execCommand( 'createlink', false, window.prompt( 'URL:', '' ) ); } else { document.execCommand( 'unlink', false, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor#red</code> )    : <br>  .   .  , ""  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript">$.suitUp.controls = [ 'bold', 'italic' ]; $( '.suitup-textarea' ).suitUp(); //    ,   $( '.suitup-textarea' ).suitUp( 'bold', 'italic' );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript">$.suitUp.controls.push( 'forecolor' ); $( '.suitup-textarea' ).suitUp();</code> <br>   : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( $.suitUp.controls.concat([ 'forecolor' ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   $.suitUp   .  ,            .      ,      ,  . <br> <br> <b>$.suitUp.getSelection</b> <br>   .          . <br> <br> <b>$.suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = $.suitUp.getSelection(); //  -,     $( '.suitup-editor' ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b>$.suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b>$.suitUp.hasSelectedNodeParent</b> <br>  ,      "link". ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( 'a' ); // true/false</code> <br> <br>    Chrome, Firefox, IE10 (+IE7 Mode) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/Suitup</a> <br> <br>   extended-commands.suitup.jquery.js     .    50        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b>UPD</b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> 1.          . ,  bold  Chrome     b,   IE   strong. <br> 2.          (      ). <br> 3.    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> <ul><li> <code><code>, ,     IE,        execCommand( 'formatblock' ... )</code>   .   :     " ",       .   IE...    ?..     <code>queryCommandValue( 'formatblock' )</code>  <code>" 1", " 2", ""</code> , .     , , , ,         .     ,    IE10. ,  ,    IE10!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  SuitUp <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript">$( '.my-textarea' ).suitUp();</code> <br>       : <br> <code class="javascript">$( '.my-textarea' ).suitUp( 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' );</code> <br>       <br> <code class="javascript">$( '.my-textarea' ).suitUp([ 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , 'forecolor',      : <br> <br> 1. ,  :  forecolor    red: <br> <code class="javascript">$.suitUp.commands = { forecolor: 'red' }</code> <br>  <br> <code class="javascript">$.extend( jQuery.suitUp.commands, { forecolor: 'red' })</code> <br>  <br> <code class="javascript">$.suitUp.commands.forecolor = 'red' // ( ,  commands -  )</code> <br> : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> 2.   () <br> <code class="javascript">$.suitUp.commands.forecolor = { 'Make Red': 'red', 'Make Green': 'green' }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> 3. ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( ' ', '' ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript">$( 'textarea' ).suitUp( 'italic', 'bold', '|', 'link', 'formatblock#&lt;h1&gt;' );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> 1.  Bold. <br> 2.  . <br> 3. ,             "". <br> <br>  ,        . <br> <br> <code class="javascript">$.extend( $.suitUp.commands, { bold: null, //   ,        null fontname: { Arial: 'arial', Times: 'times', Verdana: 'verdana' }, forecolor: function( callback ){ var blackBackground = $( '&lt;div/&gt;' ).css({ background: 'black', position: 'absolute', top: 0, left:0, opacity: .5, width: '100%', height: '100%' }).on( 'click', function(){ popup.add( this ).remove(); }).appendTo('body'), popup = $( '&lt;div/&gt;' ).css({ padding: '10px 20px', width: 200, position: 'absolute', background: 'white', top: 200, left: $( window ).width()/2 - 110, zIndex: 100 }).appendTo('body'); $( '&lt;input/&gt;' ).appendTo( popup ); $( '&lt;button/&gt;' ).appendTo( popup ).text( 'Go!' ).on( 'click', function() { var val = popup.children( 'input' ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor' );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . Callback   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( 'forecolor', false, ' ' );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript">$.suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript">$.extend( jQuery.suitUp.custom, { helloWorld: function() { return $( '&lt;span/&gt;', { 'class': 'suitup-control' //    }).css( 'backgroundColor', 'red' ).on( 'click', function() { alert( 'Hello World!' ); }); } });</code> <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor', 'helloWorld' );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       "link",     ( "createlink"),      ( "unlink"). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( 'a', { className: 'suitup-control', href: '#' }).attr({ 'data-command': 'createlink' //         createlink }).on( 'click', function() { if( !$.suitUp.hasSelectedNodeParent( 'a' ) ) { document.execCommand( 'createlink', false, window.prompt( 'URL:', '' ) ); } else { document.execCommand( 'unlink', false, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor#red</code> )    : <br>  .   .  , ""  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript">$.suitUp.controls = [ 'bold', 'italic' ]; $( '.suitup-textarea' ).suitUp(); //    ,   $( '.suitup-textarea' ).suitUp( 'bold', 'italic' );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript">$.suitUp.controls.push( 'forecolor' ); $( '.suitup-textarea' ).suitUp();</code> <br>   : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( $.suitUp.controls.concat([ 'forecolor' ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   $.suitUp   .  ,            .      ,      ,  . <br> <br> <b>$.suitUp.getSelection</b> <br>   .          . <br> <br> <b>$.suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = $.suitUp.getSelection(); //  -,     $( '.suitup-editor' ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b>$.suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b>$.suitUp.hasSelectedNodeParent</b> <br>  ,      "link". ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( 'a' ); // true/false</code> <br> <br>    Chrome, Firefox, IE10 (+IE7 Mode) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/Suitup</a> <br> <br>   extended-commands.suitup.jquery.js     .    50        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b>UPD</b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> 1.          . ,  bold  Chrome     b,   IE   strong. <br> 2.          (      ). <br> 3.    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> </li> <li> <code><code>, ,     IE,        execCommand( 'formatblock' ... )</code>   .   :     " ",       .   IE...    ?..     <code>queryCommandValue( 'formatblock' )</code>  <code>" 1", " 2", ""</code> , .     , , , ,         .     ,    IE10. ,  ,    IE10!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  SuitUp <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript">$( '.my-textarea' ).suitUp();</code> <br>       : <br> <code class="javascript">$( '.my-textarea' ).suitUp( 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' );</code> <br>       <br> <code class="javascript">$( '.my-textarea' ).suitUp([ 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , 'forecolor',      : <br> <br> 1. ,  :  forecolor    red: <br> <code class="javascript">$.suitUp.commands = { forecolor: 'red' }</code> <br>  <br> <code class="javascript">$.extend( jQuery.suitUp.commands, { forecolor: 'red' })</code> <br>  <br> <code class="javascript">$.suitUp.commands.forecolor = 'red' // ( ,  commands -  )</code> <br> : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> 2.   () <br> <code class="javascript">$.suitUp.commands.forecolor = { 'Make Red': 'red', 'Make Green': 'green' }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> 3. ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( ' ', '' ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript">$( 'textarea' ).suitUp( 'italic', 'bold', '|', 'link', 'formatblock#&lt;h1&gt;' );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> 1.  Bold. <br> 2.  . <br> 3. ,             "". <br> <br>  ,        . <br> <br> <code class="javascript">$.extend( $.suitUp.commands, { bold: null, //   ,        null fontname: { Arial: 'arial', Times: 'times', Verdana: 'verdana' }, forecolor: function( callback ){ var blackBackground = $( '&lt;div/&gt;' ).css({ background: 'black', position: 'absolute', top: 0, left:0, opacity: .5, width: '100%', height: '100%' }).on( 'click', function(){ popup.add( this ).remove(); }).appendTo('body'), popup = $( '&lt;div/&gt;' ).css({ padding: '10px 20px', width: 200, position: 'absolute', background: 'white', top: 200, left: $( window ).width()/2 - 110, zIndex: 100 }).appendTo('body'); $( '&lt;input/&gt;' ).appendTo( popup ); $( '&lt;button/&gt;' ).appendTo( popup ).text( 'Go!' ).on( 'click', function() { var val = popup.children( 'input' ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor' );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . Callback   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( 'forecolor', false, ' ' );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript">$.suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript">$.extend( jQuery.suitUp.custom, { helloWorld: function() { return $( '&lt;span/&gt;', { 'class': 'suitup-control' //    }).css( 'backgroundColor', 'red' ).on( 'click', function() { alert( 'Hello World!' ); }); } });</code> <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor', 'helloWorld' );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       "link",     ( "createlink"),      ( "unlink"). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( 'a', { className: 'suitup-control', href: '#' }).attr({ 'data-command': 'createlink' //         createlink }).on( 'click', function() { if( !$.suitUp.hasSelectedNodeParent( 'a' ) ) { document.execCommand( 'createlink', false, window.prompt( 'URL:', '' ) ); } else { document.execCommand( 'unlink', false, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor#red</code> )    : <br>  .   .  , ""  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript">$.suitUp.controls = [ 'bold', 'italic' ]; $( '.suitup-textarea' ).suitUp(); //    ,   $( '.suitup-textarea' ).suitUp( 'bold', 'italic' );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript">$.suitUp.controls.push( 'forecolor' ); $( '.suitup-textarea' ).suitUp();</code> <br>   : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( $.suitUp.controls.concat([ 'forecolor' ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   $.suitUp   .  ,            .      ,      ,  . <br> <br> <b>$.suitUp.getSelection</b> <br>   .          . <br> <br> <b>$.suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = $.suitUp.getSelection(); //  -,     $( '.suitup-editor' ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b>$.suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b>$.suitUp.hasSelectedNodeParent</b> <br>  ,      "link". ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( 'a' ); // true/false</code> <br> <br>    Chrome, Firefox, IE10 (+IE7 Mode) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/Suitup</a> <br> <br>   extended-commands.suitup.jquery.js     .    50        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b>UPD</b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> 1.          . ,  bold  Chrome     b,   IE   strong. <br> 2.          (      ). <br> 3.    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> </li> <li> <code><code>, ,     IE,        execCommand( 'formatblock' ... )</code>   .   :     " ",       .   IE...    ?..     <code>queryCommandValue( 'formatblock' )</code>  <code>" 1", " 2", ""</code> , .     , , , ,         .     ,    IE10. ,  ,    IE10!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  SuitUp <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript">$( '.my-textarea' ).suitUp();</code> <br>       : <br> <code class="javascript">$( '.my-textarea' ).suitUp( 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' );</code> <br>       <br> <code class="javascript">$( '.my-textarea' ).suitUp([ 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , 'forecolor',      : <br> <br> 1. ,  :  forecolor    red: <br> <code class="javascript">$.suitUp.commands = { forecolor: 'red' }</code> <br>  <br> <code class="javascript">$.extend( jQuery.suitUp.commands, { forecolor: 'red' })</code> <br>  <br> <code class="javascript">$.suitUp.commands.forecolor = 'red' // ( ,  commands -  )</code> <br> : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> 2.   () <br> <code class="javascript">$.suitUp.commands.forecolor = { 'Make Red': 'red', 'Make Green': 'green' }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> 3. ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( ' ', '' ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript">$( 'textarea' ).suitUp( 'italic', 'bold', '|', 'link', 'formatblock#&lt;h1&gt;' );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> 1.  Bold. <br> 2.  . <br> 3. ,             "". <br> <br>  ,        . <br> <br> <code class="javascript">$.extend( $.suitUp.commands, { bold: null, //   ,        null fontname: { Arial: 'arial', Times: 'times', Verdana: 'verdana' }, forecolor: function( callback ){ var blackBackground = $( '&lt;div/&gt;' ).css({ background: 'black', position: 'absolute', top: 0, left:0, opacity: .5, width: '100%', height: '100%' }).on( 'click', function(){ popup.add( this ).remove(); }).appendTo('body'), popup = $( '&lt;div/&gt;' ).css({ padding: '10px 20px', width: 200, position: 'absolute', background: 'white', top: 200, left: $( window ).width()/2 - 110, zIndex: 100 }).appendTo('body'); $( '&lt;input/&gt;' ).appendTo( popup ); $( '&lt;button/&gt;' ).appendTo( popup ).text( 'Go!' ).on( 'click', function() { var val = popup.children( 'input' ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor' );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . Callback   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( 'forecolor', false, ' ' );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript">$.suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript">$.extend( jQuery.suitUp.custom, { helloWorld: function() { return $( '&lt;span/&gt;', { 'class': 'suitup-control' //    }).css( 'backgroundColor', 'red' ).on( 'click', function() { alert( 'Hello World!' ); }); } });</code> <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor', 'helloWorld' );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       "link",     ( "createlink"),      ( "unlink"). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( 'a', { className: 'suitup-control', href: '#' }).attr({ 'data-command': 'createlink' //         createlink }).on( 'click', function() { if( !$.suitUp.hasSelectedNodeParent( 'a' ) ) { document.execCommand( 'createlink', false, window.prompt( 'URL:', '' ) ); } else { document.execCommand( 'unlink', false, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor#red</code> )    : <br>  .   .  , ""  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript">$.suitUp.controls = [ 'bold', 'italic' ]; $( '.suitup-textarea' ).suitUp(); //    ,   $( '.suitup-textarea' ).suitUp( 'bold', 'italic' );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript">$.suitUp.controls.push( 'forecolor' ); $( '.suitup-textarea' ).suitUp();</code> <br>   : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( $.suitUp.controls.concat([ 'forecolor' ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   $.suitUp   .  ,            .      ,      ,  . <br> <br> <b>$.suitUp.getSelection</b> <br>   .          . <br> <br> <b>$.suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = $.suitUp.getSelection(); //  -,     $( '.suitup-editor' ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b>$.suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b>$.suitUp.hasSelectedNodeParent</b> <br>  ,      "link". ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( 'a' ); // true/false</code> <br> <br>    Chrome, Firefox, IE10 (+IE7 Mode) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/Suitup</a> <br> <br>   extended-commands.suitup.jquery.js     .    50        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b>UPD</b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> 1.          . ,  bold  Chrome     b,   IE   strong. <br> 2.          (      ). <br> 3.    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> <ol><li> <code><code>, ,     IE,        execCommand( 'formatblock' ... )</code>   .   :     " ",       .   IE...    ?..     <code>queryCommandValue( 'formatblock' )</code>  <code>" 1", " 2", ""</code> , .     , , , ,         .     ,    IE10. ,  ,    IE10!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  SuitUp <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript">$( '.my-textarea' ).suitUp();</code> <br>       : <br> <code class="javascript">$( '.my-textarea' ).suitUp( 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' );</code> <br>       <br> <code class="javascript">$( '.my-textarea' ).suitUp([ 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , 'forecolor',      : <br> <br> 1. ,  :  forecolor    red: <br> <code class="javascript">$.suitUp.commands = { forecolor: 'red' }</code> <br>  <br> <code class="javascript">$.extend( jQuery.suitUp.commands, { forecolor: 'red' })</code> <br>  <br> <code class="javascript">$.suitUp.commands.forecolor = 'red' // ( ,  commands -  )</code> <br> : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> 2.   () <br> <code class="javascript">$.suitUp.commands.forecolor = { 'Make Red': 'red', 'Make Green': 'green' }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> 3. ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( ' ', '' ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript">$( 'textarea' ).suitUp( 'italic', 'bold', '|', 'link', 'formatblock#&lt;h1&gt;' );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> 1.  Bold. <br> 2.  . <br> 3. ,             "". <br> <br>  ,        . <br> <br> <code class="javascript">$.extend( $.suitUp.commands, { bold: null, //   ,        null fontname: { Arial: 'arial', Times: 'times', Verdana: 'verdana' }, forecolor: function( callback ){ var blackBackground = $( '&lt;div/&gt;' ).css({ background: 'black', position: 'absolute', top: 0, left:0, opacity: .5, width: '100%', height: '100%' }).on( 'click', function(){ popup.add( this ).remove(); }).appendTo('body'), popup = $( '&lt;div/&gt;' ).css({ padding: '10px 20px', width: 200, position: 'absolute', background: 'white', top: 200, left: $( window ).width()/2 - 110, zIndex: 100 }).appendTo('body'); $( '&lt;input/&gt;' ).appendTo( popup ); $( '&lt;button/&gt;' ).appendTo( popup ).text( 'Go!' ).on( 'click', function() { var val = popup.children( 'input' ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor' );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . Callback   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( 'forecolor', false, ' ' );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript">$.suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript">$.extend( jQuery.suitUp.custom, { helloWorld: function() { return $( '&lt;span/&gt;', { 'class': 'suitup-control' //    }).css( 'backgroundColor', 'red' ).on( 'click', function() { alert( 'Hello World!' ); }); } });</code> <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor', 'helloWorld' );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       "link",     ( "createlink"),      ( "unlink"). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( 'a', { className: 'suitup-control', href: '#' }).attr({ 'data-command': 'createlink' //         createlink }).on( 'click', function() { if( !$.suitUp.hasSelectedNodeParent( 'a' ) ) { document.execCommand( 'createlink', false, window.prompt( 'URL:', '' ) ); } else { document.execCommand( 'unlink', false, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor#red</code> )    : <br>  .   .  , ""  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript">$.suitUp.controls = [ 'bold', 'italic' ]; $( '.suitup-textarea' ).suitUp(); //    ,   $( '.suitup-textarea' ).suitUp( 'bold', 'italic' );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript">$.suitUp.controls.push( 'forecolor' ); $( '.suitup-textarea' ).suitUp();</code> <br>   : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( $.suitUp.controls.concat([ 'forecolor' ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   $.suitUp   .  ,            .      ,      ,  . <br> <br> <b>$.suitUp.getSelection</b> <br>   .          . <br> <br> <b>$.suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = $.suitUp.getSelection(); //  -,     $( '.suitup-editor' ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b>$.suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b>$.suitUp.hasSelectedNodeParent</b> <br>  ,      "link". ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( 'a' ); // true/false</code> <br> <br>    Chrome, Firefox, IE10 (+IE7 Mode) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/Suitup</a> <br> <br>   extended-commands.suitup.jquery.js     .    50        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b>UPD</b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> 1.          . ,  bold  Chrome     b,   IE   strong. <br> 2.          (      ). <br> 3.    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> </li> <li> <code><code>, ,     IE,        execCommand( 'formatblock' ... )</code>   .   :     " ",       .   IE...    ?..     <code>queryCommandValue( 'formatblock' )</code>  <code>" 1", " 2", ""</code> , .     , , , ,         .     ,    IE10. ,  ,    IE10!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  SuitUp <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript">$( '.my-textarea' ).suitUp();</code> <br>       : <br> <code class="javascript">$( '.my-textarea' ).suitUp( 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' );</code> <br>       <br> <code class="javascript">$( '.my-textarea' ).suitUp([ 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , 'forecolor',      : <br> <br> 1. ,  :  forecolor    red: <br> <code class="javascript">$.suitUp.commands = { forecolor: 'red' }</code> <br>  <br> <code class="javascript">$.extend( jQuery.suitUp.commands, { forecolor: 'red' })</code> <br>  <br> <code class="javascript">$.suitUp.commands.forecolor = 'red' // ( ,  commands -  )</code> <br> : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> 2.   () <br> <code class="javascript">$.suitUp.commands.forecolor = { 'Make Red': 'red', 'Make Green': 'green' }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> 3. ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( ' ', '' ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript">$( 'textarea' ).suitUp( 'italic', 'bold', '|', 'link', 'formatblock#&lt;h1&gt;' );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> 1.  Bold. <br> 2.  . <br> 3. ,             "". <br> <br>  ,        . <br> <br> <code class="javascript">$.extend( $.suitUp.commands, { bold: null, //   ,        null fontname: { Arial: 'arial', Times: 'times', Verdana: 'verdana' }, forecolor: function( callback ){ var blackBackground = $( '&lt;div/&gt;' ).css({ background: 'black', position: 'absolute', top: 0, left:0, opacity: .5, width: '100%', height: '100%' }).on( 'click', function(){ popup.add( this ).remove(); }).appendTo('body'), popup = $( '&lt;div/&gt;' ).css({ padding: '10px 20px', width: 200, position: 'absolute', background: 'white', top: 200, left: $( window ).width()/2 - 110, zIndex: 100 }).appendTo('body'); $( '&lt;input/&gt;' ).appendTo( popup ); $( '&lt;button/&gt;' ).appendTo( popup ).text( 'Go!' ).on( 'click', function() { var val = popup.children( 'input' ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor' );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . Callback   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( 'forecolor', false, ' ' );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript">$.suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript">$.extend( jQuery.suitUp.custom, { helloWorld: function() { return $( '&lt;span/&gt;', { 'class': 'suitup-control' //    }).css( 'backgroundColor', 'red' ).on( 'click', function() { alert( 'Hello World!' ); }); } });</code> <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor', 'helloWorld' );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       "link",     ( "createlink"),      ( "unlink"). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( 'a', { className: 'suitup-control', href: '#' }).attr({ 'data-command': 'createlink' //         createlink }).on( 'click', function() { if( !$.suitUp.hasSelectedNodeParent( 'a' ) ) { document.execCommand( 'createlink', false, window.prompt( 'URL:', '' ) ); } else { document.execCommand( 'unlink', false, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor#red</code> )    : <br>  .   .  , ""  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript">$.suitUp.controls = [ 'bold', 'italic' ]; $( '.suitup-textarea' ).suitUp(); //    ,   $( '.suitup-textarea' ).suitUp( 'bold', 'italic' );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript">$.suitUp.controls.push( 'forecolor' ); $( '.suitup-textarea' ).suitUp();</code> <br>   : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( $.suitUp.controls.concat([ 'forecolor' ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   $.suitUp   .  ,            .      ,      ,  . <br> <br> <b>$.suitUp.getSelection</b> <br>   .          . <br> <br> <b>$.suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = $.suitUp.getSelection(); //  -,     $( '.suitup-editor' ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b>$.suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b>$.suitUp.hasSelectedNodeParent</b> <br>  ,      "link". ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( 'a' ); // true/false</code> <br> <br>    Chrome, Firefox, IE10 (+IE7 Mode) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/Suitup</a> <br> <br>   extended-commands.suitup.jquery.js     .    50        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b>UPD</b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> 1.          . ,  bold  Chrome     b,   IE   strong. <br> 2.          (      ). <br> 3.    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> </li> <li> <code><code>, ,     IE,        execCommand( 'formatblock' ... )</code>   .   :     " ",       .   IE...    ?..     <code>queryCommandValue( 'formatblock' )</code>  <code>" 1", " 2", ""</code> , .     , , , ,         .     ,    IE10. ,  ,    IE10!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  SuitUp <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript">$( '.my-textarea' ).suitUp();</code> <br>       : <br> <code class="javascript">$( '.my-textarea' ).suitUp( 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' );</code> <br>       <br> <code class="javascript">$( '.my-textarea' ).suitUp([ 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , 'forecolor',      : <br> <br> 1. ,  :  forecolor    red: <br> <code class="javascript">$.suitUp.commands = { forecolor: 'red' }</code> <br>  <br> <code class="javascript">$.extend( jQuery.suitUp.commands, { forecolor: 'red' })</code> <br>  <br> <code class="javascript">$.suitUp.commands.forecolor = 'red' // ( ,  commands -  )</code> <br> : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> 2.   () <br> <code class="javascript">$.suitUp.commands.forecolor = { 'Make Red': 'red', 'Make Green': 'green' }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> 3. ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( ' ', '' ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript">$( 'textarea' ).suitUp( 'italic', 'bold', '|', 'link', 'formatblock#&lt;h1&gt;' );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> 1.  Bold. <br> 2.  . <br> 3. ,             "". <br> <br>  ,        . <br> <br> <code class="javascript">$.extend( $.suitUp.commands, { bold: null, //   ,        null fontname: { Arial: 'arial', Times: 'times', Verdana: 'verdana' }, forecolor: function( callback ){ var blackBackground = $( '&lt;div/&gt;' ).css({ background: 'black', position: 'absolute', top: 0, left:0, opacity: .5, width: '100%', height: '100%' }).on( 'click', function(){ popup.add( this ).remove(); }).appendTo('body'), popup = $( '&lt;div/&gt;' ).css({ padding: '10px 20px', width: 200, position: 'absolute', background: 'white', top: 200, left: $( window ).width()/2 - 110, zIndex: 100 }).appendTo('body'); $( '&lt;input/&gt;' ).appendTo( popup ); $( '&lt;button/&gt;' ).appendTo( popup ).text( 'Go!' ).on( 'click', function() { var val = popup.children( 'input' ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor' );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . Callback   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( 'forecolor', false, ' ' );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript">$.suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript">$.extend( jQuery.suitUp.custom, { helloWorld: function() { return $( '&lt;span/&gt;', { 'class': 'suitup-control' //    }).css( 'backgroundColor', 'red' ).on( 'click', function() { alert( 'Hello World!' ); }); } });</code> <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor', 'helloWorld' );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       "link",     ( "createlink"),      ( "unlink"). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( 'a', { className: 'suitup-control', href: '#' }).attr({ 'data-command': 'createlink' //         createlink }).on( 'click', function() { if( !$.suitUp.hasSelectedNodeParent( 'a' ) ) { document.execCommand( 'createlink', false, window.prompt( 'URL:', '' ) ); } else { document.execCommand( 'unlink', false, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor#red</code> )    : <br>  .   .  , ""  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript">$.suitUp.controls = [ 'bold', 'italic' ]; $( '.suitup-textarea' ).suitUp(); //    ,   $( '.suitup-textarea' ).suitUp( 'bold', 'italic' );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript">$.suitUp.controls.push( 'forecolor' ); $( '.suitup-textarea' ).suitUp();</code> <br>   : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( $.suitUp.controls.concat([ 'forecolor' ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   $.suitUp   .  ,            .      ,      ,  . <br> <br> <b>$.suitUp.getSelection</b> <br>   .          . <br> <br> <b>$.suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = $.suitUp.getSelection(); //  -,     $( '.suitup-editor' ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b>$.suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b>$.suitUp.hasSelectedNodeParent</b> <br>  ,      "link". ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( 'a' ); // true/false</code> <br> <br>    Chrome, Firefox, IE10 (+IE7 Mode) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/Suitup</a> <br> <br>   extended-commands.suitup.jquery.js     .    50        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b>UPD</b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> 1.          . ,  bold  Chrome     b,   IE   strong. <br> 2.          (      ). <br> 3.    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> </li> </ol> <code><code>, ,     IE,        execCommand( 'formatblock' ... )</code>   .   :     " ",       .   IE...    ?..     <code>queryCommandValue( 'formatblock' )</code>  <code>" 1", " 2", ""</code> , .     , , , ,         .     ,    IE10. ,  ,    IE10!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  SuitUp <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript">$( '.my-textarea' ).suitUp();</code> <br>       : <br> <code class="javascript">$( '.my-textarea' ).suitUp( 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' );</code> <br>       <br> <code class="javascript">$( '.my-textarea' ).suitUp([ 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , 'forecolor',      : <br> <br> 1. ,  :  forecolor    red: <br> <code class="javascript">$.suitUp.commands = { forecolor: 'red' }</code> <br>  <br> <code class="javascript">$.extend( jQuery.suitUp.commands, { forecolor: 'red' })</code> <br>  <br> <code class="javascript">$.suitUp.commands.forecolor = 'red' // ( ,  commands -  )</code> <br> : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> 2.   () <br> <code class="javascript">$.suitUp.commands.forecolor = { 'Make Red': 'red', 'Make Green': 'green' }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> 3. ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( ' ', '' ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript">$( 'textarea' ).suitUp( 'italic', 'bold', '|', 'link', 'formatblock#&lt;h1&gt;' );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> 1.  Bold. <br> 2.  . <br> 3. ,             "". <br> <br>  ,        . <br> <br> <code class="javascript">$.extend( $.suitUp.commands, { bold: null, //   ,        null fontname: { Arial: 'arial', Times: 'times', Verdana: 'verdana' }, forecolor: function( callback ){ var blackBackground = $( '&lt;div/&gt;' ).css({ background: 'black', position: 'absolute', top: 0, left:0, opacity: .5, width: '100%', height: '100%' }).on( 'click', function(){ popup.add( this ).remove(); }).appendTo('body'), popup = $( '&lt;div/&gt;' ).css({ padding: '10px 20px', width: 200, position: 'absolute', background: 'white', top: 200, left: $( window ).width()/2 - 110, zIndex: 100 }).appendTo('body'); $( '&lt;input/&gt;' ).appendTo( popup ); $( '&lt;button/&gt;' ).appendTo( popup ).text( 'Go!' ).on( 'click', function() { var val = popup.children( 'input' ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor' );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . Callback   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( 'forecolor', false, ' ' );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript">$.suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript">$.extend( jQuery.suitUp.custom, { helloWorld: function() { return $( '&lt;span/&gt;', { 'class': 'suitup-control' //    }).css( 'backgroundColor', 'red' ).on( 'click', function() { alert( 'Hello World!' ); }); } });</code> <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor', 'helloWorld' );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       "link",     ( "createlink"),      ( "unlink"). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( 'a', { className: 'suitup-control', href: '#' }).attr({ 'data-command': 'createlink' //         createlink }).on( 'click', function() { if( !$.suitUp.hasSelectedNodeParent( 'a' ) ) { document.execCommand( 'createlink', false, window.prompt( 'URL:', '' ) ); } else { document.execCommand( 'unlink', false, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor#red</code> )    : <br>  .   .  , ""  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript">$.suitUp.controls = [ 'bold', 'italic' ]; $( '.suitup-textarea' ).suitUp(); //    ,   $( '.suitup-textarea' ).suitUp( 'bold', 'italic' );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript">$.suitUp.controls.push( 'forecolor' ); $( '.suitup-textarea' ).suitUp();</code> <br>   : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( $.suitUp.controls.concat([ 'forecolor' ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   $.suitUp   .  ,            .      ,      ,  . <br> <br> <b>$.suitUp.getSelection</b> <br>   .          . <br> <br> <b>$.suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = $.suitUp.getSelection(); //  -,     $( '.suitup-editor' ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b>$.suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b>$.suitUp.hasSelectedNodeParent</b> <br>  ,      "link". ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( 'a' ); // true/false</code> <br> <br>    Chrome, Firefox, IE10 (+IE7 Mode) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/Suitup</a> <br> <br>   extended-commands.suitup.jquery.js     .    50        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b>UPD</b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> 1.          . ,  bold  Chrome     b,   IE   strong. <br> 2.          (      ). <br> 3.    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> </li><li> <code><code>, ,     IE,        execCommand( 'formatblock' ... )</code>   .   :     " ",       .   IE...    ?..     <code>queryCommandValue( 'formatblock' )</code>  <code>" 1", " 2", ""</code> , .     , , , ,         .     ,    IE10. ,  ,    IE10!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  SuitUp <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript">$( '.my-textarea' ).suitUp();</code> <br>       : <br> <code class="javascript">$( '.my-textarea' ).suitUp( 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' );</code> <br>       <br> <code class="javascript">$( '.my-textarea' ).suitUp([ 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , 'forecolor',      : <br> <br> 1. ,  :  forecolor    red: <br> <code class="javascript">$.suitUp.commands = { forecolor: 'red' }</code> <br>  <br> <code class="javascript">$.extend( jQuery.suitUp.commands, { forecolor: 'red' })</code> <br>  <br> <code class="javascript">$.suitUp.commands.forecolor = 'red' // ( ,  commands -  )</code> <br> : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> 2.   () <br> <code class="javascript">$.suitUp.commands.forecolor = { 'Make Red': 'red', 'Make Green': 'green' }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> 3. ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( ' ', '' ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript">$( 'textarea' ).suitUp( 'italic', 'bold', '|', 'link', 'formatblock#&lt;h1&gt;' );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> 1.  Bold. <br> 2.  . <br> 3. ,             "". <br> <br>  ,        . <br> <br> <code class="javascript">$.extend( $.suitUp.commands, { bold: null, //   ,        null fontname: { Arial: 'arial', Times: 'times', Verdana: 'verdana' }, forecolor: function( callback ){ var blackBackground = $( '&lt;div/&gt;' ).css({ background: 'black', position: 'absolute', top: 0, left:0, opacity: .5, width: '100%', height: '100%' }).on( 'click', function(){ popup.add( this ).remove(); }).appendTo('body'), popup = $( '&lt;div/&gt;' ).css({ padding: '10px 20px', width: 200, position: 'absolute', background: 'white', top: 200, left: $( window ).width()/2 - 110, zIndex: 100 }).appendTo('body'); $( '&lt;input/&gt;' ).appendTo( popup ); $( '&lt;button/&gt;' ).appendTo( popup ).text( 'Go!' ).on( 'click', function() { var val = popup.children( 'input' ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor' );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . Callback   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( 'forecolor', false, ' ' );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript">$.suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript">$.extend( jQuery.suitUp.custom, { helloWorld: function() { return $( '&lt;span/&gt;', { 'class': 'suitup-control' //    }).css( 'backgroundColor', 'red' ).on( 'click', function() { alert( 'Hello World!' ); }); } });</code> <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor', 'helloWorld' );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       "link",     ( "createlink"),      ( "unlink"). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( 'a', { className: 'suitup-control', href: '#' }).attr({ 'data-command': 'createlink' //         createlink }).on( 'click', function() { if( !$.suitUp.hasSelectedNodeParent( 'a' ) ) { document.execCommand( 'createlink', false, window.prompt( 'URL:', '' ) ); } else { document.execCommand( 'unlink', false, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor#red</code> )    : <br>  .   .  , ""  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript">$.suitUp.controls = [ 'bold', 'italic' ]; $( '.suitup-textarea' ).suitUp(); //    ,   $( '.suitup-textarea' ).suitUp( 'bold', 'italic' );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript">$.suitUp.controls.push( 'forecolor' ); $( '.suitup-textarea' ).suitUp();</code> <br>   : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( $.suitUp.controls.concat([ 'forecolor' ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   $.suitUp   .  ,            .      ,      ,  . <br> <br> <b>$.suitUp.getSelection</b> <br>   .          . <br> <br> <b>$.suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = $.suitUp.getSelection(); //  -,     $( '.suitup-editor' ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b>$.suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b>$.suitUp.hasSelectedNodeParent</b> <br>  ,      "link". ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( 'a' ); // true/false</code> <br> <br>    Chrome, Firefox, IE10 (+IE7 Mode) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/Suitup</a> <br> <br>   extended-commands.suitup.jquery.js     .    50        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b>UPD</b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> 1.          . ,  bold  Chrome     b,   IE   strong. <br> 2.          (      ). <br> 3.    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> </li> </ul> <code><code>, ,     IE,        execCommand( 'formatblock' ... )</code>   .   :     " ",       .   IE...    ?..     <code>queryCommandValue( 'formatblock' )</code>  <code>" 1", " 2", ""</code> , .     , , , ,         .     ,    IE10. ,  ,    IE10!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  SuitUp <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript">$( '.my-textarea' ).suitUp();</code> <br>       : <br> <code class="javascript">$( '.my-textarea' ).suitUp( 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' );</code> <br>       <br> <code class="javascript">$( '.my-textarea' ).suitUp([ 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , 'forecolor',      : <br> <br> 1. ,  :  forecolor    red: <br> <code class="javascript">$.suitUp.commands = { forecolor: 'red' }</code> <br>  <br> <code class="javascript">$.extend( jQuery.suitUp.commands, { forecolor: 'red' })</code> <br>  <br> <code class="javascript">$.suitUp.commands.forecolor = 'red' // ( ,  commands -  )</code> <br> : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> 2.   () <br> <code class="javascript">$.suitUp.commands.forecolor = { 'Make Red': 'red', 'Make Green': 'green' }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> 3. ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( ' ', '' ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript">$( 'textarea' ).suitUp( 'italic', 'bold', '|', 'link', 'formatblock#&lt;h1&gt;' );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> 1.  Bold. <br> 2.  . <br> 3. ,             "". <br> <br>  ,        . <br> <br> <code class="javascript">$.extend( $.suitUp.commands, { bold: null, //   ,        null fontname: { Arial: 'arial', Times: 'times', Verdana: 'verdana' }, forecolor: function( callback ){ var blackBackground = $( '&lt;div/&gt;' ).css({ background: 'black', position: 'absolute', top: 0, left:0, opacity: .5, width: '100%', height: '100%' }).on( 'click', function(){ popup.add( this ).remove(); }).appendTo('body'), popup = $( '&lt;div/&gt;' ).css({ padding: '10px 20px', width: 200, position: 'absolute', background: 'white', top: 200, left: $( window ).width()/2 - 110, zIndex: 100 }).appendTo('body'); $( '&lt;input/&gt;' ).appendTo( popup ); $( '&lt;button/&gt;' ).appendTo( popup ).text( 'Go!' ).on( 'click', function() { var val = popup.children( 'input' ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor' );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . Callback   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( 'forecolor', false, ' ' );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript">$.suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript">$.extend( jQuery.suitUp.custom, { helloWorld: function() { return $( '&lt;span/&gt;', { 'class': 'suitup-control' //    }).css( 'backgroundColor', 'red' ).on( 'click', function() { alert( 'Hello World!' ); }); } });</code> <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor', 'helloWorld' );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       "link",     ( "createlink"),      ( "unlink"). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( 'a', { className: 'suitup-control', href: '#' }).attr({ 'data-command': 'createlink' //         createlink }).on( 'click', function() { if( !$.suitUp.hasSelectedNodeParent( 'a' ) ) { document.execCommand( 'createlink', false, window.prompt( 'URL:', '' ) ); } else { document.execCommand( 'unlink', false, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor#red</code> )    : <br>  .   .  , ""  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript">$.suitUp.controls = [ 'bold', 'italic' ]; $( '.suitup-textarea' ).suitUp(); //    ,   $( '.suitup-textarea' ).suitUp( 'bold', 'italic' );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript">$.suitUp.controls.push( 'forecolor' ); $( '.suitup-textarea' ).suitUp();</code> <br>   : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( $.suitUp.controls.concat([ 'forecolor' ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   $.suitUp   .  ,            .      ,      ,  . <br> <br> <b>$.suitUp.getSelection</b> <br>   .          . <br> <br> <b>$.suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = $.suitUp.getSelection(); //  -,     $( '.suitup-editor' ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b>$.suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b>$.suitUp.hasSelectedNodeParent</b> <br>  ,      "link". ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( 'a' ); // true/false</code> <br> <br>    Chrome, Firefox, IE10 (+IE7 Mode) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/Suitup</a> <br> <br>   extended-commands.suitup.jquery.js     .    50        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b>UPD</b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> 1.          . ,  bold  Chrome     b,   IE   strong. <br> 2.          (      ). <br> 3.    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> <h5> <code><code>, ,     IE,        execCommand( 'formatblock' ... )</code>   .   :     " ",       .   IE...    ?..     <code>queryCommandValue( 'formatblock' )</code>  <code>" 1", " 2", ""</code> , .     , , , ,         .     ,    IE10. ,  ,    IE10!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  SuitUp <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript">$( '.my-textarea' ).suitUp();</code> <br>       : <br> <code class="javascript">$( '.my-textarea' ).suitUp( 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' );</code> <br>       <br> <code class="javascript">$( '.my-textarea' ).suitUp([ 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , 'forecolor',      : <br> <br> 1. ,  :  forecolor    red: <br> <code class="javascript">$.suitUp.commands = { forecolor: 'red' }</code> <br>  <br> <code class="javascript">$.extend( jQuery.suitUp.commands, { forecolor: 'red' })</code> <br>  <br> <code class="javascript">$.suitUp.commands.forecolor = 'red' // ( ,  commands -  )</code> <br> : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> 2.   () <br> <code class="javascript">$.suitUp.commands.forecolor = { 'Make Red': 'red', 'Make Green': 'green' }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> 3. ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( ' ', '' ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript">$( 'textarea' ).suitUp( 'italic', 'bold', '|', 'link', 'formatblock#&lt;h1&gt;' );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> 1.  Bold. <br> 2.  . <br> 3. ,             "". <br> <br>  ,        . <br> <br> <code class="javascript">$.extend( $.suitUp.commands, { bold: null, //   ,        null fontname: { Arial: 'arial', Times: 'times', Verdana: 'verdana' }, forecolor: function( callback ){ var blackBackground = $( '&lt;div/&gt;' ).css({ background: 'black', position: 'absolute', top: 0, left:0, opacity: .5, width: '100%', height: '100%' }).on( 'click', function(){ popup.add( this ).remove(); }).appendTo('body'), popup = $( '&lt;div/&gt;' ).css({ padding: '10px 20px', width: 200, position: 'absolute', background: 'white', top: 200, left: $( window ).width()/2 - 110, zIndex: 100 }).appendTo('body'); $( '&lt;input/&gt;' ).appendTo( popup ); $( '&lt;button/&gt;' ).appendTo( popup ).text( 'Go!' ).on( 'click', function() { var val = popup.children( 'input' ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor' );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . Callback   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( 'forecolor', false, ' ' );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript">$.suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript">$.extend( jQuery.suitUp.custom, { helloWorld: function() { return $( '&lt;span/&gt;', { 'class': 'suitup-control' //    }).css( 'backgroundColor', 'red' ).on( 'click', function() { alert( 'Hello World!' ); }); } });</code> <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor', 'helloWorld' );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       "link",     ( "createlink"),      ( "unlink"). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( 'a', { className: 'suitup-control', href: '#' }).attr({ 'data-command': 'createlink' //         createlink }).on( 'click', function() { if( !$.suitUp.hasSelectedNodeParent( 'a' ) ) { document.execCommand( 'createlink', false, window.prompt( 'URL:', '' ) ); } else { document.execCommand( 'unlink', false, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor#red</code> )    : <br>  .   .  , ""  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript">$.suitUp.controls = [ 'bold', 'italic' ]; $( '.suitup-textarea' ).suitUp(); //    ,   $( '.suitup-textarea' ).suitUp( 'bold', 'italic' );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript">$.suitUp.controls.push( 'forecolor' ); $( '.suitup-textarea' ).suitUp();</code> <br>   : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( $.suitUp.controls.concat([ 'forecolor' ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   $.suitUp   .  ,            .      ,      ,  . <br> <br> <b>$.suitUp.getSelection</b> <br>   .          . <br> <br> <b>$.suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = $.suitUp.getSelection(); //  -,     $( '.suitup-editor' ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b>$.suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b>$.suitUp.hasSelectedNodeParent</b> <br>  ,      "link". ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( 'a' ); // true/false</code> <br> <br>    Chrome, Firefox, IE10 (+IE7 Mode) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/Suitup</a> <br> <br>   extended-commands.suitup.jquery.js     .    50        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b>UPD</b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> 1.          . ,  bold  Chrome     b,   IE   strong. <br> 2.          (      ). <br> 3.    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> </h5> <code><code>, ,     IE,        execCommand( 'formatblock' ... )</code>   .   :     " ",       .   IE...    ?..     <code>queryCommandValue( 'formatblock' )</code>  <code>" 1", " 2", ""</code> , .     , , , ,         .     ,    IE10. ,  ,    IE10!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  SuitUp <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript">$( '.my-textarea' ).suitUp();</code> <br>       : <br> <code class="javascript">$( '.my-textarea' ).suitUp( 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' );</code> <br>       <br> <code class="javascript">$( '.my-textarea' ).suitUp([ 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , 'forecolor',      : <br> <br> 1. ,  :  forecolor    red: <br> <code class="javascript">$.suitUp.commands = { forecolor: 'red' }</code> <br>  <br> <code class="javascript">$.extend( jQuery.suitUp.commands, { forecolor: 'red' })</code> <br>  <br> <code class="javascript">$.suitUp.commands.forecolor = 'red' // ( ,  commands -  )</code> <br> : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> 2.   () <br> <code class="javascript">$.suitUp.commands.forecolor = { 'Make Red': 'red', 'Make Green': 'green' }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> 3. ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( ' ', '' ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript">$( 'textarea' ).suitUp( 'italic', 'bold', '|', 'link', 'formatblock#&lt;h1&gt;' );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> 1.  Bold. <br> 2.  . <br> 3. ,             "". <br> <br>  ,        . <br> <br> <code class="javascript">$.extend( $.suitUp.commands, { bold: null, //   ,        null fontname: { Arial: 'arial', Times: 'times', Verdana: 'verdana' }, forecolor: function( callback ){ var blackBackground = $( '&lt;div/&gt;' ).css({ background: 'black', position: 'absolute', top: 0, left:0, opacity: .5, width: '100%', height: '100%' }).on( 'click', function(){ popup.add( this ).remove(); }).appendTo('body'), popup = $( '&lt;div/&gt;' ).css({ padding: '10px 20px', width: 200, position: 'absolute', background: 'white', top: 200, left: $( window ).width()/2 - 110, zIndex: 100 }).appendTo('body'); $( '&lt;input/&gt;' ).appendTo( popup ); $( '&lt;button/&gt;' ).appendTo( popup ).text( 'Go!' ).on( 'click', function() { var val = popup.children( 'input' ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor' );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . Callback   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( 'forecolor', false, ' ' );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript">$.suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript">$.extend( jQuery.suitUp.custom, { helloWorld: function() { return $( '&lt;span/&gt;', { 'class': 'suitup-control' //    }).css( 'backgroundColor', 'red' ).on( 'click', function() { alert( 'Hello World!' ); }); } });</code> <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor', 'helloWorld' );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       "link",     ( "createlink"),      ( "unlink"). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( 'a', { className: 'suitup-control', href: '#' }).attr({ 'data-command': 'createlink' //         createlink }).on( 'click', function() { if( !$.suitUp.hasSelectedNodeParent( 'a' ) ) { document.execCommand( 'createlink', false, window.prompt( 'URL:', '' ) ); } else { document.execCommand( 'unlink', false, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor#red</code> )    : <br>  .   .  , ""  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript">$.suitUp.controls = [ 'bold', 'italic' ]; $( '.suitup-textarea' ).suitUp(); //    ,   $( '.suitup-textarea' ).suitUp( 'bold', 'italic' );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript">$.suitUp.controls.push( 'forecolor' ); $( '.suitup-textarea' ).suitUp();</code> <br>   : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( $.suitUp.controls.concat([ 'forecolor' ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   $.suitUp   .  ,            .      ,      ,  . <br> <br> <b>$.suitUp.getSelection</b> <br>   .          . <br> <br> <b>$.suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = $.suitUp.getSelection(); //  -,     $( '.suitup-editor' ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b>$.suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b>$.suitUp.hasSelectedNodeParent</b> <br>  ,      "link". ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( 'a' ); // true/false</code> <br> <br>    Chrome, Firefox, IE10 (+IE7 Mode) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/Suitup</a> <br> <br>   extended-commands.suitup.jquery.js     .    50        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b>UPD</b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> 1.          . ,  bold  Chrome     b,   IE   strong. <br> 2.          (      ). <br> 3.    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> <pre> <code class="hljs smalltalk"><code>, ,     <span class="hljs-type"><span class="hljs-type">IE</span></span>,        execCommand( <span class="hljs-string"><span class="hljs-string">'formatblock'</span></span> ... )</code>   .   :     <span class="hljs-comment"><span class="hljs-comment">" "</span></span>,       .   <span class="hljs-type"><span class="hljs-type">IE</span></span>...    ?..     <code>queryCommandValue( <span class="hljs-string"><span class="hljs-string">'formatblock'</span></span> )</code>  <code><span class="hljs-comment"><span class="hljs-comment">" 1"</span></span>, <span class="hljs-comment"><span class="hljs-comment">" 2"</span></span>, <span class="hljs-comment"><span class="hljs-comment">""</span></span></code> , .     , , , ,         .     ,    <span class="hljs-type"><span class="hljs-type">IE10</span></span>. ,  ,    <span class="hljs-type"><span class="hljs-type">IE10</span></span>!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  <span class="hljs-type"><span class="hljs-type">SuitUp</span></span> <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp();</code> <br>       : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> );</code> <br>       <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp([ <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>,      : <br> <br> <span class="hljs-number"><span class="hljs-number">1.</span></span> ,  :  forecolor    red: <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands = { forecolor: <span class="hljs-string"><span class="hljs-string">'red'</span></span> }</code> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( jQuery.suitUp.commands, { forecolor: <span class="hljs-string"><span class="hljs-string">'red'</span></span> })</code> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands.forecolor = <span class="hljs-string"><span class="hljs-string">'red'</span></span> // ( ,  commands -  )</code> <br> : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>   () <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands.forecolor = { <span class="hljs-string"><span class="hljs-string">'Make Red'</span></span>: <span class="hljs-string"><span class="hljs-string">'red'</span></span>, <span class="hljs-string"><span class="hljs-string">'Make Green'</span></span>: <span class="hljs-string"><span class="hljs-string">'green'</span></span> }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> <span class="hljs-number"><span class="hljs-number">3.</span></span> ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span> ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'link'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> <span class="hljs-number"><span class="hljs-number">1.</span></span>  <span class="hljs-type"><span class="hljs-type">Bold</span></span>. <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>  . <br> <span class="hljs-number"><span class="hljs-number">3.</span></span> ,             <span class="hljs-comment"><span class="hljs-comment">""</span></span>. <br> <br>  ,        . <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands, { bold: null, //   ,        null fontname: { <span class="hljs-type"><span class="hljs-type">Arial</span></span>: <span class="hljs-string"><span class="hljs-string">'arial'</span></span>, <span class="hljs-type"><span class="hljs-type">Times</span></span>: <span class="hljs-string"><span class="hljs-string">'times'</span></span>, <span class="hljs-type"><span class="hljs-type">Verdana</span></span>: <span class="hljs-string"><span class="hljs-string">'verdana'</span></span> }, forecolor: function( callback ){ var blackBackground = <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;div/&gt;'</span></span> ).css({ background: <span class="hljs-string"><span class="hljs-string">'black'</span></span>, position: <span class="hljs-string"><span class="hljs-string">'absolute'</span></span>, top: <span class="hljs-number"><span class="hljs-number">0</span></span>, left:<span class="hljs-number"><span class="hljs-number">0</span></span>, opacity: <span class="hljs-number"><span class="hljs-number">.5</span></span>, width: <span class="hljs-string"><span class="hljs-string">'100%'</span></span>, height: <span class="hljs-string"><span class="hljs-string">'100%'</span></span> }).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function(){ popup.add( this ).remove(); }).appendTo(<span class="hljs-string"><span class="hljs-string">'body'</span></span>), popup = <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;div/&gt;'</span></span> ).css({ padding: <span class="hljs-string"><span class="hljs-string">'10px 20px'</span></span>, width: <span class="hljs-number"><span class="hljs-number">200</span></span>, position: <span class="hljs-string"><span class="hljs-string">'absolute'</span></span>, background: <span class="hljs-string"><span class="hljs-string">'white'</span></span>, top: <span class="hljs-number"><span class="hljs-number">200</span></span>, left: <span class="hljs-string"><span class="hljs-string">$(</span></span> window ).width()/<span class="hljs-number"><span class="hljs-number">2</span></span> - <span class="hljs-number"><span class="hljs-number">110</span></span>, zIndex: <span class="hljs-number"><span class="hljs-number">100</span></span> }).appendTo(<span class="hljs-string"><span class="hljs-string">'body'</span></span>); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;input/&gt;'</span></span> ).appendTo( popup ); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;button/&gt;'</span></span> ).appendTo( popup ).text( <span class="hljs-string"><span class="hljs-string">'Go!'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { var val = popup.children( <span class="hljs-string"><span class="hljs-string">'input'</span></span> ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'fontname'</span></span>, <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . <span class="hljs-type"><span class="hljs-type">Callback</span></span>   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span> );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( jQuery.suitUp.custom, { helloWorld: function() { return <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;span/&gt;'</span></span>, { <span class="hljs-string"><span class="hljs-string">'class'</span></span>: <span class="hljs-string"><span class="hljs-string">'suitup-control'</span></span> //    }).css( <span class="hljs-string"><span class="hljs-string">'backgroundColor'</span></span>, <span class="hljs-string"><span class="hljs-string">'red'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { alert( <span class="hljs-string"><span class="hljs-string">'Hello World!'</span></span> ); }); } });</code> <br> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'fontname'</span></span>, <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>, <span class="hljs-string"><span class="hljs-string">'helloWorld'</span></span> );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       <span class="hljs-comment"><span class="hljs-comment">"link"</span></span>,     ( <span class="hljs-comment"><span class="hljs-comment">"createlink"</span></span>),      ( <span class="hljs-comment"><span class="hljs-comment">"unlink"</span></span>). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( <span class="hljs-string"><span class="hljs-string">'a'</span></span>, { className: <span class="hljs-string"><span class="hljs-string">'suitup-control'</span></span>, href: <span class="hljs-string"><span class="hljs-string">'#'</span></span> }).attr({ <span class="hljs-string"><span class="hljs-string">'data-command'</span></span>: <span class="hljs-string"><span class="hljs-string">'createlink'</span></span> //         createlink }).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { if( !<span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.hasSelectedNodeParent( <span class="hljs-string"><span class="hljs-string">'a'</span></span> ) ) { document.execCommand( <span class="hljs-string"><span class="hljs-string">'createlink'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, window.prompt( <span class="hljs-string"><span class="hljs-string">'URL:'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span> ) ); } else { document.execCommand( <span class="hljs-string"><span class="hljs-string">'unlink'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor<span class="hljs-symbol"><span class="hljs-symbol">#red</span></span></code> )    : <br>  .   .  , <span class="hljs-comment"><span class="hljs-comment">""</span></span>  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls = [ <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'italic'</span></span> ]; <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp(); //    ,   <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'italic'</span></span> );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls.push( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp();</code> <br>   : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls.concat([ <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp   .  ,            .      ,      ,  . <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelection</b> <br>   .          . <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelection(); //  -,     <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-editor'</span></span> ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.hasSelectedNodeParent</b> <br>  ,      <span class="hljs-comment"><span class="hljs-comment">"link"</span></span>. ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( <span class="hljs-string"><span class="hljs-string">'a'</span></span> ); // <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">false</span></span></code> <br> <br>    <span class="hljs-type"><span class="hljs-type">Chrome</span></span>, <span class="hljs-type"><span class="hljs-type">Firefox</span></span>, <span class="hljs-type"><span class="hljs-type">IE10</span></span> (+<span class="hljs-type"><span class="hljs-type">IE7</span></span> <span class="hljs-type"><span class="hljs-type">Mode</span></span>) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/<span class="hljs-type"><span class="hljs-type">Suitup</span></span></a> <br> <br>   extended-commands.suitup.jquery.js     .    <span class="hljs-number"><span class="hljs-number">50</span></span>        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b><span class="hljs-type"><span class="hljs-type">UPD</span></span></b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> <span class="hljs-number"><span class="hljs-number">1.</span></span>          . ,  bold  <span class="hljs-type"><span class="hljs-type">Chrome</span></span>     b,   <span class="hljs-type"><span class="hljs-type">IE</span></span>   strong. <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>          (      ). <br> <span class="hljs-number"><span class="hljs-number">3.</span></span>    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> </pre> <code><code>, ,     IE,        execCommand( 'formatblock' ... )</code>   .   :     " ",       .   IE...    ?..     <code>queryCommandValue( 'formatblock' )</code>  <code>" 1", " 2", ""</code> , .     , , , ,         .     ,    IE10. ,  ,    IE10!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  SuitUp <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript">$( '.my-textarea' ).suitUp();</code> <br>       : <br> <code class="javascript">$( '.my-textarea' ).suitUp( 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' );</code> <br>       <br> <code class="javascript">$( '.my-textarea' ).suitUp([ 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , 'forecolor',      : <br> <br> 1. ,  :  forecolor    red: <br> <code class="javascript">$.suitUp.commands = { forecolor: 'red' }</code> <br>  <br> <code class="javascript">$.extend( jQuery.suitUp.commands, { forecolor: 'red' })</code> <br>  <br> <code class="javascript">$.suitUp.commands.forecolor = 'red' // ( ,  commands -  )</code> <br> : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> 2.   () <br> <code class="javascript">$.suitUp.commands.forecolor = { 'Make Red': 'red', 'Make Green': 'green' }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> 3. ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( ' ', '' ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript">$( 'textarea' ).suitUp( 'italic', 'bold', '|', 'link', 'formatblock#&lt;h1&gt;' );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> 1.  Bold. <br> 2.  . <br> 3. ,             "". <br> <br>  ,        . <br> <br> <code class="javascript">$.extend( $.suitUp.commands, { bold: null, //   ,        null fontname: { Arial: 'arial', Times: 'times', Verdana: 'verdana' }, forecolor: function( callback ){ var blackBackground = $( '&lt;div/&gt;' ).css({ background: 'black', position: 'absolute', top: 0, left:0, opacity: .5, width: '100%', height: '100%' }).on( 'click', function(){ popup.add( this ).remove(); }).appendTo('body'), popup = $( '&lt;div/&gt;' ).css({ padding: '10px 20px', width: 200, position: 'absolute', background: 'white', top: 200, left: $( window ).width()/2 - 110, zIndex: 100 }).appendTo('body'); $( '&lt;input/&gt;' ).appendTo( popup ); $( '&lt;button/&gt;' ).appendTo( popup ).text( 'Go!' ).on( 'click', function() { var val = popup.children( 'input' ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor' );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . Callback   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( 'forecolor', false, ' ' );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript">$.suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript">$.extend( jQuery.suitUp.custom, { helloWorld: function() { return $( '&lt;span/&gt;', { 'class': 'suitup-control' //    }).css( 'backgroundColor', 'red' ).on( 'click', function() { alert( 'Hello World!' ); }); } });</code> <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor', 'helloWorld' );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       "link",     ( "createlink"),      ( "unlink"). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( 'a', { className: 'suitup-control', href: '#' }).attr({ 'data-command': 'createlink' //         createlink }).on( 'click', function() { if( !$.suitUp.hasSelectedNodeParent( 'a' ) ) { document.execCommand( 'createlink', false, window.prompt( 'URL:', '' ) ); } else { document.execCommand( 'unlink', false, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor#red</code> )    : <br>  .   .  , ""  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript">$.suitUp.controls = [ 'bold', 'italic' ]; $( '.suitup-textarea' ).suitUp(); //    ,   $( '.suitup-textarea' ).suitUp( 'bold', 'italic' );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript">$.suitUp.controls.push( 'forecolor' ); $( '.suitup-textarea' ).suitUp();</code> <br>   : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( $.suitUp.controls.concat([ 'forecolor' ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   $.suitUp   .  ,            .      ,      ,  . <br> <br> <b>$.suitUp.getSelection</b> <br>   .          . <br> <br> <b>$.suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = $.suitUp.getSelection(); //  -,     $( '.suitup-editor' ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b>$.suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b>$.suitUp.hasSelectedNodeParent</b> <br>  ,      "link". ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( 'a' ); // true/false</code> <br> <br>    Chrome, Firefox, IE10 (+IE7 Mode) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/Suitup</a> <br> <br>   extended-commands.suitup.jquery.js     .    50        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b>UPD</b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> 1.          . ,  bold  Chrome     b,   IE   strong. <br> 2.          (      ). <br> 3.    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> <pre> <code class="hljs smalltalk"><code>, ,     <span class="hljs-type"><span class="hljs-type">IE</span></span>,        execCommand( <span class="hljs-string"><span class="hljs-string">'formatblock'</span></span> ... )</code>   .   :     <span class="hljs-comment"><span class="hljs-comment">" "</span></span>,       .   <span class="hljs-type"><span class="hljs-type">IE</span></span>...    ?..     <code>queryCommandValue( <span class="hljs-string"><span class="hljs-string">'formatblock'</span></span> )</code>  <code><span class="hljs-comment"><span class="hljs-comment">" 1"</span></span>, <span class="hljs-comment"><span class="hljs-comment">" 2"</span></span>, <span class="hljs-comment"><span class="hljs-comment">""</span></span></code> , .     , , , ,         .     ,    <span class="hljs-type"><span class="hljs-type">IE10</span></span>. ,  ,    <span class="hljs-type"><span class="hljs-type">IE10</span></span>!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  <span class="hljs-type"><span class="hljs-type">SuitUp</span></span> <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp();</code> <br>       : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> );</code> <br>       <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp([ <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>,      : <br> <br> <span class="hljs-number"><span class="hljs-number">1.</span></span> ,  :  forecolor    red: <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands = { forecolor: <span class="hljs-string"><span class="hljs-string">'red'</span></span> }</code> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( jQuery.suitUp.commands, { forecolor: <span class="hljs-string"><span class="hljs-string">'red'</span></span> })</code> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands.forecolor = <span class="hljs-string"><span class="hljs-string">'red'</span></span> // ( ,  commands -  )</code> <br> : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>   () <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands.forecolor = { <span class="hljs-string"><span class="hljs-string">'Make Red'</span></span>: <span class="hljs-string"><span class="hljs-string">'red'</span></span>, <span class="hljs-string"><span class="hljs-string">'Make Green'</span></span>: <span class="hljs-string"><span class="hljs-string">'green'</span></span> }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> <span class="hljs-number"><span class="hljs-number">3.</span></span> ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span> ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'link'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> <span class="hljs-number"><span class="hljs-number">1.</span></span>  <span class="hljs-type"><span class="hljs-type">Bold</span></span>. <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>  . <br> <span class="hljs-number"><span class="hljs-number">3.</span></span> ,             <span class="hljs-comment"><span class="hljs-comment">""</span></span>. <br> <br>  ,        . <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands, { bold: null, //   ,        null fontname: { <span class="hljs-type"><span class="hljs-type">Arial</span></span>: <span class="hljs-string"><span class="hljs-string">'arial'</span></span>, <span class="hljs-type"><span class="hljs-type">Times</span></span>: <span class="hljs-string"><span class="hljs-string">'times'</span></span>, <span class="hljs-type"><span class="hljs-type">Verdana</span></span>: <span class="hljs-string"><span class="hljs-string">'verdana'</span></span> }, forecolor: function( callback ){ var blackBackground = <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;div/&gt;'</span></span> ).css({ background: <span class="hljs-string"><span class="hljs-string">'black'</span></span>, position: <span class="hljs-string"><span class="hljs-string">'absolute'</span></span>, top: <span class="hljs-number"><span class="hljs-number">0</span></span>, left:<span class="hljs-number"><span class="hljs-number">0</span></span>, opacity: <span class="hljs-number"><span class="hljs-number">.5</span></span>, width: <span class="hljs-string"><span class="hljs-string">'100%'</span></span>, height: <span class="hljs-string"><span class="hljs-string">'100%'</span></span> }).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function(){ popup.add( this ).remove(); }).appendTo(<span class="hljs-string"><span class="hljs-string">'body'</span></span>), popup = <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;div/&gt;'</span></span> ).css({ padding: <span class="hljs-string"><span class="hljs-string">'10px 20px'</span></span>, width: <span class="hljs-number"><span class="hljs-number">200</span></span>, position: <span class="hljs-string"><span class="hljs-string">'absolute'</span></span>, background: <span class="hljs-string"><span class="hljs-string">'white'</span></span>, top: <span class="hljs-number"><span class="hljs-number">200</span></span>, left: <span class="hljs-string"><span class="hljs-string">$(</span></span> window ).width()/<span class="hljs-number"><span class="hljs-number">2</span></span> - <span class="hljs-number"><span class="hljs-number">110</span></span>, zIndex: <span class="hljs-number"><span class="hljs-number">100</span></span> }).appendTo(<span class="hljs-string"><span class="hljs-string">'body'</span></span>); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;input/&gt;'</span></span> ).appendTo( popup ); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;button/&gt;'</span></span> ).appendTo( popup ).text( <span class="hljs-string"><span class="hljs-string">'Go!'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { var val = popup.children( <span class="hljs-string"><span class="hljs-string">'input'</span></span> ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'fontname'</span></span>, <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . <span class="hljs-type"><span class="hljs-type">Callback</span></span>   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span> );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( jQuery.suitUp.custom, { helloWorld: function() { return <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;span/&gt;'</span></span>, { <span class="hljs-string"><span class="hljs-string">'class'</span></span>: <span class="hljs-string"><span class="hljs-string">'suitup-control'</span></span> //    }).css( <span class="hljs-string"><span class="hljs-string">'backgroundColor'</span></span>, <span class="hljs-string"><span class="hljs-string">'red'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { alert( <span class="hljs-string"><span class="hljs-string">'Hello World!'</span></span> ); }); } });</code> <br> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'fontname'</span></span>, <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>, <span class="hljs-string"><span class="hljs-string">'helloWorld'</span></span> );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       <span class="hljs-comment"><span class="hljs-comment">"link"</span></span>,     ( <span class="hljs-comment"><span class="hljs-comment">"createlink"</span></span>),      ( <span class="hljs-comment"><span class="hljs-comment">"unlink"</span></span>). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( <span class="hljs-string"><span class="hljs-string">'a'</span></span>, { className: <span class="hljs-string"><span class="hljs-string">'suitup-control'</span></span>, href: <span class="hljs-string"><span class="hljs-string">'#'</span></span> }).attr({ <span class="hljs-string"><span class="hljs-string">'data-command'</span></span>: <span class="hljs-string"><span class="hljs-string">'createlink'</span></span> //         createlink }).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { if( !<span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.hasSelectedNodeParent( <span class="hljs-string"><span class="hljs-string">'a'</span></span> ) ) { document.execCommand( <span class="hljs-string"><span class="hljs-string">'createlink'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, window.prompt( <span class="hljs-string"><span class="hljs-string">'URL:'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span> ) ); } else { document.execCommand( <span class="hljs-string"><span class="hljs-string">'unlink'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor<span class="hljs-symbol"><span class="hljs-symbol">#red</span></span></code> )    : <br>  .   .  , <span class="hljs-comment"><span class="hljs-comment">""</span></span>  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls = [ <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'italic'</span></span> ]; <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp(); //    ,   <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'italic'</span></span> );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls.push( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp();</code> <br>   : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls.concat([ <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp   .  ,            .      ,      ,  . <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelection</b> <br>   .          . <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelection(); //  -,     <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-editor'</span></span> ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.hasSelectedNodeParent</b> <br>  ,      <span class="hljs-comment"><span class="hljs-comment">"link"</span></span>. ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( <span class="hljs-string"><span class="hljs-string">'a'</span></span> ); // <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">false</span></span></code> <br> <br>    <span class="hljs-type"><span class="hljs-type">Chrome</span></span>, <span class="hljs-type"><span class="hljs-type">Firefox</span></span>, <span class="hljs-type"><span class="hljs-type">IE10</span></span> (+<span class="hljs-type"><span class="hljs-type">IE7</span></span> <span class="hljs-type"><span class="hljs-type">Mode</span></span>) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/<span class="hljs-type"><span class="hljs-type">Suitup</span></span></a> <br> <br>   extended-commands.suitup.jquery.js     .    <span class="hljs-number"><span class="hljs-number">50</span></span>        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b><span class="hljs-type"><span class="hljs-type">UPD</span></span></b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> <span class="hljs-number"><span class="hljs-number">1.</span></span>          . ,  bold  <span class="hljs-type"><span class="hljs-type">Chrome</span></span>     b,   <span class="hljs-type"><span class="hljs-type">IE</span></span>   strong. <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>          (      ). <br> <span class="hljs-number"><span class="hljs-number">3.</span></span>    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> </pre> <code><code>, ,     IE,        execCommand( 'formatblock' ... )</code>   .   :     " ",       .   IE...    ?..     <code>queryCommandValue( 'formatblock' )</code>  <code>" 1", " 2", ""</code> , .     , , , ,         .     ,    IE10. ,  ,    IE10!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  SuitUp <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript">$( '.my-textarea' ).suitUp();</code> <br>       : <br> <code class="javascript">$( '.my-textarea' ).suitUp( 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' );</code> <br>       <br> <code class="javascript">$( '.my-textarea' ).suitUp([ 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , 'forecolor',      : <br> <br> 1. ,  :  forecolor    red: <br> <code class="javascript">$.suitUp.commands = { forecolor: 'red' }</code> <br>  <br> <code class="javascript">$.extend( jQuery.suitUp.commands, { forecolor: 'red' })</code> <br>  <br> <code class="javascript">$.suitUp.commands.forecolor = 'red' // ( ,  commands -  )</code> <br> : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> 2.   () <br> <code class="javascript">$.suitUp.commands.forecolor = { 'Make Red': 'red', 'Make Green': 'green' }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> 3. ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( ' ', '' ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript">$( 'textarea' ).suitUp( 'italic', 'bold', '|', 'link', 'formatblock#&lt;h1&gt;' );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> 1.  Bold. <br> 2.  . <br> 3. ,             "". <br> <br>  ,        . <br> <br> <code class="javascript">$.extend( $.suitUp.commands, { bold: null, //   ,        null fontname: { Arial: 'arial', Times: 'times', Verdana: 'verdana' }, forecolor: function( callback ){ var blackBackground = $( '&lt;div/&gt;' ).css({ background: 'black', position: 'absolute', top: 0, left:0, opacity: .5, width: '100%', height: '100%' }).on( 'click', function(){ popup.add( this ).remove(); }).appendTo('body'), popup = $( '&lt;div/&gt;' ).css({ padding: '10px 20px', width: 200, position: 'absolute', background: 'white', top: 200, left: $( window ).width()/2 - 110, zIndex: 100 }).appendTo('body'); $( '&lt;input/&gt;' ).appendTo( popup ); $( '&lt;button/&gt;' ).appendTo( popup ).text( 'Go!' ).on( 'click', function() { var val = popup.children( 'input' ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor' );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . Callback   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( 'forecolor', false, ' ' );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript">$.suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript">$.extend( jQuery.suitUp.custom, { helloWorld: function() { return $( '&lt;span/&gt;', { 'class': 'suitup-control' //    }).css( 'backgroundColor', 'red' ).on( 'click', function() { alert( 'Hello World!' ); }); } });</code> <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor', 'helloWorld' );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       "link",     ( "createlink"),      ( "unlink"). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( 'a', { className: 'suitup-control', href: '#' }).attr({ 'data-command': 'createlink' //         createlink }).on( 'click', function() { if( !$.suitUp.hasSelectedNodeParent( 'a' ) ) { document.execCommand( 'createlink', false, window.prompt( 'URL:', '' ) ); } else { document.execCommand( 'unlink', false, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor#red</code> )    : <br>  .   .  , ""  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript">$.suitUp.controls = [ 'bold', 'italic' ]; $( '.suitup-textarea' ).suitUp(); //    ,   $( '.suitup-textarea' ).suitUp( 'bold', 'italic' );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript">$.suitUp.controls.push( 'forecolor' ); $( '.suitup-textarea' ).suitUp();</code> <br>   : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( $.suitUp.controls.concat([ 'forecolor' ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   $.suitUp   .  ,            .      ,      ,  . <br> <br> <b>$.suitUp.getSelection</b> <br>   .          . <br> <br> <b>$.suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = $.suitUp.getSelection(); //  -,     $( '.suitup-editor' ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b>$.suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b>$.suitUp.hasSelectedNodeParent</b> <br>  ,      "link". ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( 'a' ); // true/false</code> <br> <br>    Chrome, Firefox, IE10 (+IE7 Mode) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/Suitup</a> <br> <br>   extended-commands.suitup.jquery.js     .    50        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b>UPD</b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> 1.          . ,  bold  Chrome     b,   IE   strong. <br> 2.          (      ). <br> 3.    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> <pre> <code class="hljs smalltalk"><code class="javascript"><code>, ,     <span class="hljs-type"><span class="hljs-type">IE</span></span>,        execCommand( <span class="hljs-string"><span class="hljs-string">'formatblock'</span></span> ... )</code>   .   :     <span class="hljs-comment"><span class="hljs-comment">" "</span></span>,       .   <span class="hljs-type"><span class="hljs-type">IE</span></span>...    ?..     <code>queryCommandValue( <span class="hljs-string"><span class="hljs-string">'formatblock'</span></span> )</code>  <code><span class="hljs-comment"><span class="hljs-comment">" 1"</span></span>, <span class="hljs-comment"><span class="hljs-comment">" 2"</span></span>, <span class="hljs-comment"><span class="hljs-comment">""</span></span></code> , .     , , , ,         .     ,    <span class="hljs-type"><span class="hljs-type">IE10</span></span>. ,  ,    <span class="hljs-type"><span class="hljs-type">IE10</span></span>!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  <span class="hljs-type"><span class="hljs-type">SuitUp</span></span> <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp();</code> <br>       : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> );</code> <br>       <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp([ <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>,      : <br> <br> <span class="hljs-number"><span class="hljs-number">1.</span></span> ,  :  forecolor    red: <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands = { forecolor: <span class="hljs-string"><span class="hljs-string">'red'</span></span> }</code> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( jQuery.suitUp.commands, { forecolor: <span class="hljs-string"><span class="hljs-string">'red'</span></span> })</code> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands.forecolor = <span class="hljs-string"><span class="hljs-string">'red'</span></span> // ( ,  commands -  )</code> <br> : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>   () <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands.forecolor = { <span class="hljs-string"><span class="hljs-string">'Make Red'</span></span>: <span class="hljs-string"><span class="hljs-string">'red'</span></span>, <span class="hljs-string"><span class="hljs-string">'Make Green'</span></span>: <span class="hljs-string"><span class="hljs-string">'green'</span></span> }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> <span class="hljs-number"><span class="hljs-number">3.</span></span> ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span> ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'link'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> <span class="hljs-number"><span class="hljs-number">1.</span></span>  <span class="hljs-type"><span class="hljs-type">Bold</span></span>. <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>  . <br> <span class="hljs-number"><span class="hljs-number">3.</span></span> ,             <span class="hljs-comment"><span class="hljs-comment">""</span></span>. <br> <br>  ,        . <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands, { bold: null, //   ,        null fontname: { <span class="hljs-type"><span class="hljs-type">Arial</span></span>: <span class="hljs-string"><span class="hljs-string">'arial'</span></span>, <span class="hljs-type"><span class="hljs-type">Times</span></span>: <span class="hljs-string"><span class="hljs-string">'times'</span></span>, <span class="hljs-type"><span class="hljs-type">Verdana</span></span>: <span class="hljs-string"><span class="hljs-string">'verdana'</span></span> }, forecolor: function( callback ){ var blackBackground = <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;div/&gt;'</span></span> ).css({ background: <span class="hljs-string"><span class="hljs-string">'black'</span></span>, position: <span class="hljs-string"><span class="hljs-string">'absolute'</span></span>, top: <span class="hljs-number"><span class="hljs-number">0</span></span>, left:<span class="hljs-number"><span class="hljs-number">0</span></span>, opacity: <span class="hljs-number"><span class="hljs-number">.5</span></span>, width: <span class="hljs-string"><span class="hljs-string">'100%'</span></span>, height: <span class="hljs-string"><span class="hljs-string">'100%'</span></span> }).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function(){ popup.add( this ).remove(); }).appendTo(<span class="hljs-string"><span class="hljs-string">'body'</span></span>), popup = <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;div/&gt;'</span></span> ).css({ padding: <span class="hljs-string"><span class="hljs-string">'10px 20px'</span></span>, width: <span class="hljs-number"><span class="hljs-number">200</span></span>, position: <span class="hljs-string"><span class="hljs-string">'absolute'</span></span>, background: <span class="hljs-string"><span class="hljs-string">'white'</span></span>, top: <span class="hljs-number"><span class="hljs-number">200</span></span>, left: <span class="hljs-string"><span class="hljs-string">$(</span></span> window ).width()/<span class="hljs-number"><span class="hljs-number">2</span></span> - <span class="hljs-number"><span class="hljs-number">110</span></span>, zIndex: <span class="hljs-number"><span class="hljs-number">100</span></span> }).appendTo(<span class="hljs-string"><span class="hljs-string">'body'</span></span>); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;input/&gt;'</span></span> ).appendTo( popup ); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;button/&gt;'</span></span> ).appendTo( popup ).text( <span class="hljs-string"><span class="hljs-string">'Go!'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { var val = popup.children( <span class="hljs-string"><span class="hljs-string">'input'</span></span> ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'fontname'</span></span>, <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . <span class="hljs-type"><span class="hljs-type">Callback</span></span>   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span> );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( jQuery.suitUp.custom, { helloWorld: function() { return <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;span/&gt;'</span></span>, { <span class="hljs-string"><span class="hljs-string">'class'</span></span>: <span class="hljs-string"><span class="hljs-string">'suitup-control'</span></span> //    }).css( <span class="hljs-string"><span class="hljs-string">'backgroundColor'</span></span>, <span class="hljs-string"><span class="hljs-string">'red'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { alert( <span class="hljs-string"><span class="hljs-string">'Hello World!'</span></span> ); }); } });</code> <br> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'fontname'</span></span>, <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>, <span class="hljs-string"><span class="hljs-string">'helloWorld'</span></span> );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       <span class="hljs-comment"><span class="hljs-comment">"link"</span></span>,     ( <span class="hljs-comment"><span class="hljs-comment">"createlink"</span></span>),      ( <span class="hljs-comment"><span class="hljs-comment">"unlink"</span></span>). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( <span class="hljs-string"><span class="hljs-string">'a'</span></span>, { className: <span class="hljs-string"><span class="hljs-string">'suitup-control'</span></span>, href: <span class="hljs-string"><span class="hljs-string">'#'</span></span> }).attr({ <span class="hljs-string"><span class="hljs-string">'data-command'</span></span>: <span class="hljs-string"><span class="hljs-string">'createlink'</span></span> //         createlink }).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { if( !<span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.hasSelectedNodeParent( <span class="hljs-string"><span class="hljs-string">'a'</span></span> ) ) { document.execCommand( <span class="hljs-string"><span class="hljs-string">'createlink'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, window.prompt( <span class="hljs-string"><span class="hljs-string">'URL:'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span> ) ); } else { document.execCommand( <span class="hljs-string"><span class="hljs-string">'unlink'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor<span class="hljs-symbol"><span class="hljs-symbol">#red</span></span></code> )    : <br>  .   .  , <span class="hljs-comment"><span class="hljs-comment">""</span></span>  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls = [ <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'italic'</span></span> ]; <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp(); //    ,   <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'italic'</span></span> );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls.push( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp();</code> <br>   : <br> <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls.concat([ <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ]) );  ,       (    ). <br> <br>    <br>    ,   ,   ,   <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp   .  ,            .      ,      ,  . <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelection</b> <br>   .          . <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelection(); //  -,     <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-editor'</span></span> ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.hasSelectedNodeParent</b> <br>  ,      <span class="hljs-comment"><span class="hljs-comment">"link"</span></span>. ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( <span class="hljs-string"><span class="hljs-string">'a'</span></span> ); // <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">false</span></span></code> <br> <br>    <span class="hljs-type"><span class="hljs-type">Chrome</span></span>, <span class="hljs-type"><span class="hljs-type">Firefox</span></span>, <span class="hljs-type"><span class="hljs-type">IE10</span></span> (+<span class="hljs-type"><span class="hljs-type">IE7</span></span> <span class="hljs-type"><span class="hljs-type">Mode</span></span>) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/<span class="hljs-type"><span class="hljs-type">Suitup</span></span></a> <br> <br>   extended-commands.suitup.jquery.js     .    <span class="hljs-number"><span class="hljs-number">50</span></span>        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b><span class="hljs-type"><span class="hljs-type">UPD</span></span></b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> <span class="hljs-number"><span class="hljs-number">1.</span></span>          . ,  bold  <span class="hljs-type"><span class="hljs-type">Chrome</span></span>     b,   <span class="hljs-type"><span class="hljs-type">IE</span></span>   strong. <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>          (      ). <br> <span class="hljs-number"><span class="hljs-number">3.</span></span>    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code></code> </pre> <code><code>, ,     IE,        execCommand( 'formatblock' ... )</code>   .   :     " ",       .   IE...    ?..     <code>queryCommandValue( 'formatblock' )</code>  <code>" 1", " 2", ""</code> , .     , , , ,         .     ,    IE10. ,  ,    IE10!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  SuitUp <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript">$( '.my-textarea' ).suitUp();</code> <br>       : <br> <code class="javascript">$( '.my-textarea' ).suitUp( 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' );</code> <br>       <br> <code class="javascript">$( '.my-textarea' ).suitUp([ 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , 'forecolor',      : <br> <br> 1. ,  :  forecolor    red: <br> <code class="javascript">$.suitUp.commands = { forecolor: 'red' }</code> <br>  <br> <code class="javascript">$.extend( jQuery.suitUp.commands, { forecolor: 'red' })</code> <br>  <br> <code class="javascript">$.suitUp.commands.forecolor = 'red' // ( ,  commands -  )</code> <br> : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> 2.   () <br> <code class="javascript">$.suitUp.commands.forecolor = { 'Make Red': 'red', 'Make Green': 'green' }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> 3. ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( ' ', '' ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript">$( 'textarea' ).suitUp( 'italic', 'bold', '|', 'link', 'formatblock#&lt;h1&gt;' );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> 1.  Bold. <br> 2.  . <br> 3. ,             "". <br> <br>  ,        . <br> <br> <code class="javascript">$.extend( $.suitUp.commands, { bold: null, //   ,        null fontname: { Arial: 'arial', Times: 'times', Verdana: 'verdana' }, forecolor: function( callback ){ var blackBackground = $( '&lt;div/&gt;' ).css({ background: 'black', position: 'absolute', top: 0, left:0, opacity: .5, width: '100%', height: '100%' }).on( 'click', function(){ popup.add( this ).remove(); }).appendTo('body'), popup = $( '&lt;div/&gt;' ).css({ padding: '10px 20px', width: 200, position: 'absolute', background: 'white', top: 200, left: $( window ).width()/2 - 110, zIndex: 100 }).appendTo('body'); $( '&lt;input/&gt;' ).appendTo( popup ); $( '&lt;button/&gt;' ).appendTo( popup ).text( 'Go!' ).on( 'click', function() { var val = popup.children( 'input' ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor' );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . Callback   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( 'forecolor', false, ' ' );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript">$.suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript">$.extend( jQuery.suitUp.custom, { helloWorld: function() { return $( '&lt;span/&gt;', { 'class': 'suitup-control' //    }).css( 'backgroundColor', 'red' ).on( 'click', function() { alert( 'Hello World!' ); }); } });</code> <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor', 'helloWorld' );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       "link",     ( "createlink"),      ( "unlink"). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( 'a', { className: 'suitup-control', href: '#' }).attr({ 'data-command': 'createlink' //         createlink }).on( 'click', function() { if( !$.suitUp.hasSelectedNodeParent( 'a' ) ) { document.execCommand( 'createlink', false, window.prompt( 'URL:', '' ) ); } else { document.execCommand( 'unlink', false, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor#red</code> )    : <br>  .   .  , ""  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript">$.suitUp.controls = [ 'bold', 'italic' ]; $( '.suitup-textarea' ).suitUp(); //    ,   $( '.suitup-textarea' ).suitUp( 'bold', 'italic' );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript">$.suitUp.controls.push( 'forecolor' ); $( '.suitup-textarea' ).suitUp();</code> <br>   : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( $.suitUp.controls.concat([ 'forecolor' ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   $.suitUp   .  ,            .      ,      ,  . <br> <br> <b>$.suitUp.getSelection</b> <br>   .          . <br> <br> <b>$.suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = $.suitUp.getSelection(); //  -,     $( '.suitup-editor' ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b>$.suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b>$.suitUp.hasSelectedNodeParent</b> <br>  ,      "link". ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( 'a' ); // true/false</code> <br> <br>    Chrome, Firefox, IE10 (+IE7 Mode) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/Suitup</a> <br> <br>   extended-commands.suitup.jquery.js     .    50        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b>UPD</b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> 1.          . ,  bold  Chrome     b,   IE   strong. <br> 2.          (      ). <br> 3.    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> <h5> <code><code>, ,     IE,        execCommand( 'formatblock' ... )</code>   .   :     " ",       .   IE...    ?..     <code>queryCommandValue( 'formatblock' )</code>  <code>" 1", " 2", ""</code> , .     , , , ,         .     ,    IE10. ,  ,    IE10!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  SuitUp <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript">$( '.my-textarea' ).suitUp();</code> <br>       : <br> <code class="javascript">$( '.my-textarea' ).suitUp( 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' );</code> <br>       <br> <code class="javascript">$( '.my-textarea' ).suitUp([ 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , 'forecolor',      : <br> <br> 1. ,  :  forecolor    red: <br> <code class="javascript">$.suitUp.commands = { forecolor: 'red' }</code> <br>  <br> <code class="javascript">$.extend( jQuery.suitUp.commands, { forecolor: 'red' })</code> <br>  <br> <code class="javascript">$.suitUp.commands.forecolor = 'red' // ( ,  commands -  )</code> <br> : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> 2.   () <br> <code class="javascript">$.suitUp.commands.forecolor = { 'Make Red': 'red', 'Make Green': 'green' }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> 3. ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( ' ', '' ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript">$( 'textarea' ).suitUp( 'italic', 'bold', '|', 'link', 'formatblock#&lt;h1&gt;' );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> 1.  Bold. <br> 2.  . <br> 3. ,             "". <br> <br>  ,        . <br> <br> <code class="javascript">$.extend( $.suitUp.commands, { bold: null, //   ,        null fontname: { Arial: 'arial', Times: 'times', Verdana: 'verdana' }, forecolor: function( callback ){ var blackBackground = $( '&lt;div/&gt;' ).css({ background: 'black', position: 'absolute', top: 0, left:0, opacity: .5, width: '100%', height: '100%' }).on( 'click', function(){ popup.add( this ).remove(); }).appendTo('body'), popup = $( '&lt;div/&gt;' ).css({ padding: '10px 20px', width: 200, position: 'absolute', background: 'white', top: 200, left: $( window ).width()/2 - 110, zIndex: 100 }).appendTo('body'); $( '&lt;input/&gt;' ).appendTo( popup ); $( '&lt;button/&gt;' ).appendTo( popup ).text( 'Go!' ).on( 'click', function() { var val = popup.children( 'input' ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor' );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . Callback   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( 'forecolor', false, ' ' );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript">$.suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript">$.extend( jQuery.suitUp.custom, { helloWorld: function() { return $( '&lt;span/&gt;', { 'class': 'suitup-control' //    }).css( 'backgroundColor', 'red' ).on( 'click', function() { alert( 'Hello World!' ); }); } });</code> <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor', 'helloWorld' );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       "link",     ( "createlink"),      ( "unlink"). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( 'a', { className: 'suitup-control', href: '#' }).attr({ 'data-command': 'createlink' //         createlink }).on( 'click', function() { if( !$.suitUp.hasSelectedNodeParent( 'a' ) ) { document.execCommand( 'createlink', false, window.prompt( 'URL:', '' ) ); } else { document.execCommand( 'unlink', false, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor#red</code> )    : <br>  .   .  , ""  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript">$.suitUp.controls = [ 'bold', 'italic' ]; $( '.suitup-textarea' ).suitUp(); //    ,   $( '.suitup-textarea' ).suitUp( 'bold', 'italic' );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript">$.suitUp.controls.push( 'forecolor' ); $( '.suitup-textarea' ).suitUp();</code> <br>   : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( $.suitUp.controls.concat([ 'forecolor' ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   $.suitUp   .  ,            .      ,      ,  . <br> <br> <b>$.suitUp.getSelection</b> <br>   .          . <br> <br> <b>$.suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = $.suitUp.getSelection(); //  -,     $( '.suitup-editor' ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b>$.suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b>$.suitUp.hasSelectedNodeParent</b> <br>  ,      "link". ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( 'a' ); // true/false</code> <br> <br>    Chrome, Firefox, IE10 (+IE7 Mode) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/Suitup</a> <br> <br>   extended-commands.suitup.jquery.js     .    50        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b>UPD</b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> 1.          . ,  bold  Chrome     b,   IE   strong. <br> 2.          (      ). <br> 3.    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> </h5> <code><code>, ,     IE,        execCommand( 'formatblock' ... )</code>   .   :     " ",       .   IE...    ?..     <code>queryCommandValue( 'formatblock' )</code>  <code>" 1", " 2", ""</code> , .     , , , ,         .     ,    IE10. ,  ,    IE10!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  SuitUp <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript">$( '.my-textarea' ).suitUp();</code> <br>       : <br> <code class="javascript">$( '.my-textarea' ).suitUp( 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' );</code> <br>       <br> <code class="javascript">$( '.my-textarea' ).suitUp([ 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , 'forecolor',      : <br> <br> 1. ,  :  forecolor    red: <br> <code class="javascript">$.suitUp.commands = { forecolor: 'red' }</code> <br>  <br> <code class="javascript">$.extend( jQuery.suitUp.commands, { forecolor: 'red' })</code> <br>  <br> <code class="javascript">$.suitUp.commands.forecolor = 'red' // ( ,  commands -  )</code> <br> : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> 2.   () <br> <code class="javascript">$.suitUp.commands.forecolor = { 'Make Red': 'red', 'Make Green': 'green' }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> 3. ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( ' ', '' ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript">$( 'textarea' ).suitUp( 'italic', 'bold', '|', 'link', 'formatblock#&lt;h1&gt;' );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> 1.  Bold. <br> 2.  . <br> 3. ,             "". <br> <br>  ,        . <br> <br> <code class="javascript">$.extend( $.suitUp.commands, { bold: null, //   ,        null fontname: { Arial: 'arial', Times: 'times', Verdana: 'verdana' }, forecolor: function( callback ){ var blackBackground = $( '&lt;div/&gt;' ).css({ background: 'black', position: 'absolute', top: 0, left:0, opacity: .5, width: '100%', height: '100%' }).on( 'click', function(){ popup.add( this ).remove(); }).appendTo('body'), popup = $( '&lt;div/&gt;' ).css({ padding: '10px 20px', width: 200, position: 'absolute', background: 'white', top: 200, left: $( window ).width()/2 - 110, zIndex: 100 }).appendTo('body'); $( '&lt;input/&gt;' ).appendTo( popup ); $( '&lt;button/&gt;' ).appendTo( popup ).text( 'Go!' ).on( 'click', function() { var val = popup.children( 'input' ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor' );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . Callback   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( 'forecolor', false, ' ' );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript">$.suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript">$.extend( jQuery.suitUp.custom, { helloWorld: function() { return $( '&lt;span/&gt;', { 'class': 'suitup-control' //    }).css( 'backgroundColor', 'red' ).on( 'click', function() { alert( 'Hello World!' ); }); } });</code> <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor', 'helloWorld' );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       "link",     ( "createlink"),      ( "unlink"). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( 'a', { className: 'suitup-control', href: '#' }).attr({ 'data-command': 'createlink' //         createlink }).on( 'click', function() { if( !$.suitUp.hasSelectedNodeParent( 'a' ) ) { document.execCommand( 'createlink', false, window.prompt( 'URL:', '' ) ); } else { document.execCommand( 'unlink', false, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor#red</code> )    : <br>  .   .  , ""  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript">$.suitUp.controls = [ 'bold', 'italic' ]; $( '.suitup-textarea' ).suitUp(); //    ,   $( '.suitup-textarea' ).suitUp( 'bold', 'italic' );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript">$.suitUp.controls.push( 'forecolor' ); $( '.suitup-textarea' ).suitUp();</code> <br>   : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( $.suitUp.controls.concat([ 'forecolor' ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   $.suitUp   .  ,            .      ,      ,  . <br> <br> <b>$.suitUp.getSelection</b> <br>   .          . <br> <br> <b>$.suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = $.suitUp.getSelection(); //  -,     $( '.suitup-editor' ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b>$.suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b>$.suitUp.hasSelectedNodeParent</b> <br>  ,      "link". ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( 'a' ); // true/false</code> <br> <br>    Chrome, Firefox, IE10 (+IE7 Mode) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/Suitup</a> <br> <br>   extended-commands.suitup.jquery.js     .    50        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b>UPD</b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> 1.          . ,  bold  Chrome     b,   IE   strong. <br> 2.          (      ). <br> 3.    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> <pre> <code class="hljs smalltalk"><code>, ,     <span class="hljs-type"><span class="hljs-type">IE</span></span>,        execCommand( <span class="hljs-string"><span class="hljs-string">'formatblock'</span></span> ... )</code>   .   :     <span class="hljs-comment"><span class="hljs-comment">" "</span></span>,       .   <span class="hljs-type"><span class="hljs-type">IE</span></span>...    ?..     <code>queryCommandValue( <span class="hljs-string"><span class="hljs-string">'formatblock'</span></span> )</code>  <code><span class="hljs-comment"><span class="hljs-comment">" 1"</span></span>, <span class="hljs-comment"><span class="hljs-comment">" 2"</span></span>, <span class="hljs-comment"><span class="hljs-comment">""</span></span></code> , .     , , , ,         .     ,    <span class="hljs-type"><span class="hljs-type">IE10</span></span>. ,  ,    <span class="hljs-type"><span class="hljs-type">IE10</span></span>!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  <span class="hljs-type"><span class="hljs-type">SuitUp</span></span> <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp();</code> <br>       : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> );</code> <br>       <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp([ <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>,      : <br> <br> <span class="hljs-number"><span class="hljs-number">1.</span></span> ,  :  forecolor    red: <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands = { forecolor: <span class="hljs-string"><span class="hljs-string">'red'</span></span> }</code> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( jQuery.suitUp.commands, { forecolor: <span class="hljs-string"><span class="hljs-string">'red'</span></span> })</code> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands.forecolor = <span class="hljs-string"><span class="hljs-string">'red'</span></span> // ( ,  commands -  )</code> <br> : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>   () <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands.forecolor = { <span class="hljs-string"><span class="hljs-string">'Make Red'</span></span>: <span class="hljs-string"><span class="hljs-string">'red'</span></span>, <span class="hljs-string"><span class="hljs-string">'Make Green'</span></span>: <span class="hljs-string"><span class="hljs-string">'green'</span></span> }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> <span class="hljs-number"><span class="hljs-number">3.</span></span> ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span> ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'link'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> <span class="hljs-number"><span class="hljs-number">1.</span></span>  <span class="hljs-type"><span class="hljs-type">Bold</span></span>. <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>  . <br> <span class="hljs-number"><span class="hljs-number">3.</span></span> ,             <span class="hljs-comment"><span class="hljs-comment">""</span></span>. <br> <br>  ,        . <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands, { bold: null, //   ,        null fontname: { <span class="hljs-type"><span class="hljs-type">Arial</span></span>: <span class="hljs-string"><span class="hljs-string">'arial'</span></span>, <span class="hljs-type"><span class="hljs-type">Times</span></span>: <span class="hljs-string"><span class="hljs-string">'times'</span></span>, <span class="hljs-type"><span class="hljs-type">Verdana</span></span>: <span class="hljs-string"><span class="hljs-string">'verdana'</span></span> }, forecolor: function( callback ){ var blackBackground = <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;div/&gt;'</span></span> ).css({ background: <span class="hljs-string"><span class="hljs-string">'black'</span></span>, position: <span class="hljs-string"><span class="hljs-string">'absolute'</span></span>, top: <span class="hljs-number"><span class="hljs-number">0</span></span>, left:<span class="hljs-number"><span class="hljs-number">0</span></span>, opacity: <span class="hljs-number"><span class="hljs-number">.5</span></span>, width: <span class="hljs-string"><span class="hljs-string">'100%'</span></span>, height: <span class="hljs-string"><span class="hljs-string">'100%'</span></span> }).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function(){ popup.add( this ).remove(); }).appendTo(<span class="hljs-string"><span class="hljs-string">'body'</span></span>), popup = <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;div/&gt;'</span></span> ).css({ padding: <span class="hljs-string"><span class="hljs-string">'10px 20px'</span></span>, width: <span class="hljs-number"><span class="hljs-number">200</span></span>, position: <span class="hljs-string"><span class="hljs-string">'absolute'</span></span>, background: <span class="hljs-string"><span class="hljs-string">'white'</span></span>, top: <span class="hljs-number"><span class="hljs-number">200</span></span>, left: <span class="hljs-string"><span class="hljs-string">$(</span></span> window ).width()/<span class="hljs-number"><span class="hljs-number">2</span></span> - <span class="hljs-number"><span class="hljs-number">110</span></span>, zIndex: <span class="hljs-number"><span class="hljs-number">100</span></span> }).appendTo(<span class="hljs-string"><span class="hljs-string">'body'</span></span>); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;input/&gt;'</span></span> ).appendTo( popup ); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;button/&gt;'</span></span> ).appendTo( popup ).text( <span class="hljs-string"><span class="hljs-string">'Go!'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { var val = popup.children( <span class="hljs-string"><span class="hljs-string">'input'</span></span> ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'fontname'</span></span>, <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . <span class="hljs-type"><span class="hljs-type">Callback</span></span>   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span> );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( jQuery.suitUp.custom, { helloWorld: function() { return <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;span/&gt;'</span></span>, { <span class="hljs-string"><span class="hljs-string">'class'</span></span>: <span class="hljs-string"><span class="hljs-string">'suitup-control'</span></span> //    }).css( <span class="hljs-string"><span class="hljs-string">'backgroundColor'</span></span>, <span class="hljs-string"><span class="hljs-string">'red'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { alert( <span class="hljs-string"><span class="hljs-string">'Hello World!'</span></span> ); }); } });</code> <br> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'fontname'</span></span>, <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>, <span class="hljs-string"><span class="hljs-string">'helloWorld'</span></span> );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       <span class="hljs-comment"><span class="hljs-comment">"link"</span></span>,     ( <span class="hljs-comment"><span class="hljs-comment">"createlink"</span></span>),      ( <span class="hljs-comment"><span class="hljs-comment">"unlink"</span></span>). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( <span class="hljs-string"><span class="hljs-string">'a'</span></span>, { className: <span class="hljs-string"><span class="hljs-string">'suitup-control'</span></span>, href: <span class="hljs-string"><span class="hljs-string">'#'</span></span> }).attr({ <span class="hljs-string"><span class="hljs-string">'data-command'</span></span>: <span class="hljs-string"><span class="hljs-string">'createlink'</span></span> //         createlink }).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { if( !<span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.hasSelectedNodeParent( <span class="hljs-string"><span class="hljs-string">'a'</span></span> ) ) { document.execCommand( <span class="hljs-string"><span class="hljs-string">'createlink'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, window.prompt( <span class="hljs-string"><span class="hljs-string">'URL:'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span> ) ); } else { document.execCommand( <span class="hljs-string"><span class="hljs-string">'unlink'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor<span class="hljs-symbol"><span class="hljs-symbol">#red</span></span></code> )    : <br>  .   .  , <span class="hljs-comment"><span class="hljs-comment">""</span></span>  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls = [ <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'italic'</span></span> ]; <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp(); //    ,   <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'italic'</span></span> );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls.push( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp();</code> <br>   : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls.concat([ <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp   .  ,            .      ,      ,  . <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelection</b> <br>   .          . <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelection(); //  -,     <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-editor'</span></span> ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.hasSelectedNodeParent</b> <br>  ,      <span class="hljs-comment"><span class="hljs-comment">"link"</span></span>. ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( <span class="hljs-string"><span class="hljs-string">'a'</span></span> ); // <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">false</span></span></code> <br> <br>    <span class="hljs-type"><span class="hljs-type">Chrome</span></span>, <span class="hljs-type"><span class="hljs-type">Firefox</span></span>, <span class="hljs-type"><span class="hljs-type">IE10</span></span> (+<span class="hljs-type"><span class="hljs-type">IE7</span></span> <span class="hljs-type"><span class="hljs-type">Mode</span></span>) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/<span class="hljs-type"><span class="hljs-type">Suitup</span></span></a> <br> <br>   extended-commands.suitup.jquery.js     .    <span class="hljs-number"><span class="hljs-number">50</span></span>        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b><span class="hljs-type"><span class="hljs-type">UPD</span></span></b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> <span class="hljs-number"><span class="hljs-number">1.</span></span>          . ,  bold  <span class="hljs-type"><span class="hljs-type">Chrome</span></span>     b,   <span class="hljs-type"><span class="hljs-type">IE</span></span>   strong. <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>          (      ). <br> <span class="hljs-number"><span class="hljs-number">3.</span></span>    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> </pre> <code><code>, ,     IE,        execCommand( 'formatblock' ... )</code>   .   :     " ",       .   IE...    ?..     <code>queryCommandValue( 'formatblock' )</code>  <code>" 1", " 2", ""</code> , .     , , , ,         .     ,    IE10. ,  ,    IE10!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  SuitUp <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript">$( '.my-textarea' ).suitUp();</code> <br>       : <br> <code class="javascript">$( '.my-textarea' ).suitUp( 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' );</code> <br>       <br> <code class="javascript">$( '.my-textarea' ).suitUp([ 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , 'forecolor',      : <br> <br> 1. ,  :  forecolor    red: <br> <code class="javascript">$.suitUp.commands = { forecolor: 'red' }</code> <br>  <br> <code class="javascript">$.extend( jQuery.suitUp.commands, { forecolor: 'red' })</code> <br>  <br> <code class="javascript">$.suitUp.commands.forecolor = 'red' // ( ,  commands -  )</code> <br> : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> 2.   () <br> <code class="javascript">$.suitUp.commands.forecolor = { 'Make Red': 'red', 'Make Green': 'green' }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> 3. ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( ' ', '' ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript">$( 'textarea' ).suitUp( 'italic', 'bold', '|', 'link', 'formatblock#&lt;h1&gt;' );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> 1.  Bold. <br> 2.  . <br> 3. ,             "". <br> <br>  ,        . <br> <br> <code class="javascript">$.extend( $.suitUp.commands, { bold: null, //   ,        null fontname: { Arial: 'arial', Times: 'times', Verdana: 'verdana' }, forecolor: function( callback ){ var blackBackground = $( '&lt;div/&gt;' ).css({ background: 'black', position: 'absolute', top: 0, left:0, opacity: .5, width: '100%', height: '100%' }).on( 'click', function(){ popup.add( this ).remove(); }).appendTo('body'), popup = $( '&lt;div/&gt;' ).css({ padding: '10px 20px', width: 200, position: 'absolute', background: 'white', top: 200, left: $( window ).width()/2 - 110, zIndex: 100 }).appendTo('body'); $( '&lt;input/&gt;' ).appendTo( popup ); $( '&lt;button/&gt;' ).appendTo( popup ).text( 'Go!' ).on( 'click', function() { var val = popup.children( 'input' ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor' );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . Callback   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( 'forecolor', false, ' ' );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript">$.suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript">$.extend( jQuery.suitUp.custom, { helloWorld: function() { return $( '&lt;span/&gt;', { 'class': 'suitup-control' //    }).css( 'backgroundColor', 'red' ).on( 'click', function() { alert( 'Hello World!' ); }); } });</code> <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor', 'helloWorld' );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       "link",     ( "createlink"),      ( "unlink"). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( 'a', { className: 'suitup-control', href: '#' }).attr({ 'data-command': 'createlink' //         createlink }).on( 'click', function() { if( !$.suitUp.hasSelectedNodeParent( 'a' ) ) { document.execCommand( 'createlink', false, window.prompt( 'URL:', '' ) ); } else { document.execCommand( 'unlink', false, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor#red</code> )    : <br>  .   .  , ""  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript">$.suitUp.controls = [ 'bold', 'italic' ]; $( '.suitup-textarea' ).suitUp(); //    ,   $( '.suitup-textarea' ).suitUp( 'bold', 'italic' );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript">$.suitUp.controls.push( 'forecolor' ); $( '.suitup-textarea' ).suitUp();</code> <br>   : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( $.suitUp.controls.concat([ 'forecolor' ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   $.suitUp   .  ,            .      ,      ,  . <br> <br> <b>$.suitUp.getSelection</b> <br>   .          . <br> <br> <b>$.suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = $.suitUp.getSelection(); //  -,     $( '.suitup-editor' ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b>$.suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b>$.suitUp.hasSelectedNodeParent</b> <br>  ,      "link". ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( 'a' ); // true/false</code> <br> <br>    Chrome, Firefox, IE10 (+IE7 Mode) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/Suitup</a> <br> <br>   extended-commands.suitup.jquery.js     .    50        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b>UPD</b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> 1.          . ,  bold  Chrome     b,   IE   strong. <br> 2.          (      ). <br> 3.    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> <pre> <code class="hljs smalltalk"><code class="javascript"><code>, ,     <span class="hljs-type"><span class="hljs-type">IE</span></span>,        execCommand( <span class="hljs-string"><span class="hljs-string">'formatblock'</span></span> ... )</code>   .   :     <span class="hljs-comment"><span class="hljs-comment">" "</span></span>,       .   <span class="hljs-type"><span class="hljs-type">IE</span></span>...    ?..     <code>queryCommandValue( <span class="hljs-string"><span class="hljs-string">'formatblock'</span></span> )</code>  <code><span class="hljs-comment"><span class="hljs-comment">" 1"</span></span>, <span class="hljs-comment"><span class="hljs-comment">" 2"</span></span>, <span class="hljs-comment"><span class="hljs-comment">""</span></span></code> , .     , , , ,         .     ,    <span class="hljs-type"><span class="hljs-type">IE10</span></span>. ,  ,    <span class="hljs-type"><span class="hljs-type">IE10</span></span>!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  <span class="hljs-type"><span class="hljs-type">SuitUp</span></span> <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp();</code> <br>       : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> );</code> <br>       <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.my-textarea'</span></span> ).suitUp([ <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>,      : <br> <br> <span class="hljs-number"><span class="hljs-number">1.</span></span> ,  :  forecolor    red: <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands = { forecolor: <span class="hljs-string"><span class="hljs-string">'red'</span></span> }</code> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( jQuery.suitUp.commands, { forecolor: <span class="hljs-string"><span class="hljs-string">'red'</span></span> })</code> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands.forecolor = <span class="hljs-string"><span class="hljs-string">'red'</span></span> // ( ,  commands -  )</code> <br> : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>   () <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands.forecolor = { <span class="hljs-string"><span class="hljs-string">'Make Red'</span></span>: <span class="hljs-string"><span class="hljs-string">'red'</span></span>, <span class="hljs-string"><span class="hljs-string">'Make Green'</span></span>: <span class="hljs-string"><span class="hljs-string">'green'</span></span> }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> <span class="hljs-number"><span class="hljs-number">3.</span></span> ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( <span class="hljs-string"><span class="hljs-string">' '</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span> ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'italic'</span></span>, <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'|'</span></span>, <span class="hljs-string"><span class="hljs-string">'link'</span></span>, <span class="hljs-string"><span class="hljs-string">'formatblock#&lt;h1&gt;'</span></span> );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> <span class="hljs-number"><span class="hljs-number">1.</span></span>  <span class="hljs-type"><span class="hljs-type">Bold</span></span>. <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>  . <br> <span class="hljs-number"><span class="hljs-number">3.</span></span> ,             <span class="hljs-comment"><span class="hljs-comment">""</span></span>. <br> <br>  ,        . <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.commands, { bold: null, //   ,        null fontname: { <span class="hljs-type"><span class="hljs-type">Arial</span></span>: <span class="hljs-string"><span class="hljs-string">'arial'</span></span>, <span class="hljs-type"><span class="hljs-type">Times</span></span>: <span class="hljs-string"><span class="hljs-string">'times'</span></span>, <span class="hljs-type"><span class="hljs-type">Verdana</span></span>: <span class="hljs-string"><span class="hljs-string">'verdana'</span></span> }, forecolor: function( callback ){ var blackBackground = <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;div/&gt;'</span></span> ).css({ background: <span class="hljs-string"><span class="hljs-string">'black'</span></span>, position: <span class="hljs-string"><span class="hljs-string">'absolute'</span></span>, top: <span class="hljs-number"><span class="hljs-number">0</span></span>, left:<span class="hljs-number"><span class="hljs-number">0</span></span>, opacity: <span class="hljs-number"><span class="hljs-number">.5</span></span>, width: <span class="hljs-string"><span class="hljs-string">'100%'</span></span>, height: <span class="hljs-string"><span class="hljs-string">'100%'</span></span> }).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function(){ popup.add( this ).remove(); }).appendTo(<span class="hljs-string"><span class="hljs-string">'body'</span></span>), popup = <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;div/&gt;'</span></span> ).css({ padding: <span class="hljs-string"><span class="hljs-string">'10px 20px'</span></span>, width: <span class="hljs-number"><span class="hljs-number">200</span></span>, position: <span class="hljs-string"><span class="hljs-string">'absolute'</span></span>, background: <span class="hljs-string"><span class="hljs-string">'white'</span></span>, top: <span class="hljs-number"><span class="hljs-number">200</span></span>, left: <span class="hljs-string"><span class="hljs-string">$(</span></span> window ).width()/<span class="hljs-number"><span class="hljs-number">2</span></span> - <span class="hljs-number"><span class="hljs-number">110</span></span>, zIndex: <span class="hljs-number"><span class="hljs-number">100</span></span> }).appendTo(<span class="hljs-string"><span class="hljs-string">'body'</span></span>); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;input/&gt;'</span></span> ).appendTo( popup ); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;button/&gt;'</span></span> ).appendTo( popup ).text( <span class="hljs-string"><span class="hljs-string">'Go!'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { var val = popup.children( <span class="hljs-string"><span class="hljs-string">'input'</span></span> ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'fontname'</span></span>, <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . <span class="hljs-type"><span class="hljs-type">Callback</span></span>   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-string"><span class="hljs-string">' '</span></span> );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>extend( jQuery.suitUp.custom, { helloWorld: function() { return <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'&lt;span/&gt;'</span></span>, { <span class="hljs-string"><span class="hljs-string">'class'</span></span>: <span class="hljs-string"><span class="hljs-string">'suitup-control'</span></span> //    }).css( <span class="hljs-string"><span class="hljs-string">'backgroundColor'</span></span>, <span class="hljs-string"><span class="hljs-string">'red'</span></span> ).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { alert( <span class="hljs-string"><span class="hljs-string">'Hello World!'</span></span> ); }); } });</code> <br> <br>  : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'fontname'</span></span>, <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span>, <span class="hljs-string"><span class="hljs-string">'helloWorld'</span></span> );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       <span class="hljs-comment"><span class="hljs-comment">"link"</span></span>,     ( <span class="hljs-comment"><span class="hljs-comment">"createlink"</span></span>),      ( <span class="hljs-comment"><span class="hljs-comment">"unlink"</span></span>). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( <span class="hljs-string"><span class="hljs-string">'a'</span></span>, { className: <span class="hljs-string"><span class="hljs-string">'suitup-control'</span></span>, href: <span class="hljs-string"><span class="hljs-string">'#'</span></span> }).attr({ <span class="hljs-string"><span class="hljs-string">'data-command'</span></span>: <span class="hljs-string"><span class="hljs-string">'createlink'</span></span> //         createlink }).on( <span class="hljs-string"><span class="hljs-string">'click'</span></span>, function() { if( !<span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.hasSelectedNodeParent( <span class="hljs-string"><span class="hljs-string">'a'</span></span> ) ) { document.execCommand( <span class="hljs-string"><span class="hljs-string">'createlink'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, window.prompt( <span class="hljs-string"><span class="hljs-string">'URL:'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span> ) ); } else { document.execCommand( <span class="hljs-string"><span class="hljs-string">'unlink'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor<span class="hljs-symbol"><span class="hljs-symbol">#red</span></span></code> )    : <br>  .   .  , <span class="hljs-comment"><span class="hljs-comment">""</span></span>  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls = [ <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'italic'</span></span> ]; <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp(); //    ,   <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">'bold'</span></span>, <span class="hljs-string"><span class="hljs-string">'italic'</span></span> );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls.push( <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ); <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp();</code> <br>   : <br> <code class="javascript"><span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-textarea'</span></span> ).suitUp( <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.controls.concat([ <span class="hljs-string"><span class="hljs-string">'forecolor'</span></span> ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp   .  ,            .      ,      ,  . <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelection</b> <br>   .          . <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = <span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelection(); //  -,     <span class="hljs-string"><span class="hljs-string">$(</span></span> <span class="hljs-string"><span class="hljs-string">'.suitup-editor'</span></span> ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b><span class="hljs-string"><span class="hljs-string">$.</span></span>suitUp.hasSelectedNodeParent</b> <br>  ,      <span class="hljs-comment"><span class="hljs-comment">"link"</span></span>. ,         ,    . <br> jQuery.suitUp.hasSelectedNodeParent( <span class="hljs-string"><span class="hljs-string">'a'</span></span> ); // <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>/<span class="hljs-keyword"><span class="hljs-keyword">false</span></span> <br> <br>    <span class="hljs-type"><span class="hljs-type">Chrome</span></span>, <span class="hljs-type"><span class="hljs-type">Firefox</span></span>, <span class="hljs-type"><span class="hljs-type">IE10</span></span> (+<span class="hljs-type"><span class="hljs-type">IE7</span></span> <span class="hljs-type"><span class="hljs-type">Mode</span></span>) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/<span class="hljs-type"><span class="hljs-type">Suitup</span></span></a> <br> <br>   extended-commands.suitup.jquery.js     .    <span class="hljs-number"><span class="hljs-number">50</span></span>        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b><span class="hljs-type"><span class="hljs-type">UPD</span></span></b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> <span class="hljs-number"><span class="hljs-number">1.</span></span>          . ,  bold  <span class="hljs-type"><span class="hljs-type">Chrome</span></span>     b,   <span class="hljs-type"><span class="hljs-type">IE</span></span>   strong. <br> <span class="hljs-number"><span class="hljs-number">2.</span></span>          (      ). <br> <span class="hljs-number"><span class="hljs-number">3.</span></span>    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code></code> </pre> <code><code>, ,     IE,        execCommand( 'formatblock' ... )</code>   .   :     " ",       .   IE...    ?..     <code>queryCommandValue( 'formatblock' )</code>  <code>" 1", " 2", ""</code> , .     , , , ,         .     ,    IE10. ,  ,    IE10!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  SuitUp <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript">$( '.my-textarea' ).suitUp();</code> <br>       : <br> <code class="javascript">$( '.my-textarea' ).suitUp( 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' );</code> <br>       <br> <code class="javascript">$( '.my-textarea' ).suitUp([ 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , 'forecolor',      : <br> <br> 1. ,  :  forecolor    red: <br> <code class="javascript">$.suitUp.commands = { forecolor: 'red' }</code> <br>  <br> <code class="javascript">$.extend( jQuery.suitUp.commands, { forecolor: 'red' })</code> <br>  <br> <code class="javascript">$.suitUp.commands.forecolor = 'red' // ( ,  commands -  )</code> <br> : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> 2.   () <br> <code class="javascript">$.suitUp.commands.forecolor = { 'Make Red': 'red', 'Make Green': 'green' }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> 3. ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( ' ', '' ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript">$( 'textarea' ).suitUp( 'italic', 'bold', '|', 'link', 'formatblock#&lt;h1&gt;' );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> 1.  Bold. <br> 2.  . <br> 3. ,             "". <br> <br>  ,        . <br> <br> <code class="javascript">$.extend( $.suitUp.commands, { bold: null, //   ,        null fontname: { Arial: 'arial', Times: 'times', Verdana: 'verdana' }, forecolor: function( callback ){ var blackBackground = $( '&lt;div/&gt;' ).css({ background: 'black', position: 'absolute', top: 0, left:0, opacity: .5, width: '100%', height: '100%' }).on( 'click', function(){ popup.add( this ).remove(); }).appendTo('body'), popup = $( '&lt;div/&gt;' ).css({ padding: '10px 20px', width: 200, position: 'absolute', background: 'white', top: 200, left: $( window ).width()/2 - 110, zIndex: 100 }).appendTo('body'); $( '&lt;input/&gt;' ).appendTo( popup ); $( '&lt;button/&gt;' ).appendTo( popup ).text( 'Go!' ).on( 'click', function() { var val = popup.children( 'input' ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor' );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . Callback   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( 'forecolor', false, ' ' );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript">$.suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript">$.extend( jQuery.suitUp.custom, { helloWorld: function() { return $( '&lt;span/&gt;', { 'class': 'suitup-control' //    }).css( 'backgroundColor', 'red' ).on( 'click', function() { alert( 'Hello World!' ); }); } });</code> <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor', 'helloWorld' );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       "link",     ( "createlink"),      ( "unlink"). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( 'a', { className: 'suitup-control', href: '#' }).attr({ 'data-command': 'createlink' //         createlink }).on( 'click', function() { if( !$.suitUp.hasSelectedNodeParent( 'a' ) ) { document.execCommand( 'createlink', false, window.prompt( 'URL:', '' ) ); } else { document.execCommand( 'unlink', false, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor#red</code> )    : <br>  .   .  , ""  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript">$.suitUp.controls = [ 'bold', 'italic' ]; $( '.suitup-textarea' ).suitUp(); //    ,   $( '.suitup-textarea' ).suitUp( 'bold', 'italic' );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript">$.suitUp.controls.push( 'forecolor' ); $( '.suitup-textarea' ).suitUp();</code> <br>   : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( $.suitUp.controls.concat([ 'forecolor' ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   $.suitUp   .  ,            .      ,      ,  . <br> <br> <b>$.suitUp.getSelection</b> <br>   .          . <br> <br> <b>$.suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = $.suitUp.getSelection(); //  -,     $( '.suitup-editor' ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b>$.suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b>$.suitUp.hasSelectedNodeParent</b> <br>  ,      "link". ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( 'a' ); // true/false</code> <br> <br>    Chrome, Firefox, IE10 (+IE7 Mode) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/Suitup</a> <br> <br>   extended-commands.suitup.jquery.js     .    50        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b>UPD</b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> 1.          . ,  bold  Chrome     b,   IE   strong. <br> 2.          (      ). <br> 3.    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> <h5> <code><code>, ,     IE,        execCommand( 'formatblock' ... )</code>   .   :     " ",       .   IE...    ?..     <code>queryCommandValue( 'formatblock' )</code>  <code>" 1", " 2", ""</code> , .     , , , ,         .     ,    IE10. ,  ,    IE10!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  SuitUp <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript">$( '.my-textarea' ).suitUp();</code> <br>       : <br> <code class="javascript">$( '.my-textarea' ).suitUp( 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' );</code> <br>       <br> <code class="javascript">$( '.my-textarea' ).suitUp([ 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , 'forecolor',      : <br> <br> 1. ,  :  forecolor    red: <br> <code class="javascript">$.suitUp.commands = { forecolor: 'red' }</code> <br>  <br> <code class="javascript">$.extend( jQuery.suitUp.commands, { forecolor: 'red' })</code> <br>  <br> <code class="javascript">$.suitUp.commands.forecolor = 'red' // ( ,  commands -  )</code> <br> : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> 2.   () <br> <code class="javascript">$.suitUp.commands.forecolor = { 'Make Red': 'red', 'Make Green': 'green' }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> 3. ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( ' ', '' ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript">$( 'textarea' ).suitUp( 'italic', 'bold', '|', 'link', 'formatblock#&lt;h1&gt;' );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> 1.  Bold. <br> 2.  . <br> 3. ,             "". <br> <br>  ,        . <br> <br> <code class="javascript">$.extend( $.suitUp.commands, { bold: null, //   ,        null fontname: { Arial: 'arial', Times: 'times', Verdana: 'verdana' }, forecolor: function( callback ){ var blackBackground = $( '&lt;div/&gt;' ).css({ background: 'black', position: 'absolute', top: 0, left:0, opacity: .5, width: '100%', height: '100%' }).on( 'click', function(){ popup.add( this ).remove(); }).appendTo('body'), popup = $( '&lt;div/&gt;' ).css({ padding: '10px 20px', width: 200, position: 'absolute', background: 'white', top: 200, left: $( window ).width()/2 - 110, zIndex: 100 }).appendTo('body'); $( '&lt;input/&gt;' ).appendTo( popup ); $( '&lt;button/&gt;' ).appendTo( popup ).text( 'Go!' ).on( 'click', function() { var val = popup.children( 'input' ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor' );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . Callback   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( 'forecolor', false, ' ' );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript">$.suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript">$.extend( jQuery.suitUp.custom, { helloWorld: function() { return $( '&lt;span/&gt;', { 'class': 'suitup-control' //    }).css( 'backgroundColor', 'red' ).on( 'click', function() { alert( 'Hello World!' ); }); } });</code> <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor', 'helloWorld' );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       "link",     ( "createlink"),      ( "unlink"). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( 'a', { className: 'suitup-control', href: '#' }).attr({ 'data-command': 'createlink' //         createlink }).on( 'click', function() { if( !$.suitUp.hasSelectedNodeParent( 'a' ) ) { document.execCommand( 'createlink', false, window.prompt( 'URL:', '' ) ); } else { document.execCommand( 'unlink', false, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor#red</code> )    : <br>  .   .  , ""  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript">$.suitUp.controls = [ 'bold', 'italic' ]; $( '.suitup-textarea' ).suitUp(); //    ,   $( '.suitup-textarea' ).suitUp( 'bold', 'italic' );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript">$.suitUp.controls.push( 'forecolor' ); $( '.suitup-textarea' ).suitUp();</code> <br>   : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( $.suitUp.controls.concat([ 'forecolor' ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   $.suitUp   .  ,            .      ,      ,  . <br> <br> <b>$.suitUp.getSelection</b> <br>   .          . <br> <br> <b>$.suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = $.suitUp.getSelection(); //  -,     $( '.suitup-editor' ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b>$.suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b>$.suitUp.hasSelectedNodeParent</b> <br>  ,      "link". ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( 'a' ); // true/false</code> <br> <br>    Chrome, Firefox, IE10 (+IE7 Mode) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/Suitup</a> <br> <br>   extended-commands.suitup.jquery.js     .    50        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b>UPD</b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> 1.          . ,  bold  Chrome     b,   IE   strong. <br> 2.          (      ). <br> 3.    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code> </h5> <code><code>, ,     IE,        execCommand( 'formatblock' ... )</code>   .   :     " ",       .   IE...    ?..     <code>queryCommandValue( 'formatblock' )</code>  <code>" 1", " 2", ""</code> , .     , , , ,         .     ,    IE10. ,  ,    IE10!     ,           ,     . <br> <br> <a name="suitup"></a> <br>  SuitUp <br> <a href="https://dl.dropbox.com/u/13598455/WYSIWYG/demo.html"></a> <br> ,      , , ,   ,   ---,       . ,    . <br> <br>          :) <br> <br>   ,      : <br> <code class="javascript">$( '.my-textarea' ).suitUp();</code> <br>       : <br> <code class="javascript">$( '.my-textarea' ).suitUp( 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' );</code> <br>       <br> <code class="javascript">$( '.my-textarea' ).suitUp([ 'italic', 'bold', '|', 'formatblock#&lt;h1&gt;' ]);</code> <br> <br> ¬´|¬ª     ,   . ,    ,    ,     ,  ‚Äî .   _#,     .   ‚Äî  ,   ,   ,     .    , ,  ,    null.        . <br> <br>   (    ) <br>       jQuery.suitUp.commands,   - ( ),     , , 'forecolor',      : <br> <br> 1. ,  :  forecolor    red: <br> <code class="javascript">$.suitUp.commands = { forecolor: 'red' }</code> <br>  <br> <code class="javascript">$.extend( jQuery.suitUp.commands, { forecolor: 'red' })</code> <br>  <br> <code class="javascript">$.suitUp.commands.forecolor = 'red' // ( ,  commands -  )</code> <br> : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> 2.   () <br> <code class="javascript">$.suitUp.commands.forecolor = { 'Make Red': 'red', 'Make Green': 'green' }</code> <br>      select,      ,      . <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <img src="https://habrastorage.org/storage2/7cf/6eb/3c1/7cf6eb3c1382ff185c59514e5b754256.png"> <br> <br> 3. ,    ,      .  ,  ,         .     propmt: <br> <br> <code class="javascript">jQuery.suitUp.commands.forecolor = function( callback ) { var color = prompt( ' ', '' ); //     callback( color ); //   }</code> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'forecolor' );</code> <br> <br>      ,  ‚Äî   ,      ,     .  ,       suitUp     : <br> <code class="javascript">$( 'textarea' ).suitUp( 'italic', 'bold', '|', 'link', 'formatblock#&lt;h1&gt;' );</code> <br>    .   <a href="https://developer.mozilla.org/en-US/docs/Rich-Text_Editing_in_Mozilla">  </a> . ,   : <br> 1.  Bold. <br> 2.  . <br> 3. ,             "". <br> <br>  ,        . <br> <br> <code class="javascript">$.extend( $.suitUp.commands, { bold: null, //   ,        null fontname: { Arial: 'arial', Times: 'times', Verdana: 'verdana' }, forecolor: function( callback ){ var blackBackground = $( '&lt;div/&gt;' ).css({ background: 'black', position: 'absolute', top: 0, left:0, opacity: .5, width: '100%', height: '100%' }).on( 'click', function(){ popup.add( this ).remove(); }).appendTo('body'), popup = $( '&lt;div/&gt;' ).css({ padding: '10px 20px', width: 200, position: 'absolute', background: 'white', top: 200, left: $( window ).width()/2 - 110, zIndex: 100 }).appendTo('body'); $( '&lt;input/&gt;' ).appendTo( popup ); $( '&lt;button/&gt;' ).appendTo( popup ).text( 'Go!' ).on( 'click', function() { var val = popup.children( 'input' ).val(); blackBackground.add( popup ).remove() callback( val ); }); } });</code> <br> <br>  <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor' );</code> <br> <br> <img src="https://habrastorage.org/storage2/107/bcb/e56/107bcbe5673ad16f6ca98dfff8619120.png"> <br> <br> <img src="https://habrastorage.org/storage2/7ed/904/888/7ed904888f3a9cac60e39c98e57ed0ed.png"> <br> <br> <img src="https://habrastorage.org/storage2/2b3/46f/a8c/2b346fa8c1d4e33142d0355040f31a01.png"> <br> <br>     , ,  .        ,         button.  ,       ,  callback,      . Callback   ,  ,        forecolor  . <br> <br> <code class="javascript">document.execCommand( 'forecolor', false, ' ' );</code> <br> <b>!</b>   ,         camelCase,    ,       .     . <br> <br>   <br>     ,     .   ,        ,  . <br> <br>      ,      : <br> <code class="javascript">$.suitUp.custom = {};</code> <br>  ,         . <br> <br> <code class="javascript">$.extend( jQuery.suitUp.custom, { helloWorld: function() { return $( '&lt;span/&gt;', { 'class': 'suitup-control' //    }).css( 'backgroundColor', 'red' ).on( 'click', function() { alert( 'Hello World!' ); }); } });</code> <br> <br>  : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( 'bold', 'fontname', 'forecolor', 'helloWorld' );</code> <br> <img src="https://habrastorage.org/storage2/d45/850/053/d45850053e0569198388a75916a83c8f.png"> <br> <br>  ,        . <br> <br>  ,       "link",     ( "createlink"),      ( "unlink"). <br> <br> <code class="javascript">... { link: function() { return jQuery._createElement( 'a', { className: 'suitup-control', href: '#' }).attr({ 'data-command': 'createlink' //         createlink }).on( 'click', function() { if( !$.suitUp.hasSelectedNodeParent( 'a' ) ) { document.execCommand( 'createlink', false, window.prompt( 'URL:', '' ) ); } else { document.execCommand( 'unlink', false, null ); } }); } }</code> <br>  ,          (    helloWorld),        . <br> <br>       : <br>    suitUp     (    commands),       null.         ( <code>forecolor#red</code> )    : <br>  .   .  , ""  (, - colorpicker). <br>         suitUp. <br>   . <br> <br>     <br>       suitUp      : <br> <code class="javascript">$.suitUp.controls = [ 'bold', 'italic' ]; $( '.suitup-textarea' ).suitUp(); //    ,   $( '.suitup-textarea' ).suitUp( 'bold', 'italic' );</code> <br>   controls   ,    .    . ,         : <br> <br> <code class="javascript">$.suitUp.controls.push( 'forecolor' ); $( '.suitup-textarea' ).suitUp();</code> <br>   : <br> <code class="javascript">$( '.suitup-textarea' ).suitUp( $.suitUp.controls.concat([ 'forecolor' ]) );</code>  ,       (    ). <br> <br>    <br>    ,   ,   ,   $.suitUp   .  ,            .      ,      ,  . <br> <br> <b>$.suitUp.getSelection</b> <br>   .          . <br> <br> <b>$.suitUp.restoreSelection</b> <br>  .      ,   getSelection. <br> <br> <code class="javascript">var sel = $.suitUp.getSelection(); //  -,     $( '.suitup-editor' ).focus(); //   jQuery.suitUp.restoreSelection( sel ); //  </code> <br> <br> <b>$.suitUp.getSelectedNode</b> <br>     (        ) <br> <br> <b>$.suitUp.hasSelectedNodeParent</b> <br>  ,      "link". ,         ,    . <br> <code class="javascript">jQuery.suitUp.hasSelectedNodeParent( 'a' ); // true/false</code> <br> <br>    Chrome, Firefox, IE10 (+IE7 Mode) <br>     , : <a href="https://github.com/finom/Suitup">github.com/finom/Suitup</a> <br> <br>   extended-commands.suitup.jquery.js     .    50        ,   . <br> <br> <img src="https://habrastorage.org/storage2/c2e/ee4/a43/c2eee4a437095c82e1676e33601197b7.png"> <br> <br>     ,   . <br> <br>  . <br> <br> <b>UPD</b> <br> <a name="critic"></a> <br>    <br> ,    ,          .        ,    ,     . <br> 1.          . ,  bold  Chrome     b,   IE   strong. <br> 2.          (      ). <br> 3.    ,   . ,         . <br> <br>   ‚Äî   .        , ,  ,    .        , ,  .       ‚Äî  . <br> <br>   .</code>  </div><p>Source: <a href="https://habr.com/ru/post/161715/">https://habr.com/ru/post/161715/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../161701/index.html">Computer vision algorithms competition. Prizes go to all</a></li>
<li><a href="../161703/index.html">Limiting Abstractions (.NET, ASP.NET MVC)</a></li>
<li><a href="../161705/index.html">Habrarebrecha. Kiev. Saturday</a></li>
<li><a href="../161707/index.html">Evolution of Zeus. Part I</a></li>
<li><a href="../161713/index.html">How do I find time?</a></li>
<li><a href="../161717/index.html">Changes in subscription to Google Apps. Registration for Google Apps Free is disabled.</a></li>
<li><a href="../161723/index.html">Is the device in demand for non-invasive real-time energy consumption monitoring?</a></li>
<li><a href="../161727/index.html">Are you at work? Urgent to the personnel department, to Android! He has 35,000% more vacancies</a></li>
<li><a href="../161729/index.html">Root Transmission: we get Root rights on one Android device using another Android device</a></li>
<li><a href="../161731/index.html">RailsClub'Ulyanovsk</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>