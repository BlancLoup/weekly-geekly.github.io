<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Shake dust from the globe: check the project NASA World Wind</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sometimes it is useful to look back and see how the analyzer could help in old projects, and which errors can be avoided in a timely manner if you use...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Shake dust from the globe: check the project NASA World Wind</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/39b/aaf/1ec/39baaf1ec15c54ec6dbdd85c189ca991.png" alt="PVS-Studio and NASA World Wind" align="left">  Sometimes it is useful to look back and see how the analyzer could help in old projects, and which errors can be avoided in a timely manner if you use the analyzer regularly.  This time, the choice fell on the NASA World Wind project, which until 2007 was developed in C #. <br><br>  <a href="http://worldwind.arc.nasa.gov/java/">NASA World Wind</a> is an interactive globe that allows you to see any place on Earth.  For the project, the project uses the Landsat public image database and the Shuttle Radar Topography Mission relief modeling project.  The first versions of the project were created in C #.  Later the project continued its development in the Java language.  The latest version released in C # is 1.4.  Although the C # version has been abandoned for many years, it will not prevent us from checking the project and assessing the quality of the code developed by the <a href="https://ru.wikipedia.org/wiki/%25D0%2598%25D1%2581%25D1%2581%25D0%25BB%25D0%25B5%25D0%25B4%25D0%25BE%25D0%25B2%25D0%25B0%25D1%2582%25D0%25B5%25D0%25BB%25D1%258C%25D1%2581%25D0%25BA%25D0%25B8%25D0%25B9_%25D1%2586%25D0%25B5%25D0%25BD%25D1%2582%25D1%2580_%25D0%25AD%25D0%25B9%25D0%25BC%25D1%2581%25D0%25B0">NASA Ames Research Center</a> . <br><br>  Why did we check the old project?  We have long been offered to check out some of the NASA projects and now we accidentally came across this project.  Yes, this check will not bring any benefit to the project.  But we did not set such a goal this time.  We just wanted to once again demonstrate the benefits that the PVS-Studio static code analyzer can bring when developing, including NASA. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br>  By the way, this is not the first time that ‚Äúhistorical‚Äù projects have been checked.  You may also be interested in the following articles: <ul><li>  <a href="http://www.viva64.com/ru/b/0245/">Entertaining archeology.</a>  <a href="http://www.viva64.com/ru/b/0245/">Or PVS-Studio checks Microsoft Word 1.1a</a> </li><li>  <a href="http://www.viva64.com/ru/b/0355/">On the thirtieth anniversary of the first C ++ compiler: look for errors in Cfront</a> </li></ul><br>  The NASA World Wind project shows well the capabilities of the PVS-Studio analyzer.  As it will be seen from the article, while writing the code, it seems, the <a href="http://www.viva64.com/ru/t/0068/">Copy-Paste</a> mechanisms were actively used.  Many errors have multiplied and are often duplicated in the code.  Some project errors are indicative and well illustrate the principles of analyzer diagnostics. <br><br>  To analyze the project, we used the PVS-Studio analyzer version 6.06. <br><br><h2>  Error density </h2><br>  After checking the project, the analyzer issued 120 warnings of the first level and 158 warnings of the second level.  After studying the messages, I believe that the code should be fixed in 122 places.  Thus, the percentage of false positives was 56%.  This means that every second message indicates an error or a clearly bad code that needs to be corrected. <br><br>  Now let's calculate the error density.  In total in the project, taking into account comments, 474240 lines of code in 943 files.  Among them, 122 problem areas.  We get that the analyzer finds an average of 0.25 errors per 1000 lines of code.  This indicates the high quality of the code. <br><br><h2>  Last line effect </h2><br><pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Point3d</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Point3d P</span></span></span><span class="hljs-function">)</span></span> { X = PX; Y = PY; X = PZ; <span class="hljs-comment"><span class="hljs-comment">// &lt;= }</span></span></code> </pre> <br>  A warning: <ul><li>  <a href="http://www.viva64.com/ru/d/0395/">V3008</a> The 'X' variable is assigned twice successively.  Perhaps this is a mistake.  Check lines: 40, 38. Point3d.cs 40 </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/b64/769/ff5/b64769ff5d86c871a9be556ec02a7e42.png" alt="Unicorn Facepalm"><br><br>  Here we see the classic error in the copy constructor.  When assigning three-dimensional coordinates of an object, instead of setting the variable <i>Z</i> , the value of the variable <i>X</i> was overwritten twice.  It is quite obvious that this mistake was made as a result of using the ‚ÄúCopy-Paste methodology‚Äù.  The chance to make a mistake in the last line when copying code is much higher.  You can read more about this phenomenon in Andrei Karpov‚Äôs article ‚ÄúLast line effect‚Äù.  To fix this constructor, you need to replace the variable in the last line. <br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Point3d</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">Point3d P</span></span></span><span class="hljs-function">)</span></span> { X = PX; Y = PY; Z = PZ; }</code> </pre> <br>  This is not the only mistake in the project that confirms this effect.  In the continuation of the article will meet some more examples proving it. <br><br>  A few more suspicious places where V3008 diagnostics worked: <ul><li>  V3008 The 'this._imagePath' variable is assigned values ‚Äã‚Äãtwice successively.  Perhaps this is a mistake.  Check lines: 270, 263. ImageLayer.cs 270 </li><li>  V3008 The 'm_PolygonFill' variable is assigned values ‚Äã‚Äãtwice successively.  Perhaps this is a mistake.  Check lines: 1623, 1618. ShapeFileLayer.cs 1623 </li></ul><br><h2>  Logical error or insidious typo? </h2><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WebUpdate</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">....</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ver != version) <span class="hljs-comment"><span class="hljs-comment">// &lt;= { .... } else if (ver != version) // &lt;= { .... } }</span></span></code> </pre> <br>  A warning: <ul><li>  <a href="http://www.viva64.com/ru/d/0382/">V3003</a> The use of if (A) {...} else if (A) {...} 'pattern was detected.  There is a possibility of logical error presence.  Check lines: 2111, 2197. KMLImporter.cs 2111 </li></ul><br>  The fragment is engaged in automatic updating of a plug-in in the project.  If the version doesn‚Äôt match, he downloads the necessary plugin.  If this is an internal plugin, the program refuses to update it automatically and simply gives a message about the new version.  But the conditional statement located after <i>else</i> contains an expression that contradicts the condition for entering the <i>else statement</i> .  The code is quite contradictory, and only developers who know exactly how the function should work can determine exactly what the error is.  At the moment, I can only assume that <i>else</i> should not be related to this conditional operator.  Or, judging by the commentary next to the conditional operator, it can be concluded that the <i>else</i> operator is in place, and the second <i>if statement</i> should have a different condition. <br><br><h2>  Copy failed </h2><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GpsSetup</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">....</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (m_gpsIcon!=<span class="hljs-literal"><span class="hljs-literal">null</span></span>) { .... labelTitle.Text = <span class="hljs-string"><span class="hljs-string">"Set options for "</span></span> + m_gpsIcon.m_RenderInfo.sDescription; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (m_gpsTrackLine != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { .... labelTitle.Text = <span class="hljs-string"><span class="hljs-string">"Set options for "</span></span> + m_gpsIcon.m_RenderInfo.sDescription; <span class="hljs-comment"><span class="hljs-comment">// &lt;= } .... }</span></span></code> </pre> <br>  A warning: <ul><li>  <a href="http://www.viva64.com/ru/d/0480/">V3080</a> Possible null dereference.  Consider inspecting 'm_gpsIcon'.  GpsTrackerPlugin.SourceSetup.cs 68 </li></ul><br>  In the given fragment the error connected with inaccurate copying of the code.  In the last condition statement, the variable is confused.  As a result, an error occurred with access to the null link.  According to previous checks, the <i>m_gpsIcon</i> variable used in the last line is guaranteed to be <i>null</i> .  If the condition <i>m_gpsTrackLine! = Null</i> works, the program will end with an error.  I can assume that the correct code should look like this: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (m_gpsTrackLine != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) { .... labelTitle.Text = <span class="hljs-string"><span class="hljs-string">"Set options for "</span></span> + m_gpsTrackLine.m_sDescription; }</code> </pre> <br><br><h2>  Noncompliant condition </h2><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LoadSettings</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">....</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (bSet) { <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(<span class="hljs-literal"><span class="hljs-literal">true</span></span>) { line = sr.ReadLine(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (line==<span class="hljs-literal"><span class="hljs-literal">null</span></span> || line.StartsWith(<span class="hljs-string"><span class="hljs-string">"END UI CONTROLS"</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (line.StartsWith(<span class="hljs-string"><span class="hljs-string">"comboBoxAPRSInternetServer="</span></span>)) <span class="hljs-comment"><span class="hljs-comment">// &lt;= .... else .... if (line.StartsWith("checkBoxNoDelay=")) // &lt;= .... else if (line.StartsWith("checkBoxNoDelay=")) // &lt;= .... .... else if (line.StartsWith("comboBoxAPRSInternetServer=")) // &lt;= .... } .... } .... }</span></span></code> </pre> <br>  Warnings: <ul><li>  <a href="http://www.viva64.com/ru/d/0382/">V3003</a> The use of if (A) {...} else if (A) {...} 'pattern was detected.  There is a possibility of logical error presence.  Check lines: 4503, 4607. GPSTracker.cs 4503 </li><li>  <a href="http://www.viva64.com/ru/d/0382/">V3003</a> The use of if (A) {...} else if (A) {...} 'pattern was detected.  There is a possibility of logical error presence.  Check lines: 4527, 4530. GPSTracker.cs 4527 </li></ul><br>  Another example of an error arising from large code fragments created by copying code.  The above function is intended for processing incoming commands and is a very long block of code consisting of conditional statements of the same type.  The code will never come to re-check.  There is nothing wrong with such an error, but it may well be that instead of a duplicate some other command should have been located.  If the necessary command is not processed, then the code behaves in a completely different way than the programmer assumes. <br><br>  The analyzer indicated at once two places in this huge tree of conditional operators.  In the first place, a double <i>line.StartsWith</i> check <i>("checkBoxNoDelay =")</i> is located nearby, and it could be noticed by scrutinizing the code, although considering the amount of code, this is a rather complicated process that would take a lot of time. <br><br>  The second place is hidden from the eyes of developers much better.  The first <i>line.StartsWith</i> check <i>(‚ÄúcomboBoxAPRSInternetServer =‚Äù)</i> is located in the middle of the tree, and the second check actually completes it, and there are about 100 lines of code between them.  This case well demonstrates that sometimes static code analysis can be even more effective than a code review.  Regular use of the analyzer allows you to detect such errors in the early stages and saves programmers from the painful debugging and reading of long functions. <br><br><h2>  Variable name error </h2><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CompareTo</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> obj</span></span></span><span class="hljs-function">)</span></span> { RenderableObject robj = obj <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> RenderableObject; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(obj == <span class="hljs-literal"><span class="hljs-literal">null</span></span>) <span class="hljs-comment"><span class="hljs-comment">// &lt;= return 1; return this.m_renderPriority.CompareTo(robj.RenderPriority); }</span></span></code> </pre> <br>  A warning: <ul><li>  <a href="http://www.viva64.com/ru/d/0388/">V3019</a> Possibly incorrectly variable conversion compared to null after type conversion using 'as' keyword.  Check variables 'obj', 'robj'.  RenderableObject.cs 199 </li></ul><br>  A typo in the variable name led to the potential use of a null reference.  Instead of checking the object of the derived class <i>robj</i> , the base object <i>obj is</i> checked.  In case it does not correspond to the <i>RenderableObject</i> type <i>, the</i> program will end with an error.  The correction requires changing the name of the variable in the conditional statement to <i>robj</i> . <br><br><h2>  Access via null link </h2><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Render</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">DrawArgs drawArgs</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.linePoints.Length &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-comment"><span class="hljs-comment">// &lt;= { .... if(this.linePoints != null) // &lt;= { .... } } .... }</span></span></code> </pre> <br>  Warnings: <ul><li>  <a href="http://www.viva64.com/ru/d/0391/">V3022</a> Expression 'this.linePoints! = Null' is always true.  PathLine.cs 346 </li><li>  <a href="http://www.viva64.com/ru/d/0504/">V3095</a> The 'this.linePoints' object was used against it.  Check lines: 332, 346. PathLine.cs 332 </li></ul><br>  Two different diagnostics immediately indicate this code.  The code violated the procedure for checking and accessing the link.  First, calculate the number of elements within the object, and then check whether the object exists at all.  Perhaps the <i>this.linePoints</i> object may never get a <i>null</i> value, but then the check in the internal condition is also not needed.  It is logical to change the code as follows: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.linePoints != <span class="hljs-literal"><span class="hljs-literal">null</span></span> &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.linePoints.Length &gt; <span class="hljs-number"><span class="hljs-number">1</span></span>) { .... }</code> </pre> <br><br><h2>  Always a false condition </h2><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">checkSurfaceImageChange</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { .... SurfaceImage currentSurfaceImage = m_ParentWorldSurfaceRenderer.SurfaceImages[i] <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> SurfaceImage; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(currentSurfaceImage.LastUpdate &gt; m_LastUpdate || currentSurfaceImage.Opacity != currentSurfaceImage.ParentRenderable.Opacity) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(currentSurfaceImage == <span class="hljs-literal"><span class="hljs-literal">null</span></span> || <span class="hljs-comment"><span class="hljs-comment">// &lt;= currentSurfaceImage.ImageTexture == null || currentSurfaceImage.ImageTexture.Disposed || !currentSurfaceImage.Enabled || ....) { continue; } else { return true; } } .... }</span></span></code> </pre> <br>  A warning: <ul><li>  <a href="http://www.viva64.com/ru/d/0461/">V3063</a> A part of the conditional expression is always false: currentSurfaceImage == null.  SurfaceTile.cs 1069 </li></ul><br>  This error is similar to the one described in the previous section.  Here, an object reference is assigned to a variable directly before conditional statements.  Most likely, the reference to the object can not be zero, and verification in the internal condition is not required.  If this is not the case, the check must be transferred to an external conditional statement.  It is already working with the properties of the <i>currentSurfaceImage</i> object.  If the link is zero, the error will occur before the check is performed. <br><br>  Similar places: <ul><li>  V3063 A part of the conditional expression is always true: iWildIndex == - 1.  GPSTrackerPlugin.APRS.cs 87 </li><li>  V3063 A part of the conditional expression is always true: iWildIndex == - 1.  GPSTrackerPlugin.NMEA.cs 169 </li><li>  V3063 A part of the conditional expression is always false: newvalue == null.  SchemaTypes.cs 860 </li></ul><br><h2>  Wandering Brace </h2><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">threadStartFile</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (File.Exists(sFileName)) { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (gpsSource.bTrackAtOnce!=<span class="hljs-literal"><span class="hljs-literal">true</span></span> &amp;&amp; ....) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!gpsSource.bWaypoints) { m_GpsTracker.m_gpsTrackerPlugin.pluginShowFixInfo(<span class="hljs-string"><span class="hljs-string">""</span></span>); .... <span class="hljs-comment"><span class="hljs-comment">// &lt;= gpsSource.sFileNameSession=sFileName; .... } else { .... } } else { .... } } // &lt;= .... }</span></span></code> </pre> <br>  A warning: <ul><li>  <a href="http://www.viva64.com/ru/d/0400/">V3033</a> It is possible that this "else" branch must apply.  GPSTrackerPlugin.File.cs 314 </li></ul><br>  The analyzer detected a mismatch between the formatting and the logic of the code.  On closer examination, it turned out that the closing bracket was forgotten in the internal <i>if</i> .  The missing parenthesis was found after completion of the block of the second operator <i>else</i> .  As a result, the project was able to compile, despite the inaccurate code.  The compiler can only report if <i>else</i> ceases to belong to the conditional operator.  In this case, simply shifting the <i>else</i> to another <i>if statement</i> .  Since the closing parenthesis was in the wrong place, the work of two conditional statements was broken, as well as the formatting of <i>else statements</i> .  I can guess what the code should look like after correcting the position of the bracket and formatting errors: <br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">threadStartFile</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (File.Exists(sFileName)) { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (gpsSource.bTrackAtOnce!=<span class="hljs-literal"><span class="hljs-literal">true</span></span> &amp;&amp; ....) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!gpsSource.bWaypoints) { m_GpsTracker.m_gpsTrackerPlugin.pluginShowFixInfo(<span class="hljs-string"><span class="hljs-string">""</span></span>); .... } gpsSource.sFileNameSession=sFileName; .... } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { .... } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { .... } .... }</code> </pre> <br><br><h2>  Unused parameter </h2><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Diagonal</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">CPoint2D vertex1, CPoint2D vertex2</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i= <span class="hljs-number"><span class="hljs-number">0</span></span>; i&lt;nNumOfVertices; i++) { .... <span class="hljs-comment"><span class="hljs-comment">//Diagonal line: double x1=vertex1.X; double y1=vertex1.Y; double x2=vertex1.X; double y2=vertex1.Y; .... } .... }</span></span></code> </pre> <br>  A warning: <ul><li>  <a href="http://www.viva64.com/ru/d/0470/">V3065</a> Parameter 'vertex2' is not utilized inside method's body.  CPolygon.cs 227 </li></ul><br>  The function receives the coordinates of two points of the line, but as a result of typos, the values ‚Äã‚Äãof both points are taken only from the variable <i>vertex1</i> .  To correct the error, you need to change the code as follows: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">double</span></span> x2=vertex2.X; <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> y2=vertex2.Y;</code> </pre> <br>  In addition to typing errors during assignment, another oddity is noticed.  Why assign a fixed value in each iteration of the loop?  Inside the loop, the value does not change and it is much more logical to make this assignment once before it starts. <br><br><h2>  Overwriting function parameter </h2><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ShowInfo</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">.... , </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> fDistance </span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (m_fTotalDistance&gt;=<span class="hljs-number"><span class="hljs-number">0F</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> sUnit=(m_fTotalDistance&gt;=<span class="hljs-number"><span class="hljs-number">1F</span></span>)?<span class="hljs-string"><span class="hljs-string">"km"</span></span>:<span class="hljs-string"><span class="hljs-string">"m"</span></span>; fDistance = (m_fTotalDistance &lt; <span class="hljs-number"><span class="hljs-number">1F</span></span>) ? (m_fTotalDistance * <span class="hljs-number"><span class="hljs-number">1000F</span></span>) : m_fTotalDistance; sInfo += <span class="hljs-string"><span class="hljs-string">"Track Distance: "</span></span> + Convert.ToString( <span class="hljs-keyword"><span class="hljs-keyword">decimal</span></span>.Round( Convert.ToDecimal(fDistance),<span class="hljs-number"><span class="hljs-number">3</span></span>)) + sUnit + <span class="hljs-string"><span class="hljs-string">"\n"</span></span>; } .... }</code> </pre> <br>  A warning: <ul><li>  <a href="http://www.viva64.com/ru/d/0468/">V3061</a> Parameter 'fDistance' is always rewritten in method of body before being used.  GPSTrackerPlugin.WorldWind.cs 1667 </li></ul><br>  The <i>fDistance</i> parameter <i>entering the</i> function is overwritten immediately before use.  The <i>actual</i> value of the variable is lost, and the value of the property of the <i>m_fTotalDistance</i> class is used <i>instead</i> .  There is no variable anywhere else in the function, so changing <i>fDistance</i> does not make sense.  Judging by the other function fragments, we can assume that the variables are interchanged here, and in fact this fragment should look like this: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (fDistance&gt;=<span class="hljs-number"><span class="hljs-number">0F</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> sUnit=(fDistance&gt;=<span class="hljs-number"><span class="hljs-number">1F</span></span>)?<span class="hljs-string"><span class="hljs-string">"km"</span></span>:<span class="hljs-string"><span class="hljs-string">"m"</span></span>; m_fTotalDistance = (fDistance &lt; <span class="hljs-number"><span class="hljs-number">1F</span></span>) ? (fDistance * <span class="hljs-number"><span class="hljs-number">1000F</span></span>) : fDistance; sInfo += <span class="hljs-string"><span class="hljs-string">"Track Distance: "</span></span> + Convert.ToString( <span class="hljs-keyword"><span class="hljs-keyword">decimal</span></span>.Round( Convert.ToDecimal(m_fTotalDistance),<span class="hljs-number"><span class="hljs-number">3</span></span>)) + sUnit + <span class="hljs-string"><span class="hljs-string">"\n"</span></span>; }</code> </pre> <br><br><h2>  Invalid NaN check </h2><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">override</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PerformSelectionAction</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">DrawArgs drawArgs</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(icon.OnClickZoomAltitude != <span class="hljs-keyword"><span class="hljs-keyword">double</span></span>.NaN || icon.OnClickZoomHeading != <span class="hljs-keyword"><span class="hljs-keyword">double</span></span>.NaN || icon.OnClickZoomTilt != <span class="hljs-keyword"><span class="hljs-keyword">double</span></span>.NaN) { .... } .... }</code> </pre> <br>  A warning: <ul><li>  <a href="http://www.viva64.com/ru/d/0473/">V3076</a> Comparison of 'icon.OnClickZoomAltitude' with 'double.NaN' is meaningless.  Use 'double.IsNaN ()' method instead.  Icon.cs 389 </li></ul><br>  According to the <a href="https://msdn.microsoft.com/en-us/library/system.double.op_equality">documentation,</a> you cannot compare two <i>double.NaN</i> values ‚Äã‚Äãwith the! = Operator.  The result of this comparison will always be <i>true</i> .  For a correct check, use the <i>double.IsNaN ()</i> method.  Accordingly, the code will take the following form: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(!<span class="hljs-keyword"><span class="hljs-keyword">double</span></span>.IsNaN(icon.OnClickZoomAltitude) || !<span class="hljs-keyword"><span class="hljs-keyword">double</span></span>.IsNaN(icon.OnClickZoomHeading) || !<span class="hljs-keyword"><span class="hljs-keyword">double</span></span>.IsNaN(icon.OnClickZoomTilt)) ....</code> </pre> <br>  The analyzer found many places using such incorrect checks: <ul><li>  V3076 Comparison of 'icon.OnClickZoomHeading' with 'double.NaN' is meaningless.  Use 'double.IsNaN ()' method instead.  Icon.cs 389 </li><li>  V3076 Comparison of 'icon.OnClickZoomTilt' with 'double.NaN' is meaningless.  Use 'double.IsNaN ()' method instead.  Icon.cs 389 </li><li>  V3076 Comparison of 'm_ShapeTileArgs.ScaleMin' with 'double.NaN' is meaningless.  Use 'double.IsNaN ()' method instead.  ShapeFileLayer.cs 642 </li><li>  V3076 Comparison of 'm_ShapeTileArgs.ScaleMax' with 'double.NaN' is meaningless.  Use 'double.IsNaN ()' method instead.  ShapeFileLayer.cs 642 </li><li>  V3076 Comparison of 'm_ShapeTileArgs.ScaleMin' with 'double.NaN' is meaningless.  Use 'double.IsNaN ()' method instead.  ShapeFileLayer.cs 645 </li><li>  V3076 Comparison of 'm_ShapeTileArgs.ScaleMax' with 'double.NaN' is meaningless.  Use 'double.IsNaN ()' method instead.  ShapeFileLayer.cs 650 </li><li>  V3076 Comparison of 'm_ShapeTileArgs.ScaleMin' with 'double.NaN' is meaningless.  Use 'double.IsNaN ()' method instead.  ShapeFileLayer.cs 677 </li><li>  V3076 Comparison of 'm_ShapeTileArgs.ScaleMax' with 'double.NaN' is meaningless.  Use 'double.IsNaN ()' method instead.  ShapeFileLayer.cs 681 </li><li>  V3076 Comparison of 'm_ScalarFilterMin' with 'double.NaN' is meaningless.  Use 'double.IsNaN ()' method instead.  ShapeFileLayer.cs 886 </li><li>  V3076 Comparison of 'm_ScalarFilterMax' with 'double.NaN' is meaningless.  Use 'double.IsNaN ()' method instead.  ShapeFileLayer.cs 894 </li><li>  V3076 Comparison of 'm_ShapeTileArgs.ScaleMin' with 'double.NaN' is meaningless.  Use 'double.IsNaN ()' method instead.  ShapeFileLayer.cs 1038 </li><li>  V3076 Comparison of 'm_ShapeTileArgs.ScaleMax' with 'double.NaN' is meaningless.  Use 'double.IsNaN ()' method instead.  ShapeFileLayer.cs 1038 </li><li>  V3076 Comparison of 'm_ShapeTileArgs.ScaleMin' with 'double.NaN' is meaningless.  Use 'double.IsNaN ()' method instead.  ShapeFileLayer.cs 1041 </li><li>  V3076 Comparison of 'm_ShapeTileArgs.ScaleMax' with 'double.NaN' is meaningless.  Use 'double.IsNaN ()' method instead.  ShapeFileLayer.cs 1046 </li><li>  V3076 Comparison of 'm_ShapeTileArgs.ScaleMin' with 'double.NaN' is meaningless.  Use 'double.IsNaN ()' method instead.  ShapeFileLayer.cs 1073 </li><li>  V3076 Comparison of 'm_ShapeTileArgs.ScaleMax' with 'double.NaN' is meaningless.  Use 'double.IsNaN ()' method instead.  ShapeFileLayer.cs 1077 </li><li>  V3076 Comparison of 'm_ScalarFilterMin' with 'double.NaN' is meaningless.  Use 'double.IsNaN ()' method instead.  ShapeFileLayer.cs 1259 </li><li>  V3076 Comparison of 'm_ScalarFilterMax' with 'double.NaN' is meaningless.  Use 'double.IsNaN ()' method instead.  ShapeFileLayer.cs 1267 </li></ul><br><h2>  Ignoring the result of a function </h2><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addExtendedInformation</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">....</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(toolBarImage.Length &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; !Path.IsPathRooted(toolBarImage)) Path.Combine(...., toolBarImage); <span class="hljs-comment"><span class="hljs-comment">// &lt;= .... }</span></span></code> </pre> <br>  A warning: <ul><li>  <a href="http://www.viva64.com/ru/d/0406/">V3010</a> The return value of the 'Combine' is required to be utilized.  ConfigurationLoader.cs 943 </li></ul><br>  Calling the <i>Path.Combine</i> function without processing the result does not make sense.  In this case, the function serves to form the path to the object based on the absolute path to the executable file and the relative path to the image.  A lack of value processing indicates an obvious error.  The <i>Path.Combine</i> function <i>is</i> used in many places in the program.  Based on this, we can conclude that the code should be corrected as follows: <br><pre> <code class="cs hljs">toolBarImage=Path.Combine(...., toolBarImage);</code> </pre> <br>  The error was copied to other places of the project: <ul><li>  V3010 The return value of the 'Combine' is required to be utilized.  ConfigurationLoader.cs 1361 </li><li>  V3010 The return value of the 'Combine' is required to be utilized.  ConfigurationLoader.cs 1566 </li><li>  V3010 The return value of the 'Combine' is required to be utilized.  ConfigurationLoader.cs 1687 </li><li>  V3010 The return value of the 'Replace' is required to be utilized.  WorldWind.cs 2455 </li></ul><br><h2>  Missing enum value </h2><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> MenuAnchor { Top, Bottom, Left, Right }</code> </pre> <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnMouseMove</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">MouseEventArgs e</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>._visibleState == VisibleState.Visible) { .... <span class="hljs-keyword"><span class="hljs-keyword">switch</span></span>(m_anchor) { <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> MenuAnchor.Top: .... <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> MenuAnchor.Bottom: .... <span class="hljs-keyword"><span class="hljs-keyword">case</span></span> MenuAnchor.Right: .... } } .... }</code> </pre> <br>  A warning: <ul><li>  <a href="http://www.viva64.com/ru/d/0401/">V3002 Enum</a> : Left.  Menu.cs 1681 </li></ul><br>  The code apparently checks to see if the cursor is over the <i>ToolBar</i> at the moment, or not.  From the code you can see that there is no handling of the <i>MenuAnchor.Left</i> element.  It is impossible to know exactly what the developers meant when writing this fragment.  Probably, its processing was not required, but I consider - it is necessary to pay attention to this fragment. <br><br><h2>  Meaningless assignment </h2><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">virtual</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">CreateElevatedMesh</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (minimumElevation &gt; maximumElevation) { <span class="hljs-comment"><span class="hljs-comment">// Compensate for negative vertical exaggeration minimumElevation = maximumElevation; maximumElevation = minimumElevation; } .... }</span></span></code> </pre> <br>  A warning: <ul><li>  <a href="http://www.viva64.com/ru/d/0420/">V3037</a> An odd sequence of assignments of this kind: A = B;  B = A ;.  Check lines: 625, 624. QuadTile.cs 625 </li></ul><br>  Here is just a redundant code.  The presence of the string <i>maximumElevation = minimumElevation</i> does not make sense, since at the time of assignment both variables have the same values ‚Äã‚Äãas a result of the previous operation.  You can, of course, assume that the developers wanted to change the values ‚Äã‚Äãof variables, but they did it incorrectly.  This is a dubious assumption, since both the comment and the fact that the <i>maximumElevation</i> variable <i>is</i> no longer used, prove the opposite. <br><br><h2>  Multiple assignment </h2><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SearchForAddress</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">....</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">double</span></span> num1; long2 = num1 = <span class="hljs-number"><span class="hljs-number">0</span></span>; long1 = num1 = num1; <span class="hljs-comment"><span class="hljs-comment">// &lt;= lat2 = num1 = num1; // &lt;= lat1 = num1; .... }</span></span></code> </pre> <br>  Warnings: <ul><li>  <a href="http://www.viva64.com/ru/d/0403/">V3005</a> The 'num1' variable is assigned to itself.  PlaceFinder.cs 2011 </li><li>  <a href="http://www.viva64.com/ru/d/0403/">V3005</a> The 'num1' variable is assigned to itself.  PlaceFinder.cs 2012 </li></ul><br>  Again, the effect of Copy-Paste, which is often found in the project.  There is no danger of this fragment, but assigning a value three times by the same change looks strange.  In my opinion, it would be <i>clearer</i> to initialize the variable <i>num1</i> immediately when it was declared, and afterwards to assign the value <i>num1</i> separately to each variable. <br><br><h2>  Insecure call to event handler </h2><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">m_timer_Elapsed</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">....</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Elapsed != <span class="hljs-literal"><span class="hljs-literal">null</span></span>) Elapsed(sender, e); }</code> </pre> <br>  A warning: <ul><li>  <a href="http://www.viva64.com/ru/d/0485/">V3083</a> Unsafe invocation of event 'Elapsed', NullReferenceException is possible.  Consider assigning an event to a local variable before invoking it.  TimeKeeper.cs 78 </li></ul><br>  In a multi-threaded application, such an event call is not secure.  A situation may well occur when between checking for <i>null</i> and directly calling the handler there will be an unsubscribe from the event in another thread.  If it was the only handler, then it would lead to the use of a null reference.  To safely call an event, it is recommended to use a temporary variable, then the event will be triggered correctly in any case.  Other ways to fix this error can be found on the diagnostics page of <a href="http://www.viva64.com/ru/d/0485/">V3083</a> . <br><br>  By the way, this is a very insidious kind of error, since problems will arise extremely rarely, and it will be almost impossible to reproduce them again! <br><br>     : <ul><li> V3083 Unsafe invocation of event 'Navigate', NullReferenceException is possible. Consider assigning event to a local variable before invoking it. InternalWebBrowser.cs 65 </li><li> V3083 Unsafe invocation of event 'Close', NullReferenceException is possible. Consider assigning event to a local variable before invoking it. InternalWebBrowser.cs 73 </li><li> V3083 Unsafe invocation of event 'OnMouseEnterEvent', NullReferenceException is possible. Consider assigning event to a local variable before invoking it. WavingFlagLayer.cs 672 </li><li> V3083 Unsafe invocation of event 'OnMouseLeaveEvent', NullReferenceException is possible. Consider assigning event to a local variable before invoking it. WavingFlagLayer.cs 691 </li><li> V3083 Unsafe invocation of event 'OnMouseUpEvent', NullReferenceException is possible. Consider assigning event to a local variable before invoking it. WavingFlagLayer.cs 1105 </li><li> V3083 Unsafe invocation of event, NullReferenceException is possible. Consider assigning event to a local variable before invoking it. TreeNodeWidget.cs 325 </li><li> V3083 Unsafe invocation of event 'OnVisibleChanged', NullReferenceException is possible. Consider assigning event to a local variable before invoking it. FormWidget.cs 721 </li><li> V3083 Unsafe invocation of event 'OnResizeEvent', NullReferenceException is possible. Consider assigning event to a local variable before invoking it. FormWidget.cs 1656 </li><li> V3083 Unsafe invocation of event 'OnMouseEnterEvent', NullReferenceException is possible. Consider assigning event to a local variable before invoking it. PictureBox.cs 351 </li><li> V3083 Unsafe invocation of event 'OnMouseLeaveEvent', NullReferenceException is possible. Consider assigning event to a local variable before invoking it. PictureBox.cs 362 </li><li> V3083 Unsafe invocation of event 'OnMouseUpEvent', NullReferenceException is possible. Consider assigning event to a local variable before invoking it. PictureBox.cs 590 </li><li> V3083 Unsafe invocation of event 'OnMouseEnterEvent', NullReferenceException is possible. Consider assigning event to a local variable before invoking it. WorldWind.Widgets.PictureBox.cs 282 </li><li> V3083 Unsafe invocation of event 'OnMouseLeaveEvent', NullReferenceException is possible. Consider assigning event to a local variable before invoking it. WorldWind.Widgets.PictureBox.cs 293 </li><li> V3083 Unsafe invocation of event 'OnMouseUpEvent', NullReferenceException is possible. Consider assigning event to a local variable before invoking it. WorldWind.Widgets.PictureBox.cs 511 </li><li> V3083 Unsafe invocation of event 'OnVisibleChanged', NullReferenceException is possible. Consider assigning event to a local variable before invoking it. WorldWindow.Widgets.Form.cs 184 </li><li> V3083 Unsafe invocation of event 'StatusChanged', NullReferenceException is possible. Consider assigning event to a local variable before invoking it. ScriptPlayer.cs 57 </li><li> V3083 Unsafe invocation of event 'Navigate', NullReferenceException is possible. Consider assigning event to a local variable before invoking it. HtmlEditor.cs 608 </li><li> V3083 Unsafe invocation of event 'ReadyStateChanged', NullReferenceException is possible. Consider assigning event to a local variable before invoking it. HtmlEditor.cs 578 </li><li> V3083 Unsafe invocation of event 'UpdateUI', NullReferenceException is possible. Consider assigning event to a local variable before invoking it. HtmlEditor.cs 568 </li><li> V3083 Unsafe invocation of event 'HtmlKeyPress', NullReferenceException is possible. Consider assigning event to a local variable before invoking it. HtmlEditor.cs 587 </li><li> V3083 Unsafe invocation of event 'HtmlEvent', NullReferenceException is possible. Consider assigning event to a local variable before invoking it. HtmlEditor.cs 600 </li><li> V3083 Unsafe invocation of event 'BeforeNavigate', NullReferenceException is possible. Consider assigning event to a local variable before invoking it. HtmlEditor.cs 635 </li><li> V3083 Unsafe invocation of event 'BeforeShortcut', NullReferenceException is possible. Consider assigning event to a local variable before invoking it. HtmlEditor.cs 626 </li><li> V3083 Unsafe invocation of event 'BeforePaste', NullReferenceException is possible. Consider assigning event to a local variable before invoking it. HtmlEditor.cs 644 </li><li> V3083 Unsafe invocation of event 'ContentChanged', NullReferenceException is possible. Consider assigning event to a local variable before invoking it. HtmlEditor.cs 615 </li></ul><br><h2>     </h2><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">APRSParse</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">....</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> iRet=<span class="hljs-number"><span class="hljs-number">-1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">lock</span></span>(<span class="hljs-string"><span class="hljs-string">"ExternDllAccess"</span></span>) { <span class="hljs-comment"><span class="hljs-comment">//Call the APRS DLL iRet=APRSParseLinePosStat(sString, ref aprsPosition, ref aprsStatus); } } catch(Exception) { iRet=-1; } return iRet; }</span></span></code> </pre> <br> : <ul><li> <a href="http://www.viva64.com/ru/d/0497/">V3090</a> Unsafe locking on an object of type 'String'. GPSTrackerPlugin.APRS.cs 256 </li></ul><br>           .          .      ,                   . <br><br>     : <ul><li> V3090 Unsafe locking on an object of type 'String'. GPSTrackerPlugin.File.cs 226 </li><li> V3090 Unsafe locking on an object of type 'String'. GPSTrackerPlugin.File.cs 244 </li><li> V3090 Unsafe locking on an object of type 'String'. GPSTrackerPlugin.File.cs 370 </li><li> V3090 Unsafe locking on an object of type 'String'. GPSTrackerPlugin.File.cs 416 </li><li> V3090 Unsafe locking on an object of type 'String'. GPSTrackerPlugin.File.cs 448 </li><li> V3090 Unsafe locking on an object of type 'String'. GPSTrackerPlugin.File.cs 723 </li><li> V3090 Unsafe locking on an object of type 'String'. GPSTrackerPlugin.WorldWind.cs 339 </li><li> V3090 Unsafe locking on an object of type 'String'. GPSTrackerPlugin.WorldWind.cs 394 </li><li> V3090 Unsafe locking on an object of type 'String'. GPSTrackerPlugin.WorldWind.cs 468 </li><li> V3090 Unsafe locking on an object of type 'String'. GPSTrackerPlugin.WorldWind.cs 538 </li><li> V3090 Unsafe locking on an object of type 'String'. GPSTracker.cs 3853 </li><li> V3090 Unsafe locking on an object of type 'String'. GPSTracker.cs 6787 </li><li> V3090 Unsafe locking on a type. All instances of a type will have the same 'Type' object. JHU_Globals.cs 73 </li><li> V3090 Unsafe locking on a type. All instances of a type will have the same 'Type' object. JHU_Globals.cs 222 </li><li> V3090 Unsafe locking on a type. All instances of a type will have the same 'Type' object. JHU_Log.cs 145 </li></ul><br><h2>  &amp;  &amp;&amp; </h2><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetDocumentSource</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">....</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> iSize = <span class="hljs-number"><span class="hljs-number">2048</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] bytedata = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[<span class="hljs-number"><span class="hljs-number">2048</span></span>]; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> iBOMLength = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (<span class="hljs-literal"><span class="hljs-literal">true</span></span>) { iSize = memstream.Read(bytedata, <span class="hljs-number"><span class="hljs-number">0</span></span>, bytedata.Length); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (iSize &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!IsUnicodeDetermined) { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((bytedata[<span class="hljs-number"><span class="hljs-number">0</span></span>] == <span class="hljs-number"><span class="hljs-number">0xEF</span></span>) &amp; (bytedata[<span class="hljs-number"><span class="hljs-number">1</span></span>] == <span class="hljs-number"><span class="hljs-number">0xBB</span></span>) &amp; (bytedata[<span class="hljs-number"><span class="hljs-number">2</span></span>] == <span class="hljs-number"><span class="hljs-number">0xBF</span></span>)) <span class="hljs-comment"><span class="hljs-comment">//UTF8 { IsUTF8 = true; IsBOMPresent = true; } if (!IsUTF16LE &amp; !IsUTF16BE &amp; !IsUTF8) { if ((bytedata[1] == 0) &amp; (bytedata[3] == 0) &amp; (bytedata[5] == 0) &amp; (bytedata[7] == 0)) { IsUTF16LE = true; //best guess } } .... } } .... }</span></span></code> </pre> <br>  Warnings: <ul><li> V3093 The '&amp;' operator evaluates both operands. Perhaps a short-circuit '&amp;&amp;' operator should be used instead. utils.cs 280 </li><li> V3093 The '&amp;' operator evaluates both operands. Perhaps a short-circuit '&amp;&amp;' operator should be used instead. utils.cs 291 </li></ul><br>  ,        . ,   ,    &amp;     .      &amp;&amp;.   ,  , ,    ,        <i>bytedata[2]</i> , <i>bytedata[3]</i>   ,        . <br><br><h2>   </h2><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> IWidgetCollection m_ChildWidgets = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> WidgetCollection(); <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">interface</span></span> <span class="hljs-title"><span class="hljs-title">IWidgetCollection</span></span> { .... IWidget <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>[<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> index] {<span class="hljs-keyword"><span class="hljs-keyword">get</span></span>;<span class="hljs-keyword"><span class="hljs-keyword">set</span></span>;} .... } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Render</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">DrawArgs drawArgs</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> index = m_ChildWidgets.Count<span class="hljs-number"><span class="hljs-number">-1</span></span>; index&gt;=<span class="hljs-number"><span class="hljs-number">0</span></span>; index--) { IWidget currentChildWidget = m_ChildWidgets[index] <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> IWidget; <span class="hljs-comment"><span class="hljs-comment">// &lt;= .... } .... }</span></span></code> </pre> <br> : <ul><li> <a href="http://www.viva64.com/ru/d/0455/">V3051</a> An excessive type cast. The object is already of the 'IWidget' type. PanelWidget.cs 749 </li></ul><br> , ,   ,    .    ,    ,   .   <i>as</i> ,    .   ,    ,     .      ,   ,        .   : <ul><li> V3051 An excessive type cast. The object is already of the 'IWidget' type. FormWidget.cs 1174 </li><li> V3051 An excessive type cast. The object is already of the 'IWidget' type. RootWidget.cs 80 </li><li> V3051 An excessive type cast. The object is already of the 'IWidget' type. RootWidget.cs 219 </li><li> V3051 An excessive type cast. The object is already of the 'IWidget' type. RootWidget.cs 244 </li><li> V3051 An excessive type cast. The object is already of the 'IWidget' type. RootWidget.cs 269 </li><li> V3051 An excessive type cast. The object is already of the 'IWidget' type. RootWidget.cs 294 </li><li> V3051 An excessive type cast. The object is already of the 'IWidget' type. RootWidget.cs 313 </li><li> V3051 An excessive type cast. The object is already of the 'IWidget' type. RootWidget.cs 337 </li><li> V3051 An excessive type cast. The object is already of the 'IWidget' type. RootWidget.cs 362 </li><li> V3051 An excessive type cast. The object is already of the 'IWidget' type. RootWidget.cs 387 </li><li> V3051 An excessive type cast. The object is already of the 'IWidget' type. RootWidget.cs 412 </li><li> V3051 An excessive type cast. The object is already of the 'IWidget' type. WorldWind.Widgets.RootWidget.cs 24 </li><li> V3051 An excessive type cast. The object is already of the 'IWidget' type. WorldWind.Widgets.RootWidget.cs 148 </li><li> V3051 An excessive type cast. The object is already of the 'IWidget' type. WorldWind.Widgets.RootWidget.cs 167 </li><li> V3051 An excessive type cast. The object is already of the 'IWidget' type. WorldWind.Widgets.RootWidget.cs 186 </li><li> V3051 An excessive type cast. The object is already of the 'IWidget' type. WorldWind.Widgets.RootWidget.cs 204 </li><li> V3051 An excessive type cast. The object is already of the 'IWidget' type. WorldWind.Widgets.RootWidget.cs 222 </li><li> V3051 An excessive type cast. The object is already of the 'IWidget' type. WorldWind.Widgets.RootWidget.cs 246 </li><li> V3051 An excessive type cast. The object is already of the 'IWidget' type. WorldWindow.Widgets.Form.cs 429 </li><li> V3051 An excessive type cast. The object is already of the 'IWidget' type. JHU_FormWidget.cs 1132 </li><li> V3051 An excessive type cast. The object is already of the 'IWidget' type. JHU_RootWidget.cs 80 </li><li> V3051 An excessive type cast. The object is already of the 'IWidget' type. JHU_RootWidget.cs 215 </li><li> V3051 An excessive type cast. The object is already of the 'IWidget' type. JHU_RootWidget.cs 240 </li><li> V3051 An excessive type cast. The object is already of the 'IWidget' type. JHU_RootWidget.cs 265 </li><li> V3051 An excessive type cast. The object is already of the 'IWidget' type. JHU_RootWidget.cs 290 </li><li> V3051 An excessive type cast. The object is already of the 'IWidget' type. JHU_RootWidget.cs 315 </li><li> V3051 An excessive type cast. The object is already of the 'IWidget' type. JHU_RootWidget.cs 340 </li><li> V3051 An excessive type cast. The object is already of the 'IWidget' type. JHU_RootWidget.cs 365 </li><li> V3051 An excessive type cast. The object is already of the 'IWidget' type. JHU_RootWidget.cs 390 </li><li> V3051 An excessive type cast. The object is already of the 'IWidget' type. JHU_PanelWidget.cs 744 </li></ul><br><h2>   </h2><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">LoadUrl</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">String url</span></span></span><span class="hljs-function">)</span></span> { .... <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!isCreated) { Debug.WriteLine(<span class="hljs-string"><span class="hljs-string">"Doc not created"</span></span> + iLoadAttempts.ToString()); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (iLoadAttempts &lt; <span class="hljs-number"><span class="hljs-number">2</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.bLoadUrlWhenReady = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HtmlEditorException(<span class="hljs-string"><span class="hljs-string">"Document not created"</span></span>); } } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!isCreated) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-comment"><span class="hljs-comment">// &lt;= .... }</span></span></code> </pre> <br> : <ul><li> <a href="http://www.viva64.com/ru/d/0390/">V3021</a> There are two 'if' statements with identical conditional expressions.  The first 'if' statement contains method return. This means that the second 'if' statement is senseless HtmlEditor.cs 1480 </li></ul><br>        .     ,         .    ,       .      ,     ,    ‚Äî  . ,          . ,  - ,      .  , ,       ,    . <br><br><h2>  Conclusion </h2><br>     ,        ,     . ,   ‚Äî   ,         .  ,  ,  PVS-Studio     ,      .         : <a href="http://www.viva64.com/ru/pvs-studio-download/"></a> . <br><br><div style="text-align:center;"> <a href="http://www.viva64.com/en/b/0416/"><img src="https://habrastorage.org/getpro/habr/post_images/35e/064/ddf/35e064ddf91f5d99b620384893909ff7.png"></a> </div><br>  If you want to share this article with an English-speaking audience, then please use the link to the translation: Alexander Chibisov. <a href="http://www.viva64.com/en/b/0416/">Dusting the globe: analysis of NASA World Wind project</a> . <br><br><div class="spoiler">  <b class="spoiler_title">Read the article and have a question?</b> <div class="spoiler_text">  Often our articles are asked the same questions.  We collected answers to them here: <a href="http://www.viva64.com/ru/a/0085/">Answers to questions from readers of articles about PVS-Studio, version 2015</a> .  Please review the list. <br></div></div></div><p>Source: <a href="https://habr.com/ru/post/306906/">https://habr.com/ru/post/306906/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../306896/index.html">Optical fiber in industrial communication systems</a></li>
<li><a href="../306898/index.html">SMAS: ‚ÄúSorted Multi Array Struct‚Äù ‚Äîan alternative to a binary search tree</a></li>
<li><a href="../306900/index.html">Monitoring applications in IT. Easier than a burger</a></li>
<li><a href="../306902/index.html">Hamlet's smuggling with a cat</a></li>
<li><a href="../306904/index.html">We work with a hybrid cloud: VMware vCloud Connector, part 1</a></li>
<li><a href="../306908/index.html">It doesn't matter if you are big or small. The main thing is not small. Stuffing Material Design</a></li>
<li><a href="../306912/index.html">Moscow Institute of Physics and Technology: the reception of applications to the online magistracy in modern combinatorics is ending</a></li>
<li><a href="../306914/index.html">Understanding Go: io Package</a></li>
<li><a href="../306916/index.html">Stylization of images using neural networks: no mysticism, just matan</a></li>
<li><a href="../306918/index.html">11 Essential Hiring Tips for Starting Employers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>