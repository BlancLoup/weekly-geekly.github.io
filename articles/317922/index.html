<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Depla web applications using Ansistrano</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ansistrano.deploy and ansistrano.rollback are Ansible roles designed to control the deployment of applications created in scripting programming langua...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Depla web applications using Ansistrano</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/files/bc4/9fd/9d2/bc49fd9d21d24c83814a517cb24c1543.png"></div><br><p>  <strong>ansistrano.deploy</strong> and <strong>ansistrano.rollback</strong> are Ansible roles designed to control the deployment of applications created in scripting programming languages ‚Äã‚Äã(for example, PHP, Python, and Ruby).  Essentially, this is Capistrano's implementation of Ansible. </p><br><p>  Using Ansistrano provides the following benefits: </p><br><ul><li>  rollback in seconds (with the role of ansistrano.rollback); </li><li>  setting up a deployment procedure using event handlers for ‚Äúbefore‚Äù and ‚Äúafter‚Äù critical steps; </li><li>  optimizing disk space usage by storing a limited number of releases; </li><li>  choice between SCP, RSYNC, GIT, SVN, HTTP Download or S3 GET deployment strategies (in addition, <em>unarchive</em> use is <em>possible</em> ). </li></ul><a name="habracut"></a><br><h4 id="kak-poyavilsya-ansistrano">  How did Ansistrano come about? </h4><br><p>  At the beginning was <a href="http://capistranorb.com/">Capistrano</a> , which is a server management automation tool;  its current version is number 3. <a href="https://github.com/capistrano/capistrano/tree/legacy-v2">Version 2.0</a> was created to deploy RoR applications.  Using plugins, you could work with non-Rails applications written, for example, in PHP or Python, using different deployment strategies, test environments, and more.  And it was good. </p><br><p>  Capistrano 2 is a great tool that still works.  But it is no longer supported, as the developers have switched to the third version.  At the same time, according to the creators of Ansistrano, Capistrano 3 is less flexible and not as powerful, and also does not have the feature set that the previous version had.  In addition, other application deployment tools (for example, Ansible) do not stand still and are constantly being improved. </p><br><p>  The Ansistrano developers explain the rejection of Capistrano by the lack of support for version 2 and the lack of functionality in v3, as well as by the fact that all the necessary tasks are accomplished with the help of Ansible.  Alternatively, it is proposed to look at Fabric and Chef Solo. </p><br><p>  By the way, the name of the project - Ansistrano - was obtained by combining Ansible and Capistrano. </p><br><h4 id="anonimnaya-statistika-ispolzovaniya-ansistrano">  Anonymous Ansistrano usage statistics </h4><br><p>  An additional optional step has recently been added to Ansistrano, which gives developers the opportunity to find out how many people are deploying applications with Ansistrano.  Since Ansible Galaxy does not provide statistics on downloads or usage, the authors of Ansistrano claim that this was almost the only way to find out the number of users of the project. </p><br><p>  The code for collecting anonymous statistics, see <a href="">here</a> .  In addition, this <del>  probe </del>  the functionality can be disabled by setting the <code>ansistrano_allow_anonymous_stats</code> setting in all playbuttons to false. </p><br><h4 id="kto-ispolzuet-ansistrano">  Who uses Ansistrano? </h4><br><p>  Is Ansistrano ready for use? </p><br><div class="spoiler">  <b class="spoiler_title">Here are some companies that work with Ansistrano:</b> <div class="spoiler_text"><ul><li>  <a href="http://www.atrapalo.com/">Atr√°palo</a> </li><li>  <a href="http://www.anotherplaceproductions.com/">Another Place Productions</a> </li><li>  <a href="http://www.suntransfers.com/">Suntransfers</a> </li><li>  <a href="https://www.ulabox.com/">Ulabox</a> </li><li>  <a href="http://euromillions.com/">Euromillions.com</a> </li><li>  <a href="http://www.uvinum.com/">Uvinum</a> </li><li>  <a href="http://www.cycloid.io/">Cycloid</a> </li><li>  <a href="https://www.spotahome.com/">Spotahome</a> </li><li>  <a href="http://www.ofertix.com/">Ofertix</a> </li><li>  <a href="http://www.niceandcrazy.com/">Nice &amp; crazy</a> </li><li>  <a href="http://www.g-stock.es/">Gstock</a> </li><li>  <a href="http://www.teamcmp.com/">CMP Group</a> </li><li>  <a href="http://jolicode.com/">Jolicode</a> </li><li>  <a href="http://monitoring.wavecontrol.com/ca/public/demo/">Wavecontrol</a> </li><li>  <a href="http://www.enalquiler.com/">Enalquiler</a> </li><li>  <a href="http://www.abaenglish.com/">ABA English</a> </li><li>  <a href="http://oferplan.com/">Offerplan</a> </li><li>  <a href="https://yubl.me/">Yubl</a> </li><li>  <a href="http://www.fluxus.io/">Fluxus</a> </li><li>  TechPump </li><li>  <a href="http://www.nodoambar.com/">Nodo √Åmbar</a> </li><li>  <a href="https://www.cabissimo.com/">Cabissimo</a> </li><li>  <a href="https://www.unicef.es/">UNICEF Comit√© Espa√±ol</a> </li><li>  <a href="http://www.claranet.fr/">Claranet france</a> </li><li>  <a href="http://opsway.com/">OpsWay Software Factory</a> </li></ul></div></div><br><h4 id="ustanovka-i-obnovlenie">  Installation and Update </h4><br><p>  To deploy applications with Ansistrano you will need: </p><br><ul><li>  Ansible on the central machine; </li><li>  <code>rsync</code> on target machine (if <code>rsync</code> , <code>git</code> or <code>ansistrano_current_via = rsync</code> deployment strategy is used). </li></ul><br><p>  Ansistrano is available via <a href="https://galaxy.ansible.com/">Ansible Galaxy</a> .  To start the installation, run: </p><br><pre> <code class="bash hljs">$ ansible-galaxy install carlosbuenosvinos.ansistrano-deploy carlosbuenosvinos.ansistrano-rollback</code> </pre> <br><p>  To update Ansistrano, add the <strong>--force</strong> parameter: </p><br><pre> <code class="bash hljs">$ ansible-galaxy install --force carlosbuenosvinos.ansistrano-deploy carlosbuenosvinos.ansistrano-rollback</code> </pre> <br><h4 id="osnovnaya-shema-raboty">  The main scheme of work </h4><br><p>  Deploying applications with Ansistrano follows the same pattern as Capistrano. </p><br><ul><li>  Setup: creates a directory structure for storing releases. </li><li>  Code Update: Download release to target machines. </li><li>  Link Update (Symlink): After deploying a new release on target machines, the <code>current</code> link is set to the new release. </li><li>  Cleaning (Cleanup): taking into account the parameter <code>ansistrano_keep_releases</code> , old versions are removed (see ‚ÄúRole Variables‚Äù). </li></ul><br><img src="https://habrastorage.org/files/134/9bc/5e5/1349bc5e5eb745a28888380aaec5713c.png"><br><p><br></p><br><h4 id="peremennye-roli">  Variable roles </h4><br><p>  The following is a list of Ansistrano variables for reference. </p><br><div class="spoiler">  <b class="spoiler_title">List of role variables</b> <div class="spoiler_text"><pre> <code class="bash hljs">- vars: ansistrano_deploy_from: <span class="hljs-string"><span class="hljs-string">"{{ playbook_dir }}"</span></span> <span class="hljs-comment"><span class="hljs-comment">#   (   ). ansistrano_deploy_to: "/var/www/my-app" #   . ansistrano_version_dir: "releases" #    . ansistrano_current_dir: "current" #     ,  . ansistrano_current_via: "symlink" #     "current". : "symlink"  "rsync". ansistrano_shared_paths: [] #        . ansistrano_shared_files: [] #        . ansistrano_keep_releases: 0 # ,   . . ¬´  ¬ª. ansistrano_deploy_via: "rsync" #     . : "copy", "rsync", "git", "svn", "s3"  "download".  "copy", "download"  "s3"    (unarchive)   (  "_unarchive").        *tasks/update-code*. ansistrano_allow_anonymous_stats: yes # ,     "rsync" ansistrano_rsync_extra_params: "" #  ,        rsync  .  Ansible   ,         "--include". .     https://github.com/ansistrano/deploy/commit/e98942dc969d4e620313f00f003a7ea2eab67e86 ansistrano_rsync_set_remote_user: yes # . [ansible synchronize module](http://docs.ansible.com/ansible/synchronize_module.html). : "yes", "no". # ,     Git ansistrano_git_repo: git@github.com:USERNAME/REPO.git #   git. ansistrano_git_branch: master #    .     40-  SHA-1,  HEAD,      (tag name). ansistrano_git_repo_tree: "" #    (subtree)   . ansistrano_git_identity_key_path: "" #  ,             git,    ,   . # ,     SVN #  :  Ansible 1.8.x     subversion (https://github.com/ansible/ansible-modules-core/issues/370),        Ansible 1.9. ansistrano_svn_repo: "https://svn.company.com/project" #   svn ansistrano_svn_branch: "trunk" #    . ansistrano_svn_revision: "HEAD" #    . ansistrano_svn_username: "user" # SVN authentication username ansistrano_svn_password: "Pa$$word" # SVN authentication password # ,     download ansistrano_get_url: https://github.com/someproject/somearchive.tar.gz # ,     S3 ansistrano_s3_bucket: s3bucket ansistrano_s3_object: s3object.tgz #   _unarchive  ansistrano_deploy_via,      (, s3_unarchive) ansistrano_s3_region: eu-west-1 ansistrano_s3_rgw: false #   Ansible &gt;= 2.2,  Ceph RGW (   "true",  ansistrano_s3_region) ansistrano_s3_url: http://rgw.example.com #   Ceph RGW  url #  ,     ansistrano_s3_aws_access_key: YOUR_AWS_ACCESS_KEY ansistrano_s3_aws_secret_key: YOUR_AWS_SECRET_KEY # Hooks: (     ) ansistrano_before_setup_tasks_file: "{{ playbook_dir }}/&lt;your-deployment-config&gt;/my-before-setup-tasks.yml" ansistrano_after_setup_tasks_file: "{{ playbook_dir }}/&lt;your-deployment-config&gt;/my-after-setup-tasks.yml" ansistrano_before_update_code_tasks_file: "{{ playbook_dir }}/&lt;your-deployment-config&gt;/my-before-update-code-tasks.yml" ansistrano_after_update_code_tasks_file: "{{ playbook_dir }}/&lt;your-deployment-config&gt;/my-after-update-code-tasks.yml" ansistrano_before_symlink_shared_tasks_file: "{{ playbook_dir }}/&lt;your-deployment-config&gt;/my-before-symlink-shared-tasks.yml" ansistrano_after_symlink_shared_tasks_file: "{{ playbook_dir }}/&lt;your-deployment-config&gt;/my-after-symlink-shared-tasks.yml" ansistrano_before_symlink_tasks_file: "{{ playbook_dir }}/&lt;your-deployment-config&gt;/my-before-symlink-tasks.yml" ansistrano_after_symlink_tasks_file: "{{ playbook_dir }}/&lt;your-deployment-config&gt;/my-after-symlink-tasks.yml" ansistrano_before_cleanup_tasks_file: "{{ playbook_dir }}/&lt;your-deployment-config&gt;/my-before-cleanup-tasks.yml" ansistrano_after_cleanup_tasks_file: "{{ playbook_dir }}/&lt;your-deployment-config&gt;/my-after-cleanup-tasks.yml"</span></span></code> </pre> <br><p>  <code>{{ playbook_dir }}</code> - Ansible variable, which stores the path to the current playbook. </p></div></div><br><h4 id="razvertyvanie">  Deployment </h4><br><p>  To deploy with Ansistrano, take a few steps. </p><br><ul><li>  Create a new <code>hosts</code> .  For questions, see the <a href="http://docs.ansible.com/intro_inventory.html">Ansible Inventory documentation</a> .  The target machines will be listed in this file. </li><li>  Create a new playbook to deploy the application (for example, <code>deploy.yml</code> ). </li><li>  Configure variable roles. </li><li>  Include the role of <code>carlosbuenosvinos.ansistrano-deploy</code> in the script (play). </li><li>  Start the playbook. </li></ul><br><pre> <code class="bash hljs">ansible-playbook -i hosts deploy.yml</code> </pre> <br><p>  If everything was configured correctly, this command will create approximately the following directory structure on the server.  Check out what the <em>hosts</em> directory will look like after one, two and three deployments. </p><br><pre> <code class="bash hljs">-- /var/www/my-app.com |-- current -&gt; /var/www/my-app.com/releases/20100509145325 |-- releases | |-- 20100509145325 |-- shared</code> </pre> <br><pre> <code class="bash hljs">-- /var/www/my-app.com |-- current -&gt; /var/www/my-app.com/releases/20100509150741 |-- releases | |-- 20100509150741 | |-- 20100509145325 |-- shared</code> </pre> <br><pre> <code class="bash hljs">-- /var/www/my-app.com |-- current -&gt; /var/www/my-app.com/releases/20100512131539 |-- releases | |-- 20100512131539 | |-- 20100509150741 | |-- 20100509145325 |-- shared</code> </pre> <br><h5 id="posledovatelnye-razvertyvaniya">  Sequential deployments </h5><br><p>  To prevent different timestamps from being deployed to multiple servers using the <a href="http://docs.ansible.com/playbooks_delegation.html"><code>serial</code></a> option, set the variable <code>ansistrano_release_version</code> . </p><br><pre> <code class="bash hljs">ansible-playbook -i hosts -e <span class="hljs-string"><span class="hljs-string">"ansistrano_release_version=`date -u +%Y%m%d%H%M%SZ`"</span></span> deploy.yml</code> </pre> <br><h4 id="otkat">  Rollback </h4><br><p>  To roll back with Ansistrano, you must configure the deployment and perform a rollback playbook. </p><br><pre> <code class="bash hljs">ansible-playbook -i hosts rollback.yml</code> </pre> <br><p>  If you try to rollback with the number of deployed releases equal to 1 or 0, the system will generate an error;  no action will be performed. </p><br><p>  In a rollback scenario, compared to a deployment, there are far fewer custom variables: </p><br><pre> <code class="bash hljs">- vars: ansistrano_deploy_to: <span class="hljs-string"><span class="hljs-string">"/var/www/my-app"</span></span> <span class="hljs-comment"><span class="hljs-comment">#   . ansistrano_version_dir: "releases" #    . ansistrano_current_dir: "current" #     ,  . # Hooks: (     ) ansistrano_before_symlink_tasks_file: "{{ playbook_dir }}/&lt;your-deployment-config&gt;/my-before-symlink-tasks.yml" ansistrano_after_symlink_tasks_file: "{{ playbook_dir }}/&lt;your-deployment-config&gt;/my-after-symlink-tasks.yml" ansistrano_before_cleanup_tasks_file: "{{ playbook_dir }}/&lt;your-deployment-config&gt;/my-before-cleanup-tasks.yml" ansistrano_after_cleanup_tasks_file: "{{ playbook_dir }}/&lt;your-deployment-config&gt;/my-after-cleanup-tasks.yml"</span></span></code> </pre> <br><h4 id="mnogostadiynye-sredy-multistage-environments--devel-preprod-prod-i-t-d">  Multistage environments (devel, preprod, prod, etc.) </h4><br><p>  When deploying to different environments (for example, <em>devel</em> , <em>preprod</em> and <em>prod</em> ), it is recommended to create different <em>hosts</em> files for them.  The same playbook can be launched for different <em>hosts</em> files using the <strong>-i</strong> parameter.  In each of these files, you can specify different data (usernames, passwords, connection settings, etc.). </p><br><pre> <code class="bash hljs">ansible-playbook -i hosts_devel deploy.yml ansible-playbook -i hosts_preprod deploy.yml ansible-playbook -i hosts_prod deploy.yml</code> </pre> <br><h4 id="hooks-polzovatelskie-zadachi-custom-tasks">  Hooks: custom tasks </h4><br><p>  After the <code>Symlink</code> step, it is usually necessary to restart the server, or download dependencies before <code>Code update</code> , or even do it in <em>production</em> before <code>Symlink</code> .  So, to perform custom tasks, you need handlers (hooks) that Ansistrano will perform before or after each of the 3 basic steps. </p><br><pre> <code class="bash hljs">-- /my-local-machine/my-app.com |-- hosts |-- deploy.yml |-- my-custom-tasks | |-- before-code-update.yml | |-- after-code-update.yml | |-- before-symlink.yml | |-- after-symlink.yml | |-- before-cleanup.yml | |-- after-cleanup.yml</code> </pre> <br><p>  For example, to restart Apache after the <code>after-symlink.yml</code> step, add the following lines to <code>after-symlink.yml</code> : </p><br><pre> <code class="hljs pgsql">- <span class="hljs-type"><span class="hljs-type">name</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">Restart</span></span> Apache service: <span class="hljs-type"><span class="hljs-type">name</span></span>=httpd state=reloaded</code> </pre> <br><p>  How to add mail notification of deployment completion or clear the cache?  Very simple!  Using the variables of the role <code>ansistrano_before_*_tasks_file</code> and <code>ansistrano_after_*_tasks_file</code> you can specify a file with custom tasks for the ‚Äúbefore‚Äù and ‚Äúafter‚Äù points of each step. </p><br><h4 id="peremennye-v-polzovatelskih-zadachah">  Variables in custom tasks </h4><br><p>  When writing custom task files, you may need some variables that are available in Ansistrano: </p><br><ul><li>  <code>{{ ansistrano_release_path.stdout }}</code> : the path to the current release for deployment (this is probably the most needed variable); </li><li>  <code>{{ ansistrano_releases_path.stdout }}</code> : path to the directory with releases; </li><li>  <code>{{ ansistrano_shared_path.stdout }}</code> : path to the shared folder (where files common to all releases can be stored); </li><li>  <code>{{ ansistrano_release_version }}</code> : relative name of the directory with the release (default is the current timestamp in the UTC zone). </li></ul><br><h4 id="udalenie-staryh-relizov">  Remove old releases </h4><br><p>  In environments where Continuous delivery is applied, many releases are usually put into commercial operation.  Those lucky ones who may have an excess of free space on disks may not see this as a problem, but it‚Äôs common practice to store only a limited number of releases. </p><br><p>  To remove old releases after deployment, write to the variable <code>ansistrano_keep_releases</code> amount you want to keep. </p><br><p>  Let's take a look at how Ansistrano will behave when deploying three releases and <code>ansistrano_keep_releases: 2</code> : </p><br><pre> <code class="bash hljs">-- /var/www/my-app.com |-- current -&gt; /var/www/my-app.com/releases/20100509145325 |-- releases | |-- 20100509145325 |-- shared</code> </pre> <br><pre> <code class="bash hljs">-- /var/www/my-app.com |-- current -&gt; /var/www/my-app.com/releases/20100509150741 |-- releases | |-- 20100509150741 | |-- 20100509145325 |-- shared</code> </pre> <br><pre> <code class="bash hljs">-- /var/www/my-app.com |-- current -&gt; /var/www/my-app.com/releases/20100512131539 |-- releases | |-- 20100512131539 | |-- 20100509150741 |-- shared</code> </pre> <br><p>  Note that the release <code>20100509145325</code> been removed. </p><br><h4 id="primer-pleybuka">  Example playbook </h4><br><p>  In the <code>example</code> directory of the <a href="https://github.com/ansistrano/deploy">Ansistrano</a> repository, <a href="https://github.com/ansistrano/deploy">you</a> can find a demonstration project that gives an example of deploying a small application. </p><br><p>  To run it, you will need Vagrant and Ansistrano roles.  For information on working with Vagrant, see <a href="https://www.vagrantup.com/">https://www.vagrantup.com</a> . </p><br><pre> <code class="bash hljs">$ <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> example/my-playbook $ vagrant up $ ansible-playbook -i hosts deploy.yml</code> </pre> <br><p>  After executing these commands, the <em>index.html</em> file located in the <code>my-app</code> directory will be deployed to both machines created using Vagrant. </p><br><p>  To test a rollback, you need to run <em>deploy.yml</em> at least twice (in order to roll back to something).  After that do: </p><br><pre> <code class="bash hljs">$ ansible-playbook -i hosts rollback.yml</code> </pre> <br><p>  In the <em>test</em> folder there are more complex examples that use Travis-CI. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/317922/">https://habr.com/ru/post/317922/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../317910/index.html">How Yandex taught the machine to create translations for rare languages</a></li>
<li><a href="../317912/index.html">As we on Habr√© survey about CRM conducted: results</a></li>
<li><a href="../317914/index.html">Citrix NetScaler and one-time passwords</a></li>
<li><a href="../317916/index.html">Test automation by Scrum methodology</a></li>
<li><a href="../317918/index.html">How to make the perfect tutorial for hardcore gamers and their moms</a></li>
<li><a href="../317924/index.html">Three minutes to set up WiFi authorization via SMS</a></li>
<li><a href="../317928/index.html">RxJava. Remove magic</a></li>
<li><a href="../317930/index.html">Articles underlying Facebook's vision for computer vision</a></li>
<li><a href="../317934/index.html">History of one name, or positioning of a product on a new platform</a></li>
<li><a href="../317936/index.html">December release of ReSharper Ultimate 2016.3</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>