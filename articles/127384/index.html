<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>No entry for unauthorised people</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Have you ever had the idea that the idea of ‚Äã‚Äãusing a username and password to log in to the system is somewhat outdated? Why, having a flash drive in...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>No entry for unauthorised people</h1><div class="post__text post__text-html js-mediator-article">  Have you ever had the idea that the idea of ‚Äã‚Äãusing a username and password to log in to the system is somewhat outdated?  Why, having a flash drive in one pocket, a phone in another, and an installed SSH installed on a computer with configured authorization using keys, do we continue to enter these confusing passwords? <br><img src="https://habrastorage.org/storage1/79a9de2f/d99c3a69/96d93d5a/fb7406c1.jpg"><br><a name="habracut"></a><br><br>  Passwords and accounts were invented in the era of large mainframes, the hippie movement, the war in Afghanistan and large analog tape recorders, the most technologically advanced component of which were transistors.  In those days, using passwords to enter the mainframe looked really cool.  You could come up with a combination like sexhero or iamsuperman and really be proud of yourself. <br>  Today, passwords look not only archaic, but terribly inconvenient, old pontov combinations do not work anymore, and instead you have to invent furious character sets that are not only impossible to remember, but also difficult to enter the first time.  We live in the XXI century, we have access to a huge number of gadgets and technical tools that offer a much simpler and higher-quality authentication mechanism, but continue to drive passwords, swearing at the whole apartment for each unsuccessful attempt to enter the system.  It's time to fix it. <br>  In this article, I will talk about how to get rid of passwords once and for all and turn your computer into a truly technological device, to enter which you just need to insert a USB flash drive, look in a webcam, or just put a cell phone on the table. <br><br><h3>  High tech key </h3><br>  The key is the easiest and most effective method of protecting anything.  We use the keys daily: to turn on the car engine, to enter the apartment, to unlock drawers and cabinets.  The keys are convenient and easy to manufacture, thanks to modern programmable locks are not afraid to lose them.  Many times, humanity has tried to invent a replacement for the keys, but all attempts failed (we all remember what the idea of ‚Äã‚Äãusing combination locks on the access doors led to).  Why do we not use such a good and time-tested technology to protect computers? <br>  Modern analogue of the key - USB flash drive.  Regardless of the purpose for which you usually use a USB flash drive, you can always make a full-featured high-tech key from it, which will make entering the system as easy as unlocking the apartment door. <br>  There are several ways to do this, but the simplest and most universal method is to use the <a href="http://pamusb.org/">PAM_usb</a> PAM module, which will check each USB flash drive inserted into the computer for its compliance with the specified requirements and, depending on the result, unlock or block the user account. <br>  No modification of the partition table or information stored on the flash drive is required.  To identify the "correct" flash drive, its serial number, model, manufacturer, as well as a set of random data are used that are recorded in the backup flash drive area and change with every successful authentication (if someone copies your flash drive, but you have time to log in before the attacker) , the data will be changed, and its copy will no longer work).  In case of loss, there will always be an opportunity to log in using the password and recode pam_usb to a new USB flash drive.  Also, as a key, you can use various memory cards (SD, MMC) and other removable drives. <br>  Starting to use pam_usb is pretty simple.  Full system setup consists of five steps. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>1.</b> Install the libpam_usb.so library and module management utilities: <br><br> <code>$ sudo apt-get install libpam-usb pamusb-tools</code> <br> <br>  <b>2.</b> We take the flash drive, which we are going to use as a key, insert it into the USB port and execute the following command: <br><br> <code>$ sudo pamusb-conf --add-device </code> <br> <br>  So pam_usb will collect all the necessary information about the flash drive, add to its database and write 2 KB of random data.  Udisks will be used to search for flash drives in the system (the ‚Äúname‚Äù argument is used here to give the flash drive an arbitrary name and not to specify its device file), so it is important that other external drives are disabled during the operation of this command. <br><br>  <b>3.</b> Now we give pam_usb to understand that this flash drive is associated with the account we need (the path will be vasya): <br><br> <code>$ sudo pamusb-conf --add-user vasya</code> <br> <br>  <b>4.</b> Run the validation of the collected data in case the flash drive was not correctly identified.  Or we forgot to disconnect some other drive, and it was used instead of the one we need: <br><br> <code>$ sudo pamusb-check vasya</code> <br> <br>  <b>5.</b> Add pam_usb to the list of modules required for successful user authentication.  On Ubuntu and other Debian-based distributions, this is done by modifying the /etc/pam.d/common-auth file.  It is necessary to find a line of the following form in it (it may differ): <code>auth required pam_unix.so</code> .  And right in front of it add the following line: <code>auth sufficient pam_usb.so</code> . <br>  So we will inform PAM that before the login of any user, you need to give control to the pam_usb module, which will check the availability of the necessary flash drive, and only in case of failure of this operation to request a password.  Therefore, if you want to let the user in only on a flash drive, completely blocking the account in case of failure, the word ‚Äúsufficient‚Äù should be replaced with the word ‚Äúrequired‚Äù. <br>  In principle, all of this should be enough for the system to simply work (try to log out and log in to check it), however, the functionality of pam_usb can be slightly extended if you use the pamusb-agent daemon. <br>  The task of pamusb-agent is to automate the work of blocking and unlocking a user account when removing and inserting a flash drive into a PC.  In order for the agent to work, you need to add the following lines to the /etc/pamusb.conf configuration file: <br><br> <code>&lt;user id="_"&gt; <br> &lt;device&gt;_&lt;/device&gt; <br> ... <br> &lt;agent event="lock"&gt;gnome-screensaver-command --lock&lt;/agent&gt; <br> &lt;agent event="unlock"&gt;gnome-screensaver-command --deactivate&lt;/agent&gt; <br> ...&lt;/user&gt;</code> <br> <br>  This is a recipe for Gnome.  To use pamusb-agent with other environments, the "gnome-screensaver-command --lock" and "gnome-screensaver-command --deactivate" commands need to be changed. <br>  Now you can run pamusb-agent and check its performance: <br><br> <code>$ pamusb-agent</code> <br> <br>  If everything works fine, you can add it to autorun: <br><br> <code>$ cd ~/.config/autostart <br> $ ln -s /usr/bin/pamusb-agent pamusb-agent</code> <br> <br><h3>  Running around your fingers? </h3><br>  The pam_usb module is conveniently used as a protection method for laptops equipped with a card reader.  You can carry a small SD card in your wallet or inside pocket and stick it in a laptop without worrying about what it will interfere with (as is the case with a USB flash drive).  However, this approach will look somewhat archaic if the laptop is already equipped with a fingerprint scanner. <br>  Laptops with a fingerprint scanner produced by many manufacturers.  As a rule, they are not much more expensive than other models with similar characteristics, but their fingerprint sensor works only in Windows.  To eliminate this drawback, freedesktop.org launched the <a href="http://www.freedesktop.org/wiki/Software/fprint">fprint</a> project, which developed an open library implementation for fingerprint recognition and a corresponding PAM module that allows the use of the library's capabilities during user login and other account manipulations. <br>  Today, libfprint is in any distribution, so you can install it using any package manager: <br><br> <code>$ sudo apt-get install libfprint0 libpam-fprint fprint-demo</code> <br> <br>  Next, the scanner can be checked using a special demo program with a graphical interface: <br><br> <code>$ fprint_demo</code> <br> <br>  If everything works correctly and without failures, you can start setting up authentication.  To do this, run the pam_fprint_enroll program, which will allow you to make a reference fingerprint, which will then be used to identify its owner: <br><br> <code># pam_fprint_enroll ‚Äìenroll-finger 7</code> <br> <br>  The number 7 here means the index finger of the right hand.  The fprint system numbers the fingers from left to right, so that the number 1 indicates the little finger of the left hand, and 10 indicates the little finger of the right hand. <br>  When the cast is ready, add the pam_fprint module to the PAM modules stack of all applications. To do this, open the /etc/pam.d/common-auth file, find the same line ‚Äúauth required pam_unix.so‚Äù and add the line in front of it, responsible for loading pam_fprint: <code>auth sufficient pam_fprint.so</code> . <br>  With the next login everything should work. <br><br><img src="https://habrastorage.org/storage1/d0bfe66f/27ea76f7/22274cdd/64dba14c.jpg"><br><h4>  Add the pam_usb and pam_fprint modules to the PAM stack </h4><br><br><h3>  Memory on faces </h3><br>  Fingers are not the only thing that distinguishes people from each other.  We all have different faces, so the system can use a snapshot of the face taken by a webcam to identify the user.  This is not particularly security, as the attacker can show the camera an ordinary photograph printed on paper, but it will make a very strong impression on friends and acquaintances. <br>  Linux distributions do not have built-in face recognition tools, but you can add them by installing a software package called <a href="http://www.pam-face-authentication.org/">pam-face-authentication</a> , which includes a library that implements a face recognition algorithm, a PAM module for authentication, and a reference snapshot application. . <br>  All this can be collected from source or installed from third-party repositories in Ubuntu.  Since the project is still raw, and the packages are not prepared for all distributions, we will consider both installation options.  So, to install from source, we need packages with a compiler, linker and header files for all dependencies.  In Ubuntu (and in other distributions) you can install them by executing one command: <br><br> <code>$ sudo apt-get install build-essential cmake qt4-qmake libx11-dev libcv-dev libcvaux-dev libhighgui4 libhighgui-dev libqt4-dev libpam0g-dev</code> <br> <br>  Next, download the source from the project page and unpack: <br><br> <code><a href="http://goo.gl/dpD1s"></a> $ cd <br> $ wget goo.gl/dpD1s <br> $ tar -xzf pam-face-authentication-0.3.tar.gz</code> <br> <br>  Cmake is used for assembly, so everything is simple here: <br><br> <code>$ cd pam-face-authentication-0.3 <br> $ cmake &amp;&amp; make <br> $ sudo make install</code> <br> <br>  You can use the antonio.chiurazzi repository to install an already precompiled package in Ubuntu: <br><br> <code>$ sudo add-apt-repository ppa:antonio.chiurazzi/ppa <br> $ sudo apt-get update <br> $ sudo apt-get install pam-face-authentication</code> <br> <br>  After the installation is complete, launch the tutorial: <br><br> <code>$ qt-facetrainer</code> <br> <br>  We turn the face in front of the camera, constantly pressing the "Capture" button.  It is important to take at least a dozen photos so that the system learns to recognize your face from any angle.  It will also be nice to take photos in different light conditions.  Do not forget to test the system. <br>  Now add the pam_face_authentication.so module to the stack of loaded PAM modules.  To do this, open the file /etc/pam.d/gdm or /etc/pam.d/kdm (if you use KDE) and add the following line to its beginning: <code>auth sufficient pam_face_authentication.so enableX</code> / <br>  The file /etc/pam.d/common-auth should not be changed, since it is used not only by graphical logon managers, but also by standard console / bin / login and / bin / su, and pam_face requires access to X. <br>  You also need to create a profile for the new PAM module.  Open (create) the file / usr / share / pam-configs / face_authentication with the following content: <br><br> <code>Name: Manually installed face_authentication profile <br> Default: yes <br> Priority: 900 <br> Auth-Type: Primary <br> Auth: <br> [success=end default=ignore] pam_face_authentication.so enableX</code> <br> <br>  And activate it: <br><br> <code>$ sudo pam-auth-update --package face_authentication</code> <br> <br><h3>  Key from the phone </h3><br>  Cell phone is a symbol of the 21st century.  We have long been accustomed to the fact that it can be used not only for calls, but also for accessing the Internet, playing games, listening to music, watching videos, and even paying bills.  But can it be used as a key to enter the computer system? <br>  Of course yes.  Like a USB flash drive, the phone has many features that make it unique.  These are all the same manufacturer and model IDs, serial number, MAC address, IMEI, after all.  Any of them can be used to uniquely identify the device and its owner, but we will focus only on one of them - the MAC address of the Bluetooth interface. <br>  Anyone, even a very ancient and simple phone, has support for the Bluetooth protocol and, as a result, a unique MAC address that sends to the network in response to any request to search for devices with another Bluetooth adapter.  Many modern laptops have such an adapter on board, and its external USB version costs a penny, so for us a blue tooth would be an ideal option for setting up password-free and wireless authentication.  I went into the room - access is open, out - the system is locked. <br>  We take the phone, turn on Bluetooth, make it so that it is ‚Äúvisible‚Äù to other devices.  Sit at the computer and launch the hcitool utility (included in the bluez-utils package) in the device search mode: <br><br> <code>$ hcitool scan</code> <br> <br>  We get the name of your device and its MAC address, copy the last one to the clipboard.  Install the libpam_blue package (or pam_blue, where as): <br><br> <code>$ sudo apt-get install libpam_blue</code> <br> <br>  Create the configuration file /etc/security/bluesscan.conf and write the following to it: <br><br> <code>#   <br> general { <br> #     ( 3  15) <br> timeout = 15; <br> } <br> <br> #      <br> mylogin = { <br> name =  ; <br> bluemac = MAC- ; <br> }</code> <br> <br>  Save the file, open the already known /etc/pam.d/common-auth config and add the line <code>auth sufficient pam_blue.so</code> before the line containing ‚Äúpam_unix.so‚Äù. <br>  Now to log in it will be enough to put the phone next to the laptop and enter the name.  The control will then be transferred to the pam_blue module, which will scan the network, find the phone's MAC address and let the user in.  Otherwise, you will have to enter a password. <br><br><h3>  findings </h3><br>  Setting up passwordless authentication using alternative methods in Linux is quite simple.  You do not need to be an experienced geek, be able to write code or have deep knowledge in the field of security, everything is done in a few minutes and works amazingly efficiently.  You can say that most of these methods are potentially unsafe and easy to get by, but before you do this, think about how safe ordinary passwords are. <br>  The safety of a machine that outsiders can access is pure myth.  To bypass the standard password protection is simple.  There are a huge number of ways to do this, and they are all known even to children.  The password is only a small index sign, which carries information that the company has an owner, and he does not want to see uninvited guests.  By applying the methods described in the article, we will not make the system more vulnerable, but we can make our lives easier and more convenient. <br><br><h6>  The equivalent of the /etc/pam.d/common-auth file in Gentoo and Mandriva is /etc/pam.d/system-auth, in FreeBSD it is replaced by /etc/pam.d/system.  In ArchLinux, you will have to edit PAM configs for each application separately. </h6><br><h6>  Another way to protect the machine from intrusion is to remotely create the file / etc / nologin using any mobile SSH client.  To unlock you will have to log in as root and delete this file. </h6><br><br><img src="https://habrastorage.org/getpro/habr/post_images/b7f/72e/a7f/b7f72ea7fa4cd764bcff301000c3d144.jpg" alt="image"><br>  <i>Hacker Magazine, <a href="http://www.xakep.ru/articles/magazine/default.asp">September (09) 152</a></i> <i><br></i>  <i>Evgeny Zobnin ( <a href="http://execbit.ru/">execbit.ru</a> )</i> . <br><br>  Subscribe to "Hacker" <br><ul><li>  <a href="http://bit.ly/habr_subscribe_paper">1 999 .</a>  <a href="http://bit.ly/habr_subscribe_paper">for 12 numbers of paper version</a> </li><li>  <a href="http://bit.ly/digital_xakep">1249r.</a>  <a href="http://bit.ly/digital_xakep">for an annual subscription to iOS / iPad (Android'a release soon!)</a> </li><li>  <a href="http://bit.ly/habr_android">"Hacker" on Android</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/127384/">https://habr.com/ru/post/127384/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../127375/index.html">Interactive diagram on CSS and HTML</a></li>
<li><a href="../127376/index.html">Experience creating an Ajax application</a></li>
<li><a href="../127378/index.html">The history of one poker bot</a></li>
<li><a href="../127382/index.html">SSL certificates for the .google.com domain are forged</a></li>
<li><a href="../127383/index.html">Simply Linux. Fresh release</a></li>
<li><a href="../127385/index.html">Getting started with the Rungine game engine</a></li>
<li><a href="../127386/index.html">How do you pronounce acai? No not like this</a></li>
<li><a href="../127387/index.html">Confetti - simple and fast configuration of your project</a></li>
<li><a href="../127390/index.html">Google redesigned Google Docs editor</a></li>
<li><a href="../127391/index.html">Why do freelancers and customers often consider each other idiots</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>