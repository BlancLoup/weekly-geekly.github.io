<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Map / Reduce: solving real problems - TF-IDF</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Yesterday I asked a question in my HabraBlog - are people interested in learning what Hadoop is in terms of its real use? It turned out interesting. T...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Map / Reduce: solving real problems - TF-IDF</h1><div class="post__text post__text-html js-mediator-article">  Yesterday I <a href="http://sigizmund.habrahabr.ru/blog/74748/">asked a question</a> in my HabraBlog - are people interested in learning what Hadoop is in terms of its real use?  It turned out interesting.  The matter is not long - I wrote the article pretty quickly (at least its first part) - at least, because I knew for a long time what I was going to write about (because I still remember quite well how I poked myself looking for information when I started using Hadoop ).  The first article focuses on the basics - but not about the ones that are usually talked about :-) <br><br>  Before reading the article, I strongly recommend to study at least the first and last sources from the list for reading - their understanding or at least reading almost guarantees that the article will be understood without problems.  Here we go? <br><br><h3>  What is Hadoop? </h3><br><img src="http://romankirillov.info/images/hadoop-elephant-small-rgb.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Tell me, what's the point of writing about it?  More than once it has been spoken, posts on Hadoop, HDFS, and others began to be written repeatedly.  Unfortunately, usually everything ended with a rather lengthy introduction and the phrase ‚ÄúTo be continued‚Äù.  So: this is a sequel.  To some, the topic touched upon in this article may seem completely trivial and uninteresting, however, it‚Äôs the beginning of a disaster ‚Äî any complex tasks must be solved piecemeal.  This statement, in particular, we implement in the course of the article.  Immediately, I‚Äôll try to avoid writing code in this particular article ‚Äî it can wait, and you can understand the principles of building programs that work with Map / Reduce ‚Äúon cats‚Äù (besides, with the current frequency of drastic changes to the Hadoop API, any code becomes about a month later). <br><br>  When I started to deal with Hadup, the initial understanding of the Map / Reduce ideology was very difficult for me personally (I prefer to write this phrase just to emphasize that this is not about the product, but about the principle).  The essence and value of the method will be understood at the very end - after we solve a simple task. <br><a name="habracut"></a><ol><li>  The number of words in the body </li><li>  The number of terms in the body (by the term hereinafter I will understand the unique word-token) </li><li>  The number of documents in the body </li><li>  How many times each term occurs in each document </li><li>  How many documents each term contains. </li></ol>  Let's face it - the task is simple and solved in the forehead is quite simple - I do not think that it will take you more than half an hour to write such a program.  Everything becomes more complicated if the text becomes <strong>larger</strong> , the number of words grows <strong>without limit</strong> , the number of terms approaches the number of words in the text language, and dictionaries no longer fit in memory.  It's time to remember that the first principle of not only developing complex software, but also solving problems in general, was formulated quite a long time ago and is formulated as ‚Äúdivide and rule‚Äù.  So, we will divide the task into components. <br><br>  To begin with, we will make an assumption (for simplicity, and later we will look at how to solve this problem in a more general case) that our input data is presented in a text file format with a very simple structure: <br><br><pre>  &lt;w11&gt; &lt;w12&gt; &lt;w13&gt; ... &lt;w1N&gt;
 &lt;w21&gt; &lt;w22&gt; &lt;w23&gt; ... &lt;w2M&gt;
 ... </pre><br>  In other words, each document is a set of words that are possible (and quite likely) are repeated, and each such set of words is located on one line of a text file.  The assumption is small - almost every document can be presented in this form. <br><br>  Counting the number of words in the body is a simple task, and is solved in linear time, however, it may not even have to be solved separately.  The same applies to the number of terms - they count themselves.  The most interesting task at this stage is to calculate how many times each term occurs in the body of the text. <br><br>  Yes, yes, you are not mistaken, it is she who is the most popular and already tortured task, the first example in every Hadoop tutorial is WordCount.  It is as popular as it is simple - I will not even bring it here, it can be viewed in the official tutorial of Hadup.  In short, at the map step, the program forms the following pairs: <br><br><pre>  map1:
     &lt;term1&gt; 1
     &lt;term2&gt; 1
     &lt;term3&gt; 1

 map2:
     &lt;term2&gt; 1
     &lt;term3&gt; 1
     &lt;term3&gt; 1

 map3:
     &lt;term1&gt; 1
     ... </pre><br>  At a reduce-step, each reduce-task gets a key (that is, &lt;term1&gt;, &lt;term2&gt;, and so on) and a list of <em>all</em> values ‚Äã‚Äãassociated with this key, obtained from <em>all</em> map tasks (in this case, just a list of ones).  It will look like: <br><br><pre>  &lt;term1&gt; 1.1
 &lt;term2&gt; 1.1
 &lt;term3&gt; 1,1,1
</pre><br><br><img src="http://romankirillov.info/images/mr_whiteboard.jpg"><br><br>  Summing up these units (and in fact - simply counting the number of elements in the list), we get the number of occurrences of each term in the body: <br><br><pre>  the 19283
 to 3432
 from 343
 ...
 ...
 london 14 </pre><br>  This is already something, although the value of this data is not obvious.  However, a simple count of the number of lines in the resulting file gives us the number of unique terms.  And summing up all the values ‚Äã‚Äãfrom the second column, we get the total number of tokens.  It seems that they didn‚Äôt do anything - and they already received several fundamental characteristics of the hull. <br><br>  Next comes the classic information retrieval.  First, based on the results of <code>WordCount</code> we build a dictionary - that is, a general list of corpus terms.  Our next task is to establish how often and exactly which dictionary terms are found in each of the documents.  To do this, we are already implementing a slightly modified version of <code>WordCount</code> , which considers the number of terms applicable to a specific document.  Probably the easiest way to achieve this is to use a key in the results of map tasks, consisting of the document identifier (the mapper input key) and the term: <br><br><pre>  map1:
     1_the 1
     1_the 1
     1_the 1
     1_to 1
     ...

 map2:
     2_the 1
     2_the 1
     2_from 1
     ...

 map3:
     37_london 1
     ...
</pre><br>  Reduce for this task will be identical to the classic <code>WordCount</code> - it will simply summarize the values ‚Äã‚Äãwith the same key.  As a result, we get: <br><br><pre>  1_the 3
 1_to 1
 ...
 2_the 2
 2_from 1
 ...
 37_london 1
</pre><br>  So what we got?  And we got the so-called frequency of terms - which is much better known as <em>term frequency</em> , abbreviated <em>tf (t, d)</em> (here t and d mean that the value is considered applicable to a specific document and a specific term).  For example, in the article about London, the value of tf for the word <code>london</code> will probably be higher than in the article about pig breeding (and maybe it will be equal to zero - the zero frequency is also a frequency).  Probably, it should be noted that we have obtained an unnormalized version of this characteristic, to normalize the obtained values ‚Äã‚Äãshould be divided by the total number of tokens in the case. <br><br>  As part of our example, we developed an algorithm for calculating one of the most popular statistical characteristics in information retrieval.  The value of this method is that it can be extended to a body of almost any size - and this can be calculated even on one machine (or you can easily parallelize to a cluster of one and a half to two thousand nodes).  Thus, the answer to the question formulated at the very beginning of the article is as follows: the Map / Reduce ideology allows us to break the computationally complex task into small blocks that can be counted separately, and then combine the results.  These blocks can be considered in parallel, they can - in series and this makes no difference: the point is that we have turned one extremely resource-intensive task into a large number of tasks, each of which can be solved on your home computer. <br><br>  Perhaps, here I should still say the sacred phrase - ‚ÄúTo be continued‚Äù.  In the next post, we will look at the calculation of the second part of <em>tf-idf</em> - namely, the <em>inverse document frequency</em> , after which we will proceed smoothly to the solution of this problem for a real large (no one will find it) data set. <br><br>  PS A small note that seemed important to me: when writing the Russian version of the article (and it was originally written almost in parallel in <a href="http://romankirillov.info/hadoop.html">two languages</a> ) I tried to write as much in Russian as possible, but I did not translate many stable combinations (such as Map / Reduce) and did not even try to translate the names of the phases of this process, from there appeared map-drag and reduce-drag.  Unfortunately, Russian terminology is not fully established applicable to this subject, but the great and powerful is so great and powerful that any student can decline the word ‚Äútask‚Äù in cases - not to mention the programmers who represent the target audience of this post. <br><br>  If you thought something incomprehensible - please write.  After you have been working in a certain area for a long time, to some extent your brains get ‚Äúwashed up‚Äù and you take many things for granted.  If somewhere it was the place to be - write, and I will correct. <br><br>  _________________________________________________________________ <br><br>  References for home reading: <ol><li>  <a href="http://developer.yahoo.com/hadoop/tutorial/">Yahoo!</a>  <a href="http://developer.yahoo.com/hadoop/tutorial/">Hadoop Tutorial</a> - I recommend reading it first, because there is simply no better documentation at the moment, including the official website. </li><li>  <a href="http://hadoop.apache.org/common/docs/current/quickstart.html">Hadoop QuickStart Guide</a> </li><li>  <a href="http://hadoop.apache.org/common/docs/current/mapred_tutorial.html">Hadoop Map / Reduce Tutorial</a> </li><li>  <a href="http://developer.yahoo.com/hadoop/">Hadoop and Distributed Computing at Yahoo!</a> </li><li>  <a href="http://en.wikipedia.org/wiki/Tf%25E2%2580%2593idf">Term frequency-inverse document frequency</a> - Wikipedia article. </li></ol><br><br>  The original photo was published under the Creative Commons license: <a href="http://www.flickr.com/photos/antichrist/3427853501/">www.flickr.com/photos/antichrist/3427853501</a> <br><br>  <b>Update:</b> since the UFO has temporarily disabled the ability to create new blogs, it has published in algorithms - after all, Hadoop is not the only implementation of Map / Reduce, and not a single line of code is here.  When the UFO has mercy, I will create a Hadoop blog and transfer it along with new articles that are being written. <br><br>  <b>Update 2:</b> I also said that to be continued?  Well, here it is - <a href="http://habrahabr.ru/blogs/algorithm/74934/">this is the very continuation</a> - read and comment! </div><p>Source: <a href="https://habr.com/ru/post/74792/">https://habr.com/ru/post/74792/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../74775/index.html">What power is required to emulate the human brain?</a></li>
<li><a href="../74777/index.html">Komsomolskaya Pravda Time Machine</a></li>
<li><a href="../74779/index.html">How would you rate the Nokia service in your city / region?</a></li>
<li><a href="../74781/index.html">Return to the basics of 3D</a></li>
<li><a href="../74786/index.html">Ricoh has released a replaceable matrix camera, GXR</a></li>
<li><a href="../74793/index.html">The work of the service of repairing mobile phones</a></li>
<li><a href="../74795/index.html">Google acquires AdMob</a></li>
<li><a href="../74802/index.html">Google bought Gizmo5, threatening to create a rival Skype</a></li>
<li><a href="../74806/index.html">New interface design for the 1C: Enterprise platform</a></li>
<li><a href="../74807/index.html">Move the cursor to the Terminal</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>