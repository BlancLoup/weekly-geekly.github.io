<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Open machine learning course. Theme 5. Compositions: bagging, random forest</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We will devote the fifth article of the course to simple composition methods: bagging and random forest. You will learn how to get the distribution of...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Open machine learning course. Theme 5. Compositions: bagging, random forest</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/6y/c1/fe/6yc1fed7lwikddu1fros2s3cgsa.jpeg" align="right" width="320"><br><p>  We will devote the fifth article of the course to simple composition methods: bagging and random forest.  You will learn how to get the distribution of the average for the general population, if we have information only about a small part of it;  We will see how using composition of algorithms to reduce the variance and thus improve the accuracy of the model;  Let us analyze what a random forest is, what parameters it is necessary to ‚Äútwist‚Äù and how to find the most important feature.  Let's concentrate in practice by adding a ‚Äúpinch‚Äù of mathematics. </p><br><p>  <strong>UPD:</strong> now the course is in English under the brand <a href="http://mlcourse.ai/">mlcourse.ai</a> with <a href="https://medium.com/open-machine-learning-course">articles</a> on Medium, and materials on Kaggle ( <a href="https://www.kaggle.com/kashnitsky/mlcourse">Dataset</a> ) and on <a href="">GitHub</a> . </p><br><p>  <a href="https://youtu.be/G0DmuuFeC30">Video recording of the</a> lecture based on this article in the second run of the open course (September-November 2017). </p><br><div class="spoiler">  <b class="spoiler_title">List of articles series</b> <div class="spoiler_text"><ol><li>  <a href="https://habrahabr.ru/company/ods/blog/322626/">Primary data analysis with Pandas</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/323210/">Visual data analysis with Python</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/322534/">Classification, decision trees and the method of nearest neighbors</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/323890/">Linear classification and regression models</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/324402/">Compositions: bagging, random forest</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/325422/">Construction and selection of signs</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/325654/">Teaching without a teacher: PCA, clustering</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/326418/">Training in gigabytes with Vowpal Wabbit</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/327242/">Time Series Analysis with Python</a> </li><li>  Gradient boosting </li></ol></div></div><a name="habracut"></a><br><h4 id="plan-etoy-stati">  Plan for this article </h4><br><ol><li>  <a href="https://habrahabr.ru/company/ods/blog/324402/">Bagging</a> <br><ul><li>  <a href="https://habrahabr.ru/company/ods/blog/324402/">Ensembles</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/324402/">Bootstrap</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/324402/">Bagging</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/324402/">Out-of-bag error</a> </li></ul></li><li>  <a href="https://habrahabr.ru/company/ods/blog/324402/">Random forest</a> <br><ul><li>  <a href="https://habrahabr.ru/company/ods/blog/324402/">Algorithm</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/324402/">Comparison with decision tree and bagging</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/324402/">Options</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/324402/">Variation and decorrelation effect</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/324402/">Bias</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/324402/">Extra random trees</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/324402/">Similar to the k-nearest neighbor algorithm</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/324402/">Transformation of signs into multidimensional space</a> </li></ul></li><li>  <a href="https://habrahabr.ru/company/ods/blog/324402/">Assessment of the importance of signs</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/324402/">Pros and cons of random forest</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/324402/">Homework number 5</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/324402/">Useful sources</a> </li></ol><br><h2 id="1-begging">  1. Bagging </h2><br><p>  From past lectures you have already learned about the different classification algorithms, and also learned how to correctly validate and evaluate the quality of the model.  But what if you have already found the best model and can no longer increase the accuracy of the model?  In this case, you need to apply more advanced machine learning techniques that can be combined with the word "ensembles".  An ensemble is a certain aggregate, parts of which form a single whole.  From everyday life, you know musical ensembles, where several musical instruments are combined, architectural ensembles with different buildings, etc. </p><br><h3 id="ansambli">  Ensembles </h3><br><p>  A good example of ensembles is the Condorcet theorem on the jury (1784).  If each member of the jury has an independent opinion, and if the probability of the correct decision of the jury member is more than 0.5, then the probability of the correct decision of the jury as a whole increases with the number of jury members and tends to one.  If the probability of being right for each of the jury members is less than 0.5, then the probability of making the right decision by the jury as a whole decreases monotonically and tends to zero with an increase in the number of jurors. <br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mtext" id="MJXp-Span-2">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-3"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-5"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">g </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-7"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.816ex" height="2.419ex" viewBox="0 -780.1 3365 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-6C" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-61" x="548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-72" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-67" x="1529" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-65" x="2010" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-4E" x="2476" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-1"> \ large N </script>  - number of jurors <br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-9"><span class="MJXp-mtext" id="MJXp-Span-10">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-11"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-12"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-13"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-14"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">g </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-15"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-16"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">p</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.921ex" height="2.419ex" viewBox="0 -780.1 2980 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-6C" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-61" x="548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-72" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-67" x="1529" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-65" x="2010" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-70" x="2476" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2"> \ large p </script>  - the probability of the correct decision of the jury <br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-17"><span class="MJXp-mtext" id="MJXp-Span-18">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-19"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-21"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-22"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">g </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-23"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-25"><font style="vertical-align: inherit;">m </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-26"><font style="vertical-align: inherit;">u</font></span></font><span class="MJXp-mtext" id="MJXp-Span-24">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-25"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-26"><font style="vertical-align: inherit;"></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.703ex" height="2.419ex" viewBox="0 -780.1 4177.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-6C" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-61" x="548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-72" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-67" x="1529" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-65" x="2010" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-6D" x="2726" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-75" x="3605" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-3"> \ large \ mu </script>  - the probability of the correct decision of the entire jury <br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-27"><span class="MJXp-mtext" id="MJXp-Span-28">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-29"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-30"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-31"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-32"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">g </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-33"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-34"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.792ex" height="2.419ex" viewBox="0 -780.1 3355 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-6C" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-61" x="548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-72" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-67" x="1529" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-65" x="2010" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-6D" x="2476" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-4"> \ large m </script>  - the minimum majority of the jury members, <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-35"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m </font></font></span><span class="MJXp-mo" id="MJXp-Span-37" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-39"><font style="vertical-align: inherit;">t </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40"><font style="vertical-align: inherit;">e </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-41"><font style="vertical-align: inherit;">x </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-42"><font style="vertical-align: inherit;">t </font></span><span class="MJXp-mrow" id="MJXp-Span-43"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44"><font style="vertical-align: inherit;">f </font></span></span><span class="MJXp-mrow" id="MJXp-Span-43"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-45"><font style="vertical-align: inherit;">l </font></span></span><span class="MJXp-mrow" id="MJXp-Span-43"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-46"><font style="vertical-align: inherit;">o </font></span></span><span class="MJXp-mrow" id="MJXp-Span-43"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-47"><font style="vertical-align: inherit;">o </font></span></span><span class="MJXp-mrow" id="MJXp-Span-43"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48"><font style="vertical-align: inherit;">r</font></span></span><span class="MJXp-mo" id="MJXp-Span-49" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"> ( </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-50"><font style="vertical-align: inherit;">N </font></span><span class="MJXp-mrow" id="MJXp-Span-51"><span class="MJXp-mo" id="MJXp-Span-52" style="margin-left: 0.111em; margin-right: 0.111em;"><font style="vertical-align: inherit;">/</font></span></span><span class="MJXp-mn" id="MJXp-Span-53"><font style="vertical-align: inherit;"> 2 </font></span><span class="MJXp-mo" id="MJXp-Span-54" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">) </font></span><span class="MJXp-mo" id="MJXp-Span-55" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;">+ </font></span><span class="MJXp-mn" id="MJXp-Span-56"><font style="vertical-align: inherit;">1</font></span></font><span class="MJXp-mtext" id="MJXp-Span-38">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-39"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-41"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-42"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mrow" id="MJXp-Span-43"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-45"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-46"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-47"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-48"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mo" id="MJXp-Span-49" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-50"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mrow" id="MJXp-Span-51"><span class="MJXp-mo" id="MJXp-Span-52" style="margin-left: 0.111em; margin-right: 0.111em;"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mn" id="MJXp-Span-53"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-54" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-55" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mn" id="MJXp-Span-56"><font style="vertical-align: inherit;"></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="25.288ex" height="2.66ex" viewBox="0 -832 10888 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-6D" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMAIN-3D" x="1156" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-74" x="2462" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-65" x="2824" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-78" x="3290" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-74" x="3863" y="0"></use><g transform="translate(4224,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-66" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-6C" x="550" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-6F" x="849" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-6F" x="1334" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-72" x="1820" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMAIN-28" x="6496" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-4E" x="6885" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMAIN-2F" x="7774" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMAIN-32" x="8274" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMAIN-29" x="8775" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMAIN-2B" x="9386" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMAIN-31" x="10387" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-5"> m = \ text {floor} (N / 2) + 1 </script><br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-57"><span class="MJXp-mtext" id="MJXp-Span-58">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-59"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">l </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-60"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-61"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-62"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">g </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-63"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-64"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-65" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C </font></font></span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-67"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i </font></font></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-66"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.105ex" height="3.021ex" viewBox="0 -883.9 3920.3 1300.8" role="img" focusable="false" style="vertical-align: -0.969ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-6C" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-61" x="548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-72" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-67" x="1529" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-65" x="2010" y="0"></use><g transform="translate(2476,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-43" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-69" x="1094" y="499"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-4E" x="1011" y="-452"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-6"> \ large C_N ^ i </script>  - number of <a href="https://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25BE%25D1%2587%25D0%25B5%25D1%2582%25D0%25B0%25D0%25BD%25D0%25B8%25D0%25B5">combinations</a> of <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-68"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-69"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">N</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.064ex" height="2.057ex" viewBox="0 -780.1 888.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-4E" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-7"> N </script>  by <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-70"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-71"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.802ex" height="1.937ex" viewBox="0 -728.2 345.5 834" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-69" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-8"> i </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-72"><span class="MJXp-mtext" id="MJXp-Span-73">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-74">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-75">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-76">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-77">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-78">e</span><span class="MJXp-mtext" id="MJXp-Span-79">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-80">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-81">u</span><span class="MJXp-mo" id="MJXp-Span-82" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-83">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-84">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-85">u</span><span class="MJXp-msubsup" id="MJXp-Span-86"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-87" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-92"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-93">N</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-88"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-89">i</span><span class="MJXp-mo" id="MJXp-Span-90">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-91">m</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-94"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-95" style="margin-right: 0.05em;">C</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-97">i</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-96">N</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-98"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-99" style="margin-right: 0.05em;">p</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-100" style="vertical-align: 0.5em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-101" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-102">1</span><span class="MJXp-mo" id="MJXp-Span-103" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-104">p</span><span class="MJXp-msubsup" id="MJXp-Span-105"><span class="MJXp-mo" id="MJXp-Span-106" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-107" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-108">N</span><span class="MJXp-mo" id="MJXp-Span-109">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-110">i</span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="37.205ex" height="3.262ex" viewBox="0 -987.6 16018.6 1404.6" role="img" focusable="false" style="vertical-align: -0.969ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-6C" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-61" x="548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-72" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-67" x="1529" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-65" x="2010" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-6D" x="2726" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-75" x="3605" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMAIN-3D" x="4455" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-73" x="5761" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-75" x="6231" y="0"></use><g transform="translate(6803,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-4E" x="1242" y="488"></use><g transform="translate(878,-304)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-6D" x="1124" y="0"></use></g></g><g transform="translate(9198,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-43" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-69" x="1094" y="499"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-4E" x="1011" y="-452"></use></g><g transform="translate(10641,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-70" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-69" x="712" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMAIN-28" x="11489" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMAIN-31" x="11879" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMAIN-2212" x="12601" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-70" x="13602" y="0"></use><g transform="translate(14106,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMAIN-29" x="0" y="0"></use><g transform="translate(389,412)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-4E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMAIN-2212" x="888" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-69" x="1667" y="0"></use></g></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-9"> \ large \ mu = \ sum_ {i = m} ^ {N} C_N ^ ip ^ i (1-p) ^ {N-i} </script></p><br><p>  If a <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-111"><span class="MJXp-mtext" id="MJXp-Span-112">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-113">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-114">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-115">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-116">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-117">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-118">p</span><span class="MJXp-mo" id="MJXp-Span-119" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mn" id="MJXp-Span-120">0.5</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.992ex" height="2.419ex" viewBox="0 -780.1 5593.6 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-6C" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-61" x="548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-72" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-67" x="1529" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-65" x="2010" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-70" x="2476" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMAIN-3E" x="3257" y="0"></use><g transform="translate(4314,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMAIN-30"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMAIN-2E" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMAIN-35" x="779" y="0"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-10"> \ large p> 0.5 </script>  then <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-121"><span class="MJXp-mtext" id="MJXp-Span-122">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-123">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-124">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-125">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-126">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-127">e</span><span class="MJXp-mtext" id="MJXp-Span-128">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-129">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-130">u</span><span class="MJXp-mo" id="MJXp-Span-131" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-132">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.971ex" height="2.419ex" viewBox="0 -780.1 6015.1 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-6C" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-61" x="548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-72" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-67" x="1529" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-65" x="2010" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-6D" x="2726" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-75" x="3605" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMAIN-3E" x="4455" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-70" x="5511" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-11"> \ large \ mu> p </script><br>  If a <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-133"><span class="MJXp-mtext" id="MJXp-Span-134">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-135">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-136">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-137">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-138">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-139">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-140">N</span><span class="MJXp-mtext" id="MJXp-Span-141">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-142">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-143">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-144">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-145">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-146">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-147">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-148">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-149">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-150">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-151">w</span><span class="MJXp-mtext" id="MJXp-Span-152">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-153">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-154">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-155">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-156">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-157">y</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="25.712ex" height="2.419ex" viewBox="0 -780.1 11070.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-6C" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-61" x="548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-72" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-67" x="1529" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-65" x="2010" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-4E" x="2476" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-72" x="3615" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-69" x="4066" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-67" x="4412" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-68" x="4892" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-74" x="5469" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-61" x="5830" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-72" x="6360" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-72" x="6811" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-6F" x="7263" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-77" x="7748" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-69" x="8715" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-6E" x="9060" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-66" x="9661" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-74" x="10211" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-79" x="10573" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-12"> \ large N \ rightarrow \ infty </script>  then <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-158"><span class="MJXp-mtext" id="MJXp-Span-159">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-160">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-161">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-162">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-163">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-164">e</span><span class="MJXp-mtext" id="MJXp-Span-165">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-166">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-167">u</span><span class="MJXp-mtext" id="MJXp-Span-168">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-169">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-170">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-171">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-172">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-173">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-174">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-175">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-176">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-177">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-178">w</span><span class="MJXp-mn" id="MJXp-Span-179">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="22.71ex" height="2.419ex" viewBox="0 -780.1 9778 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-6C" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-61" x="548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-72" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-67" x="1529" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-65" x="2010" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-6D" x="2726" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-75" x="3605" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-72" x="4427" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-69" x="4879" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-67" x="5224" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-68" x="5705" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-74" x="6281" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-61" x="6643" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-72" x="7172" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-72" x="7624" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-6F" x="8075" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-77" x="8561" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMAIN-31" x="9277" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-13"> \ large \ mu \ rightarrow 1 </script></p><br><p>  Let's look at another example of ensembles - "The Wisdom of the crowd."  In 1906, Francis Galton visited the market, where a certain lottery for peasants was held. <img src="https://habrastorage.org/getpro/habr/post_images/d58/66e/f0b/d5866ef0bfe6416952f8ebc14f07ed2b.png" align="right" width="15%" height="15%"><br>  About 800 people gathered, and they tried to guess the weight of the bull that stood in front of them.  The bull weighed 1198 pounds.  No peasant guessed the exact weight of the bull, but if you count the average of their predictions, you get 1197 pounds. <br>  This idea of ‚Äã‚Äãreducing errors was also applied in machine learning. </p><br><h3 id="butstrep">  Bootstrap </h3><br><p>  Bagging (from Bootstrap aggregation) is one of the first and simplest types of ensembles.  It was coined by <a href="https://ru.wikipedia.org/wiki/%25D0%2591%25D1%2580%25D0%25B5%25D0%25B9%25D0%25BC%25D0%25B0%25D0%25BD,_%25D0%259B%25D0%25B5%25D0%25BE">Leo Brijman</a> in 1994.  Bagging is based on the bootstrap statistical method, which allows estimating many statistics of complex distributions. </p><br><p>  The bootstrap method is as follows.  Let there be a sample <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-180"><span class="MJXp-mtext" id="MJXp-Span-181">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-182">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-183">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-184">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-185">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-186">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-187">X</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.732ex" height="2.419ex" viewBox="0 -780.1 3329 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-6C" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-61" x="548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-72" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-67" x="1529" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-65" x="2010" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-58" x="2476" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-14"> \ large X </script>  size <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-188"><span class="MJXp-mtext" id="MJXp-Span-189">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-190">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-191">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-192">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-193">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-194">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-195">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.816ex" height="2.419ex" viewBox="0 -780.1 3365 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-6C" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-61" x="548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-72" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-67" x="1529" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-65" x="2010" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-4E" x="2476" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-15"> \ large N </script>  .  Uniformly take from the sample <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-196"><span class="MJXp-mtext" id="MJXp-Span-197">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-198">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-199">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-200">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-201">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-202">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-203">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.816ex" height="2.419ex" viewBox="0 -780.1 3365 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-6C" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-61" x="548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-72" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-67" x="1529" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-65" x="2010" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-4E" x="2476" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-16"> \ large N </script>  objects with return.  That means we will <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-204"><span class="MJXp-mtext" id="MJXp-Span-205">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-206">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-207">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-208">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-209">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-210">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-211">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.816ex" height="2.419ex" viewBox="0 -780.1 3365 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-6C" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-61" x="548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-72" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-67" x="1529" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-65" x="2010" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-4E" x="2476" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-17"> \ large N </script>  select an arbitrary sample object (we assume that each object is ‚Äúpicked up‚Äù with the same probability <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-212"><span class="MJXp-mtext" id="MJXp-Span-213">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-214">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-215">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-216">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-217">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-218">e</span><span class="MJXp-mtext" id="MJXp-Span-219">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-220">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-221">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-222">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-223">c</span><span class="MJXp-mrow" id="MJXp-Span-224"><span class="MJXp-mn" id="MJXp-Span-225">1</span></span><span class="MJXp-mrow" id="MJXp-Span-226"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-227">N</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.123ex" height="2.419ex" viewBox="0 -780.1 6080.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-6C" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-61" x="548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-72" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-67" x="1529" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-65" x="2010" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-66" x="2726" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-72" x="3277" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-61" x="3728" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-63" x="4258" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMAIN-31" x="4691" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-4E" x="5192" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-18"> \ large \ frac {1} {N} </script>  ), and each time we choose from all the source <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-228"><span class="MJXp-mtext" id="MJXp-Span-229">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-230">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-231">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-232">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-233">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-234">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-235">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.816ex" height="2.419ex" viewBox="0 -780.1 3365 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-6C" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-61" x="548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-72" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-67" x="1529" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-65" x="2010" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-4E" x="2476" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-19"> \ large N </script>  objects.  One can imagine the bag from which the balls are taken: the ball selected at some step returns back to the bag, and the next choice is again made equally probable from the same number of balls.  Note that due to the return among them will be repetitions.  Denote the new sample by <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-236"><span class="MJXp-mtext" id="MJXp-Span-237">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-238">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-239">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-240">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-241">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-242">e</span><span class="MJXp-msubsup" id="MJXp-Span-243"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-244" style="margin-right: 0.05em;">X</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-245" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.73ex" height="2.419ex" viewBox="0 -780.1 3758.9 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-6C" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-61" x="548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-72" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-67" x="1529" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-65" x="2010" y="0"></use><g transform="translate(2476,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMATHI-58" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/324402/&amp;xid=25657,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjywVyKK9Byphk8-TJ5zLvup_lZoA#MJMAIN-31" x="1171" y="-213"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-20"> \ large X_1 </script>  .  Repeating the procedure <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-246"><span class="MJXp-mtext" id="MJXp-Span-247">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-248">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-249">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-250">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-251">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-252">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-253">M</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-21"> \ large M </script>  times, we will generate <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-254"><span class="MJXp-mtext" id="MJXp-Span-255">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-256">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-257">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-258">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-259">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-260">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-261">M</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-22"> \ large M </script>  subsamples <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-262"><span class="MJXp-mtext" id="MJXp-Span-263">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-264">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-265">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-266">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-267">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-268">e</span><span class="MJXp-msubsup" id="MJXp-Span-269"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-270" style="margin-right: 0.05em;">X</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-271" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-272" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-273">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-274">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-275">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-276">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-277">s</span><span class="MJXp-mo" id="MJXp-Span-278" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-279"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-280" style="margin-right: 0.05em;">X</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-281" style="vertical-align: -0.4em;">M</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-23"> \ large X_1, \ dots, X_M </script>  .  Now we have a fairly large number of samples and can evaluate various statistics of the original distribution. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/198/14a/3f7/19814a3f7efaa3b7d1a3f8ab35889832.jpg" alt="image"></p><br><p> For example, let's take the <code>telecom_churn</code> data set already known to you from the past lessons of our course.  Recall that this is the task of binary classification of customer churn.  One of the most important signs in this dataset is the number of calls made by the customer to the service center.  Let's try to visualize the data and look at the distribution of this trait. </p><br><div class="spoiler">  <b class="spoiler_title">Code for loading data and plotting</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> matplotlib <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pyplot <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> plt plt.style.use(<span class="hljs-string"><span class="hljs-string">'ggplot'</span></span>) plt.rcParams[<span class="hljs-string"><span class="hljs-string">'figure.figsize'</span></span>] = <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> seaborn <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> sns %matplotlib inline telecom_data = pd.read_csv(<span class="hljs-string"><span class="hljs-string">'data/telecom_churn.csv'</span></span>) fig = sns.kdeplot(telecom_data[telecom_data[<span class="hljs-string"><span class="hljs-string">'Churn'</span></span>] == <span class="hljs-keyword"><span class="hljs-keyword">False</span></span>][<span class="hljs-string"><span class="hljs-string">'Customer service calls'</span></span>], label = <span class="hljs-string"><span class="hljs-string">'Loyal'</span></span>) fig = sns.kdeplot(telecom_data[telecom_data[<span class="hljs-string"><span class="hljs-string">'Churn'</span></span>] == <span class="hljs-keyword"><span class="hljs-keyword">True</span></span>][<span class="hljs-string"><span class="hljs-string">'Customer service calls'</span></span>], label = <span class="hljs-string"><span class="hljs-string">'Churn'</span></span>) fig.set(xlabel=<span class="hljs-string"><span class="hljs-string">' '</span></span>, ylabel=<span class="hljs-string"><span class="hljs-string">''</span></span>) plt.show()</code> </pre> </div></div><br><p><img src="https://habrastorage.org/getpro/habr/post_images/9aa/8b7/81f/9aa8b781f23117ab9b719b7e3e2e087e.png" alt="image"></p><br><p>  As you may have noticed, the number of calls to the service center for loyal customers is less than that of our former customers.  Now it would be good to estimate how many calls each group makes on average.  Since there is little data in our dataset, it‚Äôs not quite right to look for the average, it‚Äôs better to apply our new bootstrap knowledge.  Let's generate 1000 new subsamples from our population and make an interval estimate of the average. </p><br><div class="spoiler">  <b class="spoiler_title">Code to build a confidence interval using bootstrap</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_bootstrap_samples</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(data, n_samples)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-comment"><span class="hljs-comment">#        indices = np.random.randint(0, len(data), (n_samples, len(data))) samples = data[indices] return samples def stat_intervals(stat, alpha): #     boundaries = np.percentile(stat, [100 * alpha / 2., 100 * (1 - alpha / 2.)]) return boundaries #    numpy         loyal_calls = telecom_data[telecom_data['Churn'] == False]['Customer service calls'].values churn_calls= telecom_data[telecom_data['Churn'] == True]['Customer service calls'].values #  seed    np.random.seed(0) #              loyal_mean_scores = [np.mean(sample) for sample in get_bootstrap_samples(loyal_calls, 1000)] churn_mean_scores = [np.mean(sample) for sample in get_bootstrap_samples(churn_calls, 1000)] #     print("Service calls from loyal: mean interval", stat_intervals(loyal_mean_scores, 0.05)) print("Service calls from churn: mean interval", stat_intervals(churn_mean_scores, 0.05))</span></span></code> </pre> </div></div><br><p>  As a result, we obtained that, with a 95% probability, the average number of calls from loyal customers would lie between 1.40 and 1.50, while our former customers called on average from 2.06 to 2.40 times.  You can also note that the interval for loyal customers is already, which is quite logical, since they rarely call (mostly 0, 1 or 2 times), and dissatisfied customers will call much more often, but over time their patience will end, and they will change the operator. </p><br><h3 id="begging">  Bagging </h3><br><p>  Now you have an idea about boosterp, and we can go directly to bagging.  Let there is a training set. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-282"><span class="MJXp-mtext" id="MJXp-Span-283">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-284">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-285">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-286">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-287">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-288">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-289">X</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-24"> \ large X </script>  .  With the help of bootstrap we will generate samples from it. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-290"><span class="MJXp-mtext" id="MJXp-Span-291">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-292">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-293">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-294">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-295">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-296">e</span><span class="MJXp-msubsup" id="MJXp-Span-297"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-298" style="margin-right: 0.05em;">X</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-299" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-300" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-301">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-302">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-303">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-304">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-305">s</span><span class="MJXp-mo" id="MJXp-Span-306" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-307"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-308" style="margin-right: 0.05em;">X</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-309" style="vertical-align: -0.4em;">M</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-25"> \ large X_1, \ dots, X_M </script>  .  Now on each sample we will train your classifier <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-310"><span class="MJXp-mtext" id="MJXp-Span-311">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-312">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-313">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-314">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-315">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-316">e</span><span class="MJXp-msubsup" id="MJXp-Span-317"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-318" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-319" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-320" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-321">x</span><span class="MJXp-mo" id="MJXp-Span-322" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-26"> \ large a_i (x) </script>  .  The final classifier will average the responses of all these algorithms (in the case of classification, this corresponds to a vote): <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-323"><span class="MJXp-mtext" id="MJXp-Span-324">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-325">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-326">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-327">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-328">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-329">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-330">a</span><span class="MJXp-mo" id="MJXp-Span-331" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-332">x</span><span class="MJXp-mo" id="MJXp-Span-333" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-334" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-335">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-336">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-337">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-338">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-339">c</span><span class="MJXp-mrow" id="MJXp-Span-340"><span class="MJXp-mn" id="MJXp-Span-341">1</span></span><span class="MJXp-mrow" id="MJXp-Span-342"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-343">M</span></span><span class="MJXp-mtext" id="MJXp-Span-344">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-345">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-346">u</span><span class="MJXp-msubsup" id="MJXp-Span-347"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-348" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-353">M</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-349"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-350">i</span><span class="MJXp-mo" id="MJXp-Span-351">=</span><span class="MJXp-mn" id="MJXp-Span-352">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-354"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-355" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-356" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-357" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-358">x</span><span class="MJXp-mo" id="MJXp-Span-359" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-27"> \ large a (x) = \ frac {1} {M} \ sum_ {i = 1} ^ M a_i (x) </script>  .  This scheme can be represented by the picture below. </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/d2d/b63/6ff/d2db636ff7c5a59f18858bb93f4323db.png" alt="image"></p><br><p>  Consider a regression problem with basic algorithms. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-360"><span class="MJXp-mtext" id="MJXp-Span-361">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-362">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-363">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-364">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-365">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-366">e</span><span class="MJXp-msubsup" id="MJXp-Span-367"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-368" style="margin-right: 0.05em;">b</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-369" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-370" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-371">x</span><span class="MJXp-mo" id="MJXp-Span-372" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-373" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-374">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-375">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-376">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-377">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-378">s</span><span class="MJXp-mo" id="MJXp-Span-379" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-380"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-381" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-382" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-383" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-384">x</span><span class="MJXp-mo" id="MJXp-Span-385" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-28"> \ large b_1 (x), \ dots, b_n (x) </script>  .  Suppose there is a true answer function for all objects <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-386"><span class="MJXp-mtext" id="MJXp-Span-387">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-388">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-389">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-390">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-391">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-392">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-393">y</span><span class="MJXp-mo" id="MJXp-Span-394" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-395">x</span><span class="MJXp-mo" id="MJXp-Span-396" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-29"> \ large y (x) </script>  , and also set the distribution on objects <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-397"><span class="MJXp-mtext" id="MJXp-Span-398">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-399">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-400">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-401">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-402">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-403">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-404">p</span><span class="MJXp-mo" id="MJXp-Span-405" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-406">x</span><span class="MJXp-mo" id="MJXp-Span-407" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-30"> \ large p (x) </script>  .  In this case, we can write the error of each regression function. </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-408"><span class="MJXp-mtext" id="MJXp-Span-409">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-410">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-411">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-412">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-413">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-414">e</span><span class="MJXp-mtext" id="MJXp-Span-415">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-416">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-417">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-418">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-419">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-420">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-421">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-422">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-423">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-424">o</span><span class="MJXp-msubsup" id="MJXp-Span-425"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-426" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-427" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-428" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-429">x</span><span class="MJXp-mo" id="MJXp-Span-430" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-431" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-432"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-433" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-434" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-435" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-436">x</span><span class="MJXp-mo" id="MJXp-Span-437" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-438" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-439">y</span><span class="MJXp-mo" id="MJXp-Span-440" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-441">x</span><span class="MJXp-mo" id="MJXp-Span-442" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-443" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-444">i</span><span class="MJXp-mo" id="MJXp-Span-445" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-446">1</span><span class="MJXp-mo" id="MJXp-Span-447" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-448">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-449">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-450">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-451">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-452">s</span><span class="MJXp-mo" id="MJXp-Span-453" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-454">n</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-31"> \ large \ varepsilon_i (x) = b_i (x) - y (x), i = 1, \ dots, n </script></p><br>  and write the expectation of the standard error <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-455"><span class="MJXp-mtext" id="MJXp-Span-456">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-457">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-458">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-459">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-460">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-461">e</span><span class="MJXp-msubsup" id="MJXp-Span-462"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-463" style="margin-right: 0.05em;">E</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-464" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mo" id="MJXp-Span-465" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-466"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-467" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-468" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-469" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-470">x</span><span class="MJXp-mo" id="MJXp-Span-471" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-472" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-473">y</span><span class="MJXp-mo" id="MJXp-Span-474" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-475">x</span><span class="MJXp-mo" id="MJXp-Span-476" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-477"><span class="MJXp-mo" id="MJXp-Span-478" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-479" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-480">2</span></span></span><span class="MJXp-mo" id="MJXp-Span-481" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-482"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-483" style="margin-right: 0.05em;">E</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-484" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mtext" id="MJXp-Span-485">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-486">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-487">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-488">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-489">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-490">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-491">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-492">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-493">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-494">o</span><span class="MJXp-msubsup" id="MJXp-Span-495"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-496" style="margin-right: 0.05em;">n</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mn" id="MJXp-Span-498">2</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-497">i</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-499" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-500">x</span><span class="MJXp-mo" id="MJXp-Span-501" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-502" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-32"> \ large E_x (b_i (x) - y (x)) ^ {2} = E_x \ varepsilon_i ^ 2 (x). </script></p><br><br><p>  The average error of the constructed regression functions is </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-503"><span class="MJXp-mtext" id="MJXp-Span-504">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-505">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-506">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-507">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-508">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-509">e</span><span class="MJXp-msubsup" id="MJXp-Span-510"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-511" style="margin-right: 0.05em;">E</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-512" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-513" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-514">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-515">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-516">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-517">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-518">c</span><span class="MJXp-mrow" id="MJXp-Span-519"><span class="MJXp-mn" id="MJXp-Span-520">1</span></span><span class="MJXp-mrow" id="MJXp-Span-521"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-522">n</span></span><span class="MJXp-msubsup" id="MJXp-Span-523"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-524" style="margin-right: 0.05em;">E</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-525" style="vertical-align: -0.4em;">x</span></span><span class="MJXp-mtext" id="MJXp-Span-526">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-527">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-528">u</span><span class="MJXp-msubsup" id="MJXp-Span-529"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-530" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-535">n</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-531"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-532">i</span><span class="MJXp-mo" id="MJXp-Span-533">=</span><span class="MJXp-mn" id="MJXp-Span-534">1</span></span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-536">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-537">v</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-538">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-539">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-540">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-541">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-542">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-543">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-544">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-545">o</span><span class="MJXp-msubsup" id="MJXp-Span-546"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-547" style="margin-right: 0.05em;">n</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-549"><span class="MJXp-mn" id="MJXp-Span-550">2</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-548">i</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-551" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-552">x</span><span class="MJXp-mo" id="MJXp-Span-553" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-33-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-33"> \ large E_1 = \ frac {1} {n} E_x \ sum_ {i = 1} ^ n \ varepsilon_i ^ {2} (x) </script></p><br><br><p>  Suppose the errors are unbiased and uncorrelated: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-554"><span class="noError" id="MJXp-Span-555" style="display: inline-block;">\&nbsp;large&nbsp;\&nbsp;begin&nbsp;{array}&nbsp;{rcl}&nbsp;E_x&nbsp;\&nbsp;varepsilon_i&nbsp;(x)&nbsp;&amp;&nbsp;=&nbsp;&amp;&nbsp;0,&nbsp;\\&nbsp;E_x&nbsp;\&nbsp;varepsilon_i&nbsp;(x)&nbsp;\&nbsp;varepsilon_j&nbsp;(x)&nbsp;&amp;&nbsp;=&nbsp;&amp;&nbsp;0,&nbsp;i&nbsp;\&nbsp;neq&nbsp;j.&nbsp;\&nbsp;end&nbsp;{array}</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-34-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-34"> \ large \ begin {array} {rcl} E_x \ varepsilon_i (x) & = & 0, \\ E_x \ varepsilon_i (x) \ varepsilon_j (x) & = & 0, i \ neq j. \ end {array} </script></p><br><p>  We now build a new regression function that will average the responses of the functions we have constructed: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-556"><span class="MJXp-mtext" id="MJXp-Span-557">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-558">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-559">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-560">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-561">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-562">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-563">a</span><span class="MJXp-mo" id="MJXp-Span-564" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-565">x</span><span class="MJXp-mo" id="MJXp-Span-566" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-567" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-568">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-569">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-570">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-571">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-572">c</span><span class="MJXp-mrow" id="MJXp-Span-573"><span class="MJXp-mn" id="MJXp-Span-574">1</span></span><span class="MJXp-mrow" id="MJXp-Span-575"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-576">n</span></span><span class="MJXp-mtext" id="MJXp-Span-577">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-578">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-579">u</span><span class="MJXp-msubsup" id="MJXp-Span-580"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-581" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-586"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-587">n</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-582"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-583">i</span><span class="MJXp-mo" id="MJXp-Span-584">=</span><span class="MJXp-mn" id="MJXp-Span-585">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-588"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-589" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-590" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-591" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-592">x</span><span class="MJXp-mo" id="MJXp-Span-593" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-35-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-35"> \ large a (x) = \ frac {1} {n} \ sum_ {i = 1} ^ {n} b_i (x) </script></p><br><p>  Find its root-mean-square error: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-594"><span class="noError" id="MJXp-Span-595" style="display: inline-block;">\&nbsp;large&nbsp;\&nbsp;begin&nbsp;{array}&nbsp;{rcl}&nbsp;E_n&nbsp;&amp;&nbsp;=&nbsp;&amp;&nbsp;E_x&nbsp;\&nbsp;Big&nbsp;(\&nbsp;frac&nbsp;{1}&nbsp;{n}&nbsp;\&nbsp;sum_&nbsp;{i&nbsp;=&nbsp;1}&nbsp;^&nbsp;{n}&nbsp;b_i&nbsp;(x)&nbsp;-y&nbsp;(x)&nbsp;\&nbsp;Big)&nbsp;^&nbsp;2&nbsp;\\&nbsp;&amp;&nbsp;=&nbsp;&amp;&nbsp;E_x&nbsp;\&nbsp;Big&nbsp;(\&nbsp;frac&nbsp;{1}&nbsp;{n}&nbsp;\&nbsp;sum_&nbsp;{i&nbsp;=&nbsp;1}&nbsp;^&nbsp;{n}&nbsp;\&nbsp;varepsilon_i&nbsp;\&nbsp;Big)&nbsp;^&nbsp;2&nbsp;\\&nbsp;&amp;&nbsp;=&nbsp;&amp;&nbsp;\&nbsp;frac&nbsp;{1}&nbsp;{n&nbsp;^&nbsp;2}&nbsp;E_x&nbsp;\&nbsp;Big&nbsp;(\&nbsp;sum_&nbsp;{i&nbsp;=&nbsp;1}&nbsp;^&nbsp;{n}&nbsp;\&nbsp;varepsilon_i&nbsp;^&nbsp;2&nbsp;(x)&nbsp;+&nbsp;\&nbsp;sum_&nbsp;{i&nbsp;\&nbsp;neq&nbsp;j}&nbsp;\&nbsp;varepsilon_i&nbsp;(x)&nbsp;\&nbsp;varepsilon_j&nbsp;(x)&nbsp;\&nbsp;Big)&nbsp;\\&nbsp;&amp;&nbsp;=&nbsp;&amp;&nbsp;\&nbsp;frac&nbsp;{1}&nbsp;{n}&nbsp;E_1&nbsp;\&nbsp;end&nbsp;{array}</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-36-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-36"> \ large \ begin {array} {rcl} E_n & = & E_x \ Big (\ frac {1} {n} \ sum_ {i = 1} ^ {n} b_i (x) -y (x) \ Big) ^ 2 \\ & = & E_x \ Big (\ frac {1} {n} \ sum_ {i = 1} ^ {n} \ varepsilon_i \ Big) ^ 2 \\ & = & \ frac {1} {n ^ 2} E_x \ Big (\ sum_ {i = 1} ^ {n} \ varepsilon_i ^ 2 (x) + \ sum_ {i \ neq j} \ varepsilon_i (x) \ varepsilon_j (x) \ Big) \\ & = & \ frac {1} {n} E_1 \ end {array} </script></p><br><p>  Thus, averaging the answers allowed to reduce the average square of the error by n times! </p><br><p>  Let us remind you from our previous <a href="https://habrahabr.ru/company/ods/blog/323890/">lesson</a> how the general error is decomposed: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-596"><span class="noError" id="MJXp-Span-597" style="display: inline-block;">\&nbsp;large&nbsp;\&nbsp;begin&nbsp;{array}&nbsp;{rcl}&nbsp;\&nbsp;text&nbsp;{Err}&nbsp;\&nbsp;left&nbsp;(\&nbsp;vec&nbsp;{x}&nbsp;\&nbsp;right)&nbsp;&amp;&nbsp;=&nbsp;&amp;&nbsp;\&nbsp;mathbb&nbsp;{E}&nbsp;\&nbsp;left&nbsp;[\&nbsp;left&nbsp;(y&nbsp;-&nbsp;\&nbsp;hat&nbsp;{f}&nbsp;\&nbsp;left&nbsp;(\&nbsp;vec&nbsp;{x}&nbsp;\&nbsp;right)&nbsp;\&nbsp;right)&nbsp;^&nbsp;2&nbsp;\&nbsp;right]&nbsp;\\&nbsp;&amp;&nbsp;=&nbsp;&amp;&nbsp;\&nbsp;sigma&nbsp;^&nbsp;2&nbsp;+&nbsp;f&nbsp;^&nbsp;2&nbsp;+&nbsp;\&nbsp;text&nbsp;{Var}&nbsp;\&nbsp;left&nbsp;(\&nbsp;hat&nbsp;{f}&nbsp;\&nbsp;right)&nbsp;+&nbsp;\&nbsp;mathbb&nbsp;{E}&nbsp;\&nbsp;left&nbsp;[\&nbsp;hat&nbsp;{f}&nbsp;\&nbsp;right]&nbsp;^&nbsp;2&nbsp;-&nbsp;2f&nbsp;\&nbsp;mathbb&nbsp;{E}&nbsp;\&nbsp;left&nbsp;[\&nbsp;hat&nbsp;{f}&nbsp;\&nbsp;right]&nbsp;\\&nbsp;&amp;&nbsp;=&nbsp;&amp;&nbsp;\&nbsp;left&nbsp;(f&nbsp;-&nbsp;\&nbsp;mathbb&nbsp;{E}&nbsp;\&nbsp;left&nbsp;[\&nbsp;hat&nbsp;{f}&nbsp;\&nbsp;right]&nbsp;\&nbsp;right)&nbsp;^&nbsp;2&nbsp;+&nbsp;\&nbsp;text&nbsp;{Var}&nbsp;\&nbsp;left&nbsp;(\&nbsp;hat&nbsp;{f}&nbsp;\&nbsp;right)&nbsp;+&nbsp;\&nbsp;sigma&nbsp;^&nbsp;2&nbsp;\\&nbsp;&amp;&nbsp;=&nbsp;&amp;&nbsp;\&nbsp;text&nbsp;{Bias}&nbsp;\&nbsp;left&nbsp;(&nbsp;\&nbsp;hat&nbsp;{f}&nbsp;\&nbsp;right)&nbsp;^&nbsp;2&nbsp;+&nbsp;\&nbsp;text&nbsp;{Var}&nbsp;\&nbsp;left&nbsp;(\&nbsp;hat&nbsp;{f}&nbsp;\&nbsp;right)&nbsp;+&nbsp;\&nbsp;sigma&nbsp;^&nbsp;2&nbsp;\&nbsp;end&nbsp;{array}</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-37-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-37"> \ large \ begin {array} {rcl} \ text {Err} \ left (\ vec {x} \ right) & = & \ mathbb {E} \ left [\ left (y - \ hat {f} \ left (\ vec {x} \ right) \ right) ^ 2 \ right] \\ & = & \ sigma ^ 2 + f ^ 2 + \ text {Var} \ left (\ hat {f} \ right) + \ mathbb {E} \ left [\ hat {f} \ right] ^ 2 - 2f \ mathbb {E} \ left [\ hat {f} \ right] \\ & = & \ left (f - \ mathbb {E} \ left [\ hat {f} \ right] \ right) ^ 2 + \ text {Var} \ left (\ hat {f} \ right) + \ sigma ^ 2 \\ & = & \ text {Bias} \ left ( \ hat {f} \ right) ^ 2 + \ text {Var} \ left (\ hat {f} \ right) + \ sigma ^ 2 \ end {array} </script></p><br><p>  Bagging allows you to reduce the variance of a trained classifier, reducing the amount by which the error will differ if you train the model on different data sets, or in other words, it prevents retraining.  The effectiveness of bagging is achieved due to the fact that the basic algorithms trained in various subsamples are quite different, and their errors are mutually compensated for when voting, and also due to the fact that emission objects may not fall into some of the training subsamples. </p><br><p>  In the <code>scikit-learn</code> library, there are <code>BaggingRegressor</code> and <code>BaggingClassifier</code> implementations that allow you to use most other algorithms "inside".  Let us consider in practice how bagging works, and compare it with the decision tree, using the example from the <a href="http://scikit-learn.org/stable/auto_examples/ensemble/plot_bias_variance.html">documentation</a> . </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/477/c24/f27/477c24f272b3312419b1865702a51034.png" alt="image"></p><br><p>  Decision Tree Error </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-598"><span class="MJXp-mtext" id="MJXp-Span-599">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-600">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-601">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-602">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-603">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-604">e</span><span class="MJXp-mn" id="MJXp-Span-605">0.0255</span><span class="MJXp-mo" id="MJXp-Span-606" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-607">E</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-608">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-609">r</span><span class="MJXp-mo" id="MJXp-Span-610" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-611" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-612">0.0003</span><span class="MJXp-mo" id="MJXp-Span-613" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-614">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-615">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-616">a</span><span class="MJXp-msubsup" id="MJXp-Span-617"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-618" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-619" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-620" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-621" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-622">0.0152</span><span class="MJXp-mo" id="MJXp-Span-623" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-624">V</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-625">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-626">r</span><span class="MJXp-mo" id="MJXp-Span-627" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-628" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-629">0.0098</span><span class="MJXp-mo" id="MJXp-Span-630" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-631">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-632">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-633">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-634">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-635">m</span><span class="MJXp-msubsup" id="MJXp-Span-636"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-637" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-638" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-639" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-38-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-38"> \ large 0.0255 (Err) = 0.0003 (Bias ^ 2) + 0.0152 (Var) + 0.0098 (\ sigma ^ 2) </script></p><br><p>  Bugging error </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-640"><span class="MJXp-mtext" id="MJXp-Span-641">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-642">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-643">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-644">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-645">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-646">e</span><span class="MJXp-mn" id="MJXp-Span-647">0.0196</span><span class="MJXp-mo" id="MJXp-Span-648" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-649">E</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-650">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-651">r</span><span class="MJXp-mo" id="MJXp-Span-652" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-653" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-654">0.0004</span><span class="MJXp-mo" id="MJXp-Span-655" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-656">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-657">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-658">a</span><span class="MJXp-msubsup" id="MJXp-Span-659"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-660" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-661" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-662" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-663" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-664">0.0092</span><span class="MJXp-mo" id="MJXp-Span-665" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-666">V</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-667">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-668">r</span><span class="MJXp-mo" id="MJXp-Span-669" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-670" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mn" id="MJXp-Span-671">0.0098</span><span class="MJXp-mo" id="MJXp-Span-672" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-673">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-674">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-675">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-676">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-677">m</span><span class="MJXp-msubsup" id="MJXp-Span-678"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-679" style="margin-right: 0.05em;">a</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-680" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-681" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-39-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-39"> \ large 0.0196 (Err) = 0.0004 (Bias ^ 2) + 0.0092 (Var) + 0.0098 (\ sigma ^ 2) </script></p><br><p>  The graph and the results above show that the variance error is much smaller during bagging, as we proved theoretically higher. </p><br><p>  Bagging is effective on small samples, when the exclusion of even a small part of the training objects leads to the construction of substantially different basic classifiers.  In the case of large samples, subsamples are usually generated that are significantly shorter. </p><br><p>  It should be noted that the example we have considered is not very applicable in practice, since we made the assumption that errors are not correlated, which is rarely done.  If this assumption is wrong, then the error reduction is not so significant.  In the following lectures, we will consider more complex methods of combining algorithms into a composition that allow us to achieve high quality in real-world problems. </p><br><h3 id="out-of-bag-error">  Out-of-bag error </h3><br><p>  Looking ahead, we note that when using random forests there is no need for cross-validation or in a separate test set to get an unbiased error estimate for the test suite.  Let's see how it turns out the "internal" assessment of the model during its training. </p><br><p>  Each tree is built using different bootstrap samples from the source data.  Approximately 37% of the examples remain outside the bootstrap sample and are not used when building the kth tree. </p><br><p>  This can be easily proved: let in the sample <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-682"><span class="MJXp-mtext" id="MJXp-Span-683">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-684">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-685">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-686">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-687">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-688">e</span><span class="MJXp-mtext" id="MJXp-Span-689">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-690">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-691">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-692">l</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-40-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-40"> \ large \ ell </script>  objects.  At each step, all objects fall into a subsample with return equiprobably, that is, a separate object with probability <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-693"><span class="MJXp-mtext" id="MJXp-Span-694">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-695">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-696">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-697">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-698">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-699">e</span><span class="MJXp-mtext" id="MJXp-Span-700">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-701">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-702">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-703">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-704">c</span><span class="MJXp-mrow" id="MJXp-Span-705"><span class="MJXp-mn" id="MJXp-Span-706">1</span></span><span class="MJXp-mrow" id="MJXp-Span-707"><span class="MJXp-mtext" id="MJXp-Span-708">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-709">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-710">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-711">l</span></span><span class="MJXp-mo" id="MJXp-Span-712" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-41-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-41"> \ large \ frac {1} {\ ell}. </script>  The probability that an object will NOT fall into a subsample (i.e. it was not taken <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-713"><span class="MJXp-mtext" id="MJXp-Span-714">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-715">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-716">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-717">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-718">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-719">e</span><span class="MJXp-mtext" id="MJXp-Span-720">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-721">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-722">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-723">l</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-42-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-42"> \ large \ ell </script>  time): <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-724"><span class="MJXp-mtext" id="MJXp-Span-725">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-726">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-727">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-728">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-729">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-730">e</span><span class="MJXp-mo" id="MJXp-Span-731" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-732">1</span><span class="MJXp-mo" id="MJXp-Span-733" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-734">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-735">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-736">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-737">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-738">c</span><span class="MJXp-mrow" id="MJXp-Span-739"><span class="MJXp-mn" id="MJXp-Span-740">1</span></span><span class="MJXp-mrow" id="MJXp-Span-741"><span class="MJXp-mtext" id="MJXp-Span-742">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-743">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-744">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-745">l</span></span><span class="MJXp-msubsup" id="MJXp-Span-746"><span class="MJXp-mo" id="MJXp-Span-747" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-748" style="vertical-align: 0.5em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-749">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-750">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-751">l</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-43-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-43"> \ large (1 - \ frac {1} {\ ell}) ^ \ ell </script>  .  With <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-752"><span class="MJXp-mtext" id="MJXp-Span-753">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-754">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-755">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-756">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-757">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-758">e</span><span class="MJXp-mtext" id="MJXp-Span-759">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-760">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-761">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-762">l</span><span class="MJXp-mtext" id="MJXp-Span-763">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-764">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-765">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-766">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-767">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-768">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-769">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-770">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-771">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-772">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-773">w</span><span class="MJXp-mo" id="MJXp-Span-774" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mtext" id="MJXp-Span-775">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-776">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-777">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-778">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-779">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-780">y</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-44-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-44"> \ large \ ell \ rightarrow + \ infty </script>  we get one of the "wonderful" limits <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-781"><span class="MJXp-mtext" id="MJXp-Span-782">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-783">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-784">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-785">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-786">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-787">e</span><span class="MJXp-mtext" id="MJXp-Span-788">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-789">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-790">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-791">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-792">c</span><span class="MJXp-mrow" id="MJXp-Span-793"><span class="MJXp-mn" id="MJXp-Span-794">1</span></span><span class="MJXp-mrow" id="MJXp-Span-795"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-796">e</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-45-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-45"> \ large \ frac {1} {e} </script>  .  Then the probability of hitting a particular object in the subsample <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-797"><span class="MJXp-mtext" id="MJXp-Span-798">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-799">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-800">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-801">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-802">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-803">e</span><span class="MJXp-mtext" id="MJXp-Span-804">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-805">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-806">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-807">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-808">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-809">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-810">x</span><span class="MJXp-mn" id="MJXp-Span-811">1</span><span class="MJXp-mo" id="MJXp-Span-812" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-813">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-814">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-815">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-816">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-817">c</span><span class="MJXp-mrow" id="MJXp-Span-818"><span class="MJXp-mn" id="MJXp-Span-819">1</span></span><span class="MJXp-mrow" id="MJXp-Span-820"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-821">e</span></span><span class="MJXp-mtext" id="MJXp-Span-822">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-823">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-824">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-825">p</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-826">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-827">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-828">x</span><span class="MJXp-mn" id="MJXp-Span-829">63</span><span class="MJXp-mi" id="MJXp-Span-830">%</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-46-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-46"> \ large \ approx 1 - \ frac {1} {e} \ approx 63 \% </script>  . </p><br><p>  Let's look at how this works in practice: </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/1e8/8e8/617/1e88e8617054fc34e732e09ab429d069.png" alt="image"><br>  The figure shows the oob error estimate.  The top figure is our original sample, we divide it into a training one (left) and a test one (right).  In the picture to the left, we have a grid of squares, which ideally breaks our sample.  Now we need to estimate the proportion of correct answers on our test sample.  The figure shows that our classifier made a mistake in 4 observations that we did not use for training.  Hence, the proportion of correct answers of our classifier: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-831"><span class="MJXp-mtext" id="MJXp-Span-832">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-833">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-834">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-835">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-836">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-837">e</span><span class="MJXp-mtext" id="MJXp-Span-838">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-839">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-840">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-841">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-842">c</span><span class="MJXp-mrow" id="MJXp-Span-843"><span class="MJXp-mn" id="MJXp-Span-844">11</span></span><span class="MJXp-mrow" id="MJXp-Span-845"><span class="MJXp-mn" id="MJXp-Span-846">15</span></span><span class="MJXp-mo" id="MJXp-Span-847" style="margin-left: 0.267em; margin-right: 0.267em;">‚àó</span><span class="MJXp-mn" id="MJXp-Span-848">100</span><span class="MJXp-mi" id="MJXp-Span-849">%</span><span class="MJXp-mo" id="MJXp-Span-850" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-851">73.33</span><span class="MJXp-mi" id="MJXp-Span-852">%</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-47-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-47"> \ large \ frac {11} {15} * 100 \% = 73.33 \% </script></p><br><p>  It turns out that each basic algorithm is trained on ~ 63% of the original objects.  This means that it can be immediately checked for the remaining ~ 37%.  Out-of-Bag estimation is the average estimate of the basic algorithms for those ~ 37% of the data on which they were not trained. </p><br><h2 id="2-sluchaynyy-les">  2. Random forest </h2><br><p>  Leo Breyman found the use of bootstrap not only in statistics, but also in machine learning.  He, along with Adel Cutler, improved the random forest algorithm proposed by <a href="http://ect.bell-labs.com/who/tkh/publications/papers/odt.pdf">Ho</a> , adding to the original version the construction of uncorrelated trees based on CART, in combination with the method of random subspaces and bagging. </p><br><p>  Decisive trees are a good family of basic classifiers for bagging, since they are quite complex and can reach zero error on any sample.  The method of random subspaces allows to reduce the correlation between trees and to avoid retraining.  Basic algorithms are trained on different subsets of the feature description, which are also randomly selected. <br>  An ensemble of models using the random subspace method can be constructed using the following algorithm: </p><br><ol><li>  Let the number of objects for learning be <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-853"><span class="MJXp-mtext" id="MJXp-Span-854">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-855">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-856">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-857">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-858">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-859">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-860">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-48-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-48"> \ large N </script>  , and the number of signs <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-861"><span class="MJXp-mtext" id="MJXp-Span-862">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-863">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-864">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-865">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-866">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-867">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-868">D</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-49-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-49"> \ large D </script>  . </li><li>  Select <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-869"><span class="MJXp-mtext" id="MJXp-Span-870">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-871">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-872">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-873">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-874">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-875">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-876">L</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-50-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-50"> \ large L </script>  as the number of individual models in the ensemble. </li><li>  For each individual model <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-877"><span class="MJXp-mtext" id="MJXp-Span-878">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-879">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-880">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-881">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-882">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-883">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-884">l</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-51-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-51"> \ large l </script>  select <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-885"><span class="MJXp-mtext" id="MJXp-Span-886">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-887">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-888">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-889">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-890">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-891">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-892">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-893">l</span><span class="MJXp-mo" id="MJXp-Span-894" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-895">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-896">l</span><span class="MJXp-mo" id="MJXp-Span-897" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-898">D</span><span class="MJXp-mo" id="MJXp-Span-899" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-52-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-52"> \ large dl (dl <D) </script>  as the number of signs for <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-900"><span class="MJXp-mtext" id="MJXp-Span-901">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-902">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-903">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-904">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-905">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-906">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-907">l</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-53-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-53"> \ large l </script>  .  Usually for all models only one value is used. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-908"><span class="MJXp-mtext" id="MJXp-Span-909">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-910">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-911">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-912">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-913">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-914">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-915">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-916">l</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-54-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-54"> \ large dl </script>  . </li><li>  For each individual model <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-917"><span class="MJXp-mtext" id="MJXp-Span-918">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-919">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-920">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-921">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-922">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-923">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-924">l</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-55-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-55"> \ large l </script>  create a training set by selecting <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-925"><span class="MJXp-mtext" id="MJXp-Span-926">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-927">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-928">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-929">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-930">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-931">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-932">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-933">l</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-56-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-56"> \ large dl </script>  signs of <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-934"><span class="MJXp-mtext" id="MJXp-Span-935">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-936">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-937">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-938">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-939">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-940">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-941">D</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-57-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-57"> \ large D </script>  and train the model. </li><li>  Now, to apply the ensemble model to a new object, combine the results of the individual <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-942"><span class="MJXp-mtext" id="MJXp-Span-943">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-944">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-945">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-946">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-947">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-948">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-949">L</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-58-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-58"> \ large L </script>  majority voting models or by combining a posteriori probabilities. </li></ol><br><h3 id="algoritm">  Algorithm </h3><br><p>  The algorithm for constructing a random forest consisting of <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-950"><span class="MJXp-mtext" id="MJXp-Span-951">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-952">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-953">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-954">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-955">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-956">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-957">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-59-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-59"> \ large N </script>  trees, looks like this: </p><br><ul><li>  For each <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-958"><span class="MJXp-mtext" id="MJXp-Span-959">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-960">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-961">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-962">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-963">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-964">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-965">n</span><span class="MJXp-mo" id="MJXp-Span-966" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-967">1</span><span class="MJXp-mo" id="MJXp-Span-968" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mtext" id="MJXp-Span-969">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-970">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-971">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-972">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-973">s</span><span class="MJXp-mo" id="MJXp-Span-974" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-975">N</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-60-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-60"> \ large n = 1, \ dots, N </script>  : <br><ul><li>  Generate a sample <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-976"><span class="MJXp-mtext" id="MJXp-Span-977">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-978">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-979">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-980">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-981">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-982">e</span><span class="MJXp-msubsup" id="MJXp-Span-983"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-984" style="margin-right: 0.05em;">X</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-985" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-61-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-61"> \ large X_n </script>  using bootstrap; </li><li>  Build a decisive tree <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-986"><span class="MJXp-mtext" id="MJXp-Span-987">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-988">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-989">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-990">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-991">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-992">e</span><span class="MJXp-msubsup" id="MJXp-Span-993"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-994" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-995" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-62-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-62"> \ large b_n </script>  by sample <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-996"><span class="MJXp-mtext" id="MJXp-Span-997">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-998">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-999">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1000">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1001">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1002">e</span><span class="MJXp-msubsup" id="MJXp-Span-1003"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1004" style="margin-right: 0.05em;">X</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1005" style="vertical-align: -0.4em;">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-63-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-63"> \ large X_n </script>  : <br>  - according to a given criterion, we choose the best attribute, make a split in the tree according to it, and so on until the sample is exhausted <br>  - the tree is built, while in each sheet no more <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1006"><span class="MJXp-mtext" id="MJXp-Span-1007">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1008">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1009">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1010">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1011">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1012">e</span><span class="MJXp-msubsup" id="MJXp-Span-1013"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1014" style="margin-right: 0.05em;">n</span><span class="MJXp-mtext MJXp-script" id="MJXp-Span-1015" style="vertical-align: -0.4em;">&nbsp;</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1016">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1017">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1018">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1019">t</span><span class="MJXp-mrow" id="MJXp-Span-1020"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1021">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1022">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1023">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-64-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-64"> \ large n_ \ text {min} </script>  objects or until you reach a certain tree height <br>  - at each splitting, first selected <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1024"><span class="MJXp-mtext" id="MJXp-Span-1025">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1026">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1027">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1028">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1029">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1030">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1031">m</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-65-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-65"> \ large m </script>  random signs from <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1032"><span class="MJXp-mtext" id="MJXp-Span-1033">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1034">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1035">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1036">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1037">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1038">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1039">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-66-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-66"> \ large n </script>  source, <br>  and the optimal sampling separation is sought only among them. </li></ul></li></ul><br><p>  Final Classifier <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1040"><span class="MJXp-mtext" id="MJXp-Span-1041">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1042">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1043">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1044">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1045">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1046">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1047">a</span><span class="MJXp-mo" id="MJXp-Span-1048" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1049">x</span><span class="MJXp-mo" id="MJXp-Span-1050" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1051" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1052">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1053">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1054">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1055">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1056">c</span><span class="MJXp-mrow" id="MJXp-Span-1057"><span class="MJXp-mn" id="MJXp-Span-1058">1</span></span><span class="MJXp-mrow" id="MJXp-Span-1059"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1060">N</span></span><span class="MJXp-mtext" id="MJXp-Span-1061">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1062">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1063">u</span><span class="MJXp-msubsup" id="MJXp-Span-1064"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1065" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1070">N</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1066"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1067">i</span><span class="MJXp-mo" id="MJXp-Span-1068">=</span><span class="MJXp-mn" id="MJXp-Span-1069">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1071"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1072" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1073" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1074" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1075">x</span><span class="MJXp-mo" id="MJXp-Span-1076" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-67-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-67"> \ large a (x) = \ frac {1} {N} \ sum_ {i = 1} ^ N b_i (x) </script>  , in simple words - for the problem of cassification we choose the solution by voting on the majority, and in the regression problem - on the average. </p><br><p>  It is recommended to take in classification tasks <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1077"><span class="MJXp-mtext" id="MJXp-Span-1078">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1079">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1080">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1081">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1082">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1083">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1084">m</span><span class="MJXp-mo" id="MJXp-Span-1085" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1086">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1087">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1088">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1089">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1090">t</span><span class="MJXp-mrow" id="MJXp-Span-1091"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1092">n</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-68-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-68"> \ large m = \ sqrt {n} </script>  , and in regression problems - <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1093"><span class="MJXp-mtext" id="MJXp-Span-1094">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1095">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1096">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1097">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1098">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1099">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1100">m</span><span class="MJXp-mo" id="MJXp-Span-1101" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-1102">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1103">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1104">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1105">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1106">c</span><span class="MJXp-mrow" id="MJXp-Span-1107"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1108">n</span></span><span class="MJXp-mrow" id="MJXp-Span-1109"><span class="MJXp-mn" id="MJXp-Span-1110">3</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-69-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-69"> \ large m = \ frac {n} {3} </script>  where <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1111"><span class="MJXp-mtext" id="MJXp-Span-1112">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1113">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1114">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1115">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1116">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1117">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1118">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-70-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-70"> \ large n </script>  - the number of signs.  It is also recommended to build each tree in the classification tasks until there is one object in each sheet, and in regression problems, until five objects are in each sheet. </p><br><p>  Thus, a random forest is a bugging over the decisive trees, when training them, for each partition, the signs are selected from some random subset of features. </p><br><h3 id="sravnenie-s-derevom-resheniy-i-beggingom">  Comparison with decision tree and bagging </h3><br><div class="spoiler">  <b class="spoiler_title">Decision tree comparison, bagging and random forest comparison code for the regression problem</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> __future__ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> division, print_function <span class="hljs-comment"><span class="hljs-comment">#    Anaconda import warnings warnings.filterwarnings('ignore') %pylab inline np.random.seed(42) figsize(8, 6) import seaborn as sns from sklearn.ensemble import RandomForestRegressor, RandomForestClassifier, BaggingRegressor from sklearn.tree import DecisionTreeRegressor, DecisionTreeClassifier n_train = 150 n_test = 1000 noise = 0.1 # Generate data def f(x): x = x.ravel() return np.exp(-x ** 2) + 1.5 * np.exp(-(x - 2) ** 2) def generate(n_samples, noise): X = np.random.rand(n_samples) * 10 - 5 X = np.sort(X).ravel() y = np.exp(-X ** 2) + 1.5 * np.exp(-(X - 2) ** 2)\ + np.random.normal(0.0, noise, n_samples) X = X.reshape((n_samples, 1)) return X, y X_train, y_train = generate(n_samples=n_train, noise=noise) X_test, y_test = generate(n_samples=n_test, noise=noise) # One decision tree regressor dtree = DecisionTreeRegressor().fit(X_train, y_train) d_predict = dtree.predict(X_test) plt.figure(figsize=(10, 6)) plt.plot(X_test, f(X_test), "b") plt.scatter(X_train, y_train, c="b", s=20) plt.plot(X_test, d_predict, "g", lw=2) plt.xlim([-5, 5]) plt.title(" , MSE = %.2f" % np.sum((y_test - d_predict) ** 2)) # Bagging decision tree regressor bdt = BaggingRegressor(DecisionTreeRegressor()).fit(X_train, y_train) bdt_predict = bdt.predict(X_test) plt.figure(figsize=(10, 6)) plt.plot(X_test, f(X_test), "b") plt.scatter(X_train, y_train, c="b", s=20) plt.plot(X_test, bdt_predict, "y", lw=2) plt.xlim([-5, 5]) plt.title("  , MSE = %.2f" % np.sum((y_test - bdt_predict) ** 2)); # Random Forest rf = RandomForestRegressor(n_estimators=10).fit(X_train, y_train) rf_predict = rf.predict(X_test) plt.figure(figsize=(10, 6)) plt.plot(X_test, f(X_test), "b") plt.scatter(X_train, y_train, c="b", s=20) plt.plot(X_test, rf_predict, "r", lw=2) plt.xlim([-5, 5]) plt.title(" , MSE = %.2f" % np.sum((y_test - rf_predict) ** 2));</span></span></code> </pre> </div></div><br><p><img src="https://habrastorage.org/getpro/habr/post_images/6d1/7a0/37d/6d17a037d147c6b5e0d641e023fbe449.png" alt="image"></p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/ded/f8b/7f6/dedf8b7f6e3716a2f2ba07bd35ac32b4.png" alt="image"></p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/731/dc6/0a8/731dc60a8b1c5d961eb584e61d8f5a0a.png" alt="image"></p><br><p>  As we can see from the graphs and MSE error values, a random forest of 10 trees gives a better result than a single tree or bagging of 10 decision trees.  The main difference between random forest and bagging on decision trees is that a random subset of features is selected in a random forest, and the best attribute for separating a node is determined from a subsample of attributes, unlike bagging, where all functions are considered for separation in a node. </p><br><p>  You can also see the advantage of random forest and bagging in classification tasks. </p><br><div class="spoiler">  <b class="spoiler_title">The code for comparing the decision tree, bagging and random forest for the classification problem</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.ensemble <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> RandomForestClassifier, BaggingClassifier <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.tree <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> DecisionTreeClassifier <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.datasets <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> make_circles <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.cross_validation <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> train_test_split <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> matplotlib <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pyplot <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> plt plt.style.use(<span class="hljs-string"><span class="hljs-string">'ggplot'</span></span>) plt.rcParams[<span class="hljs-string"><span class="hljs-string">'figure.figsize'</span></span>] = <span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">6</span></span> %matplotlib inline np.random.seed(<span class="hljs-number"><span class="hljs-number">42</span></span>) X, y = make_circles(n_samples=<span class="hljs-number"><span class="hljs-number">500</span></span>, factor=<span class="hljs-number"><span class="hljs-number">0.1</span></span>, noise=<span class="hljs-number"><span class="hljs-number">0.35</span></span>, random_state=<span class="hljs-number"><span class="hljs-number">42</span></span>) X_train_circles, X_test_circles, y_train_circles, y_test_circles = train_test_split(X, y, test_size=<span class="hljs-number"><span class="hljs-number">0.2</span></span>) dtree = DecisionTreeClassifier(random_state=<span class="hljs-number"><span class="hljs-number">42</span></span>) dtree.fit(X_train_circles, y_train_circles) x_range = np.linspace(X.min(), X.max(), <span class="hljs-number"><span class="hljs-number">100</span></span>) xx1, xx2 = np.meshgrid(x_range, x_range) y_hat = dtree.predict(np.c_[xx1.ravel(), xx2.ravel()]) y_hat = y_hat.reshape(xx1.shape) plt.contourf(xx1, xx2, y_hat, alpha=<span class="hljs-number"><span class="hljs-number">0.2</span></span>) plt.scatter(X[:,<span class="hljs-number"><span class="hljs-number">0</span></span>], X[:,<span class="hljs-number"><span class="hljs-number">1</span></span>], c=y, cmap=<span class="hljs-string"><span class="hljs-string">'autumn'</span></span>) plt.title(<span class="hljs-string"><span class="hljs-string">" "</span></span>) plt.show() b_dtree = BaggingClassifier(DecisionTreeClassifier(),n_estimators=<span class="hljs-number"><span class="hljs-number">300</span></span>, random_state=<span class="hljs-number"><span class="hljs-number">42</span></span>) b_dtree.fit(X_train_circles, y_train_circles) x_range = np.linspace(X.min(), X.max(), <span class="hljs-number"><span class="hljs-number">100</span></span>) xx1, xx2 = np.meshgrid(x_range, x_range) y_hat = b_dtree.predict(np.c_[xx1.ravel(), xx2.ravel()]) y_hat = y_hat.reshape(xx1.shape) plt.contourf(xx1, xx2, y_hat, alpha=<span class="hljs-number"><span class="hljs-number">0.2</span></span>) plt.scatter(X[:,<span class="hljs-number"><span class="hljs-number">0</span></span>], X[:,<span class="hljs-number"><span class="hljs-number">1</span></span>], c=y, cmap=<span class="hljs-string"><span class="hljs-string">'autumn'</span></span>) plt.title(<span class="hljs-string"><span class="hljs-string">"( )"</span></span>) plt.show() rf = RandomForestClassifier(n_estimators=<span class="hljs-number"><span class="hljs-number">300</span></span>, random_state=<span class="hljs-number"><span class="hljs-number">42</span></span>) rf.fit(X_train_circles, y_train_circles) x_range = np.linspace(X.min(), X.max(), <span class="hljs-number"><span class="hljs-number">100</span></span>) xx1, xx2 = np.meshgrid(x_range, x_range) y_hat = rf.predict(np.c_[xx1.ravel(), xx2.ravel()]) y_hat = y_hat.reshape(xx1.shape) plt.contourf(xx1, xx2, y_hat, alpha=<span class="hljs-number"><span class="hljs-number">0.2</span></span>) plt.scatter(X[:,<span class="hljs-number"><span class="hljs-number">0</span></span>], X[:,<span class="hljs-number"><span class="hljs-number">1</span></span>], c=y, cmap=<span class="hljs-string"><span class="hljs-string">'autumn'</span></span>) plt.title(<span class="hljs-string"><span class="hljs-string">" "</span></span>) plt.show()</code> </pre> </div></div><br><p><img src="https://habrastorage.org/getpro/habr/post_images/e06/dc3/52a/e06dc352ad5cc732ef480cef7098d3a7.png" alt="image"></p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/560/f4d/d6a/560f4dd6afc123f676db22fbbf0b3750.png" alt="image"></p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/ad8/1d2/773/ad81d277354f9216cc4fe48cb28eeb15.png" alt="image"></p><br><p>  The figures above show that the dividing boundary of the decision tree is very ‚Äúragged‚Äù and there are a lot of sharp corners on it, which indicates retraining and weak generalizing ability.  While in bagging and random forest, the border is rather smooth and there are almost no signs of retraining. </p><br><p>  Let's now try to figure out the parameters, by choosing which we can increase the proportion of correct answers. </p><br><h3 id="parametry">  Options </h3><br><p>  The random forest method is implemented in the <a href="http://scikit-learn.org/stable/">scikit-learn</a> machine learning <a href="http://scikit-learn.org/stable/">library</a> with two classes: RandomForestClassifier and RandomForestRegressor. </p><br><p>  A complete list of random forest parameters for the regression problem: </p><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sklearn</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ensemble</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RandomForestRegressor</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">( n_estimators ‚Äî    </span></span><span class="hljs-string"><span class="hljs-class"><span class="hljs-params"><span class="hljs-string">""</span></span></span></span><span class="hljs-class"><span class="hljs-params"> </span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params"><span class="hljs-params">(  ‚Äì </span></span></span><span class="hljs-number"><span class="hljs-class"><span class="hljs-params"><span class="hljs-params"><span class="hljs-number">10</span></span></span></span></span><span class="hljs-class"><span class="hljs-params"><span class="hljs-params">)</span></span></span></span><span class="hljs-class"><span class="hljs-params"> criterion ‚Äî ,       </span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params"><span class="hljs-params">(  ‚Äî </span></span></span><span class="hljs-string"><span class="hljs-class"><span class="hljs-params"><span class="hljs-params"><span class="hljs-string">"mse"</span></span></span></span></span><span class="hljs-class"><span class="hljs-params"><span class="hljs-params"> ,     </span></span></span><span class="hljs-string"><span class="hljs-class"><span class="hljs-params"><span class="hljs-params"><span class="hljs-string">"mae"</span></span></span></span></span><span class="hljs-class"><span class="hljs-params"><span class="hljs-params">)</span></span></span></span><span class="hljs-class"><span class="hljs-params"> max_features ‚Äî  ,    .        ,     : </span></span><span class="hljs-string"><span class="hljs-class"><span class="hljs-params"><span class="hljs-string">"auto"</span></span></span></span><span class="hljs-class"><span class="hljs-params"> </span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params"><span class="hljs-params">( )</span></span></span></span><span class="hljs-class"><span class="hljs-params">, </span></span><span class="hljs-string"><span class="hljs-class"><span class="hljs-params"><span class="hljs-string">"sqrt"</span></span></span></span><span class="hljs-class"><span class="hljs-params">, </span></span><span class="hljs-string"><span class="hljs-class"><span class="hljs-params"><span class="hljs-string">"log2"</span></span></span></span><span class="hljs-class"><span class="hljs-params">.    </span></span><span class="hljs-string"><span class="hljs-class"><span class="hljs-params"><span class="hljs-string">"auto"</span></span></span></span><span class="hljs-class"><span class="hljs-params">. max_depth ‚Äî    </span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params"><span class="hljs-params">(    )</span></span></span></span><span class="hljs-class"><span class="hljs-params"> min_samples_split ‚Äî   ,     .          </span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params"><span class="hljs-params">(  ‚Äî </span></span></span><span class="hljs-number"><span class="hljs-class"><span class="hljs-params"><span class="hljs-params"><span class="hljs-number">2</span></span></span></span></span><span class="hljs-class"><span class="hljs-params"><span class="hljs-params">)</span></span></span></span><span class="hljs-class"><span class="hljs-params"> min_samples_leaf ‚Äî     .          </span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params"><span class="hljs-params">(  ‚Äî </span></span></span><span class="hljs-number"><span class="hljs-class"><span class="hljs-params"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span></span><span class="hljs-class"><span class="hljs-params"><span class="hljs-params">)</span></span></span></span><span class="hljs-class"><span class="hljs-params"> min_weight_fraction_leaf ‚Äî        </span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params"><span class="hljs-params">(  )</span></span></span></span><span class="hljs-class"><span class="hljs-params">     </span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params"><span class="hljs-params">(    )</span></span></span></span><span class="hljs-class"><span class="hljs-params"> max_leaf_nodes ‚Äî    </span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params"><span class="hljs-params">(   )</span></span></span></span><span class="hljs-class"><span class="hljs-params"> min_impurity_split ‚Äî      </span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params"><span class="hljs-params">(  </span></span></span><span class="hljs-number"><span class="hljs-class"><span class="hljs-params"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span></span><span class="hljs-class"><span class="hljs-params"><span class="hljs-params"></span></span></span><span class="hljs-number"><span class="hljs-class"><span class="hljs-params"><span class="hljs-params"><span class="hljs-number">-7</span></span></span></span></span><span class="hljs-class"><span class="hljs-params"><span class="hljs-params">)</span></span></span></span><span class="hljs-class"><span class="hljs-params"> bootstrap ‚Äî       </span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params"><span class="hljs-params">(  True)</span></span></span></span><span class="hljs-class"><span class="hljs-params"> oob_score ‚Äî   out-of-bag    R^</span></span><span class="hljs-number"><span class="hljs-class"><span class="hljs-params"><span class="hljs-number">2</span></span></span></span><span class="hljs-class"><span class="hljs-params"> </span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params"><span class="hljs-params">(  False)</span></span></span></span><span class="hljs-class"><span class="hljs-params"> n_jobs ‚Äî        </span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params"><span class="hljs-params">(  </span></span></span><span class="hljs-number"><span class="hljs-class"><span class="hljs-params"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span></span><span class="hljs-class"><span class="hljs-params"><span class="hljs-params">,   </span></span></span><span class="hljs-number"><span class="hljs-class"><span class="hljs-params"><span class="hljs-params"><span class="hljs-number">-1</span></span></span></span></span><span class="hljs-class"><span class="hljs-params"><span class="hljs-params">,     )</span></span></span></span><span class="hljs-class"><span class="hljs-params"> random_state ‚Äî       </span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params"><span class="hljs-params">(   ,    ,       int verbose ‚Äî      </span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params">(  </span></span></span></span><span class="hljs-number"><span class="hljs-class"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span></span></span><span class="hljs-class"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params">)</span></span></span></span></span><span class="hljs-class"><span class="hljs-params"><span class="hljs-params"> warm_start ‚Äî          </span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params">(  False)</span></span></span></span></span><span class="hljs-class"><span class="hljs-params"><span class="hljs-params"> )</span></span></span></span></span></span></code> </pre> <br><p>  For the classification task, everything is almost the same; we will only list the parameters by which RandomForestClassifier differs from RandomForestRegressor. </p><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sklearn</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ensemble</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RandomForestClassifier</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">( criterion ‚Äî      ,      </span></span><span class="hljs-string"><span class="hljs-class"><span class="hljs-params"><span class="hljs-string">"gini"</span></span></span></span><span class="hljs-class"><span class="hljs-params"> </span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params"><span class="hljs-params">(  </span></span></span><span class="hljs-string"><span class="hljs-class"><span class="hljs-params"><span class="hljs-params"><span class="hljs-string">"entropy"</span></span></span></span></span><span class="hljs-class"><span class="hljs-params"><span class="hljs-params">)</span></span></span></span><span class="hljs-class"><span class="hljs-params"> class_weight ‚Äî    </span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params"><span class="hljs-params">(     </span></span></span><span class="hljs-number"><span class="hljs-class"><span class="hljs-params"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span></span><span class="hljs-class"><span class="hljs-params"><span class="hljs-params">,      ,    </span></span></span><span class="hljs-string"><span class="hljs-class"><span class="hljs-params"><span class="hljs-params"><span class="hljs-string">"balanced"</span></span></span></span></span><span class="hljs-class"><span class="hljs-params"><span class="hljs-params">,           ;    </span></span></span><span class="hljs-string"><span class="hljs-class"><span class="hljs-params"><span class="hljs-params"><span class="hljs-string">"balanced_subsample"</span></span></span></span></span><span class="hljs-class"><span class="hljs-params"><span class="hljs-params">,               . )</span></span></span></span></span></span></code> </pre> <br><p>  Next, we consider several parameters, which, first of all, should be paid attention to when building a model: </p><br><ul><li>  n_estimators - the number of trees in the "forest" </li><li>  criterion - criterion for splitting a sample at the vertex </li><li>  max_features - the number of features by which the partition is searched. </li><li>  min_samples_leaf - the minimum number of objects in the sheet </li><li>  max_depth - maximum tree depth </li></ul><br><p>  <strong>Consider the use of a random forest in a real problem.</strong> </p><br><p>  For this we will use the example with the problem of churn clients.  This is a classification task, so we will use the accuracy metric to assess the quality of the model.  To begin with, let's build the simplest classifier that will be our baseline.  Take only numeric characters for simplicity. </p><br><div class="spoiler">  <b class="spoiler_title">Code to build a baseline for a random forest</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.model_selection <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> cross_val_score, StratifiedKFold, GridSearchCV <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.metrics <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> accuracy_score <span class="hljs-comment"><span class="hljs-comment">#   df = pd.read_csv("../../data/telecom_churn.csv") #         cols = [] for i in df.columns: if (df[i].dtype == "float64") or (df[i].dtype == 'int64'): cols.append(i) #      X, y = df[cols].copy(), np.asarray(df["Churn"],dtype='int8') #        skf = StratifiedKFold(n_splits=5, shuffle=True, random_state=42) #       rfc = RandomForestClassifier(random_state=42, n_jobs=-1, oob_score=True) #     results = cross_val_score(rfc, X, y, cv=skf) #        print("CV accuracy score: {:.2f}%".format(results.mean()*100))</span></span></code> </pre> </div></div><br><p>     91.21%,       ,         . </p><br><p>    : </p><br><div class="spoiler"> <b class="spoiler_title">        </b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#   skf = StratifiedKFold(n_splits=5, shuffle=True, random_state=42) #           train_acc = [] test_acc = [] temp_train_acc = [] temp_test_acc = [] trees_grid = [5, 10, 15, 20, 30, 50, 75, 100] #     for ntrees in trees_grid: rfc = RandomForestClassifier(n_estimators=ntrees, random_state=42, n_jobs=-1, oob_score=True) temp_train_acc = [] temp_test_acc = [] for train_index, test_index in skf.split(X, y): X_train, X_test = X.iloc[train_index], X.iloc[test_index] y_train, y_test = y[train_index], y[test_index] rfc.fit(X_train, y_train) temp_train_acc.append(rfc.score(X_train, y_train)) temp_test_acc.append(rfc.score(X_test, y_test)) train_acc.append(temp_train_acc) test_acc.append(temp_test_acc) train_acc, test_acc = np.asarray(train_acc), np.asarray(test_acc) print("Best accuracy on CV is {:.2f}% with {} trees".format(max(test_acc.mean(axis=1))*100, trees_grid[np.argmax(test_acc.mean(axis=1))]))</span></span></code> </pre> </div></div><br><div class="spoiler"> <b class="spoiler_title">     </b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> matplotlib.pyplot <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> plt plt.style.use(<span class="hljs-string"><span class="hljs-string">'ggplot'</span></span>) %matplotlib inline fig, ax = plt.subplots(figsize=(<span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>)) ax.plot(trees_grid, train_acc.mean(axis=<span class="hljs-number"><span class="hljs-number">1</span></span>), alpha=<span class="hljs-number"><span class="hljs-number">0.5</span></span>, color=<span class="hljs-string"><span class="hljs-string">'blue'</span></span>, label=<span class="hljs-string"><span class="hljs-string">'train'</span></span>) ax.plot(trees_grid, test_acc.mean(axis=<span class="hljs-number"><span class="hljs-number">1</span></span>), alpha=<span class="hljs-number"><span class="hljs-number">0.5</span></span>, color=<span class="hljs-string"><span class="hljs-string">'red'</span></span>, label=<span class="hljs-string"><span class="hljs-string">'cv'</span></span>) ax.fill_between(trees_grid, test_acc.mean(axis=<span class="hljs-number"><span class="hljs-number">1</span></span>) - test_acc.std(axis=<span class="hljs-number"><span class="hljs-number">1</span></span>), test_acc.mean(axis=<span class="hljs-number"><span class="hljs-number">1</span></span>) + test_acc.std(axis=<span class="hljs-number"><span class="hljs-number">1</span></span>), color=<span class="hljs-string"><span class="hljs-string">'#888888'</span></span>, alpha=<span class="hljs-number"><span class="hljs-number">0.4</span></span>) ax.fill_between(trees_grid, test_acc.mean(axis=<span class="hljs-number"><span class="hljs-number">1</span></span>) - <span class="hljs-number"><span class="hljs-number">2</span></span>*test_acc.std(axis=<span class="hljs-number"><span class="hljs-number">1</span></span>), test_acc.mean(axis=<span class="hljs-number"><span class="hljs-number">1</span></span>) + <span class="hljs-number"><span class="hljs-number">2</span></span>*test_acc.std(axis=<span class="hljs-number"><span class="hljs-number">1</span></span>), color=<span class="hljs-string"><span class="hljs-string">'#888888'</span></span>, alpha=<span class="hljs-number"><span class="hljs-number">0.2</span></span>) ax.legend(loc=<span class="hljs-string"><span class="hljs-string">'best'</span></span>) ax.set_ylim([<span class="hljs-number"><span class="hljs-number">0.88</span></span>,<span class="hljs-number"><span class="hljs-number">1.02</span></span>]) ax.set_ylabel(<span class="hljs-string"><span class="hljs-string">"Accuracy"</span></span>) ax.set_xlabel(<span class="hljs-string"><span class="hljs-string">"N_estimators"</span></span>)</code> </pre> </div></div><br><p><img src="https://habrastorage.org/getpro/habr/post_images/c0f/16f/c66/c0f16fc66ea8306045fde9930a40f053.png" alt="image"></p><br><p>  ,              ,     ,      . <br>    ,        100% ,       .   ,       . </p><br><p>      ‚Äì <code>max_depth</code> . ( -  100) </p><br><div class="spoiler"> <b class="spoiler_title">         </b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#           train_acc = [] test_acc = [] temp_train_acc = [] temp_test_acc = [] max_depth_grid = [3, 5, 7, 9, 11, 13, 15, 17, 20, 22, 24] #     for max_depth in max_depth_grid: rfc = RandomForestClassifier(n_estimators=100, random_state=42, n_jobs=-1, oob_score=True, max_depth=max_depth) temp_train_acc = [] temp_test_acc = [] for train_index, test_index in skf.split(X, y): X_train, X_test = X.iloc[train_index], X.iloc[test_index] y_train, y_test = y[train_index], y[test_index] rfc.fit(X_train, y_train) temp_train_acc.append(rfc.score(X_train, y_train)) temp_test_acc.append(rfc.score(X_test, y_test)) train_acc.append(temp_train_acc) test_acc.append(temp_test_acc) train_acc, test_acc = np.asarray(train_acc), np.asarray(test_acc) print("Best accuracy on CV is {:.2f}% with {} max_depth".format(max(test_acc.mean(axis=1))*100, max_depth_grid[np.argmax(test_acc.mean(axis=1))]))</span></span></code> </pre> </div></div><br><div class="spoiler"> <b class="spoiler_title">     </b> <div class="spoiler_text"><pre> <code class="python hljs">fig, ax = plt.subplots(figsize=(<span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>)) ax.plot(max_depth_grid, train_acc.mean(axis=<span class="hljs-number"><span class="hljs-number">1</span></span>), alpha=<span class="hljs-number"><span class="hljs-number">0.5</span></span>, color=<span class="hljs-string"><span class="hljs-string">'blue'</span></span>, label=<span class="hljs-string"><span class="hljs-string">'train'</span></span>) ax.plot(max_depth_grid, test_acc.mean(axis=<span class="hljs-number"><span class="hljs-number">1</span></span>), alpha=<span class="hljs-number"><span class="hljs-number">0.5</span></span>, color=<span class="hljs-string"><span class="hljs-string">'red'</span></span>, label=<span class="hljs-string"><span class="hljs-string">'cv'</span></span>) ax.fill_between(max_depth_grid, test_acc.mean(axis=<span class="hljs-number"><span class="hljs-number">1</span></span>) - test_acc.std(axis=<span class="hljs-number"><span class="hljs-number">1</span></span>), test_acc.mean(axis=<span class="hljs-number"><span class="hljs-number">1</span></span>) + test_acc.std(axis=<span class="hljs-number"><span class="hljs-number">1</span></span>), color=<span class="hljs-string"><span class="hljs-string">'#888888'</span></span>, alpha=<span class="hljs-number"><span class="hljs-number">0.4</span></span>) ax.fill_between(max_depth_grid, test_acc.mean(axis=<span class="hljs-number"><span class="hljs-number">1</span></span>) - <span class="hljs-number"><span class="hljs-number">2</span></span>*test_acc.std(axis=<span class="hljs-number"><span class="hljs-number">1</span></span>), test_acc.mean(axis=<span class="hljs-number"><span class="hljs-number">1</span></span>) + <span class="hljs-number"><span class="hljs-number">2</span></span>*test_acc.std(axis=<span class="hljs-number"><span class="hljs-number">1</span></span>), color=<span class="hljs-string"><span class="hljs-string">'#888888'</span></span>, alpha=<span class="hljs-number"><span class="hljs-number">0.2</span></span>) ax.legend(loc=<span class="hljs-string"><span class="hljs-string">'best'</span></span>) ax.set_ylim([<span class="hljs-number"><span class="hljs-number">0.88</span></span>,<span class="hljs-number"><span class="hljs-number">1.02</span></span>]) ax.set_ylabel(<span class="hljs-string"><span class="hljs-string">"Accuracy"</span></span>) ax.set_xlabel(<span class="hljs-string"><span class="hljs-string">"Max_depth"</span></span>)</code> </pre> </div></div><br><p><img src="https://habrastorage.org/getpro/habr/post_images/bfa/515/f24/bfa515f24734503ff14690f45616214f.png" alt="image"></p><br><p>  <code>max_depth</code>     ,       .       . </p><br><p>    <code>min_samples_leaf</code> ,     . </p><br><div class="spoiler"> <b class="spoiler_title">             </b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#           train_acc = [] test_acc = [] temp_train_acc = [] temp_test_acc = [] min_samples_leaf_grid = [1, 3, 5, 7, 9, 11, 13, 15, 17, 20, 22, 24] #     for min_samples_leaf in min_samples_leaf_grid: rfc = RandomForestClassifier(n_estimators=100, random_state=42, n_jobs=-1, oob_score=True, min_samples_leaf=min_samples_leaf) temp_train_acc = [] temp_test_acc = [] for train_index, test_index in skf.split(X, y): X_train, X_test = X.iloc[train_index], X.iloc[test_index] y_train, y_test = y[train_index], y[test_index] rfc.fit(X_train, y_train) temp_train_acc.append(rfc.score(X_train, y_train)) temp_test_acc.append(rfc.score(X_test, y_test)) train_acc.append(temp_train_acc) test_acc.append(temp_test_acc) train_acc, test_acc = np.asarray(train_acc), np.asarray(test_acc) print("Best accuracy on CV is {:.2f}% with {} min_samples_leaf".format(max(test_acc.mean(axis=1))*100, min_samples_leaf_grid[np.argmax(test_acc.mean(axis=1))]))</span></span></code> </pre> </div></div><br><div class="spoiler"> <b class="spoiler_title">     </b> <div class="spoiler_text"><pre> <code class="python hljs">fig, ax = plt.subplots(figsize=(<span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>)) ax.plot(min_samples_leaf_grid, train_acc.mean(axis=<span class="hljs-number"><span class="hljs-number">1</span></span>), alpha=<span class="hljs-number"><span class="hljs-number">0.5</span></span>, color=<span class="hljs-string"><span class="hljs-string">'blue'</span></span>, label=<span class="hljs-string"><span class="hljs-string">'train'</span></span>) ax.plot(min_samples_leaf_grid, test_acc.mean(axis=<span class="hljs-number"><span class="hljs-number">1</span></span>), alpha=<span class="hljs-number"><span class="hljs-number">0.5</span></span>, color=<span class="hljs-string"><span class="hljs-string">'red'</span></span>, label=<span class="hljs-string"><span class="hljs-string">'cv'</span></span>) ax.fill_between(min_samples_leaf_grid, test_acc.mean(axis=<span class="hljs-number"><span class="hljs-number">1</span></span>) - test_acc.std(axis=<span class="hljs-number"><span class="hljs-number">1</span></span>), test_acc.mean(axis=<span class="hljs-number"><span class="hljs-number">1</span></span>) + test_acc.std(axis=<span class="hljs-number"><span class="hljs-number">1</span></span>), color=<span class="hljs-string"><span class="hljs-string">'#888888'</span></span>, alpha=<span class="hljs-number"><span class="hljs-number">0.4</span></span>) ax.fill_between(min_samples_leaf_grid, test_acc.mean(axis=<span class="hljs-number"><span class="hljs-number">1</span></span>) - <span class="hljs-number"><span class="hljs-number">2</span></span>*test_acc.std(axis=<span class="hljs-number"><span class="hljs-number">1</span></span>), test_acc.mean(axis=<span class="hljs-number"><span class="hljs-number">1</span></span>) + <span class="hljs-number"><span class="hljs-number">2</span></span>*test_acc.std(axis=<span class="hljs-number"><span class="hljs-number">1</span></span>), color=<span class="hljs-string"><span class="hljs-string">'#888888'</span></span>, alpha=<span class="hljs-number"><span class="hljs-number">0.2</span></span>) ax.legend(loc=<span class="hljs-string"><span class="hljs-string">'best'</span></span>) ax.set_ylim([<span class="hljs-number"><span class="hljs-number">0.88</span></span>,<span class="hljs-number"><span class="hljs-number">1.02</span></span>]) ax.set_ylabel(<span class="hljs-string"><span class="hljs-string">"Accuracy"</span></span>) ax.set_xlabel(<span class="hljs-string"><span class="hljs-string">"Min_samples_leaf"</span></span>)</code> </pre> </div></div><br><p><img src="https://habrastorage.org/getpro/habr/post_images/a81/665/705/a8166570558c9e2095de256e1caf46d7.png" alt="image"></p><br><p>          ,        2%     92%. </p><br><p>     <code>max_features</code> .       <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1119"><span class="MJXp-mstyle" id="MJXp-Span-1120"><span class="MJXp-msqrt" id="MJXp-Span-1121"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">‚àö</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1122">n</span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-71-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-71">\large \sqrt{n}</script> ,  n ‚Äî  .  ,       4   . </p><br><div class="spoiler"> <b class="spoiler_title">            </b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#           train_acc = [] test_acc = [] temp_train_acc = [] temp_test_acc = [] max_features_grid = [2, 4, 6, 8, 10, 12, 14, 16] #     for max_features in max_features_grid: rfc = RandomForestClassifier(n_estimators=100, random_state=42, n_jobs=-1, oob_score=True, max_features=max_features) temp_train_acc = [] temp_test_acc = [] for train_index, test_index in skf.split(X, y): X_train, X_test = X.iloc[train_index], X.iloc[test_index] y_train, y_test = y[train_index], y[test_index] rfc.fit(X_train, y_train) temp_train_acc.append(rfc.score(X_train, y_train)) temp_test_acc.append(rfc.score(X_test, y_test)) train_acc.append(temp_train_acc) test_acc.append(temp_test_acc) train_acc, test_acc = np.asarray(train_acc), np.asarray(test_acc) print("Best accuracy on CV is {:.2f}% with {} max_features".format(max(test_acc.mean(axis=1))*100, max_features_grid[np.argmax(test_acc.mean(axis=1))]))</span></span></code> </pre> </div></div><br><div class="spoiler"> <b class="spoiler_title">     </b> <div class="spoiler_text"><pre> <code class="python hljs">fig, ax = plt.subplots(figsize=(<span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>)) ax.plot(max_features_grid, train_acc.mean(axis=<span class="hljs-number"><span class="hljs-number">1</span></span>), alpha=<span class="hljs-number"><span class="hljs-number">0.5</span></span>, color=<span class="hljs-string"><span class="hljs-string">'blue'</span></span>, label=<span class="hljs-string"><span class="hljs-string">'train'</span></span>) ax.plot(max_features_grid, test_acc.mean(axis=<span class="hljs-number"><span class="hljs-number">1</span></span>), alpha=<span class="hljs-number"><span class="hljs-number">0.5</span></span>, color=<span class="hljs-string"><span class="hljs-string">'red'</span></span>, label=<span class="hljs-string"><span class="hljs-string">'cv'</span></span>) ax.fill_between(max_features_grid, test_acc.mean(axis=<span class="hljs-number"><span class="hljs-number">1</span></span>) - test_acc.std(axis=<span class="hljs-number"><span class="hljs-number">1</span></span>), test_acc.mean(axis=<span class="hljs-number"><span class="hljs-number">1</span></span>) + test_acc.std(axis=<span class="hljs-number"><span class="hljs-number">1</span></span>), color=<span class="hljs-string"><span class="hljs-string">'#888888'</span></span>, alpha=<span class="hljs-number"><span class="hljs-number">0.4</span></span>) ax.fill_between(max_features_grid, test_acc.mean(axis=<span class="hljs-number"><span class="hljs-number">1</span></span>) - <span class="hljs-number"><span class="hljs-number">2</span></span>*test_acc.std(axis=<span class="hljs-number"><span class="hljs-number">1</span></span>), test_acc.mean(axis=<span class="hljs-number"><span class="hljs-number">1</span></span>) + <span class="hljs-number"><span class="hljs-number">2</span></span>*test_acc.std(axis=<span class="hljs-number"><span class="hljs-number">1</span></span>), color=<span class="hljs-string"><span class="hljs-string">'#888888'</span></span>, alpha=<span class="hljs-number"><span class="hljs-number">0.2</span></span>) ax.legend(loc=<span class="hljs-string"><span class="hljs-string">'best'</span></span>) ax.set_ylim([<span class="hljs-number"><span class="hljs-number">0.88</span></span>,<span class="hljs-number"><span class="hljs-number">1.02</span></span>]) ax.set_ylabel(<span class="hljs-string"><span class="hljs-string">"Accuracy"</span></span>) ax.set_xlabel(<span class="hljs-string"><span class="hljs-string">"Max_features"</span></span>)</code> </pre> </div></div><br><p><img src="https://habrastorage.org/getpro/habr/post_images/77b/e20/0eb/77be200ebb6f6d05e4d2c40024d58d65.png" alt="image"></p><br><p>       ‚Äî 10,       . </p><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We looked at how the validation curves behave depending on changes in the basic parameters. </font><font style="vertical-align: inherit;">Let us now with the help </font></font><code>GridSearchCV</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">find the optimal parameters for our example.</font></font></p><br><div class="spoiler"> <b class="spoiler_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Code for the selection of optimal model parameters</font></font></b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#   ,       parameters = {'max_features': [4, 7, 10, 13], 'min_samples_leaf': [1, 3, 5, 7], 'max_depth': [5,10,15,20]} rfc = RandomForestClassifier(n_estimators=100, random_state=42, n_jobs=-1, oob_score=True) gcv = GridSearchCV(rfc, parameters, n_jobs=-1, cv=skf, verbose=1) gcv.fit(X, y)</span></span></code> </pre> </div></div><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The best proportion of correct answers, which we were able to achieve with the help of the parameter search - 92.83% with </font></font><code>'max_depth': 15, 'max_features': 7, 'min_samples_leaf': 3</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></p><br><h3 id="variaciya-i-dekorrelyacionnyy-effekt"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Variation and decorrelation effect </font></font></h3><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Let's write the variance for a random forest as </font></font></p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1123"><span class="MJXp-mstyle" id="MJXp-Span-1124"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1125"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1126"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">a </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1127"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">r </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1128"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">f </font></font></span><span class="MJXp-mo" id="MJXp-Span-1129" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1130"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-mo" id="MJXp-Span-1131" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-mo" id="MJXp-Span-1132" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1133"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">œÅ </font></font></span><span class="MJXp-mo" id="MJXp-Span-1134" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1135"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-mo" id="MJXp-Span-1136" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-1137"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1138" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">œÉ </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1139" style="vertical-align: 0.5em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-1140" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1141"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-mo" id="MJXp-Span-1142" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-72-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-72"> \large Varf(x) = \rho(x)\sigma^2(x) </script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Here </font></font><br><ul><li><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1143"><span class="MJXp-mstyle" id="MJXp-Span-1144"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1145"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">œÅ </font></font></span><span class="MJXp-mo" id="MJXp-Span-1146" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1147"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-mo" id="MJXp-Span-1148" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">)</font></font></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is the sampling correlation between any two trees used in averaging</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-73-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-73"> \large \rho(x)</script><font style="vertical-align: inherit;"></font><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1149"><span class="MJXp-mstyle" id="MJXp-Span-1150"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1151">œÅ</span><span class="MJXp-mo" id="MJXp-Span-1152" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1153">x</span><span class="MJXp-mo" id="MJXp-Span-1154" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1155" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1156">c</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1157">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1158">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1159">r</span><span class="MJXp-mo" id="MJXp-Span-1160" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1161">T</span><span class="MJXp-mo" id="MJXp-Span-1162" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1163">x</span><span class="MJXp-mo" id="MJXp-Span-1164" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-msubsup" id="MJXp-Span-1165"><span class="MJXp-mi" id="MJXp-Span-1166" style="margin-right: 0.05em;">Œò</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1167" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1168" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1169">Z</span><span class="MJXp-mo" id="MJXp-Span-1170" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1171" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1172" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1173">T</span><span class="MJXp-mo" id="MJXp-Span-1174" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1175"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1176" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1177" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1178" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1179"><span class="MJXp-mi" id="MJXp-Span-1180" style="margin-right: 0.05em;">Œò</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1181" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1182" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1183">Z</span><span class="MJXp-mo" id="MJXp-Span-1184" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1185" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1186" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-1187" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-74-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-74"> \large \rho(x) = corr[T(x;\Theta_1(Z)),T(x_2,\Theta_2(Z))], </script></p>  Where <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1188"><span class="MJXp-mstyle" id="MJXp-Span-1189"><span class="MJXp-msubsup" id="MJXp-Span-1190"><span class="MJXp-mi" id="MJXp-Span-1191" style="margin-right: 0.05em;">Œò</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1192" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1193" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1194">Z</span><span class="MJXp-mo" id="MJXp-Span-1195" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-75-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-75"> \large \Theta_1(Z) </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1196"><span class="MJXp-mstyle" id="MJXp-Span-1197"><span class="MJXp-msubsup" id="MJXp-Span-1198"><span class="MJXp-mi" id="MJXp-Span-1199" style="margin-right: 0.05em;">Œò</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1200" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1201" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1202">Z</span><span class="MJXp-mo" id="MJXp-Span-1203" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-76-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-76"> \large \Theta_2(Z) </script> ‚Äì          <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1204"><span class="MJXp-mstyle" id="MJXp-Span-1205"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1206">Z</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-77-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-77"> \large Z</script><br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1207"><span class="MJXp-mstyle" id="MJXp-Span-1208"><span class="MJXp-msubsup" id="MJXp-Span-1209"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1210" style="margin-right: 0.05em;">œÉ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1211" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1212" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1213">x</span><span class="MJXp-mo" id="MJXp-Span-1214" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-78-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-78"> \large \sigma^2(x)</script> ‚Äî       : <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1215"><span class="MJXp-mstyle" id="MJXp-Span-1216"><span class="MJXp-msubsup" id="MJXp-Span-1217"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1218" style="margin-right: 0.05em;">œÉ</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1219" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1220" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1221">x</span><span class="MJXp-mo" id="MJXp-Span-1222" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1223" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1224">V</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1225">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1226">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1227">T</span><span class="MJXp-mo" id="MJXp-Span-1228" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1229">x</span><span class="MJXp-mo" id="MJXp-Span-1230" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi" id="MJXp-Span-1231">Œò</span><span class="MJXp-mo" id="MJXp-Span-1232" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1233">X</span><span class="MJXp-mo" id="MJXp-Span-1234" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-79-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-79"> \large \sigma^2(x) = VarT(x;\Theta(X)</script></p>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1235"><span class="MJXp-mstyle" id="MJXp-Span-1236"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1237">œÅ</span><span class="MJXp-mo" id="MJXp-Span-1238" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1239">X</span><span class="MJXp-mo" id="MJXp-Span-1240" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-80-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-80"> \large \rho(X) </script>          ,    N-       .    .          ,    <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1241"><span class="MJXp-mstyle" id="MJXp-Span-1242"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1243">x</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-81-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-81"> \large x</script>  at <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1244"><span class="MJXp-mstyle" id="MJXp-Span-1245"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1246">œÅ</span><span class="MJXp-mo" id="MJXp-Span-1247" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1248">x</span><span class="MJXp-mo" id="MJXp-Span-1249" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-82-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-82"> \large \rho(x)</script>     .  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1250"><span class="MJXp-mstyle" id="MJXp-Span-1251"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1252">œÅ</span><span class="MJXp-mo" id="MJXp-Span-1253" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1254">x</span><span class="MJXp-mo" id="MJXp-Span-1255" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-83-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-83"> \large \rho(x)</script>       ,    <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1256"><span class="MJXp-mstyle" id="MJXp-Span-1257"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1258">x</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-84-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-84"> \large x</script> ,           <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1259"><span class="MJXp-mstyle" id="MJXp-Span-1260"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1261">Z</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-85-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-85"> \large Z </script> ,        .     ,    <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1262"><span class="MJXp-mstyle" id="MJXp-Span-1263"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1264">Z</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-86-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-86"> \large Z </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1265"><span class="MJXp-mstyle" id="MJXp-Span-1266"><span class="MJXp-mi" id="MJXp-Span-1267">Œò</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-87-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-87"> \large \Theta </script>  . </p><br><p>  ,      0,       ‚Äî    . </p><br><p>      ,          ( <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1268"><span class="MJXp-mstyle" id="MJXp-Span-1269"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1270">m</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-88-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-88"> \large m </script> ),        ,      ,   . <br>   <em>The Elements of Statistical Learning (Trevor Hastie, Robert Tibshirani  Jerome Friedman)</em>   ,   . <br><img src="https://habrastorage.org/getpro/habr/post_images/277/306/d13/277306d13fbcaa1898657bbce21953e6.png" alt="image"></p><br><h3 id="smeschenie">  </h3><br><p>    ,      ,        <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1271"><span class="MJXp-mstyle" id="MJXp-Span-1272"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1273">T</span><span class="MJXp-mo" id="MJXp-Span-1274" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1275">x</span><span class="MJXp-mo" id="MJXp-Span-1276" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi" id="MJXp-Span-1277">Œò</span><span class="MJXp-mo" id="MJXp-Span-1278" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1279">Z</span><span class="MJXp-mo" id="MJXp-Span-1280" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1281" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-89-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-89"> \large T(x,\Theta(Z))</script>  : </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1282"><span class="MJXp-mstyle" id="MJXp-Span-1283"><span class="MJXp-mtable" id="MJXp-Span-1284"><span><span class="MJXp-mtr" id="MJXp-Span-1285" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1286" style="text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1287">B</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1288">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1289">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1290">s</span></span><span class="MJXp-mtd" id="MJXp-Span-1291" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-1292" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-1293" style="padding-left: 1em; text-align: left;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1294">Œº</span><span class="MJXp-mo" id="MJXp-Span-1295" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1296">x</span><span class="MJXp-mo" id="MJXp-Span-1297" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1298" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-1299"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1300" style="margin-right: 0.05em;">E</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1301" style="vertical-align: -0.4em;">Z</span></span><span class="MJXp-msubsup" id="MJXp-Span-1302"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1303" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1304" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1305">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1306">f</span></span></span><span class="MJXp-mo" id="MJXp-Span-1307" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1308">x</span><span class="MJXp-mo" id="MJXp-Span-1309" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MJXp-mtr" id="MJXp-Span-1310" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1311" style="padding-top: 0.4em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-1312" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-1313" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-1314" style="padding-left: 1em; padding-top: 0.4em; text-align: left;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1315">Œº</span><span class="MJXp-mo" id="MJXp-Span-1316" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1317">x</span><span class="MJXp-mo" id="MJXp-Span-1318" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1319" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-1320"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1321" style="margin-right: 0.05em;">E</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1322" style="vertical-align: -0.4em;">Z</span></span><span class="MJXp-msubsup" id="MJXp-Span-1323"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1324" style="margin-right: 0.05em;">E</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1325" style="vertical-align: -0.4em;"><span class="MJXp-mi" id="MJXp-Span-1326">Œò</span><span class="MJXp-mrow" id="MJXp-Span-1327"><span class="MJXp-mo" id="MJXp-Span-1328">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1329">Z</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1330">T</span><span class="MJXp-mo" id="MJXp-Span-1331" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1332">x</span><span class="MJXp-mo" id="MJXp-Span-1333" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi" id="MJXp-Span-1334">Œò</span><span class="MJXp-mo" id="MJXp-Span-1335" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1336">Z</span><span class="MJXp-mo" id="MJXp-Span-1337" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1338" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-90-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-90"> \large \begin{array}{rcl} Bias &=& \mu(x) - E_Zf_{rf}(x) \\ &=& \mu(x) - E_ZE_{\Theta | Z}T(x,\Theta(Z))\end{array}</script></p><br><p>     (  ),   ¬´¬ª (unprunned) ,        . ,   ,       ,     . </p><br><h3 id="sverhsluchaynye-derevya">   </h3><br><p>    (Extremely Randomized Trees)    ,     .     ,     ,      ,        ,              .             . </p><br><p>   scikit-learn   <a href="http://scikit-learn.org/stable/modules/generated/sklearn.ensemble.ExtraTreesClassifier.html">ExtraTreesClassifier</a>  <a href="http://scikit-learn.org/stable/modules/generated/sklearn.ensemble.ExtraTreesRegressor.html">ExtraTreesRegressor</a> .    ,          . </p><br><h3 id="shozhest-sluchaynogo-lesa-s-algoritmom-k-blizhayshih-sosedey">      k-  </h3><br><p>        .  ,  ,           .      ,            .   . </p><br><p>       .  Let be <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1339"><span class="MJXp-mstyle" id="MJXp-Span-1340"><span class="MJXp-msubsup" id="MJXp-Span-1341"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1342" style="margin-right: 0.05em;">T</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1343" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-1344" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1345">x</span><span class="MJXp-mo" id="MJXp-Span-1346" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-91-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-91"> \large T_n(x) </script> ‚Äî   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1347"><span class="MJXp-mstyle" id="MJXp-Span-1348"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1349">n</span><span class="MJXp-mo" id="MJXp-Span-1350" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1351">x</span><span class="MJXp-mo" id="MJXp-Span-1352" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-92-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-92"> \large n(x)</script> -    ,     <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1353"><span class="MJXp-mstyle" id="MJXp-Span-1354"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1355">x</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-93-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-93"> \large x </script>  .   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1356"><span class="MJXp-mstyle" id="MJXp-Span-1357"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1358">x</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-94-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-94"> \large x </script>        ,      <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1359"><span class="MJXp-mstyle" id="MJXp-Span-1360"><span class="MJXp-msubsup" id="MJXp-Span-1361"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1362" style="margin-right: 0.05em;">T</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1363" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-1364" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1365">x</span><span class="MJXp-mo" id="MJXp-Span-1366" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-95-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-95"> \large T_n(x) </script>  .     </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1367"><span class="MJXp-mstyle" id="MJXp-Span-1368"><span class="MJXp-msubsup" id="MJXp-Span-1369"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1370" style="margin-right: 0.05em;">b</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1371" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-1372" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1373">x</span><span class="MJXp-mo" id="MJXp-Span-1374" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1375" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-1376"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1382" style="margin-right: 0px; margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1383">l</span></span></span><span class=""><span class="MJXp-mo" id="MJXp-Span-1377" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">‚àë</span></span></span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1378" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1379">i</span><span class="MJXp-mo" id="MJXp-Span-1380">=</span><span class="MJXp-mn" id="MJXp-Span-1381">1</span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1384"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1385" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1386" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-1387" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1388">x</span><span class="MJXp-mo" id="MJXp-Span-1389" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1390"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1391" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1392" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1393" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-1394"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1395" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1396" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1397" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-96-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-96"> \large b_n(x) = \sum_{i=1}^{l}w_n(x,x_i)y_i,</script></p><br><p>  Where </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1398"><span class="MJXp-mstyle" id="MJXp-Span-1399"><span class="MJXp-msubsup" id="MJXp-Span-1400"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1401" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1402" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-1403" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1404">x</span><span class="MJXp-mo" id="MJXp-Span-1405" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1406"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1407" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1408" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1409" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1410" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-1411" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mo" id="MJXp-Span-1412" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-1413"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1414" style="margin-right: 0.05em;">T</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1415" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-1416" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1417">x</span><span class="MJXp-mo" id="MJXp-Span-1418" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1419" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1420"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1421" style="margin-right: 0.05em;">T</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1422" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-1423" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1424"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1425" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1426" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1427" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1428" style="margin-left: 0em; margin-right: 0em;">]</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-1429"><span class="MJXp-mo" id="MJXp-Span-1430" style="margin-left: 0.111em; margin-right: 0.05em;">‚àë</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1435"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1436">l</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1431"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1432">j</span><span class="MJXp-mo" id="MJXp-Span-1433">=</span><span class="MJXp-mn" id="MJXp-Span-1434">1</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1437" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-msubsup" id="MJXp-Span-1438"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1439" style="margin-right: 0.05em;">T</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1440" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-1441" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1442">x</span><span class="MJXp-mo" id="MJXp-Span-1443" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1444" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1445"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1446" style="margin-right: 0.05em;">T</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1447" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-1448" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1449"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1450" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1451" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-1452" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1453" style="margin-left: 0em; margin-right: 0em;">]</span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-97-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-97"> \large w_n(x, x_i) = \frac{[T_n(x) = T_n(x_i)]}{\sum_{j=1}^{l}[T_n(x) = T_n(x_j)]}</script></p><br>     <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1454"><span class="MJXp-mstyle" id="MJXp-Span-1455"><span class="MJXp-mtable" id="MJXp-Span-1456"><span><span class="MJXp-mtr" id="MJXp-Span-1457" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1458" style="text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-1459"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1460" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1461" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-1462" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1463">x</span><span class="MJXp-mo" id="MJXp-Span-1464" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mtd" id="MJXp-Span-1465" style="padding-left: 1em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-1466" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-1467" style="padding-left: 1em; text-align: left;"><span class="MJXp-mfrac" id="MJXp-Span-1468" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1469">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1470">N</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1471"><span class="MJXp-mo" id="MJXp-Span-1472" style="margin-left: 0.111em; margin-right: 0.05em;">‚àë</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1477"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1478">N</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1473"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1474">n</span><span class="MJXp-mo" id="MJXp-Span-1475">=</span><span class="MJXp-mn" id="MJXp-Span-1476">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1479"><span class="MJXp-mo" id="MJXp-Span-1480" style="margin-left: 0.111em; margin-right: 0.05em;">‚àë</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1485"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1486">l</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1481"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1482">i</span><span class="MJXp-mo" id="MJXp-Span-1483">=</span><span class="MJXp-mn" id="MJXp-Span-1484">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1487"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1488" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1489" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-1490" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1491">x</span><span class="MJXp-mo" id="MJXp-Span-1492" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1493"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1494" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1495" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1496" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-msubsup" id="MJXp-Span-1497"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1498" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1499" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MJXp-mtr" id="MJXp-Span-1500" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1501" style="padding-top: 0.4em; text-align: right;"></span><span class="MJXp-mtd" id="MJXp-Span-1502" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mo" id="MJXp-Span-1503" style="margin-left: 0.333em; margin-right: 0.333em;">=</span></span><span class="MJXp-mtd" id="MJXp-Span-1504" style="padding-left: 1em; padding-top: 0.4em; text-align: left;"><span class="MJXp-msubsup" id="MJXp-Span-1505"><span class="MJXp-mo" id="MJXp-Span-1506" style="margin-left: 0.111em; margin-right: 0.05em;">‚àë</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1511"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1512">l</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1507"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1508">i</span><span class="MJXp-mo" id="MJXp-Span-1509">=</span><span class="MJXp-mn" id="MJXp-Span-1510">1</span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1513"><span class="MJXp-mo" id="MJXp-Span-1514" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.201em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.803em; margin-left: -0.05em;">(</span></span></span><span class="MJXp-mfrac" id="MJXp-Span-1515" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1516">1</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1517">N</span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1518"><span class="MJXp-mo" id="MJXp-Span-1519" style="margin-left: 0.111em; margin-right: 0.05em;">‚àë</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1524"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1525">N</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1520"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1521">j</span><span class="MJXp-mo" id="MJXp-Span-1522">=</span><span class="MJXp-mn" id="MJXp-Span-1523">1</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1526"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1527" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1528" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-1529" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1530">x</span><span class="MJXp-mo" id="MJXp-Span-1531" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1532"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1533" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1534" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-1535" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-1536"><span class="MJXp-mo" id="MJXp-Span-1537" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.201em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.803em; margin-left: -0.05em;">)</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1538"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1539" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1540" style="vertical-align: -0.4em;">i</span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-98-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-98"> \large \begin{array}{rcl} a_n(x) &=& \frac{1}{N}\sum_{n=1}^{N}\sum_{i=1}^{l}w_n(x,x_i)y_i \\ &=& \sum_{i=1}^{l}\Big(\frac{1}{N}\sum_{j=1}^{N}w_n(x,x_j)\Big)y_i \end{array}</script></p><br> ,              . ,    <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1541"><span class="MJXp-mstyle" id="MJXp-Span-1542"><span class="MJXp-msubsup" id="MJXp-Span-1543"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1544" style="margin-right: 0.05em;">T</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1545" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-1546" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1547">x</span><span class="MJXp-mo" id="MJXp-Span-1548" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-99-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-99"> \large T_n(x)</script> ,    ,      .    ,                 ,        <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1549"><span class="MJXp-mstyle" id="MJXp-Span-1550"><span class="MJXp-msubsup" id="MJXp-Span-1551"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1552" style="margin-right: 0.05em;">T</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1553" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1554" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1555">x</span><span class="MJXp-mo" id="MJXp-Span-1556" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1557" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1558" style="margin-left: 0em; margin-right: 0em;">‚Ä¶</span><span class="MJXp-mo" id="MJXp-Span-1559" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1560"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1561" style="margin-right: 0.05em;">T</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1562" style="vertical-align: -0.4em;">n</span></span><span class="MJXp-mo" id="MJXp-Span-1563" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1564">x</span><span class="MJXp-mo" id="MJXp-Span-1565" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-100-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-100"> \large T_1(x), \dots, T_n(x) </script>  .               . <br><p>      <em>The Elements of Statistical Learning</em>         k- . </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/c94/6b5/fef/c946b5fef864164b493c7489c4513140.png" alt="image"></p><br><h3 id="preobrazovanie-priznakov-v-mnogomernoe-prostranstvo">      </h3><br><p>          ,         .    <a href="http://scikit-learn.org/stable/modules/generated/sklearn.ensemble.RandomTreesEmbedding.html">RandomTreesEmbedding</a>           .    ,      ,   ,    ,     .      ,    1,    ,  0.    .              /     .              ,   ,   . </p><br><h1 id="3-ocenka-vazhnosti-priznakov"> 3.    </h1><br><p>       ,    ,      .      ,          .         . </p><br><h3 id="sut-metoda">  The essence of the method </h3><br><p>     ,    ¬´¬ª     ,    ¬´¬ª.       . </p><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/32d/465/71f/32d46571feaa7835080ac980bcf685ae.gif"></div><br><p>      ( ),         ,       /.          (    (Gini impurity)) ‚Äî   ,    ,           . </p><br><p>     .   ,  ,      out-of-bag .      -  ( )  ,    ,     ÃÅ        .     (  mse   )   ,             .  ,       ,            .       0 ()  1 ().              . ,        ,      . </p><br><p>        . </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1566"><span class="MJXp-mstyle" id="MJXp-Span-1567"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1568">V</span><span class="MJXp-msubsup" id="MJXp-Span-1569"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1570" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1571" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1572">T</span></span></span><span class="MJXp-mo" id="MJXp-Span-1573" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-1574" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-1575"><span class="MJXp-mo" id="MJXp-Span-1576" style="margin-left: 0.111em; margin-right: 0.05em;">‚àë</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1577" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1578">i</span><span class="MJXp-mo" id="MJXp-Span-1579">‚àà</span><span class="MJXp-msubsup" id="MJXp-Span-1580"><span class="MJXp-mrow" id="MJXp-Span-1581" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-frak" id="MJXp-Span-1582">B</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1583" style="vertical-align: 0.5em;">T</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1584">I</span><span class="MJXp-mrow" id="MJXp-Span-1585"><span class="MJXp-mo" id="MJXp-Span-1586" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.201em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.803em; margin-left: -0.05em;">(</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1587"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1588" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1589" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1590" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1591"><span class="MJXp-mrow" id="MJXp-Span-1592" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-1593"><span><span class="MJXp-over"><span class="" style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1595" style="margin-left: 0px; margin-right: 0px;">ÀÜ</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1594">y</span></span></span></span></span></span><span class="MJXp-script-box" style="height: 1.884em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1597"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1598">T</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1596">i</span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1599"><span class="MJXp-mo" id="MJXp-Span-1600" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.201em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.803em; margin-left: -0.05em;">)</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-1601"><span class="MJXp-mo" id="MJXp-Span-1602" style="margin-left: 0.167em; margin-right: 0.167em; vertical-align: -0.201em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.803em; margin-left: -0.013em;">|</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1603"><span class="MJXp-mrow" id="MJXp-Span-1604" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-frak" id="MJXp-Span-1605">B</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1606" style="vertical-align: 0.5em;">T</span></span><span class="MJXp-mrow" id="MJXp-Span-1607"><span class="MJXp-mo" id="MJXp-Span-1608" style="margin-left: 0.167em; margin-right: 0.167em; vertical-align: -0.201em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.803em; margin-left: -0.013em;">|</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1609" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mfrac" id="MJXp-Span-1610" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-1611"><span class="MJXp-mo" id="MJXp-Span-1612" style="margin-left: 0.111em; margin-right: 0.05em;">‚àë</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1613" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1614">i</span><span class="MJXp-mo" id="MJXp-Span-1615">‚àà</span><span class="MJXp-msubsup" id="MJXp-Span-1616"><span class="MJXp-mrow" id="MJXp-Span-1617" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-frak" id="MJXp-Span-1618">B</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1619" style="vertical-align: 0.5em;">T</span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1620">I</span><span class="MJXp-mrow" id="MJXp-Span-1621"><span class="MJXp-mo" id="MJXp-Span-1622" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.201em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.803em; margin-left: -0.05em;">(</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1623"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1624" style="margin-right: 0.05em;">y</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1625" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1626" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1627"><span class="MJXp-mrow" id="MJXp-Span-1628" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-1629"><span><span class="MJXp-over"><span class="" style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1631" style="margin-left: 0px; margin-right: 0px;">ÀÜ</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1630">y</span></span></span></span></span></span><span class="MJXp-script-box" style="height: 2.156em; vertical-align: -0.912em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1638"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1639">T</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1632"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1633">i</span><span class="MJXp-mo" id="MJXp-Span-1634">,</span><span class="MJXp-msubsup" id="MJXp-Span-1635"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1636" style="margin-right: 0.05em;">œÄ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1637" style="vertical-align: -0.4em;">j</span></span></span></span></span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1640"><span class="MJXp-mo" id="MJXp-Span-1641" style="margin-left: 0em; margin-right: 0em; vertical-align: -0.201em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.803em; margin-left: -0.05em;">)</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mrow" id="MJXp-Span-1642"><span class="MJXp-mo" id="MJXp-Span-1643" style="margin-left: 0.167em; margin-right: 0.167em; vertical-align: -0.201em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.803em; margin-left: -0.013em;">|</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1644"><span class="MJXp-mrow" id="MJXp-Span-1645" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-frak" id="MJXp-Span-1646">B</span></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1647" style="vertical-align: 0.5em;">T</span></span><span class="MJXp-mrow" id="MJXp-Span-1648"><span class="MJXp-mo" id="MJXp-Span-1649" style="margin-left: 0.167em; margin-right: 0.167em; vertical-align: -0.201em;"><span class="MJXp-right MJXp-scale7" style="font-size: 1.803em; margin-left: -0.013em;">|</span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-101-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-101"> \large VI^{T} = \frac{\sum_{i \in \mathfrak{B}^T}I \Big(y_i=\hat{y}_i^{T}\Big)}{\Big |\mathfrak{B}^T\Big |} - \frac{\sum_{i \in \mathfrak{B}^T}I \Big(y_i=\hat{y}_{i,\pi_j}^{T}\Big)}{\Big |\mathfrak{B}^T\Big |} </script></p><br><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1650"><span class="MJXp-mstyle" id="MJXp-Span-1651"><span class="MJXp-msubsup" id="MJXp-Span-1652"><span class="MJXp-mrow" id="MJXp-Span-1653" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-1654"><span><span class="MJXp-over"><span class="" style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1656" style="margin-left: 0px; margin-right: 0px;">ÀÜ</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1655">y</span></span></span></span></span></span><span class="MJXp-script-box" style="height: 1.884em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1658"><span class="MJXp-mo" id="MJXp-Span-1659">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1660">T</span><span class="MJXp-mo" id="MJXp-Span-1661">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1657">i</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1662" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1663"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1664" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1665" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1666">T</span></span></span><span class="MJXp-mo" id="MJXp-Span-1667" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1668"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1669" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1670" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1671" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-102-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-102"> \large \hat{y}_i^{(T)} = f^{T}(x_i) </script> ‚Äî    /  <br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1672"><span class="MJXp-mstyle" id="MJXp-Span-1673"><span class="MJXp-msubsup" id="MJXp-Span-1674"><span class="MJXp-mrow" id="MJXp-Span-1675" style="margin-right: 0.05em;"><span class="MJXp-munderover" id="MJXp-Span-1676"><span><span class="MJXp-over"><span class="" style="margin-bottom: -1.17em;"><span class="MJXp-mo" id="MJXp-Span-1678" style="margin-left: 0px; margin-right: 0px;">ÀÜ</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1677">y</span></span></span></span></span></span><span class="MJXp-script-box" style="height: 2.156em; vertical-align: -0.912em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1685"><span class="MJXp-mo" id="MJXp-Span-1686">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1687">T</span><span class="MJXp-mo" id="MJXp-Span-1688">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1679"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1680">i</span><span class="MJXp-mo" id="MJXp-Span-1681">,</span><span class="MJXp-msubsup" id="MJXp-Span-1682"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1683" style="margin-right: 0.05em;">œÄ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1684" style="vertical-align: -0.4em;">j</span></span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1689" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1690"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1691" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1692" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1693">T</span></span></span><span class="MJXp-mo" id="MJXp-Span-1694" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1695"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1696" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1697" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1698">i</span><span class="MJXp-mo" id="MJXp-Span-1699">,</span><span class="MJXp-msubsup" id="MJXp-Span-1700"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1701" style="margin-right: 0.05em;">œÄ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1702" style="vertical-align: -0.4em;">j</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1703" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-103-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-103"> \large \hat{y}_{i,\pi_j}^{(T)} = f^{T}(x_{i,\pi_j}) </script> ‚Äî    /  <br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1704"><span class="MJXp-mstyle" id="MJXp-Span-1705"><span class="MJXp-msubsup" id="MJXp-Span-1706"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1707" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1708" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1709">i</span><span class="MJXp-mo" id="MJXp-Span-1710">,</span><span class="MJXp-msubsup" id="MJXp-Span-1711"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1712" style="margin-right: 0.05em;">œÄ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1713" style="vertical-align: -0.4em;">j</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1714" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-1715" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1716"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1717" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1718" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1719">i</span><span class="MJXp-mo" id="MJXp-Span-1720">,</span><span class="MJXp-mn" id="MJXp-Span-1721">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1722" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1723" style="margin-left: 0em; margin-right: 0em;">‚Ä¶</span><span class="MJXp-mo" id="MJXp-Span-1724" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1725"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1726" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1727" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1728">i</span><span class="MJXp-mo" id="MJXp-Span-1729">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1730">j</span><span class="MJXp-mo" id="MJXp-Span-1731">‚àí</span><span class="MJXp-mn" id="MJXp-Span-1732">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1733" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-1734" style="width: 1em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-1735"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1736" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1737" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-1738"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1739" style="margin-right: 0.05em;">œÄ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1740" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-1741">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1742">i</span><span class="MJXp-mo" id="MJXp-Span-1743">)</span><span class="MJXp-mo" id="MJXp-Span-1744">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1745">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-1746" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mspace" id="MJXp-Span-1747" style="width: 1em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-1748"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1749" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1750" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1751">i</span><span class="MJXp-mo" id="MJXp-Span-1752">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1753">j</span><span class="MJXp-mo" id="MJXp-Span-1754">+</span><span class="MJXp-mn" id="MJXp-Span-1755">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-1756" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1757" style="margin-left: 0em; margin-right: 0em;">‚Ä¶</span><span class="MJXp-mo" id="MJXp-Span-1758" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1759"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1760" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1761" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1762">i</span><span class="MJXp-mo" id="MJXp-Span-1763">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1764">p</span></span></span><span class="MJXp-mo" id="MJXp-Span-1765" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-104-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-104"> \large x_{i,\pi_j} = (x_{i,1}, \dots , x_{i,j-1}, \quad x_{\pi_j(i),j}, \quad x_{i,j+1}, \dots , x_{i,p})</script><br> ,  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1766"><span class="MJXp-mstyle" id="MJXp-Span-1767"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1768">V</span><span class="MJXp-msubsup" id="MJXp-Span-1769"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1770" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1771" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1772">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1773">T</span><span class="MJXp-mo" id="MJXp-Span-1774">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1775" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1776"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1777" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1778" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-1779" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1780" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1781">0</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-105-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-105"> \large VI^{(T)}(x_j) = 0 </script> ,  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1782"><span class="MJXp-mstyle" id="MJXp-Span-1783"><span class="MJXp-msubsup" id="MJXp-Span-1784"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1785" style="margin-right: 0.05em;">X</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1786" style="vertical-align: -0.4em;">j</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-106-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-106"> \large X_j </script>     <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1787"><span class="MJXp-mstyle" id="MJXp-Span-1788"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1789">T</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-107-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-107"> \large T </script></p><br><p>     : <br> ‚Äî  </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1790"><span class="MJXp-mstyle" id="MJXp-Span-1791"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1792">V</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1793">I</span><span class="MJXp-mo" id="MJXp-Span-1794" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1795"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1796" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1797" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-1798" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1799" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-1800" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-msubsup" id="MJXp-Span-1801"><span class="MJXp-mo" id="MJXp-Span-1802" style="margin-left: 0.111em; margin-right: 0.05em;">‚àë</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1807"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1808">N</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1803"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1804">T</span><span class="MJXp-mo" id="MJXp-Span-1805">=</span><span class="MJXp-mn" id="MJXp-Span-1806">1</span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1809">V</span><span class="MJXp-msubsup" id="MJXp-Span-1810"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1811" style="margin-right: 0.05em;">I</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1812" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1813">T</span></span></span><span class="MJXp-mo" id="MJXp-Span-1814" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1815"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1816" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1817" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-1818" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1819">N</span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-108-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-108"> \large VI(x_j) = \frac{\sum_{T=1}^{N}VI^{T}(x_j)}{N} </script></p><br><p> ‚Äî  </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1820"><span class="MJXp-mstyle" id="MJXp-Span-1821"><span class="MJXp-msubsup" id="MJXp-Span-1822"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1823" style="margin-right: 0.05em;">z</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1824" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-1825" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-1826" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1827">V</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1828">I</span><span class="MJXp-mo" id="MJXp-Span-1829" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1830"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1831" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1832" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-1833" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mfrac" id="MJXp-Span-1834" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1835"><span class="MJXp-munderover" id="MJXp-Span-1836"><span><span class="MJXp-over"><span class=" MJXp-script" style="margin-bottom: -0.92em;"><span class="MJXp-mo" id="MJXp-Span-1838" style="margin-right: 0px; margin-left: 0px;">ÀÜ</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1837">œÉ</span></span></span></span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msqrt" id="MJXp-Span-1839"><span class="MJXp-surd"><span style="font-size: 134%; margin-top: 0.104em;">‚àö</span></span><span class="MJXp-root"><span class="MJXp-rule" style="border-top: 0.08em solid;"></span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1840">N</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-109-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-109"> \large z_j = \frac{VI(x_j)}{\frac{\hat{\sigma}}{\sqrt{N}}} </script></p><br><p>  <strong>Example</strong> </p><br><p>        Booking.com  TripAdvisor.com.  ‚Äî      ( ) ‚Äî ,    ..   ‚Äî    . </p><br><div class="spoiler"> <b class="spoiler_title">    </b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> __future__ <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> division, print_function <span class="hljs-comment"><span class="hljs-comment">#    Anaconda import warnings warnings.filterwarnings('ignore') %pylab inline import seaborn as sns # russian headres from matplotlib import rc font = {'family': 'Verdana', 'weight': 'normal'} rc('font', **font) import pandas as pd import numpy as np from sklearn.ensemble.forest import RandomForestRegressor hostel_data = pd.read_csv("../../data/hostel_factors.csv") features = {"f1":u"", "f2":u"  ", "f3":u"      ", "f4":u" ", "f5":u"  ", "f6":u"  ", "f7":u" ", "f8":u"   ", "f9":u"/", "f10":u""} forest = RandomForestRegressor(n_estimators=1000, max_features=10, random_state=0) forest.fit(hostel_data.drop(['hostel', 'rating'], axis=1), hostel_data['rating']) importances = forest.feature_importances_ indices = np.argsort(importances)[::-1] # Plot the feature importancies of the forest num_to_plot = 10 feature_indices = [ind+1 for ind in indices[:num_to_plot]] # Print the feature ranking print("Feature ranking:") for f in range(num_to_plot): print("%d. %s %f " % (f + 1, features["f"+str(feature_indices[f])], importances[indices[f]])) plt.figure(figsize=(15,5)) plt.title(u" ") bars = plt.bar(range(num_to_plot), importances[indices[:num_to_plot]], color=([str(i/float(num_to_plot+1)) for i in range(num_to_plot)]), align="center") ticks = plt.xticks(range(num_to_plot), feature_indices) plt.xlim([-1, num_to_plot]) plt.legend(bars, [u''.join(features["f"+str(i)]) for i in feature_indices]);</span></span></code> </pre> </div></div><br><p><img src="https://habrastorage.org/getpro/habr/post_images/40d/8af/1e4/40d8af1e4a180f805ac335b8a59e13cd.png" alt="image"><br>    ,           /          .            ,   -       .                  /     . </p><br><h1 id="4-plyusy-i-minusy-sluchaynogo-lesa"> 4.      </h1><br><p>  <strong>Pros</strong> : <br> ‚Äî    ,       ;      <br> ‚Äî        -   <br> ‚Äî     (     )  ,      <br> ‚Äî     ,   ¬´ ¬ª.   ¬´¬ª      0.5  3%        <br> ‚Äî           <br> ‚Äî     ,     <br> ‚Äî  ,         ,   ,     ,      <br> ‚Äî            <br> ‚Äî     ;   ,      <br> ‚Äî         ,      <br> ‚Äî     ,     ,    ( )     <br> ‚Äî ,  ,      ,         ,   <br> ‚Äî    . </p><br><p>  <strong>Cons</strong> : <br> ‚Äî     ,      <br> ‚Äî    (p-values),      <br> ‚Äî      ,        (, Bag of words) <br> ‚Äî     ,        (     ,          ) <br> ‚Äî       ,     <br> ‚Äî  ,       ,          :     ,        ,            (  ) <br> ‚Äî      ,     ,        <br> ‚Äî    .  Is required <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1841"><span class="MJXp-mstyle" id="MJXp-Span-1842"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1843">O</span><span class="MJXp-mo" id="MJXp-Span-1844" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1845">N</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1846">K</span><span class="MJXp-mo" id="MJXp-Span-1847" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-110-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-110">\large O(NK) </script>    ,  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1848"><span class="MJXp-mstyle" id="MJXp-Span-1849"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1850">K</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-111-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-111">\large K </script> ‚Äî  . </p><br><h1 id="5-domashnee-zadanie"> 5.   </h1><br><p>         ,    <a href="https://vk.com/mlcourse"> </a>   <a href=""></a> . </p><br><p>       <a href="http://nbviewer.jupyter.org/github/Yorko/mlcourse.ai/blob/master/jupyter_russian/assignments_demo/assignment05_logit_rf_credit_scoring.ipynb"> </a> ‚Äì                .       <a href="https://docs.google.com/forms/d/1HASy2b_FLBHBCzzpG-TbnbB6gqhB-qwznQxU2vaoSgc/">-</a> (    ). </p><br><h1 id="6-poleznye-istochniki"> 6.   </h1><br><p> ‚Äì <a href="https://medium.com/open-machine-learning-course/open-machine-learning-course-topic-5-ensembles-of-algorithms-and-random-forest-8e05246cbba7">Open Machine Learning Course. Topic 5. Bagging and Random Forest</a> (    ) <br> ‚Äì <a href="https://youtu.be/G0DmuuFeC30"></a>      <br> ‚Äì 15   ‚Äú <a href="https://web.stanford.edu/~hastie/Papers/ESLII.pdf">Elements of Statistical Learning</a> ‚Äù Jerome H. Friedman, Robert Tibshirani, and Trevor Hastie <br> ‚Äì <a href="https://alexanderdyakonov.wordpress.com/2016/11/14/%25D1%2581%25D0%25BB%25D1%2583%25D1%2587%25D0%25B0%25D0%25B9%25D0%25BD%25D1%258B%25D0%25B9-%25D0%25BB%25D0%25B5%25D1%2581-random-forest/"></a>   <br> ‚Äì         -    <a href="http://scikit-learn.org/stable/modules/ensemble.html">scikit-learn</a> <br> ‚Äì <a href="https://github.com/esokolov/ml-course-hse"></a>      (  GitHub).         <br> ‚Äì  <a href="https://www.researchgate.net/publication/278019662_Istoria_razvitia_ansamblevyh_metodov_klassifikacii_v_masinnom_obucenii"></a> "       " (. ) </p><br><p> <em>     <a href="https://habr.com/users/yorko/" class="user_link">yorko</a> ( ).    ‚Äì <a href="https://habr.com/users/vradchenko/" class="user_link">vradchenko</a> ( ).  <a href="https://habr.com/users/bauchgefuehl/" class="user_link">bauchgefuehl</a> ( )  .</em> </p></li></ul></div><p>Source: <a href="https://habr.com/ru/post/324402/">https://habr.com/ru/post/324402/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../324388/index.html">React + mobx path from scratch. Mobx + react, side view</a></li>
<li><a href="../324394/index.html">Are commodity aggregators good?</a></li>
<li><a href="../324396/index.html">Check Point Security CheckUP - Free network security audit. Part 1</a></li>
<li><a href="../324398/index.html">Biometrics: the art of recognition. Perspectives of biometric systems on the example of the Id-Me platform from the company RecFaces</a></li>
<li><a href="../324400/index.html">NSUserDefaults in practice</a></li>
<li><a href="../324410/index.html">Smarting Cities</a></li>
<li><a href="../324412/index.html">How to choose the best server solution and not make a mistake</a></li>
<li><a href="../324414/index.html">Scapegoat or MVC in iOS</a></li>
<li><a href="../324416/index.html">Targeted attacks on Polish banks: technical analysis</a></li>
<li><a href="../324418/index.html">Code Generation, Selenoid, HtmlElements in the auto-tester</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>