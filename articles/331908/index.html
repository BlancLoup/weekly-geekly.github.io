<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>JaCarta Authentication Server and JaCarta WebPass for OTP Authentication in Linux SSH</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article we will talk about the main stages of setting up authentication in Linux SSH to replace password authentication with one-time password...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>JaCarta Authentication Server and JaCarta WebPass for OTP Authentication in Linux SSH</h1><div class="post__text post__text-html js-mediator-article">  In this article we will talk about the main stages of setting up authentication in Linux SSH to replace password authentication with one-time passwords - this article describes the authentication scenario in an SSH connection session to Linux OS using one-time passwords using a <a href="https://www.aladdin-rd.ru/catalog/jacarta_webpass/">JaCarta WebPass device</a> . <br><br><div style="text-align:center;"><img width="300" hspace="5" src="https://habrastorage.org/web/dce/8bd/c5f/dce8bdc5f7514edcae677e52d1661beb.jpg"></div><a name="habracut"></a><br>  JaCarta WebPass developed by <a href="https://www.aladdin-rd.ru/company/">Aladdin RD</a> is a USB token with ‚ÄúOTP on board‚Äù for two-factor user authentication when accessing protected information resources using a one-time password or a reusable password token stored in memory. <br><br>  The scenario proposed in the article implies the use of the RADIUS server to verify the authenticity of the entered one-time code, as well as the OTP value verification system.  As an OTP key management system, we will use the <a href="https://www.aladdin-rd.ru/catalog/jas/">JaCarta Authentication Server (JAS)</a> also developed by Aladdin RD. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The user, when an SSH connection is established, will enter an OTP value instead of a password at the authentication stage.  The PAM module will send the transmitted value to the RADIUS Server, which will check it and allow or deny authentication. <br><br><h2>  Used to demonstrate the environment </h2><br>  This instruction is configured for the following operating system versions: <br><br><ul><li>  Microsoft Windows Server 2012; <br></li><li>  Ubuntu Server 16; <br></li><li>  Microsoft Windows 7. </li></ul><br><h2>  Environmental requirements </h2><br>  For Windows Server, you need to create a domain, add the NPS role.  To do this, follow the tips below. <br><br>  Open the snap-in to add the NPS role. <br><br><div style="text-align:center;"><img width="400" hspace="5" src="https://habrastorage.org/web/29e/e99/90f/29ee9990f1544adbae09c86bed88b472.jpg"></div><br><br>  When selecting services and components, select Network Policy Server. <br><br><div style="text-align:center;"><img width="400" hspace="5" src="https://habrastorage.org/web/1a1/680/938/1a16809389ec47bd82cdcc64b90e4e25.jpg"></div><br><br>  After that, you will see the NPS equipment available. <br><br><div style="text-align:center;"><img width="400" hspace="5" src="https://habrastorage.org/web/e13/8c7/5ae/e138c75ae1834e23b450386c57681fb9.jpg"></div><br><br><h2>  Setup on the RADIUS server side </h2><br>  On the server side, you must perform the following steps: <br><br><ul><li>  add client radius with IP address or Linux server name; <br></li><li>  Select the NPS snap-in on the server. </li></ul><br><div style="text-align:center;"><img width="400" hspace="5" src="https://habrastorage.org/web/b64/243/18b/b6424318bebf4707a67d83458eeb3421.jpg"></div><br><br>  In the snap-in menu, select NPS - RADIUS Clients and Servers - RADIUS Clients, then right-click to open the context menu and click New. <br><br><div style="text-align:center;"><img width="400" hspace="5" src="https://habrastorage.org/web/d70/2a8/4b6/d702a84b691646778656b5c696b9560a.jpg"></div><br>  Enter the client's settings for connecting to the RADIUS server: the name displayed in the snap-in, the address or name of the client, the shared secret for the client and server (you need to think of it). <br><br><div style="text-align:center;"><img width="400" hspace="5" src="https://habrastorage.org/web/ad6/49a/669/ad649a66986f4a5199362dd3f8511136.jpg"></div><br>  Create a domain user whose name will be used for authentication on a Linux server. <br><br><h2>  Preparing JaCarta WebPass </h2><br>  To initialize JaCarta WebPass, you need to open the Web Pass Tool application, which is included in the JaCarta Single Client software.  You can download software via the link <a href="https://www.aladdin-rd.ru/support/downloads/jacarta/">https://www.aladdin-rd.ru/support/downloads/jacarta/</a> . <br><br>  Open the JaCarta WebPass Tool application, select the OTP tab. <br><br><div style="text-align:center;"><img width="400" hspace="5" src="https://habrastorage.org/web/184/d6f/113/184d6f11378c496189a73c676c43ae38.jpg"></div><br>  Select the slot to initialize, then click the Initialize item in the menu. <br><br><div style="text-align:center;"><img width="400" hspace="5" src="https://habrastorage.org/web/cd1/944/402/cd194440209541cdb53ad291986c0fa6.jpg"></div><br>  In the settings, specify the One-time password, the first mechanism from the drop-down list, check Save initialization parameters and click Next. <br><br><div style="text-align:center;"><img width="400" hspace="5" src="https://habrastorage.org/web/3f8/e75/0c0/3f8e750c0f1643619d18f2b5379b2a04.jpg"></div><br>  Select the format of the JAS file and the path to the folder where the initialization file will be saved.  This file is required to connect the key to JAS. <br><br><div style="text-align:center;"><img width="400" hspace="5" src="https://habrastorage.org/web/69b/12c/b1b/69b12cb1b92d405aac2b8ea7ddb03cdf.jpg"></div><br>  Enter the PIN for the key and click Next. <br><br><div style="text-align:center;"><img width="400" hspace="5" src="https://habrastorage.org/web/892/6a7/36c/8926a736c57b435d85550cf54d7de6ae.jpg"></div><br><h2>  Setup on the JAS side </h2><br>  On the JAS side, follow the steps below. <br><br>  Add an OTP device to the system, bind the user to the device.  To do this, open the JAS snap-in. <br><br>  In the snap-in, select Import key media. <br><br><div style="text-align:center;"><img width="400" hspace="5" src="https://habrastorage.org/web/0dd/459/de6/0dd459de68944ed38028554f75de4924.jpg"></div><br>  Specify the path to the file with JaCarta WebPass initialization data (the file can be obtained during slot initialization in the Web Pass Tool application, which is included in the JaCarta Single Client software. You can download the software at <a href="https://www.aladdin-rd.ru/support/downloads/jacarta/">https://www.aladdin-rd.ru / support / downloads / jacarta /</a> ). <br><br><div style="text-align:center;"><img width="400" hspace="5" src="https://habrastorage.org/web/320/28f/b04/32028fb047fc4b959aa92f425823ad06.jpg"></div><br>  If successful, click Next. <br><br><div style="text-align:center;"><img width="400" hspace="5" src="https://habrastorage.org/web/72e/b82/5ad/72eb825ada3a40ba80eb558f6073d416.jpg"></div><br>  Select the added key, click Properties in the menu.  To bind to the user, specify the name and email address for the domain user. <br><br><div style="text-align:center;"><img width="400" hspace="5" src="https://habrastorage.org/web/745/167/8ef/7451678efff441dab04c378e397e95d6.jpg"></div><br>  Before activating, you should synchronize the device, to do this, click Sync in the menu, point to the OTP 1 window and click on the JaCarta WebPass device button, then repeat with the OTP 2 window. <br><br><div style="text-align:center;"><img width="400" hspace="5" src="https://habrastorage.org/web/743/38c/e5c/74338ce5c94c41f2b2f41877e4f7691c.jpg"></div><br>  To activate, select Enable. <br><br><div style="text-align:center;"><img width="400" hspace="5" src="https://habrastorage.org/web/aff/533/962/aff5339625f34ab98060787f3f8ecc03.jpg"></div><br><h2>  Setup on the Linux Server side </h2><br>  On the Linux server side, all operations must be performed as root. <br><br><pre><code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta"># sudo -i # apt-get install libpam-radius-auth</span></span></code> </pre> <br><br>  Add values ‚Äã‚Äãfor your RADIUS server, IP address, or server name, shared secret to the /etc/pam_radius_auth.conf file. <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta"># nano /etc/pam_radius_auth.conf # The timeout field controls how many seconds the module waits before # deciding that the server has failed to respond. # # server[:port] shared_secret timeout (s) [SERVER IP] [ ] 3</span></span></code> </pre> <br>  In the /etc/pam.d/sshd file, add the line auth sufficient pam_radius_auth.so over <a href="https://habrahabr.ru/users/include/" class="user_link">include</a> common-auth, as shown below. <br><br><pre> <code class="cpp hljs"><span class="hljs-meta"><span class="hljs-meta"># nano /etc/pam.d/sshd # PAM configuration for the Secure Shell service # Standard Un*x authentication. auth sufficient pam_radius_auth.so @</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> common-auth # Disallow non-root logins when /etc/nologin exists.</span></span></code> </pre> <br>  Create a local user with the name corresponding to the user in AD. <br><br><h2>  Solution Verification </h2><br>  For verification, we use the Microsoft Windows 7 operating system with the PUTTY client installed in SSH. <br><br>  Let's open Putty and we will specify the address of the machine interesting us on Linux. <br><br><div style="text-align:center;"> <a href=""><img width="400" hspace="5" src="https://habrastorage.org/web/e39/e59/08a/e39e5908aec14a6b9b17ed5b40131911.jpg"></a> </div><br>  Enter your username, Enter, then click on the JaCarta WebPass device button, Enter. <br><br><div style="text-align:center;"> <a href=""><img width="400" hspace="5" src="https://habrastorage.org/web/8b9/740/d14/8b9740d14070480eaa8835746bb7b8ab.jpg"></a> </div><br>  Next, enter the command SSH [Servername2], Enter, press the button on the device, Enter. <br><br><div style="text-align:center;"> <a href=""><img width="400" hspace="5" src="https://habrastorage.org/web/a2a/5b5/593/a2a5b55933e54dca8b6b2395bd3968b9.jpg"></a> </div></div><p>Source: <a href="https://habr.com/ru/post/331908/">https://habr.com/ru/post/331908/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../331898/index.html">Conferences for developers as a way to senior? And what works?</a></li>
<li><a href="../331900/index.html">Developing a new service in Android 7 | Customization of the navigation bar</a></li>
<li><a href="../331902/index.html">Data center operation: what you need to do yourself</a></li>
<li><a href="../331904/index.html">Search for strong connectivity components: Kosarayu algorithm</a></li>
<li><a href="../331906/index.html">Fighting viruses and infrastructure, or disabling SMB v1</a></li>
<li><a href="../331910/index.html">Super Metroid Invisible Hand</a></li>
<li><a href="../331912/index.html">How to create an alternative to Google Drive and Dropbox in 3700 hours</a></li>
<li><a href="../331916/index.html">N ways to use Ahrefs when conducting a search audit</a></li>
<li><a href="../331930/index.html">Transition to binary</a></li>
<li><a href="../331934/index.html">Learn all programming languages</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>