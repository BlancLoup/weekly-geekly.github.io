<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Experience with American payment systems</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! I am working on an e-commerce startup in the states and recently managed to work with a number of electronic payment services, namely Stripe , ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Experience with American payment systems</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/890/81d/fa8/89081dfa8b4184695c6a7d20aa16fb97.png" align="left" width="500">  Hello!  I am working on an e-commerce startup in the states and recently managed to work with a number of electronic payment services, namely <a href="https://stripe.com/">Stripe</a> , <a href="https://www.braintreegateway.com/">Braintree</a> and <a href="https://www.paypal.com/">Paypal</a> .  Today I want to talk a little about what features of electronic payments are in the States, about the practical experience of using the above services and also a number of general thoughts on this topic. <br><a name="habracut"></a><br>  So, at the beginning of a little theory.  Let's start, perhaps, with what types of payment cards are, because at one time it was a small discovery.  So, there are the following types of cards: <br><br><ul><li>  <a href="https://ru.wikipedia.org/wiki/%25D0%2594%25D0%25B5%25D0%25B1%25D0%25B5%25D1%2582%25D0%25BE%25D0%25B2%25D0%25B0%25D1%258F_%25D0%25BA%25D0%25B0%25D1%2580%25D1%2582%25D0%25B0">Debit card</a> (debit card) - most often we meet them in the form of salary cards </li><li>  Overdraft cards are practically the same debit cards, but there is a possibility of withdrawing money, so to say, ‚Äúon credit‚Äù, when your fixed assets are finished </li><li>  <a href="https://ru.wikipedia.org/wiki/%25D0%259A%25D1%2580%25D0%25B5%25D0%25B4%25D0%25B8%25D1%2582%25D0%25BD%25D0%25B0%25D1%258F_%25D0%25BA%25D0%25B0%25D1%2580%25D1%2582%25D0%25B0">Credit card</a> </li><li>  Prepaid cards (prepaid cards) are a prepaid card used to pay for goods or services within the prepaid amount.  About them a little more will be lower. </li><li>  Local cards - local (national) payment system card </li><li>  International cards - Visa (Visa Electron, Visa Classic, Visa Gold, Visa Platinum), MasterCard (Cirrus, Maestro, MasterCard Standard, MasterCard Gold, MasterCard Platinum), Diners Club, American Express, JCB and China Unionpay. </li><li>  Virtual card - bank prepaid card without a material carrier </li></ul><br><br>  So, about prepaid cards.  In the States, they are very popular and you can buy them at any Walmart, T-Mobile or another major store.  How it is used.  Suppose you have a beloved nephew and you decided to give him money for his birthday.  But since donating a cache is not fashionable, and a nephew buys something, let's say on Amazon, then you go and buy such a card, for example, for $ 50.  After that, the nephew activates it on the Internet and is ready, he has a $ 50 card.  There is also a subspecies prepaid card that can be replenished.  The bottom line is that these cards are popular in the US, because they allow you not to shine your personal card on the Internet.  What a plus.  However, from the point of view of a company that, for example, does not charge the entire amount for service immediately (charge upfront), this is a big risk, because you can never show anything on such a card unless you can withdraw money.  More precisely, you can, and there are even special procedures for this, but sometimes it is simply not worth it.  You can understand what type of card you are working with using the first 6 digits of the card (bin number) and such a <a href="http://www.binlist.net/">service</a> .  By the way, the <a href="">link is a</a> good infographics about what the number on payment cards means. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/bb3/4d5/eb8/bb34d5eb89dad56a3fe4c686ca9c84e2.jpg" width="350" height="320"></div><br><br>  The second wonderful thing that you will surely come across when you start working with any payment systems is an error message.  More precisely with their description.  Why?  Because most banks do not have a clear specification of what a particular code means, and when the service receives an error and cannot recognize it, you will see ‚ÄúPayment was declined‚Äù, which is really bad not for you, but for your user, who will be surprised and actively continue to press the button ‚ÄúPlace order‚Äù, nothing will work, he will be offended and will go on forever.  Although he may not be trite money on the card.  To this we must be prepared and give a more detailed description of the error. <br><br>  Now, a little about the payment service, or rather what functionality should have a good payment service. <br><br>  General requirements: <br><ul><li>  Understandable policy of use, so that you are not suddenly turned off, as Braintree did to us once (who is interested - I can tell you in person); </li><li>  Simple and clear dashboard, so that it can be used not only by programmers, but also by customer service; </li><li>  The most transparent documentation on the connection, and the following items must be clearly stated in it: <br><ul><li>  Getting started </li><li>  API Docs </li><li>  Testing </li><li>  Two sites - test / production </li><li>  Troubleshooting </li><li>  Working with widgets (if any) </li></ul><br></li><li>  Adequate support. </li></ul><br><br>  Functional requirements: <br><ul><li>  Work with users, their maps and additional data; </li><li>  Data validation; </li><li>  Making payments; </li><li>  Subscription; </li><li>  Discount coupons; </li><li>  Work with invoices; </li><li>  Accounting </li></ul><br>  It goes without saying that all this should have a clear REST API that can be taken and used without additional gestures.  An example of additional gestures - there is such a service stamps.com, which allows you to integrate with all sorts of USPS, FedEx and other services.  To access their API, you need to send a request where to include the IP of all developers, so that these IPs are added to whitelist.  After that, wait 2-3 days and there will be happiness.  Enterprise is such an enterprise. <br><br>  Actually, it's time to compare the services that I listed at the beginning.  We will not go far, Stripe wins, which we actively use.  The reasons: <br><ul><li>  the most comprehensible documentation which I ever read - I never googled anything extra; </li><li>  easy to connect - almost copy-paste from the same documentation; </li><li>  very responsive support, and indeed an example of a company that values ‚Äã‚Äãcustomers (if interested, I can tell you in person); </li><li>  the simplest interface of the personal account is intuitively clear where it is. </li></ul><br>  The same braintree loses due to the fact that it is impossible without a bottle how to connect it, and I am silent about their documentation.  As an example - try to find the numbers of cards for testing in the sandbox, good luck. <br><br>  About paypal.  Paypal is good when you sell electronic goods or service.  In other cases - forget about it.  Why?  Here is a simple picture of how to integrate with it: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/55f/984/a92/55f984a92c957f990f141b42c114226b.png" width="720" height="621"></div><br><br>  By the way, Paypal bought Braintree not so long ago and now gives them all sorts of new things to develop, because "they are a startup and can do it quickly and efficiently." <br><br>  How to connect Stripe.  Step one - javascript: <br><pre><code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//  Stripe.setPublishableKey('{stripe.publish_key}'); //     Stripe ,       //       stripeResponseHandler Stripe.card.createToken({ number: $('#cardnumber').val(), cvc: $('#cvc').val(), exp_month: $('#expdate_mm').val(), exp_year: $('#expdate_yy').val(), name: $("#cardholdername").val(), address_line1: $("#street1").val()), address_line2: $("#street2").val(), address_city: $("#city").val(), address_state: $("#region_id").val(), address_zip: $("#postcode").val(), address_country: 'US' }, stripeResponseHandler); //     var stripeResponseHandler = function (status, response) { var $form = $('#payment-form'); if (response.error) { //   Stripe, ,     / } else { $.post(url, $form.serialize(), function (data) { //      });</span></span></code> </pre> <br>  Now there is a server code - grails / java <br><br><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// Stripe.apiKey = stripe.secret_key //  Map&lt;String, Object&gt; customerParams = new HashMap&lt;String, Object&gt;() customerParams.put("email",email) customer = Customer.create(customerParams) //     ,    Map&lt;String, Object&gt; cardParams = new HashMap&lt;String, Object&gt;() cardParams.put("card", token) customer.createCard(cardParams) //  Map&lt;String, Object&gt; chargeParams = new HashMap&lt;String, Object&gt;() chargeParams.put("amount", amount) chargeParams.put("currency", "usd") chargeParams.put("description", "Charge") chargeParams.put("customer", customer.id) chargeParams.put("card", card.id) Charge.create(chargeParams)</span></span></code> </pre><br><br>  Actually everything, you had a payment.  The same code, for example on Braintree, will be 2.5 times longer. <br><br>  On this, perhaps, everything.  Ask questions in the comments, the topic is interesting, and I have collected enough rake in it. </div><p>Source: <a href="https://habr.com/ru/post/235233/">https://habr.com/ru/post/235233/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../235221/index.html">Industry of eSports: from a box of beer to a million dollars</a></li>
<li><a href="../235223/index.html">Star Citizen: Until September 5, the game is available to everyone</a></li>
<li><a href="../235225/index.html">How I spent the summer: Summer Workshop "Computer Continuum 2014"</a></li>
<li><a href="../235227/index.html">Welcome to Moscow Django MeetUp ‚Ññ 22</a></li>
<li><a href="../235231/index.html">Awesome WM and Dbus</a></li>
<li><a href="../235235/index.html">Apple fixes an important iCloud vulnerability</a></li>
<li><a href="../235245/index.html">Why is it important to maintain temperature in the server. As usual cooling server</a></li>
<li><a href="../235247/index.html">Common mistakes when protecting sites from CSRF attacks</a></li>
<li><a href="../235249/index.html">Review of the EcoReco M3 E-Scooter Electric Scooter</a></li>
<li><a href="../235251/index.html">Drupal 7 module. Transfer of meter readings</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>