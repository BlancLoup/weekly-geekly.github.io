<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Aligning partitions on modern hard drives using software</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The emergence of modern hard drives with sectors of 4 KB (instead of 512 bytes) made the problem of alignment of sections relevant for both IT-special...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Aligning partitions on modern hard drives using software</h1><div class="post__text post__text-html js-mediator-article"> The emergence of modern hard drives with sectors of 4 KB (instead of 512 bytes) made the problem of alignment of sections relevant for both IT-specialists and ordinary users.  The fact is that the discrepancy between the physical and logical distribution of data can lead to a sharp decline in the performance of the entire system and shorten the life of the equipment. <br><a name="habracut"></a><br>  To explain the essence of partition alignment, we illustrate the placement of data stored on a regular hard disk: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1b4/0e3/8ad/1b40e38ad2ac5cc4ac1cc3c7d0360eeb.jpg" alt="image"><br><br>  The figure shows a simplified segmentation scheme, where one partition takes up all disk space and all sectors.  The section corresponds with the first sector, the beginning of the section corresponds to the beginning of the first sector.  However, this is too simplified scheme.  After all, the section consists of logical units / blocks.  Consider how they are related to the sectors: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="http://i076.radikal.ru/1006/44/7771b82c2b8b.jpg" alt="image"><br><br>  The figure shows that two sectors correspond to one cluster.  This means that when reading data, for example, a small text file from one cluster, the storage device reads data from two sectors. <br>  Note: the beginning of the section corresponds to the beginning of the first sector and all clusters are aligned by sector, therefore, the section is aligned.  Data operations are performed at maximum speed. <br>  Now consider the reasons for the discrepancy between sections and sectors of the consequences of this phenomenon. <br><br>  <b>How and why does the discrepancy between partitions and sectors slow down the hard disk?</b> <br><br>  The size of the physical sectors of modern hard drives (for example, Western Digital) is 4,096 bytes, and 4 KB data blocks are processed at the physical level; however, for external equipment and software, such disks look like ‚Äútraditional‚Äù ones with 512-byte sectors.  This allows compatibility with earlier software versions.  In such cases, another level is added - the compatibility level. <br><br><img src="http://s43.radikal.ru/i099/1006/25/fd5053b91a24.jpg" alt="image"><br><br>  The figure shows the three levels of data distribution.  The lower level is, in fact, the hard disk and physical sectors of 4 KB each.  The second level is an abstract representation in the form of 512-byte sectors for external systems.  And the uppermost level is the current file system with 2 KB clusters, each of which is equal to four abstract sectors and half of the physical sector.  Thus, 1 cluster = 4 abstract sectors = ¬Ω of the physical sector. <br><br>  Notice that all three levels are aligned with each other and the beginning of the disc.  Thus, reading or writing data of one cluster is implemented using four 512-byte sectors and one 4K sector.  The number of read-write operations is minimal;  drive works with maximum performance. <br><br>  But the situation changes for the worse when the logical level clusters shift relative to the underlying layers, as shown in this figure: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3dc/31d/9e4/3dc31d9e44586ce83010a9b8b7231313.jpg" alt="image"><br><br>  As you can see, the partition is offset from the beginning of the disk by one sector of 512 bytes.  As a result, several logical clusters were associated with two physical 4KB sectors (second, fourth, and sixth), which doubled the number of read-write operations.  In this case, the performance of the system is reduced, since the hard disk drive performs two operations in two sectors instead of one, as with proper partition alignment. <br><br>  What are the causes of bias?  All versions of Windows OS prior to Vista, when creating clusters, volumes are oriented to sectors of 512 bytes and place the beginning of the partition in accordance with them, and not with 4 KB sectors as shown in the previous figure, where the beginning of the partition is shifted to one sector of 512 bytes. <br><br>  Usually the section starts with 63 sectors.  63 sectors - the established size of the ‚Äúcylinder‚Äù of the disk and some older versions of DOS or Windows require that the partition be aligned with the ‚Äúcylinder‚Äù for correct addressing and access to the sectors.  Modern operating systems do not use the outdated CHS addressing scheme (cylinder / read head / sector).  But for a number of reasons, all versions of Windows prior to Vista create partitions according to this rule. <br><br>  Interestingly, the sections aligned in 63 sectors are not matched for 4 KB sectors for purely mathematical reasons. <br><br><img src="http://s51.radikal.ru/i134/1006/18/2ee26528a325.jpg" alt="image"><br><br>  It is obvious that 63 sectors of 512 bytes do not correspond to a whole number of 4 KB sectors.  Thus, the first and all subsequent disk partitions will be located with an offset. <br><br><img src="http://s55.radikal.ru/i149/1006/92/6eda0a30e12d.jpg" alt="image"><br><br>  <b>What does the Paragon Alignment Tool do?</b> <br><br>  In the coming days, Paragon Software will present the Paragon Alignment Tool (PAT) utility.  In fact, it moves partitions by a number of sectors of 512 bytes, aligning the volumes.  For example, to align a partition with a size of 63 sectors, you just need to move it forward one sector with a size of 512 bytes. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/915/bf3/481/915bf34814887036888bc538de4efbfa.jpg" alt="image"><br><br>  Now the beginning of the section corresponds to the beginning of the 4KB sector, and this section and all subsequent ones are arranged correctly. <br><br><img src="http://s42.radikal.ru/i097/1006/2a/c6aaccd8974b.jpg" alt="image"><br><br>  PAT shifts the beginning of the partition by 2048 sectors of 512 bytes from the beginning of the disk, which corresponds to 1 MB, and is also well suited for 4 KB sectors. <br><br>  <b>The need to align sections for SSD</b> <br><br>  For SSDs, the problem of misallocating partitions is even more relevant than for traditional hard drives.  The size of the memory modules of modern SSD is 4096 bytes, which is analogous to 4 KB sectors.  Thus, all the previously mentioned problems associated with the alignment of partitions, arise when using SSD. <br><br>  However, in addition to reducing the speed of the file system, there is another problem that is unique to SSD.  Memory cells of solid-state disks fail faster with a large number of write operations.  Thus, with the wrong location of partitions on the SSD, not only the speed of the system is reduced, but also the SSD itself is endangered. <br><br>  Aligning partitions with PAT eliminates redundant read / write operations, which can significantly increase the speed and extend the life of the SSD. <br><br>  <b>The need for partition alignment for SAN and RAID</b> <br><br>  RAID technology allows you to combine multiple hard drives and other storage devices into one large data array.  The system perceives this array as one large storage device, and the data is distributed across all of its resources.  The volume, after reaching which the data cease to be recorded on one disk of the array and begin to be recorded on another, is called the size of the stripe, which, in turn, can be very different (8 KB, 16 KB, 32 KB or 64 KB). <br><br>  When using software or hardware RAID, system performance may decrease if the initial partition position does not match the stripe size.  In this case, the number of operations with data on multiple disks of the RAID array increases. <br><br>  To solve this problem, PAT shifts sections by 2048 sectors.  This offset is suitable for most stripe sizes.  Working with data becomes faster by eliminating redundant operations. <br><br>  <b>The need for partition alignment in virtual environments</b> <br><br>  Aligning partitions in a virtual infrastructure environment is very important for performance, equipment life and efficient use of storage.  Incorrect partitioning results in the virtual machine receiving more data from the array than requested.  This not only reduces work efficiency, but with such excessive load, more storage resources are required. <br><br><img src="http://i072.radikal.ru/1006/a3/22bdb32c136a.jpg" alt="image"><br><br>  This figure shows the configuration of a VMware ESX \ Server \ vSphere server using RAID / SAN storage.  Here, the sections are incorrectly located on two levels at once, which leads to a serious decrease in performance.  For example, to read data from the first cluster, the system must read three VMFS blocks and four RAID blocks (and even more stripes). <br><br>  Currently, PAT cannot move VMFS volumes themselves, but can align partitions on virtual disks. <br><br><img src="http://i064.radikal.ru/1006/cf/ea617186f5a9.jpg" alt="image"><br><br>  With this configuration, all volumes and partitions are located correctly and the overall speed of data operations has doubled. </div><p>Source: <a href="https://habr.com/ru/post/97436/">https://habr.com/ru/post/97436/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../97429/index.html">Universal e-book reader from computer screen and mobile devices</a></li>
<li><a href="../97430/index.html">World of Tanks - the beginning of the OBT</a></li>
<li><a href="../97431/index.html">Event007 - hosting service invitations to concerts, events and meetings</a></li>
<li><a href="../97432/index.html">Free Wi-Fi CSOs! for all CSO subscribers!</a></li>
<li><a href="../97434/index.html">Firmware information for Samsung devices on the Android platform</a></li>
<li><a href="../97437/index.html">Eight daring, or "Causes Taimyr!", Part Two</a></li>
<li><a href="../97440/index.html">Parsim Dictionary of the Russian language Zaliznyak Andrei Anatolyevich</a></li>
<li><a href="../97441/index.html">Why writing applications under the N900 is profitable!</a></li>
<li><a href="../97443/index.html">10 HTML5 examples so you forget about flash</a></li>
<li><a href="../97445/index.html">Features of team building in IT companies</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>