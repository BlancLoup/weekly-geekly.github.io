<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Micro Editors</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="There are many different useful editors who help article authors prepare content for publication on web resources. But unfortunately, it is often the ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Micro Editors</h1><div class="post__text post__text-html js-mediator-article">  There are many different useful editors who help article authors prepare content for publication on web resources.  But unfortunately, it is often the case that the best is the enemy of the good, and you have to use not very convenient programs that instead of taking and sharpening ‚Äúyour‚Äù editor for the necessary goals.  My approach to this issue is to write my editor.  In this post, I want to tell you about how and what features I implemented. <br><br><a name="habracut"></a><h3>  Content </h3><br><ul><li>  <a href="https://habr.com/ru/post/72527/">Autogenerated content</a> </li><li>  <a href="https://habr.com/ru/post/72527/">Text as pictures</a> </li><li>  <a href="https://habr.com/ru/post/72527/">Syntax highlighting</a> </li><li>  <a href="https://habr.com/ru/post/72527/">Counts</a> </li></ul><br><br><h3>  Autogenerated content </h3><br>  If you take the same Microsoft Word, then there is for example the ability to add content (table of contents) or a link (references / endnotes / footnotes) to the text.  To publish on web resources, these features are sometimes needed, although not all portals support, for example, named links.  But nevertheless, two features that I managed to add to my editor are the autogeneration of a TOC and a list of links (‚Äúnotes‚Äù). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Content </h4><br>  The list of content items is shown a bit higher in this post.  Its essence is to allow quick navigation through the elements of a post or article.  Naturally, this list is autogenerated using the <code>H1</code> - <code>H8</code> tags, which it finds in the document.  Simply tears them out, finds the topmost level of the header (for example, for Habr it is <code>H3</code> ), and makes the corresponding lists using nested <code>UL</code> and <code>LI</code> elements.  This is not very safe, but such a simple expression is used to search for headers: <br><br><blockquote> <code><font color="black"><font color="#0000FF">var</font> r = <font color="#0000FF">new</font> Regex( <font color="#570000">"&lt;h([^&lt;]+)&gt;(.+)&lt;/h.&gt;"</font> );&lt;br/&gt; <br></font></code> </blockquote><br>  The content is useful mainly for large posts, for example if you are writing an article on <a href="http://codeproject.com/">CodeProject</a> .  By the way, I note that if there are no headers, then the content is not created.  And the header level of the content (if any) always corresponds to the top level of the header in the file. <br><br>  The implementation of such a list was not an easy task.  Here is a piece of code that illustrates how this is done: <br><br><blockquote> <code><font color="black"><font color="#0000FF">private</font> <font color="#0000FF">static</font> <font color="#0000FF">string</font> GenerateToc([NotNull] <font color="#0000FF">string</font> text, ConversionOptions options, <font color="#0000FF">out</font> <font color="#0000FF">int</font> minLevel)&lt;br/&gt; <br> {&lt;br/&gt; <br> List&lt;HeadingEntry&gt; entries = <font color="#0000FF">new</font> List&lt;HeadingEntry&gt;();&lt;br/&gt; <br> <font color="#0000FF">var</font> r = <font color="#0000FF">new</font> Regex( <font color="#570000">"&lt;h([^&lt;]+)&gt;(.+)&lt;/h.&gt;"</font> );&lt;br/&gt; <br> <font color="#0000FF">var</font> matches = r.Matches(text);&lt;br/&gt; <br> <font color="#0000FF">int</font> count = 0;&lt;br/&gt; <br> <font color="#0000FF">foreach</font> (Match m <font color="#0000FF">in</font> matches)&lt;br/&gt; <br> {&lt;br/&gt; <br> <font color="#0000FF">int</font> n;&lt;br/&gt; <br> <font color="#0000FF">if</font> ( <font color="#0000FF">int</font> .TryParse(m.Groups[1].Value, <font color="#0000FF">out</font> n))&lt;br/&gt; <br> {&lt;br/&gt; <br> HeadingEntry he = <font color="#0000FF">new</font> HeadingEntry(n, m.Groups[2].Value);&lt;br/&gt; <br> <font color="#006400">// set tag text if clash</font> <br> <font color="#0000FF">bool</font> bFound = <font color="#0000FF">false</font> ;&lt;br/&gt; <br> <font color="#0000FF">foreach</font> (HeadingEntry h <font color="#0000FF">in</font> entries)&lt;br/&gt; <br> <font color="#0000FF">if</font> (h.SuggestedTagText == he.SuggestedTagText)&lt;br/&gt; <br> bFound = <font color="#0000FF">true</font> ;&lt;br/&gt; <br> he.TagText = he.SuggestedTagText + (bFound ? (count++).ToString() : <font color="#0000FF">string</font> .Empty);&lt;br/&gt; <br> entries.Add(he);&lt;br/&gt; <br> <font color="#006400">// replace only first occurence</font> <br> <font color="#006400">//text = text.Replace(m.Groups[0].Value,</font> <br> <font color="#006400">//                    string.Format("&lt;h{0}&gt;&lt;a name=\"{2}\"&gt;&lt;/a&gt;{1}&lt;/h{0}&gt;", n, he.Text, he.TagText));</font> <br> <font color="#0000FF">int</font> idx = text.IndexOf(m.Groups[0].Value);&lt;br/&gt; <br> <font color="#0000FF">string</font> emptyLink = options.UseImageHeadings ? <font color="#0000FF">string</font> .Empty :&lt;br/&gt; <br> <font color="#0000FF">string</font> .Format( <font color="#570000">"&lt;a name=\"{0}\"&gt;&lt;/a&gt;"</font> , he.TagText);&lt;br/&gt; <br> text = text.Remove(idx, m.Groups[0].Value.Length).Insert(idx,&lt;br/&gt; <br> <font color="#0000FF">string</font> .Format( <font color="#570000">"&lt;h{0}&gt;{2}{1}&lt;/h{0}&gt;"</font> , n, he.Text, emptyLink));&lt;br/&gt; <br> }&lt;br/&gt; <br> }&lt;br/&gt; <br> minLevel = <font color="#0000FF">int</font> .MaxValue;&lt;br/&gt; <br> <font color="#0000FF">if</font> (entries.Count &gt; 0)&lt;br/&gt; <br> {&lt;br/&gt; <br> <font color="#0000FF">var</font> hb = <font color="#0000FF">new</font> HtmlBuilder();&lt;br/&gt; <br> <font color="#006400">// all are, essentially, ULs</font> <br> <font color="#0000FF">int</font> lastLevel = -1;&lt;br/&gt; <br> <font color="#0000FF">foreach</font> (HeadingEntry he <font color="#0000FF">in</font> entries)&lt;br/&gt; <br> {&lt;br/&gt; <br> <font color="#006400">// if this level &gt; last, open a new UL</font> <br> <font color="#0000FF">if</font> (he.Level &gt; lastLevel)&lt;br/&gt; <br> hb.AppendLine( <font color="#570000">"&lt;ul&gt;"</font> ).Indent();&lt;br/&gt; <br> <font color="#0000FF">if</font> (he.Level &lt; lastLevel)&lt;br/&gt; <br> {&lt;br/&gt; <br> <font color="#0000FF">int</font> diff = lastLevel - he.Level;&lt;br/&gt; <br> <font color="#0000FF">while</font> (--diff &gt;= 0)&lt;br/&gt; <br> hb.Unindent().AppendLine( <font color="#570000">"&lt;/ul&gt;"</font> );&lt;br/&gt; <br> }&lt;br/&gt; <br> hb.AppendLine( <font color="#0000FF">string</font> .Format( <font color="#570000">"&lt;li&gt;&lt;a href=\"#{0}\"&gt;{1}&lt;/a&gt;&lt;/li&gt;"</font> , he.TagText, he.Text));&lt;br/&gt; <br> minLevel = Math.Min(minLevel, he.Level);&lt;br/&gt; <br> lastLevel = he.Level;&lt;br/&gt; <br> }&lt;br/&gt; <br> <font color="#006400">// close out all indent levels</font> <br> <font color="#0000FF">while</font> (hb.IndentLevel &gt; 0)&lt;br/&gt; <br> hb.Unindent().AppendLine( <font color="#570000">"&lt;/ul&gt;"</font> );&lt;br/&gt; <br> <font color="#0000FF">if</font> (! <font color="#0000FF">string</font> .IsNullOrEmpty(options.TocLabel))&lt;br/&gt; <br> hb.Insert( <font color="#0000FF">string</font> .Format( <font color="#570000">"&lt;h{0}&gt;{1}&lt;/h{0}&gt;{2}"</font> , minLevel,&lt;br/&gt; <br> HttpUtility.HtmlEncode(options.TocLabel), Environment.NewLine), 0);&lt;br/&gt; <br> <font color="#006400">// at this point, hb contains the TOC, so</font> <br> <font color="#0000FF">if</font> (! <font color="#0000FF">string</font> .IsNullOrEmpty(options.TocAfterToken))&lt;br/&gt; <br> {&lt;br/&gt; <br> <font color="#0000FF">int</font> idx = text.IndexOf(options.TocAfterToken);&lt;br/&gt; <br> <font color="#0000FF">if</font> (idx &gt;= 0)&lt;br/&gt; <br> <font color="#0000FF">return</font> text.Substring(0, idx + options.TocAfterToken.Length) +&lt;br/&gt; <br> hb + text.Substring(idx + options.TocAfterToken.Length);&lt;br/&gt; <br> }&lt;br/&gt; <br> hb.Append(text);&lt;br/&gt; <br> <font color="#0000FF">return</font> hb.ToString();&lt;br/&gt; <br> }&lt;br/&gt; <br> <font color="#0000FF">return</font> text;&lt;br/&gt; <br> }&lt;br/&gt; <br></font></code> </blockquote><br><h4>  Notes </h4><br>  Notes, or links, are additional, minor thoughts that appear after the article itself.  I prefer to add them to the code in square brackets, <code>[ ]</code> .  Each footnote is assigned the number [ <a href="https://habr.com/ru/post/72527/" title="Here is the footnote number 1">1</a> ] in the order of the meeting in the file, and then they are neatly grouped at the end of the document. <br><br>  Unfortunately, notes can not be pulled out by regexp'ami - because you can just have square brackets, for example, in the <code>PRE</code> section.  Therefore, ‚Äúcatching‚Äù square brackets is real only in the process of traversing a file (by letter) with a transformer.  Yes, yes, this is the same transformer, which makes beautiful dashes and quotes. <br><br><h3>  Text as pictures </h3><br>  Sometimes you need to demonstrate some kind of font, sometimes you want to write something that will not be indexed by a search engine, sometimes you just want to protect your content from plagiarism.  Therefore, being able to display text as graphics is useful.  And to be able to display it using ClearType and OpenType is generally super.  Therefore, for these purposes, I had to add a ‚Äúunmanaged‚Äù part to my managed (WPF) application, which draws beautiful text using Direct2D - a new API for two-dimensional graphics from Microsoft.  How it works?  Well, I write for example <code>[{Hello, World!}]</code> And the system responds to this: <br><br><img src="http://nesteruk.org/pix/16/ff0.jpg"><br><br>  After I earned plain text, I added the actual support for fonts, sizes and features of OpenType to make everything look even more beautiful. <br><br><img src="http://nesteruk.org/pix/16/ff1.jpg"><br><br>  Having the opportunity to replace the text with graphics with impunity, I automated this process so that, for example, I can replace all the headers with my own production graphics. <br><br>  One valuable snippet that I finally wrote is a method for measuring the useful sizes of a bitmap after the text is drawn on it.  I used to do this in GDI +, but I recently got angry and wrote in C ++: <br><br><blockquote> <code><font color="black">MYAPI RECT MeasureCropArea( <font color="#0000FF">BYTE</font> * src, <font color="#0000FF">int</font> width, <font color="#0000FF">int</font> height, <font color="#0000FF">int</font> stride, <font color="#0000FF">int</font> color)&lt;br/&gt; <br> {&lt;br/&gt; <br> Pixel&amp; bgr = * <font color="#0000FF">reinterpret_cast</font> &lt;Pixel*&gt;(&amp;color);&lt;br/&gt; <br> RECT result;&lt;br/&gt; <br> <font color="#006400">// find the first non-conforming row of pixels</font> <br> <font color="#0000FF">for</font> ( <font color="#0000FF">int</font> y = 0; y &lt; height; ++y) &lt;br/&gt; <br> {&lt;br/&gt; <br> <font color="#0000FF">int</font> y_offset = y * stride;&lt;br/&gt; <br> <font color="#0000FF">for</font> ( <font color="#0000FF">int</font> x = 0; x &lt; width; ++x)&lt;br/&gt; <br> {&lt;br/&gt; <br> <font color="#0000FF">int</font> offset = x * <font color="#0000FF">sizeof</font> (Pixel) + y_offset;&lt;br/&gt; <br> Pixel&amp; s = * <font color="#0000FF">reinterpret_cast</font> &lt;Pixel*&gt;(src + offset);&lt;br/&gt; <br> <font color="#006400">// if this pixel is non-conforming, so is the row</font> <br> <font color="#0000FF">if</font> (s != bgr)&lt;br/&gt; <br> {&lt;br/&gt; <br> result.top = y;&lt;br/&gt; <br> <font color="#006400">// cause soft eject</font> <br> x = width;&lt;br/&gt; <br> y = height;&lt;br/&gt; <br> }&lt;br/&gt; <br> }&lt;br/&gt; <br> }&lt;br/&gt; <br> <font color="#006400">// find the last non-conforming row of pixels</font> <br> <font color="#0000FF">for</font> ( <font color="#0000FF">int</font> y = height - 1; y &gt;= 0; --y) &lt;br/&gt; <br> {&lt;br/&gt; <br> <font color="#0000FF">int</font> y_offset = y * stride;&lt;br/&gt; <br> <font color="#0000FF">for</font> ( <font color="#0000FF">int</font> x = 0; x &lt; width; ++x)&lt;br/&gt; <br> {&lt;br/&gt; <br> <font color="#0000FF">int</font> offset = x * <font color="#0000FF">sizeof</font> (Pixel) + y_offset;&lt;br/&gt; <br> Pixel&amp; s = * <font color="#0000FF">reinterpret_cast</font> &lt;Pixel*&gt;(src + offset);&lt;br/&gt; <br> <font color="#006400">// if this pixel is non-conforming, so is the row</font> <br> <font color="#0000FF">if</font> (s != bgr)&lt;br/&gt; <br> {&lt;br/&gt; <br> result.bottom = y;&lt;br/&gt; <br> <font color="#006400">// cause soft eject</font> <br> x = width;&lt;br/&gt; <br> y = -1;&lt;br/&gt; <br> }&lt;br/&gt; <br> }&lt;br/&gt; <br> }&lt;br/&gt; <br> <font color="#006400">// find the first non-conforming column of pixels</font> <br> <font color="#0000FF">for</font> ( <font color="#0000FF">int</font> x = 0; x &lt; width; ++x)&lt;br/&gt; <br> {&lt;br/&gt; <br> <font color="#0000FF">for</font> ( <font color="#0000FF">int</font> y = 0; y &lt; height; ++y) &lt;br/&gt; <br> {&lt;br/&gt; <br> <font color="#0000FF">int</font> offset = x * <font color="#0000FF">sizeof</font> (Pixel) + y * stride;&lt;br/&gt; <br> Pixel&amp; s = * <font color="#0000FF">reinterpret_cast</font> &lt;Pixel*&gt;(src + offset);&lt;br/&gt; <br> <font color="#006400">// if this pixel is non-conforming, so is the column</font> <br> <font color="#0000FF">if</font> (s != bgr)&lt;br/&gt; <br> {&lt;br/&gt; <br> result.left = x;&lt;br/&gt; <br> <font color="#006400">// cause soft eject</font> <br> x = width;&lt;br/&gt; <br> y = height;&lt;br/&gt; <br> }&lt;br/&gt; <br> }&lt;br/&gt; <br> }&lt;br/&gt; <br> <font color="#006400">// find the last non-conforming column of pixels</font> <br> <font color="#0000FF">for</font> ( <font color="#0000FF">int</font> x = width - 1; x &gt;= 0; --x)&lt;br/&gt; <br> {&lt;br/&gt; <br> <font color="#0000FF">for</font> ( <font color="#0000FF">int</font> y = 0; y &lt; height; ++y) &lt;br/&gt; <br> {&lt;br/&gt; <br> <font color="#0000FF">int</font> offset = x * <font color="#0000FF">sizeof</font> (Pixel) + y * stride;&lt;br/&gt; <br> Pixel&amp; s = * <font color="#0000FF">reinterpret_cast</font> &lt;Pixel*&gt;(src + offset);&lt;br/&gt; <br> <font color="#006400">// if this pixel is non-conforming, so is the column</font> <br> <font color="#0000FF">if</font> (s != bgr)&lt;br/&gt; <br> {&lt;br/&gt; <br> result.right = x;&lt;br/&gt; <br> <font color="#006400">// cause soft eject</font> <br> x = -1;&lt;br/&gt; <br> y = height;&lt;br/&gt; <br> }&lt;br/&gt; <br> }&lt;br/&gt; <br> }&lt;br/&gt; <br> <font color="#0000FF">int</font> w = result.right - result.left;&lt;br/&gt; <br> <font color="#0000FF">int</font> h = result.bottom - result.top;&lt;br/&gt; <br> <font color="#0000FF">if</font> (w &lt; 1) { result.left = 0; result.right = 1; }&lt;br/&gt; <br> <font color="#0000FF">if</font> (h &lt; 1) { result.top = 0; result.bottom = 1; }&lt;br/&gt; <br> <font color="#0000FF">return</font> result;&lt;br/&gt; <br> }&lt;br/&gt; <br></font></code> </blockquote><br><h3>  Syntax highlighting </h3><br>  RANT: I'm <strong>sick of</strong> seeing articles on Habr√© where it‚Äôs written after a piece of code: <code>This code was highlighted with CodeSyntaxHighlighter</code> .  This is inadequate. <br><br>  I needed exactly the same functionality for the editor.  As a result, I used the same library as the highlighter (I don‚Äôt remember exactly how it is there), got a little bit of the API and now I did it - you can write <code>{{   }}</code> and the backlight will work.  Code examples are right in this post :) <br><br><h3>  Counts </h3><br>  Counts are my new hobby.  Sometimes it‚Äôs just not to explain the idea differently.  Again, the autogeneration of a graph graph is basically simple, but in practice it led to the creation of a DSL that allows me to write simple commands, and on the output draws a graph.  From such specs <br><br><blockquote> <code><font color="black">edge basic advanced&lt;br/&gt; <br> edge advanced TOC`generation&lt;br/&gt; <br> edge advanced Text- <font color="#0000FF">as</font> -image`generation&lt;br/&gt; <br> edge advanced Graph`generation&lt;br/&gt; <br> edge Heading`substitution&lt;br/&gt; <br> edge TOC`generation Heading`substitution&lt;br/&gt; <br> edge Heading`substitution Migration`from`FlowDocument`to`Direct2D&lt;br/&gt; <br> edge Text- <font color="#0000FF">as</font> -image`generation Heading`substitution&lt;br/&gt; <br> edge Graph`generation Subpixel`hinting`(future)&lt;br/&gt; <br></font></code> </blockquote><br>  It turns out such a picture: <br><br><img src="http://nesteruk.org/pix/0/9ba4e7fb-0583-40a0-abf0-3a472f49817c.jpg"><br><br><br>  This is of course DSLka, and I realized it through reflection.  Each <code>edge</code> directive turns into a real call to the edge method.  Here is the parser of these commands: <br><br><blockquote> <code><font color="black"><font color="#0000FF">public</font> <font color="#0000FF">void</font> AddInstruction( <font color="#0000FF">string</font> line)&lt;br/&gt; <br> {&lt;br/&gt; <br> <font color="#0000FF">if</font> ( <font color="#0000FF">string</font> .IsNullOrEmpty(line)) <font color="#0000FF">return</font> ;&lt;br/&gt; <br> <font color="#0000FF">foreach</font> (Match m <font color="#0000FF">in</font> Regex.Matches(line, <font color="#570000">"([\"'])(?:\\\\\\1|.)*?\\1"</font> ))&lt;br/&gt; <br> line = line.Replace(m.Value, m.Value.Replace( <font color="#570000">' '</font> , <font color="#570000">'`'</font> ));&lt;br/&gt; <br> <font color="#0000FF">string</font> [] parts = line.Split( <font color="#570000">' '</font> ).Select(p =&gt; p.Replace( <font color="#570000">'`'</font> , <font color="#570000">' '</font> ).Unquote()).ToArray();&lt;br/&gt; <br> <font color="#0000FF">if</font> (parts.Length &lt; 1) <font color="#0000FF">return</font> ;&lt;br/&gt; <br> <font color="#006400">// having acquired the parts, see if there's a matching method</font> <br> MethodInfo mi = <font color="#0000FF">null</font> ;&lt;br/&gt; <br> <font color="#0000FF">if</font> (cachedMethodInfo.ContainsKey( <font color="#0000FF">new</font> KeyValuePair&lt; <font color="#0000FF">string</font> , <font color="#0000FF">int</font> &gt;(parts[0], parts.Length - 1)))&lt;br/&gt; <br> mi = cachedMethodInfo[ <font color="#0000FF">new</font> KeyValuePair&lt; <font color="#0000FF">string</font> , <font color="#0000FF">int</font> &gt;(parts[0], parts.Length - 1)];&lt;br/&gt; <br> <font color="#0000FF">else</font> &lt;br/&gt; <br> {&lt;br/&gt; <br> <font color="#0000FF">var</font> methods = GetType().GetMethods().Where(m =&gt; m.Name.ToLower() == parts[0]&lt;br/&gt; <br> &amp;&amp; m.GetParameters().Length == (parts.Length - 1));&lt;br/&gt; <br> <font color="#0000FF">if</font> (methods.Any())&lt;br/&gt; <br> {&lt;br/&gt; <br> mi = methods.First();&lt;br/&gt; <br> cachedMethodInfo.Add( <font color="#0000FF">new</font> KeyValuePair&lt; <font color="#0000FF">string</font> , <font color="#0000FF">int</font> &gt;(mi.Name, parts.Length - 1), mi);&lt;br/&gt; <br> }&lt;br/&gt; <br> }&lt;br/&gt; <br> <font color="#0000FF">if</font> (mi != <font color="#0000FF">null</font> )&lt;br/&gt; <br> {&lt;br/&gt; <br> <font color="#0000FF">var</font> pars = mi.GetParameters();&lt;br/&gt; <br> <font color="#0000FF">object</font> [] ps = <font color="#0000FF">new</font> <font color="#0000FF">object</font> [0];&lt;br/&gt; <br> <font color="#0000FF">if</font> (pars.Length == parts.Length - 1)&lt;br/&gt; <br> {&lt;br/&gt; <br> <font color="#006400">// try building a parameter array</font> <br> ps = <font color="#0000FF">new</font> <font color="#0000FF">object</font> [pars.Length];&lt;br/&gt; <br> <font color="#0000FF">for</font> ( <font color="#0000FF">int</font> i = 0; i &lt; pars.Length; i++)&lt;br/&gt; <br> {&lt;br/&gt; <br> <font color="#0000FF">var</font> par = pars[i];&lt;br/&gt; <br> <font color="#0000FF">var</font> source = parts[i + 1];&lt;br/&gt; <br> ps[i] = ConvertString(source, par.ParameterType);&lt;br/&gt; <br> }&lt;br/&gt; <br> }&lt;br/&gt; <br> <font color="#006400">// parameters ready - call it</font> <br> <font color="#0000FF">try</font> { mi.Invoke( <font color="#0000FF">this</font> , ps); }&lt;br/&gt; <br> <font color="#0000FF">catch</font> (Exception ex) { }&lt;br/&gt; <br> }&lt;br/&gt; <br> }&lt;br/&gt; <br></font></code> </blockquote><br>  In a piece of code above, I tried to cache an expensive search for information about the method.  Perhaps there are better solutions, but everything works for me.  This again shows that it is not always necessary to use F # or climb into the DLR to quickly get a small DSL interpreter. <br><br>  That's all I wanted to tell you. <br><br><h3>  Notes </h3><br><ol><li>  <a href="https://habr.com/ru/post/72527/" title="Back to text">‚Üë</a> Here is this footnote number 1 </li></ol></div><p>Source: <a href="https://habr.com/ru/post/72527/">https://habr.com/ru/post/72527/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../72519/index.html">Firefox 3.6 Beta 1 Test Build Available</a></li>
<li><a href="../72520/index.html">IntelliJ IDEA has become open</a></li>
<li><a href="../72523/index.html">Manual watch</a></li>
<li><a href="../72524/index.html">Veridata OptiLite 486S / 50</a></li>
<li><a href="../72525/index.html">Advertisement Identity Theft</a></li>
<li><a href="../72528/index.html">How to remember a large amount of information in a short period of time</a></li>
<li><a href="../72530/index.html">7 steps to systematize the design and development process</a></li>
<li><a href="../72532/index.html">How are you doing there, fish?</a></li>
<li><a href="../72534/index.html">DDoS protection. Is free</a></li>
<li><a href="../72536/index.html">NeoTokyo - New Source Mod</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>