<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>"Bloated code" in commercial software development</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In product development, consistent patterns are used within the team. These are not only well-known design patterns, but also, for example, error-hand...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>"Bloated code" in commercial software development</h1><div class="post__text post__text-html js-mediator-article">  In product development, consistent patterns are used within the team.  These are not only well-known design patterns, but also, for example, error-handling patterns within the system, request and response formats in intersystem interaction, and so on.  Also, in case of individual development, not all chunks that repeat in logic and structure can be wrapped in methods, which also does not contribute to readability and simplicity of the code. <br><br>  With the increase in the number of systems and their size with the slightest change in patterns, it is necessary to refactor a bunch of places to bring the code to a given pattern. <br><br>  After exploring alternative languages ‚Äã‚Äãon jvm, we stopped at clojure.  Here is a small example of implementing an error handling pattern on it. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Suppose we arrange error handling in Java as follows: <br><br><a name="habracut"></a><br><blockquote>  <font color="#000000">try</font> <font color="#009900">{</font> <br>  ... <font color="#006633">work</font> ... <br>  <font color="#009900">}</font> <font color="#000000">catch</font> <font color="#009900">(</font> InternalException e <font color="#009900">)</font> <font color="#009900">{</font> <br>  exceptionHelper.  <font color="#006633">addGroup</font> <font color="#009900">(</font> e, TestTest. <font color="#000000">class</font> . <font color="#006633">getName</font> <font color="#009900">(</font> <font color="#009900">)</font> , <font color="#0000ff">"... error ..."</font> , <br>  <font color="#000000">new</font> Pair <font color="#009900">(</font> <font color="#0000ff">"param1"</font> , param1 <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000000">new</font> Pair <font color="#009900">(</font> <font color="#0000ff">"param2"</font> , param2 <font color="#009900">)</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000000">throw</font> e <font color="#339933">;</font> <br>  <font color="#009900">}</font> <font color="#000000">catch</font> <font color="#009900">(</font> <font color="#003399">Exception</font> e <font color="#009900">)</font> <font color="#009900">{</font> <br>  <font color="#000000">throw</font> exceptionHelper.  <font color="#006633">generate</font> <font color="#009900">(</font> ErrorRef. <font color="#006633">SYSTEM_ERROR</font> , <font color="#0000ff">"... error ..."</font> , <br>  <font color="#000000">new</font> Pair <font color="#009900">(</font> <font color="#0000ff">"param1"</font> , param1 <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000000">new</font> pair <font color="#009900">(</font> <font color="#0000ff">"param2"</font> , param2 <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#000000">new</font> Pair <font color="#009900">(</font> <font color="#0000ff">"exception"</font> , MySerialization. <font color="#006633">exceptionToString</font> <font color="#009900">(</font> e <font color="#009900">)</font> <font color="#009900">)</font> <font color="#009900">)</font> <font color="#339933">;</font> <br>  <font color="#009900">}</font> <br>  <font color="#009900">}</font> </blockquote><br><br>  On <b>clojure</b> , the macro <b>handler-ie</b> was implemented in the corresponding library, which implements the logic of this pattern.  For example, in the <b>middle</b> function, we process the call to the <b>bottom</b> function using this macro: <br><br><blockquote>  <font color="#66cc66">(</font> defn middle <font color="#66cc66">[</font> a b <font color="#66cc66">]</font> <br>  <font color="#66cc66">(</font> ie / handler-ie ie / system-test <font color="#ff0000">"middle level processing"</font> <font color="#b1b100">nil</font> <font color="#66cc66">[</font> a b <font color="#66cc66">]</font> <br>  <font color="#66cc66">(</font> <font color="#b1b100">let</font> <font color="#66cc66">[</font> result <font color="#66cc66">(</font> bottom a b <font color="#66cc66">)</font> <font color="#66cc66">]</font> <br>  result <font color="#66cc66">)</font> <font color="#66cc66">)</font> <font color="#66cc66">)</font> <br></blockquote><br><br>  Let's see what the code of the function body unfolds at compile time: <br><br><blockquote>  <font color="#66cc66">(</font> macroexpand- <font color="#cc66cc">1</font> ' <font color="#66cc66">(</font> ie / handler-ie ie / system-test <font color="#ff0000">"middle level processing"</font> <font color="#b1b100">nil</font> <font color="#66cc66">[</font> a b <font color="#66cc66">]</font> <br>  <font color="#66cc66">(</font> <font color="#b1b100">let</font> <font color="#66cc66">[</font> result <font color="#66cc66">(</font> bottom a b <font color="#66cc66">)</font> <font color="#66cc66">]</font> <br>  result <font color="#66cc66">)</font> <font color="#66cc66">)</font> <font color="#66cc66">)</font> </blockquote><br><br>  Result (auto-variable suffixes and full namespaces are removed for readability): <br><br><blockquote>  <font color="#66cc66">(</font> <font color="#b1b100">let</font> <font color="#66cc66">[</font> params <font color="#66cc66">(</font> <font color="#b1b100">reverse</font> <font color="#66cc66">(</font> zipmap <font color="#66cc66">(</font> map str ' <font color="#66cc66">[</font> a b <font color="#66cc66">]</font> <font color="#66cc66">))</font> <br>  <font color="#66cc66">[</font> a b <font color="#66cc66">]</font> <font color="#66cc66">)</font> <font color="#66cc66">)</font> <br>  error-place <font color="#66cc66">(</font> current-function- <font color="#b1b100">name</font> <font color="#66cc66">)</font> <font color="#66cc66">]</font> <br>  <font color="#66cc66">(</font> try <font color="#66cc66">(</font> <font color="#b1b100">let</font> <font color="#66cc66">[</font> result <font color="#66cc66">(</font> bottom a b <font color="#66cc66">)</font> <font color="#66cc66">]</font> <br>  result <font color="#66cc66">)</font> <br>  <font color="#66cc66">(</font> <font color="#b1b100">catch</font> errors <font color="#66cc66">.</font> entities <font color="#66cc66">.</font> internalexception e <br>  <font color="#66cc66">(</font> add-group-to-ie e error-place <font color="#ff0000">"middle level processing"</font> params <font color="#66cc66">)</font> <br>  <font color="#66cc66">(</font> <font color="#b1b100">throw</font> e <font color="#66cc66">)</font> <font color="#66cc66">)</font> <br>  <font color="#66cc66">(</font> <font color="#b1b100">catch</font> java <font color="#66cc66">.</font> lang <font color="#66cc66">.</font> exception e <br>  <font color="#66cc66">(</font> <font color="#b1b100">let</font> <font color="#66cc66">[</font> error-ref <font color="#66cc66">(</font> error-map <font color="#66cc66">(</font> <font color="#66cc66">.</font> getname <font color="#66cc66">(</font> <font color="#66cc66">.</font> getclass e <font color="#66cc66">)</font> <font color="#66cc66">)</font> <font color="#66cc66">)</font> <br>  error-ref <font color="#66cc66">(</font> <font color="#b1b100">if</font> <font color="#66cc66">(</font> <font color="#b1b100">nil</font> ? error-ref <font color="#66cc66">)</font> <br>  <font color="#66cc66">(</font> make-system-error-ref system-test errorref-system- <font color="#b1b100">error</font> <font color="#66cc66">)</font> <br>  error-ref <font color="#66cc66">)</font> <br>  ie <font color="#66cc66">(</font> make-ie error-ref error-place <font color="#ff0000">"middle level processing"</font> e params <font color="#66cc66">)</font> <font color="#66cc66">]</font> <br>  <font color="#66cc66">(</font> <font color="#b1b100">throw</font> ie <font color="#66cc66">)</font> <font color="#66cc66">)</font> <font color="#66cc66">)</font> <font color="#66cc66">)</font> <font color="#66cc66">)</font> </blockquote><br><br>  It can be seen that the resulting code is a parameterized version of the Java version.  Also, the advantage of the clojure version is that if you change the implementation of the error handling logic, I will not have to change the source code of the projects where this processing is used.  It will be enough just to reassemble the corresponding project. <br><br>  At the moment, we use macros to handle errors, generate intersystem responses and within our eDSL for working with the database.  So  All the repeated patterns in our projects have become just an extension of the language. <br><br>  After switching to Lisp, the size of the source code has decreased by orders of magnitude.  This is not only due to macros, but also because of the ability to write in a functional style using convenient universal clojure data structures, high-order functions and closures.  At the same time, the possibility of working with clojure libraries, java and j2ee frameworks was not lost.  And most importantly, now only the programmer can be the only reason for bydlokod. <br><br><h4>  Library example </h4><br><br>  <b>Source Code:</b> <br><br><blockquote>  <font color="#66cc66">(</font> defn bottom <font color="#66cc66">[</font> a b <font color="#66cc66">]</font> <br>  <font color="#66cc66">(</font> ie / handler-ie ie / system-test <font color="#ff0000">"low level operation"</font> <br>  <font color="#66cc66">{</font> <font color="#ff0000">"java.lang.ArithmeticException"</font> TestSystemEM $ ErrorRef / BAD_ARGS <font color="#66cc66">}</font> <br>  <font color="#66cc66">[</font> a b <font color="#66cc66">]</font> <br>  <font color="#66cc66">(</font> <font color="#b1b100">let</font> <font color="#66cc66">[</font> result <font color="#66cc66">(</font> / a b <font color="#66cc66">)</font> <font color="#66cc66">]</font> <br>  result <font color="#66cc66">)</font> <font color="#66cc66">)</font> <font color="#66cc66">)</font> <br><br>  <font color="#66cc66">(</font> defn middle <font color="#66cc66">[</font> a b <font color="#66cc66">]</font> <br>  <font color="#66cc66">(</font> ie / handler-ie ie / system-test <font color="#ff0000">"middle level processing"</font> <font color="#b1b100">nil</font> <font color="#66cc66">[</font> a b <font color="#66cc66">]</font> <br>  <font color="#66cc66">(</font> <font color="#b1b100">let</font> <font color="#66cc66">[</font> result <font color="#66cc66">(</font> bottom a b <font color="#66cc66">)</font> <font color="#66cc66">]</font> <br>  result <font color="#66cc66">)</font> <font color="#66cc66">)</font> <font color="#66cc66">)</font> <br><br>  <font color="#66cc66">(</font> defn tester <font color="#66cc66">[</font> a b <font color="#66cc66">]</font> <br>  <font color="#66cc66">(</font> <font color="#b1b100">let</font> <font color="#66cc66">[</font> c <font color="#66cc66">(</font> + a b <font color="#66cc66">)</font> <font color="#66cc66">]</font> <br>  <font color="#66cc66">(</font> ie / handler-ie ie / system-test <font color="#ff0000">"public interface action"</font> <font color="#b1b100">nil</font> <font color="#66cc66">[</font> a b c <font color="#66cc66">]</font> <br>  <font color="#66cc66">(</font> <font color="#b1b100">let</font> <font color="#66cc66">[</font> result <font color="#66cc66">(</font> middle a b <font color="#66cc66">)</font> <font color="#66cc66">]</font> <br>  result <font color="#66cc66">)</font> <font color="#66cc66">)</font> <font color="#66cc66">)</font> <font color="#66cc66">)</font> <br></blockquote><br><br>  <b>Result without exception:</b> <br><br><blockquote>  user <font color="#66cc66">&gt;</font> <font color="#66cc66">(</font> try <font color="#66cc66">(</font> tester <font color="#cc66cc">1</font> <font color="#cc66cc">2</font> <font color="#66cc66">)</font> <br>  <font color="#66cc66">(</font> <font color="#b1b100">catch</font> InternalException e <br>  <font color="#66cc66">(</font> println <font color="#66cc66">(</font> ie / human-readable-ie e <font color="#66cc66">)</font> <font color="#66cc66">)</font> <font color="#66cc66">)</font> <font color="#66cc66">)</font> <br><br>  <font color="#cc66cc">1/2</font> <br></blockquote><br><br>  <b>With exception:</b> <br><br><blockquote>  user <font color="#66cc66">&gt;</font> <font color="#66cc66">(</font> try <font color="#66cc66">(</font> tester <font color="#cc66cc">1</font> <font color="#cc66cc">0</font> <font color="#66cc66">)</font> <br>  <font color="#66cc66">(</font> <font color="#b1b100">catch</font> InternalException e <br>  <font color="#66cc66">(</font> println <font color="#66cc66">(</font> ie / human-readable-ie e <font color="#66cc66">)</font> <font color="#66cc66">)</font> <font color="#66cc66">)</font> <font color="#66cc66">)</font> <br><br>  ErrorRef: BAD_ARGS <br>  Group parameters: <br>  className: libs.error.example $ tester <br>  message: public interface action <br>  parameters: <br>  name: a, value: &lt;int&gt; 1 &lt;/ int&gt; <br>  name: b, value: &lt;int&gt; 0 &lt;/ int&gt; <br>  name: c, value: &lt;int&gt; 1 &lt;/ int&gt; <br>  Group parameters: <br>  className: libs.error.example $ middle <br>  message: middle level processing <br>  parameters: <br>  name: a, value: &lt;int&gt; 1 &lt;/ int&gt; <br>  name: b, value: &lt;int&gt; 0 &lt;/ int&gt; <br>  Group parameters: <br>  className: libs.error.example $ bottom <br>  message: low level operation <br>  parameters: <br>  name: b, value: &lt;int&gt; 0 &lt;/ int&gt; <br>  name: a, value: &lt;int&gt; 1 &lt;/ int&gt; <br>  name: Exception, value: &lt;java.lang.String&gt; Error message: Divide by zero <br>  java.lang.ArithmeticException: Divide by zero <br>  at clojure.lang.Numbers.divide (Numbers.java:138) <br>  at libs.error.example $ bottom.invoke (example.clj: 12) <br>  at libs.error.example $ middle.invoke (example.clj: 17) <br>  at libs.error.example $ tester.invoke (example.clj: 23) <br>  ... <br>  &lt;/java.lang.String&gt; <br></blockquote></div><p>Source: <a href="https://habr.com/ru/post/130323/">https://habr.com/ru/post/130323/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../130317/index.html">Mobile and tablet future of Flash looks less and less radiant</a></li>
<li><a href="../130318/index.html">Memory barriers and non-blocking synchronization in .NET</a></li>
<li><a href="../130319/index.html">Background upload lists</a></li>
<li><a href="../130320/index.html">Configuring Replication in SQL 2008</a></li>
<li><a href="../130321/index.html">We're saving ourselves from the paper flood, or how to spend the International Day without paper.</a></li>
<li><a href="../130325/index.html">9 rules how to protect your Asterisk!</a></li>
<li><a href="../130326/index.html">Developing games with Intel: autumn webinar series</a></li>
<li><a href="../130327/index.html">Centralized deployment of Microsoft Word settings through Group Policy</a></li>
<li><a href="../130329/index.html">GDD 2011: Developer Impressions</a></li>
<li><a href="../130330/index.html">Unix-way reminder</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>