<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Booting Windows 7 from VHD Image</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Last time, we created a VHD image with Window 7 for Virtual PC . It is clear that in a virtual environment, of course, there are advantages, but never...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Booting Windows 7 from VHD Image</h1><div class="post__text post__text-html js-mediator-article">  Last time, we <a href="http://kichik.habrahabr.ru/blog/49635/">created a VHD image with Window 7 for Virtual PC</a> .  It is clear that in a virtual environment, of course, there are advantages, but nevertheless, I would like everything to work more brightly ... <br><br>  In the case of Window 7, I would also like to see it in all its glory, at least with the aero-interface running. <br><br>  Next, we will discuss how to boot from the resulting VHD image along with the installed base system.  That is, to work with the system, you do not need a separate partition and you will not need to demolish the existing system, Win 7 will still be stored inside the VHD file, but at the same time it will be running in a real environment. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br><br>  <em>Note: this method, by default, works in Windows 7 and Windows Server 2008 R2, I will tell you how to make it work on Vista (see clause 1).</em> <br><br><br><br>  0. If you have a virtual image (.vhd file) created as an image with a dynamic size, have lunch that you have free space in the system in the maximum size for this image. <br><br>  1. First of all, we need two files: bootmgr (a new boot manager that can boot from VHD) and bcdedit.exe (a new version of the program for editing boot records). <br><br>  The first one can be taken from the installation disk, the second one can be taken from the installed Windows 7 system (for example, it can be pulled out from the VHD-image in hand).  Or you can just download <a href="">from here (skydrive)</a> :) <br><br>  Next, you will have to <strong>rewrite the</strong> file <strong>c: \ bootmgr</strong> .  File <strong>c: \ windows \ system32 \ bcdedit.exe</strong> , in principle, you can not overwrite (just run from another location).  Just in case, I recommend to keep the old versions. <br><br><br><br>  <em>Note: for rewriting, you may need full ownership rights to the files.</em> <br><br><br><br>  2. Open the console (cmd) with admin rights, just in case, make a copy of the current records and simultaneously create a new record: <br><br>  <strong>bcdedit / copy {current} / d ‚ÄúWindows 7‚Äù</strong> <br><br>  The command will return the GUID of the newly created entry. <br><br>  3. Next, you need to register the address with the VHD-disk to download <br><br>  <strong>bcdedit / set {GUID} device vhd = [c:] \ vhd \ win7b.vhd</strong> <br><br>  <strong>bcdedit / set {GUID} osdevice vhd = [c:] \ vhd \ win7b.vhd</strong> <br><br>  4. If you want the added system to be the last in the OS list at boot time, you need to run the following command <br><br>  <strong>bcdedit / displayorder {GUID} / addlast</strong> <br><br>  The record with the corresponding GUID is transferred to the end (in this way, any desired order can be achieved). <br><br>  5. If you want to change the system name when booting, you need to run the following command <br><br>  <strong>bcdedit / set {GUID} description ‚ÄúWindows 7 - VHD‚Äù</strong> <br><br>  6. To force automatic detection in Windows of a disk through the appropriate level of abstraction - Hardware Abstraction Layer ‚Äî the following command should be executed <br><br>  <strong>bcdedit / set &lt;guid&gt; detecthal on</strong> <br><br>  Done!  You can reboot.  After booting, Windows 7 will start installing the necessary drivers for your real hardware.  Ask to reboot.  After that, you can work normally.  With Aero! <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/002/871/2b1/0028712b1a719f52c259d39f12576a37.png"><br><img src="https://habrastorage.org/getpro/geektimes/post_images/bb9/729/30b/bb972930be4726971194bbca2feaa258.png"><br><br>  If you look at the disks present in the system, you will see that in addition to the 16 GB virtual disk (circled in orange), from which Win7 is actually loaded, there is also a second section of the 200 MB virtual disk for system files and a real (!) Hard disk drive. disk installed on the computer. <br><br> <a href="http://img-fotki.yandex.ru/get/3002/kichinsky.3/0_1f06b_f676bb20_orig"><img src="https://habrastorage.org/getpro/geektimes/post_images/3f5/636/e29/3f5636e2997fb67e713a9a1bc58d4b92.png"></a> <br><br>  If you open a real disk and see where the file with the image of the system <br><br> <a href="http://img-fotki.yandex.ru/get/3200/kichinsky.3/0_1f06c_9b76e178_orig"><img src="https://habrastorage.org/getpro/geektimes/post_images/1d4/841/2d6/1d48412d65309e75863ae789c57e4c25.png"></a> <br><br>  You may find that the file size has increased to 16 GB.  The fact is that our VHD-image was automatically converted into an image with a fixed size, that is, it took the maximum possible 16 GB.  It speeds up the system. <br><br>  It is also worth noting that this image can still be downloaded via Virtual PC. </div><p>Source: <a href="https://habr.com/ru/post/49670/">https://habr.com/ru/post/49670/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../49660/index.html">How to make friends with Java and C ++. Part one</a></li>
<li><a href="../49662/index.html">95% of all downloaded music from the Internet - pirated</a></li>
<li><a href="../49664/index.html">The easiest way to learn how to type blindly</a></li>
<li><a href="../49665/index.html">Sendmail stub for linux</a></li>
<li><a href="../49668/index.html">Arrange tree comments to articles using JavaScript</a></li>
<li><a href="../49671/index.html">We master Python. Ounce 1. Types of data.</a></li>
<li><a href="../49672/index.html">With a flick, the sneakers are turning ... are turning ...</a></li>
<li><a href="../49674/index.html">Make Start Page in Firefox</a></li>
<li><a href="../49675/index.html">What is NetBSD?</a></li>
<li><a href="../49676/index.html">Rutsentr lies?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>