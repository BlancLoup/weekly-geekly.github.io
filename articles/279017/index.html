<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Bitrix, HMVC and a bit of nonsense ...</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! Surely many people know what CMS Bitrix is, what it is and what kind of ‚Äúwonderful‚Äù code and architectural solutions its developers represent. ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Bitrix, HMVC and a bit of nonsense ...</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/046/202/951/046202951f794be893ccb06504a897be.gif"><br><br>  Hello!  Surely many people know what CMS Bitrix is, what it is and what kind of ‚Äúwonderful‚Äù code and architectural solutions its developers represent.  In this post I would like to offer a new vision for the development of components and modules of the system. <a name="habracut"></a><br><br><h4>  HMVC </h4><br>  Before explaining what these 4 letters are, let me remind you what the last three mean: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/907/fce/6ec/907fce6ecf3f4509a90dfd663630bf4f.png" alt="image"><br><br>  MVC itself is a design pattern that divides the system into three parts: <br><br><ul><li>  <b>Model</b> - business logic; </li><li>  <b>Controller</b> - control / interaction logic; </li><li>  <b>Presentation</b> - UI. </li></ul><br>  The advantages of this template are that if it is <strong>normally</strong> implemented, then the business logic is completely independent of <strong>C</strong> and <strong>V.</strong>  Who needs the details and who for some reason still does not know what it is - go ahead to google. <br><br>  It seems to be all right, MVC is almost a panacea (this is the kind of thing that solves all the problems), but if the system is large enough, then it will inevitably become more complicated and as a result (or cause) problems of scaling arise.  Here a good friend comes to the rescue: <strong>H - Hierarchical</strong> . <br><br><img src="https://habrastorage.org/files/92c/3e1/a08/92c3e1a088d14a4ebb8952cbb785f800.png"><br><br>  The main idea of ‚Äã‚Äãthis template is that the whole system is divided into separate, independent triads (MVC's), which communicate with each other through controllers.  Thus, business logic is still isolated from the outside world, and in fact the system spontaneously splits into small parts, and this is much more convenient and easier for spaghetti-dependencies that will inevitably arise in a large system. <br><br>  Triad communication occurs by querying the controllers.  The following types of requests can be distinguished: <br><br><ul><li>  <strong>external request</strong> - creating a request to another server (divine distribution); </li><li>  <strong>internal request</strong> - creating a request to the current server; </li><li>  <strong>a function call</strong> is simply a call to the controller's action from the code, without additional request to the server. </li></ul><br><h4>  Bitrix and his cockroaches </h4><br>  <strong>Bitrix</strong> is a highly advertised and extremely unfriendly management system for a developer.  But in fact this is not the case, so let's get down to business. <br><br>  According to the authors, this system implements the MVC pattern.  It looks like this: <br><br><img src="https://habrastorage.org/files/7b3/d1c/d36/7b3d1cd36d6340a5a8831d0301820f71.png"><br><br>  Um ... seriously?  The model is located in <strong>another structural part of the</strong> system, separately from the controller and the presentation.  Separately, Carl !!! <br><br>  In fact, this is quite a good move, because  the whole system is based on components and each of them can pull any model, any module, and to be exact a specific model - information blocks.  But as for me from the point of view of MVC, this is wrong, the controllers are overloaded with logic (at least if you look at the implementation of standard components). <br><br><h4>  Bitrix  Models </h4><br>  <strong>Information blocks</strong> - this is a very convenient and flexible solution for storing information, you can not argue and ignore this tool - it's silly.  For clarity, the structure of the system in general can be represented as: <br><br><img src="https://habrastorage.org/files/54c/cea/f57/54cceaf57bc14518bea32c4e89e910df.png"><br><br>  Looking at this picture, we can conclude that the decision to separate the model is pretty damn wonderful.  But in this case there is a lot of logic in the controllers (components), and models (API) are just a <strong>domain model</strong> , and they do not contain any logic. <br><br><h4>  Bitrix  Controllers </h4><br>  Bitrix assures us that the components play the role of controllers, but I do not agree with that. <br><br>  <strong>Components</strong> are widgets: they receive input data and in some way convert them. <br><br>  <strong>Complex components</strong> are controllers (more precisely, front controllers): they take the user's request as input, parse it and initiate the requested action.  Schematically, this can be expressed as: <br><br><img src="https://habrastorage.org/files/cfb/4e2/db6/cfb4e2db649f4d8f9a616e0a8e29ba19.png"><br><br><h4>  Bitrix  HMVC </h4><br>  We got acquainted with the bitrix about MVC, now let's consider the options for communication between the controllers (components) with each other. <br><br>  As the documentation advises us: components can be communicated either through global variables or through events.  In fact, these are tips on cooperation of the modules, but strictly speaking, they are also applicable to the components, only they do not quite fit: <br><br><ul><li>  <strong>global variables</strong> - implicit data transfer; </li><li>  <strong>events</strong> - generally past the box office. </li></ul><br>  So, in my opinion, the transfer of parameters by reference is optimal: <br><br><pre><code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?</span></span> $APPLICATION-&gt;IncludeComponent(<span class="hljs-string"><span class="hljs-string">'comp1'</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>,[&amp; $params]); $APPLICATION-&gt;IncludeComponent(<span class="hljs-string"><span class="hljs-string">'comp2'</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>,[$params]); <span class="hljs-comment"><span class="hljs-comment">//        $APPLICATION-&gt;IncludeComponent('comp1','',['request' =&gt; $req, 'response' =&gt; &amp; $res]); $APPLICATION-&gt;IncludeComponent('comp2','',[$res]); </span><span class="hljs-meta"><span class="hljs-comment"><span class="hljs-meta">?&gt;</span></span></span></span></code> </pre> <br>  Everything is transparent and understandable where and when it comes. <br><br>  It seems to be all, but no.  Each individual component (not complex) must be a separate MVC triad, and this is strictly not.  <b>Service layer</b> comes to the rescue: <br><br><img src="https://habrastorage.org/files/7cf/df1/108/7cfdf1108566415391bdbf12acafcfb9.png"><br><br>  Due to this structure, each component (not complex) has its own model (service layer), with the necessary business logic, which in turn refers to the API (domain model) to work with the database. <br><br><h4>  A little nonsense </h4><br>  Of course, it would be possible to finish the article with the paragraph above, but my emotions rush out, so I cannot be silent.  I am very amused by the fact that all bitrixsoids, regardless of their level of professionalism, shout in one voice ‚Äúuse everything out of the box, if this is not in the box, do not use the bitrix at all!‚Äù.  The question is "Why then the marketplace?", But oh well. <br><br>  Are you guys serious?  Are you a developer or what?  I understand that Bitrix is ‚Äã‚Äãa certain constructor (guess whose opinion is this) in which there is A <b>LOT of</b> what it is, but just a moment: a lot is <b>NOT ALL</b> .  And I feel sad when Bitrixoids say they use standard modules and on the basis of them do something. <br><br>  I do not call to rewrite all modules and sculpt a bunch of bicycles (although the marketplace is replete with them).  Of course, it‚Äôs worthwhile to write a pair of bicycles to upgrade a skill, but from standard modules you can take only an API and no more, because in real life I haven‚Äôt seen worse govnokod, but this is Bitrix, there's nothing to be done about it. </div><p>Source: <a href="https://habr.com/ru/post/279017/">https://habr.com/ru/post/279017/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../278997/index.html">Release Webix 3.2. New widgets for working with data and other features</a></li>
<li><a href="../278999/index.html">Thorny road to sales on Themeforest.net - Part 1</a></li>
<li><a href="../279005/index.html">Creating reports in PowerShell</a></li>
<li><a href="../279007/index.html">Crutch for the signal-slot system in Qt</a></li>
<li><a href="../279011/index.html">Update DataGrid after DELETE (WPF)</a></li>
<li><a href="../279019/index.html">Emoji appeared on Github: reactions to pull requests, bugs and comments</a></li>
<li><a href="../279021/index.html">Experiment: Using Google Trends to predict stock market crashes</a></li>
<li><a href="../279023/index.html">CI DIY for Unity3D</a></li>
<li><a href="../279025/index.html">Parametric identification of a linear dynamic system</a></li>
<li><a href="../279029/index.html">Universal reusable data forms. Cooking and serving recipes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>