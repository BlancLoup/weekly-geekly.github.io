<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Dissecting .xlsx files: editing a file with PL / SQL</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Part 1 . Introduction, styles 
 Part 2 . Lines, markup 
 Part 3 Editing through PL / SQL 

 Good day. The third part of the conversation about the for...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Dissecting .xlsx files: editing a file with PL / SQL</h1><div class="post__text post__text-html js-mediator-article">  <a href="https://habrahabr.ru/post/347550/">Part 1</a> .  Introduction, styles <br>  <a href="https://habrahabr.ru/post/347616/">Part 2</a> .  Lines, markup <br>  <b>Part 3</b>  Editing through PL / SQL <br><br>  Good day.  The third part of the conversation about the format XLSX arrived.  I did not accidentally start from the internal device file.  Not understanding where everything is and what it looks like, it is difficult to understand why I did this and that.  Besides, now I can make a few comments: <br><br>  <i>The first.</i>  If I have not mentioned any element that you need, create an empty XLSX file, create the necessary element and save.  Now you know where to look for the code defining this element. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <i>The second.</i>  OpenXML allows arbitrary text in the markup, if it does not violate the structure of tags (we will use this very actively).  Now illustrate.  You can do this: <br><a name="habracut"></a><br><pre><code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">sst</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.openxmlformats.org/spreadsheetml/2006/main"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">si</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">t</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">t</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">si</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">si</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">t</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">t</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">si</span></span></span><span class="hljs-tag">&gt;</span></span> $  $ <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">sst</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  And so - you can not: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">sst</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.openxmlformats.org/spreadsheetml/2006/main"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">si</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">t</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">t</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">si</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">si</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">t</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">t</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">si</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name"></span></span></span><span class="hljs-tag">  &gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">sst</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  But to the point.  Strictly speaking, there are two possible cases.  Either we have a certain template that we need to fill in with data, or we ourselves have to create a file, which is called, from scratch.  The first case is simpler, the second is more interesting.  But at the same time, both cases require us to have a blank file: since the .XLSX file consists not only of .XML files, creating it with your own hands, alas, will not work. <br><br>  In general, the methodology I use is largely based on the <a href="https://github.com/mortenbra/alexandria-plsql-utils">Alexandria PL / SQL</a> library.  The library itself is huge, and if except for the purposes described below, you do not need it, then it is better to implant it selectively. <br><br>  For a simple substitution in the receipt form of the full name of the subscriber of the funds represented in this library, it should be enough.  I, in view of my specifics, had to make an add-on over it.  Therefore, if you started reading, I recommend reading it to the end: how to know, maybe my solution will seem more convenient or effective to you.  The general algorithm of actions is as follows: <br><br><ol><li>  We transform the blank file into BLOB; </li><li>  Replace the conditional tags in the XML files inside it with our data; </li><li>  Save the modified BLOB as a new file; </li><li>  We return the modified file to the user. </li></ol><br>  Go through these items in more detail.  To distinguish between library tools and self-written ones, let‚Äôs imagine that I placed the library code in the speculative package <i>lib_utils</i> . <br><br><h3>  Transformation of the blank file to BLOB </h3><br>  If we have some form available, for example, a receipt, in which the subscriber‚Äôs name and amount must be inserted, then everything is easier: we take a ready-made receipt and change the contents of the variable fields to special beacons.  There are two basic rules about the text of these beacons - they should not imitate tags and the probability of coincidence in the source text of the document or in the replacement text should be vanishingly small.  Otherwise, it all depends on your imagination or habits.  I use something like <i>% name%</i> .  I will explain why.  The sign "%" does not imitate markup, and the probability that there will be a word somewhere, isolated from this side by this sign, is scanty. <br><br>  But in the case when we do not know in advance what could be in the output file, there will be more work. <br><br>  First of all, I recommend Excel exploration and designate all the cell styles that we might need (if you don‚Äôt need it, it's okay, it's better than if something is not enough).  After that, we cut a notebook into the styles and write down the indices of specific styles.  So, I made myself a separate style for the heading (gray fill, bold spelling and thin borders) and a separate style for an ordinary line (no fill, regular writing and thin borders). <br><br>  Then you will have to work not through Excel, but with your hands <br><br>  The <b>sharedStrings.xml</b> file should look something like this: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">sst</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.openxmlformats.org/spreadsheetml/2006/main"</span></span></span><span class="hljs-tag">&gt;</span></span> %strings% <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">sst</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  The <b>sheet1.xml</b> file (assuming that we have the first sheet) should contain the following: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">sheetViews</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">sheetView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">tabSelected</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">workbookViewId</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag">&gt;</span></span> %attach% <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">sheetView</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">sheetViews</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">sheetFormatPr</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">defaultRowHeight</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"15"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">x14ac:dyDescent</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.25"</span></span></span><span class="hljs-tag">/&gt;</span></span> %colsize% <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">sheetData</span></span></span><span class="hljs-tag">&gt;</span></span> %data% <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">sheetData</span></span></span><span class="hljs-tag">&gt;</span></span> %filter%</code> </pre><br>  The <i>% attach%</i> label is located where the region's attachment tag should be.  The <i>% colsize%</i> label is where the tag is located, indicating the width of the occupied columns.  This was done so that, say, in the column name the width was appropriate.  The <i>% data%</i> label will be replaced with the generated cell markup.  Label <i>% filter%</i> - in case you need to build an autofilter. <br><br>  Save, close - the disc is ready.  Next, we need to transform it into a BLOB.  To do this, we need the library function <b>lib_utils.get_blob_from_file</b> (just in case I remind you that lib_utils is a function from the library by reference at the beginning of the post).  The function takes two parameters: directory and file name.  Since this is a bit unobvious, I will explain that the directory means the object DIRECTORY.  In our example we will name the directory <i>FILE_DIR</i> .  That is, the call will look something like this: <br><br><pre> <code class="sql hljs"><span class="hljs-comment"><span class="hljs-comment">--  ,         -  v_blobsrc := lib_utils.get_blob_from_file('FILE_DIR', 'src_blank.xlsx');</span></span></code> </pre><br><h3>  Replacing tags with custom data </h3><br>  In a simpler case with a receipt form (or a similar case), simply use the function <b>lib_utils.multi_replace</b> .  The library will do everything for you. <br><br>  For a difficult case, I built my design.  It is based on a composite handwritten data type, which is a comprehensive description of the contents of an Excel sheet.  Since the type is composite, let's go from bottom to top: <br><br><pre> <code class="sql hljs"><span class="hljs-comment"><span class="hljs-comment">/* :  */</span></span> type tp_cell is record(address varchar2(15), style number, val varchar2(4000), lines number default 1); <span class="hljs-comment"><span class="hljs-comment">/* :  */</span></span> type tp_row is table of tp_cell index by binary_integer; <span class="hljs-comment"><span class="hljs-comment">/* :  () */</span></span> type tp_table is table of tp_row index by binary_integer; <span class="hljs-comment"><span class="hljs-comment">/* :      */</span></span> type tp_string is table of varchar2(4000) index by binary_integer; type tp_number is table of number index by binary_integer;</code> </pre><br>  The latter type is not directly involved in the construction of the <i>tp_table</i> , but it will still be needed later.  Let me explain the elements of type <i>tp_cell</i> . <br><br><ul><li>  <b>address</b> is the actual cell address.  Here it is necessary to clarify something.  In the comments to the previous post, the results of experiments are laid out, showing that it is not necessary to enter the address when describing a cell.  This is true.  However, in my opinion, the explicit, as a rule, is better than the implicit. </li><li>  <b>style</b> - reference to the style index of the cell being described.  I decided for myself that all the styles I described will be stored as global constants of the <i>custom_utils</i> package. </li><li>  <b>val</b> - the contents of the cell. </li><li>  <b>lines</b> is a multi-line flag.  Setting its value to 2 or higher will mean that the contents of the cell imply the transfer, and as we remember, to display it you should increase the height of the cell. </li></ul><br>  The final signature of my file layout procedure looks like this: <br><br><pre> <code class="sql hljs">file_build(i_content tp_table, i_filename varchar2, i_filter number default 0, i_attach number default 0);</code> </pre><br>  The procedure takes the following parameters: <br><br><ul><li>  <b>i_content</b> - the contents of the future file. </li><li>  <b>i_filename</b> is the name of the future file. </li><li>  <b>i_filter</b> - checkbox for <b>auto filter</b> </li><li>  <b>i_attach</b> - checkbox of the need to fix the area  Since in my case only the first line needs to be fixed, my code generated by this flag will always be the same. </li></ul><br>  And before starting a detailed analysis of the main procedure, I will lay out auxiliary functions: <br><br><div class="spoiler">  <b class="spoiler_title">Secondary functions</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-comment"><span class="hljs-comment">/*     (  Excel) */</span></span> function get_literal(i_number number) return varchar2 is <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-comment"><span class="hljs-comment">--    if i_number &lt; 1 or is_number(i_number) = false then return '#'; -- 1-  elsif i_number &gt; 0 and i_number &lt; 29 then return chr(64 + i_number); -- 2-  else return chr(64 + trunc(i_number / 28))||chr(64 + (i_number - (28 * trunc(i_number / 28)))); end if; end get_literal; /* :    */ function is_number(i_char char) return boolean is begin if (to_number(i_char) = to_number(i_char)) then return true; end if; exception when others then return false; end is_number; /*     */ function array_search(i_source tp_string, i_value varchar2) return number is begin for i in 1 .. i_source.count loop if i_value = i_source(i) then return i; end if; end loop; return -1; end array_search; /*  ""  ( 32767 )   CLOB-    */ procedure clob_append(i_dest in out clob, i_src in varchar2, i_encode in varchar2 default 'utf8') is begin if i_src is not null then if i_dest is null then i_dest := to_clob(convert(i_src, i_encode)); else dbms_lob.write(i_dest, length(convert(i_src, i_encode)), length(i_dest) + 1, convert(i_src, i_encode)); end if; end if; end clob_append;</span></span></code> </pre><br></div></div><br>  Just want to explain something.  Since there may be a lot of data in the file, it is impossible to work with varchar-like types, they simply are not enough.  Therefore you have to sharpen your decision under CLOB.  In general, so far nothing supernatural.  But - to the point. <br><br><div class="spoiler">  <b class="spoiler_title">Basic procedure</b> <div class="spoiler_text"><pre> <code class="sql hljs">procedure build_file(i_content tp_table, i_filename varchar2, i_filter number default 0, i_attach number default 0) is v_blobsrc blob; <span class="hljs-comment"><span class="hljs-comment">--    BLOB v_blobres blob; --    BLOB c_namesrc constant varchar2(50) := 'src_blank.xlsx'; --  - v_stringarr tp_string; --     v_numarr tp_number; --    v_index number; --     v_clobmarkup clob; --   v_clobstring clob; --  sharedStrings.xml v_clobcolumns clob; --    c_letsize constant number := 3; --  1   .. c_padding constant number := 1; --    v_rowcount number; --  -  v_colcount number; --  -  v_multiline number; --  v_filtertag varchar2(50); --    v_attachtag varchar2(150); --     begin /*      */ for l_row in 1 .. i_content.count loop v_rowcount := l_row; --   DIMENSION /* ,      .  ,         */ v_multiline := 1; for l_col in 1 .. i_content(l_row).count loop if i_content(l_row)(l_col).lines &gt; v_multiline then v_multiline := i_content(l_row)(l_col).lines; end if; end loop; clob_append(v_clobmarkup, '&lt;row r="'||l_row||'"'||case when v_multiline &gt; 1 then ' ht="'||(15 * v_multiline)||'" customHeight="1"' else null end||'&gt;'||chr(10)); /*      */ for l_cells in 1 .. i_content(l_row).count loop v_colcount := l_cells; --   if i_content(l_row)(l_cells).val is null then clob_append(v_clobmarkup, '&lt;cr="'||i_content(l_row)(l_cells).address||'" s="'||i_content(l_row)(l_cells).style||'"&gt;&lt;v&gt;&lt;/v&gt;&lt;/c&gt;'||chr(10)); else --      if is_number(i_content(l_row)(l_cells).val) then clob_append(v_clobmarkup, '&lt;cr="'||i_content(l_row)(l_cells).address||'" s="'||i_content(l_row)(l_cells).style||'"&gt;&lt;v&gt;'||i_content(l_row)(l_cells).val||'&lt;/v&gt;&lt;/c&gt;'||chr(10)); else /*   : "-1" -  ,          */ v_index := array_search(v_stringarr, i_content(l_row)(l_cells).val); if v_index = -1 then v_index := v_stringarr.count + 1; v_stringarr(v_index) := i_content(l_row)(l_cells).val; end if; -- --         clob_append(v_clobmarkup, '&lt;cr="'||i_content(l_row)(l_cells).address||'" s="'||i_content(l_row)(l_cells).style||'" t="s"&gt;&lt;v&gt;'||(v_index - 1)||'&lt;/v&gt;&lt;/c&gt;'||chr(10)); end if; end if; /*          */ if v_numarr.count &gt;= l_cells then if length(i_content(l_row)(l_cells).val) &gt; v_numarr(l_cells) then v_numarr(l_cells) := length(i_content(l_row)(l_cells).val); end if; elsif v_numarr.count = l_cells - 1 then v_numarr(l_cells) := length(i_content(l_row)(l_cells).val); end if; end loop; --    clob_append(v_clobmarkup, chr(10)||'&lt;/row&gt;'); end loop; --     clob_append(v_clobcolumns, '&lt;cols&gt;'); for l_cnt in 1 .. v_numarr.count loop clob_append(v_clobcolumns, '&lt;col min="'||l_cnt||'" max="'||l_cnt||'" width="'||round((v_numarr(l_cnt) * c_letsize / 2) + c_padding)||'" style="1" customWidth="1"/&gt;'); end loop; clob_append(v_clobcolumns, '&lt;/cols&gt;'); --     for l_cnt in 1 .. v_stringarr.count loop clob_append(v_clobstring, '&lt;si&gt;&lt;t&gt;'||v_stringarr(l_cnt)||'&lt;/t&gt;&lt;/si&gt;'||chr(10)); end loop; /*    -   */ if i_filter = 1 then v_filtertag := '&lt;autoFilter ref="A1:'||get_literal(v_colcount)||'1"/&gt;'; end if; if i_attach = 1 then v_attachtag := '&lt;pane ySplit="1" topLeftCell="A2" activePane="bottomLeft" state="frozen"/&gt;'; end if; --  v_blobsrc := lib_utils.get_blob_from_file('FILE_DIR', c_namesrc); v_blobres := lib_utils.get_file_from_template(v_blobsrc, lib_utils.t_str_array('%colsize%', '%data%', '%strings%', '%filter%', '%attach%', '&lt;dimension ref="A1:B2"/&gt;'), lib_utils.t_str_array(v_clobcolumns, v_clobmarkup, v_clobstring, v_filtertag, v_attachtag, '&lt;dimension ref="A1:'||get_literal(v_colcount)||v_rowcount||'"/&gt;')); lib_utils.save_blob_to_file('FILE_DIR', i_filename, v_blobres); exception when others then dbms_output.put_line('    Excel: '||sqlerrm); end build_file;</span></span></code> </pre><br></div></div><br>  Actually, everything.  Well, yes, I want to make a reservation: this procedure is periodically supplemented in accordance with current needs. </div><p>Source: <a href="https://habr.com/ru/post/348450/">https://habr.com/ru/post/348450/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../348440/index.html">How to hold a tender for the development of the site</a></li>
<li><a href="../348442/index.html">Raiffeisenbank begins the second set of Java school</a></li>
<li><a href="../348444/index.html">Best UX - no UI at all</a></li>
<li><a href="../348446/index.html">Mobio Talks with Boris Golikov (YouDrive) about business, Yandex. Drive, car sharing and competition</a></li>
<li><a href="../348448/index.html">Web Apps: fast, cheap, cool</a></li>
<li><a href="../348452/index.html">The man who with the Quantum "on you"</a></li>
<li><a href="../348454/index.html">How is the advanced protection against DDoS in Selectel</a></li>
<li><a href="../348458/index.html">Freeswitch: the path of least resistance</a></li>
<li><a href="../348460/index.html">Subtleties of the value restriction in F #</a></li>
<li><a href="../348462/index.html">Consilium in the smartphone: about the MegaFon.Health service and the development of telemedicine</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>