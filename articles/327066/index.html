<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Results of the second round of the Russian Code Cup 2017</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="On April 16, the second qualifying round of the Russian Code Cup 2017 was held , at which attendance records for the last three years were broken. By ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Results of the second round of the Russian Code Cup 2017</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://hsto.org/files/4f8/bf2/28b/4f8bf228b3c24a59a4ede02dc470e237.jpg" alt="image"></p><br><p>  On April 16, the second qualifying round of the <a href="http://www.russiancodecup.ru/ru/">Russian Code Cup 2017 was held</a> , at which attendance records for the last three years were broken.  By tradition, we brag a little bit of the results and lay out the analysis of tasks. </p><br><p>  A. <a href="https://habrahabr.ru/company/mailru/blog/327066/">Very important guests</a> <br>  B. <a href="https://habrahabr.ru/company/mailru/blog/327066/">The least common multiple</a> <br>  C. <a href="https://habrahabr.ru/company/mailru/blog/327066/">Portim order</a> <br>  D. <a href="https://habrahabr.ru/company/mailru/blog/327066/">Red-black tree</a> <br>  E. <a href="https://habrahabr.ru/company/mailru/blog/327066/">Exploring the array</a> </p><a name="habracut"></a><br><p>  This time 5262 programmers were registered (647 of them are new participants).  In the qualifying round, we took on the results of another 201 participants.  All five tasks successfully solved 10 people.  The first three places were taken by the guys with a very large margin from the rest: </p><br><ol><li>  In the first place is Andrei Popa from Romania. </li><li>  Second place went to Lam Nguyen, only two minutes behind the penalty time. </li><li>  In the third place with a small margin of five minutes was Vladislav Epifanov from Nizhny Novgorod, Russia. </li></ol><br><p>  In addition, the top 10 hit: </p><br><ul><li>  Adam Bardashevich, Mozyr, Belarus </li><li>  Mahmoudian Arash, Reina, Iran </li><li>  Oleg Davydov, St. Petersburg, Russia </li><li>  George Wu, China </li><li>  Yuri Pisarchik, Minsk, Belarus </li><li>  Roman Udovichenko, Stolbtsy, Belarus </li><li>  Nguyen Trung, Vietnam </li></ul><br><p>  We congratulate all those who passed in the qualifying round.  The rest can be prepared for the third qualifying round, it will be held on Saturday, April 29, <a href="https://www.timeanddate.com/worldclock/fixedtime.html%3Fmsg%3DRussian%2BCode%2BCup%2BQual%2B2%26iso%3D20170429T14%26p1%3D166%26ah%3D2">from 14:00 to 16:00</a> Moscow time.  And now - analysis. </p><br><h2 id="a-ochen-vazhnye-gosti">  A. Very important guests </h2><br><p>  Time limit - 1 second <br>  Memory limit - 256 megabytes </p><br><p>  At the opening of the new campus of the University of the city of N plan to arrive <em>nm</em> very important guests.  The ceremony will be held in the hall, which has a rectangular shape, the seats in the hall are organized in <em>n</em> rows of <em>m</em> seats, the rows are numbered from 1 to <em>n</em> , the seats in each row from 1 to <em>m</em> , <em>j</em> -th place in the <em>i</em> -th row is designated as (( <em>i, j</em> ). </p><br><p>  The opening ceremony organizers numbered guests from 1 to <em>nm</em> in accordance with their importance, the more - the more important.  The most important guest - the mayor of the city - has the number <em>nm</em> .  It is known that the mayor plans to sit down at the place (1, 1).  Now you need to seat the rest of the guests.  At the same time, guests must be arranged in such a way that a guest with a larger number is located no further from the mayor than a guest with a smaller number.  The distance between two places ( <em>r</em> <sub>1</sub> , <em>s</em> <sub>1</sub> ) and ( <em>r</em> <sub>2</sub> , <em>s</em> <sub>2</sub> ) is the value |  <em>r</em> <sub>1</sub> - <em>r</em> <sub>2</sub> |  + |  <em>s</em> <sub>1</sub> - <em>s</em> <sub>2</sub> |. </p><br><p>  Help the organizers of the ceremony seating the guests. </p><br><p>  <strong>Input Format</strong> </p><br><p>  The input contains several test cases.  The first line contains the number of tests <em>t</em> (1 ‚â§ <em>t</em> ‚â§ 400). </p><br><p>  Each of the tests is described by two integers: <em>n</em> and <em>m</em> (1 ‚â§ <em>n</em> , <em>m</em> ‚â§ 20). </p><br><p>  <strong>Output format</strong> </p><br><p>  For each test, output what the hall will look like after accommodating guests there. </p><br><p>  Print <em>n</em> lines, each with <em>m</em> numbers, <em>j</em> -th number of the <em>i-</em> th line should be equal to the importance of the guest who will sit on the seat ( <em>i, j</em> ). </p><br><p>  If there are several suitable ways to seat the guests, output any of them. </p><br><p>  <strong>Examples</strong> </p><br><p>  Input data <br>  2 <br>  2 3 <br>  3 2 </p><br><p>  Output <br>  6 4 2 <br>  5 3 1 <br>  6 4 <br>  5 2 <br>  3 1 </p><br><div class="spoiler">  <b class="spoiler_title">Task analysis</b> <div class="spoiler_text"><p>  There are two ways to solve this problem.  The first is to seat guests diagonally, starting from position (1, 1).  Some accuracy in implementation is required to correctly take into account the cases <em>n &lt;m</em> and <em>m &lt;n</em> .  The second method allows not to think about which way the rectangle is drawn.  Just run the bypass in width from the place (1, 1) and we will seat the guests, starting from the maximum number, in order to extract seats from the queue. </p></div></div><br><h2 id="b-naimenshee-obschee-kratnoe">  B. The least common multiple </h2><br><p>  Time limit - 2 seconds <br>  Memory limit - 256 megabytes </p><br><p>  The concept of the smallest common multiple, the minimum number that is divided into each of the given, is well known.  This concept can be generalized to other mathematical concepts.  For example, on ordinary fractions. </p><br><p>  Given two fractions.  It is required to find their smallest common multiple ‚Äî such a smallest positive irreducible fraction <em>p / q</em> , that when it is divided into each of these fractions in a particular, an integer is obtained. </p><br><p>  <strong>Input Format</strong> </p><br><p>  The input contains several test cases.  The first line of the input data contains the number <em>t</em> - the number of tests (1 ‚â§ <em>t</em> ‚â§ 50 000). </p><br><p>  Each test is described by one line, which contains four numbers a, b, c, d, which define fractions <em>a / b</em> and <em>c / d</em> (1 ‚â§ <em>a, b, c, d</em> ‚â§ 10 <sup>9</sup> ).  It is guaranteed that <em>a / b</em> and <em>c / d</em> are reduced fractions. </p><br><p>  <strong>Output format</strong> </p><br><p>  For each test, output on a separate line the smallest common multiple of the fractions <em>a / b</em> and <em>c / d</em> - the numerator and denominator of the desired irreducible fraction through a space. </p><br><p>  <strong>Examples</strong> </p><br><p>  Input data <br>  2 <br>  9 5 12 5 <br>  1 10 3 100 </p><br><p>  Output <br>  36 5 <br>  3 10 </p><br><div class="spoiler">  <b class="spoiler_title">Task analysis</b> <div class="spoiler_text"><p>  Let <em>p / q be</em> wholly divisible by <em>a / b</em> and <em>c / d</em> , and all fractions are irreducible.  Then the integers are ( <em>p / q</em> ): ( <em>a / b</em> ) = ( <em>p ‚Ä¢ b</em> ) / ( <em>q ‚Ä¢ a</em> ) and ( <em>p / q</em> ): ( <em>c / d</em> ) = ( <em>p ‚Ä¢ d</em> ) / <em>q</em> ( <em>c</em> ). </p><br><p>  <em>p ‚Ä¢ b</em> is divided by <em>q ‚Ä¢ a</em> .  Since <em>b</em> and <em>a</em> are coprime, <em>p</em> is divisible by <em>a</em> .  <em>p</em> and <em>q</em> are coprime too, so <em>b</em> is divisible by <em>q</em> .  Similarly, <em>p</em> is divided by <em>c</em> , <em>d</em> is divided by <em>q</em> . </p><br><p>  Thus <em>p</em> divides <em>lcm</em> ( <em>a, c</em> ), <em>q</em> divides <em>gcd</em> ( <em>b, d</em> ).  The <em>lcm</em> ( <em>a, c</em> ) / <em>gcd</em> ( <em>b, d</em> ) fraction is the smallest fraction and is divided by <em>a / b</em> and <em>c / d</em> .  Thus, the answer is <em>lcm</em> ( <em>a, c</em> ) / <em>gcd</em> ( <em>b, d</em> ). </p></div></div><br><h2 id="c-portim-poryadok">  C. Portim order </h2><br><p>  Time limit - 2 seconds <br>  Memory limit - 256 megabytes </p><br><p>  Dima has <em>n</em> dots painted in a row on the carpet in the room.  By a surprising coincidence, he also has <em>n</em> cubes, weighing 1, 2, ..., <em>n</em> grams, respectively.  Dima played enough with the cubes and put them in a row, one per point.  Now he was going to shift them so that they went from left to right in ascending weight, but a little distracted.  At that moment, the bad boy Vadim entered the room and decided to foul up on Dima. </p><br><p>  Vadim knows that Dima is still small, and he will arrange the cubes in order of increasing weight as follows.  Each time he will look for the easiest cube, which is not yet in place, and change it with the one that stands there in his place. </p><br><p>  Vadim is a bad boy, so he wants to spoil a little more.  He has already pulled several cubes out of the row and now wants to arrange them back in such a way that Dima makes the maximum number of exchanges.  After the cubes return, those cubes that Vadim did not remove should remain in their places, exactly one die should appear at each point. </p><br><p>  How exactly should he arrange the cubes? </p><br><p>  <strong>Input Format</strong> </p><br><p>  The input contains several test cases.  The first line contains the number of tests <em>t</em> . </p><br><p>  Each test is described as follows. </p><br><p>  The first line of the test description contains the number <em>n</em> - the total number of cubes (1 ‚â§ <em>n</em> ‚â§ 10 <sup>5</sup> ).  The next line contains <em>n</em> numbers <em>a <sub>i</sub></em> (0 ‚â§ <em>a <sub>i</sub></em> ‚â§ <em>n</em> ) </p><br><p>  If <em>a <sub>i</sub></em> is equal to 0, then at the <em>i-</em> th place is not worth anything yet, this cube Vadim took out.  Otherwise, <em>a <sub>i</sub></em> is equal to the mass of the cube, which stands on the <em>i-</em> th place. </p><br><p>  It is guaranteed that the masses of the cubes present are different.  Vadim must return exactly those cubes in a row to empty spaces that are not there yet. </p><br><p>  The sum <em>n</em> in all tests of one input data does not exceed 10 <sup>5</sup> . </p><br><p>  <strong>Output format</strong> </p><br><p>  For each test, output two lines. </p><br><p>  In the first line print the number of exchanges that Dima will have to make to sort the cubes. </p><br><p>  In the second line print <em>n</em> numbers - the masses of the cubes in the order from left to right, which are obtained with the optimal arrangement of the cubes by Vadim.  Please note that the cubes that Vadim did not take out immediately should remain in place. </p><br><p>  If there are several possible solutions that lead to the maximum number of exchanges, output any of them. </p><br><p>  <strong>Examples</strong> </p><br><p>  Input data <br>  3 <br>  2 <br>  0 0 <br>  four <br>  4 0 0 3 <br>  five <br>  0 4 0 2 5 </p><br><p>  Output <br>  one <br>  2 1 <br>  3 <br>  4 1 2 3 <br>  2 <br>  3 4 1 2 5 </p><br><div class="spoiler">  <b class="spoiler_title">Task analysis</b> <div class="spoiler_text"><p>  In the task, it is necessary to supplement the original array before rearranging the numbers from 1 to <em>n</em> so that the sorting will make the greatest number of exchanges. </p><br><p>  To begin with, let us assume that we have already generated some sort of permutation and want to find out how many exchanges the sorting will make by choice.  For this, we will consider the permutation as a set of cycles.  Consider a cycle that contains the minimum number that does not stand in its place.  The length of this cycle is more than 1. It is easy to notice that with one exchange the length of the corresponding cycle decreases by one and a new cycle of length 1 appears. Now note that the cycle of length <em>L</em> will decrease its length exactly <em>L</em> - 1 times during the sorting process, which means that the total cycle lengths will decrease exactly by <em>n</em> - <em>c</em> , where <em>c</em> is the number of cycles. </p><br><p>  Thus, we need to supplement the array before permutation so that the number of cycles is minimal.  To do this, consider the permutation as a directed graph, where if <em>a</em> [ <em>i</em> ] = <em>j</em> , then the graph has an edge from vertex <em>i</em> to vertex <em>j</em> .  The graph broke into loops and chains.  All the cycles that are in this graph will be preserved even after adding the missing elements, and all existing chains (a vertex that has neither incoming nor outgoing edges, we will consider as a chain of length 0) can be combined into one big cycle.  Go through all the available chains and add an edge from the end of one chain to the top of another.  When all the chains are connected into one, we add an edge from its end to the beginning, and it will become a cycle. </p></div></div><br><h2 id="d-krasno-chyornoe-derevo">  D. Red-black tree </h2><br><p>  Time limit - 3 seconds <br>  Memory limit - 256 megabytes </p><br><p>  Did you know that in most standard libraries the data structure ‚Äúset‚Äù is implemented using red-black tree?  In this task, you need to find the number of ways to paint a given binary tree so that it becomes red and black.  The answer must be displayed modulo 10 <sup>9</sup> + 7. </p><br><p>  Consider a binary tree.  If a vertex has less than two children, add fictitious vertices to the place of missing children.  A tree is called red-black if the following properties are true: </p><br><ol><li>  Each vertex is painted in one of two colors: red or black. </li><li>  The root of the tree and all the added dummy vertices are colored black. </li><li>  The parent of the top, painted red, is painted black. </li><li>  All paths from the root to the added fictitious leaves contain the same number of black vertices. </li></ol><br><p>  Note that the parent of a vertex colored black can be colored black. </p><br><p>  Two colors of a tree are called different if there is a vertex that is painted in different colors in these colorings. </p><br><p>  The figure shows two ways of painting wood from the second test. </p><br><p><img src="https://habrastorage.org/files/14d/c75/e35/14dc75e351e148a39b0677c71c0fec44.png" alt="image"></p><br><p>  <strong>Input Format</strong> </p><br><p>  The first line contains a single integer <em>n</em> - the number of vertices in the tree (1 ‚â§ <em>n</em> ‚â§ 500 000). </p><br><p> The following <em>n</em> lines describe the tree.  The <em>i-</em> th line contains two integers <em>l <sub>i</sub></em> and <em>r <sub>i</sub></em> - the indices of the vertices that are the left and right children of the <em>i</em> -th, or 0, if the corresponding child is missing ( <em>l <sub>i</sub></em> = 0 or <em>i</em> &lt; <em>l <sub>i</sub></em> ‚â§ <em>n</em> ; <em>r <sub>i</sub></em> = 0 or <em>i</em> &lt; <em>r <sub>i</sub></em> ‚â§ <em>n</em> ).  The root of the tree is number 1. It is guaranteed that the correct tree is described in the input. </p><br><p>  <strong>Output format</strong> </p><br><p>  Output one integer - the number of ways to paint the given tree so that it becomes red and black.  The answer must be displayed modulo 10 <sup>9</sup> + 7. </p><br><p>  <strong>Examples</strong> </p><br><p>  Input data <br>  3 <br>  2 3 <br>  0 0 <br>  0 0 </p><br><p>  Output <br>  2 </p><br><p>  Input data <br>  6 <br>  2 4 <br>  thirty <br>  0 0 <br>  5 6 <br>  0 0 <br>  0 0 </p><br><p>  Output <br>  2 </p><br><div class="spoiler">  <b class="spoiler_title">Task analysis</b> <div class="spoiler_text"><p>  Having noticed a subtle hint in the first sentence of the conditions, it is easy to prove (or check in any book on data structures) that in any red-black tree with <em>n</em> vertices on the way from the root to the leaves <em>O</em> ( <em>logn</em> ) black vertices.  We take advantage of this fact in the decision. </p><br><p>  We call an almost red-black tree in which all the properties of a red-black tree are fulfilled, but the root of the tree is painted red. </p><br><p>  Using dynamic programming, we calculate for each subtree the number of ways to color vertices in it so that the subtree is red and black and the number of black vertices on the path from root to leaf is <em>h</em> - or the tree is almost red and black and the number of black vertices on the path from root to leaf was <em>h</em> . </p><br><p>  Save this number of methods in the array <em>d</em> [ <em>v</em> ] [ <em>h</em> ] [ <em>t</em> ], where <em>v</em> is the number of the vertex that is the root of the subtree, <em>h</em> is the number of black vertices on the path from root to leaf, and <em>t</em> denotes the type of painting: if <em>t</em> = 0 - the number of dyes is stored there so that the subtree becomes red-black, and if <em>t</em> = 1, the subtree becomes almost red-black. </p><br><p>  Then <em>d</em> [ <em>v</em> ] [ <em>h</em> ] [0] equals the product for all <em>u</em> , which are children of <em>v</em> , of the values ‚Äã‚Äã( <em>d</em> [ <em>u</em> ] [ <em>h</em> - 1] [0] + <em>d</em> [ <em>u</em> ] [ <em>h</em> - 1] [1]).  And <em>d</em> [ <em>v</em> ] [ <em>h</em> ] [1] equals the product over all <em>u</em> , which are children of <em>v</em> , of values <em>d</em> [ <em>u</em> ] [ <em>h</em> ] [0]. </p><br><p>  The answer to the problem will be equal to the sum over all <em>d</em> [1] [ <em>h</em> ] [0]. </p><br><p>  Now we note that <em>h</em> for all admissible colorings of subtrees is limited to a certain value <em>C</em> = <em>O</em> ( <em>log</em> ( <em>n</em> )), and for all <em>h</em> &gt; <em>C the</em> number of colorings is guaranteed to be zero. </p><br><p>  This means that all <em>O</em> ( <em>nlog</em> ( <em>n</em> )) states are needed, from each of which there are <em>O</em> (1) transitions.  Therefore, the solution will work for <em>O</em> ( <em>nlog</em> ( <em>n</em> )). </p></div></div><br><h2 id="e-izuchenie-massiva">  E. Exploring the array </h2><br><p>  Time limit - 2 seconds <br>  Memory limit - 256 megabytes </p><br><p>  Vasya loves arrays.  Therefore, for his birthday, his parents gave him an array <em>a</em> , consisting of the numbers 1 and - 1. Vasya immediately began to study it. </p><br><p>  Since Vasya also loves zeros very much, he decided to take different subsegments <em>a</em> [ <em>l <sub>i</sub></em> , ..., <em>r <sub>i</sub></em> ] of array a and look for the length of the maximum subsegment with the sum 0. If there is no such subsection, he considers the answer to be 0. Vasya wrote on a piece of paper <em>q</em> segments [ <em>l <sub>i</sub></em> , <em>r <sub>i</sub></em> ] and now wants to find the sum of the answers to them. </p><br><p>  Here are the answers to the subsegments selected by Vasya in the test example: </p><br><ul><li>  Sub-segment [1, 5]: maximum sub-segment with the sum of 0 - [2, 5]; </li><li>  Sub-segment [1, 3]: maximum sub-segment with the sum of 0 - [2, 3]; </li><li>  Sub-segment [2, 4]: maximum sub-segment with the sum of 0 - [2, 3]; </li><li>  Sub-segment [3, 4]: There is no sub-segment with sum 0; </li><li>  Sub-segment [3, 5]: the maximum sub-segment with the sum of 0 - [4, 5]. </li></ul><br><p>  Total, the total length of all the desired subsegments in this test is 4 + 2 + 2 + 0 + 2 = 10. </p><br><p>  <strong>Input Format</strong> </p><br><p>  The input contains several test cases.  The first line contains the number of tests <em>t</em> (1 ‚â§ <em>t</em> ‚â§ 1000). </p><br><p>  Each of the following <em>t</em> tests is described as follows: the first line of the test description contains the number <em>n</em> - the number of array elements (1 ‚â§ <em>n</em> ‚â§ 10 <sup>5</sup> ). </p><br><p>  The next line contains <em>n</em> integers <em>a <sub>i</sub></em> - the elements of the array ( <em>a <sub>i</sub></em> = - 1 or <em>a <sub>i</sub></em> = 1). </p><br><p>  The next line contains the number <em>q</em> - the number of sub-spars written out by Vasya (1 ‚â§ <em>q</em> ‚â§ 10 <sup>5</sup> ). </p><br><p>  Each of the following q lines contains two numbers <em>l <sub>i</sub></em> , <em>r <sub>i</sub></em> - the left and right borders of the <em>i</em> -th sub-segment, respectively (1 ‚â§ <em>l <sub>i</sub></em> ‚â§ <em>r <sub>i</sub></em> ‚â§ <em>n</em> ) </p><br><p>  It is guaranteed that the sum <em>n</em> in all tests of one input data does not exceed 10 <sup>5</sup> , and the sum <em>q</em> in all tests of one input data does not exceed 10 <sup>5</sup> . </p><br><p>  <strong>Output format</strong> </p><br><p>  For each test, output the answer to it - the sum of the answers for all <em>q</em> sub-spans. </p><br><p>  <strong>Examples</strong> </p><br><p>  Input data <br>  one <br>  five <br>  1 -1 1 1 -1 <br>  five <br>  15 <br>  13 <br>  2 4 <br>  3 4 <br>  3 5 </p><br><p>  Output <br>  ten </p><br><div class="spoiler">  <b class="spoiler_title">Task analysis</b> <div class="spoiler_text"><p>  Since the restrictions on <em>n</em> and <em>q are the</em> same, we will use <em>n</em> instead of <em>max</em> ( <em>n, q</em> ).  Let's make some observations. </p><br><p>  The first observation: the answer to the request is the maximum length of the segment [ <em>L, R</em> ] such that <em>pref <sub>L</sub></em> - 1 = <em>pref <sub>R</sub></em> , where <em>pref <sub>i</sub></em> = <em>a</em> 1 + <em>a</em> 2 + ... + <em>a <sub>i</sub></em> is the prefix sum of the array <em>a</em> ( <em>pref <sub>0</sub></em> = 0).  Further, we will assume that we work with the array <em>pref <sub>0</sub></em> , <em>pref <sub>1</sub></em> , ..., <em>pref <sub>n</sub></em> and on request [ <em>l, r</em> ] it is required to find the maximum in length of the [ <em>L, R</em> ] sub-segment [ <em>l</em> - 1, <em>r</em> ], such such that <em>pref <sub>L</sub></em> = <em>pref <sub>R.</sub></em> </p><br><p>  The second observation: <em>pref <sub>i</sub></em> - rather small (- <em>n</em> ‚â§ <em>pref <sub>i</sub></em> ‚â§ <em>n</em> ). </p><br><p>  We will solve the problem offline.  We use the method, in many respects similar to the Mo algorithm.  We divide all queries into groups, where the <em>i</em> -th group contains queries [ <em>l <sub>i</sub></em> , <em>r <sub>i</sub></em> ], such that <em>i ‚Ä¢ K</em> ‚â§ <em>l <sub>i</sub></em> &lt;( <em>i</em> + 1) ‚Ä¢ <em>K</em> ( <em>K</em> is a constant approximately equal to <em>sqrt</em> ( <em>n</em> ) ).  In each group, sort the requests by the right border.  Now we will solve the problem separately for each group of requests. </p><br><p>  Consider the <em>ith</em> group [ <em>L <sub>i</sub></em> , <em>R <sub>i</sub></em> ].  We will go in a row on requests from left to right (i.e., not decreasing the right border).  We will also support two arrays, <em>mostLeft</em> [ <em>p</em> ] and <em>mostRight</em> [ <em>p</em> ]: the current leftmost occurrence of the prefix sum <em>p</em> , which is also to the left of <em>R <sub>i</sub></em> , and the current rightmost occurrence of the prefix sum <em>p</em> .  Supporting these two arrays, it is also easy to maintain the answer on the segment [ <em>R <sub>i</sub></em> + 1, <em>r</em> ], where <em>r</em> is the right border of the current query.  To answer the query [ <em>l, r</em> ], we calculate in <em>O</em> ( <em>K</em> ) the answer to [ <em>l</em> , <em>min</em> ( <em>r, R</em> )], using the information from the <em>mostRight</em> array, and compare this value with the current answer on the [ <em>R</em> + 1, <em>r</em> ] segment . </p><br><p>  Total for requests of each group in total we spend <em>O</em> ( <em>K ‚Ä¢ c <sub>i</sub></em> + <em>n</em> ) time, where <em>c <sub>i</sub></em> is the number of requests in the group.  Since the groups are <em>O</em> ( <em>n / K</em> ), we get the total operation time <em>O</em> ( <em>sum <sub>i</sub></em> = 1 ... <em>n / K</em> ( <em>K ‚Ä¢ c <sub>i</sub></em> + <em>n</em> )) = <em>O</em> ( <em>K ‚Ä¢ sum (c <sub>i</sub></em> ) + <em>n2 / K</em> ).  With <em>K</em> = <em>sqrt</em> ( <em>n</em> ), we obtain the running time <em>O</em> ( <em>n ‚Ä¢ sqrt</em> ( <em>n</em> )). </p></div></div><br><h2 id="vse-na-tretiy-raund">  All for the third round! </h2><br><p>  Once again we remind: the third round will begin on April 29 at 14:00 Moscow time.  More than five thousand participants have already been registered.  Will compete with anyone! </p><br><p>  <a href="http://www.russiancodecup.ru/ru/">Join now</a> ! </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/327066/">https://habr.com/ru/post/327066/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../327056/index.html">"The little things that we noticed": case IaaS-provider</a></li>
<li><a href="../327058/index.html">Difficult lessons: five years with Node.js</a></li>
<li><a href="../327060/index.html">Clarive 6.8 has been released.</a></li>
<li><a href="../327062/index.html">Typography: font selection process</a></li>
<li><a href="../327064/index.html">Native American software designer tricks. Release 1</a></li>
<li><a href="../327068/index.html">PHP 7 Virtual Machine</a></li>
<li><a href="../327070/index.html">‚ÄúWhy don't you just rewrite it in X?‚Äù</a></li>
<li><a href="../327072/index.html">Predict the popularity of articles on TJ</a></li>
<li><a href="../327074/index.html">Experience migrating applications from Unity3D to iOS sdk and SceneKit</a></li>
<li><a href="../327076/index.html">We increase the potential of the network storage abandoned by the manufacturer</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>