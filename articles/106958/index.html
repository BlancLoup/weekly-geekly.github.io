<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Caching data in LINQ-to-SQL, incl. and null</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I want to share with the community about a couple of classes that I use in my ASP.NET projects. One is a wrapper for the Cache object, the other conta...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Caching data in LINQ-to-SQL, incl. and null</h1><div class="post__text post__text-html js-mediator-article">  I want to share with the community about a couple of classes that I use in my ASP.NET projects.  One is a wrapper for the Cache object, the other contains extensible methods for caching the results of LINQ-to-SQL queries. <br><br>  So, the task: to cache LINQ-to-SQL queries. <br><br>  What should be the result: <br>  1) an expanding method for caching a collection of records (after performing ToList ()) <br>  2) an expanding method for caching one record (FirstOrDefault ()), <br>  3) a generalizing method for working with a cache, which allows to get records and lead to the specified type <br>  3) NULL caching capability. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br><br>  Problems: <br>  1) it is impossible to write NULL in Cache <br>  2) FirstOrDefault () can return not only Nullable types, but also value types (int, double, etc.) <br><br>  So, let's write a class for working with the cache: <br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">class</font> CacheStorage { <font color="#0000ff">internal</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Null = <font color="#0000ff">new</font> Object(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Get( <font color="#0000ff">string</font> index) { <font color="#0000ff">return</font> <font color="#2B91AF">HttpContext</font> .Current.Cache.Get(index); } <font color="#0000ff">public</font> <font color="#0000ff">static</font> CacheItem&lt;T&gt; Get&lt;T&gt;( <font color="#0000ff">string</font> key) { CacheItem&lt;T&gt; result = <font color="#0000ff">new</font> CacheItem&lt;T&gt; { Cached = <font color="#0000ff">false</font> , Item = <font color="#0000ff">default</font> (T) }; <font color="#0000ff">object</font> obj = Get(key); <font color="#0000ff">if</font> (obj != <font color="#0000ff">null</font> ) { result.Cached = <font color="#0000ff">true</font> ; result.Item = obj == CacheStorage.Null ? <font color="#0000ff">default</font> (T) : (T)obj; } <font color="#0000ff">return</font> result; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> Put( <font color="#0000ff">string</font> key, <font color="#0000ff">object</font> <font color="#0000ff">value</font> ) { <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> == <font color="#0000ff">null</font> ) { <font color="#0000ff">value</font> = CacheStorage.Null; } <font color="#0000ff">int</font> expirationMinutes = 2; <font color="#2B91AF">HttpContext</font> .Current.Cache.Insert(key, <font color="#0000ff">value</font> , <font color="#0000ff">null</font> , <font color="#2B91AF">DateTime</font> .Now.AddMinutes(expirationMinutes), <font color="#2B91AF">TimeSpan</font> .Zero); } } <font color="#0000ff">public</font> <font color="#0000ff">class</font> CacheItem&lt;T&gt; { <font color="#0000ff">public</font> T Item { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#0000ff">bool</font> Cached { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } }</font> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <ol><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">class</font> CacheStorage { <font color="#0000ff">internal</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Null = <font color="#0000ff">new</font> Object(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Get( <font color="#0000ff">string</font> index) { <font color="#0000ff">return</font> <font color="#2B91AF">HttpContext</font> .Current.Cache.Get(index); } <font color="#0000ff">public</font> <font color="#0000ff">static</font> CacheItem&lt;T&gt; Get&lt;T&gt;( <font color="#0000ff">string</font> key) { CacheItem&lt;T&gt; result = <font color="#0000ff">new</font> CacheItem&lt;T&gt; { Cached = <font color="#0000ff">false</font> , Item = <font color="#0000ff">default</font> (T) }; <font color="#0000ff">object</font> obj = Get(key); <font color="#0000ff">if</font> (obj != <font color="#0000ff">null</font> ) { result.Cached = <font color="#0000ff">true</font> ; result.Item = obj == CacheStorage.Null ? <font color="#0000ff">default</font> (T) : (T)obj; } <font color="#0000ff">return</font> result; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> Put( <font color="#0000ff">string</font> key, <font color="#0000ff">object</font> <font color="#0000ff">value</font> ) { <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> == <font color="#0000ff">null</font> ) { <font color="#0000ff">value</font> = CacheStorage.Null; } <font color="#0000ff">int</font> expirationMinutes = 2; <font color="#2B91AF">HttpContext</font> .Current.Cache.Insert(key, <font color="#0000ff">value</font> , <font color="#0000ff">null</font> , <font color="#2B91AF">DateTime</font> .Now.AddMinutes(expirationMinutes), <font color="#2B91AF">TimeSpan</font> .Zero); } } <font color="#0000ff">public</font> <font color="#0000ff">class</font> CacheItem&lt;T&gt; { <font color="#0000ff">public</font> T Item { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#0000ff">bool</font> Cached { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">class</font> CacheStorage { <font color="#0000ff">internal</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Null = <font color="#0000ff">new</font> Object(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Get( <font color="#0000ff">string</font> index) { <font color="#0000ff">return</font> <font color="#2B91AF">HttpContext</font> .Current.Cache.Get(index); } <font color="#0000ff">public</font> <font color="#0000ff">static</font> CacheItem&lt;T&gt; Get&lt;T&gt;( <font color="#0000ff">string</font> key) { CacheItem&lt;T&gt; result = <font color="#0000ff">new</font> CacheItem&lt;T&gt; { Cached = <font color="#0000ff">false</font> , Item = <font color="#0000ff">default</font> (T) }; <font color="#0000ff">object</font> obj = Get(key); <font color="#0000ff">if</font> (obj != <font color="#0000ff">null</font> ) { result.Cached = <font color="#0000ff">true</font> ; result.Item = obj == CacheStorage.Null ? <font color="#0000ff">default</font> (T) : (T)obj; } <font color="#0000ff">return</font> result; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> Put( <font color="#0000ff">string</font> key, <font color="#0000ff">object</font> <font color="#0000ff">value</font> ) { <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> == <font color="#0000ff">null</font> ) { <font color="#0000ff">value</font> = CacheStorage.Null; } <font color="#0000ff">int</font> expirationMinutes = 2; <font color="#2B91AF">HttpContext</font> .Current.Cache.Insert(key, <font color="#0000ff">value</font> , <font color="#0000ff">null</font> , <font color="#2B91AF">DateTime</font> .Now.AddMinutes(expirationMinutes), <font color="#2B91AF">TimeSpan</font> .Zero); } } <font color="#0000ff">public</font> <font color="#0000ff">class</font> CacheItem&lt;T&gt; { <font color="#0000ff">public</font> T Item { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#0000ff">bool</font> Cached { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">class</font> CacheStorage { <font color="#0000ff">internal</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Null = <font color="#0000ff">new</font> Object(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Get( <font color="#0000ff">string</font> index) { <font color="#0000ff">return</font> <font color="#2B91AF">HttpContext</font> .Current.Cache.Get(index); } <font color="#0000ff">public</font> <font color="#0000ff">static</font> CacheItem&lt;T&gt; Get&lt;T&gt;( <font color="#0000ff">string</font> key) { CacheItem&lt;T&gt; result = <font color="#0000ff">new</font> CacheItem&lt;T&gt; { Cached = <font color="#0000ff">false</font> , Item = <font color="#0000ff">default</font> (T) }; <font color="#0000ff">object</font> obj = Get(key); <font color="#0000ff">if</font> (obj != <font color="#0000ff">null</font> ) { result.Cached = <font color="#0000ff">true</font> ; result.Item = obj == CacheStorage.Null ? <font color="#0000ff">default</font> (T) : (T)obj; } <font color="#0000ff">return</font> result; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> Put( <font color="#0000ff">string</font> key, <font color="#0000ff">object</font> <font color="#0000ff">value</font> ) { <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> == <font color="#0000ff">null</font> ) { <font color="#0000ff">value</font> = CacheStorage.Null; } <font color="#0000ff">int</font> expirationMinutes = 2; <font color="#2B91AF">HttpContext</font> .Current.Cache.Insert(key, <font color="#0000ff">value</font> , <font color="#0000ff">null</font> , <font color="#2B91AF">DateTime</font> .Now.AddMinutes(expirationMinutes), <font color="#2B91AF">TimeSpan</font> .Zero); } } <font color="#0000ff">public</font> <font color="#0000ff">class</font> CacheItem&lt;T&gt; { <font color="#0000ff">public</font> T Item { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#0000ff">bool</font> Cached { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li></li><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">class</font> CacheStorage { <font color="#0000ff">internal</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Null = <font color="#0000ff">new</font> Object(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Get( <font color="#0000ff">string</font> index) { <font color="#0000ff">return</font> <font color="#2B91AF">HttpContext</font> .Current.Cache.Get(index); } <font color="#0000ff">public</font> <font color="#0000ff">static</font> CacheItem&lt;T&gt; Get&lt;T&gt;( <font color="#0000ff">string</font> key) { CacheItem&lt;T&gt; result = <font color="#0000ff">new</font> CacheItem&lt;T&gt; { Cached = <font color="#0000ff">false</font> , Item = <font color="#0000ff">default</font> (T) }; <font color="#0000ff">object</font> obj = Get(key); <font color="#0000ff">if</font> (obj != <font color="#0000ff">null</font> ) { result.Cached = <font color="#0000ff">true</font> ; result.Item = obj == CacheStorage.Null ? <font color="#0000ff">default</font> (T) : (T)obj; } <font color="#0000ff">return</font> result; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> Put( <font color="#0000ff">string</font> key, <font color="#0000ff">object</font> <font color="#0000ff">value</font> ) { <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> == <font color="#0000ff">null</font> ) { <font color="#0000ff">value</font> = CacheStorage.Null; } <font color="#0000ff">int</font> expirationMinutes = 2; <font color="#2B91AF">HttpContext</font> .Current.Cache.Insert(key, <font color="#0000ff">value</font> , <font color="#0000ff">null</font> , <font color="#2B91AF">DateTime</font> .Now.AddMinutes(expirationMinutes), <font color="#2B91AF">TimeSpan</font> .Zero); } } <font color="#0000ff">public</font> <font color="#0000ff">class</font> CacheItem&lt;T&gt; { <font color="#0000ff">public</font> T Item { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#0000ff">bool</font> Cached { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">class</font> CacheStorage { <font color="#0000ff">internal</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Null = <font color="#0000ff">new</font> Object(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Get( <font color="#0000ff">string</font> index) { <font color="#0000ff">return</font> <font color="#2B91AF">HttpContext</font> .Current.Cache.Get(index); } <font color="#0000ff">public</font> <font color="#0000ff">static</font> CacheItem&lt;T&gt; Get&lt;T&gt;( <font color="#0000ff">string</font> key) { CacheItem&lt;T&gt; result = <font color="#0000ff">new</font> CacheItem&lt;T&gt; { Cached = <font color="#0000ff">false</font> , Item = <font color="#0000ff">default</font> (T) }; <font color="#0000ff">object</font> obj = Get(key); <font color="#0000ff">if</font> (obj != <font color="#0000ff">null</font> ) { result.Cached = <font color="#0000ff">true</font> ; result.Item = obj == CacheStorage.Null ? <font color="#0000ff">default</font> (T) : (T)obj; } <font color="#0000ff">return</font> result; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> Put( <font color="#0000ff">string</font> key, <font color="#0000ff">object</font> <font color="#0000ff">value</font> ) { <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> == <font color="#0000ff">null</font> ) { <font color="#0000ff">value</font> = CacheStorage.Null; } <font color="#0000ff">int</font> expirationMinutes = 2; <font color="#2B91AF">HttpContext</font> .Current.Cache.Insert(key, <font color="#0000ff">value</font> , <font color="#0000ff">null</font> , <font color="#2B91AF">DateTime</font> .Now.AddMinutes(expirationMinutes), <font color="#2B91AF">TimeSpan</font> .Zero); } } <font color="#0000ff">public</font> <font color="#0000ff">class</font> CacheItem&lt;T&gt; { <font color="#0000ff">public</font> T Item { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#0000ff">bool</font> Cached { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">class</font> CacheStorage { <font color="#0000ff">internal</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Null = <font color="#0000ff">new</font> Object(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Get( <font color="#0000ff">string</font> index) { <font color="#0000ff">return</font> <font color="#2B91AF">HttpContext</font> .Current.Cache.Get(index); } <font color="#0000ff">public</font> <font color="#0000ff">static</font> CacheItem&lt;T&gt; Get&lt;T&gt;( <font color="#0000ff">string</font> key) { CacheItem&lt;T&gt; result = <font color="#0000ff">new</font> CacheItem&lt;T&gt; { Cached = <font color="#0000ff">false</font> , Item = <font color="#0000ff">default</font> (T) }; <font color="#0000ff">object</font> obj = Get(key); <font color="#0000ff">if</font> (obj != <font color="#0000ff">null</font> ) { result.Cached = <font color="#0000ff">true</font> ; result.Item = obj == CacheStorage.Null ? <font color="#0000ff">default</font> (T) : (T)obj; } <font color="#0000ff">return</font> result; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> Put( <font color="#0000ff">string</font> key, <font color="#0000ff">object</font> <font color="#0000ff">value</font> ) { <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> == <font color="#0000ff">null</font> ) { <font color="#0000ff">value</font> = CacheStorage.Null; } <font color="#0000ff">int</font> expirationMinutes = 2; <font color="#2B91AF">HttpContext</font> .Current.Cache.Insert(key, <font color="#0000ff">value</font> , <font color="#0000ff">null</font> , <font color="#2B91AF">DateTime</font> .Now.AddMinutes(expirationMinutes), <font color="#2B91AF">TimeSpan</font> .Zero); } } <font color="#0000ff">public</font> <font color="#0000ff">class</font> CacheItem&lt;T&gt; { <font color="#0000ff">public</font> T Item { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#0000ff">bool</font> Cached { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">class</font> CacheStorage { <font color="#0000ff">internal</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Null = <font color="#0000ff">new</font> Object(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Get( <font color="#0000ff">string</font> index) { <font color="#0000ff">return</font> <font color="#2B91AF">HttpContext</font> .Current.Cache.Get(index); } <font color="#0000ff">public</font> <font color="#0000ff">static</font> CacheItem&lt;T&gt; Get&lt;T&gt;( <font color="#0000ff">string</font> key) { CacheItem&lt;T&gt; result = <font color="#0000ff">new</font> CacheItem&lt;T&gt; { Cached = <font color="#0000ff">false</font> , Item = <font color="#0000ff">default</font> (T) }; <font color="#0000ff">object</font> obj = Get(key); <font color="#0000ff">if</font> (obj != <font color="#0000ff">null</font> ) { result.Cached = <font color="#0000ff">true</font> ; result.Item = obj == CacheStorage.Null ? <font color="#0000ff">default</font> (T) : (T)obj; } <font color="#0000ff">return</font> result; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> Put( <font color="#0000ff">string</font> key, <font color="#0000ff">object</font> <font color="#0000ff">value</font> ) { <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> == <font color="#0000ff">null</font> ) { <font color="#0000ff">value</font> = CacheStorage.Null; } <font color="#0000ff">int</font> expirationMinutes = 2; <font color="#2B91AF">HttpContext</font> .Current.Cache.Insert(key, <font color="#0000ff">value</font> , <font color="#0000ff">null</font> , <font color="#2B91AF">DateTime</font> .Now.AddMinutes(expirationMinutes), <font color="#2B91AF">TimeSpan</font> .Zero); } } <font color="#0000ff">public</font> <font color="#0000ff">class</font> CacheItem&lt;T&gt; { <font color="#0000ff">public</font> T Item { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#0000ff">bool</font> Cached { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li></li><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">class</font> CacheStorage { <font color="#0000ff">internal</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Null = <font color="#0000ff">new</font> Object(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Get( <font color="#0000ff">string</font> index) { <font color="#0000ff">return</font> <font color="#2B91AF">HttpContext</font> .Current.Cache.Get(index); } <font color="#0000ff">public</font> <font color="#0000ff">static</font> CacheItem&lt;T&gt; Get&lt;T&gt;( <font color="#0000ff">string</font> key) { CacheItem&lt;T&gt; result = <font color="#0000ff">new</font> CacheItem&lt;T&gt; { Cached = <font color="#0000ff">false</font> , Item = <font color="#0000ff">default</font> (T) }; <font color="#0000ff">object</font> obj = Get(key); <font color="#0000ff">if</font> (obj != <font color="#0000ff">null</font> ) { result.Cached = <font color="#0000ff">true</font> ; result.Item = obj == CacheStorage.Null ? <font color="#0000ff">default</font> (T) : (T)obj; } <font color="#0000ff">return</font> result; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> Put( <font color="#0000ff">string</font> key, <font color="#0000ff">object</font> <font color="#0000ff">value</font> ) { <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> == <font color="#0000ff">null</font> ) { <font color="#0000ff">value</font> = CacheStorage.Null; } <font color="#0000ff">int</font> expirationMinutes = 2; <font color="#2B91AF">HttpContext</font> .Current.Cache.Insert(key, <font color="#0000ff">value</font> , <font color="#0000ff">null</font> , <font color="#2B91AF">DateTime</font> .Now.AddMinutes(expirationMinutes), <font color="#2B91AF">TimeSpan</font> .Zero); } } <font color="#0000ff">public</font> <font color="#0000ff">class</font> CacheItem&lt;T&gt; { <font color="#0000ff">public</font> T Item { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#0000ff">bool</font> Cached { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">class</font> CacheStorage { <font color="#0000ff">internal</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Null = <font color="#0000ff">new</font> Object(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Get( <font color="#0000ff">string</font> index) { <font color="#0000ff">return</font> <font color="#2B91AF">HttpContext</font> .Current.Cache.Get(index); } <font color="#0000ff">public</font> <font color="#0000ff">static</font> CacheItem&lt;T&gt; Get&lt;T&gt;( <font color="#0000ff">string</font> key) { CacheItem&lt;T&gt; result = <font color="#0000ff">new</font> CacheItem&lt;T&gt; { Cached = <font color="#0000ff">false</font> , Item = <font color="#0000ff">default</font> (T) }; <font color="#0000ff">object</font> obj = Get(key); <font color="#0000ff">if</font> (obj != <font color="#0000ff">null</font> ) { result.Cached = <font color="#0000ff">true</font> ; result.Item = obj == CacheStorage.Null ? <font color="#0000ff">default</font> (T) : (T)obj; } <font color="#0000ff">return</font> result; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> Put( <font color="#0000ff">string</font> key, <font color="#0000ff">object</font> <font color="#0000ff">value</font> ) { <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> == <font color="#0000ff">null</font> ) { <font color="#0000ff">value</font> = CacheStorage.Null; } <font color="#0000ff">int</font> expirationMinutes = 2; <font color="#2B91AF">HttpContext</font> .Current.Cache.Insert(key, <font color="#0000ff">value</font> , <font color="#0000ff">null</font> , <font color="#2B91AF">DateTime</font> .Now.AddMinutes(expirationMinutes), <font color="#2B91AF">TimeSpan</font> .Zero); } } <font color="#0000ff">public</font> <font color="#0000ff">class</font> CacheItem&lt;T&gt; { <font color="#0000ff">public</font> T Item { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#0000ff">bool</font> Cached { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">class</font> CacheStorage { <font color="#0000ff">internal</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Null = <font color="#0000ff">new</font> Object(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Get( <font color="#0000ff">string</font> index) { <font color="#0000ff">return</font> <font color="#2B91AF">HttpContext</font> .Current.Cache.Get(index); } <font color="#0000ff">public</font> <font color="#0000ff">static</font> CacheItem&lt;T&gt; Get&lt;T&gt;( <font color="#0000ff">string</font> key) { CacheItem&lt;T&gt; result = <font color="#0000ff">new</font> CacheItem&lt;T&gt; { Cached = <font color="#0000ff">false</font> , Item = <font color="#0000ff">default</font> (T) }; <font color="#0000ff">object</font> obj = Get(key); <font color="#0000ff">if</font> (obj != <font color="#0000ff">null</font> ) { result.Cached = <font color="#0000ff">true</font> ; result.Item = obj == CacheStorage.Null ? <font color="#0000ff">default</font> (T) : (T)obj; } <font color="#0000ff">return</font> result; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> Put( <font color="#0000ff">string</font> key, <font color="#0000ff">object</font> <font color="#0000ff">value</font> ) { <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> == <font color="#0000ff">null</font> ) { <font color="#0000ff">value</font> = CacheStorage.Null; } <font color="#0000ff">int</font> expirationMinutes = 2; <font color="#2B91AF">HttpContext</font> .Current.Cache.Insert(key, <font color="#0000ff">value</font> , <font color="#0000ff">null</font> , <font color="#2B91AF">DateTime</font> .Now.AddMinutes(expirationMinutes), <font color="#2B91AF">TimeSpan</font> .Zero); } } <font color="#0000ff">public</font> <font color="#0000ff">class</font> CacheItem&lt;T&gt; { <font color="#0000ff">public</font> T Item { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#0000ff">bool</font> Cached { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">class</font> CacheStorage { <font color="#0000ff">internal</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Null = <font color="#0000ff">new</font> Object(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Get( <font color="#0000ff">string</font> index) { <font color="#0000ff">return</font> <font color="#2B91AF">HttpContext</font> .Current.Cache.Get(index); } <font color="#0000ff">public</font> <font color="#0000ff">static</font> CacheItem&lt;T&gt; Get&lt;T&gt;( <font color="#0000ff">string</font> key) { CacheItem&lt;T&gt; result = <font color="#0000ff">new</font> CacheItem&lt;T&gt; { Cached = <font color="#0000ff">false</font> , Item = <font color="#0000ff">default</font> (T) }; <font color="#0000ff">object</font> obj = Get(key); <font color="#0000ff">if</font> (obj != <font color="#0000ff">null</font> ) { result.Cached = <font color="#0000ff">true</font> ; result.Item = obj == CacheStorage.Null ? <font color="#0000ff">default</font> (T) : (T)obj; } <font color="#0000ff">return</font> result; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> Put( <font color="#0000ff">string</font> key, <font color="#0000ff">object</font> <font color="#0000ff">value</font> ) { <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> == <font color="#0000ff">null</font> ) { <font color="#0000ff">value</font> = CacheStorage.Null; } <font color="#0000ff">int</font> expirationMinutes = 2; <font color="#2B91AF">HttpContext</font> .Current.Cache.Insert(key, <font color="#0000ff">value</font> , <font color="#0000ff">null</font> , <font color="#2B91AF">DateTime</font> .Now.AddMinutes(expirationMinutes), <font color="#2B91AF">TimeSpan</font> .Zero); } } <font color="#0000ff">public</font> <font color="#0000ff">class</font> CacheItem&lt;T&gt; { <font color="#0000ff">public</font> T Item { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#0000ff">bool</font> Cached { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">class</font> CacheStorage { <font color="#0000ff">internal</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Null = <font color="#0000ff">new</font> Object(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Get( <font color="#0000ff">string</font> index) { <font color="#0000ff">return</font> <font color="#2B91AF">HttpContext</font> .Current.Cache.Get(index); } <font color="#0000ff">public</font> <font color="#0000ff">static</font> CacheItem&lt;T&gt; Get&lt;T&gt;( <font color="#0000ff">string</font> key) { CacheItem&lt;T&gt; result = <font color="#0000ff">new</font> CacheItem&lt;T&gt; { Cached = <font color="#0000ff">false</font> , Item = <font color="#0000ff">default</font> (T) }; <font color="#0000ff">object</font> obj = Get(key); <font color="#0000ff">if</font> (obj != <font color="#0000ff">null</font> ) { result.Cached = <font color="#0000ff">true</font> ; result.Item = obj == CacheStorage.Null ? <font color="#0000ff">default</font> (T) : (T)obj; } <font color="#0000ff">return</font> result; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> Put( <font color="#0000ff">string</font> key, <font color="#0000ff">object</font> <font color="#0000ff">value</font> ) { <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> == <font color="#0000ff">null</font> ) { <font color="#0000ff">value</font> = CacheStorage.Null; } <font color="#0000ff">int</font> expirationMinutes = 2; <font color="#2B91AF">HttpContext</font> .Current.Cache.Insert(key, <font color="#0000ff">value</font> , <font color="#0000ff">null</font> , <font color="#2B91AF">DateTime</font> .Now.AddMinutes(expirationMinutes), <font color="#2B91AF">TimeSpan</font> .Zero); } } <font color="#0000ff">public</font> <font color="#0000ff">class</font> CacheItem&lt;T&gt; { <font color="#0000ff">public</font> T Item { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#0000ff">bool</font> Cached { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">class</font> CacheStorage { <font color="#0000ff">internal</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Null = <font color="#0000ff">new</font> Object(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Get( <font color="#0000ff">string</font> index) { <font color="#0000ff">return</font> <font color="#2B91AF">HttpContext</font> .Current.Cache.Get(index); } <font color="#0000ff">public</font> <font color="#0000ff">static</font> CacheItem&lt;T&gt; Get&lt;T&gt;( <font color="#0000ff">string</font> key) { CacheItem&lt;T&gt; result = <font color="#0000ff">new</font> CacheItem&lt;T&gt; { Cached = <font color="#0000ff">false</font> , Item = <font color="#0000ff">default</font> (T) }; <font color="#0000ff">object</font> obj = Get(key); <font color="#0000ff">if</font> (obj != <font color="#0000ff">null</font> ) { result.Cached = <font color="#0000ff">true</font> ; result.Item = obj == CacheStorage.Null ? <font color="#0000ff">default</font> (T) : (T)obj; } <font color="#0000ff">return</font> result; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> Put( <font color="#0000ff">string</font> key, <font color="#0000ff">object</font> <font color="#0000ff">value</font> ) { <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> == <font color="#0000ff">null</font> ) { <font color="#0000ff">value</font> = CacheStorage.Null; } <font color="#0000ff">int</font> expirationMinutes = 2; <font color="#2B91AF">HttpContext</font> .Current.Cache.Insert(key, <font color="#0000ff">value</font> , <font color="#0000ff">null</font> , <font color="#2B91AF">DateTime</font> .Now.AddMinutes(expirationMinutes), <font color="#2B91AF">TimeSpan</font> .Zero); } } <font color="#0000ff">public</font> <font color="#0000ff">class</font> CacheItem&lt;T&gt; { <font color="#0000ff">public</font> T Item { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#0000ff">bool</font> Cached { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">class</font> CacheStorage { <font color="#0000ff">internal</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Null = <font color="#0000ff">new</font> Object(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Get( <font color="#0000ff">string</font> index) { <font color="#0000ff">return</font> <font color="#2B91AF">HttpContext</font> .Current.Cache.Get(index); } <font color="#0000ff">public</font> <font color="#0000ff">static</font> CacheItem&lt;T&gt; Get&lt;T&gt;( <font color="#0000ff">string</font> key) { CacheItem&lt;T&gt; result = <font color="#0000ff">new</font> CacheItem&lt;T&gt; { Cached = <font color="#0000ff">false</font> , Item = <font color="#0000ff">default</font> (T) }; <font color="#0000ff">object</font> obj = Get(key); <font color="#0000ff">if</font> (obj != <font color="#0000ff">null</font> ) { result.Cached = <font color="#0000ff">true</font> ; result.Item = obj == CacheStorage.Null ? <font color="#0000ff">default</font> (T) : (T)obj; } <font color="#0000ff">return</font> result; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> Put( <font color="#0000ff">string</font> key, <font color="#0000ff">object</font> <font color="#0000ff">value</font> ) { <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> == <font color="#0000ff">null</font> ) { <font color="#0000ff">value</font> = CacheStorage.Null; } <font color="#0000ff">int</font> expirationMinutes = 2; <font color="#2B91AF">HttpContext</font> .Current.Cache.Insert(key, <font color="#0000ff">value</font> , <font color="#0000ff">null</font> , <font color="#2B91AF">DateTime</font> .Now.AddMinutes(expirationMinutes), <font color="#2B91AF">TimeSpan</font> .Zero); } } <font color="#0000ff">public</font> <font color="#0000ff">class</font> CacheItem&lt;T&gt; { <font color="#0000ff">public</font> T Item { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#0000ff">bool</font> Cached { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li></li><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">class</font> CacheStorage { <font color="#0000ff">internal</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Null = <font color="#0000ff">new</font> Object(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Get( <font color="#0000ff">string</font> index) { <font color="#0000ff">return</font> <font color="#2B91AF">HttpContext</font> .Current.Cache.Get(index); } <font color="#0000ff">public</font> <font color="#0000ff">static</font> CacheItem&lt;T&gt; Get&lt;T&gt;( <font color="#0000ff">string</font> key) { CacheItem&lt;T&gt; result = <font color="#0000ff">new</font> CacheItem&lt;T&gt; { Cached = <font color="#0000ff">false</font> , Item = <font color="#0000ff">default</font> (T) }; <font color="#0000ff">object</font> obj = Get(key); <font color="#0000ff">if</font> (obj != <font color="#0000ff">null</font> ) { result.Cached = <font color="#0000ff">true</font> ; result.Item = obj == CacheStorage.Null ? <font color="#0000ff">default</font> (T) : (T)obj; } <font color="#0000ff">return</font> result; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> Put( <font color="#0000ff">string</font> key, <font color="#0000ff">object</font> <font color="#0000ff">value</font> ) { <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> == <font color="#0000ff">null</font> ) { <font color="#0000ff">value</font> = CacheStorage.Null; } <font color="#0000ff">int</font> expirationMinutes = 2; <font color="#2B91AF">HttpContext</font> .Current.Cache.Insert(key, <font color="#0000ff">value</font> , <font color="#0000ff">null</font> , <font color="#2B91AF">DateTime</font> .Now.AddMinutes(expirationMinutes), <font color="#2B91AF">TimeSpan</font> .Zero); } } <font color="#0000ff">public</font> <font color="#0000ff">class</font> CacheItem&lt;T&gt; { <font color="#0000ff">public</font> T Item { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#0000ff">bool</font> Cached { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li></li><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">class</font> CacheStorage { <font color="#0000ff">internal</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Null = <font color="#0000ff">new</font> Object(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Get( <font color="#0000ff">string</font> index) { <font color="#0000ff">return</font> <font color="#2B91AF">HttpContext</font> .Current.Cache.Get(index); } <font color="#0000ff">public</font> <font color="#0000ff">static</font> CacheItem&lt;T&gt; Get&lt;T&gt;( <font color="#0000ff">string</font> key) { CacheItem&lt;T&gt; result = <font color="#0000ff">new</font> CacheItem&lt;T&gt; { Cached = <font color="#0000ff">false</font> , Item = <font color="#0000ff">default</font> (T) }; <font color="#0000ff">object</font> obj = Get(key); <font color="#0000ff">if</font> (obj != <font color="#0000ff">null</font> ) { result.Cached = <font color="#0000ff">true</font> ; result.Item = obj == CacheStorage.Null ? <font color="#0000ff">default</font> (T) : (T)obj; } <font color="#0000ff">return</font> result; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> Put( <font color="#0000ff">string</font> key, <font color="#0000ff">object</font> <font color="#0000ff">value</font> ) { <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> == <font color="#0000ff">null</font> ) { <font color="#0000ff">value</font> = CacheStorage.Null; } <font color="#0000ff">int</font> expirationMinutes = 2; <font color="#2B91AF">HttpContext</font> .Current.Cache.Insert(key, <font color="#0000ff">value</font> , <font color="#0000ff">null</font> , <font color="#2B91AF">DateTime</font> .Now.AddMinutes(expirationMinutes), <font color="#2B91AF">TimeSpan</font> .Zero); } } <font color="#0000ff">public</font> <font color="#0000ff">class</font> CacheItem&lt;T&gt; { <font color="#0000ff">public</font> T Item { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#0000ff">bool</font> Cached { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">class</font> CacheStorage { <font color="#0000ff">internal</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Null = <font color="#0000ff">new</font> Object(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Get( <font color="#0000ff">string</font> index) { <font color="#0000ff">return</font> <font color="#2B91AF">HttpContext</font> .Current.Cache.Get(index); } <font color="#0000ff">public</font> <font color="#0000ff">static</font> CacheItem&lt;T&gt; Get&lt;T&gt;( <font color="#0000ff">string</font> key) { CacheItem&lt;T&gt; result = <font color="#0000ff">new</font> CacheItem&lt;T&gt; { Cached = <font color="#0000ff">false</font> , Item = <font color="#0000ff">default</font> (T) }; <font color="#0000ff">object</font> obj = Get(key); <font color="#0000ff">if</font> (obj != <font color="#0000ff">null</font> ) { result.Cached = <font color="#0000ff">true</font> ; result.Item = obj == CacheStorage.Null ? <font color="#0000ff">default</font> (T) : (T)obj; } <font color="#0000ff">return</font> result; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> Put( <font color="#0000ff">string</font> key, <font color="#0000ff">object</font> <font color="#0000ff">value</font> ) { <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> == <font color="#0000ff">null</font> ) { <font color="#0000ff">value</font> = CacheStorage.Null; } <font color="#0000ff">int</font> expirationMinutes = 2; <font color="#2B91AF">HttpContext</font> .Current.Cache.Insert(key, <font color="#0000ff">value</font> , <font color="#0000ff">null</font> , <font color="#2B91AF">DateTime</font> .Now.AddMinutes(expirationMinutes), <font color="#2B91AF">TimeSpan</font> .Zero); } } <font color="#0000ff">public</font> <font color="#0000ff">class</font> CacheItem&lt;T&gt; { <font color="#0000ff">public</font> T Item { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#0000ff">bool</font> Cached { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">class</font> CacheStorage { <font color="#0000ff">internal</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Null = <font color="#0000ff">new</font> Object(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Get( <font color="#0000ff">string</font> index) { <font color="#0000ff">return</font> <font color="#2B91AF">HttpContext</font> .Current.Cache.Get(index); } <font color="#0000ff">public</font> <font color="#0000ff">static</font> CacheItem&lt;T&gt; Get&lt;T&gt;( <font color="#0000ff">string</font> key) { CacheItem&lt;T&gt; result = <font color="#0000ff">new</font> CacheItem&lt;T&gt; { Cached = <font color="#0000ff">false</font> , Item = <font color="#0000ff">default</font> (T) }; <font color="#0000ff">object</font> obj = Get(key); <font color="#0000ff">if</font> (obj != <font color="#0000ff">null</font> ) { result.Cached = <font color="#0000ff">true</font> ; result.Item = obj == CacheStorage.Null ? <font color="#0000ff">default</font> (T) : (T)obj; } <font color="#0000ff">return</font> result; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> Put( <font color="#0000ff">string</font> key, <font color="#0000ff">object</font> <font color="#0000ff">value</font> ) { <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> == <font color="#0000ff">null</font> ) { <font color="#0000ff">value</font> = CacheStorage.Null; } <font color="#0000ff">int</font> expirationMinutes = 2; <font color="#2B91AF">HttpContext</font> .Current.Cache.Insert(key, <font color="#0000ff">value</font> , <font color="#0000ff">null</font> , <font color="#2B91AF">DateTime</font> .Now.AddMinutes(expirationMinutes), <font color="#2B91AF">TimeSpan</font> .Zero); } } <font color="#0000ff">public</font> <font color="#0000ff">class</font> CacheItem&lt;T&gt; { <font color="#0000ff">public</font> T Item { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#0000ff">bool</font> Cached { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">class</font> CacheStorage { <font color="#0000ff">internal</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Null = <font color="#0000ff">new</font> Object(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Get( <font color="#0000ff">string</font> index) { <font color="#0000ff">return</font> <font color="#2B91AF">HttpContext</font> .Current.Cache.Get(index); } <font color="#0000ff">public</font> <font color="#0000ff">static</font> CacheItem&lt;T&gt; Get&lt;T&gt;( <font color="#0000ff">string</font> key) { CacheItem&lt;T&gt; result = <font color="#0000ff">new</font> CacheItem&lt;T&gt; { Cached = <font color="#0000ff">false</font> , Item = <font color="#0000ff">default</font> (T) }; <font color="#0000ff">object</font> obj = Get(key); <font color="#0000ff">if</font> (obj != <font color="#0000ff">null</font> ) { result.Cached = <font color="#0000ff">true</font> ; result.Item = obj == CacheStorage.Null ? <font color="#0000ff">default</font> (T) : (T)obj; } <font color="#0000ff">return</font> result; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> Put( <font color="#0000ff">string</font> key, <font color="#0000ff">object</font> <font color="#0000ff">value</font> ) { <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> == <font color="#0000ff">null</font> ) { <font color="#0000ff">value</font> = CacheStorage.Null; } <font color="#0000ff">int</font> expirationMinutes = 2; <font color="#2B91AF">HttpContext</font> .Current.Cache.Insert(key, <font color="#0000ff">value</font> , <font color="#0000ff">null</font> , <font color="#2B91AF">DateTime</font> .Now.AddMinutes(expirationMinutes), <font color="#2B91AF">TimeSpan</font> .Zero); } } <font color="#0000ff">public</font> <font color="#0000ff">class</font> CacheItem&lt;T&gt; { <font color="#0000ff">public</font> T Item { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#0000ff">bool</font> Cached { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">class</font> CacheStorage { <font color="#0000ff">internal</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Null = <font color="#0000ff">new</font> Object(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Get( <font color="#0000ff">string</font> index) { <font color="#0000ff">return</font> <font color="#2B91AF">HttpContext</font> .Current.Cache.Get(index); } <font color="#0000ff">public</font> <font color="#0000ff">static</font> CacheItem&lt;T&gt; Get&lt;T&gt;( <font color="#0000ff">string</font> key) { CacheItem&lt;T&gt; result = <font color="#0000ff">new</font> CacheItem&lt;T&gt; { Cached = <font color="#0000ff">false</font> , Item = <font color="#0000ff">default</font> (T) }; <font color="#0000ff">object</font> obj = Get(key); <font color="#0000ff">if</font> (obj != <font color="#0000ff">null</font> ) { result.Cached = <font color="#0000ff">true</font> ; result.Item = obj == CacheStorage.Null ? <font color="#0000ff">default</font> (T) : (T)obj; } <font color="#0000ff">return</font> result; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> Put( <font color="#0000ff">string</font> key, <font color="#0000ff">object</font> <font color="#0000ff">value</font> ) { <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> == <font color="#0000ff">null</font> ) { <font color="#0000ff">value</font> = CacheStorage.Null; } <font color="#0000ff">int</font> expirationMinutes = 2; <font color="#2B91AF">HttpContext</font> .Current.Cache.Insert(key, <font color="#0000ff">value</font> , <font color="#0000ff">null</font> , <font color="#2B91AF">DateTime</font> .Now.AddMinutes(expirationMinutes), <font color="#2B91AF">TimeSpan</font> .Zero); } } <font color="#0000ff">public</font> <font color="#0000ff">class</font> CacheItem&lt;T&gt; { <font color="#0000ff">public</font> T Item { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#0000ff">bool</font> Cached { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li></li><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">class</font> CacheStorage { <font color="#0000ff">internal</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Null = <font color="#0000ff">new</font> Object(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Get( <font color="#0000ff">string</font> index) { <font color="#0000ff">return</font> <font color="#2B91AF">HttpContext</font> .Current.Cache.Get(index); } <font color="#0000ff">public</font> <font color="#0000ff">static</font> CacheItem&lt;T&gt; Get&lt;T&gt;( <font color="#0000ff">string</font> key) { CacheItem&lt;T&gt; result = <font color="#0000ff">new</font> CacheItem&lt;T&gt; { Cached = <font color="#0000ff">false</font> , Item = <font color="#0000ff">default</font> (T) }; <font color="#0000ff">object</font> obj = Get(key); <font color="#0000ff">if</font> (obj != <font color="#0000ff">null</font> ) { result.Cached = <font color="#0000ff">true</font> ; result.Item = obj == CacheStorage.Null ? <font color="#0000ff">default</font> (T) : (T)obj; } <font color="#0000ff">return</font> result; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> Put( <font color="#0000ff">string</font> key, <font color="#0000ff">object</font> <font color="#0000ff">value</font> ) { <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> == <font color="#0000ff">null</font> ) { <font color="#0000ff">value</font> = CacheStorage.Null; } <font color="#0000ff">int</font> expirationMinutes = 2; <font color="#2B91AF">HttpContext</font> .Current.Cache.Insert(key, <font color="#0000ff">value</font> , <font color="#0000ff">null</font> , <font color="#2B91AF">DateTime</font> .Now.AddMinutes(expirationMinutes), <font color="#2B91AF">TimeSpan</font> .Zero); } } <font color="#0000ff">public</font> <font color="#0000ff">class</font> CacheItem&lt;T&gt; { <font color="#0000ff">public</font> T Item { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#0000ff">bool</font> Cached { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">class</font> CacheStorage { <font color="#0000ff">internal</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Null = <font color="#0000ff">new</font> Object(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Get( <font color="#0000ff">string</font> index) { <font color="#0000ff">return</font> <font color="#2B91AF">HttpContext</font> .Current.Cache.Get(index); } <font color="#0000ff">public</font> <font color="#0000ff">static</font> CacheItem&lt;T&gt; Get&lt;T&gt;( <font color="#0000ff">string</font> key) { CacheItem&lt;T&gt; result = <font color="#0000ff">new</font> CacheItem&lt;T&gt; { Cached = <font color="#0000ff">false</font> , Item = <font color="#0000ff">default</font> (T) }; <font color="#0000ff">object</font> obj = Get(key); <font color="#0000ff">if</font> (obj != <font color="#0000ff">null</font> ) { result.Cached = <font color="#0000ff">true</font> ; result.Item = obj == CacheStorage.Null ? <font color="#0000ff">default</font> (T) : (T)obj; } <font color="#0000ff">return</font> result; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> Put( <font color="#0000ff">string</font> key, <font color="#0000ff">object</font> <font color="#0000ff">value</font> ) { <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> == <font color="#0000ff">null</font> ) { <font color="#0000ff">value</font> = CacheStorage.Null; } <font color="#0000ff">int</font> expirationMinutes = 2; <font color="#2B91AF">HttpContext</font> .Current.Cache.Insert(key, <font color="#0000ff">value</font> , <font color="#0000ff">null</font> , <font color="#2B91AF">DateTime</font> .Now.AddMinutes(expirationMinutes), <font color="#2B91AF">TimeSpan</font> .Zero); } } <font color="#0000ff">public</font> <font color="#0000ff">class</font> CacheItem&lt;T&gt; { <font color="#0000ff">public</font> T Item { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#0000ff">bool</font> Cached { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li></li><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">class</font> CacheStorage { <font color="#0000ff">internal</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Null = <font color="#0000ff">new</font> Object(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Get( <font color="#0000ff">string</font> index) { <font color="#0000ff">return</font> <font color="#2B91AF">HttpContext</font> .Current.Cache.Get(index); } <font color="#0000ff">public</font> <font color="#0000ff">static</font> CacheItem&lt;T&gt; Get&lt;T&gt;( <font color="#0000ff">string</font> key) { CacheItem&lt;T&gt; result = <font color="#0000ff">new</font> CacheItem&lt;T&gt; { Cached = <font color="#0000ff">false</font> , Item = <font color="#0000ff">default</font> (T) }; <font color="#0000ff">object</font> obj = Get(key); <font color="#0000ff">if</font> (obj != <font color="#0000ff">null</font> ) { result.Cached = <font color="#0000ff">true</font> ; result.Item = obj == CacheStorage.Null ? <font color="#0000ff">default</font> (T) : (T)obj; } <font color="#0000ff">return</font> result; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> Put( <font color="#0000ff">string</font> key, <font color="#0000ff">object</font> <font color="#0000ff">value</font> ) { <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> == <font color="#0000ff">null</font> ) { <font color="#0000ff">value</font> = CacheStorage.Null; } <font color="#0000ff">int</font> expirationMinutes = 2; <font color="#2B91AF">HttpContext</font> .Current.Cache.Insert(key, <font color="#0000ff">value</font> , <font color="#0000ff">null</font> , <font color="#2B91AF">DateTime</font> .Now.AddMinutes(expirationMinutes), <font color="#2B91AF">TimeSpan</font> .Zero); } } <font color="#0000ff">public</font> <font color="#0000ff">class</font> CacheItem&lt;T&gt; { <font color="#0000ff">public</font> T Item { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#0000ff">bool</font> Cached { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">class</font> CacheStorage { <font color="#0000ff">internal</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Null = <font color="#0000ff">new</font> Object(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Get( <font color="#0000ff">string</font> index) { <font color="#0000ff">return</font> <font color="#2B91AF">HttpContext</font> .Current.Cache.Get(index); } <font color="#0000ff">public</font> <font color="#0000ff">static</font> CacheItem&lt;T&gt; Get&lt;T&gt;( <font color="#0000ff">string</font> key) { CacheItem&lt;T&gt; result = <font color="#0000ff">new</font> CacheItem&lt;T&gt; { Cached = <font color="#0000ff">false</font> , Item = <font color="#0000ff">default</font> (T) }; <font color="#0000ff">object</font> obj = Get(key); <font color="#0000ff">if</font> (obj != <font color="#0000ff">null</font> ) { result.Cached = <font color="#0000ff">true</font> ; result.Item = obj == CacheStorage.Null ? <font color="#0000ff">default</font> (T) : (T)obj; } <font color="#0000ff">return</font> result; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> Put( <font color="#0000ff">string</font> key, <font color="#0000ff">object</font> <font color="#0000ff">value</font> ) { <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> == <font color="#0000ff">null</font> ) { <font color="#0000ff">value</font> = CacheStorage.Null; } <font color="#0000ff">int</font> expirationMinutes = 2; <font color="#2B91AF">HttpContext</font> .Current.Cache.Insert(key, <font color="#0000ff">value</font> , <font color="#0000ff">null</font> , <font color="#2B91AF">DateTime</font> .Now.AddMinutes(expirationMinutes), <font color="#2B91AF">TimeSpan</font> .Zero); } } <font color="#0000ff">public</font> <font color="#0000ff">class</font> CacheItem&lt;T&gt; { <font color="#0000ff">public</font> T Item { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#0000ff">bool</font> Cached { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">class</font> CacheStorage { <font color="#0000ff">internal</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Null = <font color="#0000ff">new</font> Object(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Get( <font color="#0000ff">string</font> index) { <font color="#0000ff">return</font> <font color="#2B91AF">HttpContext</font> .Current.Cache.Get(index); } <font color="#0000ff">public</font> <font color="#0000ff">static</font> CacheItem&lt;T&gt; Get&lt;T&gt;( <font color="#0000ff">string</font> key) { CacheItem&lt;T&gt; result = <font color="#0000ff">new</font> CacheItem&lt;T&gt; { Cached = <font color="#0000ff">false</font> , Item = <font color="#0000ff">default</font> (T) }; <font color="#0000ff">object</font> obj = Get(key); <font color="#0000ff">if</font> (obj != <font color="#0000ff">null</font> ) { result.Cached = <font color="#0000ff">true</font> ; result.Item = obj == CacheStorage.Null ? <font color="#0000ff">default</font> (T) : (T)obj; } <font color="#0000ff">return</font> result; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> Put( <font color="#0000ff">string</font> key, <font color="#0000ff">object</font> <font color="#0000ff">value</font> ) { <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> == <font color="#0000ff">null</font> ) { <font color="#0000ff">value</font> = CacheStorage.Null; } <font color="#0000ff">int</font> expirationMinutes = 2; <font color="#2B91AF">HttpContext</font> .Current.Cache.Insert(key, <font color="#0000ff">value</font> , <font color="#0000ff">null</font> , <font color="#2B91AF">DateTime</font> .Now.AddMinutes(expirationMinutes), <font color="#2B91AF">TimeSpan</font> .Zero); } } <font color="#0000ff">public</font> <font color="#0000ff">class</font> CacheItem&lt;T&gt; { <font color="#0000ff">public</font> T Item { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#0000ff">bool</font> Cached { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">class</font> CacheStorage { <font color="#0000ff">internal</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Null = <font color="#0000ff">new</font> Object(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Get( <font color="#0000ff">string</font> index) { <font color="#0000ff">return</font> <font color="#2B91AF">HttpContext</font> .Current.Cache.Get(index); } <font color="#0000ff">public</font> <font color="#0000ff">static</font> CacheItem&lt;T&gt; Get&lt;T&gt;( <font color="#0000ff">string</font> key) { CacheItem&lt;T&gt; result = <font color="#0000ff">new</font> CacheItem&lt;T&gt; { Cached = <font color="#0000ff">false</font> , Item = <font color="#0000ff">default</font> (T) }; <font color="#0000ff">object</font> obj = Get(key); <font color="#0000ff">if</font> (obj != <font color="#0000ff">null</font> ) { result.Cached = <font color="#0000ff">true</font> ; result.Item = obj == CacheStorage.Null ? <font color="#0000ff">default</font> (T) : (T)obj; } <font color="#0000ff">return</font> result; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> Put( <font color="#0000ff">string</font> key, <font color="#0000ff">object</font> <font color="#0000ff">value</font> ) { <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> == <font color="#0000ff">null</font> ) { <font color="#0000ff">value</font> = CacheStorage.Null; } <font color="#0000ff">int</font> expirationMinutes = 2; <font color="#2B91AF">HttpContext</font> .Current.Cache.Insert(key, <font color="#0000ff">value</font> , <font color="#0000ff">null</font> , <font color="#2B91AF">DateTime</font> .Now.AddMinutes(expirationMinutes), <font color="#2B91AF">TimeSpan</font> .Zero); } } <font color="#0000ff">public</font> <font color="#0000ff">class</font> CacheItem&lt;T&gt; { <font color="#0000ff">public</font> T Item { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#0000ff">bool</font> Cached { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">class</font> CacheStorage { <font color="#0000ff">internal</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Null = <font color="#0000ff">new</font> Object(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Get( <font color="#0000ff">string</font> index) { <font color="#0000ff">return</font> <font color="#2B91AF">HttpContext</font> .Current.Cache.Get(index); } <font color="#0000ff">public</font> <font color="#0000ff">static</font> CacheItem&lt;T&gt; Get&lt;T&gt;( <font color="#0000ff">string</font> key) { CacheItem&lt;T&gt; result = <font color="#0000ff">new</font> CacheItem&lt;T&gt; { Cached = <font color="#0000ff">false</font> , Item = <font color="#0000ff">default</font> (T) }; <font color="#0000ff">object</font> obj = Get(key); <font color="#0000ff">if</font> (obj != <font color="#0000ff">null</font> ) { result.Cached = <font color="#0000ff">true</font> ; result.Item = obj == CacheStorage.Null ? <font color="#0000ff">default</font> (T) : (T)obj; } <font color="#0000ff">return</font> result; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> Put( <font color="#0000ff">string</font> key, <font color="#0000ff">object</font> <font color="#0000ff">value</font> ) { <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> == <font color="#0000ff">null</font> ) { <font color="#0000ff">value</font> = CacheStorage.Null; } <font color="#0000ff">int</font> expirationMinutes = 2; <font color="#2B91AF">HttpContext</font> .Current.Cache.Insert(key, <font color="#0000ff">value</font> , <font color="#0000ff">null</font> , <font color="#2B91AF">DateTime</font> .Now.AddMinutes(expirationMinutes), <font color="#2B91AF">TimeSpan</font> .Zero); } } <font color="#0000ff">public</font> <font color="#0000ff">class</font> CacheItem&lt;T&gt; { <font color="#0000ff">public</font> T Item { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#0000ff">bool</font> Cached { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">class</font> CacheStorage { <font color="#0000ff">internal</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Null = <font color="#0000ff">new</font> Object(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Get( <font color="#0000ff">string</font> index) { <font color="#0000ff">return</font> <font color="#2B91AF">HttpContext</font> .Current.Cache.Get(index); } <font color="#0000ff">public</font> <font color="#0000ff">static</font> CacheItem&lt;T&gt; Get&lt;T&gt;( <font color="#0000ff">string</font> key) { CacheItem&lt;T&gt; result = <font color="#0000ff">new</font> CacheItem&lt;T&gt; { Cached = <font color="#0000ff">false</font> , Item = <font color="#0000ff">default</font> (T) }; <font color="#0000ff">object</font> obj = Get(key); <font color="#0000ff">if</font> (obj != <font color="#0000ff">null</font> ) { result.Cached = <font color="#0000ff">true</font> ; result.Item = obj == CacheStorage.Null ? <font color="#0000ff">default</font> (T) : (T)obj; } <font color="#0000ff">return</font> result; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> Put( <font color="#0000ff">string</font> key, <font color="#0000ff">object</font> <font color="#0000ff">value</font> ) { <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> == <font color="#0000ff">null</font> ) { <font color="#0000ff">value</font> = CacheStorage.Null; } <font color="#0000ff">int</font> expirationMinutes = 2; <font color="#2B91AF">HttpContext</font> .Current.Cache.Insert(key, <font color="#0000ff">value</font> , <font color="#0000ff">null</font> , <font color="#2B91AF">DateTime</font> .Now.AddMinutes(expirationMinutes), <font color="#2B91AF">TimeSpan</font> .Zero); } } <font color="#0000ff">public</font> <font color="#0000ff">class</font> CacheItem&lt;T&gt; { <font color="#0000ff">public</font> T Item { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#0000ff">bool</font> Cached { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li></li><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">class</font> CacheStorage { <font color="#0000ff">internal</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Null = <font color="#0000ff">new</font> Object(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Get( <font color="#0000ff">string</font> index) { <font color="#0000ff">return</font> <font color="#2B91AF">HttpContext</font> .Current.Cache.Get(index); } <font color="#0000ff">public</font> <font color="#0000ff">static</font> CacheItem&lt;T&gt; Get&lt;T&gt;( <font color="#0000ff">string</font> key) { CacheItem&lt;T&gt; result = <font color="#0000ff">new</font> CacheItem&lt;T&gt; { Cached = <font color="#0000ff">false</font> , Item = <font color="#0000ff">default</font> (T) }; <font color="#0000ff">object</font> obj = Get(key); <font color="#0000ff">if</font> (obj != <font color="#0000ff">null</font> ) { result.Cached = <font color="#0000ff">true</font> ; result.Item = obj == CacheStorage.Null ? <font color="#0000ff">default</font> (T) : (T)obj; } <font color="#0000ff">return</font> result; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> Put( <font color="#0000ff">string</font> key, <font color="#0000ff">object</font> <font color="#0000ff">value</font> ) { <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> == <font color="#0000ff">null</font> ) { <font color="#0000ff">value</font> = CacheStorage.Null; } <font color="#0000ff">int</font> expirationMinutes = 2; <font color="#2B91AF">HttpContext</font> .Current.Cache.Insert(key, <font color="#0000ff">value</font> , <font color="#0000ff">null</font> , <font color="#2B91AF">DateTime</font> .Now.AddMinutes(expirationMinutes), <font color="#2B91AF">TimeSpan</font> .Zero); } } <font color="#0000ff">public</font> <font color="#0000ff">class</font> CacheItem&lt;T&gt; { <font color="#0000ff">public</font> T Item { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#0000ff">bool</font> Cached { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li></li><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">class</font> CacheStorage { <font color="#0000ff">internal</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Null = <font color="#0000ff">new</font> Object(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Get( <font color="#0000ff">string</font> index) { <font color="#0000ff">return</font> <font color="#2B91AF">HttpContext</font> .Current.Cache.Get(index); } <font color="#0000ff">public</font> <font color="#0000ff">static</font> CacheItem&lt;T&gt; Get&lt;T&gt;( <font color="#0000ff">string</font> key) { CacheItem&lt;T&gt; result = <font color="#0000ff">new</font> CacheItem&lt;T&gt; { Cached = <font color="#0000ff">false</font> , Item = <font color="#0000ff">default</font> (T) }; <font color="#0000ff">object</font> obj = Get(key); <font color="#0000ff">if</font> (obj != <font color="#0000ff">null</font> ) { result.Cached = <font color="#0000ff">true</font> ; result.Item = obj == CacheStorage.Null ? <font color="#0000ff">default</font> (T) : (T)obj; } <font color="#0000ff">return</font> result; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> Put( <font color="#0000ff">string</font> key, <font color="#0000ff">object</font> <font color="#0000ff">value</font> ) { <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> == <font color="#0000ff">null</font> ) { <font color="#0000ff">value</font> = CacheStorage.Null; } <font color="#0000ff">int</font> expirationMinutes = 2; <font color="#2B91AF">HttpContext</font> .Current.Cache.Insert(key, <font color="#0000ff">value</font> , <font color="#0000ff">null</font> , <font color="#2B91AF">DateTime</font> .Now.AddMinutes(expirationMinutes), <font color="#2B91AF">TimeSpan</font> .Zero); } } <font color="#0000ff">public</font> <font color="#0000ff">class</font> CacheItem&lt;T&gt; { <font color="#0000ff">public</font> T Item { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#0000ff">bool</font> Cached { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">class</font> CacheStorage { <font color="#0000ff">internal</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Null = <font color="#0000ff">new</font> Object(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Get( <font color="#0000ff">string</font> index) { <font color="#0000ff">return</font> <font color="#2B91AF">HttpContext</font> .Current.Cache.Get(index); } <font color="#0000ff">public</font> <font color="#0000ff">static</font> CacheItem&lt;T&gt; Get&lt;T&gt;( <font color="#0000ff">string</font> key) { CacheItem&lt;T&gt; result = <font color="#0000ff">new</font> CacheItem&lt;T&gt; { Cached = <font color="#0000ff">false</font> , Item = <font color="#0000ff">default</font> (T) }; <font color="#0000ff">object</font> obj = Get(key); <font color="#0000ff">if</font> (obj != <font color="#0000ff">null</font> ) { result.Cached = <font color="#0000ff">true</font> ; result.Item = obj == CacheStorage.Null ? <font color="#0000ff">default</font> (T) : (T)obj; } <font color="#0000ff">return</font> result; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> Put( <font color="#0000ff">string</font> key, <font color="#0000ff">object</font> <font color="#0000ff">value</font> ) { <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> == <font color="#0000ff">null</font> ) { <font color="#0000ff">value</font> = CacheStorage.Null; } <font color="#0000ff">int</font> expirationMinutes = 2; <font color="#2B91AF">HttpContext</font> .Current.Cache.Insert(key, <font color="#0000ff">value</font> , <font color="#0000ff">null</font> , <font color="#2B91AF">DateTime</font> .Now.AddMinutes(expirationMinutes), <font color="#2B91AF">TimeSpan</font> .Zero); } } <font color="#0000ff">public</font> <font color="#0000ff">class</font> CacheItem&lt;T&gt; { <font color="#0000ff">public</font> T Item { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#0000ff">bool</font> Cached { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">class</font> CacheStorage { <font color="#0000ff">internal</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Null = <font color="#0000ff">new</font> Object(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Get( <font color="#0000ff">string</font> index) { <font color="#0000ff">return</font> <font color="#2B91AF">HttpContext</font> .Current.Cache.Get(index); } <font color="#0000ff">public</font> <font color="#0000ff">static</font> CacheItem&lt;T&gt; Get&lt;T&gt;( <font color="#0000ff">string</font> key) { CacheItem&lt;T&gt; result = <font color="#0000ff">new</font> CacheItem&lt;T&gt; { Cached = <font color="#0000ff">false</font> , Item = <font color="#0000ff">default</font> (T) }; <font color="#0000ff">object</font> obj = Get(key); <font color="#0000ff">if</font> (obj != <font color="#0000ff">null</font> ) { result.Cached = <font color="#0000ff">true</font> ; result.Item = obj == CacheStorage.Null ? <font color="#0000ff">default</font> (T) : (T)obj; } <font color="#0000ff">return</font> result; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> Put( <font color="#0000ff">string</font> key, <font color="#0000ff">object</font> <font color="#0000ff">value</font> ) { <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> == <font color="#0000ff">null</font> ) { <font color="#0000ff">value</font> = CacheStorage.Null; } <font color="#0000ff">int</font> expirationMinutes = 2; <font color="#2B91AF">HttpContext</font> .Current.Cache.Insert(key, <font color="#0000ff">value</font> , <font color="#0000ff">null</font> , <font color="#2B91AF">DateTime</font> .Now.AddMinutes(expirationMinutes), <font color="#2B91AF">TimeSpan</font> .Zero); } } <font color="#0000ff">public</font> <font color="#0000ff">class</font> CacheItem&lt;T&gt; { <font color="#0000ff">public</font> T Item { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#0000ff">bool</font> Cached { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li></li><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">class</font> CacheStorage { <font color="#0000ff">internal</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Null = <font color="#0000ff">new</font> Object(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Get( <font color="#0000ff">string</font> index) { <font color="#0000ff">return</font> <font color="#2B91AF">HttpContext</font> .Current.Cache.Get(index); } <font color="#0000ff">public</font> <font color="#0000ff">static</font> CacheItem&lt;T&gt; Get&lt;T&gt;( <font color="#0000ff">string</font> key) { CacheItem&lt;T&gt; result = <font color="#0000ff">new</font> CacheItem&lt;T&gt; { Cached = <font color="#0000ff">false</font> , Item = <font color="#0000ff">default</font> (T) }; <font color="#0000ff">object</font> obj = Get(key); <font color="#0000ff">if</font> (obj != <font color="#0000ff">null</font> ) { result.Cached = <font color="#0000ff">true</font> ; result.Item = obj == CacheStorage.Null ? <font color="#0000ff">default</font> (T) : (T)obj; } <font color="#0000ff">return</font> result; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> Put( <font color="#0000ff">string</font> key, <font color="#0000ff">object</font> <font color="#0000ff">value</font> ) { <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> == <font color="#0000ff">null</font> ) { <font color="#0000ff">value</font> = CacheStorage.Null; } <font color="#0000ff">int</font> expirationMinutes = 2; <font color="#2B91AF">HttpContext</font> .Current.Cache.Insert(key, <font color="#0000ff">value</font> , <font color="#0000ff">null</font> , <font color="#2B91AF">DateTime</font> .Now.AddMinutes(expirationMinutes), <font color="#2B91AF">TimeSpan</font> .Zero); } } <font color="#0000ff">public</font> <font color="#0000ff">class</font> CacheItem&lt;T&gt; { <font color="#0000ff">public</font> T Item { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#0000ff">bool</font> Cached { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">class</font> CacheStorage { <font color="#0000ff">internal</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Null = <font color="#0000ff">new</font> Object(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Get( <font color="#0000ff">string</font> index) { <font color="#0000ff">return</font> <font color="#2B91AF">HttpContext</font> .Current.Cache.Get(index); } <font color="#0000ff">public</font> <font color="#0000ff">static</font> CacheItem&lt;T&gt; Get&lt;T&gt;( <font color="#0000ff">string</font> key) { CacheItem&lt;T&gt; result = <font color="#0000ff">new</font> CacheItem&lt;T&gt; { Cached = <font color="#0000ff">false</font> , Item = <font color="#0000ff">default</font> (T) }; <font color="#0000ff">object</font> obj = Get(key); <font color="#0000ff">if</font> (obj != <font color="#0000ff">null</font> ) { result.Cached = <font color="#0000ff">true</font> ; result.Item = obj == CacheStorage.Null ? <font color="#0000ff">default</font> (T) : (T)obj; } <font color="#0000ff">return</font> result; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> Put( <font color="#0000ff">string</font> key, <font color="#0000ff">object</font> <font color="#0000ff">value</font> ) { <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> == <font color="#0000ff">null</font> ) { <font color="#0000ff">value</font> = CacheStorage.Null; } <font color="#0000ff">int</font> expirationMinutes = 2; <font color="#2B91AF">HttpContext</font> .Current.Cache.Insert(key, <font color="#0000ff">value</font> , <font color="#0000ff">null</font> , <font color="#2B91AF">DateTime</font> .Now.AddMinutes(expirationMinutes), <font color="#2B91AF">TimeSpan</font> .Zero); } } <font color="#0000ff">public</font> <font color="#0000ff">class</font> CacheItem&lt;T&gt; { <font color="#0000ff">public</font> T Item { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#0000ff">bool</font> Cached { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">class</font> CacheStorage { <font color="#0000ff">internal</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Null = <font color="#0000ff">new</font> Object(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Get( <font color="#0000ff">string</font> index) { <font color="#0000ff">return</font> <font color="#2B91AF">HttpContext</font> .Current.Cache.Get(index); } <font color="#0000ff">public</font> <font color="#0000ff">static</font> CacheItem&lt;T&gt; Get&lt;T&gt;( <font color="#0000ff">string</font> key) { CacheItem&lt;T&gt; result = <font color="#0000ff">new</font> CacheItem&lt;T&gt; { Cached = <font color="#0000ff">false</font> , Item = <font color="#0000ff">default</font> (T) }; <font color="#0000ff">object</font> obj = Get(key); <font color="#0000ff">if</font> (obj != <font color="#0000ff">null</font> ) { result.Cached = <font color="#0000ff">true</font> ; result.Item = obj == CacheStorage.Null ? <font color="#0000ff">default</font> (T) : (T)obj; } <font color="#0000ff">return</font> result; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> Put( <font color="#0000ff">string</font> key, <font color="#0000ff">object</font> <font color="#0000ff">value</font> ) { <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> == <font color="#0000ff">null</font> ) { <font color="#0000ff">value</font> = CacheStorage.Null; } <font color="#0000ff">int</font> expirationMinutes = 2; <font color="#2B91AF">HttpContext</font> .Current.Cache.Insert(key, <font color="#0000ff">value</font> , <font color="#0000ff">null</font> , <font color="#2B91AF">DateTime</font> .Now.AddMinutes(expirationMinutes), <font color="#2B91AF">TimeSpan</font> .Zero); } } <font color="#0000ff">public</font> <font color="#0000ff">class</font> CacheItem&lt;T&gt; { <font color="#0000ff">public</font> T Item { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#0000ff">bool</font> Cached { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">class</font> CacheStorage { <font color="#0000ff">internal</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Null = <font color="#0000ff">new</font> Object(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Get( <font color="#0000ff">string</font> index) { <font color="#0000ff">return</font> <font color="#2B91AF">HttpContext</font> .Current.Cache.Get(index); } <font color="#0000ff">public</font> <font color="#0000ff">static</font> CacheItem&lt;T&gt; Get&lt;T&gt;( <font color="#0000ff">string</font> key) { CacheItem&lt;T&gt; result = <font color="#0000ff">new</font> CacheItem&lt;T&gt; { Cached = <font color="#0000ff">false</font> , Item = <font color="#0000ff">default</font> (T) }; <font color="#0000ff">object</font> obj = Get(key); <font color="#0000ff">if</font> (obj != <font color="#0000ff">null</font> ) { result.Cached = <font color="#0000ff">true</font> ; result.Item = obj == CacheStorage.Null ? <font color="#0000ff">default</font> (T) : (T)obj; } <font color="#0000ff">return</font> result; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> Put( <font color="#0000ff">string</font> key, <font color="#0000ff">object</font> <font color="#0000ff">value</font> ) { <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> == <font color="#0000ff">null</font> ) { <font color="#0000ff">value</font> = CacheStorage.Null; } <font color="#0000ff">int</font> expirationMinutes = 2; <font color="#2B91AF">HttpContext</font> .Current.Cache.Insert(key, <font color="#0000ff">value</font> , <font color="#0000ff">null</font> , <font color="#2B91AF">DateTime</font> .Now.AddMinutes(expirationMinutes), <font color="#2B91AF">TimeSpan</font> .Zero); } } <font color="#0000ff">public</font> <font color="#0000ff">class</font> CacheItem&lt;T&gt; { <font color="#0000ff">public</font> T Item { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#0000ff">bool</font> Cached { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">class</font> CacheStorage { <font color="#0000ff">internal</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Null = <font color="#0000ff">new</font> Object(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Get( <font color="#0000ff">string</font> index) { <font color="#0000ff">return</font> <font color="#2B91AF">HttpContext</font> .Current.Cache.Get(index); } <font color="#0000ff">public</font> <font color="#0000ff">static</font> CacheItem&lt;T&gt; Get&lt;T&gt;( <font color="#0000ff">string</font> key) { CacheItem&lt;T&gt; result = <font color="#0000ff">new</font> CacheItem&lt;T&gt; { Cached = <font color="#0000ff">false</font> , Item = <font color="#0000ff">default</font> (T) }; <font color="#0000ff">object</font> obj = Get(key); <font color="#0000ff">if</font> (obj != <font color="#0000ff">null</font> ) { result.Cached = <font color="#0000ff">true</font> ; result.Item = obj == CacheStorage.Null ? <font color="#0000ff">default</font> (T) : (T)obj; } <font color="#0000ff">return</font> result; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> Put( <font color="#0000ff">string</font> key, <font color="#0000ff">object</font> <font color="#0000ff">value</font> ) { <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> == <font color="#0000ff">null</font> ) { <font color="#0000ff">value</font> = CacheStorage.Null; } <font color="#0000ff">int</font> expirationMinutes = 2; <font color="#2B91AF">HttpContext</font> .Current.Cache.Insert(key, <font color="#0000ff">value</font> , <font color="#0000ff">null</font> , <font color="#2B91AF">DateTime</font> .Now.AddMinutes(expirationMinutes), <font color="#2B91AF">TimeSpan</font> .Zero); } } <font color="#0000ff">public</font> <font color="#0000ff">class</font> CacheItem&lt;T&gt; { <font color="#0000ff">public</font> T Item { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#0000ff">bool</font> Cached { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } } <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> </ol> <code><font color="gray"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">class</font> CacheStorage { <font color="#0000ff">internal</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Null = <font color="#0000ff">new</font> Object(); <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Get( <font color="#0000ff">string</font> index) { <font color="#0000ff">return</font> <font color="#2B91AF">HttpContext</font> .Current.Cache.Get(index); } <font color="#0000ff">public</font> <font color="#0000ff">static</font> CacheItem&lt;T&gt; Get&lt;T&gt;( <font color="#0000ff">string</font> key) { CacheItem&lt;T&gt; result = <font color="#0000ff">new</font> CacheItem&lt;T&gt; { Cached = <font color="#0000ff">false</font> , Item = <font color="#0000ff">default</font> (T) }; <font color="#0000ff">object</font> obj = Get(key); <font color="#0000ff">if</font> (obj != <font color="#0000ff">null</font> ) { result.Cached = <font color="#0000ff">true</font> ; result.Item = obj == CacheStorage.Null ? <font color="#0000ff">default</font> (T) : (T)obj; } <font color="#0000ff">return</font> result; } <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> Put( <font color="#0000ff">string</font> key, <font color="#0000ff">object</font> <font color="#0000ff">value</font> ) { <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> == <font color="#0000ff">null</font> ) { <font color="#0000ff">value</font> = CacheStorage.Null; } <font color="#0000ff">int</font> expirationMinutes = 2; <font color="#2B91AF">HttpContext</font> .Current.Cache.Insert(key, <font color="#0000ff">value</font> , <font color="#0000ff">null</font> , <font color="#2B91AF">DateTime</font> .Now.AddMinutes(expirationMinutes), <font color="#2B91AF">TimeSpan</font> .Zero); } } <font color="#0000ff">public</font> <font color="#0000ff">class</font> CacheItem&lt;T&gt; { <font color="#0000ff">public</font> T Item { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <font color="#0000ff">public</font> <font color="#0000ff">bool</font> Cached { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } }</font> * This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  The simplest methods are getting the data from the cache and writing: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Get ( <font color="#0000ff">string</font> index) </li><li>  { </li><li>  <font color="#0000ff">return</font> <font color="#2B91AF">HttpContext</font> .Current.Cache.Get (index); </li><li>  } </li><li></li><li>  <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">void</font> Put ( <font color="#0000ff">string</font> key, <font color="#0000ff">object</font> <font color="#0000ff">value</font> ) </li><li>  { </li><li>  <font color="#0000ff">if</font> ( <font color="#0000ff">value</font> == <font color="#0000ff">null</font> ) </li><li>  { </li><li>  <font color="#0000ff">value</font> = CacheStorage.Null; </li><li>  } </li><li></li><li>  <font color="#0000ff">int</font> expirationMinutes = 2; </li><li></li><li>  <font color="#2B91AF">HttpContext</font> .Current.Cache.Insert (key, <font color="#0000ff">value</font> , <font color="#0000ff">null</font> , <font color="#2B91AF">DateTime</font> .Now. AddMinutes (expirationMinutes), <font color="#2B91AF">TimeSpan.</font> Zero); </li><li>  } </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br>  The recording method, of course, needs some work on your application, since  I did it as much as possible (the settings need to be brought out in the configuration, to make support for various caching policies).  You probably noticed that in the Put method there is a condition that checks for the null value that we want to put in the cache.  When this condition is met, we substitute this value for the stub, <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">internal</font> <font color="#0000ff">static</font> <font color="#0000ff">object</font> Null = <font color="#0000ff">new</font> Object (); </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br>  which is not null, but in our context it would be null :) <br><br>  More interesting is the generalized method for retrieving data from the cache.  It returns not just an object of the type we need, but a CacheItem object, which contains, in fact, the return value and the caching flag: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">public</font> <font color="#0000ff">static</font> CacheItem &lt;T&gt; Get &lt;T&gt; ( <font color="#0000ff">string</font> key) </li><li>  { </li><li>  CacheItem &lt;T&gt; result = <font color="#0000ff">new</font> CacheItem &lt;T&gt; </li><li>  { </li><li>  Cached = <font color="#0000ff">false</font> , </li><li>  Item = <font color="#0000ff">default</font> (T) </li><li>  }; </li><li></li><li>  <font color="#0000ff">object</font> obj = Get (key); </li><li></li><li>  <font color="#0000ff">if</font> (obj! = <font color="#0000ff">null</font> ) </li><li>  { </li><li>  result.Cached = <font color="#0000ff">true</font> ; </li><li>  result.Item = obj == CacheStorage.Null?  <font color="#0000ff">default</font> (T): (T) obj; </li><li>  } </li><li></li><li>  <font color="#0000ff">return</font> result; </li><li>  } </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br>  where CacheItem is <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">public</font> <font color="#0000ff">class</font> CacheItem &lt;T&gt; </li><li>  { </li><li>  <font color="#0000ff">public</font> T Item { <font color="#0000ff">get</font> ;  <font color="#0000ff">set</font> ;  } </li><li>  <font color="#0000ff">public</font> <font color="#0000ff">bool</font> Cached { <font color="#0000ff">get</font> ;  <font color="#0000ff">set</font> ;  } </li><li>  } </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br>  That is, if the cache is null, then we return the caching flag false, and the object is returned as the default value (default (T)).  If the cache is not null, then the caching flag will be true, and the object will be the default if the cache stores our null stub, or an object that has been cast to the desired type. <br>  In general, I somehow wonderfully described the work, in the code, I think, it is easier to understand. <br><br>  Now the class with methods for caching LINQ-to-SQL queries: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#0000ff">class</font> QueryResultCache </li><li>  { </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br>  The first method caches the ToList () call: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">public</font> <font color="#0000ff">static</font> <font color="#2B91AF">List</font> &lt;T&gt; FromCache &lt;T&gt; ( <font color="#0000ff">this</font> IQueryable &lt;T&gt; query, </li><li>  <font color="#0000ff">params</font> <font color="#0000ff">object</font> [] parameters) </li><li>  { </li><li>  <font color="#0000ff">string</font> key = QueryResultCache.GetKey (parameters); </li><li></li><li>  <font color="#2B91AF">List</font> &lt;T&gt; result = CacheStorage.Get (key) <font color="#0000ff">as</font> <font color="#2B91AF">List</font> &lt;T&gt;; </li><li></li><li>  <font color="#0000ff">if</font> (result == <font color="#0000ff">null</font> ) </li><li>  { </li><li>  result = query.ToList (); </li><li>  CacheStorage.Put (key, result); </li><li>  } </li><li></li><li>  <font color="#0000ff">return</font> result; </li><li>  } </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br>  The second method caches the call to FirstOrDefault (): <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">public</font> <font color="#0000ff">static</font> T FirstOrDefaultFromCache &lt;T&gt; ( <font color="#0000ff">this</font> IQueryable &lt;T&gt; query, </li><li>  <font color="#0000ff">params</font> <font color="#0000ff">object</font> [] parameters) </li><li>  { </li><li>  <font color="#0000ff">string</font> key = QueryResultCache.GetKey (parameters); </li><li></li><li>  CacheItem &lt;T&gt; result = CacheStorage.Get &lt;T&gt; (key); </li><li></li><li>  <font color="#0000ff">if</font> (! result.Cached) </li><li>  { </li><li>  result.Item = query.FirstOrDefault (); </li><li>  CacheStorage.Put (key, result.Item); </li><li>  } </li><li></li><li>  <font color="#0000ff">return</font> result.Item; </li><li>  } </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br>  In this method, shamanism is used with the CacheItem class (note: for ToList () this is not necessary, because this method always returns a collection; in the absence of data, it will be of zero length) <br>  For placement in the cache, you need a unique key that can be generated in MD5, for example, by gluing the parameters passed to the caching method: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">private</font> <font color="#0000ff">static</font> <font color="#0000ff">string</font> GetKey ( <font color="#0000ff">object</font> [] parameters) </li><li>  { </li><li>  <font color="#0000ff">return</font> GetMD5 ( <font color="#0000ff">string</font> .Join ( <font color="#0000ff">string</font> .Empty, parameters.Select (x =&gt; x.ToString ()). ToArray ())); </li><li>  } </li><li></li><li>  <font color="#0000ff">private</font> <font color="#0000ff">static</font> <font color="#0000ff">string</font> GetMD5 ( <font color="#0000ff">string</font> input) </li><li>  { </li><li>  MD5 md5Hasher = MD5.Create (); </li><li></li><li>  <font color="#0000ff">byte</font> [] data = md5Hasher.ComputeHash ( <font color="#2B91AF">Encoding</font> .Default.GetBytes (input)); </li><li></li><li>  <font color="#2B91AF">StringBuilder</font> sBuilder = <font color="#0000ff">new</font> <font color="#2B91AF">StringBuilder</font> (); </li><li></li><li>  <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt;data.Length; i ++) </li><li>  { </li><li>  sBuilder.Append (data [i] .ToString ( <font color="#A31515">"x2"</font> )); </li><li>  } </li><li></li><li>  <font color="#0000ff">return</font> sBuilder.ToString (); </li><li>  } </li><li>  } </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br>  Now you can try these classes in action.  Let's create a simple application, and cache the List, string and int values.  We start the SQL profiler and see that within 2 minutes the SQL server is resting. <br><br>  All source codes are available <a href="">here</a> (.net 4.0, you need to register your connectionString in web.config. SQL to create the database is in the DB.sql file). <br><br>  Comments and criticism is welcome. </div><p>Source: <a href="https://habr.com/ru/post/106958/">https://habr.com/ru/post/106958/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../106950/index.html">Apartama - a service for interior design and not only</a></li>
<li><a href="../106951/index.html">MSDN: Internet Explorer Developer Center Updated</a></li>
<li><a href="../106953/index.html">Most people seem dumb compared to you.</a></li>
<li><a href="../106954/index.html">Imaginary anonymity</a></li>
<li><a href="../106957/index.html">Why is your online advertising not working?</a></li>
<li><a href="../106963/index.html">James Gosling: why Apple refuses JVM</a></li>
<li><a href="../106964/index.html">New version of DriverPack Solution</a></li>
<li><a href="../106965/index.html">Did you participate in the census?</a></li>
<li><a href="../106968/index.html">If your freelancing does not work - is the freelancer guilty?</a></li>
<li><a href="../106970/index.html">Course young Desire'voda</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>