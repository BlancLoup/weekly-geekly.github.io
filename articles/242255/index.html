<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Ilya Grigorik on the implementation of HTTP / 2</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Well-known server and client optimization specialist, co-author of WebRTC, author of High Perfomance Browser Networking, Google's Ilya Grigorik, publi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Ilya Grigorik on the implementation of HTTP / 2</h1><div class="post__text post__text-html js-mediator-article">  Well-known server and client optimization specialist, co-author of WebRTC, author of High Perfomance Browser Networking, Google's Ilya Grigorik, published the presentation <a href="https://docs.google.com/presentation/d/1l9c9ROjLTD8clOL0yFufAOMbxNC0D-19zCiXMgqtY-M/present%3Fslide%3Did.g40fbe7d8c_03">‚ÄúHTTP / 2 all the things!‚Äù</a> , Which explains how to configure the server part for HTTP 2.0 in order to improve page loading speed and reduced latency compared to HTTP 1.1. <br><br><img src="https://habrastorage.org/files/b6d/93f/31d/b6d93f31d5d34eba896c61fc43a1d3ab.png"><br>  <i>The Connection View mode in the browser shows the loading of the Yahoo.com title page elements in HTTP 1.1.</i> <br><br>  Ilya begins with the fact that for modern sites most of the delays are due to waiting for resources to load, and the bandwidth is not a limiting factor (in blue in the <i>Connection View</i> diagram).  According to statistics, to download the average web page, the browser makes 78 requests to 12 different hosts (the total size of download files is 1232 KB). <br><a name="habracut"></a><br>  For 1 million of the largest Internet sites, according to Alexa, on a 5-megabit channel, the average page load time is <a href="https://groups.google.com/a/chromium.org/forum/">2.413 seconds</a> , with the CPU running only 0.735 seconds, and the rest is waiting for resources from the network (latency) to arrive. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      HTTP 1.1 problems consist in a large number of requests, limited parallelism, not working in practice, pipelining of requests, the presence of concurrent TCP-flows, the overhead of service traffic. <br><br>  Another problem is that webmasters go overboard with domain sharding.  They add too many shards to bypass the browser restriction on 6 simultaneous connections with one server, and because of this they harm themselves.  Traffic is repeatedly duplicated, congestion, retransmissions, etc. occur. <br><br>  Problems with a large number of requests when developing applications for HTTP 1.1 are also solved in the wrong way: through concat (creating large monolithic code fragments, expensive cache invalidation, delayed execution of JSS / CSS) and inline (duplication of resources on each page, broken prioritization). <br><br>  What to do? <br><br>  Everything is very simple.  The new HTTP 2.0 fixes many of the shortcomings of HTTP 1.1, Ilya Grigorik is sure.  HTTP 2.0 does not require the establishment of multiple connections and reduces latency while maintaining the usual HTTP 1.1 semantics. <br><br><img src="https://habrastorage.org/files/a3a/9c9/4de/a3a9c94de5f7492a857eefe43c94b10b.png"><br><br>  First, all the threads are mixed by splitting into frames (HEADERS, DATA, etc.), which are sent over a single TCP connection.  Frames have priority and flow control.  And server-push replaces inline.  And, of course, effective header compression, to the point that the HEADER is ‚Äúcompressed‚Äù to 9 bytes (only changes are transmitted). <br><br><img src="https://habrastorage.org/files/c5f/0c6/89f/c5f0c689f95442a58fabda8a3eff2c93.png"><br><br>  How specifically to use the benefits of HTTP 2.0 to optimize server applications?  This is the most interesting part of the presentation of Ilya Grigorik. <br><br><h3>  Eliminate domain sharding </h3><br>  Sharding specifically beats HTTP / 2 performance, breaks frame prioritization, flow control, and so on. <br><br>  If necessary, you can implement sharding via <code>altName</code> .  If you use one IP and one certificate, then HTTP / 2 will be able to open a single connection for all shards. <br><br><h3>  Get rid of unnecessary optimizations (concat, CSS sprites) </h3><br>  Flows are no longer a limitation, so it is possible to correctly allocate resources across modules, set a caching strategy for each of them. <br><br><h3>  Implement server-push instead of inline </h3><br>  The server can now issue several responses to one request.  The client orders one thing, and the server can give him something else as well.  Each resource is cached independently (it is not necessary to cache for each request, there is a smart push).  By the way, using server-side push notifications, you can also cancel the entry in the client cache! <br><br>  Smart push is generally a great thing.  The server itself analyzes the traffic and builds dependencies, what resources the client requests, depending on the referrer.  For example, <i>index.html ‚Üí {style.css, app.js}</i> .  In accordance with these laws, rules are created for further push notifications to new customers. <br><br><hr><br>  Ilya Grigorik stresses that in the case of HTTP / 2 servers must be properly configured.  This wasn‚Äôt so critical in the days of HTTP / 1.1, but now it‚Äôs true.  For example, in HTTP / 1.1, the browser itself first sent important requests (index.html, style, css), holding the secondary ones (hero.jpg, other.jpg, more.jpg, etc.), but now it does not.  So, if you do not configure the server to process important requests in the first place, then performance will suffer. <br><br>  Further, HTTP / 2 allows fine control of the stream.  For example, you can first send the first few kilobytes of the image (so that the browser decodes the header and determines the size of the image), then the important scripts, and then the rest of the image. <br><br>  Testing has shown that when using SPDY, latency and page loading speed are reduced by 30-40%. <br><br>  For example, Twitter <a href="https://blog.twitter.com/2013/cocoaspdy-spdy-for-ios-os-x">tested the delay in accessing the API</a> in December 2013.  The results in milliseconds are shown in the graph for the 50th, 75th, 95th, and 99th percentiles (median).  Interestingly, SPDY brings more value when a client is connected via the worst communication channel (low latency locale). <br><br><img src="https://habrastorage.org/files/ff4/9dc/1fd/ff49dc1fd0b64f0cb30668af65e4b4dd.png"><br><br><img src="https://habrastorage.org/files/9e9/f1d/3c4/9e9f1d3c48ef4c39ac74bc84efd2416e.png"><br><br>  Google has published its statistics to increase the speed of loading pages <a href="http2.html">a year ago</a> . <br><br><table><tbody><tr><td><br></td><td>  Google News <br></td><td>  Google sites <br></td><td>  Google drive <br></td><td>  Google maps <br></td></tr><tr><td>  Median <br></td><td>  -43% <br></td><td>  -27% <br></td><td>  -23% <br></td><td>  -24% <br></td></tr><tr><td>  5th percentile <br>  (fast connections) <br></td><td>  -32% <br></td><td>  -thirty% <br></td><td>  -15% <br></td><td>  -20% <br></td></tr><tr><td>  95th percentile <br>  (slow connections) <br></td><td>  -44% <br></td><td>  -33% <br></td><td>  -36% <br></td><td>  -28% <br></td></tr></tbody></table>  Native HTTP / 2 support will appear in the nearest stable version of Chrome 39 and in the nearest stable version of Firefox 34, so in just a few months most browsers on the Internet will support HTTP / 2 and be able to take advantage of the new protocol (since SPDY has become part of HTTP / 2, now his separate incarnation is removed from circulation). <br><br>  Github <a href="http2-spec/wiki/Implementations">maintains a list of</a> known HTTP / 2 implementations in C #, NodeJS, C ++, Perl, etc.  The <a href="http2.org/">nghttp2</a> library in C is also <a href="http2.org/">included</a> there. In general, Ilya Grigorik urges everyone to optimize their servers for HTTP / 2 and <a href="https://istlsfastyet.com/">check the correct operation of TLS</a> . </div><p>Source: <a href="https://habr.com/ru/post/242255/">https://habr.com/ru/post/242255/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../242241/index.html">Getting unique content from video blogs</a></li>
<li><a href="../242243/index.html">ASP.NET vNext Likbez</a></li>
<li><a href="../242247/index.html">The first browser specifically for developers: soon</a></li>
<li><a href="../242251/index.html">Algorithms for eliminating false and redundant data in the GPS stream</a></li>
<li><a href="../242253/index.html">As a Windows driver crafty breaks sound in Linux or painful bug searches</a></li>
<li><a href="../242257/index.html">Startup, Westing, Cliff: Shares in Business and Rights of Participants</a></li>
<li><a href="../242261/index.html">Effective Django. Part 2</a></li>
<li><a href="../242263/index.html">We restore the old clock "Electronics-7"</a></li>
<li><a href="../242267/index.html">Free signing for Open Source from Certum</a></li>
<li><a href="../242269/index.html">There will be no exceptions in Rust 1.0</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>