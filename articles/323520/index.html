<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Write me money: iMessage transfers</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="iMessage in fresh versions of iOS has learned to work with third-party extensions. For example, you can now add cats to messages, or even transfer mon...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Write me money: iMessage transfers</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/web/69b/dee/4ee/69bdee4eecdd467cb4f08a335f85e5e7.png" alt="image alt text"></p><br><p>  iMessage in fresh versions of iOS has learned to work with third-party extensions.  For example, you can now add cats to messages, or even transfer money to someone without additional details.  This is a lazy dream - to send money without leaving the messenger, so the development of Yandex.Money sat down for implementation. </p><br><p>  When developing fashionable magic, quests were not without cost, because iMessage tells almost nothing about the recipient of the message.  There is neither a wallet number, nor a full name, nor at least a static ID.  But we came up with a way to find out about the addressee everything you need to send money. <a name="habracut"></a></p><br><h1 id="zachem-voobsche-perevodit-dengi-po-imessage">  Why bother to transfer money using iMessage </h1><br><p>  ... because there is a native Yandex.Money application, where you only need to specify the recipient‚Äôs wallet number.  This can be answered with a counter question: why not implement a simplified mechanism that will not require the user to know the wallet number and switch between applications in the money transfer process? </p><br><p>  Or you can answer even shorter - because people want it, and we can. </p><br><p><img src="https://habrastorage.org/files/ee1/a54/a91/ee1a54a9150e48bba8cbe16dc9b56b63.png" alt="image alt text"><br>  <em>... and no questions in the spirit of "what is your wallet number?", "Where to transfer money?".</em> </p><br><p>  And here the most interesting begins.  Apple is responsible for protecting personal data, so the iMessage extension knows almost nothing about your partner.  Moreover, it will not even get your own phone number from iOS, which does not allow for a head-on transfer with the request for a purse number from the Yandex.Money payment service for some unique features of the iMessage subscriber. </p><br><p>  If you don‚Äôt get any specifics from iMessage, you will have to work around it.  For example, you can exchange the necessary information in the form of service background messages.  To make it clearer, let‚Äôs analyze all this in the code using the example with the main application Yandex.Money and our extension for iMessage. </p><br><p>  Of course, everything described below can be used in other scenarios or applications, not necessarily limited to translations. </p><br><h1 id="kak-podruzhit-imessage-s-osnovnym-prilozheniem">  How to make iMessage friends with the main application </h1><br><p>  First of all, you need to establish data exchange between iMessage and the main application, for which Yandex.Money was included in the App Groups: </p><br><pre><code class="hljs haskell">//  user defaults: <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> appGroupUserDefaults = <span class="hljs-type"><span class="hljs-type">NSUserDefaults</span></span>(suiteName: <span class="hljs-string"><span class="hljs-string">"com.bundle.group"</span></span>) //     ‚Äî        <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> appGroupDirectoryPath = <span class="hljs-type"><span class="hljs-type">FileManager</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">default</span></span>.containerURL(forSecurityApplicationGroupIdentifier: <span class="hljs-string"><span class="hljs-string">"com.bundle.group"</span></span>)</code> </pre> <br><p>  After that, the iMessage extension opens access to the NSUserDefaults user parameters list and the application's local database.  Let's add another Keychain Sharing to access the Keychain storage of mobile Yandex.Money ‚Äî the payment token is stored there: </p><br><p><img src="https://habrastorage.org/files/b77/495/9d3/b774959d389a4cdf9c2e389007160ef4.png" alt="image alt text"></p><br><p>  For translations, you will probably need to show individual screens of the application with pre-filled information, therefore, the processing of your own URL schemes that were previously implemented in Yandex.Money turned out to be very useful.  This allowed you to open the desired program window directly from iMessage by simply navigating to a specific URL.  This completes the preparations, and you can proceed to the message setup. </p><br><p>  To create interactive messages, we use the <strong>MSMessage</strong> class, in which we define the appearance of a new element through the layout property: </p><br><pre> <code class="hljs mel">let <span class="hljs-keyword"><span class="hljs-keyword">layout</span></span> = MSMessageTemplateLayout() <span class="hljs-keyword"><span class="hljs-keyword">layout</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">image</span></span> = UIImage(named: <span class="hljs-string"><span class="hljs-string">"moneyTransfer"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">layout</span></span>.caption = <span class="hljs-string"><span class="hljs-string">"$\(conversation.localParticipantIdentifier.uuidString)   "</span></span> message.<span class="hljs-keyword"><span class="hljs-keyword">layout</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">layout</span></span></code> </pre> <br><p><img src="https://habrastorage.org/files/1e7/962/d15/1e7962d159a64ef3ba1f109b4c4776d9.png" alt="image alt text"><br>  <em>This was the translation interface in the message.</em> </p><br><p>  For more customization in MSMessage, you can set your own image, text fields and URL. </p><br><h1 id="menyaem-abstraktnyy-uuid-na-nechto-bolee-konkretnoe">  Change the abstract UUID to something more specific. </h1><br><p>  In any iMessage conversation, the interlocutors are represented by abstract UUIDs of the form "154D1B67-FF3B-40E2-AB53-49DD127BB1FA".  By UUID, you can understand the number of interlocutors in a chat or use it to get readable usernames in text fields. </p><br><p>  For example, we can add a text description to a new message in which the system replaces the UUID with the sender's name: </p><br><pre> <code class="hljs pgsql">let newMessage = MSMessage(<span class="hljs-keyword"><span class="hljs-keyword">session</span></span>: activeConversation.selectedMessage.<span class="hljs-keyword"><span class="hljs-keyword">session</span></span>) newMessage.summaryText = "$\(conversation.localParticipantIdentifier.uuidString)  \(amount) ‚ÇΩ" ‚Ä¶ conversation.<span class="hljs-keyword"><span class="hljs-keyword">insert</span></span>(newMessage)</code> </pre> <br><p>  You might think that the UUID is unique throughout the entire iMessage network and that the same person is always hiding behind it, but that would be too easy.  In fact, the UUID is different on each device of the same user, and is also recreated when you reinstall the application to which the extension is attached.  Therefore, in order to accurately identify the user and understand that ‚Äúfrom here‚Äù the payment was accurately made, we decided to use the Yandex account UID. </p><br><p>  As we already know, instances of the MSMessage class (messages) can contain multiple text data that is encoded in one web address: </p><br><pre> <code class="hljs objectivec">http:<span class="hljs-comment"><span class="hljs-comment">//yamoney.ru?account=1234567&amp;amount=100&amp;comment=%20</span></span></code> </pre> <br><p>  With this line, we immediately provide the recipient‚Äôs account number, the transfer amount and an explanation for the user.  If the message uses the HTTP or HTTPS URL scheme, then this address will be opened in the macOS browser with a transition to the Yandex.Money mobile web interface.  In iOS, the corresponding extension is called instead. </p><br><p>  Then we decided to store all the text information in a base64-encoded JSON object: </p><br><pre> <code class="hljs objectivec"><span class="hljs-string"><span class="hljs-string">"?data= TWFuIGlzIGRpc3Rpbmd1aXNoZWQsIG5vdC‚Ä¶"</span></span></code> </pre> <br><p>  Using JSON allows you to avoid long uncomfortable URLs, and also adds versatility and saves traffic.  Thus, the collection of information necessary for translation is performed using service messages with coded URLs. </p><br><h1 id="dopustim-vy-perevodite-innokentiyu-1000-r">  Suppose you translate Innocent 1000 p. </h1><br><p>  First, you send a message to Innocent that you want to make a transfer through the Yandex.Money extension interface.  From the useful information in this message only the amount of transfer and comment. </p><br><pre> <code class="hljs ruby">{ <span class="hljs-string"><span class="hljs-string">"status"</span></span>: <span class="hljs-string"><span class="hljs-string">"created"</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   <span class="hljs-string"><span class="hljs-string">"amount"</span></span>: <span class="hljs-string"><span class="hljs-string">"1000"</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   <span class="hljs-string"><span class="hljs-string">"senderId"</span></span>: <span class="hljs-string"><span class="hljs-string">"dc47160234144e198baa62a3e5edafe5"</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>     <span class="hljs-string"><span class="hljs-string">"text"</span></span>: <span class="hljs-string"><span class="hljs-string">" "</span></span> /<span class="hljs-regexp"><span class="hljs-regexp">/    }</span></span></code> </pre> <br><p><img src="https://habrastorage.org/files/04a/9a4/73b/04a9a473b13441c4a2526e22e6e5e43f.png" alt="image alt text"></p><br><p>  Innocent tapaet on the message and he also opens iMessage-extension with a proposal to accept the transfer.  In the reply message from Innocent, the number of his electronic wallet in Yandex.Money is added, if it is authorized in the main application.  If not, using the URL scheme, the extension invokes the application window for authorization. </p><br><pre> <code class="hljs ruby">{ <span class="hljs-string"><span class="hljs-string">"status"</span></span>: <span class="hljs-string"><span class="hljs-string">"accepted"</span></span>, <span class="hljs-string"><span class="hljs-string">"amount"</span></span>: <span class="hljs-string"><span class="hljs-string">"1000"</span></span>, <span class="hljs-string"><span class="hljs-string">"to"</span></span>: <span class="hljs-string"><span class="hljs-string">"4100145388962"</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>     <span class="hljs-string"><span class="hljs-string">"senderId"</span></span>: <span class="hljs-string"><span class="hljs-string">"af865bc2575a803dc9726e876f6ee23f"</span></span>, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>    <span class="hljs-string"><span class="hljs-string">"text"</span></span>: <span class="hljs-string"><span class="hljs-string">" "</span></span> }</code> </pre> <br><p><img src="https://habrastorage.org/files/abe/901/f8d/abe901f8d80f4a3fbb895e0557ea5a1c.png" alt="image alt text"><br>  <em>Payment confirmation.</em> </p><br><p>  As soon as Innocent agrees to transfer, you can send money.  If you are already authorized in the application, the PIN code entry screen will open.  With it, the iMessage extension will decrypt the payment token of their Keychain application, and then make a payment with it.  You can read more about the Yandex.Money API in the <a href="https://tech.yandex.ru/money/doc/dg/concepts/About-docpage/">special help section</a> . </p><br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"status"</span></span>: <span class="hljs-string"><span class="hljs-string">"paid"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"amount"</span></span>: <span class="hljs-string"><span class="hljs-string">"1000"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"to"</span></span>: <span class="hljs-string"><span class="hljs-string">"4100145388962"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"senderId"</span></span>: <span class="hljs-string"><span class="hljs-string">"dc47160234144e198baa62a3e5edafe5"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"text"</span></span>: <span class="hljs-string"><span class="hljs-string">" "</span></span> }</code> </pre> <br><p><img src="https://habrastorage.org/files/1ab/9a6/138/1ab9a6138424466da52d395f83f7c26d.png" alt="image alt text"><br>  <em>PIN verification and success screen.</em> </p><br><p>  When you need to collect money from several interview participants in iMessage, the initiator creates a message with one amount for each recipient, which contains the number of the target wallet.  Recipients need only tapknut on the message and confirm the transfer of the algorithm already familiar to us. </p><br><h1 id="legkaya-krivizna-beta-freymvorka-i-v-celom-pro-interfeys">  Easy curvature of the beta framework, and in general about the interface </h1><br><p>  Unlike most Yandex.Money projects, programmers worked primarily on the payment expansion interface.  Partly from the interest, partly from the desire to quickly roll out the first version of the payment extension for the internal test.  Contrary to popular belief, it turned out very well.  At least, UX-designers were outraged only by the selection of colors, which were replaced by those that you see in the screenshots. </p><br><p>  In general, at the time of the first development of the payment extension under the iMessage framework, the framework was rather raw, due to which it was necessary to deal with all sorts of dissonances: </p><br><p><img src="https://habrastorage.org/files/e11/1ea/0cf/e111ea0cfe824c75910758257e0982de.png" alt="image alt text"><br>  <em>It turned out that the extension out of the box is not very friendly in landscape orientation.</em> </p><br><p><img src="https://habrastorage.org/files/c6a/c98/b4c/c6ac98b4c40c46acb81816adb7bb438c.png" alt="image alt text"><br>  <em>And this example is generally the most favorite</em> - <em>for the first time on iOS a diagonal interface.</em> </p><br><p>  Since we have touched the interfaces, we‚Äôll discuss in more detail the features of working with GUI extensions iMessage. </p><br><p>  The main View Controller for the extension is a class inherited from <strong>MSMessagesAppViewController</strong> , which displays the interface when the extension is activated.  If we want to display other view controller, then the usual calls to present or push will not work here - you need to overlay controllers manually. </p><br><p>  To do this, we wrote a small extension to the UIViewController class: </p><br><pre> <code class="hljs swift"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extension</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UIViewController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">presentChild</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">_</span></span></span></span><span class="hljs-function"><span class="hljs-params"> controller: UIViewController)</span></span></span></span> { addChildViewController(controller) controller.view.frame = view.bounds view.addSubview(controller.view) controller.didMove(toParentViewController: <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>) } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">func</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dismissChild</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { willMove(toParentViewController: <span class="hljs-literal"><span class="hljs-literal">nil</span></span>) view.removeFromSuperview() removeFromParentViewController() } }</code> </pre> <br><p>  An auxiliary function of the main controller can be called tracking the life cycle of an extension, for which we use redefined methods like UIApplicationDelegate. </p><br><p>  For the expansion of Yandex. Money, we managed three of them: </p><br><pre> <code class="hljs haskell"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MessagesViewController</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MSMessagesAppViewController</span></span></span><span class="hljs-class"> { override func willBecomeActive(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">with</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">conversation</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MSConversation</span></span></span><span class="hljs-class">) { super.willBecomeActive(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">with</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">conversation</span></span></span><span class="hljs-class">) //   ,    .  ,    ,    . transferButton.isHidden = conversation.remoteParticipantIdentifiers.count &gt; 1 } override func willSelect(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">_</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">message</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MSMessage</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">conversation</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MSConversation</span></span></span><span class="hljs-class">) { super.willSelect(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">message</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">conversation</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">conversation</span></span></span><span class="hljs-class">) //           present(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">message</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">message</span></span></span><span class="hljs-class">) } override func willTransition(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">to</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">presentationStyle</span></span></span><span class="hljs-class">: </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">MSMessagesAppPresentationStyle</span></span></span><span class="hljs-class">) { super.willTransition(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">to</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">presentationStyle</span></span></span><span class="hljs-class">) //        view controller switch presentationStyle { case .compact: presentChild(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">selectViewController</span></span></span><span class="hljs-class">) case .expanded: present(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">message</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">activeConversation</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">selectedMessage</span></span></span><span class="hljs-class">) } } ... }</span></span></code> </pre> <br><p>  From noteworthy features of building an interface on this, perhaps, everything. </p><br><p>  Our script can be used not only for money transfers, but also in other areas where you need to know some information about the addressee.  For example, iMessage extensions can be adapted for easy sharing of contacts from social networks or for sending out individual invitations to an event. </p><br><p>  <strong>What other payment chips, in your opinion, can be useful in the messenger?</strong> </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/323520/">https://habr.com/ru/post/323520/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../323510/index.html">Veeam Availability Suite now supports integration with Cisco HyperFlex</a></li>
<li><a href="../323512/index.html">Who is interested in the Russian IaaS</a></li>
<li><a href="../323514/index.html">CocoaHeads video footage March 1, 2017</a></li>
<li><a href="../323516/index.html">Complete latent semantic analysis with Python tools</a></li>
<li><a href="../323518/index.html">Development for Sailfish OS: Qt / C ++ Unit Testing under Sailfish OS</a></li>
<li><a href="../323522/index.html">Analyzing book recommendations for developers with Stack Overflow using Python tools</a></li>
<li><a href="../323524/index.html">Learning to learn. Create self-improving AI</a></li>
<li><a href="../323526/index.html">Magic newtype in haskell</a></li>
<li><a href="../323528/index.html">Quality management system: how to understand the standards and start the process of their implementation in the company</a></li>
<li><a href="../323532/index.html">Turquoise Organizations: Examples and Common Answers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>