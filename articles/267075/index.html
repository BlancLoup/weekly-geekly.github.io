<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Parsing the Digit Recognizer Challenge Kaggle Competitions</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, Habr! 



 As promised, I continue to publish the analysis of tasks that I resolved while working with the guys from MLClass.ru . This time, we wi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Parsing the Digit Recognizer Challenge Kaggle Competitions</h1><div class="post__text post__text-html js-mediator-article">  Hi, Habr! <br><br><img src="https://habrastorage.org/files/5bb/a0d/0af/5bba0d0af5514b4b9f22caa4bce3f0b7.png"><br><br>  As promised, I continue to publish the analysis of tasks that I resolved while working with the guys from <a href="http://dscourse.mlclass.ru/">MLClass.ru</a> .  This time, we will analyze the principal component method using the example of the well-known digit recognition task <a href="https://www.kaggle.com/c/digit-recognizer">Digit Recognizer</a> from the Kaggle platform.  The article will be useful for beginners who are just beginning to study data analysis.  By the way, it is not too late to enroll in the course <a href="http://dscourse.mlclass.ru/">Applied data analysis</a> , having the opportunity to pump as quickly as possible in this area. <br><a name="habracut"></a><br><h3>  Introduction </h3><br>  This paper is a natural continuation of the <a href="http://habrahabr.ru/company/mlclass/blog/266727/">study</a> that studies the dependence of the quality of the model on the sample size.  It showed the possibility of reducing the number of objects used in the training sample in order to obtain acceptable results in conditions of limited computing resources.  But, besides the number of objects, the number of features used also affects the size of the data.  Consider this feature on the same data.  The data used was studied in detail in previous work, so we simply load the training sample into <b>R.</b> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="hljs vhdl"><span class="hljs-keyword"><span class="hljs-keyword">library</span></span>(readr) <span class="hljs-keyword"><span class="hljs-keyword">library</span></span>(caret) <span class="hljs-keyword"><span class="hljs-keyword">library</span></span>(ggbiplot) <span class="hljs-keyword"><span class="hljs-keyword">library</span></span>(ggplot2) <span class="hljs-keyword"><span class="hljs-keyword">library</span></span>(dplyr) <span class="hljs-keyword"><span class="hljs-keyword">library</span></span>(rgl) data_train &lt;- read_csv(<span class="hljs-string"><span class="hljs-string">"train.csv"</span></span>) ## |================================================================================| <span class="hljs-number"><span class="hljs-number">100</span></span>% <span class="hljs-number"><span class="hljs-number">73</span></span> MB</code> </pre> <br>  As we already know, the data has 42000 objects and 784 signs, representing the brightness value of each of the pixels of the figure constituting the image.  Divide the sample into a training and test in the ratio of 60/40. <br><br><pre> <code class="hljs sql">set.seed(<span class="hljs-number"><span class="hljs-number">111</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">split</span></span> &lt;- createDataPartition(data_train$label, p = <span class="hljs-number"><span class="hljs-number">0.6</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">list</span></span> = <span class="hljs-literal"><span class="hljs-literal">FALSE</span></span>) train &lt;- slice(data_train, <span class="hljs-keyword"><span class="hljs-keyword">split</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">test</span></span> &lt;- slice(data_train, -<span class="hljs-keyword"><span class="hljs-keyword">split</span></span>)</code> </pre><br>  Now we remove the attributes that have a constant value. <br><br><pre> <code class="hljs bash">zero_var_col &lt;- nearZeroVar(train, saveMetrics = T) train &lt;- train[, !zero_var_col<span class="hljs-variable"><span class="hljs-variable">$nzv</span></span>] <span class="hljs-built_in"><span class="hljs-built_in">test</span></span> &lt;- <span class="hljs-built_in"><span class="hljs-built_in">test</span></span>[, !zero_var_col<span class="hljs-variable"><span class="hljs-variable">$nzv</span></span>] dim(train) <span class="hljs-comment"><span class="hljs-comment">## [1] 25201 253</span></span></code> </pre><br>  As a result, 253 signs remained. <br><br><h3>  Theory </h3><br>  The principal component method (PCA) converts the basic features into new ones, each of which is a linear combination of the original ones in such a way that the spread of data (that is, the standard deviation from the mean value) along them is maximum.  The method is used to visualize data and to reduce data dimension (compression). <br><br><h3>  PCA </h3><br>  For greater clarity, we randomly select 1000 objects from a training sample and draw them in the space of the first two features. <br><br><pre> <code class="hljs xml">train_1000 <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">-</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">train</span></span></span><span class="hljs-tag">[</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">sample</span></span></span><span class="hljs-tag">(</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">nrow</span></span></span><span class="hljs-tag">(</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">train</span></span></span><span class="hljs-tag">), </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">size</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">1000),]</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ggplot</span></span></span><span class="hljs-tag">(</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">train_1000,</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">aes</span></span></span><span class="hljs-tag">(</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">x</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">pixel152,</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">y</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">pixel153,</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">color</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">factor(label)))</span></span></span><span class="hljs-tag"> + </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">geom_point</span></span></span><span class="hljs-tag">()</span></span></code> </pre><br><br><img src="https://habrastorage.org/files/5f2/370/d79/5f2370d791b34bacab313066aa5b0fa5.png"><br><br>  Obviously, the objects are mixed and to select among them groups of objects belonging to the same class is problematic.  We will transform the data using the principal component method and draw the first two components in space.  I note that the components are arranged in descending order, depending on the spread of data that falls along them. <br><br><pre> <code class="hljs lisp">pc &lt;- princomp(<span class="hljs-name"><span class="hljs-name">train_1000</span></span>[, <span class="hljs-number"><span class="hljs-number">-1</span></span>], cor=TRUE, scores=TRUE) ggbiplot(<span class="hljs-name"><span class="hljs-name">pc</span></span>, obs.scale = <span class="hljs-number"><span class="hljs-number">1</span></span>, var.scale = <span class="hljs-number"><span class="hljs-number">1</span></span>, groups = factor(<span class="hljs-name"><span class="hljs-name">train_1000</span></span>$label), ellipse = TRUE, circle = F, var.axes = F) + scale_color_discrete(<span class="hljs-name"><span class="hljs-name">name</span></span> = '') + theme(<span class="hljs-name"><span class="hljs-name">legend</span></span>.direction = 'horizontal', legend.position = 'top')</code> </pre><br><img src="https://habrastorage.org/files/f62/6bd/23a/f626bd23aaae4bfc88d29895313e4693.png"><br><br>  Obviously, even in the space of only two signs, it is already possible to select explicit groups of objects.  Now consider the same data, but in the space of the first three components. <br><br><pre> <code class="hljs mel">plot3d(pc$scores[,<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">3</span></span>], col= train_1000$label + <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">size</span></span> = <span class="hljs-number"><span class="hljs-number">0.7</span></span>, type = <span class="hljs-string"><span class="hljs-string">"s"</span></span>)</code> </pre><br><img src="https://habrastorage.org/files/bd3/9e8/5a8/bd39e85a849047269cb07bedfb37c9f2.png"><br><br>  Allocation of various classes is even easier.  Now select the number of components that we will use for further work.  To do this, look at the ratio of the variance and the number of components explaining it, but using the entire training sample. <br><br><pre> <code class="hljs haskell"><span class="hljs-title"><span class="hljs-title">pc</span></span> &lt;- princomp(train[, <span class="hljs-number"><span class="hljs-number">-1</span></span>], cor=<span class="hljs-type"><span class="hljs-type">TRUE</span></span>, scores=<span class="hljs-type"><span class="hljs-type">TRUE</span></span>) variance &lt;- pc$sdev^<span class="hljs-number"><span class="hljs-number">2</span></span>/sum(pc$sdev^<span class="hljs-number"><span class="hljs-number">2</span></span>) cumvar &lt;- cumsum(variance) cumvar &lt;- <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class">.frame(</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">PC</span></span></span><span class="hljs-class"> = 1:252, </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CumVar</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">cumvar</span></span></span><span class="hljs-class">) ggplot(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">data</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">cumvar</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">aes</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">x</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">PC</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">y</span></span></span><span class="hljs-class"> = </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">CumVar</span></span></span><span class="hljs-class">)) + geom_point()</span></span></code> </pre><br><img src="https://habrastorage.org/files/84f/517/6ed/84f5176ed3c34aed99e574a217ec0f0f.png"><br><br><pre> <code class="hljs xml">variance <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">-</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data.frame</span></span></span><span class="hljs-tag">(</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">PC</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">1:252,</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Var</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">variance*100)</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ggplot</span></span></span><span class="hljs-tag">(</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">variance[1:10,],</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">aes</span></span></span><span class="hljs-tag">(</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">x</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">factor(PC),</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">y</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">Var))</span></span></span><span class="hljs-tag"> + </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">geom_bar</span></span></span><span class="hljs-tag">(</span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">stat</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"identity"</span></span></span><span class="hljs-tag">)</span></span></code> </pre><br><img src="https://habrastorage.org/files/83d/6a2/1a8/83d6a21a8d254b76817c3f14bc73105f.png"><br><br><pre> <code class="hljs axapta"><span class="hljs-keyword"><span class="hljs-keyword">sum</span></span>(variance$Var[<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">70</span></span>]) <span class="hljs-meta"><span class="hljs-meta">## [1] 92.69142</span></span></code> </pre><br>  In order to save more than 90 percent of the information contained in the data, only 70 components are sufficient, i.e.  we have come from 784 signs to 70 and, at the same time, have lost less than 10 percent of the data variation! <br><br>  We transform the training and test samples into the space of the main components. <br><br><pre> <code class="hljs mel">train &lt;- predict(pc) %&gt;% cbind(train$label, .) %&gt;% as.data.frame(.) %&gt;% <span class="hljs-keyword"><span class="hljs-keyword">select</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">71</span></span>) colnames(train)[<span class="hljs-number"><span class="hljs-number">1</span></span>]&lt;- <span class="hljs-string"><span class="hljs-string">"label"</span></span> train$label &lt;- as.factor(train$label) test %&lt;&gt;% predict(pc, .) %&gt;% cbind(test$label, .) %&gt;% as.data.frame(.) %&gt;% <span class="hljs-keyword"><span class="hljs-keyword">select</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">71</span></span>) colnames(test)[<span class="hljs-number"><span class="hljs-number">1</span></span>]&lt;- <span class="hljs-string"><span class="hljs-string">"label"</span></span></code> </pre><br>  To select model parameters, I use the caret package, which provides the ability to perform parallel computations using the multi-core processors of today. <br><br><pre> <code class="hljs lisp">library(<span class="hljs-string"><span class="hljs-string">"doParallel"</span></span>) cl &lt;- makePSOCKcluster(<span class="hljs-number"><span class="hljs-number">2</span></span>) registerDoParallel(<span class="hljs-name"><span class="hljs-name">cl</span></span>)</code> </pre><br><h4>  Knn </h4><br>  Now let's start creating predictive models using transformed data.  Create the first model using the k-nearest-neighbor ( <b>KNN</b> ) method.  In this model, there is only one parameter - the number of nearby objects used to classify an object.  We will select this parameter using tenfold cross-validation ( <b>10-fold cross-validation (CV)</b> ) with the sample split into 10 parts.  Evaluation is made on a randomly selected part of the original objects.  To assess the quality of the models, we will use the <b>Accuracy</b> metric, which is the percentage of exactly predicted classes of objects. <br><br><pre> <code class="hljs kotlin"><span class="hljs-keyword"><span class="hljs-keyword">set</span></span>.seed(<span class="hljs-number"><span class="hljs-number">111</span></span>) train_1000 &lt;- train[sample(nrow(train), size = <span class="hljs-number"><span class="hljs-number">1000</span></span>),] ctrl &lt;- trainControl(method=<span class="hljs-string"><span class="hljs-string">"repeatedcv"</span></span>,repeats = <span class="hljs-number"><span class="hljs-number">3</span></span>)       . knnFit &lt;- train(label ~ ., <span class="hljs-keyword"><span class="hljs-keyword">data</span></span> = train_1000, method = <span class="hljs-string"><span class="hljs-string">"knn"</span></span>, trControl = ctrl,tuneLength = <span class="hljs-number"><span class="hljs-number">20</span></span>) knnFit ## k-Nearest Neighbors ## ## <span class="hljs-number"><span class="hljs-number">1000</span></span> samples ## <span class="hljs-number"><span class="hljs-number">70</span></span> predictor ## <span class="hljs-number"><span class="hljs-number">10</span></span> classes: <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'1'</span></span>, <span class="hljs-string"><span class="hljs-string">'2'</span></span>, <span class="hljs-string"><span class="hljs-string">'3'</span></span>, <span class="hljs-string"><span class="hljs-string">'4'</span></span>, <span class="hljs-string"><span class="hljs-string">'5'</span></span>, <span class="hljs-string"><span class="hljs-string">'6'</span></span>, <span class="hljs-string"><span class="hljs-string">'7'</span></span>, <span class="hljs-string"><span class="hljs-string">'8'</span></span>, <span class="hljs-string"><span class="hljs-string">'9'</span></span> ## ## No pre-processing ## Resampling: Cross-Validated (<span class="hljs-number"><span class="hljs-number">10</span></span> fold, repeated <span class="hljs-number"><span class="hljs-number">3</span></span> times) ## Summary of sample sizes: <span class="hljs-number"><span class="hljs-number">899</span></span>, <span class="hljs-number"><span class="hljs-number">901</span></span>, <span class="hljs-number"><span class="hljs-number">900</span></span>, <span class="hljs-number"><span class="hljs-number">901</span></span>, <span class="hljs-number"><span class="hljs-number">899</span></span>, <span class="hljs-number"><span class="hljs-number">899</span></span>, ... ## Resampling results across tuning parameters: ## ## k Accuracy Kappa Accuracy SD Kappa SD ## <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">0.8749889</span></span> <span class="hljs-number"><span class="hljs-number">0.8608767</span></span> <span class="hljs-number"><span class="hljs-number">0.03637257</span></span> <span class="hljs-number"><span class="hljs-number">0.04047629</span></span> ## <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-number"><span class="hljs-number">0.8679743</span></span> <span class="hljs-number"><span class="hljs-number">0.8530101</span></span> <span class="hljs-number"><span class="hljs-number">0.03458659</span></span> <span class="hljs-number"><span class="hljs-number">0.03853048</span></span> ## <span class="hljs-number"><span class="hljs-number">9</span></span> <span class="hljs-number"><span class="hljs-number">0.8652707</span></span> <span class="hljs-number"><span class="hljs-number">0.8500155</span></span> <span class="hljs-number"><span class="hljs-number">0.03336461</span></span> <span class="hljs-number"><span class="hljs-number">0.03713965</span></span> ## <span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-number"><span class="hljs-number">0.8529954</span></span> <span class="hljs-number"><span class="hljs-number">0.8363199</span></span> <span class="hljs-number"><span class="hljs-number">0.03692823</span></span> <span class="hljs-number"><span class="hljs-number">0.04114777</span></span> ## <span class="hljs-number"><span class="hljs-number">13</span></span> <span class="hljs-number"><span class="hljs-number">0.8433141</span></span> <span class="hljs-number"><span class="hljs-number">0.8255274</span></span> <span class="hljs-number"><span class="hljs-number">0.03184725</span></span> <span class="hljs-number"><span class="hljs-number">0.03548771</span></span> ## <span class="hljs-number"><span class="hljs-number">15</span></span> <span class="hljs-number"><span class="hljs-number">0.8426833</span></span> <span class="hljs-number"><span class="hljs-number">0.8248052</span></span> <span class="hljs-number"><span class="hljs-number">0.04097424</span></span> <span class="hljs-number"><span class="hljs-number">0.04568565</span></span> ## <span class="hljs-number"><span class="hljs-number">17</span></span> <span class="hljs-number"><span class="hljs-number">0.8423694</span></span> <span class="hljs-number"><span class="hljs-number">0.8244683</span></span> <span class="hljs-number"><span class="hljs-number">0.04070299</span></span> <span class="hljs-number"><span class="hljs-number">0.04540152</span></span> ## <span class="hljs-number"><span class="hljs-number">19</span></span> <span class="hljs-number"><span class="hljs-number">0.8340150</span></span> <span class="hljs-number"><span class="hljs-number">0.8151256</span></span> <span class="hljs-number"><span class="hljs-number">0.04291349</span></span> <span class="hljs-number"><span class="hljs-number">0.04788273</span></span> ## <span class="hljs-number"><span class="hljs-number">21</span></span> <span class="hljs-number"><span class="hljs-number">0.8263450</span></span> <span class="hljs-number"><span class="hljs-number">0.8065723</span></span> <span class="hljs-number"><span class="hljs-number">0.03914363</span></span> <span class="hljs-number"><span class="hljs-number">0.04369889</span></span> ## <span class="hljs-number"><span class="hljs-number">23</span></span> <span class="hljs-number"><span class="hljs-number">0.8200042</span></span> <span class="hljs-number"><span class="hljs-number">0.7995067</span></span> <span class="hljs-number"><span class="hljs-number">0.03872017</span></span> <span class="hljs-number"><span class="hljs-number">0.04320466</span></span> ## <span class="hljs-number"><span class="hljs-number">25</span></span> <span class="hljs-number"><span class="hljs-number">0.8156764</span></span> <span class="hljs-number"><span class="hljs-number">0.7946582</span></span> <span class="hljs-number"><span class="hljs-number">0.03825163</span></span> <span class="hljs-number"><span class="hljs-number">0.04269085</span></span> ## <span class="hljs-number"><span class="hljs-number">27</span></span> <span class="hljs-number"><span class="hljs-number">0.8093227</span></span> <span class="hljs-number"><span class="hljs-number">0.7875839</span></span> <span class="hljs-number"><span class="hljs-number">0.04299301</span></span> <span class="hljs-number"><span class="hljs-number">0.04799252</span></span> ## <span class="hljs-number"><span class="hljs-number">29</span></span> <span class="hljs-number"><span class="hljs-number">0.8010018</span></span> <span class="hljs-number"><span class="hljs-number">0.7783100</span></span> <span class="hljs-number"><span class="hljs-number">0.04252630</span></span> <span class="hljs-number"><span class="hljs-number">0.04747852</span></span> ## <span class="hljs-number"><span class="hljs-number">31</span></span> <span class="hljs-number"><span class="hljs-number">0.8019849</span></span> <span class="hljs-number"><span class="hljs-number">0.7794036</span></span> <span class="hljs-number"><span class="hljs-number">0.04327120</span></span> <span class="hljs-number"><span class="hljs-number">0.04827493</span></span> ## <span class="hljs-number"><span class="hljs-number">33</span></span> <span class="hljs-number"><span class="hljs-number">0.7963572</span></span> <span class="hljs-number"><span class="hljs-number">0.7731147</span></span> <span class="hljs-number"><span class="hljs-number">0.04418378</span></span> <span class="hljs-number"><span class="hljs-number">0.04930341</span></span> ## <span class="hljs-number"><span class="hljs-number">35</span></span> <span class="hljs-number"><span class="hljs-number">0.7936906</span></span> <span class="hljs-number"><span class="hljs-number">0.7701616</span></span> <span class="hljs-number"><span class="hljs-number">0.04012802</span></span> <span class="hljs-number"><span class="hljs-number">0.04478789</span></span> ## <span class="hljs-number"><span class="hljs-number">37</span></span> <span class="hljs-number"><span class="hljs-number">0.7889930</span></span> <span class="hljs-number"><span class="hljs-number">0.7649252</span></span> <span class="hljs-number"><span class="hljs-number">0.04163075</span></span> <span class="hljs-number"><span class="hljs-number">0.04644193</span></span> ## <span class="hljs-number"><span class="hljs-number">39</span></span> <span class="hljs-number"><span class="hljs-number">0.7863463</span></span> <span class="hljs-number"><span class="hljs-number">0.7619669</span></span> <span class="hljs-number"><span class="hljs-number">0.03947693</span></span> <span class="hljs-number"><span class="hljs-number">0.04404655</span></span> ## <span class="hljs-number"><span class="hljs-number">41</span></span> <span class="hljs-number"><span class="hljs-number">0.7829758</span></span> <span class="hljs-number"><span class="hljs-number">0.7582087</span></span> <span class="hljs-number"><span class="hljs-number">0.03482612</span></span> <span class="hljs-number"><span class="hljs-number">0.03889550</span></span> ## <span class="hljs-number"><span class="hljs-number">43</span></span> <span class="hljs-number"><span class="hljs-number">0.7796388</span></span> <span class="hljs-number"><span class="hljs-number">0.7544879</span></span> <span class="hljs-number"><span class="hljs-number">0.03745359</span></span> <span class="hljs-number"><span class="hljs-number">0.04179976</span></span> ## ## Accuracy was used to select the optimal model using the largest value. ## The <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> value used <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> the model was k = <span class="hljs-number"><span class="hljs-number">5</span></span>.</code> </pre><br>  Now reduce it and get the exact value. <br><br><pre> <code class="hljs mel"><span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> &lt;- expand.<span class="hljs-keyword"><span class="hljs-keyword">grid</span></span>(k=<span class="hljs-number"><span class="hljs-number">2</span></span>:<span class="hljs-number"><span class="hljs-number">5</span></span>) knnFit &lt;- train(label ~ ., data = train_1000, method = <span class="hljs-string"><span class="hljs-string">"knn"</span></span>, trControl = ctrl, tuneGrid=<span class="hljs-keyword"><span class="hljs-keyword">grid</span></span>) knnFit ## k-Nearest Neighbors ## ## <span class="hljs-number"><span class="hljs-number">1000</span></span> samples ## <span class="hljs-number"><span class="hljs-number">70</span></span> predictor ## <span class="hljs-number"><span class="hljs-number">10</span></span> classes: <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'1'</span></span>, <span class="hljs-string"><span class="hljs-string">'2'</span></span>, <span class="hljs-string"><span class="hljs-string">'3'</span></span>, <span class="hljs-string"><span class="hljs-string">'4'</span></span>, <span class="hljs-string"><span class="hljs-string">'5'</span></span>, <span class="hljs-string"><span class="hljs-string">'6'</span></span>, <span class="hljs-string"><span class="hljs-string">'7'</span></span>, <span class="hljs-string"><span class="hljs-string">'8'</span></span>, <span class="hljs-string"><span class="hljs-string">'9'</span></span> ## ## No pre-processing ## Resampling: Cross-Validated (<span class="hljs-number"><span class="hljs-number">10</span></span> fold, repeated <span class="hljs-number"><span class="hljs-number">3</span></span> times) ## Summary of sample sizes: <span class="hljs-number"><span class="hljs-number">900</span></span>, <span class="hljs-number"><span class="hljs-number">901</span></span>, <span class="hljs-number"><span class="hljs-number">901</span></span>, <span class="hljs-number"><span class="hljs-number">899</span></span>, <span class="hljs-number"><span class="hljs-number">901</span></span>, <span class="hljs-number"><span class="hljs-number">899</span></span>, ... ## Resampling results across tuning parameters: ## ## k Accuracy Kappa Accuracy SD Kappa SD ## <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">0.8699952</span></span> <span class="hljs-number"><span class="hljs-number">0.8553199</span></span> <span class="hljs-number"><span class="hljs-number">0.03055544</span></span> <span class="hljs-number"><span class="hljs-number">0.03402108</span></span> ## <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">0.8799832</span></span> <span class="hljs-number"><span class="hljs-number">0.8664399</span></span> <span class="hljs-number"><span class="hljs-number">0.02768544</span></span> <span class="hljs-number"><span class="hljs-number">0.03082014</span></span> ## <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">0.8736591</span></span> <span class="hljs-number"><span class="hljs-number">0.8593777</span></span> <span class="hljs-number"><span class="hljs-number">0.02591618</span></span> <span class="hljs-number"><span class="hljs-number">0.02888557</span></span> ## <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">0.8726753</span></span> <span class="hljs-number"><span class="hljs-number">0.8582703</span></span> <span class="hljs-number"><span class="hljs-number">0.02414173</span></span> <span class="hljs-number"><span class="hljs-number">0.02689738</span></span> ## ## Accuracy was used to <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> the optimal model using the largest value. ## The final value used <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> the model was k = <span class="hljs-number"><span class="hljs-number">3.</span></span></code> </pre><br>  The model has the best indicator when the value of the parameter k is equal to 3. Using this value, we obtain the prediction on the test data.  Construct the <b>Confusion Table</b> and calculate <b>Accuracy</b> . <br><br><pre> <code class="hljs python">library(<span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">prediction_knn</span></span></span><span class="hljs-class"> &lt;- </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">knn</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(train, test, train$label, k=</span></span><span class="hljs-number"><span class="hljs-class"><span class="hljs-params"><span class="hljs-number">3</span></span></span></span><span class="hljs-class"><span class="hljs-params">)</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">table</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(test$label, prediction_knn)</span></span></span><span class="hljs-class"> ## </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">prediction_knn</span></span></span><span class="hljs-class"> ## 0 1 2 3 4 5 6 7 8 9 ## 0 1643 0 6 1 0 1 2 0 0 0 ## 1 0 1861 4 1 2 0 0 0 0 0 ## 2 7 7 1647 3 0 0 1 11 0 0 ## 3 1 0 9 1708 2 19 4 6 1 3 ## 4 0 4 0 0 1589 0 10 7 0 6 ## 5 3 2 1 20 1 1474 13 0 6 2 ## 6 0 0 0 1 2 3 1660 0 0 0 ## 7 0 6 3 0 2 0 0 1721 0 13 ## 8 0 1 0 11 1 16 12 4 1522 20 ## 9 0 0 1 3 3 5 1 23 5 1672 </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sum</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(diag</span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params"><span class="hljs-params">(table</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params"><span class="hljs-params"><span class="hljs-params">(test$label, prediction_knn)</span></span></span></span></span><span class="hljs-class"><span class="hljs-params"><span class="hljs-params">)</span></span></span></span><span class="hljs-class"><span class="hljs-params">)</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">nrow</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(test)</span></span></span><span class="hljs-class"> ## [1] 0.9820227</span></span></code> </pre><br><br><h4>  Random forest </h4><br>  The second model is <b>Random Forest</b> .  In this model, we will choose the parameter <b>mtry</b> - the number of signs used when obtaining each of the trees used in the ensemble.  To select the best value of this parameter, let's go the same way as before. <br><br><pre> <code class="hljs mel">rfFit &lt;- train(label ~ ., data = train_1000, method = <span class="hljs-string"><span class="hljs-string">"rf"</span></span>, trControl = ctrl,tuneLength = <span class="hljs-number"><span class="hljs-number">3</span></span>) rfFit ## Random Forest ## ## <span class="hljs-number"><span class="hljs-number">1000</span></span> samples ## <span class="hljs-number"><span class="hljs-number">70</span></span> predictor ## <span class="hljs-number"><span class="hljs-number">10</span></span> classes: <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'1'</span></span>, <span class="hljs-string"><span class="hljs-string">'2'</span></span>, <span class="hljs-string"><span class="hljs-string">'3'</span></span>, <span class="hljs-string"><span class="hljs-string">'4'</span></span>, <span class="hljs-string"><span class="hljs-string">'5'</span></span>, <span class="hljs-string"><span class="hljs-string">'6'</span></span>, <span class="hljs-string"><span class="hljs-string">'7'</span></span>, <span class="hljs-string"><span class="hljs-string">'8'</span></span>, <span class="hljs-string"><span class="hljs-string">'9'</span></span> ## ## No pre-processing ## Resampling: Cross-Validated (<span class="hljs-number"><span class="hljs-number">10</span></span> fold, repeated <span class="hljs-number"><span class="hljs-number">3</span></span> times) ## Summary of sample sizes: <span class="hljs-number"><span class="hljs-number">901</span></span>, <span class="hljs-number"><span class="hljs-number">900</span></span>, <span class="hljs-number"><span class="hljs-number">900</span></span>, <span class="hljs-number"><span class="hljs-number">899</span></span>, <span class="hljs-number"><span class="hljs-number">902</span></span>, <span class="hljs-number"><span class="hljs-number">899</span></span>, ... ## Resampling results across tuning parameters: ## ## mtry Accuracy Kappa Accuracy SD Kappa SD ## <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">0.8526986</span></span> <span class="hljs-number"><span class="hljs-number">0.8358081</span></span> <span class="hljs-number"><span class="hljs-number">0.02889351</span></span> <span class="hljs-number"><span class="hljs-number">0.03226317</span></span> ## <span class="hljs-number"><span class="hljs-number">36</span></span> <span class="hljs-number"><span class="hljs-number">0.8324051</span></span> <span class="hljs-number"><span class="hljs-number">0.8133909</span></span> <span class="hljs-number"><span class="hljs-number">0.03442843</span></span> <span class="hljs-number"><span class="hljs-number">0.03836844</span></span> ## <span class="hljs-number"><span class="hljs-number">70</span></span> <span class="hljs-number"><span class="hljs-number">0.8026823</span></span> <span class="hljs-number"><span class="hljs-number">0.7802912</span></span> <span class="hljs-number"><span class="hljs-number">0.03696172</span></span> <span class="hljs-number"><span class="hljs-number">0.04118363</span></span> ## ## Accuracy was used to <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> the optimal model using the largest value. ## The final value used <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> the model was mtry = <span class="hljs-number"><span class="hljs-number">2.</span></span> <span class="hljs-keyword"><span class="hljs-keyword">grid</span></span> &lt;- expand.<span class="hljs-keyword"><span class="hljs-keyword">grid</span></span>(mtry=<span class="hljs-number"><span class="hljs-number">2</span></span>:<span class="hljs-number"><span class="hljs-number">6</span></span>) rfFit &lt;- train(label ~ ., data = train_1000, method = <span class="hljs-string"><span class="hljs-string">"rf"</span></span>, trControl = ctrl,tuneGrid=<span class="hljs-keyword"><span class="hljs-keyword">grid</span></span>) rfFit ## Random Forest ## ## <span class="hljs-number"><span class="hljs-number">1000</span></span> samples ## <span class="hljs-number"><span class="hljs-number">70</span></span> predictor ## <span class="hljs-number"><span class="hljs-number">10</span></span> classes: <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'1'</span></span>, <span class="hljs-string"><span class="hljs-string">'2'</span></span>, <span class="hljs-string"><span class="hljs-string">'3'</span></span>, <span class="hljs-string"><span class="hljs-string">'4'</span></span>, <span class="hljs-string"><span class="hljs-string">'5'</span></span>, <span class="hljs-string"><span class="hljs-string">'6'</span></span>, <span class="hljs-string"><span class="hljs-string">'7'</span></span>, <span class="hljs-string"><span class="hljs-string">'8'</span></span>, <span class="hljs-string"><span class="hljs-string">'9'</span></span> ## ## No pre-processing ## Resampling: Cross-Validated (<span class="hljs-number"><span class="hljs-number">10</span></span> fold, repeated <span class="hljs-number"><span class="hljs-number">3</span></span> times) ## Summary of sample sizes: <span class="hljs-number"><span class="hljs-number">898</span></span>, <span class="hljs-number"><span class="hljs-number">900</span></span>, <span class="hljs-number"><span class="hljs-number">900</span></span>, <span class="hljs-number"><span class="hljs-number">901</span></span>, <span class="hljs-number"><span class="hljs-number">900</span></span>, <span class="hljs-number"><span class="hljs-number">898</span></span>, ... ## Resampling results across tuning parameters: ## ## mtry Accuracy Kappa Accuracy SD Kappa SD ## <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">0.8553016</span></span> <span class="hljs-number"><span class="hljs-number">0.8387134</span></span> <span class="hljs-number"><span class="hljs-number">0.03556811</span></span> <span class="hljs-number"><span class="hljs-number">0.03967709</span></span> ## <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">0.8615798</span></span> <span class="hljs-number"><span class="hljs-number">0.8457973</span></span> <span class="hljs-number"><span class="hljs-number">0.03102887</span></span> <span class="hljs-number"><span class="hljs-number">0.03458732</span></span> ## <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">0.8669329</span></span> <span class="hljs-number"><span class="hljs-number">0.8517297</span></span> <span class="hljs-number"><span class="hljs-number">0.03306870</span></span> <span class="hljs-number"><span class="hljs-number">0.03690844</span></span> ## <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">0.8739532</span></span> <span class="hljs-number"><span class="hljs-number">0.8595897</span></span> <span class="hljs-number"><span class="hljs-number">0.02957395</span></span> <span class="hljs-number"><span class="hljs-number">0.03296439</span></span> ## <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">0.8696883</span></span> <span class="hljs-number"><span class="hljs-number">0.8548470</span></span> <span class="hljs-number"><span class="hljs-number">0.03203166</span></span> <span class="hljs-number"><span class="hljs-number">0.03568138</span></span> ## ## Accuracy was used to <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> the optimal model using the largest value. ## The final value used <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> the model was mtry = <span class="hljs-number"><span class="hljs-number">5.</span></span></code> </pre><br>  Select <b>mtry</b> equal to 4 and get <b>Accuracy</b> on the test data.  I note that I had to train the model apart from the available training data, since  to use all the data requires more RAM.  But, as shown in the previous work, it does not greatly affect the final result. <br><br><pre> <code class="hljs haskell"><span class="hljs-title"><span class="hljs-title">library</span></span>(randomForest) rfFit &lt;- randomForest(label ~ ., <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class"> = train[sample(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">nrow</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">train</span></span></span><span class="hljs-class">), size = 15000),], mtry = 4) prediction_rf&lt;-predict(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">rfFit</span></span></span><span class="hljs-class">,</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">test</span></span></span><span class="hljs-class">) table(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">test</span></span></span><span class="hljs-class">$</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">label</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">prediction_rf</span></span></span><span class="hljs-class">) ## prediction_rf ## 0 1 2 3 4 5 6 7 8 9 ## 0 1608 0 6 3 4 1 20 2 9 0 ## 1 0 1828 9 9 3 5 3 2 9 0 ## 2 12 9 1562 16 15 5 6 19 31 1 ## 3 12 1 26 1625 2 33 12 14 22 6 ## 4 0 6 11 1 1524 0 22 7 6 39 ## 5 12 3 3 48 12 1415 10 1 15 3 ## 6 13 4 8 0 4 11 1623 0 3 0 ## 7 3 14 25 2 13 3 0 1653 4 28 ## 8 4 10 12 64 8 21 12 5 1428 23 ## 9 4 4 10 39 38 10 0 39 7 1562 sum(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">diag</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">table</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">test</span></span></span><span class="hljs-class">$</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">label</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">prediction_rf</span></span></span><span class="hljs-class">)))/nrow(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">test</span></span></span><span class="hljs-class">) ## [1] 0.9421989</span></span></code> </pre><br><h4>  SVM </h4><br>  And finally, <b>Support Vector Machine</b> .  In this model, <b>Radial Kernel</b> will be used and two parameters are already selected: sigma (regularization parameter) and <b>C</b> (parameter defining the shape of the core). <br><br><pre> <code class="hljs lua">svmFit &lt;- train(label ~ ., data = train_1000, method = <span class="hljs-string"><span class="hljs-string">"svmRadial"</span></span>, trControl = ctrl,tuneLength = <span class="hljs-number"><span class="hljs-number">5</span></span>) svmFit ## Support Vector Machines with Radial Basis Function Kernel ## ## <span class="hljs-number"><span class="hljs-number">1000</span></span> samples ## <span class="hljs-number"><span class="hljs-number">70</span></span> predictor ## <span class="hljs-number"><span class="hljs-number">10</span></span> classes: <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'1'</span></span>, <span class="hljs-string"><span class="hljs-string">'2'</span></span>, <span class="hljs-string"><span class="hljs-string">'3'</span></span>, <span class="hljs-string"><span class="hljs-string">'4'</span></span>, <span class="hljs-string"><span class="hljs-string">'5'</span></span>, <span class="hljs-string"><span class="hljs-string">'6'</span></span>, <span class="hljs-string"><span class="hljs-string">'7'</span></span>, <span class="hljs-string"><span class="hljs-string">'8'</span></span>, <span class="hljs-string"><span class="hljs-string">'9'</span></span> ## ## No pre-processing ## Resampling: Cross-Validated (<span class="hljs-number"><span class="hljs-number">10</span></span> fold, repeated <span class="hljs-number"><span class="hljs-number">3</span></span> times) ## Summary of sample sizes: <span class="hljs-number"><span class="hljs-number">901</span></span>, <span class="hljs-number"><span class="hljs-number">900</span></span>, <span class="hljs-number"><span class="hljs-number">898</span></span>, <span class="hljs-number"><span class="hljs-number">900</span></span>, <span class="hljs-number"><span class="hljs-number">900</span></span>, <span class="hljs-number"><span class="hljs-number">901</span></span>, ... ## Resampling results across tuning parameters: ## ## C Accuracy Kappa Accuracy SD Kappa SD ## <span class="hljs-number"><span class="hljs-number">0.25</span></span> <span class="hljs-number"><span class="hljs-number">0.7862419</span></span> <span class="hljs-number"><span class="hljs-number">0.7612933</span></span> <span class="hljs-number"><span class="hljs-number">0.02209354</span></span> <span class="hljs-number"><span class="hljs-number">0.02469667</span></span> ## <span class="hljs-number"><span class="hljs-number">0.50</span></span> <span class="hljs-number"><span class="hljs-number">0.8545924</span></span> <span class="hljs-number"><span class="hljs-number">0.8381166</span></span> <span class="hljs-number"><span class="hljs-number">0.02931921</span></span> <span class="hljs-number"><span class="hljs-number">0.03262332</span></span> ## <span class="hljs-number"><span class="hljs-number">1.00</span></span> <span class="hljs-number"><span class="hljs-number">0.8826064</span></span> <span class="hljs-number"><span class="hljs-number">0.8694079</span></span> <span class="hljs-number"><span class="hljs-number">0.02903226</span></span> <span class="hljs-number"><span class="hljs-number">0.03225475</span></span> ## <span class="hljs-number"><span class="hljs-number">2.00</span></span> <span class="hljs-number"><span class="hljs-number">0.8929180</span></span> <span class="hljs-number"><span class="hljs-number">0.8808766</span></span> <span class="hljs-number"><span class="hljs-number">0.02781461</span></span> <span class="hljs-number"><span class="hljs-number">0.03090255</span></span> ## <span class="hljs-number"><span class="hljs-number">4.00</span></span> <span class="hljs-number"><span class="hljs-number">0.8986322</span></span> <span class="hljs-number"><span class="hljs-number">0.8872208</span></span> <span class="hljs-number"><span class="hljs-number">0.02607149</span></span> <span class="hljs-number"><span class="hljs-number">0.02898200</span></span> ## ## Tuning parameter <span class="hljs-string"><span class="hljs-string">'sigma'</span></span> was held constant at a value of <span class="hljs-number"><span class="hljs-number">0.007650572</span></span> ## Accuracy was used to <span class="hljs-built_in"><span class="hljs-built_in">select</span></span> the optimal model using the largest value. ## The final values used <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> the model were sigma = <span class="hljs-number"><span class="hljs-number">0.007650572</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> C = <span class="hljs-number"><span class="hljs-number">4.</span></span> grid &lt;- expand.grid(C = <span class="hljs-number"><span class="hljs-number">4</span></span>:<span class="hljs-number"><span class="hljs-number">6</span></span>, sigma = seq(<span class="hljs-number"><span class="hljs-number">0.006</span></span>, <span class="hljs-number"><span class="hljs-number">0.009</span></span>, <span class="hljs-number"><span class="hljs-number">0.001</span></span>)) svmFit &lt;- train(label ~ ., data = train_1000, method = <span class="hljs-string"><span class="hljs-string">"svmRadial"</span></span>, trControl = ctrl,tuneGrid=grid) svmFit ## Support Vector Machines with Radial Basis Function Kernel ## ## <span class="hljs-number"><span class="hljs-number">1000</span></span> samples ## <span class="hljs-number"><span class="hljs-number">70</span></span> predictor ## <span class="hljs-number"><span class="hljs-number">10</span></span> classes: <span class="hljs-string"><span class="hljs-string">'0'</span></span>, <span class="hljs-string"><span class="hljs-string">'1'</span></span>, <span class="hljs-string"><span class="hljs-string">'2'</span></span>, <span class="hljs-string"><span class="hljs-string">'3'</span></span>, <span class="hljs-string"><span class="hljs-string">'4'</span></span>, <span class="hljs-string"><span class="hljs-string">'5'</span></span>, <span class="hljs-string"><span class="hljs-string">'6'</span></span>, <span class="hljs-string"><span class="hljs-string">'7'</span></span>, <span class="hljs-string"><span class="hljs-string">'8'</span></span>, <span class="hljs-string"><span class="hljs-string">'9'</span></span> ## ## No pre-processing ## Resampling: Cross-Validated (<span class="hljs-number"><span class="hljs-number">10</span></span> fold, repeated <span class="hljs-number"><span class="hljs-number">3</span></span> times) ## Summary of sample sizes: <span class="hljs-number"><span class="hljs-number">901</span></span>, <span class="hljs-number"><span class="hljs-number">900</span></span>, <span class="hljs-number"><span class="hljs-number">900</span></span>, <span class="hljs-number"><span class="hljs-number">899</span></span>, <span class="hljs-number"><span class="hljs-number">901</span></span>, <span class="hljs-number"><span class="hljs-number">901</span></span>, ... ## Resampling results across tuning parameters: ## ## C sigma Accuracy Kappa Accuracy SD Kappa SD ## <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">0.006</span></span> <span class="hljs-number"><span class="hljs-number">0.8943835</span></span> <span class="hljs-number"><span class="hljs-number">0.8824894</span></span> <span class="hljs-number"><span class="hljs-number">0.02999785</span></span> <span class="hljs-number"><span class="hljs-number">0.03335171</span></span> ## <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">0.007</span></span> <span class="hljs-number"><span class="hljs-number">0.8970537</span></span> <span class="hljs-number"><span class="hljs-number">0.8854531</span></span> <span class="hljs-number"><span class="hljs-number">0.02873482</span></span> <span class="hljs-number"><span class="hljs-number">0.03194698</span></span> ## <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">0.008</span></span> <span class="hljs-number"><span class="hljs-number">0.8984139</span></span> <span class="hljs-number"><span class="hljs-number">0.8869749</span></span> <span class="hljs-number"><span class="hljs-number">0.03068411</span></span> <span class="hljs-number"><span class="hljs-number">0.03410783</span></span> ## <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">0.009</span></span> <span class="hljs-number"><span class="hljs-number">0.8990838</span></span> <span class="hljs-number"><span class="hljs-number">0.8877269</span></span> <span class="hljs-number"><span class="hljs-number">0.03122154</span></span> <span class="hljs-number"><span class="hljs-number">0.03469947</span></span> ## <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">0.006</span></span> <span class="hljs-number"><span class="hljs-number">0.8960834</span></span> <span class="hljs-number"><span class="hljs-number">0.8843721</span></span> <span class="hljs-number"><span class="hljs-number">0.03061547</span></span> <span class="hljs-number"><span class="hljs-number">0.03404636</span></span> ## <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">0.007</span></span> <span class="hljs-number"><span class="hljs-number">0.8960703</span></span> <span class="hljs-number"><span class="hljs-number">0.8843617</span></span> <span class="hljs-number"><span class="hljs-number">0.03069610</span></span> <span class="hljs-number"><span class="hljs-number">0.03412880</span></span> ## <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">0.008</span></span> <span class="hljs-number"><span class="hljs-number">0.8990774</span></span> <span class="hljs-number"><span class="hljs-number">0.8877134</span></span> <span class="hljs-number"><span class="hljs-number">0.03083329</span></span> <span class="hljs-number"><span class="hljs-number">0.03427321</span></span> ## <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">0.009</span></span> <span class="hljs-number"><span class="hljs-number">0.8990838</span></span> <span class="hljs-number"><span class="hljs-number">0.8877271</span></span> <span class="hljs-number"><span class="hljs-number">0.03122154</span></span> <span class="hljs-number"><span class="hljs-number">0.03469983</span></span> ## <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">0.006</span></span> <span class="hljs-number"><span class="hljs-number">0.8957534</span></span> <span class="hljs-number"><span class="hljs-number">0.8840045</span></span> <span class="hljs-number"><span class="hljs-number">0.03094360</span></span> <span class="hljs-number"><span class="hljs-number">0.03441242</span></span> ## <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">0.007</span></span> <span class="hljs-number"><span class="hljs-number">0.8963971</span></span> <span class="hljs-number"><span class="hljs-number">0.8847267</span></span> <span class="hljs-number"><span class="hljs-number">0.03081294</span></span> <span class="hljs-number"><span class="hljs-number">0.03425451</span></span> ## <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">0.008</span></span> <span class="hljs-number"><span class="hljs-number">0.8990774</span></span> <span class="hljs-number"><span class="hljs-number">0.8877134</span></span> <span class="hljs-number"><span class="hljs-number">0.03083329</span></span> <span class="hljs-number"><span class="hljs-number">0.03427321</span></span> ## <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">0.009</span></span> <span class="hljs-number"><span class="hljs-number">0.8990838</span></span> <span class="hljs-number"><span class="hljs-number">0.8877271</span></span> <span class="hljs-number"><span class="hljs-number">0.03122154</span></span> <span class="hljs-number"><span class="hljs-number">0.03469983</span></span> ## ## Accuracy was used to <span class="hljs-built_in"><span class="hljs-built_in">select</span></span> the optimal model using the largest value. ## The final values used <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> the model were sigma = <span class="hljs-number"><span class="hljs-number">0.009</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> C = <span class="hljs-number"><span class="hljs-number">4.</span></span> library(kernlab) svmFit &lt;- ksvm(label ~ ., data = train,<span class="hljs-built_in"><span class="hljs-built_in">type</span></span>=<span class="hljs-string"><span class="hljs-string">"C-svc"</span></span>,kernel=<span class="hljs-string"><span class="hljs-string">"rbfdot"</span></span>,kpar=list(sigma=<span class="hljs-number"><span class="hljs-number">0.008</span></span>),C=<span class="hljs-number"><span class="hljs-number">4</span></span>) prediction_svm &lt;- predict(svmFit, newdata = test) <span class="hljs-built_in"><span class="hljs-built_in">table</span></span>(test$label, prediction_svm) ## prediction_svm ## <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">9</span></span> ## <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1625</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">13</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ## <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">1841</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> ## <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">1624</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">13</span></span> <span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> ## <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">18</span></span> <span class="hljs-number"><span class="hljs-number">1684</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">23</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">12</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> ## <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1567</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">9</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">21</span></span> ## <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">24</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">1465</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> ## <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">1649</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ## <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">15</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1695</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">15</span></span> ## <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">9</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">1530</span></span> <span class="hljs-number"><span class="hljs-number">9</span></span> ## <span class="hljs-number"><span class="hljs-number">9</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">13</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span> <span class="hljs-number"><span class="hljs-number">9</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">21</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">1644</span></span> sum(diag(<span class="hljs-built_in"><span class="hljs-built_in">table</span></span>(test$label, prediction_svm)))/nrow(test) ## [<span class="hljs-number"><span class="hljs-number">1</span></span>] <span class="hljs-number"><span class="hljs-number">0.9717245</span></span></code> </pre><br><h4>  Model Ensemble </h4><br>  Create a fourth model, which is an ensemble of three models created earlier.  This model predicts the value for which most of the models used ‚Äúvote‚Äù. <br><br><pre> <code class="hljs pgsql">all_prediction &lt;- cbind(<span class="hljs-keyword"><span class="hljs-keyword">as</span></span>.numeric(levels(prediction_knn))[prediction_knn], <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>.numeric(levels(prediction_rf))[prediction_rf], <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>.numeric(levels(prediction_svm))[prediction_svm]) predictions_ensemble &lt;- apply(all_prediction, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">function</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">row</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">row</span></span> %&gt;% <span class="hljs-keyword"><span class="hljs-keyword">table</span></span>(.) %&gt;% which.max(.) %&gt;% names(.) %&gt;% <span class="hljs-keyword"><span class="hljs-keyword">as</span></span>.numeric(.) }) <span class="hljs-keyword"><span class="hljs-keyword">table</span></span>(test$label, predictions_ensemble) ## predictions_ensemble ## <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">9</span></span> ## <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1636</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ## <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">1851</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ## <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">1636</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ## <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span> <span class="hljs-number"><span class="hljs-number">1690</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">18</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> ## <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1573</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">12</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span> ## <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">21</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">1478</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ## <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">1651</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> ## <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-number"><span class="hljs-number">12</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1704</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span> ## <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-number"><span class="hljs-number">17</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">13</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">1514</span></span> <span class="hljs-number"><span class="hljs-number">15</span></span> ## <span class="hljs-number"><span class="hljs-number">9</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">21</span></span> <span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">20</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">1645</span></span> sum(diag(<span class="hljs-keyword"><span class="hljs-keyword">table</span></span>(test$label, predictions_ensemble)))/nrow(test) ## [<span class="hljs-number"><span class="hljs-number">1</span></span>] <span class="hljs-number"><span class="hljs-number">0.974939</span></span></code> </pre><br><h3>  Results </h3><br>  The following results were obtained on the test sample: <br><br><table><tbody><tr><td>  Model </td><td>  Test accuracy </td></tr><tr><td>  Knn </td><td>  0.981 </td></tr><tr><td>  Random forest </td><td>  0.948 </td></tr><tr><td>  SVM </td><td>  0.971 </td></tr><tr><td>  Ensemble </td><td>  0.974 </td></tr></tbody></table><br><br>  The best <b>Accuracy</b> indicator has a model using the k-nearest-neighbor method ( <b>KNN</b> ). <br><br>  Evaluation of the models on the Kaggle website is given in the following table. <br><br><table><tbody><tr><td>  Model </td><td>  Kaggle Accuracy </td></tr><tr><td>  Knn </td><td>  0.97171 </td></tr><tr><td>  Random forest </td><td>  0.93286 </td></tr><tr><td>  SVM </td><td>  0.97786 </td></tr><tr><td>  Ensemble </td><td>  0.97471 </td></tr></tbody></table><br><br>  And the best results here are at SVM. <br><br><h3>  Eigenfaces </h3><br>  And finally, out of pure curiosity, we will visually look at the transformations produced by the method of principal components.  To do this, first we get the image of the numbers in their original form. <br><br><pre> <code class="hljs sql">set.seed(<span class="hljs-number"><span class="hljs-number">100</span></span>) train_1000 &lt;- data_train[<span class="hljs-keyword"><span class="hljs-keyword">sample</span></span>(nrow(data_train), <span class="hljs-keyword"><span class="hljs-keyword">size</span></span> = <span class="hljs-number"><span class="hljs-number">1000</span></span>),] colors&lt;-c(<span class="hljs-string"><span class="hljs-string">'white'</span></span>,<span class="hljs-string"><span class="hljs-string">'black'</span></span>) cus_col&lt;-colorRampPalette(colors=colors) default_par &lt;- par() number_row &lt;- <span class="hljs-number"><span class="hljs-number">28</span></span> number_col &lt;- <span class="hljs-number"><span class="hljs-number">28</span></span> par(mfrow=c(<span class="hljs-number"><span class="hljs-number">5</span></span>,<span class="hljs-number"><span class="hljs-number">5</span></span>),pty=<span class="hljs-string"><span class="hljs-string">'s'</span></span>,mar=c(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>),xaxt=<span class="hljs-string"><span class="hljs-string">'n'</span></span>,yaxt=<span class="hljs-string"><span class="hljs-string">'n'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">25</span></span>) { z&lt;-<span class="hljs-built_in"><span class="hljs-built_in">array</span></span>(as.matrix(train_1000)[i,<span class="hljs-number"><span class="hljs-number">-1</span></span>],dim=c(number_row,number_col)) z&lt;-z[,number_col:<span class="hljs-number"><span class="hljs-number">1</span></span>] image(<span class="hljs-number"><span class="hljs-number">1</span></span>:number_row,<span class="hljs-number"><span class="hljs-number">1</span></span>:number_col,z,<span class="hljs-keyword"><span class="hljs-keyword">main</span></span>=train_1000[i,<span class="hljs-number"><span class="hljs-number">1</span></span>],<span class="hljs-keyword"><span class="hljs-keyword">col</span></span>=cus_col(<span class="hljs-number"><span class="hljs-number">256</span></span>)) } par(default_par)</code> </pre><br><img src="https://habrastorage.org/files/cca/f67/7de/ccaf677ded5d4028a3095e9bfbd7fa19.png"><br><br>  And the image of the same figures, but after we used the PCA method and left the first 70 components.  The resulting objects are called eigenfaces <br><br><pre> <code class="hljs mel">zero_var_col &lt;- nearZeroVar(train_1000, saveMetrics = T) train_1000_cut &lt;- train_1000[, !zero_var_col$nzv] pca &lt;- prcomp(train_1000_cut[, <span class="hljs-number"><span class="hljs-number">-1</span></span>], center = TRUE, <span class="hljs-keyword"><span class="hljs-keyword">scale</span></span> = TRUE) restr &lt;- pca$x[,<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">70</span></span>] %*% t(pca$rotation[,<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">70</span></span>]) restr &lt;- <span class="hljs-keyword"><span class="hljs-keyword">scale</span></span>(restr, center = FALSE , <span class="hljs-keyword"><span class="hljs-keyword">scale</span></span>=<span class="hljs-number"><span class="hljs-number">1</span></span>/pca$scale) restr &lt;- <span class="hljs-keyword"><span class="hljs-keyword">scale</span></span>(restr, center = <span class="hljs-number"><span class="hljs-number">-1</span></span> * pca$center, <span class="hljs-keyword"><span class="hljs-keyword">scale</span></span>=FALSE) restr &lt;- as.data.frame(cbind(train_1000_cut$label, restr)) test &lt;- data.frame(<span class="hljs-keyword"><span class="hljs-keyword">matrix</span></span>(NA, nrow = <span class="hljs-number"><span class="hljs-number">1000</span></span>, ncol = ncol(train_1000))) zero_col_number &lt;- <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>:ncol(train_1000)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (zero_var_col$nzv[i] == F) { test[, i] &lt;- restr[, zero_col_number] zero_col_number &lt;- zero_col_number + <span class="hljs-number"><span class="hljs-number">1</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> test[, i] &lt;- train_1000[, i] } par(mfrow=c(<span class="hljs-number"><span class="hljs-number">5</span></span>,<span class="hljs-number"><span class="hljs-number">5</span></span>),pty=<span class="hljs-string"><span class="hljs-string">'s'</span></span>,mar=c(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>),xaxt=<span class="hljs-string"><span class="hljs-string">'n'</span></span>,yaxt=<span class="hljs-string"><span class="hljs-string">'n'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(i <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">25</span></span>) { z&lt;-array(as.<span class="hljs-keyword"><span class="hljs-keyword">matrix</span></span>(test)[i,<span class="hljs-number"><span class="hljs-number">-1</span></span>],dim=c(number_row,number_col)) z&lt;-z[,number_col:<span class="hljs-number"><span class="hljs-number">1</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">image</span></span>(<span class="hljs-number"><span class="hljs-number">1</span></span>:number_row,<span class="hljs-number"><span class="hljs-number">1</span></span>:number_col,z,main=test[i,<span class="hljs-number"><span class="hljs-number">1</span></span>],col=cus_col(<span class="hljs-number"><span class="hljs-number">256</span></span>)) } par(default_par)</code> </pre><br><img src="https://habrastorage.org/files/4cd/108/6b3/4cd1086b349a47799d4d5bbdc4b32ed9.png"><br><br>  Next time we will consider one of the tasks of Text Mining, but for now, you can join the course on <a href="http://dscourse.mlclass.ru/">Practical Data Analysis</a> - I recommend! </div><p>Source: <a href="https://habr.com/ru/post/267075/">https://habr.com/ru/post/267075/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../267063/index.html">Functional C #: Non-nullable reference types (non-zero reference types)</a></li>
<li><a href="../267067/index.html">The story of the damn doubles</a></li>
<li><a href="../267069/index.html">A new way of MITM-attack on the TLS protocol makes the attacker invisible</a></li>
<li><a href="../267071/index.html">Already a year we create an operator together</a></li>
<li><a href="../267073/index.html">Vector Drawable API. Application possibilities</a></li>
<li><a href="../267079/index.html">Isn't it time for relational databases to fall into the dustbin of history?</a></li>
<li><a href="../267081/index.html">The results of the contest for the design of Mail.Ru mailing app on Dribbble</a></li>
<li><a href="../267083/index.html">How to improve resiliency of billing: The experience of "Hydra"</a></li>
<li><a href="../267085/index.html">How to optimize the online store. Part 1. Automatic calling of incoming leads</a></li>
<li><a href="../267087/index.html">FP on Scala: Invariant Functor</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>