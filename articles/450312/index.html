<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Beginner Compose Docker Tutorial</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The author of the article, the translation of which we are publishing today, says that it is intended for those developers who want to study Docker Co...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Beginner Compose Docker Tutorial</h1><div class="post__text post__text-html js-mediator-article">  The author of the article, the translation of which we are publishing today, says that it is intended for those developers who want to study Docker Compose and are going to create their first client-server application using Docker.  It is assumed that the reader of this material is familiar with the basics of Docker.  If this is not the case, you can take a look at <a href="https://habr.com/ru/company/ruvds/blog/441574/">this</a> series of materials, at <a href="https://habr.com/ru/company/ruvds/blog/438982/">this</a> publication, where the fundamentals of Docker are reviewed along with the basics of Kubernetes, and at <a href="https://medium.freecodecamp.org/a-beginners-guide-to-docker-how-to-create-your-first-docker-application-cc03de9b639f">this</a> article for beginners. <br><br> <a href="https://habr.com/ru/company/ruvds/blog/450312/"><img src="https://habrastorage.org/getpro/habr/post_images/b4c/71f/be9/b4c71fbe9634709b3e33a72eabca59af.png" alt="image"></a> <br><a name="habracut"></a><br><h2>  <font color="#3AC1EF">What is Docker Compose?</font> </h2><br>  Docker Compose is a tool included with Docker.  It is designed to solve problems associated with the deployment of projects. <br><br>  While learning the basics of Docker, you might have come up with the creation of simplest applications that work autonomously, independent of, for example, from external data sources or from certain services.  In practice, such applications are rare.  Actual projects usually include a whole set of collaborative applications. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      How do you know if you need to use Docker Compose when you deploy a project?  In fact - very simple.  If several services are used to make this project work, then Docker Compose may be useful to you.  For example, in a situation where they create a website that, in order to perform user authentication, needs to connect to the database.  Such a project may consist of two services - the one that provides the website, and the one that is responsible for maintaining the database. <br><br>  The Docker Compose technology, if it is simplified to describe it, allows, with the help of a single command, to launch multiple services. <br><br><h2>  <font color="#3AC1EF">Difference between Docker and Docker Compose</font> </h2><br>  Docker is used to manage the individual containers (services) that make up an application. <br><br>  Docker Compose is used to simultaneously manage multiple containers that are part of an application.  This tool offers the same features as Docker, but allows you to work with more complex applications. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/859/489/407/85948940715022ca196b8ad6f1e810d0.png"></div><br>  <i><font color="#999999">Docker (separate container) and Docker Compose (multiple containers)</font></i> <br><br><h2>  <font color="#3AC1EF">Typical Docker Compose usage scenario</font> </h2><br>  Docker Compose is, in capable hands, a very powerful tool that allows you to very quickly deploy applications that have a complex architecture.  Now we will look at an example of the practical use of Docker Compose, the analysis of which will allow you to evaluate the advantages that the use of Docker Compose will give you. <br><br>  Imagine that you are a developer of a web project.  This project includes two websites.  The first allows business people to create, just a few mouse clicks, online shopping.  The second is aimed at customer support.  These two sites interact with the same database. <br><br>  Your project is becoming more popular, and it turns out that the capacity of the server on which it runs is no longer enough.  As a result, you decide to transfer the entire project to another machine. <br><br>  Unfortunately, you didn't use something like Docker Compose.  Therefore, you will have to transfer and reconfigure services one by one, hoping that you will not forget anything in the process of this work. <br><br>  If you use Docker Compose, then transferring your project to a new server is an issue that is solved by executing several commands.  In order to complete the transfer of the project to a new location, you only need to perform some settings and upload a backup copy of the database to the new server. <br><br><h2>  <font color="#3AC1EF">Developing a client-server application using Docker Compose</font> </h2><br>  Now that you know what we're going to use Docker Compose for, it's time to create your first client / server application using this tool.  Namely, we are talking about the development of a small website (server) in Python, which can produce a file with a piece of text.  This file is requested from the server by a program (client), also written in Python.  After receiving the file from the server, the program displays the text stored in it on the screen. <br><br>  Pay attention to the fact that we are counting on the fact that you own the basics of Docker, and on the fact that you already have the Docker platform installed. <br><br>  Let's get to work on the project. <br><br><h3>  <font color="#3AC1EF">‚ñç1.</font>  <font color="#3AC1EF">Project creation</font> </h3><br>  In order to build your first client-server application, I suggest starting with creating a project folder.  It should contain the following files and folders: <br><br><ul><li> The <code>docker-compose.yml</code> .  This is the Docker Compose file, which will contain the instructions necessary to start and configure the services. </li><li>  Folder <code>server</code> .  It will contain the files necessary for the operation of the server. </li><li>  Folder <code>client</code> .  Here will be the files of the client application. </li></ul><br>  As a result, the contents of the main folder of your project should look like this: <br><br><pre> <code class="plaintext hljs">. ‚îú‚îÄ‚îÄ client/ ‚îú‚îÄ‚îÄ docker-compose.yml ‚îî‚îÄ‚îÄ server/ 2 directories, 1 file</code> </pre> <br><h3>  <font color="#3AC1EF">‚ñç2.</font>  <font color="#3AC1EF">Server creation</font> </h3><br>  Here we are, in the process of creating the server, will touch on some basic things concerning Docker. <br><br><h4>  2a.  Creating files </h4><br>  Go to the <code>server</code> folder and create the following files in it: <br><br><ul><li>  File <code>server.py</code> .  It will contain the server code. </li><li>  The <code>index.html</code> file.  This file will contain a fragment of text that the client application should display. </li><li>  <code>Dockerfile</code> file.  This is a Docker file that will contain the instructions needed to create the server environment. </li></ul><br>  Here‚Äôs what the contents of your <code>server/</code> folder should look like: <br><br><pre> <code class="plaintext hljs">. ‚îú‚îÄ‚îÄ Dockerfile ‚îú‚îÄ‚îÄ index.html ‚îî‚îÄ‚îÄ server.py 0 directories, 3 files</code> </pre> <br><h4>  2b.  Editing a Python file. </h4><br>  Add the following code to the <code>server.py</code> file: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/env python3 #    python. #       -. #     - ,      Python. import http.server import socketserver #         . handler = http.server.SimpleHTTPRequestHandler #   ,        1234. #    ,        ,    docker-compose. with socketserver.TCPServer(("", 1234), handler) as httpd:   #       ,    .  httpd.serve_forever()</span></span></code> </pre> <br>  This code allows you to create a simple web server.  It will give clients an <code>index.html</code> file, the contents of which will later be displayed on a web page. <br><br><h4>  2c.  HTML file editing </h4><br>  Add the following text to the <code>index.html</code> file: <br><br><pre> <code class="plaintext hljs">Docker-Compose is magic!</code> </pre> <br>  This text will be transmitted to the client. <br><br><h4>  2d.  Editing the Dockerfile file </h4><br>  Now we will create a simple <code>Dockerfile</code> file that will be responsible for organizing the runtime environment for the Python server.  As a basis of the created image we will use the <a href="https://hub.docker.com/_/python">official image</a> intended for the execution of programs written in Python.  Here are the contents of the Dockerfile: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#    ,  Dockerfile       . #      'FROM'. #      python ( DockerHub). #   ,    ,  'python',     - 'latest'. FROM python:latest #       ,   Python,     'server.py'  'index.html'. #     ,     'ADD'. #  , 'server.py',    ,   . #  , '/server/',  ,        . #        '/server/'. ADD server.py /server/ ADD index.html /server/ #     'WORKDIR', ,   . #      . #    ,      ,   '/server/'. WORKDIR /server/</span></span></code> </pre> <br>  Now let's work on the client. <br><br><h3>  <font color="#3AC1EF">‚ñç3.</font>  <font color="#3AC1EF">Customer creation</font> </h3><br>  Creating the client part of our project, we will simultaneously recall some of the basics of Docker. <br><br><h4>  3a.  Creating files </h4><br>  Go to the folder of your <code>client</code> project and create the following files in it: <br><br><ul><li>  File <code>client.py</code> .  There will be a client code. </li><li>  <code>Dockerfile</code> file.  This file plays the same role as the similar file in the server folder.  Namely, it contains a statement describing the creation of an environment for executing client code. </li></ul><br>  As a result, your <code>client/</code> folder at this stage should look like this: <br><br><pre> <code class="plaintext hljs">. ‚îú‚îÄ‚îÄ client.py ‚îî‚îÄ‚îÄ Dockerfile 0 directories, 2 files</code> </pre> <br><h4>  3b.  Editing a Python file </h4><br>  Add the following code to the <code>client.py</code> file: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/env python3 #    Python. #      'index.html'  . #     ,      Python. import urllib.request #      'http://localhost:1234/'. # ,      ,   'http://localhost:1234'. # localhost   ,      . # 1234 -   ,        . fp = urllib.request.urlopen("http://localhost:1234/") # 'encodedContent'     ('index.html'). # 'decodedContent'     (  ,      ). encodedContent = fp.read() decodedContent = encodedContent.decode("utf8") #   ,    ('index.html'). print(decodedContent) #    . fp.close()</span></span></code> </pre> <br>  Thanks to this code, the client application can download data from the server and display it on the screen. <br><br><h4>  3c.  Editing the Dockerfile file </h4><br>  As in the case of the server, we create a simple <code>Dockerfile</code> for the client, responsible for creating the environment in which the client Python application will run.  Here is the code of the client <code>Dockerfile</code> : <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#   ,     Dockerfile. FROM python:latest #  'client.py'   '/client/'. ADD client.py /client/ #      '/client/'. WORKDIR /client/</span></span></code> </pre> <br><h3>  <font color="#3AC1EF">‚ñç4.</font>  <font color="#3AC1EF">Docker compose</font> </h3><br>  As you can see, we have created two different projects: a server and a client.  Each of them has its own <code>Dockerfile</code> file.  Until now, everything that happens does not go beyond the basics of working with Docker.  Now we begin to work with Docker Compose.  To do this, refer to the <code>docker-compose.yml</code> file located in the root folder of the project. <br><br>  Here we are not trying to consider absolutely all the commands that can be used in <code>docker-compose.yml</code> .  Our main goal is to make out a practical example that gives you a basic knowledge of Docker Compose. <br><br>  Here is the code to put in the <code>docker-compose.yml</code> : <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#  docker-compose     . #   "3"    -        . version: "3" #  ,  docker-composes   . # 1  = 1 . #    , ,   ... # ,     ,   'services'. services: #    ,       . #  ,     . #   (): . #    ,   . #       . #  ,    ,    'server'. server:   #   "build"     #    Dockerfile,      ,   #    .   #  'server/'     ,   #    Dockerfile.   build: server/   # ,      .   #     "python ./server.py".   command: python ./server.py   #   ,      'server/server.py'   1234.   #          (   ),   #         .   #       'ports'.   #      : [ ]:[ ]   #        1234         # 1234  (         #   ).   ports:     - 1234:1234 #   (): . #    'client'. client:   #  'client/    ,     #  Dockerfile    .   build: client/   # ,      .   #     "python ./client.py".   command: python ./client.py   #   'network_mode'     .   #    ,      'localhost' .   network_mode: host   #   'depends_on'  ,   ,   #   , ,       .   #  ,   'client'       'server'.   depends_on:     - server</span></span></code> </pre> <br><h3>  <font color="#3AC1EF">‚ñç5.</font>  <font color="#3AC1EF">Build project</font> </h3><br>  After all the necessary instructions <code>docker-compose.yml</code> been entered into <code>docker-compose.yml</code> , the project needs to be assembled.  This step of our work resembles the use of the <code>docker build</code> , but the corresponding command relates to several services: <br><br><pre> <code class="plaintext hljs">$ docker-compose build</code> </pre> <br><h3>  <font color="#3AC1EF">‚ñç6.</font>  <font color="#3AC1EF">Launch of the project</font> </h3><br>  Now that the project is complete, it's time to start it.  This step of our work corresponds to the step at which, when working with separate containers, the <code>docker run</code> command is executed: <br><br><pre> <code class="plaintext hljs">$ docker-compose up</code> </pre> <br>  After executing this command, the text loaded by the client from the server should appear in the terminal: <code>Docker-Compose is magic!</code>  . <br><br>  As already mentioned, the server uses computer port <code>1234</code> to service client requests.  Therefore, if you go to the browser at <a href="http://localhost:1234/">http: // localhost: 1234 /</a> , it will display a page with the text <code>Docker-Compose is magic!</code>  . <br><br><h2>  <font color="#3AC1EF">Useful commands</font> </h2><br>  Consider some commands that may come in handy when working with Docker Compose. <br><br>  This command allows you to stop and delete containers and other resources created by the <code>docker-compose up</code> : <br><br><pre> <code class="plaintext hljs">$ docker-compose down</code> </pre> <br>  This command displays service logs: <br><br><pre> <code class="plaintext hljs">$ docker-compose logs -f [service name]</code> </pre> <br>  For example, in our project it can be used in this form: <code>$ docker-compose logs -f [service name]</code> . <br><br>  With this command you can display a list of containers: <br><br><pre> <code class="plaintext hljs">$ docker-compose ps</code> </pre> <br>  This command allows you to execute a command in a running container: <br><br><pre> <code class="plaintext hljs">$ docker-compose exec [service name] [command]</code> </pre> <br>  For example, it might look like this: <code>docker-compose exec server ls</code> . <br><br>  This command allows you to display a list of images: <br><br><pre> <code class="plaintext hljs">$ docker-compose images</code> </pre> <br><h2>  <font color="#3AC1EF">Results</font> </h2><br>  We covered the basics of working with Docker Compose technology, the knowledge of which will allow you to use this technology and, if you wish, to begin to study it in more depth.  <a href="https://github.com/gael-thomas/Client-Server-Docker-Compose-example">Here is the</a> repository with the project code that we reviewed here. <br><br>  <b>Dear readers!</b>  Do you use Docker Compose in your projects? <br><br> <a href="https://ruvds.com/ru-rub/"><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div><p>Source: <a href="https://habr.com/ru/post/450312/">https://habr.com/ru/post/450312/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../450298/index.html">Quantum Future (continued)</a></li>
<li><a href="../4503/index.html">Usim here skavatstsa —û Bulbu i ma—ûchats!</a></li>
<li><a href="../450300/index.html">Stop arguing about functional programming and OOP</a></li>
<li><a href="../450304/index.html">Spider-man riding an ant: 100 million years of myrmecophilia</a></li>
<li><a href="../450308/index.html">GPU Ray Tracing in Unity - Part 3</a></li>
<li><a href="../450314/index.html">TensorFlow for beginners. Part 1: general information, library installation</a></li>
<li><a href="../450322/index.html">Why do we need so many messengers?</a></li>
<li><a href="../450324/index.html">How a performance monitoring system automatically dismisses Amazon employees</a></li>
<li><a href="../45033/index.html">CMF BORS ¬©</a></li>
<li><a href="../450332/index.html">How the rendering of The Witcher 3 is implemented: lightning, witches sneak and other effects</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>