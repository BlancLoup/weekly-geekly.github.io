<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Dynamic programming in the real world: cutting seams</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dynamic programming has a reputation for a method that you study at a university, and then you only remember it at interviews. But in fact, the method...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Dynamic programming in the real world: cutting seams</h1><div class="post__text post__text-html js-mediator-article">  Dynamic programming has a reputation for a method that you study at a university, and then you only remember it at interviews.  But in fact, the method is applicable in many situations.  In fact, this is a <b>technique for efficiently solving problems that can be broken down into many strongly repetitive subtasks</b> . <br><br>  In the article I will show an interesting real-world application of dynamic programming ‚Äî the task of cutting seams (seam carving).  The task and methodology are described in detail in the work of Avidan and Shamir <a href="https://dl.acm.org/citation.cfm%3Fid%3D1276390">‚ÄúCutting out the seams for resizing images with regard to content‚Äù</a> (the article is freely available). <br><br>  This is one of a series of articles on dynamic programming.  If you want to brush up on methods, see the <a href="https://avikdas.com/2019/04/15/a-graphical-introduction-to-dynamic-programming.html">illustrated introduction to dynamic programming</a> . <br><a name="habracut"></a><br><h1>  Resizing images with content </h1><br>  To solve a real problem with dynamic programming, you need to formulate it correctly.  This section describes the necessary presets for the selected task. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The authors of the original article describe the content-oriented resizing of the image, that is, changing the width or height of the image, taking into account the content.  See the original work for details, and I offer a quick overview.  Suppose you want to resize a surfer photo: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/979/931/22d/97993122dc9a852c8b299974fc643aa8.jpg"><br>  <i><font color="gray">Top view of the surfer in the middle of a calm ocean, with turbulent waves on the right.</font></i>  <i><font color="gray">Photo: <a href="https://pixabay.com/users/kirildobrev-12266114/">Kiril Dobrev</a> on <a href="https://pixabay.com/photos/blue-beach-surf-travel-surfer-4145659/">Pixabay</a></font></i> <br><br>  As described in detail in the article, there are several ways to reduce the width of the image: these are standard cropping and scaling, with their inherent flaws, as well as removing columns of pixels from the middle.  As you can imagine, this leaves a visible seam in the photo, where the image on the left and right does not match.  And in this way you can remove only a limited amount of image. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e2e/e83/7bc/e2ee837bc6950dd52349e3010f7c9c32.jpg"><br>  <i><font color="gray">Attempting to reduce the width by trimming the left side and cutting the block from the middle.</font></i>  <i><font color="gray">Last leaves visible seam</font></i> <br><br>  Avidan and Shamir in the article describe a new technique of "cutting seams" (seam carving).  It first determines the less important "low-energy" areas, and then calculates the low-energy "seams" that pass through the picture.  In the case of reducing the width of the image is determined by the vertical seam from the top of the image to the bottom, which on each line is shifted to the left or right by no more than one pixel. <br><br>  In the photo of the surfer, the lowest-energy seam passes through the middle of the image, where the water is the calmest.  This corresponds to our intuition. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/41b/8aa/6d9/41b8aa6d9d587e1ede3c02a2e515d5a0.jpg"><br>  <i><font color="gray">The lowest-energy seam found on the surfer's image is shown by a red line five pixels wide for visibility, although in fact the seam is only one pixel wide</font></i> <br><br>  Having determined the seam with the lowest energy, and then removing it, we reduce the width of the image by one pixel.  Repeating this process again and again allows you to significantly reduce the width of the entire photo. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/00b/ce5/31e/00bce531ebd56e33728f12d0d3103da9.jpg"><br>  <i><font color="gray">Image of the surfer after reducing the width by 1024 pixels</font></i> <br><br>  Again, the algorithm quite logically removed the still water in the middle, as well as on the left side of the photo.  But unlike framing, the texture of the water on the left is preserved and there are no sharp transitions.  True, you can find some imperfect transitions in the center, but basically the result looks natural. <br><br><h3>  Image Energy Definition </h3><br>  The magic is to find the lowest energy seam.  To do this, we first assign energy to each pixel of the image.  Then we use dynamic programming to find the path through the images with the least energy - this algorithm will be discussed in detail in the next section.  First, consider how to assign energy values ‚Äã‚Äãto pixels. <br><br>  The scientific article discusses several energy functions and their differences.  We will not complicate and take a function that simply captures the amount of color change around each pixel.  For the sake of completeness, I will describe the energy function in a little more detail in case you want to implement it yourself, but this is just a pre-installation for subsequent calculations of dynamic programming. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bee/58c/9a3/bee58c9a39f57d4d548b020ae7e046e0.png"><br>  <i><font color="gray">Left three pixels from dark to bright.</font></i>  <i><font color="gray">The difference between the first and the last is great.</font></i>  <i><font color="gray">On the right are three dark pixels with a slight difference in color intensity.</font></i> <br><br>  To calculate the energy of a particular pixel, we look at the pixels to the left and right of it.  Component by component, we calculate the square of the distance between them, that is, the square of the difference between the red, green, and blue components, and then we add them.  Do the same for the pixels above and below the center.  Finally, we fold the horizontal and vertical distances. <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mtext>&amp;#xA0;</mtext><mi>D</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><mi>x</mi><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mn>2</mn></msup><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><mtext>&amp;#xA0;</mtext><mi>D</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><msub><mi>r</mi><mi>x</mi></msub><msup><mo stretchy=&quot;false&quot;>)</mo><mn>2</mn></msup><mo>+</mo><mo stretchy=&quot;false&quot;>(</mo><mtext>&amp;#xA0;</mtext><mi>D</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><msub><mi>g</mi><mi>x</mi></msub><msup><mo stretchy=&quot;false&quot;>)</mo><mn>2</mn></msup><mo>+</mo><mo stretchy=&quot;false&quot;>(</mo><mtext>&amp;#xA0;</mtext><mi>D</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><msub><mi>b</mi><mi>x</mi></msub><msup><mo stretchy=&quot;false&quot;>)</mo><mn>2</mn></msup></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="53.125ex" height="3.142ex" viewBox="0 -1039.5 22873 1352.7" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-7C" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-44" x="528" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-65" x="1357" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-6C" x="1823" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-74" x="2122" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-61" x="2483" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-78" x="3013" y="0"></use><g transform="translate(3585,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-7C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-32" x="393" y="675"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-3D" x="4595" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-28" x="5651" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-44" x="6291" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-65" x="7119" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-6C" x="7586" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-74" x="7884" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-61" x="8246" y="0"></use><g transform="translate(8775,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-78" x="638" y="-213"></use></g><g transform="translate(9732,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-29" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-32" x="550" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-2B" x="10797" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-28" x="11798" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-44" x="12438" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-65" x="13266" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-6C" x="13733" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-74" x="14031" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-61" x="14393" y="0"></use><g transform="translate(14922,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-67" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-78" x="675" y="-213"></use></g><g transform="translate(15904,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-29" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-32" x="550" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-2B" x="16970" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-28" x="17971" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-44" x="18610" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-65" x="19439" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-6C" x="19905" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-74" x="20204" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-61" x="20565" y="0"></use><g transform="translate(21095,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-62" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-78" x="607" y="-213"></use></g><g transform="translate(22029,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-29" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-32" x="550" y="583"></use></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mtext>&nbsp;</mtext><mi>D</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><mi>x</mi><msup><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mn>2</mn></msup><mo>=</mo><mo stretchy="false">(</mo><mtext>&nbsp;</mtext><mi>D</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><msub><mi>r</mi><mi>x</mi></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>+</mo><mo stretchy="false">(</mo><mtext>&nbsp;</mtext><mi>D</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><msub><mi>g</mi><mi>x</mi></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>+</mo><mo stretchy="false">(</mo><mtext>&nbsp;</mtext><mi>D</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><msub><mi>b</mi><mi>x</mi></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> | \ Delta x | ^ 2 = (\ Delta r_x) ^ 2 + (\ Delta g_x) ^ 2 + (\ Delta b_x) ^ 2 </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mtext>&amp;#xA0;</mtext><mi>D</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><mi>y</mi><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mn>2</mn></msup><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><mtext>&amp;#xA0;</mtext><mi>D</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><msub><mi>r</mi><mi>y</mi></msub><msup><mo stretchy=&quot;false&quot;>)</mo><mn>2</mn></msup><mo>+</mo><mo stretchy=&quot;false&quot;>(</mo><mtext>&amp;#xA0;</mtext><mi>D</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><msub><mi>g</mi><mi>y</mi></msub><msup><mo stretchy=&quot;false&quot;>)</mo><mn>2</mn></msup><mo>+</mo><mo stretchy=&quot;false&quot;>(</mo><mtext>&amp;#xA0;</mtext><mi>D</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><msub><mi>b</mi><mi>y</mi></msub><msup><mo stretchy=&quot;false&quot;>)</mo><mn>2</mn></msup></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="52.581ex" height="3.262ex" viewBox="0 -1039.5 22638.9 1404.6" role="img" focusable="false" style="vertical-align: -0.848ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-7C" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-44" x="528" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-65" x="1357" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-6C" x="1823" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-74" x="2122" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-61" x="2483" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-79" x="3013" y="0"></use><g transform="translate(3510,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-7C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-32" x="393" y="675"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-3D" x="4520" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-28" x="5576" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-44" x="6216" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-65" x="7044" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-6C" x="7511" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-74" x="7809" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-61" x="8171" y="0"></use><g transform="translate(8700,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-72" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-79" x="638" y="-213"></use></g><g transform="translate(9604,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-29" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-32" x="550" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-2B" x="10669" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-28" x="11670" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-44" x="12310" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-65" x="13138" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-6C" x="13605" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-74" x="13903" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-61" x="14265" y="0"></use><g transform="translate(14794,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-67" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-79" x="675" y="-213"></use></g><g transform="translate(15723,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-29" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-32" x="550" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-2B" x="16789" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-28" x="17790" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-44" x="18429" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-65" x="19258" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-6C" x="19724" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-74" x="20023" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-61" x="20384" y="0"></use><g transform="translate(20914,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-62" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-79" x="607" y="-213"></use></g><g transform="translate(21795,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-29" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-32" x="550" y="583"></use></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mtext>&nbsp;</mtext><mi>D</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><mi>y</mi><msup><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mn>2</mn></msup><mo>=</mo><mo stretchy="false">(</mo><mtext>&nbsp;</mtext><mi>D</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><msub><mi>r</mi><mi>y</mi></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>+</mo><mo stretchy="false">(</mo><mtext>&nbsp;</mtext><mi>D</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><msub><mi>g</mi><mi>y</mi></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup><mo>+</mo><mo stretchy="false">(</mo><mtext>&nbsp;</mtext><mi>D</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><msub><mi>b</mi><mi>y</mi></msub><msup><mo stretchy="false">)</mo><mn>2</mn></msup></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-2"> | \ Delta y | ^ 2 = (\ Delta r_y) ^ 2 + (\ Delta g_y) ^ 2 + (\ Delta b_y) ^ 2 </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>e</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mtext>&amp;#xA0;</mtext><mi>D</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><mi>x</mi><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mn>2</mn></msup><mo>+</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mtext>&amp;#xA0;</mtext><mi>D</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><mi>y</mi><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mn>2</mn></msup></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="32.234ex" height="3.142ex" viewBox="0 -1039.5 13878.5 1352.7" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-65" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-28" x="466" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-78" x="856" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-2C" x="1428" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-79" x="1873" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-29" x="2371" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-3D" x="3038" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-7C" x="4094" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-44" x="4623" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-65" x="5451" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-6C" x="5918" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-74" x="6216" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-61" x="6578" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-78" x="7107" y="0"></use><g transform="translate(7680,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-7C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-32" x="393" y="675"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-2B" x="8634" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-7C" x="9635" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-44" x="10164" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-65" x="10992" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-6C" x="11459" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-74" x="11757" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-61" x="12119" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-79" x="12648" y="0"></use><g transform="translate(13146,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-7C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-32" x="393" y="675"></use></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>e</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mtext>&nbsp;</mtext><mi>D</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><mi>x</mi><msup><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mn>2</mn></msup><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mtext>&nbsp;</mtext><mi>D</mi><mi>e</mi><mi>l</mi><mi>t</mi><mi>a</mi><mi>y</mi><msup><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mn>2</mn></msup></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-3"> e (x, y) = | \ Delta x | ^ 2 + | \ Delta y | ^ 2 </script></p><br>  The only caveat is, say, if a pixel is on the left edge, then there is no neighbor on the left.  In this case, we make a comparison only with the right pixel.  Similar checks are made for pixels on the top, right and bottom edges. <br><br>  The energy function is great if the neighboring pixels are very different in color, and small if they are similar. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/62a/270/c37/62a270c374afe98c9951449496a75041.jpg"><br>  <i><font color="gray">The energy of each pixel in a surfer photo: the lighter - the higher it is.</font></i>  <i><font color="gray">As expected, the surfer has the highest energy in the middle and the turbulent waves on the right.</font></i> <br><br>  The energy function works well on a surfer photo.  However, it takes a very large range of values.  Therefore, when visualizing, it appears that in most of the photos the pixels have zero energy.  In fact, there are just very low values ‚Äã‚Äãcompared to the regions with the highest energy.  To simplify the visualization, I zoomed in the surfer and covered this area. <br><br><h1>  Find low-energy welds with dynamic programming </h1><br>  By calculating the energy of each pixel, we can find the seam with the lowest energy from the top of the image to the bottom.  The same analysis is applicable for horizontal joints to reduce the height of the original image.  However, we will focus on vertical. <br><br>  Let's start with the definition: <br><br><ul><li>  A seam is a sequence of pixels, one pixel per line.  The requirement is that between two consecutive lines the coordinate <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-78" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-4"> x </script>  varies by no more than one pixel.  This saves the seam sequence. <br></li><li>  The seam with the lowest energy is the one whose total energy over all the pixels in the seam is minimized. </li></ul><br>  It is important to note that the seam with the lowest energy does not necessarily pass through all the pixels with the lowest energy.  It takes into account the total energy of all, rather than individual pixels. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3eb/f9d/cd8/3ebf9dcd8be067ac7f5adabfb1bea8e8.png"><br>  <i><font color="gray">Greedy approach does not work.</font></i>  <i><font color="gray">Choosing a low-energy pixel at an early stage, we get stuck in the high-energy region of the image (red path to the right)</font></i> <br><br>  As you can see, you can not just choose the pixel with the lowest energy in the next line. <br><br><h3>  We break a problem into subtasks </h3><br>  The problem with the greedy approach is that when deciding on the next step, we do not take into account the rest of the seam ahead.  We cannot look into the future, but we are able to take into account everything that we already know by now. <br><br>  Let's turn the task upside down.  <i>Instead of choosing between several pixels to continue one seam, we will choose between several seams to go to one pixel</i> .  What we need to do is take each pixel and choose between the pixels in the line above, from which the seam can emanate.  If each of the pixels in the line above encodes the path traversed to this point, then we are essentially looking at the full story to this point. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/efe/39e/c83/efe39ec83477a2a410e7b4214bef9377.png"><br>  <i><font color="gray">For each pixel we study three pixels in the line above.</font></i>  <i><font color="gray">The fundamental choice is which of the seams to continue?</font></i> <br><br>  This implies a subtask for each pixel in the image.  The subtask should find the best path to a particular pixel, so a good idea would be to associate with each pixel the energy of the lowest-energy seam that <i>ends at that pixel</i> . <br><br>  Unlike the greedy approach, the above approach essentially tries all possible paths through the image.  Just when checking all possible paths, the same subtasks are solved again and again, which makes this approach an ideal option for dynamic programming. <br><br><h3>  Determination of the recurrence ratio </h3><br>  As usual, now we need to formalize the idea into a recurrent relation.  There is a subtask corresponding to each pixel in the original image, so the inputs to our recurrence relation may simply be coordinates <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-78" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-5"> x </script>  and <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.155ex" height="1.817ex" viewBox="0 -520.7 497.5 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-79" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-6"> y </script>  this pixel.  This provides integer inputs, making it easy to organize subtasks, as well as the ability to store previously calculated values ‚Äã‚Äãin a two-dimensional array. <br><br>  Define the function <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>M</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.771ex" height="2.66ex" viewBox="0 -832 3345.7 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-4D" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-28" x="1051" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-78" x="1441" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-2C" x="2013" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-79" x="2458" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-29" x="2956" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-7"> M (x, y) </script>  which represents the energy of a vertical seam with the lowest energy.  It starts at the top of the image and ends at the pixel. <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.328ex" height="2.66ex" viewBox="0 -832 2294.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-78" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-2C" x="962" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-79" x="1407" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-29" x="1904" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-8"> (x, y) </script>  .  Title <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>M</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.442ex" height="2.057ex" viewBox="0 -780.1 1051.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-4D" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi></math></span></span><script type="math/tex" id="MathJax-Element-9"> M </script>  selected as in the original scientific article. <br><br>  First, you need a base case.  All seams, which are completed in the top row, have only one pixel length.  Thus, the seam with the minimum energy is just a pixel with the minimum energy: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>M</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mn>0</mn><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>e</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mn>0</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="17.295ex" height="2.66ex" viewBox="0 -832 7446.4 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-4D" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-28" x="1051" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-78" x="1441" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-2C" x="2013" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-30" x="2458" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-29" x="2959" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-3D" x="3626" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-65" x="4682" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-28" x="5149" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-78" x="5538" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-2C" x="6111" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-30" x="6556" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-29" x="7056" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>M</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mn>0</mn><mo stretchy="false">)</mo><mo>=</mo><mi>e</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mn>0</mn><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-10"> M (x, 0) = e (x, 0) </script></p><br>  For the pixels in the remaining rows, we look at the pixels above.  Since the seam must be continuous, we consider only three pixels located on the upper left, on the top, and on the upper right.  From them, select the seam with the lowest energy, which ends in one of these pixels, and add the energy of the current pixel: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>M</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>e</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mtext>&amp;#xA0;</mtext><mi>m</mi><mi>i</mi><mi>n</mi><mtext>&amp;#xA0;</mtext><mi>b</mi><mi>e</mi><mi>g</mi><mi>i</mi><mi>n</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>c</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi>s</mi></mrow><mi>M</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo>,</mo><mi>y</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo><mspace linebreak=&quot;newline&quot; /><mi>M</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo><mspace linebreak=&quot;newline&quot; /><mi>M</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>y</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo><mtext>&amp;#xA0;</mtext><mi>e</mi><mi>n</mi><mi>d</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>c</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi>s</mi></mrow></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="76.867ex" height="9.407ex" viewBox="0 -832 33095.6 4050.2" role="img" focusable="false" style="vertical-align: -7.475ex; max-width: 638px;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g transform="translate(5312,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-4D" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-28" x="1051" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-78" x="1441" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-2C" x="2013" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-79" x="2458" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-29" x="2956" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-3D" x="3623" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-65" x="4679" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-28" x="5146" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-78" x="5535" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-2C" x="6108" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-79" x="6553" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-29" x="7050" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-2B" x="7662" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-6D" x="8913" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-69" x="9791" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-6E" x="10137" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-62" x="10987" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-65" x="11417" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-67" x="11883" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-69" x="12364" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-6E" x="12709" y="0"></use><g transform="translate(13310,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-63" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-61" x="433" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-73" x="963" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-65" x="1432" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-73" x="1899" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-4D" x="15678" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-28" x="16730" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-78" x="17119" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-2212" x="17914" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-31" x="18915" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-2C" x="19415" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-79" x="19860" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-2212" x="20580" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-31" x="21581" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-29" x="22081" y="0"></use></g><g transform="translate(14013,-1433)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-4D" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-28" x="1051" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-78" x="1441" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-2C" x="2013" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-79" x="2458" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-2212" x="3178" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-31" x="4179" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-29" x="4679" y="0"></use></g><g transform="translate(11047,-2866)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-4D" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-28" x="1051" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-78" x="1441" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-2B" x="2235" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-31" x="3236" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-2C" x="3736" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-79" x="4182" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-2212" x="4901" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-31" x="5902" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-29" x="6403" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-65" x="7042" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-6E" x="7509" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-64" x="8109" y="0"></use><g transform="translate(8633,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-63" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-61" x="433" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-73" x="963" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-65" x="1432" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-73" x="1899" y="0"></use></g></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>M</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>=</mo><mi>e</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>+</mo><mtext>&nbsp;</mtext><mi>m</mi><mi>i</mi><mi>n</mi><mtext>&nbsp;</mtext><mi>b</mi><mi>e</mi><mi>g</mi><mi>i</mi><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mi>c</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi>s</mi></mrow><mi>M</mi><mo stretchy="false">(</mo><mi>x</mi><mo>‚àí</mo><mn>1</mn><mo>,</mo><mi>y</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mi>M</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace><mi>M</mi><mo stretchy="false">(</mo><mi>x</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>y</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="false">)</mo><mtext>&nbsp;</mtext><mi>e</mi><mi>n</mi><mi>d</mi><mrow class="MJX-TeXAtom-ORD"><mi>c</mi><mi>a</mi><mi>s</mi><mi>e</mi><mi>s</mi></mrow></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-11"> M (x, y) = e (x, y) + \ min \ begin {cases} M (x - 1, y - 1) \\ M (x, y - 1) \\ M (x + 1, y - 1) \ end {cases} </script></p><br>  As a border situation, consider the case where the current pixel is located at the left or right edge of the image.  In these cases we omit <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>M</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo>,</mo><mi>y</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.776ex" height="2.66ex" viewBox="0 -832 6792.6 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-4D" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-28" x="1051" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-78" x="1441" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-2212" x="2235" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-31" x="3236" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-2C" x="3736" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-79" x="4182" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-2212" x="4901" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-31" x="5902" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-29" x="6403" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi><mo stretchy="false">(</mo><mi>x</mi><mo>‚àí</mo><mn>1</mn><mo>,</mo><mi>y</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-12"> M (x-1, y-1) </script>  for pixels on the left edge or <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>M</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>y</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.776ex" height="2.66ex" viewBox="0 -832 6792.6 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-4D" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-28" x="1051" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-78" x="1441" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-2B" x="2235" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-31" x="3236" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-2C" x="3736" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-79" x="4182" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-2212" x="4901" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-31" x="5902" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-29" x="6403" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi><mo stretchy="false">(</mo><mi>x</mi><mo>+</mo><mn>1</mn><mo>,</mo><mi>y</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-13"> M (x + 1, y-1) </script>  on the right edge. <br><br>  Finally, you need to extract the energy of the lowest-energy weld, which covers the entire height of the image.  This means that we are looking at the bottom line of the image and choosing the lowest-energy seam that ends at one of these pixels.  For photo wide <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>W</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.435ex" height="2.057ex" viewBox="0 -780.1 1048.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-57" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>W</mi></math></span></span><script type="math/tex" id="MathJax-Element-14"> W </script>  and tall <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>H</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.064ex" height="2.057ex" viewBox="0 -780.1 888.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-48" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>H</mi></math></span></span><script type="math/tex" id="MathJax-Element-15"> H </script>  pixels: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtext>&amp;#xA0;</mtext><mi>m</mi><mi>i</mi><msub><mi>n</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>0</mn><mtext>&amp;#xA0;</mtext><mi>l</mi><mi>e</mi><mi>x</mi><mo>&amp;lt;</mo><mi>W</mi></mrow></msub><mi>M</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>H</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="24.332ex" height="2.66ex" viewBox="0 -832 10476.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-69" x="1128" y="0"></use><g transform="translate(1474,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-6E" x="0" y="0"></use><g transform="translate(600,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-30" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-6C" x="854" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-65" x="1152" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-78" x="1619" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-3C" x="2191" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-57" x="2970" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-4D" x="5016" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-28" x="6067" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-78" x="6457" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-2C" x="7029" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-48" x="7474" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-2212" x="8585" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-31" x="9586" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-29" x="10086" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>&nbsp;</mtext><mi>m</mi><mi>i</mi><msub><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mn>0</mn><mtext>&nbsp;</mtext><mi>l</mi><mi>e</mi><mi>x</mi><mo>&lt;</mo><mi>W</mi></mrow></msub><mi>M</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>H</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-16"> \ min_ {0 \ le x <W} M (x, H - 1) </script></p><br>  So, we got a recurrent relation with all the necessary properties: <br><br><ul><li>  The recurrence relation has integer inputs. <br></li><li>  From the ratio is easy to extract the final answer. <br></li><li>  The ratio depends on oneself. </li></ul><br><h3>  DAG subtask check (oriented acyclic graph) </h3><br>  Because each subtask <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>M</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.771ex" height="2.66ex" viewBox="0 -832 3345.7 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-4D" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-28" x="1051" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-78" x="1441" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-2C" x="2013" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-79" x="2458" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-29" x="2956" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-17"> M (x, y) </script>  corresponds to one pixel of the original image, the dependency graph is very easy to visualize.  Simply place them on a two-dimensional grid, as on the original image! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/24f/2a7/9cf/24f2a79cffa7d5c6f1f84bc4ff79d5bc.png"><br>  <i><font color="gray">The subtasks are located in a two-dimensional grid, as are the pixels in the original image</font></i> <br><br>  As follows from the basic scenario of the recurrence relation, the top line of subtasks can be initialized with the energy values ‚Äã‚Äãof individual pixels. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/323/ddd/ee2/323dddee252bd76daec13922fd2de43e.png"><br>  <i><font color="gray">The top row does not depend on other subtasks.</font></i>  <i><font color="gray">Note the lack of arrows from the top row of cells.</font></i> <br><br>  Dependencies begin to appear in the second line.  First, in the leftmost cell in the second line, we are confronted with a borderline situation.  Since there are no cells on the left, the cell <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.168ex" height="2.66ex" viewBox="0 -832 2225.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-31" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-2C" x="890" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-30" x="1335" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-29" x="1835" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mn>1</mn><mo>,</mo><mn>0</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-18"> (1,0) </script>  depends only on the cells located directly above it and on the top right.  The same thing will happen later with the leftmost cell in the third row. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/946/1fa/21c/9461fa21ce25095b1d960f3a4e8ccbf6.png"><br>  <i><font color="gray">Subtasks on the left edge depend only on two subtasks above them.</font></i> <br><br>  In the second cell of the second row (1,1), we see the most typical manifestation of the recurrence relation.  This cell depends on three cells: top left, right above it and top right.  This dependency structure is applied to all ‚Äúmiddle‚Äù cells in the second and subsequent lines. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/648/1f8/cbd/6481f8cbdaf08c304aab457ea42b520d.png"><br>  <i><font color="gray">The subtasks between the left and right edges depend on the three subtasks above</font></i> <br><br>  Finally, the cell from the right edge represents the second borderline situation.  Since there are no more cells to the right, it depends only on the cells directly above and above to the left. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4a8/38e/551/4a838e551dbe3859974e6fd5c13204d0.png"><br>  <i><font color="gray">Subtasks on the right edge only depend on two cells above</font></i> <br><br>  The process is repeated for all subsequent lines. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fe2/42d/350/fe242d35089994e199c1028fb38554f0.gif"><br>  <i><font color="gray">Since there are many arrows in the dependency graph, this animation shows dependencies for each subtask in turn.</font></i> <br><br>  The full dependency graph scares a lot of arrows, but viewing them one by one helps to set up explicit templates. <br><br><h3>  Implementation from the bottom up </h3><br>  After conducting this analysis, we obtained the processing order: <br><br><ul><li>  Go from the top of the image to the bottom. <br></li><li>  Each line can act in any order.  The natural choice is to go from left to right. </li></ul><br>  Since each row depends only on the previous one, you need to save only two rows of data: one for the previous row and one for the current row.  Moving from left to right, we can even throw away individual elements from the previous line as they are used.  However, this complicates the algorithm, since it is necessary to find out which parts of the previous line can be discarded. <br><br>  In the following Python code, the input is a list of lines, where each line contains a list of numbers representing the individual pixel energies in this line.  The input is <code>pixel_energies</code> , and <code>pixel_energies[y][x]</code> represents the pixel energy in coordinates <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.328ex" height="2.66ex" viewBox="0 -832 2294.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-78" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-2C" x="962" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-79" x="1407" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-29" x="1904" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-19"> (x, y) </script>  . <br><br>  Let's start by calculating the energy of the seams of the upper row, simply by copying the individual energies of the pixels in the upper row: <br><br><pre> <code class="python hljs">previous_seam_energies_row = list(pixel_energies[<span class="hljs-number"><span class="hljs-number">0</span></span>])</code> </pre> <br>  Then we cycle the remaining input lines, calculating the seam energies for each line.  The most "difficult" part is to determine which elements of the previous line to refer to, since there are no pixels to the left of the left edge or to the right of the right edge. <br><br>  At each iteration, a new list of seam energies is created for the current line.  At the end of the iteration, we replace the data of the previous line with the data of the current line for the next iteration.  Here is how we discard the previous line: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># Skip the first row in the following loop. for y in range(1, len(pixel_energies)): pixel_energies_row = pixel_energies[y] seam_energies_row = [] for x, pixel_energy in enumerate(pixel_energies_row): # Determine the range of x values to iterate over in the previous # row. The range depends on if the current pixel is in the middle of # the image, or on one of the edges. x_left = max(x - 1, 0) x_right = min(x + 1, len(pixel_energies_row) - 1) x_range = range(x_left, x_right + 1) min_seam_energy = pixel_energy + \ min(previous_seam_energies_row[x_i] for x_i in x_range) seam_energies_row.append(min_seam_energy) previous_seam_energies_row = seam_energies_row</span></span></code> </pre> <br>  In summary, <code>previous_seam_energies_row</code> contains the seam energies for the bottom line.  We find the minimum value in this list - and this is the answer! <br><br><pre> <code class="python hljs">min(seam_energy <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> seam_energy <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> previous_seam_energies_row)</code> </pre> <br>  You can check this implementation by wrapping the above code in a function, and then calling it with a two-dimensional array that you built.  The following inputs are chosen so that the greedy approach fails, with the obvious seam with the lowest energy: <br><br><pre> <code class="python hljs">ENERGIES = [ [<span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>], [<span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>], [<span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>], [<span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>], ] print(min_seam_energy(ENERGIES))</code> </pre> <br><h3>  Spatial and temporal complexity </h3><br>  Each pixel in the source image corresponds to one subtask.  For each of the subtasks there are no more than three dependencies, so the solution to each of them involves a constant amount of work.  The last row passes twice.  So for the image width <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>W</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.435ex" height="2.057ex" viewBox="0 -780.1 1048.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-57" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>W</mi></math></span></span><script type="math/tex" id="MathJax-Element-20"> W </script>  and tall <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>H</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.064ex" height="2.057ex" viewBox="0 -780.1 888.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-48" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>H</mi></math></span></span><script type="math/tex" id="MathJax-Element-21"> H </script>  pixel time complexity is equal to <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mi>W</mi><mo>&amp;#xD7;</mo><mi>H</mi><mo>+</mo><mi>W</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="16.197ex" height="2.66ex" viewBox="0 -832 6973.9 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-28" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-57" x="1153" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-D7" x="2423" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-48" x="3424" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-2B" x="4535" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-57" x="5535" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-29" x="6584" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>W</mi><mo>√ó</mo><mi>H</mi><mo>+</mo><mi>W</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-22"> O (W √ó H + W) </script>  . <br><br>  At each moment of time we have two lists: one for the previous line and one for the current one.  In the first <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>W</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.435ex" height="2.057ex" viewBox="0 -780.1 1048.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-57" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>W</mi></math></span></span><script type="math/tex" id="MathJax-Element-23"> W </script>  elements, and the second gradually increases to <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>W</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.435ex" height="2.057ex" viewBox="0 -780.1 1048.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-57" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>W</mi></math></span></span><script type="math/tex" id="MathJax-Element-24"> W </script>  .  Thus, the spatial complexity is <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mn>2</mn><mi>W</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.18ex" height="2.66ex" viewBox="0 -832 3091.5 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-28" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-32" x="1153" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-57" x="1653" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-29" x="2702" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mn>2</mn><mi>W</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-25"> O (2W) </script>  that is just <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mi>W</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.018ex" height="2.66ex" viewBox="0 -832 2591 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-28" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-57" x="1153" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-29" x="2201" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>W</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-26"> O (W) </script>  . <br><br>  Note that if we actually discarded the data elements of the previous line, we would reduce the list of elements of the previous line at about the same speed as the list of the current line grows.  Thus, the spatial complexity will remain <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mi>W</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.018ex" height="2.66ex" viewBox="0 -832 2591 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-28" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-57" x="1153" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-29" x="2201" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>W</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-27"> O (W) </script>  .  Although the width may vary, this is usually not so important. <br><br><h1>  Reverse pointers for finding the seam with the lowest energy </h1><br>  So, we have found the value of the lowest-energy weld, but what to do with this information?  After all, in fact, we are concerned not with the value of energy, but with the seam itself!  The problem is that from the end pixel there is no way to return to the rest of the seam. <br><br>  This is what I missed in previous articles, but the same applies to many of the problems of dynamic programming.  For example, if you remember the <a href="https://avikdas.com/2019/04/15/a-graphical-introduction-to-dynamic-programming.html">house robber problem</a> , we have found the maximum value for the amount of robbery, but not what specific houses should be robbed to get this amount. <br><br><h3>  Return Pointer Representation </h3><br>  General answer: store <i>back pointers</i> .  In the task of cutting seams, we need not only the value of the seam energy at each pixel.  You also need to know which of the pixels in the previous line led to this energy.  Keeping this information, we can follow the inverse signs up to the top line, getting the coordinates of all the pixels that make up the seam with the least energy. <br><br>  First, create a class for storing energy and return pointers.  Energy will be used to calculate subtasks.  Since the backward pointer determines which pixel in the previous line gave the current energy, we can simply represent it as the x coordinate. <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SeamEnergyWithBackPointer</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">()</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, energy, x_coordinate_in_previous_row=None)</span></span></span><span class="hljs-function">:</span></span> self.energy = energy self.x_coordinate_in_previous_row = x_coordinate_in_previous_row</code> </pre> <br>  The result of the calculation of each subtask is not just a number, but an instance of this class. <br><br><h3>  Reverse Pointer Storage </h3><br>  At the end you have to go back through the entire height of the image, following the opposite signs, in order to restore the seam with the least energy.  Unfortunately, this means that you need to store pointers for all pixels of the image, and not just for the previous line. <br><br>  To do this, simply save the full result of all subtasks, although technically you can refuse the numerical energies of the seam of the previous lines.  The results are stored in a two-dimensional array, which looks the same as the input array. <br><br>  Let's start with the first line, which contains only individual pixel energies.  Since there is no previous line, all the return pointers are missing, but for consistency, we will still keep instances of <code>SeamEnergyWithBackPointers</code> : <br><br><pre> <code class="python hljs">seam_energies = [] <span class="hljs-comment"><span class="hljs-comment"># Initialize the top row of seam energies by copying over the top row of # the pixel energies. There are no back pointers in the top row. seam_energies.append([ SeamEnergyWithBackPointer(pixel_energy) for pixel_energy in pixel_energies[0] ])</span></span></code> </pre> <br>  The main loop works basically the same as the previous implementation, with the following differences: <br><br><ul><li>  The data for the previous line contains instances of <code>SeamEnergyWithBackPointer</code> , so when calculating the value of the recurrence relation, you should look for the seam energy inside these objects. <br></li><li>  To save the data for the current pixel, you need to build a new instance of <code>SeamEnergyWithBackPointer</code> .  Here we will store the seam energy for the current pixel, as well as the x coordinate from the previous line, used to calculate the current seam energy. <br></li><li>  At the end of each line, instead of discarding the data of the previous line, we simply add the data of the current line to <code>seam_energies</code> . </li></ul><br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># Skip the first row in the following loop. for y in range(1, len(pixel_energies)): pixel_energies_row = pixel_energies[y] seam_energies_row = [] for x, pixel_energy in enumerate(pixel_energies_row): # Determine the range of x values to iterate over in the previous # row. The range depends on if the current pixel is in the middle of # the image, or on one of the edges. x_left = max(x - 1, 0) x_right = min(x + 1, len(pixel_energies_row) - 1) x_range = range(x_left, x_right + 1) min_parent_x = min( x_range, key=lambda x_i: seam_energies[y - 1][x_i].energy ) min_seam_energy = SeamEnergyWithBackPointer( pixel_energy + seam_energies[y - 1][min_parent_x].energy, min_parent_x ) seam_energies_row.append(min_seam_energy) seam_energies.append(seam_energies_row)</span></span></code> </pre> <br><h3>  We go on the opposite signs </h3><br>  Now the entire table of subtasks is full and we can restore the seam with the least energy.  We start by searching for the x coordinate in the bottom line, which corresponds to the seam with the lowest energy: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># Find the x coordinate with minimal seam energy in the bottom row. min_seam_end_x = min( range(len(seam_energies[-1])), key=lambda x: seam_energies[-1][x].energy )</span></span></code> </pre> <br>  Now go from the bottom of the image to the top, changing <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.155ex" height="1.817ex" viewBox="0 -520.7 497.5 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-79" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-28"> y </script>  from <code>len(seam_energies) - 1</code> to zero.  At each iteration we add the current pair. <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.328ex" height="2.66ex" viewBox="0 -832 2294.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-78" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-2C" x="962" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-79" x="1407" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-29" x="1904" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-29"> (x, y) </script>  to the list representing our seam and then set the value <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-78" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-30"> x </script>  for the object pointed to by <code>SeamEnergyWithBackPointer</code> in the current line. <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># Follow the back pointers to form a list of coordinates that form the # lowest-energy seam. seam = [] seam_point_x = min_seam_end_x for y in range(len(seam_energies) - 1, -1, -1): seam.append((seam_point_x, y)) seam_point_x = \ seam_energies[y][seam_point_x].x_coordinate_in_previous_row seam.reverse()</span></span></code> </pre> <br>  So the seam is built from the bottom up, the list can then be read in reverse order, if you need the coordinates from top to bottom. <br><br><h3>  Spatial and temporal complexity </h3><br>  The time complexity is similar to the previous one, because we still need to process each pixel once.  After viewing the last line and searching for the seam with the least energy, we then rise to the full height of the image to restore the seam.  So for the image <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>W</mi><mo>&amp;#xD7;</mo><mi>H</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.339ex" height="2.057ex" viewBox="0 -780.1 3159.9 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-57" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-D7" x="1270" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-48" x="2271" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>W</mi><mo>√ó</mo><mi>H</mi></math></span></span><script type="math/tex" id="MathJax-Element-31"> W √ó H </script>  time complexity is equal <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mi>W</mi><mo>&amp;#xD7;</mo><mi>H</mi><mo>+</mo><mi>W</mi><mo>+</mo><mi>H</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="21.101ex" height="2.66ex" viewBox="0 -832 9085.3 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-28" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-57" x="1153" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-D7" x="2423" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-48" x="3424" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-2B" x="4535" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-57" x="5535" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-2B" x="6806" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-48" x="7807" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-29" x="8695" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>W</mi><mo>√ó</mo><mi>H</mi><mo>+</mo><mi>W</mi><mo>+</mo><mi>H</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-32"> O (W √ó H + W + H) </script>  . <br><br>  As for volume, we still keep a constant amount of data for each subtask, but now we don‚Äôt discard any data.  So we use volume <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-33-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mi>W</mi><mo>&amp;#xD7;</mo><mi>H</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.922ex" height="2.66ex" viewBox="0 -832 4702.4 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-28" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-57" x="1153" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-D7" x="2423" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-48" x="3424" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-29" x="4312" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>W</mi><mo>√ó</mo><mi>H</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-33"> O (W √ó H) </script>  . <br><br><h1>  Removing low-energy joints </h1><br>  As soon as a vertical seam with the lowest energy is found, we can simply copy the pixels from the original image to the new one.  Each line of the new image contains all the pixels from the corresponding line of the original image, with the exception of the pixel from the seam with the lowest energy.  Since we remove one pixel in each row, starting with the image <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-34-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>W</mi><mo>&amp;#xD7;</mo><mi>H</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.339ex" height="2.057ex" viewBox="0 -780.1 3159.9 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-57" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-D7" x="1270" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-48" x="2271" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>W</mi><mo>√ó</mo><mi>H</mi></math></span></span><script type="math/tex" id="MathJax-Element-34"> W √ó H </script>  then we get the image <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-35-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>W</mi><mo>&amp;#x2212;</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#xD7;</mo><mi>H</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.151ex" height="2.66ex" viewBox="0 -832 5662.4 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-28" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-57" x="389" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-2212" x="1660" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-31" x="2660" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-29" x="3161" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMAIN-D7" x="3773" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/458110/&amp;xid=17259,15700023,15700186,15700191,15700256,15700259,15700262&amp;usg=ALkJrhgsMCJ-fWL2QQmgD4PO81-V98Edjg#MJMATHI-48" x="4773" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>W</mi><mo>‚àí</mo><mn>1</mn><mo stretchy="false">)</mo><mo>√ó</mo><mi>H</mi></math></span></span><script type="math/tex" id="MathJax-Element-35"> (W ‚àí 1) √ó H </script>  . <br><br>  We can repeat this process by recalculating the energy function in the new image and finding the lowest-energy weld on it.  It seems tempting to find more than one low-energy weld in the original image, and then remove them all at once.  The problem is that the two seams may intersect.  When the first is removed, the second will become invalid, because it lacks one or several pixels. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/B9HPREBePI4" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  <i><font color="gray">Animation of the seam removal process.</font></i>  <i><font color="gray">It is better to watch in full screen mode for a clearer view of the seams.</font></i> <br><br>  Each frame of the video is an image at each iteration with the overlay visualization of the seam with the least energy. <br><br><h1>  Another example </h1><br>  The article had many detailed explanations, so let's end with a series of beautiful photos!  The following photo shows a rock formation in Arches National Park: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7ee/947/449/7ee947449ba6b1204b6a3c17b844658b.jpg"><br>  <i><font color="gray">Rock formation with a hole in Arches National Park.</font></i>  <i><font color="gray">Photo: <a href="https://www.flickr.com/photos/exit78/">Mike Goad</a> on <a href="https://flic.kr/p/4hxxz5">Flickr</a></font></i> <br><br>  The energy function for this image is: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9b2/aa4/e8f/9b2aa4e8f4f4c736276a1b0c50ee949b.jpg"><br>  <i><font color="gray">The energy of each pixel in the photo: the lighter - the higher it is.</font></i>  <i><font color="gray">Note the high energy around the edge of the hole.</font></i> <br><br>  As a result of the calculation, such a seam is obtained with the lowest energy.  Note that it passes through the rock on the right, entering directly into the rock formation where the lighted part at the top of the rock coincides with the color of the sky.  Perhaps you should choose a better energy function! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a3b/90a/943/a3b90a94356a10044acb45950af7d8de.jpg"><br>  <i><font color="gray">The lowest-energy seam found in the image is shown with a red line five pixels wide for visibility, although in fact the seam is only one pixel wide</font></i> <br><br>  Finally, the image of the arch after resizing: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/833/166/796/8331667968e36e0bfc80d2d214772379.jpg"><br>  <i><font color="gray">Arch after compression at 1024 pixels</font></i> <br><br>  The result is definitely not perfect: many of the edges of the mountain from the original image are distorted.  One improvement could be the implementation of one of the other energy functions listed in a scientific article. <br><br><hr><br>  Although dynamic programming is usually discussed in theory, it is a useful practical method for solving complex problems.  In this article, we looked at one of the applications of dynamic programming: resizing an image based on content by cutting out seams. <br><br>  We applied the same principles of splitting the task into smaller subtasks, analyzing the dependencies between these subtasks, and then solving the subtasks in a manner that minimizes the spatial and temporal complexity of the algorithm.  In addition, we studied the use of backward pointers to not only find the energy value for the optimal seam, but also to determine the coordinates of each pixel that made up this value.  Then they applied these parts to the real problem, which requires some pre- and post-processing for truly effective use of the dynamic programming algorithm. </div><p>Source: <a href="https://habr.com/ru/post/458110/">https://habr.com/ru/post/458110/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../4581/index.html">IE7 and CSS support: expert comments</a></li>
<li><a href="../458102/index.html">Effective web development workflow: Confluence, Airtable and other tools</a></li>
<li><a href="../458104/index.html">RDMA inside the data center in the implementation of Huawei</a></li>
<li><a href="../458106/index.html">Jetpack Compose dive</a></li>
<li><a href="../45811/index.html">Black Triangle Dock in Leopard</a></li>
<li><a href="../458112/index.html">Sony's Xperia 10 Review</a></li>
<li><a href="../458116/index.html">SwiftUI and auto-renewable subscriptions</a></li>
<li><a href="../458118/index.html">React Native Guide for Beginner Android Developers (with an example application)</a></li>
<li><a href="../45812/index.html">SEO in real life ...</a></li>
<li><a href="../458120/index.html">Habr Weekly # 7 / Neural Network strips people, luxury Airbnb, they will be allowed to google on the USE, on Google Play a lot of fakes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>