<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Cyclic cuts, shifts and rotation of collections</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="One of the typical tasks when working with collections and arrays is the selection of n elements, starting with the i -th index, or, alternatively, th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Cyclic cuts, shifts and rotation of collections</h1><div class="post__text post__text-html js-mediator-article">  One of the typical tasks when working with collections and arrays is the selection of <i><b>n</b></i> elements, starting with the <i><b>i</b></i> -th index, or, alternatively, the selection of elements from the <i><b>i</b></i> -th through the <i><b>jth</b></i> index.  In <i>C #</i> using the <i>Linq</i> library extension methods, it is solved very simply: <br><br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> selectedItems = items.Skip(i).Take(n).ToArray(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> selectedItems = items.Skip(i).Take(j - i).ToArray();</code> </pre> <br>  For strings, there is a special <i>Substing</i> method: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> target = source.Substing(i, n); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> target = source.Substing(i, j - i); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> target = source.Substing(i); <span class="hljs-comment"><span class="hljs-comment">// from i to end</span></span></code> </pre><br>  Often, novice developers invent their bikes for such purposes due to lack of knowledge, so at interviews technical interviewers sometimes ask questions about this topic.  In some programming languages, there is also a related and very interesting concept of <i>slices</i> , a detailed explanation of which with examples follows. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/b24/129/b82/b24129b82a9e42fba40fddb01381c2dc.png" alt="image"><br><a name="habracut"></a><br>  Let given an array of letters sorted alphabetically.  Each letter corresponds not only to the usual positive index, counted from left to right (from the head), but also negative, counted from right to left (from the tail): <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> bodyLetters = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span>[] {<span class="hljs-string"><span class="hljs-string">'A'</span></span>, <span class="hljs-string"><span class="hljs-string">'B'</span></span>, <span class="hljs-string"><span class="hljs-string">'C'</span></span>, <span class="hljs-string"><span class="hljs-string">'D'</span></span>, <span class="hljs-string"><span class="hljs-string">'E'</span></span>, <span class="hljs-string"><span class="hljs-string">'F'</span></span>, <span class="hljs-string"><span class="hljs-string">'G'</span></span>, <span class="hljs-string"><span class="hljs-string">'I'</span></span>}; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> headIndexes = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span>[] { <span class="hljs-number"><span class="hljs-number">0</span></span> , <span class="hljs-number"><span class="hljs-number">1</span></span> , <span class="hljs-number"><span class="hljs-number">2</span></span> , <span class="hljs-number"><span class="hljs-number">3</span></span> , <span class="hljs-number"><span class="hljs-number">4</span></span> , <span class="hljs-number"><span class="hljs-number">5</span></span> , <span class="hljs-number"><span class="hljs-number">6</span></span> , <span class="hljs-number"><span class="hljs-number">7</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> tailIndexes = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span>[] {<span class="hljs-number"><span class="hljs-number">-8</span></span> , <span class="hljs-number"><span class="hljs-number">-7</span></span> , <span class="hljs-number"><span class="hljs-number">-6</span></span> , <span class="hljs-number"><span class="hljs-number">-5</span></span> , <span class="hljs-number"><span class="hljs-number">-4</span></span> , <span class="hljs-number"><span class="hljs-number">-3</span></span> , <span class="hljs-number"><span class="hljs-number">-2</span></span> , <span class="hljs-number"><span class="hljs-number">-1</span></span> };</code> </pre><br>  <i>UPDATE</i> <i><br></i>  <i>Initially, the method of indexing the Python language was used as the basis (the second parameter of the method is the tail index), but during the discussions it turned out that this is not the optimal solution (using the length [including negative] as the second parameter gives more advantages), so the material was updated</i> <br><br><div class="spoiler">  <b class="spoiler_title">A variant of the Slice method with Python language indexing (the second parameter is the tail index)</b> <div class="spoiler_text">  The choice of elements from the fourth to the seventh inclusive can be done in several ways: <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//      bodyLetters.Slice(3, 7); // 'D', 'E', 'F', 'G' bodyLetters.Slice(-5, 7); // 'D', 'E', 'F', 'G' bodyLetters.Slice(3, -1); // 'D', 'E', 'F', 'G' bodyLetters.Slice(-5, -1); // 'D', 'E', 'F', 'G'</span></span></code> </pre><br>  It is convenient not to turn on the tail, since the sample length is then easily calculated from indices without an extra increment of one and does not cause confusion (5-2 = 3 instead of 5-2 + 1 = 4) <br><br>  But the question arises how, in this case, to include the last element of the original collection in the resulting sample, because there is no element with index <i><b>8</b></i> , and there is not even a negative match for it (unless the integer <i>-0</i> , which cannot be distinguished from <i>+0</i> )?  Here there is some mismatch.  Of course, you can make the inclusion of the tail, complicating the calculation of the length, or artificially use indices outside the array, as was done, for example, in the <i>Python language</i> . <br><br>  To make the best decision, let's consider other points, how should the method behave when the tail index is before the head index? <br><br><pre> <code class="cs hljs">bodyLetters.Slice(<span class="hljs-number"><span class="hljs-number">7</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>); <span class="hljs-comment"><span class="hljs-comment">// ??? bodyLetters.Slice(-1, -5); // ???</span></span></code> </pre><br>  The most elementary solutions are to give an empty sample, throw an exception, or tolerantly change the indexes of the tail and head in some places, and then continue processing, perhaps, output the resulting sample in the reverse order? <br><br>  And what to do when the indices of the tail and head are the same?  According to our rules, we turn on the head, but we exclude the tail, but in this case the tail and the head are the same!  There is a logical contradiction.  Returning to the case with the inclusion of the tail? <br><br>  Let's think ... What if we <b>close, loop the array on ourselves</b> ?  That is, suppose that immediately after the last index <i><b>7</b></i> goes <i><b>0</b></i> again, and if you pass, say, parameters <i>6</i> and <i>2</i> to the method, then output the following result <i>'G', 'I', 'A', 'B'</i> .  Then to include the last element of the original collection in the sample, it suffices to write <i>Slice (6, 0) // 'G' 'I'</i> , and the record <i>Slice (5, 5)</i> will result in the original collection being cyclically shifted five indexes to the left - <i>'F', 'G', 'I', 'A', 'B', 'C', 'D', 'E'</i> - this is a miracle! <br><br>  In order to get one element, you need to write <i>Slice (5, 6)</i> , plus no difficulties with negative indices, and if you suddenly go beyond the bounds of the array, you will get the expected exception.  How beautiful everything turned out!  If you suddenly need to display the cut-off sample in the reverse order, then the <i>Reverse</i> method will help.  We found a common solution for two classes of problems at once, devoid of contradictions and very natural ... <br><br><pre> <code class="cs hljs"><span class="hljs-comment"><span class="hljs-comment">//      bodyLetters.Slice(6, 2); // 'G', 'I', 'A', 'B' bodyLetters.Slice(5, 5); // 'F', 'G', 'I', 'A', 'B', 'C', 'D', 'E' bodyLetters.Slice(5, 5, SliceOptions.Lazy); // {empty} bodyLetters.Slice(5, 6); // 'F' bodyLetters.Slice(5, 0); // 'F', 'G', 'I' bodyLetters.Slice(5); // 'F', 'G', 'I'</span></span></code> </pre><br>  Well, it remains to implement it! <br><br><pre> <code class="cs hljs"> [<span class="hljs-meta"><span class="hljs-meta">Flags</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">enum</span></span> SliceOptions { None = <span class="hljs-number"><span class="hljs-number">0</span></span>, Lazy = <span class="hljs-number"><span class="hljs-number">1</span></span>, } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> IEnumerable&lt;T&gt; Slice&lt;T&gt;( <span class="hljs-keyword"><span class="hljs-keyword">this</span></span> IEnumerable&lt;T&gt; collection, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> head, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> tail = <span class="hljs-number"><span class="hljs-number">0</span></span>, SliceOptions options = SliceOptions.None) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> items = collection <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> T[] ?? collection.ToArray(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> count = items.Count(); head = head &lt; <span class="hljs-number"><span class="hljs-number">0</span></span> ? count + head : head; tail = tail &lt; <span class="hljs-number"><span class="hljs-number">0</span></span> ? count + tail : tail; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (head &lt; <span class="hljs-number"><span class="hljs-number">0</span></span> || count - <span class="hljs-number"><span class="hljs-number">1</span></span> &lt; head) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArgumentOutOfRangeException(<span class="hljs-string"><span class="hljs-string">"head"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (tail &lt; <span class="hljs-number"><span class="hljs-number">0</span></span> || count - <span class="hljs-number"><span class="hljs-number">1</span></span> &lt; tail) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArgumentOutOfRangeException(<span class="hljs-string"><span class="hljs-string">"tail"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (head == tail &amp;&amp; (options &amp; SliceOptions.Lazy) == SliceOptions.Lazy) { <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (head &lt; tail) { <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> item <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> items.Skip(head).Take(tail - head)) { <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> item; } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> item <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> items.Skip(head)) { <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> item; } <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> item <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> items.Skip(<span class="hljs-number"><span class="hljs-number">0</span></span>).Take(tail)) { <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> item; } } }</code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Update 2</b> <div class="spoiler_text"><pre> <code class="cs hljs"> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> IEnumerable&lt;T&gt; Turn&lt;T&gt;(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span> IList&lt;T&gt; items, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> skip, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> turnsCount = <span class="hljs-number"><span class="hljs-number">0</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> reverse = skip &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> count = items.Count; skip = reverse ? count + skip : skip; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> take = turnsCount == <span class="hljs-number"><span class="hljs-number">0</span></span> ? reverse ? -skip - <span class="hljs-number"><span class="hljs-number">1</span></span> : count - skip : count*turnsCount; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> items.Ring(skip, take); } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> IEnumerable&lt;T&gt; Ring&lt;T&gt;(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span> IList&lt;T&gt; items, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> skip, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> take) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> reverse = take &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> count = items.Count; skip = skip &lt; <span class="hljs-number"><span class="hljs-number">0</span></span> ? count + skip : skip; skip = skip &lt; count ? skip : skip%count; take = reverse ? -take : take; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; take; i++) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> j = i &lt; count ? i : i%count; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> index = reverse ? skip - j : skip + j; index = index &lt; <span class="hljs-number"><span class="hljs-number">0</span></span> ? count + index : index; index = index &lt; count ? index : index%count; <span class="hljs-keyword"><span class="hljs-keyword">yield</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> items[index]; } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] args</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> bodyLetters = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span>[] {<span class="hljs-string"><span class="hljs-string">'A'</span></span>, <span class="hljs-string"><span class="hljs-string">'B'</span></span>, <span class="hljs-string"><span class="hljs-string">'C'</span></span>, <span class="hljs-string"><span class="hljs-string">'D'</span></span>, <span class="hljs-string"><span class="hljs-string">'E'</span></span>, <span class="hljs-string"><span class="hljs-string">'F'</span></span>, <span class="hljs-string"><span class="hljs-string">'G'</span></span>, <span class="hljs-string"><span class="hljs-string">'I'</span></span>}; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> headIndexes = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span>[] { <span class="hljs-number"><span class="hljs-number">0</span></span> , <span class="hljs-number"><span class="hljs-number">1</span></span> , <span class="hljs-number"><span class="hljs-number">2</span></span> , <span class="hljs-number"><span class="hljs-number">3</span></span> , <span class="hljs-number"><span class="hljs-number">4</span></span> , <span class="hljs-number"><span class="hljs-number">5</span></span> , <span class="hljs-number"><span class="hljs-number">6</span></span> , <span class="hljs-number"><span class="hljs-number">7</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> tailIndexes = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span>[] {<span class="hljs-number"><span class="hljs-number">-8</span></span> , <span class="hljs-number"><span class="hljs-number">-7</span></span> , <span class="hljs-number"><span class="hljs-number">-6</span></span> , <span class="hljs-number"><span class="hljs-number">-5</span></span> , <span class="hljs-number"><span class="hljs-number">-4</span></span> , <span class="hljs-number"><span class="hljs-number">-3</span></span> , <span class="hljs-number"><span class="hljs-number">-2</span></span> , <span class="hljs-number"><span class="hljs-number">-1</span></span> }; <span class="hljs-comment"><span class="hljs-comment">// 'C', 'D', 'E', 'F', 'G', 'I', 'A', 'B', bodyLetters.Ring(2, 8).ToList().ForEach(Console.Write); Console.WriteLine(); // 'C', 'B', 'A', 'I', 'G', 'F', 'E', 'D', bodyLetters.Ring(2, -8).ToList().ForEach(Console.Write); Console.WriteLine(); // 'D', 'E', 'F', 'G' bodyLetters.Ring(3, 4).ToList().ForEach(Console.Write); Console.WriteLine(); // 'D', 'E', 'F', 'G' bodyLetters.Ring(-5, 4).ToList().ForEach(Console.Write); Console.WriteLine(); // 'D', 'C', 'B', 'A' bodyLetters.Ring(-5, -4).ToList().ForEach(Console.Write); Console.WriteLine(); // 'D', 'E', 'F', 'G', 'I', 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'I', 'A', 'B', 'C' bodyLetters.Ring(3, 16).ToList().ForEach(Console.Write); Console.WriteLine(); // 'D', 'C', 'B', 'A', 'I', 'G', 'F', 'E', 'D', 'C', 'B', 'A', 'I', 'G', 'F', 'E' bodyLetters.Ring(-5, -16).ToList().ForEach(Console.Write); Console.WriteLine(); // 'D', 'E', 'F', 'G', 'I' bodyLetters.Turn(3).ToList().ForEach(Console.Write); Console.WriteLine(); // 'D', 'C', 'B', 'A' bodyLetters.Turn(-5).ToList().ForEach(Console.Write); Console.WriteLine(); Console.ReadKey(); }</span></span></code> </pre><br></div></div><br>  Final Update <br><pre> <code class="cs hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] args</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> bodyLetters = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span>[] {<span class="hljs-string"><span class="hljs-string">'A'</span></span>, <span class="hljs-string"><span class="hljs-string">'B'</span></span>, <span class="hljs-string"><span class="hljs-string">'C'</span></span>, <span class="hljs-string"><span class="hljs-string">'D'</span></span>, <span class="hljs-string"><span class="hljs-string">'E'</span></span>, <span class="hljs-string"><span class="hljs-string">'F'</span></span>, <span class="hljs-string"><span class="hljs-string">'G'</span></span>, <span class="hljs-string"><span class="hljs-string">'I'</span></span>}; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> headIndexes = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span>[] { <span class="hljs-number"><span class="hljs-number">0</span></span> , <span class="hljs-number"><span class="hljs-number">1</span></span> , <span class="hljs-number"><span class="hljs-number">2</span></span> , <span class="hljs-number"><span class="hljs-number">3</span></span> , <span class="hljs-number"><span class="hljs-number">4</span></span> , <span class="hljs-number"><span class="hljs-number">5</span></span> , <span class="hljs-number"><span class="hljs-number">6</span></span> , <span class="hljs-number"><span class="hljs-number">7</span></span> }; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> tailIndexes = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span>[] {<span class="hljs-number"><span class="hljs-number">-8</span></span> , <span class="hljs-number"><span class="hljs-number">-7</span></span> , <span class="hljs-number"><span class="hljs-number">-6</span></span> , <span class="hljs-number"><span class="hljs-number">-5</span></span> , <span class="hljs-number"><span class="hljs-number">-4</span></span> , <span class="hljs-number"><span class="hljs-number">-3</span></span> , <span class="hljs-number"><span class="hljs-number">-2</span></span> , <span class="hljs-number"><span class="hljs-number">-1</span></span> }; <span class="hljs-comment"><span class="hljs-comment">// CDEFGICDEF bodyLetters.SkipByRing(18).TakeByRing(10).ToList().ForEach(Console.Write); Console.WriteLine(); // FEDCBAFEDC bodyLetters.SkipByRing(-18).TakeByRing(10).ToList().ForEach(Console.Write); Console.WriteLine(); // IGFEDCIGFE bodyLetters.SkipByRing(18).TakeByRing(-10).ToList().ForEach(Console.Write); Console.WriteLine(); // ABCDEFABCD bodyLetters.SkipByRing(-18).TakeByRing(-10).ToList().ForEach(Console.Write); Console.WriteLine(); Console.WriteLine(); // CDEFGIABCD bodyLetters.SliceByRing(18, 10).ToList().ForEach(Console.Write); Console.WriteLine(); // GIABCDEFGI bodyLetters.SliceByRing(-18, 10).ToList().ForEach(Console.Write); Console.WriteLine(); // BAIGFEDCBA bodyLetters.SliceByRing(18, -10).ToList().ForEach(Console.Write); Console.WriteLine(); // FEDCBAIGFE bodyLetters.SliceByRing(-18, -10).ToList().ForEach(Console.Write); Console.WriteLine(); Console.ReadKey(); }</span></span></code> </pre><br>  Implementation <br><pre> <code class="cs hljs"> <span class="hljs-comment"><span class="hljs-comment">// ReSharper disable PossibleMultipleEnumeration // ReSharper disable LoopCanBePartlyConvertedToQuery public static IEnumerable&lt;T&gt; SkipByRing&lt;T&gt;(this IEnumerable&lt;T&gt; source, int count) { var originalCount = 0; var reverse = count &lt; 0; count = reverse ? -count : count; source = reverse ? source.Reverse() : source; while (true) { if (originalCount &gt; 0) count %= originalCount; foreach (var item in source) { originalCount++; if (count &gt; 0) { count--; continue; } yield return item; } if (count == 0) yield break; } } public static IEnumerable&lt;T&gt; TakeByRing&lt;T&gt;(this IEnumerable&lt;T&gt; source, int count) { var reverse = count &lt; 0; count = reverse ? -count : count; source = reverse ? source.Reverse() : source; while (true) { foreach (var item in source) { if (count &gt; 0) { count--; yield return item; } } if (count == 0) yield break; } } public static IEnumerable&lt;T&gt; SliceByRing&lt;T&gt;(this IEnumerable&lt;T&gt; source, int skipCount, int takeCount) { var originalCount = 0; var skipReverse = skipCount &lt; 0; var takeReverse = takeCount &lt; 0; skipCount = skipReverse ? -skipCount : skipCount; takeCount = takeReverse ? -takeCount : takeCount; source = takeReverse ? source.Reverse() : source; if (skipReverse ^ takeReverse) { var count = source.Count(); skipCount = count - skipCount % count; } while (true) { if (originalCount &gt; 0) skipCount %= originalCount; foreach (var item in source) { originalCount++; if (skipCount &gt; 0) { skipCount--; continue; } if (takeCount &gt; 0) { takeCount--; yield return item; } } if (takeCount == 0) yield break; } }</span></span></code> </pre><br><br>  So <i><b>yield</b></i> us.  And quite a bit of code came out.  I like, and you? <br><br>  <b>PS</b> And that's not all, this article was written intentionally.  The <i>Slice</i> method is a small part of the syntax sugar of the powerful and functional library <a href="http://makeloft.by/ru/tools"><i>Aero Framework</i></a> , which provides abstractions and higher level concepts so delicately coordinated with each other, that with proper patience in studying this harmony will amaze you ... True, the <i>Aero Framework</i> code is the most perfect that I was lucky to write in life at the moment.  And this article is about <u>cyclical cuts and shifts</u> only zamanuha!  Learn the <i>Aero Framework</i> and you will definitely appreciate it. </div><p>Source: <a href="https://habr.com/ru/post/272743/">https://habr.com/ru/post/272743/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../272729/index.html">Robo code game challenge</a></li>
<li><a href="../272733/index.html">"Transparent" Squid with HTTPS filtering resources without certificate substitution (x86, x64 - universal instruction)</a></li>
<li><a href="../272735/index.html">Postgres NoSQL is better than MongoDB?</a></li>
<li><a href="../272737/index.html">Using the MVVM (Model-View-ViewModel) pattern in Android</a></li>
<li><a href="../272739/index.html">Python Meetup October: Deliberate Practice and Desktop Applications on Penta.by</a></li>
<li><a href="../272749/index.html">CRM implementation. From lead registration to closing a deal. Case and explanation</a></li>
<li><a href="../272751/index.html">Desktop in the cloud</a></li>
<li><a href="../272753/index.html">Hellish UX Spotify</a></li>
<li><a href="../272755/index.html">Hello, SaaS | Russian SaaS 2015</a></li>
<li><a href="../272759/index.html">Different programming languages ‚Äã‚Äãand their applications. Lecture in Yandex</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>