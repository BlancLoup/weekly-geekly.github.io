<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>3CX integration with Office 365 through the Azure API</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="PBX 3CX v16 editions of Pro and Enterprise offers full integration with Office 365 applications. In particular, it has been implemented: 



- Synchro...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>3CX integration with Office 365 through the Azure API</h1><div class="post__text post__text-html js-mediator-article">  PBX 3CX v16 editions of Pro and Enterprise offers full integration with Office 365 applications. In particular, it has been implemented: <br><br><ul><li>  Synchronize Office 365 users and 3CX extension numbers (users). <br></li><li>  Synchronize personal contacts of Office users and personal address book 3CX. <br></li><li>  Synchronize Office 365 user's calendar (busy) status and 3CX extension status. <br></li></ul><br>  To make outgoing calls from the Office web application interface, 3CX uses the <a href="https://www.3cx.ru/user-manual/click-to-call/">3CX Click to Call</a> extension for <a href="https://chrome.google.com/webstore/detail/3cx-click-to-call/ingddacbmngapennhhfhnpjnaklakach">Chrome</a> and <a href="https://addons.mozilla.org/en-US/firefox/addon/3cx-clicktocall/">Firefox browsers</a> .  You can also use keyboard shortcuts in <a href="https://www.3cx.ru/user-manual/calls/">the 3CX application for Windows</a> . <a name="habracut"></a><br><br>  To get started, you will need an Office 3CX subscription and Office portal administrator credentials with Global Administrator privileges. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Some Office 365 subscriptions have limited or no integration with 3CX: <br><br><ul><li>  Subscriptions without user management, i.e.  all home subscriptions. <br></li><li>  Subscriptions without Exchange cannot synchronize contacts and calendar (Office 365 Business and Office 365 Pro Plus). <br></li></ul><br>  Office 365 servers must have a direct connection to your 3CX server for real-time status transfer.  If it is not possible to provide a persistent connection, 3CX will still perform daily synchronization. <br><br>  Please note that synchronization is performed only in one direction - from Office 365 to 3CX.  For successful synchronization, Office 365 users must have the ‚ÄúUserType‚Äù attribute set to ‚ÄúMember‚Äù (set in Active Directory).  If a user synchronized from Office 365 is deleted or modified via the 3CX interface, it returns to the previous state during the next manual or automatic synchronization. <br><br><h2>  Microsoft Azure Authentication Application </h2><br><img src="https://habrastorage.org/getpro/habr/post_images/115/f9b/dbb/115f9bdbbf70ef594ccbf9da3a5a7d08.png"><br><br>  The first step in connecting an <a href="https://www.3cx.ru/blog/office-365-pbx-sync/">Office 365 integration</a> is to create an individual application in your account to authorize the integration. <br><br><ol><li>  In the 3CX management interface, go to Settings - Office 365 - Settings tab - Step 3 section and copy the Redirect URL. <br></li><li>  Log into the Office 365 portal with Global Administrator credentials and go to the <a href="https://portal.azure.com/">Microsoft Azure Application Registration</a> page. <br></li><li>  Click New Registration and specify the name of the application, for example, the 3CX PBX Office 365 Sync App. <br></li><li>  In the Supported Account Types section, leave the default option, Accounts only in this directory, organization <br></li><li>  In the Redirection URI section (optional), specify the Web type and insert the redirect URI from the 3CX interface section: Settings&gt; Office 365 Integration&gt; Settings tab&gt; Step 3 section. Platform and permissions, for example, <a href="https://company.3cx.eu/">company.3cx.eu</a> : 5001 / oauth2office2 <br></li><li>  Click Register, and the application will be created. <br></li><li>  The settings page for the created application will open.  Copy the Application Identification (Client) value and paste it with the appropriate field in the 3CX management interface, Options&gt; Office 365 Integration&gt; Settings tab&gt; Step 1. Configure the App ID. <br></li></ol><br><img src="https://habrastorage.org/getpro/habr/post_images/ab0/a8f/267/ab0a8f267c78352ce8004da418e9444d.png"><br><br><h2>  Authentication Keys </h2><br>  Now you need to establish a public key trust relationship between your 3CX v16 system and the application created in the Office 365 portal. <br><br><ol><li>  In the 3CX interface (Settings&gt; Office 365 Integration&gt; Settings tab), click Generate a new key pair and save the key public_key.pem. <br></li><li>  Go to the application settings page in the Certificates and Secrets section.  Click Submit Certificate and upload the generated key. <br></li></ol><br><img src="https://habrastorage.org/getpro/habr/post_images/741/2c7/9e5/7412c79e5b022631f55cadc700d6ce37.png"><br><img src="https://habrastorage.org/getpro/habr/post_images/2d1/436/303/2d14363031e7cf7c2ec328574e4ecf73.png"><br><br><h2>  Application Permissions </h2><br>  The final configuration step is to set the API permissions in the API Permissions section.  These permissions define the rules for your 3CX system to access an Office 365 account. <br><br><ol><li>  Go to the API Permissions section, click Add Permission, and select Microsoft Graph. <br></li><li>  Add API permissions in the Application Permissions section: Calendars&gt; Calendars.Read, Contacts&gt; Contacts.Read, Directory&gt; Directory.Read.All and click Add Permissions. <br></li><li>  In the Grant Consent section, click Grant admin consent for ... to activate permissions. <br></li><li>  Wait about 10 minutes for the changes to take effect correctly. <br></li><li>  Switch to the 3CX interface and in the Office 365 Integration section, click Sign in to Office 365. Confirm the permissions for the created application and the connection between the systems will be established. <br></li></ol><br><img src="https://habrastorage.org/getpro/habr/post_images/b6b/d3e/d61/b6bd3ed610540751a5409b415060d6f9.png"><br><br><h2>  Synchronization capabilities </h2><br>  Synchronization between 3CX and Office 365 is configured in three tabs: <br><br><ul><li>  User Synchronization - Office 365 users synchronize with 3CX users (extensions).  In the 3CX management interface, synced users are located in the Azure AD organizational group. <br></li><li>  Contact synchronization ‚Äî Office 365 personal contacts are synchronized with the 3CX address book.  The user sees these contacts in 3CX applications for all platforms. <br></li><li>  Calendar sync - automatically change the status of the 3CX extension number depending on the busy status in the Office 365 calendar: <br></li></ul><br>  After the event is completed in the Office 365 calendar, 3CX user status is also synchronized and returned to its previous state. <br><br>  All synchronization elements can be configured for all Office 365 users, as well as for selected users. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ea5/841/31f/ea584131fe4ae19c59658fb780c77652.png"><br><br>  This integration is complete. </div><p>Source: <a href="https://habr.com/ru/post/452838/">https://habr.com/ru/post/452838/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../452824/index.html">Tens of thousands of purchases that are transparent as glass: unraveling a tangle</a></li>
<li><a href="../452826/index.html">English grammar. Than vs. Then - how to understand which word to use</a></li>
<li><a href="../452828/index.html">Mission Impossible: How to make the first business event in an unfamiliar country</a></li>
<li><a href="../452830/index.html">Big Bang Sparks</a></li>
<li><a href="../452832/index.html">Full plan of the new lunar NASA program "Artemis" (Artemis)</a></li>
<li><a href="../452840/index.html">VMware EMPOWER 2019 Conference: how was your first day</a></li>
<li><a href="../452842/index.html">SMPP - peer-to-peer short message protocol</a></li>
<li><a href="../452844/index.html">Transformation or profanation: how to "digitize" communication operators</a></li>
<li><a href="../45285/index.html">Creating an event with SMS notification in Google Calendar using XMLHTTP and launching a script from Outlook</a></li>
<li><a href="../452850/index.html">Systems inside cartridges: how engineers have expanded the capabilities of game consoles</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>