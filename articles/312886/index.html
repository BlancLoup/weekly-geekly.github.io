<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Telegram bots: to help the editor</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="- A synonym for the word "capricious"? - the voice of his wife came from the next room. 

 The cracking sound of the keyboard and the cat, taking adva...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Telegram bots: to help the editor</h1><div class="post__text post__text-html js-mediator-article">  - A synonym for the word "capricious"?  - the voice of his wife came from the next room. <br><br>  The cracking sound of the keyboard and the cat, taking advantage of the pause, decisively declared their miserable half-starved existence, apparently hoping that right now the masters would finally tear their ass off the chair and feed the unfortunate. <br><br>  - So look at this ... how is it ... <br>  - Yes, yes, I also forgot.  Well, so tell me a synonym? 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      But alas, I am not a walking encyclopedia, and not even its sedentary version, so I did not find anything better than sending my wife to google dictionary. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/503/350/994/5033509945e6ad3e2f4a9449e06ceca6.jpg"></div><br><a name="habracut"></a><br>  - So it is a long time!  I thought you would remember faster ... <br><br>  The cat, Buridan's donkey, was throwing between me and my wife, in the end I chose to be more good (interesting - by weight or for some other parameters?), And I had no choice but to go to the kitchen to feed the unfortunate bastard.  Along the way, thinking about how to bring to my wife the fact that the ‚Äúbookmarks" in the browser are not intended for the general preservation of all her friends from Vcantaktik, but for memorizing the really necessary links. All previous attempts to teach her to use bookmarks ended in saving, if not friends, the music laid out by friends, but the links that I saved for her turned out to be completely buried under these rubble. <br><br>  But if she learned to use Vaktaktikik and Telegram, it means ... it means she already knows how to use Telegram and Vkantaktikik!  Eureka! <br><br>  Someone said that bots for Telegram is easy?  But now we take and try ... <br><br>  How to register the user part of the new bot, you probably already know.  If not, just add <a href="https://telegram.me/BotFather">@BotFather</a> to the Telegram and start a conversation with it. <br><br><blockquote>  <i>@BotFather is the official bots management interface.</i>  <i>In addition to it, requests for creating bots go around Manybot, YourBot, and a few more.</i>  <i>Judging by the description, these are some kind of gaskets, because</i>  <i>when working with them, you still have to contact @BotFather.</i>  <i>I did not understand them and I will be grateful for clarifying the benefits of them.</i> </blockquote><br>  The first problem encountered when creating a synonym-bot is the search for a dictionary of synonyms. <br><br>  Most nagulennyh dictionaries are full of formidable inscriptions and signatures with a list of terrible cars, which will certainly fall on the head of the unfortunate, who dared to use the ‚Äúimproper‚Äù creation of the authors.  Who, judging by the number of tastefully painted threats, has a ‚Äúcopyright in Russian‚Äù entirely, completely and without any exceptions.  Moreover, the ‚Äúpurpose‚Äù on such resources is sometimes not defined anywhere and in any way, and the volumes of their dictionaries, as a rule, amount to a measly 5,000 ... 40,000 words. <br><br>  Part of the dictionaries are alphabetical lists: the first page with the words with the letter ‚Äúa‚Äù, the second with ‚Äúb‚Äù and so on.  Here is not something that parsing, even loading the hell of a footwoman turns into a stand-alone problem. <br><br><blockquote>  <i>And, of course, no API is even mentioned.</i> </blockquote><br>  In the end, I managed to find an <a href="http://www.trishin.ru/left/dictionary">adequate dictionary</a> with the volume, as stated in the description of ‚Äú591 thousand words and idioms and 2166 thousand synonymous relations‚Äù, which is also freely distributed.  Its only drawback was the complete absence of the API, which was compensated by the ability to legally download the dictionary itself (albeit in a terrible format) and a stable online version. <br><br>  It also seemed to me that in this particular dictionary there are too many obsolete, out-of-turn words and, on the contrary, too few modern ones.  But the wife noted that in five years everyone will forget about the new-fashioned ‚Äúselfies‚Äù, ‚Äúcover‚Äù and ‚Äútransparency‚Äù, but ‚Äúsurely‚Äù, ‚Äúa little bit‚Äù and ‚Äúcapitulate‚Äù will live in the language forever, despite the tricks of linguists from the authorities. <br><br><blockquote>  <i>Once again I am convinced that a good product is usually a terrible package, and behind the beautiful ‚Äúle-endings‚Äù with large buttons and air fields there is an ordinary bullshit.</i> </blockquote><br>  At this point, the already well-fed cat broke away from licking his warm analog identifiers and affirmatively squeaked as if confirming that he was not going to change the classic ‚Äúmeow‚Äù, despite the fact that someone might say that it is ‚Äúuncooked‚Äù or ‚Äúsucks‚Äù . <br><br>  The second problem - most likely the names of the bots that suit you will be occupied.  I tried a whole bunch of sweet short names and they all turned out to be busy and ‚Äî tadaaaam ‚Äî expectedly dead.  As a result, it was necessary to register the name @synonim_bot, long and difficult to remember: for some reason, squatters did not get to it and it turned out to be free. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/ee4/815/ed9/ee4815ed92de4c409b74c7c168dc65a4.png"></div><br>  In short, the whole scheme works like this: <br><br>  <strong>0.</strong> You install a webhost - you tell the Telegram API the script address on your server (HTTPS!), Which it will contact when the user writes something to your bot. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/f1e/c87/2bd/f1ec872bdd734dd9ba1fe41323fe2d23.JPG"></div><br>  And then implement your logic.  The diagram shows a shortened version of the <a href="https://telegram.me/synonim_bot">bot</a> logic. <a href="https://telegram.me/synonim_bot">Synonym</a> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/417/f0e/e39/417f0ee3947d475892f92ce7c169c430.JPG"></div><br><br><blockquote>  <i>I deliberately do not cite a single line of code in order to exclude holivars and mutual cooling.</i>  <i>Write on what you know - bot anyway.</i> </blockquote><br>  Now with the text: <br><br>  <strong>1.</strong> User writes your bot something - a command or a word. <br><br>  <strong>2.</strong> API Telegram pulls your script (it already knows its URL from item 0) and sends it about the following: <br><br><pre><code class="php hljs">{ <span class="hljs-string"><span class="hljs-string">"update_id"</span></span>:<span class="hljs-number"><span class="hljs-number">12345678</span></span>, <span class="hljs-string"><span class="hljs-string">"message"</span></span>: { <span class="hljs-string"><span class="hljs-string">"message_id"</span></span>:<span class="hljs-number"><span class="hljs-number">1234</span></span>, <span class="hljs-string"><span class="hljs-string">"from"</span></span>: { <span class="hljs-string"><span class="hljs-string">"id"</span></span>:<span class="hljs-number"><span class="hljs-number">0123456789</span></span>, <span class="hljs-string"><span class="hljs-string">"first_name"</span></span>:<span class="hljs-string"><span class="hljs-string">"Vasya"</span></span>, <span class="hljs-string"><span class="hljs-string">"username"</span></span>:<span class="hljs-string"><span class="hljs-string">"vapupkin"</span></span> }, <span class="hljs-string"><span class="hljs-string">"chat"</span></span>: { <span class="hljs-string"><span class="hljs-string">"id"</span></span>:<span class="hljs-number"><span class="hljs-number">1234567890</span></span>, <span class="hljs-string"><span class="hljs-string">"first_name"</span></span>:<span class="hljs-string"><span class="hljs-string">"Vasya"</span></span>, <span class="hljs-string"><span class="hljs-string">"username"</span></span>:<span class="hljs-string"><span class="hljs-string">"vapupkin"</span></span>, <span class="hljs-string"><span class="hljs-string">"type"</span></span>:<span class="hljs-string"><span class="hljs-string">"private"</span></span> }, <span class="hljs-string"><span class="hljs-string">"date"</span></span>: <span class="hljs-number"><span class="hljs-number">1451606400</span></span>, <span class="hljs-string"><span class="hljs-string">"text"</span></span>:<span class="hljs-string"><span class="hljs-string">"preved"</span></span> } }</code> </pre> <br>  <strong>3.</strong> Next, your script should figure out what was sent to it and issue an answer: <br><br> <code>https://api.telegram.org/bot123456789:boLshoiogRomnIycOLlaideR/sendMessage?chat_id=1234567890&amp;text=Taki%20Preved</code> <br> <br><blockquote>  <i>Probably it would be more correct to rewrite it in POST in order to have a reserve in size of the text to be sent, but in my case this is also enough: after all, the messengers are not intended for Longrida.</i> </blockquote><br>  <strong>4.</strong> API Telegram will send back something like this: <br><br><pre> <code class="php hljs">{ <span class="hljs-string"><span class="hljs-string">"ok"</span></span>:<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>, <span class="hljs-string"><span class="hljs-string">"result"</span></span>: { <span class="hljs-string"><span class="hljs-string">"message_id‚Äù:1234, "</span></span>from<span class="hljs-string"><span class="hljs-string">": { "</span></span>id‚Äù:<span class="hljs-number"><span class="hljs-number">9876543210</span></span>, <span class="hljs-string"><span class="hljs-string">"first_name"</span></span>:<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"username"</span></span>:<span class="hljs-string"><span class="hljs-string">"my_bot"</span></span> }, <span class="hljs-string"><span class="hljs-string">"chat"</span></span>: { <span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-number"><span class="hljs-number">0123456789</span></span>, <span class="hljs-string"><span class="hljs-string">"first_name"</span></span>:<span class="hljs-string"><span class="hljs-string">"Vasya"</span></span>, <span class="hljs-string"><span class="hljs-string">"username"</span></span>:<span class="hljs-string"><span class="hljs-string">"vapupkin"</span></span>, <span class="hljs-string"><span class="hljs-string">"type"</span></span>:<span class="hljs-string"><span class="hljs-string">"private"</span></span> }, <span class="hljs-string"><span class="hljs-string">"date"</span></span>: <span class="hljs-number"><span class="hljs-number">1451606500</span></span>, <span class="hljs-string"><span class="hljs-string">"text"</span></span>:<span class="hljs-string"><span class="hljs-string">"Taki Preved"</span></span> } }</code> </pre><br>  I understood that with this answer I can do as I please (if not correct, correct it).  Theoretically, it is possible to collect statistics based on it, but I collect it at an earlier stage: it is more convenient for me. <br><br>  A few words about the differences sent by the user commands from, sorry for the pun, words. <br>  You can prepare the standard answers of the bot to the standard questions of the user, making this farm in the form of commands using @BotFather - they will be visible to the user if he starts the line with a slash.  In the bot script, it will be enough to catch these commands (the API Telegram passes them, with a forward slash), to give an answer and immediately stop the further execution of the script. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/533/64d/753/53364d753c114418bf2e6a0aba045639.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/files/9f8/fb4/f74/9f8fb4f74ef84aef823d006bd46425eb.png"></div><br>  The procedure of communicating a bot with a dictionary is not of artistic value and I will leave it out with your permission.  The only thing that needed to be done was to catch the absence of the result, when the dictionary did not find a synonym for the entered word. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/1bd/2af/1ca/1bd2af1ca3fb4d3c9cb7b73f2f7bc5f1.png"></div><br>  ... as well as the case when the user entered a whole phrase - after all, the dictionary does not know how to do this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/f85/f69/f56/f85f69f56a7e4f4b9bf43f336c774937.png"></div><br>  The third problem was waiting for me when real people started using the bot: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/8c0/5fe/bbe/8c05febbe56d4c24b04de07832cedf38.JPG"></div><br>  Yeah ... Modern technologies sometimes allow us to work wonders, but they completely deprive us of knowledge about fundamental things.  Almost half of the requested words contained errors and typos and something had to be done about it. <br><br>  With timid hope, I immediately rushed to my beloved Dadata, but I broke off: she perfectly performs her tasks and does not aim at the entire language corpus.  Googling, oddly enough, did not bring any adequate results, and I quickly screwed Yandex.Speler as a temporary option.  Theoretically, until he became paid and demanded a notarized copy of his passport, he could also be used somehow. <br><br><blockquote>  <i>I would be grateful for the hint: a free spell checker service in Russian with an API is required.</i> </blockquote><br>  A fourth problem was discovered here: if the word is typed without errors, Yandex.Speler does not give out anything.  It is just silent as a partisan, which makes statistics a little harder. <br><br>  It would be nice to somehow mark the correction of user input, without shouting about it in all Ivanovo.  Because of the poor bot's html toolkit, I chose this alert option (perhaps in the future I will correct it): <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/f56/7cb/d57/f567cbd57896456c9f1418e87768abc2.png"></div><br>  I put my wife to test, asked to distribute to colleagues on the network.  If the bot is necessary for someone, I will develop it. <br><br>  <strong>PS:</strong> When writing a bot, the Unix cat (real character) did not starve.  Neither before nor after. <br><br><div class="spoiler">  <b class="spoiler_title">Proof</b> <div class="spoiler_text"><div style="text-align:center;"><img src="https://habrastorage.org/files/549/c4d/f91/549c4df91c154563b2d48cd177ab202e.jpg"></div><br></div></div><br><hr><br>  References: <br>  Bot Synonym: <a href="https://telegram.me/synonim_bot">telegram.me/synonim_bot</a> <br>  Trishin Synonyms Dictionary: <a href="http://www.trishin.ru/left/dictionary">www.trishin.ru/left/dictionary</a> <br>  API Telegram: <a href="https://tlgrm.ru/docs/bots/api">tlgrm.ru/docs/bots/api#authorizing-your-bot</a> </div><p>Source: <a href="https://habr.com/ru/post/312886/">https://habr.com/ru/post/312886/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../312876/index.html">Hybrid Android apps for kids</a></li>
<li><a href="../312878/index.html">ASP.NET Core: Creating your first web API using ASP.NET Core MVC and Visual Studio</a></li>
<li><a href="../312880/index.html">Math in javascript</a></li>
<li><a href="../312882/index.html">Anatomy of KD-Trees</a></li>
<li><a href="../312884/index.html">A brief history of the gaming industry by platform</a></li>
<li><a href="../312888/index.html">IoT market. There are many grades, no consensus</a></li>
<li><a href="../312890/index.html">Kerosene vs. Patriots: How American military programmers learned how to round correctly</a></li>
<li><a href="../312892/index.html">We introduce a full-fledged system of feedback about each other on "Freelance"</a></li>
<li><a href="../312894/index.html">How in Java to shoot yourself in the leg of lambda and not to miss</a></li>
<li><a href="../312896/index.html">Welcome to Moscow CocoaHeads Meetup October 28</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>