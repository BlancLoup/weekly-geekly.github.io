<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We do tetris under FPGA</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! 

 On this long New Year‚Äôs holiday, I wondered how easy it was to write some kind of simple toy on an FPGA with display and control from the ke...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We do tetris under FPGA</h1><div class="post__text post__text-html js-mediator-article">  Hello! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3e4/f51/5fb/3e4f515fbade2e6bd944d1377b3da560.jpg" alt="image" width="216" height="250" align="left">  On this long New Year‚Äôs holiday, I wondered how easy it was to write some kind of simple toy on an FPGA with display and control from the keyboard.  This is how one more tetris implementation on <a href="https://ru.wikipedia.org/wiki/%25D0%259F%25D1%2580%25D0%25BE%25D0%25B3%25D1%2580%25D0%25B0%25D0%25BC%25D0%25BC%25D0%25B8%25D1%2580%25D1%2583%25D0%25B5%25D0%25BC%25D0%25B0%25D1%258F_%25D0%25BF%25D0%25BE%25D0%25BB%25D1%258C%25D0%25B7%25D0%25BE%25D0%25B2%25D0%25B0%25D1%2582%25D0%25B5%25D0%25BB%25D0%25B5%25D0%25BC_%25D0%25B2%25D0%25B5%25D0%25BD%25D1%2582%25D0%25B8%25D0%25BB%25D1%258C%25D0%25BD%25D0%25B0%25D1%258F_%25D0%25BC%25D0%25B0%25D1%2582%25D1%2580%25D0%25B8%25D1%2586%25D0%25B0">FPGA</a> was born: <b>yafpgatetris</b> . <br><br><br>  Of course, FPGA games are made more for fun and learning, than for some real ‚Äúproduction‚Äù tasks, and I‚Äôm very <a href="http://habrahabr.ru/post/234369/">far</a> from the ‚Äúdevelopment‚Äù of games, you can say this is a new experience for me. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <br>  If you are interested in how you can run a game without an operating system, implementing it at the lowest level, using triggers and combinational logic, welcome to Cat. <br><br><a name="habracut"></a><br><h3>  About girls </h3><br>  We need "something" where our game will start.  One of the easiest ways is to take a devkit with FPGAs and some I / O peripherals.  At my disposal was a handkerchief from Terasic called <a href="http://de1-soc.terasic.com/"><b>DE1-SoC</b></a> . <br><br><img src="https://habrastorage.org/files/8a1/c1d/b17/8a1c1db1747c447597ac310fcb0bea72.jpg"><br><br><img src="https://habrastorage.org/files/a42/3d3/706/a423d37066024ff8b14642f1a68f2478.jpg"><br><br>  What can I say? <br>  Devkit, as devkit.  A lot of peripherals: we will be interested in <b>PS / 2</b> and <b>VGA</b> plugs from it.  For training (in schools or universities) is the thing.  For our purposes, we bought it just to play (and to train students) than to implement some of our "production" of ideas. <br>  If suddenly you use DE1-SoC (or similar boards) in your real devices (and not just blink an LED) - share in the comments, it will be interesting. <br><br>  <b>SoC</b> in the name of the chip means that the chip has both normal FPGA-logic and ARM-processor.  Looking ahead, I‚Äôll say that for my task I didn‚Äôt use either ARM or some kind of software processor, so you can run my project on your boards with other FPGA chips.  If it is interesting to read about raising a bunch of FPGA + ARM, and what bonuses can be obtained from this, I advise you to refer to the <a href="http://habrahabr.ru/post/235707/">article of</a> my colleague <a href="https://habrahabr.ru/users/des333/" class="user_link">Des333</a> . <br><br><h3>  What we want to get </h3><br>  You can put various things into the concept of tetris, so I sketched an approximate TK, which I wanted to get: <br><ul><li>  Standard set of figures.  Their behavior should be as similar to the usual. </li><li>  The game is colorful.  Each figure has its own color. </li><li>  The figures are generated randomly with a uniform distribution. </li><li>  There should be a window in which the next figure is displayed. </li><li>  There should be information about the state of the game: the number of points, the number of lines removed, the current level. </li><li>  Points are awarded on a ‚Äúprogressive‚Äù scale: the more lines you remove at once, the more points. </li><li>  The higher the level, the greater the speed of the falling figures. </li><li>  The ‚Äúend of the game‚Äù is detected correctly, there is an opportunity to start a new game. </li><li>  User input is entered from the keyboard (PS / 2). </li><li>  Displaying the status of the field and other things happens on a normal display via the VGA interface. </li></ul><br><br><h3>  Project outline </h3><br><img src="https://habrastorage.org/files/142/59f/08f/14259f08ff0f444da10f8b6490ca56e2.png"><br><br>  There are three main parts: <br><ul><li>  User input.  We accept data from the keyboard and ‚Äúwork‚Äù on the system. </li><li>  All that relates to the game itself.  In fact, FSM (finite-state machine), which accepts ‚Äúrequests‚Äù from the player, and ‚Äúdoes everything‚Äù: generates new figures, moves them, removes lines, and so on. </li><li>  Displays the status of the game.  Draw to the display via the VGA interface. </li></ul><br><br><h3>  PS / 2 </h3><br>  To be honest, at first I thought about doing without the keyboard and using the keys on the whale itself, but surprisingly there were no problems with the keyboard: everything worked out of the box. <br><br>  To receive commands from the keyboard you need a PS / 2 controller.  I used this <a href="http://www.eecg.toronto.edu/~jayar/ece241_08F/AudioVideoCores/ps2/ps2.html">one</a> . <br><br>  If we turn a little to theory, then for each key a set of <a href="http://www.computer-engineering.org/ps2keyboard/scancodes2.html">codes is</a> determined, which the keyboard sends when it is pressed or released. <br><br>  Take the ‚ÄúEnter‚Äù key: <br><ul><li>  Make: 5A </li><li>  Break: F0, 5A. </li></ul><br>  Let's see how it looks inside the FPGA: <br><br>  Normal keystroke: <br> <a href="http://http:"><img src="https://habrastorage.org/files/ba2/e5b/f39/ba2e5bf39a50403999876e82bc12b6ec.png"></a> <br>  As you can see, really: <br><ul><li>  Press the key, comes 5A. </li><li>  Release: F0 comes, after it 5A. </li><li>  Press again: comes 5A and so on. </li></ul><br><br>  If we hold the key, we get this: <br> <a href="http://http:"><img src="https://habrastorage.org/files/972/53f/72f/97253f72f189451cb0816131f1d5f104.png"></a> <br>  Just comes team 5A with some frequency. <br><br>  We need a small set of keys: <br><ul><li>  ordinary arrows - to control the figure. </li><li>  <b>n</b> - to start a new game. </li></ul><br>  To determine the type of event, you can get by with a shift register and a small primitive logic, and just skip all the other keys.  As part of this game, I decided that it was enough for me to detect keystroke events, and letting go to ignore.  When you hold the key, commands will come all the same that the key is pressed, and therefore the player still wants the figure to move or turn over.  I admit, I was afraid that the figures would move too unusual, but everything worked out. <br><br>  After detecting the ‚Äúevent‚Äù we are interested in, we put it into the FIFO, from where the ‚Äúapplied logic‚Äù of the game will take it.  If you did not have PS / 2 on your board, but there are some keys, toggle switches, then it will be enough to write the logic that pressing these buttons translates into ‚Äúevents‚Äù and the game will not notice anything. <br><br>  This controller allows you to connect a mouse, but I have not tried. <br><br><h3>  The main logic of the game </h3><br><br>  On the one hand, the logic is trivial, and is described by the following FSM: <br><img src="https://habrastorage.org/files/ee4/f28/1b4/ee4f281b48ed4b9cafffcc25437876cc.png"><br><br>  (To be honest, I don‚Äôt know if someone uses the ‚ÄúState Machine Viewer‚Äù production, if so, share in the comments for what. For all the development time for FPGA, I opened it a couple of times, and then as part of the training). <br><br>  FSM "communicates" with the following blocks / modules: <br><ul><li>  <b>gen_sys_event</b> is a timer that counts the time after which it is necessary to automatically move the figure down. </li><li>  <b>gen_next_block</b> is a new figure generator. </li><li>  <b>check_move</b> - check if the current ‚Äúmove‚Äù can be performed. </li><li>  <b>tetris_stat</b> - the accumulation of "statistics". </li><li>  <b>user_input</b> - reads the event that the user "made". </li></ul><br>  Everything is very similar to the "usual" Tetris implementation, which is written in C ++ / Java / etc: various modules perform the role of functions in those languages.  Yes, and problems arise the same: the longest was sitting over the figure's coup, the answer was peeped in the <a href="https://wiki.gnome.org/Apps/Quadrapassel">quadrapassel</a> code.  One option is that you can store a table of all possible turns (for each figure there are four options). <br><br>  All code is written in Verilog, or to be more precise - on SystemVerilog.  On the one hand, SystemVerilog is much more flexible than Verilog, but on the other hand, this leads to the fact that you are not limited, and you want to implement more and more different ryushechek :). <br><br>  I simplified my life: the current state of the field is stored on registers (instead of internal memory), and because of this (as well as the fact that some things are not optimal) a lot of logic is formed, and the project takes a lot of resources (about 3.2k ALM from 32k ).  If you move to memory, you will have to do some things sequentially (for example, moving down the entire field when you need to remove a line that has been filled).  Most likely I will not redo the memory usage. <br><br>  For test purposes, I collected a project for DE0 / DE1 boards (brothers of the board I have, but with budget chips: they have less resources and they are more ‚Äúyounger generation‚Äù): the project on resources fits.  But‚Ä¶ <br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text">  ... right out of the box does not work: <br><ul><li>  Quartus will swear at some things in the qsf file, because  I collected for the 14th quarter, where there is no Cyclone II / III.  Early versions of the quartus of these things do not know: you have to remove these lines in the qsf file with pens, and then, in the sense, put the same daws in the GUI of the quartus. </li><li>  It does not fit in the frequency: the ‚Äúmain‚Äù frequency in this project is 108 MHz (the main_game_logic itself works on it and the drawing is on VGA).  Slightly running ahead, the frequency is 108 MHz - because the resolution is 1280x1024, if you use 640x480, then there will be a frequency of 25 MHz, and it will fit. </li><li>  You may have to regenerate mega functions for PLL and FIFO, because  They were created for Cyclone V. </li><li>  The display may need to be slightly edited (choose other colors), because  there, for each color, only four bits are allocated (as I understand it), against eight, as in this board. </li></ul><br></div></div><br><br><h3>  Display </h3><br>  You can find a lot of information on how to display an image via VGA using FPGAs, for example, in <a href="http://habrahabr.ru/post/157863/">Habr√©</a> , so I‚Äôll not dwell on this in detail. <br><br>  In this whale, the output on VGA is made as follows: <br><img src="https://habrastorage.org/files/23d/3ab/79b/23d3ab79b4aa4fdab8568aab5cc24d84.png"><br><br>  Each <b>VGA_CLK</b> clock cycle <b>must</b> be set to a new color value in the RGB model, and then the DAC converts these values ‚Äã‚Äãto the desired signal level. <br><br>  As a controller for VGA signals, I took a module from the demos for example on the <a href="http://www.terasic.com/downloads/cd-rom/de1-soc/">CD</a> for this whale.  It's funny that there is a CD concept, but there is no CD bundled with the board: you need to download the archive from the Internet. <br><br>  This "controller" Terasic uses in other whales: it is easily googled by the name "vga_time_generator".  It is convenient in that you can configure it to any mode of operation (640x480, 800x600, etc), and that gives the coordinates ( <b>pixel_x</b> , <b>pixel_y</b> ) of the current pixel for display.  Our task is to substitute the desired color values ‚Äã‚Äãdepending on these coordinates. <br><br> <a href="http://http:"><img src="https://habrastorage.org/files/8fb/44c/296/8fb44c2962824edd86202bdf2a2d4966.png"></a> <br><br>  I decided that 640x480 on the big monitor doesn‚Äôt look very good and moved to 1280x1024, simply by transferring the required values ‚Äã‚Äãfrom the <a href="http://tinyvga.com/vga-timing">standard</a> to the module.  Additionally, we had to change the value of <b>VGA_CLK</b> : instead of 25.175 MHz, it was 108 MHz.  True, I later regretted it a little, but beauty requires sacrifice. <br><br>  Consider how to display some primitive objects. <br><br>  For example: <br><pre><code class="vhdl hljs">`define RGB_BLACK <span class="hljs-number"><span class="hljs-number">24</span></span><span class="hljs-symbol"><span class="hljs-symbol">'h00_00_00</span></span> `define RGB_ORANGE <span class="hljs-number"><span class="hljs-number">24</span></span><span class="hljs-symbol"><span class="hljs-symbol">'hFF_A5_00</span></span> logic [<span class="hljs-number"><span class="hljs-number">23</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>] vga_data; localparam START_X = <span class="hljs-number"><span class="hljs-number">100</span></span>; localparam START_Y = <span class="hljs-number"><span class="hljs-number">100</span></span>; localparam END_X = START_X + <span class="hljs-number"><span class="hljs-number">200</span></span> - <span class="hljs-number"><span class="hljs-number">1</span></span>; localparam END_Y = START_Y + <span class="hljs-number"><span class="hljs-number">300</span></span> - <span class="hljs-number"><span class="hljs-number">1</span></span>; always_comb <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> vga_data = `RGB_BLACK; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( ( pixel_x &gt;= START_X ) &amp;&amp; ( pixel_x &lt;= END_X ) &amp;&amp; ( pixel_y &gt;= START_Y ) &amp;&amp; ( pixel_y &lt;= END_Y ) ) vga_data = `RGB_ORANGE; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> assign { r, g, b } = vga_data;</code> </pre> <br><br>  An orange square of 200x300 pixels is displayed, with the upper left corner located at (100, 100). <br><br>  Or: <br><pre> <code class="vhdl hljs">`define RGB_BLACK <span class="hljs-number"><span class="hljs-number">24</span></span><span class="hljs-symbol"><span class="hljs-symbol">'h00_00_00</span></span> `define RGB_ORANGE <span class="hljs-number"><span class="hljs-number">24</span></span><span class="hljs-symbol"><span class="hljs-symbol">'hFF_A5_00</span></span> logic [<span class="hljs-number"><span class="hljs-number">23</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>] vga_data; localparam MSG_X = <span class="hljs-number"><span class="hljs-number">56</span></span>; localparam MSG_Y = <span class="hljs-number"><span class="hljs-number">5</span></span>; logic [<span class="hljs-number"><span class="hljs-number">0</span></span>:MSG_Y-<span class="hljs-number"><span class="hljs-number">1</span></span>][<span class="hljs-number"><span class="hljs-number">0</span></span>:MSG_X-<span class="hljs-number"><span class="hljs-number">1</span></span>] msg; assign msg[<span class="hljs-number"><span class="hljs-number">0</span></span>] = <span class="hljs-number"><span class="hljs-number">56</span></span><span class="hljs-symbol"><span class="hljs-symbol">'b10010011110010000010000001100000001001000110001110001110</span></span>; assign msg[<span class="hljs-number"><span class="hljs-number">1</span></span>] = <span class="hljs-number"><span class="hljs-number">56</span></span><span class="hljs-symbol"><span class="hljs-symbol">'b10010010000010000010000010010000001001001001001001001001</span></span>; assign msg[<span class="hljs-number"><span class="hljs-number">2</span></span>] = <span class="hljs-number"><span class="hljs-number">56</span></span><span class="hljs-symbol"><span class="hljs-symbol">'b11110011110010000010000010010000001111001111001111001111</span></span>; assign msg[<span class="hljs-number"><span class="hljs-number">3</span></span>] = <span class="hljs-number"><span class="hljs-number">56</span></span><span class="hljs-symbol"><span class="hljs-symbol">'b10010010000010000010000010010000001001001001001001001110</span></span>; assign msg[<span class="hljs-number"><span class="hljs-number">4</span></span>] = <span class="hljs-number"><span class="hljs-number">56</span></span><span class="hljs-symbol"><span class="hljs-symbol">'b10010011110011110011110001100000001001001001001110001001</span></span>; logic [$clog2(MSG_X)-<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>] msg_pix_x; logic [$clog2(MSG_Y)-<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">0</span></span>] msg_pix_y; localparam START_MSG_X = <span class="hljs-number"><span class="hljs-number">100</span></span>; localparam START_MSG_Y = <span class="hljs-number"><span class="hljs-number">100</span></span>; localparam END_MSG_X = START_MSG_X + MSG_X - <span class="hljs-number"><span class="hljs-number">1</span></span>; localparam END_MSG_Y = START_MSG_Y + MSG_Y - <span class="hljs-number"><span class="hljs-number">1</span></span>; assign msg_pix_x = pixel_x - START_MSG_X; assign msg_pix_y = pixel_y - START_MSG_Y; always_comb <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> vga_data = `RGB_BLACK; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( ( pixel_x &gt;= START_MSG_X ) &amp;&amp; ( pixel_x &lt;= END_MSG_X ) &amp;&amp; ( pixel_y &gt;= START_MSG_Y ) &amp;&amp; ( pixel_y &lt;= END_MSG_Y ) ) <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( msg[ msg_pix_y ][ msg_pix_x ] ) <span class="hljs-keyword"><span class="hljs-keyword">begin</span></span> vga_data = `RGB_ORANGE; <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> assign { r, g, b } = vga_data;</code> </pre><br><br>  It will be displayed <b>HELLO HABR</b> font with a height of 5 pixels in orange on a black background.  (Look at the units in the <b>msg</b> array). <br><br>  I think it‚Äôs clear how you can draw some static messages or a game field. <br><br><h4>  Display lines </h4><br>  To display statistics (lines of "Score", "Lines", "Level" and their values), I decided to go along the "classical" path.  You can see it, for example, <a href="http://ece320web.groups.et.byu.net/labs/VGATextGeneration/VGA_Terminal.html">here</a> . <br><br>  Suppose some kind of logic has already determined which character (read, letter or number) we want to output right now (depending on <b>pixel_x</b> , <b>pixel_y</b> ).  To display it, we use a ready-made font table, where units will indicate which pixel you need to paint with the font color, and with zero ‚Äî the background color, such as: <br><pre> <code class="hljs swift"> <span class="hljs-string"><span class="hljs-string">"00000000"</span></span>, -- <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-string"><span class="hljs-string">"00000000"</span></span>, -- <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-string"><span class="hljs-string">"00010000"</span></span>, -- <span class="hljs-number"><span class="hljs-number">2</span></span> * <span class="hljs-string"><span class="hljs-string">"00111000"</span></span>, -- <span class="hljs-number"><span class="hljs-number">3</span></span> *** <span class="hljs-string"><span class="hljs-string">"01101100"</span></span>, -- <span class="hljs-number"><span class="hljs-number">4</span></span> ** ** <span class="hljs-string"><span class="hljs-string">"11000110"</span></span>, -- <span class="hljs-number"><span class="hljs-number">5</span></span> ** ** <span class="hljs-string"><span class="hljs-string">"11000110"</span></span>, -- <span class="hljs-number"><span class="hljs-number">6</span></span> ** ** <span class="hljs-string"><span class="hljs-string">"11111110"</span></span>, -- <span class="hljs-number"><span class="hljs-number">7</span></span> ******* <span class="hljs-string"><span class="hljs-string">"11000110"</span></span>, -- <span class="hljs-number"><span class="hljs-number">8</span></span> ** ** <span class="hljs-string"><span class="hljs-string">"11000110"</span></span>, -- <span class="hljs-number"><span class="hljs-number">9</span></span> ** ** <span class="hljs-string"><span class="hljs-string">"11000110"</span></span>, -- a ** ** <span class="hljs-string"><span class="hljs-string">"11000110"</span></span>, -- b ** ** <span class="hljs-string"><span class="hljs-string">"00000000"</span></span>, -- <span class="hljs-built_in"><span class="hljs-built_in">c</span></span> <span class="hljs-string"><span class="hljs-string">"00000000"</span></span>, -- d <span class="hljs-string"><span class="hljs-string">"00000000"</span></span>, -- e <span class="hljs-string"><span class="hljs-string">"00000000"</span></span>, -- f</code> </pre><br><br>  Many projects (which can be found on the network) with VGA use such a table ( <b>Font ROM</b> ), but they are designed for a 640x480 display: for 1280x1024 it turns out a bit small, so you need to prepare a similar table, but with a ‚Äúbig‚Äù font. <br><br>  The <a href="http://nafe.sourceforge.net/">nafe</a> utility helped me in this.  At the input it receives a psf file, at the output - a text file with X, in those pixels that need to be drawn.  Using your favorite language (or just rewrite the output of the original program), change X to ‚Äú1‚Äù and spaces to ‚Äú0‚Äù, and add a header to make the mif file (which is then used to initialize the ROM). <br><br>  The largest font I found in my psf format was 32x16, and, in principle, it was enough for this task, but I would like to do a little more.  As far as I understand, there are no restrictions, and with the help of this utility you can prepare a ROM with any symbols (for example, Russian letters). <br><br>  However, for the <b>yafpgatetris</b> header and the <b>GAMEOVER</b> message <b>,</b> this size seemed to me small, and I decided to display these messages in the same way as the <b>HELLO HABR</b> line in the example above.  The only question is how to prepare <b>msg</b> , because  I really didn't want to do this with pens. <br><br>  Immediately came up with a relatively simple bicycle (?) Solution: <br><ul><li>  Type the text of the desired font and size in Paint / GIMP. </li><li>  We save in PNG without compression and smoothing. </li><li>  We use some kind of ready-made library to read the PNG file and output 0 for each pixel if ‚Äúcolor is white‚Äù, 1 if ‚Äúcolor is black‚Äù. </li></ul><br>  The resulting set of zeros and ones can also be put in ROM (in other than the font, of course). <br><br><h4>  A few pictures </h4><br>  A couple of photos from the ‚Äúdevelopment in process‚Äù series: <br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text">  We learned how to display the field: the figures just fall down and all are the same color. <br><img src="//habrastorage.org/files/ede/6b1/760/ede6b1760549453395f0c36031822703.jpg"><br><br>  Added statistics and different colors.  Eyes vyvaglaznye :) <br><img src="//habrastorage.org/files/37f/d1d/94b/37fd1d94bd844adeba91d71030294028.jpg"><br><br>  Well, the final version is at the beginning of the article :) <br><br>  PS <br>  To be honest, I don‚Äôt know why when photographing such ‚Äúdivorces‚Äù on the display, maybe I didn‚Äôt turn on any settings in the VGA-peel, or just not lucky ... <br></div></div><br><br><h4>  Results </h4><br>  <b>Sources:</b> <br>  <a href="https://github.com/johan92/yafpgatetris">https://github.com/johan92/yafpgatetris</a> <br><br>  <b>Video:</b> <br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/I6k_7Kwuilw%3Ffeature%3Doembed&amp;xid=25657,15700023,15700186,15700191,15700253&amp;usg=ALkJrhg-C3deS6lV3S3fuSMorFISf13Y6A" frameborder="0" allowfullscreen=""></iframe><br><br>  I tried to make the project as parameterizable as possible, and logically divided into parts, so if you want to make ‚Äúraces‚Äù on the basis of my project, where you have to dodge other machines, or a snake, you just need to write your <b>main_game_logic</b> and slightly correct the conclusion (if necessary) . <br><br>  It took about 5 days to develop, if we consider the ‚Äúpure time‚Äù: I had to tinker with the figure's coup (in fact, rewrite the algorithm twice), it took a lot of time to select colors, sizes, alignment and positioning of messages.  The internal perfectionist all the time demanded that the internal designer move something, increase / decrease something, etc. For myself, I learned that GUI development is not mine) As a result, I took the colors for the figures from <a href="https://vk.com/app1">Tetris</a> application on Vkontakte. <br><br>  If you bought a whale and want to learn how to develop under FPGA, I do not recommend doing Tetris directly as a first project.  Start with LEDs, segment indicators, clocks, and other classic things.  When this passes, you can try Tetris, or some other simple game.  I hope my project will help in this endeavor. <br><br>  Thanks for attention!  If you have questions, ask without a doubt. </div><p>Source: <a href="https://habr.com/ru/post/247535/">https://habr.com/ru/post/247535/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../247515/index.html">Reports for NORD POS. Part 1</a></li>
<li><a href="../247519/index.html">Creating a plugin for PHP Composer</a></li>
<li><a href="../247521/index.html">Release Rust 1.0 Alpha</a></li>
<li><a href="../247527/index.html">Padding Oracle Attack or why cryptography scares</a></li>
<li><a href="../247533/index.html">Programming tutorial for kids</a></li>
<li><a href="../247539/index.html">ROS Speech Recognition with Google Speech API</a></li>
<li><a href="../247541/index.html">Parse security in iOS application</a></li>
<li><a href="../247543/index.html">Impress Application Server in simple terms</a></li>
<li><a href="../247545/index.html">Introduction to the development of web-applications on PSGI / Plack</a></li>
<li><a href="../247547/index.html">Creating an environment for web development based on Docker</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>