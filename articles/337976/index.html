<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>RTP Bleed: Dangerous vulnerability to intercept VoIP traffic</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the popular IP telephony solution Asterisk, a vulnerability has been discovered that allows you to inject RTP packets into a conversation or listen...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>RTP Bleed: Dangerous vulnerability to intercept VoIP traffic</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/web/e33/104/34b/e3310434b92c4114bd6b511039d248cf.png"></div><br>  In the popular IP telephony solution Asterisk, a vulnerability has been discovered that allows you to inject RTP packets into a conversation or listen for RTP traffic. <br><a name="habracut"></a><br><h2>  How it works </h2><br>  To exploit the vulnerability, an attacker needs to send an RTP packet to the server port to which the RTP stream is currently attached.  If the server is vulnerable, it will respond with RTP Stream packets destined for the subscriber who actually uses this port to talk.  This vulnerability does not require an attacker to be between the server and the subscriber.  Although it resembles <a href="http://heartbleed.com/">heartbleed</a> in name, in fact, the vulnerability rather allows for a MITM attack. <br><br>  This becomes possible due to the operation of some RTP proxies.  In the process of solving ‚Äúproblems‚Äù associated with the delivery of RTP packets using NAT, the proxy does not require any authentication to enter into its internal table information about the final IP address and port to which RTP responses should be sent so that they are delivered to the subscriber.  The RTP proxy ‚Äúremembers‚Äù the IP / Port pairs based on which IP / port the proxy receives RTP packets from the subscriber. <br><br>  Thus, in order to receive packets from a third-party subscriber, you only need to know the RTP port that is used by the subscriber and start sending RTP packets to it, thereby misleading the RTP proxy. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Vulnerabilities are affected by Asterisk versions from 11.4.0 to 14.6.1. <br><br>  You can learn more about the problem on the official website of the vulnerability <a href="https://rtpbleed.com/">rtpbleed.com</a> <br><br><h2>  Instruments </h2><br>  To check if your systems are vulnerable to RTP Bleed, you can use the free <a href="https://github.com/kapejod/rtpnatscan">rtpnatscan</a> tool. <br><br>  To install, you need to clone the repository and compile the utilities. <br><br><pre><code class="bash hljs">git <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> https://github.com/kapejod/rtpnatscan.git <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> rtpnatscan make rtpnatscan make rtcpnatscan</code> </pre> <br>  Next, you need to make a call, check which ports are used for RTP, for example through Asterisk CLI <br><br><pre> <code class="bash hljs">asterisk -r rtp <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> debug on</code> </pre> <br>  Then, on a third-party machine, run the rtpnatscan scan and try to get the RTP packets <br><br><pre> <code class="bash hljs">./rtpnatscan  _ _ _</code> </pre> <br>  To do this, you do not need to use any MITM techniques, like ARP spoofing.  You just need to be able to send RTP packets to the vulnerable server and port. <br><br>  If the remote server sent RTP packets in response, then your configuration is vulnerable. <br><br>  rtpnatscan is only a scanner and does not allow to listen to the conversation. <br><br>  In addition to the rtpnatscan utility, there is a paid tool with more features. <br><br><h2>  How to protect </h2><br>  First you need to check whether your systems are vulnerable to RTP Bleed with the tool described above. <br><br>  There is an official patch for Asterisk, but it does not completely close the vulnerability, so there is an additional <a href="https://github.com/kapejod/rtpnatscan/tree/master/patches/asterisk">patch</a> , which is also recommended to be applied. <br><br>  If it is not possible to install a patch, do not set the nat = yes parameter in the Asterisk configuration, if this is acceptable in your case. <br><br>  It is also recommended to use encryption of voice traffic so that even when intercepting RTP packets, the attacker does not get access to confidential information. </div><p>Source: <a href="https://habr.com/ru/post/337976/">https://habr.com/ru/post/337976/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../337964/index.html">Docker, or There and back</a></li>
<li><a href="../337968/index.html">What do large successful open source projects have in common?</a></li>
<li><a href="../337970/index.html">People's Privacy Policy</a></li>
<li><a href="../337972/index.html">On the factor of the case when playing "Monopoly"</a></li>
<li><a href="../337974/index.html">Overview of one Russian RTOS, part 5. First application</a></li>
<li><a href="../337978/index.html">Telegram bot for Mikrotik with Webhook and JSON parser</a></li>
<li><a href="../337982/index.html">Methods for developing motion software flow sensors that work with Arduino</a></li>
<li><a href="../337984/index.html">About smart contracts in simple words</a></li>
<li><a href="../337986/index.html">Prototyping in the Python-Arduino environment</a></li>
<li><a href="../337990/index.html">Android web applications without Cordova, Phonegap and SMS</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>