<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Compiling ASP.NET pages: code generation</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Now it's time to figure out what happens to the code from the time of writing the ASPX / ASCX markup and the CS code to the moment of their physical e...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Compiling ASP.NET pages: code generation</h1><div class="post__text post__text-html js-mediator-article">  Now it's time to figure out what happens to the code from the time of writing the ASPX / ASCX markup and the CS code to the moment of their physical execution in the form of some compiled code on the server. <a name="habracut"></a><br><br><h2>  Generate full source code </h2><br>  Let's start with a simple, and, in principle, well-known features of ASP.NET 2.0: partial compilation of pages.  As we know, partial (partial) classes are syntactic sugar for splitting class source code into several different files.  This is especially useful when one part of the class code is automatically generated by some utility, and the other is written manually by the programmer.  Since modifying the autogenerated code is a very bad practice (after all, the subsequent regeneration will destroy all such changes), in such cases the utility generates classes as partial, and the programmer can easily add the necessary functionality ‚Äúside by side‚Äù in the adjacent file that is not affected by regeneration. <br>  This is exactly what ASP.NET does when faced with a pair of ASPX (or ASCX, ASHX, ASAX) + CS.  Let there be a couple of descriptions - an ASPX page with server code and a control and its separated code file: <br><br><h3>  SomePage.aspx: </h3><blockquote><ol><li>  <font color="#009900">&lt;% @ Page <font color="#000066">Language</font> <font color="#66cc66">=</font> <font color="#ff0000">"C #"</font> AutoEventWireup <font color="#66cc66">=</font> <font color="#ff0000">"true"</font> CodeFile <font color="#66cc66">=</font> <font color="#ff0000">"SomePage.aspx.cs"</font> Inherits <font color="#66cc66">=</font> <font color="#ff0000">"SomePage"</font> %&gt;</font> </li><li>  <font color="#009900">&lt; <font color="#000000">html</font> &gt;</font> </li><li>  <font color="#009900">&lt; <font color="#000000">head</font> &gt;</font> </li><li>  <font color="#009900">&lt; <font color="#000000">title</font> &gt;</font> SomePage <font color="#009900">&lt; <font color="#66cc66">/</font> <font color="#000000">title</font> &gt;</font> </li><li>  <font color="#009900">&lt; <font color="#66cc66">/</font> <font color="#000000">head</font> &gt;</font> </li><li>  <font color="#009900">&lt; <font color="#000000">body</font> &gt;</font> </li><li>  <font color="#009900">&lt;asp: <font color="#000066">Label</font> <font color="#000066">ID</font> <font color="#66cc66">=</font> <font color="#ff0000">"lblHello"</font> runat <font color="#66cc66">=</font> <font color="#ff0000">"server"</font> EnableViewState <font color="#66cc66">=</font> <font color="#ff0000">"false"</font> <font color="#66cc66">/</font> &gt;</font> </li><li></li><li>  <font color="#009900">&lt; <font color="#000000">script</font> runat <font color="#66cc66">=</font> <font color="#ff0000">"server"</font> <font color="#000066">type</font> <font color="#66cc66">=</font> <font color="#ff0000">"text / C #"</font> &gt;</font> </li><li></li><li>  protected void Page_Load (object sender, EventArgs e) </li><li>  { </li><li>  lblHello.ForeColor = System.Drawing.Color.Red; </li><li>  } </li><li></li><li>  <font color="#009900">&lt; <font color="#66cc66">/</font> <font color="#000000">script</font> &gt;</font> </li><li>  <font color="#009900">&lt; <font color="#66cc66">/</font> <font color="#000000">body</font> &gt;</font> </li><li>  <font color="#009900">&lt; <font color="#66cc66">/</font> <font color="#000000">html</font> &gt;</font> </li><li></li></ol></blockquote>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  SomePage.aspx.cs: </h3><blockquote><ol><li>  <font color="#0600FF">using</font> <font color="#008080">System</font> <font color="#008000">;</font> </li><li>  <font color="#0600FF">using</font> <font color="#008080">System.Web</font> <font color="#008000">;</font> </li><li>  <font color="#0600FF">using</font> <font color="#008080">System.Web.UI</font> <font color="#008000">;</font> </li><li>  <font color="#0600FF">using</font> <font color="#008080">System.Web.UI.WebControls</font> <font color="#008000">;</font> </li><li></li><li>  <font color="#0600FF">public</font> <font color="#0600FF">partial</font> <font color="#FF0000">class</font> SomePage <font color="#008000">:</font> Page </li><li>  <font color="#000000">{</font> </li><li>  <font color="#0600FF">protected</font> <font color="#0600FF">void</font> Page_PreRender <font color="#000000">(</font> <font color="#FF0000">object</font> sender, EventArgs e <font color="#000000">)</font> </li><li>  <font color="#000000">{</font> </li><li>  lblHello.  <font color="#0000FF">Text</font> <font color="#008000">=</font> <font color="#666666">"Hello from code"</font> <font color="#008000">;</font> </li><li>  <font color="#000000">}</font> </li><li>  <font color="#000000">}</font> </li><li></li></ol></blockquote><br>  Consider how this page turns into code. <br><br>  Here ASP.NET generates two whole classes.  First, partial class SomePage is generated, in which protected members for controls are defined (in our case, Label lblHello) and two properties for accessing custom typed Profile and ApplicationInstance objects (in this example, their types have not been redefined and coincide with standard ones) as well as that server code is presented that we saw in the &lt;script runat = "server"&gt; tag <br><br><h3>  App_Web_ogjttwiz.0.cs: </h3><blockquote><ol><li>  <font color="#0600FF">public</font> <font color="#0600FF">partial</font> <font color="#FF0000">class</font> SomePage <font color="#008000">:</font> <font color="#000000">System.</font>  <font color="#000000"><font color="#0000FF">Web</font></font> .  <font color="#0000FF">SessionState</font> .  <font color="#0000FF">IRequiresSessionState</font> <font color="#000000">{</font> </li><li></li><li></li><li>  <font color="#0600FF">protected</font> global <font color="#008000">::</font> <font color="#000000">System.</font>  <font color="#000000"><font color="#0000FF">Web</font> .</font>  <font color="#000000"><font color="#0000FF">Ui</font> .</font>  <font color="#000000"><font color="#0000FF">WebControls</font></font> .  <font color="#0000FF">Label</font> lblhello <font color="#008000">;</font> </li><li></li><li></li><li>  <font color="#0600FF">protected</font> <font color="#0600FF">void</font> Page_Load <font color="#000000">(</font> <font color="#FF0000">object</font> sender, EventArgs e <font color="#000000">)</font> </li><li>  <font color="#000000">{</font> </li><li>  lblHello.  <font color="#0000FF">ForeColor</font> <font color="#008000">=</font> <font color="#000000">System.</font>  <font color="#000000"><font color="#0000FF">Drawing</font></font> .  <font color="#0000FF">Color</font> .  <font color="#0000FF">Red</font> <font color="#008000">;</font> </li><li>  <font color="#000000">}</font> </li><li></li><li></li><li>  <font color="#0600FF">protected</font> <font color="#000000">system.</font>  <font color="#000000"><font color="#0000FF">Web</font></font> .  <font color="#0000FF">Profile</font> .  <font color="#0000FF">DefaultProfile</font> Profile <font color="#000000">{</font> </li><li>  get <font color="#000000">{</font> </li><li>  <font color="#0600FF">return</font> <font color="#000000">(</font> <font color="#000000">(</font> <font color="#000000">System. <font color="#0000FF">Web</font></font> . <font color="#0000FF">Profile</font> . <font color="#0000FF">DefaultProfile</font> <font color="#000000">)</font> <font color="#000000">(</font> <font color="#0600FF">this</font> . <font color="#0000FF">Context</font> . <font color="#0000FF">Profile</font> <font color="#000000">)</font> <font color="#000000">)</font> <font color="#008000">;</font> </li><li>  <font color="#000000">}</font> </li><li>  <font color="#000000">}</font> </li><li></li><li>  <font color="#0600FF">protected</font> <font color="#000000">system.</font>  <font color="#000000"><font color="#0000FF">Web</font></font> .  <font color="#0000FF">HttpApplication</font> ApplicationInstance <font color="#000000">{</font> </li><li>  get <font color="#000000">{</font> </li><li>  <font color="#0600FF">return</font> <font color="#000000">(</font> <font color="#000000">(</font> <font color="#000000">System. <font color="#0000FF">Web</font></font> . <font color="#0000FF">HttpApplication</font> <font color="#000000">)</font> <font color="#000000">(</font> <font color="#0600FF">this</font> . <font color="#0000FF">Context</font> . <font color="#0000FF">ApplicationInstance</font> <font color="#000000">)</font> <font color="#000000">)</font> <font color="#008000">;</font> </li><li>  <font color="#000000">}</font> </li><li>  <font color="#000000">}</font> </li><li>  <font color="#000000">}</font> </li><li></li></ol></blockquote>  After that, the actual page class is generated, which will already process our physical request.  I note that its ASP.NET places in the same temporary code file in which we also saw the previous class. <br><br><h3>  App_Web_ogjttwiz.0.cs (continued): </h3><blockquote><ol><li>  <font color="#0600FF">namespace</font> ASP <font color="#000000">{</font> </li><li></li><li>  ... </li><li>  <font color="#000000">[</font> <font color="#000000">System</font> .  <font color="#0000FF">Runtime</font>  <font color="#0000FF">CompilerServices</font> .  <font color="#0000FF">CompilerGlobalScopeAttribute</font> <font color="#000000">(</font> <font color="#000000">)</font> <font color="#000000">]</font> </li><li>  <font color="#0600FF">public</font> <font color="#FF0000">class</font> somepage_aspx <font color="#008000">:</font> global <font color="#008000">::</font> <font color="#0000FF">SomePage</font> , <font color="#000000">System.</font>  <font color="#000000"><font color="#0000FF">Web</font></font> .  <font color="#0000FF">IHttpHandler</font> <font color="#000000">{</font> </li><li></li><li>  <font color="#0600FF">private</font> <font color="#0600FF">static</font> <font color="#FF0000">bool</font> @__initialized <font color="#008000">;</font> </li><li></li><li>  <font color="#0600FF">private</font> <font color="#0600FF">static</font> <font color="#FF0000">object</font> @__fileDependencies <font color="#008000">;</font> </li><li></li><li>  <font color="#000000">[</font> <font color="#000000">System.</font>  <font color="#000000"><font color="#0000FF">Diagnostics</font></font> .  <font color="#0000FF">DebuggerNonUserCodeAttribute</font> <font color="#000000">(</font> <font color="#000000">)</font> <font color="#000000">]</font> </li><li>  <font color="#0600FF">public</font> somepage_aspx <font color="#000000">(</font> <font color="#000000">)</font> <font color="#000000">{</font> </li><li>  <font color="#FF0000">string</font> <font color="#000000">[</font> <font color="#000000">]</font> dependencies <font color="#008000">;</font> </li><li></li><li>  <font color="#000000">(</font> <font color="#0600FF">this</font> <font color="#000000">)</font> .  <font color="#0000FF">AppRelativeVirtualPath</font> <font color="#008000">=</font> <font color="#666666">"~ / SomePage.aspx"</font> <font color="#008000">;</font> </li><li></li><li>  <font color="#0600FF">if</font> <font color="#000000">(</font> <font color="#000000">(</font> global <font color="#008000">::</font> <font color="#0000FF">ASP</font> . <font color="#0000FF">somepage_aspx</font> . @ __ initialized <font color="#008000">==</font> <font color="#0600FF">false</font> <font color="#000000">)</font> <font color="#000000">)</font> <font color="#000000">{</font> </li><li>  dependencies <font color="#008000">=</font> <font color="#008000">new</font> <font color="#FF0000">string</font> <font color="#000000">[</font> <font color="#FF0000">2</font> <font color="#000000">]</font> <font color="#008000">;</font> </li><li>  dependencies <font color="#000000">[</font> <font color="#FF0000">0</font> <font color="#000000">]</font> <font color="#008000">=</font> <font color="#666666">"~ / SomePage.aspx"</font> <font color="#008000">;</font> </li><li>  dependencies <font color="#000000">[</font> <font color="#FF0000">1</font> <font color="#000000">]</font> <font color="#008000">=</font> <font color="#666666">"~ / SomePage.aspx.cs"</font> <font color="#008000">;</font> </li><li>  global <font color="#008000">::</font> <font color="#0000FF">ASP</font> .  <font color="#0000FF">somepage_aspx</font> . @ __ fileDependencies <font color="#008000">=</font> <font color="#0600FF">this</font> .  <font color="#0000FF">GetWrappedFileDependencies</font> <font color="#000000">(</font> dependencies <font color="#000000">)</font> <font color="#008000">;</font> </li><li>  global <font color="#008000">::</font> <font color="#0000FF">ASP</font> .  <font color="#0000FF">somepage_aspx</font> . @ __ initialized <font color="#008000">=</font> true <font color="#008000">;</font> </li><li>  <font color="#000000">}</font> </li><li>  <font color="#0600FF">this</font> .  <font color="#0000FF">Server</font> .  <font color="#0000FF">ScriptTimeout</font> <font color="#008000">=</font> <font color="#FF0000">30,000,000</font> <font color="#008000">;</font> </li><li>  <font color="#000000">}</font> </li><li></li><li>  <font color="#000000">[</font> <font color="#000000">System.</font>  <font color="#000000"><font color="#0000FF">Diagnostics</font></font> .  <font color="#0000FF">DebuggerNonUserCodeAttribute</font> <font color="#000000">(</font> <font color="#000000">)</font> <font color="#000000">]</font> </li><li>  <font color="#0600FF">protected</font> <font color="#0600FF">override</font> <font color="#0600FF">void</font> FrameworkInitialize <font color="#000000">(</font> <font color="#000000">)</font> <font color="#000000">{</font> </li><li>  <font color="#0600FF">base</font> .  <font color="#0000FF">FrameworkInitialize</font> <font color="#000000">(</font> <font color="#000000">)</font> <font color="#008000">;</font> </li><li>  <font color="#0600FF">this</font> .  @__BuildControlTree <font color="#000000">(</font> <font color="#0600FF">this</font> <font color="#000000">)</font> <font color="#008000">;</font> </li><li>  <font color="#0600FF">this</font> .  <font color="#0000FF">AddWrappedFileDependencies</font> <font color="#000000">(</font> global <font color="#008000">::</font> <font color="#0000FF">ASP</font> . <font color="#0000FF">Somepage_aspx</font> . @ __ fileDependencies <font color="#000000">)</font> <font color="#008000">;</font> </li><li>  <font color="#000000">}</font> </li><li></li><li>  <font color="#000000">[</font> <font color="#000000">System.</font>  <font color="#000000"><font color="#0000FF">Diagnostics</font></font> .  <font color="#0000FF">DebuggerNonUserCodeAttribute</font> <font color="#000000">(</font> <font color="#000000">)</font> <font color="#000000">]</font> </li><li>  <font color="#0600FF">private</font> <font color="#0600FF">void</font> @__BuildControlTree <font color="#000000">(</font> somepage_aspx @__ctrl <font color="#000000">)</font> <font color="#000000">{</font> </li><li></li><li>  <font color="#0600FF">this</font> .  <font color="#0000FF">InitializeCulture</font> <font color="#000000">(</font> <font color="#000000">)</font> <font color="#008000">;</font> </li><li></li><li>  <font color="#000000">System.</font>  <font color="#000000"><font color="#0000FF">Web</font> .</font>  <font color="#000000"><font color="#0000FF">Ui</font></font> .  <font color="#0000FF">IParserAccessor</font> @__parser <font color="#008000">=</font> <font color="#000000">(</font> <font color="#000000">(</font> <font color="#000000">System. <font color="#0000FF">Web</font> . <font color="#0000FF">UI</font></font> . <font color="#0000FF">IParserAccessor</font> <font color="#000000">)</font> <font color="#000000">(</font> @__ctrl <font color="#000000">)</font> <font color="#000000">)</font> <font color="#008000">;</font> </li><li></li><li>  @__parser.  <font color="#0000FF">AddParsedSubObject</font> <font color="#000000">(</font> <font color="#008000">new</font> <font color="#000000">System. <font color="#0000FF">Web</font> . <font color="#0000FF">UI</font></font> . <font color="#0000FF">LiteralControl</font> <font color="#000000">(</font> <font color="#666666">@ "&lt;html&gt;</font> </li><li>  <font color="#666666">&lt;head&gt;</font> </li><li>  <font color="#666666">&lt;title&gt; SomePage &lt;/ title&gt;</font> </li><li>  <font color="#666666">&lt;/ head&gt;</font> </li><li>  <font color="#666666">&lt;body&gt; "</font> <font color="#000000">)</font> <font color="#000000">)</font> <font color="#008000">;</font> </li><li></li><li>  global <font color="#008000">::</font> <font color="#000000">System.</font>  <font color="#000000"><font color="#0000FF">Web</font> .</font>  <font color="#000000"><font color="#0000FF">Ui</font> .</font>  <font color="#000000"><font color="#0000FF">WebControls</font></font> .  <font color="#0000FF">Label</font> @__ ctrl2 <font color="#008000">;</font> </li><li></li><li>  @__ ctrl2 <font color="#008000">=</font> <font color="#0600FF">this</font> .  @__BuildControllblHello <font color="#000000">(</font> <font color="#000000">)</font> <font color="#008000">;</font> </li><li></li><li>  @__parser.  <font color="#0000FF">AddParsedSubObject</font> <font color="#000000">(</font> @__ ctrl2 <font color="#000000">)</font> <font color="#008000">;</font> </li><li></li><li>  @__parser.  <font color="#0000FF">AddParsedSubObject</font> <font color="#000000">(</font> <font color="#008000">new</font> <font color="#000000">System. <font color="#0000FF">Web</font> . <font color="#0000FF">UI</font></font> . <font color="#0000FF">LiteralControl</font> <font color="#000000">(</font> <font color="#666666">"&lt;/ body&gt; &lt;/ html&gt;"</font> <font color="#000000">)</font> <font color="#000000">)</font> <font color="#008000">;</font> </li><li>  <font color="#000000">}</font> </li><li></li><li>  <font color="#000000">[</font> <font color="#000000">System.</font>  <font color="#000000"><font color="#0000FF">Diagnostics</font></font> .  <font color="#0000FF">DebuggerNonUserCodeAttribute</font> <font color="#000000">(</font> <font color="#000000">)</font> <font color="#000000">]</font> </li><li>  <font color="#0600FF">private</font> global <font color="#008000">::</font> <font color="#000000">System.</font>  <font color="#000000"><font color="#0000FF">Web</font> .</font>  <font color="#000000"><font color="#0000FF">Ui</font> .</font>  <font color="#000000"><font color="#0000FF">WebControls</font></font> .  <font color="#0000FF">Label</font> @__BuildControllblHello <font color="#000000">(</font> <font color="#000000">)</font> <font color="#000000">{</font> </li><li>  global <font color="#008000">::</font> <font color="#000000">System.</font>  <font color="#000000"><font color="#0000FF">Web</font> .</font>  <font color="#000000"><font color="#0000FF">Ui</font> .</font>  <font color="#000000"><font color="#0000FF">WebControls</font></font> .  <font color="#0000FF">Label</font> @__ctrl <font color="#008000">;</font> </li><li></li><li>  @__ctrl <font color="#008000">=</font> <font color="#008000">new</font> global <font color="#008000">::</font> <font color="#000000">System.</font>  <font color="#000000"><font color="#0000FF">Web</font> .</font>  <font color="#000000"><font color="#0000FF">Ui</font> .</font>  <font color="#000000"><font color="#0000FF">WebControls</font></font> .  <font color="#0000FF">Label</font> <font color="#000000">(</font> <font color="#000000">)</font> <font color="#008000">;</font> </li><li></li><li>  <font color="#0600FF">this</font> .  <font color="#0000FF">lblError</font> <font color="#008000">=</font> @__ctrl <font color="#008000">;</font> </li><li>  @__ctrl.  <font color="#0000FF">ApplyStyleSheetSkin</font> <font color="#000000">(</font> <font color="#0600FF">this</font> <font color="#000000">)</font> <font color="#008000">;</font> </li><li></li><li>  @__ctrl.  <font color="#0000FF">Id</font> <font color="#008000">=</font> <font color="#666666">"lblHello"</font> <font color="#008000">;</font> </li><li></li><li></li><li>  @__ctrl.  <font color="#0000FF">EnableViewState</font> <font color="#008000">=</font> false <font color="#008000">;</font> </li><li></li><li>  <font color="#0600FF">return</font> @__ctrl <font color="#008000">;</font> </li><li>  <font color="#000000">}</font> </li><li>  ... </li><li>  <font color="#000000">}</font> </li><li>  <font color="#000000">}</font> </li><li></li></ol></blockquote>  This class is by default named somepage_aspx, but this can be changed by setting the ClassName attribute on the Page directive, like this: <blockquote><ol><li>  <font color="#009900">&lt;% @ Page <font color="#000066">Language</font> <font color="#66cc66">=</font> <font color="#ff0000">"C #"</font> AutoEventWireup <font color="#66cc66">=</font> <font color="#ff0000">"true"</font> CodeFile <font color="#66cc66">=</font> <font color="#ff0000">"SomePage.aspx.cs"</font> Inherits <font color="#66cc66">=</font> <font color="#ff0000">"SomePage"</font> ClassName <font color="#66cc66">=</font> <font color="#ff0000">"MyPageClass"</font> %&gt;</font> </li></ol></blockquote>  As you can see here, to generate the first of the classes (public partial class SomePage), the CodeFile and Inherits attributes are used, and they must be matched (that is, the file specified in the CodeFile must contain a class with the name, as in the Inherits attribute).  After that, a second class is created with the name taken from the ClassName attribute (or by default - &lt;Inits_lowercase value&gt; _aspx) <br>  In the second class (it is the final class of the page), we see the code responsible for generating the page's control tree, and the code responsible for initializing the compilation and caching infrastructure of the compiled pages as assemblies .dll. <br>  We analyze it in parts. <blockquote><ol><li>  <font color="#0600FF">public</font> somepage_aspx <font color="#000000">(</font> <font color="#000000">)</font> <font color="#000000">{</font> </li><li>  <font color="#FF0000">string</font> <font color="#000000">[</font> <font color="#000000">]</font> dependencies <font color="#008000">;</font> </li><li></li><li>  <font color="#000000">(</font> <font color="#0600FF">this</font> <font color="#000000">)</font> .  <font color="#0000FF">AppRelativeVirtualPath</font> <font color="#008000">=</font> <font color="#666666">"~ / SomePage.aspx"</font> <font color="#008000">;</font> </li><li></li><li>  <font color="#0600FF">if</font> <font color="#000000">(</font> <font color="#000000">(</font> global <font color="#008000">::</font> <font color="#0000FF">ASP</font> . <font color="#0000FF">somepage_aspx</font> . @ __ initialized <font color="#008000">==</font> <font color="#0600FF">false</font> <font color="#000000">)</font> <font color="#000000">)</font> <font color="#000000">{</font> </li><li>  dependencies <font color="#008000">=</font> <font color="#008000">new</font> <font color="#FF0000">string</font> <font color="#000000">[</font> <font color="#FF0000">2</font> <font color="#000000">]</font> <font color="#008000">;</font> </li><li>  dependencies <font color="#000000">[</font> <font color="#FF0000">0</font> <font color="#000000">]</font> <font color="#008000">=</font> <font color="#666666">"~ / SomePage.aspx"</font> <font color="#008000">;</font> </li><li>  dependencies <font color="#000000">[</font> <font color="#FF0000">1</font> <font color="#000000">]</font> <font color="#008000">=</font> <font color="#666666">"~ / SomePage.aspx.cs"</font> <font color="#008000">;</font> </li><li>  global <font color="#008000">::</font> <font color="#0000FF">ASP</font> .  <font color="#0000FF">somepage_aspx</font> . @ __ fileDependencies <font color="#008000">=</font> <font color="#0600FF">this</font> .  <font color="#0000FF">GetWrappedFileDependencies</font> <font color="#000000">(</font> dependencies <font color="#000000">)</font> <font color="#008000">;</font> </li><li>  global <font color="#008000">::</font> <font color="#0000FF">ASP</font> .  <font color="#0000FF">somepage_aspx</font> . @ __ initialized <font color="#008000">=</font> true <font color="#008000">;</font> </li><li>  <font color="#000000">}</font> </li><li>  <font color="#0600FF">this</font> .  <font color="#0000FF">Server</font> .  <font color="#0000FF">ScriptTimeout</font> <font color="#008000">=</font> <font color="#FF0000">30,000,000</font> <font color="#008000">;</font> </li><li>  <font color="#000000">}</font> </li><li></li></ol></blockquote>  The constructor somepage_aspx initializes the current virtual path for the page, since the ASP.NET infrastructure itself is not responsible for this (you need to keep this fact in mind when developing your own custom classes that inherit the page, bypassing the standard compilation path). <br>  After that, it is stated that the compiled version of this class (in the form of a dll) must be recompiled when the following source files are changed: ~ / SomePage.aspx and ~ / SomePage.aspx.cs.  This information will be transmitted below to the infrastructure (namely, to the standard provider of the path), which, in turn, will provide it to the compilation provider if necessary. <br><br>  The generation of the control tree is handled by the @__BuildControlTree method, in which a sequential invocation of methods of the type @__ BuildControl &lt;control_id&gt; () is made: <blockquote><ol><li>  <font color="#000000">[</font> <font color="#000000">System.</font>  <font color="#000000"><font color="#0000FF">Diagnostics</font></font> .  <font color="#0000FF">DebuggerNonUserCodeAttribute</font> <font color="#000000">(</font> <font color="#000000">)</font> <font color="#000000">]</font> </li><li>  <font color="#0600FF">private</font> <font color="#0600FF">void</font> @__BuildControlTree <font color="#000000">(</font> somepage_aspx @__ctrl <font color="#000000">)</font> <font color="#000000">{</font> </li><li></li><li>  <font color="#0600FF">this</font> .  <font color="#0000FF">InitializeCulture</font> <font color="#000000">(</font> <font color="#000000">)</font> <font color="#008000">;</font> </li><li></li><li>  <font color="#000000">System.</font>  <font color="#000000"><font color="#0000FF">Web</font> .</font>  <font color="#000000"><font color="#0000FF">Ui</font></font> .  <font color="#0000FF">IParserAccessor</font> @__parser <font color="#008000">=</font> <font color="#000000">(</font> <font color="#000000">(</font> <font color="#000000">System. <font color="#0000FF">Web</font> . <font color="#0000FF">UI</font></font> . <font color="#0000FF">IParserAccessor</font> <font color="#000000">)</font> <font color="#000000">(</font> @__ctrl <font color="#000000">)</font> <font color="#000000">)</font> <font color="#008000">;</font> </li><li></li><li>  @__parser.  <font color="#0000FF">AddParsedSubObject</font> <font color="#000000">(</font> <font color="#008000">new</font> <font color="#000000">System. <font color="#0000FF">Web</font> . <font color="#0000FF">UI</font></font> . <font color="#0000FF">LiteralControl</font> <font color="#000000">(</font> <font color="#666666">@ "&lt;html&gt;</font> </li><li>  <font color="#666666">&lt;head&gt;</font> </li><li>  <font color="#666666">&lt;title&gt; SomePage &lt;/ title&gt;</font> </li><li>  <font color="#666666">&lt;/ head&gt;</font> </li><li>  <font color="#666666">&lt;body&gt; "</font> <font color="#000000">)</font> <font color="#000000">)</font> <font color="#008000">;</font> </li><li></li><li>  global <font color="#008000">::</font> <font color="#000000">System.</font>  <font color="#000000"><font color="#0000FF">Web</font> .</font>  <font color="#000000"><font color="#0000FF">Ui</font> .</font>  <font color="#000000"><font color="#0000FF">WebControls</font></font> .  <font color="#0000FF">Label</font> @__ ctrl2 <font color="#008000">;</font> </li><li></li><li>  @__ ctrl2 <font color="#008000">=</font> <font color="#0600FF">this</font> .  @__BuildControllblHello <font color="#000000">(</font> <font color="#000000">)</font> <font color="#008000">;</font> </li><li></li><li>  @__parser.  <font color="#0000FF">AddParsedSubObject</font> <font color="#000000">(</font> @__ ctrl2 <font color="#000000">)</font> <font color="#008000">;</font> </li><li></li><li>  @__parser.  <font color="#0000FF">AddParsedSubObject</font> <font color="#000000">(</font> <font color="#008000">new</font> <font color="#000000">System. <font color="#0000FF">Web</font> . <font color="#0000FF">UI</font></font> . <font color="#0000FF">LiteralControl</font> <font color="#000000">(</font> <font color="#666666">"&lt;/ body&gt; &lt;/ html&gt;"</font> <font color="#000000">)</font> <font color="#000000">)</font> <font color="#008000">;</font> </li><li>  <font color="#000000">}</font> </li><li></li></ol></blockquote>  In our case, there is only one control - this is lblHello.  In addition to creating an object for it, text fragments are added to the page object tree, framing our control.  As a result, each line of markup is added to the page object tree, either as LiteralControl, or as a typed server control. <br><br><h2>  Total </h2><br>  The resulting class implements the IHttpHandler interface, and after working through the page factory, the instance of this class it creates handles a request of the form http: //url/SomePage.aspx ‚Äî after which the well-known ASP.NET life cycle begins. <br><br>  In the future, I will probably write more about the providers mentioned here: compilations and virtual paths. <br><br>  UPD: Transferred to ".NET" </div><p>Source: <a href="https://habr.com/ru/post/61074/">https://habr.com/ru/post/61074/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../61068/index.html">How to open an online store with a bare ass</a></li>
<li><a href="../61069/index.html">calendarLite plugin</a></li>
<li><a href="../61070/index.html">Windows 7 from the point of view of a pirate</a></li>
<li><a href="../61072/index.html">OpenSolaris 2009.06 Release</a></li>
<li><a href="../61073/index.html">Google will start selling e-books</a></li>
<li><a href="../61075/index.html">DesignSocial.ru - social network of designers</a></li>
<li><a href="../61076/index.html">Gauss Cannon - Myth or Reality?</a></li>
<li><a href="../61078/index.html">Procedural vs. object oriented programming</a></li>
<li><a href="../61082/index.html">How easy it is to make a calendar and a clock for entering the date and time on a form</a></li>
<li><a href="../61086/index.html">Kyocera KE 301 and Linux</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>