<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Implementing the infrastructure of the Internet of things for a smart office - the experience of Microsoft Technology Center</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The article was written by Maxim Khlupnov, technical director of the Microsoft Solutions and Technology Center (Microsoft Technology Center), based on...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Implementing the infrastructure of the Internet of things for a smart office - the experience of Microsoft Technology Center</h1><div class="post__text post__text-html js-mediator-article"><blockquote>  <em>The article was written by Maxim Khlupnov, technical director of the Microsoft Solutions and Technology Center (Microsoft Technology Center), based on real experience in designing and implementing a smart office project.</em>  <em>The material is a continuation of the article on the <a href="http://habrahabr.ru/company/microsoft/blog/261367/">Internet of Things, published on Monday</a></em> </blockquote><br>  Microsoft‚Äôs second Moscow office, located near the Belorusskaya metro station, is not an office space in the generally accepted sense.  Most of the 1700 sq.m.  The areas are occupied by demonstration stands with the latest devices and solutions, including a small modern data center of 160 kW, three computer classes for 15 workplaces each, meeting rooms and conference rooms filled with modern equipment.  But this is only the "visible part" - its work is provided by power supply systems, data center cooling and other complex engineering solutions.  However, this is exactly what the Microsoft Technology Center (MTC), designed to demonstrate and test advanced technologies, should look like. <br><br><img src="https://habrastorage.org/files/0b1/971/d91/0b1971d9143a4e4a99ff06727979620e.jpg"><br><a name="habracut"></a><br>  MTS is constantly changing: partners supply new equipment, and employees of the center integrate it into the existing infrastructure. <br><br>  What makes a smart office different from an ordinary one?  Almost everything.  Starting with parking, which calculates the number of spaces required for employees' cars - until the Server Display Room Energy Management (SDS) is monitored.  SDS is a small 160 kW datacenter for demonstrations and load testing.  Communications, identification of employees or guests using smart cards or using NFC in the phone, quick access to elevators in high-rise buildings, navigation around the office for guests, electronic secretary at the reception, the ability to control the projector, lighting and other meeting room equipment with a voice from a smartphone ... Part These solutions already exist and are being actively used; some of them will be widely distributed in the near future.  Now we are completing the integration of our office systems into a single solution based on <a href="http://azure.com/">Microsoft Azure</a> services. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The technology center team consists of only 10 people, and only two of them are engaged in infrastructure support.  The remaining employees work with customers, hold demonstrations, briefings, sessions on the creation of a solution architecture, load testing and concept validation projects. <br><br><h2>  From the subsystem ACS to the IoT solution architecture </h2><br>  Since opening in 2009, MTC has been receiving guests almost daily: presentations for partners and customers, seminars and trainings for IT specialists, briefings for journalists are held here.  Only for trainings, more than 50 computers are prepared daily in four computer classes. <br><br>  Effective management of such a technically rich site is unthinkable without automation.  Considering that events for customers are responsible - it is important to receive monitoring information and notifications about system and equipment failures, to predict in advance possible failures by analyzing the system operation statistics. <br><br>  We plan to publish several articles describing the architecture and approaches that we use to manage and automate a modern office: Monitoring the engineering infrastructure and integration with building management systems, data center monitoring (SDS), managing audio-visual equipment, managing the loading of meeting rooms , analysis of the efficiency of use of premises and equipment, prediction of failures and failures. <br>  In this article we will look at the main components of the architecture that provide automation for office space.  We did not implement the system from scratch, but performed the integration of the proven industrial solutions of the partners of the technology center, built on industry standards. <br><br><img src="https://habrastorage.org/files/f44/ed1/eb7/f44ed1eb7ce84e4c9220560ae74f18a7.png"><br><br>  The infrastructure is controlled by hundreds of sensors and actuators.  Sources of sensor categories - information providers are: <br><br><ul><li>  Sensors Server Display Room (temperature, humidity, power supply, cooling, video surveillance, etc.) </li><li>  Lighting control </li><li>  Audio-video and presentation equipment management </li><li>  Schedule, configuration and loading management </li><li>  Climate control </li><li>  Access control </li><li>  Increase business productivity and unified communications </li></ul><br>  The data of these sensors are collected and analyzed both locally, using linear data concentrators, and with transfer to cloud services. <br><br><img src="https://habrastorage.org/files/aaf/dac/f58/aafdacf5877240f08387b8af0c75e089.png"><br><br>  The cloud we use primarily for notification of failures - Exchange Online for sending mail and Azure Notification Hub for sending Push-notifications to smartphones.  We also plan to use the Azure Machine Learning machine learning services to analyze the accumulated statistics in order to predict failures. <br><br>  For example, now we use several Crestron Advanced Control Processor 3-series switches for controlling the lighting via the DALI bus, audio-video equipment (projectors are controlled via RS-232 interface, and TV sets via IR).  At the same time, the switch reports on each event that occurs in the line hub bus it controls. <br><br><h2>  Azure IoT gateway </h2><br>  Our IoT line hub (IoT gateway) is implemented as a service that we wrote in C # using the Microsoft Lab of Things.  Hub service, on the one hand, listens to the signal bus of Crestron switches, and on the other hand, publishes WCF services that are available to our mobile and web applications.  Exactly, through the mobile application that calls the WCF-service, voice control of light and audio-video equipment is implemented on the video above. <br><br>  In addition, we plan to broadcast messages from the Crestron network (BACnet) through our hub to the cloud for further analysis in Azure Machine Learning.  Our goal is to predict possible equipment failures and projectively determine which of our users will need help in setting up equipment. <br>  Now we have a subsystem deployed that transmits Crestron signal and command bus messages through an IoT hub (IoT gateway) to the Azure EventHub.  EventHub is called mtcmanager, it is deployed in our Azure subscription and allows you to send up to 1Gb / s of events to the cloud.  Of course, we do not create such a flow of events in our office, even with the inclusion of each bulb, but this is fully consistent with the real industrial scenarios of the application area.  If we served thousands of offices around the world - EventHub still coped with the data stream! <br><br><img src="https://habrastorage.org/files/c1c/e05/d3d/c1ce05d3ddcb4afdb4d14a650b20457d.png"><br><br>  Events in Azure EventHub come in JSON format encapsulated in AMQP packets and contain the following data: numeric values ‚Äã‚Äã(join, slot, value and signal type - information from the Crestron switchboard), event timestamp and source code. <br><br>  Our goal is to display a dashboard with the state of the light and projectors in the MTC (in which rooms the lights, projector, etc. are turned on).  This information may already be useful if the equipment, for example, is turned on during off-hours.  Then we will be able to connect Azure Machine Learning, add data from the schedule of events to the MTC, in order to predict, for example, with what probability they forget to turn off the lights after the end of the event or there are difficulties in connecting audio-video equipment. <br><br>  To add metadata to the mean sensor readings, we connect the Azure StreamAnalytics service and point it to the Azure EventHub ‚Äúmtcmanager‚Äù data source. <br><br>  Signal descriptions for combinations of the join and slot values ‚Äã‚Äãare stored in Azure SQL as a lookup table.  By combining the data of each event with the data of the reference in the request of Azure Stream Analytics, we get information suitable for analysis. <br><br><h2>  Access from anywhere and security solutions </h2><br>  Classic ACS systems understand security as the physical protection of a connection.  If someone gets the opportunity to access the network management of the building, he often gets access to all devices.  That is why in classic ACS systems, publishing services via the Internet causes a shudder.  We ‚Äúcease to control the perimeter and ensuring security becomes an intractable task‚Äù for classic control systems. <br><br>  By publishing the WCF services of our IoT hub through the Azure Service Bus, we were able to securely access the services of our system from anywhere.  And it did not require programming.  Access is protected by two-factor authentication for administrators and is completely secure. <br><br>  However, having a large number of complex services that provide management of business-critical equipment ‚Äî access control is of paramount importance.  Several hundred people work at Microsoft office, and many of them participate in events at MTS.  How to provide secure access to mobile applications for several hundreds of people "on demand"?  The answer for us is a new IoT solution architecture based on the Microsoft-announced Azure IoT suite service (see figure below). <br><br><img src="https://habrastorage.org/files/001/1b0/633/0011b063346044a4b4fdb5bf43de56fc.png"><br><br>  But this is a topic for the next article.  Thank! </div><p>Source: <a href="https://habr.com/ru/post/261533/">https://habr.com/ru/post/261533/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../261521/index.html">Setting tasks and calculating labor costs for the development of documentation in an IT company</a></li>
<li><a href="../261525/index.html">How to control response time or how fast your website loads?</a></li>
<li><a href="../261527/index.html">Mobile app design: why we work in @ 1x</a></li>
<li><a href="../261529/index.html">How to replace a homogeneous background with a transparent imagemagick</a></li>
<li><a href="../261531/index.html">Push notifications via Telegram</a></li>
<li><a href="../261535/index.html">Automatic reorganization of arrays in the memory of the graphics accelerator</a></li>
<li><a href="../261537/index.html">Manage dependencies in iOS applications correctly: Typhoon modularity</a></li>
<li><a href="../261539/index.html">Alt key for mouse gestures, as well as various important fixes in Vivaldi 1.0.212.3</a></li>
<li><a href="../261541/index.html">Expanding the functionality of the "notebook"</a></li>
<li><a href="../261543/index.html">We continue to expand the functionality of the browser Vivaldi</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>