<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Vulnerabilities in Oschadbank: getting a full name of a client by phone number, enumerating card numbers, problems in payment terminals</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I have accumulated several problems found in various services of Oschadbank, one of the largest Ukrainian banks. 

 All information is provided for in...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Vulnerabilities in Oschadbank: getting a full name of a client by phone number, enumerating card numbers, problems in payment terminals</h1><div class="post__text post__text-html js-mediator-article">  I have accumulated several problems found in various services of Oschadbank, one of the largest Ukrainian banks. <br><br>  <b>All information is provided for informational purposes only.</b>  <b>I am not responsible for any possible harm caused by the materials of this article.</b> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ke/x-/cd/kex-cdffc5qakjxnbcqopm0nxke.png" alt="vulnerabilities Oschadbanka"></div><br>  <b>1. Getting the name of the client by phone number</b> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Oschadbank added a new function to its online banking Oschad 24/7 - transfer from card to card by phone number: to transfer funds, it is not necessary to know the card number of the recipient. <br><br>  Earlier, I considered the problems in the implementation of this function in another Ukrainian bank - <a href="https://habrahabr.ru/post/334700/">Vulnerability in Alfa-Bank Ukraine: obtaining the client‚Äôs full name by phone number</a> . <br><br>  Here, the vulnerability is less - in fact, it‚Äôs possible to receive not just the full name, but only the name and the first letter of the last name, but this does not negate the fact that you can now find out the real name of a person hiding behind an anonymous phone number to the passport). <br><br>  Those.  if you are interested in, for example, the name of the person who called you, and a search in social networks does not give results, or you doubt their validity (often in social networks indicate made-up names), then with the help of Oschadbank you can try to find out his real name. <br><br>  What kind of search in social networks?  It has already been described many times, but I think it will not be superfluous to recall the ‚Äúfeature‚Äù: if you need to know the person‚Äôs full name, you can try to ‚Äúrestore‚Äù your social media credentials. <br><br>  For example, you can click "Forgot your account?" On Facebook, enter the desired phone number and, if the person is registered with this phone, the following data will be available: <br><a name="habracut"></a><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/px/sa/vx/pxsavxkm3qvswtqaciay2x1qadu.png"></div><br>  - Masked mail address; <br>  - User's avatar as a link <a href="https://www.facebook.com/profile/pic.php%3Fcuid%3DXYZ%26square_px%3D50">www.facebook.com/profile/pic.php?cuid=XYZ&amp;square_px=50</a> , which can be opened in higher resolution by increasing the parameter square_px; <br>  - Name and surname under which the user is registered. <br><br>  So, if the name and surname indicated in one of the social networks raise doubts about their authenticity, Oschadbank comes to the rescue with its almost 5.5 million active bank cards (this is the second bank by the number of active cards in Ukraine): <br><br>  In Oschad 24/7 choose: Payments and transfers, Transfers between cards, By phone number: <br><br><img src="https://habrastorage.org/webt/py/us/2u/pyus2un51--5tfjstb_6gso6wsm.png"><br>  If the client‚Äôs system is found, we see his name, the first letter of the last name and the masked card number: <br><br><img src="https://habrastorage.org/webt/-x/jm/ed/-xjmedxfitvrtgf6evayxy-sa-g.png"><br><br>  Or you can use the GET request at <a href="https://online.oschadbank.ua/wb/api/v2/catalogs/CONTRACT_BY_PHONE%3FfilterCode%3DBY_PHONE%26PHONE_NUMBER%3D380987654321">https://online.oschadbank.ua/wb/api/v2/catalogs/CONTRACT_BY_PHONE?filterCode=BY_PHONE&amp;PHONE_NUMBER=380987654321</a> <br><br>  In response, we get: <br><br> <code>[ { <br> "id" : "+380987654321", <br> "name" : "+380987654321", <br> "CONTRACT_ID" : "42577459", <br> "CLIENT_NAME" : " <b> .</b> ", <br> "PAN" : "5167********3489" <br> } ]</code> <br> <br>  Yes, Oschadbank has blocked for some time the possibility of transferring non-existent phone numbers when trying to iterate. <br><br>  However, this is not such a problem, considering the second vulnerability of Oschadbank. <br><br>  <b>2. Getting a <u>new</u> account in Oschad 24/7 using Visa prepaid cards</b> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/bk/co/eo/bkcoeo9gcrlt1rlxbfjlmcynbtk.png" alt="Visa Eurovision"></div><br>  A prepaid card (issued without submission of documents) is activated with any phone number: when issuing a card, Oschadbank does not match the client‚Äôs phone number with the card - the client automatically links it to any mobile number. <br><br>  So, in order to get an account in Oschad 24/7, you can not buy such a payment card of Oschadbank, but simply try to activate it in the automatic call center menu by brute forceing the <a href="https://ru.wikipedia.org/wiki/%25D0%2590%25D0%25BB%25D0%25B3%25D0%25BE%25D1%2580%25D0%25B8%25D1%2582%25D0%25BC_%25D0%259B%25D1%2583%25D0%25BD%25D0%25B0">correct</a> card number. <br><br>  In the IVR menu, there is no limit on the number of unsuccessful attempts to make such a selection, and if the 16-digit card number is ‚Äúfree‚Äù (this card was not activated by anyone), the bank: <br><br><ul><li>  immediately activates the card </li><li>  connect SMS informing to this phone number, </li><li>  and automatically register the card in Oschad 24/7. </li></ul><br>  All this without a plastic card in your hands. <br><br>  Accordingly, it will be possible to enter Internet banking without ever having appeared in the department. <br><br>  Well, how then is it better to implement a transfer by phone number, so that it is safe and convenient for customers?  - I will reiterate the previous article: <a href="https://habrahabr.ru/post/334700/">Vulnerability in Alfa-Bank Ukraine: getting the client's full name by phone number</a> .  I like the final implementation of the Alfa-Bank service: part of the last name is masked with asterisks, and the first and middle names are indicated only by the first letters. <br><br>  <b>3. Access to folders and files on the Oschadbank site</b> <br><br>  Another problem with Visa cards, it is not listed in the header. <br><br>  When Oschadbank launched the sale of Visa Prepaid on its website, they did not take care of the settings for access and display of directories. <br><br>  For example, on one of the https-pages it was possible to search through the form of someone else's order, where the client‚Äôs e-mail address, his order number and name are indicated in the page code: <br><br><img src="https://habrastorage.org/webt/wu/e6/mp/wue6mp2uykhn1tp3kwzwy0invp4.png"><br><br>  The rest of the pages were on http, not https, and on them, without authorization, the folders, files and logs of payment by clients for the card data were available: <br><br><img src="https://habrastorage.org/webt/mv/km/rr/mvkmrrivyrq53qrgzfvv482krie.png"><br><br>  Payment logs: <br><br><img src="https://habrastorage.org/webt/nh/0r/g-/nh0rg-yovbxnaxdk3j77rigtheo.png"><br><br>  The answer to my message about the vulnerability on this site, except for the person on duty ‚Äúwill be transmitted‚Äù, was not there, it was quietly corrected and did not even say ‚ÄúThank you‚Äù. <br><br>  <b>4. Access to customer transactions in payment terminals</b> <br><br>  Knowing the mobile phone number of the client of Oschadbank, one can get access to the operations performed by them in the payment terminals. <br><br>  In the terminal menu (there will be no photo) to enter your personal account you need to enter a mobile phone number. <br><br>  In PrivatBank and the terminals of other payment companies, after entering the phone number, a one-time code is sent to it, which must be entered for authorization, or authorization takes place in a different way. <br><br>  In Oschadbank, there is no authorization - you simply enter a phone number and get access to the saved payments assigned to this client's phone number. <br><br>  I have something else to say about the terminals.  In principle, the next problem with the terminals is similar to the one I described in the article <a href="https://habrahabr.ru/post/264089/">‚Äú5 clicks on the terminal screen - and any folder opens‚Äù</a> . <br><br>  <b>5. Full access to the management of the payment terminal</b> <br><br>  In one of the payment terminals of Oschadbank, I somehow opened the desktop. <br><br>  Not only could one go through the folders of the system disk and configure almost any Windows parameters (although this is, of course, another problem), it is also in the folder with the straightforward name ‚ÄúCustomer‚Äù on the C drive: there are operations logs in this terminal extension "jrn" (and in fact - plain text). <br><br><div class="spoiler">  <b class="spoiler_title">Pictures in poor quality</b> <div class="spoiler_text"><img src="https://habrastorage.org/webt/1h/ob/pa/1hobpahomq8foftltashapirzpa.png"><br><br><img src="https://habrastorage.org/webt/op/t9/gv/opt9gvxhoz1leuijwbicljzyjhu.png"><br><br><img src="https://habrastorage.org/webt/1w/hv/er/1whverqu5o6tv7ft0vherye42ys.png"><br><br><img src="https://habrastorage.org/webt/xl/2h/yq/xl2hyqvqghgpg5u7r0vthacxbiu.png"><br></div></div><br>  Files are created every day and contain the following information: what operations were carried out in this terminal, how much money was deposited to replenish the card, how much to replenish the mobile (with the full phone number), how much and when the terminal was collected, which bills and etc ... <br><br>  By the way, log files of client operations could be changed and deleted.  I reported to the bank about the problem in the terminal, but I don‚Äôt know how it ended (as can be seen from the preceding paragraphs, the bank does not consider it necessary to inform customers about the solution of their requests). <br><br><hr><br>  Bug bounty, thanks, at least just a feedback?  No, not heard. <br><br>  So it goes. </div><p>Source: <a href="https://habr.com/ru/post/341252/">https://habr.com/ru/post/341252/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../341240/index.html">Transformer - new neural network architecture for working with strings</a></li>
<li><a href="../341242/index.html">When virtual reality goes too far</a></li>
<li><a href="../341244/index.html">Digital events in Moscow from October 30 to November 5</a></li>
<li><a href="../341246/index.html">On November 18‚Äì19, 2017 in Moscow in the co-working center "Atmosphere" the first in Russia Legal Tech Hackathon will be held</a></li>
<li><a href="../341250/index.html">About toilet paper, DevOps and 582 banks</a></li>
<li><a href="../341254/index.html">What does software development have in common with board game development?</a></li>
<li><a href="../341256/index.html">Splunk Discovery Day 2017 in Moscow. How did everything go‚Ä¶</a></li>
<li><a href="../341260/index.html">For each webinar: learn about new HPE products and solutions</a></li>
<li><a href="../341262/index.html">The task of the page in three columns, one of them in a hundred pixels</a></li>
<li><a href="../341264/index.html">Keyword "mutable" in C ++</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>