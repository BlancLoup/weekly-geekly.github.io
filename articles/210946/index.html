<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Analyzing traffic sources to increase conversion</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This article will discuss how to correctly analyze traffic sources, for example, using Google Analytics tools or Yandex Metrica. Turning off sources w...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Analyzing traffic sources to increase conversion</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/e08/ef9/e09/e08ef9e0993f1920fc5f15bba99e1e2c.jpg" alt="Google Analytics is a powerful traffic analysis tool." align="left">  This article will discuss how to correctly analyze traffic sources, for example, using Google Analytics tools or Yandex Metrica.  Turning off sources with low or zero conversion, you can significantly increase the overall conversion, reduce the cost of the order and improve the profitability of online advertising. <br><br>  The purpose of this article is to get feedback and comments on the methods described below, to describe ways to make informed decisions about blocking poor quality traffic sources. <br><a name="habracut"></a><br>  So, suppose that we decided to organize our own small business selling, for example, books, via the Internet.  We have created a wonderful user-friendly website, having entered it is simply impossible not to buy something.  Googling reviews, we chose one of the many ad networks as a source of low-cost traffic for our store.  As a rule, all ad networks do not have their own traffic, but buy it from various sources.  The quality of traffic from different sources can be extremely diverse.  On some sources there may be the most blatant cheat, from which no conversion will not have to wait.  From other sources, there are random clicks, not target transitions.  On third sources, the audience is interested in seeds and bits, not books.  On the fourth sources, on the contrary, lovers of books are concentrated, for which our resource will be just a godsend, and the conversion will exceed all expectations. <br><br>  Usually, all developed ad networks provide access to their sources through UTM markup and provide an opportunity to block sources that we don‚Äôt like.  We can only learn to correctly find those poor-quality sources, without shutting down which we will throw our money away, or even go bankrupt.  In addition, competent optimization of sources will allow us to reduce advertising costs, we will be able to lower the price of the goods and become much more competitive in the market. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      I would like to emphasize that the sources in this article do not mean channels, such as Google AdWords, Yandex Direct or teaser ads, but sources (platforms) within the channel itself.  For example, we chose some kind of advertising network from which we buy traffic.  This network provides us with traffic from hundreds of independent sources and the challenge is to understand which sources are not suitable for our project.  You can, of course, compare the channels with one another in this way, but they are usually not so many and can be dealt with manually. <br><br>  We had to repeatedly come across a poorly substantiated approach to the analysis of sources, which is called "by eye".  In one of the variations of this method, sources that simply do not give any conversion are turned off, for example, from 100 visits (this number pretends to be in the mind).  Or, for example, this number of visits give a conversion below 0.1% (the number also pretends to be in the mind).  In fact, these are the right approaches, except for ‚Äúthinking about the mind‚Äù, which can lead to different mistakes.  Particularly acute is the situation when one has to bear personal responsibility for the decisions made.  In this case, it is very important to be able to justify why these sources were blocked, and those were not.  ‚ÄúIt seemed‚Äù here would be extremely inappropriate.  This article will describe how to justify these values ‚Äã‚Äãand minimize the risks of turning off a completely good source. <br><br>  To begin with, we should determine the permissible errors.  The statistics consider the <a href="http://ru.wikipedia.org/wiki/%25D0%259E%25D1%2588%25D0%25B8%25D0%25B1%25D0%25BA%25D0%25B8_%25D0%25BF%25D0%25B5%25D1%2580%25D0%25B2%25D0%25BE%25D0%25B3%25D0%25BE_%25D0%25B8_%25D0%25B2%25D1%2582%25D0%25BE%25D1%2580%25D0%25BE%25D0%25B3%25D0%25BE_%25D1%2580%25D0%25BE%25D0%25B4%25D0%25B0">error of the first kind and the error of the second kind</a> . <br><br>  In our case, the error of the first kind is when, due to accidental circumstances, we do not turn off the bad source.  For us, a mistake of this kind is not critical: they did not block today - we block tomorrow, when random circumstances blow in the right direction. <br><br>  More critical for us is the error of the second kind.  In our case, this is the moment when, due to accidents, we will block a good source.  This is critical because after blocking the traffic from it will stop, and it will no longer have a chance to prove that it was actually good. <br><br>  The probability of such an error B is usually chosen 5% or 1% depending on the situation.  If the situation is critical, advertising does not pay off, serious amounts go, then you can arm yourself with the probability of blocking a good source of 5% or even 10%.  If the situation is stable, but just want to optimize the sources, it is better to choose 1% to minimize the loss of good sources.  The level of permissible errors of 1% will require us to significantly more traffic for statistics than the level of 5%. <br><br>  I would like to note that if we chose an error level, for example, 5%, this does not mean at all that we will lose 5% of good sources.  This means that in case of boundary (and unlikely) situations, we will lose no more than 5% of good sources from those that we block. <br><br>  The next step is to determine the critical level of conversion Ccr - traffic with a conversion, below which we are not ready to buy.  Sources with a conversion below this value will be disabled.  But sources with a conversion above this value should in no case be turned off (or rather, the probability of turning off such sources should not be higher than acceptable B).  If we are engaged in source optimization, we can select Ccr as 30% of the current average conversion value. <br><br>  Once we have decided on the basic values, we can run ads and observe the situation in Analytics or in the Metric.  In order to collect statistics, you need to lay under a certain budget. <br><br>  The first method of detecting low-quality sources is especially effective at the first stage - this is the identification of sources that have not brought a single conversion, but have already collected a sufficient number of visits.  Calculate the threshold number of visits, above which it is already possible to block sources (if they did not bring any conversion). <br><br>  Suppose that some source has that critical level of Ccr conversion.  Then the probability that the order will not occur during the visit will be 1-Ccr.  And the probability that no order will occur at N visits will be <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1e0/e95/37e/1e0e9537e256261144fe3089ae9f2f82.jpg" alt="(1-Ccr) ^ N"><br><br>  We equate this probability to the admissible level of error probability B, which we determined at the very beginning.  Then, at the critical value Ncr, we just get this value. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3da/d66/084/3dad66084abc572e6cac9a24c9c969c5.jpg" alt="B = (1-Ccr) ^ Ncr"><br><br>  To find Ncr, we need to log both parts of the expression and, in fact, find Ncr <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e50/cec/f2b/e50cecf2b104a0ca9b9929cb3ad3575e.jpg" alt="Ncr = ln (B) / ln (1-Ccr)">  (one) <br><br>  Instead of the natural logarithm, you can also use binary or decimal in calculations, if that is easier.  So, having determined the critical value of the number of visits to Ncr, we can safely turn off all sources that have exceeded this number of visits and have not given a single conversion, and there is no need to worry - the risk that we turn off a good source is nothing more than that asked yourself. <br><br>  By turning off substandard sources in the first way and feeling the joy of improving the envelope and the bitterness of reducing traffic volumes, we can move on to the second, more complex (computationally) way of finding substandard sources. <br><br>  Suppose that some sources significantly exceeded the critical value of Ncr, brought orders, but their conversion seems low to us.  We cannot block them by the first method, but, perhaps, their true conversion (which we do not know) is still lower than the critical one we have established for ourselves.  Let's try to find such sources with acceptable risks B. <br><br>  We cannot block sources only because their conversion is lower than Ccr, since  sources with a conversion higher than Ccr may accidentally show such a conversion.  To eliminate this, we must block sources whose conversion is slightly lower than Ccr and must be less than some boundary value Cx.  By changing the value of Cx, we will be able to ensure that the probability of blocking sources whose conversion is higher than Ccr will not be higher than what we specified B. Let us try to calculate this boundary value Cx. <br><br>  The number of orders on a fixed sample with a fixed conversion (and we just have these conditions) will obey the <a href="http://ru.wikipedia.org/wiki/%25D0%2591%25D0%25B8%25D0%25BD%25D0%25BE%25D0%25BC%25D0%25B8%25D0%25B0%25D0%25BB%25D1%258C%25D0%25BD%25D0%25BE%25D0%25B5_%25D1%2580%25D0%25B0%25D1%2581%25D0%25BF%25D1%2580%25D0%25B5%25D0%25B4%25D0%25B5%25D0%25BB%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5">binomial distribution</a> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/83a/5de/b2a/83a5deb2aa53b06f6c886fea791f0577.jpg"><br><br>  As is well known, with significant n (number of visits), the binomial distribution tends to normal with the expectation m = n * p and the variance D = s ^ 2 = n * p * q (p, in our case, this is conversion, and q = 1- p). <br><br>  Suppose that some source has a critical Ccr conversion value.  Then the probability of the fact that at n visits it will show a conversion of Cx or less is equal to: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e23/a85/aa9/e23a85aa9683970af8a4a06d60def3ad.jpg" alt="K = F ((x-m) / s) = F ((n * Cx-n * Ccr) / sqrt (n * Ccr * (1-Ccr))"><br><br>  According to the tables of the normal distribution or using the <a href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.norm.html">numpy</a> package in python, we find the corresponding quantile K - such values ‚Äã‚Äãof the normal function for which the probabilities correspond to the permissible errors B: <br><pre><code class="python hljs">&gt;&gt;&gt;<span class="hljs-keyword"><span class="hljs-keyword">from</span></span> scipy.stats <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> norm &gt;&gt;&gt; norm.ppf(<span class="hljs-number"><span class="hljs-number">0.05</span></span>) <span class="hljs-number"><span class="hljs-number">-1.6448536269514729</span></span> &gt;&gt;&gt; norm.ppf(<span class="hljs-number"><span class="hljs-number">0.01</span></span>) <span class="hljs-number"><span class="hljs-number">-2.3263478740408408</span></span></code> </pre> <br><br>  Then we get: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a44/bf2/9e8/a44bf29e80a5983a14701d5bdd51bc7e.jpg" alt="(n * Cx-n * Ccr) / sqrt (n * Ccr * (1-Ccr)) = K"><br><br>  From <br><br><img src="https://habrastorage.org/getpro/habr/post_images/55d/c08/3f4/55dc083f4f3833a653a0a161c49fad66.jpg" alt="Cx = Ccr + K * sqrt (Ccr * (1-Ccr) / n)">  (2) <br><br>  Thus, if the current conversion of the source with the corresponding number of visits is below the boundary Cx, then the source must be blocked. <br>  If n is small, then Cx may turn out negative.  This means that this number of visits is not enough to assess the sources.  From the formula it is clear that with an increase in the number of visits, n x will tend to Ccr from below, which is logically expected. <br><br>  It‚Äôs very difficult to calculate Cx for each source manually, so I‚Äôll quote the source code of a simple python script that handles csv uploads from Analytics and appends a column with Cx boundaries for further analysis and search for sources to block: <br><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/env python # -*- coding: utf-8 -*- import csv import math from scipy.stats import norm #  , ,    file_in = 'in.csv' #       file_out = 'out.csv' #    !!  % ,       Ccr = 1.0 #  -     (      ) B = 0.05 # ,      (  - 1) column_source = 1 # ,      column_n = 2 # ,       column_c = 4 K = norm.ppf(B) Ccr = float(Ccr) / 100 #          ,   0, : column_source -=1 column_n -=1 column_c -=1 out_data = [] with open(file_in, 'rb') as csvfile: reader = csv.reader(csvfile, delimiter=',') for i, row in enumerate(reader): # ,       if not i: out_data.append([row[column_source], row[column_n], row[column_c], 'Cx, %']) continue n = row[column_n] n = n.replace(' ', '') n = int(n) C = row[column_c] #    -      , #   ,      C.replace('%', '') C.replace(',', '.') Cx = Ccr + K * math.sqrt(Ccr * (1 - Ccr) / n) Cx = round(Cx * 100, 3) out_data.append([row[column_source], str(n), C, str(Cx)]) with open(file_out, 'wb') as csvfile: writer = csv.writer(csvfile, delimiter=',', quoting=csv.QUOTE_MINIMAL) for row in out_data: writer.writerow(row)</span></span></code> </pre><br><br>  Consider the following simple example of source analysis.  Suppose we have 8 sources with such data: <br><table><tbody><tr><th>  A source </th><th>  Visits </th><th>  Orders </th><th>  Conversion,% </th></tr><tr><td>  one </td><td>  844 </td><td>  3 </td><td>  0.355 </td></tr><tr><td>  2 </td><td>  751 </td><td>  47 </td><td>  6.258 </td></tr><tr><td>  3 </td><td>  520 </td><td>  one </td><td>  0.192 </td></tr><tr><td>  four </td><td>  397 </td><td>  40 </td><td>  10.076 </td></tr><tr><td>  five </td><td>  315 </td><td>  0 </td><td>  0 </td></tr><tr><td>  6 </td><td>  301 </td><td>  0 </td><td>  0 </td></tr><tr><td>  7 </td><td>  162 </td><td>  eight </td><td>  4.938 </td></tr><tr><td>  eight </td><td>  12 </td><td>  0 </td><td>  0 </td></tr></tbody></table><br><br>  Perhaps the example looks somewhat artificial, because here and ‚Äúby eye‚Äù you can see where something needs to be blocked.  This is so because, firstly, there are few of them here, and secondly, their properties are pronounced.  In practice, the mass of boundary cases, when even the most experienced "eye" will necessarily make the wrong decision. <br><br>  So, the total conversion of this system = m = The sum of all orders / The sum of all visits = 2.998% <br><br>  Choose a critical value as 0.3 * m = 1% <br><br>  According to the formula (1) we calculate the threshold value, which can be used to separate sources with zero conversion. <br><br>  Ncr = ln (0.05) / ln (1-0.01) = 298 <br><br>  Now we are looking for sources whose conversion is 0 and the number of visits is more than 298. We have 2 such sources: 5 and 6. We block them by the first sign. <br><br>  We cannot disable source 8 on this basis, because, despite the fact that there is a conversion of 0, there were very few visitors, and we cannot be sure that its true conversion is actually below the critical one.  Perhaps, in fact, its conversion is even higher than that of source 7, despite the fact that it shows very good results. <br><br>  We now turn to the second sign. <br><br>  Calculate the boundary value of the conversion for the first source by the formula (2): <br>  Cx = 0.01 + (-1.64) * sqrt (0.01 * (1-0.01) / 844) = 0.00438 = 0.438% <br><br>  Thus, the current conversion of this source is below the boundary, and we can, with an error probability of no more than 5%, state that the conversion of this source is below the critical one.  Thus, this source is subject to blocking. <br><br>  In order not to manually count the remaining 7 conversions, I use the script above.  Save the original data in the file in.csv.  Carefully review and configure the variables at the beginning of the script, run calc.py and see the results in out.csv, which will show us the following result: <br><br><table><tbody><tr><th>  A source </th><th>  Visits </th><th>  Conversion,% </th><th>  Cx,% </th></tr><tr><td>  one </td><td>  844 </td><td>  0.355 </td><td>  0.437 </td></tr><tr><td>  2 </td><td>  751 </td><td>  6.258 </td><td>  0.403 </td></tr><tr><td>  3 </td><td>  520 </td><td>  0.192 </td><td>  0.282 </td></tr><tr><td>  four </td><td>  397 </td><td>  10.076 </td><td>  0.179 </td></tr><tr><td>  five </td><td>  315 </td><td>  0 </td><td>  0.078 </td></tr><tr><td>  6 </td><td>  301 </td><td>  0 </td><td>  0.057 </td></tr><tr><td>  7 </td><td>  162 </td><td>  4.938 </td><td>  -0.286 </td></tr><tr><td>  eight </td><td>  12 </td><td>  0 </td><td>  -3.724 </td></tr></tbody></table><br><br>  Comparing the current and boundary conversions, we can see that source 3 is also subject to blocking. <br><br>  It is also interesting to note that sources 5 and 6 again fall under blocking.  This is understandable, since method 2 does not contradict method 1, but extends it in case the current conversion of the source is not 0. <br><br>  Boundary conversion of sources 7 and 8 below zero.  This means that with the number of visits that those sources currently have, they cannot be blocked for any number of orders (well, except for negative orders).  Their number of visits is not enough to make any predictions with an acceptable probability of error. <br><br>  This is how we can provide a mathematical justification for our decisions on blocking sources.  It should be noted, of course, that for successfully blocking sources with an error probability no higher than a given one, a sufficiently high number of visitors from the source being analyzed is needed.  For example, if cr is set to 0.38%, then turning off this source due to the absence of an envelope will require at least 787 transitions.  And, for example, for the boundary conversion of Cx = 0.119 with the same values, about 1500 visits from this source are required.  But the visits are not analyzed in one day, sometimes even a month, so only recently launched advertising campaigns can expect such difficulties.  In addition, there are ways to significantly improve the sensitivity, but this topic is probably another article. <br><br>  I would appreciate an indication of errors and inaccuracies.  Successful advertising campaigns! </div><p>Source: <a href="https://habr.com/ru/post/210946/">https://habr.com/ru/post/210946/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../210932/index.html">ODR - On-Demand Routing</a></li>
<li><a href="../210934/index.html">Data migration between different e-commerce engines</a></li>
<li><a href="../210936/index.html">Is it necessary to make a client a friend, and a friend a client?</a></li>
<li><a href="../210938/index.html">Dislocker Or find a common language with BitLocker in Linux Mint</a></li>
<li><a href="../210942/index.html">How I invent a method of simulating annealing</a></li>
<li><a href="../210948/index.html">Critical analysis of the games of the genre "hidden objects"</a></li>
<li><a href="../210950/index.html">Stresstest Apache and Nginx on EC2 MicroInstance</a></li>
<li><a href="../210952/index.html">Two stories about vulnerabilities in Google services</a></li>
<li><a href="../210954/index.html">Game developers troll creators Candy Crush</a></li>
<li><a href="../210956/index.html">Octodon: What should be a comfortable keyboard for smartphones</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>