<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>AzaMath - Number Systems (including custom) + arbitrary precision arithmetic in PHP</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="There was recently a problem associated with the conversion between different positional number systems. 

 As a real use, services are usually used t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>AzaMath - Number Systems (including custom) + arbitrary precision arithmetic in PHP</h1><div class="post__text post__text-html js-mediator-article">  There was recently a problem associated with the conversion between different positional number systems. <br><br>  As a real use, services are usually used to shorten URLs that use base36 / base62 systems or, for example, storing large numbers of huge numbers in the same base62 to save memory. <br><br>  Searching among the existing solutions, I realized that none of them suits, and therefore, I decided to prepare a <nobr>library component</nobr> for various mathematical tasks in the framework. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      It <b><a href="https://github.com/Anizoptera/Math">turned out AzaMath</a></b> - a library for converting between number systems (including custom ones) + convenient arbitrary precision arithmetic. <br><a name="habracut"></a><br>  Supports <nobr>PSR-0</nobr> , easily put <a href="https://packagist.org/packages/aza/math">through the composer</a> , 100% code coverage tests. <br><br><h3>  Number systems </h3><br>  The main task of the library, at the moment, is to transfer small, large and huge numbers from one positional number system to another.  Support for standard systems with a base from 2 to 62, inclusive, as well as support for positional systems with its own alphabet (although all ASCII characters).  Negative numbers and fractions are also desirable. <br><br>  To begin with an analysis of alternative implementations that can be used. <br><br><blockquote><h5>  Option 1 - Special functions (decbin, bindec, decoct, ...) </h5><br>  Six PHP functions for converting between the most common number systems (10, 2, 8, 16). <br><table><tbody><tr><th width="360">  pros </th><th width="360">  Minuses </th></tr><tr><td><ul><li>  Quickest way </li></ul><br></td><td><ul><li>  Platform-dependent format of a negative number.  Without using the '-' sign.  It does not fit because we can have numbers of any size. </li><li>  The maximum number supported is constant PHP_INT_MAX </li><li>  Fractions are not supported. </li><li>  Ignores incorrect characters in the original number, but only when converting to a decimal number.  In the opposite direction is no longer working. </li><li>  Limited number systems </li></ul><br></td></tr></tbody></table><br><h5>  Option 2 - base_convert </h5><br>  Standard PHP function, for converting between number systems from 2 to 36 inclusive. <br><table><tbody><tr><th width="360">  pros </th><th width="360">  Minuses </th></tr><tr><td><ul><li>  Ignore invalid characters in source </li></ul><br></td><td><ul><li>  Negative numbers are not supported. </li><li>  The maximum supported number is equal to the constant PHP_INT_MAX + 1 </li><li>  Fractions are not supported. </li><li>  Limited number systems </li><li>  40‚Äì70% slower than special functions </li></ul><br></td></tr></tbody></table><br><h5>  Option 3 - GMP (gmp_strval (gmp_init ($ number, $ x), $ y)) </h5><br>  In the presence of <acronym>GMP</acronym> extensions, you can use functions to change the number system from there.  Systems from 2 to 62 and from -2 to -36 are supported (normal systems 2‚Äì36, only at the output of a letter in upper case). <br><table><tbody><tr><th width="360">  pros </th><th width="360">  Minuses </th></tr><tr><td><ul><li>  Negative numbers are supported normally. </li><li>  No limit on the size of the number </li><li>  All standard number systems are supported (2‚Äì62) </li></ul><br></td><td><ul><li>  Fractions are not supported. </li><li>  Conversion error with incorrect characters in the original number </li><li>  70‚Äì90% slower, base_convert </li><li>  70‚Äì215% slower than special functions </li></ul><br></td></tr></tbody></table></blockquote>  Its own conversion option was implemented completely independently of third-party extensions and without intermediate conversion into decimal systems, which allowed it to be as fast as possible in PHP (this is slow :) - about 6000% slower than the GMP implementation.  Therefore, if possible, a faster implementation is always used.  It is also highly recommended to install the <a href="http://php.net/gmp">GMP</a> extension, if you suddenly need a lot and regularly convert numbers.  Negative numbers are fully supported. <br><br>  The library includes, as an example, three non-standard number systems: base32 and base64 with alphabets of known coding systems according to the <a href="http://tools.ietf.org/html/rfc4648">RFC4648</a> standard, and also base64url from the same standard - base64 with a safe alphabet for use in the URL.  Note that this is a conversion of numbers, not arbitrary strings, so the result of base64 will be completely different from the result of <a href="http://php.net/base64_encode">base64_encode</a> . <br><br>  Alas, the support of fractions has not finished yet - it was not possible to do it quickly enough and had to be postponed.  Perhaps I will do it later, or if <nobr>someone</nobr> needs it, I will gladly accept a <nobr>pull request</nobr> with this feature. <br><br><h4>  Examples of using </h4><br><pre><code class="php hljs">$res = NumeralSystem::convert(<span class="hljs-string"><span class="hljs-string">'WIKIPEDIA'</span></span>, <span class="hljs-number"><span class="hljs-number">36</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $res . PHP_EOL; <span class="hljs-comment"><span class="hljs-comment">// 91730738691298 $res = NumeralSystem::convert('9173073869129891730738691298', 10, 16); echo $res . PHP_EOL; // 1da3c9f2dd3133d4ed04bce2 $res = NumeralSystem::convertTo('9173073869129891730738691298', 62); echo $res . PHP_EOL; // BvepB3yk4UBFhGew $res = NumeralSystem::convertFrom('BvepB3yk4UBFhGew', 62); echo $res . PHP_EOL; // 9173073869129891730738691298</span></span></code> </pre> <br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//    c  . //       . //   ASCII . $alphabet = '!@#$%^&amp;*()_+=-'; //  base14 $name = 'StrangeSystem'; NumeralSystem::setSystem($name, $alphabet); $number = '9999'; $res = NumeralSystem::convertTo($number, $name); echo $res . PHP_EOL; // $)!$ $res = NumeralSystem::convertFrom($res, $name); echo $res . PHP_EOL; // 9999</span></span></code> </pre><br><br><h3>  Arithmetic of arbitrary precision </h3><br>  Handling over large numbers is done as a convenient wrapper over the <a href="http://php.net/gmp">BCMath</a> extension.  In the initial state, <acronym>BCMath is</acronym> not very convenient for real use.  Just filling the result with zeros to the specified precision (1234.2130000000 ...) is worth something. <br><br>  All basic arithmetic operations are supported, as well as exponentiation, square root, division residue, bit shift, rounding, comparisons, and some other operations. <br><br>  All numbers inside are represented as strings, but int / float types are accepted as input.  In tests, it quickly became clear how much accuracy is lost with the float data type.  In addition, the exponential notation (12e26, <nobr>12e-26</nobr> ) is not supported at all at the BCMath level.  So we had to look for the possibility of preserving the maximum available accuracy, so all the floating-point numbers at the input are processed by a special algorithm, keeping as accurate as possible. <br><br><h4>  Examples of using </h4><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//        - 20 (  100) $number = new BigNumber('118059162071741130342591466421', 20); //  $number-&gt;divide(12345678910); echo $number . PHP_EOL; // 9562792207086578954.49764831288650451382 //          //    : // 1) HALF_UP -      *.5 ( ) // 2) HALF_DOWN -      *.5 // 3) CUT,     ,     //  ,    BigNumber::ROUND_*  //    PHP - PHP_ROUND_HALF_UP, PHP_ROUND_HALF_DOWN $number-&gt;divide(9876543210)-&gt;round(3, PHP_ROUND_HALF_DOWN); echo $number . PHP_EOL; // 968232710.955</span></span></code> </pre><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//   $number = new BigNumber(10); echo ($number-&gt;compareTo(20) &lt; 0) . PHP_EOL; // 1 echo $number-&gt;isLessThan(20) . PHP_EOL; // 1 $number = new BigNumber(20); echo ($number-&gt;compareTo(10) &gt; 0) . PHP_EOL; // 1 echo $number-&gt;isGreaterThan(10) . PHP_EOL; // 1 $number = new BigNumber(20); echo ($number-&gt;compareTo(20) === 0) . PHP_EOL; // 1 echo $number-&gt;isLessThanOrEqualTo(20) . PHP_EOL; // 1</span></span></code> </pre><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//  .     . $number = new BigNumber("9,223 372`036'854,775.808000"); echo $number . PHP_EOL; // 9223372036854775.808</span></span></code> </pre><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//       62-   $number = new BigNumber('9223372036854775807'); $number = $number-&gt;pow(2)-&gt;convertToBase(62); echo $number . PHP_EOL; // 1wlVYJaWMuw53lV7Cg98qn</span></span></code> </pre><br><br><h3>  Links </h3><br><ul><li>  <a href="https://github.com/Anizoptera/Math">AzaMath Library on GitHub</a> </li><li>  <a href="https://packagist.org/packages/aza/math">Composer aza / math package</a> </li><li>  <a href="https://travis-ci.org/Anizoptera/Math">The results of the last build on Travis CI</a> </li></ul><br>  <b>UPD:</b> <br>  A small library update has been released - a wrapper for the most primitive arithmetic operations only on integers of any size that can work without additional extensions (the native implementation uses BCMath or GMP if present). <br>  We now write about our new developments and updates of open components <a href="http://azagroup.ru/">on our blog AzaGroup.ru</a> . </div><p>Source: <a href="https://habr.com/ru/post/168935/">https://habr.com/ru/post/168935/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../168925/index.html">The popularity of Android 4.x is growing</a></li>
<li><a href="../168927/index.html">Star Wars and Network Technologies</a></li>
<li><a href="../168929/index.html">Bike: Promises in Node.js</a></li>
<li><a href="../168931/index.html">Ultrahydrophobic coating</a></li>
<li><a href="../168933/index.html">Video on configuring VPS on Linode</a></li>
<li><a href="../168937/index.html">Astronauts who are much cooler than any action movie hero</a></li>
<li><a href="../168939/index.html">Motivation methods in the altruistic team</a></li>
<li><a href="../168949/index.html">Pseudocode in Russian</a></li>
<li><a href="../168951/index.html">Boost Property Tree and its XML parser</a></li>
<li><a href="../168957/index.html">Idea of ‚Äã‚Äãa book with augmented reality</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>