<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Unit tests, BDD and the power of fluid statements (fluent assertions) in 1C</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A bit of history 
 Thanks to the cool uncle Kent Beck (Kent Beck) a wonderful methodology for test-driven development was born. Despite the unusual ap...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Unit tests, BDD and the power of fluid statements (fluent assertions) in 1C</h1><div class="post__text post__text-html js-mediator-article"><h4>  A bit of history </h4><br>  Thanks to the cool uncle Kent Beck (Kent Beck) a wonderful methodology for test-driven development was born.  Despite the unusual approach that turns the usual process of writing code upside down (a test for functionality is created before implementation), we can already say that development through testing has become the de facto standard.  Practically in any vacancies there is a requirement for knowledge and experience of using the TDD methodology and the corresponding tools.  Why, it would seem, the methodology breaking the habitual paradigm of thinking has taken root and standardized?  Because ‚ÄúLife is too short for manual testing‚Äù, and sometimes it‚Äôs just impossible to write auto-tests on existing code, because the code written in the usual paradigm is completely dough-unfit. <br><br>  It should be noted that during its existence, the methodology has managed to acquire a fork in the form of BDD.  Dan North in his article ( <a href="http://dannorth.net/introducing-bdd/">Introducing BDD</a> ) pointed out the difficulties of introducing TDD among developers and offered a practice called ‚Äúbehavioral-driven development‚Äù to solve these problems.  The main feature of BDD can be called a mix of TDD and DDD, which was initially expressed in the correct naming of test methods (the names of test methods should be sentences).  The apogee of BDD, for the time being, can be considered the birth of the Gherkin language and the tools that use it (Cucumber, RSpec, etc.). <br><a name="habracut"></a><br><h4>  What do I lead and what have 1C? </h4><br>  In the world of 1C TDD is just beginning to gain popularity.  I have not yet seen 1C developer jobs with the requirement of knowledge of TDD.  We have to admit that a significant obstacle is the lack of tools for writing tests to the code in the 1C platform core. <br>  So what do we currently have to develop through testing in the world of 1C? <br><ul><li>  <a href="https://github.com/xDrivenDevelopment/xUnitFor1C">xUnitFor1C</a> - quite a mature project, allowing you to develop in the style of TDD. </li><li>  <a href="https://github.com/silverbulleters/vanessa-behavoir">Vanessa-behavoir</a> - specifications in the Gherkin language, etc., so far not in the release state. </li></ul><br>  And now the question that should arise in any self-respecting member of society: "How can I personally help ... (in my case - the world of 1C development to switch to advanced methodologies)?". <br><br>  Before answering this question, I want to touch on the topic of well-written statements in tests.  Statements denote the expected behavior of our code.  One look at the statements should be enough to understand what kind of behavior the test is trying to convey to us.  Unfortunately, the classic statements do not allow this to be achieved.  Often we have to take a long time to read and decipher the idea of ‚Äã‚Äãthe author of the test. <br>  Fortunately, recently there has been a trend towards the use of fluid interfaces (fluent interface), which has a very positive effect on the visibility and intuitive clarity of the code.  The toolkit for testing also did not stay aside. Fluid statements, also called BDD statements, appeared.  They make it possible to formulate statements in a more natural, comfortable and expressive manner. <br>  I first encountered a similar approach in NUnit in the constraint <a href="http://www.nunit.org/index.php%3Fp%3DconstraintModel%26r%3D2.6.4">-based</a> assertion model ( <a href="http://www.nunit.org/index.php%3Fp%3DconstraintModel%26r%3D2.6.4">Constraint-Based Assert Model</a> ). <br>  Much later, I met a bunch of <a href="http://mochajs.org/">mocha.js</a> + <a href="http://chaijs.com/api/bdd/">chai.js</a> , which caused my utter delight. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      So, my answer to the question ‚ÄúHow can I personally help the world of 1C development go to advanced methodologies?‚Äù - flowing statements ... for starters. <br><br><h4>  Development of fluid statements for the 1C platform </h4><br>  As a real developer through testing, I started development with a test.  The first test method contained only 1 line: <br><br><pre><code class="1c hljs">.(<span class="hljs-number"><span class="hljs-number">5</span></span>).(<span class="hljs-number"><span class="hljs-number">5</span></span>);</code> </pre> <br>  The implementation was surprisingly simple.  The variable Expect contains the object External Processing (hereinafter the object-assertions), this object has export methods: <br><ul><li>  What (Checked Value) - saves the value being checked in the context of the assertion object; </li><li>  Equals (Expected) - checks for equality a previously saved value with the transmitted expected value.  In case of inequality, an exception is thrown with a description of the assertion error. </li></ul><br>  Each method returns the same assertion object. <br><br>  The next step is the signature of the method that has been extended by the optional Message parameter, which makes the exceptions thrown by the assertions more informative. <br><br>  Further, I thought about what to do with the statement of No Equal.  Should there be such a statement?  In classical statements it is, almost every statement has its own antipode (Equal / Equal, Filled / Uncompleted, etc.).  But not in flowing statements!  Thus was born the test number 2: <br><br><pre> <code class="1c hljs">.(<span class="hljs-number"><span class="hljs-number">5</span></span>).<span class="hljs-keyword"><span class="hljs-keyword"></span></span>.(<span class="hljs-number"><span class="hljs-number">7</span></span>);</code> </pre><br>  It looks beautiful, but not realizable in 1C.  Another attempt: <br><br><pre> <code class="1c hljs">.(<span class="hljs-number"><span class="hljs-number">5</span></span>).<span class="hljs-keyword"><span class="hljs-keyword"></span></span>().(<span class="hljs-number"><span class="hljs-number">7</span></span>);</code> </pre><br>  Still beautiful and seemingly realizable.  All you need to do is to flag the negation flag in the context of the assertion object, and then check any subsequent statement along the chain, taking into account this flag.  In fact, I needed XOR, in 1C it looks like this: <br><br><pre> <code class="1c hljs"> =  &lt;&gt; ;</code> </pre><br>  But the platform refused to compile the object with the He () method.  The fact is that a <i>Not</i> - reserved word, a restriction on its use extends including.  and in the name of the method.  Brainstorming with colleagues did not allow to get around this problem beautifully, so the final version with denial looks like this: <br><br><pre> <code class="1c hljs">.(<span class="hljs-number"><span class="hljs-number">5</span></span>)._().(<span class="hljs-number"><span class="hljs-number">7</span></span>);</code> </pre><br>  If someone offers the best solution to this problem, I will be very grateful.  The option of replacing Russian letters in the Latin alphabet does not offer! <br><br><h4>  As a result, the next API was born </h4><br>  <i>What (Checked Value, Message = "")</i> - saves, in the context of external processing, the checked value and the additional message for exceptions thrown by assertions. <br><br>  <i>He_ ()</i> - denies any statement following the chain. <br><br>  <i>This is Truth ()</i> - claims that the value being verified is the Truth. <br><br>  <i>ThisFlash ()</i> - claims that the value being tested is False. <br><br>  <i>Equal to (Expected)</i> - states that the value being tested is equal to the expected value. <br><br>  <i>Greater (Lower Value)</i> - states that the value being verified is greater than the value passed to the statement. <br><br>  <i>Greater Or Equal (Lower Or Equal Value) / Minimum (Minimum</i> Value <i>)</i> - states that the value to be checked is greater than or equal to the value passed to the statement. <br><br>  <i>Less Or. Equal (Greater. Or Equal Value) / Maximum (Maximum</i> Value <i>)</i> - states that the value to be checked is less than or equal to the value passed to the statement. <br><br>  <i>Less (Greater Value)</i> - states that the value being verified is less than the value passed to the statement. <br><br>  <i>Filled ()</i> - states that the value being tested is different from the default value of the same type. <br><br>  <i>There is ()</i> - states that the value being tested is not Null and not Undefined. <br><br>  <i>This is Undefined ()</i> - states that the value being tested is Undefined. <br><br>  <i>This is Null ()</i> - states that the value being tested is Null. <br><br>  <i>Has Type (Type)</i> - states that the type or name of the type passed to the assertion has the checked value. <br><br>  <i>Between (Initial</i> Value <i>, End</i> Value <i>)</i> - states that the value being tested is between the values ‚Äã‚Äãpassed to the assertion. <br><br>  <i>Contains (Seeker)</i> - asserts that the value being checked contains the passed in assertion.  Used for strings and collections. <br><br>  <i>Has Length (Expected Length)</i> - states that the value being tested has the length passed to the statement.  Used for strings and collections. <br><br><h4>  Examples of using </h4><br><pre> <code class="1c hljs">.(<span class="hljs-number"><span class="hljs-number">1</span></span> &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>).(); .(<span class="hljs-number"><span class="hljs-number">13</span></span> = <span class="hljs-number"><span class="hljs-number">2</span></span>)._().(); .(<span class="hljs-number"><span class="hljs-number">5</span></span> = <span class="hljs-number"><span class="hljs-number">7</span></span>).(); .(<span class="hljs-number"><span class="hljs-number">5</span></span>).(<span class="hljs-number"><span class="hljs-number">5</span></span>); .(<span class="hljs-number"><span class="hljs-number">4</span></span>).(<span class="hljs-number"><span class="hljs-number">2</span></span>); .(<span class="hljs-number"><span class="hljs-number">7</span></span>).(<span class="hljs-number"><span class="hljs-number">7</span></span>); .(.()).(<span class="hljs-number"><span class="hljs-number">9</span></span>); .(<span class="hljs-number"><span class="hljs-number">90</span></span>).(<span class="hljs-number"><span class="hljs-number">100</span></span>); .(<span class="hljs-built_in"><span class="hljs-built_in"></span></span>()).(<span class="hljs-number"><span class="hljs-number">90</span></span>); .(<span class="hljs-number"><span class="hljs-number">55</span></span>).(<span class="hljs-number"><span class="hljs-number">56</span></span>); .(<span class="hljs-number"><span class="hljs-number">1</span></span>).(); .(<span class="hljs-keyword"><span class="hljs-keyword"></span></span> <span class="hljs-type"><span class="hljs-type"></span></span>).(); .(<span class="hljs-literal"><span class="hljs-literal"></span></span>).(); .(.).Null(); .(<span class="hljs-string"><span class="hljs-string">""</span></span>).(<span class="hljs-string"><span class="hljs-string">""</span></span>); .(<span class="hljs-number"><span class="hljs-number">7</span></span>).(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>); .(<span class="hljs-string"><span class="hljs-string">" "</span></span>).(<span class="hljs-string"><span class="hljs-string">""</span></span>); .(<span class="hljs-string"><span class="hljs-string">" "</span></span>).(<span class="hljs-number"><span class="hljs-number">12</span></span>);</code> </pre><br>  The example is a bit more complicated: <br><br><pre> <code class="1c hljs">.(<span class="hljs-string"><span class="hljs-string">" "</span></span>) .() ._().(<span class="hljs-string"><span class="hljs-string">""</span></span>) .(<span class="hljs-number"><span class="hljs-number">12</span></span>) ._().(<span class="hljs-string"><span class="hljs-string">"!!!"</span></span>);</code> </pre><br><h4>  Afterword </h4><br>  Development is available on <a href="">github</a> .  As the reader with an inquisitive mind probably noticed, the link leads to more than just a library of statements.  But this is the material for the next article. </div><p>Source: <a href="https://habr.com/ru/post/260013/">https://habr.com/ru/post/260013/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../260003/index.html">Creating native Android applications using the Intel C ++ Compiler compiler in Android Studio 1.0.1</a></li>
<li><a href="../260005/index.html">Architecture of storing photos in Badoo - an interview with the speaker of DevConf 2015</a></li>
<li><a href="../260007/index.html">Practice of using Laurent-2, Laurent-112, KBX-3D modules</a></li>
<li><a href="../260009/index.html">New Opera for Computers, Android and Windows Phone</a></li>
<li><a href="../260011/index.html">Dubsmash 2 - regular porn clicker for Android</a></li>
<li><a href="../260017/index.html">Automated xkcd-style diagram creation: from serious to funny</a></li>
<li><a href="../260019/index.html">Mobile App Distribution Services for iOS. Part 4 (final): Fabric (Crashlytics)</a></li>
<li><a href="../260021/index.html">How to check your sites for getting into the Blacklist or why the newsletter gets into spam</a></li>
<li><a href="../260023/index.html">Application Migration - Code Examples</a></li>
<li><a href="../260025/index.html">Fun starts or C ++ and STL: who is faster?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>