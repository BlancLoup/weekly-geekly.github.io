<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We play videos from YouTube using Action script 3.0</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="And yet customers are not predictable people! 

 You work on the project, you work and everything seems to be fine, but he (the customer) a week befor...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We play videos from YouTube using Action script 3.0</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/geektimes/post_images/7f5/0a8/a33/7f50a8a334e450095c577e7f5a6b252d.jpg"><br><br>  And yet customers are not predictable people! <br><br>  You work on the project, you work and everything seems to be fine, but he (the customer) a week before the project‚Äôs delivery: ‚ÄúI want the video to play on my flash-site.  Yes, not simple, but from YouTube. ‚Äù  Well, what can you do ... Nothing. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <i>For clarification, I will say that the site is made in Flash CS4 using Action Script 3.0.</i> <br><br>  However, the problem, as it turned out not easy.  And as always I had to get out. <br><br><a name="habracut"></a><br><br><h4>  Thanks for the karma!  Transferred an article to the Adobe Flex blog. </h4><br><br><h4>  Where to begin: </h4><br><br>  Search for articles on the topic of interest?  And what pleases any, but the trouble is, as the author himself says, this method no longer works, and the promised update of the article is not yet available.  Task‚Ä¶ <br><br>  You can, of course, download the entire player, but since it is written in Action Script 2, you can forget about controlling playback.  And even such a simple action as scaling a video becomes, unbearably, challenging.  And so this method also disappears. <br><br>  What to do?  To work, to work and to work again "And yes you will be rewarded for your labors."  And so I write the decision in steps: <br><br>  <b>First step.</b>  We take out the YouTube player from the browser's cache (in my case, the FireFox browser is about: cache). <br><br>  <b>The second step.</b>  We look at the player code with the help of special programs (there are many of them, I use Sothink SWF Decompiler). <br><br>  <b>The third step.</b>  We are looking for in numerous classes the information we need, namely where and how we can take a direct link to the video.  From this <a href="http://habrahabr.ru/blogs/flex/42094">article,</a> we know that in order to get a direct link to a video, we need to know two things: the video identification number (video_id) and a certain video identifier (the t parameter).  With video_id, everything is simple, it is in the video request line <a href="http://www.youtube.com/watch%3Fv%3DlIZVEnyHoGU">http://www.youtube.com/watch?v=lIZVEnyHoGU</a> and is called ‚Äúv‚Äù.  And here is where to get the ‚Äút‚Äù, and here we are helped by the player that we parsed into parts from which we learn that there is a certain request to the server with the ID of the video, in which we get information about it.  The request is as follows <a href="http://youtube.com/get_video_info.php%3Fvideo_id%3DlIZVEnyHoGU">http://youtube.com/get_video_info.php?video_id=lIZVEnyHoGU</a> .  If you insert this link in the browser line, then you will be prompted to download a file called ‚Äúget_video_info.php‚Äù.  Download and view the contents of the file.  The file contains a line with variables of the form "status = ok &amp; vq = None &amp; author = guylevy ..., etc.".  So, of the whole variety of variables, we need one, it is called ‚Äútoken‚Äù - in fact, this is the same ‚Äút‚Äù network that we were looking for. <br><br>  <b>Step Four.</b>  We have achieved what we wanted - we received a direct link to the video and now, if we add up everything received together <a href="http://www.youtube.com/get_video.php%3Fvideo_id%3DlIZVEnyHoGU%26t%3D%2520vjVQa1PpcFNnve5gW7h8B51Da_gr8T6BHzSFMbwf6Dw%253D">http://www.youtube.com/pt_pdf_pdf.pdf.pdf.pcfvn_fc_flc_vc_v4_fb_gr8T6BHzSFMbwf6gW7h8B51Da_gr8T6BHzSFMbwf66W7h8B51Da_gr8T6BHzSFMbwf66WWH4B51Da_gr8T6BHzSFMbwf66WWH4B51Da_gr8T6BHzSFMbwf6.</a> flv-movie with the name "video.flv", which in turn can either download or play in your player. <br><br>  And so for the third step, we need to download as a text file ‚Äúget_video_info.php‚Äù and extract from it the information we need.  This was helped by the ‚ÄúURL.as‚Äù class, which I found on one of the forums, it helps me to get almost any information from the url, and after my refinement I also encode and decode the url with coded dots, dashes, ins and so on. d. <br>  The whole process of getting a direct link, I implemented in the class "YouTubeVideoPlayer.as" <br><br>  Also, using the article about <a href="http://flake.habrahabr.ru/blog/68608/">10 tricks for working with YouTube</a> in the class ‚ÄúYouTubeVideoPlayer.as‚Äù, you can set the quality of the video received, provided that it exists. <br><br>  Actually, these two classes that will ‚Äúsave the world‚Äù :) <br><br>  <b><i>(The code above is written for use in Flex)</i></b> <br><br> <code><a href="http://www.youtube.com/watch%3Fv%3DlIZVEnyHoGU"></a> <a href="http://www.youtube.com/watch%3Fv%3DlIZVEnyHoGU"></a> <a href="http://www.youtube.com/watch%3Fv%3DlIZVEnyHoGU"></a> package com <br> { <br> import flash.events.Event; <br> import flash.net.URLLoader; <br> import flash.net.URLRequest; <br> <br> import mx.controls.VideoDisplay; <br> import mx.events.VideoEvent; <br> <br> import com.URL; <br> <br> /** <br> *  YouTubeVideoPlayer. <br> * @author Aslanyan Tsolak Rubikovich <br> * @version 1.0 <br> */ <br> <br> public class YouTubeVideoPlayer extends VideoDisplay <br> { <br> private static var GET_VIDEO :String = "http://www.youtube.com/get_video.php"; <br> private static var GET_VIDEO_INFO :String = "http://youtube.com/get_video_info.php"; <br> private static var URL_PREFIX :String = "http://youtube.com?"; <br> private static var QUALITY0 :String = ""; <br> private static var QUALITY1 :String = "&amp;fmt=18"; <br> private static var QUALITY2 :String = "&amp;fmt=22"; <br> private static var QUALITY3 :String = "&amp;ap=%2526fmt%3D18"; <br> private static var QUALITY4 :String = "&amp;ap=%2526fmt%3D22"; <br> <br> private var videoID :String; <br> private var videoToken :String; <br> private var videoQuality :String; <br> private var InfoLoader :URLLoader; <br> <br> /** <br> * . <br> * @params source:     www.youtube.com/watch?v=lIZVEnyHoGU <br> * @params quality:    [0,1,2,3,4] <br> * @return void <br> */ <br> <br> public function YouTubeVideoPlayer(source:String, quality:Number):void <br> { <br> super(); <br> <br> videoQuality = DefineQuality(quality); <br> <br> LoadVideoInfo(source); <br> } <br> <br> /** <br> *    . <br> * @params quality:    [0,1,2,3,4] <br> * @return     <br> */ <br> <br> private function DefineQuality(quality:Number):String <br> { <br> switch(quality) <br> { <br> case 0: return QUALITY0; break; <br> case 1: return QUALITY1; break; <br> case 2: return QUALITY2; break; <br> case 3: return QUALITY3; break; <br> case 4: return QUALITY4; break; <br> } <br> <br> return QUALITY0; <br> } <br> <br> /** <br> *     . <br> * @params source:     www.youtube.com/watch?v=lIZVEnyHoGU <br> * @return void <br> */ <br> <br> private function LoadVideoInfo(source:String):void <br> { <br> videoID = GetVideoID(source); <br> <br> var urlRequest :URLRequest = new URLRequest(GET_VIDEO_INFO + "?video_id=" + videoID); <br> <br> InfoLoader = new URLLoader(); <br> InfoLoader.addEventListener(Event.COMPLETE, OnInfoLoaderComplete); <br> InfoLoader.load(urlRequest); <br> } <br> <br> /** <br> *   source VideoID. <br> * @params source:     www.youtube.com/watch?v=lIZVEnyHoGU <br> * @return VideoID <br> */ <br> <br> private function GetVideoID(source:String):String <br> { <br> var _url:URL = new URL(source); <br> <br> return _url.query.parsed.v; <br> } <br> <br> /** <br> *    get_video_info.php. <br> * @return void <br> */ <br> <br> private function OnInfoLoaderComplete(e:Event):void <br> { <br> InfoLoader.removeEventListener(Event.COMPLETE, OnInfoLoaderComplete); <br> <br> var str:String = URL_PREFIX + "?" + e.target.data.toString(); <br> <br> videoToken = GetVideoToken(str); <br> <br> var fullVideoUrl:String = FlvUrlConstruct(videoID, videoToken); <br> <br> InitVideoDisplay(fullVideoUrl); <br> } <br> <br> /** <br> *   source videoToken. <br> * @params source:      get_video_info.php. <br> * @return videoToken <br> */ <br> <br> private function GetVideoToken(source:String):String <br> { <br> var _url:URL = new URL(source); <br> <br> return _url.query.parsed.token; <br> } <br> <br> /** <br> *   URL  . <br> * @params video_id: id . <br> * @params token: id   . <br> * @return videoToken <br> */ <br> <br> private function FlvUrlConstruct(video_id:String, token:String):String <br> { <br> var fullUrl:String = GET_VIDEO + "?video_id=" + video_id + "&amp;t=" + token + videoQuality; <br> <br> return fullUrl; <br> } <br> <br> /** <br> *  VideoDisplay. <br> * @params source:   . <br> * @return void <br> */ <br> <br> private function InitVideoDisplay(source:String):void <br> { <br> this.autoPlay = true; //    <br> this.source = source; //    <br> this.width = 500; //  <br> this.height = 281.25; //  <br> this.autoRewind = true; //     <br> this.maintainAspectRatio = true; //    <br> this.playheadUpdateInterval = 100; //   VideoEvent.PLAYHEAD_UPDATE <br> this.bufferTime = 5; //    <br> <br> this.addEventListener(VideoEvent.STATE_CHANGE, StateChange); <br> } <br> <br> private function StateChange(e:VideoEvent):void <br> { <br> trace(e.state) <br> } <br> } <br> }</code> <br> <br><h4>  and one more class </h4><br> <code><a href="http://manfred.dschini.org/"></a> <a href="http://user/"></a> package com <br> { <br> /** <br> * Dschini.org - Manfred Weber <br> * manfred.dschini.org <br> * manfred.weber (at) gmail dot com <br> * Updated Tsolak Aslanyan <br> * version 1.1 <br> */ <br> <br> public class URL <br> { <br> private static const PATTERN:RegExp = /^([A-Za-z0-9_+.]{1,8}:\/\/)?([!-~]+@)?([^\/?#:]*)(:[0-9]*)?(\/[^?#]*)?(\?[^#]*)?(\#.*)?/i; <br> <br> private var _url :String; <br> private var _scheme :String; <br> private var _userinfo :String; <br> private var _host :String; <br> private var _port :String; <br> private var _path :String; <br> private var _query :String; <br> private var _fragment :String; <br> <br> /** <br> * Create new URL Object <br> * @params The url <br> */ <br> <br> function URL(url:String):void <br> { <br> var result:Array = url.match(URL.PATTERN); <br> <br> _url = result[0]; // user:pass@example.com:80/foo/bar.php?var1=foo&amp;var2=bar#abc <br> _scheme = result[1]; // http:// <br> _userinfo = result[2]; // user:pass@ <br> _host = result[3]; // example.com <br> _port = result[4]; // :80 <br> _path = result[5]; // /foo/bar.php <br> _query = result[6]; // ?var1=foo&amp;var2=bar <br> _fragment = result[7]; // #abc <br> } <br> <br> /** <br> * Get the url <br> */ <br> <br> public function get url():String <br> { <br> return _url.length &lt;= 0 ? undefined : _url; <br> } <br> <br> /** <br> * Get the scheme <br> */ <br> <br> public function get scheme():String <br> { <br> return _scheme.length &lt;= 0 ? undefined : _scheme.substring(0 , _scheme.length - 3); <br> } <br> <br> /** <br> * Get the userinfo <br> * Returns an object containing the user and/or password <br> */ <br> <br> public function get userinfo():Object <br> { <br> var ret:Object = {user:undefined, pass:undefined}; <br> <br> if(_userinfo) <br> { <br> var arr:Array = _userinfo.substring(0, _userinfo.length - 1).split(':'); <br> <br> ret.user = arr[0] ? arr[0] : ret.user; <br> ret.pass = arr[1] ? arr[1] : ret.pas; <br> } <br> <br> return ret; <br> } <br> <br> /** <br> * Get the host <br> */ <br> <br> public function get host():String <br> { <br> return _host.length &lt;= 0 ? undefined : _host; <br> } <br> <br> /** <br> * Get the port <br> */ <br> <br> public function get port():int <br> { <br> return _port.length &lt;= 0 ? undefined : int(_port.substring(1, _port.length)); <br> } <br> <br> /** <br> * Get the path <br> */ <br> <br> public function get path():String <br> { <br> return _path.length &lt;= 0 ? undefined : _path; <br> } <br> <br> /** <br> * Get the query <br> * Returns an object containing the raw and parsed query string <br> */ <br> <br> public function get query():Object <br> { <br> var ret:Object = {raw:undefined, parsed:undefined}; <br> <br> if(_query &amp;&amp; _query.length &gt; 0) <br> { <br> ret.raw = _query; <br> <br> var _parse :String = _query.substring(1, _query.length); <br> var _intovars :Array = _parse.split("&amp;"); <br> <br> ret.parsed = _intovars.length &gt; 0 ? {} : undefined; <br> <br> for(var i:int = 0; i &lt; _intovars.length; i++) <br> { <br> var _kv:Array = _intovars[i].split("="); <br> <br> ret.parsed[_kv[0]] = _kv[1]; <br> } <br> } <br> return ret; <br> } <br> <br> /** <br> * Get the fragment <br> */ <br> <br> public function get fragment():String <br> { <br> return _fragment.length &lt;= 0 ? undefined : _fragment; <br> } <br> <br> /** <br> * Accepts an encoded string. <br> * Returns the decoded string. <br> */ <br> <br> public function Unescape(value:String):String <br> { <br> return unescape(value); <br> } <br> <br> /** <br> * Accepts an decoded string. <br> * Returns the encoded string. <br> */ <br> <br> public function Escape(value:String):String <br> { <br> return escape(value); <br> } <br> } <br> } <br></code> <br><br><h4>  Here is an example of using classes in Flex Builder: </h4><br><br> <code>&lt;?xml version="1.0" encoding="utf-8"?&gt; <br> &lt;mx:Application xmlns:mx="http://www.adobe.com/2006/mxml" layout="absolute"&gt; <br> <br> &lt;mx:Script&gt;&lt;![CDATA[ <br> <br> import com.YouTubeVideoPlayer; <br> <br> private var vp:YouTubeVideoPlayer; <br> <br> private function GetVideo():void <br> { <br> if(vp != null) <br> { <br> vp.stop(); <br> vp.close(); <br> removeChild(vp); <br> } <br> <br> var vp:YouTubeVideoPlayer = new YouTubeVideoPlayer(utUrl.text, 1); <br> vp.x = 119; <br> vp.y = 38; <br> addChild(vp); <br> } <br> ]]&gt;&lt;/mx:Script&gt; <br> <br> &lt;mx:Label x="10" y="12" text="  "/&gt; <br> &lt;mx:TextInput id="utUrl" x="119" y="10" width="600" text="http://www.youtube.com/watch?v=lIZVEnyHoGU"/&gt; <br> &lt;mx:Button x="727" y="10" label="" click="GetVideo()"/&gt; <br> <br> &lt;/mx:Application&gt; <br></code> <br><br>  I hope this article will help someone, or at least will seem interesting. <br><br>  <strong>PS</strong> <br>  <strong>Thank you so much <a href="http://ayurganov.habrahabr.ru/">ayurganov</a> for an invite !!!</strong> <br><br>  <s><strong>Pps</strong></s> <br>  <s>No karma to transfer the topic: (</s> <br><br></div><p>Source: <a href="https://habr.com/ru/post/69537/">https://habr.com/ru/post/69537/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../69529/index.html">Slightly late congratulations on the day of the programmer from the leader of the Yabloko party</a></li>
<li><a href="../69530/index.html">Javascript: Good code style is usually</a></li>
<li><a href="../69531/index.html">Postal pigeons: still faster than ADSL</a></li>
<li><a href="../69532/index.html">Setting the maximum file size upload via HTML form</a></li>
<li><a href="../69536/index.html">What metrics do you collect for projects?</a></li>
<li><a href="../69539/index.html">How to make money free</a></li>
<li><a href="../69540/index.html">"Reactive websites". The first version of the manuscript</a></li>
<li><a href="../69542/index.html">Distortion effect on violin</a></li>
<li><a href="../69543/index.html">Ready for the cloud? 74% of techies use 3 or more computers</a></li>
<li><a href="../69544/index.html">Haiku R1 / Alpha 1</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>