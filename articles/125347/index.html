<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ABBYY FlexiCapture Engine 9.0: How to embed DataCapture technology into an application (programmer's view)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Not so long ago, my colleagues told Habr's readers about the new version of the product for developers ABBYY FlexiCapture Engine 9.0, which allows our...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>ABBYY FlexiCapture Engine 9.0: How to embed DataCapture technology into an application (programmer's view)</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage1/2408680b/5cca6962/5b5ccf92/cde7bb9f.png" align="left">  Not so long ago, my colleagues <a href="http://habrahabr.ru/company/abbyy/blog/118089/">told</a> Habr's readers about the new version of the product for developers ABBYY FlexiCapture Engine 9.0, which allows our users to embed technology to extract data from images into their software solutions. <br><br>  In the above article, we talked about what this technology is and what it allows us to do, praised by the new API and examples.  In this article I would like to complete the picture and show how the work with the product looks from the programmer's point of view: to give an opportunity to ‚Äútouch‚Äù the API and talk about some ‚Äúgoodies‚Äù that make it easy and natural to integrate our product into most types of applications (desktop, server, cloud, etc.). <a name="habracut"></a><br><br>  We start with the basic scenario of extracting data from images using FlexiCapture Engine 9.0 (this scenario is well suited for a simple desktop application), and then we can discuss what can be changed in this scenario to adapt it to the requirements of the application being developed. <br>  In promotional materials it looks like this: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/storage1/3486d306/bf2f1d60/94ee5531/9e796850.png"><br><br>  In the code it looks like this (read the comments): <blockquote><pre> <code class="hljs vhdl"><code> [C#] //  FCEngine    IEngineLoader engineLoader = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FCEngine.InprocLoader(); IEngine engine = engineLoader.Load( serialNumber, <span class="hljs-string"><span class="hljs-string">""</span></span> ); //            IFlexiCaptureProcessor processor = engine.CreateFlexiCaptureProcessor(); processor.AddDocumentDefinitionFile( sampleFolder + <span class="hljs-string"><span class="hljs-string">"Invoice_eng.fcdot"</span></span> ); //         processor.AddImageFile( sampleFolder + <span class="hljs-string"><span class="hljs-string">"Invoices_1.tif"</span></span> ); processor.AddImageFile( sampleFolder + <span class="hljs-string"><span class="hljs-string">"Invoices_2.tif"</span></span> ); //      (    )   IDocument document = processor.RecognizeNextDocument(); <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span>( document != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> ); //     <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span>( document.DocumentDefinition != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> ); //       <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span>( document.Pages.Count == <span class="hljs-number"><span class="hljs-number">2</span></span> ); //       //         <span class="hljs-built_in"><span class="hljs-built_in">string</span></span> invoiceNumber = documents.Sections[<span class="hljs-number"><span class="hljs-number">0</span></span>].Fields[<span class="hljs-number"><span class="hljs-number">0</span></span>].Value.AsString; //      ...</code></code> </pre> </blockquote>  Now we will describe in more detail the individual steps of this scenario, roughly corresponding to the commented pieces in the code: <br><br><h4>  Download FlexiCapture Engine </h4><br><img src="https://habrastorage.org/storage1/12a13e0d/43c162ef/810eac36/61386f4b.png" align="right">  The loading of the Engine object corresponds to the loading and initialization of executable modules and, as a rule, is performed once at the start or at the first use. <br><br>  There are several download options.  You can load Engine directly into the main process, as in the above example, which is convenient for simple desktop applications.  It is also possible to increase Engine reliability in a separate workflow, which is recommended for server solutions.  When loaded into a separate process, it is possible to control the priority and lifetime of this process.  You can also create a pool of workflows, in which Engine-safe thread-safe instances run in parallel and completely independently of each other and periodically recycle.  (The examples include a ready implementation of such a pool.) <br><br>  Further use of the Engine is practically independent of the boot method, so the same code can be reused, and the boot method can be an easily implemented option. <br><br><h4>  Creating and configuring the processor </h4><br><img src="https://habrastorage.org/storage1/29aff413/2843cb13/246b8101/1273fcdf.png" align="right">  The FlexiCaptureProcessor is a lightweight configurable handler that receives images as input and converts them into documents with output data.  The number of such objects in one process is limited only by available resources.  Processors can be created each time before use or cached (in this case we save on the loading time of document definitions). <br><br>  To work, the processor requires you to specify a set of <i>document definitions</i> .  Document definitions can be loaded ready-made from files on disk, as in the example, or from a stream of bytes in memory, which allows you to store these objects in arbitrary storage (application resources, databases, shared network storage, etc.).  You can also create document definitions on the fly from scratch, either on the basis of a ‚Äúflexible‚Äù or ‚Äúhard‚Äù geometric markup description.  (As a rule, it is recommended to use ready-made templates created and debugged using FlexiCapture visual tools. Software creation or modification of definitions may be required, for example, to simplify maintenance when you need to work with families of similar forms whose geometry changes from year to year. and the semantics of the data is more or less preserved). <br><br>  Using processors, it is possible to organize multilevel processing, when one processor at the input performs the primary classification of documents according to some simple features and gives the result to one of the more specialized processors, which already determine the exact type of the document and retrieves data.  This approach can improve productivity when working with a large number of different types of documents.  In addition, specialized processors can work in parallel, further increasing the throughput of the entire solution. <br><br><h4>  Input Images </h4><br><img src="https://habrastorage.org/storage1/6e0f3897/15cc672d/ded9c523/44b90274.png" align="right">  For processing the processor input is a sequence of images.  In the simplest case, these may simply be links to files, as in the above example ‚Äî in this case, the links are added to the processor's internal queue.  You can also create a <i>custom queue (source) of images</i> and attach it to the input of the processor. <br><br>  A user queue on demand can provide the processor with links to image files, in-memory streams corresponding to these files, or downloaded images (in the internal format of the FlexiCapture Engine).  The latter option also allows you to implement arbitrary image preprocessing by the user before transferring them to the processor (using built-in tools or custom algorithms).  Also in the user queue, you can arrange to wait until the next image becomes available (more on this later). <br><br>  In some cases, the queue interface of images can directly map objects of the target application, representing the image storage in the workflow system, the custom implementation of a ‚Äúbatch of documents‚Äù, etc.  These objects to implement their logic can privately implement this interface. <br><br><h4>  Processing cycle </h4><br><img src="https://habrastorage.org/storage1/3b37c73f/5d7f1bc4/8b9fcf12/4bd3d31d.png" align="right">  In the example given at the beginning of the article, exactly one document is recognized, which is a fairly common task.  However, in the more general case, in this place you should ‚Äútwist‚Äù the processing cycle, at each step of which the next sequence of images is selected from the queue and exactly one finished document corresponding to this sequence is issued, or an error (there is no access to the image, a broken image, etc. .). <br><br>  In conjunction with the user image queue, scrolling of the processing cycle allows you to implement a pull model of image acquisition by the processor when the processing cycle ‚Äúpumps‚Äù images from the queue and can be suspended for the next image loading time. <br><br>  One queue of images can be used from several processors working in parallel, which makes it easy to parallelize processing (at the same time, processors without idle time and ‚Äúactive waiting‚Äù simultaneously ‚Äúpumping‚Äù images from the queue as they appear, an example of the implementation of this approach can be found in the examples). <br><br><h4>  Work with results </h4><br><img src="https://habrastorage.org/storage1/ca280b42/e16e37c4/792950cb/4a492d28.png" align="right">  The processor issues documents that include a tree-like structure of nodes containing extracted data and pages with geometric markings showing where the data was found on the image. <br><br>  Data from the document can be retrieved directly and independently stored in files or in a database (including the necessary sections of images) or allowed for further processing.  You can also export data using the built-in export tools to file formats. <br><br>  You can also save the document as an intermediate result to a file or stream in memory for marshaling or further processing elsewhere and at another time.  Such further processing may be, for example, data verification using built-in verification tools. <br><br>  Built-in verification tools allow you to optimize manual verification of large amounts of data by combining data into groups.  Instead, it is often possible and convenient to verify the data programmatically (bypassing the document and programmatically checking the data on the database, dictionaries, checksums, etc.). <br><br><h4>  Custom link resolution mechanism </h4><br>  In the example discussed at the beginning of the article, we used links to document definition files and image files as paths in the file system.  The use of links is often convenient and natural, and allows you to postpone the download of the relevant objects until it becomes necessary.  Links are also easier to marshal when transferring between processes. <br><br>  Redefining the link resolution mechanism allows the user to completely rebuild the mechanism for working with links in the context of this processor to suit his needs.  The link is considered simply as some string understood by this mechanism.  This can be some url or identifier in the database or a combination of those with an indication of the protocol.  Redefining the link resolution mechanism requires only the ability to return the path to a local (temporary) file on disk or a stream of bytes in memory for this string.  Additionally, when working with links, a protocol is defined for controlling the lifetime of returned objects (so that temporary files are deleted in a timely manner, and objects from memory are unloaded). <br><br><h4>  Conclusion </h4><br>  Much of what is described in this article is covered by the examples supplied with the product.  This allows developers using our technologies to begin work with an already proven working solution and develop it to fit their needs.  Examples include such types of applications as: <br><ol><li>  Desktop applications (uses a separate processor, loaded directly into the user process, images as a list of files on disk) </li><li>  High-performance multithreaded processing server (using a pool of processing processors that take images from a shared queue) </li><li>  Web service (a pool of processing processors that parallelly process parallel client requests) </li></ol>  There is also a special example (Code Snippets), written specially by programmers for programmers and containing many ready-made short scripts for using the product in exactly the form (without translation errors :)), as it was intended by the developers and tested. <br><br>  There is an excellent reference, which describes in detail all the objects and methods and their use. <br><br>  For more information about ABBYY FlexiCapture Engine 9.0, you can read <a href="http://www.abbyy.ru/flexicapture_engine/">on the ABBYY website</a> . <br><br>  <i>Alexey Kalyuzhny</i> <i><br></i>  <i>Product Development Department</i> </div><p>Source: <a href="https://habr.com/ru/post/125347/">https://habr.com/ru/post/125347/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../125337/index.html">2GIS runs an API with data on 1,000,000 organizations and the opportunity to earn</a></li>
<li><a href="../125338/index.html">Audit "Black box"</a></li>
<li><a href="../125340/index.html">Overview of php-frontend of Zabbix monitoring system</a></li>
<li><a href="../125341/index.html">New PHP documentation translation tool: edit.php.net</a></li>
<li><a href="../125342/index.html">Which text formatting option is most convenient for you (in forums, social networks, blogs, etc.)</a></li>
<li><a href="../125348/index.html">A team of translators of PHP documentation needs help.</a></li>
<li><a href="../125349/index.html">And yet it is hacked</a></li>
<li><a href="../125350/index.html">Log Marathon First results</a></li>
<li><a href="../125352/index.html">Digest Wanted.VC # 8</a></li>
<li><a href="../125353/index.html">PasteScript based project templates</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>