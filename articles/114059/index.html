<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Porting games from the real world to Android</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It all started as if in a real detective story: the New Year holidays, December 31, the parental home for many kilometers from Moscow, and the worst t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Porting games from the real world to Android</h1><div class="post__text post__text-html js-mediator-article">  It all started as if in a real detective story: the New Year holidays, December 31, the parental home for many kilometers from Moscow, and the worst thing is the complete absence of the Internet and 2x2 channel.  The brain can work in two modes - either consume the content, or create it.  It so happened that my brain started working in the second mode at that moment.  By coincidence, I came across a long-forgotten puzzle game "Pythagoras": <br><br><img src="https://habrastorage.org/storage/1e4dbb6c/0142e01a/20632cea/f8520d1a.jpg"><br><br>  And I decided to "digitize" it. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br><br>  Pythagoras puzzle consists of 7 geometric figures, which must be folded in such a way as to obtain the shape indicated in the task.  When solving a task, you must use all 7 puzzle figures. <br><br>  <u><b>Choosing a platform.</b></u> <br><br>  Well, in the appendage of everything, I have long wanted to write something under the "mobile phone". <br><br>  Since Eclipse was on the laptop with the necessary Pribluda for Android, and there were several books about him, downloaded "in reserve", the choice was predetermined. <br><br>  So, it is decided: we will write the Pythagoras toy for Android.  I also note that I am not a programmer, in my understanding of the word. <br><br>  <u><b>Implementation of the idea</b></u> <br><br>  I will not describe how to install and configure Eclipse and how to create a project, because about this, and so much has been written, finally go to the essence of the story. <br><br>  Create a project named Pifagor. <br>  After creation we will have a file with the name Pifagor.java and the contents: <br><br><pre><code class="hljs scala"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> <span class="hljs-type"><span class="hljs-type">Pifagor</span></span>.android.game; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.app.<span class="hljs-type"><span class="hljs-type">Activity</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.<span class="hljs-type"><span class="hljs-type">Bundle</span></span>; public <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Pifagor</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Activity</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** Called when the activity is first created. */</span></span> <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> public void onCreate(<span class="hljs-type"><span class="hljs-type">Bundle</span></span> savedInstanceState) { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState); setContentView(<span class="hljs-type"><span class="hljs-type">R</span></span>.layout.main); pifagorView = (<span class="hljs-type"><span class="hljs-type">PifagorView</span></span>) findViewById(<span class="hljs-type"><span class="hljs-type">R</span></span>.id.game); } }</code> </pre> <br><br>  A start. <br>  Now we will create the file PifagorDraw.java in which our game will be implemented.  We define the class PifagorDraw which is a child of the class Thread.  For our class, we define the methods for handling events on the screen, reset the game to the initial state, and override the run method: <br><br><pre> <code class="hljs markdown">package Pifagor.android.game; import android.content.Context; import android.graphics.Bitmap; import android.graphics.Canvas; import android.graphics.Color; import android.graphics.Paint; import android.graphics.Paint.Style; import android.view.MotionEvent; import android.view.SurfaceHolder; public class PifagorDraw extends Thread { private SurfaceHolder appScreen; private boolean appRunning; //    private boolean appPaused; //    private Paint appPaint; // private Bitmap clearScreen; //     private PifagorPuzzle Puzzles[<span class="hljs-string"></span><span class="hljs-string"></span>]; //   private int activePuzzle; //    private long thisTime; //        private long downTime; //        private PifagorTask Tasks[<span class="hljs-string"></span><span class="hljs-string"></span>]; //   private PifagorTask ResetPiktogram; //     private int activeTask; //    private int maxTasks; //    private boolean prevButton, nextButton, resetButton; //    //   //   private int PuzzleTemplate1[<span class="hljs-string"></span><span class="hljs-string"></span>][<span class="hljs-symbol"></span><span class="hljs-symbol"></span>][<span class="hljs-string"></span><span class="hljs-string"></span>] = {......}; //   private int PuzzleTemplate2[<span class="hljs-string"></span><span class="hljs-string"></span>][<span class="hljs-symbol"></span><span class="hljs-symbol"></span>][<span class="hljs-string"></span><span class="hljs-string"></span>] = {......}; //   private int PuzzleTemplate3[<span class="hljs-string"></span><span class="hljs-string"></span>][<span class="hljs-symbol"></span><span class="hljs-symbol"></span>][<span class="hljs-string"></span><span class="hljs-string"></span>] = {......}; //   private int PuzzleTemplate4[<span class="hljs-string"></span><span class="hljs-string"></span>][<span class="hljs-symbol"></span><span class="hljs-symbol"></span>][<span class="hljs-string"></span><span class="hljs-string"></span>] = {......}; //   private int PuzzleTemplate5[<span class="hljs-string"></span><span class="hljs-string"></span>][<span class="hljs-symbol"></span><span class="hljs-symbol"></span>][<span class="hljs-string"></span><span class="hljs-string"></span>] = {......}; //   "" private int Pikto1[<span class="hljs-string"></span><span class="hljs-string"></span>][<span class="hljs-symbol"></span><span class="hljs-symbol"></span>] = {......}; //   private int Task1[<span class="hljs-string"></span><span class="hljs-string"></span>][<span class="hljs-symbol"></span><span class="hljs-symbol"></span>] = {......}; private int Task2[<span class="hljs-string"></span><span class="hljs-string"></span>][<span class="hljs-symbol"></span><span class="hljs-symbol"></span>] = {......}; private int Task3[<span class="hljs-string"></span><span class="hljs-string"></span>][<span class="hljs-symbol"></span><span class="hljs-symbol"></span>] = {......}; private int Task4[][] = {......}; //  public PifagorDraw(SurfaceHolder surfaceHolder, Context context) { //     appScreen = surfaceHolder; appRunning = false; appPaused = false; activePuzzle = 0; thisTime = 0; downTime = 0; prevButton = false; nextButton = false; resetButton = false; //   appPaint = new Paint(); appPaint.setColor(Color.BLUE); appPaint.setStrokeWidth(2); appPaint.setStyle(Style.STROKE); //      clearScreen = Bitmap.createBitmap(screenWidth, screenHeight, Bitmap.Config.RGB<span class="hljs-emphasis"><span class="hljs-emphasis">_565); //      Puzzles = new PifagorPuzzle[7]; Puzzles[0] = new PifagorPuzzle(......); Puzzles[1] = new PifagorPuzzle(......); Puzzles[2] = new PifagorPuzzle(......); Puzzles[3] = new PifagorPuzzle(......); Puzzles[4] = new PifagorPuzzle(......); Puzzles[5] = new PifagorPuzzle(......); Puzzles[6] = new PifagorPuzzle(......); PuzzlesReset(); //      maxTasks = 4; activeTask = 0; Tasks = new PifagorTask[maxTasks]; Tasks[0] = new PifagorTask(......); Tasks[1] = new PifagorTask(......); Tasks[2] = new PifagorTask(......); Tasks[3] = new PifagorTask(......); //    ResetPiktogram = new PifagorTask(......); } //     public void setRunning(boolean status) { appRunning = status; } //     public boolean Touch(MotionEvent event) { int mouseX = (int)event.getX(); int mouseY = (int)event.getY(); switch(event.getAction()) { case MotionEvent.ACTION_</span></span>MOVE: //   ...... break; case MotionEvent.ACTION<span class="hljs-emphasis"><span class="hljs-emphasis">_DOWN: //   ...... break; case MotionEvent.ACTION_</span></span>UP: //   ...... break; } return true; //  true,       } //        public void PuzzlesReset() { ...... } @Override public void run() { while(appRunning) { if (!appPaused) { Canvas canvas = null; try { canvas = appScreen.lockCanvas(); synchronized(appScreen) { //         // : //   canvas.drawBitmap(clearScreen, 0, 0, null); //    for(int i=0;i<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">7;i++)</span></span></span></span><span class="xml"><span class="hljs-tag"> { </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">Puzzles</span></span></span></span><span class="xml"><span class="hljs-tag">[</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">i</span></span></span></span><span class="xml"><span class="hljs-tag">]</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">.Update</span></span></span></span><span class="xml"><span class="hljs-tag">(); </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">Puzzles</span></span></span></span><span class="xml"><span class="hljs-tag">[</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">i</span></span></span></span><span class="xml"><span class="hljs-tag">]</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">.Draw</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">canvas</span></span></span></span><span class="xml"><span class="hljs-tag">); } </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">......</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">sleep</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">20</span></span></span></span><span class="xml"><span class="hljs-tag">); } } </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">catch</span></span></span></span><span class="xml"><span class="hljs-tag"> (</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">Exception</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">e</span></span></span></span><span class="xml"><span class="hljs-tag">) { } </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">finally</span></span></span></span><span class="xml"><span class="hljs-tag"> { </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">if</span></span></span></span><span class="xml"><span class="hljs-tag"> (</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">canvas</span></span></span></span><span class="xml"><span class="hljs-tag"> != </span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">null)</span></span></span></span><span class="xml"><span class="hljs-tag"> { </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">appScreen.unlockCanvasAndPost</span></span></span></span><span class="xml"><span class="hljs-tag">(</span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">canvas</span></span></span></span><span class="xml"><span class="hljs-tag">); } } } } } }</span></span></span></span></code> </pre><br><br>  I read about various ways of working with graphics on Android, but more or less figured out with one, and I will use it. <br><br>  Now create a file in the project with the name PifagorView.java.  In this file, we declare the PifagorView class, which is a child of the SurfaceView class, and add the inheritance of the SurfaceHolder.Callback interface - this class will be the link. <br>  In the created class, we need to override the three methods inherited from SurfaceView to respond to changes in the View state, as well as one method to handle screen events (click, drag, drop): <br><br><pre> <code class="hljs pgsql">package Pifagor.android.game; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.Context; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.util.AttributeSet; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.<span class="hljs-keyword"><span class="hljs-keyword">view</span></span>.MotionEvent; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.<span class="hljs-keyword"><span class="hljs-keyword">view</span></span>.SurfaceHolder; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.<span class="hljs-keyword"><span class="hljs-keyword">view</span></span>.SurfaceView; <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> PifagorView extends SurfaceView implements SurfaceHolder.Callback { private SurfaceHolder appScreen; private PifagorDraw appThread; <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">boolean</span></span> surfaceCreated; //  <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> PifagorView(Context context, AttributeSet attrs) { super(context, attrs); surfaceCreated = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; appScreen = getHolder(); appScreen.addCallback(this); appThread = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> PifagorDraw(appScreen, context); setFocusable(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); } @Override <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> surfaceChanged(SurfaceHolder arg0, <span class="hljs-type"><span class="hljs-type">int</span></span> arg1, <span class="hljs-type"><span class="hljs-type">int</span></span> arg2, <span class="hljs-type"><span class="hljs-type">int</span></span> arg3) { // TODO Auto-<span class="hljs-keyword"><span class="hljs-keyword">generated</span></span> <span class="hljs-keyword"><span class="hljs-keyword">method</span></span> stub } @Override <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> surfaceCreated(SurfaceHolder holder) { appThread = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> PifagorDraw(holder, getContext(), screenWidth, screenHeight); appThread.setRunning(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); appThread.<span class="hljs-keyword"><span class="hljs-keyword">start</span></span>(); } @Override <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> surfaceDestroyed(SurfaceHolder arg0) { <span class="hljs-type"><span class="hljs-type">boolean</span></span> retry = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; appThread.setRunning(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(retry) { try { appThread.<span class="hljs-keyword"><span class="hljs-keyword">join</span></span>(); retry = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } catch (InterruptedException e){ } } } @Override <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">boolean</span></span> onTouchEvent(MotionEvent event) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> appThread.Touch(event); //           PifagorDraw,        } }</code> </pre><br><br>  Now we need to tweak the main.xml file - we have created our View object and now we need to place it on the screen: <br><br><pre> <code class="hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LinearLayout</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:orientation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"fill_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"fill_parent"</span></span></span><span class="hljs-tag"> &gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Pifagor.android.game.PifagorView</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"@+id/game"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:orientation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"vertical"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"fill_parent"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:layout_height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"fill_parent"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LinearLayout</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  Also in the project there are two more classes PifagorPuzzle, which describes the geometric figures of the puzzle, and the class PifagorTask, which describes the tasks.  We will not consider them. <br><br>  The application, in principle, can already be launched, but when the application is minimized and resumed, it will fall with a critical error. <br>  To fix this, do the following: <br><br>  First, in the PifagorView class, we will create the CreateThread and TerminateThread methods (which is clear from the name for what they will be used for), and slightly change the overridden SurfaceCreated and SurfaceDestoryed methods: <br><pre> <code class="hljs pgsql"><span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> PifagorView extends SurfaceView implements SurfaceHolder.Callback { private SurfaceHolder appScreen; private PifagorDraw appThread; <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">boolean</span></span> surfaceCreated; private <span class="hljs-type"><span class="hljs-type">int</span></span> screenWidth; private <span class="hljs-type"><span class="hljs-type">int</span></span> screenHeight; //  <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> PifagorView(Context context, AttributeSet attrs) { super(context, attrs); surfaceCreated = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; appScreen = getHolder(); appScreen.addCallback(this); appThread = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> PifagorDraw(appScreen, context, screenWidth, screenHeight); setFocusable(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); } //   <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> terminateThread() { <span class="hljs-type"><span class="hljs-type">boolean</span></span> retry = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; appThread.setRunning(<span class="hljs-keyword"><span class="hljs-keyword">false</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(retry) { try { appThread.<span class="hljs-keyword"><span class="hljs-keyword">join</span></span>(); retry = <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>; } catch (InterruptedException e){ } } } //   <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> createThread(SurfaceHolder holder) { appThread = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> PifagorDraw(holder, getContext()); appThread.setRunning(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); appThread.<span class="hljs-keyword"><span class="hljs-keyword">start</span></span>(); } @Override <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> surfaceChanged(SurfaceHolder arg0, <span class="hljs-type"><span class="hljs-type">int</span></span> arg1, <span class="hljs-type"><span class="hljs-type">int</span></span> arg2, <span class="hljs-type"><span class="hljs-type">int</span></span> arg3) { // TODO Auto-<span class="hljs-keyword"><span class="hljs-keyword">generated</span></span> <span class="hljs-keyword"><span class="hljs-keyword">method</span></span> stub } @Override <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> surfaceCreated(SurfaceHolder holder) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (surfaceCreated == <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) { createThread(holder); surfaceCreated = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } } @Override <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> surfaceDestroyed(SurfaceHolder arg0) { terminateThread(); } @Override <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">boolean</span></span> onTouchEvent(MotionEvent event) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> appThread.Touch(event); } }</code> </pre><br><br>  Second, in the Pifagor class, override the onPause and onResume methods: <br><pre> <code class="hljs scala">public <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Pifagor</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Activity</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** Called when the activity is first created. */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-type"><span class="hljs-type">PifagorView</span></span> pifagorView; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> public void onCreate(<span class="hljs-type"><span class="hljs-type">Bundle</span></span> savedInstanceState) { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState); setContentView(<span class="hljs-type"><span class="hljs-type">R</span></span>.layout.main); pifagorView = (<span class="hljs-type"><span class="hljs-type">PifagorView</span></span>) findViewById(<span class="hljs-type"><span class="hljs-type">R</span></span>.id.game); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> public void onPause() { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onPause(); pifagorView.terminateThread(); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> public void onResume() { <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onResume(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (pifagorView.surfaceCreated == <span class="hljs-literal"><span class="hljs-literal">true</span></span>) { pifagorView.createThread(pifagorView.getHolder()); } } }</code> </pre><br><br>  Thus, when the application is minimized, the game process described in the PifagorDraw class will be destroyed, and when returned to the application, it will be launched again. <br><br>  <i>I did not give full source codes, if anyone is interested, write in a personal, I will send.</i> <br><br>  Well, we start and see what happens: <br><img src="http://habrastorage.org/storage/b513f5a6/2f81650a/a57dd68a/1a631e41.png"><img src="http://habrastorage.org/storage/085e968f/c76af816/12bf868c/0356104a.png"><img src="http://habrastorage.org/storage/dbede842/2e1a40eb/62a5ca12/e2d55783.png"><br>  I did not find a designer for a toy.  If someone is willing to participate - write in a personal. <br><br>  <u><b>What's next?</b></u> <br>  The game is written, you need to do something further.  Or clean up the archive, where it will disappear or try to put in the Android Maket.  The second is much more interesting, so we register on the market.android.com/publish, register Google Checkout (it's better to register via IE, I had problems with other browsers), pay $ 25 and as usual at the very last moment we try to understand where we are again , that is, we are looking for information - how to promote applications in the Android Market.  We read the <a href="http://habrahabr.ru/blogs/android_development/112185/">article</a> and then draw up the following plan: <br><ul><li>  We publish a free demo version of the game, containing only 5 tasks </li><li>  We publish a paid version of the game, with 30 tasks </li><li>  We publish the update of the game with some modifications </li><li>  We write reviews of the game on various Internet resources. </li><li>  We publish an updated version of the game with an additional 30 tasks <br><br>  And also in parallel we compile a list of functions that I would like to add to the game. <br><br>  Since this article is the implementation of the third paragraph, I will share the results of the first two: <br>  The demo version of the game was downloaded by a little more than 200 people, about 100 active installations, which in my opinion is very good for the first application.  I also received some tips on the game. <br><br>  A week later, after the publication of the demo version, published the first edition of the paid version of the game.  The demo version was deleted - due to the fact that I lost the certificate with which I signed the application, and I could not download the update of the demo version - so be careful.  During the first 24 hours of finding the game in the market, it was bought by 2 people, moreover, both of the states, judging by the profile on google checkout.  During the week there was another sale. <br><br>  Following the plan, I finalized and laid out the updated version of the game with additional features. <br><br>  As events will develop further, I will unsubscribe later. <br><br>  <u><b>In custody...</b></u> <br>  The time spent on all this is absolutely not a pity, since I got some experience and a lot of pleasure.  So if anyone else is wondering whether or not to start, guys, do not hesitate!  Dare!  It's worth it! <br><br>  PS There are plans to port the game under Windows Phone 7 and if the fuse does not disappear, then even under iOS. </li></ul></div><p>Source: <a href="https://habr.com/ru/post/114059/">https://habr.com/ru/post/114059/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../114046/index.html">Conference "Online stores of Ukraine 2011"</a></li>
<li><a href="../114047/index.html">Aka rspec, i.e. lazy variables in tests</a></li>
<li><a href="../114053/index.html">Full review of the first smart on NVIDIA Tegra 2 - LG Optimus 2x</a></li>
<li><a href="../114054/index.html">How programmers lull children</a></li>
<li><a href="../114055/index.html">Forbes.com accused of selling links and lowered the issue of Google</a></li>
<li><a href="../114060/index.html">Why online stores do not work the way I want?</a></li>
<li><a href="../114061/index.html">Effective meetings</a></li>
<li><a href="../114062/index.html">What's next?</a></li>
<li><a href="../114063/index.html">Love and sex in search queries or "I do not want to learn, I want to marry!"</a></li>
<li><a href="../114064/index.html">Would you buy a nokia smartphone with windows phone 7?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>