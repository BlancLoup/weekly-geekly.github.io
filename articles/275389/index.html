<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Using ASF and Atmel Start in IAR</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ASF and IAR 
 The library for products Atmel ASF has two versions: built into Atmel Studio and the so-called stand-alone. Stand-alone version can be u...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Using ASF and Atmel Start in IAR</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/50f/127/c7d/50f127c7d38e427497b0ca616a092f31.png"><br><br><h4>  ASF and IAR </h4><br>  The library for products Atmel <abbr title="Atmel software framework">ASF</abbr> has two versions: built into Atmel Studio and the so-called stand-alone.  Stand-alone version can be used, for example, in IAR.  Since IAR itself is somewhat ascetic from the point of view of various autocomplete chips, the use of ASF as an external library is not as interactive and convenient as in Atmel Studio, but nevertheless, you can customize and use everything once Atmel Start - WEB configurator code for ease and speed development. <br><a name="habracut"></a><br><h4>  Configuring IAR + ASF </h4><br>  First you need to download the <a href="http://www.atmel.com/tools/avrsoftwareframework.aspx%3Ftab%3Doverview">stand-alone version of ASF</a> and unpack. <br>  Then create a new project in IAR with the necessary options.  Suppose we have a motherboard of our own production with a SAMD20G16 microcontroller. <br>  In the options of the project choose: <br>  <b>General</b> -Options-Target-Device - Atmel ATSAMD20G16 <br>  <b>General</b> -Options-Library Configuration-Use CMSIS <br>  <b>C / C ++ Compiler</b> -Preprocessor: here you need to specify the paths to the ASF files that will be used in the project. <br><div class="spoiler">  <b class="spoiler_title">If you are not going to use Atmel Start (for example, there is no internet connection)</b> <div class="spoiler_text">  The folders in the ASF itself that store the peripheral drivers, as well as the configuration files, must be copied to the project folder.  System files, such as working with interrupts, can be left in the folder with the ASF (if you are not going to change them). <br>  In order not to overload the preprocessor field and for convenience in principle, you can use the PROJ_DIR system variable to specify the path to the files in the working project folder and create your own for the path to the ASF folder. <br>  To do this: <b>Tools</b> -Configure Custom Argument Variables-Global-New Group (set the group name) ‚ÄìAdd Variable (set the variable name and path). <br>  Then the Preprocessor might look something like this (depending on the required periphery): <br>  $ PROJ_DIR $ / drivers / port <br>  $ PROJ_DIR $ / drivers / system / interrupt / system_interrupt_samd20 <br>  $ PROJ_DIR $ / drivers / system / interrupt <br>  $ PROJ_DIR $ / drivers / system / pinmux <br>  $ PROJ_DIR $ / drivers / system <br>  $ PROJ_DIR $ / drivers / nvm <br>  $ PROJ_DIR $ / drivers / extint <br>  $ PROJ_DIR $ / drivers / system / clock <br>  $ PROJ_DIR $ /. <br>  $ PROJ_DIR $ / drivers / sercom <br>  $ PROJ_DIR $ / drivers / sercom / usart <br>  $ PROJ_DIR $ / drivers / rtc <br>  $ PROJ_DIR $ / drivers / sercom / spi <br>  $ PROJ_DIR $ / drivers / sercom / spi / module_config <br>  $ PROJ_DIR $ / drivers / sercom / i2c <br>  $ PROJ_DIR $ / drivers / tc <br>  $ PROJ_DIR $ / drivers / system / clock / clock_samd20 <br>  $ ASF_DIR $ / utils <br>  $ ASF_DIR $ / utils / preprocessor <br>  $ ASF_DIR $ / utils / cmsis / samd20 / source <br>  $ ASF_DIR $ / utils / cmsis / samd20 / include / pio <br>  $ ASF_DIR $ / utils / cmsis / samd20 / include <br>  $ ASF_DIR $ / utils / header_files <br>  $ ASF_DIR $ / boards <br>  $ ASF_DIR $ / boards / samd20_xplained_pro <br>  $ ASF_DIR $ / .. / common / utils <br>  $ ASF_DIR $ / .. / common / boards <br>  $ ASF_DIR $ / utils / header_files <br>  Even in this section, you must specify defyny for the project.  In our case: <br>  Defined symbols: (one per line) <br>  ARM_MATH_CM0 = true <br>  EXTINT_CALLBACK_MODE = true <br>  __SAMD20G16__ <br>  BOARD = USER_BOARD <br>  TC_ASYNC = true <br>  USART_CALLBACK_MODE = true <br>  RTC_COUNT_ASYNC = true <br>  SPI_CALLBACK_MODE = false <br>  I2C_MASTER_CALLBACK_MODE = false <br></div></div><br>  If you are going to use Atmel Start, then the preprocessor settings are automatically generated when the project is loaded. <br>  Assembler-Preprocessor <br>  <b>Output Converter -</b> Output-Generate, Output Format: Intel Extended, Output File: Override default: file name.hex <br>  <b>Linker</b> -Config-Linker configuration file: Override default: $ PROJ_DIR $ \ samd20g16_flash.icf <br>  <b>Debugger-</b> Setup-Driver: J-Link / J-Trace <br>  All settings are made. <br>  To write the initialization functions of the controller and peripherals, use Atmel Start. <br>  Alternatively, you can see examples for both IAR and Atmel Studio, or documentation. <br><br><h4>  Use AtmelStart </h4><br>  <a href="http://start.atmel.com/">Atmel Start</a> is an online code generator. <br>  Select a board and controller and create a project: Custom Board, ATSAMD20G16 - Create new project <br>  Let's start with the clocking settings.  Suppose that our controller is clocked from an external oscillator with a frequency of 7.37 MHz and we want to have a system frequency of 48 MHz (see how to do this in Atmel Studio <a href="http://geektimes.ru/company/rainbow/blog/262158/">here</a> ). <br>  Open the <a href="http://start.atmel.com/">Go to clock configurator</a> : 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/319/b68/b97/319b68b9740047a1aeb6a8b6f9be03a4.png"><br><br>  Everything is very clear, click on the modules, enter the necessary settings, and it should turn out like this: <br><img src="https://habrastorage.org/files/283/e18/17b/283e1817b972440b9ab2338f911167d5.png"><br><br>  You also need to configure the I / O ports of the microcontroller, for this there is a <a href="http://start.atmel.com/">Pin / Mux Configurator</a> .  In this section, everything is intuitive. <br>  Of course, you need to add the necessary peripherals - Add Software Component.  For the convenience of searching, we leave only the search by driver.  We find the right one, for example, SPI, select the quantity and add it.  This can also be done on the main page by clicking on the "+" near the Drivers. <br><img src="https://habrastorage.org/files/812/542/c65/812542c65f014c18982b5407b60a4434.png"><br><br>  Now go to its settings. <br>  We specify all the parameters we need.  It turns out like this: <br><img src="https://habrastorage.org/files/017/01b/744/01701b7440c24a109492ed2759a4afa0.png"><br><br>  We do all the rest of the peripherals and everything we need.  When everything is ready, we export the project to the format we need. <br>  For this: Export Project: - Include IAR (.ipcf) file - Download Pack <br><img src="https://habrastorage.org/files/14d/9e2/6f3/14d9e26f3abb42ecbd71e9adf8a598d8.png"><br><br>  We change the extension of the archive to a simple zip and unpack it into the project folder.  In IAR: <b>Tools</b> -Options-Project-Enable Project Connections. <br>  Next <b>Project</b> -Add Project Connection - IAR Project Connection-Ok, select the file: iar-project-connection.ipcf.  Then all the settings and the files themselves in the folders appear in the project. <br><br><img src="https://habrastorage.org/files/929/0fb/c74/9290fbc74f7a4870b8fe826f9e22fda9.png"><br>  You can compile and enjoy! </div><p>Source: <a href="https://habr.com/ru/post/275389/">https://habr.com/ru/post/275389/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../275379/index.html">Dialog and Atmel have announced a merger. Comments of the official distributor in Russia</a></li>
<li><a href="../275381/index.html">Remote firmware update microcontroller</a></li>
<li><a href="../275383/index.html">Connecting the temperature sensor and iButton key reader to Queclink GV300 / GV320 trackers</a></li>
<li><a href="../275385/index.html">Atmel Launches Studio 7 Development Environment and Atmel START Web Platform - Software Configuration and Software Generation Tool</a></li>
<li><a href="../275387/index.html">Diagnostic connector OBDII: whether it is possible to ‚Äútame‚Äù</a></li>
<li><a href="../275391/index.html">We give debugging SAM4S-EK + Atmel SAM-ICE programmer for publishing on the Internet (the action is completed)</a></li>
<li><a href="../275393/index.html">Protocol watchdog and function key setting in GPS / GLONASS tracker Queclink GL300</a></li>
<li><a href="../275395/index.html">Interesting Atmel Cortex microcontroller families</a></li>
<li><a href="../275397/index.html">Every cyclist needs this device.</a></li>
<li><a href="../275399/index.html">Atmel Wireless Solutions for IoT</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>