<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Information security in the process control system: attack vector man-machine interface</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="‚ÄúAbout three decades ago, we, industrial automation specialists, faced a task for which we were poorly prepared. We began to implement an automated pr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Information security in the process control system: attack vector man-machine interface</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/59/e7/f8/59e7f8cfc467a396792019.jpeg"><br><br>  <i>‚ÄúAbout three decades ago, we, industrial automation specialists, faced a task for which we were poorly prepared.</i>  <i>We began to implement an automated process control system with the ability to graphically display the course of processes in real time.</i>  <i>However, initially the screens were empty, and we had to fill them with information. We did not have manuals in which we could read about what ‚Äúgood‚Äù graphics are.</i>  <i>We did everything we could, or rather, we knew everything ‚Äî and we knew a little.</i>  <i>The result was predictable - we created an inefficient paradigm of human-machine interfaces (HMI or English: HMI, humane machine interface), or rather, how they should look.</i>  <i>Inertia of thinking did the rest.</i>  <i>Basically, for the sake of ease of implementation, we decided to depict the processes in the form of a P &amp; ID (from the English: process &amp; instrumentation diagram), functional diagrams supplemented with numerical values.</i>  <i>We adhered to this paradigm even when the graphics capabilities of DCS / SCADA systems improved, and simply migrated the old screens to newer systems. ‚Äù</i> <i><br></i>  <i><b>Bill Hollifield, for InTech.</b></i> <br><br><h3>  Historically </h3><br>  According to research, the mistakes of operators, observing and controlling technological processes, cause about 42% of accidents.  This is due to the development of production and increased automation.  In this case, the operator, not being close to the real equipment, is not able to assess his physical condition at the present time in the current operating conditions.  Today in the modern world, this function is performed by SCADA-systems, the main component of which is the human-machine interface (HMI). <br><a name="habracut"></a><br>  Historically, HMI (man-machine interface) was understood as a dial gauge, buttons, switches, and switches. At the moment, there are still requirements, according to which the emergency shutdown button and the accident indicator lamp must be real physical objects.  Modern operator panel consists of virtual buttons, graphs, analog and digital indicators. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Abandoning physical devices is not completely possible due to compliance with safety standards.  Because it allows you to organize a physical break in the control circuit and control the situation if the virtual interface has failed. <br><br>  It is important to understand that the operator panel and human-machine interface (HMI) are not the same.  The panel is just an interface for a simplified understanding of the process technology.  Most of its modern capabilities and ‚Äúintellectual abilities‚Äù are determined by software.  Thus, the evolution of HMI is always a parallel process of development of hardware and software (software). <br><br>  As practice shows, operators and dispatchers do not participate in the process of creating a human-machine interface of SCADA-systems.  This factor affects the efficiency of the operators and the number of mistakes made by them during the process control at the facilities. <br><br>  The passive approach in the development of HMI, due to the desire of designers to create interfaces for the already used samples.  This problem is well illustrated by the fact of the use at the moment in the territory of the Russian Federation of the GOST 21480-76 ‚ÄúSystem‚Äú Man-Machine ‚Äù.  Mnemonic Schemes  General Ergonomic Requirements ‚Äù, reissued in November 1986. Obviously, over the past 30 years, radical changes have occurred in the level and volume of automation of technological processes, as well as in the capabilities of SCADA systems.  There are standards IEC 60447-93 "Man-machine interface (ICM), GOST R IEC 60447-2000" Man-machine interface.  The principles of actuation ‚Äù,‚Äù but they do not reflect the approach to optimizing HMI. <br><br>  As a result, today thousands of operators control production worth tens of billions, looking at primitive images developed at a time when they had no idea about the effectiveness of the HMI. <br><br><h3>  How to improve HMI </h3><br>  How to achieve the greatest return from a human machine interface is to provide information that is important and in the form that it is intuitively understandable.  High performance HMIs display information ‚Äî data in a specific context that makes it useful.  HMIs should not only display the values ‚Äã‚Äãof certain process variables, but also show whether these values ‚Äã‚Äãare ‚Äúgood‚Äù or ‚Äúbad‚Äù.  Abnormal indicators should stand out clearly.  Providing information in a graphical form of processes allows you to maximize the efficiency of operators.  Processes should be presented in the most informative and conducive to immediate action form. <br><br>  In 2009, the Electric Power Research Institute or EPRI conducted a large-scale study of HMI.  As a result of the study, a report was created, which was called the Operator‚Äôs Graphic Fuegle, ID 1017637. <br><br>  There was a special simulator that was used for more than 10 years.  During the test, several operators discovered and resolved critical situations, using both existing, familiar to them control screens, and new ones, organized using the principles of high-performance HMIs.  The latter have significantly improved the efficiency of operators in several important ways. <br><br>  Prior to this test, it had never occurred to anyone to develop specialized screens for such scenarios, with all the management tools necessary to complete the task.  The test results showed that the new approach to the organization of HMI is much more efficient.  Complex control systems, as a rule, have ineffective and problematic HMIs created by people without special knowledge.  Operator efficiency can be greatly improved with HMI using the right principles.  High performance HMIs are very practical, they are easy to implement, and their price is quite affordable. <br><br><h3>  Current trends and aspirations of HMI </h3><br>  No matter how modern the process control system of making key decisions is, it is always up to the person.  Convenience, reliability and functionality largely determine the success of the entire work of the process control system. <br><br>  Other requirements for automation are associated with the complexity of the process technology itself, which employs many different devices from different manufacturers.  For consumers, the ease of integrating HMI with all various devices, support for open communication protocols (most often Ethernet), as well as the possibility of transferring information to a system whiter than a high level and scalability of the presented solutions come first. <br><br>  However, there are general requirements for HMI, which are characteristic for both machine and process automation.  First, it is the ease of customization and adaptation to the needs of production.  Secondly, the ability to create your own, including dynamic, objects and replicate them.  Third, a clear and clear display of information, regardless of environmental conditions and other factors.  Finally, fourthly, the ability to quickly and accurately manage the system, regardless of its current state, environmental conditions and other factors. <br><br>  In the era of smartphones and tablets, any screen is perceived not only as an information output device, but also as an input device. <br><br>  As noted above, many of the innovative capabilities of the operator panels are associated with the evolution of software.  It is on the characteristics of the software depend on the speed of application development, configuration flexibility. <br><br>  Typically, HMI hardware does not have strong industry specificity and is determined by the availability of certificates from various classification societies, such as IEC, UL, CSA, EAC, marine BV, GL, and ATEX. <br><br>  You can also adapt HMI to industry-specific tasks by using ready-made architectures - TVDA (Technical validated documented architecture).  Thanks to TVDA, there is no need to write bulky programs, just enter the parameters for ready-made architectures. <br><br>  Significantly expand the capabilities of the software for configuring the panels by supporting the scripted programming language JavaScript, which allows you to implement almost any logic. <br><br>  One of the key trends in the HMI market in recent years is the ability to control production processes not only with fixed panels, but also with the help of mobile devices.  This function is required where there is a need to monitor remote equipment. <br><br>  The expanded version allows the technical manager or development engineer to create additional screens on his mobile device that are not associated with the operator panel screen.  With their help, you can change the settings that are not available on normal workstations. <br><br>  Also, modern operator panels can interact with the user at a distance by sending him SMS or emails. <br><br>  Industrial computers are supplied with installed Windows operating systems, SCADA systems (dispatcher control and data collection systems) for installing applications, or HMI systems or a web interface depending on the user's needs. <br><br>  HMI tools remain an integral part of an automation system, and must be easily integrated with any of its components, often with top-level systems (ERP and MES). <br><br><h3>  Vulnerability and accessibility </h3><br>  It would seem that the networks in production are usually isolated from public networks and the internal networks of the enterprise, the equipment and software in them are significantly different from conventional networks - not to mention the fact that all processes are clearly regulated and strictly controlled. <br><br>  The SCADA HMI market is very active, but often not as safe as necessary.  The largest HMI suppliers in this industry are Siemens, Advantech and GE, but there are also many smaller players in many other countries.  In some cases, a small company is bought before the release of its product patch, which makes it difficult to track the state of vulnerability in the disclosure process. <br><br>  In addition, suppliers of SCADA systems, as a rule, focus on industrial equipment, and not on the software that manages them.  Because they make a profit from the sale of equipment. <br><br>  When it comes to the actual codes that underlie SCADA systems, most do not use basic protection ‚Äî in-depth, such as address space allocation randomization (ASLR), SafeSEH, or stack cookies.  This may be due to the erroneous belief that these solutions will work in a completely isolated environment. <br>  Despite the obvious risks of unauthorized access to critical systems, the development branch of SCADA systems is aimed at producing equipment and less at software.  The lack of global standards for HMI software further exacerbates the security problems in this field. <br><br>  Information from publicly available sources, such as vulnerability knowledge bases ( <i>ICS-CERT, NVD, CVE, Siemens Product CERT, Positive Research Center, Trend Micro, Zero Day Iniciative (ZDI)</i> ), manufacturer notifications, exploit collections , reports of scientific conferences, publications on specialized sites and blogs. <br><br>  As a result, 743 vulnerabilities were revealed in the automated process control systems detected from 2005 to 2012, and from 2009 to 2012 the number of detected vulnerabilities in the automated process control system u increased 20 times (from 9 to 192).  In recent years (2012‚Äì2015), the number of vulnerabilities found annually remains stable (about 200).  According to the data of 2015, only 14% of vulnerabilities were eliminated within three months, 34% were eliminated more than three months, and the remaining 52% of errors were either not corrected at all, or the manufacturer does not report the time of elimination. <br><br>  As of 2016, 158,087 ICS components available on the Internet were detected.  The largest number of components of the automated process control system is available via HTTP, Modbus (RTU and TCP / IP) and Profibus / Profinet, BACnet, accounting for approximately 33% each, OPC (25%).  However, the number of vulnerabilities detected depends on the prevalence of the product and whether the manufacturer adheres to the policy of responsible disclosure. <br><br>  The greatest number of vulnerabilities was detected in SCADA components, as well as in components of human-machine interfaces.  However, currently only 5% of known vulnerabilities have published exploits.  This figure dropped significantly compared with 2012: then it was possible to find exploits for 35% of vulnerabilities. <br>  Among all the operating systems used with the APCS, Microsoft Windows leads by a large margin.  Most often, the global network contains various components of SCADA systems (including HMI).  They account for 70% of all detected objects. <br><br>  The availability in the public domain of a ready-made tool for exploiting a vulnerability or information about it greatly increases the likelihood of a successful attack. <br><br>  As a rule, the number of published vulnerabilities correlates with the number of published exploits.  In the period from the beginning of 2011 to September 2012, 50 exploits were published - six times more than in six years from 2005 to 2010. <br>  However, the lack of a known method for implementing an attack reduces the likelihood of an attack, but does not completely exclude it, since cyber attacks on industrial facilities are carried out with the assistance of experienced high-level specialists who often simply do not need "exploit packs" and other popular tools. <br><br>  Vulnerabilities for which there is already an exploit, but a patch has not yet been released, pose the greatest danger, since an attacker does not need in-depth knowledge and lengthy preparation to penetrate the system. <br><br><h3>  HMI vulnerabilities report for 2016 </h3><br>  The developers of SCADA solutions often have little experience in building a user interface (UI).  This is due to the fact that developers do not know what the final operating environment for systems will be.  This forces developers to make assumptions that are often incorrect.  Without the full life cycle of code development, programs contain vulnerabilities.  SCADA developers continue to make the same mistakes that application and OS developers made ten years ago. <br><br>  Trend Micro experts analyzed the ICS-CERT warnings for the period from 2015 to 2016 related to HMI vulnerabilities, and came to disappointing conclusions. <br>  This study examines the current SCADA HMI security status.  Analyzing all publicly disclosed vulnerabilities in SCADA software that have been fixed since 2015 and 2016, including 250 vulnerabilities acquired through the Zero Day Initiative (ZDI) program.  Almost a third of vulnerabilities (36%) are related to buffer overflow (Buffer Overflow).  This security problem allows an attacker not only to cause a program crash or ‚Äúfreeze‚Äù the program, which leads to a denial of service, but also to execute arbitrary code on the target system. <br><br>  If you add up all types of vulnerabilities, the exploitation of which allows a hacker to launch code execution (for example, buffer overflow, remote code execution), you will get about 40% of all vulnerabilities.  It is worth noting a large number of problems with authentication and key management (Authentication / Key Management) - almost 23%. <br><br>  All these errors can be prevented by using safe code development techniques.  Finally, we observe the average time between the disclosure of an error to the SCADA provider and the release of the patch, it reaches 150 days, another 30 days will be required for software deployment. <br><br>  This means that on average five months before the SCADA vulnerabilities are fixed.  For some manufacturers, this may take only one or two weeks, while for larger ones it takes up to 200 days. <br><br>  The US Department of Homeland Security, ICS-CERT, is tasked with reducing risks within all critical infrastructure sectors through collaboration with law enforcement and intelligence and pooling efforts. <br><br>  There is such an interesting ZDI program that buys people into vulnerabilities that they found in various products.  After purchasing a vulnerability, they analyze this vulnerability with all similar products of a particular company in whose code there are errors.  Thereafter, contact the company and represents the vulnerability.  In fact, it turns into a business.  When the ZDI program acquires vulnerabilities that affect SCADA, ICS-CERT is reported to resolve this issue.  In 2015, ICS-CERT responded to 295 incidents and handled 486 vulnerability disclosures. <br><br>  To determine which vulnerabilities prevail in the HMI, consider the results of ICS-CERT detection for 2015 and 2016, and corrections over the past two years.  This data was combined with more than 250 zero-day vulnerabilities purchased by the ZDI program.  This information was also compared with the listed CWE vulnerabilities to determine the total number. <br><br>  As it turned out, 20% of the exploited vulnerabilities were caused by memory damage (buffer overflow, read / write vulnerability outside the field (out-of-bounds read / write), etc.). <br><br>  23% of vulnerabilities arose due to the lack of authorization mechanisms, 19% of problems were associated with credentials (stitched passwords, hidden accounts with full rights, storing passwords in clear text), 9% of problems allowed the introduction of code. <br><br><img src="https://habrastorage.org/webt/59/e4/5e/59e45e31dd89a710145744.png"><br>  <i>Figure 1: Vulnerability Categories</i> <br><br>  Although some cross-site scripting (XSS) and Cross-Site Request Forgery (CSRF) problems were expected, most of the HMI problems are problems with Windows, not web applications.  Some XSS and CSRF errors exist in the ‚ÄúOthers‚Äù category, although they are few. <br><br>  <b><i>Memory corruption issues</i></b> <br><br>  Problems with memory damage account for 20% of the vulnerabilities identified.  Weaknesses in this category are classic code protection problems, such as stack buffer and heap overflows beyond the limits of read / write boundaries.  Memory corruption can occur in the HMI when the contents of a memory cell are inadvertently altered due to errors somewhere in the code. <br><br>  This can also be called a security breach of memory.  When the contents of corrupted memory are used later in this program, the failure or execution of code that is not intended to run. <br><br><img src="https://habrastorage.org/webt/59/e4/5c/59e45c67ae367640557795.png"><br>  <i>Memory damage 20.44%</i> <br><br>  <b>Example: Advantech WebAccess HMI Solution</b> <br><br>  At some point, ZDI received 100 separate reports using the Advantech WebAccess HMI product in one day.  Most of these cases turned out to be buffer overflows, most of which are similar to the example below. <br><br><img src="https://habrastorage.org/webt/59/e5/68/59e56862600e6063993986.png">  <i>Figure 2: Advantech WebAccess Toolbar</i> <br><br>  One interesting point is that, at present, this is a SCADA solution, but it is also advertised as a solution for Internet of Things (IoT).  The solution contains the webvrpcs.exe service, which runs in the context of a local administrative user.  The service listens to the Transmission Control Protocol (TCP) port 4592 and can be accessed via the Remote Procedure Call Protocol (RPC) -based protocol. <br><br>  Service calls from the application are designed to resemble Microsoft Windows DeviceIoControl functions.  Each service call contains an input / output value (IOCTL) that allows you to use conversion tables to use hundreds of service types.  In this example, the parameter is the name window, which is copied using the _sprintf function to the stack buffer, which is 0x80 characters. <br><br><img src="https://habrastorage.org/webt/59/e5/68/59e5689e944db926684287.png"><br><br>  The area marked in yellow is the IOCTL code, followed by the buffer length (in and out) - 0x8 bytes in size followed by a terminating zero.  Because the attack puts 0x8c bytes of data into a buffer of 0x80 bytes in length, the predicted overflow results.  Viewing the vulnerable code shows the classic _sprintf call, which allows overflow conditions. <br><br><img src="https://habrastorage.org/webt/59/e5/68/59e568c9d7a6d262254124.png"><br><br>  Checking the stack layout shows that WindowName is set to -80 with 0 as the return address.  Since then, it was not installed during the compilation stage, there is no stack of cookies installed for protection. <br><br><img src="https://habrastorage.org/webt/59/e5/68/59e568efaec6a622375386.png"><br><br>  The lack of stack cookies, as well as other protections such as ASLR and SafeSEH, is probably due to the fact that the original code was written prior to the existence of these encoding methods.  However, the use of prohibited (API) and the lack of deep security measures means that the attacker simply needs to rewrite the return address to the beginning of the attacking return link (ROP). <br><br>  Without ASLR, no difficulty is required to execute malicious code controlled by an attacker with elevated privileges.  Analysis of the patch for this vulnerability also shows some interesting options for cleaning up the code of aging databases.  The original _sprintf function was included in the list of API-banned by Microsoft released in 2007.  ZDI researchers expected Advantech to implement a list of banned APIs and remove known bad functions from its code.  Instead, the patch for this error changed the _sprintf function to the _snprintf function. <br><br><img src="https://habrastorage.org/webt/59/e5/69/59e5691c8261b307851257.png"><br><br>  However, _snprintf is also on the list of prohibited APIs.  Although _snprintf provides greater overflow tolerance than _sprintf, it cannot complete (with a null character) if there are too many characters. <br><br>  This means that when the stack is not cleared (a rare situation), it is possible for attackers to use string manipulations on this WindowName to trick the program, counting a buffer of 0x80 characters long, when in reality the buffer is longer because it does not complete zero. <br><br>  Of the 75 fixes released by Advantech, all were point fixes.  In other words, the supplier fixed the bug, but did not eliminate the global problem functions.  Thousands The functions _sprintf and _snprintf remain in the code base for today.  Advantech did not release patches for the remaining 25 questions that were reported by ZDI researchers.  These questions were subsequently disclosed to the public in accordance with the policies of the ZDI program. <br><br>  <b><i>Credential Management Issues</i></b> <br><br>  Identity management problems account for 19% of the vulnerabilities identified.  Vulnerabilities in categories are cases such as the use of hard-coded passwords, saving passwords in a recoverable format (for example, clear text) and insufficient credential protection. <br><br><img src="https://habrastorage.org/webt/59/e4/5c/59e45c6842f27711730446.png"><br><br>  <b>Hidden GE MDS PulseNET account</b> <br><br>  General Electric (GE) MDS PulseNET is used to monitor industrial communication devices and networks deployed in the energy, water and wastewater sectors around the world.  The ZDI program reports that "affected products contain a hard-coded account with full privileges."  A full investigation led to the disclosure of CVE-2015-6456 with a general system vulnerability score (CVSS) rating of 9.0. <br><br>  Take a look at the user control panel, it indicates the existence of only two accounts in the system (operator and administrator).  However, as noted by Andrea Micalizzi (who is also known by the nickname "rgod"), there is a hidden third user account with administrator rights. <br><br><img src="https://habrastorage.org/webt/59/e5/69/59e5697613624676798820.png"><br>  <i>Figure 3: GE MDS PulseNET User Control Panel</i> <br><br>  Using HeidiSQL to extract information from the database provides an account "ge_support" with a password hash &lt;! [HDATA [MD5 $ 8af7e0cd2c76d2faa98b71f8ca7923f9.  The decrypt is MD5 hash, the password is displayed as ‚ÄúPu1seNET‚Äù. <br><br><img src="https://habrastorage.org/webt/59/e5/69/59e569a2d22c5070878824.png"><br>  <i>Figure 4: GE MDS PulseNET User Control Panel after Login</i> <br><br>  Even after logging in with the ‚Äúge_support‚Äù account, the third username is not displayed to the user in the control panel. <br><br> <b><i>  /      </i></b> <br><br>    23%  SCADA.     ,      ,       ActiveX,   . <br><br><img src="https://habrastorage.org/webt/59/e4/5c/59e45c68b751c253479742.png"><br><br> <b> : Siemens SINEMA Server   </b> <br><br> ,            HMI,  ,          (ACL)        Windows Program Files . <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Instead of properly protecting these top-level directories, they are writable by default, and the directory tree includes utility source solution files. This allows any local user to attach a new binary file that will be executed as a system service in the directory. This problem manifested itself on the Siemens SINEMA server and was reviewed using CVE-2016-6486. The product itself is installed in a directory tree with a weak ACL. By default, Microsoft installs the Program Files directory ‚Äî as protected with ACLs. </font></font><br><br><img src="https://habrastorage.org/webt/59/e5/69/59e569f7ce166040355597.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 5: Command line showing standard Program Files permissions</font></font></i> <br><br>  ,               .        .     ,   ,   ,    Program Files,  Siemens     . <br><br><img src="https://habrastorage.org/webt/59/e5/6a/59e56a1c53fc2633651097.png"><br> <i> 6:     Siemens SINEMA Server</i> <br><br>   ,          ,    .       ,       -  .  ,    ,    ,    . <br><br><img src="https://habrastorage.org/webt/59/e5/6a/59e56a471eacf444599097.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As noted by the highlighted line, Authenticated Users have full control. To join a verified user group, the user only needs to authenticate in the Windows domain. In essence, this means that almost everyone in the system will be in the Authenticated Users group. An examination of the source code in this directory shows similar results. </font></font><br><br><img src="https://habrastorage.org/webt/59/e5/6a/59e56a774d195897224888.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It is important to note that this particular source file starts a service that runs at the local system level. </font></font><br><br><img src="https://habrastorage.org/webt/59/e5/6a/59e56a9e34fd5443195669.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The end result of this unsafe default installation allows any authenticated user to replace the original file at will. In addition, this new attacker-driven binary is executed in the context of the local system after the next reboot. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Example: Advantech WebAccess</font></font></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Advantech WebAccess provides cross-platform, cross-browser data access and a user interface based on HTML5 technology. The ZDI program received an error message that allowed you to view other passwords when changing your password. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The ICS-CERT report on this error "A properly authenticated administrator can view passwords for other administrators." We should note that this does not mean a system administrator. This refers to the administrator of SCADA systems. As part of the solution, there is the upAdmin.asp script, which allows the SCADA administrator to update his username, password, or description. The Active Server Pages (ASP) script can be exploited by anyone with the permission of the system. </font></font><br><br><img src="https://habrastorage.org/webt/59/e5/6a/59e56ad1995c9969869439.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 7: Advantech WebAccess User Settings Panel</font></font></i> <br><br>     ,           ¬´  ¬ª.     <br> URL- http:///broadWeb/user/upAdminPg.asp?uname=known&amp;return=bwproj <br>    ‚Äî  IP- ,     .        URL-   ,   <br> http:///broadWeb/user/upAdminPg.asp?uname=victim&amp;return=bwproj <br>         ,    HTML- ,      . <br><br><img src="https://habrastorage.org/webt/59/e5/6a/59e56af78ce04079320053.png"><br><br>          ,   SCADA . <br><br> <b><i>   </i></b> <br><br>    -,   HMI  ,    .     9%  .        ‚Äî SQL, , ,    -  ,       SCADA.    - ,   ‚Äî  Gamma,    Cogent DataHub . <br><br><img src="https://habrastorage.org/webt/59/e4/5c/59e45c68d9600819635272.png"><br><br><blockquote> <b>  -  Gamma?</b> <br>  Cogent DataHub      Gamma   HMI .   , Gamma      ,          .    ,   C  C ++,     ,            . Gamma      API     . </blockquote><br> <b>: Cogent DataHub</b> <br><br>   , Cogent DataHub       ,    ,          OLE     (OPC)   Windows. <br><br>  ZDI    ,   ,      -.            . <br><br><img src="https://habrastorage.org/webt/59/e5/6b/59e56b4171561847840244.png"><br> <i> 8: Cogent DataHub WebView</i> <br><br>   , Cogent DataHub        ,      SCADA .         EvalExpression  Gamma        .       Ajax  TCP- 80. <br><br>  Gamma  ,   ,          SCADA.          .       ,      . <br><br><img src="https://habrastorage.org/webt/59/e5/6b/59e56b6e885a3922892905.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The highlighted error accepts the expression and checks one flag to determine if the system is allowed to execute the expression. If this check returns true, the expression is executed regardless of what it contains. The attacker still has to deceive the system. Fortunately for the intruder, the system allows this as well. To complete this exploit, an attacker must first send an HTTP request to any Gamma script that loads the necessary libraries.</font></font><br><br>   ,      ,        ,     .      AJAXSupport.AllowExpressions   allow_any_expression   True.      AJAXSupport.AllowExpressions   ,    .       .   ,  Cogent    .       ,   ‚Äî -.  . <br><br><img src="https://habrastorage.org/webt/59/e5/6b/59e56b962b259131093459.png"><br> <i> 9:       </i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In the first part of the patch, AllowExpressions is completely removed. This prevents the switch of this flag in the system. Until the developer completely removed EvalExpressions, he made a comment, noting that using the method poses a security risk. </font></font><br><br><img src="https://habrastorage.org/webt/59/e5/6b/59e56bc060a6a163479699.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cogent also commented on the violation code so that it is not installed by default. To enable the code, the developer must log in and manually unlock the method. This method also makes it unlikely for a repeated error to follow. </font></font><br><br> <i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Information disclosure</font></font></b></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">When researchers discover vulnerabilities in SCADA products, the amount of time it takes to fix a bug is different. This time is often called the window of vulnerability. ZDI researchers examined all HMI vulnerabilities obtained through the program (more than 250), and analyzed how long they were fixed. As can be seen from the data for the last four years, the average correction time does not decrease. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Since 2013, the average time between when the researchers disclose an error to the supplier and the time when the patch is released is about 140 days. </font></font><br><br><img src="https://habrastorage.org/webt/59/e4/5c/59e45c6909633705766266.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 10: Average time to fix vulnerabilities from the time they are disclosed by year</font></font></i> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The quality of the released patch also plays a part in time. A problematic update applied to a system may result in a denial of service (DoS) on a critical portion of the infrastructure. Due to these and other problems, there is a lag between the availability of the patch and the installation of this fix to the production system. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Not all SCADA providers work in the same time frame. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Some providers respond much faster than others. For example, ZDI analyzed that Cogent Real-Time Systems quickly reacted to this vulnerability. For large suppliers, ABB, GE, Indusoft and PTC, it takes an average of more than 200 days to create a patch. </font></font><br><br><img src="https://habrastorage.org/webt/59/e4/5c/59e45c69311d0123079850.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 11: Average time to fix vulnerabilities since they were disclosed by the supplier </font></font></i> <br><br> <b><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Comparison by industry</font></font></i></b> <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A comparison of the response time of the SCADA manufacturers with other industries shows that the response time is not much different from other industries. Although the widespread software of large suppliers such as Microsoft, Apple, Oracle, Adobe and others have an average response time of less than 120 days. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In SCADA-systems and security systems automation on average about 150 days. The security software industry is slightly faster, but not significantly. Business programs include enterprises such as HPE and IBM. These providers require significantly more time to disclose information about errors. </font></font><br><br><img src="https://habrastorage.org/webt/59/e4/5c/59e45c69570da397058490.png"><br> <i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 12: The average time to fix vulnerabilities since they were disclosed by industry</font></font></i> <br><br><h3>  Conclusion </h3><br> ,              ‚Äî  140 .  ,  SCADA-     ,    ,        . <br>     ,   . ,        (  API,     ..),    . <br><br><blockquote> ¬´ HMI  SCADA-        ,         .      ,        , ,     .    ,        ¬ª,-    . </blockquote><br><br>     SCADA HMI          . HMI        .      HMI          ,    . <br><br>         ,      HMI          ,        . <br><br>    ,    HMI    :  ,   ,   /      .            . <br><br>   ,     ,      SCADA  ,      150 ,  30 ,   ,  Microsoft  Adobe,   43  ,      ,  HPE  IBM. <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Taking into account the vector of attacks on HMI, SCADA systems, where the vulnerability is an effective entry point into the system, we hope that the owners of SCADA and administrators are aware of the vulnerabilities promulgated and are therefore trying to block the threat. Developers of HMI and SCADA solutions would benefit from adopting safe methods in the life cycle of developing software code, as it has been done by OS and application developers for a decade.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">By taking simple steps, such as auditing to use forbidden APIs, suppliers can make their products more resilient to attacks. SCADA developers should also expect that their products will not be used in ideal systems. For example, although this is considered a bad security practice, developers must take responsibility for their products and solutions and understand that their systems will be connected to a public network. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">By adopting such an approach, which implies a worse product usage scenario, developers should implement deeper protection measures. Malicious programs specifically designed for process control systems exist and are actively targeted at HMI.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Errors in SCADA systems are likely to be with us for many more years. </font><font style="vertical-align: inherit;">Working together, the security of these systems will continue to improve. </font><font style="vertical-align: inherit;">While a completely secure system is likely to never be created. </font><font style="vertical-align: inherit;">Enhancing the research and development of software code for the HMI will be our best chance to deter attackers as long as necessary.</font></font><br></div><p>Source: <a href="https://habr.com/ru/post/340164/">https://habr.com/ru/post/340164/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../340150/index.html">The digest of fresh materials from the world of the frontend for the last week ‚Ññ284 (October 9 - 15, 2017)</a></li>
<li><a href="../340154/index.html">Change sex and race on a selfie using neural networks</a></li>
<li><a href="../340156/index.html">FrontFest.JS: ClojureScript in production, optimization of React rendering and how to (not) get depressed with Angular</a></li>
<li><a href="../340158/index.html">VoIP server for a small company (FreePBX 14, Asterisk 15, Ubuntu 16.04) part 2</a></li>
<li><a href="../340160/index.html">Header design features</a></li>
<li><a href="../340166/index.html">How Android Converts Resource Sizes</a></li>
<li><a href="../340168/index.html">How did we choose Graylog2</a></li>
<li><a href="../340170/index.html">Rust 1.21 release</a></li>
<li><a href="../340172/index.html">Analysis of the latest version of the Dridex malware for identity theft</a></li>
<li><a href="../340176/index.html">The whole web on 60+ FPS: how a new renderer in Firefox got rid of jerks and slowdowns</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>