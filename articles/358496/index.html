<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Applying trigonometry rules to create high-quality animation.</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The author of the material, the translation of which we are publishing today, Nash Vale, says that he was recently engaged in research on landing page...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Applying trigonometry rules to create high-quality animation.</h1><div class="post__text post__text-html js-mediator-article">  The author of the material, the translation of which we are publishing today, Nash Vale, says that he was recently engaged in research on landing pages.  During the work, he came across one site.  It was a great, useful resource.  However, in the course of working with him, Nash noticed something unpleasant. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b71/7f8/778/b717f8778595a033fedacdd0da0a7305.gif"></div>  <i><font color="#999999">Unnatural animation</font></i> <br><a name="habracut"></a><br>  When he saw how unnaturally the circles were moving, on the basis of which the animation was created, he decided to write this article.  In particular, here he will talk about how to create a much more attractive version of this animation, using basic concepts of trigonometry.  He says that, in fact, in order to make high-quality animation, you need surprisingly little code.  In addition, this article is intended for a wide range of readers, even for those who do not understand mathematics and trigonometry.  Here everything is revealed that is necessary in order to proceed to the conscious use of the principles of trigonometry in web animation. <br><br>  As a matter of fact, this is what the boot animation looks like, to the creation of which this material is dedicated. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/af5/425/db9/af5425db9602d708392aabe0f2152521.gif"></div><br>  <i><font color="#999999">Smooth animation</font></i> <br><br><h2>  <font color="#3AC1EF">1. Positioning the circle</font> </h2><br>  The boot animation we are going to create consists of three circles, periodically moving up and down.  In this case, due to the fact that each of them moves in its own way, it turns out a smooth wavy animation. <br><br>  Let us analyze this animation in all details, starting with a consideration of how to make a separate circle make smooth periodic moves up and down.  As we move through the material, we will delve into the details of what is happening. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/385/cb1/ca0/385cb1ca04e2c3834f0d92c4cbf7802f.png"></div><br>  This code allows you to draw a circle in the center of the <code>&lt;svg&gt;</code> element.  The following figure shows such a circle, even more like a ball.  It should be noted that its appearance does not correspond to the above code, but we are not interested in external effects, but in the fact that there is a circle in the center of some area intended for displaying graphic elements. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/280/d3d/fa0/280d3dfa0d172f3365a720b6ebb97743.png"></div><br>  <i><font color="#999999">Circle in the center of the area for displaying graphic elements</font></i> <br><br>  Let us deal with what is happening here by comparing the code and its graphical representation. <br><br>  So, the <code>width</code> and <code>height</code> properties specified in the code represent, respectively, the width and height of a rectangular SVG element. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/acc/a93/a82/acca93a820a2baa0e55d8fa2ab942a9d.png"></div><br>  <i><font color="#999999">The width and height of the SVG-rectangle</font></i> <br><br>  By default, SVG elements use the traditional coordinate system, which origin is in the upper left corner.  In such a coordinate system, the values ‚Äã‚Äãalong the X and Y axes increase as you move along it to the right and down.  In addition, each point in this coordinate system corresponds to one pixel.  As a result, for example, the four corners of a rectangle have coordinates depending on the width and height given to it. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e24/61d/327/e2461d32794c0fa25d545b2f34ddc80a.png"></div><br>  <i><font color="#999999">The coordinates of the corners of the SVG-rectangle</font></i> <br><br>  The next step, which is to place the circle in the center of the field, involves the use of mathematical principles that are learned in elementary school.  Namely, the coordinates of the center of the figure are the result of dividing the width and height of the field by 2 ( <code>width/2</code> , <code>height/2</code> ), which gives us (150, 75).  We assign these values ‚Äã‚Äãto the <code>cx</code> and <code>cy</code> properties, which makes it possible to place a circle in the center of the field. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ede/1b4/2dc/ede1b42dc1e8a676aa79b28d015cc00d.png"></div><br>  <i><font color="#999999">Finding the center of the figure</font></i> <br><br><h2>  <font color="#3AC1EF">2. Moving a circle</font> </h2><br>  Now our task is to organize the movement of the circle.  However, we are not satisfied with some arbitrary movement.  We need the circle to make periodic movements up and down. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/eb0/e83/b41/eb0e83b41f300369e4d8b5002e7b525c.png"></div><br>  <i><font color="#999999">The pattern of movement of the figure</font></i> <br><br><h3>  <font color="#3AC1EF">‚ñç2.1.</font>  <font color="#3AC1EF">Mathematical Principles of Periodic Motion</font> </h3><br>  Periodicity is a phenomenon that occurs at regular intervals.  The simplest example of periodicity is the daily sunrise and sunset.  Frequency is also peculiar to our time frame.  Say, if it is 6:30 pm now, then after 24 hours it will again be 6:30 pm, and after another 24 hours - again 6:30 pm.  In this case, before us is something regular, occurring at an interval of exactly 24 hours. <br><br>  Suppose it is now noon, and the sun is at its highest point above the horizon.  After 24 hours, it will come to this point again.  Or, it is evening now, and the sun is low over the horizon, touching it, ready to disappear behind it.  After 24 hours we will be able to observe the same picture.  The cyclical movements of the sun are shown in the following figure. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/7c2/e18/46f/7c2e1846ff06a70e8c87c3d8780ac3ef.png"></div><br>  <i><font color="#999999">Sunrise and Sunset Cycle</font></i> <br><br>  This is a very simple illustration of what is happening with the sun, one can even say that from a scientific point of view this view is wrong, but this picture helps to illustrate what we are interested in now, namely that the sun makes periodic movements. <br><br>  If you draw a graph showing the change in the vertical position of the sun over time, then the frequency of what is happening becomes even more obvious. <br><br>  In order to build a two-dimensional curve, we need two coordinates - <code>x</code> and <code>y</code> .  In our case, this is the <code>time</code> coordinate representing the time of day, and the <code>positionOfTheSun</code> coordinate corresponding to the position of the sun. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d8c/54c/880/d8c54c8803012e9669c586657a9e681c.png"></div><br>  <i><font color="#999999">The cycle of sunrise and sunset, presented in the form of a graph</font></i> <br><br>  The vertical axis, or <code>Y</code> axis, is the vertical position of the sun in the sky, and the horizontal axis, or <code>X</code> axis, is time.  Over time, the position of the sun changes, and this process is reproduced every 24 hours. <br><br>  Now, after we have studied the graph of the behavior of the sun, we can find out its position in the sky, even if we do not see the sky, for example, being in a cave where the sunlight does not penetrate.  In order to do this, let's name our graphic, for example, <code>sunsVerticalPositionAt</code> .  Now we can build the following equation: <br><br><pre> <code class="hljs pgsql">verticalPositionInTheSky = sunsVerticalPositionAt( [<span class="hljs-type"><span class="hljs-type">time</span></span>] )</code> </pre> <br>  Now, mathematically speaking, it is enough for us to transfer the value of time to the function, and it will give us the position of the sun.  Here's what it looks like. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/24c/4f1/f58/24c4f1f58fedf7bd25fc5b20ff4c6a47.png"></div><br>  <i><font color="#999999">Finding out the position of the sun using the graph function</font></i> <br><br>  Here we select the time point ( <code>t1</code> ) to which we need to know the position of the sun, then draw a vertical line in our coordinate system, and at the point where it crosses the graph, draw a horizontal line, and find the coordinate of its intersection with the <code>y</code> axis.  This coordinate gives us the position of the sun in the sky at a given point in time. <br><br>  Probably, we have already taken from this example all that is possible, so leave the sun alone and move on to the usual charts.  Here is how it all looks. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/668/e94/c87/668e94c870286285aeb526f40aabe69c.png"></div><br>  <i><font color="#999999">Periodic curve</font></i> <br><br>  This graph is a universal representation of a certain periodic process.  The value (what was the vertical position of the sun in our example) repeats as another value changes (in our example these second value was time). <br><br>  There are quite a few periodic functions in mathematics, we will focus on the simplest, widely known function, which we will use to create flawless animation.  This is a sinusoidal function, described by the formula <code>y = sin(x)</code> .  Here is her schedule. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0b7/56c/9f5/0b756c9f5d4b5402e0afa97b54dfcf85.png"></div><br>  <i><font color="#999999">Sine curve</font></i> <br><br>  Doesn't this remind you of anything?  For example - the graph that we built, based on an analysis of the behavior of the sun? <br><br>  We can substitute the <code>y = sin(x)</code> values ‚Äã‚Äãin the <code>y = sin(x)</code> formula and get the <code>y</code> values.  Strictly speaking, it looks the same as finding out the position of the sun according to the corresponding schedule. <br><br>  Perhaps now you are concerned about the question of what is a " <a href="https://en.wikipedia.org/wiki/Sine">sinusoidal function</a> ."  In fact, ‚Äúsine‚Äù is nothing more than the name given to some function, just as we, in our experiment, gave the name of the function <code>sunsVerticalPositionAt</code> , with which we determined the position of the sun. <br><br>  In the equation <code>y = sin(x)</code> , you should pay attention to <code>y</code> and <code>x</code> , to how the value of <code>y</code> changes as the value of <code>x</code> changes (it is easy to see that the behavior of <code>y</code> similar to what we have already seen in the example with the sun). <br><br>  In addition, it is worth paying attention to the fact that the maximum value reached by <code>y</code> is 1, and the minimum is represented by -1. <br><br>  This is only a feature of the sinusoidal function.  The values <code>y = sin(x)</code> yields are in the range of -1 to +1. <br><br>  This range, by the way, is easy to change.  That is what we will soon do.  However, first, let's gather everything that we have already dealt with and make it so that the circle in the SVG element starts moving. <br><br><h3>  <font color="#3AC1EF">‚ñç2.2.</font>  <font color="#3AC1EF">Transition from mathematics to programming</font> </h3><br>  So, inside the element <code>...</code> there is a circle with the identifier <code>c</code> .  Here's how to access this circle from javascript.  After that we will be able to move it. <br><br><pre> <code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> c = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementbyId(<span class="hljs-string"><span class="hljs-string">'c'</span></span>); animate(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">animate</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ requestAnimationFrame(animate); }</code> </pre> <br>  In this code, we get a reference to the circle and store it in the variable <code>c</code> .  Also here is a mechanism for performing animation.  Namely, here we use the <code>requestAnimationFrame</code> function, which we pass to the animate function.  This function recursively calls itself using <code>requestAnimationFrame</code> , which allows you to execute any code inside the <code>animate</code> function at intervals of up to 60 times per second.  This makes it possible to perform animations at up to 60 FPS (frames per second).  Details about <code>requestAnimationFrame</code> can be read <a href="https://developer.mozilla.org/en-US/docs/Web/API/window/requestAnimationFrame">here</a> . <br><br>  The most important thing to know about the <code>animate</code> function is that the code inside it, each time it is called, describes one frame of the animation.  The next recursive call to this function makes a small change, reflected in the next frame of the animation.  This happens again and again, at a very high speed (up to 60 FPS), and the result is what looks like an animation. <br><br>  Consider these provisions in practice by analyzing the following code fragment. <br><br><pre> <code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> c = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'c'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> currentAnimationTime = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> centreY = <span class="hljs-number"><span class="hljs-number">75</span></span>; animate(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">animate</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ c.setAttribute(<span class="hljs-string"><span class="hljs-string">'cy'</span></span>, centreY + (<span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.sin(currentAnimationTime))); currentAnimationTime += <span class="hljs-number"><span class="hljs-number">0.15</span></span>; requestAnimationFrame(animate); }</code> </pre> <br>  Here, in comparison with the previous fragment, 4 new lines are added.  If you run this code, you can see slow periodic circle oscillations around the center point. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/909/803/96b/90980396bd9b89e918efdc4b9105f473.gif"></div><br>  <i><font color="#999999">Circle movements</font></i> <br><br>  That's what's going on here.  After we have the coordinates of the center of the circle, <code>cx</code> and <code>cy</code> , we can say that we are half ready to animate it.  Now, first, let's not touch <code>cx</code> , since we do not need the circle to change its horizontal position. <br><br>  And, secondly, we will periodically add the same numbers to <code>cy</code> or subtract them from this coordinate, which will allow us to move the circle up and down.  This process describes our code. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/cbc/b33/dce/cbcb33dce5c5e11e0d1380597627e72f.png"></div><br>  <i><font color="#999999">Changing the y coordinate of the circle center</font></i> <br><br>  The <code>centreY</code> stores the <code>y</code> coordinate of the center of the circle (75), which allows, to change the vertical position of the shape, add some values ‚Äã‚Äãto this constant or subtract them from it. <br><br>  The variable <code>currentAnimationTime</code> , which is initially set to 0, is used to control the speed of the animation.  The more we increase it with each call, the faster the circle will move.  Here, experimentally, the value of 0.15 is chosen.  As it turned out, it gives quite acceptable looking movement of the figure. <br><br>  The <code>currentAnimationTime</code> is <code>x</code> in the equation <code>y = sin(x)</code> .  Performing the calculations necessary to prepare the next frame of the animation, we pass the <code>Math.sin</code> function (this is the standard JavaScript function) to the <code>currentAnimationTime</code> value, increased in the previous step, and add the number that this function produces to the <code>centreY</code> constant. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/314/5d8/01c/3145d801c5e021fa02c781cfc125f031.png"></div><br>  Then we add what we got to <code>cy</code> , using the <a href="https://developer.mozilla.org/en/docs/Web/API/Element/setAttribute">setAttribute</a> method. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/929/a0a/825/929a0a825e3904cb0261e6cd6fc6c91c.png"></div><br>  As we already know, the function <code>y = sin(x)</code> , for any value of <code>x</code> , returns values ‚Äã‚Äãin the range from <code>-1</code> to <code>1</code> .  As a result, the values ‚Äã‚Äãthat we assign <code>cy</code> will be in the range from <code>centreY - 1</code> to <code>centreY + 1</code> .  This causes the circle to move vertically within 1 pixel. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/fca/abf/313/fcaabf313334fd1a98a4fd5ce7f02a75.png"></div><br>  <i><font color="#999999">Vertical movement of the shape specified in the code</font></i> <br><br>  Now we would like to expand the range of movement of the circle.  That is, it is necessary that it deviates vertically from the original value by a distance greater than 1 pixel.  How to do it?  Maybe we need a new feature?  Fortunately, we already have everything we need. <br><br>  Recall that at the end of section 2.1.  it was about the features of the sinusoidal function.  In order to expand the range of movement of the figure, you need to multiply what the <code>Math.sin</code> function produces, by a certain number, which will become a representation of the upper and lower limits of movement. <br><br>  The operation of multiplying a function by a constant is called scaling.  Notice how the shape of the graph has changed, and how the multiplication affected the maximum and minimum values ‚Äã‚Äãof the function. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2b2/84f/c73/2b284fc73427e5d848fc275324f36a24.png"></div><br>  <i><font color="#999999">Scaling graphics</font></i> <br><br>  Now, after we figured it out, make changes to the code. <br><br><pre> <code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> c = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'c'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> currentAnimationTime = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> centreY = <span class="hljs-number"><span class="hljs-number">75</span></span>; animate(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">animate</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ c.setAttribute(<span class="hljs-string"><span class="hljs-string">'cy'</span></span>, centreY + (<span class="hljs-number"><span class="hljs-number">20</span></span> *(<span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.sin(currentAnimationTime)))); currentAnimationTime += <span class="hljs-number"><span class="hljs-number">0.15</span></span>; requestAnimationFrame(animate); }</code> </pre> <br>  But how will the circle behave now. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/baf/b13/73c/bafb1373c296d29ab17d5dac52d40051.gif"></div><br>  <i><font color="#999999">Circle movements</font></i> <br><br>  As a result, you can see how the circle smoothly moves up and down.  Well done, right? <br><br>  We have just increased the amplitude of the sinusoidal function by multiplying it by a number.  Now we want to add two more circles to our animation, one before the one that already exists, the second after it, and make them move in the same way as the original circle.  In the code, the description of the new figures looks like this: <br><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">svg</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"300"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">height</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"150"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">circle</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"cLeft"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">cx</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"120"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">cy</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"75"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">r</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"10"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">circle</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"cCentre"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">cx</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"150"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">cy</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"75"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">r</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"10"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">circle</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"cRight"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">cx</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"180"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">cy</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"75"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">r</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"10"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">svg</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  We made some changes to the code and organized it in a new way.  For starters, notice the two lines in bold.  They describe two new circles, one placed 30 pixels ( <code>150 - 30 = 120</code> ) to the left of the original, the second 30 pixels to the right ( <code>150 + 30 = 180</code> ). <br><br>  Earlier, we assigned a single circle identifier <code>c</code> .  The circle was one, and it didn‚Äôt stop working with him.  But now, since we have three circles, it will be useful for them to assign clearer identifiers.  That is what is done here.  Now, if we consider the circles from left to right, they have the identifiers <code>cLeft</code> , <code>cCentre</code> and <code>cRight</code> .  Source circle identifier, <code>c</code> , changed to <code>cCentre</code> . <br><br>  If we now run our code, as a result we can see the following. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/f3e/684/34d/f3e68434d7689fcc3b53c27e311f374f.gif"></div><br>  <i><font color="#999999">Three circles</font></i> <br><br>  So far, so good, but new circles are still.  Fix it. <br><br><pre> <code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> cLeft= <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'cLeft'</span></span>), cCenter = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'cCenter'</span></span>), cRight = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'cRight'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> currentAnimationTime = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> centreY = <span class="hljs-number"><span class="hljs-number">75</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> amplitude = <span class="hljs-number"><span class="hljs-number">20</span></span>; animate(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">animate</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ cLeft.setAttribute(<span class="hljs-string"><span class="hljs-string">'cy'</span></span>, centreY + (amplitude *(<span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.sin(currentAnimationTime)))); cCenter.setAttribute(<span class="hljs-string"><span class="hljs-string">'cy'</span></span>, centreY + (amplitude * (<span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.sin(currentAnimationTime)))); cRight.setAttribute(<span class="hljs-string"><span class="hljs-string">'cy'</span></span>, centreY + (amplitude * (<span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.sin(currentAnimationTime)))); currentAnimationTime += <span class="hljs-number"><span class="hljs-number">0.15</span></span>; requestAnimationFrame(animate); }</code> </pre> <br>  Several lines of code have been added here, where, first, we get links to new objects, and second, we apply the same animation rules to them as to the original ones.  That's what it all gave us. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1ed/6a1/2bd/1ed6a12bd14e52c8f1be3c0508743a25.gif"></div><br>  <i><font color="#999999">Animated circles</font></i> <br><br>  Now move and new circles.  However, all this is not yet similar to the animation that we are striving to create. <br><br>  Although the circles move periodically, the problem is that their movements are synchronized.  And this is not what we need.  We need each of the following laps to start moving with some delay.  As a result, it will look as if a circle located to the right of the other follows it.  For example, as shown below. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/eae/9d1/72f/eae9d172fd00c924f1ba70b9e209a661.gif"></div><br>  <i><font color="#999999">Animated circles</font></i> <br><br>  You noticed that the circles are now not moving synchronously, those that are located to the right of others, as if they are catching up.  If you close, for example, two circles of three with your hand, you will notice that the visible circle performs exactly the same movements as when we were working with a single figure. <br><br>  Now, in order to achieve the desired effect, we need to make very small changes to the code.  However, understanding what these changes are and how they influence the result is very important.  So let's deal with them. <br><br>  If we represent the movement of circles as graphs of the dependence of their coordinates <code>cy</code> on <code>currentAnimationTime</code> , we get the following. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/13a/968/f83/13a968f83c4fc60c1f416d9d5436fa0b.png"></div><br>  <i><font color="#999999">Graphs of coordinates of figures depending on time</font></i> <br><br>  There is nothing surprising in these charts, as we know that all circles move in the same way.  It is also clear that since we use a sinusoidal function to animate figures, all the graphs presented here are graphs of this function.  Now, to disrupt the synchronization of these graphs, we need to understand the mathematical concept of shift / transfer graphs. <br><br>  Shift is a parallel transfer of a graph that does not change the shape or size of the graph of a function.  It only changes its location.  Shift can be horizontal or vertical.  In this case, we are interested in horizontal shifts in graphs.  Notice how changing the value of <code>a</code> in the following illustration leads to a horizontal movement of the graph of the function <code>y=sin(x)</code> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0a4/2dc/ef8/0a42dcef823c2b21283aa3a484dc26da.gif"></div><br>  <i><font color="#999999">Transfer function graph (Desmos)</font></i> <br><br>  In order to understand how this works, let us return to the example with the sun.  So, in that example, we used the <code>sunsVerticalPositionAt(t)</code> function.  This function can pass the time and find out the vertical position of the sun at a specified time.  That is, for example, in order to find out the height of the sun above the horizon at 9 am, you can use the construction <code>sunsVerticalPositionAt(9)</code> . <br><br>  Now consider a function of the form <code>sunsVerticalPositionAt(t-3)</code> . <br><br>  Take a closer look at her.  If you pass some time stamp <code>t</code> to it, it subtracts 3 from this value and returns the position of the sun 3 hours earlier than the specified time. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/2b4/10e/6ed/2b410e6ed7ad586dbbbd726fac548a84.png"></div><br>  <i><font color="#999999">Comparison of functions taking t and t-3</font></i> <br><br>  As a result, at <code>t=9</code> new function returns the same as the old one, at <code>t=6</code> , at <code>t=12</code> , the same function as the old at <code>t=9</code> , and so on.  We changed the function so that it returns the values ‚Äã‚Äãthat precede those values ‚Äã‚Äãthat we pass to it. <br><br>  In other words, we moved the function graph to the right along the <code>x</code> axis. <br><br>  Take a look at the following drawing.  The old function at <code>t=6</code> gives us the value <code>B</code>  After shifting the graph, the same value is obtained at <code>t=9</code> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/4e1/b5a/c91/4e1b5ac91ced39b5b1fda30fa6f70773.png"></div><br>  <i><font color="#999999">Old schedule and shifted schedule</font></i> <br><br>  Similarly, if we add, rather than subtract 3, by getting the function <code>sunsVerticalPosition(t + 3)</code> , the graph will move to the left, in other words, the function will give us values ‚Äã‚Äã3 hours later than the time passed to it. <br><br>  Knowing all that we have just dismantled, we can move the graphs that control the animation of the last two circles, bringing them to the following form. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d94/ef6/0e6/d94ef60e61f76e36936a41ea9d1b0763.png"></div><br>  <i><font color="#999999">Shift of graphs of the functions that define the animation of circles</font></i> <br><br>  In order to express this in code, you will need to make the following small change. <br><br><pre> <code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> cLeft= <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'cLeft'</span></span>), cCenter = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'cCenter'</span></span>), cRight = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'cRight'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> currentAnimationTime = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> centreY = <span class="hljs-number"><span class="hljs-number">75</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> amplitude = <span class="hljs-number"><span class="hljs-number">20</span></span>; animate(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">animate</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ cLeft.setAttribute(<span class="hljs-string"><span class="hljs-string">'cy'</span></span>, centreY + (amplitude *(<span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.sin(currentAnimationTime)))); cCenter.setAttribute(<span class="hljs-string"><span class="hljs-string">'cy'</span></span>, centreY + (amplitude * (<span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.sin(currentAnimationTime - <span class="hljs-number"><span class="hljs-number">1</span></span>)))); cRight.setAttribute(<span class="hljs-string"><span class="hljs-string">'cy'</span></span>, centreY + (amplitude * (<span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.sin(currentAnimationTime - <span class="hljs-number"><span class="hljs-number">2</span></span>)))); currentAnimationTime += <span class="hljs-number"><span class="hljs-number">0.15</span></span>; requestAnimationFrame(animate); }</code> </pre> <br>  That's all!  We moved the graphics responsible for the animation of the <code>cCenter</code> and <code>cRight</code> .  Now the circles behave as we need. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0cf/cea/b39/0cfceab39d2efcf974f5a72e4aed63a5.gif"></div><br>  <i><font color="#999999">Finished animation</font></i> <br><br><h2>  <font color="#3AC1EF">Results</font> </h2><br>  As you can see, now the animation looks quite decent, the movements of objects are calculated with absolute mathematical precision.  Of course, this simple example is quite amenable to improvement, but it provides a basis on which to build high-quality animation.  To better understand how individual animation parameters affect the final result, experiment with the value of <code>currentAnimationFrame</code> , which is responsible for the speed of the animation, and with the value of <code>amplitude</code> , which sets the amplitude of the motion, and with other values ‚Äã‚Äãtoo.  In fact, now you can make this kind of animation just the way you want it. <br><br>  <b>Dear readers!</b>  How do you develop animations for your projects? <br><br><div style="text-align:center;"> <a href="https://ruvds.com/ru-rub/"><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div></div><p>Source: <a href="https://habr.com/ru/post/358496/">https://habr.com/ru/post/358496/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../358486/index.html">The digest of fresh materials from the world of the frontend for the last week ‚Ññ314 (May 7 - 13, 2018)</a></li>
<li><a href="../358488/index.html">How to connect via RDP with Windows, Ubuntu or Debian (Linux), Mac OS, as well as from a phone on Android and iPhone</a></li>
<li><a href="../358490/index.html">PHP Digest 130 (May 1 - 13, 2018)</a></li>
<li><a href="../358492/index.html">Stablecoins: a quick guide</a></li>
<li><a href="../358494/index.html">Working with the clipboard in JavaScript using the asynchronous Clipboard API</a></li>
<li><a href="../358500/index.html">SPLUNK VS ELK?</a></li>
<li><a href="../358502/index.html">noBackend, or How to survive the era of fat clients</a></li>
<li><a href="../358504/index.html">How to deploy Adaptavist ScriptRunner artifacts</a></li>
<li><a href="../358506/index.html">AI, practical course. Project planning</a></li>
<li><a href="../358508/index.html">Check Point. A selection of useful materials from TS Solution</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>