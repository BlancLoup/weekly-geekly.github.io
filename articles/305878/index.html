<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to choose a server for 1C, SQL and terminals</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Probably every sysadmin at least once in his life had to solve the problem of introducing 1C products, deploying SQL databases and creating terminal s...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to choose a server for 1C, SQL and terminals</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/85e/e28/81f/85ee2881f7da4b20a7a2388eb6d392a1.jpg"><br><br>  Probably every sysadmin at least once in his life had to solve the problem of introducing 1C products, deploying SQL databases and creating terminal servers.  Customers regularly contact us with a request to select a server for any of these tasks, or even all at once.  There are three possible approaches here, and we want to share our experience in the selection of equipment, perhaps, it will make life easier for someone. <br><a name="habracut"></a><br>  The main criterion when choosing servers for an organization is the set of services to be used, and the number of users. <br><br>  Today we will look at the choice of server hardware for a small organization of 25-30 users, with distributed infrastructure (outlets, warehouses), which requires a terminal server and the 1C: Enterprise program.  These services will be used by all employees. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Most of the small companies, in order to reduce the cost of equipment, prefer to minimize the amount of purchased equipment and ask administrators to ‚Äúshove‚Äù all the services they requested into one physical server.  The desire is clear and excusable, but here "there are nuances." <br><br>  You can organize a terminal server and use the file version of 1C there, but with such a number of users, the developer company recommends switching to the client-server version.  Therefore, we will need another server for ‚Äú1C: Enterprise‚Äù and a database server.  We‚Äôll clarify right away that it is possible to organize a terminal server, SQL server and 1C server on the same operating system, but from the point of view of security and stability of the services, it is highly discouraged.  And if you really want to use one physical server for all three roles, we recommend using virtualization, for example, VMWare ESXi or Hyper-V. <br>  Thus, there are three options: <br><br><ol><li>  One server with file 1C.  The bad option, then we will not consider it. </li><li>  One server with two virtual machines. </li><li>  Two physical servers, one terminal, the second with the database and 1C. </li></ol><br><img src="https://habrastorage.org/files/821/21c/121/82121c121db6408b9f62ebf652f6174c.jpg"><br><br>  To solve these problems, we can offer the following server configuration: <br><br>  In the case of <b>one physical server,</b> we chose the Dell R710, with two six-core Xeon X5650 processors, 64 GB of RAM and six disks: two SSDs in RAID 1 and four SAS disks in RAID 10. <br><br>  In the case of <b>two physical servers,</b> we chose the following configurations: <br><br><ul><li>  Terminal server: IBM x3550 M3 with one Xeon E5620 processor, 32 GB of RAM and two SSDs in RAID 1, with an additional network card for two gigabit interfaces.  This server also has rich opportunities for upgrade, as it is dual-processor, has 18 slots for memory modules and supports up to 288 GB of RAM. </li><li>  Database server: IBM x3250 M5 with one Xeon E3-1220v3 processor, 16 GB of RAM, additional SAS / SATA RAID controller, four SAS disks in RAID 10, with an additional 2 Gigabit network interface card. </li></ul><br>  Why did we choose such configurations?  To answer this question, let's calculate what we need to ensure comfortable work of users in our small organization with 25-30 employees.  To avoid misunderstandings: this is just one example of an inexpensive implementation of 1C, and in many cases it is better to choose other configurations. <br><br><h3>  <font color="#018bc7">CPU</font> </h3><br><img src="https://habrastorage.org/files/b3a/b02/e3f/b3ab02e3ff974d4893f5158b114f30de.png" align="left">  From the point of view of processor time, terminal sessions occupy a not very large share.  According to the experience of implementing terminal solutions in various organizations, 4-6 physical cores of the processor will be enough to maintain the comfortable work of 30 users, one core for 6-8 sessions. <br><br>  For a small database, the SQL server will need one kernel.  But we will focus on expanding the database in the future (or increasing the number of databases) and take two cores on SQL. <br><br>  For the 1C: Enterprise server, it‚Äôs important not so much the number of cores as their clock frequency and bus frequency.  Therefore, we will lay two more cores on the 1C server. <br>  And let's not forget that in the case of virtualization, one or two cores will be useful for us to ensure the operation of the host operating system. <br><br>  Total we get: <br><ul><li>  for a server with two virtual machines, you need 12 physical cores.  It is possible and less, but there should always be a reserve in power.  A server with two six-core processors is ideal for this. </li><li>  for a terminal server, one Xeon E5620 processor with six cores is enough; for a database server, a Xeon E3-1220v3 processor with four cores. </li></ul><br><h3>  <font color="#018bc7">RAM</font> </h3><br><img src="https://habrastorage.org/files/6c6/288/fd9/6c6288fd9a33405a8a13651614e3c780.png" align="left">  First, let's see how much RAM is needed for services: <br><br><ul><li>  The Windows Server operating system only for itself requires 2 GB of RAM. </li><li>  For SQL and a small base of 1C, 4-6 GB of RAM will suffice. </li><li>  Server "1C: Enterprise" requires another 2-3 GB of RAM. </li><li>  We expect that each user will need 700 MB of RAM in the terminal session, then for 30 users, 21 GB will be required. </li></ul><br>  Now apply this to our options. <br><br><ul><li>  For one server with two virtual machines, you need about 40 GB of RAM. </li><li>  For a terminal server, 24 GB or 32 GB of RAM will suffice (we will take it with a margin, assuming a future expansion).  For a server with databases, you need at least 8 GB, but this is ‚Äúbutt‚Äù, so 16 GB with a margin.  Memory is now one of the cheapest server components. </li></ul><br><h3>  <font color="#018bc7">Disk subsystem</font> </h3><br><img src="https://habrastorage.org/files/cd3/2e4/d5b/cd32e4d5b40744adb66679be32a0154e.png" align="left">  This is a traditional bottleneck of many systems.  Choosing the right hard drives is very important for server performance.  When working with 1C SQL database, there are many read / write operations per second (IOPS).  If users are working on a terminal server from thin clients (i.e., they fully use the terminal server as a working environment), this greatly burdens the server‚Äôs disk system.  For example, 30 terminal server users on RAID 1, SATA 3Gb / s, with WD Velociraptor drives feel uncomfortable when working with mail and actively surfing the Internet.  For terminal servers, we recommend using SSD-drives.  For database servers, SAS disks compiled into fail-safe arrays. <br><br>  In addition to drives, you should pay attention to the disk controller.  Modern servers have pretty good controllers onboard, for example, HP SmartArray and DELL PERC.  However, it will be incorrect to use on-board solutions with a serious load when maximum performance is required.  Having saved a little, you can easily get a powerful server that does not pull the load at all.  Therefore, the controller must be <a href="https://habrahabr.ru/company/pc-administrator/blog/304798/">hardware, not software</a> , with its non-volatile memory. <br><br>  Consider options for solving this problem. <br><br><ul><li>  For one server with two virtual machines, it is advisable to use two RAID arrays: one will have the files of the virtual machine of the terminal server, the other will contain the files of the virtual machine of the database server and ‚Äú1C: Enterprise‚Äù.  To create the first array, it is best to use two SSDs in RAID 1 (mirror). <br><br>  It is better to create the second array from four SAS disks in RAID 10 (mirror + stripe), but it is also possible from two SSD drives in RAID 1. The choice depends only on the cost of the disks and the server model. </li><li>  For two servers, all the same, only the arrays will be separated by servers.  On the terminal - RAID 1 of two SSDs, on the database server - RAID 10. </li></ul><br><h3>  <font color="#018bc7">One or more servers</font> </h3><br><img src="https://habrastorage.org/files/0e9/cee/731/0e9cee7314ff453ba585f166dbb96789.png" align="left">  As mentioned above, small organizations have a great desire to host all services on one server. <br><br>  The advantages of using one server and virtualization can be considered lower power consumption and more flexible allocation of resources between virtual machines.  Well, the transfer of virtual machines, in which case, much more convenient than the transfer of physical operating systems. <br><br>  However, two servers have more opportunities to upgrade.  For example, in our version of the low-cost IBM x3550 M3 with the addition of another processor and RAM, the terminal server for 50 or even more users turns into <s>elegant shorts</s> . <br><br>  Another ‚Äúbottleneck‚Äù in our case that needs to be considered when choosing two physical servers is the exchange of data between them over the network.  Virtual servers exchange data through a virtual switch.  Here, in order to increase network bandwidth, you can install each server via a network card with two gigabit interfaces that can be aggregated with each other and directly connect both servers with aggregated 2 gigabit links.  Or use network cards with SPF + 10GBASE, but this is expensive. <br><br><h3>  <font color="#018bc7">Power reserve</font> </h3><br>  When calculating and choosing a server, it is necessary to take into account peak loads.  Also, be sure to remember that the database will only "swell", the volume of data on the terminal server will grow, and the number of users may increase.  Many enterprises save on power reserves and in six months or a year they face interruptions in work and user complaints.  This is the case when excessive savings lead to new costs in the future - the miser pays twice.  The options chosen by us are calculated with a margin of power and the possibility of an upgrade.  It is taken into account that in the DELL R710 it will be possible to add two more hard disks and RAM, as well as replace processors with more productive ones. <br><br>  So, if you need an extension, or the number of services increases, there are great prospects, and the existing servers will effectively carry out their tasks for a long time.  Maybe in a year we will unexpectedly need to double the number of users, up to 60 people?  You are welcome. <br><br>  If you used one DELL R710 server, then you can buy an inexpensive IBM x3550 M3, pick up a hypervisor on it, move a virtual machine with a database and a 1C server there, and give all resources to a virtual machine with a terminal.  It will be fast, and you will not need to ‚Äúthrow everything out and buy something new.‚Äù <br>  If you used two IBM servers, then the x3550 M3 with the addition of a second processor and a small amount of RAM turns from a middling into a fairly powerful machine.  And in x3250 M5, you can upgrade the processor from E3-1220v3 to E3-1285v3. <br><br><h3>  <font color="#018bc7">Conclusion</font> </h3><br>  Of course, the proposed configurations are far <a href="http://pc-administrator.ru/">from the only equipment options</a> , for example, for implementing the same 1C.  Here a lot depends on the current infrastructure, the load level and its increase in the future, as well as the budget.  Therefore, you can always choose a similar server models, or more powerful and expensive. </div><p>Source: <a href="https://habr.com/ru/post/305878/">https://habr.com/ru/post/305878/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../305866/index.html">List of useful resources on Microsoft SQL Server</a></li>
<li><a href="../305868/index.html">Speech synthesizer "for robots" from scratch</a></li>
<li><a href="../305870/index.html">How Linus Torvalds made software development freer</a></li>
<li><a href="../305872/index.html">Solution of the problem "Performance Evaluation" mlbootcamp.ru</a></li>
<li><a href="../305876/index.html">Restrictions on the use of smart LEDs WS2812, WS2801 and similar in modern projects of decorative lighting</a></li>
<li><a href="../305880/index.html">What's new is expected in v4.8-rc1 core for Intel Edison. Digest</a></li>
<li><a href="../305882/index.html">Pass a technical interview (Level 4)</a></li>
<li><a href="../305886/index.html">VShBI Lectures: Game Design and Game Operations</a></li>
<li><a href="../305888/index.html">Agile API - is it possible?</a></li>
<li><a href="../305890/index.html">The digest of interesting events from the world of Java, and around it # 6 (07/04/2016 - 07/17/2016)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>