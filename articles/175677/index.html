<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Counter of individual time counting on pure JavaScript</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Sometimes you need to implement a countdown for each visitor individually, on one-page pages or sites - without installing plug-ins and connecting lib...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Counter of individual time counting on pure JavaScript</h1><div class="post__text post__text-html js-mediator-article">  Sometimes you need to implement a countdown for each visitor individually, on one-page pages or sites - without installing plug-ins and connecting libraries (for example, jQuery).  To solve this problem, I developed a counter in pure JavaScript. <br>  This counter works as follows: <br><ol><li>  Activated when the page loads. </li><li>  Checks for the presence of a countdown record in the visitor‚Äôs browser cookie. </li><li>  If there is a record, then it reads it.  If there is no record, it takes the time specified in the script settings, and makes an entry in the visitor's browser cookie. </li><li>  The time is converted into a format for more flexible settings for the design of the counter. </li><li>  A counter is displayed, or an indication of the end of the countdown (if time is up) at the place where the script was called. </li></ol><a name="habracut"></a><br>  Now let's sort the counter code itself. <br>  To begin with, I wrote down the functions of reading and writing Cookies like this: <br><pre><code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//  Cookie function getCookie(c_name) { var i, x, y, ARRcookies = document.cookie.split(";"); for (i = 0; i &lt; ARRcookies.length; i++) { x = ARRcookies[i].substr(0, ARRcookies[i].indexOf("=")); y = ARRcookies[i].substr(ARRcookies[i].indexOf("=") + 1); x = x.replace(/^\s+|\s+$/g, ""); if (x == c_name) { return unescape(y); } } } //  Cookie function setCookie(c_name, value, exdays) { var exdate = new Date(); exdate.setDate(exdate.getDate() + exdays); var c_value = escape(value) + ((exdays == null) ? "" : "; expires=" + exdate.toUTCString()); document.cookie = c_name + "=" + c_value; }</span></span></code> </pre> <br>  Then I used the cookie functions written above, and checked if previously recorded values ‚Äã‚Äãexist in the cookie with the name ‚ÄúBig Day‚Äù. <br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//     var str = getCookie('Big Day'); //  Cookie if(!str) //   Cookie     { var BigDay = new Date(); BigDay.setMinutes(BigDay.getMinutes()+1); //      setCookie('Big Day', BigDay, 3); //  Cookie }else{ BigDay = new Date(str); }</span></span></code> </pre><br>  After the completion time of the reference has become known, the calculation of the remaining time until the end of the reference is carried out.  But to further be able to more flexibly customize the design of the counter - we reduce the time to seconds. <br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//         var today = new Date(); var diff = BigDay - today; var countdown4 = Math.round(diff / 1000) //     </span></span></code> </pre><br>  When we have the remaining time in seconds, we can adjust it to the desired form.  In order not to litter the article (as it is a bit cumbersome by the number of lines), this part of the script is hidden under the spoiler: <br><div class="spoiler">  <b class="spoiler_title">Hidden part of the script</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//       :  :  :  function convert_to_time(secs) { secs = parseInt(secs); hh = secs / 3600; hh = parseInt(hh); mmt = secs - (hh * 3600); mm = mmt / 60; mm = parseInt(mm); ss = mmt - (mm * 60); if (hh &gt; 23) { dd = hh / 24; dd = parseInt(dd); hh = hh - (dd * 24); } else { dd = 0; } if (ss &lt; 10) { ss = "0" + ss; } if (mm &lt; 10) { mm = "0" + mm; } if (hh &lt; 10) { hh = "0" + hh; } if (dd == 0) { return (hh + ":" + mm + ":" + ss); } else { if (dd &gt; 1) { return (dd + " day " + hh + ":" + mm + ":" + ss); } else { return (dd + " day " + hh + ":" + mm + ":" + ss); } } }</span></span></code> </pre></div></div><br>  Now we make the penultimate dash and proceed to the graphic part of the script.  Here there is a check of what to display on the page - the timer with the remaining time or the message that the timer counted to 0:00:00. <br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//  -         do_cd4 = function() { if (countdown4 &lt; 0) { document.getElementById('cd4').innerHTML = " !"; } else { document.getElementById('cd4').innerHTML = convert_to_time(countdown4); setTimeout('do_cd4()', 1000); } countdown4 = countdown4 - 1; }</span></span></code> </pre><br>  And finally - we assign styles to our counter and output it to the javascript file connection point, inside of which all the counter code itself is located. <br><pre> <code class="javascript hljs"><span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.write(<span class="hljs-string"><span class="hljs-string">"&lt;div id='cd4' style='text-align: center; font-size: 40pt'&gt;&lt;/div&gt;\n"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//     do_cd4(); //    </span></span></code> </pre><br>  That's it, the meter is ready ‚Äúfor work and defense‚Äù. <br><br>  <a href="https://github.com/Qwikky/scriptoto">Download the script at this link (github.com).</a> </div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/175677/">https://habr.com/ru/post/175677/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../175661/index.html">Windows Phone and continuous integration into TeamCity</a></li>
<li><a href="../175663/index.html">Installing Nexus 1000V on vSphere 5.1 (Part One)</a></li>
<li><a href="../175665/index.html">Browser Games (Poll)</a></li>
<li><a href="../175669/index.html">PXE boot menu with System Center Configuration Manager</a></li>
<li><a href="../175671/index.html">Petman from Boston Dynamics is ready to serve</a></li>
<li><a href="../175681/index.html">The digest of interesting news and materials from the world of ayti for the last week ‚Ññ51 (March 30 - April 5, 2013)</a></li>
<li><a href="../175683/index.html">The first real Russian smartphone?</a></li>
<li><a href="../175685/index.html">GitHub Pages are moving to github.io</a></li>
<li><a href="../175689/index.html">Corona SDK Starter - free version</a></li>
<li><a href="../175693/index.html">Jolla Releases SailfishOS SDK for MOSOS and Windows</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>