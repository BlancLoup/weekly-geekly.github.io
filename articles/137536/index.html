<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Writing an error handler for phpredis</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It all started with the fact that in our company we decided to make a proxy / load balancer that, depending on the key, would send a request to one or...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Writing an error handler for phpredis</h1><div class="post__text post__text-html js-mediator-article">  It all started with the fact that in our company we decided to make a proxy / load balancer that, depending on the key, would send a request to one or another Redis instance.  Since ideally nothing works right away, the project written in php, working with radish (using phpredis) through this same balancer, took off with enviable regularity with critical errors.  Alas, the proxy did not always correctly collect complex server responses ... <br>  Working with Redis in the code every 10 lines, and there was no desire to wrap each call in try, catch, but it was not very convenient to debug with constant departures.  Then I came up with the idea to replace the Redis object with my own, from the inside of which I would have called all the methods of a real object ... <br><a name="habracut"></a><br>  It is natural to duplicate all the methods of the original class is very expensive, and why not, because there is a wonderful method <a href="http://www.php.net/manual/en/language.oop5.overloading.php">__call</a> , which is accessed, when calling a non-existent method of the object.  At the input we get the name of the requested method and an array of arguments, and then successfully call the required method of the original object using <a href="http://php.net/manual/en/function.call-user-func-array.php">call_user_func_array</a> .  Thus wrap in try, catch, we need only one call call_user_func_array. <br>  The total __call method is as follows: <br><pre><code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__call</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($name, $arguments)</span></span></span><span class="hljs-function"> </span></span>{ $i=<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> call_user_func_array(<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;obj, $name), $arguments); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">Exception</span></span> $e) { <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;handle_exception($e,$name,$arguments); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($i&lt;<span class="hljs-number"><span class="hljs-number">5</span></span>) $i++; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">die</span></span>(<span class="hljs-string"><span class="hljs-string">'5 time redis lug'</span></span>); } } }</code> </pre> <br>  If an error occurs, we send it to the handler, and we try to call the same method again.  After 5 unsuccessful calls, we stop torturing the proxy and go to the smoke logs ... <br><br>  The first version of the class looked like this: <br><pre> <code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RedisErrHandler</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $obj; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $ip; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $port; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $timeout; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__construct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($ip,$port,$timeout=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ip=$ip; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;port=$port; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;timeout=$timeout; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;rconnect(); } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">rconnect</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;obj=<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Redis; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;obj-&gt;connect(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ip,<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;port,<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;timeout) <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-keyword"><span class="hljs-keyword">die</span></span>(<span class="hljs-string"><span class="hljs-string">'Error connecting redis'</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__call</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($name, $arguments)</span></span></span><span class="hljs-function"> </span></span>{ $i=<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> call_user_func_array(<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;obj, $name), $arguments); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">Exception</span></span> $e) { <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;handle_exception($e,$name,$arguments); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($i&lt;<span class="hljs-number"><span class="hljs-number">5</span></span>) $i++; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">die</span></span>(<span class="hljs-string"><span class="hljs-string">'5 time redis lug'</span></span>); } } } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">handle_exception</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($e,$name,$args)</span></span></span><span class="hljs-function"> </span></span>{ $err=$e-&gt;getMessage(); $msg=<span class="hljs-string"><span class="hljs-string">"Caught exception: "</span></span>.$err.<span class="hljs-string"><span class="hljs-string">"\tcall "</span></span>.$name.<span class="hljs-string"><span class="hljs-string">"\targs "</span></span>.implode(<span class="hljs-string"><span class="hljs-string">" "</span></span>,$args).<span class="hljs-string"><span class="hljs-string">"\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($_SERVER[<span class="hljs-string"><span class="hljs-string">'LOG'</span></span>]) { $handle2=fopen(<span class="hljs-string"><span class="hljs-string">'redis_log.txt'</span></span>,<span class="hljs-string"><span class="hljs-string">'a'</span></span>); fwrite($handle2,date(<span class="hljs-string"><span class="hljs-string">'H:i:s'</span></span>).<span class="hljs-string"><span class="hljs-string">"\t$msg"</span></span>); fclose($handle2); } <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $msg; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(substr(trim($err),<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">37</span></span>)==<span class="hljs-string"><span class="hljs-string">'Caught exception: protocol error, got'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">die</span></span>(<span class="hljs-string"><span class="hljs-string">'bye'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;rconnect(); } }</code> </pre><br>  He reconnected at each departure and "died" when departing with the error "protocol error", because it was precisely these errors that we hunted. <br><br>  To integrate it, you just had to replace it. <br><pre> <code class="php hljs">$r=<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Redis(); $r-&gt;connect(<span class="hljs-string"><span class="hljs-string">'127.0.0.1'</span></span>,<span class="hljs-number"><span class="hljs-number">6379</span></span>,<span class="hljs-number"><span class="hljs-number">10</span></span>);</code> </pre>  on <br><pre> <code class="php hljs">$r=<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RedisErrHandler(<span class="hljs-string"><span class="hljs-string">'127.0.0.1'</span></span>,<span class="hljs-number"><span class="hljs-number">6379</span></span>,<span class="hljs-number"><span class="hljs-number">10</span></span>);</code> </pre> <br>  This option worked fine for the time being, until once the script crashed while working with multi.  Since a separate object is allocated for transactions in phpredis, it became clear that you need to write a wrapper for it as well. <br>  First of all, the multi method was added to the above class: <br><pre> <code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">multi</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($type)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RedisMultiErrHandler(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;obj,$type,<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ip,<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;port,<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;timeout); }</code> </pre> <br>  Well, the class for error handling in the transaction object is written, by analogy to the previous one: <br><pre> <code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RedisMultiErrHandler</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $obj; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $ip; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $port; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $timeout; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $m; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $type; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $commands; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__construct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(&amp;$redis,$type,$ip,$port,$timeout=</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ip=$ip; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;port=$port; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;timeout=$timeout; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;type=$type; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;obj=$redis; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;m=<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;obj-&gt;multi($type); } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">rconnect</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;obj=<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Redis; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;obj-&gt;connect(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;ip,<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;port,<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;timeout) <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-keyword"><span class="hljs-keyword">die</span></span>(<span class="hljs-string"><span class="hljs-string">'Error connecting redis'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;m=<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;obj-&gt;multi(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;type); } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__call</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($name, $arguments)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;commands[]=<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'name'</span></span>=&gt;$name, <span class="hljs-string"><span class="hljs-string">'arguments'</span></span>=&gt;$arguments); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">handle_exception</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($e)</span></span></span><span class="hljs-function"> </span></span>{ $err=$e-&gt;getMessage(); $msg=<span class="hljs-string"><span class="hljs-string">''</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;commands <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $command) { $msg.=<span class="hljs-string"><span class="hljs-string">"Multi sent\tcall "</span></span>.$command[<span class="hljs-string"><span class="hljs-string">'name'</span></span>].<span class="hljs-string"><span class="hljs-string">"\targs "</span></span>.implode(<span class="hljs-string"><span class="hljs-string">" "</span></span>,$command[<span class="hljs-string"><span class="hljs-string">'arguments'</span></span>]).<span class="hljs-string"><span class="hljs-string">"\n"</span></span>; } $msg.=<span class="hljs-string"><span class="hljs-string">"Caught exception: "</span></span>.$err.<span class="hljs-string"><span class="hljs-string">"\n"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($_SERVER[<span class="hljs-string"><span class="hljs-string">'LOG'</span></span>]) { $handle2=fopen(<span class="hljs-string"><span class="hljs-string">'redis_multi_log.txt'</span></span>,<span class="hljs-string"><span class="hljs-string">'a'</span></span>); fwrite($handle2,date(<span class="hljs-string"><span class="hljs-string">'H:i:s'</span></span>).<span class="hljs-string"><span class="hljs-string">"\t$msg"</span></span>); fclose($handle2); } <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $msg; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(substr(trim($err),<span class="hljs-number"><span class="hljs-number">0</span></span>,<span class="hljs-number"><span class="hljs-number">37</span></span>)==<span class="hljs-string"><span class="hljs-string">'Caught exception: protocol error, got'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">die</span></span>(<span class="hljs-string"><span class="hljs-string">'bye'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;rconnect(); } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">exec</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ $i=<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">foreach</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;commands <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> $command) { call_user_func_array(<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;m, $command[<span class="hljs-string"><span class="hljs-string">'name'</span></span>]), $command[<span class="hljs-string"><span class="hljs-string">'arguments'</span></span>]); } <span class="hljs-keyword"><span class="hljs-keyword">try</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;m-&gt;exec(); <span class="hljs-keyword"><span class="hljs-keyword">break</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">Exception</span></span> $e) { <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;handle_exception($e); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>($i&lt;<span class="hljs-number"><span class="hljs-number">5</span></span>) $i++; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">die</span></span>(<span class="hljs-string"><span class="hljs-string">'5 time mredis lug'</span></span>); } } } }</code> </pre> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In order to be able to re-send all the transaction commands on departure, all calls, except exec (), which directly completes the transaction, were entered into an array and sent to the server when the latter was called.  Discard is not used in our code because in the class it could not stand it separately. <br><br>  Considering that sometimes, although extremely rarely, the connection with radish hangs even without the use of a proxy, these wrappers are successfully used to this day. </div><p>Source: <a href="https://habr.com/ru/post/137536/">https://habr.com/ru/post/137536/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../137528/index.html">Chrome won first place in Russia</a></li>
<li><a href="../137529/index.html">Intel Anti-Theft Special Forces</a></li>
<li><a href="../137530/index.html">Some details about Class Based Views, part 3</a></li>
<li><a href="../137532/index.html">Augmented Reality Contact Lenses</a></li>
<li><a href="../137534/index.html">"One Last Thing" - a documentary about Steve Jobs (2011), professional Russian translation</a></li>
<li><a href="../137542/index.html">Minecraft Physics World</a></li>
<li><a href="../137543/index.html">Java SOAP Server with Apache CXF and Spring</a></li>
<li><a href="../137544/index.html">Crypt fonts</a></li>
<li><a href="../137545/index.html">Come to Kharkov and burn with us at Ciklum Mobile Subbotnik and iPhoneDevCamp 2012</a></li>
<li><a href="../137548/index.html">Fair voting on the Internet using sms</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>