<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Placing the node.js application on dotcloud.com</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="dotCloud is a cloud-based platform for hosting web applications. Free account is well suited for training. 

 Its advantages: 


- You can use two ser...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Placing the node.js application on dotcloud.com</h1><div class="post__text post__text-html js-mediator-article">  <a href="https://www.dotcloud.com/">dotCloud</a> is a cloud-based platform for hosting web applications.  Free account is well suited for training. <br><br>  Its advantages: <br><ul><li>  You can use two services for free.  Unlike <a href="http://www.heroku.com/pricing">heroku</a> , you can make a full-fledged database application. </li><li>  file system is available for writing - it will be more convenient to keep logs </li><li>  good <a href="http://docs.dotcloud.com/firststeps/platform-overview/">documentation</a> . </li></ul><br><br>  But there are also disadvantages: <br><ul><li>  free services ‚Äúfall asleep‚Äù if no one has used them for the last half hour.  This means that such a situation is possible: you go to your site and instead see the standard service page asking you to wait.  After some time (up to several minutes) the service ‚Äúwakes up‚Äù and starts working as it should be. </li><li> the default version is <code>node 0.4.10</code> .  But it can be fixed. </li></ul><br><a name="habracut"></a><br>  <em>Warning: Most of what is written below is a brief retelling of <a href="http://docs.dotcloud.com/firststeps/platform-overview/">official documentation</a> .</em>  <em>Of course, it would be better to read the full version.</em> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Terms </h2><br>  When working with DotCloud, the word <em>application</em> (application) means a set of <em>services</em> (services) that you use.  The service can be a single node.js process (php, python, ruby, etc.) or a single database instance.  For example, from the php and mysql services, you can make a ‚Äúwordpress blog‚Äù application. <br><br>  When you register on the site, in the Settings section you will see the so-called <em>API Key</em> - a randomly generated sequence of letters and numbers.  She will need to continue to work with the platform. <br><br>  All actions with DotCloud are performed using a special <code>dotcloud</code> utility (in the documentation it is called the CLI - Command-Line Interface). <br><br><h2>  CLI Installation </h2><br>  <a href="http://docs.dotcloud.com/firststeps/install/">The CLI is</a> written in Python and uses the EasyInstall package manager, so you first need to <a href="http://www.linuxask.com/questions/how-to-install-easy-install-for-python-in-ubuntu">install it</a> : <br><br><pre> <code class="bash hljs">sudo apt-get install python-setuptools python-dev build-essential</code> </pre> <br>  and then <br><pre> <code class="bash hljs">sudo easy_install pip &amp;&amp; sudo pip install dotcloud</code> </pre> <br><br>  As a result, the <em>dotcloud</em> utility will appear on your system.  When you first start you will need to enter your <em>API Key</em> . <br><br><h2>  Application installation </h2><br>  The simplest example of the application was found <a href="https://github.com/atodorov/dotcloud-nodejs-hello-world">here</a> .  But it does nothing, and therefore not very interesting. <br><br><h3>  Source preparation </h3><br>  Suppose you already have some kind of running node.js application.  You can use the <a href="https://github.com/hacksparrow/ninja-store">example</a> from this <a href="http://www.hacksparrow.com/express-js-tutorial.html">article</a> .  It will be necessary to make one change: <strong>dotCloud applications are required <a href="http://docs.dotcloud.com/services/nodejs/">to listen to port 8080</a></strong> .  After deployment, it will be available as usual, on port 80, but in the source code it should be exactly 8080. <br><br><h3>  Application Description </h3><br>  For deployment, you need to create and put in the right places on the file system three files: <code>dotcloud.yml</code> , <code>supervisord.conf</code> and <code>package.json</code> .  As a result, you should get this structure: <br><br><pre> <code class="bash hljs">ninja_on_dotcloud/ |_ dotcloud.yml |_ ninja-store/        |_ supervisord.conf |_ package.json |_ app.js    |_ ...      </code> </pre> <br>  The <code>dotcloud.yml</code> file describes the set of services that our application uses.  We have one service, so <code>dotcloud.yml</code> looks like this: <br><br><pre> <code class="javascript hljs">www: type: nodejs approot: ninja-store</code> </pre> <br>  Here <code>www</code> is the name of the service (theoretically it can be any), <code>ninja-store</code> is our source folder. <br>  <code>supervisord.conf</code> also simple: <br><pre> <code class="python hljs">[program:node] command = node app.js directory = /home/dotcloud/current</code> </pre> <br>  In this case, <code>app.js</code> is the main file of our application. <br><br>  <a href="http://npmjs.org/doc/json.html">package.json</a> is a standard <a href="http://npmjs.org/doc/">npm</a> file.  For placement on dotCloud, only the <a href="http://npmjs.org/doc/json.html">dependencies</a> section is important in which the packages used by your application are listed. <br><br><h3>  Deployment </h3><br>  To get it all to the server, you need to run two commands. <br><br>  First create an application <br><pre> <code class="bash hljs">dotcloud create -f sandbox nstore</code> </pre><br>  The <code>-f</code> key sets the <a href="http://docs.dotcloud.com/guides/flavors/">application flavor</a> - roughly speaking, the tariff plan and hosting options.  <code>nstore</code> - the name of our application, will be needed for further management. <br><br>  And finally, send the code of our site to the server <br><pre> <code class="bash hljs">dotcloud push nstore ./ninja_on_dotcloud</code> </pre> <br>  As a result, if everything goes well, then the console will write the address at which the application will be available.  In my case, it is <a href="http://nstore-beardog.dotcloud.com/">http://nstore-beardog.dotcloud.com/</a> .  The rules by which this URL is formed may change: a year ago, a random sequence of characters was simply generated, and the name of the application and account is now combined.  You cannot use your own domain with a free account. <br><br>  And if it is bad, you will have to watch the logs. <br><br><h2>  View logs </h2><br>  If the application is successfully launched, you can see the logs with the <a href="http://docs.dotcloud.com/guides/logs/">command</a> <br><br><pre> <code class="bash hljs">dotcloud logs _._</code> </pre> <br>  It happens that an application cannot be started (for example, if you forget to specify a dependency in package.json).  Then you need to use something like very truncated <a href="http://docs.dotcloud.com/guides/logs/">ssh access</a> .  For example, this is how I discovered that in version 0.4.10 there is a shortage of the <a href="http://nodejs.org/api/zlib.html">zlib</a> module, which is necessary for the work of express.js: <br><br><pre> <code class="bash hljs">user@u5$ dotcloud ssh ninjastore.www <span class="hljs-comment"><span class="hljs-comment"># $SHELL dotcloud@ninjastore-default-www-0:~$ ls /var/log/supervisor/ node-stderr---supervisor-7vur0l.log node-stdout---supervisor-xqRYq7.log supervisord.log dotcloud@ninjastore-default-www-0:~$ tail --lines=20 /var/log/supervisor/node-stderr---supervisor-7vur0l.log node.js:134 throw e; // process.nextTick error, or 'error' event on first tick ^ Error: Cannot find module 'zlib' at Function._resolveFilename (module.js:317:11) at Function._load (module.js:262:25) at require (module.js:346:19) at Object.&lt;anonymous&gt; (/home/dotcloud/node_modules/express/node_modules/connect/lib/middleware/compress.js:14:12) at Module._compile (module.js:402:26) at Object..js (module.js:408:10) at Module.load (module.js:334:31) at Function._load (module.js:293:12) at require (module.js:346:19) at Object.compress (/home/dotcloud/node_modules/express/node_modules/connect/lib/connect.js:89:14)</span></span></code> </pre><br><br>  The names of files with logs can change with the release of the new version of the platform, so you will not be able to give clear instructions.  Most likely, somewhere in <code>/var/log/</code> there is a file with the necessary information. <br><br><h2>  Installing other versions of node </h2><br>  Thanks to the hack shown in <a href="https://github.com/dotcloud/node-on-dotcloud">this repository</a> , any version of node.js can be installed on dotCloud. <br><br>  Need to: <br><br><ol><li>  Copy <a href="https://github.com/dotcloud/node-on-dotcloud">repository</a> </li><li>  In the dotcloud.yml file in the <code>node_version</code> field indicate the version you want </li><li>  Naturally, replace <code>hellonode</code> with your sources </li><li>  Run <code>dotcloud push</code> as usual. </li></ol><br><br>  <em>Important: delete the .git folder after cloning.</em>  <em>If dotcloud notices it, it will try to <a href="http://docs.dotcloud.com/guides/git-hg/">pick up the source from github</a> , instead of using the local version.</em> <br><br>  As a result, during the installation, <code>dotcloud</code> downloads and <code>dotcloud</code> sources of the specified node version.  The following calls to <code>push</code> will not compile. <br><br>  Perhaps there will be problems with the logs, then you can try <a href="https://github.com/afoong/node-on-dotcloud">this version.</a> <br><br>  Another possible problem is the port that the application should listen to.  For some reason, in that example, it is defined <a href="">like this</a> : <br><br><pre> <code class="javascript hljs">}).listen(process.env[<span class="hljs-string"><span class="hljs-string">'PORT_WWW'</span></span>] || <span class="hljs-number"><span class="hljs-number">8080</span></span>);</code> </pre> <br><br>  All thanks for your attention.  <a href="http://steveram.info/blog/2011/08/02/dotcloud-deploying-a-nodejsmongodb-app/">Here there</a> was another article about dotcloud, mongodb and node.  And a year ago, <a href="http://habrahabr.ru/post/125375/">an article</a> with the same title appeared on Habr√© (unfortunately, I found it after I wrote my own) </div><p>Source: <a href="https://habr.com/ru/post/147181/">https://habr.com/ru/post/147181/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../147176/index.html">Logitech - the best warranty service</a></li>
<li><a href="../147177/index.html">Yandex.Money for shopping in the Opera Mobile Store</a></li>
<li><a href="../147178/index.html">Ask jay</a></li>
<li><a href="../147179/index.html">Save contact information to Google Contacts</a></li>
<li><a href="../147180/index.html">Piama Day at CodeFest Mini, July 28</a></li>
<li><a href="../147182/index.html">The third free school iOS developers in St. Petersburg</a></li>
<li><a href="../147183/index.html">Survey on controls</a></li>
<li><a href="../147184/index.html">Are you interested in the LoadBalancer service?</a></li>
<li><a href="../147185/index.html">Virtual graphics card QXL on real hardware</a></li>
<li><a href="../147186/index.html">New branding for Microsoft</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>