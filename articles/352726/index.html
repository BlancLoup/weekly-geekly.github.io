<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Enough automation - it's time to draw an owl on PowerShell and teach the console to speak</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today is PowerShell's finest hour: the time of strange scripts and games created with the help of ‚ÄúPowerful Shell‚Äù. If you are tired of a serious rout...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Enough automation - it's time to draw an owl on PowerShell and teach the console to speak</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/webt/km/re/c7/kmrec7sokfd-jkqe0ue17gruurm.jpeg"></p><br><p>  Today is PowerShell's finest hour: the time of strange scripts and games created with the help of ‚ÄúPowerful Shell‚Äù.  If you are tired of a serious routine and want to look at other talents of PowerShell, I invite you to the cat. <a name="habracut"></a></p><br><h1 id="govoryaschaya-konsol">  Talking console </h1><br><p>  Perhaps we will begin with the simplest entertainment - the talking console.  In the Windows family, the speech synthesis interface has been around for a long time: in the .Net library it is called System.Speech, and for preferring COM objects it is called SAPI.SpVoice.  PowerShell allows you to use both methods. </p><br><p>  Check the operation of the interface with the following script: </p><br><pre><code class="hljs php">Add-Type -AssemblyName System.Speech $voice = <span class="hljs-keyword"><span class="hljs-keyword">New</span></span>-Object System.Speech.Synthesis.SpeechSynthesizer $voice.Speak(<span class="hljs-string"><span class="hljs-string">"-- ‚Äî    ,    !"</span></span>)</code> </pre> <br><p>  Several voices can be installed in the system - there are variants of different nationalities, ages and genders, each with its own name.  You can view the general list with the command: </p><br><pre> <code class="hljs perl">$voice.GetInstalledVoices().VoiceInfo</code> </pre> <br><p><img src="https://habrastorage.org/webt/9g/zg/qx/9gzgqxhhrp_-gfcu5fihudc7lmy.jpeg"><br>  <em>Irina and Zira are ready.</em> </p><br><blockquote>  Additional ‚Äúimaginary friends‚Äù can be downloaded along with the input language through the standard Windows interface, from the <a href="http://www.microsoft.com/en-us/download/details.aspx%3Fid%3D27224">Microsoft</a> website or from <a href="http://www.zero2000.com/free-text-to-speech-natural-voices.html">external sources</a> . </blockquote><p>  You can select the appropriate voice with the command: </p><br><pre> <code class="hljs perl">$voice.SelectVoice(<span class="hljs-string"><span class="hljs-string">""</span></span>)</code> </pre> <br><p>  Armed with this knowledge, you can collect monitoring, which would speak about the fall of the server, or surprise your colleagues with the help of your favorite tool for remote access to their machines.  You can use our material " <a href="https://habrahabr.ru/company/pc-administrator/blog/342428/">1000 ++ way to run commands on a remote computer</a> ." </p><br><p>  As ready examples I will leave some links: </p><br><ul><li>  <a href="http://mattblogsit.com/oob/powershell-pranks-making-work-fun-with-creepy-voices">PowerShell Pranks</a> in the <em>Matt Blogs IT</em> blog. </li><li>  <a href="http://mikefrobbins.com/2013/09/19/fun-and-games-with-powershell/">Fun and Games with PowerShell</a> in the <em>Mike F Robbins</em> blog. </li><li>  The script <a href="https://gist.github.com/jrgcubano/0f9b9d6f7a2dddfdef9e">funtalk.ps1</a> from <em>Jorge Rodr√≠guez Gal√°n</em> . </li></ul><br><p>  But one opportunity to tell us, of course, is not enough.  How about that, so that the console still welcomed melody at the opening? </p><br><h1 id="privet-username">  Hi% USERNAME% </h1><br><p>  PowerShell has a profile concept.  You can read more about this in the <a href="https://technet.microsoft.com/en-us/library/bb613488(v%3Dvs.85).aspx">Windows PowerShell Profiles</a> material on TechNet.  I note only that with the help of profiles you can configure the following entities: </p><br><ul><li>  Aliases commands </li><li>  The size of the console window. </li><li>  The color and title of the window. </li><li>  Start folder instead of user profile. </li><li>  Run tasks when opening the console. </li></ul><br><p>  The latter option allows, for example, to play music every time someone opens the PowerShell window.  As a preparation, you need to create a profile, if you still don‚Äôt have it, with the following command: </p><br><pre> <code class="hljs vhdl"><span class="hljs-keyword"><span class="hljs-keyword">New</span></span>-Item -path $profile -<span class="hljs-keyword"><span class="hljs-keyword">type</span></span> <span class="hljs-keyword"><span class="hljs-keyword">file</span></span> -<span class="hljs-keyword"><span class="hljs-keyword">force</span></span></code> </pre> <br><p>  Now you can change the profile with any editor - for example, PowerShell ISE: </p><br><pre> <code class="hljs perl">PowerShell_ISE.exe $profile</code> </pre> <br><p>  As an example of launching a task, the user of the spiceworks portal <a href="https://community.spiceworks.com/people/lwbm">Luke Murray</a> suggested playing the imperial march with the following script: </p><br><pre> <code class="hljs javascript">start-job { [<span class="hljs-built_in"><span class="hljs-built_in">console</span></span>]::beep(<span class="hljs-number"><span class="hljs-number">440</span></span>,<span class="hljs-number"><span class="hljs-number">500</span></span>) [<span class="hljs-built_in"><span class="hljs-built_in">console</span></span>]::beep(<span class="hljs-number"><span class="hljs-number">440</span></span>,<span class="hljs-number"><span class="hljs-number">500</span></span>) [<span class="hljs-built_in"><span class="hljs-built_in">console</span></span>]::beep(<span class="hljs-number"><span class="hljs-number">440</span></span>,<span class="hljs-number"><span class="hljs-number">500</span></span>) [<span class="hljs-built_in"><span class="hljs-built_in">console</span></span>]::beep(<span class="hljs-number"><span class="hljs-number">349</span></span>,<span class="hljs-number"><span class="hljs-number">350</span></span>) [<span class="hljs-built_in"><span class="hljs-built_in">console</span></span>]::beep(<span class="hljs-number"><span class="hljs-number">523</span></span>,<span class="hljs-number"><span class="hljs-number">150</span></span>) [<span class="hljs-built_in"><span class="hljs-built_in">console</span></span>]::beep(<span class="hljs-number"><span class="hljs-number">440</span></span>,<span class="hljs-number"><span class="hljs-number">500</span></span>) [<span class="hljs-built_in"><span class="hljs-built_in">console</span></span>]::beep(<span class="hljs-number"><span class="hljs-number">349</span></span>,<span class="hljs-number"><span class="hljs-number">350</span></span>) [<span class="hljs-built_in"><span class="hljs-built_in">console</span></span>]::beep(<span class="hljs-number"><span class="hljs-number">523</span></span>,<span class="hljs-number"><span class="hljs-number">150</span></span>) [<span class="hljs-built_in"><span class="hljs-built_in">console</span></span>]::beep(<span class="hljs-number"><span class="hljs-number">440</span></span>,<span class="hljs-number"><span class="hljs-number">1000</span></span>) [<span class="hljs-built_in"><span class="hljs-built_in">console</span></span>]::beep(<span class="hljs-number"><span class="hljs-number">659</span></span>,<span class="hljs-number"><span class="hljs-number">500</span></span>) [<span class="hljs-built_in"><span class="hljs-built_in">console</span></span>]::beep(<span class="hljs-number"><span class="hljs-number">659</span></span>,<span class="hljs-number"><span class="hljs-number">500</span></span>) [<span class="hljs-built_in"><span class="hljs-built_in">console</span></span>]::beep(<span class="hljs-number"><span class="hljs-number">659</span></span>,<span class="hljs-number"><span class="hljs-number">500</span></span>) [<span class="hljs-built_in"><span class="hljs-built_in">console</span></span>]::beep(<span class="hljs-number"><span class="hljs-number">698</span></span>,<span class="hljs-number"><span class="hljs-number">350</span></span>) [<span class="hljs-built_in"><span class="hljs-built_in">console</span></span>]::beep(<span class="hljs-number"><span class="hljs-number">523</span></span>,<span class="hljs-number"><span class="hljs-number">150</span></span>) [<span class="hljs-built_in"><span class="hljs-built_in">console</span></span>]::beep(<span class="hljs-number"><span class="hljs-number">415</span></span>,<span class="hljs-number"><span class="hljs-number">500</span></span>) [<span class="hljs-built_in"><span class="hljs-built_in">console</span></span>]::beep(<span class="hljs-number"><span class="hljs-number">349</span></span>,<span class="hljs-number"><span class="hljs-number">350</span></span>) [<span class="hljs-built_in"><span class="hljs-built_in">console</span></span>]::beep(<span class="hljs-number"><span class="hljs-number">523</span></span>,<span class="hljs-number"><span class="hljs-number">150</span></span>) [<span class="hljs-built_in"><span class="hljs-built_in">console</span></span>]::beep(<span class="hljs-number"><span class="hljs-number">440</span></span>,<span class="hljs-number"><span class="hljs-number">1000</span></span>) }</code> </pre> <br><p>  As a task, you can also use the material from the previous section, so that the console tells a fairy tale when it starts up or importantly greeted the system administrator by name and patronymic.  And you can simply open the DVD-ROM (who still have these) with the command: </p><br><pre> <code class="hljs css">(<span class="hljs-selector-tag"><span class="hljs-selector-tag">New-Object</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-com</span></span> "<span class="hljs-selector-tag"><span class="hljs-selector-tag">WMPlayer</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.OCX</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.7</span></span>")<span class="hljs-selector-class"><span class="hljs-selector-class">.cdromcollection</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.item</span></span>(0)<span class="hljs-selector-class"><span class="hljs-selector-class">.eject</span></span>()</code> </pre> <br><p>  Here, the WMPlayer.OCX.7 object is used to open the ‚Äúcoffee stand‚Äù.  It can be used for its intended purpose - to play music. </p><br><h1 id="delaem-konsolnyy-pleer">  Making console player </h1><br><p>  If for some reason you don‚Äôt like the good old <strong>mpd</strong> and you‚Äôd like to reinvent the wheel - or rather look at the finished one - then the engineer, developer, and just a good person .  The peculiarity of the script is that it can mix reproducible tracks. </p><br><p>  The script can be immediately added to the PowerShell profile, and then run the player with one command: </p><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">Music</span></span> <span class="hljs-string"><span class="hljs-string">"    "</span></span></code> </pre> <br><p><img src="https://habrastorage.org/webt/sz/z2/tn/szz2tnfl6h5ygzgmyoozntsjacy.png"><br>  <em>Run player.</em> </p><br><p>  To control playback, you can run the command with the parameters Shuffle (shuffle), Loop (loop playback) and Stop (stop playback), and when you move to the next track, a system notification appears in the lower corner. </p><br><p><img src="https://habrastorage.org/webt/kt/uq/qf/ktuqqfqwgkj4wwnzd37ova-dhus.png"><br>  <em>Notification of the launch of a new track.</em> </p><br><p>  The full text of the script is available in the <a href="">repository of the author</a> . </p><br><p>  <em>Prateek Singh has a</em> lot of scripts of varying degrees of utility, so I‚Äôll give links to just some of them: </p><br><ul><li>  HTTP error <a href="https://geekeefy.wordpress.com/2017/12/14/introducing-psdecode-powershell-module-v0-9-0/">decoder</a> , network card manufacturer ID by MAC address, protocol descriptions by port, etc. </li><li>  <a href="https://geekeefy.wordpress.com/2017/09/04/plot-graph-in-powershell-console/">Module</a> for building diagrams. </li><li>  <a href="https://geekeefy.wordpress.com/2017/08/24/get-weather-report-using-powershell/">Weather forecast</a> with authentic console graphics. </li></ul><br><p><img src="https://habrastorage.org/webt/hm/gm/_p/hmgm_pxypbt_mzo-lhjkohwy3na.jpeg"><br>  <em>Weather forecast on PowerShell.</em>  <em>Because we can.</em> </p><br><p>  If we hit in multimedia, I will tell you about the option of creating objects for 3D printing, modeling and other augmented reality. </p><br><h1 id="kak-narisovat-sovu-teper-v-3d">  How to draw an owl, now in 3D! </h1><br><p>  In January, <em>Cosmos Darwin</em> published in his blog the article ‚Äú <a href="http://www.cosmosdarwin.com/2018/01/12/create-mixed-reality-models-in-powershell.html">Create mixed reality models in PowerShell‚Äù</a> , which discusses the possibility of generating 3D model files using PowerShell. </p><br><p>  If you disassemble the file .obj, then you can find there the coordinates of points with the designations " <strong>v</strong> ", and the coordinates of the planes under the letter " <strong>f"</strong> .  For example, a simple cube would look like this in a file: </p><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">v</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> v <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> v <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> v <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> v <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> v <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> v <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> v <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> f <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> f <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> f <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span> f <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> f <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> f <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span> <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span></code> </pre> <br><p>  If you save the resulting file and open it with a graphic viewer (for example, ‚Äúa mixed reality viewer‚Äù), then a cube will actually be drawn. </p><br><p><img src="https://habrastorage.org/webt/g1/ko/uu/g1kouuxpkaqyupk-my1jjeejs-i.jpeg"><br>  <em>Freshly created cube.</em> </p><br><p>  Creating files with more complex structures manually is more difficult, so mathematics and PowerShell come to the rescue. </p><br><p>  For example, you can create a glass of wine to the glory of Dionysus or Bacchus.  Since the glass is a figure of rotation, it is enough to create only half of the glass.  Then, with rotation, you get the desired vessel. </p><br><p><img src="https://habrastorage.org/webt/hu/l_/np/hul_npbloji68kztybwasgyt83w.png"><br>  <em>With the rotation of this figure you get a glass.</em> </p><br><p>  Next, add a few materials, remember the school course of mathematics, arrange in the form of a script and get a great glass. </p><br><p><img src="https://habrastorage.org/webt/f0/4f/wi/f04fwixkcjjgbsprhirxcbtnodg.png"><br>  <em>Ready to glass.</em> </p><br><p>  Ready scripts and textures are available in the account of the author GitHub in the project <a href="https://github.com/cosmosdarwin/obj-in-powershell">obj-in-powershell</a> .  We now turn to a more practical application of PowerShell and 3D. </p><br><h1 id="monitoring-na-unity">  Monitoring on unity </h1><br><p>  Just imagine: a beautiful map on the big screen in the IT room, which displays the objects of the monitoring system and their status.  And when there are no prying eyes, you can roll the map and watch the Simpsons. </p><br><p>  As the supplier of the card can be the same <a href="https://www.zabbix.com/">Zabbix</a> or <a href="http://www.kilievich.com/rus/fpinger/">Fpinger</a> .  But despite the excessive information content, with the beauty they have not.  <em>Micky Balladelli</em> undertook to correct this omission, using the capabilities of Unity as a set of <strong>PSUnity</strong> applications for <strong>visualization</strong> . </p><br><p>  The idea is simple - a server is started on a specific port, and a set of PowerShell cmdlets is used to add objects to monitor or change their status.  The client connects to the server and displays the resulting picture.  Statuses of objects can be taken from the usual monitoring system - for example, from Zabbix or SCOM. </p><br><p>  When you start the server without objects, you can watch a single R2D2 in the open field: </p><br><p><img src="https://habrastorage.org/webt/to/jc/0_/tojc0_lra_6hjqpjv0s1vdtumri.jpeg"><br>  <em>The droid we are looking for.</em> </p><br><p>  By the View button you can switch modes - data center, planet, space.  Pretty deserted. </p><br><p><img src="https://habrastorage.org/webt/ry/pf/v7/rypfv71edligcwmz-de_tc7byre.jpeg"><br>  <em>Unpopulated planet monitoring.</em> </p><br><p>  The situation changes when we start adding objects using PowerShell. </p><br><p>  You can connect to the server itself with the command: </p><br><pre> <code class="hljs php">$Session = <span class="hljs-keyword"><span class="hljs-keyword">New</span></span>-PSUnitySession -ComputerName localhost -Port <span class="hljs-number"><span class="hljs-number">7777</span></span></code> </pre> <br><p>  You can add objects to the map with the droid using the Set-PSUnityServer cmdlet: </p><br><pre> <code class="hljs sql"><span class="hljs-keyword"><span class="hljs-keyword">Set</span></span>-PSUnityServer -<span class="hljs-keyword"><span class="hljs-keyword">Session</span></span> $<span class="hljs-keyword"><span class="hljs-keyword">Session</span></span> -X <span class="hljs-number"><span class="hljs-number">0</span></span> -Y <span class="hljs-number"><span class="hljs-number">5</span></span> -<span class="hljs-keyword"><span class="hljs-keyword">Name</span></span> EXSRV1 -<span class="hljs-keyword"><span class="hljs-keyword">Role</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Exchange</span></span> -Location Maui -<span class="hljs-keyword"><span class="hljs-keyword">Status</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> -Description <span class="hljs-string"><span class="hljs-string">"EXSRV1 has drifted its configuration."</span></span></code> </pre> <br><p>  The above command will add a server with an ominous description. </p><br><p><img src="https://habrastorage.org/webt/z-/rs/ff/z-rsffkb3c7oahxdbej3xiuet-o.jpeg"><br>  <em>Added a server to the map, and R2D2 starts to study it.</em> </p><br><p>  To add a city to the planet and change its status, you can use the following commands: </p><br><pre> <code class="hljs sql"><span class="hljs-keyword"><span class="hljs-keyword">Set</span></span>-PSUnityCity -<span class="hljs-keyword"><span class="hljs-keyword">Session</span></span> $<span class="hljs-keyword"><span class="hljs-keyword">Session</span></span> -<span class="hljs-keyword"><span class="hljs-keyword">Name</span></span> <span class="hljs-string"><span class="hljs-string">"Moscow"</span></span> -<span class="hljs-keyword"><span class="hljs-keyword">Status</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span>-PSUnityCity -<span class="hljs-keyword"><span class="hljs-keyword">Session</span></span> $<span class="hljs-keyword"><span class="hljs-keyword">Session</span></span> -<span class="hljs-keyword"><span class="hljs-keyword">Name</span></span> <span class="hljs-string"><span class="hljs-string">"Saint Petersburg"</span></span> -<span class="hljs-keyword"><span class="hljs-keyword">Status</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> <br><p><img src="https://habrastorage.org/webt/ah/9j/f-/ah9jf-s7ilgzkcxwzzb3v6kxilu.jpeg"><br>  <em>Two cities added.</em> </p><br><p>  Another interesting view is two data centers with virtual machines and their statuses.  Add a couple: </p><br><pre> <code class="hljs sql"><span class="hljs-keyword"><span class="hljs-keyword">Set</span></span>-PSUnityCloudInfo -<span class="hljs-keyword"><span class="hljs-keyword">Session</span></span> $<span class="hljs-keyword"><span class="hljs-keyword">Session</span></span> -Site <span class="hljs-number"><span class="hljs-number">2</span></span> -<span class="hljs-keyword"><span class="hljs-keyword">Name</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span> -<span class="hljs-keyword"><span class="hljs-keyword">Role</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span> -Location <span class="hljs-string"><span class="hljs-string">" "</span></span> -<span class="hljs-keyword"><span class="hljs-keyword">Status</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span>-PSUnityCloudInfo -<span class="hljs-keyword"><span class="hljs-keyword">Session</span></span> $<span class="hljs-keyword"><span class="hljs-keyword">Session</span></span> -Site <span class="hljs-number"><span class="hljs-number">1</span></span> -<span class="hljs-keyword"><span class="hljs-keyword">Name</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span> -<span class="hljs-keyword"><span class="hljs-keyword">Role</span></span> <span class="hljs-string"><span class="hljs-string">""</span></span> -Location <span class="hljs-string"><span class="hljs-string">" "</span></span> -<span class="hljs-keyword"><span class="hljs-keyword">Status</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> <br><p>  Now let's create a lot of virtual machines in the main data center: </p><br><pre> <code class="hljs perl">$color = <span class="hljs-number"><span class="hljs-number">4</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> ($i = <span class="hljs-number"><span class="hljs-number">0</span></span>; $i -<span class="hljs-keyword"><span class="hljs-keyword">lt</span></span> <span class="hljs-number"><span class="hljs-number">1500</span></span>; $i++) { Set-PSUnityCloud -Session $Session -Site <span class="hljs-number"><span class="hljs-number">1</span></span> -Name <span class="hljs-string"><span class="hljs-string">"VM$i"</span></span> -VMHost <span class="hljs-string"><span class="hljs-string">"Hostname"</span></span> -Cluster <span class="hljs-string"><span class="hljs-string">"ClusterID"</span></span> -Status $color -Description Running $color++; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($color -eq <span class="hljs-number"><span class="hljs-number">5</span></span>) { $color = <span class="hljs-number"><span class="hljs-number">0</span></span> } }</code> </pre> <br><p>  The output will be the following result: </p><br><p><img src="https://habrastorage.org/webt/ge/1b/2k/ge1b2kxnoplgd3fd3fgd4d0ntq8.jpeg"><br>  <em>Virtuals are spinning.</em>  <em>Beauty!</em> </p><br><p>  Download the server itself with the client, a set of cmdlets and sample scripts can be in the <a href="https://github.com/MickyBalladelli/PSUnity/releases">releases</a> section of the PSUnity project.  Once we got to Unity, it's time for a couple of straightforward PowerShell games. </p><br><h1 id="gamedev-i-powershell">  Gamedev and PowerShell </h1><br><p>  A few years ago, the world was ‚Äúblown up‚Äù by a game called <a href="https://ru.wikipedia.org/wiki/2048_(%25D0%25B8%25D0%25B3%25D1%2580%25D0%25B0)">2048</a> .  Initially, the browser version received a lot of adaptations, including for mobile devices.  Of course, there was also a clone on PowerShell, created by the aforementioned <em>Micky Balladelli</em> .  The script is available in the author's blog, in article <a href="https://balladelli.com/2048-powershell/">2048 en Powershell</a> . </p><br><p><img src="https://habrastorage.org/webt/-w/fy/co/-wfycofxbipcf2ysn4kp8d5f2ku.jpeg"><br>  <em>Game interface</em> </p><br><p>  The second popular game is <a href="https://ru.wikipedia.org/wiki/Flappy_Bird">Flappy Bird</a> , originally created for mobile devices.  If you have already managed to break the smartphone in rage and forget the game as a bad dream - let me remind you of it with a clone on PowerShell. </p><br><p>  The clone itself is available in the repository of <a href="https://github.com/avdaredevil/Flappy-Shell">Flappy Shell by the</a> engineer <em>Apoorv Verma</em> . </p><br><p><img src="https://habrastorage.org/webt/yj/jv/nx/yjjvnxbqgdxji3bu4epn_evyok4.jpeg"><br>  <em>We recall the game, collect the walls, get the negative.</em> </p><br><p>  At the end of the article I would like to provide a link to the adaptation of the favorite childhood game - <a href="https://ru.wikipedia.org/wiki/Space_Invaders">Space Invaders</a> .  The PowerShell solution is available for download in an <em>Adrian Milliner</em> article with the telling title <a href="http://ps1.soapyfrog.com/2007/01/02/space-invaders/">Space Invaders</a> .  The script is not just a script, but a full-fledged game with sound.  Be careful at work. </p><br><p><img src="https://habrastorage.org/webt/lx/rh/te/lxrhteche76vg2ge1dvhogo9eac.jpeg"><br>  <em>Nostalgic with PowerShell, fighting the alien invaders.</em> </p><br><p>  <strong>If you have your own interesting and extraordinary PowerShell scripts - you know what to do.</strong> </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/352726/">https://habr.com/ru/post/352726/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../352716/index.html">New C # 7.2. Span <T> and Memory <T></a></li>
<li><a href="../352718/index.html">Where better to live programmer. Compare 9 countries</a></li>
<li><a href="../352720/index.html">Centralized update of Let's Encrypt certificates</a></li>
<li><a href="../352722/index.html">How to issue a self-signed SSL certificate and make your browser trust it</a></li>
<li><a href="../352724/index.html">What will be Web 3.0: blockchain-marketplace for machine learning</a></li>
<li><a href="../352728/index.html">Standoff on the web</a></li>
<li><a href="../352730/index.html">To steal in 1100 seconds - the strangest bug that I saw</a></li>
<li><a href="../352732/index.html">Creating a simple RESTful API with Spark Framework</a></li>
<li><a href="../352734/index.html">Building an extended anti-virus protection system for a small enterprise. Part 1. Choosing a strategy and decision</a></li>
<li><a href="../352736/index.html">ActiveDirectory Integration into Aether Management Console</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>