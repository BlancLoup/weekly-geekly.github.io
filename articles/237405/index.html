<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We use Docker and do not worry about vendor-lock</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Docker has significantly changed the approach to setting up servers, supporting and delivering applications. Developers are beginning to think about w...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We use Docker and do not worry about vendor-lock</h1><div class="post__text post__text-html js-mediator-article">  Docker has significantly changed the approach to setting up servers, supporting and delivering applications.  Developers are beginning to think about whether their application architecture can be divided into smaller components that will run in isolated containers, which will allow for greater acceleration, parallelization of performance and reliability.  Docker also solves the important problem of removing the vendor ‚Äì lock cloud and allows you to easily migrate customized applications between your own servers and clouds.  All that is required from the server to start Docker is more or less modern Linux OS with a kernel not lower than 3.8. <br><br>  In this article we will talk about how easy it is to use Docker and what advantages it will give to the system administrator and developer.  Forget about problems with dependencies, run software on one server that requires different Linux distributions, do not be afraid to "pollute" the system with wrong actions.  And share the groundwork with the community.  Docker solves a lot of actual problems and helps to make IaaS much more similar to PaaS, without vendor-lock. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b60/e25/921/b60e259212c0e9e2e5d8695f4f3eb4b2.png" title="InfoboxCloud Docker" alt="InfoboxCloud Docker" width="400">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      On the <a href="http://infobox.ru/vps/cloud/">cloud VPS</a> from Infobox, we made a ready image of Ubuntu 14.04 with Docker.  <a href="http://infobox.ru/vps/cloud/">Get a free trial version</a> (‚ÄúTest 10 days‚Äù button) and start using Docker right now!  Do not forget to tick the ‚ÄúAllow OS kernel management‚Äù checkbox when creating the server, this is required for the Docker operation.  In the very near future we will have other OS with Docker inside. <br><br>  Under the cut, you will find out that Docker was so inspired by the author of the article that in a couple of days he transferred his cloud servers that automate parts of the development process into Docker containers. <br><a name="habracut"></a><br><h4>  <b>What is a Docker?</b> </h4><br>  Docker is an open ‚Äì source engine that automates the deployment of applications into lightweight, portable, self-contained containers that can be transferred between servers without changes. <br><br>  The same container that the developer creates and tests on a laptop can be easily transferred to the production server in the cloud and just as easily migrated to another region if necessary. <br><br>  Basic Docker Uses: <br><ul><li>  Automate packaging and application deployment </li><li>  Creating your own lightweight PaaS environments </li><li>  Test automation and continuous integration / deployment </li><li>  Deploying and scaling web applications, databases and backend services </li></ul><br>  Fifteen years ago, almost all applications were developed on well-known technology stacks and deployed to a single, monolithic, proprietary server.  Today, developers create and distribute applications using the best available services and technologies and must prepare applications for deployment to various places: to physical servers, to public and private clouds.  The criterion for choosing a cloud is the quality of service, security, reliability and availability, while vendor ‚Äì lock is a thing of the past. <br><br>  You can draw a good analogy from the field of freight.  Until the 1960s, most of the goods were transported mixed.  Carriers had to take care of the impact of one type of cargo on another (for example, if anvils were suddenly placed on bags of bananas).  The change of transport, for example, from train to ship, was also a test for cargo.  Up to half of the travel time took loading, unloading and reloading.  There were heavy losses during the trip due to damage to the cargo. <br><br>  The solution was a standard shipping container.  Now any types of cargo (from tomatoes to cars) could be packed in containers.  Containers did not open until the end of the trip.  It was easy to efficiently arrange the containers in transport and overload with automatic cranes if necessary, without unloading the container itself.  Containers have changed the world of freight.  Today, 18 million transported standard containers account for 90% of world trade. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/33b/304/4b2/33b3044b27ca7ca727db9258f4f3bc3d.jpg" width="800"><br>  <em>Containers for sea freight in the port of Qingdao, China.</em> <br><br>  Docker can be represented exactly as such containers in the computer code.  Virtually any application can be packaged in a lightweight container that allows automation.  Such containers are designed to run virtually on any Linux ‚Äì server (with kernel 3.8 or higher). <br><br>  In other words, developers can package their applications once and be sure that the application runs exactly in their tested configuration.  The work of system administrators is also greatly simplified - the need to take care of software support is less and less. <br><br><h4>  <b>Docker components</b> </h4><br><h5>  <b>Client and server</b> </h5><br>  Docker is a client-server application.  Clients talk to a server (daemon) that directly does all the work.  Docker command line utility and <a href="http://docs.docker.com/reference/api/docker_remote_api/">RESTful API</a> can be used to manage Docker.  You can run the client and server on the same host or connect to the Docker server remotely. <br><br><h5>  <b>Docker Images</b> </h5><br>  The user launches his containers from images that are part of the container building process.  The image uses <a href="https://ru.wikipedia.org/wiki/Aufs">AuFS</a> to transparently mount file systems.  Using bootfs, the container is loaded into memory.  Then bootfs is unmounted, freeing memory.  Next, rootfs works (from Debian, Ubuntu, etc.).  In Docker, rootfs is mounted in read-only mode.  When the container is launched from an image, the file system is mounted on the record above the required layer below. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/eee/48e/eda/eee48eeda407cf1f30876f3a2e92bf74.png" width="250"><br><br><h5>  <b>Registries</b> </h5><br>  Docker stores the images you create in registries.  There are two types of registries: public and private.  The official registry is called <a href="https://hub.docker.com/">Docker Hub</a> .  By creating an account in it, you can save your images in it and share them with other users. <br><br>  The Docker Hub has more than 10,000 images with various operating systems and software.  You can also save private images in Docker Hub and use them within your organization.  Using the Docker Hub is optional.  You can create your own repositories outside the Docker infrastructure (for example, on your corporate cloud servers). <br><br><h5>  <b>Containers</b> </h5><br>  Docker helps you create and deploy containers within which you can run your applications and services.  Containers run from images. <br><br>  When the Docker starts the container, the write layer is empty.  With changes, they are recorded in this layer.  For example, when a file is changed, it is copied to a layer that can be written to (copy on write).  A ‚Äúread only‚Äù copy still exists, but is hidden.  After creating the container, Docker builds a set of read ‚Äì only images and turns on the layer for writing. <br><br><h4>  <b>Create an interactive container</b> </h4><br>  After creating a virtual machine with Docker, you can start creating containers.  You can get basic installation information using the <strong>docker info command</strong> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/043/1f8/f29/0431f8f29bbe168bbe4cbb865ae34429.png" width="600"><br>  A complete list of available commands can be obtained with the <strong>docker help command</strong> . <br><br>  Let's build a container with Ubuntu. <br><pre><code class="bash hljs">sudo docker run -i -t ubuntu /bin/bash</code> </pre> <br>  The -i flag leaves STDIN open, even when you are not attached to the container.  The -t flag assigns a pseudo-tty container.  This creates an interactive interface to the container.  We also specify the name of the image (ubuntu is the base image) and shell / bin / bash. <br><br>  Let's install the nano into a container. <br><pre> <code class="bash hljs">apt-get update apt-get install -y nano</code> </pre><br>  You can exit the container with the exit command. <br><br>  The <strong>docker ps command</strong> shows a list of all running containers, and <strong>docker ps -a</strong> lists all, including those that have been stopped. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bb6/ee7/f4c/bb6ee7f4cf9111b35cc43d1ebb1f058e.png" width="800"><br>  The list of running containers is not.  When you left the container, it stopped.  In the screenshot above (docker ps -a) you can see the name of the container.  When you create a container, the name is automatically generated.  You can specify a different name when creating the container: <br><pre> <code class="bash hljs">docker run --name habrahabr -t -i ubuntu</code> </pre><br>  The container can be accessed not only by ID, but also by name. <br>  Let's run the container: <br><pre> <code class="bash hljs">docker start stupefied_lovelace</code> </pre><br>  To connect to the container, you must use the <strong>attach</strong> command: <br><pre> <code class="bash hljs">docker attach stupefied_lovelace</code> </pre><br>  (you may need to press Enter before the prompt appears). <br><br><h4>  <b>Create a container daemon</b> </h4><br>  Of course, you can create long-lived containers suitable for running applications and services.  Such containers do not have an interactive session. <br><pre> <code class="bash hljs">docker run --name city -d ubuntu /bin/bash -c <span class="hljs-string"><span class="hljs-string">"while true; do echo hello world; sleep 1; done"</span></span></code> </pre>  where city is the name of the container. <br>  You can see what is happening inside the container with the <strong>docker logs &lt;container name&gt; command</strong> . <br>  You can stop a container with the <strong>docker stop command &lt;container name&gt;</strong> .  If after that the container is restarted again to <strong>docker start &lt;container name&gt;</strong> , the while loop will continue in the container. <br><br>  You can see the details of the container with the command <strong>docker inspect &lt;container name&gt;</strong> . <br>  To remove a container, use <strong>docker rm &lt;container name&gt;</strong> . <br><br><h4>  <b>How to get and put the data?</b> </h4><br>  In order to copy data to a container or remove it from it, you need to use the command <br><pre> <code class="bash hljs">docker cp &lt;    &gt; &lt; &gt;:&lt;&gt;</code> </pre><br>  You can mount the host folder in the container when creating: <br><pre> <code class="bash hljs">docker run -v /tmp:/root -t -i &lt; &gt;</code> </pre>  , <br>  where / tmp is the path to the folder on the host, and / root is the path to the folder on the server.  This way you can work from the container with the data on the host and eliminate the need to copy data in both directions. <br><br><h4>  <b>We work with images</b> </h4><br>  Let's see a list of all our <strong>docker images</strong> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/037/678/fe6/037678fe6f4af928fe80f05144352f56.png" width="600"><br><br>  Changes to an existing container can be committed to an image for future use. <br><pre> <code class="bash hljs">docker commit &lt;id &gt; &lt; &gt;</code> </pre>  . <br><h4>  Transferring the image to another host </h4><br>  Finally, the main thing.  Let's say you set up your application in Docker and commit to an image.  Now you can save the image to a file. <br><pre> <code class="bash hljs">docker save _ &gt; ~/transfer.tar</code> </pre><br>  Copy this image to another host, for example, using scp and import it into Docker. <br><pre> <code class="bash hljs">docker load &lt; /tmp/transfer.tar</code> </pre><br>  That's all, you can easily transfer your applications between hosts, clouds and your own servers.  No vendor ‚Äì lock.  Just for this you should use Docker!  (if you saved data to the mounted file system, do not forget to transfer it as well). <br><br><h4>  <b>Install nginx in Docker</b> </h4><br>  For example, let's install nginx in Docker and configure its autorun.  Of course, you can simply download the image from nginx for Docker, but we'll see how this is done from the very beginning. <br><br>  Create a clean container with Ubuntu 14.04 with ports 80 and 443 open: <br><pre> <code class="bash hljs">docker run -i -t -p 80:80 -p 443:443 --name nginx ubuntu:trusty</code> </pre><br>  Add the official repository of the stable version of nginx to /etc/apt/sources.list: <br><pre> <code class="xml hljs">deb http://nginx.org/packages/ubuntu/ trusty nginx deb-src http://nginx.org/packages/ubuntu/ trusty nginx</code> </pre><br><br>  Install nginx: <br><pre> <code class="bash hljs">apt-key update apt-get update apt-get install nginx</code> </pre><br><br>  You can verify that nginx starts by running: <br><pre> <code class="bash hljs">/etc/init.d/nginx start</code> </pre><br>  We will see the welcome page by going to the ip server on port 80: <br><img src="https://infoboxcloud.ru/community/uploads/images/00/00/01/2014/09/14/968a8a.png" width="400"><br><br>  For different applications, the nginx settings may differ, it makes sense to save the container from nginx to an image of &lt;your login on hub.docker.com&gt; / nginx: <br><pre> <code class="bash hljs">docker commit nginx trukhinyuri/nginx</code> </pre><br>  Here we first met the <a href="http://hub.docker.com/">Docker Hub</a> .  Time to create an account in this service and log in using the docker login command. <br><br>  Now you can share the image with other users or simply save the image for reuse on other hosts.  We did not just save the image in the format &lt;username&gt;: &lt;image tag&gt;.  Attempting to send an image named in a different format will fail.  For example, if you try to send an image just named nginx, you will be politely informed that only favorites can save images to the root repository. <br><br>  Send our trukhinyuri / nginx image to the docker hub for reuse on other servers in the future.  (here trukhinyuri is the author's repository name): <br><pre> <code class="bash hljs">docker push trukhinyuri/nginx</code> </pre><br>  To enable nginx to start when the host starts, add the upstart initialization script to the address /etc/init/nginx.conf: <br><pre> <code class="xml hljs">description "Nginx" author "Me" start on filesystem and started docker stop on runlevel [!2345] respawn script /usr/bin/docker start -a nginx end script</code> </pre><br><h4>  <b>Conclusion</b> </h4><br>  In this article, you were able to try Docker and appreciate how easy it is to package an application and migrate between different hosts.  This is only the tip of the iceberg, a lot of things are left behind the scenes and will be considered in the future.  For additional reading, we recommend the book <a href="http://www.dockerbook.com/">The Docker Book</a> . <br><br>  You can try the image with Docker in on cloud VPS from Infobox in Amsterdam by getting a <a href="http://infobox.ru/vps/cloud/">trial version for free</a> (the button ‚ÄúTest 10 days‚Äù). <br><br>  UPD: Access to the trial version of cloud VPS is temporarily restricted.  Order is still available.  We are testing a new technology to make the service even faster.  Follow the news. <br><br>  If you find an error in the article, the author will gladly correct it.  Please write in the LAN or <a href="">in the mail</a> about it. <br>  In case you can not leave comments on Habr√© - write a comment on the article in the <a href="https://infoboxcloud.ru/community/blog/iaas/149.html">InfoboxCloud Community</a> . <br><br>  Successful use! </div><p>Source: <a href="https://habr.com/ru/post/237405/">https://habr.com/ru/post/237405/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../237391/index.html">Outsourcing rake or 9 mistakes when opening an accounting business that any startup needs to know</a></li>
<li><a href="../237393/index.html">We check Oracle VM VirtualBox. Part 1</a></li>
<li><a href="../237395/index.html">Yet another registry. What in practice means getting into the register of information dissemination organizers</a></li>
<li><a href="../237399/index.html">Mobile application "Guess the game"</a></li>
<li><a href="../237403/index.html">Smart antennas help make 5G affordable (part 1)</a></li>
<li><a href="../237409/index.html">Create a 2D platformer using the Unreal Engine 4. Part 1 - Game character, movement</a></li>
<li><a href="../237413/index.html">What is Kenevin and a little about the conference Lean Kanban Russia</a></li>
<li><a href="../237415/index.html">Identify search engine ranking algorithms</a></li>
<li><a href="../237417/index.html">Ranking Factor # 1: User Satisfaction</a></li>
<li><a href="../237419/index.html">Translation App Store Review Guidelines</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>