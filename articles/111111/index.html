<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Google Docs v3 Family Budget</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Happy New Year to all who can not on holidays without brain activity and without Habr. 
 I continue my favorite series of posts ( one , two ) about th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Google Docs v3 Family Budget</h1><div class="post__text post__text-html js-mediator-article">  Happy New Year to all who can not on holidays without brain activity and without Habr. <br>  I continue my favorite series of posts ( <a href="http://habrahabr.ru/blogs/google/53530/">one</a> , <a href="http://habrahabr.ru/blogs/google/87739/">two</a> ) about the theory and practice of maintaining a family budget in Google Docs. <br><br>  I honestly kept my budget, written in Google docs a year ago, and gave birth to a new version and a new philosophy (for myself) of running a budget.  What I am in a hurry to share. <br><br><h5>  Introduction </h5><br>  I know that there are many specialized systems for the family budget, like 4 Envelopes or Easy Finance, but I like to do everything myself, because it allows you to do what you want and use your brainchild more pleasantly. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h6>  The main advantages of maintaining a budget for Google Docs: </h6><br>  1. You can fill in from anywhere (laptops, phones, iPads) - using Google forms <br>  2. You can develop the logic and visualization yourself. <br>  3. Reliability and almost 100% fault tolerance provided by Evil Corporation :) <br><br><h5>  A bit of philosophy. </h5><br>  Why are we starting to keep a budget?  Everyone has their own reasons: to understand why the money runs out 10 days before the salary;  understand why credit card debts are only growing;  understand what costs are better to cut or how to save money for a new car. <br>  Many financial systems offer us to have a whole lot of budget items and write down our expenses in them without thinking about why we need all this.  At the very beginning, I went the same way and faced the fact that it is almost impossible to analyze expenses, because  some of them were obviously not constant (buying a laptop or a suit - obviously expenses ‚Äúby necessity / desire‚Äù) and it is impossible to plan and analyze them. <br>  Spherical budget in a vacuum - these are two articles: ‚Äúarrival‚Äù and ‚Äúexpense‚Äù.  Every day you enter expenses and incomes and see what happens.  Then you have thoughts, and what do we want to analyze?  Someone wants to see, and how much money is spent on cars (gasoline, insurance, taxes, repairs, washing), someone is interested in understanding how much he spends on entertainment (going to restaurants, movies, bars). <br>  I advise you to divide the cost items by no more than 10-15 items based on what you want to analyze this year / quarter. <br><br>  My expense items look like this: <br><img src="https://habrastorage.org/getpro/geektimes/post_images/ed1/ca2/e67/ed1ca2e67dbdf0c47898b1705dc8e8a2.png" alt="image"><br><br>  And the most interesting is how to do it in the Gouglodox box with detailed instructions and formulas and examples - under the cut. <br><a name="habracut"></a><br><br><h5>  Let's start from the beginning. </h5><br>  Create a spreadsheet in Google Docs. <br>  And we make on it a FORM to fill - <br><img src="https://habrastorage.org/getpro/geektimes/post_images/b01/4d0/8ab/b014d08aba73ba80f486289d8b5b670d.png" alt="image"><br><br>  As a result, the data from this form will fall on the sheet, which I called "F-0" - the type of raw data. <br><img src="https://habrastorage.org/getpro/geektimes/post_images/858/d64/75a/858d6475a55b4405dc9963459d84ab80.png" alt="image"><br><br>  The data here is simple: <br>  - date (affixed automatically, which is very nice, although you can change the pens) <br>  - expense (amount) <br>  - income (amount) <br>  - comment <br>  here we put the tag with the key symbol colon.  Tags are set on the sheet PLAN.  Tags allow us to break the cost of items.  In theory, you can make a choice of tag from the list, but I decided that I would write them with my hands - 3-4 letters are not scary.  After the colon, you can write any comment, so you do not forget or analyze, you should do for meaningful and large purchases. <br>  - a source <br>  For me personally, for analysis, it is important to understand the state of the cache and each of my credit cards, so I choose where I pay each amount from.  With this, I equate debit card and cache with cache. <br><br>  As a result, my form from iPhone looks like this: <br><img src="https://habrastorage.org/getpro/geektimes/post_images/4bc/9f9/38a/4bc9f938adc322d5b573414473ff82f8.jpg" alt="image"><br>  Bought groceries - opened iphone - made a record.  It's simple. <br><br>  Above is a reminder of what tags I have, a link to the last 10 entries, a link to an analysis sheet ‚Äî all of this is in the text below. <br><br>  Further, these data are processed on the tab "F-1", but about it a little later.  First, let's think and plan our expenses and revenues. <br>  Here is another one of my know-how (well, at least I haven‚Äôt seen such an approach yet).  How to plan, say, the cost of a car, where we want to include not only constant monthly expenses for gasoline and car wash, but also repair (MOT), insurance and taxes + inspection?  Constant expenses are simple - 3,400 per month, but in March we have insurance for 32,000, in August and November there will be maintenance at 7K and 11K.  It is clear that there are unforeseen expenses for the same car - but they are already unforeseen :), that they cannot be planned. <br><br>  Solution: I made a table with coefficients for each month.  Like this: <br><img src="https://habrastorage.org/getpro/geektimes/post_images/099/5b3/1e2/0995b31e2b9384c8e64d2871a1280584.png" alt="image"><br><br>  Those.  I tried to single out the constant component so that in the maximum number of months there was a coefficient 1, and there, where there would most likely be ‚Äúsingle‚Äù expenses in this article - I put the coefficients more (and somewhere else, less, for example, in November the vacation time is also by car I will not go half a month). <br><br>  Of course, you can select insurance for a car in a hotel article, as well as TO-40,000 and TO-50,000 and another tax, but as I wrote above - I do not need to analyze the costs of maintenance, but I want to see the cost of cars in general.  And you?  Google docs will allow you to customize it yourself :) <br><br>  Go ahead and before proceeding to the sly logic in the "F-1", let's see what we want in the end get. <br>  The main page (sheet) for analyzing the current ‚Äúfinancial well-being‚Äù is ‚ÄúA month‚Äù, which means Analysis of the month.  That's so compact on one page, I see my current position and I can see the history by months. <br><img src="https://habrastorage.org/getpro/geektimes/post_images/f8f/302/4a5/f8f3024a5e67d25b7199e8a3f18b6631.png" alt="image"><br><br>  1. From above, we select the year and month for analysis.  (PS Year is only one and the choice does not work) <br>  Recently, a list of <br><img src="https://habrastorage.org/getpro/geektimes/post_images/8e6/6a5/7c8/8e66a57c8b430ba58cb16c93228cdb09.png" alt="image"><br><br>  2. Below we have automatically put down the planned value of the flow "PLANNED" and the actual situation "FACT". <br><img src="https://habrastorage.org/getpro/geektimes/post_images/253/6b7/404/2536b7404198e12ee38fe4e6a737ce07.png" alt="image"><br>  Everything is collected from the form "F-1" and when you add a record - in a second it is already updated. <br>  Then comes the percentage of the plan - if the value goes to a critical 93%, tint in red. <br><img src="https://habrastorage.org/getpro/geektimes/post_images/01a/8ef/a8a/01a8efa8a3072ab2f4aae48480daacbd.png" alt="image"><br>  (You can make a whole gradation - adding 3-4 rules: green, yellow, red, brown - like traffic jams on Yandex) <br><br>  3. The lowest CORR cell is an adjustment. <br><img src="https://habrastorage.org/getpro/geektimes/post_images/014/a57/a65/014a57a653e105976778fc0fbf686def.png" alt="image"><br>  Often needed for unplanned situations.  Suppose you paid a card for a friend's TV, and he gave you cash.  It seems the money from the card was spent, and at the same time the cash came.  Or at the end of the month, they realized that you actually have 2,000 rubles more in your wallet than in the system ‚Äî you need an adjustment. <br>  By the way, such an article as an adjustment I rarely met in "specialized systems".  I have it shows how much you have adjusted to plus, and how much to minus. <br><br>  4. On the right (above) of 5 lines under the heading "Last 10 records" show the last 5 records. <br><img src="https://habrastorage.org/getpro/geektimes/post_images/d62/f6d/ff5/d62f6dff52133725883091772c05c9b2.png" alt="image"><br>  Why five and not 10?  Guess yourself :) <br>  The algorithm is tricky here - it is sewn up on the ‚ÄúOTH‚Äù tab, where all the service info and calculations are dumped. <br><img src="https://habrastorage.org/getpro/geektimes/post_images/c70/601/cc2/c70601cc25f90c161d0b3093240aa29c.png" alt="image"><br><br>  looking for the last entry (each is numbered in ascending order) - i.e.  you need to find the maximum and compare it with a line in the table "F-1".  Then make look 5 lines up from the last (bottom) entry. <br><br>  Why do you need it?  I share the ‚ÄúA month‚Äù sheet as a web page and a range of cells under the last 10 records - you can see quickly and cheaply in terms of traffic.  Suppose you have forgotten, whether skates you bought yesterday or not entered into the budget - Last 5 records will help you. <br><br>  5. Below on the right is my status by cards and cash. <br><img src="https://habrastorage.org/getpro/geektimes/post_images/aa4/cd8/c88/aa4cd8c88ae8d42b83e296ca3f93f0f6.png" alt="image"><br>  It can be seen how much what bank I owe in rubles and interest.  Every month I do a reconciliation and look at each map and availability ‚Äî how much is in fact and how much is in the system ‚Äî and I make an adjustment. <br><br>  Well, that's all about the planning list - let's move on to the logic in ‚ÄúF-1‚Äù <br>  It looks like this: <br><img src="https://habrastorage.org/getpro/geektimes/post_images/6a1/aa7/97f/6a1aa797f403cc80ea92c74ed84d418f.png" alt="image"><br>  Let's sort by columns: <br><br>  1. columns ‚ÄúB‚Äù through ‚ÄúF‚Äù stupidly duplicate records from the raw data sheet ‚ÄúF-0‚Äù.  Although not entirely stupid.  For some reason, Guglodox didn‚Äôt want to accept just a formula like "= A1! F-0" and shifted the entries in the F-1 sheet as soon as a new one was added to the F-0, so I had to fake the formula for the "stupid" data collection from the F- sheet 0 looks like this: <br><img src="https://habrastorage.org/getpro/geektimes/post_images/9b5/2af/b48/9b52afb483d484bc35b29f02d7f43fcd.png" alt="image"><br>  where in A2 stands ROW (), which returns the row number :) - so we bypassed the automatic shifting of the formula when adding a new record in the form. <br><br>  2. In the ‚ÄúH‚Äù column I make my favorite feature in Excel - an auxiliary column, <br><hh user="http://clip2net.com/clip/m7523/1294084790-clip-9kb.png"><br>  which closes a hole in the Gugloboxes, that it does not have the SUMIFA formula, which allows one to sum up the values ‚Äã‚Äãgiven not one, but several criteria.  As a result, in the ‚ÄúH‚Äù column I received unique values ‚Äã‚Äãfor the aggregate ‚Äúyear‚Äù, ‚Äúmonth‚Äù, ‚ÄúTag‚Äù, which gives me the right to summarize it in the analysis sheet: <br><img src="https://habrastorage.org/getpro/geektimes/post_images/481/62f/a04/48162fa048f29a7fdad679b635b37dcd.png" alt="image"><br><br>  3. In the SUM column, simply summarize the income and expense in order to look at the same column in the analysis. <br>  I wondered ... why would I need two different fields in the form of "income" &amp; "expense" ... because each amount is tagged and it is clear that income or expense!  Ok, we'll fix it later :) <br><br>  4. In the column ‚ÄúREC No for Last 10‚Äù - the recording number is added according to a ridiculous formula: <br>  = IF (C3 + D3&gt; 0; J2 + 1; J2) She catches ‚Äúempty‚Äù entries for me. <br><br>  5. In the column ‚ÄúTest wrong category‚Äù - there is a real test for a fool - by entering the Tag just to be mistaken - it is important to wink with red if you entered the wrong tag. <br><img src="https://habrastorage.org/getpro/geektimes/post_images/238/76f/64c/23876f64cc41870bf92a699c04e85331.png" alt="image"><br><br>  6. Next comes the allocation of the amount to a particular source (maps, cache, envelopes) - the amount is simply put with a plus or minus sign and summarized on the Analysis sheet.  By the way, the initial values ‚Äã‚Äãof the money at the start of the budget are also laid in separate cells in the plan sheet. <br><br>  Here on the analysis sheet, the system first looks at the initial value on CITIBANK and then summarizes all the values ‚Äã‚Äãfrom the CITI column. <br><img src="https://habrastorage.org/getpro/geektimes/post_images/f13/30f/d0c/f1330fd0c0f4e1179534bb17730cc07c.png" alt="image"><br><br>  It seemed so long and difficult to think about all this and create a solution architecture - and it came out to describe in an hour.  For a snack: <br><br>  1. The shared file web page (unfortunately without formulas) <a href="https://spreadsheets.google.com/pub%3Fkey%3D0Aht4cFRJGkY7dEhHb3RqdzhUMTZCMXlPbzJ1T3kxZHc%26output%3Dhtml">spreadsheets.google.com/pub?key=0Aht4cFRJGkY7dEhHb3RqdzhUMTZCMXlPbzJ1T3kxZHc&amp;output=html</a> <br><br>  2. copy of file in Excel - formulas are visible there - <a href="http://narod.ru/disk/2677466001/HABR%2520Budget%25202011.xls.html">narod.ru/disk/2677466001/HABR%20Budget%202011.xls.html</a> <br>  By the way, for some reason, the IFERROR formula (IFERBY) - is not converted into Russian Excel - I had to interrupt with my hands :) <br><br>  Probably forgot something or didn‚Äôt tell, but for this we have comments and <b>UPD</b> .  in posts - therefore I will be glad to discuss and accept all your opinions on the account of personal finances. </hh></div><p>Source: <a href="https://habr.com/ru/post/111111/">https://habr.com/ru/post/111111/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../111103/index.html">Monoblock for the "difficult" user</a></li>
<li><a href="../111105/index.html">Development using the Model-View-ViewModel design pattern on the example of the Twitter client step by step</a></li>
<li><a href="../111106/index.html">OV-Chipkaart: contactless smart cards in the service of the community</a></li>
<li><a href="../111108/index.html">Browser usage statistics for December 2010 according to StatCounter</a></li>
<li><a href="../111109/index.html">How does Opera make money (aka most frequently asked question)</a></li>
<li><a href="../111114/index.html">The story of one computer war</a></li>
<li><a href="../111115/index.html">reCaller - program for those who call back a lot</a></li>
<li><a href="../111117/index.html">Midnight Commander 4.7.5 is stable</a></li>
<li><a href="../111119/index.html">Improving the sound of speakers Sven Stream</a></li>
<li><a href="../111120/index.html">10 years of practice. Part 1: building a program</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>