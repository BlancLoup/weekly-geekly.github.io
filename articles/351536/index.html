<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>UI Autotests for Xamarin</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Testing is an essential element of any software development. A lot of time is allocated for it in the total amount of labor costs, but testing itself ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>UI Autotests for Xamarin</h1><div class="post__text post__text-html js-mediator-article">  Testing is an essential element of any software development.  A lot of time is allocated for it in the total amount of labor costs, but testing itself is a monotonous and monotonous thing, so it lends itself well to automation.  In our today's article, we will look at how to use UI tests in your Xamarin projects, including large business applications. <br><br><img src="https://habrastorage.org/webt/eg/gf/iy/eggfiymx47_rul0zkrlmr6yj5ke.jpeg"><a name="habracut"></a><br><br>  <i>I give the word to the author.</i> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      While the software used few third-party modules and had a primitive user interface, for most of the tasks, traditional unit-tests were enough that tested the performance of individual methods and classes.  In mobile applications, unit-tests also got their use, but they are not so easy to cover modules and classes tied to the user interface or platform functionality.  This will help us to special UI-tests that will simulate the action of a real user: data entry, clicking on the screen, swipe and other gestures. <br><br><h2>  Xamarin UI Tests </h2><br>  If you have not yet had the opportunity to use Xamarin UI Tests in your projects, then briefly recall that with the help of this framework you can write automated tests in C # and run them both locally and in App Center Test Cloud.  Currently supported by iOS / Android, on Windows UWP this is not yet working, but you can use <a href="https://msdn.microsoft.com/ru-ru/library/dn305948.aspx">Coded UI Tests</a> or another framework instead of Xamarin UI Tests. <br><br>  For a deeper acquaintance with automatic testing of mobile applications and Xamarin UI Tests, we recommend these articles on Habr√©: <br><br><ul><li>  <a href="https://habrahabr.ru/company/badoo/blog/347986/">Mobile App Auto-Test Tools Guide</a> </li><li>  <a href="https://habrahabr.ru/post/269389">Xamarin.UITest</a> </li><li>  <a href="https://habrahabr.ru/company/microsoft/blog/325184/">DevOps in the service of man</a> </li></ul><br>  These articles very much describe the first steps in mastering autotests, but we will move on and consider how best to use autotests on large projects and integrate them with the App Center to perform in the cloud on a wide fleet of devices. <br><br><h2>  Types of UI tests and Mobile problems </h2><br>  Since UI-tests are not widely used in all teams on a regular basis, let's define what and how can be tested using autotests.  To do this, we will go from those classes of errors and problems that are specific to mobile applications: <br><br><ul><li>  Various operating systems and their versions.  The application should work correctly on a wide range of very different operating systems, each of which has its own characteristics and limitations.  Frequent errors: the application does not start or crashes in any version of the OS. </li><li>  Different variants of the CPU architecture.  Iron smartphones and tablets are constantly improving, but do not forget about the "old men" five years ago, which may be in the hands of your real users.  Frequent errors: the application is not installed on too old, too new or rare (for example, Android x86) devices. </li><li>  Different screen resolutions devices.  Regardless of the number of pixels or the aspect ratio, the interface of the mobile application should correctly ‚Äúdrag‚Äù and ‚Äúcarry‚Äù.  Frequent errors: UI elements are cropped or clumsily displayed on the smallest or largest screens. </li></ul><br>  The curvature of some programmers, leading to bugs, is not a feature of mobile development, so we leave it outside our article. <br><br>  Based on the frequent problem areas, autotests are reasonably divided into 3 main types: <br><br><ul><li>  Smoke tests to run the assembled application on the ‚Äúmost‚Äù extreme iron options: the oldest and the newest.  This will make sure that the update of a dependent library or a tick in the project settings is not broken. </li><li>  Acceptance tests to verify key user scripts.  This will make sure that the last edits did not break at least those scenarios that real users will follow in most situations. </li><li>  Advanced tests to check the layout of all screens at various resolutions, as well as tests for any specific functionality.  This also includes regression autotests. </li></ul><br>  We will discuss how to correctly organize the QA process using UI tests in our next articles, and today we will focus on practice - how to organize your code base with tests on Xamarin UI Tests and how to run tests in App Center. <br><br><h2>  Project structure with UI tests </h2><br>  The structure of the UI tests just added to the project is as follows: <br><br><img src="https://habrastorage.org/webt/95/yc/38/95yc38_phtb6vyuqlevjlj0feke.png"><br><br>  The default structure is not very suitable for large projects where there can be a lot of tests.  Therefore, we divide the logic into the description of the pages and the very logic of the tests that will operate on the pages.  A similar structure is recommended by Xamarin in its examples: <br><br><ul><li>  github.com/Microsoft/SmartHotel360-mobile-desktop-apps/tree/master/src/SmartHotel.Clients.UITests </li><li>  github.com/xamarinhq/app-evolve/tree/master/src/XamarinEvolve.UITests </li><li>  github.com/xamarin/test-cloud-samples </li></ul><br>  An example of a project structure with a large number of tests: <br><br><img src="https://habrastorage.org/webt/gc/jl/2a/gcjl2aj7eaywzj_cpbvvdmoruio.png"><br><br><ul><li>  Pages contain methods that describe the logic of the individual pages. </li><li>  Tests contains tests that use ready-made methods from Pages </li></ul><br>  For convenience, tests can be grouped by functionality, which they check.  For example: MapTests, AutorizationTests, etc. <br><br>  All visual elements (buttons, labels, lists, and other controls) in Xamarin.Forms applications with which interaction is possible, you need to set the AutomationId property through which the tests from them are accessed.  If you are writing on the classic Xamarin iOS / Android, then you need to set the AccessibilityIdentifier properties in iOS and ContentDescription in Android.  This should be done in the application code, and the tester himself can handle it. <br><br><img src="https://habrastorage.org/webt/vq/b3/dn/vqb3dnbudtmn6l4qv-sks_jy7y8.png"><br><br>  It is necessary for more convenient work with UI-tests.  Separating the logic of the behavior of pages (Pages) and the logic of the most tests (Tests) increases the readability of the code and allows you to further refine them further as the project progresses. <br><br><h2>  Run UI tests and basic methods </h2><br>  After creating the structure of the UI tests, you can start writing them.  The tests are run from the unit test panel.  Tests for Android can be run directly into Windows from Visual Studio, but for iOS, at least for debugging, they will need to be performed on a Mac using Visual Studio for Mac, and then launched in App Center. <br><br>  The main tool for writing tests is the <a href="https://developer.xamarin.com/guides/testcloud/uitest/working-with/repl/">Repl</a> method.  It launches the console, in which we will enter the methods necessary for working with Xamarin UI Test. <br><br><img src="https://habrastorage.org/webt/bx/t-/ww/bxt-wwecsbkwbyn4l7jbawc8uw4.png"><br><img src="https://habrastorage.org/webt/vq/ei/jd/vqeijddqzlhkuv_clsr5ltpmoas.png"><br><br>  <b>The main methods include</b> : <br><br><ul><li>  tree - gives all the information on the elements on the screen; </li><li>  app.Tap - tap on the selected item; </li><li>  app.WaitForElement - waiting for an element to appear on the page; </li><li>  app.Scroll Down \ Up - scroll imitation; </li><li>  app.EnterText - text input; </li><li>  app.Query - gives all the information on the selected element on the screen; </li><li>  app.Screenshot - makes a screenshot of the screen. </li></ul><br>  For more information on how to manually write tests using Xamarin UI Tests, you can find out in the official documentation: <br><br><ul><li>  <a href="http://developer.xamarin.com/api/type/Xamarin.UITest.Android.AndroidApp">Android</a> </li><li>  <a href="http://developer.xamarin.com/api/type/Xamarin.UITest.iOS.iOSApp">iOS</a> </li></ul><br>  Currently, Xamarin UI Tests cannot perform the following actions: <br><br><ul><li>  Internet connection and network management; </li><li>  Integration with other applications on the device is not available; </li><li>  Bluetooth / WiFi control functions, physical rotation are not available;  device and simulate a variety of battery conditions; </li><li>  No interaction with system notifications; </li><li>  Limited work with the camera. </li></ul><br>  You will also need some additional actions when interacting with system dialogs, for example, when you receive Permissions. <br><br><h2>  Xamarin Test Recorder </h2><br>  In addition to manually writing tests, you can use the Xamarin Test Recorder tool, which will record your actions on the device (data entry, tapes, gestures) and automatically create UI test code in C #.  As conceived by Xamarin, it should reduce the time spent on creating tests, but it is worth remembering that this tool is still in the Preview stage.  Often does not see AutomationId, and tests recorded for iOS do not work on Android. <br><br>  In real Xamarin Test Recorder projects, it‚Äôs better not to count for the time being, so we recommend getting comfortable with writing tests in C #. <br><br><h2>  Local testing </h2><br>  So, with the writing of tests we figured out.  Before embedding UI tests into your CI / CD pipeline for automatic start, you need to run and debug them locally.  To do this, you can perform UI tests through the tool for working with unit tests in Visual Studio on both Windows (Android only) and Mac (Android + iOS). <br><br><img src="https://habrastorage.org/webt/5p/fq/bw/5pfqbw4ekwkdby-qmqhjfqwwqg8.png"><br><br>  In order to get to practice, let's consider a simple example of UI tests for local testing. <br><br>  There is a simple application consisting of 4 screens.  Let's write a test for it. <br><br>  First, we compose the structure and describe BasePage, BaseTest and AppInitializer: <br><br><img src="https://habrastorage.org/webt/a7/8m/4i/a78m4it4in8scqwfbtoxf0x9ei4.png"><br><br>  Then we describe each page (Page): <br><br><img src="https://habrastorage.org/webt/v4/0j/rq/v40jrqesefvpyynlypuc0wrig80.png"><br><br>  And only now we write the test itself: <br><br><img src="https://habrastorage.org/webt/on/de/5x/onde5x1thj5__n0is45gqscvt1a.png"><br><br>  If you did everything correctly, the test will succeed. <br><br><img src="https://habrastorage.org/webt/ck/zz/4k/ckzz4kipvropaqldd_si0yaiep4.png"><br><br>  If you need to perform different actions on iOS and Android in one test, then OniOS and OnAndroid properties from BasePage will be useful.  This allows you to write common scripts for both platforms: <br><br><img src="https://habrastorage.org/webt/eq/ek/3l/eqek3lrugdj8t-byxxox3ak-vam.png"><br><br><h2>  App Center </h2><br>  The main advantage of UI tests is revealed when they are embedded in your daily product development process.  You can make your farm devices for autotests, but it is expensive and very labor intensive.  It is better to use ready-made, now there are different cloud farms, including those from Google and Amazon (see the <a href="https://habrahabr.ru/company/microsoft/blog/333606/">7 best device farms for testing mobile applications</a> ). <br><br>  Recall that, most recently, Microsoft combined the Hockey App services (feedback collection and distribution), Xamarin Test Cloud (automated UI testing on real devices) with developments from Visual Studio Team Services (build) and introduced a service called App Center. <br><br>  If you have already used Xamarin Test Cloud, then the interface will seem familiar to you: <br><br><img src="https://habrastorage.org/webt/f7/gw/2t/f7gw2tghb_gjzp5xzsqso9ju8z4.png"><br><br>  Information about a specific test includes step-by-step results with screenshots: <br><br><img src="https://habrastorage.org/webt/xe/zs/2c/xezs2cmg2j_u9mguvsvycqzpo2o.png"><br><br>  Start an acquaintance with the App Center is better for <a href="http://docs.microsoft.com/en-us/appcenter/test-cloud/getting-started">official documentation</a> . <br><br>  To run the tests themselves in the console, you must write the following commands: <br><br> <code>appcenter test run uitest --app ‚Äú_‚Äù --devices "_DEVICE_SET" --app-path ‚Äú__APK/IPA‚Äù --test-series "_TEST_SERIES" --locale "ru_RU" --build-dir ‚Äú____UI_‚Äù --uitest-tools-dir ‚Äú___test-cloud.exe‚Äù</code> <br> <br>  You can see an example of launching on the AppCeter.ms website in the Test section.  For our example application, it looked like this: <br><br><img src="https://habrastorage.org/webt/hb/mg/kq/hbmgkqeb-e4cdz1woaekhw0qnxg.png"><br><br>  The minimum time to perform one test on one device takes about 1 minute, but it takes time to prepare the device and deploy your application to it.  Thus, the minimum time to launch your project in the App Center will be about 5 minutes.  The tests themselves will also take from 2 to 15 minutes, depending on the number of steps and the required time to wait for data from the server. <br><br><h2>  Several types of tests in one project </h2><br>  Often in practice there is a need to run various types of tests, such as Smoke, Acceptance and others.  To do this, you must specify the category name (Category) for each set of tests (or an individual test) and run only the desired set of scripts in App Center. <br><br><img src="https://habrastorage.org/webt/e1/2m/4z/e12m4z0ersiacsl2c9-vob_qeq4.png"><br><br>  And this is how the test launch line of the required category will look like: <br><br><img src="https://habrastorage.org/webt/fz/8l/u4/fz8lu4wgnqymod0_3mrd28pgyp0.png"><br><br>  This will allow you to run only those tests that are currently needed. <br><br><h2>  Total </h2><br>  Autotest allows you to remove the itch of manual testing, and with the help of Xamarin UI Tests you can write and debug custom C # scripts directly in Visual Studio.  Xamarin UI Test allows you to cover most user scenarios for iOS / Android, and then also run your tests on hundreds of real devices in the App Center. <br><br>  <a href="http://bitbucket.org/binwell/uitestdemo">Repository with an example</a> . <br><br>  Stay in touch and ask your questions in the comments! <br><br><h2>  The authors </h2><br><img src="https://habrastorage.org/files/f70/e9c/e7a/f70e9ce7a2bd45a98e19652a08b15e26.JPG" align="left" width="120">  <b>Vyacheslav Chernikov</b> - head of development at <a href="https://aka.ms/habr_321454_4">Binwell</a> .  In the past, he was one of the Nokia Champion and Qt Certified Specialists, currently he is the Xamarin and Azure platform specialist.  He came to the sphere of mobile in 2005, since 2008 he has been developing mobile applications: he started with Symbian, Maemo, Meego, Windows Mobile, then switched to iOS, Android and Windows Phone. <br><br>  Articles Vyacheslav you can also read the <a href="https://aka.ms/habr_323296_8">blog on Medium</a> . <br><blockquote>  <b>Minute advertising.</b>  We invite you on April 13 to the <a href="https://info.microsoft.com/CE-AZUREPLAT-WBNR-FY18-04Apr-13-MobileDevOpsinpractice-MCW0005750_01Registration-ForminBody.html">Mobile DevOps in Practice</a> master class, where you can talk with Vyacheslav Chernikov and learn how to organize the DevOps process in the mobile developers team. </blockquote><br><img src="https://habrastorage.org/webt/ov/zz/a9/ovzza9tgppikt-imx3od2qmosfm.jpeg" align="left" width="120">  <b>Pavel Grushevsky</b> , Automated Testing <a href="https://binwell.com/">Specialist</a> , <a href="https://binwell.com/">Binwell</a> . </div><p>Source: <a href="https://habr.com/ru/post/351536/">https://habr.com/ru/post/351536/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../351524/index.html">Koteyki against the Black Lord: statistics online NeoQUEST-2018</a></li>
<li><a href="../351526/index.html">How we lost and found cars in a 9-story car park</a></li>
<li><a href="../351528/index.html">Why don't Statutes and Project Management Plans work?</a></li>
<li><a href="../351530/index.html">Developing games under NES in C. Chapter 24. Appendix 2 - working with memory banks</a></li>
<li><a href="../351534/index.html">FastTrack Training. "Network Basics". "Security basics". Eddie Martin December 2012</a></li>
<li><a href="../351540/index.html">Analysis of performance tasks with JBreak (part 3)</a></li>
<li><a href="../351542/index.html">IBM Cloud Caf√© - Kubernetes meetup</a></li>
<li><a href="../351544/index.html">Katalon Recorder Review and Tutorial (Selenium IDE ++ for Chrome and Firefox)</a></li>
<li><a href="../351548/index.html">How to get PCI DSS certification: IT GRAD experience</a></li>
<li><a href="../351550/index.html">We accept payments by cryptocurrency using PayKassa aggregator</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>