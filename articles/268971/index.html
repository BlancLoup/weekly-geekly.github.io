<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Machine learning, predicting the future and analyzing the reasons for success in e-commerce</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We continue to publish materials from the summer conference Bitrix Summer Fest . This time we want to share with Alexander Serbul‚Äôs presentation on cu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Machine learning, predicting the future and analyzing the reasons for success in e-commerce</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/bf5/d88/30a/bf5d8830a10546c7b29dccf69602cf5b.jpg"><br><br>  We continue to publish materials from the summer conference <a href="http://conf.1c-bitrix.ru/summer2015/">Bitrix Summer Fest</a> .  This time we want to share with Alexander Serbul‚Äôs presentation on current machine learning trends, available techniques, and practical ways to use mathematics to increase conversion and retain customers. <br><br>  The material in any case does not claim to be formal and scientifically strict.  Think of it as a light, fun, useful and introductory "reading matter." <br><a name="habracut"></a><br>  In the world of big-data, higher mathematics and machine learning, something unimaginable is happening now.  When we enter this area and start counting the money it can give, it turns out that we need knowledge, materials and experience from various other areas.  We, as a rule, are developers.  Some of us may be with some mathematical background, someone writes a good code, someone, for example, a dock in mathematical statistics.  And machine learning just requires knowledge and skills in these areas. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/99c/c0e/217/99cc0e217b3f46b78c2eebe7919688fb.jpg"><br><br>  And it does not forgive us some amateurishness.  But very few people can with sufficiently high competence to understand all these areas.  And this is a big problem.  This is understood by modern researchers of machine learning, scientists and employees of various companies.  It turns out that everyone wants to use machine learning, but there are no people who are well versed in all the necessary areas and can eclectically connect the components together. <br><br>  If you turn to Wikipedia or Google in the hope of understanding what logistic regression is, you can go crazy.  A normal person will not understand what is written there.  After all, mathematics is a separate culture that lives by its own laws.  This also applies to us, the developers.  If I tell some mathematics about the TCP / IP stack, about state diagrams, datagrams, refer to the authors of Unix, then he will not understand me either.  And if the developer does not have a "sufficient" mathematical education, it will be quite difficult for him to master the theory of sets, the theory of probability, mathematical statistics, higher mathematics, series, and much more.  And scoring by habit in the search engine query, you will understand little of the results. <br><br><img src="https://habrastorage.org/files/e7f/080/dd0/e7f080dd06d044c8becb9fb0bc51fd28.jpg"><br><br>  You will say that a good developer should know mathematics and be able to learn in general, and refer to the ‚Äúcorrect‚Äù literature.  For example, re-read "Reference book on higher mathematics" Vygodskogo.  And in general, it will be necessary to remember what we were taught in universities, to get into the theory of probability, because the expectation, the correlation matrix, the variance, the standard deviation, the median, the mode - all this we need to know and remember.  But life imposes its own ‚Äúprofessional deformation‚Äù: the modern IT world requires narrow specialization, since it is almost impossible to be a universal, deeply understanding a number of scientific and applied disciplines.  And it is very clearly manifested in the situation around big data and machine learning. <br><br><h3>  What to do? </h3><br>  In fact, now nobody knows what to do with it.  But I still want to try to give a recipe.  I will give an analogy with karate.  This martial art originated among the Japanese peasants who wanted to confront armed and well-trained samurai.  Thanks to karate, peasants armed with sticks and hoes managed to resist the soldiers in armor with swords and spears. <br><br>  In Big Data, I want to suggest that you use an approach where you need to know a small amount of things, but know them well.  Someone may become a sensei over time if he develops intensively and reads the necessary literature. <br><br>  To begin, let's consider what types of machine learning are, what are the principles of their actions, how to evaluate their quality and how they can be applied. <br><br><h3>  What is machine learning? </h3><br>  Why do we need machine learning, why did it come up? <br><br>  Typically, the developer solves the task as follows: he sat down, poured coffee, invented (he took it ready - this is more often) the algorithm, coded it - it works.  The problem is that there are situations where it is extremely difficult to logically solve a problem because of the volume of data and complex interrelations.  Also, often there is little time to solve the problem.  In such cases, it is best to have the computer do all the work for you, learn how to make decisions yourself.  Those.  you need to make a drone out of it and make it not only work, but also think for you. <br><br>  The basic assumptions of the theory of probability state that it is possible to sit down and think over all the connections between entities, but this is very long and expensive.  For example, it is necessary to calculate the range of the projectiles, while there are fluctuations in mass, temperature, quantity and chemical composition of gunpowder, the angle of inclination of the gun, etc.  All this can be taken into account, but you will create a model for a long time and it will be suitable for a specific case - it is expensive.  Therefore, at one time, a probability theory was created, which studies random phenomena and carries out operations with them - in general, they came up with ‚Äúhow to save‚Äù and ‚Äúshorten the way‚Äù.  And with the help of machine learning, you can just ‚Äúteach‚Äù a computer to use the tools of probability theory, and it will be done a priori faster than a person. <br><br><h3>  What can you teach a computer? </h3><br>  First, to classify things: you can determine the gender (male / female), classify mail (spam or not spam), carry out multiclass classification (stone, scissors, paper).  An example of a multi-class life classification: the definition of customer income (low, medium or high ‚Äî three categories). <br><br>  A computer can also learn on its own - this is a clustering task - it takes the data and understands how to group it - but that‚Äôs if you're lucky.  There are tasks where the computer needs to be taught.  That is, there are roughly two types of training: with a teacher and without. <br><br>  You can teach a computer to predict certain data using regression.  Suppose we have a database of apartments with their value and certain attributes (district, area, presence of a kindergarten nearby, etc.).  We train the model and then enter new data, new attributes, based on which it predicts the price.  This is a regression. <br><br><img src="https://habrastorage.org/files/d87/c43/466/d87c434662184e88a106aa0f1c8f0d47.JPG"><br><br><h3>  How does a computer learn? </h3><br>  <b>Perceptron</b> <br>  People have always tried to find out how the human brain works.  But only relatively recently it was found out that the model of neural connections is quite simple and can be implemented algorithmically. <br><br><img src="https://habrastorage.org/files/c91/22f/ec3/c9122fec3b1b4d91932e7aacde9af554.jpg"><br><br>  Data (S-elements) are fed to the input, then A-elements (neurons) take on some values.  We can assign weights, that is, the number of signals reaching each neuron can be varied using mathematical methods.  And the output is R-elements, that is, a kind of prediction issued by neurons. <br><br>  The disadvantage of this approach, implemented ‚Äúhead-on,‚Äù is that neurons can predict only by dividing elements in space linearly. <br><br><img src="https://habrastorage.org/files/b89/b23/91b/b89b2391b50a4e30bbd859f0ebf4287d.jpg"><br><br>  If we have two-dimensional space, then the boundary will be a line, if multidimensional, then the hyperplane.  With this approach, it is possible to solve problems associated with binary classification, that is, with the division of data into two groups. <br><br>  You can also add an intermediate layer.  As a rule, it is not recommended to add more than one intermediate (hidden) layer (otherwise the training time will greatly increase). <br><br><img src="https://habrastorage.org/files/981/818/645/98181864572f4b90be0c8c23d1369588.jpg"><br><br>  The resulting system is a multilayer perceptron - a neural network.  Due to the additional layer of neurons, the perceptron can group data in much more complicated patterns.  That is, not a straight line or a plane, but much more complex lines and surfaces will act as a border.  In other words, the perceptron can approximate any surface.  Developing an idea, you can even learn to recognize faces. <br><br><img src="https://habrastorage.org/files/6c4/bba/6a1/6c4bba6a19014608a0ac7ea3687f8a06.jpg"><br><br>  Today, perceptrons, both ordinary and multilayer (MLP, multilayer perceptron), are well studied and widely used, especially in deep learning <br><br>  <b>Bayesian ID</b> <br>  Englishman Thomas Bayes was a mathematician and priest.  In between worship he created the <a href="https://ru.wikipedia.org/wiki/%25D0%25A2%25D0%25B5%25D0%25BE%25D1%2580%25D0%25B5%25D0%25BC%25D0%25B0_%25D0%2591%25D0%25B0%25D0%25B9%25D0%25B5%25D1%2581%25D0%25B0">Bayes theorem</a> .  It deals with the probability of one event, subject to the origin of another interconnected event.  That is, the whole theorem is visually represented as two intersecting circles. <br><br><img src="https://habrastorage.org/files/418/114/a79/418114a796214168bbf8354900d10fb2.jpg"><br><br>  This theorem and Bayes classifier are used almost everywhere.  For example, mail filtering - spam / non-spam is a Bayesian classifier.  It is much easier to code than a multilayer perceptron.  He learns faster than the neural network.  In addition, it is much more accessible to understand.  Therefore, when you face the task of quickly classifying something, this is the easiest option. <br><br>  Another popular option for binary classification is logistic regression. <br><br>  <b>Decision tree</b> <br>  Suppose you are faced with the task of quickly determining whether a certain animal is flying or crawling.  You can ask if he has paws, tail, eyes, esophagus, nose - all this does not bring us closer to solving the problem.  Just ask if he has wings.  If yes - it is a flying animal. <br><br>  If there are attributes at the input, then with the help of the tree, attributes are searched that allow unambiguously to cut off a part of the input data as if they do not satisfy any condition.  With the help of leading questions, you can very quickly share many possible solutions, step by step reducing the amount of input data.  How effectively each attribute divides data is called entropy. <br><br><img src="https://habrastorage.org/files/407/412/4ee/4074124eebe14649880afc1d94617287.jpg"><br><br>  You can train a classifier and he will build a decision tree inside himself.  Here is an example of a tree with which you can determine the probability of survival in the crash of the Titanic. <br><br><img src="https://habrastorage.org/files/760/2d2/458/7602d2458ea14acaa65e9031713a5b1e.jpg"><br><br>  The decision tree is built quickly and transparently, you can expand the constructed model and see how it works. <br><br>  <b>Random forests</b> <br><br><img src="https://habrastorage.org/files/5fc/0f5/b03/5fc0f5b03aa848e286c9330bc89bdfb4.jpg"><br><br>  Random forests are a collection of decision trees.  How it works?  You can build a lot of small trees that do not work ‚Äúwell enough‚Äù, but if you combine the results of their work, then the efficiency of this set of trees is much higher than that of a single large and complex tree.  The word random is used because an element of randomness is added to the operation of this forest. <br><br>  This algorithm is now very popular, because it is very well parallelized - you can deploy thousands, millions of trees on a heap of cheap iron and conduct machine learning, which will work at the level of the best analogues in the world.  This algorithm is very efficient. <br><br>  <b>Boosting</b> <br>  This algorithm works as follows: it builds, for example, trees one after another, and each next tree learns from the results of the previous one, and the data is modified.  The algorithm can thus divide nested rings into classes, which is a rather difficult classification task. <br><br><img src="https://habrastorage.org/files/22d/288/007/22d2880078dd4565a02213b50f5069fe.jpg"><br><br><img src="https://habrastorage.org/files/4b8/133/9a5/4b81339a5d1e4a69b91925efde7de347.jpg"><br><br>  Boosting takes much longer to complete than the Random forests.  This is due to the fact that in this algorithm it is necessary to consistently train each tree.  This is a big problem. <br><br>  <b>Hidden Markov Model</b> <br>  This <a href="https://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25BA%25D1%2580%25D1%258B%25D1%2582%25D0%25B0%25D1%258F_%25D0%25BC%25D0%25B0%25D1%2580%25D0%25BA%25D0%25BE%25D0%25B2%25D1%2581%25D0%25BA%25D0%25B0%25D1%258F_%25D0%25BC%25D0%25BE%25D0%25B4%25D0%25B5%25D0%25BB%25D1%258C">model was</a> developed on the basis of the <a href="https://ru.wikipedia.org/wiki/%25D0%259C%25D0%25B0%25D1%2580%25D0%25BA%25D0%25BE%25D0%25B2%25D1%2581%25D0%25BA%25D0%25B8%25D0%25B9_%25D0%25BF%25D1%2580%25D0%25BE%25D1%2586%25D0%25B5%25D1%2581%25D1%2581">Markov process</a> created by the famous Russian mathematician Andrei Andreevich Markov.  Markov models are popular in the world, they are actively used by many companies, including Google.  The essence of the Markov model is very simple. <br><br><img src="https://habrastorage.org/files/818/3e6/73d/8183e673d9964a688964ea0d4bad28d1.jpg"><br><br>  There is a certain state - for example, high or low air temperature.  But what kind of condition - you do not know.  But you know the signs: the sun was shining, it was raining, there were clouds.  You have a certain set of values ‚Äã‚Äãcollected for the statistical period: the sun - rain, the sun - rain - clouds.  The numbers above the arrows are probabilities, i.e.  if the sun, then with a probability of 60% is warm and with a probability of 20% it is cold.  If the clouds, it is warm with a probability of 10%, and cold with a probability of 40%. <br><br>  When you get a list of states, you can calculate in which internal, hidden state the system was.  What can it be useful for?  Say, when you analyze the client's action - he paid for it with a card, turned to tech support, made an order, looked at the catalog item - you can tie these actions to hidden actions. <br><br>  For example, actions that show the level of customer loyalty to you - low, medium, high.  And based on this, you predict the state of the client.  If yesterday he was in a "high" state of loyalty, tomorrow on average, the day after tomorrow in a low one, then the trend will let you know that you need to do something, otherwise you can "accidentally" lose the client.  Hidden Markov models are widely used for solving such problems. <br><br><h3>  How to evaluate the quality of the model? </h3><br>  There is one fairly good, understandable to all measure of the effectiveness of mathematical models, predictors - <a href="https://en.wikipedia.org/wiki/Confusion_matrix">Confusion matrix</a> . <br><br><img src="https://habrastorage.org/files/15f/347/3e7/15f3473e7afc4f36823a193905bb9270.jpg"><br><br>  Suppose you have trained a certain model and it has decomposed the original data into groups.  Horizontally, real groups are deposited, and vertically - predicted by the model.  In the example above, we have in fact 209 ducks (the total number in the Duck group horizontally), 242 birds (Bird), 209 frogs (Frog), 198 gulls (Seagull) and 198 pigeons (Dove).  Quantitative distribution of results by groups is presented in columns.  The more accurately your model works, the better it is, the brighter the data diagonal on the matrix is, the smaller the values ‚Äã‚Äãin the cells outside the diagonals. <br><br><h3>  Where and what to apply? </h3><br>  <b>Churn-rate</b> : classifier, regressor.  It is used to calculate the probability that a particular person may cease to be your client.  This is useful when conducting marketing campaigns to retain customers.  You make a classifier: enter customer data and, on their basis, determine whether it will leave or not.  This saves the marketing budget. <br><br>  <b>CLV (customer lifetime value)</b> : classifier, regressor.  By the activity of the client allows you to assess how much money he can bring to your company.  Enter all statistics into the system, make a perceptron, or build a decision tree, or a Bayesian classifier, or a logistic regression, and determine how much money the client has brought - a small amount, medium, large.  Then enter the customer data and the model predicts that this customer can bring you a large amount (before that you already learned how to count the probability).  And when the client is ready to leave, and he is expensive and can bring a lot of money, you start working only with him, and not with everyone.  As a result, your marketing campaigns shrink and become more efficient.  Or if such a client calls you, then CRM redirects the call not to the manager, but to the manager.  This approach is widely used in the West by banks, insurance companies, large retailers.  We are just starting to develop it. <br><br>  <b>The effectiveness of a marketing campaign for a specific client</b> : a classifier.  By collecting data from several past marketing campaigns, you can assess whether a new customer will respond to the next campaign. <br><br>  For example, you have developed five advertising campaigns.  And when you need to stimulate a client who is ready to leave and is valuable to you, you are mathematically testing which advertising campaign he will respond to.  Thus, it is possible to group the client base and target advertising and marketing campaigns for the sake of increasing their efficiency. <br><br>  <b>Customer loyalty trend</b> : hidden Markov model.  You track the internal state of the client in the system by his actions.  If the trend of the internal state falls, you are doing something. <br><br>  <b>Price / volume of purchases</b> : regressor.  The classic problem of forecasting the volume of purchases of goods based on the intensity of sales. <br><br>  <b>Similar products</b> : KNN (k nearest neighborhoods).  You are clustering products, looking for the nearest cluster and returning products that are most similar.  This is a variant of the search engine algorithm in mathematical KNN. <br><br>  <b>Accessories</b> : item2item collaborative filtering.  You have basic products and you need to bind related accessories, for example, cases to smartphones.  Customers, walking through the site and choosing, give you data from which you can build a matrix to perform the binding.  Thus, we offer the client relevant products, increasing turnover and customer satisfaction. <br><br>  <b>Recommendations</b> : item2item collaborative filtering.  The approach is similar to the previous one.  For example, you watched two films from the Star Wars series, and we recommend the rest to you.  That is, we recommend you products that have already been bought by your friends or people who resemble you by some criteria or behavioral patterns. <br><br><h3>  Soft </h3><br><img src="https://habrastorage.org/files/76d/95b/9ea/76d95b9eac004008973bbe84dae93caa.jpg"><br><br>  You can play with different algorithms with RapidMiner, IBM SPSS, SAS, Spark MLlib.  For example, in our project we need to count everything in a parallel cloud, and for this we need Spark, MapReduce and a lot of beer cans. <br><br>  Colleagues, we wish you good luck in the fascinating process of applied machine learning.  The main thing is not to give up, constantly go ahead and useful models for business will open in all its glory.  Only by diligently experimenting with algorithms, data sets, and measuring the quality of the output, you can achieve sustained success and overtake competitors.  Good luck to you! </div><p>Source: <a href="https://habr.com/ru/post/268971/">https://habr.com/ru/post/268971/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../268961/index.html">October 17, from 10:00 (MSK), watch the online translation of SQLSaturday</a></li>
<li><a href="../268963/index.html">HTML5 Video and Audio support in new Vivaldi 1.0.300.5 browser build</a></li>
<li><a href="../268965/index.html">How to become a cloud IP PBX provider - Step-by-Step Guide</a></li>
<li><a href="../268967/index.html">VR and AR Digest: September</a></li>
<li><a href="../268969/index.html">BabylonJS Tutorial - Using Sprites</a></li>
<li><a href="../268973/index.html">Creating a space browser game. First experience</a></li>
<li><a href="../268975/index.html">Recipe for rotating planets in space on HTML5 + JavaScript</a></li>
<li><a href="../268977/index.html">Mental Labor and Physical Education</a></li>
<li><a href="../268979/index.html">Visualization of static and dynamic networks on R, part 7, the last</a></li>
<li><a href="../268981/index.html">Adobe has released an emergency update for Flash Player.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>