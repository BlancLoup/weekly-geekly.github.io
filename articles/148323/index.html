<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Bot for browser Angry Pets</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Warning : the bot is simple to disgrace. You are unlikely to learn something new. Article just for fun. 

 I decided that after a year you can look at...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Bot for browser Angry Pets</h1><div class="post__text post__text-html js-mediator-article">  <i>Warning</i> : the bot is simple to disgrace.  You are unlikely to learn something new.  Article just for fun. <br><br><img align="left" src="https://habrastorage.org/storage2/d47/d82/04c/d47d8204c61575fa5c411597f675c674.png">  I decided that after a year you can look at what friends vkontakte fun.  In addition to traditional tons of political politics, pictures of kittens and other indecencies, I found a link to the <a href="http://www.angrypets.ru/">Angry Pets</a> browser.  I never played browser, so I decided to see what kind of animal it is.  It turned out the following: the pictures are the kuaiest (cute seals, penguins and little squirrels hit each other‚Äôs muzzles), the donate is more anonymous (they multiply the income 8 times for money), the plot, the strategy, the hopelessness, the manual and other usual amenities are absent. <br><br><img align="right" src="https://habrastorage.org/storage2/d87/44a/d09/d8744ad09f90a4202d7e252a276e807f.png">  The game slightly less than completely consists of the following simple operations: build a building, wait 10 minutes, build units, wait 10 minutes, find a victim, send units to attack, wait 10 minutes, find a victim, send units to attack, wait 10 minutes ... (10 minutes at high levels grow exponentially. For acceleration - a separate fee.) 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      What to do with this game?  That's right, write a bot.  Do not play <i>it</i> , honestly. <br><br><a name="habracut"></a><img src="https://habrastorage.org/storage2/486/5ef/930/4865ef930fb762641ed50775e15aee0d.png"><br><br>  We set the task: <br><br><ul><li>  A bot should be able to attack scheduled cities by a list. </li><li>  The bot can be set, what units to attack. </li><li>  The bot should not immediately fire.  :) </li></ul><br>  To prevent the bot from sleeping right away, firstly, we choose the players who did not go online for a long time as victims for <s>beating</s> <u>farm</u> <s>babies</s> so that they would not complain about where they should go;  secondly, we imitate actions of the user, but we do not send naked AJAX requests;  thirdly, the delay between actions is not zero, but random. <br><br>  To the joy of the authors of the bots, the scripts on the site are not obfuscated.  The only packaged scripts are jQuery and the like.  And yes, there is jQuery, so we use all the benefits of civilization. <br><br>  Most of the actions in the game lead to AJAX requests.  You click an item, the request leaves, either the almost full screen comes up, or a separate window.  Examining the links in the debugger, we see that they look like <pre><code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/10193192/city/view/10009466"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-link-handled</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">onclick</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Main.goToUrl(this);return false;"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre>  where the method Main.goToUrl accepts either strings or link elements.  Most game links have a prefix with a player profile id at the beginning.  Save it. <br><br><pre> <code class="hljs mel"> profilePath: <span class="hljs-keyword"><span class="hljs-keyword">window</span></span>.location.pathname.<span class="hljs-keyword"><span class="hljs-keyword">match</span></span>(/^\/\d+\<span class="hljs-comment"><span class="hljs-comment">//)[0],</span></span></code> </pre><br>  How to wait for an AJAX request?  JQuery has a nice $ .ajaxSuccess function that you can pass a callback to be called after each successful request.  Event, object XMLHttpRequest and arguments of a call of $ .ajax fall down into it.  Accordingly, when we receive a given URL, we call our callback. <br><br><pre> <code class="hljs javascript"> ajaxCallbacks: {}, <span class="hljs-attr"><span class="hljs-attr">run</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ ... $(<span class="hljs-string"><span class="hljs-string">'html'</span></span>).ajaxSuccess(Bot.ajaxSuccess); ... }, <span class="hljs-attr"><span class="hljs-attr">ajaxSuccess</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e, xhr, settings</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ajaxUrl = <span class="hljs-literal"><span class="hljs-literal">null</span></span>, ajaxCallback = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; $.each(Bot.ajaxCallbacks, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">url, callback</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> fullUrl = Bot.profilePath + url; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (settings.url.substr(<span class="hljs-number"><span class="hljs-number">0</span></span>, fullUrl.length) == fullUrl) { ajaxUrl = url; ajaxCallback = callback; } }); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ajaxCallback) { Bot.ajaxCallbacks[ajaxUrl] = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; setTimeout(ajaxCallback, Bot.getClickDelay()); } }, <span class="hljs-attr"><span class="hljs-attr">waitForAjax</span></span>: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">pageUrl, gotoPage, success</span></span></span><span class="hljs-function">) </span></span>{ Bot.ajaxCallbacks[pageUrl] = success; gotoPage(); },</code> </pre><br>  Well, purely for uniformity, we add waitForAction to waitForAjax, when you need not to wait for AJAX, but just to make a delay. <br><br><pre> <code class="hljs matlab"> waitForAction: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(action, success)</span></span></span><span class="hljs-function"> { </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">action</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setTimeout</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(success, Bot.getClickDelay()</span></span></span><span class="hljs-function">); },</span></span></code> </pre><br>  How does a simple humanized mortal often farm?  Clicks on the mail button, go to the logs, selects the recently attacked city, presses "Attack", selects units, presses "Fill the face." <br><br><img src="https://habrastorage.org/storage2/5df/e19/681/5dfe1968152c6410dc6a0c310877694e.png"><br><br>  So we will repeat this operation in a circle.  Of course, in the logs the desired city will not always be on the necessary page, but it is frankly too lazy to write the complex logic of turning over without much motivation. <br><br>  Choosing a victim and forming links ... <br><pre> <code class="hljs actionscript"> attackNext: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Bot.targetCities.length == <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!Bot.targetCities[Bot.currentTargetCity]) Bot.currentTargetCity = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> targetCity = Bot.targetCities[Bot.currentTargetCity++], targetCityUrl = <span class="hljs-string"><span class="hljs-string">'city/view/'</span></span> + targetCity, attackCityUrl = <span class="hljs-string"><span class="hljs-string">'attack/'</span></span> + targetCity;</code> </pre><br>  Follow the links and click the buttons ... <br><pre> <code class="hljs javascript"> Bot.waitForAjax(<span class="hljs-string"><span class="hljs-string">'pm/inbox'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ Main.goToUrl(Bot.profilePath + <span class="hljs-string"><span class="hljs-string">'pm/inbox'</span></span>); }, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ Bot.waitForAjax(<span class="hljs-string"><span class="hljs-string">'pm/logs'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ Main.goToUrl(Bot.profilePath + <span class="hljs-string"><span class="hljs-string">'pm/logs'</span></span>); }, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ Bot.waitForAjax(targetCityUrl, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ Main.goToUrl(Bot.profilePath + targetCityUrl); }, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ Bot.waitForAjax(attackCityUrl, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ $(<span class="hljs-string"><span class="hljs-string">'button[onclick^="Attack.showAttackAlert"]'</span></span>).click(); }, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{</code> </pre><br>  Either select specific units (the available amount is in the attribute max), or select all (a separate button), and then the most important thing: click "Attack". <br><pre> <code class="hljs javascript"> Bot.waitForAction(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> count = <span class="hljs-number"><span class="hljs-number">0</span></span>; $.each(Bot.attackUnits, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">unitType, unitNum</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ctl = $(<span class="hljs-string"><span class="hljs-string">'input[name="units['</span></span> + unitType + <span class="hljs-string"><span class="hljs-string">']"]'</span></span>); ctl.val(<span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.min(ctl.attr(<span class="hljs-string"><span class="hljs-string">'max'</span></span>), unitNum)).change(); count++; }); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (count == <span class="hljs-number"><span class="hljs-number">0</span></span>) { $(<span class="hljs-string"><span class="hljs-string">'span[onclick^="Attack.ChooseEveryone"]'</span></span>).click(); } }, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ $(<span class="hljs-string"><span class="hljs-string">'button[type=submit]'</span></span>).click(); setTimeout(Bot.attackNext, Bot.getAttackInterval()); })</code> </pre><br>  Popup layers, when navigating through AJAX-pages, close themselves, you can not bother. <br><br>  Actually, everything.  Only a beautiful list of attacked cities can be screwed to see who we dab. <br><br>  Full code: <br><pre> <code class="hljs lua">window.Bot = { attackInterval: /*<span class="hljs-number"><span class="hljs-number">5.5</span></span>*/<span class="hljs-number"><span class="hljs-number">8</span></span> * <span class="hljs-number"><span class="hljs-number">60</span></span> * <span class="hljs-number"><span class="hljs-number">1000</span></span>, // <span class="hljs-number"><span class="hljs-number">8</span></span> <span class="hljs-built_in"><span class="hljs-built_in">min</span></span> attackIntervalRandom: <span class="hljs-number"><span class="hljs-number">1.2</span></span> * <span class="hljs-number"><span class="hljs-number">60</span></span> * <span class="hljs-number"><span class="hljs-number">1000</span></span>, // <span class="hljs-number"><span class="hljs-number">1.2</span></span> <span class="hljs-built_in"><span class="hljs-built_in">min</span></span> clickDelay: <span class="hljs-number"><span class="hljs-number">3</span></span> * <span class="hljs-number"><span class="hljs-number">1000</span></span>, // <span class="hljs-number"><span class="hljs-number">3</span></span> sec clickDelayRandom: <span class="hljs-number"><span class="hljs-number">4</span></span> * <span class="hljs-number"><span class="hljs-number">1000</span></span>, // <span class="hljs-number"><span class="hljs-number">4</span></span> sec targetCities: [ //<span class="hljs-number"><span class="hljs-number">12345678</span></span> ], attackUnits: { //<span class="hljs-number"><span class="hljs-number">101</span></span>: <span class="hljs-number"><span class="hljs-number">99</span></span> }, profilePath: window.location.pathname.<span class="hljs-built_in"><span class="hljs-built_in">match</span></span>(/^\/\d+\//)[<span class="hljs-number"><span class="hljs-number">0</span></span>], currentTargetCity: <span class="hljs-number"><span class="hljs-number">0</span></span>, ajaxCallbacks: {}, run: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { var box = <span class="hljs-string"><span class="hljs-string">'&lt;div style="position: absolute; background: #fff; padding: 10px; border-radius: 10px; left: 20px; top: 20px; z-index: 666666"&gt;'</span></span>; $.each(Bot.targetCities, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(_, cityId)</span></span></span></span> { box += <span class="hljs-string"><span class="hljs-string">'&lt;a class="bot-target-city" data-link-handled="1" onclick="Main.goToUrl(this);return false;"'</span></span> + <span class="hljs-string"><span class="hljs-string">' id="bot-target-city-'</span></span> + cityId + <span class="hljs-string"><span class="hljs-string">'"'</span></span> + <span class="hljs-string"><span class="hljs-string">' href="'</span></span> + Bot.profilePath + <span class="hljs-string"><span class="hljs-string">'city/view/'</span></span> + cityId + <span class="hljs-string"><span class="hljs-string">'"&gt;'</span></span> + cityId + <span class="hljs-string"><span class="hljs-string">'&lt;/a&gt;&lt;br&gt;'</span></span>; }); box += <span class="hljs-string"><span class="hljs-string">'&lt;/div&gt;'</span></span>; $(<span class="hljs-string"><span class="hljs-string">'body'</span></span>).append(box); $(<span class="hljs-string"><span class="hljs-string">'html'</span></span>).ajaxSuccess(Bot.ajaxSuccess); Bot.attackNext(); }, ajaxSuccess: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(e, xhr, settings)</span></span></span></span> { var ajaxUrl = null, ajaxCallback = null; $.each(Bot.ajaxCallbacks, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(url, callback)</span></span></span></span> { var fullUrl = Bot.profilePath + url; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (settings.url.substr(<span class="hljs-number"><span class="hljs-number">0</span></span>, fullUrl.length) == fullUrl) { ajaxUrl = url; ajaxCallback = callback; } }); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (ajaxCallback) { Bot.ajaxCallbacks[ajaxUrl] = null; setTimeout(ajaxCallback, Bot.getClickDelay()); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { console.<span class="hljs-built_in"><span class="hljs-built_in">log</span></span>(<span class="hljs-string"><span class="hljs-string">'Not recognized '</span></span> + settings.url); } }, waitForAjax: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(pageUrl, gotoPage, success)</span></span></span></span> { Bot.ajaxCallbacks[pageUrl] = success; gotoPage(); }, waitForAction: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(action, success)</span></span></span></span> { action(); setTimeout(success, Bot.getClickDelay()); }, getAttackInterval: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> parseInt(Bot.attackInterval + Math.<span class="hljs-built_in"><span class="hljs-built_in">random</span></span>() * Bot.attackIntervalRandom); }, getClickDelay: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> parseInt(Bot.clickDelay + Math.<span class="hljs-built_in"><span class="hljs-built_in">random</span></span>() * Bot.clickDelayRandom); }, attackNext: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (Bot.targetCities.length == <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!Bot.targetCities[Bot.currentTargetCity]) Bot.currentTargetCity = <span class="hljs-number"><span class="hljs-number">0</span></span>; var targetCity = Bot.targetCities[Bot.currentTargetCity++], targetCityUrl = <span class="hljs-string"><span class="hljs-string">'city/view/'</span></span> + targetCity, attackCityUrl = <span class="hljs-string"><span class="hljs-string">'attack/'</span></span> + targetCity; $(<span class="hljs-string"><span class="hljs-string">'a.bot-target-city'</span></span>).css({ fontWeight: <span class="hljs-string"><span class="hljs-string">'normal'</span></span> }); $(<span class="hljs-string"><span class="hljs-string">'a#bot-target-city-'</span></span> + targetCity).css({ fontWeight: <span class="hljs-string"><span class="hljs-string">'bold'</span></span> }); Bot.waitForAjax(<span class="hljs-string"><span class="hljs-string">'pm/inbox'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { Main.goToUrl(Bot.profilePath + <span class="hljs-string"><span class="hljs-string">'pm/inbox'</span></span>); }, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { Bot.waitForAjax(<span class="hljs-string"><span class="hljs-string">'pm/logs'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { Main.goToUrl(Bot.profilePath + <span class="hljs-string"><span class="hljs-string">'pm/logs'</span></span>); }, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { Bot.waitForAjax(targetCityUrl, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { Main.goToUrl(Bot.profilePath + targetCityUrl); }, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { Bot.waitForAjax(attackCityUrl, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { $(<span class="hljs-string"><span class="hljs-string">'button[onclick^="Attack.showAttackAlert"]'</span></span>).click(); }, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { Bot.waitForAction(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { var count = <span class="hljs-number"><span class="hljs-number">0</span></span>; $.each(Bot.attackUnits, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(unitType, unitNum)</span></span></span></span> { var ctl = $(<span class="hljs-string"><span class="hljs-string">'input[name="units['</span></span> + unitType + <span class="hljs-string"><span class="hljs-string">']"]'</span></span>); ctl.val(Math.<span class="hljs-built_in"><span class="hljs-built_in">min</span></span>(ctl.attr(<span class="hljs-string"><span class="hljs-string">'max'</span></span>), unitNum)).change(); count++; }); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (count == <span class="hljs-number"><span class="hljs-number">0</span></span>) { $(<span class="hljs-string"><span class="hljs-string">'span[onclick^="Attack.ChooseEveryone"]'</span></span>).click(); } }, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> { $(<span class="hljs-string"><span class="hljs-string">'button[type=submit]'</span></span>).click(); setTimeout(Bot.attackNext, Bot.getAttackInterval()); }) }); }); }); }); } }; Bot.run();</code> </pre><br><br>  Instructions for use: <br><br><ul><li>  In the code, fill the targetCities array with the identifiers of the attacked cities.  When viewing a city page, an identifier is the number at the very end. </li><li>  In the code, the attackUnits object should be filled in with the type of a unit in pairs - the number of units.  <a href="">Type identifiers are</a> kindly provided by the developers (101 of the example is the feline "fighter"). </li><li>  Adjust the delays according to their capabilities: attackInterval - the interval between attacks, clickDelay - the delay for clicks, the values ‚Äã‚ÄãRandom - the range of the randomly added delay. </li><li>  Enter the game. </li><li>  Run the code from the debug console. </li><li>  If everything is correct, then a list of identifiers of the attacked cities will appear on the left, and the script will launch an attack on the first city.  The current city is bold. </li></ul><br>  In general, I am amused by the arrogance of the game owners.  "Subscription fee" in the form of Ozverin (without which to play even more sadly) is 180 rubles / month (WoW, which has everything that is not in this game, costs only 2 times more expensive).  Resources can be bought for up to 120 rubles / day (day!), Increasing the rate of resource extraction by 8 times (competition of wallets, non-paying in general go to the forest).  The open spaces for <s>extorting</s> Donat on accelerators, details for a rocket, bonuses for attacking, completing quests (yeah, paid 300 rubles - the quest was completed) and other trifles are generally limitless.  Exchange of resources, joining the clan, etc. - just for the money.  They have to pay "the choice of players" - this is a coin for 1500 rubles.  And this is all covered by an iron argument: ‚ÄúPart of the income goes to WWF!  You are saving cute furry animals!  You will be outraged - ban nafig! " <br><br>  And because people pay.  I go nuts. </div><p>Source: <a href="https://habr.com/ru/post/148323/">https://habr.com/ru/post/148323/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../148313/index.html">The principles of minimalism in developing games for mobile platforms</a></li>
<li><a href="../148316/index.html">Installing Debian on a physically accessible system without a monitor and keyboard</a></li>
<li><a href="../148317/index.html">Defending against spam with IronPort c170</a></li>
<li><a href="../148318/index.html">Auto-Renewable Subscription in iOS: proper implementation and pitfalls</a></li>
<li><a href="../148319/index.html">Recognition of numbers by 4 points</a></li>
<li><a href="../148324/index.html">Sublime Text 2: How to create a snippet?</a></li>
<li><a href="../148325/index.html">Computational geometry, or how I became involved in Olympiad programming. Part 2</a></li>
<li><a href="../148326/index.html">The practice of using digital filters</a></li>
<li><a href="../148327/index.html">‚ÄúDiv‚Äù blocks of the same height</a></li>
<li><a href="../148329/index.html">What have you spent your best karma on?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>