<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Absurdly fast base64 encoding and decoding</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="About the author: Daniel Lemer is a professor of computer science at the University of Quebec (Canada). His research affects software performance and ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Absurdly fast base64 encoding and decoding</h1><div class="post__text post__text-html js-mediator-article">  <font color="gray">About the author: Daniel Lemer is a professor of computer science at the University of Quebec (Canada).</font>  <font color="gray">His research affects software performance and data engineering.</font> <br><br>  Computers store data as a stream of bits.  As images, audio or video files, and binary files can contain almost any sequence of bits. <br><br>  However, we often use text formats;  for example, web pages and emails must be in text format.  How do we send images by email?  How do we embed pictures on web pages?  One of the options is to put a link to a real binary file.  Another typical approach is to embed a binary file directly into the body of a letter or web page using <a href="https://en.wikipedia.org/wiki/Base64">base64</a> .  Base64 is just a standard text format that can be used to encode any binary data.  To be precise, the base64 code is always valid ASCII text (and therefore also valid UTF-8).  Each base64 code byte contains 6 data bits.  That is, we "lose" about 2 bits per byte.  Therefore, the equivalent of the base64 binary file will be about 33% more.  In practice, such an increase in size rarely becomes a problem.  As far as I know, email attachments are almost always base64 encoded. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      When writing HTML, I found it convenient to embed images directly into HTML code using the <a href="https://en.wikipedia.org/wiki/Data_URI_scheme">data URI scheme</a> .  For example, in a <a href="https://lemire.me/blog/2018/01/16/microbenchmarking-calls-for-idealized-conditions/">recent article,</a> I thus encoded a PNG file.  The largest websites like Google constantly use this scheme.  A small disadvantage is that web pages slightly increase in size (which is obvious) and you cannot take advantage of image caching.  But the browser saves one network request. <br><a name="habracut"></a><br>  If you are a web developer, you can use <a href="https://en.wikipedia.org/wiki/Web_storage">Web Storage</a> to create a database for your application on the client side.  This client database will store images and arbitrary data, but they must all be encoded in base64. <br><br>  Most database engines support binary data, but some require coding in base64 at some point: these are MongoDB, Elasticsearch, Amazon SimpleDB and Amazon DynamoDB.  Probably some more. <br><br>  Base64 is commonly used for key exchange in cryptography.  The base64 form is also used to transfer arbitrary data as part of a URI. <br><br>  Fortunately, base64 encoding and decoding is fast.  Although there are cases where insufficient speed can be a problem.  Matt Crane and Jimmy Lin <a href="https://cs.uwaterloo.ca/~jimmylin/publications/Crane_Lin_ICTIR2017.pdf">discovered</a> slow decoding of base64 binary attributes in Amazon DynamoDB. <br><br>  How fast can you decode base64 data?  On the latest Intel processor, this takes about two cycles per byte (from the cache) when using a fast decoder like the one built into the Chrome browser.  This fast decoder is mainly busy with table calls.  This is much slower than copying data in the cache (which takes less than 0.05 cycles per byte). <br><br>  Is this the best you can get? <br><br>  A few years ago, Alfred Klopp <a href="http://www.alfredklomp.com/programming/sse-base64/">showed</a> that much better results could be achieved using vector instructions.  Wojciech Mula, I myself and several colleagues (including Howard and Kurtz) decided to seriously reconsider the problem.  Mula opened a <a href="http://0x80.pl/notesen/2016-01-12-sse-base64-encoding.html">webpage</a> dedicated to this topic. <br><br>  We found that you can speed up processing 10 times and use only about 0.2 cycles per byte on the latest Intel processors using vector instructions.  This is still more than copying, but much less than the limit that could ever become the bottleneck of the system.  I should note that error handling enters into these 0.2 cycles per byte: the decoder must decode and check the input data (for example, if invalid characters are found, then decoding is canceled). <br><br>  <a href="https://github.com/lemire/fastbase64">The code for our research is available</a> , so you can reproduce the results.  Our article is published on arXiv and accepted for publication in the web version of ACM Transactions. <br><br>  As far as I understand, our good results are integrated into <a href="https://github.com/aklomp/base64">Klomp's base64 library</a> . <br><br><h4>  Additional materials: </h4><br>  Wojciech Mule, Daniel Lemer, ‚Äú <a href="https://arxiv.org/abs/1704.00605">Faster Base64 encoding and decoding using AVX2 instructions</a> ‚Äù, web version of ACM Transactions (coming soon) </div><p>Source: <a href="https://habr.com/ru/post/347864/">https://habr.com/ru/post/347864/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../347848/index.html">Blockchain - the future of financial technology?</a></li>
<li><a href="../347852/index.html">Web development experience when making a ‚ÄúMake a Word‚Äù game</a></li>
<li><a href="../347854/index.html">Special projects at Sberbank Technologies: how banks are preparing Hadoop, Spark, Kafka and other Big Data</a></li>
<li><a href="../347856/index.html">Data structures with program properties</a></li>
<li><a href="../347858/index.html">Digest news from the world of PostgreSQL. Issue number 2</a></li>
<li><a href="../347866/index.html">Implicit type conversion in javascript. How many will be! + [] + [] +! []?</a></li>
<li><a href="../347868/index.html">The miner on the site is evil (although it can be good)</a></li>
<li><a href="../347870/index.html">‚ÄúStrashilka‚Äù about GDPR</a></li>
<li><a href="../347872/index.html">Pygest # 23. News, releases, articles, interesting projects and libraries from the world of Python [February 4, 2018 - February 26, 2018]</a></li>
<li><a href="../347874/index.html">Is it time for open and free processors?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>