<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The first steps in developing Flash games. Making Backend on AMFPHP</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Social games are a very unstable, but at the same time very demanding and interesting branch of development. 

 When you start working with a new proj...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The first steps in developing Flash games. Making Backend on AMFPHP</h1><div class="post__text post__text-html js-mediator-article">  Social games are a very unstable, but at the same time very demanding and interesting branch of development. <br><br>  When you start working with a new project, you are always between two fires - on the one hand, you need to do everything very quickly, because  Most likely, several of your competitors have also begun to develop, and they step on your heels, but on the other hand, you must do so that if tomorrow attendance increases 5 times, your servers must endure it. <br><br>  But this is all the lyrics, and there is plenty of lyricism and romance in our life, so let's get straight to the technical details. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br><br><br><h5>  AMF </h5>  This is a binary format that uses serialized ActionScript objects for cross-domain communication. In principle, this is sufficient information to understand why to use it, but for those who want to learn more, there is a <a href="http://en.wikipedia.org/wiki/Action_Message_Format">wikipedia</a> that I don‚Äôt see to quote. <br><br><h5>  AMFPHP </h5>  <a href="http://amfphp.sourceforge.net/">AMFPHP is</a> used as the AMF parsing library, because: <br>  1. It can be quickly installed <br>  2. Does not require installation of additional extensions on the server <br>  3. Opensource, and written in PHP, which helps to quickly understand it and change its behavior as it should (this is an extreme case, but the opportunity should still be) <br>  3. Not tied to any framework and is not a framework itself. <br>  4. Native Parsit JSON <br>  5. Contains built-in profiler. <br><br><h5>  Primary setting. </h5>  To begin with, we introduce some conventions.  Access to the project is carried out at http: // game /.  DOCUMENT_ROOT for our project is the www folder, the application is in the app folder, and all third-party libraries in the lib folder.  Models are in the app / model folder, and abstract classes are in the app / model / abstract folder, controllers are in the / app / controller folder.  If you decide to blindly follow my guide, then I advise you to create these folders. <br><br><h5>  The process of raising the server. </h5> 0. Create a file www / gateway.php with this content: <blockquote> <code><font color="#000000">&lt;?php</font> &lt;br/&gt; <font color="#b1b100">require_once</font> <font color="#0000ff">'../app/config.php'</font> <font color="#339933">;</font> &lt;br/&gt; <font color="#b1b100">require_once</font> <font color="#0000ff">'amfphp/gateway.php'</font> <font color="#339933">;</font></code> </blockquote> <br>  1. <a href="http://sourceforge.net/projects/amfphp/files/">Download AMFPHP</a> , unpack it, put the core folder and all the files that are in the root (except .htaccess) in the lib / amfphp folder <br><br>  2. Create an app / config.php file with the following content: <blockquote> <code><font color="#000000">&lt;?php</font> &lt;br/&gt; <font color="#666666">//   </font> &lt;br/&gt; <font color="#990000">define</font> <font color="#009900">(</font> <font color="#0000ff">'ROOT_DIR'</font> <font color="#339933">,</font> <font color="#0000ff">'/var/www/game/'</font> <font color="#009900">)</font> <font color="#339933">;</font> <font color="#666666">//     </font> &lt;br/&gt; <font color="#990000">define</font> <font color="#009900">(</font> <font color="#0000ff">'LOG_DIR'</font> <font color="#339933">,</font> ROOT_DIR <font color="#339933">.</font> <font color="#0000ff">'log/'</font> <font color="#009900">)</font> <font color="#339933">;</font> <font color="#666666">//   </font> &lt;br/&gt; <font color="#990000">define</font> <font color="#009900">(</font> <font color="#0000ff">'GAME_PLATFORM'</font> <font color="#339933">,</font> <font color="#0000ff">'development'</font> <font color="#009900">)</font> <font color="#339933">;</font> <font color="#666666">//  </font> &lt;br/&gt; <font color="#000088">$paths</font> <font color="#339933">=</font> <font color="#990000">array</font> <font color="#009900">(</font> &lt;br/&gt; <font color="#0000ff">'.'</font> <font color="#339933">,</font> &lt;br/&gt;    ROOT_DIR <font color="#339933">.</font> <font color="#0000ff">'lib'</font> <font color="#339933">,</font> &lt;br/&gt;    ROOT_DIR <font color="#339933">.</font> <font color="#0000ff">'app'</font> &lt;br/&gt; <font color="#009900">)</font> <font color="#339933">;</font> &lt;br/&gt; <font color="#990000">set_include_path</font> <font color="#009900">(</font> <font color="#990000">implode</font> <font color="#009900">(</font> PATH_SEPARATOR <font color="#339933">,</font> <font color="#000088">$paths</font> <font color="#009900">)</font> <font color="#009900">)</font> <font color="#339933">;</font></code> </blockquote> <br>  3. In the file lib / amfphp / globals.php, assign the value $ ROOT_DIR to the variable $ servicesPath.  "App / controller /" <br><br>  4. Create an app / model / Response.php file with the following content: <br> <code>&lt;?php <font color="#000000">&lt;?php</font> &lt;br/&gt;abstract <font color="#000000">class</font> Response&lt;br/&gt; <font color="#009900">{</font> &lt;br/&gt;    protected <font color="#000088">$error</font> <font color="#339933">;</font> &lt;br/&gt;    protected <font color="#000088">$content</font> <font color="#339933">=</font> <font color="#990000">array</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> &lt;br/&gt; &lt;br/&gt; <font color="#000000">public</font> <font color="#000000">function</font> __construct <font color="#009900">(</font> <font color="#990000">array</font> <font color="#000088">$content</font> <font color="#339933">=</font> <font color="#009900">null</font> <font color="#009900">)</font> &lt;br/&gt; <font color="#009900">{</font> &lt;br/&gt; <font color="#b1b100">if</font> <font color="#009900">(</font> <font color="#990000">isset</font> <font color="#009900">(</font> <font color="#000088">$content</font> <font color="#009900">)</font> <font color="#009900">)</font> <font color="#009900">{</font> &lt;br/&gt; <font color="#000088">$this</font> <font color="#339933">-&gt;</font> <font color="#004000">content</font> <font color="#339933">=</font> <font color="#000088">$content</font> <font color="#339933">;</font> &lt;br/&gt; <font color="#009900">}</font> &lt;br/&gt; <font color="#009900">}</font> &lt;br/&gt; &lt;br/&gt; <font color="#000000">public</font> <font color="#000000">function</font> addContent <font color="#009900">(</font> <font color="#000088">$content</font> <font color="#009900">)</font> &lt;br/&gt; <font color="#009900">{</font> &lt;br/&gt; <font color="#b1b100">if</font> <font color="#009900">(</font> <font color="#339933">!</font> <font color="#990000">is_array</font> <font color="#009900">(</font> <font color="#000088">$content</font> <font color="#009900">)</font> <font color="#009900">)</font> <font color="#009900">{</font> &lt;br/&gt; <font color="#b1b100">return</font> <font color="#009900">false</font> <font color="#339933">;</font> &lt;br/&gt; <font color="#009900">}</font> &lt;br/&gt; <font color="#b1b100">foreach</font> <font color="#009900">(</font> <font color="#000088">$content</font> <font color="#b1b100">as</font> <font color="#000088">$name</font> <font color="#339933">=&gt;</font> <font color="#000088">$data</font> <font color="#009900">)</font> <font color="#009900">{</font> &lt;br/&gt; <font color="#000088">$this</font> <font color="#339933">-&gt;</font> <font color="#004000">content</font> <font color="#009900">[</font> <font color="#000088">$name</font> <font color="#009900">]</font> <font color="#339933">=</font> <font color="#000088">$data</font> <font color="#339933">;</font> &lt;br/&gt; <font color="#009900">}</font> &lt;br/&gt; <font color="#009900">}</font> &lt;br/&gt; &lt;br/&gt; <font color="#000000">public</font> <font color="#000000">function</font> getData <font color="#009900">(</font> <font color="#009900">)</font> &lt;br/&gt; <font color="#009900">{</font> &lt;br/&gt; <font color="#b1b100">return</font> <font color="#990000">array</font> <font color="#009900">(</font> &lt;br/&gt; <font color="#0000ff">'error'</font> <font color="#339933">=&gt;</font> <font color="#000088">$this</font> <font color="#339933">-&gt;</font> <font color="#004000">error</font> <font color="#339933">,</font> &lt;br/&gt; <font color="#0000ff">'response'</font> <font color="#339933">=&gt;</font> <font color="#000088">$this</font> <font color="#339933">-&gt;</font> <font color="#004000">content</font> <font color="#339933">,</font> &lt;br/&gt; <font color="#009900">)</font> <font color="#339933">;</font> &lt;br/&gt; <font color="#009900">}</font> &lt;br/&gt; <font color="#009900">}</font> &lt;br/&gt; &lt;br/&gt; <font color="#000000">class</font> ErrorResponse <font color="#000000">extends</font> Response&lt;br/&gt; <font color="#009900">{</font> &lt;br/&gt; <font color="#000000">public</font> <font color="#000000">function</font> __construct <font color="#009900">(</font> <font color="#990000">array</font> <font color="#000088">$content</font> <font color="#339933">=</font> <font color="#009900">null</font> <font color="#009900">)</font> &lt;br/&gt; <font color="#009900">{</font> &lt;br/&gt;        parent <font color="#339933">::</font> __construct <font color="#009900">(</font> <font color="#000088">$content</font> <font color="#009900">)</font> <font color="#339933">;</font> &lt;br/&gt; <font color="#000088">$this</font> <font color="#339933">-&gt;</font> <font color="#004000">error</font> <font color="#339933">=</font> <font color="#cc66cc">1</font> <font color="#339933">;</font> &lt;br/&gt; <font color="#009900">}</font> &lt;br/&gt; <font color="#009900">}</font> &lt;br/&gt; &lt;br/&gt; <font color="#000000">class</font> SuccessResponse <font color="#000000">extends</font> Response&lt;br/&gt; <font color="#009900">{</font> &lt;br/&gt; <font color="#000000">public</font> <font color="#000000">function</font> __construct <font color="#009900">(</font> <font color="#990000">array</font> <font color="#000088">$content</font> <font color="#339933">=</font> <font color="#009900">null</font> <font color="#009900">)</font> &lt;br/&gt; <font color="#009900">{</font> &lt;br/&gt;        parent <font color="#339933">::</font> __construct <font color="#009900">(</font> <font color="#000088">$content</font> <font color="#009900">)</font> <font color="#339933">;</font> &lt;br/&gt; <font color="#000088">$this</font> <font color="#339933">-&gt;</font> <font color="#004000">error</font> <font color="#339933">=</font> <font color="#cc66cc">0</font> <font color="#339933">;</font> &lt;br/&gt; <font color="#009900">}</font> &lt;br/&gt; <font color="#009900">}</font></code> <blockquote> <code>&lt;?php <font color="#000000">&lt;?php</font> &lt;br/&gt;abstract <font color="#000000">class</font> Response&lt;br/&gt; <font color="#009900">{</font> &lt;br/&gt;    protected <font color="#000088">$error</font> <font color="#339933">;</font> &lt;br/&gt;    protected <font color="#000088">$content</font> <font color="#339933">=</font> <font color="#990000">array</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> &lt;br/&gt; &lt;br/&gt; <font color="#000000">public</font> <font color="#000000">function</font> __construct <font color="#009900">(</font> <font color="#990000">array</font> <font color="#000088">$content</font> <font color="#339933">=</font> <font color="#009900">null</font> <font color="#009900">)</font> &lt;br/&gt; <font color="#009900">{</font> &lt;br/&gt; <font color="#b1b100">if</font> <font color="#009900">(</font> <font color="#990000">isset</font> <font color="#009900">(</font> <font color="#000088">$content</font> <font color="#009900">)</font> <font color="#009900">)</font> <font color="#009900">{</font> &lt;br/&gt; <font color="#000088">$this</font> <font color="#339933">-&gt;</font> <font color="#004000">content</font> <font color="#339933">=</font> <font color="#000088">$content</font> <font color="#339933">;</font> &lt;br/&gt; <font color="#009900">}</font> &lt;br/&gt; <font color="#009900">}</font> &lt;br/&gt; &lt;br/&gt; <font color="#000000">public</font> <font color="#000000">function</font> addContent <font color="#009900">(</font> <font color="#000088">$content</font> <font color="#009900">)</font> &lt;br/&gt; <font color="#009900">{</font> &lt;br/&gt; <font color="#b1b100">if</font> <font color="#009900">(</font> <font color="#339933">!</font> <font color="#990000">is_array</font> <font color="#009900">(</font> <font color="#000088">$content</font> <font color="#009900">)</font> <font color="#009900">)</font> <font color="#009900">{</font> &lt;br/&gt; <font color="#b1b100">return</font> <font color="#009900">false</font> <font color="#339933">;</font> &lt;br/&gt; <font color="#009900">}</font> &lt;br/&gt; <font color="#b1b100">foreach</font> <font color="#009900">(</font> <font color="#000088">$content</font> <font color="#b1b100">as</font> <font color="#000088">$name</font> <font color="#339933">=&gt;</font> <font color="#000088">$data</font> <font color="#009900">)</font> <font color="#009900">{</font> &lt;br/&gt; <font color="#000088">$this</font> <font color="#339933">-&gt;</font> <font color="#004000">content</font> <font color="#009900">[</font> <font color="#000088">$name</font> <font color="#009900">]</font> <font color="#339933">=</font> <font color="#000088">$data</font> <font color="#339933">;</font> &lt;br/&gt; <font color="#009900">}</font> &lt;br/&gt; <font color="#009900">}</font> &lt;br/&gt; &lt;br/&gt; <font color="#000000">public</font> <font color="#000000">function</font> getData <font color="#009900">(</font> <font color="#009900">)</font> &lt;br/&gt; <font color="#009900">{</font> &lt;br/&gt; <font color="#b1b100">return</font> <font color="#990000">array</font> <font color="#009900">(</font> &lt;br/&gt; <font color="#0000ff">'error'</font> <font color="#339933">=&gt;</font> <font color="#000088">$this</font> <font color="#339933">-&gt;</font> <font color="#004000">error</font> <font color="#339933">,</font> &lt;br/&gt; <font color="#0000ff">'response'</font> <font color="#339933">=&gt;</font> <font color="#000088">$this</font> <font color="#339933">-&gt;</font> <font color="#004000">content</font> <font color="#339933">,</font> &lt;br/&gt; <font color="#009900">)</font> <font color="#339933">;</font> &lt;br/&gt; <font color="#009900">}</font> &lt;br/&gt; <font color="#009900">}</font> &lt;br/&gt; &lt;br/&gt; <font color="#000000">class</font> ErrorResponse <font color="#000000">extends</font> Response&lt;br/&gt; <font color="#009900">{</font> &lt;br/&gt; <font color="#000000">public</font> <font color="#000000">function</font> __construct <font color="#009900">(</font> <font color="#990000">array</font> <font color="#000088">$content</font> <font color="#339933">=</font> <font color="#009900">null</font> <font color="#009900">)</font> &lt;br/&gt; <font color="#009900">{</font> &lt;br/&gt;        parent <font color="#339933">::</font> __construct <font color="#009900">(</font> <font color="#000088">$content</font> <font color="#009900">)</font> <font color="#339933">;</font> &lt;br/&gt; <font color="#000088">$this</font> <font color="#339933">-&gt;</font> <font color="#004000">error</font> <font color="#339933">=</font> <font color="#cc66cc">1</font> <font color="#339933">;</font> &lt;br/&gt; <font color="#009900">}</font> &lt;br/&gt; <font color="#009900">}</font> &lt;br/&gt; &lt;br/&gt; <font color="#000000">class</font> SuccessResponse <font color="#000000">extends</font> Response&lt;br/&gt; <font color="#009900">{</font> &lt;br/&gt; <font color="#000000">public</font> <font color="#000000">function</font> __construct <font color="#009900">(</font> <font color="#990000">array</font> <font color="#000088">$content</font> <font color="#339933">=</font> <font color="#009900">null</font> <font color="#009900">)</font> &lt;br/&gt; <font color="#009900">{</font> &lt;br/&gt;        parent <font color="#339933">::</font> __construct <font color="#009900">(</font> <font color="#000088">$content</font> <font color="#009900">)</font> <font color="#339933">;</font> &lt;br/&gt; <font color="#000088">$this</font> <font color="#339933">-&gt;</font> <font color="#004000">error</font> <font color="#339933">=</font> <font color="#cc66cc">0</font> <font color="#339933">;</font> &lt;br/&gt; <font color="#009900">}</font> &lt;br/&gt; <font color="#009900">}</font></code> </blockquote> <br>  This file describes two different response options: an answer with an error (ErrorResponse) and a ‚Äúsuccessful‚Äù answer (SuccessResponse) <br><br>  5. Create a shell for the controller (file app / model / abstract / AbstractAMFController.php) <code>&lt;?php <font color="#000000">&lt;?php</font> &lt;br/&gt; <font color="#b1b100">require_once</font> <font color="#0000ff">'model/Response.php'</font> <font color="#339933">;</font> &lt;br/&gt; &lt;br/&gt; <font color="#000000">class</font> AbstractAMFController <font color="#009900">{</font> &lt;br/&gt; &lt;br/&gt;    protected <font color="#000088">$controller</font> <font color="#339933">;</font> &lt;br/&gt; &lt;br/&gt; <font color="#000000">public</font> <font color="#000000">function</font> __construct <font color="#009900">(</font> <font color="#000088">$controllerName</font> <font color="#009900">)</font> &lt;br/&gt; <font color="#009900">{</font> &lt;br/&gt; <font color="#000088">$this</font> <font color="#339933">-&gt;</font> <font color="#004000">controller</font> <font color="#339933">=</font> <font color="#000000">new</font> <font color="#000088">$controllerName</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> &lt;br/&gt; <font color="#009900">}</font> &lt;br/&gt; &lt;br/&gt;    protected <font color="#000000">function</font> methodWrapper <font color="#009900">(</font> <font color="#000088">$method</font> <font color="#339933">,</font> <font color="#000088">$data</font> <font color="#009900">)</font> <font color="#009900">{</font> &lt;br/&gt;        try <font color="#009900">{</font> &lt;br/&gt; <font color="#000088">$result</font> <font color="#339933">=</font> <font color="#000088">$this</font> <font color="#339933">-&gt;</font> <font color="#004000">controller</font> <font color="#339933">-&gt;</font> <font color="#000088">$method</font> <font color="#009900">(</font> <font color="#000088">$data</font> <font color="#009900">)</font> <font color="#339933">;</font> &lt;br/&gt; <font color="#000088">$response</font> <font color="#339933">=</font> <font color="#000000">new</font> SuccessResponse <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> &lt;br/&gt; <font color="#000088">$response</font> <font color="#339933">-&gt;</font> <font color="#004000">addContent</font> <font color="#009900">(</font> <font color="#000088">$result</font> <font color="#009900">)</font> <font color="#339933">;</font> &lt;br/&gt; <font color="#009900">}</font> catch <font color="#009900">(</font> Exception <font color="#000088">$e</font> <font color="#009900">)</font> <font color="#009900">{</font> &lt;br/&gt; <font color="#000088">$response</font> <font color="#339933">=</font> <font color="#000000">new</font> ErrorResponse <font color="#009900">(</font> <font color="#000088">$e</font> <font color="#339933">-&gt;</font> <font color="#004000">getMessage</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">.</font> <font color="#0000ff">'\n'</font> <font color="#339933">.</font> <font color="#000088">$e</font> <font color="#339933">-&gt;</font> <font color="#004000">getTraceAsString</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">)</font> <font color="#339933">;</font> &lt;br/&gt; <font color="#009900">}</font> &lt;br/&gt; <font color="#009900">}</font> &lt;br/&gt; <font color="#b1b100">return</font> <font color="#000088">$response</font> <font color="#339933">-&gt;</font> <font color="#004000">getData</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> &lt;br/&gt; <font color="#009900">}</font> &lt;br/&gt; <font color="#009900">}</font></code> <blockquote> <code>&lt;?php <font color="#000000">&lt;?php</font> &lt;br/&gt; <font color="#b1b100">require_once</font> <font color="#0000ff">'model/Response.php'</font> <font color="#339933">;</font> &lt;br/&gt; &lt;br/&gt; <font color="#000000">class</font> AbstractAMFController <font color="#009900">{</font> &lt;br/&gt; &lt;br/&gt;    protected <font color="#000088">$controller</font> <font color="#339933">;</font> &lt;br/&gt; &lt;br/&gt; <font color="#000000">public</font> <font color="#000000">function</font> __construct <font color="#009900">(</font> <font color="#000088">$controllerName</font> <font color="#009900">)</font> &lt;br/&gt; <font color="#009900">{</font> &lt;br/&gt; <font color="#000088">$this</font> <font color="#339933">-&gt;</font> <font color="#004000">controller</font> <font color="#339933">=</font> <font color="#000000">new</font> <font color="#000088">$controllerName</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> &lt;br/&gt; <font color="#009900">}</font> &lt;br/&gt; &lt;br/&gt;    protected <font color="#000000">function</font> methodWrapper <font color="#009900">(</font> <font color="#000088">$method</font> <font color="#339933">,</font> <font color="#000088">$data</font> <font color="#009900">)</font> <font color="#009900">{</font> &lt;br/&gt;        try <font color="#009900">{</font> &lt;br/&gt; <font color="#000088">$result</font> <font color="#339933">=</font> <font color="#000088">$this</font> <font color="#339933">-&gt;</font> <font color="#004000">controller</font> <font color="#339933">-&gt;</font> <font color="#000088">$method</font> <font color="#009900">(</font> <font color="#000088">$data</font> <font color="#009900">)</font> <font color="#339933">;</font> &lt;br/&gt; <font color="#000088">$response</font> <font color="#339933">=</font> <font color="#000000">new</font> SuccessResponse <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> &lt;br/&gt; <font color="#000088">$response</font> <font color="#339933">-&gt;</font> <font color="#004000">addContent</font> <font color="#009900">(</font> <font color="#000088">$result</font> <font color="#009900">)</font> <font color="#339933">;</font> &lt;br/&gt; <font color="#009900">}</font> catch <font color="#009900">(</font> Exception <font color="#000088">$e</font> <font color="#009900">)</font> <font color="#009900">{</font> &lt;br/&gt; <font color="#000088">$response</font> <font color="#339933">=</font> <font color="#000000">new</font> ErrorResponse <font color="#009900">(</font> <font color="#000088">$e</font> <font color="#339933">-&gt;</font> <font color="#004000">getMessage</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">.</font> <font color="#0000ff">'\n'</font> <font color="#339933">.</font> <font color="#000088">$e</font> <font color="#339933">-&gt;</font> <font color="#004000">getTraceAsString</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">)</font> <font color="#339933">;</font> &lt;br/&gt; <font color="#009900">}</font> &lt;br/&gt; <font color="#009900">}</font> &lt;br/&gt; <font color="#b1b100">return</font> <font color="#000088">$response</font> <font color="#339933">-&gt;</font> <font color="#004000">getData</font> <font color="#009900">(</font> <font color="#009900">)</font> <font color="#339933">;</font> &lt;br/&gt; <font color="#009900">}</font> &lt;br/&gt; <font color="#009900">}</font></code> </blockquote> <br>  This shell calls the controller's method specified in the constructor, and if suddenly there is an action inside the method, it generates a request with an error and returns it.  This shell is convenient because in the future it will be able to store a lot of code inside it (for example, logging, automatic creation of a player's class, traces, and much more, it makes no sense to list now) <br><br>  6. Create app / controller / wrappers.php <blockquote> <code><font color="#000000">class</font> Game <font color="#000000">extends</font> AbstractAMFController <font color="#009900">{</font> &lt;br/&gt; <font color="#000000">public</font> <font color="#000000">function</font> __construct <font color="#009900">(</font> <font color="#009900">)</font> <font color="#009900">{</font> &lt;br/&gt;        parent <font color="#339933">::</font> __construct <font color="#009900">(</font> <font color="#0000ff">'GameController'</font> <font color="#009900">)</font> <font color="#339933">;</font> &lt;br/&gt; <font color="#009900">}</font> &lt;br/&gt; &lt;br/&gt; <font color="#000000">public</font> <font color="#000000">function</font> hello <font color="#009900">(</font> <font color="#000088">$data</font> <font color="#009900">)</font> <font color="#009900">{</font> &lt;br/&gt; <font color="#b1b100">return</font> <font color="#000088">$this</font> <font color="#339933">-&gt;</font> <font color="#004000">methodWrapper</font> <font color="#009900">(</font> <font color="#0000ff">'hello'</font> <font color="#339933">,</font> <font color="#000088">$data</font> <font color="#009900">)</font> <font color="#339933">;</font> &lt;br/&gt; <font color="#009900">}</font> &lt;br/&gt; <font color="#009900">}</font></code> </blockquote> <br>  Here will be stored wrappers methods.  The fact is that AMFPHP does not want to work with the magic function __call, so you have to write a little more code than you would like <br><br>  7. Well, the final chord.  Create app / controller / Game.php <blockquote> <code><font color="#000000">class</font> GameController <font color="#009900">{</font> &lt;br/&gt; &lt;br/&gt; <font color="#000000">public</font> <font color="#000000">function</font> hello <font color="#009900">(</font> <font color="#000088">$data</font> <font color="#009900">)</font> <font color="#009900">{</font> &lt;br/&gt; <font color="#b1b100">return</font> <font color="#0000ff">'hello'</font> <font color="#339933">;</font> &lt;br/&gt; <font color="#009900">}</font> &lt;br/&gt; <font color="#009900">}</font> &lt;br/&gt; <font color="#b1b100">include</font> <font color="#0000ff">'wrappers.php'</font> <font color="#339933">;</font></code> </blockquote> <br>  Now you can open the browser (it lies in the archive with AMFPHP in the browser folder, the address is http: //game/gateway.php, the method is hello. Voila, you should get something like {"error": 0, "response" : "Hello"} <br>  That's it, now the server is ready, and you can start implementing the first calls.  But this is all later, and now drink up the tea and go home, almost 9, and I'm still at work :). </div><p>Source: <a href="https://habr.com/ru/post/113503/">https://habr.com/ru/post/113503/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../113495/index.html">2gis for Android</a></li>
<li><a href="../113497/index.html">Accelerometers of smartphones will help to find holes on the roads</a></li>
<li><a href="../113498/index.html">IDN domains in Russian - now in .ORG</a></li>
<li><a href="../113499/index.html">About freelancer Ivan and how he did not get up from the couch</a></li>
<li><a href="../113500/index.html">ILSpy - open source alternative to .NET Reflector</a></li>
<li><a href="../113504/index.html">Google, Facebook and other large companies want to buy Twitter</a></li>
<li><a href="../113507/index.html">Scientists plan to create Wikipedia for robots</a></li>
<li><a href="../113508/index.html">Uploading files with the html5 File API, with preference and dancers</a></li>
<li><a href="../113510/index.html">First look at the HP TouchPad</a></li>
<li><a href="../113512/index.html">Announcement of node 0.4 - second stable branch</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>