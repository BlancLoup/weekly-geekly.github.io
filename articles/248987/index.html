<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>CTB-Locker - a new modification of the FileCoder cryptographer</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We have already written several times about various families of encryption Trojans. We are talking about modifications of the FileCoder malware family...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>CTB-Locker - a new modification of the FileCoder cryptographer</h1><div class="post__text post__text-html js-mediator-article">  We have already written several times about various families of encryption Trojans.  We are talking about <a href="http://habrahabr.ru/company/eset/blog/247031/">modifications</a> of the FileCoder malware family, as well as the <a href="http://habrahabr.ru/company/eset/blog/247267/">Win32 / Virlock extortionist</a> .  A few days ago, our anti-virus laboratory began receiving messages about a malicious campaign targeting users in Latin America and Eastern Europe.  Phishing e-mails contained information about the ‚Äúarrived fax‚Äù.  Attachments of such messages contained malware that specializes in encrypting user files and requesting a ransom for decryption in Bitcoins. <br><br><img src="https://habrastorage.org/files/a07/ed7/759/a07ed7759e164687841691fc1afc269d.jpeg"><br><a name="habracut"></a><br>  An example of such a malicious message is shown below in the screenshot. <br><br><img src="https://habrastorage.org/files/979/b42/14c/979b4214cf394d9098588d382f1edeaf.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In this post, we will look at a malicious campaign to distribute this malicious program, which has been distributed in Poland, the Czech Republic, Mexico and many other countries. <br><br><img src="https://habrastorage.org/files/469/bed/ed6/469beded6b0e445382f5b27c35755087.png"><br><br>  As we mentioned above, the main CTB-Locker distribution vector is a phishing email message.  A malicious executable file that is attached to an email is detected by ESET AV products as <b>Win32 / TrojanDownloader.Elenoocka.A</b> .  This bootloader (or downloader) downloads the FileCoder modification (CTB-Locker) mentioned above to the user's computer.  This modification is detected as <b>Win32 / FileCoder.DA</b> .  After running this malware file on disk are encrypted. <br><br><img src="https://habrastorage.org/files/49d/796/e7d/49d796e7db684488848e23f2fad39e07.png"><br><br>  The CTB ‚Äë locker itself is similar to another well-known cryptographer called <a href="http://habrahabr.ru/company/eset/blog/207532/">CryptoLocker</a> .  The difference between them is the use of different file encryption algorithms.  The result of the CTB ‚Äë locker activity is similar to CryptoLocker or <a href="http://habrahabr.ru/company/eset/blog/247031/">TorrentLocker</a> , that is, it leads to encryption of files with the extensions mp4, .pem, .jpg, .doc, .cer, .db.  After the file encryption operation is completed, the malware displays a warning message to the user.  For this purpose, CTB ‚Äë locker can personalize the user's desktop, i.e., change the wallpaper there for the following. <br><br><img src="https://habrastorage.org/files/215/804/92a/21580492a2d64a1399539c8e733997d7.png"><br><br>  Extortionist supports text display in various languages, including, German, Dutch, Italian, English.  There is no Spanish in the list of supported languages, although we have seen infections by this malicious program in those countries for which this language is the main one. <br><br>  CTB-Locker is distinguished by the fact that attackers use a special method to convince the user to pay the ransom.  They show him what will happen after his payment, that is, they convince the user that they will not deceive him and decrypt the files. <br><br><img src="https://habrastorage.org/files/e23/ab5/e55/e23ab5e5553a4135b5f47909c5b3f930.png"><br><br><img src="https://habrastorage.org/files/765/e86/7fa/765e867fadd24a57a2f2bf5cc8f8f1da.png"><br><br>  After that, the user will be shown how he can decrypt files and to what account he will need to transfer Bitcoins for this. <br><br><img src="https://habrastorage.org/files/5f1/352/71c/5f135271c36d48578aa1e16999b8f8cf.png"><br><br>  As can be seen above in the screenshot, CTB-Locker can demonstrate the exchange rate of bitcoins based on the currency that corresponds to the location of the locked computer.  At the time of taking the screenshot, eight bitcoins were $ 1680. <br><br>  From a technical point of view, the ransomware downloader himself, who shows up as <b>Win32 / TrojanDownloader.Elenoocka.A</b> , is a rather small in terms of size and simple from a technical point of view malware.  We have observed the use of this downloader by attackers in other malicious campaigns.  In one of these campaigns, phishing emails were used, which included malicious files with the names invoice_% YEAR_% MONTH_% DAY-1% HOUR_% MIN.scr (eg invoice_2015_01_20-15_33 .scr).  To disguise its launch on the system, the executable file contains a fake Word document in its resources, which will be shown to the user in the background of the malicious file. <br><br>  CTB-Locker malware is a type of extortionist, after whose activity it is impossible to decrypt files without a key received from intruders.  As we have repeatedly stressed, the use of backup is the main method that can be used to restore data after the activities of such malware, in addition to the timely update of the anti-virus database is also a necessary measure to prevent infection. </div><p>Source: <a href="https://habr.com/ru/post/248987/">https://habr.com/ru/post/248987/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../248977/index.html">Results of 2014: Windows threats and exploitation</a></li>
<li><a href="../248979/index.html">OpenMP Regions Analysis with Intel¬Æ VTune ‚Ñ¢ Amplifier XE</a></li>
<li><a href="../248981/index.html">Dynamic do-it-yourself java code compilation</a></li>
<li><a href="../248983/index.html">How-to: Automate accounting tasks hosting provider</a></li>
<li><a href="../248985/index.html">CSS Auditing: Style Sheets Shouldn't Be Horrible</a></li>
<li><a href="../248991/index.html">Automatic Age Assessment System for Face Images</a></li>
<li><a href="../248993/index.html">Map of the latest photos of all people from these cities VK using VKScript</a></li>
<li><a href="../248995/index.html">Guide to the Car Tutorial (Unity3d) part 3 of 3</a></li>
<li><a href="../248997/index.html">Details about the new Microsoft rendering engine for Project Spartan</a></li>
<li><a href="../248999/index.html">Generating fake data for your javascript application using faker</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>