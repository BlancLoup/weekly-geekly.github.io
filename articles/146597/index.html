<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Sypex Geo - quick city identification by IP</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="At the beginning of the year I published the article Country Definition by IP: we test the speed of the algorithms , in which my ‚Äúbicycle‚Äù was mention...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Sypex Geo - quick city identification by IP</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/022/723/03b/02272303b7d5de94be5351752ba9c309.png" align="left">  At the beginning of the year I published the article <a href="http://habrahabr.ru/post/138067/">Country Definition by IP: we test the speed of the algorithms</a> , in which my ‚Äúbicycle‚Äù was mentioned, which is distinguished by high speed.  One of the popular questions was the possibility of determining the city by IP. <br><br>  And a few months later, the project started as a ‚Äúfor fun‚Äù developed into an independent project. <br>  A separate site dedicated to the <a href="http://sypexgeo.net/">Sypex Geo</a> project has been opened, where you can download the latest versions of the API and databases, as well as get acquainted with the documentation. <br><br>  For those who want to test the correctness of determining the city by IP, this is a <a href="http://sypexgeo.net/ru/demo/">link to a demo page</a> .  And under Habrakat, I will describe some technical details and give the results of a little testing. <br><a name="habracut"></a><br><h4>  Sypex Geo 2.1 format </h4><br>  Since the publication of the last article, the format of Sypex Geo (abbreviated SxGeo) has been optimized, and the possibility of including two directories in the database - cities and regions - has been added. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      When creating a new format, the following priorities were set: <br><ul><li>  high speed </li><li>  low resource consumption </li><li>  openness (specifications of the format of the binary database file and API are open) </li><li>  universality (the ability to create databases with any data sets) </li></ul><br>  The format allows you to store data in different encoding.  After exiting the beta, scripts for converting a database from MySQL to a binary database file will be published. <br><br>  The following information is stored in the database: <br><ul><li>  Country ID </li><li>  ISO 3166-1 country code (two character) </li><li>  Region code FIPS 10-4 (two-character) </li><li>  Region name (optional) </li><li>  City </li><li>  Latitude </li><li>  Longitude </li><li>  Timezone (optional) </li></ul><br>  This list can be modified and / or expanded if necessary.  More information <a href="http://sypexgeo.net/ru/format/">about the SxGeo 2.1 format</a> can be found on the website. <br><br><h4>  Own database </h4><br>  After a very close acquaintance with the popular geolocation system GeoLite City from MaxMind, it was decided to create its own database.  The problem is that in GeoLite City there are a lot of inaccuracies, rubbish, duplicate cities, excessive splitting of the ranges, as well as problems with the cities of the former USSR (for example, the names of companies or responsible names from Whois are taken instead of cities). <br><br>  At the moment, the base is based on GeoLite City, but already contains a completely revised coverage of Russia, Ukraine and Belarus.  Gradually, other countries will be refined, primarily the CIS and Europe.  The Sypex Geo City database contains the names of cities and regions in Russian in UTF-8 (there are not yet translated names), as well as the timezone. <br><br>  In addition, other databases available on the site are converted to the SxGeo 2.1 format. <br><br><h4>  Using </h4><br>  Using Sypex Geo API is extremely simplified. <br><pre><code class="php hljs"><span class="hljs-number"><span class="hljs-number">1.</span></span>  SxGeo.php  SxGeoCity.dat (  )   <span class="hljs-number"><span class="hljs-number">2.</span></span>   SxGeo.php   ,   <span class="hljs-keyword"><span class="hljs-keyword">include</span></span>(<span class="hljs-string"><span class="hljs-string">"SxGeo.php"</span></span>); <span class="hljs-number"><span class="hljs-number">3.</span></span>   SxGeo <span class="hljs-comment"><span class="hljs-comment">//$SxGeo = new SxGeo(); //   ,   SxGeo.dat $SxGeo = new SxGeo('SxGeoCity.dat', SXGEO_BATCH | SXGEO_MEMORY); //    4.   (SxGeo City, GeoLite City, IpGeoBase) $SxGeo-&gt;get($ip); (   ,      ) // $SxGeo-&gt;getCityFull($ip); (      )</span></span></code> </pre> <br><h4>  Performance testing </h4><br>  And for dessert, a little comparative performance testing.  The opponents are GeoLite API and Geobaza API.  All test participants use a binary database of their own format, and use the PHP API.  Testing takes place under Win 7 (proportions are preserved on Linux), PHP 5.2.17. <br><br>  Results after 10 runs for each API in two modes (normal and with caching in memory) averaging and rounding to dozens.  For each run, an array of 50,000 random IP addresses is created, and a loop is searched by each algorithm. <br><img src="https://habrastorage.org/storage2/524/1bb/656/5241bb656f295cc83bd8a196f8057b54.png"><br><br>  Suggestion and wish are welcome.  Also looking for help with porting API to other languages, and the creation of modules for Apache and nginx. </div><p>Source: <a href="https://habr.com/ru/post/146597/">https://habr.com/ru/post/146597/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../146592/index.html">MySQL is a million times faster than MemSQL</a></li>
<li><a href="../146593/index.html">Atlassian Office in San Francisco</a></li>
<li><a href="../146594/index.html">Indicators of key information on sites for Firefox in a hurry</a></li>
<li><a href="../146595/index.html">Split testing: how it works for us</a></li>
<li><a href="../146596/index.html">C11 corrects errors C99</a></li>
<li><a href="../146598/index.html">VK :: App - a module for creating client applications in vk.com</a></li>
<li><a href="../146601/index.html">How we develop programs for Android in Parcsis</a></li>
<li><a href="../146603/index.html">Multimedia center at Arduino UNO</a></li>
<li><a href="../146604/index.html">Swarp SDK or how to quickly create an AR-application. Part 2</a></li>
<li><a href="../146605/index.html">OPEN DAYS INGRIA: ‚ÄúThe secrets of successful entrepreneurship‚Äù</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>