<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Drop Stack Overflow: What Happened</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="On the night from Thursday to Friday, the Stack Overflow resource was unavailable . After some time, the work was restored, however, on Friday morning...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Drop Stack Overflow: What Happened</h1><div class="post__text post__text-html js-mediator-article">  On the night from Thursday to Friday, the Stack Overflow resource <a href="https://www.theregister.co.uk/2018/02/23/stackoverflow_wobbly/">was unavailable</a> .  After some time, the work was restored, however, on Friday morning the site again " <a href="https://twitter.com/arasuvel001/status/966950632400871424">fell</a> ." <br><br>  The SO <a href="https://www.theregister.co.uk/2018/02/23/stackoverflow_wobbly/">notes</a> that the failure caused a series of problems that appeared simultaneously.  The system has failed to cope with a growing number of connections.  Now the site is working normally. <br><br>  Under the cut we will tell about the reasons that caused the failure. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     <a href="https://habrahabr.ru/company/it-grad/blog/349824/"><img src="https://habrastorage.org/webt/os/ch/2_/osch2_y-tm7xlwzgdniem69dojo.jpeg"></a> <a name="habracut"></a><br>  <font color="#A9A9A9"><i>/ photo by <a href="https://www.flickr.com/photos/149902454%40N08/34970439105/">Hamza Butt</a> <a href="https://creativecommons.org/licenses/by/2.0/">CC</a></i></font> <br><br>  Stack Overflow runs on 9 web servers, each of which processes from 200 to 500 requests per second.  As Architecture Lead of the Stack Overflow platform <a href="https://meta.stackoverflow.com/questions/363730/systematic-this-is-our-fault-on-some-links/363765">notes</a> Nick Craver, on Friday the problem affected two servers: ny-web01 and ny-web04, which began to ‚Äúbombard‚Äù the Stack Overflow database with a huge number of requests.  This led to a depletion of the <a href="https://ru.wikipedia.org/wiki/Internet_Information_Services">IIS</a> thread pool and an increase in the waiting time for processing requests from the database. <br><br>  It turned out that the new requests were waiting for a response from the thread pool, while not allowing the old one to finish.  There was a deadlock.  According to Nick, restricting traffic in theory would solve the problem, but this did not happen due to an error in the work of the load balancer. <br><br><h2>  Problem with load balancer </h2><br>  Ideally, HAProxy should have turned off the two ‚Äúproblem‚Äù servers automatically and before administrator intervention was required.  But ASP.NET in Stack Overflow redirected from the home page to / error, and HAProxy received back the response code 302, which was interpreted as ‚Äúsuccess‚Äù.  Therefore, no attempt to turn off the servers was made. <br><br>  Nick Craver notes that they already have a solution for this problem.  The team will make HAProxy expect only certain status codes and stop redirecting users from the home page.  Nick implemented this feature for quite some time, but it was not added to production.  Now its introduction is scheduled for next week. <br><br>  Nick notes that the team has so far <a href="https://twitter.com/Nick_Craver/status/967093200262434816">not been able</a> to establish the exact cause that led to an increase in the number of SQL queries (in the thread on the SO he published a graph - it <a href="https://meta.stackoverflow.com/questions/363730/systematic-this-is-our-fault-on-some-links/363765">shows</a> large bursts of activity).  SO are working on this and plan to keep the resident platform informed. <br><br><h2>  Past outages </h2><br>  Note that the "fall" Stack Overflow happened in the past - there was a <a href="https://techcrunch.com/2014/02/16/stackoverflow-goes-down-programmers-around-the-world-panic-its-back-up-now/">shutdown</a> in 2014.  However, then the problem was <a href="https://mobile.twitter.com/StackStatus/status/435130357546254336">caused by a</a> massive DDoS attack on the network service provider with which the platform cooperates.  At that time, the problem was solved in an hour. <br><br>  <b>Disclaimer:</b> as new information becomes available regarding the ‚Äúfall‚Äù of SO-analytics, IT infrastructure or information security solutions, we will supplement this material. <br><br><hr><br>  PS What we write about in the First blog about corporate IaaS: <br><br><ul><li>  <a href="http://iaas-blog.it-grad.ru/funkcionalnost/organizaciya-blokchejn-na-vmware-vsphere-ot-teorii-k-praktike/">Organizing the blockchain on VMware vSphere: from theory to practice</a> </li><li>  <a href="http://iaas-blog.it-grad.ru/kejsy/kak-iaas-pomogaet-servisam-dostavki-opyt-rossijskix-i-zarubezhnyx-kompanij/">How IaaS helps delivery services: the experience of Russian and foreign companies</a> </li><li>  <a href="http://iaas-blog.it-grad.ru/kejsy/kak-oblachnye-texnologii-svyazany-s-vashem-avtomobilem/">IaaS in the automotive industry: use cases</a> </li><li>  <a href="http://iaas-blog.it-grad.ru/funkcionalnost/iaas-pervye-shagi-posle-arendy-oblachnoj-infrastruktury/">First steps after renting cloud infrastructure</a> </li><li>  <a href="http://iaas-blog.it-grad.ru/bezopasnost/postroenie-attestuemyx-i-zashhishhennyx-infrastruktur-na-baze-reshenij-vmware/">Building Qualified and Secured Infrastructures Based on VMware Solutions</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/349824/">https://habr.com/ru/post/349824/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../349812/index.html">Segregated Witness for Dummies</a></li>
<li><a href="../349816/index.html">Open webinar "Features of JavaScript"</a></li>
<li><a href="../349818/index.html">Asynchronous HTTP requests in C ++: incoming through RESTinio, outgoing through libcurl. Part 2</a></li>
<li><a href="../349820/index.html">–ï–ì–ê–ò–° 3.0 - 100% readiness! Alcohol accounting markup</a></li>
<li><a href="../349822/index.html">Qt: Writing a generic model for QML ListView</a></li>
<li><a href="../349826/index.html">Sleight of hand and no fraud: practical tips on accelerated design training for developers</a></li>
<li><a href="../349830/index.html">Personal experience: a selection of materials about the virtual infrastructure, information security and trends in the IaaS market</a></li>
<li><a href="../349832/index.html">Alternative to paid off ads in the free Android application</a></li>
<li><a href="../349836/index.html">Understanding Dependencies</a></li>
<li><a href="../349838/index.html">The story of the internet in Germany and the undocumented features of Juniper SRX</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>