<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Php closures</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It's no secret that PHP 5.3 introduced a number of interesting innovations. Different degrees of utility and scandal. It is even possible that the rel...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Php closures</h1><div class="post__text post__text-html js-mediator-article">  It's no secret that <strong>PHP 5.3</strong> introduced a number of interesting innovations.  Different degrees of utility and scandal.  It is even possible that the release of PHP 5.3 is a well-planned PR move: the <em>largest list of changes</em> in the last five years, the <a title="PHP: goto - Manual" href="http://ru2.php.net/manual/en/control-structures.goto.php">goto</a> (sic!) Operator, <a title="PHP: Namespaces overview - Manual" href="http://ru2.php.net/manual/en/language.namespaces.rationale.php">namespaces</a> ( <em>namespaces</em> ) with the ‚Äúnot like everyone else‚Äù syntax, <a title="PHP: Late Static Bindings - Manual" href="http://ru2.php.net/manual/en/language.oop5.late-static-bindings.php">late static binding</a> ( <em>late static binding</em> ), more or less honest <a title="PHP: Anonymous functions - Manual" href="http://www.php.net/manual/en/functions.anonymous.php">anonymous (lambda) functions</a> ( <em>lambda functions</em> ), <strong>closures</strong> ( <em>closures</em> ). <a name="habracut"></a><br><br>  About the last I want to tell.  To be fair, I want to add that in PHP 5.3 a lot of other functionality was introduced that makes this release remarkable: modules <a title="PHP: intl - Manual" href="http://ru.php.net/manual/en/book.intl.php">Intl</a> (internationalization), <a title="PHP: Phar - Manual" href="http://ru.php.net/manual/en/book.phar.php">Phar</a> (PHP archives, like JAR for JAVA), <a title="PHP: Mysqlnd - Manual" href="http://ru.php.net/manual/en/book.mysqlnd.php">mysqlnd</a> (new driver for mysql), improvements in <a title="PHP: Standard PHP Library (SPL) - Manual" href="http://ru.php.net/manual/en/book.spl.php">SPL</a> , overall performance increase up to 10% and a lot more then. <br><br>  <strong>Closures</strong> and <em>lambda functions</em> - innovations in PHP 5.3, generally speaking, are not the advanced frontier of modern technology.  Surprisingly, both appeared in the functional programming language <strong>LISP</strong> in the late 50s, and were doped with a file to a state close to the modern in the 70s.  Thus, PHP has lagged behind with a competent implementation of 40 years. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <em>Closures</em> , according to <a title="Short circuit (programming)" href="http://ru.wikipedia.org/wiki/%25D0%2597%25D0%25B0%25D0%25BC%25D1%258B%25D0%25BA%25D0%25B0%25D0%25BD%25D0%25B8%25D0%25B5_(%25D0%25BF%25D1%2580%25D0%25BE%25D0%25B3%25D1%2580%25D0%25B0%25D0%25BC%25D0%25BC%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D0%25B5)">Wikipedia</a> , are procedures that refer to free variables in their lexical context.  Academically strictly, but if I did not know what it was about, I would never have understood from this definition. <br><br>  In many programming languages, a function whose definition is nested in another function, one way or another, can have access not only to its local variables, but also to variables of the parent function.  Sometimes some special syntax is used for this, sometimes it works without extra effort.  I will give an example of <strong>Javascript</strong> , because everything works there without some special syntax (the same examples, but in PHP will be later): <br><br><pre><code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//***  1j *** function outer(x) //   { var y=2; //    function inner(a) //   { var b=4; //    /*       *  ,      *    */ var res=x+y+a+b; alert(res); // 10   . } inner(3); //   } outer(1); //  ,    .</span></span></code> </pre> <br><br>  So, the <strong>inner</strong> function, without any special declaration, freely uses the variables of the outer outer function.  But this is not a <em>closure</em> . <br><br>  In many programming languages, a function (meaning not the result of executing a function, but the function itself as executable code, a pointer to a function) is a certain object of a special type.  Like any other object (string, number, array), a function can be assigned to a variable, passed to another function as a parameter, and returned as the result of the execution of another function.  Another important thing is related to this: <em>When defining a function, you can not assign a name, but assign this function to a variable and call it through this variable</em> .  The function itself does not have a name of its own, and therefore remains " <strong>anonymous</strong> ."  Such functions are also called <strong>lambda functions</strong> . <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">// ***  2j *** adder=function(a,b) //   ,     { return a+b; //  } subber=function(a,b) { return ab; } //  ,     /* *    -   adder  subber   *        , ,  , *   . ..   adder  subber   ,  , *    : x=adder(1,3);   x   . */ function performAction(action, a, b) //    performAction { var result=action(a,b); //   action -   return result; } function makeDivider() //    makeDivider { return function (a,b) //   { return a/b; } } r1=adder(1,2); //    . r1=1+2; r2=performAction(subber,6,4); //    . r2=6-4; r3=performAction(function(a,b) {return a*b;} ,5,6); //     . r3=5*6; divider=makeDivider(); // ,   ,   r4=divider(16,4); //     : r4=16/4; r5=makeDivider()(32,16);//  ,    : r5=32/16; alert([r1,r2,r3,r4,r5]); //3,2,30,4,2</span></span></code> </pre><br><br>  If the previous examples are more or less clear, then the <strong>closures</strong> will also be clear, because they are, in fact, a combination of the two principles described above: <br><ul><li>  An anonymous function defined within any other function has access to parent variables. </li><li>  If the parent function returns the child function as a result of its work, the variables of the parent function will remain available in the child, despite the fact that the parent has already completed and its local variables must be deleted. </li></ul><br>  Those.  <em>nested function as it closes the variables from the parent osprey, not allowing them to be destroyed</em> .  And here is a useful <strong>Javascript</strong> example: <br><br><pre> <code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/1999/xhtml"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">http-equiv</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Content-Type"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">content</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/html; charset=utf-8"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>Closure test<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"link1"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"link2"</span></span></span><span class="hljs-tag">&gt;</span></span>  <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hide1"</span></span></span><span class="hljs-tag">&gt;</span></span>  <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hide2"</span></span></span><span class="hljs-tag">&gt;</span></span>   <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="actionscript"><span class="actionscript"> </span><span class="hljs-comment"><span class="actionscript"><span class="hljs-comment">// ***  3j *** function getHider(id) // id     { return function() { document.getElementById(id).style.display='none'; return false; } /* *     ,   id  *            . *  getHider    *          , *       . */ } document.getElementById('link1').onclick=getHider('hide1'); document.getElementById('link2').onclick=getHider('hide2'); /* *      onclick    *    getHider,    ,   *  ,    id='hide1'    *  id='hide2'  .  ,   *    ,      */ </span></span></span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  <strong>Lambda functions</strong> (and closures, being them) as though postpone execution of some code for later term.  Therefore, they are often used in the development of user interfaces as event handlers, as was shown above. <br><br>  Let's go back to <strong>PHP</strong> .  Everything in it is not as beautiful as in Javascript.  First, in order for the function to use the variables of the parent function, it is necessary to explicitly indicate this in its definition (this follows from the ideology of the language), second, it only works with anonymous functions and it only works with <strong>PHP 5.3</strong> .  Example 1j performed by PHP will look something like this: <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">// ***  1p *** function outer($x) //   { $y=2; //    $inner=function ($a) use ($x, $y) //   { $b=4; //    /*       *  ,      *    */ $res=$x+$y+$a+$b; echo $res; // 10   . }; $inner(3); //   } outer(1);</span></span></code> </pre><br><br>  And our example 2j something like this: <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">// ***  2p *** $adder=function($a,$b) //   ,     { return $a+$b; //  }; $subber=function($a,$b) { return $a-$b; }; //  ,     function performAction($action, $a, $b) //    performAction { $result=$action($a,$b); //   action -   return $result; } function makeDivider() //    makeDivider { return function ($a,$b) //   { return $a/$b; }; } $r1=$adder(1,2); //    . r1=1+2; $r2=performAction($subber,6,4); //    . r2=6-4; $r3=performAction(function($a,$b) {return $a*$b;} ,5,6); //     . r3=5*6; $divider=makeDivider(); // ,   ,   $r4=$divider(16,4); //     : r4=16/4; //     r5  PHP   . //$r5=makeDivider()(32,16);//  ,    : r5=32/16; $r5='php fail'; echo "$r1,$r2,$r3,$r4,$r5"; //3,2,30,4,php fail</span></span></code> </pre><br><br>  Anonymous functions in <strong>PHP</strong> allow you to simplify and make clearer the use of various built-in functions using <strong>callback</strong> , for example: <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">// : function cmp($a, $b) { return($a &gt; $b); } //    uasort($array, 'cmp'); //     // : uasort($array, function($a, $b) { return($a &gt; $b);});</span></span></code> </pre><br><br>  In the old version, the code of the comparison function and the code where it is used may be placed quite far apart, moreover, this function is used only once, but it must be given a name and it may accidentally come into conflict with the name of another function.  In the new version, everything is much nicer, all the code is placed compactly and the namespace also does not clog up. <br><br>  It may seem that anonymous functions were already in previous versions of PHP.  Is <strong>create_function</strong> , is it not the same thing?  Yes and no.  create_function on every call creates a <em>new real named function in the global namespace</em> (sic!), but its name starts with \ 0 (zero byte) and therefore cannot conflict with normal functions.  But is it really possible to call such a function anonymous?  By the way, create_function returns a string with the name of this ‚Äúanonymous‚Äù function.  Otherwise, the use is really similar to the use of anonymous functions in PHP 5.3: <br><br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//  ,    PHP 4!: uasort($array, create_function('$a, $b','return $a &gt; $b;'));</span></span></code> </pre><br><br>  Why do I need closures in PHP, I understand poorly.  To simply save the state of a function between calls?  For example: <br><br><pre> <code class="php hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getModernIncrementer</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ $x=<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">use</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(&amp;$x)</span></span></span><span class="hljs-function"> //    ! </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $x++; }; } $incrementer2=getModernIncrementer(); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $incrementer2(), $incrementer2(), $incrementer2();<span class="hljs-comment"><span class="hljs-comment">//012</span></span></code> </pre><br><br>  But for this there are <strong>static</strong> variables.  Their use is simpler, more convenient and requires less code: <br><br><pre> <code class="php hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">incrementer</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> $x=<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $x++; } <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> incrementer(),incrementer(),incrementer(); <span class="hljs-comment"><span class="hljs-comment">//012</span></span></code> </pre><br><br>  For complex state preservation between calls, there is an <strong>OOP</strong> .  By the way, anonymous functions in <strong>PHP 5.3</strong> are not exactly honest functions!  In practice, this function turns out to be ... turns out ... Attention focus: <br><br><pre> <code class="php hljs">var_dump(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>{<span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>;}); <span class="hljs-comment"><span class="hljs-comment">// object(Closure)#1 (0) { }</span></span></code> </pre><br><br>  The function is an object of the <strong>Closure</strong> class - and here it is your OOP.  And so that the object in every possible way posed a function out of itself, the PHP developers invented a special ‚Äúmagic‚Äù method <em>__invoke ()</em> : <br><br><pre> <code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Test</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__invoke</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">123</span></span>; } } $func = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Test(); <span class="hljs-keyword"><span class="hljs-keyword">echo</span></span> $func(); <span class="hljs-comment"><span class="hljs-comment">//123</span></span></code> </pre><br><br>  <strong>To summarize:</strong> Anonymous functions and closures are a very powerful tool.  And like any powerful tool, they require very careful application.  They can significantly simplify the program code, make it more beautiful and improve its readability, but they can do exactly the opposite - make it completely unreadable.  Closures are very often used as callback functions when programming GUIs.  It is very convenient to hang them as handlers for clicking on different buttons.  But in PHP, almost no one makes programs with <strong>GUIs</strong> ( <a title="PHP GTK" href="http://php-gtk.eu/apps">although there are craftsmen</a> ), and there are some reasons for this - PHP is still a web scripting language, not desktop applications.  Therefore, anonymous functions are good in <strong>preg_replace_callback</strong> , <strong>array_filter,</strong> and similar functions, and closures should be left for <strong>Javascript</strong> , <strong>Python,</strong> and other languages, where they are implemented really well and where they are really needed for use in the GUI. <br><br>  <strong>In conclusion:</strong> I want to give a complete example of using closures with <strong>jQuery</strong> (when working with this library, they are widely used).  In the example, there are many nested functions, handlers, and in order to avoid constant (albeit fast, but ugly) searches for <strong>DOM</strong> objects by parameters, variables already containing the desired object, derived from the external function, are used everywhere (this is the closure).  The same code is used in the admin of the <a title="Hi-tech@Mail.Ru" href="http://hi-tech.mail.ru/">hi-tech.mail.ru</a> project, and allows you to dynamically add the ability to edit and save individual blocks of the page via <strong>AJAX</strong> (like what the <a href="http://plugins.jquery.com/project/Editable">Editable</a> plugin does), while the <strong>HTML</strong> code of the page does not contain any special markup for this . <br><br><pre> <code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span>dynaedit<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/css"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"><span class="undefined"> .msg, .edt {font-family: "Verdana", "Arial", "Helvetica", sans-serif; font-size: 10pt} .msg {background-color:#DDf; border: 1px solid #000; padding:2px} .edt {margin:-2px 0 -2px -1px; padding:0; width:100%; height:100%; border 0} </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://code.jquery.com/jquery-latest.min.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="javascript"><span class="javascript"> $(</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">document</span></span></span><span class="javascript">).ready(</span><span class="hljs-function"><span class="hljs-keyword"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="javascript"><span class="hljs-function">(</span></span><span class="hljs-params"></span><span class="javascript"><span class="hljs-function"><span class="hljs-params"></span>) </span></span></span><span class="javascript">{ $(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"#admin"</span></span></span><span class="javascript">).click(</span><span class="hljs-function"><span class="hljs-keyword"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="javascript"><span class="hljs-function">(</span></span><span class="hljs-params"></span><span class="javascript"><span class="hljs-function"><span class="hljs-params"></span>) </span></span></span><span class="javascript">{ $(</span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">this</span></span></span><span class="javascript">).remove(); $(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"p.msg"</span></span></span><span class="javascript">).each(</span><span class="hljs-function"><span class="hljs-keyword"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="javascript"><span class="hljs-function">(</span></span><span class="hljs-params"></span><span class="javascript"><span class="hljs-function"><span class="hljs-params"></span>) </span></span></span><span class="javascript">{ </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">var</span></span></span><span class="javascript"> msg_id=</span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">this</span></span></span><span class="javascript">.id.substr(</span><span class="hljs-number"><span class="javascript"><span class="hljs-number">1</span></span></span><span class="javascript">); </span><span class="hljs-comment"><span class="javascript"><span class="hljs-comment">//  this?  each! var msg=$(this); // JQuery  DOM  &lt;p&gt; $("&lt;input/&gt;", //    { type: "button", value: "  #"+msg_id, click: function StartEdit() //      p   textarea   { var edt=$("&lt;textarea/&gt;", // textarea,     p { 'class':'edt', value:msg.html().replace(/&lt;br[^&gt;]*&gt;/gim,"\n"), // msg?    =&gt;  height:msg.height(), }).appendTo(msg.empty()); $(this).val("  #"+msg_id).unbind().click(function() //      { //$.post("/ajax/savemessage",{msg_id:msg_id, msg:edt.val()}, function(data){}); //   msg.html(edt.remove().val().replace(/\n/gm,"&lt;br /&gt;")); // textarea,   $(this).val("  #"+msg_id).unbind().click(StartEdit);// ,      return false; });//Save return false; } //StartEdit() }).insertAfter(this);//&lt;input/&gt; });//$("p.msg").each return false; });//$("#admin").click });//$(document).ready </span></span></span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"p1234"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"msg"</span></span></span><span class="hljs-tag">&gt;</span></span>  <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag"> /&gt;</span></span>  !<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"p1235"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"msg"</span></span></span><span class="hljs-tag">&gt;</span></span>  <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag"> /&gt;</span></span>   !<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag"> /&gt;</span></span>PS Just 4 lulz<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"admin"</span></span></span><span class="hljs-tag">&gt;</span></span>    !<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  <i>Respectfully,</i> <i><br></i>  <i>Mail.Ru Research and Development Department</i> </div><p>Source: <a href="https://habr.com/ru/post/103983/">https://habr.com/ru/post/103983/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../103971/index.html">New kitchen design interface from IKEA</a></li>
<li><a href="../103972/index.html">The idea of ‚Äã‚Äãthe project FlipTweet.com</a></li>
<li><a href="../103976/index.html">Nokia changed CEO</a></li>
<li><a href="../103978/index.html">Bing + HTML5</a></li>
<li><a href="../103982/index.html">FSB adopts Russian drones</a></li>
<li><a href="../103985/index.html">Issue 2: Cisco ROI Finalists are welcome in our incubator</a></li>
<li><a href="../103986/index.html">Adobe's response to Apple's new rules</a></li>
<li><a href="../103990/index.html">Fast Rubik's Cube Assembly</a></li>
<li><a href="../103991/index.html">OnPropertyChanged with strong names</a></li>
<li><a href="../103992/index.html">majordomo lies</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>