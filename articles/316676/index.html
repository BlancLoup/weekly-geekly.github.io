<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Front-end and ad blockers (for example, Adblock Plus)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I want to share some experience with ad blockers by a front-end developer. Everyone understands that our task is to make the site work normally and lo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Front-end and ad blockers (for example, Adblock Plus)</h1><div class="post__text post__text-html js-mediator-article">  I want to share some experience with ad blockers by a front-end developer.  Everyone understands that our task is to make the site work normally and look at any user settings, on any devices.  I <s>sometimes look</s> constantly checking how the site looks when javascript is disabled, I check the work on touch-devices, devices with low resolution and so on.  etc.  Once the video player stopped working on our site due to Adblock Plus (hereinafter simply Adblock), it became clear that the presence of an ad blocker should also be taken into account when imposing a site ... <br><a name="habracut"></a><br>  Once, letters about a non-working video player fell to our support service.  <s>At</s> long <s>lasting method</s> , it was found that Adblock blocks Yandex video ads that are shown in front of our videos.  There was no such <s>rudeness of</s> exclusion in the player - therefore, with the blocker turned on, instead of the video clip, the preloader was constantly spinning. <br><br>  The first question is how many such users are.  <a href="https://habrahabr.ru/post/140980/">The survey on Habr√©</a> showed sad data.  On our site, the Yandex metric showed more than 8% of users with a blocker enabled. <br><br><div class="spoiler">  <b class="spoiler_title">Watch</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/131/5c6/b2f/1315c6b2fd754077ba2440a27322713e.jpg"><br></div></div><br>  I think the real figure is much higher (for example, well-known metrics can also be blocked), but the available data turned out to be enough to install a blocker and look at the site after <s>removing the rose-colored glasses</s> again. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      It turns out that, in addition to well-known advertising services (Google, Yandex), some of our pictures and blocks were cut out, and not all are related to advertisements. <br><br>  I had to repair.  It turned out, the blocker cuts all the pictures, in the paths of which there is mention of advertising: / ad / banner /.  In addition to the paths, Adblock can cut the contents by the id attribute (adblock, AdDiv, etc.), the name of the classes (Adv, etc.), the very name of the pictures (728x90.png, etc.), styles.  There are a lot of names, but you can see everything in files with standard blocker filters: <br><br>  <a href="https://easylist-downloads.adblockplus.org/easylist.txt">easylist-downloads.adblockplus.org/easylist.txt</a> <br>  <a href="https://easylist-downloads.adblockplus.org/antiadblockfilters.txt">easylist-downloads.adblockplus.org/antiadblockfilters.txt</a> <br><br>  <s>Renaming everything that can be</s> done Having replaced the usual ad with another name, I was pleased to find that all our ad units appeared on the site again and my layout has the same appearance, with Adblock and without it.  Feeling proud for the work done, I began to do my usual things again. <br><br>  Less than a month ago, I found that the <s>most annoying</s> most important advertising for us was again blocked.  I placed such advertising separately, in the illumination folder. <br><br>  In addition to standard filters, Adblock has subscriptions - these are the same text lists of ready-made filters that can be created by many authors;  they are built into the extension and the user can choose the ones he needs.  In the standard subscription list: <br><br>  <a href="https://easylist-downloads.adblockplus.org/ruadlist%2Beasylist.txt">easylist-downloads.adblockplus.org/ruadlist+easylist.txt</a> <br><br>  I found this line: <br><br>  /illumination/$script,stylesheet,domain=kinoafisha.info|kinoafisha.msk.ru|kinoafisha.spb.ru <br><br>  It became clear that the advertisement bothered users and we were added to the list of subscriptions. <br><br>  Then there were two ways to solve the problem: <br><br>  1. Continue to fight Adblock, periodically changing the name, coming up with other ways to bypass the blocker <br>  2. Put up with the situation and think about an alternative solution. <br><br>  On the example <a href="https://geektimes.ru/post/279420/">of Facebook‚Äôs fight against Adblock</a> , and on its own example, it was clear that the struggle would last forever and in any case would be the blocker - he would do his direct business, and you, instead of developing the site, would fight the wind turbines mills. <br><br>  But we could not refuse to show advertising - we are not an online store, we do not sell any articles, we work honestly and display advertising on the site - this is our main source of income.  Without it, our normal existence and development is impossible.  Even Habr is forced to show ads, explaining this need very well - <a href="https://habrahabr.ru/adblock/">habrahabr.ru/adblock</a> <br><br>  As a result, it was decided: to try to determine the presence of a blocker and show such a sad cat to such users.  At the same time, the cat should not be in some kind of hellish popup or constantly occupy a half-screen - otherwise, he himself will soon fall into the blocker and / or lead to an outflow of visitors.  It is enough to do so to pay attention to him, his main goal was to <s>put pressure on the pity</s> to explain to the user the need for advertising.  As a result, a regular block with the following content appeared at the top of the site: <br><br><img src="https://habrastorage.org/files/a23/433/34b/a2343334b00a4025bcf80fdd94f0293d.jpg"><br><br>  It remained to find out how to determine whether the ad blocker is enabled or not.  The first thing that came to mind was to insert an element in the markup that exactly fits the standard filter and check its presence using js.  If the item is not present, then the adblock is enabled.  In fact, it turned out to be a little more complicated.  Despite the fact that advertising is not visible on the site - the ad unit is in the DOM-tree and it is not enough to determine its presence.  It is necessary that the element has dimensions, it would not be ‚Äúthrown out‚Äù from the stream (that is, without display: none) and if the element has zero width, then it is blocked: <br><br><div class="spoiler">  <b class="spoiler_title">View code</b> <div class="spoiler_text"><pre><code class="markdown hljs"><span class="xml"><span class="hljs-meta"><span class="xml"><span class="hljs-meta">&lt;!DOCTYPE html&gt;</span></span></span></span> <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">html</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"no-js"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">lang</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"ru"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">head</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">meta</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">charset</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"utf-8"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">title</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> Adblock<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">title</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">style</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="undefined"></span></span><span class="xml"><span class="undefined"></span></span> .px { visibility:hidden; position:absolute; left:-9999px; top:-9999px; display:block; width:1px; height:1px; overflow:hidden; } <span class="xml"><span class="undefined"></span><span class="hljs-tag"><span class="xml"><span class="undefined"></span><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">style</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">head</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">body</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"adblock"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"px"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="undefined"></span></span><span class="xml"><span class="undefined"></span></span> document.addEventListener("DOMContentLoaded", function(){ var box = document.getElementById('adblock'); if(!box.getBoundingClientRect().width) alert('Adblock '); else alert('Adblock '); }); <span class="xml"><span class="undefined"></span><span class="hljs-tag"><span class="xml"><span class="undefined"></span><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">body</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">html</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br></div></div><br>  It is possible that after some time Adblock will come up with something else or add this code to the filter, and this check will stop working, but at the time of writing the article the cat on the site appears regularly. <br><br>  There is another opportunity to leave ad units on the page - Adblock has a so-called white list of unobtrusive ads where small sites can get for free.  More can be found on Habr√©: <br><br>  <a href="https://habrahabr.ru/post/299000/">habrahabr.ru/post/299000</a> <br>  <a href="https://habrahabr.ru/post/185786/">habrahabr.ru/post/185786</a> <br><br>  I can‚Äôt advise anything here - we didn‚Äôt try to get on this list, it‚Äôs quite possible that I can finish writing something substantial later. <br><br>  Thank you for reading to these lines, if I could convince any of the front-end developers to look at the work of the site with the blocker turned on - it would be nice.  Just do not forget to turn it off - otherwise you can deprive yourself of salary).  As for how much the cat helped in the display of ad units - until I can say, we set it up two days ago.  If someone is interested - in a month, I can probably drop the number. </div><p>Source: <a href="https://habr.com/ru/post/316676/">https://habr.com/ru/post/316676/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../316666/index.html">We write interactive Telegram bots on Python</a></li>
<li><a href="../316668/index.html">Hype driven development</a></li>
<li><a href="../316670/index.html">We build PVS-Studio in Eclipse CDT (Linux)</a></li>
<li><a href="../316672/index.html">Unity: squeezing compressed</a></li>
<li><a href="../316674/index.html">Veeam 9.5 and VMware vCloud Director backup</a></li>
<li><a href="../316678/index.html">AngelList crowdfunding platform and Product Hunt platform create a single ecosystem for IT startups</a></li>
<li><a href="../316680/index.html">Web technologies for designers - why and how</a></li>
<li><a href="../316682/index.html">Interview with the designer: Olga Romanova</a></li>
<li><a href="../316684/index.html">Speak the word about Brave React</a></li>
<li><a href="../316686/index.html">Gitlab flow</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>