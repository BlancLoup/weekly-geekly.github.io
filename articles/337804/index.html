<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Investigation of information leaks from the carrier‚Äôs corporate database</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We were approached by a large Russian carrier that owns an impressive fleet of vehicles. Its customers include dozens of logistics companies and enter...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Investigation of information leaks from the carrier‚Äôs corporate database</h1><div class="post__text post__text-html js-mediator-article">  We were approached by a large Russian carrier that owns an impressive fleet of vehicles.  Its customers include dozens of logistics companies and enterprises.  The zone of its activity extends far beyond the borders of the CIS countries.  Each car is equipped with a monitoring system that sends data about coordinates, fuel consumption and many other indicators to the control center. <br><br>  From a single center, information about the coordinates of the goods diverges to customers.  Everything works in an automated way.  For the convenience of control of delivery, the cost of services included a service to inform customers about the location of their goods. <br><br><img src="https://habrastorage.org/web/930/74f/84b/93074f84bec74aa9bd52db594c1583bd.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The reason for contacting us was the activity of several online resources that sold information about the carrier‚Äôs cargo.  It is unlikely that a logistics company or another client of our carrier will be glad to know that anyone, including competitors, can acquire data on his goods. <br><a name="habracut"></a><br>  From a technical point of view, information about your cargo can be obtained in two ways. <br>  The first is on the carrier‚Äôs website, the second, more complex, by connecting its logistic information system (customer‚Äôs ACS) directly to the carrier‚Äôs base.  All requests from the client's ACS to the carrier‚Äôs database (DB) are implemented through a set of Stored Procedures.  To control access to each client, his own account is allocated with a set of necessary powers and rights. <br><br><img src="https://habrastorage.org/web/ab5/551/e06/ab5551e06b7647f786a36cc8b4716b60.jpg"><br><br>  The carrier‚Äôs specialists understood that, in addition to data on the location of the cargo, other information may also flow from their database.  Who and for what purpose they will use is unknown, but alarming.  Presumably the customers of such sites may be not only competitors, but also the clients of the carrier who wish to have an alternative channel of control.  Also information on trucks may be interesting to those who managed to unofficially "attach" their cargo in the back, for example, by agreeing with the driver.  There is an obvious information leakage, and our task was to find out the method of its organization. <br><br>  To begin with, we conducted an analysis of the information provided by these sellers of stolen goods.  It turned out that the range of their services is quite wide.  For quite reasonable money that even a private person can afford, you can get information on the location of a particular truck or cargo at the moment.  You can subscribe to the tracking of cargo or vehicle, then you will receive data by e-mail or by SMS with the frequency for which you have enough money. <br><br>  To continue the investigation, we chose the ‚Äútest purchase‚Äù method.  We registered on one of these criminal resources and paid for several dozen requests for the coordinates of the truck.  When planning each request, we planned to track the sources of calls to the carrier‚Äôs central database. <br><br>  After reviewing the base structure, we realized that information about the coordinates of a vehicle can be obtained either from the base table or from the view.  We chose one of the trucks of the company that was on the flight, asked the database administrators of the control center to enable tracing of calls to the table and views containing data on the coordinates of the truck.  Over the next three hours we made 10 requests on the fraudulent website and received GPS coordinates for each request.  Data for each request came to us with a delay of no more than a second.  During these three hours, about 70 megabytes of text magazines were added.  To analyze them, we went to our office, where we had the right tools, leaving the base administrators alone. <br><br>  During the analysis, we realized that the data in response to our requests came in online mode, and versions about leaks from backup copies, or about processing requests in manual mode, were noted.  We were hoping that within a second of our request, the data about the external client that "merges" the information will appear in the trace.  The results of the analysis were disappointing - in the trace made by standard DBMS tools there was information on appeals to the table and views, but there was no information about specific requests for data on our truck.  It turned out that in a second there are more than two hundred calls to the table and views, and it is not possible to single out the calls made in response to our requests among them. <br><br>  There is a need for additional tools, which will give us the contents of each specific reference to the table or view.  Many tools can analyze SQL queries and the like in traffic, but in our case it was necessary to have software that not only could intercept requests from stored procedures to the database on the same server, but also ‚Äúparse‚Äù their contents. <br><br>  It‚Äôs good that we managed to quickly find such a tool and agree on its temporary use.  This solution (InfoSphere Guardium) can analyze requests from stored procedures using the software agent directly on the database server.  By analyzing queries on the fly, the system allows us to obtain all the data we need.  After the nightly installation and configuration work, we again conducted a series of 10 data requests for our truck on the ‚Äúleft‚Äù resource.  This time, thanks to the built-in filtering methods of our analytical system, we received a list of 12 accounts to which the data on the coordinates of our truck ‚Äúflew‚Äù within a second after each of our requests.  For any of these accounts is the ACS of one of the carrier's customers.  The task was to determine which specific ACS transfers data to the side, for which we used the method of setting individual "tags". <br><br>  Together with the database administrators, we slightly modified those stored procedures, using which the 12 accounts we detected take data from the database.  The modification pursued one goal - depending on the account, to make individual adjustments to the coordinates of the truck.  For each of the 12 automated control systems, individual coordinates were formed, differing in the last two digits, all values ‚Äã‚Äãsent by us were carefully stored in a special journal.  Having received the "marked" coordinates from the criminal website, we, referring to the log of issuing tags, were able to identify the ACS that merges the data. <br><br>  Now a rather delicate moment has come - for further investigation, data from the client‚Äôs ACS were needed.  This meant that the client must be at least partially privy to the heart of the matter.  Moreover, if the data is drained by the administrator of this automated control system, he can catch all traces.  It was necessary to act very carefully.  The circumstances were successful, because  An agreement was reached on cooperation at the level of the carrier‚Äôs security services and this client, a major logistics operator.  The client security service agreed to provide us with the ACS server logs.  Log analysis gave us a single account that received data tagged.  The account belonged to one of the employees of the logistics company.  What happened to him next story is silent.  The main thing is that the goal was achieved - the sale of stolen data has stopped. </div><p>Source: <a href="https://habr.com/ru/post/337804/">https://habr.com/ru/post/337804/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../337782/index.html">BlueBorne exploit on Android, iOS, Linux and Windows: more than 8 billion devices are critically vulnerable</a></li>
<li><a href="../337784/index.html">Implementing OpenId Connect in ASP.NET Core using IdentityServer4 and oidc-client</a></li>
<li><a href="../337786/index.html">VMworld 2017 Europe Conference. Day 0</a></li>
<li><a href="../337800/index.html">Two-factor authentication for VPN connections</a></li>
<li><a href="../337802/index.html">The practice of forming requirements in IT projects from A to Z. Part 7. Transfer of requirements into production. Conclusion</a></li>
<li><a href="../337806/index.html">Selection: 10 useful tools for an internet marketer</a></li>
<li><a href="../337808/index.html">When size matters: create a ruler application with ARKit</a></li>
<li><a href="../337810/index.html">Computer vision. Ask an Intel Expert Question</a></li>
<li><a href="../337812/index.html">Oracle will place the Java EE project in the hands of the Eclipse Foundation community</a></li>
<li><a href="../337814/index.html">"Innovations Around": why descriptions on companies' websites are so incomprehensible, and why this is bad</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>