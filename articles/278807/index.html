<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Intel RealSense SDK Plug-in for Unreal Engine 4</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This article will help developers familiarize themselves with the capabilities of the RealSense plug- in for Unreal Engine 4, understand its architect...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Intel RealSense SDK Plug-in for Unreal Engine 4</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/afa/6e1/998/afa6e1998ac241c090a91501ac284cf9.jpg"><br>  This article will help developers familiarize themselves with the capabilities of the <a href="https://software.intel.com/en-us/realsense/home">RealSense</a> plug- <a href="https://software.intel.com/en-us/realsense/home">in</a> for Unreal Engine 4, understand its architecture and device.  This plug-in was developed by Intel to support the Intel¬Æ RealSense ‚Ñ¢ SDK.  This article is intended for experienced developers using UE4, as well as for developers who are familiar with RealSense technology.  If you want to start exploring UE4, read the <a href="https://wiki.unrealengine.com/Main_Page">documentation and training materials</a> .  You can also download Epic Games Launcher <a href="https://www.unrealengine.com/dashboard">here</a> and view sample projects on the Learn tab. <br><a name="habracut"></a><br><h1>  <font color="#0071c5">Basic information and area of ‚Äã‚Äãthis work</font> </h1><br>  Unreal Engine 4 is the fourth generation of the Epic Games game engine.  It was first introduced to a limited audience in 2012 at the Game Developers Conference.  In 2014, all interested developers could already get the source code of this engine, paying a small monthly subscription.  The subscription fee was canceled in 2015, now the source code of the entire engine is available to all developers for free. <br><br>  The Unreal Engine source code is written in C ++.  In the UE4 version, Epic developers first used Blueprint visual scripts instead of the Kismet system used in UE3.  In fig.  Figure 1 shows an example Blueprint script. <br><br><img src="https://habrastorage.org/files/c6c/021/6ec/c6c0216ecdb244419c441f0a7b3381b4.png"><br>  <i>Figure 1. Sample Blueprint script in Unreal Engine * 4</i> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Developers can create Blueprint nodes for events, functions, variables, macros, etc., and link them together using logical process chains.  Blueprint scripts simplify the work of novice developers with limited programming experience and provide extremely fast prototyping. <br><br>  Many UE4 games are implemented using a combination of C ++ program code and Blueprint scripts.  Visual scripts allow you to manage animated images, define complex artificial intelligence behavior trees, and implement any kind of game logic. <br><br><h1>  <font color="#0071c5">Intel RealSense SDK Plugin</font> </h1><br>  The Intel RealSense SDK was originally written in C ++, which gives developers a convenient way to access SDK functions from game code, also written in C ++.  The described plug-in extends the development capabilities of UE4 by providing access to the SDK functionality through Blueprint scripts. <br>  At the time of this writing, the plug-in officially supported the following functions: <br><ul><li>  Transfer the raw color image and depth image from the camera. </li><li>  Three-dimensional scanning of faces and objects. </li></ul><br>  Work is also underway on implementing support for two more components: <br><ul><li>  Head tracking. </li><li>  The perception of the scene. </li></ul><br>  The ultimate goal of the plug-in is to support all the features and capabilities of the full version of the Intel RealSense SDK applicable to games.  For a complete list of RealSense SDK features, organized by camera and availability, see the <a href="https://software.intel.com/en-us/intel-realsense-sdk/download">RealSense SDK release notes</a> . <br><br>  The source code of the plug-in is available <a href="https://github.com/GameTechDev/UE4RealSensePlugin">here</a> . <br>  In the sample project, there is a map designed to demonstrate each of the capabilities of the plug-in;  commentary scripts describe the intended use of RealSense components. <br>  If you are interested in developing using any of the experimental functions of the plug-in, use additional branches in the plug-in storage. <br><br>  In addition, the Getting Started guide is located in the project folder to help add a plug-in to a new project.  The same actions are described in the next training video. <br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/mrIiBssoI0w%3Ffeature%3Doembed&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhgWlX7HGHmBA3TG_aVrf4BHA-wz2Q" frameborder="0" allowfullscreen=""></iframe><br><br><h1>  <font color="#0071c5">RealSense components</font> </h1><br>  This section provides a more detailed description of each of the RealSense components. <br><br><h2>  <font color="#0071c5">UE4 components</font> </h2><br>  The Unreal Engine has a special type of object called a component.  Its purpose is to join other objects.  Components are usually quite compact and autonomous, they provide a limited set of functions to the objects to which they are attached.  They can be attached to almost any imaginable objects, including player characters, static objects, vehicles, lights, and interface elements.  The purpose of the components is to provide similar functionality to dissimilar classes of objects. <br><br>  To get an idea of ‚Äã‚Äãthe latitude of the components, for example, consider the Scene component that applies the transform to the object to which it is attached.  Transformation is the application of location, rotation and scale to an object.  Using the transformation, the developer can place the object in any place of the game world.  This component makes it very easy to add a transformation to anything, even to light and sounds. <br><br>  The RealSense plug-in is organized as a set of components, each of which provides access to specific features of the RealSense SDK.  For example, the Camera Streams component provides a developer with access to a color image stream and a depth stream transmitted from a camera.  In the UE4 editor, the list of components is in the <b>Add Component</b> drop-down menu in the <b>Components</b> window in the <b>RealSense</b> category, as shown in Figure.  2 <br><br><img src="https://habrastorage.org/files/0e5/518/5ef/0e55185ef61d45fc9f11390547eaec76.png"><br>  <i>Figure 2. Components of the RealSense plug-in in the Components window of the Unreal Engine * 4</i> <br><br><h2>  <font color="#0071c5">RealSense component</font> </h2><br>  This component is the abstract parent class of all other RealSense components.  It provides the overall functionality needed by each component, but it‚Äôs impossible to attach it to any object in Unreal. <br>  The data provided by this class include the following (Figure 3). <br><br><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">float</span></span> ColorHorizontalFOV; <span class="hljs-comment"><span class="hljs-comment">//       float ColorVerticalFOV; //       float DepthHorizontalFOV; //       float DepthVerticalFOV; //       ECameraModel CameraModel; //   : F200, R200  SR300 FString CameraFirmware; //    </span></span></code> </pre> <br><br><img src="https://habrastorage.org/files/b00/eda/e78/b00edae78da54d4d828c79f968e71383.png"><br>  <i>Figure 3. Member variables of the RealSense component</i> <br><br>  The RealSense component also provides the following features (Figure 4). <br><br><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">StartCamera</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-comment"><span class="hljs-comment">//   RealSense void StopCamera(); //   RealSense bool IsCameraRunning(); //   true,    //       FStreamResolution GetColorCameraResolution(); virtual void SetColorCameraResolution(EColorResolution); //       FStreamResolution GetDepthCameraResolution(); virtual void SetDepthCameraResolution(EDepthResolution); //   true,       . bool IsStreamSetValid(EColorResolution, EDepthResolution);</span></span></code> </pre><br><br><img src="https://habrastorage.org/files/b00/eda/e78/b00edae78da54d4d828c79f968e71383.png"><br>  <i>Figure 4. Member functions of the RealSense component</i> <br><br><h2>  <font color="#0071c5">Component Camera Streams</font> </h2><br>  This component provides access to the raw color image and depth data from an Intel RealSense camera, as well as convenient Texture objects to display these images. <br>  The data provided by this class include the following (Figure 5). <br><br><pre> <code class="cpp hljs">TArray&lt;FSimpleColor&gt; ColorBuffer; <span class="hljs-comment"><span class="hljs-comment">//  32-   (RGBA) TArray&lt;int32&gt; DepthBuffer; //  16-   ( ) UTexture2D* ColorTexture; //     . UTexture2D* DepthTexture; //     .</span></span></code> </pre><br><br><img src="https://habrastorage.org/files/a76/93d/998/a7693d998d4d4bb6bd0dff4dc875369f.png"><br>  <i>Figure 5. Camera Streams member variable</i> <br><br>  The Camera Streams component also provides the following features that are overridden from the RealSense component: <br><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//    RealSense,  ColorBuffer  ColorTexture   . virtual void SetColorCameraResolution(EColorResolution) override; //    RealSense,  DepthBuffer  DepthTexture   . virtual void SetDepthCameraResolution(EDepthResolution) override;</span></span></code> </pre><br>  There is a small library of utility functions, it is called RealSense Utilities.  One of these functions accepts a color buffer (Color Buffer object) and color texture (Color Texture object) as input data and fills this texture with buffer data.  There is also a comparison function that works with a depth buffer (Depth Buffer object) and a depth texture (Depth Texture object).  The use of this function is shown in Fig.  6 <br><br><img src="https://habrastorage.org/files/df1/09a/a63/df109aa63fbb41c583976b2d1e4de837.png"><br>  <i>Figure 6. An example of using the Color Buffer to Texture function</i> <br><br>  Check out this quick tutorial to learn how to use the Camera Streams component of the RealSense plug-in to access a stream of color from your camera and display this image on the screen. <br><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/WMqG3UZkBTE%3Ffeature%3Doembed&amp;xid=17259,15700023,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjWQJXnbPfwmeviFAiFJbJU9JEgUA" frameborder="0" allowfullscreen=""></iframe><br><br><h2>  <font color="#0071c5">Scan 3D component</font> </h2><br>  This component provides access to the intermediate 3D scanning module in the Intel RealSense SDK.  Currently, the plug-in supports scanning of faces and objects, but does not support the output of textures, only vertex colors are displayed. <br>  The data provided by this class include the following (Figure 7). <br><br><pre> <code class="cpp hljs">TArray&lt;FSimpleColor&gt; ScanBuffer; <span class="hljs-comment"><span class="hljs-comment">//  32-   (RGBA),    ,      . UTexture2D* ScanTexture; //    ScanBuffer TArray&lt;FVector&gt; Vertices; //   Vector3,     TArray&lt;int32&gt; Triangles; //   ,   TArray&lt;FColor&gt; Colors; //  ,   </span></span></code> </pre><br><br><img src="https://habrastorage.org/files/9f6/03c/9a8/9f603c9a8f034aa38b91314e949cb372.png"><br>  <i>Figure 7. The variable members of the Scan 3D component</i> <br><br>  The Scan 3D component also provides the following functions (Figure 8). <br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//    (    )  , ,       void ConfigureScanning(EScan3DMode, bool); void StartScanning(); //    void StopScanning(); //    void ResetScanning(); //    bool IsScanning();//   true,     void SaveScan(FString); //     OBJ-    . void LoadScan(FString); //      OBJ-</span></span></code> </pre><br><br><img src="https://habrastorage.org/files/3fc/38b/dca/3fc38bdcae1647abb729d6b1b12f3c9f.png"><br>  <i>Figure 8. Member functions of the Scan 3D component</i> <br><br>  Finally, the Scan 3D component provides one Blueprint event (Figure 9). <br><br><pre> <code class="cpp hljs">OnScanComplete(); <span class="hljs-comment"><span class="hljs-comment">// ,     </span></span></code> </pre><br><br><img src="https://habrastorage.org/files/fc2/21c/30e/fc221c30e9094c86ac4ab2c0561267c0.png"><br>  <i>Figure 9. Blueprint OnScanComplete Event Node</i> <br><br>  The <i>SaveScan ()</i> function <i>instructs the scan engine</i> to save and return immediately after that.  Somewhat later (in the new camera frame), the RealSense plug-in stream will perform the save operation.  Developers should use the <i>OnScanComplete ()</i> event to receive notification that the save is complete when scanning. <br><br><h1>  <font color="#0071c5">Architecture</font> </h1><br><h2>  <font color="#0071c5">RealSense Session Manager</font> </h2><br>  When a component is attached to an object in UE4, this object receives a new instance of this component class.  You can create multiple instances of the same component class and attach them to multiple objects within a single project.  But for the RealSense components, this causes a problem.  The fact is that there is only <a href="https://software.intel.com/en-us/realsense/devkit">one Intel¬Æ RealSense ‚Ñ¢ camera</a> in the system that needs to be managed by the developer.  But since you can create multiple instances of the same component class, each instance of a RealSense component will receive its own copy of the data from the camera. <br><br>  To solve this problem, the RealSense Session Manager object is used in the RealSense plug-in.  This is a singleton class, an instance of which is automatically created when the first RealSense component is added to an object in the game.  All subsequent instances of the RealSense component receive a link to the RealSense Session Manager when they are initialized.  RealSense Session Manager owns the master copy of all Intel RealSense SDK data.  Each RealSense component reads data from RealSense Session Manager and writes data to it. <br><br><h2>  <font color="#0071c5">Multithreading</font> </h2><br>  RealSense Session Manager is responsible for managing the dedicated stream of the RealSense plug-in.  This stream provides RealSense SDK modules so that the game uses RealSense component classes based on the SDK capabilities.  This stream is where the <i>AcquireFrame ()</i> / <i>ReleaseFrame ()</i> SDK works.  All involved modules process the received frames. <br><br>  RealSense Session Manager uses a triple buffer to control the exchange of data between the RealSense plug-in stream and the main stream of the UE4 game.  The RealSense plug-in stream writes all new data to the background buffer.  After calling <i>ReleaseFrame (), the</i> background buffer exchanges data with the middle buffer, locked by means of mutually exclusive locks (mutexes).  After that, in each clock of the game stream, the foreground frame is exchanged with the middle buffer, providing the latest data to the Session Manager and to all RealSense components. <br><br><h1>  <font color="#0071c5">Conclusion</font> </h1><br>  The RealSense plug-in provides developers using UE4 a simple and easy to use interface to the Intel RealSense SDK.  The features of the SDK are made available to the Blueprint scripting system, which significantly speeds development.  Thanks to the architecture based on a set of components, developers can add 3D capabilities to almost any object in the game. </div><p>Source: <a href="https://habr.com/ru/post/278807/">https://habr.com/ru/post/278807/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../278793/index.html">Do I need a JSON replacement? In the wake of an article about KTV</a></li>
<li><a href="../278797/index.html">In Google Summer of Code 2016 with KolibriOS</a></li>
<li><a href="../278801/index.html">Custom configuration file in Rails</a></li>
<li><a href="../278803/index.html">I invite to the programming championship</a></li>
<li><a href="../278805/index.html">Charts and other usefulness for UWP applications</a></li>
<li><a href="../278809/index.html">OSSIM - we use integrated open source security management system</a></li>
<li><a href="../278811/index.html">How to organize the transfer of financial data on the American stock exchange Nasdaq: ITCH and OUCH protocols</a></li>
<li><a href="../278813/index.html">Register for the webinar ‚ÄúUsing Panda SaaS Solutions to Protect and Manage Enterprise IT Assets‚Äù</a></li>
<li><a href="../278815/index.html">Android application architecture</a></li>
<li><a href="../278817/index.html">ReactiveCocoa. Concurrency. Multithreading</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>