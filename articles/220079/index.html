<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>XSLT conversion of an internal table to ABAP with a generic reference type field</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Prologue 
 What is the note about? As from the internal table, the row of which contains a link to an unknown (generic) type (REF TO DATA), which, in ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>XSLT conversion of an internal table to ABAP with a generic reference type field</h1><div class="post__text post__text-html js-mediator-article"><h4>  Prologue </h4><br>  <b>What is the note about?</b>  As from the internal table, the row of which contains a link to an unknown (generic) type (REF TO DATA), which, in fact, stores a link to the same table, get the XML of the specified format.  At the same time, the number of nesting levels is initially unknown. <br>  <b>Why do you need it?</b>  I needed this when uploading data to various formats of MS Office XML files without using OLE. <br>  <b>Who is this article for?</b>  For programmers on ABAP. <br>  <b>Required level of knowledge:</b> know what the <a href="http://help.sap.com/saphelp_nw04s/helpdata/en/1a/42923ae53dca62e10000000a11402f/content.htm">reference type is</a> , <a href="http://help.sap.com/abapdocu_70/en/ABENBUILT_IN_TYPES_GENERIC.htm">generic type</a> , <a href="http://ru.wikipedia.org/wiki/Xml">XML</a> ;  to hear that there is such a thing as <a href="http://ru.wikipedia.org/wiki/Xslt">XSLT</a> . <br><a name="habracut"></a><br><h4>  How to deal with this? </h4><br><h5>  Task </h5><br>  There is a tree.  The tree is stored in the internal table.  The table type is defined as follows: <br><pre><code class="bash hljs">TYPES : BEGIN OF tdeep_struct , name TYPE string , rf_child_list TYPE REF TO data <span class="hljs-string"><span class="hljs-string">"    , END OF tdeep_struct , t_deep_struct TYPE STANDARD TABLE OF tdeep_struct WITH NON-UNIQUE DEFAULT KEY .</span></span></code> </pre> <br><br>  Those.  The structure of the table row in the <code>rf_child_list</code> field contains a reference to a generic type. <br><br>  From the internal table of this structure, you need to get the following XML format: <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span>  <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span>  <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      At the same time, the location of the source tree nodes in the final XML should correspond to the downward traversal of the tree (Ie, we start looking at the internal table entries from above. We display the contents of the first record, if it has dependent entries in the <code>rf_child_list</code> , then we start outputting them from the first record. it is dependent - then we derive them, etc.). <br><br><h5>  Test case </h5><br>  Suppose we have a tree of the following form stored in the internal table (the values ‚Äã‚Äãof the Name field are listed): <br><pre> <code class="bash hljs">GrandParent1 Child1 Child2 GrandChild1 GrandParent2</code> </pre><br>  Under the terms of the problem, we need to get this XML from this data. <br><div class="spoiler">  <b class="spoiler_title">Summary XML for Test Case</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> GrandParent1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span>Child1 <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span>Child2 <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span>GrandChild1 <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> GrandParent2<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br><h5>  Decision </h5><br>  Let's start with a simple one: ABAP code, what could be simpler? <br><br><div class="spoiler">  <b class="spoiler_title">Define and fill the internal table with test data</b> <div class="spoiler_text"><pre> <code class="bash hljs">DATA : gt_tree TYPE t_deep_struct <span class="hljs-string"><span class="hljs-string">"  , gtree TYPE tdeep_struct "</span></span>     , gchild TYPE tdeep_struct <span class="hljs-string"><span class="hljs-string">"     , ggrandchild TYPE tdeep_struct "</span></span>     . FIELD-SYMBOLS : &lt;gt_child_list&gt; TYPE t_deep_struct <span class="hljs-string"><span class="hljs-string">"     , &lt;gt_grandchild_list&gt; TYPE t_deep_struct "</span></span>     . START-OF-SELECTION. gtree-name = <span class="hljs-string"><span class="hljs-string">'GrandParent1'</span></span>. CREATE DATA gtree-rf_child_list TYPE t_deep_struct. ASSIGN gtree-rf_child_list-&gt;* TO &lt;gt_child_list&gt;. gchild-name = <span class="hljs-string"><span class="hljs-string">'Child1'</span></span>. APPEND gchild TO &lt;gt_child_list&gt;. gchild-name = <span class="hljs-string"><span class="hljs-string">'Child2'</span></span>. CREATE DATA gchild-rf_child_list TYPE t_deep_struct. ASSIGN gchild-rf_child_list-&gt;* TO &lt;gt_grandchild_list&gt;. ggrandchild-name = <span class="hljs-string"><span class="hljs-string">'GrandChild1'</span></span>. APPEND ggrandchild TO &lt;gt_grandchild_list&gt;. APPEND gchild TO &lt;gt_child_list&gt;. APPEND gtree TO gt_tree. CLEAR gtree. gtree-name = <span class="hljs-string"><span class="hljs-string">'GrandParent2'</span></span>. APPEND gtree TO gt_tree.</code> </pre><br></div></div><br><br>  Solving the problem, I thought that I should use XSLT transformation.  Since the tag for this article I put "XSLT for beginners," then I must mention what it is.  If it is completely on the fingers, then it is a language that allows you to get another XML from one XML.  In doing so, XSLT itself is a subset of XML.  Stop!  And where does the internal table, if it converts XML?  And this is such a feature of the implementation of XSLT in SAP.  Let's see more. <br><br>  For performing the transformation in ABAP is responsible operator <a href="http://help.sap.com/abapdocu_70/en/ABAPCALL_TRANSFORMATION.htm">CALL TRANSFORMATION</a> .  He has a lot of options and a lot of options for work. <br>  The input data that needs to be converted will be transmitted by specifying the <nobr><code>SOURCE _ = __</code></nobr> . <br>  The result can be obtained by specifying the <nobr><code>RESULT XML XML/ // </code></nobr> .  For simplicity, we will get the result in a string. <br><br>  The result of the transformation is displayed on the screen by the standard means of the object CL_XML_DOCUMENT. <br>  We get the following code: <br><pre> <code class="bash hljs"> CALL TRANSFORMATION zedu_test_xslt_deep_transform2 SOURCE table = gt_tree RESULT XML gxml_str. go_xml_doc-&gt;parse_string( gxml_str ). go_xml_doc-&gt;display( ).</code> </pre><br><br>  Oh yeah ... I'm distracted!  The question was: and where is the transformation, if at all, is it to convert one XML into another? <br><br><h5>  Bit rtfm </h5><br>  Let's start with the fact that in SAP transformations are used to <a href="http://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25B5%25D1%2580%25D0%25B8%25D0%25B0%25D0%25BB%25D0%25B8%25D0%25B7%25D0%25B0%25D1%2586%25D0%25B8%25D1%258F">serialize</a> and deserialize data.  Ie, how from some data object (structure, internal table, object) to get a representation in the form of a sequence of bits and vice versa.  We just have a serialization task: the input is a nested structure (internal table ABAP), and the output is XML (textual representation). <br>  XSLT in SAP are of 2 types: normal XSLT and simple transformation (ST).  SAP seemed to have little XSLT and it implemented its own XSLT subset, which called the simple transformation.  It does not suit us, because  cannot work with generic type fields in input parameters. <br>  Remains pure XSLT. <br>  SAP, when executed with XSLT serialization, transforms input transformation parameters to asXML ( <a href="http://help.sap.com/abapdocu_702/en/abenabap_xslt_asxml.htm">canonical XML representation</a> ).  In the process of this conversion, <a href="http://help.sap.com/abapdocu_702/en/abenabap_xslt_asxml_named.htm">according to certain rules</a> , ABAP types are converted, this also applies to the generic type (You can explicitly get a canonical representation of any variable using the standard ABAP <a href="http://help.sap.com/abapdocu_731/en/abenabap_xslt_repository.htm">XSLT conversion with the reserved name ID</a> ). <br>  ABAP help picture explaining data transformations during transformations <br><img src="https://habrastorage.org/getpro/habr/post_images/3d2/521/08a/3d252108afd4e9287b632144696d3d12.gif" alt="We are interested in the direction of Serialization"><br><br><div class="spoiler">  <b class="spoiler_title">For my example, the canonical XML representation looks like this:</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8" ?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">asx:abap</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:asx</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/abapxml"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">asx:values</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TABLE</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">NAME</span></span></span><span class="hljs-tag">&gt;</span></span>GrandParent1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">NAME</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RF_CHILD_LIST</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#d1"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">NAME</span></span></span><span class="hljs-tag">&gt;</span></span>GrandParent2<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">NAME</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RF_CHILD_LIST</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">TABLE</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">asx:values</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">asx:heap</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsd</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:abap</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/abapxml/types/built-in"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:cls</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/abapxml/classes/global"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:dic</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/abapxml/types/dictionary"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">prg:T_DEEP_STRUCT</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"d1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:prg</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">NAME</span></span></span><span class="hljs-tag">&gt;</span></span>Child1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">NAME</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RF_CHILD_LIST</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">NAME</span></span></span><span class="hljs-tag">&gt;</span></span>Child2<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">NAME</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RF_CHILD_LIST</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#d2"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">prg:T_DEEP_STRUCT</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">prg:T_DEEP_STRUCT</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"d2"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:prg</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">NAME</span></span></span><span class="hljs-tag">&gt;</span></span>GrandChild1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">NAME</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RF_CHILD_LIST</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">item</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">prg:T_DEEP_STRUCT</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">asx:heap</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">asx:abap</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br><br><h5>  And how to live with it? </h5><br>  When obtaining a canonical representation of XML for the inner table, the table itself is converted into an element <code><code><code>,         .           . ..      RF_CHILD_LIST ,      DATA ( <code>TYPE REF TO DATA</code> ),      ,     <code>href</code>     ,    . <br> ,     <code>&lt;RF_CHILD_LIST href="#d1" /&gt;</code> ,   <code>#</code> -       <a href="http://ru.wikipedia.org/wiki/XLink">XLink</a> ,  <code>d1</code> ‚Äì  .         XML-: <code>asx:heap</code>  ,   <code>id</code>  d1.    &lt; <code>prg:T_DEEP_STRUCT id="d1" ‚Ä¶ &gt;</code> .      ,         . <br> ..,    XML   ,  . <br> <br>  XSLT- ? <br>     XSLT-. <br>  SAP      STRANS. <br> <img src="//habrastorage.org/files/9e2/1a4/62a/9e21a462a5794b7b820619abc4edb1ec.jpg"> <br>   ,  ¬´¬ª(F5). <br> <img src="//habrastorage.org/files/f25/1a9/ff3/f251a9ff31c7413f96bf83dc1ee3a4e6.jpg"> <br>   ‚Äì  ,       (   ‚Äì XSLT).  Enter. <br> <br>         XSLT,        .  ,        ,    ‚Äì  . <br> <br>        , ..,   ,         (   ,    , ,   html ). <br> <br>    ,       , ..    .      <br> <code class="xml">&lt;xsl:transform version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;xsl:template match="/"&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> : <br> <code>xmlns:xsl</code> ,       xsl. ..       ,       <code>xsl</code> : ( <code>&lt;xsl:strip-space elements="*"/&gt;</code> ) <code>xmlns:sap</code> ,       sap <code>xsl:transform</code> ,     XSLT- <code>&lt;xsl:strip-space elements="*"/&gt;</code>      <code>&lt;xsl:template match="/"&gt;</code>   ,       XML  <br> <br> XSLT-      ( <code>xsl:template</code> )     XML-,      <code>match</code> .   <code>match</code>      <a href="http://ru.wikipedia.org/wiki/XPath">XPath</a> .    ,     ¬´/¬ª,      XML- <code>TABLE</code>    "/asx:abap/asx:values/TABLE" (..    XML-   ( <code>asx:abap</code> )    ( <code>TABLE</code> )). <br> <br>  ,      XML- List.   : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>item</code>   <code>TABLE</code>   XML ,      <code>&lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt;</code> ,    <code>select</code>  XPath   ,     .       <code>MyItem</code> ,     <code>Name</code>   NAME    ,    .  ,       : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>&lt;xsl:value-of select="NAME"/&gt;</code> ,   <code>select</code>   XPath-  ,     .  ,    <code>xsl:value-of</code>   ,   <code>xsl:for-each</code> .   ,   <code>xsl:for-each</code>   ,    ,   <code>xsl:value-of</code> ‚Äì     (..    <code>xsl:for-each</code> ). <br>  ,   ,         . <br>  ,            <code>asx, sap, prg</code> (XSLT     ).       XML,  <code>xsl:transform</code>  : <br> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt;</code> <br> <br> ..     ,    <code>exclude-result-prefixes</code>  ,       XML. <br>        ,       <code>RF_CHILD_LIST</code> .        .   ‚Äì   . <br> ,    id   .    <code>ChilListID</code> .     . <br>      : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;/xsl:template&gt;</code> <br> <br> ..      <code>OutChilds</code>   <code>ChilListID</code> .  ,       XML-,    <code>/asx:abap/asx:heap</code> . <br> <br>       ?    item   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> .        <code>xsl:for-each</code> . <br>   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]"&gt;</code> <br>  XPath ,        <code>prg:T_DEEP_STRUCT</code> ,    <code>id</code>   <code>ChilListID</code> . <br>        item: <code>&lt;xsl:for-each select="item"&gt;</code> <br> <br> ,        ,   ,    , XSLT  .     : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt;</code> <br> <br>   <code>MyItem</code>   <code>Name</code> .    : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>      .    :      . <br>     <code>xsl:apply-templates</code> ,     <code>select</code>     XML      . <br>  ,  ,       <code>ChilListID</code> . ,      ,    <code>RF_CHILD_LIST</code>  <code>href,</code>    <code>#id___</code> . ..     <code>href</code>     ,    .     XPath  : <code>substring(RF_CHILD_LIST/@href,2)</code> . ..     : <br> <code class="xml"> &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt;</code> <br> <br>  ,     : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>  ,  ,     ,    . <br> <br> <b class="spoiler_title"> ,      :</b> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;!--       , .   --&gt; &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;!--         XML --&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;!--  NAMR  --&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--      ,        --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt; &lt;!--     --&gt; &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;!--   --&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;!--  , id    ,   --&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--    --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> <br> <b class="spoiler_title">  ABAP-</b> <code class="bash">REPORT zedu_test_xslt_deep_transform. *      "   " TYPES : BEGIN OF tdeep_struct , name TYPE string , rf_child_list TYPE REF TO data , END OF tdeep_struct *       "   " , t_deep_struct TYPE STANDARD TABLE OF tdeep_struct WITH NON-UNIQUE DEFAULT KEY . DATA : gt_tree TYPE t_deep_struct "  , gtree TYPE tdeep_struct "       , gchild TYPE tdeep_struct "       , ggrandchild TYPE tdeep_struct "       , gxml_str TYPE string "  XML , go_xml_doc TYPE REF TO cl_xml_document "    XML . FIELD-SYMBOLS : &lt;gt_child_list&gt; TYPE t_deep_struct "    , &lt;gt_grandchild_list&gt; TYPE t_deep_struct "    . START-OF-SELECTION. *    gtree-name = 'GrandParent1'. CREATE DATA gtree-rf_child_list TYPE t_deep_struct. ASSIGN gtree-rf_child_list-&gt;* TO &lt;gt_child_list&gt;. gchild-name = 'Child1'. APPEND gchild TO &lt;gt_child_list&gt;. gchild-name = 'Child2'. CREATE DATA gchild-rf_child_list TYPE t_deep_struct. ASSIGN gchild-rf_child_list-&gt;* TO &lt;gt_grandchild_list&gt;. ggrandchild-name = 'GrandChild1'. APPEND ggrandchild TO &lt;gt_grandchild_list&gt;. APPEND gchild TO &lt;gt_child_list&gt;. APPEND gtree TO gt_tree. CLEAR gtree. gtree-name = 'GrandParent2'. APPEND gtree TO gt_tree. * XSLT- CALL TRANSFORMATION zedu_test_xslt_deep_transform2 SOURCE table = gt_tree RESULT XML gxml_str. *    XML CREATE OBJECT go_xml_doc. go_xml_doc-&gt;parse_string( gxml_str ). go_xml_doc-&gt;display( ).</code> <br> <br> <br>  <br>  ,      XSLT  ? <br> <br>   <br> <a href="http://help.sap.com/abapdocu_70/en/ABAPCALL_TRANSFORMATION.htm"> ABAP</a> <a href="http://msdn.microsoft.com/ru-ru/library/ms256069%2528v%3Dvs.110%2529.aspx">MSDN:   XSLT</a> <a href="http://zvon.org/comp/r/tut-XPath_1.html">XPath tutorial</a> <a href="http://www.w3.org/TR/xslt"> XSLT</a></code></code></code> <code><code><code>,         .           . ..      RF_CHILD_LIST</code> ,      DATA ( <code>TYPE REF TO DATA</code> ),      ,     <code>href</code>     ,    . <br> ,     <code>&lt;RF_CHILD_LIST href="#d1" /&gt;</code> ,   <code>#</code> -       <a href="http://ru.wikipedia.org/wiki/XLink">XLink</a> ,  <code>d1</code> ‚Äì  .         XML-: <code>asx:heap</code>  ,   <code>id</code>  d1.    &lt; <code>prg:T_DEEP_STRUCT id="d1" ‚Ä¶ &gt;</code> .      ,         . <br> ..,    XML   ,  . <br> <br>  XSLT- ? <br>     XSLT-. <br>  SAP      STRANS. <br> <img src="//habrastorage.org/files/9e2/1a4/62a/9e21a462a5794b7b820619abc4edb1ec.jpg"> <br>   ,  ¬´¬ª(F5). <br> <img src="//habrastorage.org/files/f25/1a9/ff3/f251a9ff31c7413f96bf83dc1ee3a4e6.jpg"> <br>   ‚Äì  ,       (   ‚Äì XSLT).  Enter. <br> <br>         XSLT,        .  ,        ,    ‚Äì  . <br> <br>        , ..,   ,         (   ,    , ,   html ). <br> <br>    ,       , ..    .      <br> <code class="xml">&lt;xsl:transform version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;xsl:template match="/"&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> : <br> <code>xmlns:xsl</code> ,       xsl. ..       ,       <code>xsl</code> : ( <code>&lt;xsl:strip-space elements="*"/&gt;</code> ) <code>xmlns:sap</code> ,       sap <code>xsl:transform</code> ,     XSLT- <code>&lt;xsl:strip-space elements="*"/&gt;</code>      <code>&lt;xsl:template match="/"&gt;</code>   ,       XML  <br> <br> XSLT-      ( <code>xsl:template</code> )     XML-,      <code>match</code> .   <code>match</code>      <a href="http://ru.wikipedia.org/wiki/XPath">XPath</a> .    ,     ¬´/¬ª,      XML- <code>TABLE</code>    "/asx:abap/asx:values/TABLE" (..    XML-   ( <code>asx:abap</code> )    ( <code>TABLE</code> )). <br> <br>  ,      XML- List.   : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>item</code>   <code>TABLE</code>   XML ,      <code>&lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt;</code> ,    <code>select</code>  XPath   ,     .       <code>MyItem</code> ,     <code>Name</code>   NAME    ,    .  ,       : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>&lt;xsl:value-of select="NAME"/&gt;</code> ,   <code>select</code>   XPath-  ,     .  ,    <code>xsl:value-of</code>   ,   <code>xsl:for-each</code> .   ,   <code>xsl:for-each</code>   ,    ,   <code>xsl:value-of</code> ‚Äì     (..    <code>xsl:for-each</code> ). <br>  ,   ,         . <br>  ,            <code>asx, sap, prg</code> (XSLT     ).       XML,  <code>xsl:transform</code>  : <br> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt;</code> <br> <br> ..     ,    <code>exclude-result-prefixes</code>  ,       XML. <br>        ,       <code>RF_CHILD_LIST</code> .        .   ‚Äì   . <br> ,    id   .    <code>ChilListID</code> .     . <br>      : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;/xsl:template&gt;</code> <br> <br> ..      <code>OutChilds</code>   <code>ChilListID</code> .  ,       XML-,    <code>/asx:abap/asx:heap</code> . <br> <br>       ?    item   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> .        <code>xsl:for-each</code> . <br>   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]"&gt;</code> <br>  XPath ,        <code>prg:T_DEEP_STRUCT</code> ,    <code>id</code>   <code>ChilListID</code> . <br>        item: <code>&lt;xsl:for-each select="item"&gt;</code> <br> <br> ,        ,   ,    , XSLT  .     : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt;</code> <br> <br>   <code>MyItem</code>   <code>Name</code> .    : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>      .    :      . <br>     <code>xsl:apply-templates</code> ,     <code>select</code>     XML      . <br>  ,  ,       <code>ChilListID</code> . ,      ,    <code>RF_CHILD_LIST</code>  <code>href,</code>    <code>#id___</code> . ..     <code>href</code>     ,    .     XPath  : <code>substring(RF_CHILD_LIST/@href,2)</code> . ..     : <br> <code class="xml"> &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt;</code> <br> <br>  ,     : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>  ,  ,     ,    . <br> <br> <b class="spoiler_title"> ,      :</b> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;!--       , .   --&gt; &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;!--         XML --&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;!--  NAMR  --&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--      ,        --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt; &lt;!--     --&gt; &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;!--   --&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;!--  , id    ,   --&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--    --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> <br> <b class="spoiler_title">  ABAP-</b> <code class="bash">REPORT zedu_test_xslt_deep_transform. *      "   " TYPES : BEGIN OF tdeep_struct , name TYPE string , rf_child_list TYPE REF TO data , END OF tdeep_struct *       "   " , t_deep_struct TYPE STANDARD TABLE OF tdeep_struct WITH NON-UNIQUE DEFAULT KEY . DATA : gt_tree TYPE t_deep_struct "  , gtree TYPE tdeep_struct "       , gchild TYPE tdeep_struct "       , ggrandchild TYPE tdeep_struct "       , gxml_str TYPE string "  XML , go_xml_doc TYPE REF TO cl_xml_document "    XML . FIELD-SYMBOLS : &lt;gt_child_list&gt; TYPE t_deep_struct "    , &lt;gt_grandchild_list&gt; TYPE t_deep_struct "    . START-OF-SELECTION. *    gtree-name = 'GrandParent1'. CREATE DATA gtree-rf_child_list TYPE t_deep_struct. ASSIGN gtree-rf_child_list-&gt;* TO &lt;gt_child_list&gt;. gchild-name = 'Child1'. APPEND gchild TO &lt;gt_child_list&gt;. gchild-name = 'Child2'. CREATE DATA gchild-rf_child_list TYPE t_deep_struct. ASSIGN gchild-rf_child_list-&gt;* TO &lt;gt_grandchild_list&gt;. ggrandchild-name = 'GrandChild1'. APPEND ggrandchild TO &lt;gt_grandchild_list&gt;. APPEND gchild TO &lt;gt_child_list&gt;. APPEND gtree TO gt_tree. CLEAR gtree. gtree-name = 'GrandParent2'. APPEND gtree TO gt_tree. * XSLT- CALL TRANSFORMATION zedu_test_xslt_deep_transform2 SOURCE table = gt_tree RESULT XML gxml_str. *    XML CREATE OBJECT go_xml_doc. go_xml_doc-&gt;parse_string( gxml_str ). go_xml_doc-&gt;display( ).</code> <br> <br> <br>  <br>  ,      XSLT  ? <br> <br>   <br> <a href="http://help.sap.com/abapdocu_70/en/ABAPCALL_TRANSFORMATION.htm"> ABAP</a> <a href="http://msdn.microsoft.com/ru-ru/library/ms256069%2528v%3Dvs.110%2529.aspx">MSDN:   XSLT</a> <a href="http://zvon.org/comp/r/tut-XPath_1.html">XPath tutorial</a> <a href="http://www.w3.org/TR/xslt"> XSLT</a></code></code> <h5> <code><code><code>,         .           . ..      RF_CHILD_LIST</code> ,      DATA ( <code>TYPE REF TO DATA</code> ),      ,     <code>href</code>     ,    . <br> ,     <code>&lt;RF_CHILD_LIST href="#d1" /&gt;</code> ,   <code>#</code> -       <a href="http://ru.wikipedia.org/wiki/XLink">XLink</a> ,  <code>d1</code> ‚Äì  .         XML-: <code>asx:heap</code>  ,   <code>id</code>  d1.    &lt; <code>prg:T_DEEP_STRUCT id="d1" ‚Ä¶ &gt;</code> .      ,         . <br> ..,    XML   ,  . <br> <br>  XSLT- ? <br>     XSLT-. <br>  SAP      STRANS. <br> <img src="//habrastorage.org/files/9e2/1a4/62a/9e21a462a5794b7b820619abc4edb1ec.jpg"> <br>   ,  ¬´¬ª(F5). <br> <img src="//habrastorage.org/files/f25/1a9/ff3/f251a9ff31c7413f96bf83dc1ee3a4e6.jpg"> <br>   ‚Äì  ,       (   ‚Äì XSLT).  Enter. <br> <br>         XSLT,        .  ,        ,    ‚Äì  . <br> <br>        , ..,   ,         (   ,    , ,   html ). <br> <br>    ,       , ..    .      <br> <code class="xml">&lt;xsl:transform version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;xsl:template match="/"&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> : <br> <code>xmlns:xsl</code> ,       xsl. ..       ,       <code>xsl</code> : ( <code>&lt;xsl:strip-space elements="*"/&gt;</code> ) <code>xmlns:sap</code> ,       sap <code>xsl:transform</code> ,     XSLT- <code>&lt;xsl:strip-space elements="*"/&gt;</code>      <code>&lt;xsl:template match="/"&gt;</code>   ,       XML  <br> <br> XSLT-      ( <code>xsl:template</code> )     XML-,      <code>match</code> .   <code>match</code>      <a href="http://ru.wikipedia.org/wiki/XPath">XPath</a> .    ,     ¬´/¬ª,      XML- <code>TABLE</code>    "/asx:abap/asx:values/TABLE" (..    XML-   ( <code>asx:abap</code> )    ( <code>TABLE</code> )). <br> <br>  ,      XML- List.   : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>item</code>   <code>TABLE</code>   XML ,      <code>&lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt;</code> ,    <code>select</code>  XPath   ,     .       <code>MyItem</code> ,     <code>Name</code>   NAME    ,    .  ,       : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>&lt;xsl:value-of select="NAME"/&gt;</code> ,   <code>select</code>   XPath-  ,     .  ,    <code>xsl:value-of</code>   ,   <code>xsl:for-each</code> .   ,   <code>xsl:for-each</code>   ,    ,   <code>xsl:value-of</code> ‚Äì     (..    <code>xsl:for-each</code> ). <br>  ,   ,         . <br>  ,            <code>asx, sap, prg</code> (XSLT     ).       XML,  <code>xsl:transform</code>  : <br> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt;</code> <br> <br> ..     ,    <code>exclude-result-prefixes</code>  ,       XML. <br>        ,       <code>RF_CHILD_LIST</code> .        .   ‚Äì   . <br> ,    id   .    <code>ChilListID</code> .     . <br>      : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;/xsl:template&gt;</code> <br> <br> ..      <code>OutChilds</code>   <code>ChilListID</code> .  ,       XML-,    <code>/asx:abap/asx:heap</code> . <br> <br>       ?    item   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> .        <code>xsl:for-each</code> . <br>   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]"&gt;</code> <br>  XPath ,        <code>prg:T_DEEP_STRUCT</code> ,    <code>id</code>   <code>ChilListID</code> . <br>        item: <code>&lt;xsl:for-each select="item"&gt;</code> <br> <br> ,        ,   ,    , XSLT  .     : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt;</code> <br> <br>   <code>MyItem</code>   <code>Name</code> .    : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>      .    :      . <br>     <code>xsl:apply-templates</code> ,     <code>select</code>     XML      . <br>  ,  ,       <code>ChilListID</code> . ,      ,    <code>RF_CHILD_LIST</code>  <code>href,</code>    <code>#id___</code> . ..     <code>href</code>     ,    .     XPath  : <code>substring(RF_CHILD_LIST/@href,2)</code> . ..     : <br> <code class="xml"> &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt;</code> <br> <br>  ,     : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>  ,  ,     ,    . <br> <br> <b class="spoiler_title"> ,      :</b> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;!--       , .   --&gt; &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;!--         XML --&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;!--  NAMR  --&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--      ,        --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt; &lt;!--     --&gt; &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;!--   --&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;!--  , id    ,   --&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--    --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> <br> <b class="spoiler_title">  ABAP-</b> <code class="bash">REPORT zedu_test_xslt_deep_transform. *      "   " TYPES : BEGIN OF tdeep_struct , name TYPE string , rf_child_list TYPE REF TO data , END OF tdeep_struct *       "   " , t_deep_struct TYPE STANDARD TABLE OF tdeep_struct WITH NON-UNIQUE DEFAULT KEY . DATA : gt_tree TYPE t_deep_struct "  , gtree TYPE tdeep_struct "       , gchild TYPE tdeep_struct "       , ggrandchild TYPE tdeep_struct "       , gxml_str TYPE string "  XML , go_xml_doc TYPE REF TO cl_xml_document "    XML . FIELD-SYMBOLS : &lt;gt_child_list&gt; TYPE t_deep_struct "    , &lt;gt_grandchild_list&gt; TYPE t_deep_struct "    . START-OF-SELECTION. *    gtree-name = 'GrandParent1'. CREATE DATA gtree-rf_child_list TYPE t_deep_struct. ASSIGN gtree-rf_child_list-&gt;* TO &lt;gt_child_list&gt;. gchild-name = 'Child1'. APPEND gchild TO &lt;gt_child_list&gt;. gchild-name = 'Child2'. CREATE DATA gchild-rf_child_list TYPE t_deep_struct. ASSIGN gchild-rf_child_list-&gt;* TO &lt;gt_grandchild_list&gt;. ggrandchild-name = 'GrandChild1'. APPEND ggrandchild TO &lt;gt_grandchild_list&gt;. APPEND gchild TO &lt;gt_child_list&gt;. APPEND gtree TO gt_tree. CLEAR gtree. gtree-name = 'GrandParent2'. APPEND gtree TO gt_tree. * XSLT- CALL TRANSFORMATION zedu_test_xslt_deep_transform2 SOURCE table = gt_tree RESULT XML gxml_str. *    XML CREATE OBJECT go_xml_doc. go_xml_doc-&gt;parse_string( gxml_str ). go_xml_doc-&gt;display( ).</code> <br> <br> <br>  <br>  ,      XSLT  ? <br> <br>   <br> <a href="http://help.sap.com/abapdocu_70/en/ABAPCALL_TRANSFORMATION.htm"> ABAP</a> <a href="http://msdn.microsoft.com/ru-ru/library/ms256069%2528v%3Dvs.110%2529.aspx">MSDN:   XSLT</a> <a href="http://zvon.org/comp/r/tut-XPath_1.html">XPath tutorial</a> <a href="http://www.w3.org/TR/xslt"> XSLT</a></code></code> </h5> <code><code><code>,         .           . ..      RF_CHILD_LIST</code> ,      DATA ( <code>TYPE REF TO DATA</code> ),      ,     <code>href</code>     ,    . <br> ,     <code>&lt;RF_CHILD_LIST href="#d1" /&gt;</code> ,   <code>#</code> -       <a href="http://ru.wikipedia.org/wiki/XLink">XLink</a> ,  <code>d1</code> ‚Äì  .         XML-: <code>asx:heap</code>  ,   <code>id</code>  d1.    &lt; <code>prg:T_DEEP_STRUCT id="d1" ‚Ä¶ &gt;</code> .      ,         . <br> ..,    XML   ,  . <br> <br>  XSLT- ? <br>     XSLT-. <br>  SAP      STRANS. <br> <img src="//habrastorage.org/files/9e2/1a4/62a/9e21a462a5794b7b820619abc4edb1ec.jpg"> <br>   ,  ¬´¬ª(F5). <br> <img src="//habrastorage.org/files/f25/1a9/ff3/f251a9ff31c7413f96bf83dc1ee3a4e6.jpg"> <br>   ‚Äì  ,       (   ‚Äì XSLT).  Enter. <br> <br>         XSLT,        .  ,        ,    ‚Äì  . <br> <br>        , ..,   ,         (   ,    , ,   html ). <br> <br>    ,       , ..    .      <br> <code class="xml">&lt;xsl:transform version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;xsl:template match="/"&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> : <br> <code>xmlns:xsl</code> ,       xsl. ..       ,       <code>xsl</code> : ( <code>&lt;xsl:strip-space elements="*"/&gt;</code> ) <code>xmlns:sap</code> ,       sap <code>xsl:transform</code> ,     XSLT- <code>&lt;xsl:strip-space elements="*"/&gt;</code>      <code>&lt;xsl:template match="/"&gt;</code>   ,       XML  <br> <br> XSLT-      ( <code>xsl:template</code> )     XML-,      <code>match</code> .   <code>match</code>      <a href="http://ru.wikipedia.org/wiki/XPath">XPath</a> .    ,     ¬´/¬ª,      XML- <code>TABLE</code>    "/asx:abap/asx:values/TABLE" (..    XML-   ( <code>asx:abap</code> )    ( <code>TABLE</code> )). <br> <br>  ,      XML- List.   : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>item</code>   <code>TABLE</code>   XML ,      <code>&lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt;</code> ,    <code>select</code>  XPath   ,     .       <code>MyItem</code> ,     <code>Name</code>   NAME    ,    .  ,       : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>&lt;xsl:value-of select="NAME"/&gt;</code> ,   <code>select</code>   XPath-  ,     .  ,    <code>xsl:value-of</code>   ,   <code>xsl:for-each</code> .   ,   <code>xsl:for-each</code>   ,    ,   <code>xsl:value-of</code> ‚Äì     (..    <code>xsl:for-each</code> ). <br>  ,   ,         . <br>  ,            <code>asx, sap, prg</code> (XSLT     ).       XML,  <code>xsl:transform</code>  : <br> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt;</code> <br> <br> ..     ,    <code>exclude-result-prefixes</code>  ,       XML. <br>        ,       <code>RF_CHILD_LIST</code> .        .   ‚Äì   . <br> ,    id   .    <code>ChilListID</code> .     . <br>      : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;/xsl:template&gt;</code> <br> <br> ..      <code>OutChilds</code>   <code>ChilListID</code> .  ,       XML-,    <code>/asx:abap/asx:heap</code> . <br> <br>       ?    item   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> .        <code>xsl:for-each</code> . <br>   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]"&gt;</code> <br>  XPath ,        <code>prg:T_DEEP_STRUCT</code> ,    <code>id</code>   <code>ChilListID</code> . <br>        item: <code>&lt;xsl:for-each select="item"&gt;</code> <br> <br> ,        ,   ,    , XSLT  .     : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt;</code> <br> <br>   <code>MyItem</code>   <code>Name</code> .    : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>      .    :      . <br>     <code>xsl:apply-templates</code> ,     <code>select</code>     XML      . <br>  ,  ,       <code>ChilListID</code> . ,      ,    <code>RF_CHILD_LIST</code>  <code>href,</code>    <code>#id___</code> . ..     <code>href</code>     ,    .     XPath  : <code>substring(RF_CHILD_LIST/@href,2)</code> . ..     : <br> <code class="xml"> &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt;</code> <br> <br>  ,     : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>  ,  ,     ,    . <br> <br> <b class="spoiler_title"> ,      :</b> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;!--       , .   --&gt; &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;!--         XML --&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;!--  NAMR  --&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--      ,        --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt; &lt;!--     --&gt; &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;!--   --&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;!--  , id    ,   --&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--    --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> <br> <b class="spoiler_title">  ABAP-</b> <code class="bash">REPORT zedu_test_xslt_deep_transform. *      "   " TYPES : BEGIN OF tdeep_struct , name TYPE string , rf_child_list TYPE REF TO data , END OF tdeep_struct *       "   " , t_deep_struct TYPE STANDARD TABLE OF tdeep_struct WITH NON-UNIQUE DEFAULT KEY . DATA : gt_tree TYPE t_deep_struct "  , gtree TYPE tdeep_struct "       , gchild TYPE tdeep_struct "       , ggrandchild TYPE tdeep_struct "       , gxml_str TYPE string "  XML , go_xml_doc TYPE REF TO cl_xml_document "    XML . FIELD-SYMBOLS : &lt;gt_child_list&gt; TYPE t_deep_struct "    , &lt;gt_grandchild_list&gt; TYPE t_deep_struct "    . START-OF-SELECTION. *    gtree-name = 'GrandParent1'. CREATE DATA gtree-rf_child_list TYPE t_deep_struct. ASSIGN gtree-rf_child_list-&gt;* TO &lt;gt_child_list&gt;. gchild-name = 'Child1'. APPEND gchild TO &lt;gt_child_list&gt;. gchild-name = 'Child2'. CREATE DATA gchild-rf_child_list TYPE t_deep_struct. ASSIGN gchild-rf_child_list-&gt;* TO &lt;gt_grandchild_list&gt;. ggrandchild-name = 'GrandChild1'. APPEND ggrandchild TO &lt;gt_grandchild_list&gt;. APPEND gchild TO &lt;gt_child_list&gt;. APPEND gtree TO gt_tree. CLEAR gtree. gtree-name = 'GrandParent2'. APPEND gtree TO gt_tree. * XSLT- CALL TRANSFORMATION zedu_test_xslt_deep_transform2 SOURCE table = gt_tree RESULT XML gxml_str. *    XML CREATE OBJECT go_xml_doc. go_xml_doc-&gt;parse_string( gxml_str ). go_xml_doc-&gt;display( ).</code> <br> <br> <br>  <br>  ,      XSLT  ? <br> <br>   <br> <a href="http://help.sap.com/abapdocu_70/en/ABAPCALL_TRANSFORMATION.htm"> ABAP</a> <a href="http://msdn.microsoft.com/ru-ru/library/ms256069%2528v%3Dvs.110%2529.aspx">MSDN:   XSLT</a> <a href="http://zvon.org/comp/r/tut-XPath_1.html">XPath tutorial</a> <a href="http://www.w3.org/TR/xslt"> XSLT</a></code></code> <pre> <code class="hljs xml"><code><code>,         .           . ..      RF_CHILD_LIST</code> ,      DATA ( <code>TYPE REF TO DATA</code> ),      ,     <code>href</code>     ,    . <br> ,     <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RF_CHILD_LIST</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#d1"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> ,   <code>#</code> -       <a href="http://ru.wikipedia.org/wiki/XLink">XLink</a> ,  <code>d1</code> ‚Äì  .         XML-: <code>asx:heap</code>  ,   <code>id</code>  d1.    <span class="hljs-tag"><span class="hljs-tag">&lt; </span></span><code><span class="hljs-tag"><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">prg:T_DEEP_STRUCT</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"d1"</span></span></span><span class="hljs-tag"> ‚Ä¶ &gt;</span></span></code> .      ,         . <br> ..,    XML   ,  . <br> <br>  XSLT- ? <br>     XSLT-. <br>  SAP      STRANS. <br> <img src="//habrastorage.org/files/9e2/1a4/62a/9e21a462a5794b7b820619abc4edb1ec.jpg"> <br>   ,  ¬´¬ª(F5). <br> <img src="//habrastorage.org/files/f25/1a9/ff3/f251a9ff31c7413f96bf83dc1ee3a4e6.jpg"> <br>   ‚Äì  ,       (   ‚Äì XSLT).  Enter. <br> <br>         XSLT,        .  ,        ,    ‚Äì  . <br> <br>        , ..,   ,         (   ,    , ,   html ). <br> <br>    ,       , ..    .      <br> <code class="xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsl</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/1999/XSL/Transform"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:sap</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/sapxsl"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:strip-space</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">elements</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> : <br> <code>xmlns:xsl</code> ,       xsl. ..       ,       <code>xsl</code> : ( <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:strip-space</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">elements</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> ) <code>xmlns:sap</code> ,       sap <code>xsl:transform</code> ,     XSLT- <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:strip-space</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">elements</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag">/&gt;</span></span></code>      <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span></code>   ,       XML  <br> <br> XSLT-      ( <code>xsl:template</code> )     XML-,      <code>match</code> .   <code>match</code>      <a href="http://ru.wikipedia.org/wiki/XPath">XPath</a> .    ,     ¬´/¬ª,      XML- <code>TABLE</code>    "/asx:abap/asx:values/TABLE" (..    XML-   ( <code>asx:abap</code> )    ( <code>TABLE</code> )). <br> <br>  ,      XML- List.   : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>        <code>item</code>   <code>TABLE</code>   XML ,      <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:values/TABLE/item"</span></span></span><span class="hljs-tag">&gt;</span></span></code> ,    <code>select</code>  XPath   ,     .       <code>MyItem</code> ,     <code>Name</code>   NAME    ,    .  ,       : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:values/TABLE/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>        <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> ,   <code>select</code>   XPath-  ,     .  ,    <code>xsl:value-of</code>   ,   <code>xsl:for-each</code> .   ,   <code>xsl:for-each</code>   ,    ,   <code>xsl:value-of</code> ‚Äì     (..    <code>xsl:for-each</code> ). <br>  ,   ,         . <br>  ,            <code>asx, sap, prg</code> (XSLT     ).       XML,  <code>xsl:transform</code>  : <br> <code class="xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsl</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/1999/XSL/Transform"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:sap</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/sapxsl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:asx</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/abapxml"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:prg</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">exclude-result-prefixes</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"asx sap prg"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> ..     ,    <code>exclude-result-prefixes</code>  ,       XML. <br>        ,       <code>RF_CHILD_LIST</code> .        .   ‚Äì   . <br> ,    id   .    <code>ChilListID</code> .     . <br>      : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"OutChilds"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> ..      <code>OutChilds</code>   <code>ChilListID</code> .  ,       XML-,    <code>/asx:abap/asx:heap</code> . <br> <br>       ?    item   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> .        <code>xsl:for-each</code> . <br>   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> : <br> <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]"</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br>  XPath ,        <code>prg:T_DEEP_STRUCT</code> ,    <code>id</code>   <code>ChilListID</code> . <br>        item: <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"item"</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> ,        ,   ,    , XSLT  .     : <br> <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]/item"</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>   <code>MyItem</code>   <code>Name</code> .    : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"OutChilds"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>      .    :      . <br>     <code>xsl:apply-templates</code> ,     <code>select</code>     XML      . <br>  ,  ,       <code>ChilListID</code> . ,      ,    <code>RF_CHILD_LIST</code>  <code>href,</code>    <code>#id___</code> . ..     <code>href</code>     ,    .     XPath  : <code>substring(RF_CHILD_LIST/@href,2)</code> . ..     : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:with-param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"substring(RF_CHILD_LIST/@href,2)"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>  ,     : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"OutChilds"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:with-param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"substring(RF_CHILD_LIST/@href,2)"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>  ,  ,     ,    . <br> <br> <b class="spoiler_title"> ,      :</b> <code class="xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsl</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/1999/XSL/Transform"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:sap</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/sapxsl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:asx</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/abapxml"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:prg</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">exclude-result-prefixes</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"asx sap prg"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:strip-space</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">elements</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--       , .   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--         XML --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:values/TABLE/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  NAMR  --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--      ,        --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:with-param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"substring(RF_CHILD_LIST/@href,2)"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--     --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"OutChilds"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  , id    ,   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--    --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:with-param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"substring(RF_CHILD_LIST/@href,2)"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> <br> <b class="spoiler_title">  ABAP-</b> <code class="bash">REPORT zedu_test_xslt_deep_transform. *      "   " TYPES : BEGIN OF tdeep_struct , name TYPE string , rf_child_list TYPE REF TO data , END OF tdeep_struct *       "   " , t_deep_struct TYPE STANDARD TABLE OF tdeep_struct WITH NON-UNIQUE DEFAULT KEY . DATA : gt_tree TYPE t_deep_struct "  , gtree TYPE tdeep_struct "       , gchild TYPE tdeep_struct "       , ggrandchild TYPE tdeep_struct "       , gxml_str TYPE string "  XML , go_xml_doc TYPE REF TO cl_xml_document "    XML . FIELD-SYMBOLS : <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_child_list</span></span></span><span class="hljs-tag">&gt;</span></span> TYPE t_deep_struct "    , <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_grandchild_list</span></span></span><span class="hljs-tag">&gt;</span></span> TYPE t_deep_struct "    . START-OF-SELECTION. *    gtree-name = 'GrandParent1'. CREATE DATA gtree-rf_child_list TYPE t_deep_struct. ASSIGN gtree-rf_child_list-&gt;* TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_child_list</span></span></span><span class="hljs-tag">&gt;</span></span>. gchild-name = 'Child1'. APPEND gchild TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_child_list</span></span></span><span class="hljs-tag">&gt;</span></span>. gchild-name = 'Child2'. CREATE DATA gchild-rf_child_list TYPE t_deep_struct. ASSIGN gchild-rf_child_list-&gt;* TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_grandchild_list</span></span></span><span class="hljs-tag">&gt;</span></span>. ggrandchild-name = 'GrandChild1'. APPEND ggrandchild TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_grandchild_list</span></span></span><span class="hljs-tag">&gt;</span></span>. APPEND gchild TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_child_list</span></span></span><span class="hljs-tag">&gt;</span></span>. APPEND gtree TO gt_tree. CLEAR gtree. gtree-name = 'GrandParent2'. APPEND gtree TO gt_tree. * XSLT- CALL TRANSFORMATION zedu_test_xslt_deep_transform2 SOURCE table = gt_tree RESULT XML gxml_str. *    XML CREATE OBJECT go_xml_doc. go_xml_doc-&gt;parse_string( gxml_str ). go_xml_doc-&gt;display( ).</code> <br> <br> <br>  <br>  ,      XSLT  ? <br> <br>   <br> <a href="http://help.sap.com/abapdocu_70/en/ABAPCALL_TRANSFORMATION.htm"> ABAP</a> <a href="http://msdn.microsoft.com/ru-ru/library/ms256069%2528v%3Dvs.110%2529.aspx">MSDN:   XSLT</a> <a href="http://zvon.org/comp/r/tut-XPath_1.html">XPath tutorial</a> <a href="http://www.w3.org/TR/xslt"> XSLT</a></code></code> </pre> <code><code><code>,         .           . ..      RF_CHILD_LIST</code> ,      DATA ( <code>TYPE REF TO DATA</code> ),      ,     <code>href</code>     ,    . <br> ,     <code>&lt;RF_CHILD_LIST href="#d1" /&gt;</code> ,   <code>#</code> -       <a href="http://ru.wikipedia.org/wiki/XLink">XLink</a> ,  <code>d1</code> ‚Äì  .         XML-: <code>asx:heap</code>  ,   <code>id</code>  d1.    &lt; <code>prg:T_DEEP_STRUCT id="d1" ‚Ä¶ &gt;</code> .      ,         . <br> ..,    XML   ,  . <br> <br>  XSLT- ? <br>     XSLT-. <br>  SAP      STRANS. <br> <img src="//habrastorage.org/files/9e2/1a4/62a/9e21a462a5794b7b820619abc4edb1ec.jpg"> <br>   ,  ¬´¬ª(F5). <br> <img src="//habrastorage.org/files/f25/1a9/ff3/f251a9ff31c7413f96bf83dc1ee3a4e6.jpg"> <br>   ‚Äì  ,       (   ‚Äì XSLT).  Enter. <br> <br>         XSLT,        .  ,        ,    ‚Äì  . <br> <br>        , ..,   ,         (   ,    , ,   html ). <br> <br>    ,       , ..    .      <br> <code class="xml">&lt;xsl:transform version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;xsl:template match="/"&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> : <br> <code>xmlns:xsl</code> ,       xsl. ..       ,       <code>xsl</code> : ( <code>&lt;xsl:strip-space elements="*"/&gt;</code> ) <code>xmlns:sap</code> ,       sap <code>xsl:transform</code> ,     XSLT- <code>&lt;xsl:strip-space elements="*"/&gt;</code>      <code>&lt;xsl:template match="/"&gt;</code>   ,       XML  <br> <br> XSLT-      ( <code>xsl:template</code> )     XML-,      <code>match</code> .   <code>match</code>      <a href="http://ru.wikipedia.org/wiki/XPath">XPath</a> .    ,     ¬´/¬ª,      XML- <code>TABLE</code>    "/asx:abap/asx:values/TABLE" (..    XML-   ( <code>asx:abap</code> )    ( <code>TABLE</code> )). <br> <br>  ,      XML- List.   : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>item</code>   <code>TABLE</code>   XML ,      <code>&lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt;</code> ,    <code>select</code>  XPath   ,     .       <code>MyItem</code> ,     <code>Name</code>   NAME    ,    .  ,       : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>&lt;xsl:value-of select="NAME"/&gt;</code> ,   <code>select</code>   XPath-  ,     .  ,    <code>xsl:value-of</code>   ,   <code>xsl:for-each</code> .   ,   <code>xsl:for-each</code>   ,    ,   <code>xsl:value-of</code> ‚Äì     (..    <code>xsl:for-each</code> ). <br>  ,   ,         . <br>  ,            <code>asx, sap, prg</code> (XSLT     ).       XML,  <code>xsl:transform</code>  : <br> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt;</code> <br> <br> ..     ,    <code>exclude-result-prefixes</code>  ,       XML. <br>        ,       <code>RF_CHILD_LIST</code> .        .   ‚Äì   . <br> ,    id   .    <code>ChilListID</code> .     . <br>      : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;/xsl:template&gt;</code> <br> <br> ..      <code>OutChilds</code>   <code>ChilListID</code> .  ,       XML-,    <code>/asx:abap/asx:heap</code> . <br> <br>       ?    item   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> .        <code>xsl:for-each</code> . <br>   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]"&gt;</code> <br>  XPath ,        <code>prg:T_DEEP_STRUCT</code> ,    <code>id</code>   <code>ChilListID</code> . <br>        item: <code>&lt;xsl:for-each select="item"&gt;</code> <br> <br> ,        ,   ,    , XSLT  .     : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt;</code> <br> <br>   <code>MyItem</code>   <code>Name</code> .    : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>      .    :      . <br>     <code>xsl:apply-templates</code> ,     <code>select</code>     XML      . <br>  ,  ,       <code>ChilListID</code> . ,      ,    <code>RF_CHILD_LIST</code>  <code>href,</code>    <code>#id___</code> . ..     <code>href</code>     ,    .     XPath  : <code>substring(RF_CHILD_LIST/@href,2)</code> . ..     : <br> <code class="xml"> &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt;</code> <br> <br>  ,     : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>  ,  ,     ,    . <br> <br> <b class="spoiler_title"> ,      :</b> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;!--       , .   --&gt; &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;!--         XML --&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;!--  NAMR  --&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--      ,        --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt; &lt;!--     --&gt; &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;!--   --&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;!--  , id    ,   --&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--    --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> <br> <b class="spoiler_title">  ABAP-</b> <code class="bash">REPORT zedu_test_xslt_deep_transform. *      "   " TYPES : BEGIN OF tdeep_struct , name TYPE string , rf_child_list TYPE REF TO data , END OF tdeep_struct *       "   " , t_deep_struct TYPE STANDARD TABLE OF tdeep_struct WITH NON-UNIQUE DEFAULT KEY . DATA : gt_tree TYPE t_deep_struct "  , gtree TYPE tdeep_struct "       , gchild TYPE tdeep_struct "       , ggrandchild TYPE tdeep_struct "       , gxml_str TYPE string "  XML , go_xml_doc TYPE REF TO cl_xml_document "    XML . FIELD-SYMBOLS : &lt;gt_child_list&gt; TYPE t_deep_struct "    , &lt;gt_grandchild_list&gt; TYPE t_deep_struct "    . START-OF-SELECTION. *    gtree-name = 'GrandParent1'. CREATE DATA gtree-rf_child_list TYPE t_deep_struct. ASSIGN gtree-rf_child_list-&gt;* TO &lt;gt_child_list&gt;. gchild-name = 'Child1'. APPEND gchild TO &lt;gt_child_list&gt;. gchild-name = 'Child2'. CREATE DATA gchild-rf_child_list TYPE t_deep_struct. ASSIGN gchild-rf_child_list-&gt;* TO &lt;gt_grandchild_list&gt;. ggrandchild-name = 'GrandChild1'. APPEND ggrandchild TO &lt;gt_grandchild_list&gt;. APPEND gchild TO &lt;gt_child_list&gt;. APPEND gtree TO gt_tree. CLEAR gtree. gtree-name = 'GrandParent2'. APPEND gtree TO gt_tree. * XSLT- CALL TRANSFORMATION zedu_test_xslt_deep_transform2 SOURCE table = gt_tree RESULT XML gxml_str. *    XML CREATE OBJECT go_xml_doc. go_xml_doc-&gt;parse_string( gxml_str ). go_xml_doc-&gt;display( ).</code> <br> <br> <br>  <br>  ,      XSLT  ? <br> <br>   <br> <a href="http://help.sap.com/abapdocu_70/en/ABAPCALL_TRANSFORMATION.htm"> ABAP</a> <a href="http://msdn.microsoft.com/ru-ru/library/ms256069%2528v%3Dvs.110%2529.aspx">MSDN:   XSLT</a> <a href="http://zvon.org/comp/r/tut-XPath_1.html">XPath tutorial</a> <a href="http://www.w3.org/TR/xslt"> XSLT</a></code></code> <ul><li> <code><code><code>,         .           . ..      RF_CHILD_LIST</code> ,      DATA ( <code>TYPE REF TO DATA</code> ),      ,     <code>href</code>     ,    . <br> ,     <code>&lt;RF_CHILD_LIST href="#d1" /&gt;</code> ,   <code>#</code> -       <a href="http://ru.wikipedia.org/wiki/XLink">XLink</a> ,  <code>d1</code> ‚Äì  .         XML-: <code>asx:heap</code>  ,   <code>id</code>  d1.    &lt; <code>prg:T_DEEP_STRUCT id="d1" ‚Ä¶ &gt;</code> .      ,         . <br> ..,    XML   ,  . <br> <br>  XSLT- ? <br>     XSLT-. <br>  SAP      STRANS. <br> <img src="//habrastorage.org/files/9e2/1a4/62a/9e21a462a5794b7b820619abc4edb1ec.jpg"> <br>   ,  ¬´¬ª(F5). <br> <img src="//habrastorage.org/files/f25/1a9/ff3/f251a9ff31c7413f96bf83dc1ee3a4e6.jpg"> <br>   ‚Äì  ,       (   ‚Äì XSLT).  Enter. <br> <br>         XSLT,        .  ,        ,    ‚Äì  . <br> <br>        , ..,   ,         (   ,    , ,   html ). <br> <br>    ,       , ..    .      <br> <code class="xml">&lt;xsl:transform version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;xsl:template match="/"&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> : <br> <code>xmlns:xsl</code> ,       xsl. ..       ,       <code>xsl</code> : ( <code>&lt;xsl:strip-space elements="*"/&gt;</code> ) <code>xmlns:sap</code> ,       sap <code>xsl:transform</code> ,     XSLT- <code>&lt;xsl:strip-space elements="*"/&gt;</code>      <code>&lt;xsl:template match="/"&gt;</code>   ,       XML  <br> <br> XSLT-      ( <code>xsl:template</code> )     XML-,      <code>match</code> .   <code>match</code>      <a href="http://ru.wikipedia.org/wiki/XPath">XPath</a> .    ,     ¬´/¬ª,      XML- <code>TABLE</code>    "/asx:abap/asx:values/TABLE" (..    XML-   ( <code>asx:abap</code> )    ( <code>TABLE</code> )). <br> <br>  ,      XML- List.   : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>item</code>   <code>TABLE</code>   XML ,      <code>&lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt;</code> ,    <code>select</code>  XPath   ,     .       <code>MyItem</code> ,     <code>Name</code>   NAME    ,    .  ,       : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>&lt;xsl:value-of select="NAME"/&gt;</code> ,   <code>select</code>   XPath-  ,     .  ,    <code>xsl:value-of</code>   ,   <code>xsl:for-each</code> .   ,   <code>xsl:for-each</code>   ,    ,   <code>xsl:value-of</code> ‚Äì     (..    <code>xsl:for-each</code> ). <br>  ,   ,         . <br>  ,            <code>asx, sap, prg</code> (XSLT     ).       XML,  <code>xsl:transform</code>  : <br> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt;</code> <br> <br> ..     ,    <code>exclude-result-prefixes</code>  ,       XML. <br>        ,       <code>RF_CHILD_LIST</code> .        .   ‚Äì   . <br> ,    id   .    <code>ChilListID</code> .     . <br>      : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;/xsl:template&gt;</code> <br> <br> ..      <code>OutChilds</code>   <code>ChilListID</code> .  ,       XML-,    <code>/asx:abap/asx:heap</code> . <br> <br>       ?    item   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> .        <code>xsl:for-each</code> . <br>   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]"&gt;</code> <br>  XPath ,        <code>prg:T_DEEP_STRUCT</code> ,    <code>id</code>   <code>ChilListID</code> . <br>        item: <code>&lt;xsl:for-each select="item"&gt;</code> <br> <br> ,        ,   ,    , XSLT  .     : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt;</code> <br> <br>   <code>MyItem</code>   <code>Name</code> .    : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>      .    :      . <br>     <code>xsl:apply-templates</code> ,     <code>select</code>     XML      . <br>  ,  ,       <code>ChilListID</code> . ,      ,    <code>RF_CHILD_LIST</code>  <code>href,</code>    <code>#id___</code> . ..     <code>href</code>     ,    .     XPath  : <code>substring(RF_CHILD_LIST/@href,2)</code> . ..     : <br> <code class="xml"> &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt;</code> <br> <br>  ,     : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>  ,  ,     ,    . <br> <br> <b class="spoiler_title"> ,      :</b> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;!--       , .   --&gt; &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;!--         XML --&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;!--  NAMR  --&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--      ,        --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt; &lt;!--     --&gt; &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;!--   --&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;!--  , id    ,   --&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--    --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> <br> <b class="spoiler_title">  ABAP-</b> <code class="bash">REPORT zedu_test_xslt_deep_transform. *      "   " TYPES : BEGIN OF tdeep_struct , name TYPE string , rf_child_list TYPE REF TO data , END OF tdeep_struct *       "   " , t_deep_struct TYPE STANDARD TABLE OF tdeep_struct WITH NON-UNIQUE DEFAULT KEY . DATA : gt_tree TYPE t_deep_struct "  , gtree TYPE tdeep_struct "       , gchild TYPE tdeep_struct "       , ggrandchild TYPE tdeep_struct "       , gxml_str TYPE string "  XML , go_xml_doc TYPE REF TO cl_xml_document "    XML . FIELD-SYMBOLS : &lt;gt_child_list&gt; TYPE t_deep_struct "    , &lt;gt_grandchild_list&gt; TYPE t_deep_struct "    . START-OF-SELECTION. *    gtree-name = 'GrandParent1'. CREATE DATA gtree-rf_child_list TYPE t_deep_struct. ASSIGN gtree-rf_child_list-&gt;* TO &lt;gt_child_list&gt;. gchild-name = 'Child1'. APPEND gchild TO &lt;gt_child_list&gt;. gchild-name = 'Child2'. CREATE DATA gchild-rf_child_list TYPE t_deep_struct. ASSIGN gchild-rf_child_list-&gt;* TO &lt;gt_grandchild_list&gt;. ggrandchild-name = 'GrandChild1'. APPEND ggrandchild TO &lt;gt_grandchild_list&gt;. APPEND gchild TO &lt;gt_child_list&gt;. APPEND gtree TO gt_tree. CLEAR gtree. gtree-name = 'GrandParent2'. APPEND gtree TO gt_tree. * XSLT- CALL TRANSFORMATION zedu_test_xslt_deep_transform2 SOURCE table = gt_tree RESULT XML gxml_str. *    XML CREATE OBJECT go_xml_doc. go_xml_doc-&gt;parse_string( gxml_str ). go_xml_doc-&gt;display( ).</code> <br> <br> <br>  <br>  ,      XSLT  ? <br> <br>   <br> <a href="http://help.sap.com/abapdocu_70/en/ABAPCALL_TRANSFORMATION.htm"> ABAP</a> <a href="http://msdn.microsoft.com/ru-ru/library/ms256069%2528v%3Dvs.110%2529.aspx">MSDN:   XSLT</a> <a href="http://zvon.org/comp/r/tut-XPath_1.html">XPath tutorial</a> <a href="http://www.w3.org/TR/xslt"> XSLT</a></code></code> </li> <li> <code><code><code>,         .           . ..      RF_CHILD_LIST</code> ,      DATA ( <code>TYPE REF TO DATA</code> ),      ,     <code>href</code>     ,    . <br> ,     <code>&lt;RF_CHILD_LIST href="#d1" /&gt;</code> ,   <code>#</code> -       <a href="http://ru.wikipedia.org/wiki/XLink">XLink</a> ,  <code>d1</code> ‚Äì  .         XML-: <code>asx:heap</code>  ,   <code>id</code>  d1.    &lt; <code>prg:T_DEEP_STRUCT id="d1" ‚Ä¶ &gt;</code> .      ,         . <br> ..,    XML   ,  . <br> <br>  XSLT- ? <br>     XSLT-. <br>  SAP      STRANS. <br> <img src="//habrastorage.org/files/9e2/1a4/62a/9e21a462a5794b7b820619abc4edb1ec.jpg"> <br>   ,  ¬´¬ª(F5). <br> <img src="//habrastorage.org/files/f25/1a9/ff3/f251a9ff31c7413f96bf83dc1ee3a4e6.jpg"> <br>   ‚Äì  ,       (   ‚Äì XSLT).  Enter. <br> <br>         XSLT,        .  ,        ,    ‚Äì  . <br> <br>        , ..,   ,         (   ,    , ,   html ). <br> <br>    ,       , ..    .      <br> <code class="xml">&lt;xsl:transform version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;xsl:template match="/"&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> : <br> <code>xmlns:xsl</code> ,       xsl. ..       ,       <code>xsl</code> : ( <code>&lt;xsl:strip-space elements="*"/&gt;</code> ) <code>xmlns:sap</code> ,       sap <code>xsl:transform</code> ,     XSLT- <code>&lt;xsl:strip-space elements="*"/&gt;</code>      <code>&lt;xsl:template match="/"&gt;</code>   ,       XML  <br> <br> XSLT-      ( <code>xsl:template</code> )     XML-,      <code>match</code> .   <code>match</code>      <a href="http://ru.wikipedia.org/wiki/XPath">XPath</a> .    ,     ¬´/¬ª,      XML- <code>TABLE</code>    "/asx:abap/asx:values/TABLE" (..    XML-   ( <code>asx:abap</code> )    ( <code>TABLE</code> )). <br> <br>  ,      XML- List.   : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>item</code>   <code>TABLE</code>   XML ,      <code>&lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt;</code> ,    <code>select</code>  XPath   ,     .       <code>MyItem</code> ,     <code>Name</code>   NAME    ,    .  ,       : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>&lt;xsl:value-of select="NAME"/&gt;</code> ,   <code>select</code>   XPath-  ,     .  ,    <code>xsl:value-of</code>   ,   <code>xsl:for-each</code> .   ,   <code>xsl:for-each</code>   ,    ,   <code>xsl:value-of</code> ‚Äì     (..    <code>xsl:for-each</code> ). <br>  ,   ,         . <br>  ,            <code>asx, sap, prg</code> (XSLT     ).       XML,  <code>xsl:transform</code>  : <br> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt;</code> <br> <br> ..     ,    <code>exclude-result-prefixes</code>  ,       XML. <br>        ,       <code>RF_CHILD_LIST</code> .        .   ‚Äì   . <br> ,    id   .    <code>ChilListID</code> .     . <br>      : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;/xsl:template&gt;</code> <br> <br> ..      <code>OutChilds</code>   <code>ChilListID</code> .  ,       XML-,    <code>/asx:abap/asx:heap</code> . <br> <br>       ?    item   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> .        <code>xsl:for-each</code> . <br>   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]"&gt;</code> <br>  XPath ,        <code>prg:T_DEEP_STRUCT</code> ,    <code>id</code>   <code>ChilListID</code> . <br>        item: <code>&lt;xsl:for-each select="item"&gt;</code> <br> <br> ,        ,   ,    , XSLT  .     : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt;</code> <br> <br>   <code>MyItem</code>   <code>Name</code> .    : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>      .    :      . <br>     <code>xsl:apply-templates</code> ,     <code>select</code>     XML      . <br>  ,  ,       <code>ChilListID</code> . ,      ,    <code>RF_CHILD_LIST</code>  <code>href,</code>    <code>#id___</code> . ..     <code>href</code>     ,    .     XPath  : <code>substring(RF_CHILD_LIST/@href,2)</code> . ..     : <br> <code class="xml"> &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt;</code> <br> <br>  ,     : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>  ,  ,     ,    . <br> <br> <b class="spoiler_title"> ,      :</b> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;!--       , .   --&gt; &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;!--         XML --&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;!--  NAMR  --&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--      ,        --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt; &lt;!--     --&gt; &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;!--   --&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;!--  , id    ,   --&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--    --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> <br> <b class="spoiler_title">  ABAP-</b> <code class="bash">REPORT zedu_test_xslt_deep_transform. *      "   " TYPES : BEGIN OF tdeep_struct , name TYPE string , rf_child_list TYPE REF TO data , END OF tdeep_struct *       "   " , t_deep_struct TYPE STANDARD TABLE OF tdeep_struct WITH NON-UNIQUE DEFAULT KEY . DATA : gt_tree TYPE t_deep_struct "  , gtree TYPE tdeep_struct "       , gchild TYPE tdeep_struct "       , ggrandchild TYPE tdeep_struct "       , gxml_str TYPE string "  XML , go_xml_doc TYPE REF TO cl_xml_document "    XML . FIELD-SYMBOLS : &lt;gt_child_list&gt; TYPE t_deep_struct "    , &lt;gt_grandchild_list&gt; TYPE t_deep_struct "    . START-OF-SELECTION. *    gtree-name = 'GrandParent1'. CREATE DATA gtree-rf_child_list TYPE t_deep_struct. ASSIGN gtree-rf_child_list-&gt;* TO &lt;gt_child_list&gt;. gchild-name = 'Child1'. APPEND gchild TO &lt;gt_child_list&gt;. gchild-name = 'Child2'. CREATE DATA gchild-rf_child_list TYPE t_deep_struct. ASSIGN gchild-rf_child_list-&gt;* TO &lt;gt_grandchild_list&gt;. ggrandchild-name = 'GrandChild1'. APPEND ggrandchild TO &lt;gt_grandchild_list&gt;. APPEND gchild TO &lt;gt_child_list&gt;. APPEND gtree TO gt_tree. CLEAR gtree. gtree-name = 'GrandParent2'. APPEND gtree TO gt_tree. * XSLT- CALL TRANSFORMATION zedu_test_xslt_deep_transform2 SOURCE table = gt_tree RESULT XML gxml_str. *    XML CREATE OBJECT go_xml_doc. go_xml_doc-&gt;parse_string( gxml_str ). go_xml_doc-&gt;display( ).</code> <br> <br> <br>  <br>  ,      XSLT  ? <br> <br>   <br> <a href="http://help.sap.com/abapdocu_70/en/ABAPCALL_TRANSFORMATION.htm"> ABAP</a> <a href="http://msdn.microsoft.com/ru-ru/library/ms256069%2528v%3Dvs.110%2529.aspx">MSDN:   XSLT</a> <a href="http://zvon.org/comp/r/tut-XPath_1.html">XPath tutorial</a> <a href="http://www.w3.org/TR/xslt"> XSLT</a></code></code> </li> <li> <code><code><code>,         .           . ..      RF_CHILD_LIST</code> ,      DATA ( <code>TYPE REF TO DATA</code> ),      ,     <code>href</code>     ,    . <br> ,     <code>&lt;RF_CHILD_LIST href="#d1" /&gt;</code> ,   <code>#</code> -       <a href="http://ru.wikipedia.org/wiki/XLink">XLink</a> ,  <code>d1</code> ‚Äì  .         XML-: <code>asx:heap</code>  ,   <code>id</code>  d1.    &lt; <code>prg:T_DEEP_STRUCT id="d1" ‚Ä¶ &gt;</code> .      ,         . <br> ..,    XML   ,  . <br> <br>  XSLT- ? <br>     XSLT-. <br>  SAP      STRANS. <br> <img src="//habrastorage.org/files/9e2/1a4/62a/9e21a462a5794b7b820619abc4edb1ec.jpg"> <br>   ,  ¬´¬ª(F5). <br> <img src="//habrastorage.org/files/f25/1a9/ff3/f251a9ff31c7413f96bf83dc1ee3a4e6.jpg"> <br>   ‚Äì  ,       (   ‚Äì XSLT).  Enter. <br> <br>         XSLT,        .  ,        ,    ‚Äì  . <br> <br>        , ..,   ,         (   ,    , ,   html ). <br> <br>    ,       , ..    .      <br> <code class="xml">&lt;xsl:transform version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;xsl:template match="/"&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> : <br> <code>xmlns:xsl</code> ,       xsl. ..       ,       <code>xsl</code> : ( <code>&lt;xsl:strip-space elements="*"/&gt;</code> ) <code>xmlns:sap</code> ,       sap <code>xsl:transform</code> ,     XSLT- <code>&lt;xsl:strip-space elements="*"/&gt;</code>      <code>&lt;xsl:template match="/"&gt;</code>   ,       XML  <br> <br> XSLT-      ( <code>xsl:template</code> )     XML-,      <code>match</code> .   <code>match</code>      <a href="http://ru.wikipedia.org/wiki/XPath">XPath</a> .    ,     ¬´/¬ª,      XML- <code>TABLE</code>    "/asx:abap/asx:values/TABLE" (..    XML-   ( <code>asx:abap</code> )    ( <code>TABLE</code> )). <br> <br>  ,      XML- List.   : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>item</code>   <code>TABLE</code>   XML ,      <code>&lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt;</code> ,    <code>select</code>  XPath   ,     .       <code>MyItem</code> ,     <code>Name</code>   NAME    ,    .  ,       : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>&lt;xsl:value-of select="NAME"/&gt;</code> ,   <code>select</code>   XPath-  ,     .  ,    <code>xsl:value-of</code>   ,   <code>xsl:for-each</code> .   ,   <code>xsl:for-each</code>   ,    ,   <code>xsl:value-of</code> ‚Äì     (..    <code>xsl:for-each</code> ). <br>  ,   ,         . <br>  ,            <code>asx, sap, prg</code> (XSLT     ).       XML,  <code>xsl:transform</code>  : <br> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt;</code> <br> <br> ..     ,    <code>exclude-result-prefixes</code>  ,       XML. <br>        ,       <code>RF_CHILD_LIST</code> .        .   ‚Äì   . <br> ,    id   .    <code>ChilListID</code> .     . <br>      : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;/xsl:template&gt;</code> <br> <br> ..      <code>OutChilds</code>   <code>ChilListID</code> .  ,       XML-,    <code>/asx:abap/asx:heap</code> . <br> <br>       ?    item   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> .        <code>xsl:for-each</code> . <br>   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]"&gt;</code> <br>  XPath ,        <code>prg:T_DEEP_STRUCT</code> ,    <code>id</code>   <code>ChilListID</code> . <br>        item: <code>&lt;xsl:for-each select="item"&gt;</code> <br> <br> ,        ,   ,    , XSLT  .     : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt;</code> <br> <br>   <code>MyItem</code>   <code>Name</code> .    : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>      .    :      . <br>     <code>xsl:apply-templates</code> ,     <code>select</code>     XML      . <br>  ,  ,       <code>ChilListID</code> . ,      ,    <code>RF_CHILD_LIST</code>  <code>href,</code>    <code>#id___</code> . ..     <code>href</code>     ,    .     XPath  : <code>substring(RF_CHILD_LIST/@href,2)</code> . ..     : <br> <code class="xml"> &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt;</code> <br> <br>  ,     : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>  ,  ,     ,    . <br> <br> <b class="spoiler_title"> ,      :</b> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;!--       , .   --&gt; &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;!--         XML --&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;!--  NAMR  --&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--      ,        --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt; &lt;!--     --&gt; &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;!--   --&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;!--  , id    ,   --&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--    --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> <br> <b class="spoiler_title">  ABAP-</b> <code class="bash">REPORT zedu_test_xslt_deep_transform. *      "   " TYPES : BEGIN OF tdeep_struct , name TYPE string , rf_child_list TYPE REF TO data , END OF tdeep_struct *       "   " , t_deep_struct TYPE STANDARD TABLE OF tdeep_struct WITH NON-UNIQUE DEFAULT KEY . DATA : gt_tree TYPE t_deep_struct "  , gtree TYPE tdeep_struct "       , gchild TYPE tdeep_struct "       , ggrandchild TYPE tdeep_struct "       , gxml_str TYPE string "  XML , go_xml_doc TYPE REF TO cl_xml_document "    XML . FIELD-SYMBOLS : &lt;gt_child_list&gt; TYPE t_deep_struct "    , &lt;gt_grandchild_list&gt; TYPE t_deep_struct "    . START-OF-SELECTION. *    gtree-name = 'GrandParent1'. CREATE DATA gtree-rf_child_list TYPE t_deep_struct. ASSIGN gtree-rf_child_list-&gt;* TO &lt;gt_child_list&gt;. gchild-name = 'Child1'. APPEND gchild TO &lt;gt_child_list&gt;. gchild-name = 'Child2'. CREATE DATA gchild-rf_child_list TYPE t_deep_struct. ASSIGN gchild-rf_child_list-&gt;* TO &lt;gt_grandchild_list&gt;. ggrandchild-name = 'GrandChild1'. APPEND ggrandchild TO &lt;gt_grandchild_list&gt;. APPEND gchild TO &lt;gt_child_list&gt;. APPEND gtree TO gt_tree. CLEAR gtree. gtree-name = 'GrandParent2'. APPEND gtree TO gt_tree. * XSLT- CALL TRANSFORMATION zedu_test_xslt_deep_transform2 SOURCE table = gt_tree RESULT XML gxml_str. *    XML CREATE OBJECT go_xml_doc. go_xml_doc-&gt;parse_string( gxml_str ). go_xml_doc-&gt;display( ).</code> <br> <br> <br>  <br>  ,      XSLT  ? <br> <br>   <br> <a href="http://help.sap.com/abapdocu_70/en/ABAPCALL_TRANSFORMATION.htm"> ABAP</a> <a href="http://msdn.microsoft.com/ru-ru/library/ms256069%2528v%3Dvs.110%2529.aspx">MSDN:   XSLT</a> <a href="http://zvon.org/comp/r/tut-XPath_1.html">XPath tutorial</a> <a href="http://www.w3.org/TR/xslt"> XSLT</a></code></code> </li> <li> <code><code><code>,         .           . ..      RF_CHILD_LIST</code> ,      DATA ( <code>TYPE REF TO DATA</code> ),      ,     <code>href</code>     ,    . <br> ,     <code>&lt;RF_CHILD_LIST href="#d1" /&gt;</code> ,   <code>#</code> -       <a href="http://ru.wikipedia.org/wiki/XLink">XLink</a> ,  <code>d1</code> ‚Äì  .         XML-: <code>asx:heap</code>  ,   <code>id</code>  d1.    &lt; <code>prg:T_DEEP_STRUCT id="d1" ‚Ä¶ &gt;</code> .      ,         . <br> ..,    XML   ,  . <br> <br>  XSLT- ? <br>     XSLT-. <br>  SAP      STRANS. <br> <img src="//habrastorage.org/files/9e2/1a4/62a/9e21a462a5794b7b820619abc4edb1ec.jpg"> <br>   ,  ¬´¬ª(F5). <br> <img src="//habrastorage.org/files/f25/1a9/ff3/f251a9ff31c7413f96bf83dc1ee3a4e6.jpg"> <br>   ‚Äì  ,       (   ‚Äì XSLT).  Enter. <br> <br>         XSLT,        .  ,        ,    ‚Äì  . <br> <br>        , ..,   ,         (   ,    , ,   html ). <br> <br>    ,       , ..    .      <br> <code class="xml">&lt;xsl:transform version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;xsl:template match="/"&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> : <br> <code>xmlns:xsl</code> ,       xsl. ..       ,       <code>xsl</code> : ( <code>&lt;xsl:strip-space elements="*"/&gt;</code> ) <code>xmlns:sap</code> ,       sap <code>xsl:transform</code> ,     XSLT- <code>&lt;xsl:strip-space elements="*"/&gt;</code>      <code>&lt;xsl:template match="/"&gt;</code>   ,       XML  <br> <br> XSLT-      ( <code>xsl:template</code> )     XML-,      <code>match</code> .   <code>match</code>      <a href="http://ru.wikipedia.org/wiki/XPath">XPath</a> .    ,     ¬´/¬ª,      XML- <code>TABLE</code>    "/asx:abap/asx:values/TABLE" (..    XML-   ( <code>asx:abap</code> )    ( <code>TABLE</code> )). <br> <br>  ,      XML- List.   : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>item</code>   <code>TABLE</code>   XML ,      <code>&lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt;</code> ,    <code>select</code>  XPath   ,     .       <code>MyItem</code> ,     <code>Name</code>   NAME    ,    .  ,       : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>&lt;xsl:value-of select="NAME"/&gt;</code> ,   <code>select</code>   XPath-  ,     .  ,    <code>xsl:value-of</code>   ,   <code>xsl:for-each</code> .   ,   <code>xsl:for-each</code>   ,    ,   <code>xsl:value-of</code> ‚Äì     (..    <code>xsl:for-each</code> ). <br>  ,   ,         . <br>  ,            <code>asx, sap, prg</code> (XSLT     ).       XML,  <code>xsl:transform</code>  : <br> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt;</code> <br> <br> ..     ,    <code>exclude-result-prefixes</code>  ,       XML. <br>        ,       <code>RF_CHILD_LIST</code> .        .   ‚Äì   . <br> ,    id   .    <code>ChilListID</code> .     . <br>      : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;/xsl:template&gt;</code> <br> <br> ..      <code>OutChilds</code>   <code>ChilListID</code> .  ,       XML-,    <code>/asx:abap/asx:heap</code> . <br> <br>       ?    item   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> .        <code>xsl:for-each</code> . <br>   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]"&gt;</code> <br>  XPath ,        <code>prg:T_DEEP_STRUCT</code> ,    <code>id</code>   <code>ChilListID</code> . <br>        item: <code>&lt;xsl:for-each select="item"&gt;</code> <br> <br> ,        ,   ,    , XSLT  .     : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt;</code> <br> <br>   <code>MyItem</code>   <code>Name</code> .    : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>      .    :      . <br>     <code>xsl:apply-templates</code> ,     <code>select</code>     XML      . <br>  ,  ,       <code>ChilListID</code> . ,      ,    <code>RF_CHILD_LIST</code>  <code>href,</code>    <code>#id___</code> . ..     <code>href</code>     ,    .     XPath  : <code>substring(RF_CHILD_LIST/@href,2)</code> . ..     : <br> <code class="xml"> &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt;</code> <br> <br>  ,     : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>  ,  ,     ,    . <br> <br> <b class="spoiler_title"> ,      :</b> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;!--       , .   --&gt; &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;!--         XML --&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;!--  NAMR  --&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--      ,        --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt; &lt;!--     --&gt; &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;!--   --&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;!--  , id    ,   --&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--    --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> <br> <b class="spoiler_title">  ABAP-</b> <code class="bash">REPORT zedu_test_xslt_deep_transform. *      "   " TYPES : BEGIN OF tdeep_struct , name TYPE string , rf_child_list TYPE REF TO data , END OF tdeep_struct *       "   " , t_deep_struct TYPE STANDARD TABLE OF tdeep_struct WITH NON-UNIQUE DEFAULT KEY . DATA : gt_tree TYPE t_deep_struct "  , gtree TYPE tdeep_struct "       , gchild TYPE tdeep_struct "       , ggrandchild TYPE tdeep_struct "       , gxml_str TYPE string "  XML , go_xml_doc TYPE REF TO cl_xml_document "    XML . FIELD-SYMBOLS : &lt;gt_child_list&gt; TYPE t_deep_struct "    , &lt;gt_grandchild_list&gt; TYPE t_deep_struct "    . START-OF-SELECTION. *    gtree-name = 'GrandParent1'. CREATE DATA gtree-rf_child_list TYPE t_deep_struct. ASSIGN gtree-rf_child_list-&gt;* TO &lt;gt_child_list&gt;. gchild-name = 'Child1'. APPEND gchild TO &lt;gt_child_list&gt;. gchild-name = 'Child2'. CREATE DATA gchild-rf_child_list TYPE t_deep_struct. ASSIGN gchild-rf_child_list-&gt;* TO &lt;gt_grandchild_list&gt;. ggrandchild-name = 'GrandChild1'. APPEND ggrandchild TO &lt;gt_grandchild_list&gt;. APPEND gchild TO &lt;gt_child_list&gt;. APPEND gtree TO gt_tree. CLEAR gtree. gtree-name = 'GrandParent2'. APPEND gtree TO gt_tree. * XSLT- CALL TRANSFORMATION zedu_test_xslt_deep_transform2 SOURCE table = gt_tree RESULT XML gxml_str. *    XML CREATE OBJECT go_xml_doc. go_xml_doc-&gt;parse_string( gxml_str ). go_xml_doc-&gt;display( ).</code> <br> <br> <br>  <br>  ,      XSLT  ? <br> <br>   <br> <a href="http://help.sap.com/abapdocu_70/en/ABAPCALL_TRANSFORMATION.htm"> ABAP</a> <a href="http://msdn.microsoft.com/ru-ru/library/ms256069%2528v%3Dvs.110%2529.aspx">MSDN:   XSLT</a> <a href="http://zvon.org/comp/r/tut-XPath_1.html">XPath tutorial</a> <a href="http://www.w3.org/TR/xslt"> XSLT</a></code></code> </li> <li> <code><code><code>,         .           . ..      RF_CHILD_LIST</code> ,      DATA ( <code>TYPE REF TO DATA</code> ),      ,     <code>href</code>     ,    . <br> ,     <code>&lt;RF_CHILD_LIST href="#d1" /&gt;</code> ,   <code>#</code> -       <a href="http://ru.wikipedia.org/wiki/XLink">XLink</a> ,  <code>d1</code> ‚Äì  .         XML-: <code>asx:heap</code>  ,   <code>id</code>  d1.    &lt; <code>prg:T_DEEP_STRUCT id="d1" ‚Ä¶ &gt;</code> .      ,         . <br> ..,    XML   ,  . <br> <br>  XSLT- ? <br>     XSLT-. <br>  SAP      STRANS. <br> <img src="//habrastorage.org/files/9e2/1a4/62a/9e21a462a5794b7b820619abc4edb1ec.jpg"> <br>   ,  ¬´¬ª(F5). <br> <img src="//habrastorage.org/files/f25/1a9/ff3/f251a9ff31c7413f96bf83dc1ee3a4e6.jpg"> <br>   ‚Äì  ,       (   ‚Äì XSLT).  Enter. <br> <br>         XSLT,        .  ,        ,    ‚Äì  . <br> <br>        , ..,   ,         (   ,    , ,   html ). <br> <br>    ,       , ..    .      <br> <code class="xml">&lt;xsl:transform version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;xsl:template match="/"&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> : <br> <code>xmlns:xsl</code> ,       xsl. ..       ,       <code>xsl</code> : ( <code>&lt;xsl:strip-space elements="*"/&gt;</code> ) <code>xmlns:sap</code> ,       sap <code>xsl:transform</code> ,     XSLT- <code>&lt;xsl:strip-space elements="*"/&gt;</code>      <code>&lt;xsl:template match="/"&gt;</code>   ,       XML  <br> <br> XSLT-      ( <code>xsl:template</code> )     XML-,      <code>match</code> .   <code>match</code>      <a href="http://ru.wikipedia.org/wiki/XPath">XPath</a> .    ,     ¬´/¬ª,      XML- <code>TABLE</code>    "/asx:abap/asx:values/TABLE" (..    XML-   ( <code>asx:abap</code> )    ( <code>TABLE</code> )). <br> <br>  ,      XML- List.   : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>item</code>   <code>TABLE</code>   XML ,      <code>&lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt;</code> ,    <code>select</code>  XPath   ,     .       <code>MyItem</code> ,     <code>Name</code>   NAME    ,    .  ,       : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>&lt;xsl:value-of select="NAME"/&gt;</code> ,   <code>select</code>   XPath-  ,     .  ,    <code>xsl:value-of</code>   ,   <code>xsl:for-each</code> .   ,   <code>xsl:for-each</code>   ,    ,   <code>xsl:value-of</code> ‚Äì     (..    <code>xsl:for-each</code> ). <br>  ,   ,         . <br>  ,            <code>asx, sap, prg</code> (XSLT     ).       XML,  <code>xsl:transform</code>  : <br> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt;</code> <br> <br> ..     ,    <code>exclude-result-prefixes</code>  ,       XML. <br>        ,       <code>RF_CHILD_LIST</code> .        .   ‚Äì   . <br> ,    id   .    <code>ChilListID</code> .     . <br>      : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;/xsl:template&gt;</code> <br> <br> ..      <code>OutChilds</code>   <code>ChilListID</code> .  ,       XML-,    <code>/asx:abap/asx:heap</code> . <br> <br>       ?    item   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> .        <code>xsl:for-each</code> . <br>   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]"&gt;</code> <br>  XPath ,        <code>prg:T_DEEP_STRUCT</code> ,    <code>id</code>   <code>ChilListID</code> . <br>        item: <code>&lt;xsl:for-each select="item"&gt;</code> <br> <br> ,        ,   ,    , XSLT  .     : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt;</code> <br> <br>   <code>MyItem</code>   <code>Name</code> .    : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>      .    :      . <br>     <code>xsl:apply-templates</code> ,     <code>select</code>     XML      . <br>  ,  ,       <code>ChilListID</code> . ,      ,    <code>RF_CHILD_LIST</code>  <code>href,</code>    <code>#id___</code> . ..     <code>href</code>     ,    .     XPath  : <code>substring(RF_CHILD_LIST/@href,2)</code> . ..     : <br> <code class="xml"> &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt;</code> <br> <br>  ,     : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>  ,  ,     ,    . <br> <br> <b class="spoiler_title"> ,      :</b> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;!--       , .   --&gt; &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;!--         XML --&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;!--  NAMR  --&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--      ,        --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt; &lt;!--     --&gt; &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;!--   --&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;!--  , id    ,   --&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--    --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> <br> <b class="spoiler_title">  ABAP-</b> <code class="bash">REPORT zedu_test_xslt_deep_transform. *      "   " TYPES : BEGIN OF tdeep_struct , name TYPE string , rf_child_list TYPE REF TO data , END OF tdeep_struct *       "   " , t_deep_struct TYPE STANDARD TABLE OF tdeep_struct WITH NON-UNIQUE DEFAULT KEY . DATA : gt_tree TYPE t_deep_struct "  , gtree TYPE tdeep_struct "       , gchild TYPE tdeep_struct "       , ggrandchild TYPE tdeep_struct "       , gxml_str TYPE string "  XML , go_xml_doc TYPE REF TO cl_xml_document "    XML . FIELD-SYMBOLS : &lt;gt_child_list&gt; TYPE t_deep_struct "    , &lt;gt_grandchild_list&gt; TYPE t_deep_struct "    . START-OF-SELECTION. *    gtree-name = 'GrandParent1'. CREATE DATA gtree-rf_child_list TYPE t_deep_struct. ASSIGN gtree-rf_child_list-&gt;* TO &lt;gt_child_list&gt;. gchild-name = 'Child1'. APPEND gchild TO &lt;gt_child_list&gt;. gchild-name = 'Child2'. CREATE DATA gchild-rf_child_list TYPE t_deep_struct. ASSIGN gchild-rf_child_list-&gt;* TO &lt;gt_grandchild_list&gt;. ggrandchild-name = 'GrandChild1'. APPEND ggrandchild TO &lt;gt_grandchild_list&gt;. APPEND gchild TO &lt;gt_child_list&gt;. APPEND gtree TO gt_tree. CLEAR gtree. gtree-name = 'GrandParent2'. APPEND gtree TO gt_tree. * XSLT- CALL TRANSFORMATION zedu_test_xslt_deep_transform2 SOURCE table = gt_tree RESULT XML gxml_str. *    XML CREATE OBJECT go_xml_doc. go_xml_doc-&gt;parse_string( gxml_str ). go_xml_doc-&gt;display( ).</code> <br> <br> <br>  <br>  ,      XSLT  ? <br> <br>   <br> <a href="http://help.sap.com/abapdocu_70/en/ABAPCALL_TRANSFORMATION.htm"> ABAP</a> <a href="http://msdn.microsoft.com/ru-ru/library/ms256069%2528v%3Dvs.110%2529.aspx">MSDN:   XSLT</a> <a href="http://zvon.org/comp/r/tut-XPath_1.html">XPath tutorial</a> <a href="http://www.w3.org/TR/xslt"> XSLT</a></code></code> </li> </ul> <code><code><code>,         .           . ..      RF_CHILD_LIST</code> ,      DATA ( <code>TYPE REF TO DATA</code> ),      ,     <code>href</code>     ,    . <br> ,     <code>&lt;RF_CHILD_LIST href="#d1" /&gt;</code> ,   <code>#</code> -       <a href="http://ru.wikipedia.org/wiki/XLink">XLink</a> ,  <code>d1</code> ‚Äì  .         XML-: <code>asx:heap</code>  ,   <code>id</code>  d1.    &lt; <code>prg:T_DEEP_STRUCT id="d1" ‚Ä¶ &gt;</code> .      ,         . <br> ..,    XML   ,  . <br> <br>  XSLT- ? <br>     XSLT-. <br>  SAP      STRANS. <br> <img src="//habrastorage.org/files/9e2/1a4/62a/9e21a462a5794b7b820619abc4edb1ec.jpg"> <br>   ,  ¬´¬ª(F5). <br> <img src="//habrastorage.org/files/f25/1a9/ff3/f251a9ff31c7413f96bf83dc1ee3a4e6.jpg"> <br>   ‚Äì  ,       (   ‚Äì XSLT).  Enter. <br> <br>         XSLT,        .  ,        ,    ‚Äì  . <br> <br>        , ..,   ,         (   ,    , ,   html ). <br> <br>    ,       , ..    .      <br> <code class="xml">&lt;xsl:transform version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;xsl:template match="/"&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> : <br> <code>xmlns:xsl</code> ,       xsl. ..       ,       <code>xsl</code> : ( <code>&lt;xsl:strip-space elements="*"/&gt;</code> ) <code>xmlns:sap</code> ,       sap <code>xsl:transform</code> ,     XSLT- <code>&lt;xsl:strip-space elements="*"/&gt;</code>      <code>&lt;xsl:template match="/"&gt;</code>   ,       XML  <br> <br> XSLT-      ( <code>xsl:template</code> )     XML-,      <code>match</code> .   <code>match</code>      <a href="http://ru.wikipedia.org/wiki/XPath">XPath</a> .    ,     ¬´/¬ª,      XML- <code>TABLE</code>    "/asx:abap/asx:values/TABLE" (..    XML-   ( <code>asx:abap</code> )    ( <code>TABLE</code> )). <br> <br>  ,      XML- List.   : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>item</code>   <code>TABLE</code>   XML ,      <code>&lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt;</code> ,    <code>select</code>  XPath   ,     .       <code>MyItem</code> ,     <code>Name</code>   NAME    ,    .  ,       : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>&lt;xsl:value-of select="NAME"/&gt;</code> ,   <code>select</code>   XPath-  ,     .  ,    <code>xsl:value-of</code>   ,   <code>xsl:for-each</code> .   ,   <code>xsl:for-each</code>   ,    ,   <code>xsl:value-of</code> ‚Äì     (..    <code>xsl:for-each</code> ). <br>  ,   ,         . <br>  ,            <code>asx, sap, prg</code> (XSLT     ).       XML,  <code>xsl:transform</code>  : <br> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt;</code> <br> <br> ..     ,    <code>exclude-result-prefixes</code>  ,       XML. <br>        ,       <code>RF_CHILD_LIST</code> .        .   ‚Äì   . <br> ,    id   .    <code>ChilListID</code> .     . <br>      : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;/xsl:template&gt;</code> <br> <br> ..      <code>OutChilds</code>   <code>ChilListID</code> .  ,       XML-,    <code>/asx:abap/asx:heap</code> . <br> <br>       ?    item   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> .        <code>xsl:for-each</code> . <br>   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]"&gt;</code> <br>  XPath ,        <code>prg:T_DEEP_STRUCT</code> ,    <code>id</code>   <code>ChilListID</code> . <br>        item: <code>&lt;xsl:for-each select="item"&gt;</code> <br> <br> ,        ,   ,    , XSLT  .     : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt;</code> <br> <br>   <code>MyItem</code>   <code>Name</code> .    : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>      .    :      . <br>     <code>xsl:apply-templates</code> ,     <code>select</code>     XML      . <br>  ,  ,       <code>ChilListID</code> . ,      ,    <code>RF_CHILD_LIST</code>  <code>href,</code>    <code>#id___</code> . ..     <code>href</code>     ,    .     XPath  : <code>substring(RF_CHILD_LIST/@href,2)</code> . ..     : <br> <code class="xml"> &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt;</code> <br> <br>  ,     : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>  ,  ,     ,    . <br> <br> <b class="spoiler_title"> ,      :</b> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;!--       , .   --&gt; &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;!--         XML --&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;!--  NAMR  --&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--      ,        --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt; &lt;!--     --&gt; &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;!--   --&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;!--  , id    ,   --&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--    --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> <br> <b class="spoiler_title">  ABAP-</b> <code class="bash">REPORT zedu_test_xslt_deep_transform. *      "   " TYPES : BEGIN OF tdeep_struct , name TYPE string , rf_child_list TYPE REF TO data , END OF tdeep_struct *       "   " , t_deep_struct TYPE STANDARD TABLE OF tdeep_struct WITH NON-UNIQUE DEFAULT KEY . DATA : gt_tree TYPE t_deep_struct "  , gtree TYPE tdeep_struct "       , gchild TYPE tdeep_struct "       , ggrandchild TYPE tdeep_struct "       , gxml_str TYPE string "  XML , go_xml_doc TYPE REF TO cl_xml_document "    XML . FIELD-SYMBOLS : &lt;gt_child_list&gt; TYPE t_deep_struct "    , &lt;gt_grandchild_list&gt; TYPE t_deep_struct "    . START-OF-SELECTION. *    gtree-name = 'GrandParent1'. CREATE DATA gtree-rf_child_list TYPE t_deep_struct. ASSIGN gtree-rf_child_list-&gt;* TO &lt;gt_child_list&gt;. gchild-name = 'Child1'. APPEND gchild TO &lt;gt_child_list&gt;. gchild-name = 'Child2'. CREATE DATA gchild-rf_child_list TYPE t_deep_struct. ASSIGN gchild-rf_child_list-&gt;* TO &lt;gt_grandchild_list&gt;. ggrandchild-name = 'GrandChild1'. APPEND ggrandchild TO &lt;gt_grandchild_list&gt;. APPEND gchild TO &lt;gt_child_list&gt;. APPEND gtree TO gt_tree. CLEAR gtree. gtree-name = 'GrandParent2'. APPEND gtree TO gt_tree. * XSLT- CALL TRANSFORMATION zedu_test_xslt_deep_transform2 SOURCE table = gt_tree RESULT XML gxml_str. *    XML CREATE OBJECT go_xml_doc. go_xml_doc-&gt;parse_string( gxml_str ). go_xml_doc-&gt;display( ).</code> <br> <br> <br>  <br>  ,      XSLT  ? <br> <br>   <br> <a href="http://help.sap.com/abapdocu_70/en/ABAPCALL_TRANSFORMATION.htm"> ABAP</a> <a href="http://msdn.microsoft.com/ru-ru/library/ms256069%2528v%3Dvs.110%2529.aspx">MSDN:   XSLT</a> <a href="http://zvon.org/comp/r/tut-XPath_1.html">XPath tutorial</a> <a href="http://www.w3.org/TR/xslt"> XSLT</a></code></code> <pre> <code class="hljs xml"><code><code>,         .           . ..      RF_CHILD_LIST</code> ,      DATA ( <code>TYPE REF TO DATA</code> ),      ,     <code>href</code>     ,    . <br> ,     <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RF_CHILD_LIST</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#d1"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> ,   <code>#</code> -       <a href="http://ru.wikipedia.org/wiki/XLink">XLink</a> ,  <code>d1</code> ‚Äì  .         XML-: <code>asx:heap</code>  ,   <code>id</code>  d1.    <span class="hljs-tag"><span class="hljs-tag">&lt; </span></span><code><span class="hljs-tag"><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">prg:T_DEEP_STRUCT</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"d1"</span></span></span><span class="hljs-tag"> ‚Ä¶ &gt;</span></span></code> .      ,         . <br> ..,    XML   ,  . <br> <br>  XSLT- ? <br>     XSLT-. <br>  SAP      STRANS. <br> <img src="//habrastorage.org/files/9e2/1a4/62a/9e21a462a5794b7b820619abc4edb1ec.jpg"> <br>   ,  ¬´¬ª(F5). <br> <img src="//habrastorage.org/files/f25/1a9/ff3/f251a9ff31c7413f96bf83dc1ee3a4e6.jpg"> <br>   ‚Äì  ,       (   ‚Äì XSLT).  Enter. <br> <br>         XSLT,        .  ,        ,    ‚Äì  . <br> <br>        , ..,   ,         (   ,    , ,   html ). <br> <br>    ,       , ..    .      <br> <code class="xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsl</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/1999/XSL/Transform"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:sap</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/sapxsl"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:strip-space</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">elements</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> : <br> <code>xmlns:xsl</code> ,       xsl. ..       ,       <code>xsl</code> : ( <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:strip-space</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">elements</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> ) <code>xmlns:sap</code> ,       sap <code>xsl:transform</code> ,     XSLT- <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:strip-space</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">elements</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag">/&gt;</span></span></code>      <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span></code>   ,       XML  <br> <br> XSLT-      ( <code>xsl:template</code> )     XML-,      <code>match</code> .   <code>match</code>      <a href="http://ru.wikipedia.org/wiki/XPath">XPath</a> .    ,     ¬´/¬ª,      XML- <code>TABLE</code>    "/asx:abap/asx:values/TABLE" (..    XML-   ( <code>asx:abap</code> )    ( <code>TABLE</code> )). <br> <br>  ,      XML- List.   : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>        <code>item</code>   <code>TABLE</code>   XML ,      <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:values/TABLE/item"</span></span></span><span class="hljs-tag">&gt;</span></span></code> ,    <code>select</code>  XPath   ,     .       <code>MyItem</code> ,     <code>Name</code>   NAME    ,    .  ,       : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:values/TABLE/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>        <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> ,   <code>select</code>   XPath-  ,     .  ,    <code>xsl:value-of</code>   ,   <code>xsl:for-each</code> .   ,   <code>xsl:for-each</code>   ,    ,   <code>xsl:value-of</code> ‚Äì     (..    <code>xsl:for-each</code> ). <br>  ,   ,         . <br>  ,            <code>asx, sap, prg</code> (XSLT     ).       XML,  <code>xsl:transform</code>  : <br> <code class="xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsl</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/1999/XSL/Transform"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:sap</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/sapxsl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:asx</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/abapxml"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:prg</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">exclude-result-prefixes</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"asx sap prg"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> ..     ,    <code>exclude-result-prefixes</code>  ,       XML. <br>        ,       <code>RF_CHILD_LIST</code> .        .   ‚Äì   . <br> ,    id   .    <code>ChilListID</code> .     . <br>      : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"OutChilds"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> ..      <code>OutChilds</code>   <code>ChilListID</code> .  ,       XML-,    <code>/asx:abap/asx:heap</code> . <br> <br>       ?    item   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> .        <code>xsl:for-each</code> . <br>   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> : <br> <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]"</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br>  XPath ,        <code>prg:T_DEEP_STRUCT</code> ,    <code>id</code>   <code>ChilListID</code> . <br>        item: <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"item"</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> ,        ,   ,    , XSLT  .     : <br> <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]/item"</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>   <code>MyItem</code>   <code>Name</code> .    : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"OutChilds"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>      .    :      . <br>     <code>xsl:apply-templates</code> ,     <code>select</code>     XML      . <br>  ,  ,       <code>ChilListID</code> . ,      ,    <code>RF_CHILD_LIST</code>  <code>href,</code>    <code>#id___</code> . ..     <code>href</code>     ,    .     XPath  : <code>substring(RF_CHILD_LIST/@href,2)</code> . ..     : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:with-param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"substring(RF_CHILD_LIST/@href,2)"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>  ,     : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"OutChilds"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:with-param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"substring(RF_CHILD_LIST/@href,2)"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>  ,  ,     ,    . <br> <br> <b class="spoiler_title"> ,      :</b> <code class="xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsl</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/1999/XSL/Transform"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:sap</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/sapxsl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:asx</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/abapxml"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:prg</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">exclude-result-prefixes</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"asx sap prg"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:strip-space</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">elements</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--       , .   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--         XML --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:values/TABLE/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  NAMR  --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--      ,        --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:with-param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"substring(RF_CHILD_LIST/@href,2)"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--     --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"OutChilds"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  , id    ,   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--    --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:with-param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"substring(RF_CHILD_LIST/@href,2)"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> <br> <b class="spoiler_title">  ABAP-</b> <code class="bash">REPORT zedu_test_xslt_deep_transform. *      "   " TYPES : BEGIN OF tdeep_struct , name TYPE string , rf_child_list TYPE REF TO data , END OF tdeep_struct *       "   " , t_deep_struct TYPE STANDARD TABLE OF tdeep_struct WITH NON-UNIQUE DEFAULT KEY . DATA : gt_tree TYPE t_deep_struct "  , gtree TYPE tdeep_struct "       , gchild TYPE tdeep_struct "       , ggrandchild TYPE tdeep_struct "       , gxml_str TYPE string "  XML , go_xml_doc TYPE REF TO cl_xml_document "    XML . FIELD-SYMBOLS : <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_child_list</span></span></span><span class="hljs-tag">&gt;</span></span> TYPE t_deep_struct "    , <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_grandchild_list</span></span></span><span class="hljs-tag">&gt;</span></span> TYPE t_deep_struct "    . START-OF-SELECTION. *    gtree-name = 'GrandParent1'. CREATE DATA gtree-rf_child_list TYPE t_deep_struct. ASSIGN gtree-rf_child_list-&gt;* TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_child_list</span></span></span><span class="hljs-tag">&gt;</span></span>. gchild-name = 'Child1'. APPEND gchild TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_child_list</span></span></span><span class="hljs-tag">&gt;</span></span>. gchild-name = 'Child2'. CREATE DATA gchild-rf_child_list TYPE t_deep_struct. ASSIGN gchild-rf_child_list-&gt;* TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_grandchild_list</span></span></span><span class="hljs-tag">&gt;</span></span>. ggrandchild-name = 'GrandChild1'. APPEND ggrandchild TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_grandchild_list</span></span></span><span class="hljs-tag">&gt;</span></span>. APPEND gchild TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_child_list</span></span></span><span class="hljs-tag">&gt;</span></span>. APPEND gtree TO gt_tree. CLEAR gtree. gtree-name = 'GrandParent2'. APPEND gtree TO gt_tree. * XSLT- CALL TRANSFORMATION zedu_test_xslt_deep_transform2 SOURCE table = gt_tree RESULT XML gxml_str. *    XML CREATE OBJECT go_xml_doc. go_xml_doc-&gt;parse_string( gxml_str ). go_xml_doc-&gt;display( ).</code> <br> <br> <br>  <br>  ,      XSLT  ? <br> <br>   <br> <a href="http://help.sap.com/abapdocu_70/en/ABAPCALL_TRANSFORMATION.htm"> ABAP</a> <a href="http://msdn.microsoft.com/ru-ru/library/ms256069%2528v%3Dvs.110%2529.aspx">MSDN:   XSLT</a> <a href="http://zvon.org/comp/r/tut-XPath_1.html">XPath tutorial</a> <a href="http://www.w3.org/TR/xslt"> XSLT</a></code></code> </pre> <code><code><code>,         .           . ..      RF_CHILD_LIST</code> ,      DATA ( <code>TYPE REF TO DATA</code> ),      ,     <code>href</code>     ,    . <br> ,     <code>&lt;RF_CHILD_LIST href="#d1" /&gt;</code> ,   <code>#</code> -       <a href="http://ru.wikipedia.org/wiki/XLink">XLink</a> ,  <code>d1</code> ‚Äì  .         XML-: <code>asx:heap</code>  ,   <code>id</code>  d1.    &lt; <code>prg:T_DEEP_STRUCT id="d1" ‚Ä¶ &gt;</code> .      ,         . <br> ..,    XML   ,  . <br> <br>  XSLT- ? <br>     XSLT-. <br>  SAP      STRANS. <br> <img src="//habrastorage.org/files/9e2/1a4/62a/9e21a462a5794b7b820619abc4edb1ec.jpg"> <br>   ,  ¬´¬ª(F5). <br> <img src="//habrastorage.org/files/f25/1a9/ff3/f251a9ff31c7413f96bf83dc1ee3a4e6.jpg"> <br>   ‚Äì  ,       (   ‚Äì XSLT).  Enter. <br> <br>         XSLT,        .  ,        ,    ‚Äì  . <br> <br>        , ..,   ,         (   ,    , ,   html ). <br> <br>    ,       , ..    .      <br> <code class="xml">&lt;xsl:transform version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;xsl:template match="/"&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> : <br> <code>xmlns:xsl</code> ,       xsl. ..       ,       <code>xsl</code> : ( <code>&lt;xsl:strip-space elements="*"/&gt;</code> ) <code>xmlns:sap</code> ,       sap <code>xsl:transform</code> ,     XSLT- <code>&lt;xsl:strip-space elements="*"/&gt;</code>      <code>&lt;xsl:template match="/"&gt;</code>   ,       XML  <br> <br> XSLT-      ( <code>xsl:template</code> )     XML-,      <code>match</code> .   <code>match</code>      <a href="http://ru.wikipedia.org/wiki/XPath">XPath</a> .    ,     ¬´/¬ª,      XML- <code>TABLE</code>    "/asx:abap/asx:values/TABLE" (..    XML-   ( <code>asx:abap</code> )    ( <code>TABLE</code> )). <br> <br>  ,      XML- List.   : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>item</code>   <code>TABLE</code>   XML ,      <code>&lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt;</code> ,    <code>select</code>  XPath   ,     .       <code>MyItem</code> ,     <code>Name</code>   NAME    ,    .  ,       : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>&lt;xsl:value-of select="NAME"/&gt;</code> ,   <code>select</code>   XPath-  ,     .  ,    <code>xsl:value-of</code>   ,   <code>xsl:for-each</code> .   ,   <code>xsl:for-each</code>   ,    ,   <code>xsl:value-of</code> ‚Äì     (..    <code>xsl:for-each</code> ). <br>  ,   ,         . <br>  ,            <code>asx, sap, prg</code> (XSLT     ).       XML,  <code>xsl:transform</code>  : <br> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt;</code> <br> <br> ..     ,    <code>exclude-result-prefixes</code>  ,       XML. <br>        ,       <code>RF_CHILD_LIST</code> .        .   ‚Äì   . <br> ,    id   .    <code>ChilListID</code> .     . <br>      : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;/xsl:template&gt;</code> <br> <br> ..      <code>OutChilds</code>   <code>ChilListID</code> .  ,       XML-,    <code>/asx:abap/asx:heap</code> . <br> <br>       ?    item   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> .        <code>xsl:for-each</code> . <br>   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]"&gt;</code> <br>  XPath ,        <code>prg:T_DEEP_STRUCT</code> ,    <code>id</code>   <code>ChilListID</code> . <br>        item: <code>&lt;xsl:for-each select="item"&gt;</code> <br> <br> ,        ,   ,    , XSLT  .     : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt;</code> <br> <br>   <code>MyItem</code>   <code>Name</code> .    : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>      .    :      . <br>     <code>xsl:apply-templates</code> ,     <code>select</code>     XML      . <br>  ,  ,       <code>ChilListID</code> . ,      ,    <code>RF_CHILD_LIST</code>  <code>href,</code>    <code>#id___</code> . ..     <code>href</code>     ,    .     XPath  : <code>substring(RF_CHILD_LIST/@href,2)</code> . ..     : <br> <code class="xml"> &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt;</code> <br> <br>  ,     : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>  ,  ,     ,    . <br> <br> <b class="spoiler_title"> ,      :</b> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;!--       , .   --&gt; &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;!--         XML --&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;!--  NAMR  --&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--      ,        --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt; &lt;!--     --&gt; &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;!--   --&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;!--  , id    ,   --&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--    --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> <br> <b class="spoiler_title">  ABAP-</b> <code class="bash">REPORT zedu_test_xslt_deep_transform. *      "   " TYPES : BEGIN OF tdeep_struct , name TYPE string , rf_child_list TYPE REF TO data , END OF tdeep_struct *       "   " , t_deep_struct TYPE STANDARD TABLE OF tdeep_struct WITH NON-UNIQUE DEFAULT KEY . DATA : gt_tree TYPE t_deep_struct "  , gtree TYPE tdeep_struct "       , gchild TYPE tdeep_struct "       , ggrandchild TYPE tdeep_struct "       , gxml_str TYPE string "  XML , go_xml_doc TYPE REF TO cl_xml_document "    XML . FIELD-SYMBOLS : &lt;gt_child_list&gt; TYPE t_deep_struct "    , &lt;gt_grandchild_list&gt; TYPE t_deep_struct "    . START-OF-SELECTION. *    gtree-name = 'GrandParent1'. CREATE DATA gtree-rf_child_list TYPE t_deep_struct. ASSIGN gtree-rf_child_list-&gt;* TO &lt;gt_child_list&gt;. gchild-name = 'Child1'. APPEND gchild TO &lt;gt_child_list&gt;. gchild-name = 'Child2'. CREATE DATA gchild-rf_child_list TYPE t_deep_struct. ASSIGN gchild-rf_child_list-&gt;* TO &lt;gt_grandchild_list&gt;. ggrandchild-name = 'GrandChild1'. APPEND ggrandchild TO &lt;gt_grandchild_list&gt;. APPEND gchild TO &lt;gt_child_list&gt;. APPEND gtree TO gt_tree. CLEAR gtree. gtree-name = 'GrandParent2'. APPEND gtree TO gt_tree. * XSLT- CALL TRANSFORMATION zedu_test_xslt_deep_transform2 SOURCE table = gt_tree RESULT XML gxml_str. *    XML CREATE OBJECT go_xml_doc. go_xml_doc-&gt;parse_string( gxml_str ). go_xml_doc-&gt;display( ).</code> <br> <br> <br>  <br>  ,      XSLT  ? <br> <br>   <br> <a href="http://help.sap.com/abapdocu_70/en/ABAPCALL_TRANSFORMATION.htm"> ABAP</a> <a href="http://msdn.microsoft.com/ru-ru/library/ms256069%2528v%3Dvs.110%2529.aspx">MSDN:   XSLT</a> <a href="http://zvon.org/comp/r/tut-XPath_1.html">XPath tutorial</a> <a href="http://www.w3.org/TR/xslt"> XSLT</a></code></code> <pre> <code class="hljs xml"><code><code>,         .           . ..      RF_CHILD_LIST</code> ,      DATA ( <code>TYPE REF TO DATA</code> ),      ,     <code>href</code>     ,    . <br> ,     <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RF_CHILD_LIST</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#d1"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> ,   <code>#</code> -       <a href="http://ru.wikipedia.org/wiki/XLink">XLink</a> ,  <code>d1</code> ‚Äì  .         XML-: <code>asx:heap</code>  ,   <code>id</code>  d1.    <span class="hljs-tag"><span class="hljs-tag">&lt; </span></span><code><span class="hljs-tag"><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">prg:T_DEEP_STRUCT</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"d1"</span></span></span><span class="hljs-tag"> ‚Ä¶ &gt;</span></span></code> .      ,         . <br> ..,    XML   ,  . <br> <br>  XSLT- ? <br>     XSLT-. <br>  SAP      STRANS. <br> <img src="//habrastorage.org/files/9e2/1a4/62a/9e21a462a5794b7b820619abc4edb1ec.jpg"> <br>   ,  ¬´¬ª(F5). <br> <img src="//habrastorage.org/files/f25/1a9/ff3/f251a9ff31c7413f96bf83dc1ee3a4e6.jpg"> <br>   ‚Äì  ,       (   ‚Äì XSLT).  Enter. <br> <br>         XSLT,        .  ,        ,    ‚Äì  . <br> <br>        , ..,   ,         (   ,    , ,   html ). <br> <br>    ,       , ..    .      <br> <code class="xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsl</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/1999/XSL/Transform"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:sap</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/sapxsl"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:strip-space</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">elements</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> : <br> <code>xmlns:xsl</code> ,       xsl. ..       ,       <code>xsl</code> : ( <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:strip-space</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">elements</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> ) <code>xmlns:sap</code> ,       sap <code>xsl:transform</code> ,     XSLT- <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:strip-space</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">elements</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag">/&gt;</span></span></code>      <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span></code>   ,       XML  <br> <br> XSLT-      ( <code>xsl:template</code> )     XML-,      <code>match</code> .   <code>match</code>      <a href="http://ru.wikipedia.org/wiki/XPath">XPath</a> .    ,     ¬´/¬ª,      XML- <code>TABLE</code>    "/asx:abap/asx:values/TABLE" (..    XML-   ( <code>asx:abap</code> )    ( <code>TABLE</code> )). <br> <br>  ,      XML- List.   : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>        <code>item</code>   <code>TABLE</code>   XML ,      <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:values/TABLE/item"</span></span></span><span class="hljs-tag">&gt;</span></span></code> ,    <code>select</code>  XPath   ,     .       <code>MyItem</code> ,     <code>Name</code>   NAME    ,    .  ,       : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:values/TABLE/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>        <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> ,   <code>select</code>   XPath-  ,     .  ,    <code>xsl:value-of</code>   ,   <code>xsl:for-each</code> .   ,   <code>xsl:for-each</code>   ,    ,   <code>xsl:value-of</code> ‚Äì     (..    <code>xsl:for-each</code> ). <br>  ,   ,         . <br>  ,            <code>asx, sap, prg</code> (XSLT     ).       XML,  <code>xsl:transform</code>  : <br> <code class="xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsl</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/1999/XSL/Transform"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:sap</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/sapxsl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:asx</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/abapxml"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:prg</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">exclude-result-prefixes</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"asx sap prg"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> ..     ,    <code>exclude-result-prefixes</code>  ,       XML. <br>        ,       <code>RF_CHILD_LIST</code> .        .   ‚Äì   . <br> ,    id   .    <code>ChilListID</code> .     . <br>      : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"OutChilds"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> ..      <code>OutChilds</code>   <code>ChilListID</code> .  ,       XML-,    <code>/asx:abap/asx:heap</code> . <br> <br>       ?    item   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> .        <code>xsl:for-each</code> . <br>   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> : <br> <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]"</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br>  XPath ,        <code>prg:T_DEEP_STRUCT</code> ,    <code>id</code>   <code>ChilListID</code> . <br>        item: <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"item"</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> ,        ,   ,    , XSLT  .     : <br> <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]/item"</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>   <code>MyItem</code>   <code>Name</code> .    : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"OutChilds"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>      .    :      . <br>     <code>xsl:apply-templates</code> ,     <code>select</code>     XML      . <br>  ,  ,       <code>ChilListID</code> . ,      ,    <code>RF_CHILD_LIST</code>  <code>href,</code>    <code>#id___</code> . ..     <code>href</code>     ,    .     XPath  : <code>substring(RF_CHILD_LIST/@href,2)</code> . ..     : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:with-param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"substring(RF_CHILD_LIST/@href,2)"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>  ,     : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"OutChilds"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:with-param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"substring(RF_CHILD_LIST/@href,2)"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>  ,  ,     ,    . <br> <br> <b class="spoiler_title"> ,      :</b> <code class="xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsl</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/1999/XSL/Transform"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:sap</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/sapxsl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:asx</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/abapxml"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:prg</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">exclude-result-prefixes</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"asx sap prg"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:strip-space</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">elements</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--       , .   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--         XML --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:values/TABLE/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  NAMR  --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--      ,        --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:with-param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"substring(RF_CHILD_LIST/@href,2)"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--     --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"OutChilds"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  , id    ,   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--    --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:with-param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"substring(RF_CHILD_LIST/@href,2)"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> <br> <b class="spoiler_title">  ABAP-</b> <code class="bash">REPORT zedu_test_xslt_deep_transform. *      "   " TYPES : BEGIN OF tdeep_struct , name TYPE string , rf_child_list TYPE REF TO data , END OF tdeep_struct *       "   " , t_deep_struct TYPE STANDARD TABLE OF tdeep_struct WITH NON-UNIQUE DEFAULT KEY . DATA : gt_tree TYPE t_deep_struct "  , gtree TYPE tdeep_struct "       , gchild TYPE tdeep_struct "       , ggrandchild TYPE tdeep_struct "       , gxml_str TYPE string "  XML , go_xml_doc TYPE REF TO cl_xml_document "    XML . FIELD-SYMBOLS : <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_child_list</span></span></span><span class="hljs-tag">&gt;</span></span> TYPE t_deep_struct "    , <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_grandchild_list</span></span></span><span class="hljs-tag">&gt;</span></span> TYPE t_deep_struct "    . START-OF-SELECTION. *    gtree-name = 'GrandParent1'. CREATE DATA gtree-rf_child_list TYPE t_deep_struct. ASSIGN gtree-rf_child_list-&gt;* TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_child_list</span></span></span><span class="hljs-tag">&gt;</span></span>. gchild-name = 'Child1'. APPEND gchild TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_child_list</span></span></span><span class="hljs-tag">&gt;</span></span>. gchild-name = 'Child2'. CREATE DATA gchild-rf_child_list TYPE t_deep_struct. ASSIGN gchild-rf_child_list-&gt;* TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_grandchild_list</span></span></span><span class="hljs-tag">&gt;</span></span>. ggrandchild-name = 'GrandChild1'. APPEND ggrandchild TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_grandchild_list</span></span></span><span class="hljs-tag">&gt;</span></span>. APPEND gchild TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_child_list</span></span></span><span class="hljs-tag">&gt;</span></span>. APPEND gtree TO gt_tree. CLEAR gtree. gtree-name = 'GrandParent2'. APPEND gtree TO gt_tree. * XSLT- CALL TRANSFORMATION zedu_test_xslt_deep_transform2 SOURCE table = gt_tree RESULT XML gxml_str. *    XML CREATE OBJECT go_xml_doc. go_xml_doc-&gt;parse_string( gxml_str ). go_xml_doc-&gt;display( ).</code> <br> <br> <br>  <br>  ,      XSLT  ? <br> <br>   <br> <a href="http://help.sap.com/abapdocu_70/en/ABAPCALL_TRANSFORMATION.htm"> ABAP</a> <a href="http://msdn.microsoft.com/ru-ru/library/ms256069%2528v%3Dvs.110%2529.aspx">MSDN:   XSLT</a> <a href="http://zvon.org/comp/r/tut-XPath_1.html">XPath tutorial</a> <a href="http://www.w3.org/TR/xslt"> XSLT</a></code></code> </pre> <code><code><code>,         .           . ..      RF_CHILD_LIST</code> ,      DATA ( <code>TYPE REF TO DATA</code> ),      ,     <code>href</code>     ,    . <br> ,     <code>&lt;RF_CHILD_LIST href="#d1" /&gt;</code> ,   <code>#</code> -       <a href="http://ru.wikipedia.org/wiki/XLink">XLink</a> ,  <code>d1</code> ‚Äì  .         XML-: <code>asx:heap</code>  ,   <code>id</code>  d1.    &lt; <code>prg:T_DEEP_STRUCT id="d1" ‚Ä¶ &gt;</code> .      ,         . <br> ..,    XML   ,  . <br> <br>  XSLT- ? <br>     XSLT-. <br>  SAP      STRANS. <br> <img src="//habrastorage.org/files/9e2/1a4/62a/9e21a462a5794b7b820619abc4edb1ec.jpg"> <br>   ,  ¬´¬ª(F5). <br> <img src="//habrastorage.org/files/f25/1a9/ff3/f251a9ff31c7413f96bf83dc1ee3a4e6.jpg"> <br>   ‚Äì  ,       (   ‚Äì XSLT).  Enter. <br> <br>         XSLT,        .  ,        ,    ‚Äì  . <br> <br>        , ..,   ,         (   ,    , ,   html ). <br> <br>    ,       , ..    .      <br> <code class="xml">&lt;xsl:transform version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;xsl:template match="/"&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> : <br> <code>xmlns:xsl</code> ,       xsl. ..       ,       <code>xsl</code> : ( <code>&lt;xsl:strip-space elements="*"/&gt;</code> ) <code>xmlns:sap</code> ,       sap <code>xsl:transform</code> ,     XSLT- <code>&lt;xsl:strip-space elements="*"/&gt;</code>      <code>&lt;xsl:template match="/"&gt;</code>   ,       XML  <br> <br> XSLT-      ( <code>xsl:template</code> )     XML-,      <code>match</code> .   <code>match</code>      <a href="http://ru.wikipedia.org/wiki/XPath">XPath</a> .    ,     ¬´/¬ª,      XML- <code>TABLE</code>    "/asx:abap/asx:values/TABLE" (..    XML-   ( <code>asx:abap</code> )    ( <code>TABLE</code> )). <br> <br>  ,      XML- List.   : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>item</code>   <code>TABLE</code>   XML ,      <code>&lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt;</code> ,    <code>select</code>  XPath   ,     .       <code>MyItem</code> ,     <code>Name</code>   NAME    ,    .  ,       : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>&lt;xsl:value-of select="NAME"/&gt;</code> ,   <code>select</code>   XPath-  ,     .  ,    <code>xsl:value-of</code>   ,   <code>xsl:for-each</code> .   ,   <code>xsl:for-each</code>   ,    ,   <code>xsl:value-of</code> ‚Äì     (..    <code>xsl:for-each</code> ). <br>  ,   ,         . <br>  ,            <code>asx, sap, prg</code> (XSLT     ).       XML,  <code>xsl:transform</code>  : <br> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt;</code> <br> <br> ..     ,    <code>exclude-result-prefixes</code>  ,       XML. <br>        ,       <code>RF_CHILD_LIST</code> .        .   ‚Äì   . <br> ,    id   .    <code>ChilListID</code> .     . <br>      : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;/xsl:template&gt;</code> <br> <br> ..      <code>OutChilds</code>   <code>ChilListID</code> .  ,       XML-,    <code>/asx:abap/asx:heap</code> . <br> <br>       ?    item   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> .        <code>xsl:for-each</code> . <br>   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]"&gt;</code> <br>  XPath ,        <code>prg:T_DEEP_STRUCT</code> ,    <code>id</code>   <code>ChilListID</code> . <br>        item: <code>&lt;xsl:for-each select="item"&gt;</code> <br> <br> ,        ,   ,    , XSLT  .     : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt;</code> <br> <br>   <code>MyItem</code>   <code>Name</code> .    : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>      .    :      . <br>     <code>xsl:apply-templates</code> ,     <code>select</code>     XML      . <br>  ,  ,       <code>ChilListID</code> . ,      ,    <code>RF_CHILD_LIST</code>  <code>href,</code>    <code>#id___</code> . ..     <code>href</code>     ,    .     XPath  : <code>substring(RF_CHILD_LIST/@href,2)</code> . ..     : <br> <code class="xml"> &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt;</code> <br> <br>  ,     : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>  ,  ,     ,    . <br> <br> <b class="spoiler_title"> ,      :</b> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;!--       , .   --&gt; &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;!--         XML --&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;!--  NAMR  --&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--      ,        --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt; &lt;!--     --&gt; &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;!--   --&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;!--  , id    ,   --&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--    --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> <br> <b class="spoiler_title">  ABAP-</b> <code class="bash">REPORT zedu_test_xslt_deep_transform. *      "   " TYPES : BEGIN OF tdeep_struct , name TYPE string , rf_child_list TYPE REF TO data , END OF tdeep_struct *       "   " , t_deep_struct TYPE STANDARD TABLE OF tdeep_struct WITH NON-UNIQUE DEFAULT KEY . DATA : gt_tree TYPE t_deep_struct "  , gtree TYPE tdeep_struct "       , gchild TYPE tdeep_struct "       , ggrandchild TYPE tdeep_struct "       , gxml_str TYPE string "  XML , go_xml_doc TYPE REF TO cl_xml_document "    XML . FIELD-SYMBOLS : &lt;gt_child_list&gt; TYPE t_deep_struct "    , &lt;gt_grandchild_list&gt; TYPE t_deep_struct "    . START-OF-SELECTION. *    gtree-name = 'GrandParent1'. CREATE DATA gtree-rf_child_list TYPE t_deep_struct. ASSIGN gtree-rf_child_list-&gt;* TO &lt;gt_child_list&gt;. gchild-name = 'Child1'. APPEND gchild TO &lt;gt_child_list&gt;. gchild-name = 'Child2'. CREATE DATA gchild-rf_child_list TYPE t_deep_struct. ASSIGN gchild-rf_child_list-&gt;* TO &lt;gt_grandchild_list&gt;. ggrandchild-name = 'GrandChild1'. APPEND ggrandchild TO &lt;gt_grandchild_list&gt;. APPEND gchild TO &lt;gt_child_list&gt;. APPEND gtree TO gt_tree. CLEAR gtree. gtree-name = 'GrandParent2'. APPEND gtree TO gt_tree. * XSLT- CALL TRANSFORMATION zedu_test_xslt_deep_transform2 SOURCE table = gt_tree RESULT XML gxml_str. *    XML CREATE OBJECT go_xml_doc. go_xml_doc-&gt;parse_string( gxml_str ). go_xml_doc-&gt;display( ).</code> <br> <br> <br>  <br>  ,      XSLT  ? <br> <br>   <br> <a href="http://help.sap.com/abapdocu_70/en/ABAPCALL_TRANSFORMATION.htm"> ABAP</a> <a href="http://msdn.microsoft.com/ru-ru/library/ms256069%2528v%3Dvs.110%2529.aspx">MSDN:   XSLT</a> <a href="http://zvon.org/comp/r/tut-XPath_1.html">XPath tutorial</a> <a href="http://www.w3.org/TR/xslt"> XSLT</a></code></code> <pre> <code class="hljs xml"><code><code>,         .           . ..      RF_CHILD_LIST</code> ,      DATA ( <code>TYPE REF TO DATA</code> ),      ,     <code>href</code>     ,    . <br> ,     <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RF_CHILD_LIST</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#d1"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> ,   <code>#</code> -       <a href="http://ru.wikipedia.org/wiki/XLink">XLink</a> ,  <code>d1</code> ‚Äì  .         XML-: <code>asx:heap</code>  ,   <code>id</code>  d1.    <span class="hljs-tag"><span class="hljs-tag">&lt; </span></span><code><span class="hljs-tag"><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">prg:T_DEEP_STRUCT</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"d1"</span></span></span><span class="hljs-tag"> ‚Ä¶ &gt;</span></span></code> .      ,         . <br> ..,    XML   ,  . <br> <br>  XSLT- ? <br>     XSLT-. <br>  SAP      STRANS. <br> <img src="//habrastorage.org/files/9e2/1a4/62a/9e21a462a5794b7b820619abc4edb1ec.jpg"> <br>   ,  ¬´¬ª(F5). <br> <img src="//habrastorage.org/files/f25/1a9/ff3/f251a9ff31c7413f96bf83dc1ee3a4e6.jpg"> <br>   ‚Äì  ,       (   ‚Äì XSLT).  Enter. <br> <br>         XSLT,        .  ,        ,    ‚Äì  . <br> <br>        , ..,   ,         (   ,    , ,   html ). <br> <br>    ,       , ..    .      <br> <code class="xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsl</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/1999/XSL/Transform"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:sap</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/sapxsl"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:strip-space</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">elements</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> : <br> <code>xmlns:xsl</code> ,       xsl. ..       ,       <code>xsl</code> : ( <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:strip-space</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">elements</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> ) <code>xmlns:sap</code> ,       sap <code>xsl:transform</code> ,     XSLT- <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:strip-space</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">elements</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag">/&gt;</span></span></code>      <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span></code>   ,       XML  <br> <br> XSLT-      ( <code>xsl:template</code> )     XML-,      <code>match</code> .   <code>match</code>      <a href="http://ru.wikipedia.org/wiki/XPath">XPath</a> .    ,     ¬´/¬ª,      XML- <code>TABLE</code>    "/asx:abap/asx:values/TABLE" (..    XML-   ( <code>asx:abap</code> )    ( <code>TABLE</code> )). <br> <br>  ,      XML- List.   : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>        <code>item</code>   <code>TABLE</code>   XML ,      <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:values/TABLE/item"</span></span></span><span class="hljs-tag">&gt;</span></span></code> ,    <code>select</code>  XPath   ,     .       <code>MyItem</code> ,     <code>Name</code>   NAME    ,    .  ,       : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:values/TABLE/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>        <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> ,   <code>select</code>   XPath-  ,     .  ,    <code>xsl:value-of</code>   ,   <code>xsl:for-each</code> .   ,   <code>xsl:for-each</code>   ,    ,   <code>xsl:value-of</code> ‚Äì     (..    <code>xsl:for-each</code> ). <br>  ,   ,         . <br>  ,            <code>asx, sap, prg</code> (XSLT     ).       XML,  <code>xsl:transform</code>  : <br> <code class="xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsl</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/1999/XSL/Transform"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:sap</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/sapxsl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:asx</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/abapxml"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:prg</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">exclude-result-prefixes</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"asx sap prg"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> ..     ,    <code>exclude-result-prefixes</code>  ,       XML. <br>        ,       <code>RF_CHILD_LIST</code> .        .   ‚Äì   . <br> ,    id   .    <code>ChilListID</code> .     . <br>      : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"OutChilds"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> ..      <code>OutChilds</code>   <code>ChilListID</code> .  ,       XML-,    <code>/asx:abap/asx:heap</code> . <br> <br>       ?    item   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> .        <code>xsl:for-each</code> . <br>   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> : <br> <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]"</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br>  XPath ,        <code>prg:T_DEEP_STRUCT</code> ,    <code>id</code>   <code>ChilListID</code> . <br>        item: <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"item"</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> ,        ,   ,    , XSLT  .     : <br> <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]/item"</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>   <code>MyItem</code>   <code>Name</code> .    : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"OutChilds"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>      .    :      . <br>     <code>xsl:apply-templates</code> ,     <code>select</code>     XML      . <br>  ,  ,       <code>ChilListID</code> . ,      ,    <code>RF_CHILD_LIST</code>  <code>href,</code>    <code>#id___</code> . ..     <code>href</code>     ,    .     XPath  : <code>substring(RF_CHILD_LIST/@href,2)</code> . ..     : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:with-param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"substring(RF_CHILD_LIST/@href,2)"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>  ,     : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"OutChilds"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:with-param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"substring(RF_CHILD_LIST/@href,2)"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>  ,  ,     ,    . <br> <br> <b class="spoiler_title"> ,      :</b> <code class="xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsl</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/1999/XSL/Transform"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:sap</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/sapxsl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:asx</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/abapxml"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:prg</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">exclude-result-prefixes</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"asx sap prg"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:strip-space</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">elements</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--       , .   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--         XML --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:values/TABLE/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  NAMR  --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--      ,        --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:with-param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"substring(RF_CHILD_LIST/@href,2)"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--     --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"OutChilds"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  , id    ,   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--    --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:with-param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"substring(RF_CHILD_LIST/@href,2)"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> <br> <b class="spoiler_title">  ABAP-</b> <code class="bash">REPORT zedu_test_xslt_deep_transform. *      "   " TYPES : BEGIN OF tdeep_struct , name TYPE string , rf_child_list TYPE REF TO data , END OF tdeep_struct *       "   " , t_deep_struct TYPE STANDARD TABLE OF tdeep_struct WITH NON-UNIQUE DEFAULT KEY . DATA : gt_tree TYPE t_deep_struct "  , gtree TYPE tdeep_struct "       , gchild TYPE tdeep_struct "       , ggrandchild TYPE tdeep_struct "       , gxml_str TYPE string "  XML , go_xml_doc TYPE REF TO cl_xml_document "    XML . FIELD-SYMBOLS : <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_child_list</span></span></span><span class="hljs-tag">&gt;</span></span> TYPE t_deep_struct "    , <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_grandchild_list</span></span></span><span class="hljs-tag">&gt;</span></span> TYPE t_deep_struct "    . START-OF-SELECTION. *    gtree-name = 'GrandParent1'. CREATE DATA gtree-rf_child_list TYPE t_deep_struct. ASSIGN gtree-rf_child_list-&gt;* TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_child_list</span></span></span><span class="hljs-tag">&gt;</span></span>. gchild-name = 'Child1'. APPEND gchild TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_child_list</span></span></span><span class="hljs-tag">&gt;</span></span>. gchild-name = 'Child2'. CREATE DATA gchild-rf_child_list TYPE t_deep_struct. ASSIGN gchild-rf_child_list-&gt;* TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_grandchild_list</span></span></span><span class="hljs-tag">&gt;</span></span>. ggrandchild-name = 'GrandChild1'. APPEND ggrandchild TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_grandchild_list</span></span></span><span class="hljs-tag">&gt;</span></span>. APPEND gchild TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_child_list</span></span></span><span class="hljs-tag">&gt;</span></span>. APPEND gtree TO gt_tree. CLEAR gtree. gtree-name = 'GrandParent2'. APPEND gtree TO gt_tree. * XSLT- CALL TRANSFORMATION zedu_test_xslt_deep_transform2 SOURCE table = gt_tree RESULT XML gxml_str. *    XML CREATE OBJECT go_xml_doc. go_xml_doc-&gt;parse_string( gxml_str ). go_xml_doc-&gt;display( ).</code> <br> <br> <br>  <br>  ,      XSLT  ? <br> <br>   <br> <a href="http://help.sap.com/abapdocu_70/en/ABAPCALL_TRANSFORMATION.htm"> ABAP</a> <a href="http://msdn.microsoft.com/ru-ru/library/ms256069%2528v%3Dvs.110%2529.aspx">MSDN:   XSLT</a> <a href="http://zvon.org/comp/r/tut-XPath_1.html">XPath tutorial</a> <a href="http://www.w3.org/TR/xslt"> XSLT</a></code></code> </pre> <code><code><code>,         .           . ..      RF_CHILD_LIST</code> ,      DATA ( <code>TYPE REF TO DATA</code> ),      ,     <code>href</code>     ,    . <br> ,     <code>&lt;RF_CHILD_LIST href="#d1" /&gt;</code> ,   <code>#</code> -       <a href="http://ru.wikipedia.org/wiki/XLink">XLink</a> ,  <code>d1</code> ‚Äì  .         XML-: <code>asx:heap</code>  ,   <code>id</code>  d1.    &lt; <code>prg:T_DEEP_STRUCT id="d1" ‚Ä¶ &gt;</code> .      ,         . <br> ..,    XML   ,  . <br> <br>  XSLT- ? <br>     XSLT-. <br>  SAP      STRANS. <br> <img src="//habrastorage.org/files/9e2/1a4/62a/9e21a462a5794b7b820619abc4edb1ec.jpg"> <br>   ,  ¬´¬ª(F5). <br> <img src="//habrastorage.org/files/f25/1a9/ff3/f251a9ff31c7413f96bf83dc1ee3a4e6.jpg"> <br>   ‚Äì  ,       (   ‚Äì XSLT).  Enter. <br> <br>         XSLT,        .  ,        ,    ‚Äì  . <br> <br>        , ..,   ,         (   ,    , ,   html ). <br> <br>    ,       , ..    .      <br> <code class="xml">&lt;xsl:transform version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;xsl:template match="/"&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> : <br> <code>xmlns:xsl</code> ,       xsl. ..       ,       <code>xsl</code> : ( <code>&lt;xsl:strip-space elements="*"/&gt;</code> ) <code>xmlns:sap</code> ,       sap <code>xsl:transform</code> ,     XSLT- <code>&lt;xsl:strip-space elements="*"/&gt;</code>      <code>&lt;xsl:template match="/"&gt;</code>   ,       XML  <br> <br> XSLT-      ( <code>xsl:template</code> )     XML-,      <code>match</code> .   <code>match</code>      <a href="http://ru.wikipedia.org/wiki/XPath">XPath</a> .    ,     ¬´/¬ª,      XML- <code>TABLE</code>    "/asx:abap/asx:values/TABLE" (..    XML-   ( <code>asx:abap</code> )    ( <code>TABLE</code> )). <br> <br>  ,      XML- List.   : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>item</code>   <code>TABLE</code>   XML ,      <code>&lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt;</code> ,    <code>select</code>  XPath   ,     .       <code>MyItem</code> ,     <code>Name</code>   NAME    ,    .  ,       : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>&lt;xsl:value-of select="NAME"/&gt;</code> ,   <code>select</code>   XPath-  ,     .  ,    <code>xsl:value-of</code>   ,   <code>xsl:for-each</code> .   ,   <code>xsl:for-each</code>   ,    ,   <code>xsl:value-of</code> ‚Äì     (..    <code>xsl:for-each</code> ). <br>  ,   ,         . <br>  ,            <code>asx, sap, prg</code> (XSLT     ).       XML,  <code>xsl:transform</code>  : <br> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt;</code> <br> <br> ..     ,    <code>exclude-result-prefixes</code>  ,       XML. <br>        ,       <code>RF_CHILD_LIST</code> .        .   ‚Äì   . <br> ,    id   .    <code>ChilListID</code> .     . <br>      : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;/xsl:template&gt;</code> <br> <br> ..      <code>OutChilds</code>   <code>ChilListID</code> .  ,       XML-,    <code>/asx:abap/asx:heap</code> . <br> <br>       ?    item   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> .        <code>xsl:for-each</code> . <br>   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]"&gt;</code> <br>  XPath ,        <code>prg:T_DEEP_STRUCT</code> ,    <code>id</code>   <code>ChilListID</code> . <br>        item: <code>&lt;xsl:for-each select="item"&gt;</code> <br> <br> ,        ,   ,    , XSLT  .     : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt;</code> <br> <br>   <code>MyItem</code>   <code>Name</code> .    : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>      .    :      . <br>     <code>xsl:apply-templates</code> ,     <code>select</code>     XML      . <br>  ,  ,       <code>ChilListID</code> . ,      ,    <code>RF_CHILD_LIST</code>  <code>href,</code>    <code>#id___</code> . ..     <code>href</code>     ,    .     XPath  : <code>substring(RF_CHILD_LIST/@href,2)</code> . ..     : <br> <code class="xml"> &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt;</code> <br> <br>  ,     : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>  ,  ,     ,    . <br> <br> <b class="spoiler_title"> ,      :</b> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;!--       , .   --&gt; &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;!--         XML --&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;!--  NAMR  --&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--      ,        --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt; &lt;!--     --&gt; &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;!--   --&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;!--  , id    ,   --&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--    --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> <br> <b class="spoiler_title">  ABAP-</b> <code class="bash">REPORT zedu_test_xslt_deep_transform. *      "   " TYPES : BEGIN OF tdeep_struct , name TYPE string , rf_child_list TYPE REF TO data , END OF tdeep_struct *       "   " , t_deep_struct TYPE STANDARD TABLE OF tdeep_struct WITH NON-UNIQUE DEFAULT KEY . DATA : gt_tree TYPE t_deep_struct "  , gtree TYPE tdeep_struct "       , gchild TYPE tdeep_struct "       , ggrandchild TYPE tdeep_struct "       , gxml_str TYPE string "  XML , go_xml_doc TYPE REF TO cl_xml_document "    XML . FIELD-SYMBOLS : &lt;gt_child_list&gt; TYPE t_deep_struct "    , &lt;gt_grandchild_list&gt; TYPE t_deep_struct "    . START-OF-SELECTION. *    gtree-name = 'GrandParent1'. CREATE DATA gtree-rf_child_list TYPE t_deep_struct. ASSIGN gtree-rf_child_list-&gt;* TO &lt;gt_child_list&gt;. gchild-name = 'Child1'. APPEND gchild TO &lt;gt_child_list&gt;. gchild-name = 'Child2'. CREATE DATA gchild-rf_child_list TYPE t_deep_struct. ASSIGN gchild-rf_child_list-&gt;* TO &lt;gt_grandchild_list&gt;. ggrandchild-name = 'GrandChild1'. APPEND ggrandchild TO &lt;gt_grandchild_list&gt;. APPEND gchild TO &lt;gt_child_list&gt;. APPEND gtree TO gt_tree. CLEAR gtree. gtree-name = 'GrandParent2'. APPEND gtree TO gt_tree. * XSLT- CALL TRANSFORMATION zedu_test_xslt_deep_transform2 SOURCE table = gt_tree RESULT XML gxml_str. *    XML CREATE OBJECT go_xml_doc. go_xml_doc-&gt;parse_string( gxml_str ). go_xml_doc-&gt;display( ).</code> <br> <br> <br>  <br>  ,      XSLT  ? <br> <br>   <br> <a href="http://help.sap.com/abapdocu_70/en/ABAPCALL_TRANSFORMATION.htm"> ABAP</a> <a href="http://msdn.microsoft.com/ru-ru/library/ms256069%2528v%3Dvs.110%2529.aspx">MSDN:   XSLT</a> <a href="http://zvon.org/comp/r/tut-XPath_1.html">XPath tutorial</a> <a href="http://www.w3.org/TR/xslt"> XSLT</a></code></code> <pre> <code class="hljs xml"><code><code>,         .           . ..      RF_CHILD_LIST</code> ,      DATA ( <code>TYPE REF TO DATA</code> ),      ,     <code>href</code>     ,    . <br> ,     <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RF_CHILD_LIST</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#d1"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> ,   <code>#</code> -       <a href="http://ru.wikipedia.org/wiki/XLink">XLink</a> ,  <code>d1</code> ‚Äì  .         XML-: <code>asx:heap</code>  ,   <code>id</code>  d1.    <span class="hljs-tag"><span class="hljs-tag">&lt; </span></span><code><span class="hljs-tag"><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">prg:T_DEEP_STRUCT</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"d1"</span></span></span><span class="hljs-tag"> ‚Ä¶ &gt;</span></span></code> .      ,         . <br> ..,    XML   ,  . <br> <br>  XSLT- ? <br>     XSLT-. <br>  SAP      STRANS. <br> <img src="//habrastorage.org/files/9e2/1a4/62a/9e21a462a5794b7b820619abc4edb1ec.jpg"> <br>   ,  ¬´¬ª(F5). <br> <img src="//habrastorage.org/files/f25/1a9/ff3/f251a9ff31c7413f96bf83dc1ee3a4e6.jpg"> <br>   ‚Äì  ,       (   ‚Äì XSLT).  Enter. <br> <br>         XSLT,        .  ,        ,    ‚Äì  . <br> <br>        , ..,   ,         (   ,    , ,   html ). <br> <br>    ,       , ..    .      <br> <code class="xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsl</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/1999/XSL/Transform"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:sap</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/sapxsl"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:strip-space</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">elements</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> : <br> <code>xmlns:xsl</code> ,       xsl. ..       ,       <code>xsl</code> : ( <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:strip-space</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">elements</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> ) <code>xmlns:sap</code> ,       sap <code>xsl:transform</code> ,     XSLT- <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:strip-space</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">elements</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag">/&gt;</span></span></code>      <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span></code>   ,       XML  <br> <br> XSLT-      ( <code>xsl:template</code> )     XML-,      <code>match</code> .   <code>match</code>      <a href="http://ru.wikipedia.org/wiki/XPath">XPath</a> .    ,     ¬´/¬ª,      XML- <code>TABLE</code>    "/asx:abap/asx:values/TABLE" (..    XML-   ( <code>asx:abap</code> )    ( <code>TABLE</code> )). <br> <br>  ,      XML- List.   : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>        <code>item</code>   <code>TABLE</code>   XML ,      <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:values/TABLE/item"</span></span></span><span class="hljs-tag">&gt;</span></span></code> ,    <code>select</code>  XPath   ,     .       <code>MyItem</code> ,     <code>Name</code>   NAME    ,    .  ,       : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:values/TABLE/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>        <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> ,   <code>select</code>   XPath-  ,     .  ,    <code>xsl:value-of</code>   ,   <code>xsl:for-each</code> .   ,   <code>xsl:for-each</code>   ,    ,   <code>xsl:value-of</code> ‚Äì     (..    <code>xsl:for-each</code> ). <br>  ,   ,         . <br>  ,            <code>asx, sap, prg</code> (XSLT     ).       XML,  <code>xsl:transform</code>  : <br> <code class="xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsl</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/1999/XSL/Transform"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:sap</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/sapxsl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:asx</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/abapxml"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:prg</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">exclude-result-prefixes</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"asx sap prg"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> ..     ,    <code>exclude-result-prefixes</code>  ,       XML. <br>        ,       <code>RF_CHILD_LIST</code> .        .   ‚Äì   . <br> ,    id   .    <code>ChilListID</code> .     . <br>      : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"OutChilds"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> ..      <code>OutChilds</code>   <code>ChilListID</code> .  ,       XML-,    <code>/asx:abap/asx:heap</code> . <br> <br>       ?    item   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> .        <code>xsl:for-each</code> . <br>   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> : <br> <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]"</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br>  XPath ,        <code>prg:T_DEEP_STRUCT</code> ,    <code>id</code>   <code>ChilListID</code> . <br>        item: <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"item"</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> ,        ,   ,    , XSLT  .     : <br> <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]/item"</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>   <code>MyItem</code>   <code>Name</code> .    : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"OutChilds"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>      .    :      . <br>     <code>xsl:apply-templates</code> ,     <code>select</code>     XML      . <br>  ,  ,       <code>ChilListID</code> . ,      ,    <code>RF_CHILD_LIST</code>  <code>href,</code>    <code>#id___</code> . ..     <code>href</code>     ,    .     XPath  : <code>substring(RF_CHILD_LIST/@href,2)</code> . ..     : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:with-param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"substring(RF_CHILD_LIST/@href,2)"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>  ,     : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"OutChilds"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:with-param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"substring(RF_CHILD_LIST/@href,2)"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>  ,  ,     ,    . <br> <br> <b class="spoiler_title"> ,      :</b> <code class="xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsl</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/1999/XSL/Transform"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:sap</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/sapxsl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:asx</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/abapxml"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:prg</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">exclude-result-prefixes</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"asx sap prg"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:strip-space</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">elements</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--       , .   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--         XML --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:values/TABLE/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  NAMR  --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--      ,        --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:with-param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"substring(RF_CHILD_LIST/@href,2)"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--     --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"OutChilds"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  , id    ,   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--    --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:with-param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"substring(RF_CHILD_LIST/@href,2)"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> <br> <b class="spoiler_title">  ABAP-</b> <code class="bash">REPORT zedu_test_xslt_deep_transform. *      "   " TYPES : BEGIN OF tdeep_struct , name TYPE string , rf_child_list TYPE REF TO data , END OF tdeep_struct *       "   " , t_deep_struct TYPE STANDARD TABLE OF tdeep_struct WITH NON-UNIQUE DEFAULT KEY . DATA : gt_tree TYPE t_deep_struct "  , gtree TYPE tdeep_struct "       , gchild TYPE tdeep_struct "       , ggrandchild TYPE tdeep_struct "       , gxml_str TYPE string "  XML , go_xml_doc TYPE REF TO cl_xml_document "    XML . FIELD-SYMBOLS : <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_child_list</span></span></span><span class="hljs-tag">&gt;</span></span> TYPE t_deep_struct "    , <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_grandchild_list</span></span></span><span class="hljs-tag">&gt;</span></span> TYPE t_deep_struct "    . START-OF-SELECTION. *    gtree-name = 'GrandParent1'. CREATE DATA gtree-rf_child_list TYPE t_deep_struct. ASSIGN gtree-rf_child_list-&gt;* TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_child_list</span></span></span><span class="hljs-tag">&gt;</span></span>. gchild-name = 'Child1'. APPEND gchild TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_child_list</span></span></span><span class="hljs-tag">&gt;</span></span>. gchild-name = 'Child2'. CREATE DATA gchild-rf_child_list TYPE t_deep_struct. ASSIGN gchild-rf_child_list-&gt;* TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_grandchild_list</span></span></span><span class="hljs-tag">&gt;</span></span>. ggrandchild-name = 'GrandChild1'. APPEND ggrandchild TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_grandchild_list</span></span></span><span class="hljs-tag">&gt;</span></span>. APPEND gchild TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_child_list</span></span></span><span class="hljs-tag">&gt;</span></span>. APPEND gtree TO gt_tree. CLEAR gtree. gtree-name = 'GrandParent2'. APPEND gtree TO gt_tree. * XSLT- CALL TRANSFORMATION zedu_test_xslt_deep_transform2 SOURCE table = gt_tree RESULT XML gxml_str. *    XML CREATE OBJECT go_xml_doc. go_xml_doc-&gt;parse_string( gxml_str ). go_xml_doc-&gt;display( ).</code> <br> <br> <br>  <br>  ,      XSLT  ? <br> <br>   <br> <a href="http://help.sap.com/abapdocu_70/en/ABAPCALL_TRANSFORMATION.htm"> ABAP</a> <a href="http://msdn.microsoft.com/ru-ru/library/ms256069%2528v%3Dvs.110%2529.aspx">MSDN:   XSLT</a> <a href="http://zvon.org/comp/r/tut-XPath_1.html">XPath tutorial</a> <a href="http://www.w3.org/TR/xslt"> XSLT</a></code></code> </pre> <code><code><code>,         .           . ..      RF_CHILD_LIST</code> ,      DATA ( <code>TYPE REF TO DATA</code> ),      ,     <code>href</code>     ,    . <br> ,     <code>&lt;RF_CHILD_LIST href="#d1" /&gt;</code> ,   <code>#</code> -       <a href="http://ru.wikipedia.org/wiki/XLink">XLink</a> ,  <code>d1</code> ‚Äì  .         XML-: <code>asx:heap</code>  ,   <code>id</code>  d1.    &lt; <code>prg:T_DEEP_STRUCT id="d1" ‚Ä¶ &gt;</code> .      ,         . <br> ..,    XML   ,  . <br> <br>  XSLT- ? <br>     XSLT-. <br>  SAP      STRANS. <br> <img src="//habrastorage.org/files/9e2/1a4/62a/9e21a462a5794b7b820619abc4edb1ec.jpg"> <br>   ,  ¬´¬ª(F5). <br> <img src="//habrastorage.org/files/f25/1a9/ff3/f251a9ff31c7413f96bf83dc1ee3a4e6.jpg"> <br>   ‚Äì  ,       (   ‚Äì XSLT).  Enter. <br> <br>         XSLT,        .  ,        ,    ‚Äì  . <br> <br>        , ..,   ,         (   ,    , ,   html ). <br> <br>    ,       , ..    .      <br> <code class="xml">&lt;xsl:transform version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;xsl:template match="/"&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> : <br> <code>xmlns:xsl</code> ,       xsl. ..       ,       <code>xsl</code> : ( <code>&lt;xsl:strip-space elements="*"/&gt;</code> ) <code>xmlns:sap</code> ,       sap <code>xsl:transform</code> ,     XSLT- <code>&lt;xsl:strip-space elements="*"/&gt;</code>      <code>&lt;xsl:template match="/"&gt;</code>   ,       XML  <br> <br> XSLT-      ( <code>xsl:template</code> )     XML-,      <code>match</code> .   <code>match</code>      <a href="http://ru.wikipedia.org/wiki/XPath">XPath</a> .    ,     ¬´/¬ª,      XML- <code>TABLE</code>    "/asx:abap/asx:values/TABLE" (..    XML-   ( <code>asx:abap</code> )    ( <code>TABLE</code> )). <br> <br>  ,      XML- List.   : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>item</code>   <code>TABLE</code>   XML ,      <code>&lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt;</code> ,    <code>select</code>  XPath   ,     .       <code>MyItem</code> ,     <code>Name</code>   NAME    ,    .  ,       : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>&lt;xsl:value-of select="NAME"/&gt;</code> ,   <code>select</code>   XPath-  ,     .  ,    <code>xsl:value-of</code>   ,   <code>xsl:for-each</code> .   ,   <code>xsl:for-each</code>   ,    ,   <code>xsl:value-of</code> ‚Äì     (..    <code>xsl:for-each</code> ). <br>  ,   ,         . <br>  ,            <code>asx, sap, prg</code> (XSLT     ).       XML,  <code>xsl:transform</code>  : <br> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt;</code> <br> <br> ..     ,    <code>exclude-result-prefixes</code>  ,       XML. <br>        ,       <code>RF_CHILD_LIST</code> .        .   ‚Äì   . <br> ,    id   .    <code>ChilListID</code> .     . <br>      : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;/xsl:template&gt;</code> <br> <br> ..      <code>OutChilds</code>   <code>ChilListID</code> .  ,       XML-,    <code>/asx:abap/asx:heap</code> . <br> <br>       ?    item   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> .        <code>xsl:for-each</code> . <br>   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]"&gt;</code> <br>  XPath ,        <code>prg:T_DEEP_STRUCT</code> ,    <code>id</code>   <code>ChilListID</code> . <br>        item: <code>&lt;xsl:for-each select="item"&gt;</code> <br> <br> ,        ,   ,    , XSLT  .     : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt;</code> <br> <br>   <code>MyItem</code>   <code>Name</code> .    : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>      .    :      . <br>     <code>xsl:apply-templates</code> ,     <code>select</code>     XML      . <br>  ,  ,       <code>ChilListID</code> . ,      ,    <code>RF_CHILD_LIST</code>  <code>href,</code>    <code>#id___</code> . ..     <code>href</code>     ,    .     XPath  : <code>substring(RF_CHILD_LIST/@href,2)</code> . ..     : <br> <code class="xml"> &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt;</code> <br> <br>  ,     : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>  ,  ,     ,    . <br> <br> <b class="spoiler_title"> ,      :</b> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;!--       , .   --&gt; &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;!--         XML --&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;!--  NAMR  --&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--      ,        --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt; &lt;!--     --&gt; &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;!--   --&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;!--  , id    ,   --&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--    --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> <br> <b class="spoiler_title">  ABAP-</b> <code class="bash">REPORT zedu_test_xslt_deep_transform. *      "   " TYPES : BEGIN OF tdeep_struct , name TYPE string , rf_child_list TYPE REF TO data , END OF tdeep_struct *       "   " , t_deep_struct TYPE STANDARD TABLE OF tdeep_struct WITH NON-UNIQUE DEFAULT KEY . DATA : gt_tree TYPE t_deep_struct "  , gtree TYPE tdeep_struct "       , gchild TYPE tdeep_struct "       , ggrandchild TYPE tdeep_struct "       , gxml_str TYPE string "  XML , go_xml_doc TYPE REF TO cl_xml_document "    XML . FIELD-SYMBOLS : &lt;gt_child_list&gt; TYPE t_deep_struct "    , &lt;gt_grandchild_list&gt; TYPE t_deep_struct "    . START-OF-SELECTION. *    gtree-name = 'GrandParent1'. CREATE DATA gtree-rf_child_list TYPE t_deep_struct. ASSIGN gtree-rf_child_list-&gt;* TO &lt;gt_child_list&gt;. gchild-name = 'Child1'. APPEND gchild TO &lt;gt_child_list&gt;. gchild-name = 'Child2'. CREATE DATA gchild-rf_child_list TYPE t_deep_struct. ASSIGN gchild-rf_child_list-&gt;* TO &lt;gt_grandchild_list&gt;. ggrandchild-name = 'GrandChild1'. APPEND ggrandchild TO &lt;gt_grandchild_list&gt;. APPEND gchild TO &lt;gt_child_list&gt;. APPEND gtree TO gt_tree. CLEAR gtree. gtree-name = 'GrandParent2'. APPEND gtree TO gt_tree. * XSLT- CALL TRANSFORMATION zedu_test_xslt_deep_transform2 SOURCE table = gt_tree RESULT XML gxml_str. *    XML CREATE OBJECT go_xml_doc. go_xml_doc-&gt;parse_string( gxml_str ). go_xml_doc-&gt;display( ).</code> <br> <br> <br>  <br>  ,      XSLT  ? <br> <br>   <br> <a href="http://help.sap.com/abapdocu_70/en/ABAPCALL_TRANSFORMATION.htm"> ABAP</a> <a href="http://msdn.microsoft.com/ru-ru/library/ms256069%2528v%3Dvs.110%2529.aspx">MSDN:   XSLT</a> <a href="http://zvon.org/comp/r/tut-XPath_1.html">XPath tutorial</a> <a href="http://www.w3.org/TR/xslt"> XSLT</a></code></code> <pre> <code class="hljs xml"><code><code>,         .           . ..      RF_CHILD_LIST</code> ,      DATA ( <code>TYPE REF TO DATA</code> ),      ,     <code>href</code>     ,    . <br> ,     <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RF_CHILD_LIST</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#d1"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> ,   <code>#</code> -       <a href="http://ru.wikipedia.org/wiki/XLink">XLink</a> ,  <code>d1</code> ‚Äì  .         XML-: <code>asx:heap</code>  ,   <code>id</code>  d1.    <span class="hljs-tag"><span class="hljs-tag">&lt; </span></span><code><span class="hljs-tag"><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">prg:T_DEEP_STRUCT</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"d1"</span></span></span><span class="hljs-tag"> ‚Ä¶ &gt;</span></span></code> .      ,         . <br> ..,    XML   ,  . <br> <br>  XSLT- ? <br>     XSLT-. <br>  SAP      STRANS. <br> <img src="//habrastorage.org/files/9e2/1a4/62a/9e21a462a5794b7b820619abc4edb1ec.jpg"> <br>   ,  ¬´¬ª(F5). <br> <img src="//habrastorage.org/files/f25/1a9/ff3/f251a9ff31c7413f96bf83dc1ee3a4e6.jpg"> <br>   ‚Äì  ,       (   ‚Äì XSLT).  Enter. <br> <br>         XSLT,        .  ,        ,    ‚Äì  . <br> <br>        , ..,   ,         (   ,    , ,   html ). <br> <br>    ,       , ..    .      <br> <code class="xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsl</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/1999/XSL/Transform"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:sap</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/sapxsl"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:strip-space</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">elements</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> : <br> <code>xmlns:xsl</code> ,       xsl. ..       ,       <code>xsl</code> : ( <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:strip-space</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">elements</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> ) <code>xmlns:sap</code> ,       sap <code>xsl:transform</code> ,     XSLT- <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:strip-space</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">elements</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag">/&gt;</span></span></code>      <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span></code>   ,       XML  <br> <br> XSLT-      ( <code>xsl:template</code> )     XML-,      <code>match</code> .   <code>match</code>      <a href="http://ru.wikipedia.org/wiki/XPath">XPath</a> .    ,     ¬´/¬ª,      XML- <code>TABLE</code>    "/asx:abap/asx:values/TABLE" (..    XML-   ( <code>asx:abap</code> )    ( <code>TABLE</code> )). <br> <br>  ,      XML- List.   : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>        <code>item</code>   <code>TABLE</code>   XML ,      <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:values/TABLE/item"</span></span></span><span class="hljs-tag">&gt;</span></span></code> ,    <code>select</code>  XPath   ,     .       <code>MyItem</code> ,     <code>Name</code>   NAME    ,    .  ,       : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:values/TABLE/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>        <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> ,   <code>select</code>   XPath-  ,     .  ,    <code>xsl:value-of</code>   ,   <code>xsl:for-each</code> .   ,   <code>xsl:for-each</code>   ,    ,   <code>xsl:value-of</code> ‚Äì     (..    <code>xsl:for-each</code> ). <br>  ,   ,         . <br>  ,            <code>asx, sap, prg</code> (XSLT     ).       XML,  <code>xsl:transform</code>  : <br> <code class="xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsl</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/1999/XSL/Transform"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:sap</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/sapxsl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:asx</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/abapxml"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:prg</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">exclude-result-prefixes</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"asx sap prg"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> ..     ,    <code>exclude-result-prefixes</code>  ,       XML. <br>        ,       <code>RF_CHILD_LIST</code> .        .   ‚Äì   . <br> ,    id   .    <code>ChilListID</code> .     . <br>      : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"OutChilds"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> ..      <code>OutChilds</code>   <code>ChilListID</code> .  ,       XML-,    <code>/asx:abap/asx:heap</code> . <br> <br>       ?    item   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> .        <code>xsl:for-each</code> . <br>   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> : <br> <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]"</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br>  XPath ,        <code>prg:T_DEEP_STRUCT</code> ,    <code>id</code>   <code>ChilListID</code> . <br>        item: <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"item"</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> ,        ,   ,    , XSLT  .     : <br> <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]/item"</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>   <code>MyItem</code>   <code>Name</code> .    : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"OutChilds"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>      .    :      . <br>     <code>xsl:apply-templates</code> ,     <code>select</code>     XML      . <br>  ,  ,       <code>ChilListID</code> . ,      ,    <code>RF_CHILD_LIST</code>  <code>href,</code>    <code>#id___</code> . ..     <code>href</code>     ,    .     XPath  : <code>substring(RF_CHILD_LIST/@href,2)</code> . ..     : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:with-param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"substring(RF_CHILD_LIST/@href,2)"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>  ,     : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"OutChilds"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:with-param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"substring(RF_CHILD_LIST/@href,2)"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>  ,  ,     ,    . <br> <br> <b class="spoiler_title"> ,      :</b> <code class="xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsl</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/1999/XSL/Transform"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:sap</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/sapxsl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:asx</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/abapxml"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:prg</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">exclude-result-prefixes</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"asx sap prg"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:strip-space</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">elements</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--       , .   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--         XML --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:values/TABLE/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  NAMR  --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--      ,        --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:with-param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"substring(RF_CHILD_LIST/@href,2)"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--     --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"OutChilds"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  , id    ,   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--    --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:with-param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"substring(RF_CHILD_LIST/@href,2)"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> <br> <b class="spoiler_title">  ABAP-</b> <code class="bash">REPORT zedu_test_xslt_deep_transform. *      "   " TYPES : BEGIN OF tdeep_struct , name TYPE string , rf_child_list TYPE REF TO data , END OF tdeep_struct *       "   " , t_deep_struct TYPE STANDARD TABLE OF tdeep_struct WITH NON-UNIQUE DEFAULT KEY . DATA : gt_tree TYPE t_deep_struct "  , gtree TYPE tdeep_struct "       , gchild TYPE tdeep_struct "       , ggrandchild TYPE tdeep_struct "       , gxml_str TYPE string "  XML , go_xml_doc TYPE REF TO cl_xml_document "    XML . FIELD-SYMBOLS : <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_child_list</span></span></span><span class="hljs-tag">&gt;</span></span> TYPE t_deep_struct "    , <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_grandchild_list</span></span></span><span class="hljs-tag">&gt;</span></span> TYPE t_deep_struct "    . START-OF-SELECTION. *    gtree-name = 'GrandParent1'. CREATE DATA gtree-rf_child_list TYPE t_deep_struct. ASSIGN gtree-rf_child_list-&gt;* TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_child_list</span></span></span><span class="hljs-tag">&gt;</span></span>. gchild-name = 'Child1'. APPEND gchild TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_child_list</span></span></span><span class="hljs-tag">&gt;</span></span>. gchild-name = 'Child2'. CREATE DATA gchild-rf_child_list TYPE t_deep_struct. ASSIGN gchild-rf_child_list-&gt;* TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_grandchild_list</span></span></span><span class="hljs-tag">&gt;</span></span>. ggrandchild-name = 'GrandChild1'. APPEND ggrandchild TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_grandchild_list</span></span></span><span class="hljs-tag">&gt;</span></span>. APPEND gchild TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_child_list</span></span></span><span class="hljs-tag">&gt;</span></span>. APPEND gtree TO gt_tree. CLEAR gtree. gtree-name = 'GrandParent2'. APPEND gtree TO gt_tree. * XSLT- CALL TRANSFORMATION zedu_test_xslt_deep_transform2 SOURCE table = gt_tree RESULT XML gxml_str. *    XML CREATE OBJECT go_xml_doc. go_xml_doc-&gt;parse_string( gxml_str ). go_xml_doc-&gt;display( ).</code> <br> <br> <br>  <br>  ,      XSLT  ? <br> <br>   <br> <a href="http://help.sap.com/abapdocu_70/en/ABAPCALL_TRANSFORMATION.htm"> ABAP</a> <a href="http://msdn.microsoft.com/ru-ru/library/ms256069%2528v%3Dvs.110%2529.aspx">MSDN:   XSLT</a> <a href="http://zvon.org/comp/r/tut-XPath_1.html">XPath tutorial</a> <a href="http://www.w3.org/TR/xslt"> XSLT</a></code></code> </pre> <code><code><code>,         .           . ..      RF_CHILD_LIST</code> ,      DATA ( <code>TYPE REF TO DATA</code> ),      ,     <code>href</code>     ,    . <br> ,     <code>&lt;RF_CHILD_LIST href="#d1" /&gt;</code> ,   <code>#</code> -       <a href="http://ru.wikipedia.org/wiki/XLink">XLink</a> ,  <code>d1</code> ‚Äì  .         XML-: <code>asx:heap</code>  ,   <code>id</code>  d1.    &lt; <code>prg:T_DEEP_STRUCT id="d1" ‚Ä¶ &gt;</code> .      ,         . <br> ..,    XML   ,  . <br> <br>  XSLT- ? <br>     XSLT-. <br>  SAP      STRANS. <br> <img src="//habrastorage.org/files/9e2/1a4/62a/9e21a462a5794b7b820619abc4edb1ec.jpg"> <br>   ,  ¬´¬ª(F5). <br> <img src="//habrastorage.org/files/f25/1a9/ff3/f251a9ff31c7413f96bf83dc1ee3a4e6.jpg"> <br>   ‚Äì  ,       (   ‚Äì XSLT).  Enter. <br> <br>         XSLT,        .  ,        ,    ‚Äì  . <br> <br>        , ..,   ,         (   ,    , ,   html ). <br> <br>    ,       , ..    .      <br> <code class="xml">&lt;xsl:transform version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;xsl:template match="/"&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> : <br> <code>xmlns:xsl</code> ,       xsl. ..       ,       <code>xsl</code> : ( <code>&lt;xsl:strip-space elements="*"/&gt;</code> ) <code>xmlns:sap</code> ,       sap <code>xsl:transform</code> ,     XSLT- <code>&lt;xsl:strip-space elements="*"/&gt;</code>      <code>&lt;xsl:template match="/"&gt;</code>   ,       XML  <br> <br> XSLT-      ( <code>xsl:template</code> )     XML-,      <code>match</code> .   <code>match</code>      <a href="http://ru.wikipedia.org/wiki/XPath">XPath</a> .    ,     ¬´/¬ª,      XML- <code>TABLE</code>    "/asx:abap/asx:values/TABLE" (..    XML-   ( <code>asx:abap</code> )    ( <code>TABLE</code> )). <br> <br>  ,      XML- List.   : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>item</code>   <code>TABLE</code>   XML ,      <code>&lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt;</code> ,    <code>select</code>  XPath   ,     .       <code>MyItem</code> ,     <code>Name</code>   NAME    ,    .  ,       : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>&lt;xsl:value-of select="NAME"/&gt;</code> ,   <code>select</code>   XPath-  ,     .  ,    <code>xsl:value-of</code>   ,   <code>xsl:for-each</code> .   ,   <code>xsl:for-each</code>   ,    ,   <code>xsl:value-of</code> ‚Äì     (..    <code>xsl:for-each</code> ). <br>  ,   ,         . <br>  ,            <code>asx, sap, prg</code> (XSLT     ).       XML,  <code>xsl:transform</code>  : <br> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt;</code> <br> <br> ..     ,    <code>exclude-result-prefixes</code>  ,       XML. <br>        ,       <code>RF_CHILD_LIST</code> .        .   ‚Äì   . <br> ,    id   .    <code>ChilListID</code> .     . <br>      : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;/xsl:template&gt;</code> <br> <br> ..      <code>OutChilds</code>   <code>ChilListID</code> .  ,       XML-,    <code>/asx:abap/asx:heap</code> . <br> <br>       ?    item   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> .        <code>xsl:for-each</code> . <br>   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]"&gt;</code> <br>  XPath ,        <code>prg:T_DEEP_STRUCT</code> ,    <code>id</code>   <code>ChilListID</code> . <br>        item: <code>&lt;xsl:for-each select="item"&gt;</code> <br> <br> ,        ,   ,    , XSLT  .     : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt;</code> <br> <br>   <code>MyItem</code>   <code>Name</code> .    : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>      .    :      . <br>     <code>xsl:apply-templates</code> ,     <code>select</code>     XML      . <br>  ,  ,       <code>ChilListID</code> . ,      ,    <code>RF_CHILD_LIST</code>  <code>href,</code>    <code>#id___</code> . ..     <code>href</code>     ,    .     XPath  : <code>substring(RF_CHILD_LIST/@href,2)</code> . ..     : <br> <code class="xml"> &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt;</code> <br> <br>  ,     : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>  ,  ,     ,    . <br> <br> <b class="spoiler_title"> ,      :</b> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;!--       , .   --&gt; &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;!--         XML --&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;!--  NAMR  --&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--      ,        --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt; &lt;!--     --&gt; &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;!--   --&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;!--  , id    ,   --&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--    --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> <br> <b class="spoiler_title">  ABAP-</b> <code class="bash">REPORT zedu_test_xslt_deep_transform. *      "   " TYPES : BEGIN OF tdeep_struct , name TYPE string , rf_child_list TYPE REF TO data , END OF tdeep_struct *       "   " , t_deep_struct TYPE STANDARD TABLE OF tdeep_struct WITH NON-UNIQUE DEFAULT KEY . DATA : gt_tree TYPE t_deep_struct "  , gtree TYPE tdeep_struct "       , gchild TYPE tdeep_struct "       , ggrandchild TYPE tdeep_struct "       , gxml_str TYPE string "  XML , go_xml_doc TYPE REF TO cl_xml_document "    XML . FIELD-SYMBOLS : &lt;gt_child_list&gt; TYPE t_deep_struct "    , &lt;gt_grandchild_list&gt; TYPE t_deep_struct "    . START-OF-SELECTION. *    gtree-name = 'GrandParent1'. CREATE DATA gtree-rf_child_list TYPE t_deep_struct. ASSIGN gtree-rf_child_list-&gt;* TO &lt;gt_child_list&gt;. gchild-name = 'Child1'. APPEND gchild TO &lt;gt_child_list&gt;. gchild-name = 'Child2'. CREATE DATA gchild-rf_child_list TYPE t_deep_struct. ASSIGN gchild-rf_child_list-&gt;* TO &lt;gt_grandchild_list&gt;. ggrandchild-name = 'GrandChild1'. APPEND ggrandchild TO &lt;gt_grandchild_list&gt;. APPEND gchild TO &lt;gt_child_list&gt;. APPEND gtree TO gt_tree. CLEAR gtree. gtree-name = 'GrandParent2'. APPEND gtree TO gt_tree. * XSLT- CALL TRANSFORMATION zedu_test_xslt_deep_transform2 SOURCE table = gt_tree RESULT XML gxml_str. *    XML CREATE OBJECT go_xml_doc. go_xml_doc-&gt;parse_string( gxml_str ). go_xml_doc-&gt;display( ).</code> <br> <br> <br>  <br>  ,      XSLT  ? <br> <br>   <br> <a href="http://help.sap.com/abapdocu_70/en/ABAPCALL_TRANSFORMATION.htm"> ABAP</a> <a href="http://msdn.microsoft.com/ru-ru/library/ms256069%2528v%3Dvs.110%2529.aspx">MSDN:   XSLT</a> <a href="http://zvon.org/comp/r/tut-XPath_1.html">XPath tutorial</a> <a href="http://www.w3.org/TR/xslt"> XSLT</a></code></code> <pre> <code class="hljs xml"><code><code>,         .           . ..      RF_CHILD_LIST</code> ,      DATA ( <code>TYPE REF TO DATA</code> ),      ,     <code>href</code>     ,    . <br> ,     <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RF_CHILD_LIST</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#d1"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> ,   <code>#</code> -       <a href="http://ru.wikipedia.org/wiki/XLink">XLink</a> ,  <code>d1</code> ‚Äì  .         XML-: <code>asx:heap</code>  ,   <code>id</code>  d1.    <span class="hljs-tag"><span class="hljs-tag">&lt; </span></span><code><span class="hljs-tag"><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">prg:T_DEEP_STRUCT</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"d1"</span></span></span><span class="hljs-tag"> ‚Ä¶ &gt;</span></span></code> .      ,         . <br> ..,    XML   ,  . <br> <br>  XSLT- ? <br>     XSLT-. <br>  SAP      STRANS. <br> <img src="//habrastorage.org/files/9e2/1a4/62a/9e21a462a5794b7b820619abc4edb1ec.jpg"> <br>   ,  ¬´¬ª(F5). <br> <img src="//habrastorage.org/files/f25/1a9/ff3/f251a9ff31c7413f96bf83dc1ee3a4e6.jpg"> <br>   ‚Äì  ,       (   ‚Äì XSLT).  Enter. <br> <br>         XSLT,        .  ,        ,    ‚Äì  . <br> <br>        , ..,   ,         (   ,    , ,   html ). <br> <br>    ,       , ..    .      <br> <code class="xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsl</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/1999/XSL/Transform"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:sap</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/sapxsl"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:strip-space</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">elements</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> : <br> <code>xmlns:xsl</code> ,       xsl. ..       ,       <code>xsl</code> : ( <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:strip-space</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">elements</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> ) <code>xmlns:sap</code> ,       sap <code>xsl:transform</code> ,     XSLT- <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:strip-space</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">elements</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag">/&gt;</span></span></code>      <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span></code>   ,       XML  <br> <br> XSLT-      ( <code>xsl:template</code> )     XML-,      <code>match</code> .   <code>match</code>      <a href="http://ru.wikipedia.org/wiki/XPath">XPath</a> .    ,     ¬´/¬ª,      XML- <code>TABLE</code>    "/asx:abap/asx:values/TABLE" (..    XML-   ( <code>asx:abap</code> )    ( <code>TABLE</code> )). <br> <br>  ,      XML- List.   : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>        <code>item</code>   <code>TABLE</code>   XML ,      <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:values/TABLE/item"</span></span></span><span class="hljs-tag">&gt;</span></span></code> ,    <code>select</code>  XPath   ,     .       <code>MyItem</code> ,     <code>Name</code>   NAME    ,    .  ,       : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:values/TABLE/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>        <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> ,   <code>select</code>   XPath-  ,     .  ,    <code>xsl:value-of</code>   ,   <code>xsl:for-each</code> .   ,   <code>xsl:for-each</code>   ,    ,   <code>xsl:value-of</code> ‚Äì     (..    <code>xsl:for-each</code> ). <br>  ,   ,         . <br>  ,            <code>asx, sap, prg</code> (XSLT     ).       XML,  <code>xsl:transform</code>  : <br> <code class="xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsl</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/1999/XSL/Transform"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:sap</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/sapxsl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:asx</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/abapxml"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:prg</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">exclude-result-prefixes</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"asx sap prg"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> ..     ,    <code>exclude-result-prefixes</code>  ,       XML. <br>        ,       <code>RF_CHILD_LIST</code> .        .   ‚Äì   . <br> ,    id   .    <code>ChilListID</code> .     . <br>      : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"OutChilds"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> ..      <code>OutChilds</code>   <code>ChilListID</code> .  ,       XML-,    <code>/asx:abap/asx:heap</code> . <br> <br>       ?    item   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> .        <code>xsl:for-each</code> . <br>   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> : <br> <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]"</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br>  XPath ,        <code>prg:T_DEEP_STRUCT</code> ,    <code>id</code>   <code>ChilListID</code> . <br>        item: <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"item"</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> ,        ,   ,    , XSLT  .     : <br> <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]/item"</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>   <code>MyItem</code>   <code>Name</code> .    : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"OutChilds"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>      .    :      . <br>     <code>xsl:apply-templates</code> ,     <code>select</code>     XML      . <br>  ,  ,       <code>ChilListID</code> . ,      ,    <code>RF_CHILD_LIST</code>  <code>href,</code>    <code>#id___</code> . ..     <code>href</code>     ,    .     XPath  : <code>substring(RF_CHILD_LIST/@href,2)</code> . ..     : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:with-param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"substring(RF_CHILD_LIST/@href,2)"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>  ,     : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"OutChilds"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:with-param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"substring(RF_CHILD_LIST/@href,2)"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>  ,  ,     ,    . <br> <br> <b class="spoiler_title"> ,      :</b> <code class="xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsl</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/1999/XSL/Transform"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:sap</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/sapxsl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:asx</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/abapxml"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:prg</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">exclude-result-prefixes</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"asx sap prg"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:strip-space</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">elements</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--       , .   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--         XML --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:values/TABLE/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  NAMR  --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--      ,        --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:with-param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"substring(RF_CHILD_LIST/@href,2)"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--     --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"OutChilds"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  , id    ,   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--    --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:with-param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"substring(RF_CHILD_LIST/@href,2)"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> <br> <b class="spoiler_title">  ABAP-</b> <code class="bash">REPORT zedu_test_xslt_deep_transform. *      "   " TYPES : BEGIN OF tdeep_struct , name TYPE string , rf_child_list TYPE REF TO data , END OF tdeep_struct *       "   " , t_deep_struct TYPE STANDARD TABLE OF tdeep_struct WITH NON-UNIQUE DEFAULT KEY . DATA : gt_tree TYPE t_deep_struct "  , gtree TYPE tdeep_struct "       , gchild TYPE tdeep_struct "       , ggrandchild TYPE tdeep_struct "       , gxml_str TYPE string "  XML , go_xml_doc TYPE REF TO cl_xml_document "    XML . FIELD-SYMBOLS : <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_child_list</span></span></span><span class="hljs-tag">&gt;</span></span> TYPE t_deep_struct "    , <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_grandchild_list</span></span></span><span class="hljs-tag">&gt;</span></span> TYPE t_deep_struct "    . START-OF-SELECTION. *    gtree-name = 'GrandParent1'. CREATE DATA gtree-rf_child_list TYPE t_deep_struct. ASSIGN gtree-rf_child_list-&gt;* TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_child_list</span></span></span><span class="hljs-tag">&gt;</span></span>. gchild-name = 'Child1'. APPEND gchild TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_child_list</span></span></span><span class="hljs-tag">&gt;</span></span>. gchild-name = 'Child2'. CREATE DATA gchild-rf_child_list TYPE t_deep_struct. ASSIGN gchild-rf_child_list-&gt;* TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_grandchild_list</span></span></span><span class="hljs-tag">&gt;</span></span>. ggrandchild-name = 'GrandChild1'. APPEND ggrandchild TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_grandchild_list</span></span></span><span class="hljs-tag">&gt;</span></span>. APPEND gchild TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_child_list</span></span></span><span class="hljs-tag">&gt;</span></span>. APPEND gtree TO gt_tree. CLEAR gtree. gtree-name = 'GrandParent2'. APPEND gtree TO gt_tree. * XSLT- CALL TRANSFORMATION zedu_test_xslt_deep_transform2 SOURCE table = gt_tree RESULT XML gxml_str. *    XML CREATE OBJECT go_xml_doc. go_xml_doc-&gt;parse_string( gxml_str ). go_xml_doc-&gt;display( ).</code> <br> <br> <br>  <br>  ,      XSLT  ? <br> <br>   <br> <a href="http://help.sap.com/abapdocu_70/en/ABAPCALL_TRANSFORMATION.htm"> ABAP</a> <a href="http://msdn.microsoft.com/ru-ru/library/ms256069%2528v%3Dvs.110%2529.aspx">MSDN:   XSLT</a> <a href="http://zvon.org/comp/r/tut-XPath_1.html">XPath tutorial</a> <a href="http://www.w3.org/TR/xslt"> XSLT</a></code></code> </pre> <code><code><code>,         .           . ..      RF_CHILD_LIST</code> ,      DATA ( <code>TYPE REF TO DATA</code> ),      ,     <code>href</code>     ,    . <br> ,     <code>&lt;RF_CHILD_LIST href="#d1" /&gt;</code> ,   <code>#</code> -       <a href="http://ru.wikipedia.org/wiki/XLink">XLink</a> ,  <code>d1</code> ‚Äì  .         XML-: <code>asx:heap</code>  ,   <code>id</code>  d1.    &lt; <code>prg:T_DEEP_STRUCT id="d1" ‚Ä¶ &gt;</code> .      ,         . <br> ..,    XML   ,  . <br> <br>  XSLT- ? <br>     XSLT-. <br>  SAP      STRANS. <br> <img src="//habrastorage.org/files/9e2/1a4/62a/9e21a462a5794b7b820619abc4edb1ec.jpg"> <br>   ,  ¬´¬ª(F5). <br> <img src="//habrastorage.org/files/f25/1a9/ff3/f251a9ff31c7413f96bf83dc1ee3a4e6.jpg"> <br>   ‚Äì  ,       (   ‚Äì XSLT).  Enter. <br> <br>         XSLT,        .  ,        ,    ‚Äì  . <br> <br>        , ..,   ,         (   ,    , ,   html ). <br> <br>    ,       , ..    .      <br> <code class="xml">&lt;xsl:transform version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;xsl:template match="/"&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> : <br> <code>xmlns:xsl</code> ,       xsl. ..       ,       <code>xsl</code> : ( <code>&lt;xsl:strip-space elements="*"/&gt;</code> ) <code>xmlns:sap</code> ,       sap <code>xsl:transform</code> ,     XSLT- <code>&lt;xsl:strip-space elements="*"/&gt;</code>      <code>&lt;xsl:template match="/"&gt;</code>   ,       XML  <br> <br> XSLT-      ( <code>xsl:template</code> )     XML-,      <code>match</code> .   <code>match</code>      <a href="http://ru.wikipedia.org/wiki/XPath">XPath</a> .    ,     ¬´/¬ª,      XML- <code>TABLE</code>    "/asx:abap/asx:values/TABLE" (..    XML-   ( <code>asx:abap</code> )    ( <code>TABLE</code> )). <br> <br>  ,      XML- List.   : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>item</code>   <code>TABLE</code>   XML ,      <code>&lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt;</code> ,    <code>select</code>  XPath   ,     .       <code>MyItem</code> ,     <code>Name</code>   NAME    ,    .  ,       : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>&lt;xsl:value-of select="NAME"/&gt;</code> ,   <code>select</code>   XPath-  ,     .  ,    <code>xsl:value-of</code>   ,   <code>xsl:for-each</code> .   ,   <code>xsl:for-each</code>   ,    ,   <code>xsl:value-of</code> ‚Äì     (..    <code>xsl:for-each</code> ). <br>  ,   ,         . <br>  ,            <code>asx, sap, prg</code> (XSLT     ).       XML,  <code>xsl:transform</code>  : <br> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt;</code> <br> <br> ..     ,    <code>exclude-result-prefixes</code>  ,       XML. <br>        ,       <code>RF_CHILD_LIST</code> .        .   ‚Äì   . <br> ,    id   .    <code>ChilListID</code> .     . <br>      : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;/xsl:template&gt;</code> <br> <br> ..      <code>OutChilds</code>   <code>ChilListID</code> .  ,       XML-,    <code>/asx:abap/asx:heap</code> . <br> <br>       ?    item   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> .        <code>xsl:for-each</code> . <br>   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]"&gt;</code> <br>  XPath ,        <code>prg:T_DEEP_STRUCT</code> ,    <code>id</code>   <code>ChilListID</code> . <br>        item: <code>&lt;xsl:for-each select="item"&gt;</code> <br> <br> ,        ,   ,    , XSLT  .     : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt;</code> <br> <br>   <code>MyItem</code>   <code>Name</code> .    : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>      .    :      . <br>     <code>xsl:apply-templates</code> ,     <code>select</code>     XML      . <br>  ,  ,       <code>ChilListID</code> . ,      ,    <code>RF_CHILD_LIST</code>  <code>href,</code>    <code>#id___</code> . ..     <code>href</code>     ,    .     XPath  : <code>substring(RF_CHILD_LIST/@href,2)</code> . ..     : <br> <code class="xml"> &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt;</code> <br> <br>  ,     : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>  ,  ,     ,    . <br> <br> <b class="spoiler_title"> ,      :</b> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;!--       , .   --&gt; &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;!--         XML --&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;!--  NAMR  --&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--      ,        --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt; &lt;!--     --&gt; &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;!--   --&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;!--  , id    ,   --&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--    --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> <br> <b class="spoiler_title">  ABAP-</b> <code class="bash">REPORT zedu_test_xslt_deep_transform. *      "   " TYPES : BEGIN OF tdeep_struct , name TYPE string , rf_child_list TYPE REF TO data , END OF tdeep_struct *       "   " , t_deep_struct TYPE STANDARD TABLE OF tdeep_struct WITH NON-UNIQUE DEFAULT KEY . DATA : gt_tree TYPE t_deep_struct "  , gtree TYPE tdeep_struct "       , gchild TYPE tdeep_struct "       , ggrandchild TYPE tdeep_struct "       , gxml_str TYPE string "  XML , go_xml_doc TYPE REF TO cl_xml_document "    XML . FIELD-SYMBOLS : &lt;gt_child_list&gt; TYPE t_deep_struct "    , &lt;gt_grandchild_list&gt; TYPE t_deep_struct "    . START-OF-SELECTION. *    gtree-name = 'GrandParent1'. CREATE DATA gtree-rf_child_list TYPE t_deep_struct. ASSIGN gtree-rf_child_list-&gt;* TO &lt;gt_child_list&gt;. gchild-name = 'Child1'. APPEND gchild TO &lt;gt_child_list&gt;. gchild-name = 'Child2'. CREATE DATA gchild-rf_child_list TYPE t_deep_struct. ASSIGN gchild-rf_child_list-&gt;* TO &lt;gt_grandchild_list&gt;. ggrandchild-name = 'GrandChild1'. APPEND ggrandchild TO &lt;gt_grandchild_list&gt;. APPEND gchild TO &lt;gt_child_list&gt;. APPEND gtree TO gt_tree. CLEAR gtree. gtree-name = 'GrandParent2'. APPEND gtree TO gt_tree. * XSLT- CALL TRANSFORMATION zedu_test_xslt_deep_transform2 SOURCE table = gt_tree RESULT XML gxml_str. *    XML CREATE OBJECT go_xml_doc. go_xml_doc-&gt;parse_string( gxml_str ). go_xml_doc-&gt;display( ).</code> <br> <br> <br>  <br>  ,      XSLT  ? <br> <br>   <br> <a href="http://help.sap.com/abapdocu_70/en/ABAPCALL_TRANSFORMATION.htm"> ABAP</a> <a href="http://msdn.microsoft.com/ru-ru/library/ms256069%2528v%3Dvs.110%2529.aspx">MSDN:   XSLT</a> <a href="http://zvon.org/comp/r/tut-XPath_1.html">XPath tutorial</a> <a href="http://www.w3.org/TR/xslt"> XSLT</a></code></code> <pre> <code class="hljs xml"><code><code>,         .           . ..      RF_CHILD_LIST</code> ,      DATA ( <code>TYPE REF TO DATA</code> ),      ,     <code>href</code>     ,    . <br> ,     <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RF_CHILD_LIST</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#d1"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> ,   <code>#</code> -       <a href="http://ru.wikipedia.org/wiki/XLink">XLink</a> ,  <code>d1</code> ‚Äì  .         XML-: <code>asx:heap</code>  ,   <code>id</code>  d1.    <span class="hljs-tag"><span class="hljs-tag">&lt; </span></span><code><span class="hljs-tag"><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">prg:T_DEEP_STRUCT</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"d1"</span></span></span><span class="hljs-tag"> ‚Ä¶ &gt;</span></span></code> .      ,         . <br> ..,    XML   ,  . <br> <br>  XSLT- ? <br>     XSLT-. <br>  SAP      STRANS. <br> <img src="//habrastorage.org/files/9e2/1a4/62a/9e21a462a5794b7b820619abc4edb1ec.jpg"> <br>   ,  ¬´¬ª(F5). <br> <img src="//habrastorage.org/files/f25/1a9/ff3/f251a9ff31c7413f96bf83dc1ee3a4e6.jpg"> <br>   ‚Äì  ,       (   ‚Äì XSLT).  Enter. <br> <br>         XSLT,        .  ,        ,    ‚Äì  . <br> <br>        , ..,   ,         (   ,    , ,   html ). <br> <br>    ,       , ..    .      <br> <code class="xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsl</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/1999/XSL/Transform"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:sap</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/sapxsl"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:strip-space</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">elements</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> : <br> <code>xmlns:xsl</code> ,       xsl. ..       ,       <code>xsl</code> : ( <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:strip-space</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">elements</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> ) <code>xmlns:sap</code> ,       sap <code>xsl:transform</code> ,     XSLT- <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:strip-space</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">elements</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag">/&gt;</span></span></code>      <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span></code>   ,       XML  <br> <br> XSLT-      ( <code>xsl:template</code> )     XML-,      <code>match</code> .   <code>match</code>      <a href="http://ru.wikipedia.org/wiki/XPath">XPath</a> .    ,     ¬´/¬ª,      XML- <code>TABLE</code>    "/asx:abap/asx:values/TABLE" (..    XML-   ( <code>asx:abap</code> )    ( <code>TABLE</code> )). <br> <br>  ,      XML- List.   : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>        <code>item</code>   <code>TABLE</code>   XML ,      <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:values/TABLE/item"</span></span></span><span class="hljs-tag">&gt;</span></span></code> ,    <code>select</code>  XPath   ,     .       <code>MyItem</code> ,     <code>Name</code>   NAME    ,    .  ,       : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:values/TABLE/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>        <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> ,   <code>select</code>   XPath-  ,     .  ,    <code>xsl:value-of</code>   ,   <code>xsl:for-each</code> .   ,   <code>xsl:for-each</code>   ,    ,   <code>xsl:value-of</code> ‚Äì     (..    <code>xsl:for-each</code> ). <br>  ,   ,         . <br>  ,            <code>asx, sap, prg</code> (XSLT     ).       XML,  <code>xsl:transform</code>  : <br> <code class="xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsl</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/1999/XSL/Transform"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:sap</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/sapxsl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:asx</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/abapxml"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:prg</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">exclude-result-prefixes</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"asx sap prg"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> ..     ,    <code>exclude-result-prefixes</code>  ,       XML. <br>        ,       <code>RF_CHILD_LIST</code> .        .   ‚Äì   . <br> ,    id   .    <code>ChilListID</code> .     . <br>      : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"OutChilds"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> ..      <code>OutChilds</code>   <code>ChilListID</code> .  ,       XML-,    <code>/asx:abap/asx:heap</code> . <br> <br>       ?    item   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> .        <code>xsl:for-each</code> . <br>   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> : <br> <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]"</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br>  XPath ,        <code>prg:T_DEEP_STRUCT</code> ,    <code>id</code>   <code>ChilListID</code> . <br>        item: <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"item"</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> ,        ,   ,    , XSLT  .     : <br> <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]/item"</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>   <code>MyItem</code>   <code>Name</code> .    : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"OutChilds"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>      .    :      . <br>     <code>xsl:apply-templates</code> ,     <code>select</code>     XML      . <br>  ,  ,       <code>ChilListID</code> . ,      ,    <code>RF_CHILD_LIST</code>  <code>href,</code>    <code>#id___</code> . ..     <code>href</code>     ,    .     XPath  : <code>substring(RF_CHILD_LIST/@href,2)</code> . ..     : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:with-param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"substring(RF_CHILD_LIST/@href,2)"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>  ,     : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"OutChilds"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:with-param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"substring(RF_CHILD_LIST/@href,2)"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>  ,  ,     ,    . <br> <br> <b class="spoiler_title"> ,      :</b> <code class="xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsl</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/1999/XSL/Transform"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:sap</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/sapxsl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:asx</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/abapxml"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:prg</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">exclude-result-prefixes</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"asx sap prg"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:strip-space</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">elements</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--       , .   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--         XML --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:values/TABLE/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  NAMR  --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--      ,        --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:with-param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"substring(RF_CHILD_LIST/@href,2)"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--     --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"OutChilds"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  , id    ,   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--    --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:with-param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"substring(RF_CHILD_LIST/@href,2)"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> <br> <b class="spoiler_title">  ABAP-</b> <code class="bash">REPORT zedu_test_xslt_deep_transform. *      "   " TYPES : BEGIN OF tdeep_struct , name TYPE string , rf_child_list TYPE REF TO data , END OF tdeep_struct *       "   " , t_deep_struct TYPE STANDARD TABLE OF tdeep_struct WITH NON-UNIQUE DEFAULT KEY . DATA : gt_tree TYPE t_deep_struct "  , gtree TYPE tdeep_struct "       , gchild TYPE tdeep_struct "       , ggrandchild TYPE tdeep_struct "       , gxml_str TYPE string "  XML , go_xml_doc TYPE REF TO cl_xml_document "    XML . FIELD-SYMBOLS : <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_child_list</span></span></span><span class="hljs-tag">&gt;</span></span> TYPE t_deep_struct "    , <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_grandchild_list</span></span></span><span class="hljs-tag">&gt;</span></span> TYPE t_deep_struct "    . START-OF-SELECTION. *    gtree-name = 'GrandParent1'. CREATE DATA gtree-rf_child_list TYPE t_deep_struct. ASSIGN gtree-rf_child_list-&gt;* TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_child_list</span></span></span><span class="hljs-tag">&gt;</span></span>. gchild-name = 'Child1'. APPEND gchild TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_child_list</span></span></span><span class="hljs-tag">&gt;</span></span>. gchild-name = 'Child2'. CREATE DATA gchild-rf_child_list TYPE t_deep_struct. ASSIGN gchild-rf_child_list-&gt;* TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_grandchild_list</span></span></span><span class="hljs-tag">&gt;</span></span>. ggrandchild-name = 'GrandChild1'. APPEND ggrandchild TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_grandchild_list</span></span></span><span class="hljs-tag">&gt;</span></span>. APPEND gchild TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_child_list</span></span></span><span class="hljs-tag">&gt;</span></span>. APPEND gtree TO gt_tree. CLEAR gtree. gtree-name = 'GrandParent2'. APPEND gtree TO gt_tree. * XSLT- CALL TRANSFORMATION zedu_test_xslt_deep_transform2 SOURCE table = gt_tree RESULT XML gxml_str. *    XML CREATE OBJECT go_xml_doc. go_xml_doc-&gt;parse_string( gxml_str ). go_xml_doc-&gt;display( ).</code> <br> <br> <br>  <br>  ,      XSLT  ? <br> <br>   <br> <a href="http://help.sap.com/abapdocu_70/en/ABAPCALL_TRANSFORMATION.htm"> ABAP</a> <a href="http://msdn.microsoft.com/ru-ru/library/ms256069%2528v%3Dvs.110%2529.aspx">MSDN:   XSLT</a> <a href="http://zvon.org/comp/r/tut-XPath_1.html">XPath tutorial</a> <a href="http://www.w3.org/TR/xslt"> XSLT</a></code></code> </pre> <code><code><code>,         .           . ..      RF_CHILD_LIST</code> ,      DATA ( <code>TYPE REF TO DATA</code> ),      ,     <code>href</code>     ,    . <br> ,     <code>&lt;RF_CHILD_LIST href="#d1" /&gt;</code> ,   <code>#</code> -       <a href="http://ru.wikipedia.org/wiki/XLink">XLink</a> ,  <code>d1</code> ‚Äì  .         XML-: <code>asx:heap</code>  ,   <code>id</code>  d1.    &lt; <code>prg:T_DEEP_STRUCT id="d1" ‚Ä¶ &gt;</code> .      ,         . <br> ..,    XML   ,  . <br> <br>  XSLT- ? <br>     XSLT-. <br>  SAP      STRANS. <br> <img src="//habrastorage.org/files/9e2/1a4/62a/9e21a462a5794b7b820619abc4edb1ec.jpg"> <br>   ,  ¬´¬ª(F5). <br> <img src="//habrastorage.org/files/f25/1a9/ff3/f251a9ff31c7413f96bf83dc1ee3a4e6.jpg"> <br>   ‚Äì  ,       (   ‚Äì XSLT).  Enter. <br> <br>         XSLT,        .  ,        ,    ‚Äì  . <br> <br>        , ..,   ,         (   ,    , ,   html ). <br> <br>    ,       , ..    .      <br> <code class="xml">&lt;xsl:transform version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;xsl:template match="/"&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> : <br> <code>xmlns:xsl</code> ,       xsl. ..       ,       <code>xsl</code> : ( <code>&lt;xsl:strip-space elements="*"/&gt;</code> ) <code>xmlns:sap</code> ,       sap <code>xsl:transform</code> ,     XSLT- <code>&lt;xsl:strip-space elements="*"/&gt;</code>      <code>&lt;xsl:template match="/"&gt;</code>   ,       XML  <br> <br> XSLT-      ( <code>xsl:template</code> )     XML-,      <code>match</code> .   <code>match</code>      <a href="http://ru.wikipedia.org/wiki/XPath">XPath</a> .    ,     ¬´/¬ª,      XML- <code>TABLE</code>    "/asx:abap/asx:values/TABLE" (..    XML-   ( <code>asx:abap</code> )    ( <code>TABLE</code> )). <br> <br>  ,      XML- List.   : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>item</code>   <code>TABLE</code>   XML ,      <code>&lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt;</code> ,    <code>select</code>  XPath   ,     .       <code>MyItem</code> ,     <code>Name</code>   NAME    ,    .  ,       : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>&lt;xsl:value-of select="NAME"/&gt;</code> ,   <code>select</code>   XPath-  ,     .  ,    <code>xsl:value-of</code>   ,   <code>xsl:for-each</code> .   ,   <code>xsl:for-each</code>   ,    ,   <code>xsl:value-of</code> ‚Äì     (..    <code>xsl:for-each</code> ). <br>  ,   ,         . <br>  ,            <code>asx, sap, prg</code> (XSLT     ).       XML,  <code>xsl:transform</code>  : <br> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt;</code> <br> <br> ..     ,    <code>exclude-result-prefixes</code>  ,       XML. <br>        ,       <code>RF_CHILD_LIST</code> .        .   ‚Äì   . <br> ,    id   .    <code>ChilListID</code> .     . <br>      : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;/xsl:template&gt;</code> <br> <br> ..      <code>OutChilds</code>   <code>ChilListID</code> .  ,       XML-,    <code>/asx:abap/asx:heap</code> . <br> <br>       ?    item   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> .        <code>xsl:for-each</code> . <br>   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]"&gt;</code> <br>  XPath ,        <code>prg:T_DEEP_STRUCT</code> ,    <code>id</code>   <code>ChilListID</code> . <br>        item: <code>&lt;xsl:for-each select="item"&gt;</code> <br> <br> ,        ,   ,    , XSLT  .     : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt;</code> <br> <br>   <code>MyItem</code>   <code>Name</code> .    : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>      .    :      . <br>     <code>xsl:apply-templates</code> ,     <code>select</code>     XML      . <br>  ,  ,       <code>ChilListID</code> . ,      ,    <code>RF_CHILD_LIST</code>  <code>href,</code>    <code>#id___</code> . ..     <code>href</code>     ,    .     XPath  : <code>substring(RF_CHILD_LIST/@href,2)</code> . ..     : <br> <code class="xml"> &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt;</code> <br> <br>  ,     : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>  ,  ,     ,    . <br> <br> <b class="spoiler_title"> ,      :</b> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;!--       , .   --&gt; &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;!--         XML --&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;!--  NAMR  --&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--      ,        --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt; &lt;!--     --&gt; &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;!--   --&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;!--  , id    ,   --&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--    --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> <br> <b class="spoiler_title">  ABAP-</b> <code class="bash">REPORT zedu_test_xslt_deep_transform. *      "   " TYPES : BEGIN OF tdeep_struct , name TYPE string , rf_child_list TYPE REF TO data , END OF tdeep_struct *       "   " , t_deep_struct TYPE STANDARD TABLE OF tdeep_struct WITH NON-UNIQUE DEFAULT KEY . DATA : gt_tree TYPE t_deep_struct "  , gtree TYPE tdeep_struct "       , gchild TYPE tdeep_struct "       , ggrandchild TYPE tdeep_struct "       , gxml_str TYPE string "  XML , go_xml_doc TYPE REF TO cl_xml_document "    XML . FIELD-SYMBOLS : &lt;gt_child_list&gt; TYPE t_deep_struct "    , &lt;gt_grandchild_list&gt; TYPE t_deep_struct "    . START-OF-SELECTION. *    gtree-name = 'GrandParent1'. CREATE DATA gtree-rf_child_list TYPE t_deep_struct. ASSIGN gtree-rf_child_list-&gt;* TO &lt;gt_child_list&gt;. gchild-name = 'Child1'. APPEND gchild TO &lt;gt_child_list&gt;. gchild-name = 'Child2'. CREATE DATA gchild-rf_child_list TYPE t_deep_struct. ASSIGN gchild-rf_child_list-&gt;* TO &lt;gt_grandchild_list&gt;. ggrandchild-name = 'GrandChild1'. APPEND ggrandchild TO &lt;gt_grandchild_list&gt;. APPEND gchild TO &lt;gt_child_list&gt;. APPEND gtree TO gt_tree. CLEAR gtree. gtree-name = 'GrandParent2'. APPEND gtree TO gt_tree. * XSLT- CALL TRANSFORMATION zedu_test_xslt_deep_transform2 SOURCE table = gt_tree RESULT XML gxml_str. *    XML CREATE OBJECT go_xml_doc. go_xml_doc-&gt;parse_string( gxml_str ). go_xml_doc-&gt;display( ).</code> <br> <br> <br>  <br>  ,      XSLT  ? <br> <br>   <br> <a href="http://help.sap.com/abapdocu_70/en/ABAPCALL_TRANSFORMATION.htm"> ABAP</a> <a href="http://msdn.microsoft.com/ru-ru/library/ms256069%2528v%3Dvs.110%2529.aspx">MSDN:   XSLT</a> <a href="http://zvon.org/comp/r/tut-XPath_1.html">XPath tutorial</a> <a href="http://www.w3.org/TR/xslt"> XSLT</a></code></code> <div class="spoiler"> <code><code><b class="spoiler_title"><code>,         .           . ..      RF_CHILD_LIST</code> ,      DATA ( <code>TYPE REF TO DATA</code> ),      ,     <code>href</code>     ,    . <br> ,     <code>&lt;RF_CHILD_LIST href="#d1" /&gt;</code> ,   <code>#</code> -       <a href="http://ru.wikipedia.org/wiki/XLink">XLink</a> ,  <code>d1</code> ‚Äì  .         XML-: <code>asx:heap</code>  ,   <code>id</code>  d1.    &lt; <code>prg:T_DEEP_STRUCT id="d1" ‚Ä¶ &gt;</code> .      ,         . <br> ..,    XML   ,  . <br> <br>  XSLT- ? <br>     XSLT-. <br>  SAP      STRANS. <br> <img src="//habrastorage.org/files/9e2/1a4/62a/9e21a462a5794b7b820619abc4edb1ec.jpg"> <br>   ,  ¬´¬ª(F5). <br> <img src="//habrastorage.org/files/f25/1a9/ff3/f251a9ff31c7413f96bf83dc1ee3a4e6.jpg"> <br>   ‚Äì  ,       (   ‚Äì XSLT).  Enter. <br> <br>         XSLT,        .  ,        ,    ‚Äì  . <br> <br>        , ..,   ,         (   ,    , ,   html ). <br> <br>    ,       , ..    .      <br> <code class="xml">&lt;xsl:transform version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;xsl:template match="/"&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> : <br> <code>xmlns:xsl</code> ,       xsl. ..       ,       <code>xsl</code> : ( <code>&lt;xsl:strip-space elements="*"/&gt;</code> ) <code>xmlns:sap</code> ,       sap <code>xsl:transform</code> ,     XSLT- <code>&lt;xsl:strip-space elements="*"/&gt;</code>      <code>&lt;xsl:template match="/"&gt;</code>   ,       XML  <br> <br> XSLT-      ( <code>xsl:template</code> )     XML-,      <code>match</code> .   <code>match</code>      <a href="http://ru.wikipedia.org/wiki/XPath">XPath</a> .    ,     ¬´/¬ª,      XML- <code>TABLE</code>    "/asx:abap/asx:values/TABLE" (..    XML-   ( <code>asx:abap</code> )    ( <code>TABLE</code> )). <br> <br>  ,      XML- List.   : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>item</code>   <code>TABLE</code>   XML ,      <code>&lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt;</code> ,    <code>select</code>  XPath   ,     .       <code>MyItem</code> ,     <code>Name</code>   NAME    ,    .  ,       : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>&lt;xsl:value-of select="NAME"/&gt;</code> ,   <code>select</code>   XPath-  ,     .  ,    <code>xsl:value-of</code>   ,   <code>xsl:for-each</code> .   ,   <code>xsl:for-each</code>   ,    ,   <code>xsl:value-of</code> ‚Äì     (..    <code>xsl:for-each</code> ). <br>  ,   ,         . <br>  ,            <code>asx, sap, prg</code> (XSLT     ).       XML,  <code>xsl:transform</code>  : <br> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt;</code> <br> <br> ..     ,    <code>exclude-result-prefixes</code>  ,       XML. <br>        ,       <code>RF_CHILD_LIST</code> .        .   ‚Äì   . <br> ,    id   .    <code>ChilListID</code> .     . <br>      : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;/xsl:template&gt;</code> <br> <br> ..      <code>OutChilds</code>   <code>ChilListID</code> .  ,       XML-,    <code>/asx:abap/asx:heap</code> . <br> <br>       ?    item   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> .        <code>xsl:for-each</code> . <br>   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]"&gt;</code> <br>  XPath ,        <code>prg:T_DEEP_STRUCT</code> ,    <code>id</code>   <code>ChilListID</code> . <br>        item: <code>&lt;xsl:for-each select="item"&gt;</code> <br> <br> ,        ,   ,    , XSLT  .     : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt;</code> <br> <br>   <code>MyItem</code>   <code>Name</code> .    : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>      .    :      . <br>     <code>xsl:apply-templates</code> ,     <code>select</code>     XML      . <br>  ,  ,       <code>ChilListID</code> . ,      ,    <code>RF_CHILD_LIST</code>  <code>href,</code>    <code>#id___</code> . ..     <code>href</code>     ,    .     XPath  : <code>substring(RF_CHILD_LIST/@href,2)</code> . ..     : <br> <code class="xml"> &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt;</code> <br> <br>  ,     : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>  ,  ,     ,    . <br> <br>  ,      : <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;!--       , .   --&gt; &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;!--         XML --&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;!--  NAMR  --&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--      ,        --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt; &lt;!--     --&gt; &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;!--   --&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;!--  , id    ,   --&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--    --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> <br> <b class="spoiler_title">  ABAP-</b> <code class="bash">REPORT zedu_test_xslt_deep_transform. *      "   " TYPES : BEGIN OF tdeep_struct , name TYPE string , rf_child_list TYPE REF TO data , END OF tdeep_struct *       "   " , t_deep_struct TYPE STANDARD TABLE OF tdeep_struct WITH NON-UNIQUE DEFAULT KEY . DATA : gt_tree TYPE t_deep_struct "  , gtree TYPE tdeep_struct "       , gchild TYPE tdeep_struct "       , ggrandchild TYPE tdeep_struct "       , gxml_str TYPE string "  XML , go_xml_doc TYPE REF TO cl_xml_document "    XML . FIELD-SYMBOLS : &lt;gt_child_list&gt; TYPE t_deep_struct "    , &lt;gt_grandchild_list&gt; TYPE t_deep_struct "    . START-OF-SELECTION. *    gtree-name = 'GrandParent1'. CREATE DATA gtree-rf_child_list TYPE t_deep_struct. ASSIGN gtree-rf_child_list-&gt;* TO &lt;gt_child_list&gt;. gchild-name = 'Child1'. APPEND gchild TO &lt;gt_child_list&gt;. gchild-name = 'Child2'. CREATE DATA gchild-rf_child_list TYPE t_deep_struct. ASSIGN gchild-rf_child_list-&gt;* TO &lt;gt_grandchild_list&gt;. ggrandchild-name = 'GrandChild1'. APPEND ggrandchild TO &lt;gt_grandchild_list&gt;. APPEND gchild TO &lt;gt_child_list&gt;. APPEND gtree TO gt_tree. CLEAR gtree. gtree-name = 'GrandParent2'. APPEND gtree TO gt_tree. * XSLT- CALL TRANSFORMATION zedu_test_xslt_deep_transform2 SOURCE table = gt_tree RESULT XML gxml_str. *    XML CREATE OBJECT go_xml_doc. go_xml_doc-&gt;parse_string( gxml_str ). go_xml_doc-&gt;display( ).</code> <br> <br> <br>  <br>  ,      XSLT  ? <br> <br>   <br> <a href="http://help.sap.com/abapdocu_70/en/ABAPCALL_TRANSFORMATION.htm"> ABAP</a> <a href="http://msdn.microsoft.com/ru-ru/library/ms256069%2528v%3Dvs.110%2529.aspx">MSDN:   XSLT</a> <a href="http://zvon.org/comp/r/tut-XPath_1.html">XPath tutorial</a> <a href="http://www.w3.org/TR/xslt"> XSLT</a></b></code></code> <div class="spoiler_text"> <pre> <code class="hljs xml"><code><code>,         .           . ..      RF_CHILD_LIST</code> ,      DATA ( <code>TYPE REF TO DATA</code> ),      ,     <code>href</code>     ,    . <br> ,     <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RF_CHILD_LIST</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#d1"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> ,   <code>#</code> -       <a href="http://ru.wikipedia.org/wiki/XLink">XLink</a> ,  <code>d1</code> ‚Äì  .         XML-: <code>asx:heap</code>  ,   <code>id</code>  d1.    <span class="hljs-tag"><span class="hljs-tag">&lt; </span></span><code><span class="hljs-tag"><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">prg:T_DEEP_STRUCT</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"d1"</span></span></span><span class="hljs-tag"> ‚Ä¶ &gt;</span></span></code> .      ,         . <br> ..,    XML   ,  . <br> <br>  XSLT- ? <br>     XSLT-. <br>  SAP      STRANS. <br> <img src="//habrastorage.org/files/9e2/1a4/62a/9e21a462a5794b7b820619abc4edb1ec.jpg"> <br>   ,  ¬´¬ª(F5). <br> <img src="//habrastorage.org/files/f25/1a9/ff3/f251a9ff31c7413f96bf83dc1ee3a4e6.jpg"> <br>   ‚Äì  ,       (   ‚Äì XSLT).  Enter. <br> <br>         XSLT,        .  ,        ,    ‚Äì  . <br> <br>        , ..,   ,         (   ,    , ,   html ). <br> <br>    ,       , ..    .      <br> <code class="xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsl</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/1999/XSL/Transform"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:sap</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/sapxsl"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:strip-space</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">elements</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> : <br> <code>xmlns:xsl</code> ,       xsl. ..       ,       <code>xsl</code> : ( <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:strip-space</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">elements</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> ) <code>xmlns:sap</code> ,       sap <code>xsl:transform</code> ,     XSLT- <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:strip-space</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">elements</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag">/&gt;</span></span></code>      <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span></code>   ,       XML  <br> <br> XSLT-      ( <code>xsl:template</code> )     XML-,      <code>match</code> .   <code>match</code>      <a href="http://ru.wikipedia.org/wiki/XPath">XPath</a> .    ,     ¬´/¬ª,      XML- <code>TABLE</code>    "/asx:abap/asx:values/TABLE" (..    XML-   ( <code>asx:abap</code> )    ( <code>TABLE</code> )). <br> <br>  ,      XML- List.   : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>        <code>item</code>   <code>TABLE</code>   XML ,      <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:values/TABLE/item"</span></span></span><span class="hljs-tag">&gt;</span></span></code> ,    <code>select</code>  XPath   ,     .       <code>MyItem</code> ,     <code>Name</code>   NAME    ,    .  ,       : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:values/TABLE/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>        <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> ,   <code>select</code>   XPath-  ,     .  ,    <code>xsl:value-of</code>   ,   <code>xsl:for-each</code> .   ,   <code>xsl:for-each</code>   ,    ,   <code>xsl:value-of</code> ‚Äì     (..    <code>xsl:for-each</code> ). <br>  ,   ,         . <br>  ,            <code>asx, sap, prg</code> (XSLT     ).       XML,  <code>xsl:transform</code>  : <br> <code class="xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsl</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/1999/XSL/Transform"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:sap</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/sapxsl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:asx</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/abapxml"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:prg</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">exclude-result-prefixes</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"asx sap prg"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> ..     ,    <code>exclude-result-prefixes</code>  ,       XML. <br>        ,       <code>RF_CHILD_LIST</code> .        .   ‚Äì   . <br> ,    id   .    <code>ChilListID</code> .     . <br>      : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"OutChilds"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> ..      <code>OutChilds</code>   <code>ChilListID</code> .  ,       XML-,    <code>/asx:abap/asx:heap</code> . <br> <br>       ?    item   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> .        <code>xsl:for-each</code> . <br>   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> : <br> <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]"</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br>  XPath ,        <code>prg:T_DEEP_STRUCT</code> ,    <code>id</code>   <code>ChilListID</code> . <br>        item: <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"item"</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> ,        ,   ,    , XSLT  .     : <br> <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]/item"</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>   <code>MyItem</code>   <code>Name</code> .    : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"OutChilds"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>      .    :      . <br>     <code>xsl:apply-templates</code> ,     <code>select</code>     XML      . <br>  ,  ,       <code>ChilListID</code> . ,      ,    <code>RF_CHILD_LIST</code>  <code>href,</code>    <code>#id___</code> . ..     <code>href</code>     ,    .     XPath  : <code>substring(RF_CHILD_LIST/@href,2)</code> . ..     : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:with-param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"substring(RF_CHILD_LIST/@href,2)"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>  ,     : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"OutChilds"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:with-param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"substring(RF_CHILD_LIST/@href,2)"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>  ,  ,     ,    . <br> <br> <b class="spoiler_title"> ,      :</b> <code class="xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsl</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/1999/XSL/Transform"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:sap</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/sapxsl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:asx</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/abapxml"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:prg</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">exclude-result-prefixes</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"asx sap prg"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:strip-space</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">elements</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--       , .   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--         XML --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:values/TABLE/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  NAMR  --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--      ,        --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:with-param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"substring(RF_CHILD_LIST/@href,2)"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--     --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"OutChilds"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  , id    ,   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--    --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:with-param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"substring(RF_CHILD_LIST/@href,2)"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> <br> <b class="spoiler_title">  ABAP-</b> <code class="bash">REPORT zedu_test_xslt_deep_transform. *      "   " TYPES : BEGIN OF tdeep_struct , name TYPE string , rf_child_list TYPE REF TO data , END OF tdeep_struct *       "   " , t_deep_struct TYPE STANDARD TABLE OF tdeep_struct WITH NON-UNIQUE DEFAULT KEY . DATA : gt_tree TYPE t_deep_struct "  , gtree TYPE tdeep_struct "       , gchild TYPE tdeep_struct "       , ggrandchild TYPE tdeep_struct "       , gxml_str TYPE string "  XML , go_xml_doc TYPE REF TO cl_xml_document "    XML . FIELD-SYMBOLS : <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_child_list</span></span></span><span class="hljs-tag">&gt;</span></span> TYPE t_deep_struct "    , <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_grandchild_list</span></span></span><span class="hljs-tag">&gt;</span></span> TYPE t_deep_struct "    . START-OF-SELECTION. *    gtree-name = 'GrandParent1'. CREATE DATA gtree-rf_child_list TYPE t_deep_struct. ASSIGN gtree-rf_child_list-&gt;* TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_child_list</span></span></span><span class="hljs-tag">&gt;</span></span>. gchild-name = 'Child1'. APPEND gchild TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_child_list</span></span></span><span class="hljs-tag">&gt;</span></span>. gchild-name = 'Child2'. CREATE DATA gchild-rf_child_list TYPE t_deep_struct. ASSIGN gchild-rf_child_list-&gt;* TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_grandchild_list</span></span></span><span class="hljs-tag">&gt;</span></span>. ggrandchild-name = 'GrandChild1'. APPEND ggrandchild TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_grandchild_list</span></span></span><span class="hljs-tag">&gt;</span></span>. APPEND gchild TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_child_list</span></span></span><span class="hljs-tag">&gt;</span></span>. APPEND gtree TO gt_tree. CLEAR gtree. gtree-name = 'GrandParent2'. APPEND gtree TO gt_tree. * XSLT- CALL TRANSFORMATION zedu_test_xslt_deep_transform2 SOURCE table = gt_tree RESULT XML gxml_str. *    XML CREATE OBJECT go_xml_doc. go_xml_doc-&gt;parse_string( gxml_str ). go_xml_doc-&gt;display( ).</code> <br> <br> <br>  <br>  ,      XSLT  ? <br> <br>   <br> <a href="http://help.sap.com/abapdocu_70/en/ABAPCALL_TRANSFORMATION.htm"> ABAP</a> <a href="http://msdn.microsoft.com/ru-ru/library/ms256069%2528v%3Dvs.110%2529.aspx">MSDN:   XSLT</a> <a href="http://zvon.org/comp/r/tut-XPath_1.html">XPath tutorial</a> <a href="http://www.w3.org/TR/xslt"> XSLT</a></code></code> </pre> <code><code><code>,         .           . ..      RF_CHILD_LIST</code> ,      DATA ( <code>TYPE REF TO DATA</code> ),      ,     <code>href</code>     ,    . <br> ,     <code>&lt;RF_CHILD_LIST href="#d1" /&gt;</code> ,   <code>#</code> -       <a href="http://ru.wikipedia.org/wiki/XLink">XLink</a> ,  <code>d1</code> ‚Äì  .         XML-: <code>asx:heap</code>  ,   <code>id</code>  d1.    &lt; <code>prg:T_DEEP_STRUCT id="d1" ‚Ä¶ &gt;</code> .      ,         . <br> ..,    XML   ,  . <br> <br>  XSLT- ? <br>     XSLT-. <br>  SAP      STRANS. <br> <img src="//habrastorage.org/files/9e2/1a4/62a/9e21a462a5794b7b820619abc4edb1ec.jpg"> <br>   ,  ¬´¬ª(F5). <br> <img src="//habrastorage.org/files/f25/1a9/ff3/f251a9ff31c7413f96bf83dc1ee3a4e6.jpg"> <br>   ‚Äì  ,       (   ‚Äì XSLT).  Enter. <br> <br>         XSLT,        .  ,        ,    ‚Äì  . <br> <br>        , ..,   ,         (   ,    , ,   html ). <br> <br>    ,       , ..    .      <br> <code class="xml">&lt;xsl:transform version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;xsl:template match="/"&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> : <br> <code>xmlns:xsl</code> ,       xsl. ..       ,       <code>xsl</code> : ( <code>&lt;xsl:strip-space elements="*"/&gt;</code> ) <code>xmlns:sap</code> ,       sap <code>xsl:transform</code> ,     XSLT- <code>&lt;xsl:strip-space elements="*"/&gt;</code>      <code>&lt;xsl:template match="/"&gt;</code>   ,       XML  <br> <br> XSLT-      ( <code>xsl:template</code> )     XML-,      <code>match</code> .   <code>match</code>      <a href="http://ru.wikipedia.org/wiki/XPath">XPath</a> .    ,     ¬´/¬ª,      XML- <code>TABLE</code>    "/asx:abap/asx:values/TABLE" (..    XML-   ( <code>asx:abap</code> )    ( <code>TABLE</code> )). <br> <br>  ,      XML- List.   : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>item</code>   <code>TABLE</code>   XML ,      <code>&lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt;</code> ,    <code>select</code>  XPath   ,     .       <code>MyItem</code> ,     <code>Name</code>   NAME    ,    .  ,       : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>&lt;xsl:value-of select="NAME"/&gt;</code> ,   <code>select</code>   XPath-  ,     .  ,    <code>xsl:value-of</code>   ,   <code>xsl:for-each</code> .   ,   <code>xsl:for-each</code>   ,    ,   <code>xsl:value-of</code> ‚Äì     (..    <code>xsl:for-each</code> ). <br>  ,   ,         . <br>  ,            <code>asx, sap, prg</code> (XSLT     ).       XML,  <code>xsl:transform</code>  : <br> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt;</code> <br> <br> ..     ,    <code>exclude-result-prefixes</code>  ,       XML. <br>        ,       <code>RF_CHILD_LIST</code> .        .   ‚Äì   . <br> ,    id   .    <code>ChilListID</code> .     . <br>      : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;/xsl:template&gt;</code> <br> <br> ..      <code>OutChilds</code>   <code>ChilListID</code> .  ,       XML-,    <code>/asx:abap/asx:heap</code> . <br> <br>       ?    item   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> .        <code>xsl:for-each</code> . <br>   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]"&gt;</code> <br>  XPath ,        <code>prg:T_DEEP_STRUCT</code> ,    <code>id</code>   <code>ChilListID</code> . <br>        item: <code>&lt;xsl:for-each select="item"&gt;</code> <br> <br> ,        ,   ,    , XSLT  .     : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt;</code> <br> <br>   <code>MyItem</code>   <code>Name</code> .    : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>      .    :      . <br>     <code>xsl:apply-templates</code> ,     <code>select</code>     XML      . <br>  ,  ,       <code>ChilListID</code> . ,      ,    <code>RF_CHILD_LIST</code>  <code>href,</code>    <code>#id___</code> . ..     <code>href</code>     ,    .     XPath  : <code>substring(RF_CHILD_LIST/@href,2)</code> . ..     : <br> <code class="xml"> &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt;</code> <br> <br>  ,     : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>  ,  ,     ,    . <br> <br> <b class="spoiler_title"> ,      :</b> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;!--       , .   --&gt; &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;!--         XML --&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;!--  NAMR  --&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--      ,        --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt; &lt;!--     --&gt; &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;!--   --&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;!--  , id    ,   --&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--    --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> <br> <b class="spoiler_title">  ABAP-</b> <code class="bash">REPORT zedu_test_xslt_deep_transform. *      "   " TYPES : BEGIN OF tdeep_struct , name TYPE string , rf_child_list TYPE REF TO data , END OF tdeep_struct *       "   " , t_deep_struct TYPE STANDARD TABLE OF tdeep_struct WITH NON-UNIQUE DEFAULT KEY . DATA : gt_tree TYPE t_deep_struct "  , gtree TYPE tdeep_struct "       , gchild TYPE tdeep_struct "       , ggrandchild TYPE tdeep_struct "       , gxml_str TYPE string "  XML , go_xml_doc TYPE REF TO cl_xml_document "    XML . FIELD-SYMBOLS : &lt;gt_child_list&gt; TYPE t_deep_struct "    , &lt;gt_grandchild_list&gt; TYPE t_deep_struct "    . START-OF-SELECTION. *    gtree-name = 'GrandParent1'. CREATE DATA gtree-rf_child_list TYPE t_deep_struct. ASSIGN gtree-rf_child_list-&gt;* TO &lt;gt_child_list&gt;. gchild-name = 'Child1'. APPEND gchild TO &lt;gt_child_list&gt;. gchild-name = 'Child2'. CREATE DATA gchild-rf_child_list TYPE t_deep_struct. ASSIGN gchild-rf_child_list-&gt;* TO &lt;gt_grandchild_list&gt;. ggrandchild-name = 'GrandChild1'. APPEND ggrandchild TO &lt;gt_grandchild_list&gt;. APPEND gchild TO &lt;gt_child_list&gt;. APPEND gtree TO gt_tree. CLEAR gtree. gtree-name = 'GrandParent2'. APPEND gtree TO gt_tree. * XSLT- CALL TRANSFORMATION zedu_test_xslt_deep_transform2 SOURCE table = gt_tree RESULT XML gxml_str. *    XML CREATE OBJECT go_xml_doc. go_xml_doc-&gt;parse_string( gxml_str ). go_xml_doc-&gt;display( ).</code> <br> <br> <br>  <br>  ,      XSLT  ? <br> <br>   <br> <a href="http://help.sap.com/abapdocu_70/en/ABAPCALL_TRANSFORMATION.htm"> ABAP</a> <a href="http://msdn.microsoft.com/ru-ru/library/ms256069%2528v%3Dvs.110%2529.aspx">MSDN:   XSLT</a> <a href="http://zvon.org/comp/r/tut-XPath_1.html">XPath tutorial</a> <a href="http://www.w3.org/TR/xslt"> XSLT</a></code></code> </div></div> <code><code><code>,         .           . ..      RF_CHILD_LIST</code> ,      DATA ( <code>TYPE REF TO DATA</code> ),      ,     <code>href</code>     ,    . <br> ,     <code>&lt;RF_CHILD_LIST href="#d1" /&gt;</code> ,   <code>#</code> -       <a href="http://ru.wikipedia.org/wiki/XLink">XLink</a> ,  <code>d1</code> ‚Äì  .         XML-: <code>asx:heap</code>  ,   <code>id</code>  d1.    &lt; <code>prg:T_DEEP_STRUCT id="d1" ‚Ä¶ &gt;</code> .      ,         . <br> ..,    XML   ,  . <br> <br>  XSLT- ? <br>     XSLT-. <br>  SAP      STRANS. <br> <img src="//habrastorage.org/files/9e2/1a4/62a/9e21a462a5794b7b820619abc4edb1ec.jpg"> <br>   ,  ¬´¬ª(F5). <br> <img src="//habrastorage.org/files/f25/1a9/ff3/f251a9ff31c7413f96bf83dc1ee3a4e6.jpg"> <br>   ‚Äì  ,       (   ‚Äì XSLT).  Enter. <br> <br>         XSLT,        .  ,        ,    ‚Äì  . <br> <br>        , ..,   ,         (   ,    , ,   html ). <br> <br>    ,       , ..    .      <br> <code class="xml">&lt;xsl:transform version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;xsl:template match="/"&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> : <br> <code>xmlns:xsl</code> ,       xsl. ..       ,       <code>xsl</code> : ( <code>&lt;xsl:strip-space elements="*"/&gt;</code> ) <code>xmlns:sap</code> ,       sap <code>xsl:transform</code> ,     XSLT- <code>&lt;xsl:strip-space elements="*"/&gt;</code>      <code>&lt;xsl:template match="/"&gt;</code>   ,       XML  <br> <br> XSLT-      ( <code>xsl:template</code> )     XML-,      <code>match</code> .   <code>match</code>      <a href="http://ru.wikipedia.org/wiki/XPath">XPath</a> .    ,     ¬´/¬ª,      XML- <code>TABLE</code>    "/asx:abap/asx:values/TABLE" (..    XML-   ( <code>asx:abap</code> )    ( <code>TABLE</code> )). <br> <br>  ,      XML- List.   : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>item</code>   <code>TABLE</code>   XML ,      <code>&lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt;</code> ,    <code>select</code>  XPath   ,     .       <code>MyItem</code> ,     <code>Name</code>   NAME    ,    .  ,       : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>&lt;xsl:value-of select="NAME"/&gt;</code> ,   <code>select</code>   XPath-  ,     .  ,    <code>xsl:value-of</code>   ,   <code>xsl:for-each</code> .   ,   <code>xsl:for-each</code>   ,    ,   <code>xsl:value-of</code> ‚Äì     (..    <code>xsl:for-each</code> ). <br>  ,   ,         . <br>  ,            <code>asx, sap, prg</code> (XSLT     ).       XML,  <code>xsl:transform</code>  : <br> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt;</code> <br> <br> ..     ,    <code>exclude-result-prefixes</code>  ,       XML. <br>        ,       <code>RF_CHILD_LIST</code> .        .   ‚Äì   . <br> ,    id   .    <code>ChilListID</code> .     . <br>      : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;/xsl:template&gt;</code> <br> <br> ..      <code>OutChilds</code>   <code>ChilListID</code> .  ,       XML-,    <code>/asx:abap/asx:heap</code> . <br> <br>       ?    item   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> .        <code>xsl:for-each</code> . <br>   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]"&gt;</code> <br>  XPath ,        <code>prg:T_DEEP_STRUCT</code> ,    <code>id</code>   <code>ChilListID</code> . <br>        item: <code>&lt;xsl:for-each select="item"&gt;</code> <br> <br> ,        ,   ,    , XSLT  .     : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt;</code> <br> <br>   <code>MyItem</code>   <code>Name</code> .    : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>      .    :      . <br>     <code>xsl:apply-templates</code> ,     <code>select</code>     XML      . <br>  ,  ,       <code>ChilListID</code> . ,      ,    <code>RF_CHILD_LIST</code>  <code>href,</code>    <code>#id___</code> . ..     <code>href</code>     ,    .     XPath  : <code>substring(RF_CHILD_LIST/@href,2)</code> . ..     : <br> <code class="xml"> &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt;</code> <br> <br>  ,     : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>  ,  ,     ,    . <br> <br> <b class="spoiler_title"> ,      :</b> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;!--       , .   --&gt; &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;!--         XML --&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;!--  NAMR  --&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--      ,        --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt; &lt;!--     --&gt; &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;!--   --&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;!--  , id    ,   --&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--    --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> <br> <b class="spoiler_title">  ABAP-</b> <code class="bash">REPORT zedu_test_xslt_deep_transform. *      "   " TYPES : BEGIN OF tdeep_struct , name TYPE string , rf_child_list TYPE REF TO data , END OF tdeep_struct *       "   " , t_deep_struct TYPE STANDARD TABLE OF tdeep_struct WITH NON-UNIQUE DEFAULT KEY . DATA : gt_tree TYPE t_deep_struct "  , gtree TYPE tdeep_struct "       , gchild TYPE tdeep_struct "       , ggrandchild TYPE tdeep_struct "       , gxml_str TYPE string "  XML , go_xml_doc TYPE REF TO cl_xml_document "    XML . FIELD-SYMBOLS : &lt;gt_child_list&gt; TYPE t_deep_struct "    , &lt;gt_grandchild_list&gt; TYPE t_deep_struct "    . START-OF-SELECTION. *    gtree-name = 'GrandParent1'. CREATE DATA gtree-rf_child_list TYPE t_deep_struct. ASSIGN gtree-rf_child_list-&gt;* TO &lt;gt_child_list&gt;. gchild-name = 'Child1'. APPEND gchild TO &lt;gt_child_list&gt;. gchild-name = 'Child2'. CREATE DATA gchild-rf_child_list TYPE t_deep_struct. ASSIGN gchild-rf_child_list-&gt;* TO &lt;gt_grandchild_list&gt;. ggrandchild-name = 'GrandChild1'. APPEND ggrandchild TO &lt;gt_grandchild_list&gt;. APPEND gchild TO &lt;gt_child_list&gt;. APPEND gtree TO gt_tree. CLEAR gtree. gtree-name = 'GrandParent2'. APPEND gtree TO gt_tree. * XSLT- CALL TRANSFORMATION zedu_test_xslt_deep_transform2 SOURCE table = gt_tree RESULT XML gxml_str. *    XML CREATE OBJECT go_xml_doc. go_xml_doc-&gt;parse_string( gxml_str ). go_xml_doc-&gt;display( ).</code> <br> <br> <br>  <br>  ,      XSLT  ? <br> <br>   <br> <a href="http://help.sap.com/abapdocu_70/en/ABAPCALL_TRANSFORMATION.htm"> ABAP</a> <a href="http://msdn.microsoft.com/ru-ru/library/ms256069%2528v%3Dvs.110%2529.aspx">MSDN:   XSLT</a> <a href="http://zvon.org/comp/r/tut-XPath_1.html">XPath tutorial</a> <a href="http://www.w3.org/TR/xslt"> XSLT</a></code></code> <div class="spoiler"> <code><code><b class="spoiler_title"><code>,         .           . ..      RF_CHILD_LIST</code> ,      DATA ( <code>TYPE REF TO DATA</code> ),      ,     <code>href</code>     ,    . <br> ,     <code>&lt;RF_CHILD_LIST href="#d1" /&gt;</code> ,   <code>#</code> -       <a href="http://ru.wikipedia.org/wiki/XLink">XLink</a> ,  <code>d1</code> ‚Äì  .         XML-: <code>asx:heap</code>  ,   <code>id</code>  d1.    &lt; <code>prg:T_DEEP_STRUCT id="d1" ‚Ä¶ &gt;</code> .      ,         . <br> ..,    XML   ,  . <br> <br>  XSLT- ? <br>     XSLT-. <br>  SAP      STRANS. <br> <img src="//habrastorage.org/files/9e2/1a4/62a/9e21a462a5794b7b820619abc4edb1ec.jpg"> <br>   ,  ¬´¬ª(F5). <br> <img src="//habrastorage.org/files/f25/1a9/ff3/f251a9ff31c7413f96bf83dc1ee3a4e6.jpg"> <br>   ‚Äì  ,       (   ‚Äì XSLT).  Enter. <br> <br>         XSLT,        .  ,        ,    ‚Äì  . <br> <br>        , ..,   ,         (   ,    , ,   html ). <br> <br>    ,       , ..    .      <br> <code class="xml">&lt;xsl:transform version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;xsl:template match="/"&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> : <br> <code>xmlns:xsl</code> ,       xsl. ..       ,       <code>xsl</code> : ( <code>&lt;xsl:strip-space elements="*"/&gt;</code> ) <code>xmlns:sap</code> ,       sap <code>xsl:transform</code> ,     XSLT- <code>&lt;xsl:strip-space elements="*"/&gt;</code>      <code>&lt;xsl:template match="/"&gt;</code>   ,       XML  <br> <br> XSLT-      ( <code>xsl:template</code> )     XML-,      <code>match</code> .   <code>match</code>      <a href="http://ru.wikipedia.org/wiki/XPath">XPath</a> .    ,     ¬´/¬ª,      XML- <code>TABLE</code>    "/asx:abap/asx:values/TABLE" (..    XML-   ( <code>asx:abap</code> )    ( <code>TABLE</code> )). <br> <br>  ,      XML- List.   : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>item</code>   <code>TABLE</code>   XML ,      <code>&lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt;</code> ,    <code>select</code>  XPath   ,     .       <code>MyItem</code> ,     <code>Name</code>   NAME    ,    .  ,       : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>&lt;xsl:value-of select="NAME"/&gt;</code> ,   <code>select</code>   XPath-  ,     .  ,    <code>xsl:value-of</code>   ,   <code>xsl:for-each</code> .   ,   <code>xsl:for-each</code>   ,    ,   <code>xsl:value-of</code> ‚Äì     (..    <code>xsl:for-each</code> ). <br>  ,   ,         . <br>  ,            <code>asx, sap, prg</code> (XSLT     ).       XML,  <code>xsl:transform</code>  : <br> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt;</code> <br> <br> ..     ,    <code>exclude-result-prefixes</code>  ,       XML. <br>        ,       <code>RF_CHILD_LIST</code> .        .   ‚Äì   . <br> ,    id   .    <code>ChilListID</code> .     . <br>      : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;/xsl:template&gt;</code> <br> <br> ..      <code>OutChilds</code>   <code>ChilListID</code> .  ,       XML-,    <code>/asx:abap/asx:heap</code> . <br> <br>       ?    item   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> .        <code>xsl:for-each</code> . <br>   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]"&gt;</code> <br>  XPath ,        <code>prg:T_DEEP_STRUCT</code> ,    <code>id</code>   <code>ChilListID</code> . <br>        item: <code>&lt;xsl:for-each select="item"&gt;</code> <br> <br> ,        ,   ,    , XSLT  .     : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt;</code> <br> <br>   <code>MyItem</code>   <code>Name</code> .    : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>      .    :      . <br>     <code>xsl:apply-templates</code> ,     <code>select</code>     XML      . <br>  ,  ,       <code>ChilListID</code> . ,      ,    <code>RF_CHILD_LIST</code>  <code>href,</code>    <code>#id___</code> . ..     <code>href</code>     ,    .     XPath  : <code>substring(RF_CHILD_LIST/@href,2)</code> . ..     : <br> <code class="xml"> &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt;</code> <br> <br>  ,     : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>  ,  ,     ,    . <br> <br> <b class="spoiler_title"> ,      :</b> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;!--       , .   --&gt; &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;!--         XML --&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;!--  NAMR  --&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--      ,        --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt; &lt;!--     --&gt; &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;!--   --&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;!--  , id    ,   --&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--    --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> <br>   ABAP- <code class="bash">REPORT zedu_test_xslt_deep_transform. *      "   " TYPES : BEGIN OF tdeep_struct , name TYPE string , rf_child_list TYPE REF TO data , END OF tdeep_struct *       "   " , t_deep_struct TYPE STANDARD TABLE OF tdeep_struct WITH NON-UNIQUE DEFAULT KEY . DATA : gt_tree TYPE t_deep_struct "  , gtree TYPE tdeep_struct "       , gchild TYPE tdeep_struct "       , ggrandchild TYPE tdeep_struct "       , gxml_str TYPE string "  XML , go_xml_doc TYPE REF TO cl_xml_document "    XML . FIELD-SYMBOLS : &lt;gt_child_list&gt; TYPE t_deep_struct "    , &lt;gt_grandchild_list&gt; TYPE t_deep_struct "    . START-OF-SELECTION. *    gtree-name = 'GrandParent1'. CREATE DATA gtree-rf_child_list TYPE t_deep_struct. ASSIGN gtree-rf_child_list-&gt;* TO &lt;gt_child_list&gt;. gchild-name = 'Child1'. APPEND gchild TO &lt;gt_child_list&gt;. gchild-name = 'Child2'. CREATE DATA gchild-rf_child_list TYPE t_deep_struct. ASSIGN gchild-rf_child_list-&gt;* TO &lt;gt_grandchild_list&gt;. ggrandchild-name = 'GrandChild1'. APPEND ggrandchild TO &lt;gt_grandchild_list&gt;. APPEND gchild TO &lt;gt_child_list&gt;. APPEND gtree TO gt_tree. CLEAR gtree. gtree-name = 'GrandParent2'. APPEND gtree TO gt_tree. * XSLT- CALL TRANSFORMATION zedu_test_xslt_deep_transform2 SOURCE table = gt_tree RESULT XML gxml_str. *    XML CREATE OBJECT go_xml_doc. go_xml_doc-&gt;parse_string( gxml_str ). go_xml_doc-&gt;display( ).</code> <br> <br> <br>  <br>  ,      XSLT  ? <br> <br>   <br> <a href="http://help.sap.com/abapdocu_70/en/ABAPCALL_TRANSFORMATION.htm"> ABAP</a> <a href="http://msdn.microsoft.com/ru-ru/library/ms256069%2528v%3Dvs.110%2529.aspx">MSDN:   XSLT</a> <a href="http://zvon.org/comp/r/tut-XPath_1.html">XPath tutorial</a> <a href="http://www.w3.org/TR/xslt"> XSLT</a></b></code></code> <div class="spoiler_text"> <pre> <code class="hljs xml"><code><code>,         .           . ..      RF_CHILD_LIST</code> ,      DATA ( <code>TYPE REF TO DATA</code> ),      ,     <code>href</code>     ,    . <br> ,     <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RF_CHILD_LIST</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"#d1"</span></span></span><span class="hljs-tag"> /&gt;</span></span></code> ,   <code>#</code> -       <a href="http://ru.wikipedia.org/wiki/XLink">XLink</a> ,  <code>d1</code> ‚Äì  .         XML-: <code>asx:heap</code>  ,   <code>id</code>  d1.    <span class="hljs-tag"><span class="hljs-tag">&lt; </span></span><code><span class="hljs-tag"><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">prg:T_DEEP_STRUCT</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"d1"</span></span></span><span class="hljs-tag"> ‚Ä¶ &gt;</span></span></code> .      ,         . <br> ..,    XML   ,  . <br> <br>  XSLT- ? <br>     XSLT-. <br>  SAP      STRANS. <br> <img src="//habrastorage.org/files/9e2/1a4/62a/9e21a462a5794b7b820619abc4edb1ec.jpg"> <br>   ,  ¬´¬ª(F5). <br> <img src="//habrastorage.org/files/f25/1a9/ff3/f251a9ff31c7413f96bf83dc1ee3a4e6.jpg"> <br>   ‚Äì  ,       (   ‚Äì XSLT).  Enter. <br> <br>         XSLT,        .  ,        ,    ‚Äì  . <br> <br>        , ..,   ,         (   ,    , ,   html ). <br> <br>    ,       , ..    .      <br> <code class="xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsl</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/1999/XSL/Transform"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:sap</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/sapxsl"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:strip-space</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">elements</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> : <br> <code>xmlns:xsl</code> ,       xsl. ..       ,       <code>xsl</code> : ( <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:strip-space</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">elements</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> ) <code>xmlns:sap</code> ,       sap <code>xsl:transform</code> ,     XSLT- <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:strip-space</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">elements</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag">/&gt;</span></span></code>      <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span></code>   ,       XML  <br> <br> XSLT-      ( <code>xsl:template</code> )     XML-,      <code>match</code> .   <code>match</code>      <a href="http://ru.wikipedia.org/wiki/XPath">XPath</a> .    ,     ¬´/¬ª,      XML- <code>TABLE</code>    "/asx:abap/asx:values/TABLE" (..    XML-   ( <code>asx:abap</code> )    ( <code>TABLE</code> )). <br> <br>  ,      XML- List.   : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>        <code>item</code>   <code>TABLE</code>   XML ,      <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:values/TABLE/item"</span></span></span><span class="hljs-tag">&gt;</span></span></code> ,    <code>select</code>  XPath   ,     .       <code>MyItem</code> ,     <code>Name</code>   NAME    ,    .  ,       : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:values/TABLE/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>        <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> ,   <code>select</code>   XPath-  ,     .  ,    <code>xsl:value-of</code>   ,   <code>xsl:for-each</code> .   ,   <code>xsl:for-each</code>   ,    ,   <code>xsl:value-of</code> ‚Äì     (..    <code>xsl:for-each</code> ). <br>  ,   ,         . <br>  ,            <code>asx, sap, prg</code> (XSLT     ).       XML,  <code>xsl:transform</code>  : <br> <code class="xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsl</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/1999/XSL/Transform"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:sap</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/sapxsl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:asx</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/abapxml"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:prg</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">exclude-result-prefixes</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"asx sap prg"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> ..     ,    <code>exclude-result-prefixes</code>  ,       XML. <br>        ,       <code>RF_CHILD_LIST</code> .        .   ‚Äì   . <br> ,    id   .    <code>ChilListID</code> .     . <br>      : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"OutChilds"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> ..      <code>OutChilds</code>   <code>ChilListID</code> .  ,       XML-,    <code>/asx:abap/asx:heap</code> . <br> <br>       ?    item   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> .        <code>xsl:for-each</code> . <br>   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> : <br> <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]"</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br>  XPath ,        <code>prg:T_DEEP_STRUCT</code> ,    <code>id</code>   <code>ChilListID</code> . <br>        item: <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"item"</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> ,        ,   ,    , XSLT  .     : <br> <code><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]/item"</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>   <code>MyItem</code>   <code>Name</code> .    : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"OutChilds"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>      .    :      . <br>     <code>xsl:apply-templates</code> ,     <code>select</code>     XML      . <br>  ,  ,       <code>ChilListID</code> . ,      ,    <code>RF_CHILD_LIST</code>  <code>href,</code>    <code>#id___</code> . ..     <code>href</code>     ,    .     XPath  : <code>substring(RF_CHILD_LIST/@href,2)</code> . ..     : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:with-param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"substring(RF_CHILD_LIST/@href,2)"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>  ,     : <br> <code class="xml"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"OutChilds"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:with-param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"substring(RF_CHILD_LIST/@href,2)"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br>  ,  ,     ,    . <br> <br> <b class="spoiler_title"> ,      :</b> <code class="xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsl</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/1999/XSL/Transform"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:sap</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/sapxsl"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:asx</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/abapxml"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:prg</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">exclude-result-prefixes</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"asx sap prg"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:strip-space</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">elements</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--       , .   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--         XML --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:values/TABLE/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  NAMR  --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--      ,        --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:with-param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"substring(RF_CHILD_LIST/@href,2)"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">List</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--     --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">match</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"OutChilds"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  , id    ,   --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"prg:T_DEEP_STRUCT[@id=$ChilListID]/item"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"NAME"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">MyItem</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--    --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/asx:abap/asx:heap"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:with-param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ChilListID"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"substring(RF_CHILD_LIST/@href,2)"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:apply-templates</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:template</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:transform</span></span></span><span class="hljs-tag">&gt;</span></span></code> <br> <br> <br> <b class="spoiler_title">  ABAP-</b> <code class="bash">REPORT zedu_test_xslt_deep_transform. *      "   " TYPES : BEGIN OF tdeep_struct , name TYPE string , rf_child_list TYPE REF TO data , END OF tdeep_struct *       "   " , t_deep_struct TYPE STANDARD TABLE OF tdeep_struct WITH NON-UNIQUE DEFAULT KEY . DATA : gt_tree TYPE t_deep_struct "  , gtree TYPE tdeep_struct "       , gchild TYPE tdeep_struct "       , ggrandchild TYPE tdeep_struct "       , gxml_str TYPE string "  XML , go_xml_doc TYPE REF TO cl_xml_document "    XML . FIELD-SYMBOLS : <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_child_list</span></span></span><span class="hljs-tag">&gt;</span></span> TYPE t_deep_struct "    , <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_grandchild_list</span></span></span><span class="hljs-tag">&gt;</span></span> TYPE t_deep_struct "    . START-OF-SELECTION. *    gtree-name = 'GrandParent1'. CREATE DATA gtree-rf_child_list TYPE t_deep_struct. ASSIGN gtree-rf_child_list-&gt;* TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_child_list</span></span></span><span class="hljs-tag">&gt;</span></span>. gchild-name = 'Child1'. APPEND gchild TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_child_list</span></span></span><span class="hljs-tag">&gt;</span></span>. gchild-name = 'Child2'. CREATE DATA gchild-rf_child_list TYPE t_deep_struct. ASSIGN gchild-rf_child_list-&gt;* TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_grandchild_list</span></span></span><span class="hljs-tag">&gt;</span></span>. ggrandchild-name = 'GrandChild1'. APPEND ggrandchild TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_grandchild_list</span></span></span><span class="hljs-tag">&gt;</span></span>. APPEND gchild TO <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">gt_child_list</span></span></span><span class="hljs-tag">&gt;</span></span>. APPEND gtree TO gt_tree. CLEAR gtree. gtree-name = 'GrandParent2'. APPEND gtree TO gt_tree. * XSLT- CALL TRANSFORMATION zedu_test_xslt_deep_transform2 SOURCE table = gt_tree RESULT XML gxml_str. *    XML CREATE OBJECT go_xml_doc. go_xml_doc-&gt;parse_string( gxml_str ). go_xml_doc-&gt;display( ).</code> <br> <br> <br>  <br>  ,      XSLT  ? <br> <br>   <br> <a href="http://help.sap.com/abapdocu_70/en/ABAPCALL_TRANSFORMATION.htm"> ABAP</a> <a href="http://msdn.microsoft.com/ru-ru/library/ms256069%2528v%3Dvs.110%2529.aspx">MSDN:   XSLT</a> <a href="http://zvon.org/comp/r/tut-XPath_1.html">XPath tutorial</a> <a href="http://www.w3.org/TR/xslt"> XSLT</a></code></code> </pre> <code><code><code>,         .           . ..      RF_CHILD_LIST</code> ,      DATA ( <code>TYPE REF TO DATA</code> ),      ,     <code>href</code>     ,    . <br> ,     <code>&lt;RF_CHILD_LIST href="#d1" /&gt;</code> ,   <code>#</code> -       <a href="http://ru.wikipedia.org/wiki/XLink">XLink</a> ,  <code>d1</code> ‚Äì  .         XML-: <code>asx:heap</code>  ,   <code>id</code>  d1.    &lt; <code>prg:T_DEEP_STRUCT id="d1" ‚Ä¶ &gt;</code> .      ,         . <br> ..,    XML   ,  . <br> <br>  XSLT- ? <br>     XSLT-. <br>  SAP      STRANS. <br> <img src="//habrastorage.org/files/9e2/1a4/62a/9e21a462a5794b7b820619abc4edb1ec.jpg"> <br>   ,  ¬´¬ª(F5). <br> <img src="//habrastorage.org/files/f25/1a9/ff3/f251a9ff31c7413f96bf83dc1ee3a4e6.jpg"> <br>   ‚Äì  ,       (   ‚Äì XSLT).  Enter. <br> <br>         XSLT,        .  ,        ,    ‚Äì  . <br> <br>        , ..,   ,         (   ,    , ,   html ). <br> <br>    ,       , ..    .      <br> <code class="xml">&lt;xsl:transform version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;xsl:template match="/"&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> : <br> <code>xmlns:xsl</code> ,       xsl. ..       ,       <code>xsl</code> : ( <code>&lt;xsl:strip-space elements="*"/&gt;</code> ) <code>xmlns:sap</code> ,       sap <code>xsl:transform</code> ,     XSLT- <code>&lt;xsl:strip-space elements="*"/&gt;</code>      <code>&lt;xsl:template match="/"&gt;</code>   ,       XML  <br> <br> XSLT-      ( <code>xsl:template</code> )     XML-,      <code>match</code> .   <code>match</code>      <a href="http://ru.wikipedia.org/wiki/XPath">XPath</a> .    ,     ¬´/¬ª,      XML- <code>TABLE</code>    "/asx:abap/asx:values/TABLE" (..    XML-   ( <code>asx:abap</code> )    ( <code>TABLE</code> )). <br> <br>  ,      XML- List.   : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>item</code>   <code>TABLE</code>   XML ,      <code>&lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt;</code> ,    <code>select</code>  XPath   ,     .       <code>MyItem</code> ,     <code>Name</code>   NAME    ,    .  ,       : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>&lt;xsl:value-of select="NAME"/&gt;</code> ,   <code>select</code>   XPath-  ,     .  ,    <code>xsl:value-of</code>   ,   <code>xsl:for-each</code> .   ,   <code>xsl:for-each</code>   ,    ,   <code>xsl:value-of</code> ‚Äì     (..    <code>xsl:for-each</code> ). <br>  ,   ,         . <br>  ,            <code>asx, sap, prg</code> (XSLT     ).       XML,  <code>xsl:transform</code>  : <br> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt;</code> <br> <br> ..     ,    <code>exclude-result-prefixes</code>  ,       XML. <br>        ,       <code>RF_CHILD_LIST</code> .        .   ‚Äì   . <br> ,    id   .    <code>ChilListID</code> .     . <br>      : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;/xsl:template&gt;</code> <br> <br> ..      <code>OutChilds</code>   <code>ChilListID</code> .  ,       XML-,    <code>/asx:abap/asx:heap</code> . <br> <br>       ?    item   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> .        <code>xsl:for-each</code> . <br>   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]"&gt;</code> <br>  XPath ,        <code>prg:T_DEEP_STRUCT</code> ,    <code>id</code>   <code>ChilListID</code> . <br>        item: <code>&lt;xsl:for-each select="item"&gt;</code> <br> <br> ,        ,   ,    , XSLT  .     : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt;</code> <br> <br>   <code>MyItem</code>   <code>Name</code> .    : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>      .    :      . <br>     <code>xsl:apply-templates</code> ,     <code>select</code>     XML      . <br>  ,  ,       <code>ChilListID</code> . ,      ,    <code>RF_CHILD_LIST</code>  <code>href,</code>    <code>#id___</code> . ..     <code>href</code>     ,    .     XPath  : <code>substring(RF_CHILD_LIST/@href,2)</code> . ..     : <br> <code class="xml"> &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt;</code> <br> <br>  ,     : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>  ,  ,     ,    . <br> <br> <b class="spoiler_title"> ,      :</b> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;!--       , .   --&gt; &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;!--         XML --&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;!--  NAMR  --&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--      ,        --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt; &lt;!--     --&gt; &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;!--   --&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;!--  , id    ,   --&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--    --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> <br> <b class="spoiler_title">  ABAP-</b> <code class="bash">REPORT zedu_test_xslt_deep_transform. *      "   " TYPES : BEGIN OF tdeep_struct , name TYPE string , rf_child_list TYPE REF TO data , END OF tdeep_struct *       "   " , t_deep_struct TYPE STANDARD TABLE OF tdeep_struct WITH NON-UNIQUE DEFAULT KEY . DATA : gt_tree TYPE t_deep_struct "  , gtree TYPE tdeep_struct "       , gchild TYPE tdeep_struct "       , ggrandchild TYPE tdeep_struct "       , gxml_str TYPE string "  XML , go_xml_doc TYPE REF TO cl_xml_document "    XML . FIELD-SYMBOLS : &lt;gt_child_list&gt; TYPE t_deep_struct "    , &lt;gt_grandchild_list&gt; TYPE t_deep_struct "    . START-OF-SELECTION. *    gtree-name = 'GrandParent1'. CREATE DATA gtree-rf_child_list TYPE t_deep_struct. ASSIGN gtree-rf_child_list-&gt;* TO &lt;gt_child_list&gt;. gchild-name = 'Child1'. APPEND gchild TO &lt;gt_child_list&gt;. gchild-name = 'Child2'. CREATE DATA gchild-rf_child_list TYPE t_deep_struct. ASSIGN gchild-rf_child_list-&gt;* TO &lt;gt_grandchild_list&gt;. ggrandchild-name = 'GrandChild1'. APPEND ggrandchild TO &lt;gt_grandchild_list&gt;. APPEND gchild TO &lt;gt_child_list&gt;. APPEND gtree TO gt_tree. CLEAR gtree. gtree-name = 'GrandParent2'. APPEND gtree TO gt_tree. * XSLT- CALL TRANSFORMATION zedu_test_xslt_deep_transform2 SOURCE table = gt_tree RESULT XML gxml_str. *    XML CREATE OBJECT go_xml_doc. go_xml_doc-&gt;parse_string( gxml_str ). go_xml_doc-&gt;display( ).</code> <br> <br> <br>  <br>  ,      XSLT  ? <br> <br>   <br> <a href="http://help.sap.com/abapdocu_70/en/ABAPCALL_TRANSFORMATION.htm"> ABAP</a> <a href="http://msdn.microsoft.com/ru-ru/library/ms256069%2528v%3Dvs.110%2529.aspx">MSDN:   XSLT</a> <a href="http://zvon.org/comp/r/tut-XPath_1.html">XPath tutorial</a> <a href="http://www.w3.org/TR/xslt"> XSLT</a></code></code> </div></div> <code><code><code>,         .           . ..      RF_CHILD_LIST</code> ,      DATA ( <code>TYPE REF TO DATA</code> ),      ,     <code>href</code>     ,    . <br> ,     <code>&lt;RF_CHILD_LIST href="#d1" /&gt;</code> ,   <code>#</code> -       <a href="http://ru.wikipedia.org/wiki/XLink">XLink</a> ,  <code>d1</code> ‚Äì  .         XML-: <code>asx:heap</code>  ,   <code>id</code>  d1.    &lt; <code>prg:T_DEEP_STRUCT id="d1" ‚Ä¶ &gt;</code> .      ,         . <br> ..,    XML   ,  . <br> <br>  XSLT- ? <br>     XSLT-. <br>  SAP      STRANS. <br> <img src="//habrastorage.org/files/9e2/1a4/62a/9e21a462a5794b7b820619abc4edb1ec.jpg"> <br>   ,  ¬´¬ª(F5). <br> <img src="//habrastorage.org/files/f25/1a9/ff3/f251a9ff31c7413f96bf83dc1ee3a4e6.jpg"> <br>   ‚Äì  ,       (   ‚Äì XSLT).  Enter. <br> <br>         XSLT,        .  ,        ,    ‚Äì  . <br> <br>        , ..,   ,         (   ,    , ,   html ). <br> <br>    ,       , ..    .      <br> <code class="xml">&lt;xsl:transform version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;xsl:template match="/"&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> : <br> <code>xmlns:xsl</code> ,       xsl. ..       ,       <code>xsl</code> : ( <code>&lt;xsl:strip-space elements="*"/&gt;</code> ) <code>xmlns:sap</code> ,       sap <code>xsl:transform</code> ,     XSLT- <code>&lt;xsl:strip-space elements="*"/&gt;</code>      <code>&lt;xsl:template match="/"&gt;</code>   ,       XML  <br> <br> XSLT-      ( <code>xsl:template</code> )     XML-,      <code>match</code> .   <code>match</code>      <a href="http://ru.wikipedia.org/wiki/XPath">XPath</a> .    ,     ¬´/¬ª,      XML- <code>TABLE</code>    "/asx:abap/asx:values/TABLE" (..    XML-   ( <code>asx:abap</code> )    ( <code>TABLE</code> )). <br> <br>  ,      XML- List.   : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>item</code>   <code>TABLE</code>   XML ,      <code>&lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt;</code> ,    <code>select</code>  XPath   ,     .       <code>MyItem</code> ,     <code>Name</code>   NAME    ,    .  ,       : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>&lt;xsl:value-of select="NAME"/&gt;</code> ,   <code>select</code>   XPath-  ,     .  ,    <code>xsl:value-of</code>   ,   <code>xsl:for-each</code> .   ,   <code>xsl:for-each</code>   ,    ,   <code>xsl:value-of</code> ‚Äì     (..    <code>xsl:for-each</code> ). <br>  ,   ,         . <br>  ,            <code>asx, sap, prg</code> (XSLT     ).       XML,  <code>xsl:transform</code>  : <br> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt;</code> <br> <br> ..     ,    <code>exclude-result-prefixes</code>  ,       XML. <br>        ,       <code>RF_CHILD_LIST</code> .        .   ‚Äì   . <br> ,    id   .    <code>ChilListID</code> .     . <br>      : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;/xsl:template&gt;</code> <br> <br> ..      <code>OutChilds</code>   <code>ChilListID</code> .  ,       XML-,    <code>/asx:abap/asx:heap</code> . <br> <br>       ?    item   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> .        <code>xsl:for-each</code> . <br>   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]"&gt;</code> <br>  XPath ,        <code>prg:T_DEEP_STRUCT</code> ,    <code>id</code>   <code>ChilListID</code> . <br>        item: <code>&lt;xsl:for-each select="item"&gt;</code> <br> <br> ,        ,   ,    , XSLT  .     : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt;</code> <br> <br>   <code>MyItem</code>   <code>Name</code> .    : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>      .    :      . <br>     <code>xsl:apply-templates</code> ,     <code>select</code>     XML      . <br>  ,  ,       <code>ChilListID</code> . ,      ,    <code>RF_CHILD_LIST</code>  <code>href,</code>    <code>#id___</code> . ..     <code>href</code>     ,    .     XPath  : <code>substring(RF_CHILD_LIST/@href,2)</code> . ..     : <br> <code class="xml"> &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt;</code> <br> <br>  ,     : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>  ,  ,     ,    . <br> <br> <b class="spoiler_title"> ,      :</b> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;!--       , .   --&gt; &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;!--         XML --&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;!--  NAMR  --&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--      ,        --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt; &lt;!--     --&gt; &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;!--   --&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;!--  , id    ,   --&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--    --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> <br> <b class="spoiler_title">  ABAP-</b> <code class="bash">REPORT zedu_test_xslt_deep_transform. *      "   " TYPES : BEGIN OF tdeep_struct , name TYPE string , rf_child_list TYPE REF TO data , END OF tdeep_struct *       "   " , t_deep_struct TYPE STANDARD TABLE OF tdeep_struct WITH NON-UNIQUE DEFAULT KEY . DATA : gt_tree TYPE t_deep_struct "  , gtree TYPE tdeep_struct "       , gchild TYPE tdeep_struct "       , ggrandchild TYPE tdeep_struct "       , gxml_str TYPE string "  XML , go_xml_doc TYPE REF TO cl_xml_document "    XML . FIELD-SYMBOLS : &lt;gt_child_list&gt; TYPE t_deep_struct "    , &lt;gt_grandchild_list&gt; TYPE t_deep_struct "    . START-OF-SELECTION. *    gtree-name = 'GrandParent1'. CREATE DATA gtree-rf_child_list TYPE t_deep_struct. ASSIGN gtree-rf_child_list-&gt;* TO &lt;gt_child_list&gt;. gchild-name = 'Child1'. APPEND gchild TO &lt;gt_child_list&gt;. gchild-name = 'Child2'. CREATE DATA gchild-rf_child_list TYPE t_deep_struct. ASSIGN gchild-rf_child_list-&gt;* TO &lt;gt_grandchild_list&gt;. ggrandchild-name = 'GrandChild1'. APPEND ggrandchild TO &lt;gt_grandchild_list&gt;. APPEND gchild TO &lt;gt_child_list&gt;. APPEND gtree TO gt_tree. CLEAR gtree. gtree-name = 'GrandParent2'. APPEND gtree TO gt_tree. * XSLT- CALL TRANSFORMATION zedu_test_xslt_deep_transform2 SOURCE table = gt_tree RESULT XML gxml_str. *    XML CREATE OBJECT go_xml_doc. go_xml_doc-&gt;parse_string( gxml_str ). go_xml_doc-&gt;display( ).</code> <br> <br> <br>  <br>  ,      XSLT  ? <br> <br>   <br> <a href="http://help.sap.com/abapdocu_70/en/ABAPCALL_TRANSFORMATION.htm"> ABAP</a> <a href="http://msdn.microsoft.com/ru-ru/library/ms256069%2528v%3Dvs.110%2529.aspx">MSDN:   XSLT</a> <a href="http://zvon.org/comp/r/tut-XPath_1.html">XPath tutorial</a> <a href="http://www.w3.org/TR/xslt"> XSLT</a></code></code> <h4> <code><code><code>,         .           . ..      RF_CHILD_LIST</code> ,      DATA ( <code>TYPE REF TO DATA</code> ),      ,     <code>href</code>     ,    . <br> ,     <code>&lt;RF_CHILD_LIST href="#d1" /&gt;</code> ,   <code>#</code> -       <a href="http://ru.wikipedia.org/wiki/XLink">XLink</a> ,  <code>d1</code> ‚Äì  .         XML-: <code>asx:heap</code>  ,   <code>id</code>  d1.    &lt; <code>prg:T_DEEP_STRUCT id="d1" ‚Ä¶ &gt;</code> .      ,         . <br> ..,    XML   ,  . <br> <br>  XSLT- ? <br>     XSLT-. <br>  SAP      STRANS. <br> <img src="//habrastorage.org/files/9e2/1a4/62a/9e21a462a5794b7b820619abc4edb1ec.jpg"> <br>   ,  ¬´¬ª(F5). <br> <img src="//habrastorage.org/files/f25/1a9/ff3/f251a9ff31c7413f96bf83dc1ee3a4e6.jpg"> <br>   ‚Äì  ,       (   ‚Äì XSLT).  Enter. <br> <br>         XSLT,        .  ,        ,    ‚Äì  . <br> <br>        , ..,   ,         (   ,    , ,   html ). <br> <br>    ,       , ..    .      <br> <code class="xml">&lt;xsl:transform version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;xsl:template match="/"&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> : <br> <code>xmlns:xsl</code> ,       xsl. ..       ,       <code>xsl</code> : ( <code>&lt;xsl:strip-space elements="*"/&gt;</code> ) <code>xmlns:sap</code> ,       sap <code>xsl:transform</code> ,     XSLT- <code>&lt;xsl:strip-space elements="*"/&gt;</code>      <code>&lt;xsl:template match="/"&gt;</code>   ,       XML  <br> <br> XSLT-      ( <code>xsl:template</code> )     XML-,      <code>match</code> .   <code>match</code>      <a href="http://ru.wikipedia.org/wiki/XPath">XPath</a> .    ,     ¬´/¬ª,      XML- <code>TABLE</code>    "/asx:abap/asx:values/TABLE" (..    XML-   ( <code>asx:abap</code> )    ( <code>TABLE</code> )). <br> <br>  ,      XML- List.   : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>item</code>   <code>TABLE</code>   XML ,      <code>&lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt;</code> ,    <code>select</code>  XPath   ,     .       <code>MyItem</code> ,     <code>Name</code>   NAME    ,    .  ,       : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>&lt;xsl:value-of select="NAME"/&gt;</code> ,   <code>select</code>   XPath-  ,     .  ,    <code>xsl:value-of</code>   ,   <code>xsl:for-each</code> .   ,   <code>xsl:for-each</code>   ,    ,   <code>xsl:value-of</code> ‚Äì     (..    <code>xsl:for-each</code> ). <br>  ,   ,         . <br>  ,            <code>asx, sap, prg</code> (XSLT     ).       XML,  <code>xsl:transform</code>  : <br> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt;</code> <br> <br> ..     ,    <code>exclude-result-prefixes</code>  ,       XML. <br>        ,       <code>RF_CHILD_LIST</code> .        .   ‚Äì   . <br> ,    id   .    <code>ChilListID</code> .     . <br>      : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;/xsl:template&gt;</code> <br> <br> ..      <code>OutChilds</code>   <code>ChilListID</code> .  ,       XML-,    <code>/asx:abap/asx:heap</code> . <br> <br>       ?    item   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> .        <code>xsl:for-each</code> . <br>   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]"&gt;</code> <br>  XPath ,        <code>prg:T_DEEP_STRUCT</code> ,    <code>id</code>   <code>ChilListID</code> . <br>        item: <code>&lt;xsl:for-each select="item"&gt;</code> <br> <br> ,        ,   ,    , XSLT  .     : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt;</code> <br> <br>   <code>MyItem</code>   <code>Name</code> .    : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>      .    :      . <br>     <code>xsl:apply-templates</code> ,     <code>select</code>     XML      . <br>  ,  ,       <code>ChilListID</code> . ,      ,    <code>RF_CHILD_LIST</code>  <code>href,</code>    <code>#id___</code> . ..     <code>href</code>     ,    .     XPath  : <code>substring(RF_CHILD_LIST/@href,2)</code> . ..     : <br> <code class="xml"> &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt;</code> <br> <br>  ,     : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>  ,  ,     ,    . <br> <br> <b class="spoiler_title"> ,      :</b> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;!--       , .   --&gt; &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;!--         XML --&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;!--  NAMR  --&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--      ,        --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt; &lt;!--     --&gt; &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;!--   --&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;!--  , id    ,   --&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--    --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> <br> <b class="spoiler_title">  ABAP-</b> <code class="bash">REPORT zedu_test_xslt_deep_transform. *      "   " TYPES : BEGIN OF tdeep_struct , name TYPE string , rf_child_list TYPE REF TO data , END OF tdeep_struct *       "   " , t_deep_struct TYPE STANDARD TABLE OF tdeep_struct WITH NON-UNIQUE DEFAULT KEY . DATA : gt_tree TYPE t_deep_struct "  , gtree TYPE tdeep_struct "       , gchild TYPE tdeep_struct "       , ggrandchild TYPE tdeep_struct "       , gxml_str TYPE string "  XML , go_xml_doc TYPE REF TO cl_xml_document "    XML . FIELD-SYMBOLS : &lt;gt_child_list&gt; TYPE t_deep_struct "    , &lt;gt_grandchild_list&gt; TYPE t_deep_struct "    . START-OF-SELECTION. *    gtree-name = 'GrandParent1'. CREATE DATA gtree-rf_child_list TYPE t_deep_struct. ASSIGN gtree-rf_child_list-&gt;* TO &lt;gt_child_list&gt;. gchild-name = 'Child1'. APPEND gchild TO &lt;gt_child_list&gt;. gchild-name = 'Child2'. CREATE DATA gchild-rf_child_list TYPE t_deep_struct. ASSIGN gchild-rf_child_list-&gt;* TO &lt;gt_grandchild_list&gt;. ggrandchild-name = 'GrandChild1'. APPEND ggrandchild TO &lt;gt_grandchild_list&gt;. APPEND gchild TO &lt;gt_child_list&gt;. APPEND gtree TO gt_tree. CLEAR gtree. gtree-name = 'GrandParent2'. APPEND gtree TO gt_tree. * XSLT- CALL TRANSFORMATION zedu_test_xslt_deep_transform2 SOURCE table = gt_tree RESULT XML gxml_str. *    XML CREATE OBJECT go_xml_doc. go_xml_doc-&gt;parse_string( gxml_str ). go_xml_doc-&gt;display( ).</code> <br> <br> <br>  <br>  ,      XSLT  ? <br> <br>   <br> <a href="http://help.sap.com/abapdocu_70/en/ABAPCALL_TRANSFORMATION.htm"> ABAP</a> <a href="http://msdn.microsoft.com/ru-ru/library/ms256069%2528v%3Dvs.110%2529.aspx">MSDN:   XSLT</a> <a href="http://zvon.org/comp/r/tut-XPath_1.html">XPath tutorial</a> <a href="http://www.w3.org/TR/xslt"> XSLT</a></code></code> </h4> <code><code><code>,         .           . ..      RF_CHILD_LIST</code> ,      DATA ( <code>TYPE REF TO DATA</code> ),      ,     <code>href</code>     ,    . <br> ,     <code>&lt;RF_CHILD_LIST href="#d1" /&gt;</code> ,   <code>#</code> -       <a href="http://ru.wikipedia.org/wiki/XLink">XLink</a> ,  <code>d1</code> ‚Äì  .         XML-: <code>asx:heap</code>  ,   <code>id</code>  d1.    &lt; <code>prg:T_DEEP_STRUCT id="d1" ‚Ä¶ &gt;</code> .      ,         . <br> ..,    XML   ,  . <br> <br>  XSLT- ? <br>     XSLT-. <br>  SAP      STRANS. <br> <img src="//habrastorage.org/files/9e2/1a4/62a/9e21a462a5794b7b820619abc4edb1ec.jpg"> <br>   ,  ¬´¬ª(F5). <br> <img src="//habrastorage.org/files/f25/1a9/ff3/f251a9ff31c7413f96bf83dc1ee3a4e6.jpg"> <br>   ‚Äì  ,       (   ‚Äì XSLT).  Enter. <br> <br>         XSLT,        .  ,        ,    ‚Äì  . <br> <br>        , ..,   ,         (   ,    , ,   html ). <br> <br>    ,       , ..    .      <br> <code class="xml">&lt;xsl:transform version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;xsl:template match="/"&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> : <br> <code>xmlns:xsl</code> ,       xsl. ..       ,       <code>xsl</code> : ( <code>&lt;xsl:strip-space elements="*"/&gt;</code> ) <code>xmlns:sap</code> ,       sap <code>xsl:transform</code> ,     XSLT- <code>&lt;xsl:strip-space elements="*"/&gt;</code>      <code>&lt;xsl:template match="/"&gt;</code>   ,       XML  <br> <br> XSLT-      ( <code>xsl:template</code> )     XML-,      <code>match</code> .   <code>match</code>      <a href="http://ru.wikipedia.org/wiki/XPath">XPath</a> .    ,     ¬´/¬ª,      XML- <code>TABLE</code>    "/asx:abap/asx:values/TABLE" (..    XML-   ( <code>asx:abap</code> )    ( <code>TABLE</code> )). <br> <br>  ,      XML- List.   : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>item</code>   <code>TABLE</code>   XML ,      <code>&lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt;</code> ,    <code>select</code>  XPath   ,     .       <code>MyItem</code> ,     <code>Name</code>   NAME    ,    .  ,       : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>&lt;xsl:value-of select="NAME"/&gt;</code> ,   <code>select</code>   XPath-  ,     .  ,    <code>xsl:value-of</code>   ,   <code>xsl:for-each</code> .   ,   <code>xsl:for-each</code>   ,    ,   <code>xsl:value-of</code> ‚Äì     (..    <code>xsl:for-each</code> ). <br>  ,   ,         . <br>  ,            <code>asx, sap, prg</code> (XSLT     ).       XML,  <code>xsl:transform</code>  : <br> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt;</code> <br> <br> ..     ,    <code>exclude-result-prefixes</code>  ,       XML. <br>        ,       <code>RF_CHILD_LIST</code> .        .   ‚Äì   . <br> ,    id   .    <code>ChilListID</code> .     . <br>      : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;/xsl:template&gt;</code> <br> <br> ..      <code>OutChilds</code>   <code>ChilListID</code> .  ,       XML-,    <code>/asx:abap/asx:heap</code> . <br> <br>       ?    item   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> .        <code>xsl:for-each</code> . <br>   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]"&gt;</code> <br>  XPath ,        <code>prg:T_DEEP_STRUCT</code> ,    <code>id</code>   <code>ChilListID</code> . <br>        item: <code>&lt;xsl:for-each select="item"&gt;</code> <br> <br> ,        ,   ,    , XSLT  .     : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt;</code> <br> <br>   <code>MyItem</code>   <code>Name</code> .    : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>      .    :      . <br>     <code>xsl:apply-templates</code> ,     <code>select</code>     XML      . <br>  ,  ,       <code>ChilListID</code> . ,      ,    <code>RF_CHILD_LIST</code>  <code>href,</code>    <code>#id___</code> . ..     <code>href</code>     ,    .     XPath  : <code>substring(RF_CHILD_LIST/@href,2)</code> . ..     : <br> <code class="xml"> &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt;</code> <br> <br>  ,     : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>  ,  ,     ,    . <br> <br> <b class="spoiler_title"> ,      :</b> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;!--       , .   --&gt; &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;!--         XML --&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;!--  NAMR  --&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--      ,        --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt; &lt;!--     --&gt; &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;!--   --&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;!--  , id    ,   --&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--    --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> <br> <b class="spoiler_title">  ABAP-</b> <code class="bash">REPORT zedu_test_xslt_deep_transform. *      "   " TYPES : BEGIN OF tdeep_struct , name TYPE string , rf_child_list TYPE REF TO data , END OF tdeep_struct *       "   " , t_deep_struct TYPE STANDARD TABLE OF tdeep_struct WITH NON-UNIQUE DEFAULT KEY . DATA : gt_tree TYPE t_deep_struct "  , gtree TYPE tdeep_struct "       , gchild TYPE tdeep_struct "       , ggrandchild TYPE tdeep_struct "       , gxml_str TYPE string "  XML , go_xml_doc TYPE REF TO cl_xml_document "    XML . FIELD-SYMBOLS : &lt;gt_child_list&gt; TYPE t_deep_struct "    , &lt;gt_grandchild_list&gt; TYPE t_deep_struct "    . START-OF-SELECTION. *    gtree-name = 'GrandParent1'. CREATE DATA gtree-rf_child_list TYPE t_deep_struct. ASSIGN gtree-rf_child_list-&gt;* TO &lt;gt_child_list&gt;. gchild-name = 'Child1'. APPEND gchild TO &lt;gt_child_list&gt;. gchild-name = 'Child2'. CREATE DATA gchild-rf_child_list TYPE t_deep_struct. ASSIGN gchild-rf_child_list-&gt;* TO &lt;gt_grandchild_list&gt;. ggrandchild-name = 'GrandChild1'. APPEND ggrandchild TO &lt;gt_grandchild_list&gt;. APPEND gchild TO &lt;gt_child_list&gt;. APPEND gtree TO gt_tree. CLEAR gtree. gtree-name = 'GrandParent2'. APPEND gtree TO gt_tree. * XSLT- CALL TRANSFORMATION zedu_test_xslt_deep_transform2 SOURCE table = gt_tree RESULT XML gxml_str. *    XML CREATE OBJECT go_xml_doc. go_xml_doc-&gt;parse_string( gxml_str ). go_xml_doc-&gt;display( ).</code> <br> <br> <br>  <br>  ,      XSLT  ? <br> <br>   <br> <a href="http://help.sap.com/abapdocu_70/en/ABAPCALL_TRANSFORMATION.htm"> ABAP</a> <a href="http://msdn.microsoft.com/ru-ru/library/ms256069%2528v%3Dvs.110%2529.aspx">MSDN:   XSLT</a> <a href="http://zvon.org/comp/r/tut-XPath_1.html">XPath tutorial</a> <a href="http://www.w3.org/TR/xslt"> XSLT</a></code></code> <h4> <code><code><code>,         .           . ..      RF_CHILD_LIST</code> ,      DATA ( <code>TYPE REF TO DATA</code> ),      ,     <code>href</code>     ,    . <br> ,     <code>&lt;RF_CHILD_LIST href="#d1" /&gt;</code> ,   <code>#</code> -       <a href="http://ru.wikipedia.org/wiki/XLink">XLink</a> ,  <code>d1</code> ‚Äì  .         XML-: <code>asx:heap</code>  ,   <code>id</code>  d1.    &lt; <code>prg:T_DEEP_STRUCT id="d1" ‚Ä¶ &gt;</code> .      ,         . <br> ..,    XML   ,  . <br> <br>  XSLT- ? <br>     XSLT-. <br>  SAP      STRANS. <br> <img src="//habrastorage.org/files/9e2/1a4/62a/9e21a462a5794b7b820619abc4edb1ec.jpg"> <br>   ,  ¬´¬ª(F5). <br> <img src="//habrastorage.org/files/f25/1a9/ff3/f251a9ff31c7413f96bf83dc1ee3a4e6.jpg"> <br>   ‚Äì  ,       (   ‚Äì XSLT).  Enter. <br> <br>         XSLT,        .  ,        ,    ‚Äì  . <br> <br>        , ..,   ,         (   ,    , ,   html ). <br> <br>    ,       , ..    .      <br> <code class="xml">&lt;xsl:transform version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;xsl:template match="/"&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> : <br> <code>xmlns:xsl</code> ,       xsl. ..       ,       <code>xsl</code> : ( <code>&lt;xsl:strip-space elements="*"/&gt;</code> ) <code>xmlns:sap</code> ,       sap <code>xsl:transform</code> ,     XSLT- <code>&lt;xsl:strip-space elements="*"/&gt;</code>      <code>&lt;xsl:template match="/"&gt;</code>   ,       XML  <br> <br> XSLT-      ( <code>xsl:template</code> )     XML-,      <code>match</code> .   <code>match</code>      <a href="http://ru.wikipedia.org/wiki/XPath">XPath</a> .    ,     ¬´/¬ª,      XML- <code>TABLE</code>    "/asx:abap/asx:values/TABLE" (..    XML-   ( <code>asx:abap</code> )    ( <code>TABLE</code> )). <br> <br>  ,      XML- List.   : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>item</code>   <code>TABLE</code>   XML ,      <code>&lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt;</code> ,    <code>select</code>  XPath   ,     .       <code>MyItem</code> ,     <code>Name</code>   NAME    ,    .  ,       : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>&lt;xsl:value-of select="NAME"/&gt;</code> ,   <code>select</code>   XPath-  ,     .  ,    <code>xsl:value-of</code>   ,   <code>xsl:for-each</code> .   ,   <code>xsl:for-each</code>   ,    ,   <code>xsl:value-of</code> ‚Äì     (..    <code>xsl:for-each</code> ). <br>  ,   ,         . <br>  ,            <code>asx, sap, prg</code> (XSLT     ).       XML,  <code>xsl:transform</code>  : <br> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt;</code> <br> <br> ..     ,    <code>exclude-result-prefixes</code>  ,       XML. <br>        ,       <code>RF_CHILD_LIST</code> .        .   ‚Äì   . <br> ,    id   .    <code>ChilListID</code> .     . <br>      : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;/xsl:template&gt;</code> <br> <br> ..      <code>OutChilds</code>   <code>ChilListID</code> .  ,       XML-,    <code>/asx:abap/asx:heap</code> . <br> <br>       ?    item   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> .        <code>xsl:for-each</code> . <br>   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]"&gt;</code> <br>  XPath ,        <code>prg:T_DEEP_STRUCT</code> ,    <code>id</code>   <code>ChilListID</code> . <br>        item: <code>&lt;xsl:for-each select="item"&gt;</code> <br> <br> ,        ,   ,    , XSLT  .     : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt;</code> <br> <br>   <code>MyItem</code>   <code>Name</code> .    : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>      .    :      . <br>     <code>xsl:apply-templates</code> ,     <code>select</code>     XML      . <br>  ,  ,       <code>ChilListID</code> . ,      ,    <code>RF_CHILD_LIST</code>  <code>href,</code>    <code>#id___</code> . ..     <code>href</code>     ,    .     XPath  : <code>substring(RF_CHILD_LIST/@href,2)</code> . ..     : <br> <code class="xml"> &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt;</code> <br> <br>  ,     : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>  ,  ,     ,    . <br> <br> <b class="spoiler_title"> ,      :</b> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;!--       , .   --&gt; &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;!--         XML --&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;!--  NAMR  --&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--      ,        --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt; &lt;!--     --&gt; &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;!--   --&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;!--  , id    ,   --&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--    --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> <br> <b class="spoiler_title">  ABAP-</b> <code class="bash">REPORT zedu_test_xslt_deep_transform. *      "   " TYPES : BEGIN OF tdeep_struct , name TYPE string , rf_child_list TYPE REF TO data , END OF tdeep_struct *       "   " , t_deep_struct TYPE STANDARD TABLE OF tdeep_struct WITH NON-UNIQUE DEFAULT KEY . DATA : gt_tree TYPE t_deep_struct "  , gtree TYPE tdeep_struct "       , gchild TYPE tdeep_struct "       , ggrandchild TYPE tdeep_struct "       , gxml_str TYPE string "  XML , go_xml_doc TYPE REF TO cl_xml_document "    XML . FIELD-SYMBOLS : &lt;gt_child_list&gt; TYPE t_deep_struct "    , &lt;gt_grandchild_list&gt; TYPE t_deep_struct "    . START-OF-SELECTION. *    gtree-name = 'GrandParent1'. CREATE DATA gtree-rf_child_list TYPE t_deep_struct. ASSIGN gtree-rf_child_list-&gt;* TO &lt;gt_child_list&gt;. gchild-name = 'Child1'. APPEND gchild TO &lt;gt_child_list&gt;. gchild-name = 'Child2'. CREATE DATA gchild-rf_child_list TYPE t_deep_struct. ASSIGN gchild-rf_child_list-&gt;* TO &lt;gt_grandchild_list&gt;. ggrandchild-name = 'GrandChild1'. APPEND ggrandchild TO &lt;gt_grandchild_list&gt;. APPEND gchild TO &lt;gt_child_list&gt;. APPEND gtree TO gt_tree. CLEAR gtree. gtree-name = 'GrandParent2'. APPEND gtree TO gt_tree. * XSLT- CALL TRANSFORMATION zedu_test_xslt_deep_transform2 SOURCE table = gt_tree RESULT XML gxml_str. *    XML CREATE OBJECT go_xml_doc. go_xml_doc-&gt;parse_string( gxml_str ). go_xml_doc-&gt;display( ).</code> <br> <br> <br>  <br>  ,      XSLT  ? <br> <br>   <br> <a href="http://help.sap.com/abapdocu_70/en/ABAPCALL_TRANSFORMATION.htm"> ABAP</a> <a href="http://msdn.microsoft.com/ru-ru/library/ms256069%2528v%3Dvs.110%2529.aspx">MSDN:   XSLT</a> <a href="http://zvon.org/comp/r/tut-XPath_1.html">XPath tutorial</a> <a href="http://www.w3.org/TR/xslt"> XSLT</a></code></code> </h4> <code><code><code>,         .           . ..      RF_CHILD_LIST</code> ,      DATA ( <code>TYPE REF TO DATA</code> ),      ,     <code>href</code>     ,    . <br> ,     <code>&lt;RF_CHILD_LIST href="#d1" /&gt;</code> ,   <code>#</code> -       <a href="http://ru.wikipedia.org/wiki/XLink">XLink</a> ,  <code>d1</code> ‚Äì  .         XML-: <code>asx:heap</code>  ,   <code>id</code>  d1.    &lt; <code>prg:T_DEEP_STRUCT id="d1" ‚Ä¶ &gt;</code> .      ,         . <br> ..,    XML   ,  . <br> <br>  XSLT- ? <br>     XSLT-. <br>  SAP      STRANS. <br> <img src="//habrastorage.org/files/9e2/1a4/62a/9e21a462a5794b7b820619abc4edb1ec.jpg"> <br>   ,  ¬´¬ª(F5). <br> <img src="//habrastorage.org/files/f25/1a9/ff3/f251a9ff31c7413f96bf83dc1ee3a4e6.jpg"> <br>   ‚Äì  ,       (   ‚Äì XSLT).  Enter. <br> <br>         XSLT,        .  ,        ,    ‚Äì  . <br> <br>        , ..,   ,         (   ,    , ,   html ). <br> <br>    ,       , ..    .      <br> <code class="xml">&lt;xsl:transform version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;xsl:template match="/"&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> : <br> <code>xmlns:xsl</code> ,       xsl. ..       ,       <code>xsl</code> : ( <code>&lt;xsl:strip-space elements="*"/&gt;</code> ) <code>xmlns:sap</code> ,       sap <code>xsl:transform</code> ,     XSLT- <code>&lt;xsl:strip-space elements="*"/&gt;</code>      <code>&lt;xsl:template match="/"&gt;</code>   ,       XML  <br> <br> XSLT-      ( <code>xsl:template</code> )     XML-,      <code>match</code> .   <code>match</code>      <a href="http://ru.wikipedia.org/wiki/XPath">XPath</a> .    ,     ¬´/¬ª,      XML- <code>TABLE</code>    "/asx:abap/asx:values/TABLE" (..    XML-   ( <code>asx:abap</code> )    ( <code>TABLE</code> )). <br> <br>  ,      XML- List.   : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>item</code>   <code>TABLE</code>   XML ,      <code>&lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt;</code> ,    <code>select</code>  XPath   ,     .       <code>MyItem</code> ,     <code>Name</code>   NAME    ,    .  ,       : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>&lt;xsl:value-of select="NAME"/&gt;</code> ,   <code>select</code>   XPath-  ,     .  ,    <code>xsl:value-of</code>   ,   <code>xsl:for-each</code> .   ,   <code>xsl:for-each</code>   ,    ,   <code>xsl:value-of</code> ‚Äì     (..    <code>xsl:for-each</code> ). <br>  ,   ,         . <br>  ,            <code>asx, sap, prg</code> (XSLT     ).       XML,  <code>xsl:transform</code>  : <br> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt;</code> <br> <br> ..     ,    <code>exclude-result-prefixes</code>  ,       XML. <br>        ,       <code>RF_CHILD_LIST</code> .        .   ‚Äì   . <br> ,    id   .    <code>ChilListID</code> .     . <br>      : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;/xsl:template&gt;</code> <br> <br> ..      <code>OutChilds</code>   <code>ChilListID</code> .  ,       XML-,    <code>/asx:abap/asx:heap</code> . <br> <br>       ?    item   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> .        <code>xsl:for-each</code> . <br>   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]"&gt;</code> <br>  XPath ,        <code>prg:T_DEEP_STRUCT</code> ,    <code>id</code>   <code>ChilListID</code> . <br>        item: <code>&lt;xsl:for-each select="item"&gt;</code> <br> <br> ,        ,   ,    , XSLT  .     : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt;</code> <br> <br>   <code>MyItem</code>   <code>Name</code> .    : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>      .    :      . <br>     <code>xsl:apply-templates</code> ,     <code>select</code>     XML      . <br>  ,  ,       <code>ChilListID</code> . ,      ,    <code>RF_CHILD_LIST</code>  <code>href,</code>    <code>#id___</code> . ..     <code>href</code>     ,    .     XPath  : <code>substring(RF_CHILD_LIST/@href,2)</code> . ..     : <br> <code class="xml"> &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt;</code> <br> <br>  ,     : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>  ,  ,     ,    . <br> <br> <b class="spoiler_title"> ,      :</b> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;!--       , .   --&gt; &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;!--         XML --&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;!--  NAMR  --&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--      ,        --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt; &lt;!--     --&gt; &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;!--   --&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;!--  , id    ,   --&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--    --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> <br> <b class="spoiler_title">  ABAP-</b> <code class="bash">REPORT zedu_test_xslt_deep_transform. *      "   " TYPES : BEGIN OF tdeep_struct , name TYPE string , rf_child_list TYPE REF TO data , END OF tdeep_struct *       "   " , t_deep_struct TYPE STANDARD TABLE OF tdeep_struct WITH NON-UNIQUE DEFAULT KEY . DATA : gt_tree TYPE t_deep_struct "  , gtree TYPE tdeep_struct "       , gchild TYPE tdeep_struct "       , ggrandchild TYPE tdeep_struct "       , gxml_str TYPE string "  XML , go_xml_doc TYPE REF TO cl_xml_document "    XML . FIELD-SYMBOLS : &lt;gt_child_list&gt; TYPE t_deep_struct "    , &lt;gt_grandchild_list&gt; TYPE t_deep_struct "    . START-OF-SELECTION. *    gtree-name = 'GrandParent1'. CREATE DATA gtree-rf_child_list TYPE t_deep_struct. ASSIGN gtree-rf_child_list-&gt;* TO &lt;gt_child_list&gt;. gchild-name = 'Child1'. APPEND gchild TO &lt;gt_child_list&gt;. gchild-name = 'Child2'. CREATE DATA gchild-rf_child_list TYPE t_deep_struct. ASSIGN gchild-rf_child_list-&gt;* TO &lt;gt_grandchild_list&gt;. ggrandchild-name = 'GrandChild1'. APPEND ggrandchild TO &lt;gt_grandchild_list&gt;. APPEND gchild TO &lt;gt_child_list&gt;. APPEND gtree TO gt_tree. CLEAR gtree. gtree-name = 'GrandParent2'. APPEND gtree TO gt_tree. * XSLT- CALL TRANSFORMATION zedu_test_xslt_deep_transform2 SOURCE table = gt_tree RESULT XML gxml_str. *    XML CREATE OBJECT go_xml_doc. go_xml_doc-&gt;parse_string( gxml_str ). go_xml_doc-&gt;display( ).</code> <br> <br> <br>  <br>  ,      XSLT  ? <br> <br>   <br> <a href="http://help.sap.com/abapdocu_70/en/ABAPCALL_TRANSFORMATION.htm"> ABAP</a> <a href="http://msdn.microsoft.com/ru-ru/library/ms256069%2528v%3Dvs.110%2529.aspx">MSDN:   XSLT</a> <a href="http://zvon.org/comp/r/tut-XPath_1.html">XPath tutorial</a> <a href="http://www.w3.org/TR/xslt"> XSLT</a></code></code> <ol><li> <code><code><a href="http://help.sap.com/abapdocu_70/en/ABAPCALL_TRANSFORMATION.htm"><code>,         .           . ..      RF_CHILD_LIST</code> ,      DATA ( <code>TYPE REF TO DATA</code> ),      ,     <code>href</code>     ,    . <br> ,     <code>&lt;RF_CHILD_LIST href="#d1" /&gt;</code> ,   <code>#</code> -       </a><a href="http://ru.wikipedia.org/wiki/XLink">XLink</a> ,  <code>d1</code> ‚Äì  .         XML-: <code>asx:heap</code>  ,   <code>id</code>  d1.    &lt; <code>prg:T_DEEP_STRUCT id="d1" ‚Ä¶ &gt;</code> .      ,         . <br> ..,    XML   ,  . <br> <br>  XSLT- ? <br>     XSLT-. <br>  SAP      STRANS. <br> <img src="//habrastorage.org/files/9e2/1a4/62a/9e21a462a5794b7b820619abc4edb1ec.jpg"> <br>   ,  ¬´¬ª(F5). <br> <img src="//habrastorage.org/files/f25/1a9/ff3/f251a9ff31c7413f96bf83dc1ee3a4e6.jpg"> <br>   ‚Äì  ,       (   ‚Äì XSLT).  Enter. <br> <br>         XSLT,        .  ,        ,    ‚Äì  . <br> <br>        , ..,   ,         (   ,    , ,   html ). <br> <br>    ,       , ..    .      <br> <code class="xml">&lt;xsl:transform version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;xsl:template match="/"&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> : <br> <code>xmlns:xsl</code> ,       xsl. ..       ,       <code>xsl</code> : ( <code>&lt;xsl:strip-space elements="*"/&gt;</code> ) <code>xmlns:sap</code> ,       sap <code>xsl:transform</code> ,     XSLT- <code>&lt;xsl:strip-space elements="*"/&gt;</code>      <code>&lt;xsl:template match="/"&gt;</code>   ,       XML  <br> <br> XSLT-      ( <code>xsl:template</code> )     XML-,      <code>match</code> .   <code>match</code>      <a href="http://ru.wikipedia.org/wiki/XPath">XPath</a> .    ,     ¬´/¬ª,      XML- <code>TABLE</code>    "/asx:abap/asx:values/TABLE" (..    XML-   ( <code>asx:abap</code> )    ( <code>TABLE</code> )). <br> <br>  ,      XML- List.   : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>item</code>   <code>TABLE</code>   XML ,      <code>&lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt;</code> ,    <code>select</code>  XPath   ,     .       <code>MyItem</code> ,     <code>Name</code>   NAME    ,    .  ,       : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>&lt;xsl:value-of select="NAME"/&gt;</code> ,   <code>select</code>   XPath-  ,     .  ,    <code>xsl:value-of</code>   ,   <code>xsl:for-each</code> .   ,   <code>xsl:for-each</code>   ,    ,   <code>xsl:value-of</code> ‚Äì     (..    <code>xsl:for-each</code> ). <br>  ,   ,         . <br>  ,            <code>asx, sap, prg</code> (XSLT     ).       XML,  <code>xsl:transform</code>  : <br> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt;</code> <br> <br> ..     ,    <code>exclude-result-prefixes</code>  ,       XML. <br>        ,       <code>RF_CHILD_LIST</code> .        .   ‚Äì   . <br> ,    id   .    <code>ChilListID</code> .     . <br>      : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;/xsl:template&gt;</code> <br> <br> ..      <code>OutChilds</code>   <code>ChilListID</code> .  ,       XML-,    <code>/asx:abap/asx:heap</code> . <br> <br>       ?    item   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> .        <code>xsl:for-each</code> . <br>   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]"&gt;</code> <br>  XPath ,        <code>prg:T_DEEP_STRUCT</code> ,    <code>id</code>   <code>ChilListID</code> . <br>        item: <code>&lt;xsl:for-each select="item"&gt;</code> <br> <br> ,        ,   ,    , XSLT  .     : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt;</code> <br> <br>   <code>MyItem</code>   <code>Name</code> .    : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>      .    :      . <br>     <code>xsl:apply-templates</code> ,     <code>select</code>     XML      . <br>  ,  ,       <code>ChilListID</code> . ,      ,    <code>RF_CHILD_LIST</code>  <code>href,</code>    <code>#id___</code> . ..     <code>href</code>     ,    .     XPath  : <code>substring(RF_CHILD_LIST/@href,2)</code> . ..     : <br> <code class="xml"> &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt;</code> <br> <br>  ,     : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>  ,  ,     ,    . <br> <br> <b class="spoiler_title"> ,      :</b> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;!--       , .   --&gt; &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;!--         XML --&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;!--  NAMR  --&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--      ,        --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt; &lt;!--     --&gt; &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;!--   --&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;!--  , id    ,   --&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--    --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> <br> <b class="spoiler_title">  ABAP-</b> <code class="bash">REPORT zedu_test_xslt_deep_transform. *      "   " TYPES : BEGIN OF tdeep_struct , name TYPE string , rf_child_list TYPE REF TO data , END OF tdeep_struct *       "   " , t_deep_struct TYPE STANDARD TABLE OF tdeep_struct WITH NON-UNIQUE DEFAULT KEY . DATA : gt_tree TYPE t_deep_struct "  , gtree TYPE tdeep_struct "       , gchild TYPE tdeep_struct "       , ggrandchild TYPE tdeep_struct "       , gxml_str TYPE string "  XML , go_xml_doc TYPE REF TO cl_xml_document "    XML . FIELD-SYMBOLS : &lt;gt_child_list&gt; TYPE t_deep_struct "    , &lt;gt_grandchild_list&gt; TYPE t_deep_struct "    . START-OF-SELECTION. *    gtree-name = 'GrandParent1'. CREATE DATA gtree-rf_child_list TYPE t_deep_struct. ASSIGN gtree-rf_child_list-&gt;* TO &lt;gt_child_list&gt;. gchild-name = 'Child1'. APPEND gchild TO &lt;gt_child_list&gt;. gchild-name = 'Child2'. CREATE DATA gchild-rf_child_list TYPE t_deep_struct. ASSIGN gchild-rf_child_list-&gt;* TO &lt;gt_grandchild_list&gt;. ggrandchild-name = 'GrandChild1'. APPEND ggrandchild TO &lt;gt_grandchild_list&gt;. APPEND gchild TO &lt;gt_child_list&gt;. APPEND gtree TO gt_tree. CLEAR gtree. gtree-name = 'GrandParent2'. APPEND gtree TO gt_tree. * XSLT- CALL TRANSFORMATION zedu_test_xslt_deep_transform2 SOURCE table = gt_tree RESULT XML gxml_str. *    XML CREATE OBJECT go_xml_doc. go_xml_doc-&gt;parse_string( gxml_str ). go_xml_doc-&gt;display( ).</code> <br> <br> <br>  <br>  ,      XSLT  ? <br> <br>   <br>  ABAP <a href="http://msdn.microsoft.com/ru-ru/library/ms256069%2528v%3Dvs.110%2529.aspx">MSDN:   XSLT</a> <a href="http://zvon.org/comp/r/tut-XPath_1.html">XPath tutorial</a> <a href="http://www.w3.org/TR/xslt"> XSLT</a></code></code> </li> <li> <code><code><a href="http://msdn.microsoft.com/ru-ru/library/ms256069%2528v%3Dvs.110%2529.aspx"><code>,         .           . ..      RF_CHILD_LIST</code> ,      DATA ( <code>TYPE REF TO DATA</code> ),      ,     <code>href</code>     ,    . <br> ,     <code>&lt;RF_CHILD_LIST href="#d1" /&gt;</code> ,   <code>#</code> -       </a><a href="http://ru.wikipedia.org/wiki/XLink">XLink</a> ,  <code>d1</code> ‚Äì  .         XML-: <code>asx:heap</code>  ,   <code>id</code>  d1.    &lt; <code>prg:T_DEEP_STRUCT id="d1" ‚Ä¶ &gt;</code> .      ,         . <br> ..,    XML   ,  . <br> <br>  XSLT- ? <br>     XSLT-. <br>  SAP      STRANS. <br> <img src="//habrastorage.org/files/9e2/1a4/62a/9e21a462a5794b7b820619abc4edb1ec.jpg"> <br>   ,  ¬´¬ª(F5). <br> <img src="//habrastorage.org/files/f25/1a9/ff3/f251a9ff31c7413f96bf83dc1ee3a4e6.jpg"> <br>   ‚Äì  ,       (   ‚Äì XSLT).  Enter. <br> <br>         XSLT,        .  ,        ,    ‚Äì  . <br> <br>        , ..,   ,         (   ,    , ,   html ). <br> <br>    ,       , ..    .      <br> <code class="xml">&lt;xsl:transform version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;xsl:template match="/"&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> : <br> <code>xmlns:xsl</code> ,       xsl. ..       ,       <code>xsl</code> : ( <code>&lt;xsl:strip-space elements="*"/&gt;</code> ) <code>xmlns:sap</code> ,       sap <code>xsl:transform</code> ,     XSLT- <code>&lt;xsl:strip-space elements="*"/&gt;</code>      <code>&lt;xsl:template match="/"&gt;</code>   ,       XML  <br> <br> XSLT-      ( <code>xsl:template</code> )     XML-,      <code>match</code> .   <code>match</code>      <a href="http://ru.wikipedia.org/wiki/XPath">XPath</a> .    ,     ¬´/¬ª,      XML- <code>TABLE</code>    "/asx:abap/asx:values/TABLE" (..    XML-   ( <code>asx:abap</code> )    ( <code>TABLE</code> )). <br> <br>  ,      XML- List.   : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>item</code>   <code>TABLE</code>   XML ,      <code>&lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt;</code> ,    <code>select</code>  XPath   ,     .       <code>MyItem</code> ,     <code>Name</code>   NAME    ,    .  ,       : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>&lt;xsl:value-of select="NAME"/&gt;</code> ,   <code>select</code>   XPath-  ,     .  ,    <code>xsl:value-of</code>   ,   <code>xsl:for-each</code> .   ,   <code>xsl:for-each</code>   ,    ,   <code>xsl:value-of</code> ‚Äì     (..    <code>xsl:for-each</code> ). <br>  ,   ,         . <br>  ,            <code>asx, sap, prg</code> (XSLT     ).       XML,  <code>xsl:transform</code>  : <br> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt;</code> <br> <br> ..     ,    <code>exclude-result-prefixes</code>  ,       XML. <br>        ,       <code>RF_CHILD_LIST</code> .        .   ‚Äì   . <br> ,    id   .    <code>ChilListID</code> .     . <br>      : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;/xsl:template&gt;</code> <br> <br> ..      <code>OutChilds</code>   <code>ChilListID</code> .  ,       XML-,    <code>/asx:abap/asx:heap</code> . <br> <br>       ?    item   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> .        <code>xsl:for-each</code> . <br>   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]"&gt;</code> <br>  XPath ,        <code>prg:T_DEEP_STRUCT</code> ,    <code>id</code>   <code>ChilListID</code> . <br>        item: <code>&lt;xsl:for-each select="item"&gt;</code> <br> <br> ,        ,   ,    , XSLT  .     : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt;</code> <br> <br>   <code>MyItem</code>   <code>Name</code> .    : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>      .    :      . <br>     <code>xsl:apply-templates</code> ,     <code>select</code>     XML      . <br>  ,  ,       <code>ChilListID</code> . ,      ,    <code>RF_CHILD_LIST</code>  <code>href,</code>    <code>#id___</code> . ..     <code>href</code>     ,    .     XPath  : <code>substring(RF_CHILD_LIST/@href,2)</code> . ..     : <br> <code class="xml"> &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt;</code> <br> <br>  ,     : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>  ,  ,     ,    . <br> <br> <b class="spoiler_title"> ,      :</b> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;!--       , .   --&gt; &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;!--         XML --&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;!--  NAMR  --&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--      ,        --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt; &lt;!--     --&gt; &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;!--   --&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;!--  , id    ,   --&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--    --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> <br> <b class="spoiler_title">  ABAP-</b> <code class="bash">REPORT zedu_test_xslt_deep_transform. *      "   " TYPES : BEGIN OF tdeep_struct , name TYPE string , rf_child_list TYPE REF TO data , END OF tdeep_struct *       "   " , t_deep_struct TYPE STANDARD TABLE OF tdeep_struct WITH NON-UNIQUE DEFAULT KEY . DATA : gt_tree TYPE t_deep_struct "  , gtree TYPE tdeep_struct "       , gchild TYPE tdeep_struct "       , ggrandchild TYPE tdeep_struct "       , gxml_str TYPE string "  XML , go_xml_doc TYPE REF TO cl_xml_document "    XML . FIELD-SYMBOLS : &lt;gt_child_list&gt; TYPE t_deep_struct "    , &lt;gt_grandchild_list&gt; TYPE t_deep_struct "    . START-OF-SELECTION. *    gtree-name = 'GrandParent1'. CREATE DATA gtree-rf_child_list TYPE t_deep_struct. ASSIGN gtree-rf_child_list-&gt;* TO &lt;gt_child_list&gt;. gchild-name = 'Child1'. APPEND gchild TO &lt;gt_child_list&gt;. gchild-name = 'Child2'. CREATE DATA gchild-rf_child_list TYPE t_deep_struct. ASSIGN gchild-rf_child_list-&gt;* TO &lt;gt_grandchild_list&gt;. ggrandchild-name = 'GrandChild1'. APPEND ggrandchild TO &lt;gt_grandchild_list&gt;. APPEND gchild TO &lt;gt_child_list&gt;. APPEND gtree TO gt_tree. CLEAR gtree. gtree-name = 'GrandParent2'. APPEND gtree TO gt_tree. * XSLT- CALL TRANSFORMATION zedu_test_xslt_deep_transform2 SOURCE table = gt_tree RESULT XML gxml_str. *    XML CREATE OBJECT go_xml_doc. go_xml_doc-&gt;parse_string( gxml_str ). go_xml_doc-&gt;display( ).</code> <br> <br> <br>  <br>  ,      XSLT  ? <br> <br>   <br> <a href="http://help.sap.com/abapdocu_70/en/ABAPCALL_TRANSFORMATION.htm"> ABAP</a> MSDN:   XSLT <a href="http://zvon.org/comp/r/tut-XPath_1.html">XPath tutorial</a> <a href="http://www.w3.org/TR/xslt"> XSLT</a></code></code> </li> <li> <code><code><a href="http://zvon.org/comp/r/tut-XPath_1.html"><code>,         .           . ..      RF_CHILD_LIST</code> ,      DATA ( <code>TYPE REF TO DATA</code> ),      ,     <code>href</code>     ,    . <br> ,     <code>&lt;RF_CHILD_LIST href="#d1" /&gt;</code> ,   <code>#</code> -       </a><a href="http://ru.wikipedia.org/wiki/XLink">XLink</a> ,  <code>d1</code> ‚Äì  .         XML-: <code>asx:heap</code>  ,   <code>id</code>  d1.    &lt; <code>prg:T_DEEP_STRUCT id="d1" ‚Ä¶ &gt;</code> .      ,         . <br> ..,    XML   ,  . <br> <br>  XSLT- ? <br>     XSLT-. <br>  SAP      STRANS. <br> <img src="//habrastorage.org/files/9e2/1a4/62a/9e21a462a5794b7b820619abc4edb1ec.jpg"> <br>   ,  ¬´¬ª(F5). <br> <img src="//habrastorage.org/files/f25/1a9/ff3/f251a9ff31c7413f96bf83dc1ee3a4e6.jpg"> <br>   ‚Äì  ,       (   ‚Äì XSLT).  Enter. <br> <br>         XSLT,        .  ,        ,    ‚Äì  . <br> <br>        , ..,   ,         (   ,    , ,   html ). <br> <br>    ,       , ..    .      <br> <code class="xml">&lt;xsl:transform version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;xsl:template match="/"&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> : <br> <code>xmlns:xsl</code> ,       xsl. ..       ,       <code>xsl</code> : ( <code>&lt;xsl:strip-space elements="*"/&gt;</code> ) <code>xmlns:sap</code> ,       sap <code>xsl:transform</code> ,     XSLT- <code>&lt;xsl:strip-space elements="*"/&gt;</code>      <code>&lt;xsl:template match="/"&gt;</code>   ,       XML  <br> <br> XSLT-      ( <code>xsl:template</code> )     XML-,      <code>match</code> .   <code>match</code>      <a href="http://ru.wikipedia.org/wiki/XPath">XPath</a> .    ,     ¬´/¬ª,      XML- <code>TABLE</code>    "/asx:abap/asx:values/TABLE" (..    XML-   ( <code>asx:abap</code> )    ( <code>TABLE</code> )). <br> <br>  ,      XML- List.   : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>item</code>   <code>TABLE</code>   XML ,      <code>&lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt;</code> ,    <code>select</code>  XPath   ,     .       <code>MyItem</code> ,     <code>Name</code>   NAME    ,    .  ,       : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>&lt;xsl:value-of select="NAME"/&gt;</code> ,   <code>select</code>   XPath-  ,     .  ,    <code>xsl:value-of</code>   ,   <code>xsl:for-each</code> .   ,   <code>xsl:for-each</code>   ,    ,   <code>xsl:value-of</code> ‚Äì     (..    <code>xsl:for-each</code> ). <br>  ,   ,         . <br>  ,            <code>asx, sap, prg</code> (XSLT     ).       XML,  <code>xsl:transform</code>  : <br> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt;</code> <br> <br> ..     ,    <code>exclude-result-prefixes</code>  ,       XML. <br>        ,       <code>RF_CHILD_LIST</code> .        .   ‚Äì   . <br> ,    id   .    <code>ChilListID</code> .     . <br>      : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;/xsl:template&gt;</code> <br> <br> ..      <code>OutChilds</code>   <code>ChilListID</code> .  ,       XML-,    <code>/asx:abap/asx:heap</code> . <br> <br>       ?    item   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> .        <code>xsl:for-each</code> . <br>   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]"&gt;</code> <br>  XPath ,        <code>prg:T_DEEP_STRUCT</code> ,    <code>id</code>   <code>ChilListID</code> . <br>        item: <code>&lt;xsl:for-each select="item"&gt;</code> <br> <br> ,        ,   ,    , XSLT  .     : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt;</code> <br> <br>   <code>MyItem</code>   <code>Name</code> .    : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>      .    :      . <br>     <code>xsl:apply-templates</code> ,     <code>select</code>     XML      . <br>  ,  ,       <code>ChilListID</code> . ,      ,    <code>RF_CHILD_LIST</code>  <code>href,</code>    <code>#id___</code> . ..     <code>href</code>     ,    .     XPath  : <code>substring(RF_CHILD_LIST/@href,2)</code> . ..     : <br> <code class="xml"> &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt;</code> <br> <br>  ,     : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>  ,  ,     ,    . <br> <br> <b class="spoiler_title"> ,      :</b> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;!--       , .   --&gt; &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;!--         XML --&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;!--  NAMR  --&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--      ,        --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt; &lt;!--     --&gt; &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;!--   --&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;!--  , id    ,   --&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--    --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> <br> <b class="spoiler_title">  ABAP-</b> <code class="bash">REPORT zedu_test_xslt_deep_transform. *      "   " TYPES : BEGIN OF tdeep_struct , name TYPE string , rf_child_list TYPE REF TO data , END OF tdeep_struct *       "   " , t_deep_struct TYPE STANDARD TABLE OF tdeep_struct WITH NON-UNIQUE DEFAULT KEY . DATA : gt_tree TYPE t_deep_struct "  , gtree TYPE tdeep_struct "       , gchild TYPE tdeep_struct "       , ggrandchild TYPE tdeep_struct "       , gxml_str TYPE string "  XML , go_xml_doc TYPE REF TO cl_xml_document "    XML . FIELD-SYMBOLS : &lt;gt_child_list&gt; TYPE t_deep_struct "    , &lt;gt_grandchild_list&gt; TYPE t_deep_struct "    . START-OF-SELECTION. *    gtree-name = 'GrandParent1'. CREATE DATA gtree-rf_child_list TYPE t_deep_struct. ASSIGN gtree-rf_child_list-&gt;* TO &lt;gt_child_list&gt;. gchild-name = 'Child1'. APPEND gchild TO &lt;gt_child_list&gt;. gchild-name = 'Child2'. CREATE DATA gchild-rf_child_list TYPE t_deep_struct. ASSIGN gchild-rf_child_list-&gt;* TO &lt;gt_grandchild_list&gt;. ggrandchild-name = 'GrandChild1'. APPEND ggrandchild TO &lt;gt_grandchild_list&gt;. APPEND gchild TO &lt;gt_child_list&gt;. APPEND gtree TO gt_tree. CLEAR gtree. gtree-name = 'GrandParent2'. APPEND gtree TO gt_tree. * XSLT- CALL TRANSFORMATION zedu_test_xslt_deep_transform2 SOURCE table = gt_tree RESULT XML gxml_str. *    XML CREATE OBJECT go_xml_doc. go_xml_doc-&gt;parse_string( gxml_str ). go_xml_doc-&gt;display( ).</code> <br> <br> <br>  <br>  ,      XSLT  ? <br> <br>   <br> <a href="http://help.sap.com/abapdocu_70/en/ABAPCALL_TRANSFORMATION.htm"> ABAP</a> <a href="http://msdn.microsoft.com/ru-ru/library/ms256069%2528v%3Dvs.110%2529.aspx">MSDN:   XSLT</a> XPath tutorial <a href="http://www.w3.org/TR/xslt"> XSLT</a></code></code> </li> <li> <code><code><a href="http://www.w3.org/TR/xslt"><code>,         .           . ..      RF_CHILD_LIST</code> ,      DATA ( <code>TYPE REF TO DATA</code> ),      ,     <code>href</code>     ,    . <br> ,     <code>&lt;RF_CHILD_LIST href="#d1" /&gt;</code> ,   <code>#</code> -       </a><a href="http://ru.wikipedia.org/wiki/XLink">XLink</a> ,  <code>d1</code> ‚Äì  .         XML-: <code>asx:heap</code>  ,   <code>id</code>  d1.    &lt; <code>prg:T_DEEP_STRUCT id="d1" ‚Ä¶ &gt;</code> .      ,         . <br> ..,    XML   ,  . <br> <br>  XSLT- ? <br>     XSLT-. <br>  SAP      STRANS. <br> <img src="//habrastorage.org/files/9e2/1a4/62a/9e21a462a5794b7b820619abc4edb1ec.jpg"> <br>   ,  ¬´¬ª(F5). <br> <img src="//habrastorage.org/files/f25/1a9/ff3/f251a9ff31c7413f96bf83dc1ee3a4e6.jpg"> <br>   ‚Äì  ,       (   ‚Äì XSLT).  Enter. <br> <br>         XSLT,        .  ,        ,    ‚Äì  . <br> <br>        , ..,   ,         (   ,    , ,   html ). <br> <br>    ,       , ..    .      <br> <code class="xml">&lt;xsl:transform version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;xsl:template match="/"&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> : <br> <code>xmlns:xsl</code> ,       xsl. ..       ,       <code>xsl</code> : ( <code>&lt;xsl:strip-space elements="*"/&gt;</code> ) <code>xmlns:sap</code> ,       sap <code>xsl:transform</code> ,     XSLT- <code>&lt;xsl:strip-space elements="*"/&gt;</code>      <code>&lt;xsl:template match="/"&gt;</code>   ,       XML  <br> <br> XSLT-      ( <code>xsl:template</code> )     XML-,      <code>match</code> .   <code>match</code>      <a href="http://ru.wikipedia.org/wiki/XPath">XPath</a> .    ,     ¬´/¬ª,      XML- <code>TABLE</code>    "/asx:abap/asx:values/TABLE" (..    XML-   ( <code>asx:abap</code> )    ( <code>TABLE</code> )). <br> <br>  ,      XML- List.   : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>item</code>   <code>TABLE</code>   XML ,      <code>&lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt;</code> ,    <code>select</code>  XPath   ,     .       <code>MyItem</code> ,     <code>Name</code>   NAME    ,    .  ,       : <br> <code class="xml"> &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt;</code> <br> <br>        <code>&lt;xsl:value-of select="NAME"/&gt;</code> ,   <code>select</code>   XPath-  ,     .  ,    <code>xsl:value-of</code>   ,   <code>xsl:for-each</code> .   ,   <code>xsl:for-each</code>   ,    ,   <code>xsl:value-of</code> ‚Äì     (..    <code>xsl:for-each</code> ). <br>  ,   ,         . <br>  ,            <code>asx, sap, prg</code> (XSLT     ).       XML,  <code>xsl:transform</code>  : <br> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt;</code> <br> <br> ..     ,    <code>exclude-result-prefixes</code>  ,       XML. <br>        ,       <code>RF_CHILD_LIST</code> .        .   ‚Äì   . <br> ,    id   .    <code>ChilListID</code> .     . <br>      : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;/xsl:template&gt;</code> <br> <br> ..      <code>OutChilds</code>   <code>ChilListID</code> .  ,       XML-,    <code>/asx:abap/asx:heap</code> . <br> <br>       ?    item   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> .        <code>xsl:for-each</code> . <br>   <code>prg:T_DEEP_STRUCT</code>  id    <code>ChilListID</code> : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]"&gt;</code> <br>  XPath ,        <code>prg:T_DEEP_STRUCT</code> ,    <code>id</code>   <code>ChilListID</code> . <br>        item: <code>&lt;xsl:for-each select="item"&gt;</code> <br> <br> ,        ,   ,    , XSLT  .     : <br> <code>&lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt;</code> <br> <br>   <code>MyItem</code>   <code>Name</code> .    : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>      .    :      . <br>     <code>xsl:apply-templates</code> ,     <code>select</code>     XML      . <br>  ,  ,       <code>ChilListID</code> . ,      ,    <code>RF_CHILD_LIST</code>  <code>href,</code>    <code>#id___</code> . ..     <code>href</code>     ,    .     XPath  : <code>substring(RF_CHILD_LIST/@href,2)</code> . ..     : <br> <code class="xml"> &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt;</code> <br> <br>  ,     : <br> <code class="xml"> &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt;</code> <br> <br>  ,  ,     ,    . <br> <br> <b class="spoiler_title"> ,      :</b> <code class="xml">&lt;xsl:transform xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:sap="http://www.sap.com/sapxsl" xmlns:asx="http://www.sap.com/abapxml" xmlns:prg="http://www.sap.com/abapxml/types/program/ZEDU_TEST_XSLT_DEEP_TRANSFORM" exclude-result-prefixes="asx sap prg" version="1.0"&gt; &lt;xsl:strip-space elements="*"/&gt; &lt;!--       , .   --&gt; &lt;xsl:template match="/"&gt; &lt;List&gt; &lt;!--         XML --&gt; &lt;xsl:for-each select="/asx:abap/asx:values/TABLE/item"&gt; &lt;MyItem&gt; &lt;!--  NAMR  --&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--      ,        --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/List&gt; &lt;/xsl:template&gt; &lt;!--     --&gt; &lt;xsl:template match="/asx:abap/asx:heap" name="OutChilds"&gt; &lt;!--   --&gt; &lt;xsl:param name="ChilListID"/&gt; &lt;!--  , id    ,   --&gt; &lt;xsl:for-each select="prg:T_DEEP_STRUCT[@id=$ChilListID]/item"&gt; &lt;MyItem&gt; &lt;Name&gt;&lt;xsl:value-of select="NAME"/&gt;&lt;/Name&gt; &lt;/MyItem&gt; &lt;!--    --&gt; &lt;xsl:apply-templates select="/asx:abap/asx:heap"&gt; &lt;xsl:with-param name="ChilListID" select="substring(RF_CHILD_LIST/@href,2)"/&gt; &lt;/xsl:apply-templates&gt; &lt;/xsl:for-each&gt; &lt;/xsl:template&gt; &lt;/xsl:transform&gt;</code> <br> <br> <br> <b class="spoiler_title">  ABAP-</b> <code class="bash">REPORT zedu_test_xslt_deep_transform. *      "   " TYPES : BEGIN OF tdeep_struct , name TYPE string , rf_child_list TYPE REF TO data , END OF tdeep_struct *       "   " , t_deep_struct TYPE STANDARD TABLE OF tdeep_struct WITH NON-UNIQUE DEFAULT KEY . DATA : gt_tree TYPE t_deep_struct "  , gtree TYPE tdeep_struct "       , gchild TYPE tdeep_struct "       , ggrandchild TYPE tdeep_struct "       , gxml_str TYPE string "  XML , go_xml_doc TYPE REF TO cl_xml_document "    XML . FIELD-SYMBOLS : &lt;gt_child_list&gt; TYPE t_deep_struct "    , &lt;gt_grandchild_list&gt; TYPE t_deep_struct "    . START-OF-SELECTION. *    gtree-name = 'GrandParent1'. CREATE DATA gtree-rf_child_list TYPE t_deep_struct. ASSIGN gtree-rf_child_list-&gt;* TO &lt;gt_child_list&gt;. gchild-name = 'Child1'. APPEND gchild TO &lt;gt_child_list&gt;. gchild-name = 'Child2'. CREATE DATA gchild-rf_child_list TYPE t_deep_struct. ASSIGN gchild-rf_child_list-&gt;* TO &lt;gt_grandchild_list&gt;. ggrandchild-name = 'GrandChild1'. APPEND ggrandchild TO &lt;gt_grandchild_list&gt;. APPEND gchild TO &lt;gt_child_list&gt;. APPEND gtree TO gt_tree. CLEAR gtree. gtree-name = 'GrandParent2'. APPEND gtree TO gt_tree. * XSLT- CALL TRANSFORMATION zedu_test_xslt_deep_transform2 SOURCE table = gt_tree RESULT XML gxml_str. *    XML CREATE OBJECT go_xml_doc. go_xml_doc-&gt;parse_string( gxml_str ). go_xml_doc-&gt;display( ).</code> <br> <br> <br>  <br>  ,      XSLT  ? <br> <br>   <br> <a href="http://help.sap.com/abapdocu_70/en/ABAPCALL_TRANSFORMATION.htm"> ABAP</a> <a href="http://msdn.microsoft.com/ru-ru/library/ms256069%2528v%3Dvs.110%2529.aspx">MSDN:   XSLT</a> <a href="http://zvon.org/comp/r/tut-XPath_1.html">XPath tutorial</a>  XSLT</code></code> </li> </ol></div><p>Source: <a href="https://habr.com/ru/post/220079/">https://habr.com/ru/post/220079/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../220069/index.html">Micro tools: centralized logging and viewer of icon sets Fontello</a></li>
<li><a href="../220071/index.html">Will mini drones be recharged from power lines?</a></li>
<li><a href="../220073/index.html">Zabbix + Iostat: monitoring the disk subsystem</a></li>
<li><a href="../220075/index.html">Challenge from Richard Feynman</a></li>
<li><a href="../220077/index.html">Text recognition methods</a></li>
<li><a href="../220081/index.html">Convenient development in Notepad ++</a></li>
<li><a href="../220083/index.html">Shit and sword</a></li>
<li><a href="../220087/index.html">Fly! (ASUS Fonepad Note 6)</a></li>
<li><a href="../220091/index.html">How my application received 455 thousand users in the first week</a></li>
<li><a href="../220093/index.html">Popcorn Time developers disappear one by one</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>