<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Simple wifi bot for monitoring premises or "kitchen" robotics</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction. 
 Today, each of us has a dedicated line at home with a very ‚Äúthick‚Äù channel. Also, most have a wifi router, and again, most of us do no...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Simple wifi bot for monitoring premises or "kitchen" robotics</h1><div class="post__text post__text-html js-mediator-article"><h4>  <b>Introduction.</b> </h4><br>  Today, each of us has a dedicated line at home with a very ‚Äúthick‚Äù channel.  Also, most have a wifi router, and again, most of us do not care about turning it off when we leave home.  And really why?  The wifi security protocols are very reliable, the consumption of the router is negligible.  Hence your home often or always on-line.  But what does this give us?  Torentokachalki, personal various servers, etc. <br><br>  Particularly advanced of us have a smart home with a variety of "buns" and remote monitoring via the Internet.  This is the right, but expensive solution.  But all this makes sense to install only in their housing.  In the case of removable this is absurd. <br><br>  Nevertheless, exacerbations of paranoia, hyper-responsibility or similar factors (recall the classic situation - ‚ÄúDid I turn off the iron?‚Äù) Create certain discomfort for us when we leave our home.  Especially for a long time.  The question arises - how is it that the apartment is on-line all the time, and I see nothing and do not control.  Strange. <br><img src="https://habrastorage.org/getpro/habr/post_images/8a2/719/496/8a2719496aa1abc5f48bf653d881ec14.jpg"><br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The most budget solution to put questions just webcam.  But one will not be enough, and a developed network of video surveillance is already a serious infrastructure and is not very cheap.  Different options were considered and all the pros and cons were weighed.  It turned out that the easiest way is to take one webcam, but attach wheels (or tracks) to it. <br><br>  I am well aware that in this place the opinions of the readers will be divided into two large groups.  The first one will state that there are similar projects of the sea, including here, and the second group will argue that in order to implement this, you need to be friends with a soldering iron. <br><br>  This is how we approached the main goal of this material - how to realize this project as cheaply as possible and at the level accessible to many without immersion in the jungle of electronics. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/97c/7e8/52f/97c7e852f60eb7af6ad6f2b806aa36e1.jpg"><br><br>  Looking ahead to the front, I can say that the budget is minimal from $ 70 and to the limits of common sense.  And it strongly depends on how accessible the components are and how much the individual is hoarding.  This price tag was formed in Donetsk (Ukraine), a city, though progressive, but where to get certain things is still a problem. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e66/4b7/263/e664b72639837ba82939897fd2a6e992.jpg"><br><br><h4>  <b>Components.</b> </h4><br>  All components of our wifi bot were selected based on the price / availability relationship.  Finished expensive plastmasski for lovers of refined Arduino-buildings were swept away immediately.  Otherwise, the budget would be equal to half the budget of the Lunokhod. <br><br>  1. <b>Chassis.</b>  Everything is simple here - we take the first ‚Äújeep‚Äù on the radio control (we will throw it away, therefore, it can be broken).  There, as a rule, there is already a main engine (which pushes forward) and a rotary engine on the front ‚Äúbridge‚Äù.  Feel free to rip out the circuit RU (radio control) leaving only the wires to the engines and the wires from the compartment with batteries.  For general development, it is possible to poke a battery into the motors and see where they spin at a specific polarity.  This is how our cart will be moved. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6c6/091/10e/6c609110e32f0062042d5276e4ca9a47.jpg"><br>  Fig.  1 Chassis. <br><br>  2. <b>Brains.</b>  A device for broadcasting video stream and commands to our chassis.  We need a device with wifi and a port to control the chassis.  And since the raspberries (Raspberry Pi) are still available, not all will dwell on routers.  They are shaped like this because there is Wifi, USB and the possibility of customization thanks to custom firmware.  There were a lot of mocking D-link DIR-320, which he didn‚Äôt work with, but it‚Äôs not about him.  It's time for him to retire.  Progress does not stand still and now the function of "pensioner" on your shoulders can take the baby TP-LINK TL-MR3020, although it is not a fact that when you read it there will be a better option.  The advantages of this model are primarily in size, and secondly it is more nimble.  You also need to mention that you don‚Äôt have to cut the firmware for a long time and tediously, everything is already done right here at <a href="http://roboforum.ru/wiki/OR-WRT">roboforum.ru/wiki/OR-WRT</a>  Many thanks to the guys with <a href="http://roboforum.ru/">roboforum.ru</a> for their huge contribution to home robotics.  Therefore, all you have to do is flash the router and configure it a little for your specific conditions. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d72/471/3fc/d724713fc1af6dab62525c88a14934c4.jpg"><br>  Fig.  2 TP-LINK TL-MR3020 router. <br><br>  3. <b>All-seeing eye.</b>  The webcam does not fit any, but this thorny let the choice has already been passed more than once.  First of all, it should support UVC (USB Video Class) here <a href="http://www.ideasonboard.org/uvc/">www.ideasonboard.org/uvc</a> there is a list.  And secondly, it is good if she herself will compress the flow.  The best is the Logitech Webcam C100, cheap and high quality.  With the camera itself, you do not need to do anything, just install and connect to the USB router. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ae9/180/571/ae9180571dc21b4a23a86b004440d2e9.jpg"><br>  Fig.  3 Logitech Webcam C100 <br><br>  4. <b>Driver control engine L293D.</b>  This is a 16 foot circuit.  It does the following - if a voltage is applied to one input, then the motor turns in one direction, and if the second, then the other.  The scheme supports just two motors.  If you do not use it, you will have to bother with H-bridges, but I promised you not to ship with electronics.  It costs a penny, and takes a headache decently. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1f0/01f/821/1f001f821cb245e0285760b7c09221dc.jpg"><br>  Fig.  4 L293D motor control driver. <br><br>  5. <b>Microcontroller.</b>  You can use any that you have already mastered.  The main thing is that he could take a couple of bytes through the UART and, depending on them, set 0 or 1 on the corresponding legs.  I used the Arduino Mini Pro Chinese spill (please do not kick).  Just for beginners this is the easiest. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b2e/1c6/b24/b2e1c6b24784e4c05b90387f5060c121.jpg"><br>  Figure 5. Microcontroller. <br><br>  6. <b>And the last - batteries.</b>  Many puzzled over the food and came to the conclusion that the easiest way to take four AA NiMh batteries.  They reach 2500mAh capacity, are cheap and not afraid of overcharging.  The latter is important to us because our bot must be able to recharge as there may simply be no one to charge it.  The easiest way to do this is by connecting the battery directly to a power supply unit with the required voltage (6.4V) and which can provide a current equal to the consumption of the entire cart + another 50-100 mA for unhurriedly charging the battery.  Thus, the cart will eat the current from the power supply unit, and the excess will ‚Äústick‚Äù into the battery.  And no charge schemes are applied here!  Yes, experienced electronics engineers have already sharpened their blades, but all this has been working for several months now without visible damage.  The main thing is to find the right power supply.  The current can be limited by a resistor.  I also put a diode and got rid of the likely short circuit or pereplyusovki (if some Schumacher stuck in charge at the top of his feet).  This is possible because of the design features, for example, you can simply rest your contacts on an iron door.  Here <a href="http://peugeot-citroen.net/viewtopic.php%3Ff%3D11%26t%3D7332%26p%3D104602">peugeot-citroen.net/viewtopic.php?f=11&amp;t=7332&amp;p=104602</a> people did an exhaustive battery test for which special thanks to him. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a2a/54c/2f3/a2a54c2f37a39f98e3d22bbe7b323adc.jpg"><br>  Fig.  6. Charging. <br><br><h4>  <b>Assembly.</b> </h4><br>  Batteries are mounted on the chassis and, for ease of installation, we make two long tires of tin that run along the chassis.  (The tin from coffee cans is simply delightfully soldered.) To one we connect the ‚Äú+‚Äù batteries through a toggle switch, which will de-energize the entire structure.  Minus naturally connect to the second bus.  Thus, all consumers can easily be soldered to the tires and not to arrange the orgy of wired connections.  We solder elastic contacts to these tires in order to ‚Äúrest against‚Äù charging. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/72f/d88/bbe/72fd88bbe088b736f8038e57b17fddd5.jpg"><br>  Fig.  7 Contacts for recharging. <br><br>  Next, finish the router.  We need to bring its internal UART out and make it so easy to connect a microcontroller there.  I do not advise soldering tightly because you will program the microcontroller several times until you are satisfied with the result.  It is necessary to connect this way: ground to ground, plus power to the positive, RX to TX and TX to RX.  There is a <a href="http://wiki.openwrt.org/toh/tp-link/tl-mr3020">pinout</a> here <a href="http://wiki.openwrt.org/toh/tp-link/tl-mr3020">wiki.openwrt.org/toh/tp-link/tl-mr3020</a> Next, fill in the OR-WRT firmware there, a detailed instruction is on the link to the wiki above, and configure it for your network.  With the router done. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b2e/1c6/b24/b2e1c6b24784e4c05b90387f5060c121.jpg"><br>  Fig.  8 Connection arduiny to the router. <br><br>  Now we install the engine driver.  Four legs to plus and 4 to minus and 4 more wires that are already soldered to the legs of the microcontroller ("RA0", "RA1", "RA2", "RA3"), and our engines to the remaining ones. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f9c/70a/34e/f9c70a34e2fc45775ce9cc95117ea981.jpg"><br>  Fig.  9 Connection L293D. <br><br>  It will work as follows if the microcontroller sets a high level, for example, on the leg to which the RA0 wire is soldered, motor No. 1 turns for example to the left, and if RA1 then to the right.  Anticipating the question of what will happen if you install two units - nothing terrible will happen, the motor will turn in both directions at the same time.  Joke.  The engine will not spin.  In the case of the N-bridge, this would be a short circuit, but our scheme is not afraid of this, it is stupid. <br>  The microcontroller should, in a continuous loop, simply set the high level on the legs in accordance with the received byte.  And that's all. <br>  Here is the program for the Arduino Mini Pro microcontroller. <br><br>  <a href="https://docs.google.com/file/d/0B44FXffLkWhpTnJPODA3clByak0/edit">HomeBot1_min.pde</a> <br><br>  For its firmware, you need an ordinary UART adapter for a computer (not to be confused with RS232, this is the same but other voltages here), I use an old data cable from Siemens phones.  Pin assignment is the same as when connected to the router, but we need another DTR pin from the RS232 connector, it connects to the ‚ÄúGREEN‚Äù pin on the microcontroller and when it starts the firmware is set to ‚Äú0‚Äù, thanks to which the controller understands that it will be flashed right now.  If you don‚Äôt get this contact from where you can just click on the Reset of the MC itself, I didn‚Äôt manage it, but there are live witnesses on the Internet. <br><br>  The main thing is that the pins in the program coincided with the pins physically.  If the motor does not turn or does not turn there, then just check the soldering, most likely it was mixed up.  You can test it all very simply - after the firmware, do not disconnect the MC from the computer and simply send the necessary bytes to the corresponding port. <br><br>  The very process of firmware is simple to disgrace.  Open the sketch in the Arduino IDE, select the appropriate port and the version of the MK board in the menu.  Click the Upload button and that's it.  I will not dwell on this in more detail because it is full of articles on the topic of Arduino. <br><br>  So at this stage we already have a chassis which is turned over by motors on orders from the MK which?  in turn?  receives commands on the UART.  B we have a router that is flashed and configured to connect to the home network via wifi. <br>  Now we need to slightly change the web interface so that the commands from it go straight to the internal UART of the router.  Well, from it, respectively, in MK. <br><br>  I did not bother and assigned the well-known buttons ‚ÄúA‚Äù, ‚ÄùS‚Äù, ‚ÄùD‚Äù, ‚ÄùW‚Äù to control all of us, for example, if for example MK receives a byte ‚ÄúW‚Äù (0x57), it will install a unit on the foot to which the wire is soldered forward motion, etc. <br><br>  Required file: <br>  <a href="https://docs.google.com/file/d/0B44FXffLkWhpaktUeGJPR0x5S1E/edit">index.html</a> <br>  <a href="https://docs.google.com/file/d/0B44FXffLkWhpMmF4bnAxb20wNVk/edit">serial.cgi</a> <br>  <a href="https://drive.google.com/file/d/0B-A5rhf0YLuRQ0N5cWhuV3k5LVE/edit%3Fusp%3Dsharing">Or all together</a> <br><br>  <a href="https://drive.google.com/file/d/0B-A5rhf0YLuRb3JfYWN0VHIzT1k/edit%3Fusp%3Dsharing">And a set of different versions of sketches, including the latest version with the serv.</a> <br><br>  There is changed only the fact that Java scripts that process button presses in the web interface now send ‚ÄúA‚Äù, ‚ÄùS‚Äù, ‚ÄùD‚Äù, ‚ÄùW‚Äù depending on the button pressed.  And the script itself which is engaged in sending is redirected to the internal UART of the router.  Files need to replace the original files in the directory WWW. <br><br>  The easiest way to do this is with the great winSCP program <a href="http://winscp.net/eng/docs/lang">winscp.net/eng/docs/lang</a> : ru on SSH. <br>  That's probably all.  Having received a wifi bot, you can modify it at your discretion.  Add different equipment.  For example, replace the rotary motor with a servo.  This will help keep the wheels turned without energy, but you can do without it. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/17a/88c/1f3/17a88c1f3890edc3fb3ff4c723ca8633.jpg"><br>  Fig.  10 Servo Drive. <br><br>  Charging is done and the usual transformer and rectifier.  The old videotape is used as a frame, and the contacts are made of ‚Äúcoffee tin‚Äù.  All that needs to be done is to steer and rest with the contacts in charge.  Even when recharging, excess will go through the heat. <br><br>  I understand that I still could not cover everything, and if there are enough questions I can make an extended article. <br><br>  Finally, a little video. <br><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/N2cYOxBbL5A%3Ffeature%3Doembed&amp;xid=25657,15700023,15700043,15700186,15700190,15700253,15700255,15700259&amp;usg=ALkJrhge8gFPcMrdaGdoyd3mB2b6RGf9Dw" frameborder="0" allowfullscreen=""></iframe><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/ObKokqCSUXM%3Ffeature%3Doembed&amp;xid=25657,15700023,15700043,15700186,15700190,15700253,15700255,15700259&amp;usg=ALkJrhievlicyPk6StUJE5jZYNnqvsBgKQ" frameborder="0" allowfullscreen=""></iframe></div><p>Source: <a href="https://habr.com/ru/post/153017/">https://habr.com/ru/post/153017/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../153007/index.html">‚ÄúRunet today‚Äù, October 1, 2012. Experts of the issue: Sergey Mitrofanov, Dmitry Torshin</a></li>
<li><a href="../153009/index.html">Writing the first simple telit firmware</a></li>
<li><a href="../153011/index.html">Russian Design Cup: results, reviews, impressions</a></li>
<li><a href="../153013/index.html">Node.js + Chromium = AppJS: one of the promising options for the second step of the web developer development</a></li>
<li><a href="../153015/index.html">ARM NEON skinning</a></li>
<li><a href="../153021/index.html">ObjectScript API, integration with C ++. Part 3: Connecting a Module with C ++ Functions</a></li>
<li><a href="../153023/index.html">Veeam virtualization video report</a></li>
<li><a href="../153025/index.html">"Interests" on "Mamba": girls love cats, men - movies</a></li>
<li><a href="../153029/index.html">Captain Kirk calls Enterprise! Or Zefram Cochrane of our day</a></li>
<li><a href="../153031/index.html">Yandex browser. First look</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>