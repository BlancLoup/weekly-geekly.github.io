<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>DIY: Lightsaber with sound</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! I like the Star Wars universe since childhood. When I was 7 years old I reviewed episodes 4-6 so many times that I could retell their contents ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>DIY: Lightsaber with sound</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/files/895/7f2/2f2/8957f22f20784057af52bb072fab8019.png" alt="image"></div><br>  Hello!  I like the Star Wars universe since childhood.  When I was 7 years old I reviewed episodes 4-6 so many times that I could retell their contents in the smallest details. <br><br>  Undoubtedly the most vivid impressions of the film - the battle of light swords.  Two years ago I came across a brief article on the Internet about choosing a lightsaber as a gift, I became interested and studied this topic in detail. <br><br>  At the end of the year, episode 8 comes out, on May 4, not far off, and on the threshold of the international day of Star Wars, I decided to write this article. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Under the cut, I will share information about the manufacturers of light swords and talk about creating a budget sword with sound based on Arduino. <br><a name="habracut"></a><br>  Now on the Internet there are many commercial manufacturers of light swords, the most noteworthy in my opinion: <br><br>  <a href="http://genesiscustomsabers.com/">‚óè ‚óè ‚óè Genesis Custom Sabers</a> - Very high-quality handles to order, the price for an elite custom sword with sound varies in the region of 1500-3000 USD. <br><br>  <a href="https://saberforge.com/">‚óè ‚óè ‚óè Saber Forge</a> is a great choice, prices are more affordable, but swords are not as authentic as in Genesis CS.  The price of a sword with a sound of about 300 USD. <br><br>  <a href="http://www.ultrasabers.com/%3Futm_source%3Dbing%26utm_medium%3Dcpc">‚óè ‚óè ‚óè Ultrasabers</a> is one of the most humane stores in terms of prices.  A sword with a basic sound costs about 160 USD.  You can order individual components for your project. <br><br>  <a href="http://www.thecustomsabershop.com/">‚óè ‚óè ‚óè The Custom Saber Shop</a> - a site with a shop and a designer to build your sword. <br><br>  There are other manufacturers of lightsabers, for example <a href="http://marikoswork.tian.yam.com/posts/25823016">‚óè ‚óè ‚óè Makoto Tsai</a> , which makes the brightest swords based on homemade LED strips. <br><br>  But what to do if you do not want to spend a lot of money, and the lightsaber really wants?  Only one way out - save up 5,000 rubles and make the sword yourself. <br><br>  At the time of the beginning of my project, I practically had no programming experience, knowledge in electronics was completely absent.  Maybe I did something not the best way, but I continue to learn and I will be glad to your advice. <br><br>  In the description of the process of creating a sword, I will try to describe all the main difficulties. <br><br>  <u>So let's get started.</u>  <u>Here is a list of all that I used:</u> <br><br><ol><li>  Arduino Pro micro 5v ~ 250 rubles for Ali </li><li>  Sound module WT588D-U ~ 250 rubles for Ali </li><li>  Step-up 3-5V ~ 100 rubles for Ali </li><li>  Speaker √ò28mm, 8 Ohm, 2W ~ 40 rubles for Ali </li><li>  ADXL335 Accelerometer ~ 200 rubles for Ali </li><li>  N-MOSFET IRF530N x2 ~ 40 rubles per amperka </li><li>  LED Luxeon rebel 3W ~ 70 rubles for Ali </li><li>  Lens for LED 8 ¬∞ ~ 50 rubles for Ali </li><li>  Battery CR123A x2 3.7V ~ 400 rubles for Ali </li><li>  Battery Krone 9v for Arduino power </li><li>  Battery holder ~ 15 rubles for Ali </li><li>  Anti-vandal button ~ 100 rubles for Ali </li><li>  Tumbler ~ 50 rubles for Ali </li><li>  White polycarbonate tube 1 ‚Äù~ 800 rubles in Moscow (there are many shops, they are in Google) </li><li>  PVC pipe for the manufacture of the handle </li></ol><br>  You will also need wires, a screw to fix the polycarbonate tube in the handle and a cap for the polycarbonate tube with a reflector. <br><br>  I ordered a cap with a reflector in the Custom saber shop from $ 7 there, delivery for small goods costs $ 14. <br><br>  You will also need to get somewhere sounds for the sword, usually a set of on / off sounds, work noise (hum), sounds of swing (swing), sounds of collisions (clash). <br><br>  I bought a set of sounds on <a href="http://www.saberfont.com/">Saberfont</a> for $ 7, but I'm sure you can find free sounds. <br><br>  The total for the components is about 5,000 rubles. If you buy sounds, if not, then around 4,000. <br><br>  There are two main types of illumination "blades" - one powerful LED at the base of the polycarbonate tube, the light of which is reflected by the cap at the end of the tube and the second type is a homemade segmented LED strip.  Segments are needed for the smooth inclusion of the sword, as in the movies. <br><br>  For example, Makoto uses several segmented ribbons in its brightest swords. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/a36/9df/21d/a369df21dc684305a2820cbd6659d112.png" alt="image"></div><br>  I recommend using one powerful LED for the first build, it is much simpler and quite bright. <br><br>  I want to immediately say that the swords in the video look brighter than in life, because  the matrix of the camera accumulates light in contrast to our eyes.  Do not expect your sword to shine like in movies. <br><br>  I propose to start assembling a prototype with sound settings. <br><br>  The most difficult thing in the project was to deal with the sound, the WT588D module in my case turned out to be an ideal option, since  It provides continuous playback of audio files, it does not require a flash drive. <br><br>  Before uploading files to WT, I had to edit them a little, for this you can use the free <a href="http://audacity.sourceforge.net/">Audacity</a> program. <br><br>  It is necessary to open each file in turn, select the area with sound (I had several seconds of silence at the end of each file), in the lower left corner of the screen you need to set the frequency from 16000 to 22000 Khz.  If the frequency is more than 22000, WT will not allow to download the file.  Next Export selected - 16 bit. <br>  To download files to the WT588D, you need a <a href="https://drive.google.com/file/d/0B4IMeS-6RiDJWGNhTHV1aF9pSDg/view%3Fusp%3Dsharing">program</a> to download sounds from the module manufacturer - Waytronic (it works only under Windows, I launched on MAC through BootCamp). <br><br>  You need to run the software and select English in the settings.  In WT588D there are several modes of operation, I chose One-line mode, because  it requires a minimum of soldering, the module communicates with the Arduino through one pin. <br><br>  The working field is divided into 3 parts, on the left - the list of files uploaded to the module, in the middle - the list of playlists, on the right - the list of files in the playlist. <br><br>  To download files, right-click on the list of downloaded files and select Load - find and select the audio file processed in Audacity.  Repeat for all files. <br><br>  Next, you need to create playlists, adding a lot of recurring sounds of work noise after the sound of inclusion and the sounds of strokes / collisions.  This is necessary in order not to write code to switch to noise after switching on / waving. <br><br>  The playlist numbers will be called further in our sketch.  After downloading the sounds and preparing playlists, you need to connect power to the WT, connect the speaker, and connect the Data pin to the WT with the Arduino.  Just connect to the Arduino button to turn on / off the light / sound and the LED through the MOSFET. <br><br>  Here is my connection diagram: <br><br><img src="https://habrastorage.org/files/d4c/2ab/125/d4c2ab12512940da846ece4d8683f703.png" alt="image"><br><br>  I power the WT from a separate 3.7V battery through the MOSFET using step-up to 5v, in which case I get the maximum output volume. <br><br>  First you need to register everything that will be used in the sketch: <br><br><pre><code class="hljs lua">#define WT588D_SDA <span class="hljs-number"><span class="hljs-number">8</span></span> //      WT588D //          const int xpin = A0; const int ypin = A1; const int zpin = A2; int oldtime; int newtime; int ADXL = <span class="hljs-number"><span class="hljs-number">3</span></span>; int BUTTON_PIN = <span class="hljs-number"><span class="hljs-number">7</span></span>; //     int LED_PIN = <span class="hljs-number"><span class="hljs-number">9</span></span>; //MOSFET  int WT_MOSFET = <span class="hljs-number"><span class="hljs-number">6</span></span>; //MOSFET WT588D int i = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">byte</span></span> file_count = <span class="hljs-number"><span class="hljs-number">1</span></span>; bool saberon; bool swingsound; void setup() { Serial.begin(<span class="hljs-number"><span class="hljs-number">9600</span></span>); pinMode(BUTTON_PIN, INPUT_PULLUP); pinMode(LED_PIN, OUTPUT); pinMode(ADXL, OUTPUT); pinMode(WT_MOSFET, OUTPUT); pinMode(WT588D_SDA, OUTPUT); digitalWrite(ADXL, LOW); digitalWrite(LED_PIN, LOW); digitalWrite(WT588D_SDA, HIGH); digitalWrite(WT_MOSFET, LOW); saberon = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; swingsound = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; oldtime = analogRead(xpin) + analogRead(ypin) + analogRead(zpin); //    }</code> </pre> <br>  To use WT, in the sketch you need to declare the WT_Send_Command (*) command, to do this, add the following code to the end of the sketch: <br><br><pre> <code class="hljs cs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WT588D_Send_Command</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">byte</span></span></span></span><span class="hljs-function"><span class="hljs-params"> addr</span></span></span><span class="hljs-function">)</span></span> { digitalWrite(WT588D_SDA, LOW); delay(<span class="hljs-number"><span class="hljs-number">100</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">9</span></span>; i++) { digitalWrite(WT588D_SDA, HIGH); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (bitRead(addr, i)) { delayMicroseconds(<span class="hljs-number"><span class="hljs-number">600</span></span>); digitalWrite(WT588D_SDA, LOW); delayMicroseconds(<span class="hljs-number"><span class="hljs-number">200</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { delayMicroseconds(<span class="hljs-number"><span class="hljs-number">200</span></span>); digitalWrite(WT588D_SDA, LOW); delayMicroseconds(<span class="hljs-number"><span class="hljs-number">600</span></span>); } } digitalWrite(WT588D_SDA, HIGH); delay(<span class="hljs-number"><span class="hljs-number">50</span></span>); }</code> </pre><br>  The next step is to write the code so that when the button is pressed, the LED turns on and the playlist plays with the start-up sound.  When you press the button again, the LED turns off and plays the shutdown playlist. <br><br>  If you have no programming experience, for a better understanding of the code, I recommend reading the following materials: <br><br>  ‚Ä¢ <a href="https://www.arduino.cc/en/Reference/If">Arduino If tutorial</a> <br>  ‚Ä¢ <a href="https://www.arduino.cc/en/Reference/BooleanVariables">Arduino Boolean tutorial</a> <br>  ‚Ä¢ <a href="https://www.arduino.cc/en/Tutorial/Button">Arduino Button tutorial</a> <br><br>  Here is my code for recognizing the state of a button and turning effects on / off: <br><br><pre> <code class="hljs objectivec"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (digitalRead(BUTTON_PIN) == LOW) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (saberon) { WT588D_Send_Command(*    ); delay(<span class="hljs-number"><span class="hljs-number">700</span></span>); saberon = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; { analogWrite(LED_PIN, LOW); digitalWrite(WT_MOSFET, LOW); delay(<span class="hljs-number"><span class="hljs-number">1</span></span>); } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { digitalWrite(WT_MOSFET, HIGH); delay(<span class="hljs-number"><span class="hljs-number">100</span></span>); WT588D_Send_Command(*    ); { analogWrite(LED_PIN, HIGH); delay(<span class="hljs-number"><span class="hljs-number">1</span></span>); } saberon = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; } }</code> </pre><br>  If everything is done correctly, you should hear the switch on sound and noise when the button is pressed, the LED should turn on.  When pressed again, the sound is turned off and the LED should go out. <br><br>  The main part of the sketch is ready, now we will connect the accelerometer and make WT reproduce the sounds of strokes. <br><br>  The ADXL335 is fairly easy to use, it does not need to include any libraries.  Here is the connection diagram: <br><br>  For the operation of the accelerometer, we will take two measurements and, based on a comparison of readings, play the sound of a swing. <br><br>  I recommend placing the accelerometer as close as possible to one of the ends of the handle. <br><br><pre> <code class="hljs swift">newtime = analogRead(xpin) + analogRead(ypin) + analogRead(zpin); delay (<span class="hljs-number"><span class="hljs-number">100</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (newtime - oldtime &gt;= <span class="hljs-number"><span class="hljs-number">75</span></span> || newtime - oldtime &lt;= -<span class="hljs-number"><span class="hljs-number">75</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (swingsound) { swingsound = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; delay (<span class="hljs-number"><span class="hljs-number">50</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { swingsound = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-type"><span class="hljs-type">WT588D_Send_Command</span></span>(*    ); delay (<span class="hljs-number"><span class="hljs-number">150</span></span>); } } <span class="hljs-type"><span class="hljs-type">Serial</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(oldtime); <span class="hljs-type"><span class="hljs-type">Serial</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(<span class="hljs-string"><span class="hljs-string">"\t"</span></span>); <span class="hljs-type"><span class="hljs-type">Serial</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(newtime); <span class="hljs-type"><span class="hljs-type">Serial</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(<span class="hljs-string"><span class="hljs-string">"\t"</span></span>); <span class="hljs-type"><span class="hljs-type">Serial</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">print</span></span>(newtime - oldtime); <span class="hljs-type"><span class="hljs-type">Serial</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">println</span></span>(); oldtime = newtime;</code> </pre><br>  That's it, the prototype is ready.  It's time to create a handle and put all the stuffing in it. <br><br>  I made the handle of PVC pipe, insert for the blade diameter: 28mm. <br><br>  I had problems with the handle, as a result, the first version was too small, now I'm doing a new one. <br><br>  In the manufacture of PVC handles, you are limited only by your imagination, I can only give one piece of advice - before painting, treat the surface of the pipe with fine sandpaper, otherwise the paint will not hold well. <br><br>  Here is the first version of my handle, I drilled holes in the lid and placed the speaker, and the blade is fixed in the pipe with four screws: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/406/9c1/0aa/4069c10aa7b947b384aa10645dc9aa2f.png" alt="image"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/files/f1e/d40/4bf/f1ed404bf7c94530a61093b5ae532a83.png" alt="image"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/files/538/749/70b/53874970b1f74d1194891364d268ca82.png" alt="image"></div><br>  I didn‚Äôt include a clash effect in my sword, I‚Äôll probably catch up next.  But if you want to turn on the clash, you need a vibration sensor or an accelerometer setting for detecting short accelerations.  If someone succeeds in setting up an accelerometer, do not be lazy to share the code, I will include it in an article mentioning you as the author. <br><br>  Here is a small sword test at night outside: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/c75udZr0krY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  update: <br>  I completed the handle and worked on the synchronization of sounds, added the sound of the clash to the updated video: <br><iframe width="560" height="315" src="https://www.youtube.com/embed/FvNgV78n4_w" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  I am sure that Geektimes reads a large number of very talented and skillful people, I ask you, share your opinion, give advice.  It is possible that thanks to the collaboration we will be able to further simplify / optimize the process. <br><br>  Be sure to share your results, it is very interesting to see what happens with you! <br><br>  Thank you all for your attention!  And may the force be with you! </div><p>Source: <a href="https://habr.com/ru/post/402681/">https://habr.com/ru/post/402681/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../402669/index.html">Keratoectasia (keratoconus, "bulging cornea"): what is it and what to do with it</a></li>
<li><a href="../402671/index.html">Attempt to return the former or PDA from the flea market. Part 2, the saga of the HP iPAQ rx3715 PDA</a></li>
<li><a href="../402675/index.html">Harvard CS50 course in Russian: lecture twenty-one</a></li>
<li><a href="../402677/index.html">Course Overview - Building robots and other devices on the Arduino (week 1)</a></li>
<li><a href="../402679/index.html">Universe and heavy metal</a></li>
<li><a href="../402683/index.html">Some additions for 3d printer Anet A8</a></li>
<li><a href="../402685/index.html">Genetic engineering of bacteria: how to get the protein we need from bacteria</a></li>
<li><a href="../402687/index.html">Divoom TimeBox: desktop bluetooth speaker with pixel display</a></li>
<li><a href="../402689/index.html">Dangerous products for drivers. Test breathalyzer DrinkMate</a></li>
<li><a href="../402691/index.html">Falcon 9 check completed for SES 10 mission</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>