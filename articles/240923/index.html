<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Features of the reflection of DDoS attacks and the history of attacks on one large bank</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Previously, DDoS attacks could successfully fight off on the data center side of the attacked company. Fast smart admin actions and good filtering iro...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Features of the reflection of DDoS attacks and the history of attacks on one large bank</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/504/87d/c24/50487dc24b6c4e32bbfb110f5f371e42.gif"><br><br>  Previously, DDoS attacks could successfully fight off on the data center side of the attacked company.  Fast smart admin actions and good filtering iron ensured sufficient protection against attacks.  <b>Today, botnet services are rapidly becoming cheaper, and DDoS is becoming available almost in a small business.</b> <br><br>  About half of the attacks go to the online stores or commercial sites of companies in the spirit of ‚Äúoverwhelm a competitor‚Äù, almost always attack the media sites, especially after the ‚Äúhot‚Äù publications, much more often than they seem to hit state services.  In Russia, the main objectives are banks, retail, media and tender platforms.  One of the major Russian banks, for example, periodically blocks traffic from China - attacks from there come with enviable regularity, one of the latter was more than 100 Gb / s. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Accordingly, when the attack rolls over, say, 10 Gb / s, it becomes problematic to repel it on its side because of the banal channel clogging.  At this very moment, it is necessary to make a switch to the data clearing center, so that all the ‚Äúbad‚Äù traffic will be eliminated somewhere else near the main channels, and not go to you.  Now I‚Äôll tell you how it works for one of our vendors of protective equipment - Arbor, which monitors about 90 Tbit / s (45% of the global Internet traffic). <a name="habracut"></a><br><br><h4>  Attack scenario </h4><br>  First, the attacker selects targets within the infrastructure.  Most of the "stupid" attacks goes to HTTP, a lot of attacks on the DNS, but the main "smart" attacks are usually directed at the previously explored nodes within the target infrastructure.  Often, DDoS aims not only and not so much the failure of services, as the opportunity to carry "under the general noise" through the DMZ a more serious threat.  This is often achieved through the use of ‚Äúoverloading‚Äù of perimeter protection systems such as firewalls, IPS / IDS, and the like, based on session tracking (stateful inspection).  Therefore, colleagues believe that if the device has a state table (session table) - it should be considered as part of the infrastructure that needs protection. <br><br>  <b>The main points of attack:</b> <br><img src="https://habrastorage.org/files/a54/f31/6bf/a54f316bf7494be389e3f12f48921c2d.gif"><br><br>  <b>The <a href="http://www.croc.ru/solution/integration/insecurity/network-security/">reflection attack</a> scheme is implemented as follows:</b> <br><ol><li>  On the side of the protected company is a device that ‚Äúcloses‚Äù the network.  As soon as the attack begins, the device must recognize it as an anomaly, using one of the mechanics, for example, built-in countermeasures, abnormal behavior of the traffic source, or matching a known attack profile (signature from the base). </li><li>  If the device copes with the attack, the work continues in a relatively normal mode: legitimate traffic is skipped, illegitimate traffic is cut.  There are several ‚Äúalarm levels‚Äù that differ in the degree of difficulty of the attack and the possible loss of legitimate traffic. </li><li>  If the communication channel starts to get clogged up, the traffic is automatically redirected using the standard Cloud Signaling protocol.  At first, everything comes to the site of a major provider (this could be Rostelecom, Orange, Transtelecom, Akado), where the data is cleaned with Peakflow SP equipment.  Already cleared traffic goes to the final client.  At the same time, the client has an understanding of everything that is happening - he can promptly enter the operator‚Äôs personal account and see the current status of cleaning, what countermeasures work, what is the effectiveness of suppressing attacks, and so on.  The client device also shows the effectiveness of the ongoing cleanup and the list of blocked hosts.  With both devices, if desired, you can easily remove the traffic dump in pcap format for the subsequent ‚Äúdebriefing‚Äù. </li></ol><br><br><img src="https://habrastorage.org/files/6ce/780/2ee/6ce7802ee7024f2792df7f6c9505c8ed.gif"><br><br><h4>  Reality, which is not to talk </h4><br>  <b>1. Loss of legitimate traffic.</b> <br>  The fight against DDOS attacks is the dropping of illegitimate packets and the omission of legitimate traffic, between which a very thin line sometimes passes.  Many vendors in their prospectuses like to write that these losses are close to zero.  In my practice, they can easily reach up to 2% - this means that theoretically the same director who went on a business trip will not be able to get into the corporate network from a hotel or from a conference.  Here it is very important that the system supports the ability to resolve specific connections or protocols on the fly.  A number of vendors since the start of the attack settings, in fact, almost hardkoditsya in the firmware of iron, and change them is extremely problematic.  Arbor is completely different with this.  First of all, there are three ‚Äúalarm modes‚Äù to control the level of false-positive - from ‚Äúcut everything that is definitely not ours‚Äù to ‚Äúthere is an opportunity to delve more detailed‚Äù.  Secondly, there is a convenient search for blocked hosts and the ability to cancel the blocking of traffic for a particular host, protocol or country in one click.  Note that the reality of having false positive in the fight against DDoS is recognized by all notable market players.  Alexander Lyamin (Qrator) once noted: "anyone who says that he has a false positive is a charlatan." <br><br>  <b>2. The ability to use a clogged communication channel for signaling an attack.</b> <br>  How does the client ask the provider for an attack if the channel between them is blocked due to DDoS?  Strictly speaking, even with close to 100% utilization of the communication channel in the direction from the provider to the client, there is a very big chance that the request to clear the data will reach the provider.  To do this, Cloud Signaling works on top of UDP, and in addition, the protocol does not require a response from the provider.  Thus, it is enough to have at least some capacity in the direction from the client to the operator.  For reinsurance, it is recommended to organize a separate channel for messaging Cloud Signaling.  However, a backup channel is usually created, plus an alarm goes off at a threshold of about 70-80% of the channel. <br><br>  <b>3. Time to switch to data clearing center.</b> <br>  A delay in redirecting traffic to the cleaning center of a DDoS protection service provider can take a few or even tens of minutes.  This is mainly due to the redirection mechanism - based on DNS records or BGP announcements, as well as the fact whether the decision to redirect is made manually or automatically.  In any case, if the suppression of the attack is carried out in the "cloud", then to avoid the delay will not succeed.  At a minimum, it is a few minutes.  Therefore, we adhere to the concept of multi-level protection, when large attacks on communication channels are suppressed by the operator, and slow, unobtrusive application-level attacks with equipment installed at the customer. <br><br>  <b>4. Use SSL certificates.</b> <br>  Analyzing SSL / TLS traffic for application-level attacks is problematic ‚Äî you need to decrypt each packet.  Here you are faced with a difficult dilemma: either sharing your certificates with your service provider, or accepting the risk that an attack at the HTTPS level could be missed.  Vendors try to find solutions without opening packages (which is not always good), or use a special SSL / TLS decryption module built into the client device: <br><br><img src="https://habrastorage.org/files/2e7/62e/417/2e762e417e8b41729cfa68c1d641a6fa.gif"><br><br>  In this case, your certificates are uploaded to a device that is under your control, and the delay for additional packet processing is milliseconds. <br><br>  <b>5. Manual formation of signatures.</b> <br>  Most signatures are formed by manufacturers of solutions for protection against DDoS attacks.  However, there are occasional situations when resources are exposed to new types of attacks. <br><br>  Depending on the vendor, there are two possible scenarios for actions in such a situation: either to request a new signature from the manufacturer, or to create a signature by yourself.  In the first case, you will most likely have to pay extra for the service, as well as for a considerable time to remain under attack, waiting for the problem to be solved. <br><br>  In the second case, the principle of ‚Äúsaving the drowning is the work of the drowning themselves,‚Äù well, or their partners.  Here, equipment functionality becomes critical, allowing you to quickly identify, intercept and analyze malicious traffic.  And the ability to automatically generate a signature based on the information received becomes a salvation in a critical situation.  For example, the ability to go into the packet capture, select the desired bit sequence (bit pattern), and in a couple of clicks make a signature blocking such a sequence. <br><br><h4>  Scale advantage </h4><br>  Arbor has a very interesting "trick" that allows them to use their market share very effectively.  The fact is that their equipment costs all TIER-I telecom operators and providers and most TIER-II operators. <br><br><img src="https://habrastorage.org/files/5c6/f20/902/5c6f209027b44e18aa0f7549d9da298e.gif"><br>  <i>Arbor's position in the DDoS protection equipment market in the Carrier, Enterprise, Mobile segments - 65% of the total market - the first (Infonetics Research for December 2013).</i> <br><br>  Information passes through the ATLAS system at about 90 TB / s.  As soon as signs of an attack appear somewhere, the devices begin to transmit information about what is happening on their own communications network, and information quickly spreads around the world.  For example, if a small provider is ‚Äúfelled‚Äù, its iron signals according to a special protocol a level higher.  If the superior operator has an agreement with the subordinate operator, then the signature is accepted and distributed to all subnets of a large provider. <br><br><img src="https://habrastorage.org/files/866/f82/6c1/866f826c15354c8fa29f4dc11b4f89e5.gif"><br>  Sensors (honeypots) of the ATLAS system are located on the main nodes of the global Internet to detect and classify attacks, bot network activity and various malicious software.  The information is sent to the ATLAS data center, where it is combined with data obtained from the Arbor Peakflow installation and other data.  The system automatically analyzes hundreds of thousands of code elements, and allows a team of engineers to quickly update signatures for company customers around the world. <br><br><h4>  Connection Features </h4><br>  It should say a few words about the iron, which is placed directly to you in the data center or on the site.  Many realities are also associated with it, which are not always spoken about. <br><br>  <b>1. Setup and configuration.</b> <br>  As a rule, the device needs time to profile the traffic and evaluate the behavior of the network.  But some devices are delivered in a ‚Äúcombat‚Äù mode to work from the first second after the connection - there are already ready-made templates, plus the device receives data from the ‚Äúcloud‚Äù of its vendor.  On the one hand, this is good in terms of repelling an ongoing attack, on the other - if you are used to fine-tune everything in your infrastructure, you will have to partially rely on the experience of the vendor. <br><br>  <b>2. Protective iron itself can become a point of failure.</b> <br>  Therefore, firstly, on serious objects it is duplicated or several devices are going to a cluster (respectively, control devices are needed).  And secondly, such devices have hardware bypasses, allowing you to switch interfaces at the physical level, traffic directly in case of various emergency situations - power failure, software failure, and so on ... <br><br>  <b>3. Protective iron can also be the target of an attack.</b> <br>  Especially if it is a device with a state table (session table), for example, it combines the protection functionality from DDOS, IPS, firewall, etc.).  Every time a new session is opened on such devices, the device allocates memory to track the session, fills the log and so on - and the smarter the device, the more work happens.  Many sessions - a lot of CPU and memory utilization.  Therefore, choosing a solution, it is worth paying attention to this aspect. <br><br>  <b>4. Usually there is a lot of junk traffic on the network, and in the case of large organizations, there are also regularly peaks of activity that can pass for ‚Äústupid‚Äù DDoS.</b> <br>  It is clear that everything is structured according to geography, time of use of services, and so on, but at the first stage it is important to get an understanding that the inclusion of the device in the network will not kill services.  For this purpose, the mirror connection mode is used: the device is put into the network on the bypass and receives the mirror traffic, showing what it would reject and what it would miss.  This allows you to make an assessment before problems arise.  I know customers where DDoS protection is exactly in this mode for a long time.  Arbor believes that building a baseline is only one of the methods of dealing with DDoS, but it is much better to use a specialized countermeasure.  Colleagues say the same about signatures - how big would be the network of sensors and how much traffic would be analyzed in it, you cannot rely only on signatures.  Complex threats require a combination of different protection mechanisms. <br><br>  <b>5. At the level of traffic exchange between providers, a rather unpleasant situation sometimes happens when a subnet transmits the signature of an attack, and the upstream provider says: ‚ÄúYeah, interesting, but we won't clean ourselves‚Äù.</b> <br>  The principle is very simple - while the channel is coping, all DDoS traffic is bilingual.  It is not always interesting for the upstream provider to spend money and clean it when you can just ship lower, and even for the money of the victim.  Such situations are unpleasant for service providers, but they have no effect on users of DDoS protection services, since operators fulfill their obligations in full. <br><br><h4>  Reports </h4><br>  One of the important things is a quick understanding of what is happening.  Let's look at the reports on the example of two attacks on a large Russian bank.  Feel the admins add gray hair in the comic below. <br><br><h4>  Attack with a capacity of about 50 Gbit / s </h4><br>  This attack began with DNS amplification.  Traffic recorded on the Arbor Peakflow TMS service provider: up to 7.15 Gbit / s., 1.1 Mpaket / s.  Taking into account filtering most of the attack on FlowSpec, the total attack traffic is estimated at 50 Gbit / s.  The attack was continued HTTP flood. <br><br><img src="https://habrastorage.org/files/095/08e/13e/09508e13e70d4f90b3d5b053e93058dc.gif"><br><br>  Having recorded an abnormal growth of traffic, the client device automatically requested assistance from the service provider in suppressing the attack. <br><br><img src="https://habrastorage.org/files/a8f/9fd/b9b/a8f9fdb9bddf4f18aee186b178ff01d1.gif"><br><br>  The protection system installed by the operator transmitted information about the course of suppressing the attack on Pravail APS in real time. <br><br><img src="https://habrastorage.org/files/aa3/9d0/8f2/aa39d08f26b04709a5f22de8ba61e2d7.gif"><br><br>  When the DNS-amplification attack disappeared, a large amount of HTTP flood appeared. <br><br><img src="https://habrastorage.org/files/53f/fe0/266/53ffe0266fa7462fb84acd93ef00fdda.gif"><br><br>  In addition to HTTP flood, TCP SYN flood was also present. <br><br>  As a result, most of the DNS-amplification of the attack was successfully suppressed using Flowspec, the rest of it was suppressed by the protection system, and the HTTP and TCP SYN flood was reset to Pravail APS. <br><br><h4>  Attack with a capacity of about 125 Gbit / s </h4><br><br><img src="https://habrastorage.org/files/867/d79/619/867d7961953a492f98b73653e194e926.gif"><br><br>  A few minutes at the beginning - HTTP flood.  There is a surge in the number of foreign hosts (red graph).  About 1000 hosts on the domain of the ‚ÄúLarge Russian Bank‚Äù.  The main countries are: USA (672), Germany (141), Great Britain (82), Italy (30), Netherlands (24), France (14). <br><br><img src="https://habrastorage.org/files/4d6/19e/cd8/4d619ecd86d14082b4ad003692b6402b.gif"><br><br>  The next surprise is NTP-amplification - up to 125 Gbit / s. <br><br><img src="https://habrastorage.org/files/9c5/013/2b3/9c50132b3edf43e28b0716a16930b3a3.gif"><br><br>  After failed NTP amplification - SYN-flood with spoof IP - up to 300 Mbps <br><br><h4>  Summary </h4><br>  Attacks go constantly, and if you haven‚Äôt come across this yet - it‚Äôs just a matter of time.  To illustrate, here are some events in the Russian Federation: <br><ul><li>  <a href="http://ria.ru/world/20140314/999548434.html">Attacked the</a> website of the CIS Inter-Parliamentary Assembly </li><li>  <a href="http://news.yandex.ru/yandsearch%3Fcl4url%3Dria.ru%252Feconomy%252F20140314%252F999514759.html%26lr%3D213%26rpt%3Dstory">Attacked the</a> site of the Central Bank of Russia </li><li>  <a href="http://www.novayagazeta-ug.ru/news/u2802/2014/03/13/46335">Attacked the</a> site of the first channel </li><li>  <a href="http://www.novayagazeta-ug.ru/news/u2802/2014/03/13/46343">Attacked the</a> website VGTRK </li><li>  <a href="http://www.novayagazeta-ug.ru/news/u1542/2014/03/14/46543">Attacked the</a> site of the Kremlin </li><li>  <a href="http://www.gazeta.ru/tech/news/2014/03/17/n_6017749.shtml">Attack</a> on VTB24 </li><li>  <a href="http://ria.ru/society/20140314/999538110.html">Attacked the</a> site RIA </li><li>  <a href="http://www.rbcdaily.ru/society/562949990831824">Attacked the</a> site of the Ribbon </li><li>  <a href="http://top.rbc.ru/society/30/01/2014/902338.shtml">Attacked the</a> site of the newspaper "Vedomosti" </li></ul><br>  If you have questions, I‚Äôll be happy to answer here or at avrublevsky@croc.ru.  Our division can also offer various solutions if you need a different vendor. <br><br>  And tomorrow, October 21, we are <a href="http://www.croc.ru/action/webinars/41850/">holding a webinar on the topic of DDoS protection</a> .  Come, tell us what is happening in Russia on this front now in Russia. </div><p>Source: <a href="https://habr.com/ru/post/240923/">https://habr.com/ru/post/240923/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../240913/index.html">Virtual networks: VXLAN and VMware NSX</a></li>
<li><a href="../240915/index.html">We are preparing Debian to transfer the clock October 26, 2014</a></li>
<li><a href="../240917/index.html">Go language: rehabilitation of imperative programming</a></li>
<li><a href="../240919/index.html">Project management tools and methodology on the example of a startup pivot</a></li>
<li><a href="../240921/index.html">Verve 2: an electronic designer of smart devices for beginners + the opportunity to learn the basics of electronics</a></li>
<li><a href="../240927/index.html">Update 3! A series of 24 laboratory work on the development, testing and lifecycle management software for Visual Studio 2013</a></li>
<li><a href="../240929/index.html">How CPU works: an interactive tutorial for beginners</a></li>
<li><a href="../240931/index.html">New Favorite Kickstarter: Pronto Speed ‚Äã‚ÄãCharging</a></li>
<li><a href="../240933/index.html">New in the release of Kerio Control 8.4</a></li>
<li><a href="../240935/index.html">How to debug your brain</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>