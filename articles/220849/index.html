<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Sample pen on supercomputer Lomonosov</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this post I want to tell about my experience of calculations on the Lomonosov supercomputer. I will talk about the solution of the problem, to be h...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Sample pen on supercomputer Lomonosov</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/3d9/1cc/7d7/3d91cc7d771ea272bffb5d082e9d4a5d.jpg" alt="image"><br><br>  In this post I want to tell about my experience of calculations on the Lomonosov supercomputer.  I will talk about the solution of the problem, to be honest, for which it is not necessary to use the IC, but academic interest is above all.  Detailed information about <a name="habracut"></a>  Lomonosov configurations can be found <a href="http://parallel.ru/cluster/lomonosov.html">here</a> . <br><br><h4>  Data transfer rate between nodes / processes </h4><br>  At first, I decided to conduct a simple test of the bandwidth of the cluster, and compare how much the data transfer rates differ from one stream to another: a) if both streams are running on the same cluster node;  b) on different.  The following values ‚Äã‚Äãare estimated using the mpitests-osu_bw test. <br>  Peak speed at different nodes: <br>  3.02 GB / s <br>  On one node: <br>  10.3 GB / s <br><h4>  A little bit about the task </h4><br>  It is necessary to solve the diffusion equation on a fairly simple domain. <br> <a href="http://www.codecogs.com/eqnedit.php%3Flatex%3D%5Cfrac%7B%5Cpartial%26space%3Bu(%7B%5Cbf%26space%3Br%7D,t)%7D%7B%5Cpartial%26space%3Bt%7D%3DD%5Cnabla%5E2u(%7B%5Cbf%26space%3Br%7D,t)%26plus%3Bf(%7B%5Cbf%26space%3Br%7D,t)"><img src="https://habrastorage.org/getpro/habr/post_images/02c/23d/78a/02c23d78af54329c5279a9fe00c07b5a.gif" title="\ frac {\ partial u ({\ bf r}, t)} {\ partial t} = D \ nabla ^ 2u ({\ bf r}, t) + f ({\ bf r}, t)"></a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/cd3/411/28b/cd341128b7f120e70b2e5a078d74dfa2.png" alt="image"><br><br>  We have a linear equation in ch.p.  We will solve it without flow, i.e.  at the boundaries 1, 2, 4, the derivative is normal to the wall 0, and at the border 3, the concentration is determined by a given function g (t).  Thus we get a mixed boundary value problem.  We will solve it by the method of finite differences (very inefficient, but simple). <br><br><h4>  About parallelization </h4><br>  To solve this problem, I used openMPI / intelMPI (a separate post should be devoted to comparing compilers in practice).  I will not go deeper into the numerical scheme, because there is Wikipedia and I will only say that I used an explicit scheme.  I used the block distribution of the area so that each stream is given several areas and if the data that is transmitted from the previous area is zero, then the area is not considered.  Extreme columns / rows of blocks are designed to receive data from neighboring streams. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/75d/2ee/fa9/75d2eefa9a45f9c4a9ae0aa6c324bc5c.png" alt="image"><br><br><h5>  Grid parameters used in calculations </h5><br>  Number of nodes in the grid: 3 * 10 ^ 6 <br>  Grid step: 0.0007. <br>  Physical diffusion time: 1 s <br>  Time step: 6.5 * 10 ^ -7 <br>  D: 0.8 <br>  The initial concentration at the boundary is 3 0.01 mol. <br><br><h4>  A little about the law Amdala </h4><br>  Jim Amdal formulated a law illustrating the performance limitations of a computing system with an increase in the number of calculators.  Suppose you need to solve any computational problem.  Let Œ± be the fraction of the algorithm that runs sequentially.  Then, respectively, 1-Œ± is executed in parallel and can be parallelized on p-nodes, then the acceleration obtained on the computing system can be obtained as <br><br> <a href="http://www.codecogs.com/eqnedit.php%3Flatex%3DS_p%3D%5Cfrac%7B1%7D%7B%5Calpha%26plus%3B%5Cfrac%7B1-%5Calpha%7D%7Bp%7D%7D."><img src="https://habrastorage.org/getpro/habr/post_images/a21/7ee/656/a217ee656ec461ab4bf89710a7f6e474.gif" title="S_p = \ frac {1} {\ alpha + \ frac {1- \ alpha} {p}}."></a> <br><br><h4>  Let's turn to the most interesting to the results and results of parallelization. </h4><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/YCZ4hyOWH9s%3Ffeature%3Doembed&amp;xid=17259,15700002,15700022,15700186,15700191,15700253&amp;usg=ALkJrhj6Q9b6qJ5xg-atNKkZxgENqlKT1Q" frameborder="0" allowfullscreen=""></iframe><br><br><h5>  Runtimes on a different number of threads </h5><br><table><tbody><tr><td>  number percent </td><td>  one </td><td>  2 </td><td>  eight </td><td>  sixteen </td><td>  32 </td><td>  64 </td><td>  128 </td></tr><tr><td>  time min </td><td>  840 </td><td>  480 </td><td>  216 </td><td>  112 </td><td>  61 </td><td>  46 </td><td>  41 </td></tr></tbody></table><br>  We approximate the calculation times by the Amdal law. <br><img src="https://habrastorage.org/getpro/habr/post_images/a51/115/132/a51115132f14884dcc00ab5d0647bd0e.png"><br>  From the approximation, I got the sequential code rate of about 4.2% and the maximum acceleration about 20 times.  As can be seen from the graph, the curve goes to the plateau, from this we can conclude that the maximum acceleration is reached and further dragging the number of processors is impractical.  Moreover, in this case, with an increase in the number of processes over 200, I received a decrease in acceleration, this is due to the fact that with an increase in the number of processes, their irrational use begins, i.e.  the number of rows in the grid becomes commensurate with the number of processes and more time is spent on exchanges, and this time makes a significant contribution during the calculations. <br><br><h4>  Some notes </h4><br>  In the UK, the sbatch task management system is used and there are several test queues test, regular4, regular6, gputest, gpu.  For this task, I used the regular4 queue in which the waiting time can reach three days (in practice, the waiting time is 17-20 hours). </div><p>Source: <a href="https://habr.com/ru/post/220849/">https://habr.com/ru/post/220849/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../220839/index.html">What is Excel Mashup, and to whom it may be useful?</a></li>
<li><a href="../220841/index.html">N2O: Erlang WebSockets Web Framework</a></li>
<li><a href="../220843/index.html">Commercial nanotechnology</a></li>
<li><a href="../220845/index.html">Reactjs gamma generator</a></li>
<li><a href="../220847/index.html">8 Two Wheel MODX Revolution Tips</a></li>
<li><a href="../220851/index.html">(Self) processor identification. Part two. Hairy CPUID</a></li>
<li><a href="../220853/index.html">Friday's announcement #FailOverConf. And buns to participants</a></li>
<li><a href="../220855/index.html">Mother's wisdom to guard your marketing</a></li>
<li><a href="../220859/index.html">New in the release of Kerio Control 8.3</a></li>
<li><a href="../220863/index.html">Extraction of data from the database 1C: problems with transfers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>