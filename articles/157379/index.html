<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Application recovery when starting from the start screen without losing the previous state in WP8</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Windows Phone 8 brought such a wonderful opportunity as a quick resumption of the application state after it was restarted from the application list o...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Application recovery when starting from the start screen without losing the previous state in WP8</h1><div class="post__text post__text-html js-mediator-article">  Windows Phone 8 brought such a wonderful opportunity as a quick resumption of the application state after it was restarted from the application list or through the home screen tile with full state and navigation history inside the application (to enable subsequent navigation using the Back button as if the application was nowhere folded). <br><br>  If you have already tried to use Windows 8 and applications from the Windows Store, you may have noticed that when you start the application from the start screen, you will return exactly to the place of the application where you left it.  This is the result we will achieve in our application for <nobr>Windows Phone 8</nobr> . <br><br>  So, let's begin. <br><a name="habracut"></a><br><h4>  WMAppManifest.xml </h4><br>  First, let's open the manifest file of our application (by clicking on it in Solution Explorer and selecting View Source, in the English edition of Visual Studio).  All we need to do is add an attribute called <b>ActivationPolicy</b> with the value <b>Resume</b> to the <b>DefaultTask</b> element.  Like this: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="cs hljs">&lt;DefaultTask Name=<span class="hljs-string"><span class="hljs-string">"_default"</span></span> NavigationPage=<span class="hljs-string"><span class="hljs-string">"MainPage.xaml"</span></span> ActivationPolicy=<span class="hljs-string"><span class="hljs-string">"Resume"</span></span> /&gt;</code> </pre> <br>  By and large, with this change, we ensured that our application, when restarted via the start screen / list of applications, began to recover to its previous state, plus switching to the page specified in the DefaultTask element's manifest attribute's NavigationPage attribute.  Immediately after this, the navigation history of our application looks like this: <br><img src="https://habrastorage.org/getpro/habr/post_images/e1b/169/3cc/e1b1693cc18a10bb51623f3411c09299.png" alt="image"><br>  This slightly accelerated the restart due to the fact that the system no longer clears the state and does not start the application from scratch.  But, we go further. <br><br><h4>  App.xaml.cs </h4><br>  Now we have to cancel this unnecessary transition to the main page after restarting the application.  To do this, we need to slightly edit the App.xaml.cs file (you will notice that the SDK for some reason does not want to work as described on MSDN, so we will go a little different way). <br><br>  To begin with, let's add a private non-static field of type System.Boolean to our App class and name it _reset. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> _reset;</code> </pre><br>  The next step is to find the private InitializePhoneApplication method (it is automatically created by the default template) and set up the initialization of the RootFrame, defining our fragments for the Navigating and Navigated events. <br><br><pre> <code class="cs hljs">RootFrame.Navigating += RootFrame_Navigating; RootFrame.Navigated += RootFrame_Navigated;</code> </pre><br>  The final step will be to modify the bodies of the handler methods of these events. <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RootFrame_Navigating</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sender, NavigatingCancelEventArgs e</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (_reset &amp;&amp; e.IsCancelable &amp;&amp; e.Uri.OriginalString == <span class="hljs-string"><span class="hljs-string">"/MainPage.xaml"</span></span>) { e.Cancel = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; reset = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">RootFrame_Navigated</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sender, NavigationEventArgs e</span></span></span><span class="hljs-function">)</span></span> { _reset = e.NavigationMode == NavigationMode.Reset; }</code> </pre><br>  And that's all, the goal is achieved.  Now, after the application is resumed when it is restarted, the user will go exactly where he left the application. <br><img src="https://habrastorage.org/getpro/habr/post_images/1d7/9db/4e6/1d79db4e6d85d847b633e06c525e6709.png" alt="image"><br>  In just a few minutes, we have made our application much more pleasant to use. <br><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/Kw_-wlxBjDA%3Ffeature%3Doembed&amp;xid=17259,15700022,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhjrcUugK9KtfWxF2QO_rXSfQVTsJA" frameborder="0" allowfullscreen=""></iframe><br><br>  You can also play around and, for example, when resuming, clear the history of the Back button, while maintaining only the state of the current page.  To do this, you need to add the following line in the Navigated event handler: <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (e.NavigationMode == NavigationMode.Reset) <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (RootFrame.RemoveBackEntry() != <span class="hljs-literal"><span class="hljs-literal">null</span></span>);</code> </pre><br><img src="https://habrastorage.org/getpro/habr/post_images/8ed/3f1/d9b/8ed3f1d9bc02dfa1c70f2a549565775a.png" alt="image"><br>  That's all, thank you for your attention. <br><br><h4>  Note </h4><br>  The original article lacked some points from the <a href="http://msdn.microsoft.com/ru-ru/library/windowsphone/develop/jj735579.aspx">official documentation</a> , which I thought it appropriate to add to the court of readers. </div><p>Source: <a href="https://habr.com/ru/post/157379/">https://habr.com/ru/post/157379/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../157367/index.html">On intellectual property with a cool head. Part 2</a></li>
<li><a href="../157369/index.html">Kim Dotcom promises $ 400 million fiber and free internet to all New Zealand residents</a></li>
<li><a href="../157371/index.html">Webshell on TCL, for Cisco IOS, and more</a></li>
<li><a href="../157373/index.html">Anonymous merged VMware ESX kernel source</a></li>
<li><a href="../157377/index.html">School crafts: Battlecruiser & DeathCraft</a></li>
<li><a href="../157383/index.html">Advantages of arbitrary tags, or how I abandoned HTML markup</a></li>
<li><a href="../157385/index.html">The advantages of Check Point centralized security over network competitors</a></li>
<li><a href="../157389/index.html">Context menus VS2010 / 2012 and keyboard</a></li>
<li><a href="../157391/index.html">Comparison of Microsoft Office under Windows and Mac from the perspective of office use: what to look for</a></li>
<li><a href="../157393/index.html">Custom Themes for Custom Widgets</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>