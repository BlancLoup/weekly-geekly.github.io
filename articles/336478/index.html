<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We sharpen a tool on PyQt</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I needed a tool. Sharp, practical, versatile. Meets all my requirements and expands according to my desire. 



 But simple and convenient. It should ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We sharpen a tool on PyQt</h1><div class="post__text post__text-html js-mediator-article">  I needed a tool.  Sharp, practical, versatile.  Meets all my requirements and expands according to my desire. <br><br><img src="https://habrastorage.org/web/d55/f5d/618/d55f5d61827946408fb682eb6fc78037.jpg" alt="image"><br><br>  But simple and convenient.  It should be noted here that I am not a developer at the main job, so I don‚Äôt have a permanent programming environment on my work computer and, when required, I‚Äôll write what it takes - bat, JScript, VBA in MSOffice (yes, this is Windows, corporate systems, there‚Äôs no bash and perl "out of the box"), macros in different software, etc.  All this helps to solve the current problem, but the level and possibilities are not the same as we would like to have. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In short, I need an integrated environment with a built-in programming language, in which I could parse and convert files, climb into databases, receive reports, invoke web services, generate queries in jer, etc., etc. <br><br>  You will say that now there are tools for every taste and color, just choose.  Frog aka TOAD for Oracle, SoapUI for the bus, and GNU and Apache products for everything else. <br>  But the problem is that all of them are specialized for one kind of activity, but on the other hand are too universal - much can be done, but with many actions.  And if the opportunity in the product is missing, then you can not add it.  Either the product is closed, or you need to develop / buy a plugin, or download the source code and understand them.  And I needed a tool in which simple actions are done simply, but for complex ones, some time is spent first and then everything is simple again. <br><a name="habracut"></a><br>  Therefore, I decided to assemble myself the simplest shell from which I would run the modules I needed.  The shell will be expandable, and the modules are simple and as independent as possible from the shell. <br><br><img src="https://habrastorage.org/web/b44/2fd/e46/b442fde467d64d18a5c5e95fb90b471f.png"><br><br>  As a programming language, you need to take something that does not require compilation, or at minimal cost to it, so that you can easily rebuild it for a specific task. <br><br>  Javascript is good for small scripts and would work, but it doesn‚Äôt have a window interface, but I‚Äôm not interested in raising NodeJS locally for windows and fighting the browser. <br>  Perl, PHP - the same problem. <br><br>  Visual Basic and VBScript - well, this is under Windows.  Yes, most of the corporate IT systems where I have the honor to work are Windows.  And each has an Office and, therefore, VBA.  But if you do something that you want to constantly use, then cross-platform. <br><br>  The choice fell on Python + PyQt5.  I learned about the existence of a language (besides Habr, of course) from the raspberry Raspberry Pi, where Python was preinstalled.  The breakdown of the pen served as a bot for Telegram, looking for synonyms of phrases (on <a href="https://habrahabr.ru/post/176575/">pymorphy2</a> and YARN, then I will describe if interested).  And I already knew Qt. <br><br><pre><code class="bash hljs">pip3 install pyqt5</code> </pre> <br>  To begin with, we will make a universal module for querying the database.  And so that the request and its parameters are defined outside the module, in the ini-file, and the module is engaged in all the work with the interface, working with the database and displaying data. <br><br>  Let's connect PyQt.  Naming in Qt is strict, so importing everything in a row will not interfere. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> PyQt5.QtCore <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> PyQt5.QtWidgets <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> PyQt5.QtSql <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> *</code> </pre> <br>  To prevent error messages and Qt warnings from being lost, we connect the module with the message handler, as suggested <a href="https://stackoverflow.com/questions/35894171/redirect-qdebug-output-to-file-with-pyqt5">here.</a> <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> meshandler</code> </pre> <br>  We will move the connection to the database into a separate module in order not to clog here. <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> dbpool</code> </pre> <br>  Create a class based on QDialog (QWidget is also suitable, but in it the default buttons do not work) <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PyExecutor</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(QDialog)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, iniFile, parent=None)</span></span></span><span class="hljs-function">:</span></span> super(PyExecutor, self).__init__(parent) self.setWindowFlags(self.windowFlags() | Qt.WindowMinimizeButtonHint | Qt.WindowMaximizeButtonHint )</code> </pre><br>  Fill the window, top to bottom <br><br><pre> <code class="python hljs">self.topLay = QVBoxLayout(self) self.topLay.setContentsMargins(<span class="hljs-number"><span class="hljs-number">6</span></span>,<span class="hljs-number"><span class="hljs-number">6</span></span>,<span class="hljs-number"><span class="hljs-number">6</span></span>,<span class="hljs-number"><span class="hljs-number">6</span></span>)</code> </pre><br>  Layout with space for entering parameters and buttons <br><br><pre> <code class="python hljs">self.lay = QFormLayout() self.topLay.addLayout(self.lay)</code> </pre><br>  Place for output <br><br><pre> <code class="python hljs">self.resultLay = QVBoxLayout() self.topLay.addLayout(self.resultLay)</code> </pre><br>  And the status bar to <br><br><pre> <code class="python hljs">self.bar = QStatusBar(self) self.topLay.addWidget(self.bar)</code> </pre><br>  Download the ini file.  The load will be moved to a separate method, so that later it can be blocked, if necessary. <br><br><pre> <code class="python hljs">self.loadIni(iniFile) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loadIni</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, iniFile)</span></span></span><span class="hljs-function">:</span></span></code> </pre><br>  I use Qt tools to work with ini-files simply because I know how to do it there.  In Python, there must be some ways too, but I didn‚Äôt dig.  To avoid future problems with the Russian language, we will work in UTF-8 in all files. <br><br><pre> <code class="python hljs">ini = QSettings(iniFile, QSettings.IniFormat) ini.setIniCodec(<span class="hljs-string"><span class="hljs-string">"utf-8"</span></span>)</code> </pre><br>  Load the request parameters from the section "Input" <br><br><pre> <code class="python hljs">ini.beginGroup(<span class="hljs-string"><span class="hljs-string">"Input"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> key <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> sorted(ini.childKeys()):</code> </pre><br>  The parameter is defined by the string "Name = Label: Default Value" <br>  The name can be omitted along with a colon, then the interface will be Name. <br><br><pre> <code class="python hljs">v = ini.value(key).split(<span class="hljs-string"><span class="hljs-string">':'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> len(v)&gt;<span class="hljs-number"><span class="hljs-number">1</span></span>: paramTitle = v[<span class="hljs-number"><span class="hljs-number">0</span></span>] paramValue = v[<span class="hljs-number"><span class="hljs-number">1</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: paramTitle = key paramValue = v[<span class="hljs-number"><span class="hljs-number">0</span></span>]</code> </pre><br>  For each parameter, we create an input line, add it to ourselves, insert it with the label into the interface <br><br><pre> <code class="python hljs">self.params.append([key, paramTitle, paramValue]) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> paramTitle != <span class="hljs-string"><span class="hljs-string">''</span></span>: le = QLineEdit() self.inputs[key] = le le.setText(paramValue) le.paramTitle = paramTitle self.lay.addRow(paramTitle, le) ini.endGroup()</code> </pre><br>  Read the parameters of the database connection from the section ¬´DB¬ª <br><br><pre> <code class="python hljs">ini.beginGroup(<span class="hljs-string"><span class="hljs-string">"DB"</span></span>) self.dbini = ini.value(<span class="hljs-string"><span class="hljs-string">"DBConnect"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.dbini == <span class="hljs-string"><span class="hljs-string">"this"</span></span>: self.dbini = iniFile ini.endGroup()</code> </pre><br>  And finally, read the text of the SQL query. <br><br>  In the ‚ÄúRun‚Äù section, either there will be a ‚ÄúSQL‚Äù key with the query text itself (it is better to put it in quotes), or there will be an ‚ÄúSQLScript‚Äù key in which the sql file with the query is registered ‚Äî this allows you to create multi-line queries.  In addition, it is more convenient to edit requests in the file in FAR with the backlit Colorer. <br><br>  Like ini, we assume that the sql file is in UTF-8 encoding, only for transcoding we will use 'utf-8-sig' to get rid of the <a href="https://ru.wikipedia.org/wiki/%25D0%259C%25D0%25B0%25D1%2580%25D0%25BA%25D0%25B5%25D1%2580_%25D0%25BF%25D0%25BE%25D1%2581%25D0%25BB%25D0%25B5%25D0%25B4%25D0%25BE%25D0%25B2%25D0%25B0%25D1%2582%25D0%25B5%25D0%25BB%25D1%258C%25D0%25BD%25D0%25BE%25D1%2581%25D1%2582%25D0%25B8_%25D0%25B1%25D0%25B0%25D0%25B9%25D1%2582%25D0%25BE%25D0%25B2">BOM</a> at the beginning of the file. <br><br><pre> <code class="python hljs">ini.beginGroup(<span class="hljs-string"><span class="hljs-string">"Run"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ini.contains(<span class="hljs-string"><span class="hljs-string">"SQL"</span></span>): self.sql = ini.value(<span class="hljs-string"><span class="hljs-string">"SQL"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: f = QFile(ini.value(<span class="hljs-string"><span class="hljs-string">"SQLScript"</span></span>)) f.open(QIODevice.ReadOnly) self.sql = str(f.readAll(),<span class="hljs-string"><span class="hljs-string">'utf-8-sig'</span></span>) ini.endGroup()</code> </pre><br>  The final touches - add a start button, arrange beautifully. <br><br><pre> <code class="python hljs">self.runBtn = QPushButton(<span class="hljs-string"><span class="hljs-string">"Run"</span></span>) self.runBtn.setDefault(<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>) self.btnLay = QHBoxLayout() self.btnLay.addStretch() self.btnLay.addWidget(self.runBtn) self.lay.addRow(self.btnLay)</code> </pre><br>  The button will assign our method that runs the request for execution <br><br><pre> <code class="python hljs">self.runBtn.clicked.connect(self.run)</code> </pre><br>  Actually launch method <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">run</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span> self.runBtn.setEnabled(<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>) <span class="hljs-comment"><span class="hljs-comment"># ,        self.clearResult() #  ,  </span></span></code> </pre><br>  Let's go work with the database. <br><br>  We receive object QSqlDatabase, it should be valid and open.  And if not - oops, nothing happens. <br><br><pre> <code class="python hljs">self.db = dbpool.openDatabase(self.dbini) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> self.db == <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> self.db.isValid() <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> self.db.isOpen(): print(<span class="hljs-string"><span class="hljs-string">"No opened DB"</span></span>, self.dbini) self.endRun() <span class="hljs-keyword"><span class="hljs-keyword">return</span></span></code> </pre><br>  In Qt, essentially one way to work with database queries is QSqlQuery <br><br><pre> <code class="python hljs">self.query = QSqlQuery(self.db)</code> </pre><br>  Parsing sql query, filling its parameters with values ‚Äã‚Äãfrom input lines <br><br><pre> <code class="python hljs">self.query.prepare(self.sql) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> p <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> self.params: key = p[<span class="hljs-number"><span class="hljs-number">0</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> key <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> self.inputs: le = self.inputs[key] par = <span class="hljs-string"><span class="hljs-string">':'</span></span>+key self.query.bindValue(par, le.text())</code> </pre><br>  In order not to wait until the request is executed, we will move its execution to a separate thread. <br><br><pre> <code class="python hljs">self.tr = QueryRunner(self.query) self.tr.finished.connect(self.showQueryResult) self.tr.start();</code> </pre><br>  When the stream ends, this method will execute. <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">showQueryResult</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self)</span></span></span><span class="hljs-function">:</span></span></code> </pre><br>  Create a QTableView label like this <br><br><pre> <code class="python hljs">w = self.createTableView()</code> </pre><br>  But the model with the result of the query will be transmitted in the view not immediately, but through a proxy - this will give us the opportunity to sort the label by clicking on the column and make a search if necessary. <br><br><pre> <code class="python hljs">w.sqlModel = QSqlQueryModel(w) w.sqlModel.setQuery(self.query) w.proxyModel = QSortFilterProxyModel(w) w.proxyModel.setSourceModel(w.sqlModel) w.setModel(w.proxyModel) self.resultLay.addWidget(w) self.endRun()</code> </pre><br>  Let's launch what we've got to check without a shell <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">if</span></span> __name__ == <span class="hljs-string"><span class="hljs-string">'__main__'</span></span>: <span class="hljs-comment"><span class="hljs-comment">#    Windows import os import PyQt5 import sys pyqt = os.path.dirname(PyQt5.__file__) QApplication.addLibraryPath(os.path.join(pyqt, "Qt", "plugins"))</span></span></code> </pre><br>  And actually launch <br><br><pre> <code class="python hljs">app = QApplication(sys.argv) ex = PyExecutor(<span class="hljs-string"><span class="hljs-string">"artists.ini"</span></span>) ex.show() sys.exit(app.exec_())</code> </pre><br>  File artists.ini <br><br><pre> <code class="hljs sql">[Common] Title=  [Input] Name= ():%r% [DB] DBConnect=sqlite.ini [Run] SQL="<span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> artists <span class="hljs-keyword"><span class="hljs-keyword">where</span></span> :<span class="hljs-keyword"><span class="hljs-keyword">Name</span></span> = <span class="hljs-string"><span class="hljs-string">''</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> artist <span class="hljs-keyword"><span class="hljs-keyword">like</span></span> :<span class="hljs-keyword"><span class="hljs-keyword">Name</span></span><span class="hljs-string"><span class="hljs-string">"</span></span></code> </pre><br>  Checked - works <br><br><img src="https://habrastorage.org/web/20a/f0e/be5/20af0ebe513f42f49550f5dab67fc082.png"><br><br>  Now we need the actual launch shell. <br><br>  In the shell, I want to see a tree of all my configured functions, and run them in separate windows.  And that the windows were not modal, i.e.  it was possible to switch between them and launch new ones. <br><br>  For simplicity, we will use an MDI window, since Qt has everything for it.  Reading the tree and its mapping is taken entirely from the <a href="http://ftp.ics.uci.edu/pub/centos0/ics-custom-build/BUILD/PyQt-x11-gpl-4.7.2/examples/itemviews/simpletreemodel/simpletreemodel.py">PyQt example</a> , so we will not dwell on it. <br><br>  We only define that in the first column we have the name of the function displayed in the row of the tree, in the second - the description of the function, in the third - the ini-file passed to the module <br><br> <code>   <br>       artists.ini <br></code> <br>  I will show how to create the main window on QMainWindow <br><br><pre> <code class="python hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainWindow</span></span></span><span class="hljs-params"><span class="hljs-class"><span class="hljs-params">(QMainWindow)</span></span></span><span class="hljs-class">:</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__init__</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, parent=None)</span></span></span><span class="hljs-function">:</span></span> super(MainWindow, self).__init__(parent)</code> </pre><br>  The main part of the MDI window is a special QMdiArea widget.  It will live windows run modules. <br><br><pre> <code class="python hljs">self.mdiArea = QMdiArea(self) self.setCentralWidget(self.mdiArea)</code> </pre><br>  Let's make the main menu, while with one item: <br><br><pre> <code class="python hljs">self.mainMenu = QMenuBar(self) self.setMenuBar(self.mainMenu) m = self.mainMenu.addMenu(<span class="hljs-string"><span class="hljs-string">"Window"</span></span>) a = m.addAction(<span class="hljs-string"><span class="hljs-string">"Cascade windows"</span></span>) a.triggered.connect(self.mdiArea.cascadeSubWindows)</code> </pre><br>  The tree will be in the dock-panel on the left. <br><br><pre> <code class="python hljs">self.treePanel = QDockWidget(<span class="hljs-string"><span class="hljs-string">" "</span></span>, self) w = QWidget(self.treePanel) self.treePanel.setWidget(w) lay = QVBoxLayout(w) lay.setSpacing(<span class="hljs-number"><span class="hljs-number">1</span></span>) lay.setContentsMargins(<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">1</span></span>) w.setLayout(lay) self.tree = TreeWidget(self.treePanel) lay.addWidget(self.tree)</code> </pre><br>  The description of the function will be displayed at the bottom (later) <br><br><pre> <code class="python hljs">edit = QTextEdit(w) lay.addWidget(edit)</code> </pre><br>  For double-click in the tree, assign a handler and put the panel in the main window <br><br><pre> <code class="python hljs">self.tree.activated.connect(self.handle_dblclick) self.addDockWidget(Qt.LeftDockWidgetArea, self.treePanel)</code> </pre><br>  The double click handler will take the name of the ini-file from the tree model, and create with it a class from the module.  Our class is a widget, we insert it into the client part of the MDI window. <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">handle_dblclick</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(self, index)</span></span></span><span class="hljs-function">:</span></span> proc = index.data(Qt.UserRole) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> proc != <span class="hljs-keyword"><span class="hljs-keyword">None</span></span>: proc = proc.strip() ex = PyExecutor(proc) self.mdiArea.addSubWindow(ex) ex.show()</code> </pre><br>  Check - works: <br><br><img src="https://habrastorage.org/web/f14/42a/34c/f1442a34c3864ff19c2d6fef926e4036.png"><br><br>  Sources are posted on <a href="https://github.com/sshmakov/conopy/tree/master/examples/habr">github</a> under the MIT license.  The link leads to the sources used for the article, and from the <a href="https://github.com/sshmakov/conopy/">root</a> you can get the latest version. <br><br>  <b>Tips:</b> <br>  1. PyQt, like Qt, does not include the QOCI binary driver needed to access Oracle.  The driver must be compiled from the sources (C ++) supplied with Qt and put in PyQt5 \ Qt \ plugins \ sqldrivers.  To build you need dll from Oracle Client. <br>  2. Python is better to set so that the path to it does not contain Cyrillic.  Otherwise, PyQt has a small roof, and it cannot find its files. <br><br>  Continued: <br>  - <a href="https://habrahabr.ru/post/336716/">We sculpt a toolbar on PyQt, export data to Excel and HTML</a> <br>  - <a href="https://habrahabr.ru/post/338060/">We cut XML by XQuery markup</a> <br>  - <a href="https://habrahabr.ru/post/344086/">Preview documents in Python program</a> </div><p>Source: <a href="https://habr.com/ru/post/336478/">https://habr.com/ru/post/336478/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../336466/index.html">We check the browser for support of certain CSS properties</a></li>
<li><a href="../336468/index.html">Creating a programming language using LLVM. Part 7: Language Expansion: Variable Variables</a></li>
<li><a href="../336470/index.html">Why GitHub can't host the Linux kernel</a></li>
<li><a href="../336474/index.html">Work and life in Bulgaria</a></li>
<li><a href="../336476/index.html">Desktop GUI tests in Python. Lecture in Yandex</a></li>
<li><a href="../336480/index.html">Solving the direct and dual problems of linear programming with Python</a></li>
<li><a href="../336482/index.html">Migrate the VueJS application to Vuex</a></li>
<li><a href="../336486/index.html">Inter-AS Option C Pitfalls on JunOS</a></li>
<li><a href="../336488/index.html">The digest of interesting materials for the mobile developer # 218 (August 21 - August 27)</a></li>
<li><a href="../336490/index.html">I'm too busy to do anything</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>