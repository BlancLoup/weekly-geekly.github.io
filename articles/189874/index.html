<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Creating a simple bot for WoW, programming routes (continued)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This is the second part of a post on creating a simple bot for the game World of Warcraft. The first part can be found here . Today we talk about 


1...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Creating a simple bot for WoW, programming routes (continued)</h1><div class="post__text post__text-html js-mediator-article">  This is the second part of a post on creating a simple bot for the game World of Warcraft.  The first part can be found <a href="http://habrahabr.ru/post/189792/">here</a> .  Today we talk about <br><ol><li>  writing the <b>Recorder</b> 's keys and coordinates in <b>AutoIt</b> </li><li>  Writing <b>Player</b> 's instructions for the bot </li><li>  math <b>2D</b> how to navigate in the Cartesian coordinate system without the cosine theorem </li><li>  control of the robot with an insufficient number of sensors </li><li>  bots countermeasures </li></ol><br><img src="https://habrastorage.org/storage2/885/6b7/ecc/8856b7ecc37610d90d47f1e872772437.jpg"><br><br><h4>  Recorder </h4><br>  Our task: reading colors of pixels, determining keystrokes, background work with the ability to pause, sending clicks to the application.  Here, the <a href="http://www.autoitscript.com/">AutoIt</a> language <a href="http://www.autoitscript.com/">is the</a> best fit.  To write the same thing on C, you would have to <a name="habracut"></a>  bother with handles, devices, hooks, Windows events ... And, for each of these actions, you need to read a certificate, figure out a way, decide on structures, types, apishkami. <br><br>  For editing the script and quick launch, I used <a href="http://www.autoitscript.com/site/autoit-script-editor/">SciTE-Lite</a> , which includes Highlighting, CodeFolding, Autocomplete, Intellisense, and also SyntaxCheck.  Built-in help for the language as a gift.  Standard fishhechki. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  Hotkeys </h5><br>  In every script that works with your desktop <strike>and is able to take control over it</strike> , I advise you to use a couple of shortcut handlers. <br><br><pre><code class="vbscript hljs">$paused = <span class="hljs-literal"><span class="hljs-literal">false</span></span> HotKeySet(<span class="hljs-string"><span class="hljs-string">"{F11}"</span></span>, <span class="hljs-string"><span class="hljs-string">"Pause"</span></span>) HotKeySet(<span class="hljs-string"><span class="hljs-string">"{F10}"</span></span>, <span class="hljs-string"><span class="hljs-string">"Kill"</span></span>) Func Pause() $Paused = <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> $Paused <span class="hljs-keyword"><span class="hljs-keyword">While</span></span> $Paused Sleep(<span class="hljs-number"><span class="hljs-number">100</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">WEnd</span></span> EndFunc Func Kill() FileClose($hfile) <span class="hljs-keyword"><span class="hljs-keyword">Exit</span></span> EndFunc</code> </pre> <br>  Otherwise, you risk falling into an observer state without the ability to control your system.  Judgment Day. <br><br>  I note that the <b>F12</b> and some other buttons handler can not be hung.  For some time I could not understand why he was not called. <br><br><h5>  Getting the coordinates </h5><br>  Let me remind you that in the addon we put floating-point numbers into the color components of the pixels, and they come to us in the form of whole bytes: <br><br><pre> <code class="vbscript hljs">#include &lt;Color.au3&gt; Opt(<span class="hljs-string"><span class="hljs-string">"PixelCoordMode"</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>) ;          Opt(<span class="hljs-string"><span class="hljs-string">"MouseCoordMode"</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>) ;          $WinName = <span class="hljs-string"><span class="hljs-string">"World of Warcraft"</span></span> $hwnd = WinGetHandle($WinName) Func GetPitch() $pixel2 = _ColorGetRGB(PixelGetColor(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, $hwnd)); Return ($pixel2[<span class="hljs-number"><span class="hljs-number">2</span></span>]/<span class="hljs-number"><span class="hljs-number">255.0</span></span><span class="hljs-number"><span class="hljs-number">-0.5</span></span>)*<span class="hljs-number"><span class="hljs-number">4</span></span> EndFunc Func GetPos() $pixel1 = _ColorGetRGB(PixelGetColor(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, $hwnd)); $pixel2 = _ColorGetRGB(PixelGetColor(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, $hwnd)); $result[<span class="hljs-number"><span class="hljs-number">3</span></span>] = [ ($pixel1[<span class="hljs-number"><span class="hljs-number">0</span></span>]+$pixel1[<span class="hljs-number"><span class="hljs-number">1</span></span>]/<span class="hljs-number"><span class="hljs-number">255.0</span></span>)/<span class="hljs-number"><span class="hljs-number">255</span></span>*<span class="hljs-number"><span class="hljs-number">100</span></span>, ($pixel2[<span class="hljs-number"><span class="hljs-number">0</span></span>]+$pixel2[<span class="hljs-number"><span class="hljs-number">1</span></span>]/<span class="hljs-number"><span class="hljs-number">255.0</span></span>)/<span class="hljs-number"><span class="hljs-number">255</span></span>*<span class="hljs-number"><span class="hljs-number">100</span></span>, $pixel1[<span class="hljs-number"><span class="hljs-number">2</span></span>]*<span class="hljs-number"><span class="hljs-number">7.0</span></span>/<span class="hljs-number"><span class="hljs-number">255</span></span> ] return $result EndFunc</code> </pre><br>  By counting the data, we perform inverse transformations with them.  Functions return arrays and arrays are written to variables completely transparent to the programmer. <br><br><h5>  Key logging </h5><br>  I read somewhere that the author of the <b>AutoIt</b> language did not want such a simple and powerful language to be used by attackers to write malware.  Therefore, he removed the ability to create a click handler for all keys at once, so that at least <a href="http://ru.wikipedia.org/wiki/Keylogger"><b>Keylogger's</b></a> would not rivet. <br><br>  What can I say.  <b>AutoIt is</b> very <a href="http://www.securelist.com/ru/analysis/208050579/Razvitie_informatsionnykh_ugroz_v_tretem_kvartale_2009_goda">actively used</a> to write malware, and we will do the following to intercept key presses: <br><br><pre> <code class="vbscript hljs">local $keys = StringSplit(<span class="hljs-string"><span class="hljs-string">"` [ ] 1 2 3 4 5 6 7 8 9 0 !1 !2 !3 !4 !5 !6 !7 !8 !9 !0 +1 +2 +3 +4 +5 +6 +7 +8 +9 +0 +f {SPACE} {TAB} {ESC} {PAUSE} {DELETE} {BACKSPACE}"</span></span>, <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> $i = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-built_in"><span class="hljs-built_in">UBound</span></span>($keys)<span class="hljs-number"><span class="hljs-number">-1</span></span> HotKeySet($keys[$i], <span class="hljs-string"><span class="hljs-string">"OnHotKey"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> Func OnHotKey() ;ToolTip(@HotKeyPressed) HotKeySet(@HotKeyPressed) Send(@HotKeyPressed) HotKeySet(@HotKeyPressed, <span class="hljs-string"><span class="hljs-string">"OnHotKey"</span></span>) Switch @HotKeyPressed <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> <span class="hljs-string"><span class="hljs-string">"["</span></span> FileWriteLine($hfile, <span class="hljs-string"><span class="hljs-string">"mouse left "</span></span> &amp; MouseGetPos(<span class="hljs-number"><span class="hljs-number">0</span></span>) &amp; <span class="hljs-string"><span class="hljs-string">" "</span></span> &amp; MouseGetPos(<span class="hljs-number"><span class="hljs-number">1</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> <span class="hljs-string"><span class="hljs-string">"]"</span></span> FileWriteLine($hfile, <span class="hljs-string"><span class="hljs-string">"mouse right "</span></span> &amp; MouseGetPos(<span class="hljs-number"><span class="hljs-number">0</span></span>) &amp; <span class="hljs-string"><span class="hljs-string">" "</span></span> &amp; MouseGetPos(<span class="hljs-number"><span class="hljs-number">1</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> <span class="hljs-string"><span class="hljs-string">"{PAUSE}"</span></span> FileWriteLine($hfile, <span class="hljs-string"><span class="hljs-string">"pause 1000"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> <span class="hljs-string"><span class="hljs-string">"{BACKSPACE}"</span></span> FileWriteLine($hfile, StringFormat(<span class="hljs-string"><span class="hljs-string">"pitch %.2f"</span></span>, GetPitch())) <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Else</span></span> FileWriteLine($hfile, <span class="hljs-string"><span class="hljs-string">"key "</span></span> &amp; @HotKeyPressed) EndSwitch EndFunc</code> </pre><br>  Thus, we don‚Äôt need to invent our own key names to save them to a file, it‚Äôs enough to use <a href="http://www.autoitscript.com/autoit3/docs/appendix/SendKeys.htm">AutoIT</a> <br><br>  If we need to intercept something else (and during the game we know in advance that we will crush and what spells to use), we simply add them to the long list at the beginning. <br><br>  Having intercepted a keystroke, we need to send it further to the application, for this we temporarily remove our handler <br><br><pre> <code class="vbscript hljs">HotKeySet(@HotKeyPressed) Send(@HotKeyPressed) HotKeySet(@HotKeyPressed, <span class="hljs-string"><span class="hljs-string">"OnHotKey"</span></span>)</code> </pre><br>  This approach is recommended in the help, but in practice, when you click on a combination with <b>Alt</b> and others, it is noticeably buggy.  I did not understand, but simply avoided the use of such combinations. <br><br><h5>  Mouse logging </h5><br>  In <b>AutoIt</b> there <b>is</b> no regular way to intercept mouse clicks.  There is a third-party module with <a href="http://www.autoitscript.com/forum/topic/64738-mouseonevent-udf/">an example of use</a> .  Or you can hang your <b>SetWindowsHookEx (WH_MOUSE_LL)</b> .  Cognitive example of using <b>WinAPI Callback-</b> functions on <b>AutoIt</b> <a href="http://www.autoitscript.com/forum/topic/81761-callback-low-level-mouse-hook/">here</a> .  But I did not use this approach for two reasons: <br><ol><li>  The movement of the character is associated with a large number of mouse clicks that do not need to be logged.  Plus, random clicks are possible.  I would have to write logic on the separation of flies from cutlets. </li><li>  Using Hooks increases the chances of attracting the attention of "special services" to you.  More on this in the section "Counter-bots". </li></ol><br>  Therefore, as you have already noticed, I just used the " <b>[</b> " and " <b>]</b> " buttons and pressed them as needed.  The main thing is not to forget to press them. <br><br><h5>  Coordinate recording </h5><br>  And, of course, our <b>Recorder</b> should record the movement of the character in the background. <br><br><pre> <code class="vbscript hljs">$hfile = FileOpen(<span class="hljs-string"><span class="hljs-string">"output.txt"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) $prev = <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">While</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span> WinWaitActive($hwnd) local $pos = GetPos() $command = StringFormat(<span class="hljs-string"><span class="hljs-string">"move %.3f %.3f %.3f"</span></span>, $pos[<span class="hljs-number"><span class="hljs-number">0</span></span>], $pos[<span class="hljs-number"><span class="hljs-number">1</span></span>], $pos[<span class="hljs-number"><span class="hljs-number">2</span></span>]); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> $pos[<span class="hljs-number"><span class="hljs-number">0</span></span>] + $pos[<span class="hljs-number"><span class="hljs-number">1</span></span>] &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">And</span></span> $command &lt;&gt; $prev <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> FileWriteLine($hfile, $command) EndIf $prev = $command Sleep(<span class="hljs-number"><span class="hljs-number">100</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">WEnd</span></span></code> </pre><br>  You may ask, why write coordinates so often (10 times per second)?  The fact is that on our route there are piled up obstacles: boxes, corners, doorways, lampposts, <s>rakes</s> .  And the character just ‚Äúmagnet‚Äù to them.  If somewhere, running past, he can get stuck, he will definitely do it.  Even if you are running in a straight line for a long time, remember that the azimuth of motion was not perfectly set, therefore, perhaps you have been running for a long time, resting your forehead against the wall. <br><div class="spoiler">  <b class="spoiler_title">Full source code for the Recorder</b> <div class="spoiler_text"><pre> <code class="vbscript hljs">#include &lt;Color.au3&gt; Global $WinName = <span class="hljs-string"><span class="hljs-string">"World of Warcraft"</span></span> Opt(<span class="hljs-string"><span class="hljs-string">"PixelCoordMode"</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>) ;          Opt(<span class="hljs-string"><span class="hljs-string">"MouseCoordMode"</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>) ;          $paused = <span class="hljs-literal"><span class="hljs-literal">false</span></span> HotKeySet(<span class="hljs-string"><span class="hljs-string">"{F11}"</span></span>, <span class="hljs-string"><span class="hljs-string">"Pause"</span></span>) HotKeySet(<span class="hljs-string"><span class="hljs-string">"{F10}"</span></span>, <span class="hljs-string"><span class="hljs-string">"Kill"</span></span>) local $keys = StringSplit(<span class="hljs-string"><span class="hljs-string">"` [ ] 1 2 3 4 5 6 7 8 9 0 !1 !2 !3 !4 !5 !6 !7 !8 !9 !0 +1 +2 +3 +4 +5 +6 +7 +8 +9 +0 +f {SPACE} {TAB} {ESC} {PAUSE} {DELETE} {BACKSPACE}"</span></span>, <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> $i = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> <span class="hljs-built_in"><span class="hljs-built_in">UBound</span></span>($keys)<span class="hljs-number"><span class="hljs-number">-1</span></span> HotKeySet($keys[$i], <span class="hljs-string"><span class="hljs-string">"OnHotKey"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> $hwnd = WinGetHandle($WinName) $hfile = FileOpen(<span class="hljs-string"><span class="hljs-string">"output.txt"</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) $prev = <span class="hljs-string"><span class="hljs-string">""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">While</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span> WinWaitActive($hwnd) local $pos = GetPos() $command = StringFormat(<span class="hljs-string"><span class="hljs-string">"move %.3f %.3f %.3f"</span></span>, $pos[<span class="hljs-number"><span class="hljs-number">0</span></span>], $pos[<span class="hljs-number"><span class="hljs-number">1</span></span>], $pos[<span class="hljs-number"><span class="hljs-number">2</span></span>]); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> $pos[<span class="hljs-number"><span class="hljs-number">0</span></span>] + $pos[<span class="hljs-number"><span class="hljs-number">1</span></span>] &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">And</span></span> $command &lt;&gt; $prev <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> FileWriteLine($hfile, $command) EndIf $prev = $command Sleep(<span class="hljs-number"><span class="hljs-number">100</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">WEnd</span></span> Func Pause() $Paused = <span class="hljs-keyword"><span class="hljs-keyword">NOT</span></span> $Paused <span class="hljs-keyword"><span class="hljs-keyword">While</span></span> $Paused Sleep(<span class="hljs-number"><span class="hljs-number">100</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">WEnd</span></span> EndFunc Func Kill() FileClose($hfile) <span class="hljs-keyword"><span class="hljs-keyword">Exit</span></span> EndFunc Func GetPitch() $pixel2 = _ColorGetRGB(PixelGetColor(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, $hwnd)); Return ($pixel2[<span class="hljs-number"><span class="hljs-number">2</span></span>]/<span class="hljs-number"><span class="hljs-number">255.0</span></span><span class="hljs-number"><span class="hljs-number">-0.5</span></span>)*<span class="hljs-number"><span class="hljs-number">4</span></span> EndFunc Func GetPos() $pixel1 = _ColorGetRGB(PixelGetColor(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, $hwnd)); $pixel2 = _ColorGetRGB(PixelGetColor(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, $hwnd)); local $result[<span class="hljs-number"><span class="hljs-number">3</span></span>] = [ ($pixel1[<span class="hljs-number"><span class="hljs-number">0</span></span>]+$pixel1[<span class="hljs-number"><span class="hljs-number">1</span></span>]/<span class="hljs-number"><span class="hljs-number">255.0</span></span>)/<span class="hljs-number"><span class="hljs-number">255</span></span>*<span class="hljs-number"><span class="hljs-number">100</span></span>, ($pixel2[<span class="hljs-number"><span class="hljs-number">0</span></span>]+$pixel2[<span class="hljs-number"><span class="hljs-number">1</span></span>]/<span class="hljs-number"><span class="hljs-number">255.0</span></span>)/<span class="hljs-number"><span class="hljs-number">255</span></span>*<span class="hljs-number"><span class="hljs-number">100</span></span>, $pixel1[<span class="hljs-number"><span class="hljs-number">2</span></span>]*<span class="hljs-number"><span class="hljs-number">7.0</span></span>/<span class="hljs-number"><span class="hljs-number">255</span></span> ] return $result EndFunc Func OnHotKey() ;ToolTip(@HotKeyPressed) HotKeySet(@HotKeyPressed) Send(@HotKeyPressed) HotKeySet(@HotKeyPressed, <span class="hljs-string"><span class="hljs-string">"OnHotKey"</span></span>) Switch @HotKeyPressed <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> <span class="hljs-string"><span class="hljs-string">"["</span></span> FileWriteLine($hfile, <span class="hljs-string"><span class="hljs-string">"mouse left "</span></span> &amp; MouseGetPos(<span class="hljs-number"><span class="hljs-number">0</span></span>) &amp; <span class="hljs-string"><span class="hljs-string">" "</span></span> &amp; MouseGetPos(<span class="hljs-number"><span class="hljs-number">1</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> <span class="hljs-string"><span class="hljs-string">"]"</span></span> FileWriteLine($hfile, <span class="hljs-string"><span class="hljs-string">"mouse right "</span></span> &amp; MouseGetPos(<span class="hljs-number"><span class="hljs-number">0</span></span>) &amp; <span class="hljs-string"><span class="hljs-string">" "</span></span> &amp; MouseGetPos(<span class="hljs-number"><span class="hljs-number">1</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> <span class="hljs-string"><span class="hljs-string">"{PAUSE}"</span></span> FileWriteLine($hfile, <span class="hljs-string"><span class="hljs-string">"pause 1000"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> <span class="hljs-string"><span class="hljs-string">"{BACKSPACE}"</span></span> FileWriteLine($hfile, StringFormat(<span class="hljs-string"><span class="hljs-string">"pitch %.2f"</span></span>, GetPitch())) <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Else</span></span> FileWriteLine($hfile, <span class="hljs-string"><span class="hljs-string">"key "</span></span> &amp; @HotKeyPressed) EndSwitch EndFunc</code> </pre><br></div></div><br><br><h5>  Au3record </h5><br>  Along with <b>SciTE4AutoIt3</b> comes <i>AutoIt3 \ Extras \ Au3Record \ Au3Record.exe</i> , which allows you to record your actions with the desktop and executes it immediately in the form of an <b>AutoIt</b> script.  If you have to perform a series of automatic actions many times without having to think (for example, when installing software or patches on a large fleet of computers), take a closer look at this tool. <br><br><h4>  Player </h4><br>  Let me remind you that the result of the work of <b>Recorder</b> 'a, described in the previous chapter, is a set of commands <br><br><pre>  mouse left 1892 1021
 pause 10,000
 pitch -0.89
 mouse right 942 498
 pause 10,000
 move 83.72 50.03 0.604
 key `
 pause 1000
 key {SPACE}
 pitch -0.1
 move 83.777 50.207 1.235
 move 83.777 50.207 2.114
 move 83.777 50.207 2.827
 move 83.777 50.207 2.855
 move 83.754 50.327 2.855 </pre><br>  At first glance, it seems that ‚Äúlosing‚Äù them is not difficult, but let's take a closer look at this process. <br><br><h5>  Rotate and tilt </h5><br>  Turning and tilting by pressing the buttons gives an accuracy of about 30 degrees, which is unacceptable for our task.  Therefore, we will use the second possibility for this: mouse movement with the right button held down.  The algorithm is as follows: <br><ol><li>  Hold the right mouse button </li><li>  The game itself will place the cursor on the center of the screen and will hold it there.  This will allow the user not to end up with the cursor on the edge of the screen when turning. </li><li>  Shift the cursor to the left or right by a certain number of pixels. </li><li>  The direction of the character is shifted to the left or right.  Moreover, the faster you move the cursor, the faster the character turns </li></ol><br>  How is it easier for us to determine in which direction it is more profitable to turn if we have two angles: the current and the required? <br><img src="https://habrastorage.org/storage2/cbc/ae5/d42/cbcae5d42f62af52e64ee84cfddc6c3e.png"><br>  You can look at the difference in angles, if it is positive - to the right.  But consider the case: the current angle is 30 degrees, the required angle is 330 degrees.  The difference is negative, but we still right.  And the angles can be negative.  To avoid having to write out all these conditions, just use the sine of the difference of angles and look only at its sign. <br><br>  The variables <b>$ want</b> and <b>$ current</b> contain <b>(x, y, azimuth)</b> <br><br><pre> <code class="vbscript hljs">Func Turn($want) <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span> $current = GetPos() $<span class="hljs-built_in"><span class="hljs-built_in">sin</span></span> = <span class="hljs-built_in"><span class="hljs-built_in">sin</span></span>($current[<span class="hljs-number"><span class="hljs-number">2</span></span>] - $want[<span class="hljs-number"><span class="hljs-number">2</span></span>]) ;ToolTip(StringFormat(<span class="hljs-string"><span class="hljs-string">"(%.2f,%.2f,%.2f) to (%.2f,%.2f,%.2f)"</span></span>, $current[<span class="hljs-number"><span class="hljs-number">0</span></span>], $current[<span class="hljs-number"><span class="hljs-number">1</span></span>], $<span class="hljs-built_in"><span class="hljs-built_in">sin</span></span>, $want[<span class="hljs-number"><span class="hljs-number">0</span></span>], $want[<span class="hljs-number"><span class="hljs-number">1</span></span>], $want[<span class="hljs-number"><span class="hljs-number">2</span></span>])) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>($<span class="hljs-built_in"><span class="hljs-built_in">sin</span></span>) &lt; <span class="hljs-number"><span class="hljs-number">0.05</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> return MouseMove(MouseGetPos(<span class="hljs-number"><span class="hljs-number">0</span></span>)+<span class="hljs-number"><span class="hljs-number">50</span></span>*$<span class="hljs-built_in"><span class="hljs-built_in">sin</span></span>, MouseGetPos(<span class="hljs-number"><span class="hljs-number">1</span></span>), <span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">wend</span></span> EndFunc</code> </pre><br>  Sine also allows us to adjust the speed of rotation.  The smaller the angle, the more accurately our cursor will move and the more accurately we will turn.  Conversely, at large angles, we want to turn quickly. <br><br>  The function of changing the slope to the horizon is completely analogous, only the cursor must be shifted vertically. <br><br>  In the example code, there is a logical error that can lead to incorrect behavior of the bot.  I suggest that the curious reader find it himself. <br><br><h5>  Motion </h5><br>  The following requirements are imposed on the movement <br><ol><li>  Positioning accuracy is low.  You can not stand exactly where you want </li><li>  It is necessary to move without turning around.  Of the available movements, there is only running forward, steps backward and strafe (moving sideways without turning) </li><li>  The movement should be continuous, without stopping and jerking </li><li>  As few as possible returns and changes of direction.  It is unpleasant to look at the monitor, if the character ran a little, then backed away, then ran again, and so on </li></ol><br><br><h5>  Forward or backward? </h5><br>  If you don‚Äôt like math or finished school a long time ago, you can skip this section without compromising understanding.  But there is nothing particularly difficult here.  Let the character stand on <b>(a <sub>x</sub> , a <sub>y</sub> )</b> and look at an angle <a href="http://www.codecogs.com/eqnedit.php%3Flatex%3D%5Calpha"><img src="http://habrastorage.org/getpro/habr/post_images/afa/be9/d80/afabe9d808e93fbe09b29977a6800dc7.gif" title="\ alpha"></a>  and he needs to get into <b>(b <sub>x</sub> , b <sub>y</sub> )</b> , should he run forward or backward?  To begin with, let's rephrase the task: let the character stand at <b>(0, 0)</b> , look at <a href="http://www.codecogs.com/eqnedit.php%3Flatex%3D(cos%5Calpha,sin%5Calpha)"><img src="http://1450827988889886525885" title="(cos \ alpha, sin \ alpha)"></a>  , and he needs in <b>(d <sub>x</sub> , d <sub>y</sub> )</b> . <br><img src="http://habrastorage.org/storage2/3ae/1ec/e0f/3ae1ece0f14436a608e435652af60432.png"><br>  If you solve the problem in the forehead, then it would be necessary to calculate the cosine of the angle between the vectors.  If it is positive, then the angle is sharp and run forward.  If negative - stupid, you have to back up.  Cosine can be calculated by <a href="http://ru.wikipedia.org/wiki/%25D0%25A2%25D0%25B5%25D0%25BE%25D1%2580%25D0%25B5%25D0%25BC%25D0%25B0_%25D0%25BA%25D0%25BE%25D1%2581%25D0%25B8%25D0%25BD%25D1%2583%25D1%2581%25D0%25BE%25D0%25B2">the cosine theorem</a> <br> <a href="http://www.codecogs.com/eqnedit.php%3Flatex%3Da%5E2%3Db%5E2%26plus%3Bc%5E2-2bc%5Ccdot%26space%3Bcos%5Ctheta"><img src="http://habrastorage.org/getpro/habr/post_images/550/9af/e98/5509afe98797a4769ee0eae7e5dc1bc8.gif" title="a ^ 2 = b ^ 2 + c ^ 2-2bc \ cdot cos \ theta"></a> <br>  But for this we have to calculate the length of each of the vectors, extract the roots, very cumbersome. <br><br>  There is also a <a href="http://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25BA%25D0%25B0%25D0%25BB%25D1%258F%25D1%2580%25D0%25BD%25D0%25BE%25D0%25B5_%25D0%25BF%25D1%2580%25D0%25BE%25D0%25B8%25D0%25B7%25D0%25B2%25D0%25B5%25D0%25B4%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5">scalar product</a> formula <br> <a href="http://www.codecogs.com/eqnedit.php%3Flatex%3D%5Clangle%26space%3Ba,b%5Crangle%3D%7Ca%7C%7Cb%7Ccos%5Ctheta"><img src="http://habrastorage.org/getpro/habr/post_images/450/2a2/5bd/4502a25bd2bb5ef17463b3895de1b2c8.gif" title="\ langle a, b \ rangle = | a || b | cos \ theta"></a> <br>  Which, <a href="http://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25BA%25D0%25B0%25D0%25BB%25D1%258F%25D1%2580%25D0%25BD%25D0%25BE%25D0%25B5_%25D0%25BF%25D1%2580%25D0%25BE%25D0%25B8%25D0%25B7%25D0%25B2%25D0%25B5%25D0%25B4%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5">as is known</a> , in the Cartesian coordinate system can be calculated by the formula <br> <a href="http://www.codecogs.com/eqnedit.php%3Flatex%3D%5Clangle%26space%3Ba,b%5Crangle%3Da_%7Bx%7Db_%7Bx%7D%26plus%3Ba_%7By%7Db_%7By%7D"><img src="http://habrastorage.org/getpro/habr/post_images/3e8/66a/9c5/3e866a9c5eca1fdc853e46c9bb6536d7.gif" title="\ langle a, b \ rangle = a_ {x} b_ {x} + a_ {y} b_ {y}"></a> <br>  Thus, by calculating the scalar product and looking at its sign, we can determine whether we run forward or backward.  And in our case, we will calculate it by the formula <a href="http://www.codecogs.com/eqnedit.php%3Flatex%3Dcos%5Calpha*d_x%26space%3B%26plus%3Bsin%5Calpha*d_y"><img src="http://habrastorage.org/getpro/habr/post_images/a2e/8b7/272/a2e8b727299867dbf8b23aad09439fa8.gif" title="cos \ alpha * d_x + sin \ alpha * d_y"></a>  .  Moreover, this same scalar product shows us exactly how much it is necessary to run forward or backward in its <a href="http://ru.wikipedia.org/wiki/%25D0%25A1%25D0%25BA%25D0%25B0%25D0%25BB%25D1%258F%25D1%2580%25D0%25BD%25D0%25BE%25D0%25B5_%25D0%25BF%25D1%2580%25D0%25BE%25D0%25B8%25D0%25B7%25D0%25B2%25D0%25B5%25D0%25B4%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5">geometrical definition</a> (the projection of one vector onto another multiplied by the length of the second). <br><img src="http://habrastorage.org/getpro/habr/post_images/d42/fb3/e99/d42fb3e9914b179707d290ae79e67c33.png" alt="image"><br><br><h5>  Left or right? </h5><br>  Similarly, the sine of the angle between the gaze vectors <a href="http://www.codecogs.com/eqnedit.php%3Flatex%3D(cos%5Calpha,sin%5Calpha)"><img src="http://1450827988889886525885" title="(cos \ alpha, sin \ alpha)"></a>  and the direction to the target <b>(d <sub>x</sub> , d <sub>y</sub> )</b> determines which side to go.  If positive, target on the right hand, and vice versa.  Here the <a href="http://ru.wikipedia.org/wiki/%25D0%2592%25D0%25B5%25D0%25BA%25D1%2582%25D0%25BE%25D1%2580%25D0%25BD%25D0%25BE%25D0%25B5_%25D0%25BF%25D1%2580%25D0%25BE%25D0%25B8%25D0%25B7%25D0%25B2%25D0%25B5%25D0%25B4%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5">vector product</a> will help us, and to be more precise, the <a href="http://ru.wikipedia.org/wiki/%25D0%259F%25D1%2581%25D0%25B5%25D0%25B2%25D0%25B4%25D0%25BE%25D1%2581%25D0%25BA%25D0%25B0%25D0%25BB%25D1%258F%25D1%2580%25D0%25BD%25D0%25BE%25D0%25B5_%25D0%25BF%25D1%2580%25D0%25BE%25D0%25B8%25D0%25B7%25D0%25B2%25D0%25B5%25D0%25B4%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5">pseudoscalar product</a> , calculated in Cartesian coordinates by the formula <br> <a href="http://www.codecogs.com/eqnedit.php%3Flatex%3Da%5CLambda%26space%3Bb%3D%7Ca%7C%7Cb%7Csin%5Ctheta%3Da_x%26space%3Bb_y-a_y%26space%3Bb_x"><img src="http://habrastorage.org/getpro/habr/post_images/5ab/88d/eaa/5ab88deaa42ff6fd92ab52e0e5f39a9e.gif" title="a \ Lambda b = | a || b | sin \ theta = a_x b_y-a_y b_x"></a> <br>  Again, the value of this number determines how many steps to take sideways. <br><br><h5>  Implementation </h5><br>  Let's program our reasoning. <br><br><pre> <code class="vbscript hljs">Func ScalarMult($a, $b, $x, $y) return $a*$x + $b*$y EndFunc Func VectorMult($a, $b, $x, $y) return $a*$y - $b*$x EndFunc Func GetDirection($x, $y, $wx, $wy, $angle) $dx = $x - $wx $dy = $y - $wy local $result[<span class="hljs-number"><span class="hljs-number">2</span></span>] = [ ScalarMult(-<span class="hljs-built_in"><span class="hljs-built_in">sin</span></span>($angle), -<span class="hljs-built_in"><span class="hljs-built_in">cos</span></span>($angle), $dx, $dy), VectorMult(-<span class="hljs-built_in"><span class="hljs-built_in">sin</span></span>($angle), -<span class="hljs-built_in"><span class="hljs-built_in">cos</span></span>($angle), $dx, $dy) ] Return $result EndFunc</code> </pre><br>  Do not be confused by the fact that in the program the sine and cosine are swapped and taken with the opposite sign.  Just in WoW the azimuth is counted from the north counterclockwise.  These details can simply be ‚Äútried‚Äù in a real program.  And, if it happened the other way around, play around with the signs. <br><br>  The <b>GetDirection ()</b> function returns an array of two values: how much to go forward / backward, how much to go sideways. <br><br><h5>  This is a twist! </h5><br>  Some readers may exclaim: ‚ÄúWhy, these multiplications by sine-cosines are nothing more than an ordinary <a href="http://ru.wikipedia.org/wiki/%25D0%259C%25D0%25B0%25D1%2582%25D1%2580%25D0%25B8%25D1%2586%25D0%25B0_%25D0%25BF%25D0%25BE%25D0%25B2%25D0%25BE%25D1%2580%25D0%25BE%25D1%2582%25D0%25B0">rotation of the coordinate system</a> , <br><img src="http://habrastorage.org/storage2/c27/741/0c2/c277410c20a18c528f8c512c7df61788.gif"><br>  described <br><img src="http://habrastorage.org/getpro/habr/post_images/ea6/600/9d1/ea66009d156eb28245603fdd9ab32fd5.png" alt="image"><br>  Why fool us heads. ‚Äù <br><br>  True, but then it would be more difficult for me to explain why this is the matrix. <br><br><h5>  Stop </h5><br>  Now we are ready to push the running buttons <br><br><pre> <code class="vbscript hljs">Func Move($want) <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span> StartMoving() local $pos = GetPos() local $dir = GetDirection($pos[<span class="hljs-number"><span class="hljs-number">0</span></span>], $pos[<span class="hljs-number"><span class="hljs-number">1</span></span>], $want[<span class="hljs-number"><span class="hljs-number">0</span></span>], $want[<span class="hljs-number"><span class="hljs-number">1</span></span>], $pos[<span class="hljs-number"><span class="hljs-number">2</span></span>]) ;ToolTip(StringFormat(<span class="hljs-string"><span class="hljs-string">"(%.2f,%.2f,%.2f) to (%.2f,%.2f, %.2f): (%.2f,%.2f)"</span></span>, $pos[<span class="hljs-number"><span class="hljs-number">0</span></span>], $pos[<span class="hljs-number"><span class="hljs-number">1</span></span>], $pos[<span class="hljs-number"><span class="hljs-number">2</span></span>], $want[<span class="hljs-number"><span class="hljs-number">0</span></span>], $want[<span class="hljs-number"><span class="hljs-number">1</span></span>], $want[<span class="hljs-number"><span class="hljs-number">2</span></span>], $dir[<span class="hljs-number"><span class="hljs-number">0</span></span>], $dir[<span class="hljs-number"><span class="hljs-number">1</span></span>])) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>($dir[<span class="hljs-number"><span class="hljs-number">0</span></span>]) &lt; <span class="hljs-number"><span class="hljs-number">0.1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">And</span></span> <span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>($dir[<span class="hljs-number"><span class="hljs-number">1</span></span>]) &lt; <span class="hljs-number"><span class="hljs-number">0.1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> ExitLoop <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>($dir[<span class="hljs-number"><span class="hljs-number">0</span></span>]) &gt;= <span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>($dir[<span class="hljs-number"><span class="hljs-number">1</span></span>]) <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> Send(<span class="hljs-string"><span class="hljs-string">"{a up}{d up}"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> $dir[<span class="hljs-number"><span class="hljs-number">0</span></span>] &lt;=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> Send(<span class="hljs-string"><span class="hljs-string">"{w down}{s up}"</span></span>) ; forward <span class="hljs-keyword"><span class="hljs-keyword">Else</span></span> Send(<span class="hljs-string"><span class="hljs-string">"{s down}{w up}"</span></span>) ; backward EndIf <span class="hljs-keyword"><span class="hljs-keyword">Else</span></span> Send(<span class="hljs-string"><span class="hljs-string">"{s up}"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> $dir[<span class="hljs-number"><span class="hljs-number">1</span></span>] &lt; <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> Send(<span class="hljs-string"><span class="hljs-string">"{d down}{a up}"</span></span>) ; <span class="hljs-built_in"><span class="hljs-built_in">right</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Else</span></span> Send(<span class="hljs-string"><span class="hljs-string">"{a down}{d up}"</span></span>) ; <span class="hljs-built_in"><span class="hljs-built_in">left</span></span> EndIf EndIf <span class="hljs-keyword"><span class="hljs-keyword">wend</span></span> Send(<span class="hljs-string"><span class="hljs-string">"{s up}{a up}{d up}"</span></span>) EndFunc</code> </pre><br>  Pay attention, we go in the direction in which to go the furthest, and finish the way when we are almost at the goal.  This allows the character not to flicker.  The forward button does not release when the destination is reached.  Therefore, we need to turn to the required angle relatively quickly. <br><br>  The code responsible for playing the command files is not anything interesting, and if you wish, you can familiarize yourself with it. <br><div class="spoiler">  <b class="spoiler_title">Full source code for Player</b> <div class="spoiler_text"><pre> <code class="vbscript hljs">#include &lt;Color.au3&gt; Global $WinName = <span class="hljs-string"><span class="hljs-string">"World of Warcraft"</span></span> Opt(<span class="hljs-string"><span class="hljs-string">"PixelCoordMode"</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>) ;          Opt(<span class="hljs-string"><span class="hljs-string">"MouseCoordMode"</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>) ;          $paused = <span class="hljs-literal"><span class="hljs-literal">false</span></span> $moving = <span class="hljs-literal"><span class="hljs-literal">false</span></span> HotKeySet(<span class="hljs-string"><span class="hljs-string">"{F11}"</span></span>, <span class="hljs-string"><span class="hljs-string">"Pause"</span></span>) HotKeySet(<span class="hljs-string"><span class="hljs-string">"{F10}"</span></span>, <span class="hljs-string"><span class="hljs-string">"Kill"</span></span>) ;WinActivate($WinName) $hwnd = WinGetHandle($WinName) WinWaitActive($hwnd) PlayFile(<span class="hljs-string"><span class="hljs-string">"outdoor.txt"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) PlayFile(<span class="hljs-string"><span class="hljs-string">"indoor.txt"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) PlayFile(<span class="hljs-string"><span class="hljs-string">"outdoor.txt"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) PlayFile(<span class="hljs-string"><span class="hljs-string">"indoor.txt"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) PlayFile(<span class="hljs-string"><span class="hljs-string">"outdoor.txt"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) PlayFile(<span class="hljs-string"><span class="hljs-string">"indoor.txt"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) PlayFile(<span class="hljs-string"><span class="hljs-string">"outdoor.txt"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) PlayFile(<span class="hljs-string"><span class="hljs-string">"indoor.txt"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) PlayFile(<span class="hljs-string"><span class="hljs-string">"outdoor.txt"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) PlayFile(<span class="hljs-string"><span class="hljs-string">"indoor.txt"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) Func PlayLine($line) local $command = StringSplit($line, <span class="hljs-string"><span class="hljs-string">" "</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>) ;ToolTip(StringFormat(<span class="hljs-string"><span class="hljs-string">"%s %s %s"</span></span>, $command[<span class="hljs-number"><span class="hljs-number">0</span></span>], $command[<span class="hljs-number"><span class="hljs-number">1</span></span>], $command[<span class="hljs-number"><span class="hljs-number">2</span></span>])) Switch $command[<span class="hljs-number"><span class="hljs-number">0</span></span>] <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> <span class="hljs-string"><span class="hljs-string">"move"</span></span> local $want[<span class="hljs-number"><span class="hljs-number">3</span></span>] = [ number($command[<span class="hljs-number"><span class="hljs-number">1</span></span>]), number($command[<span class="hljs-number"><span class="hljs-number">2</span></span>]), number($command[<span class="hljs-number"><span class="hljs-number">3</span></span>]) ] Move($want) Turn($want) <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> <span class="hljs-string"><span class="hljs-string">"pause"</span></span> StopMoving() Sleep($command[<span class="hljs-number"><span class="hljs-number">1</span></span>]) <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> <span class="hljs-string"><span class="hljs-string">"key"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> $command[<span class="hljs-number"><span class="hljs-number">1</span></span>] = <span class="hljs-string"><span class="hljs-string">"{SPACE}"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> Send(<span class="hljs-string"><span class="hljs-string">"{SPACE down}"</span></span>) Sleep(<span class="hljs-number"><span class="hljs-number">300</span></span>) Send(<span class="hljs-string"><span class="hljs-string">"{SPACE up}"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Else</span></span> StopMoving() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-built_in"><span class="hljs-built_in">UBound</span></span>($command) &gt; <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> Send($command[<span class="hljs-number"><span class="hljs-number">1</span></span>] &amp; <span class="hljs-string"><span class="hljs-string">" "</span></span> &amp; $command[<span class="hljs-number"><span class="hljs-number">2</span></span>]) <span class="hljs-keyword"><span class="hljs-keyword">Else</span></span> Send($command[<span class="hljs-number"><span class="hljs-number">1</span></span>]) EndIf Sleep(<span class="hljs-number"><span class="hljs-number">1500</span></span>) EndIf <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> <span class="hljs-string"><span class="hljs-string">"mouse"</span></span> StopMoving() MouseClick($command[<span class="hljs-number"><span class="hljs-number">1</span></span>], $command[<span class="hljs-number"><span class="hljs-number">2</span></span>], $command[<span class="hljs-number"><span class="hljs-number">3</span></span>]) Sleep(<span class="hljs-number"><span class="hljs-number">500</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">Case</span></span> <span class="hljs-string"><span class="hljs-string">"pitch"</span></span> SetPitch($command[<span class="hljs-number"><span class="hljs-number">1</span></span>]) EndSwitch EndFunc Func PlayFile($filename, $skip = <span class="hljs-number"><span class="hljs-number">0</span></span>) $hfile = FileOpen($filename, <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> $i = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> $skip $line = FileReadLine($hfile) <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-literal"><span class="hljs-literal">True</span></span> $line = FileReadLine($hfile) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> @<span class="hljs-keyword"><span class="hljs-keyword">error</span></span> = <span class="hljs-number"><span class="hljs-number">-1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> ExitLoop PlayLine($line) <span class="hljs-keyword"><span class="hljs-keyword">wend</span></span> FileClose($hfile) StopMoving() EndFunc Func Sign($x) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($x &lt; <span class="hljs-number"><span class="hljs-number">0</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> return <span class="hljs-number"><span class="hljs-number">-1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> return <span class="hljs-number"><span class="hljs-number">1</span></span> EndIf EndFunc Func ScalarMult($a, $b, $x, $y) return $a*$x + $b*$y EndFunc Func VectorMult($a, $b, $x, $y) return $a*$y - $b*$x EndFunc Func StartMoving() <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> $moving <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> return $moving = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; WinWaitActive($hwnd) MouseMove(@DesktopWidth/<span class="hljs-number"><span class="hljs-number">2</span></span>, @DesktopHeight/<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>) MouseDown(<span class="hljs-string"><span class="hljs-string">"right"</span></span>) Sleep(<span class="hljs-number"><span class="hljs-number">300</span></span>) EndFunc Func StopMoving() $moving = <span class="hljs-literal"><span class="hljs-literal">false</span></span> Send(<span class="hljs-string"><span class="hljs-string">"{w up}{s up}{a up}{d up}"</span></span>) MouseUp(<span class="hljs-string"><span class="hljs-string">"right"</span></span>) Sleep(<span class="hljs-number"><span class="hljs-number">300</span></span>) EndFunc Func GetPitch() StartMoving() $pixel2 = _ColorGetRGB(PixelGetColor(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, $hwnd)); Return ($pixel2[<span class="hljs-number"><span class="hljs-number">2</span></span>]/<span class="hljs-number"><span class="hljs-number">255.0</span></span><span class="hljs-number"><span class="hljs-number">-0.5</span></span>)*<span class="hljs-number"><span class="hljs-number">4</span></span> EndFunc Func GetPos() StartMoving() $pixel1 = _ColorGetRGB(PixelGetColor(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, $hwnd)); $pixel2 = _ColorGetRGB(PixelGetColor(<span class="hljs-number"><span class="hljs-number">10</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, $hwnd)); local $result[<span class="hljs-number"><span class="hljs-number">3</span></span>] = [ ($pixel1[<span class="hljs-number"><span class="hljs-number">0</span></span>]+$pixel1[<span class="hljs-number"><span class="hljs-number">1</span></span>]/<span class="hljs-number"><span class="hljs-number">255.0</span></span>)/<span class="hljs-number"><span class="hljs-number">255</span></span>*<span class="hljs-number"><span class="hljs-number">100</span></span>, ($pixel2[<span class="hljs-number"><span class="hljs-number">0</span></span>]+$pixel2[<span class="hljs-number"><span class="hljs-number">1</span></span>]/<span class="hljs-number"><span class="hljs-number">255.0</span></span>)/<span class="hljs-number"><span class="hljs-number">255</span></span>*<span class="hljs-number"><span class="hljs-number">100</span></span>, $pixel1[<span class="hljs-number"><span class="hljs-number">2</span></span>]*<span class="hljs-number"><span class="hljs-number">7.0</span></span>/<span class="hljs-number"><span class="hljs-number">255</span></span> ] return $result EndFunc Func GetDirection($x, $y, $wx, $wy, $angle) $dx = $x - $wx $dy = $y - $wy local $result[<span class="hljs-number"><span class="hljs-number">2</span></span>] = [ ScalarMult(-<span class="hljs-built_in"><span class="hljs-built_in">sin</span></span>($angle), -<span class="hljs-built_in"><span class="hljs-built_in">cos</span></span>($angle), $dx, $dy), VectorMult(-<span class="hljs-built_in"><span class="hljs-built_in">sin</span></span>($angle), -<span class="hljs-built_in"><span class="hljs-built_in">cos</span></span>($angle), $dx, $dy) ] Return $result EndFunc Func Move($want) <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span> local $pos = GetPos() local $dir = GetDirection($pos[<span class="hljs-number"><span class="hljs-number">0</span></span>], $pos[<span class="hljs-number"><span class="hljs-number">1</span></span>], $want[<span class="hljs-number"><span class="hljs-number">0</span></span>], $want[<span class="hljs-number"><span class="hljs-number">1</span></span>], $pos[<span class="hljs-number"><span class="hljs-number">2</span></span>]) ToolTip(StringFormat(<span class="hljs-string"><span class="hljs-string">"(%.2f,%.2f,%.2f) to (%.2f,%.2f, %.2f): (%.2f,%.2f)"</span></span>, $pos[<span class="hljs-number"><span class="hljs-number">0</span></span>], $pos[<span class="hljs-number"><span class="hljs-number">1</span></span>], $pos[<span class="hljs-number"><span class="hljs-number">2</span></span>], $want[<span class="hljs-number"><span class="hljs-number">0</span></span>], $want[<span class="hljs-number"><span class="hljs-number">1</span></span>], $want[<span class="hljs-number"><span class="hljs-number">2</span></span>], $dir[<span class="hljs-number"><span class="hljs-number">0</span></span>], $dir[<span class="hljs-number"><span class="hljs-number">1</span></span>])) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>($dir[<span class="hljs-number"><span class="hljs-number">0</span></span>]) &lt; <span class="hljs-number"><span class="hljs-number">0.1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">And</span></span> <span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>($dir[<span class="hljs-number"><span class="hljs-number">1</span></span>]) &lt; <span class="hljs-number"><span class="hljs-number">0.1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> ExitLoop <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>($dir[<span class="hljs-number"><span class="hljs-number">0</span></span>]) &gt;= <span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>($dir[<span class="hljs-number"><span class="hljs-number">1</span></span>]) <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> Send(<span class="hljs-string"><span class="hljs-string">"{a up}{d up}"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> $dir[<span class="hljs-number"><span class="hljs-number">0</span></span>] &lt;=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> Send(<span class="hljs-string"><span class="hljs-string">"{w down}{s up}"</span></span>) ; forward <span class="hljs-keyword"><span class="hljs-keyword">Else</span></span> Send(<span class="hljs-string"><span class="hljs-string">"{s down}{w up}"</span></span>) ; backward EndIf <span class="hljs-keyword"><span class="hljs-keyword">Else</span></span> Send(<span class="hljs-string"><span class="hljs-string">"{s up}"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> $dir[<span class="hljs-number"><span class="hljs-number">1</span></span>] &lt; <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> Send(<span class="hljs-string"><span class="hljs-string">"{d down}{a up}"</span></span>) ; <span class="hljs-built_in"><span class="hljs-built_in">right</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Else</span></span> Send(<span class="hljs-string"><span class="hljs-string">"{a down}{d up}"</span></span>) ; <span class="hljs-built_in"><span class="hljs-built_in">left</span></span> EndIf EndIf <span class="hljs-keyword"><span class="hljs-keyword">wend</span></span> Send(<span class="hljs-string"><span class="hljs-string">"{s up}{a up}{d up}"</span></span>) EndFunc Func Turn($want) <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span> local $current = GetPos() $<span class="hljs-built_in"><span class="hljs-built_in">sin</span></span> = <span class="hljs-built_in"><span class="hljs-built_in">sin</span></span>($current[<span class="hljs-number"><span class="hljs-number">2</span></span>] - $want[<span class="hljs-number"><span class="hljs-number">2</span></span>]) ;ToolTip(StringFormat(<span class="hljs-string"><span class="hljs-string">"(%.2f,%.2f,%.2f) to (%.2f,%.2f,%.2f)"</span></span>, $current[<span class="hljs-number"><span class="hljs-number">0</span></span>], $current[<span class="hljs-number"><span class="hljs-number">1</span></span>], $<span class="hljs-built_in"><span class="hljs-built_in">sin</span></span>, $want[<span class="hljs-number"><span class="hljs-number">0</span></span>], $want[<span class="hljs-number"><span class="hljs-number">1</span></span>], $want[<span class="hljs-number"><span class="hljs-number">2</span></span>])) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>($<span class="hljs-built_in"><span class="hljs-built_in">sin</span></span>) &lt; <span class="hljs-number"><span class="hljs-number">0.05</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> return MouseMove(MouseGetPos(<span class="hljs-number"><span class="hljs-number">0</span></span>)+<span class="hljs-number"><span class="hljs-number">50</span></span>*$<span class="hljs-built_in"><span class="hljs-built_in">sin</span></span>, MouseGetPos(<span class="hljs-number"><span class="hljs-number">1</span></span>), <span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">wend</span></span> EndFunc Func SetPitch($want) <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> <span class="hljs-literal"><span class="hljs-literal">true</span></span> $current = GetPitch() $<span class="hljs-built_in"><span class="hljs-built_in">sin</span></span> = <span class="hljs-built_in"><span class="hljs-built_in">sin</span></span>($current - $want) ;ToolTip(StringFormat(<span class="hljs-string"><span class="hljs-string">"pitch %.2f to %.2f: %.2f"</span></span>, $current, $want, $<span class="hljs-built_in"><span class="hljs-built_in">sin</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-built_in"><span class="hljs-built_in">abs</span></span>($<span class="hljs-built_in"><span class="hljs-built_in">sin</span></span>) &lt; <span class="hljs-number"><span class="hljs-number">0.05</span></span> <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> return MouseMove(MouseGetPos(<span class="hljs-number"><span class="hljs-number">0</span></span>), MouseGetPos(<span class="hljs-number"><span class="hljs-number">1</span></span>)+<span class="hljs-number"><span class="hljs-number">50</span></span>*$<span class="hljs-built_in"><span class="hljs-built_in">sin</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">wend</span></span> EndFunc Func Pause() $paused = <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> $paused <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> $paused <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> StopMoving() <span class="hljs-keyword"><span class="hljs-keyword">While</span></span> $Paused Sleep(<span class="hljs-number"><span class="hljs-number">1000</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">WEnd</span></span> EndFunc Func Kill() StopMoving() <span class="hljs-keyword"><span class="hljs-keyword">Exit</span></span> EndFunc</code> </pre><br></div></div><br><h4>  Control (ro) bot </h4><br><img src="http://habrastorage.org/storage2/64a/4b3/cc6/64a4b3cc69f274f5f8c91eaad5861852.jpg" title="ED-209 from Robocop falls down the stairs"><br>  That seems to be all.  Run along the route, record the coordinates, keystrokes and clicks, and start playback.  But it was not there.  Here begins the most difficult. <br><br>  In the dungeon live <a href="http://ru.wikipedia.org/wiki/%25D0%259C%25D0%25BE%25D0%25B1_(%25D0%25BA%25D0%25BE%25D0%25BC%25D0%25BF%25D1%258C%25D1%258E%25D1%2582%25D0%25B5%25D1%2580%25D0%25BD%25D1%258B%25D0%25B5_%25D0%25B8%25D0%25B3%25D1%2580%25D1%258B)">mobs</a> , which, although they do not pose a threat to the life of our character, but strive to stun, throw "silent", run aside just when you would like to kill them, and rush to the embrasure at the moment you thought take on a completely different mob.  Sometimes your goal runs behind your back, sometimes it dies in one stroke, although you have to live three.  In general, their chaotic behavior introduces a noticeable element of chance into our route, and as a result, a character may be at the locked door at the very end of the route simply because he could not kill someone at the very beginning. <br><br>  Yes, it was possible to write in-game macros that would take the desired mob as a target, and thus get rid of some problems, but I wanted to leave the bot as universal as possible. <br><br>  Lattice doors.  They need to click to open.  And since they are lattices, you can click neatly into the hole by accident.  And the character will beat his forehead against the door in an attempt to run further. <br><br>  Thus, writing down the route, you open it in a notebook and debug it.  You watch the character and in case of problems or possible problems ‚Äúdrive crutches‚Äù into the route: insert an additional spell to be faithful (suddenly the mob will survive), reach the point where the mob will be clearly visible and reach regardless of his desire to walk.  You change the route, so as not to stumble over this unfortunate box.  After 10 races, I came to the conclusion that it would be better if I simply killed all the spiders there, than they could then take revenge on me in one case out of 10 with their sudden spell.  But, when the character is already running, you no longer want to run on your own legs, you just want to look at it. <br><br>  I realized what it was like to launch a rover, program a robot vacuum cleaner, walk in complete darkness around the apartment or teach robots to play football.  It is necessary to do everything reliably, with a margin.  On Mars, the pits will be everywhere, and there will also be overhanging rocks and caves.  In the apartment, the robot vacuum cleaner will face the wires and slippers everywhere, and there will be a cat who wants to play.  In total darkness there will be corners, legs of chairs, and even knives that have fallen to the floor.  Only by touch! <br><br>  I admit, I completed only the minimum program stated in the last part.  The bot still may not complete the task with a probability of 1%.  So it is impossible to leave it without control for the night, it will get stuck. <br><br><h4>  Counter bots </h4><br><img src="http://habrastorage.org/storage2/4d9/78f/4c9/4d978f4c9aa489062a3e5aa1f10af06c.jpg"><br>  People far from <a href="http://ru.wikipedia.org/wiki/MMORPG">MMORPG games</a> will be asked: ‚ÄúWhy bother to resist bots at all?  After all, automation is welcome everywhere. ‚ÄùBut not at all.  If everyone <a href="http://ru.wikipedia.org/wiki/Free-to-play">pays the same</a> , then the possibilities should be equal.  Otherwise, the disadvantaged part is offended and stops playing.  If macros are available in the game, for example, then they should be understandable and not for programmers.  Therefore, the game developer prohibits the use of automation at the level of the license agreement and monitors. <br><br>  I often met exclamations that <b>Blizzard</b> (this is a WoW developer) is not following well, and bots are everywhere.  Firstly, I myself do not think so, I think their share is exaggerated.  And secondly, let's discuss what is in the arsenal of the developer.  How not only to recognize the bot, but also to have supporting facts.  After all, on the basis of suspicion it is impolite to ban a player. <br><br> , <a href="http://en.wikipedia.org/wiki/Gamemaster">-</a> ( )        .  ,   ¬´¬ª ,  :    ,    ,      (  ),     , ‚Äî       .  ,     ,  ,     ,  ¬´¬ª. <br><br>   <b>Blizzard</b>  <a href="http://ru.wikipedia.org/wiki/Blizzard_Entertainment">Warden</a> .     <a href="http://en.wikipedia.org/wiki/Cloud_security"> </a> : <br><ol><li>    </li><li>      </li><li> -  ,  -      </li><li>  ,   ,   </li></ol><br>  <a href="http://www.gamebreaker.tv/pc-games/wineing-about-diablo/"></a> ,       - <a href="http://ru.wikipedia.org/wiki/Wine">Wine</a> . <b>Blizzard</b> <a href="http://us.battle.net/d3/en/forum/topic/5795159954%3Fpage%3D2"> </a>        . <br><br>  ,    ,            : <br><ol><li>  ,  ,      </li><li>  <a href="http://habrahabr.ru/post/73324/"></a>    </li><li>              </li><li>    <a href="http://www.securityfocus.com/brief/34">-</a>  <a href="http://ru.wikipedia.org/wiki/%25D0%259F%25D0%25BE%25D0%25BB%25D0%25B8%25D0%25BC%25D0%25BE%25D1%2580%25D1%2584%25D0%25B8%25D0%25B7%25D0%25BC_%25D0%25BA%25D0%25BE%25D0%25BC%25D0%25BF%25D1%258C%25D1%258E%25D1%2582%25D0%25B5%25D1%2580%25D0%25BD%25D1%258B%25D1%2585_%25D0%25B2%25D0%25B8%25D1%2580%25D1%2583%25D1%2581%25D0%25BE%25D0%25B2"></a>     </li></ol><br>        ban-wave     . <br>         <b>AutoIt</b> ,    ,            ¬´¬ª .         <b>Blizzard</b>  , ,   . <br><br><h4>  Conclusion </h4><br>   : <br><ol><li>         </li><li>           </li><li>          </li><li>      </li><li>     ,     </li></ol><br>       ,  ,   .    20 (    5  ).   ,  ,     .    .   ,    ,        <a href="http://ru.wikipedia.org/wiki/%25D0%25A4%25D0%25B0%25D1%2580%25D0%25BC%25D0%25B5%25D1%2580_(MMORPG)"></a> ,  - . <br><br> ,  ,     .  Good luck. <br></div><p>Source: <a href="https://habr.com/ru/post/189874/">https://habr.com/ru/post/189874/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../189864/index.html">Glasses of augmented reality SpaceGlasses META.01 - all that is not able to Google Glass</a></li>
<li><a href="../189866/index.html">How I searched for my phone using Android Device Manager</a></li>
<li><a href="../189868/index.html">The robot explores little-studied areas of the ocean, we observe in real time (until August 16)</a></li>
<li><a href="../189870/index.html">Images Tizen SDK Live based on Ubuntu</a></li>
<li><a href="../189872/index.html">Code design, optimization of code quality control process</a></li>
<li><a href="../189876/index.html">Hyperloop technical specifications published</a></li>
<li><a href="../189882/index.html">How namedtuple or dynamic type creation works</a></li>
<li><a href="../189886/index.html">Dr. Tariff (3 months later) - you can pick up the tariff in 80 regions of Russia on Android and iOS</a></li>
<li><a href="../189888/index.html">Transition from HP EVA to 3PAR StoreServ 7400. Real implementation experience</a></li>
<li><a href="../189890/index.html">Intel Cloud Services Platform - "cloud" for the developer</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>