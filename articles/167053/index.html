<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Snippet menuCaching for MODX Revolution</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The idea of ‚Äã‚Äãa snippet is very simple. Often you want to make a menu on the site, which remains unchanged on all pages. Only the CSS class of the act...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Snippet menuCaching for MODX Revolution</h1><div class="post__text post__text-html js-mediator-article">  The idea of ‚Äã‚Äãa snippet is very simple.  Often you want to make a menu on the site, which remains unchanged on all pages.  Only the CSS class of the active menu item changes.  Why do we need to make inquiries in the database on each page and generate a menu if we only need to change the CSS class?  And if this is a large menu with drop-down sublevels, too many resources can be spent on its generation.  Snippet <b>menuCaching</b> allows <b>you</b> to save the server from this extra work. <a name="habracut"></a><br><br><img src="https://habrastorage.org/storage2/c39/75d/488/c3975d488a3e9edd8c6f1b9ecf8b0bce.png"><br><br><h5>  Snippet description </h5><br>  Snippet allows you not to generate a menu for each page separately just in order to put the CSS class on the active menu item. <br>  The menu is generated only once for the entire site, but the active items are marked. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  Usage example </h5><br><br><pre><code class="hljs json">[[menuCaching? &amp;snippetToCache=`Wayfinder` &amp;cacheSuffix=`top_menu` &amp;contexts=`web` &amp;startId=`<span class="hljs-number"><span class="hljs-number">0</span></span>` &amp;level=`<span class="hljs-number"><span class="hljs-number">1</span></span>` &amp;hereClass=`active` &amp;rowTpl=`@CODE: &lt;li class=<span class="hljs-string"><span class="hljs-string">"[[+wf.classnames]] {{active[[+id]]}}"</span></span>&gt;&lt;a href=<span class="hljs-string"><span class="hljs-string">"[[+wf.link]]"</span></span>&gt;[[+wf.linktext]]&lt;/a&gt;&lt;/li&gt;` ]]</code> </pre> <br><br>  It is recommended to create a set of parameters (for example, "top_menu") in order to, again, save the MODX parser from unnecessary work: <br><br><pre> <code class="hljs lua"><span class="hljs-string"><span class="hljs-string">[[menuCaching@top_menu]]</span></span></code> </pre> <br><br>  What is happening here, I think you guessed it.  The menu cache is stored as follows: <br><br><pre> <code class="hljs django"><span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">li</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"first </span></span></span></span></span></span><span class="hljs-template-variable"><span class="hljs-template-variable">{{active1}}</span></span><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">a</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">""</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">  1</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">a</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">li</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">li</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">" </span></span></span></span></span></span><span class="hljs-template-variable"><span class="hljs-template-variable">{{active2}}</span></span><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">a</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">""</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">  2</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">a</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">li</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">li</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"last </span></span></span></span></span></span><span class="hljs-template-variable"><span class="hljs-template-variable">{{active3}}</span></span><span class="xml"><span class="hljs-tag"><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">a</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">""</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml">  3</span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">a</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">li</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">ul</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br><br>  It remains only to replace the labels of the type {{active1}} with the class of the active element, and remove the rest, which the snippet does.  A snippet includes a plugin that clears the cache when you click the "Refresh website" button in the admin panel. <br><br>  An important snippet parameter is <b>cacheSuffix</b> .  The example creates a cache for the entire site, but you can create a cache for individual parent categories, and within one category everything will be taken from the cache: <br><br><pre> <code class="hljs lua">&amp;cacheSuffix=`<span class="hljs-string"><span class="hljs-string">[[*parent]]</span></span>`</code> </pre> <br><br>  This snippet can be used not only for menus, but for example for different sliders, etc.  blocks that do not change on the site on different pages. <br><br>  Snippet <b>menuCaching</b> in the MODX repository: <a href="http://modx.com/extras/package/menucaching">http://modx.com/extras/package/menucaching</a> <br><br>  <b>Added by</b> <br><br>  Test results with a large menu.  Calls of both snippets are uncached, i.e.  [[! snippet]] (for the test, in reality it is necessary to cache). <br><br>  <i>Wayfinder</i> <br>  The first call to any of the pages where there is a menu: <b>2.5815 sec.</b> <br>  Go to any other page with the same menu: <b>2.4566 sec.</b>  (Ie vaunted cacheResults doesn't help) <br>  Updating the page: <b>1.0021 sec.</b>  (only in this case, cacheResults saves) <br><br>  <i>Same Wayfinder, via menuCaching</i> <br>  The first call to any of the pages where there is a menu: <b>2.4842 seconds.</b>  (within the limits of error, of course there is no difference) <br>  Go to any other page with the same menu: <b>0.7008 sec.</b>  (the result is the same, but the time is different) <br>  <b>Refreshing the</b> page: <b>0.4187 sec.</b> </div><p>Source: <a href="https://habr.com/ru/post/167053/">https://habr.com/ru/post/167053/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../167039/index.html">Incorrect work of the standard search for Windows operating systems</a></li>
<li><a href="../167041/index.html">Breaking matches, or Alice in the land of mathematical errors</a></li>
<li><a href="../167043/index.html">How to create a 3D panorama of the battle of Borodino</a></li>
<li><a href="../167045/index.html">Kiev. Saturday. Habrare</a></li>
<li><a href="../167051/index.html">Scalable Mail System Architecture</a></li>
<li><a href="../167055/index.html">Antigua and Barbuda: a country that does not pay license fees in the US</a></li>
<li><a href="../167057/index.html">WindowsAndroid allows you to run Android 4.0 ICS as a Windows application</a></li>
<li><a href="../167059/index.html">Scrum - real experience in methodology</a></li>
<li><a href="../167061/index.html">Remember the real world</a></li>
<li><a href="../167063/index.html">Selectel Cloud - About Super Habraeffect, Small Optimization, and Costs for 2 Years</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>