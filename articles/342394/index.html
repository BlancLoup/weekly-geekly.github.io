<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Additional reports and processing, use of extensions in 1C Fresh</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today we want to tell you about the use of additional reports and processing, and especially configuration extensions in the service model. Technologi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Additional reports and processing, use of extensions in 1C Fresh</h1><div class="post__text post__text-html js-mediator-article">  Today we want to tell you about the use of additional reports and processing, and especially configuration extensions in the service model.  Technologies do not stand still, maintenance of 1C bases in the cloud is becoming an increasingly attractive service.  What you need to know, so that the necessary for your company functionality was implemented in a rented base, and how this process looks from the service provider side - you can learn about it under the cut. <br><img src="https://habrastorage.org/webt/qc/t0/hd/qct0hdphvmooyzhz3oeocbg6rfi.png" alt="image"><br><a name="habracut"></a><br><h3>  What are external reports and processing <br></h3><br>  Processing 1C are different, but in any case, they expand the functionality of the configuration and allow you to get quick access to the information stored in the database, without changing the configuration and without removing from support.  They can be embedded directly into the configuration, added as a configuration extension, or be external files. <br><br>  By processing functionality, they are divided into those that can change data and those that simply analyze information and output the result in a user-friendly form (reports).  In order not to change the standard layouts for printing documents, external printing forms are being developed.  Also, external processing can be performed according to a predetermined schedule on the 1C application server - these are routine tasks. <br><br>  The button has developed dozens of treatments that allow our accountants to use ‚Äúpractical magic‚Äú.  For example, to analyze the correctness of accounting in the Button, the external report ‚ÄúAuto Audit of Bases‚Äù is used.  Analysis of 120 criteria of balances and turnover on accounts, compliance of data from tax returns and accounting information, analysis of fixed assets and so on is displayed in easy-to-understand tables. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/webt/ic/ii/4j/icii4j5siptinylxd5tzru_ne7s.png" alt="image"><br><br><img src="https://habrastorage.org/webt/nq/3u/5u/nq3u5u2gip3ueat5ojl0ihvids8.png" alt="image"><br><br><img src="https://habrastorage.org/webt/i5/3o/te/i53oteodsncqmixkeq05rqgnsey.png" alt="image"><br><br>  An example of an external printed form "loan agreement" in the form developed by our lawyers.  There are cases when the entrepreneur takes an interest-free loan from his company as an individual, or vice versa, transfers his own funds to the company, then there is an opportunity to immediately print the contract. <br><br><img src="https://habrastorage.org/webt/ax/i8/ee/axi8eerb3jp2tvfcoeew2-dlql4.png" alt="image" width="550"><br><br>  A form opens to fill in the required details: <br><br><img src="https://habrastorage.org/webt/ev/qc/ez/evqcezdjrbwc_8rsemk5v5omgrs.png" alt="image" width="550"><br><br>  And the printed form of the contract is displayed: <br><br><img src="https://habrastorage.org/webt/m3/41/dt/m341dt-ye7q40l4lr1d12iqkwkk.png"><br><br>  Scheduled treatments (routine tasks) are used, for example, to correct the statement.  The buttons are configured to integrate with the main banks and special robots download the statement directly to 1C.  Thanks to machine learning technology, the percentage of errors during discharge was reduced to 3%.  But as always there are exceptions, for example, customers who use an agent-based scheme for the sale of goods, in this case, the rules for conducting a bank statement are individual.  In order not to reprogram the robot for a particular case, before the appearance of configuration extensions, a routine task was used to correct the statement after the robot every 10 minutes. <br><br><h3>  What are configuration extensions <br></h3><br>  An extension is a mini-configuration that inherits objects from the main database configuration and contains code with additions or corrections to objects and modules.  In this case, the basic configuration remains supported, it is not necessary to include the possibility of editing, which greatly facilitates the update process. <br><br>  The mechanism involves three types of use, which, in fact, are indicated in the ‚ÄúAssignment‚Äù field when creating an extension: <br><br><ol><li>  <b>A fix</b> is an extension to correct minor inaccuracies and errors in configuration objects; </li><li>  <b>Adaptation</b> - The default value when creating a new extension.  Use to change the typical objects to your requirements; </li><li>  <b>Addition</b> - adds a completely new functionality to the standard solution. </li></ol><br><h3>  Administration of additional reports, processing and extensions </h3><br>  Today Button provides accounting outsourcing services to more than 1000 entrepreneurs.  We have implemented and have been using 1C Fresh for more than two years - the technology of publishing application solutions on the 1C: Enterprise platform, which is used in the cloud service 1cfresh.com.  This is the best solution for servicing such a large number of 1C bases today.  One information base with the help of separators is divided into independent areas, more details can be found in our article ‚Äú <a href="https://habrahabr.ru/company/knopka/blog/324662/">How to independently maintain 2500 accounting bases</a> ‚Äù. <br><br>  The central component of the technology is the <b>Service Manager</b> , it stores all the information about subscribers, users, applications, information databases and the relationships between them, and with its help, external processing and expansion of configurations are managed. <br><br><img src="https://habrastorage.org/webt/hb/c1/wb/hbc1wbmlaqyr9w5my4bbwgbkvk0.png"><br><br>  All files with treatments are uploaded to a special directory of the service manager.  But before you upload a file to the directory, in other words, ‚Äúpublish it in a service,‚Äù you need to prepare it in a special way. <br><br><h3>  Preparation of external reports and treatments for publication in the service model <br></h3><br>  Additional report or processing is created in the ‚Äú1C: Enterprise 8‚Äù configurator as standard external reports and processing and saved to a file with the extension - .epf (for additional processing) or .erf (for additional reports). <br><br>  The object module must have procedures and functions for defining registration parameters. <br><br><img src="https://habrastorage.org/webt/0j/t-/z0/0jt-z0rj57iqnxl-zf1moeecmaq.png"><br><br><img src="https://habrastorage.org/webt/hg/qb/l8/hgqbl8zrhnvgulyksyovfnuafrw.png"><br><br>  Please note that the important parameter is ‚ÄúVersion‚Äú.  If you made changes to the processing that has already been previously uploaded to the service manager directory, be sure to change the version number, otherwise the service manager will refuse to download this file.  When developing a report or processing it is necessary to take into account that users work in the service model through a web client (a good article in the 1C <a href="https://habrahabr.ru/company/1c/blog/315414/">blog</a> ).  If the processing contains forms, then they should work in the web client under all web browsers that are supported by the 1C: Enterprise 8 technology platform. <br><br>  According to the standards of the <a href="http://1cfresh.com/">1cfresh.com</a> service, the additional report or processing must be fully operational when performed in safe mode, that is, to work without recourse to objects external to the configuration. <br><br>  Additional report or processing should be prepared for download to the service in the form of a package.  The bundle is an archive (zip file) containing: <br><br><ul><li>  file of additional report or processing; </li><li>  The xml-file of the manifest, in which there is additional meta-information needed by the service manager for publishing an additional report or processing it in the service. </li></ul><br>  Preparation is performed in the locally deployed information base of the configuration for which the additional report or processing is intended.  We use a special assistant to create a set of delivery, external processing Preparation of Additional Reports and Processing of Publications In Model Service.epf.  More information can be found in the documentation on the Technology of publication solutions 1C Fresh. <br><br><img src="https://habrastorage.org/webt/u9/hc/kz/u9hckzevz049kzia8giadux8er0.png"><br><br><h3>  Installation of additional reports and treatments in the service model <br></h3><br>  A distinctive feature of 1C Fresh technology is that the external report or processing cannot be loaded directly into the data area.  Adding occurs only by the service administrator through the service manager.  After the zip-archive with the processing file is prepared, it must be downloaded to the service manager directory and set for the specific service subscriber. <br><br>  Subscriber service - a group of users, united by any principle.  Accordingly, the information databases available for a certain group of users are called subscriber applications. <br><br>  Applications can have various 1C configurations (Enterprise accounting, Salary and personnel management, Management of our company, etc.), which can be used in the service model.  Additional report or processing can be installed only in the applications of the subscriber, which is specified when downloading the file. <br><br>  Here is the form of the properties of the additional report with versions.  On the hyperlink ‚ÄúInstall / Uninstall‚Äú, we get into the list of applications and select the necessary databases. <br><br><img src="https://habrastorage.org/webt/g3/fa/au/g3faauldtprtk2islunjezxhfn0.png"><br><br>  After processing is loaded and the application is selected, the service manager contacts the application address and gives the command to install it into the information base. <br><br><h3>  We start processing on schedule </h3><br>  When working with a large number of accounting bases, some processing needs to be performed periodically.  For example, once a month or every few minutes.  It is also important to automate manual and typical user operations.  For this we actively use routine tasks. <br><br>  Treatments that will be performed on a schedule do not have a form.  All logic is written in the object module and looks as follows. <br><br><img src="https://habrastorage.org/webt/at/ab/le/atablej48vojnycfasyj8c8j1-i.png"><br><img src="https://habrastorage.org/webt/bi/nk/xl/binkxlosp-vz11ygf0jgh7jrzea.png"><br><br>  When preparing the package, we set the schedule.  Now our processing will be done every hour. <br><br><img src="https://habrastorage.org/webt/p6/7b/42/p67b42dq_ovytcdfo4ybjkdtyva.png"><br><br><h3>  More on configuration extensions <br></h3><br>  In parallel with external reports and treatments that need to be prepared and administered ‚Äúin the old-fashioned way‚Äù, we began to actively use the mechanism of configuration extensions.  Starting with the platform of 1C of Enterprise 8.3.10, this mechanism has made our lives easier enough and allowed us to simplify the adaptation of configurations to the features of the Button. <br><br>  For example, we wrote above about routine operations for correcting documents for robots that were launched every 10 minutes.  Now you can use the extension to override the work of the modules.  Thus, we can immediately perform the necessary actions when recording or holding a document.  This is much more optimal, because the task queue in the database is not clogged up with performing actions every 10 minutes, and more quickly, since changes are made immediately. <br><br>  A new extension is easy to prepare.  Let's look at the process of creating extensions with specific examples. <br>  By experience, the leader in requests for adjustments is the printed form TORG-12.  For example, we need to make an extension to be able to print a waybill in a currency (by default, it can only be formed in rubles). <br>  Open Menu ‚Üí Configuration ‚Üí Configuration Extensions. <br>  Create a new extension with the appointment ‚ÄúAdaptation‚Äú. <br><br><img src="https://habrastorage.org/webt/ce/7f/xe/ce7fxeq8nxvj28exl-ajcddvb44.png"><br><br>  The extension looks like a familiar configuration tree, but so far without objects.  First of all, we will add a new layout of Torg-12, into which we inserted columns with currency amounts. <br><br><img src="https://habrastorage.org/webt/7k/qc/n3/7kqcn3xgcqgulwno3e7clgr0dmw.png"><br><br>  Since the invoice is printed from the document ‚ÄúSales of goods of services‚Äù, we will add this document to our extension from the basic configuration and make the necessary changes to the manager‚Äôs module.  To do this, in the context menu of the implementation, select ‚Äúadd to extension‚Äù. <br><br><img src="https://habrastorage.org/webt/m3/bf/i0/m3bfi0zlse38qe9mgnqhav4tkgs.png" width="550"><br><br>  Now you can modify the implementation manager module.  We need to add a new form to the list of printed forms and fill in amounts in currency. <br><br><img src="https://habrastorage.org/webt/mz/x6/xm/mzx6xmjhv7o80tt82cxyh3aduvi.png"><br><br>  To change typical procedures, we use the &amp; After annotation, we also need a couple of our functions and a procedure. <br><br>  Let's take a closer look at annotations.  In extensions you can use: &amp; Before, &amp; After, &amp; Instead (very carefully).  The principle of operation is simple: we want our algorithms from the extension to be executed first, set the annotation &amp; Before and in brackets we indicate the name of the procedure from the typical configuration.  If we first work out a typical module, and then ours, use &amp; After. <br><br>  Annotations &amp; Before and &amp; After can not be used for functions.  Therefore, if we need to change the algorithm of the function from the main configuration, we use the annotation &amp; Instead. <br><br>  Annotation &amp; Instead, it is necessary to apply as little as possible, since it completely replaces the execution of the procedure and functions from the main configuration to the extension procedure / function.  With this method of interception, the procedure / function from the main configuration will generally cease to be executed while the extension is installed, even updating versions will not help. <br><br><h3>  Conclusion </h3><br>  There are many different opinions about the use of extensions and external reports / treatments.  Based on our experience, we have two hands ‚Äúfor‚Äù expansion.  This is a modern and more adaptive technology, it has many more features, and their publication is much simpler.  Only the necessary part of the code is placed in the extension; there is also no need to additionally prescribe the procedures and functions for determining registration parameters, monitor the versions and create the delivery set. <br><br>  You can use multiple extensions for the same data region. <br>  For the specifics of the work of 1C Fresh in the data sharing mode (one configuration, many independent areas), the extension method is an excellent way out. </div><p>Source: <a href="https://habr.com/ru/post/342394/">https://habr.com/ru/post/342394/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../342384/index.html">Kotlin Night Moscow in Avito on November 25</a></li>
<li><a href="../342386/index.html">Build your Security Operation Center of 5 items</a></li>
<li><a href="../342388/index.html">Colorize a black and white photo using a neural network of 100 lines of code</a></li>
<li><a href="../342390/index.html">Russia vs Germany. Inside about the processes of those. support, quality service and Russian hackers</a></li>
<li><a href="../342392/index.html">Operation Windigo: Linux / Ebury Update</a></li>
<li><a href="../342398/index.html">Live broadcast of the press conference with the presentation of the startup ROI4CIO</a></li>
<li><a href="../342400/index.html">Targeting the Odnoklassniki Moderator application</a></li>
<li><a href="../342402/index.html">Web application on Node and Vue, part 4: code reuse</a></li>
<li><a href="../342404/index.html">Javascript: the path to code clarity</a></li>
<li><a href="../342406/index.html">Kali Linux: packages modification, kernel build, and ISO image creation exercises</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>