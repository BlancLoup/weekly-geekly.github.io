<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Heartbleed OpenSSL Vulnerability Reference</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="What can an attacker learn? 
 The server's private TLS key, the client's private TLS key (if the client is vulnerable), cookies, logins, passwords, an...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Heartbleed OpenSSL Vulnerability Reference</h1><div class="post__text post__text-html js-mediator-article"><h4>  What can an attacker learn? </h4><br>  The server's private TLS key, the client's private TLS key (if the client is vulnerable), cookies, logins, passwords, and any other data that the server and its clients exchange.  You do not need to listen to the communication channel, it is enough to send a specially crafted packet, and this cannot be detected in the server logs. <br><br>  The vulnerability is two-way: if the vulnerable client connects to the attacker's server, then the attacker can read the memory of the client's process.  Example vulnerable clients: MariaDB, wget, curl, git, nginx (in proxy mode). <br><a name="habracut"></a><br><h4>  How to test a vulnerability </h4><br>  Web services: <br>  - <a href="http://filippo.io/Heartbleed/">filippo.io/Heartbleed</a> , <br>  - <a href="https://www.ssllabs.com/ssltest/">www.ssllabs.com/ssltest</a> , <br>  - <a href="http://rehmann.co/projects/heartbeat/">rehmann.co/projects/heartbeat</a> , <br>  - <a href="http://possible.lv/tools/hb/">possible.lv/tools/hb</a> . <br>  Test for client: <a href="https://reverseheartbleed.com/">reverseheartbleed.com</a> <br>  Python Script: <a href="https://gist.github.com/sh1n0b1/10100394">gist.github.com/sh1n0b1/10100394</a> , <a href="https://gist.github.com/mitsuhiko/10130454">gist.github.com/mitsuhiko/10130454</a> <br>  Script on Go: <a href="https://github.com/titanous/heartbleeder">github.com/titanous/heartbleeder</a> <br>  <a href="https://gist.github.com/dberkholz/10169691">Site</a> statistics: <a href="https://gist.github.com/dberkholz/10169691">gist.github.com/dberkholz/10169691</a> <br><br><h4>  What systems are vulnerable </h4><br>  - Vulnerable to OpenSSL 1.0.1 - 1.0.1f, 1.0.2-beta1, the vulnerability is fixed in OpenSSL 1.0.1g and 1.0.2-beta2 ( <a href="http://www.openssl.org/news/secadv_20140407.txt">secadv</a> ). <br>  - OpenVPN, including under Windows - fixed in version I004 ( <a href="http://openvpn.net/index.php/open-source/downloads.html">download</a> ) <br>  - Any programs that are statically linked to a vulnerable version of OpenSSL. <br>  - Tor ( <a href="https://blog.torproject.org/blog/openssl-bug-cve-2014-0160">blog</a> ). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      - Debian Wheezy (stable) - fixed in OpenSSL 1.0.1e-2 + deb7u5 and 1.0.1e-2 + deb7u6 ( <a href="https://www.debian.org/security/2014/dsa-2896">security</a> ) <br>  - Ubuntu 12.04.4 LTS - fixed in OpenSSL 1.0.1-4ubuntu5.12 ( <a href="http://www.ubuntu.com/usn/usn-2165-1/">USN</a> ) <br>  - CentOS 6.5 - fixed in openssl-1.0.1e-16.el6_5.7 ( <a href="http://lists.centos.org/pipermail/centos-announce/2014-April/020249.html">centos-announce</a> ) <br>  - Redhat 6.5 - fixed in openssl-1.0.1e-16.el6_5.7 ( <a href="https://access.redhat.com/site/solutions/781793">solutions</a> , <a href="https://rhn.redhat.com/errata/RHSA-2014-0376.html">errata</a> , <a href="https://bugzilla.redhat.com/show_bug.cgi%3Fid%3DCVE-2014-0160">bugzilla</a> ) <br>  - Fedora 19 and 20 - fixed in openssl-1.0.1e-37 ( <a href="https://lists.fedoraproject.org/pipermail/announce/2014-April/003205.html">announce</a> ) <br>  - Gentoo - fixed in openssl-1.0.1g ( <a href="">GLSA</a> ) <br>  - Slackware 14.0 and 14.1 - fixed in openssl-1.0.1g ( <a href="http://www.slackware.com/lists/archive/viewer.php%3Fl%3Dslackware-security%26y%3D2014%26m%3Dslackware-security.533622">slackware-security</a> ) <br>  - OpenSUSE 12.3 and 13.1 - fixed in openssl-1.0.1e ( <a href="http://lists.opensuse.org/opensuse-security-announce/2014-04/msg00004.html">opensuse-security-announce</a> ) <br>  - FreeBSD 10.0 - fixed to 10.0-RELEASE-p1 ( <a href="">advisories</a> ) <br>  - OpenBSD 5.3 and 5.4 ( <a href="http://ftp.openbsd.org/pub/OpenBSD/patches/5.4/common/007_openssl.patch">patch</a> ) <br>  - NetBSD 5.0.2 <br>  - Amazon - fixed in OpenSSL 1.0.1e-37.66 ( <a href="http://aws.amazon.com/fr/security/security-bulletins/aws-services-updated-to-address-openssl-vulnerability/">security-bulletins</a> ) <br>  - Android 4.1.1 - other versions without vulnerability. <br><br>  Usually depend on the vulnerable library and require a restart: <br>  - Web servers: Nginx, Apache, mail servers: Postfix, Dovecot, Jabber and other IM: ejabberd, <br>  - MySQL if TLS is used for authorization and it depends on OpenSSL: on CentOS, RedHat (including Remi), Percona Server ( <a href="http://www.mysqlperformanceblog.com/2014/04/08/openssl-heartbleed-cve-2014-0160/">blog</a> ). <br><br><h4>  What is not vulnerable </h4><br>  - Windows (no OpenSSL), MacOS (old OpenSSL version), Firefox, Thunderbird (uses <a href="https://developer.mozilla.org/en/docs/NSS">NSS</a> by default), Chrome / Chromium ( <a href="http://www.chromium.org/developers/design-documents/network-stack">uses NSS</a> by default), Android (heartbeat is disabled). <br>  - Root and intermediate certificates that have signed TLS server keys (there are no private keys on them) <br>  - OpenSSH (uses OpenSSL only for key generation) <br>  - OpenVPN, if it uses static keys (not x509) or if it uses a key like "tls-auth ta.key 1" in the config <br>  - The method of distributing updates Unix-like OS (most often used for signing GnuPG). <br><br><h4>  How to upgrade the system </h4><br><h5>  Debian, Ubuntu </h5><br><pre><code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># aptitude update # aptitude -VR full-upgrade</span></span></code> </pre> <br>  After that, completely restart the services that use TLS.  The update installer will prompt you to restart automatically, or you can manually: <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># service nginx restart # service apache2 restart</span></span></code> </pre><br>  A complete list of services that need to be restarted and may be vulnerable: <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># lsof -n | grep -iE 'del.*(libssl\.so|libcrypto\.so)'  # checkrestart</span></span></code> </pre><br>  If you are not sure, it is better to restart the server. <br>  Version Verification: <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># dpkg -l | grep -i openssl # aptitude changelog openssl</span></span></code> </pre><br><br><h5>  CentOS, RedHat, Fedora </h5><br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># yum update</span></span></code> </pre><br>  After that, completely restart the services that use TLS, for example: <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># service nginx restart # service httpd restart</span></span></code> </pre><br>  A complete list of services that need to be restarted and may be vulnerable: <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># lsof -n | grep -iE 'del.*(libssl\.so|libcrypto\.so)'  # needs-restarting</span></span></code> </pre><br>  If you are not sure, it is better to restart the server. <br>  Version Verification: <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># yum list openssl # rpm -q --changelog openssl</span></span></code> </pre><br><br><h5>  Freebsd </h5><br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># freebsd-update fetch # freebsd-update install</span></span></code> </pre><br>  After that, completely restart the services that use TLS, for example: <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># service nginx restart # service apache22 restart</span></span></code> </pre><br>  If you are not sure, it is better to restart the server. <br>  Version Verification: <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># freebsd-version</span></span></code> </pre><br><br><h4>  TLS key recall and password change </h4><br>  - If the attacker was able to collect a completely private key, then he can use it to create a fake website, or to decrypt overheard sessions.  Therefore, it is recommended to revoke certificates, the keys of which could get to the attacker. <br><br>  - If the client browser transmitted passwords to the site without hash + salt, and in its pure form, then these passwords can also be compromised. <br><br><h4>  For the future </h4><br>  - It is necessary to make sure that the browser checks whether the certificate of the site that it is visiting has been revoked. <br>  Firefox checks OSCP by default, and the latest versions also support OCSP Stapling;  Safari checks by default with Mac OS X 10.7 (Lion);  Chrome does not check by default (in the settings section HTTPS / SSL), OCSP Stapling is not supported;  Internet Explorer by default checks for OSCP, but does not support OCSP Stapling;  Opera checks the OSCP by default;  Safari does not check for OSCP by default.  <a href="http://carbonwind.net/blog/post/Random-SSLTLS-101-OCSPCRL-in-practice.aspx">Settings for different browsers</a> . <br><br>  - On the server, it is desirable to enable Perfect forward secrecy (PFS).  At the same time, even if the private key is compromised, the attacker will not be able to decrypt past or future overheard traffic.  To do this, you need to enable Elliptic Curve Diffie-Hellman Ephemeral (ECDHE) or Diffie-Hellman Ephemeral (DHE).  <a href="https://wiki.mozilla.org/Security/Server_Side_TLS">Server setup</a> , <a href="https://www.ssllabs.com/ssltest/">testing</a> . </div><p>Source: <a href="https://habr.com/ru/post/218713/">https://habr.com/ru/post/218713/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../218703/index.html">Microsoft Security Essentials continues to work on Windows XP after April 8, 2014</a></li>
<li><a href="../218705/index.html">Yandex opened registration for its programming championship</a></li>
<li><a href="../218707/index.html">Virtual server from MegaFon</a></li>
<li><a href="../218709/index.html">We invite you to the Russian final of the Imagine Cup: April 19 will be a holiday at the Mail.ru Group office!</a></li>
<li><a href="../218711/index.html">Using XSLT transformations for converting XAML between different platforms</a></li>
<li><a href="../218721/index.html">Microsoft Surface Pro 2, what I would like to know before buying</a></li>
<li><a href="../218725/index.html">Problems with ishop.qiwi.ru</a></li>
<li><a href="../218727/index.html">Club of anonymous programmers, or why only a psycho can become a real programmer</a></li>
<li><a href="../218729/index.html">Strongly Typed SignalSpy to Test Qt Applications</a></li>
<li><a href="../218731/index.html">GWT, Java 8 and Future</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>