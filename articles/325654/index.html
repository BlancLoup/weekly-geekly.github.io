<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Open machine learning course. Theme 7. Teaching without a teacher: PCA and clustering</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello to all! We invite you to explore the seventh topic of our open machine learning course! 


 We will devote this lesson to unsupervised learning ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Open machine learning course. Theme 7. Teaching without a teacher: PCA and clustering</h1><div class="post__text post__text-html js-mediator-article"><p>  Hello to all!  We invite you to explore the seventh topic of our open machine learning course! </p><br><p><img align="right" src="https://habrastorage.org/getpro/habr/post_images/5be/e8a/297/5bee8a297a98ce38da75f0a775f5eb3a.png">  We will devote this lesson to unsupervised learning methods, in particular, PCA - principal component analysis and clustering.  You will learn why to reduce the dimension in the data, how to do it and what are the ways to group similar observations in the data. </p><br><p>  <strong>UPD:</strong> now the course is in English under the brand <a href="http://mlcourse.ai/">mlcourse.ai</a> with <a href="https://medium.com/open-machine-learning-course">articles</a> on Medium, and materials on Kaggle ( <a href="https://www.kaggle.com/kashnitsky/mlcourse">Dataset</a> ) and on <a href="">GitHub</a> . </p><br><p>  <a href="https://www.youtube.com/watch%3Fv%3DqmW968tw3AM">Video recording of the</a> lecture based on this article in the second run of the open course (September-November 2017). </p><a name="habracut"></a><br><div class="spoiler">  <b class="spoiler_title">List of articles series</b> <div class="spoiler_text"><ol><li>  <a href="https://habrahabr.ru/company/ods/blog/322626/">Primary data analysis with Pandas</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/323210/">Visual data analysis with Python</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/322534/">Classification, decision trees and the method of nearest neighbors</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/323890/">Linear classification and regression models</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/324402/">Compositions: bagging, random forest.</a>  <a href="https://habrahabr.ru/company/ods/blog/324402/">Validation and training curves</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/325422/">Construction and selection of signs</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/325654/">Teaching without a teacher: PCA, clustering</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/326418/">Training in gigabytes with Vowpal Wabbit</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/327242/">Time Series Analysis with Python</a> </li><li>  <a href="https://habrahabr.ru/company/ods/blog/327250/">Gradient boosting</a> </li></ol></div></div><br><h3 id="plan-etoy-stati">  Plan for this article </h3><br><ol><li>  Principal Component Method (PCA) <br><ul><li>  Intuition, theory and application features </li><li>  Examples of using </li></ul></li><li>  Clustering <br><ul><li>  K-means </li><li>  Affinity propagation </li><li>  Spectral clustering </li><li>  Agglomerative clustering </li><li>  Clustering Quality Metrics </li></ul></li><li>  Homework </li><li>  Useful sources </li></ol><br><h2 id="0-vvedenie">  0. Introduction </h2><br><p> The main difference between teaching methods without a teacher and the usual classifications and regressions of machine learning is that there are no markup for the data in this case.  This creates several features at once - firstly, the possibility of using incomparably large amounts of data, since they will not need to be laid out for training, and secondly, it is the ambiguity of measuring the quality of methods, due to the lack of straightforward and intuitive metrics, as in learning tasks with a teacher. </p><br><p>  One of the most obvious tasks that arise in the head in the absence of explicit markup is the task of reducing the dimensionality of the data.  On the one hand, it can be considered as an aid in data visualization; for this, the t-SNE method is often used, which we considered in the second article of the course.  On the other hand, such a reduction in dimensionality can remove unnecessary strongly correlated features from observations and prepare data for further processing in the teacher‚Äôs training mode, for example, to make the input data more ‚Äúdigestible‚Äù for decision trees. </p><br><h2 id="1-metod-glavnyh-komponent-pca">  1. Principal Component Method (PCA) </h2><br><h3 id="intuiciya-teoriya-i-osobennosti-primeneniya">  Intuition, theory and application features </h3><br><p>  The Principal Component Analysis method is one of the most intuitively simple and frequently used methods for reducing the dimensionality of data and projecting them onto an orthogonal subspace of features. </p><br><p><img align="right" src="https://habrastorage.org/getpro/habr/post_images/bb6/fe7/f06/bb6fe7f06e114bcc9c354a1cb025b966.png" width="400">  In a very general form, this can be represented as the assumption that all our observations most likely look like some kind of ellipsoid in the subspace of our original space and our new basis in this space coincides with the axes of this ellipsoid.  This assumption allows us to simultaneously get rid of strongly correlated features, since the vectors of the basis of the space onto which we project will be orthogonal. </p><br><p>  In the general case, the dimension of this ellipsoid will be equal to the dimension of the original space, but our assumption that the data lie in a subspace of a smaller dimension allows us to discard the ‚Äúextra‚Äù subspace in the new projection, namely, the subspace with the least extension of the ellipsoid.  We will do this "greedily", choosing in turn as the new element of the basis of our new subspace successively the axis of the ellipsoid from the remaining, along which the dispersion will be maximum. </p><br><blockquote>  "There is a lot of space for you, and it‚Äôs fourteen 'very loudly. Everyone does it."  - Geoffrey Hinton </blockquote><p>  Consider how this is done mathematically: </p><br><p>  To reduce the dimension of our data from <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">n</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.395ex" height="1.455ex" viewBox="0 -520.7 600.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-6E" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-1"> n </script>  at <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-3"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-4"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k </font></font></span><span class="MJXp-mo" id="MJXp-Span-5" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-6"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k </font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8"><font style="vertical-align: inherit;">l </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-9"><font style="vertical-align: inherit;">e </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10"><font style="vertical-align: inherit;">q </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-11"><font style="vertical-align: inherit;">n</font></span></font><span class="MJXp-mtext" id="MJXp-Span-7">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-8"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-9"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-10"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-11"><font style="vertical-align: inherit;"></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.278ex" height="2.419ex" viewBox="0 -780.1 3564.2 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-6B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMAIN-2C" x="521" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-6B" x="966" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-6C" x="1738" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-65" x="2036" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-71" x="2503" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-6E" x="2963" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2"> k, k \ leq n </script>  we need to choose top <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-12"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-13"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">k</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.211ex" height="2.057ex" viewBox="0 -780.1 521.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-6B" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-3"> k </script>  axes of such an ellipsoid, sorted in descending order by dispersion along the axes. </p><br><p>  To begin with, we calculate the variances and covariances of the original features.  This is done simply by using a covariance matrix.  By definition, covariance, for two signs <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-14"><span class="MJXp-msubsup" id="MJXp-Span-15"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-16" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-17" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.724ex" height="2.419ex" viewBox="0 -780.1 1172.8 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-58" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-69" x="1171" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-4"> X_i </script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-18"><span class="MJXp-msubsup" id="MJXp-Span-19"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-20" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-21" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.834ex" height="2.66ex" viewBox="0 -780.1 1220.2 1145.2" role="img" focusable="false" style="vertical-align: -0.848ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-58" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-6A" x="1171" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-5"> X_j </script>  their covariance will be </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-22"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-23"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-24"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">o </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-25"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v </font></font></span><span class="MJXp-mo" id="MJXp-Span-26" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-27"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-28" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-29" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-30" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-31"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-32" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-33" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">j</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-34" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) </font></font></span><span class="MJXp-mo" id="MJXp-Span-35" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-36"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">E </font></font></span><span class="MJXp-mo" id="MJXp-Span-37" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[ </font></font></span><span class="MJXp-mo" id="MJXp-Span-38" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-39"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-40" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">X </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-41" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span><span class="MJXp-mo" id="MJXp-Span-42" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - </font></font></span><font style="vertical-align: inherit;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44"><font style="vertical-align: inherit;">m </font></span><span class="MJXp-msubsup" id="MJXp-Span-45"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-46" style="margin-right: 0.05em;"><font style="vertical-align: inherit;">u </font></span></span><span class="MJXp-msubsup" id="MJXp-Span-45"><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-47" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;">i</font></span></span><span class="MJXp-mo" id="MJXp-Span-48" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"> ) </font></span><span class="MJXp-mo" id="MJXp-Span-49" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">( </font></span><span class="MJXp-msubsup" id="MJXp-Span-50"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-51" style="margin-right: 0.05em;"><font style="vertical-align: inherit;">X </font></span></span><span class="MJXp-msubsup" id="MJXp-Span-50"><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-52" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;">j</font></span></span><span class="MJXp-mo" id="MJXp-Span-53" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"> - </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-55"><font style="vertical-align: inherit;">m </font></span><span class="MJXp-msubsup" id="MJXp-Span-56"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-57" style="margin-right: 0.05em;"><font style="vertical-align: inherit;">u </font></span></span><span class="MJXp-msubsup" id="MJXp-Span-56"><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-58" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;">j</font></span></span><span class="MJXp-mo" id="MJXp-Span-59" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"> ) </font></span><span class="MJXp-mo" id="MJXp-Span-60" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">] </font></span><span class="MJXp-mo" id="MJXp-Span-61" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;">= </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-62"><font style="vertical-align: inherit;">E </font></span><span class="MJXp-mo" id="MJXp-Span-63" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;">[ </font></span><span class="MJXp-msubsup" id="MJXp-Span-64"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-65" style="margin-right: 0.05em;"><font style="vertical-align: inherit;">X </font></span></span><span class="MJXp-msubsup" id="MJXp-Span-64"><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-66" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;">i </font></span></span><span class="MJXp-msubsup" id="MJXp-Span-67"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-68" style="margin-right: 0.05em;"><font style="vertical-align: inherit;">X </font></span></span><span class="MJXp-msubsup" id="MJXp-Span-67"><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-69" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;">j</font></span></span><span class="MJXp-mo" id="MJXp-Span-70" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"> ] </font></span><span class="MJXp-mo" id="MJXp-Span-71" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;">- </font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-73"><font style="vertical-align: inherit;">m </font></span><span class="MJXp-msubsup" id="MJXp-Span-74"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-75" style="margin-right: 0.05em;"><font style="vertical-align: inherit;">u </font></span></span><span class="MJXp-msubsup" id="MJXp-Span-74"><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-76" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;">i</font></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-78"><font style="vertical-align: inherit;"> m </font></span><span class="MJXp-msubsup" id="MJXp-Span-74"><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-76" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;">i </font></span></span><span class="MJXp-msubsup" id="MJXp-Span-79"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-80" style="margin-right: 0.05em;"><font style="vertical-align: inherit;">u </font></span></span><span class="MJXp-msubsup" id="MJXp-Span-79"><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-81" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;">j</font></span></span></font><span class="MJXp-mtext" id="MJXp-Span-43">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-44"><font style="vertical-align: inherit;"></font></span><span class="MJXp-msubsup" id="MJXp-Span-45"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-46" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-47" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mo" id="MJXp-Span-48" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-49" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-msubsup" id="MJXp-Span-50"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-51" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-52" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mo" id="MJXp-Span-53" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mtext" id="MJXp-Span-54">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-55"><font style="vertical-align: inherit;"></font></span><span class="MJXp-msubsup" id="MJXp-Span-56"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-57" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-58" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mo" id="MJXp-Span-59" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-60" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-61" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-62"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-63" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-msubsup" id="MJXp-Span-64"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-65" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-66" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-msubsup" id="MJXp-Span-67"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-68" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-69" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mo" id="MJXp-Span-70" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mo" id="MJXp-Span-71" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mtext" id="MJXp-Span-72">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-73"><font style="vertical-align: inherit;"></font></span><span class="MJXp-msubsup" id="MJXp-Span-74"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-75" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-76" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"></font></span></span><span class="MJXp-mtext" id="MJXp-Span-77">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-78"><font style="vertical-align: inherit;"></font></span><span class="MJXp-msubsup" id="MJXp-Span-79"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-80" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-81" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"></font></span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="66.476ex" height="2.78ex" viewBox="0 -832 28621.5 1197.1" role="img" focusable="false" style="vertical-align: -0.848ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-63" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-6F" x="433" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-76" x="919" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMAIN-28" x="1404" y="0"></use><g transform="translate(1794,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-58" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-69" x="1171" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMAIN-2C" x="2966" y="0"></use><g transform="translate(3411,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-58" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-6A" x="1171" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMAIN-29" x="4632" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMAIN-3D" x="5299" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-45" x="6355" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMAIN-5B" x="7120" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMAIN-28" x="7398" y="0"></use><g transform="translate(7788,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-58" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-69" x="1171" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMAIN-2212" x="9183" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-6D" x="10433" y="0"></use><g transform="translate(11312,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-75" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-69" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMAIN-29" x="12229" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMAIN-28" x="12618" y="0"></use><g transform="translate(13008,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-58" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-6A" x="1171" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMAIN-2212" x="14450" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-6D" x="15701" y="0"></use><g transform="translate(16579,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-75" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-6A" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMAIN-29" x="17544" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMAIN-5D" x="17933" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMAIN-3D" x="18489" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-45" x="19546" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMAIN-5B" x="20310" y="0"></use><g transform="translate(20589,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-58" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-69" x="1171" y="-213"></use></g><g transform="translate(21761,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-58" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-6A" x="1171" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMAIN-5D" x="22982" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMAIN-2212" x="23482" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-6D" x="24733" y="0"></use><g transform="translate(25612,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-75" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-69" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-6D" x="26778" y="0"></use><g transform="translate(27657,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-75" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-6A" x="809" y="-213"></use></g></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-6"> cov (X_i, X_j) = E [(X_i - \ mu_i) (X_j - \ mu_j)] = E [X_i X_j] - \ mu_i \ mu_j </script></p><br><p>  Where <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-82"><span class="MJXp-mtext" id="MJXp-Span-83">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-84"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">m </font></font></span><span class="MJXp-msubsup" id="MJXp-Span-85"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-86" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">u </font></font></span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-87" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.75ex" height="1.817ex" viewBox="0 -520.7 2045.3 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-6D" x="250" y="0"></use><g transform="translate(1128,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-75" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-69" x="809" y="-213"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-7"> \ mu_i </script>  - expectation <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-88"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-89"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">i</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.802ex" height="1.937ex" viewBox="0 -728.2 345.5 834" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-69" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-8"> i </script>  th sign. <br>  In this case, we note that the covariance is symmetric and the covariance of the vector with itself will be equal to its dispersion. </p><br><p>  Thus, the covariance matrix is ‚Äã‚Äãa symmetric matrix, where the dispersions of the corresponding signs lie on the diagonal, and outside the diagonal lie the covariances of the corresponding pairs of characters.  In the matrix form, where <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-90"><span class="MJXp-mtext" id="MJXp-Span-91">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-92">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-93">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-94">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-95">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-96">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-97">f</span><span class="MJXp-mrow" id="MJXp-Span-98"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-99">X</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.286ex" height="2.419ex" viewBox="0 -780.1 4428.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-74" x="1658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-68" x="2019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-62" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-66" x="3025" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-58" x="3576" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-9"> \ mathbf {X} </script>  this is a matrix of observations, our covariance matrix will look like </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-100"><span class="MJXp-mtext" id="MJXp-Span-101">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-102">S</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-103">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-104">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-105">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-106">a</span><span class="MJXp-mo" id="MJXp-Span-107" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-108">E</span><span class="MJXp-mo" id="MJXp-Span-109" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mo" id="MJXp-Span-110" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-111">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-112">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-113">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-114">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-115">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-116">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-117">f</span><span class="MJXp-mrow" id="MJXp-Span-118"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-119">X</span></span><span class="MJXp-mo" id="MJXp-Span-120" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-121">E</span><span class="MJXp-mo" id="MJXp-Span-122" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-123">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-124">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-125">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-126">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-127">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-128">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-129">f</span><span class="MJXp-mrow" id="MJXp-Span-130"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-131">X</span></span><span class="MJXp-mo" id="MJXp-Span-132" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-mo" id="MJXp-Span-133" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-134" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-135">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-136">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-137">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-138">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-139">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-140">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-141">f</span><span class="MJXp-mrow" id="MJXp-Span-142"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-143">X</span></span><span class="MJXp-mo" id="MJXp-Span-144" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-145">E</span><span class="MJXp-mo" id="MJXp-Span-146" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-147">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-148">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-149">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-150">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-151">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-152">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-153">f</span><span class="MJXp-mrow" id="MJXp-Span-154"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-155">X</span></span><span class="MJXp-mo" id="MJXp-Span-156" style="margin-left: 0em; margin-right: 0em;">]</span><span class="MJXp-msubsup" id="MJXp-Span-157"><span class="MJXp-mo" id="MJXp-Span-158" style="margin-left: 0em; margin-right: 0.05em;">)</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-159" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-160">T</span></span></span><span class="MJXp-mo" id="MJXp-Span-161" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="71.406ex" height="3.021ex" viewBox="0 -987.6 30744.1 1300.8" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-53" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-69" x="895" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-67" x="1241" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-6D" x="1721" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-61" x="2600" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMAIN-3D" x="3407" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-45" x="4463" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMAIN-5B" x="5228" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMAIN-28" x="5506" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-6D" x="6146" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-61" x="7024" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-74" x="7554" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-68" x="7915" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-62" x="8492" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-66" x="8921" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-58" x="9472" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMAIN-2212" x="10546" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-45" x="11547" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMAIN-5B" x="12312" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-6D" x="12840" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-61" x="13719" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-74" x="14248" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-68" x="14610" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-62" x="15186" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-66" x="15616" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-58" x="16166" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMAIN-5D" x="17019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMAIN-29" x="17297" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMAIN-28" x="17687" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-6D" x="18326" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-61" x="19205" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-74" x="19734" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-68" x="20096" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-62" x="20672" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-66" x="21102" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-58" x="21652" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMAIN-2212" x="22727" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-45" x="23727" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMAIN-5B" x="24492" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-6D" x="25020" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-61" x="25899" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-74" x="26428" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-68" x="26790" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-62" x="27366" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-66" x="27796" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-58" x="28346" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMAIN-5D" x="29199" y="0"></use><g transform="translate(29477,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMAIN-29" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-54" x="550" y="583"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMAIN-5D" x="30465" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-10"> \ Sigma = E [(\ mathbf {X} - E [\ mathbf {X}]) (\ mathbf {X} - E [\ mathbf {X}]) ^ {T}] </script></p><br><p>  To refresh the memory - matrices like linear operators have such an interesting property as eigenvalues ‚Äã‚Äãand eigenvectors (eigenvalues ‚Äã‚Äãand eigenvectors).  These pieces are remarkable in that when we act on the corresponding linear space with our matrix, the eigenvectors remain in place and are only multiplied by their corresponding eigenvalues.  That is, they define a subspace that, under the action of this matrix as a linear operator, remains in place or "goes into itself."  Formally own vector <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-162"><span class="MJXp-msubsup" id="MJXp-Span-163"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-164" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-165" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.464ex" height="1.817ex" viewBox="0 -520.7 1060.8 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-77" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-69" x="1013" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-11"> w_i </script>  with own value <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-166"><span class="MJXp-mtext" id="MJXp-Span-167">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-168">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-169">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-170">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-171">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-172">d</span><span class="MJXp-msubsup" id="MJXp-Span-173"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-174" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-175" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.787ex" height="2.419ex" viewBox="0 -780.1 3783.3 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-6C" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-61" x="548" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-6D" x="1078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-62" x="1956" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-64" x="2386" y="0"></use><g transform="translate(2909,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-69" x="748" y="-213"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-12"> \ lambda_i </script>  for matrix <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-176"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-177">M</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.442ex" height="2.057ex" viewBox="0 -780.1 1051.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-4D" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-13"> M </script>  simply defined as <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-178"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-179">M</span><span class="MJXp-msubsup" id="MJXp-Span-180"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-181" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-182" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-183" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-184">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-185">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-186">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-187">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-188">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-189">d</span><span class="MJXp-msubsup" id="MJXp-Span-190"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-191" style="margin-right: 0.05em;">a</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-192" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-msubsup" id="MJXp-Span-193"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-194" style="margin-right: 0.05em;">w</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-195" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="19.255ex" height="2.419ex" viewBox="0 -780.1 8290.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-4D" x="0" y="0"></use><g transform="translate(1051,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-77" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-69" x="1013" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMAIN-3D" x="2390" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-6C" x="3696" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-61" x="3994" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-6D" x="4524" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-62" x="5402" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-64" x="5832" y="0"></use><g transform="translate(6355,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-69" x="748" y="-213"></use></g><g transform="translate(7229,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-77" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-69" x="1013" y="-213"></use></g></g></svg></span><script type="math/tex" id="MathJax-Element-14"> M w_i = \ lambda_i w_i </script>  . </p><br><p>  Covariance matrix for our sample <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-196"><span class="MJXp-mtext" id="MJXp-Span-197">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-198">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-199">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-200">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-201">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-202">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-203">f</span><span class="MJXp-mrow" id="MJXp-Span-204"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-205">X</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.286ex" height="2.419ex" viewBox="0 -780.1 4428.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-74" x="1658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-68" x="2019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-62" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-66" x="3025" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-58" x="3576" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-15"> \ mathbf {X} </script>  can be represented as a work <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-206"><span class="MJXp-mtext" id="MJXp-Span-207">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-208">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-209">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-210">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-211">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-212">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-213">f</span><span class="MJXp-msubsup" id="MJXp-Span-214"><span class="MJXp-mrow" id="MJXp-Span-215" style="margin-right: 0.05em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-216">X</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-217" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-218">T</span></span></span><span class="MJXp-mtext" id="MJXp-Span-219">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-220">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-221">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-222">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-223">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-224">b</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-225">f</span><span class="MJXp-mrow" id="MJXp-Span-226"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-227">X</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="21.977ex" height="2.901ex" viewBox="0 -987.6 9462.4 1249" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-74" x="1658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-68" x="2019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-62" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-66" x="3025" y="0"></use><g transform="translate(3576,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-58" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-54" x="1215" y="581"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-6D" x="5283" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-61" x="6162" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-74" x="6691" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-68" x="7053" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-62" x="7629" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-66" x="8059" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-58" x="8609" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-16"> \ mathbf {X} ^ {T} \ mathbf {X} </script>  .  From <a href="https://ru.wikipedia.org/wiki/%25D0%259E%25D1%2582%25D0%25BD%25D0%25BE%25D1%2588%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5_%25D0%25A0%25D1%258D%25D0%25BB%25D0%25B5%25D1%258F">the Rayleigh relation it</a> follows that the maximum variation of our data set will be achieved along the eigenvector of this matrix, corresponding to the maximum eigenvalue.  Thus, the main components on which we would like to project our data are simply the eigenvectors of the corresponding top <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-228"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-229">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.211ex" height="2.057ex" viewBox="0 -780.1 521.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-6B" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-17"> k </script>  pieces of eigenvalues ‚Äã‚Äãof this matrix. </p><br><p>  Further steps are simple to disgrace - you just need to multiply our data matrix on these components and we get the projection of our data in the orthogonal basis of these components.  Now, if we transpose our data matrix and the matrix of principal component vectors, we will restore the original sample in the space from which we projected onto the components.  If the number of components was less than the dimension of the original space, we will lose some of the information with this conversion. </p><br><h3 id="primery-ispolzovaniya">  Examples of using </h3><br><h3 id="nabor-dannyh-po-cvetkam-irisa">  Iris flowers data set </h3><br><p>  To begin with, we will load all the necessary modules and twist the usual dataset with irises, following the example from the documentation of the scikit-learn package. </p><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> matplotlib.pyplot <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> plt <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> seaborn <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> sns; sns.set(style=<span class="hljs-string"><span class="hljs-string">'white'</span></span>) %matplotlib inline <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> decomposition <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> datasets <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> mpl_toolkits.mplot3d <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Axes3D <span class="hljs-comment"><span class="hljs-comment">#    iris = datasets.load_iris() X = iris.data y = iris.target #     fig = plt.figure(1, figsize=(6, 5)) plt.clf() ax = Axes3D(fig, rect=[0, 0, .95, 1], elev=48, azim=134) plt.cla() for name, label in [('Setosa', 0), ('Versicolour', 1), ('Virginica', 2)]: ax.text3D(X[y == label, 0].mean(), X[y == label, 1].mean() + 1.5, X[y == label, 2].mean(), name, horizontalalignment='center', bbox=dict(alpha=.5, edgecolor='w', facecolor='w')) #    ,     y_clr = np.choose(y, [1, 2, 0]).astype(np.float) ax.scatter(X[:, 0], X[:, 1], X[:, 2], c=y_clr, cmap=plt.cm.spectral) ax.w_xaxis.set_ticklabels([]) ax.w_yaxis.set_ticklabels([]) ax.w_zaxis.set_ticklabels([])</span></span></code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/files/81a/df2/7b7/81adf27b70c741e29841d1cff3064992.png" width="400"></div><br><p>  Now let's see how PCA improves the results for the model, which in this case will not cope with the classification due to the fact that it does not have enough difficulty to describe the data: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.tree <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> DecisionTreeClassifier <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.model_selection <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> train_test_split <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.metrics <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> accuracy_score, roc_auc_score <span class="hljs-comment"><span class="hljs-comment">#       X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=.3, stratify=y, random_state=42) #       clf = DecisionTreeClassifier(max_depth=2, random_state=42) clf.fit(X_train, y_train) preds = clf.predict_proba(X_test) print('Accuracy: {:.5f}'.format(accuracy_score(y_test, preds.argmax(axis=1))))</span></span></code> </pre> <br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">Out</span></span>: Accuracy: <span class="hljs-number"><span class="hljs-number">0.88889</span></span></code> </pre> <br><p>  Now let's try to do the same, but with the data for which we have reduced the dimension to 2D: </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#    sklearn PCA pca = decomposition.PCA(n_components=2) X_centered = X - X.mean(axis=0) pca.fit(X_centered) X_pca = pca.transform(X_centered) #         plt.plot(X_pca[y == 0, 0], X_pca[y == 0, 1], 'bo', label='Setosa') plt.plot(X_pca[y == 1, 0], X_pca[y == 1, 1], 'go', label='Versicolour') plt.plot(X_pca[y == 2, 0], X_pca[y == 2, 1], 'ro', label='Virginica') plt.legend(loc=0);</span></span></code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/files/05c/df6/4b4/05cdf64b44514a0f9617e8e1a0688ea9.png" width="400"></div><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#          . X_train, X_test, y_train, y_test = train_test_split(X_pca, y, test_size=.3, stratify=y, random_state=42) clf = DecisionTreeClassifier(max_depth=2, random_state=42) clf.fit(X_train, y_train) preds = clf.predict_proba(X_test) print('Accuracy: {:.5f}'.format(accuracy_score(y_test, preds.argmax(axis=1))))</span></span></code> </pre> <br><p>  We look at the increased accuracy of classification: </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">Out</span></span>: Accuracy: <span class="hljs-number"><span class="hljs-number">0.91111</span></span></code> </pre> <br><p>  It can be seen that the quality has increased slightly, but for more complex data of a higher dimension, where the data is not broken trivially along a single attribute, the use of PCA can significantly improve the quality of operation of decision trees and ensembles based on them. </p><br><p>  Let's look at the 2 main components in the latest PCA representation of the data and the percentage of the initial variance in the data, which they "explain". </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i, component <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> enumerate(pca.components_): print(<span class="hljs-string"><span class="hljs-string">"{} component: {}% of initial variance"</span></span>.format(i + <span class="hljs-number"><span class="hljs-number">1</span></span>, round(<span class="hljs-number"><span class="hljs-number">100</span></span> * pca.explained_variance_ratio_[i], <span class="hljs-number"><span class="hljs-number">2</span></span>))) print(<span class="hljs-string"><span class="hljs-string">" + "</span></span>.join(<span class="hljs-string"><span class="hljs-string">"%.3f x %s"</span></span> % (value, name) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> value, name <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> zip(component, iris.feature_names)))</code> </pre> <br><pre> <code class="hljs pgsql"><span class="hljs-number"><span class="hljs-number">1</span></span> component: <span class="hljs-number"><span class="hljs-number">92.46</span></span>% <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> initial variance <span class="hljs-number"><span class="hljs-number">0.362</span></span> x sepal length (cm) + <span class="hljs-number"><span class="hljs-number">-0.082</span></span> x sepal width (cm) + <span class="hljs-number"><span class="hljs-number">0.857</span></span> x petal length (cm) + <span class="hljs-number"><span class="hljs-number">0.359</span></span> x petal width (cm) <span class="hljs-number"><span class="hljs-number">2</span></span> component: <span class="hljs-number"><span class="hljs-number">5.3</span></span>% <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> initial variance <span class="hljs-number"><span class="hljs-number">0.657</span></span> x sepal length (cm) + <span class="hljs-number"><span class="hljs-number">0.730</span></span> x sepal width (cm) + <span class="hljs-number"><span class="hljs-number">-0.176</span></span> x petal length (cm) + <span class="hljs-number"><span class="hljs-number">-0.075</span></span> x petal width (cm)</code> </pre> <br><h4 id="nabor-dannyh-po-rukopisnym-cifram">  Handwritten Number Data Set </h4><br><p>  Now take a set of handwritten numbers.  We already worked with him in <a href="https://habrahabr.ru/company/ods/blog/322534/">article</a> 3 about decision trees and the method of nearest neighbors. </p><br><pre> <code class="python hljs">digits = datasets.load_digits() X = digits.data y = digits.target</code> </pre> <br><p>  Recall what these numbers look like - let's look at the first ten.  The pictures here are represented by an 8 x 8 matrix (the intensities of white for each pixel).  Further, this matrix "unfolds" into a vector of length 64, a characteristic description of the object is obtained. </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># f, axes = plt.subplots(5, 2, sharey=True, figsize=(16,6)) plt.figure(figsize=(16, 6)) for i in range(10): plt.subplot(2, 5, i + 1) plt.imshow(X[i,:].reshape([8,8]));</span></span></code> </pre> <br><p><img src="https://habrastorage.org/files/a3d/d4f/7ac/a3dd4f7acc494b32913a329f5c88878a.png" alt="mnist"></p><br><p>  It turns out that the dimension of the attribute space here is 64. But let's reduce the dimension to only 2 and see that even by eye, the handwritten numbers are well divided into clusters. </p><br><pre> <code class="python hljs">pca = decomposition.PCA(n_components=<span class="hljs-number"><span class="hljs-number">2</span></span>) X_reduced = pca.fit_transform(X) print(<span class="hljs-string"><span class="hljs-string">'Projecting %d-dimensional data to 2D'</span></span> % X.shape[<span class="hljs-number"><span class="hljs-number">1</span></span>]) plt.figure(figsize=(<span class="hljs-number"><span class="hljs-number">12</span></span>,<span class="hljs-number"><span class="hljs-number">10</span></span>)) plt.scatter(X_reduced[:, <span class="hljs-number"><span class="hljs-number">0</span></span>], X_reduced[:, <span class="hljs-number"><span class="hljs-number">1</span></span>], c=y, edgecolor=<span class="hljs-string"><span class="hljs-string">'none'</span></span>, alpha=<span class="hljs-number"><span class="hljs-number">0.7</span></span>, s=<span class="hljs-number"><span class="hljs-number">40</span></span>, cmap=plt.cm.get_cmap(<span class="hljs-string"><span class="hljs-string">'nipy_spectral'</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>)) plt.colorbar() plt.title(<span class="hljs-string"><span class="hljs-string">'MNIST. PCA projection'</span></span>)</code> </pre> <br><p><img src="https://habrastorage.org/files/e03/cad/705/e03cad70566941a2984f485dd6b069e2.png" alt="pca"></p><br><p>  Well, the truth is, the picture is even better with t-SNE, since the PCA has a limitation - it only finds linear combinations of the original features.  But even on this relatively small data set, you can see how much t-SNE works longer. </p><br><pre> <code class="python hljs">%%time <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.manifold <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> TSNE tsne = TSNE(random_state=<span class="hljs-number"><span class="hljs-number">17</span></span>) X_tsne = tsne.fit_transform(X) plt.figure(figsize=(<span class="hljs-number"><span class="hljs-number">12</span></span>,<span class="hljs-number"><span class="hljs-number">10</span></span>)) plt.scatter(X_tsne[:, <span class="hljs-number"><span class="hljs-number">0</span></span>], X_tsne[:, <span class="hljs-number"><span class="hljs-number">1</span></span>], c=y, edgecolor=<span class="hljs-string"><span class="hljs-string">'none'</span></span>, alpha=<span class="hljs-number"><span class="hljs-number">0.7</span></span>, s=<span class="hljs-number"><span class="hljs-number">40</span></span>, cmap=plt.cm.get_cmap(<span class="hljs-string"><span class="hljs-string">'nipy_spectral'</span></span>, <span class="hljs-number"><span class="hljs-number">10</span></span>)) plt.colorbar() plt.title(<span class="hljs-string"><span class="hljs-string">'MNIST. t-SNE projection'</span></span>)</code> </pre> <br><p><img src="https://habrastorage.org/files/1cf/a69/7c9/1cfa697c919349c2afae344f566e0b03.png" alt="tsne"></p><br><p>  In practice, as a rule, so many principal components are chosen to leave 90% of the variance of the original data.  In this case, it is enough to select 21 main components, that is, to reduce the dimension from 64 features to 21. </p><br><pre> <code class="python hljs">pca = decomposition.PCA().fit(X) plt.figure(figsize=(<span class="hljs-number"><span class="hljs-number">10</span></span>,<span class="hljs-number"><span class="hljs-number">7</span></span>)) plt.plot(np.cumsum(pca.explained_variance_ratio_), color=<span class="hljs-string"><span class="hljs-string">'k'</span></span>, lw=<span class="hljs-number"><span class="hljs-number">2</span></span>) plt.xlabel(<span class="hljs-string"><span class="hljs-string">'Number of components'</span></span>) plt.ylabel(<span class="hljs-string"><span class="hljs-string">'Total explained variance'</span></span>) plt.xlim(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">63</span></span>) plt.yticks(np.arange(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1.1</span></span>, <span class="hljs-number"><span class="hljs-number">0.1</span></span>)) plt.axvline(<span class="hljs-number"><span class="hljs-number">21</span></span>, c=<span class="hljs-string"><span class="hljs-string">'b'</span></span>) plt.axhline(<span class="hljs-number"><span class="hljs-number">0.9</span></span>, c=<span class="hljs-string"><span class="hljs-string">'r'</span></span>) plt.show();</code> </pre> <br><p><img src="https://habrastorage.org/files/c34/039/bb7/c34039bb7993434e84ce3c5933a539cf.png" alt="variance"></p><br><h2 id="2-klasterizaciya">  2. Clustering </h2><br><p>  The intuitive formulation of the clustering problem is quite simple and is our desire to say: "Here I have points. I see that they fall into some piles together. It would be cool to be able to refer these points to piles in the case of new the points on the plane say which pile it falls into. "  From this formulation, it is clear that there is a lot of space for fantasy, and this results in a corresponding set of algorithms for solving this problem.  The listed algorithms do not in any way describe this set completely, but are examples of the most popular methods for solving the clustering problem. </p><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/8b9/ae5/586/8b9ae55861f22a2809e8b3a00ef815ad.png"></div><br>  Examples of operation of clustering algorithms from the scikit-learn package documentation <br><h3 id="k-means">  K-means </h3><br><p>  The K-means algorithm is probably the most popular and simple clustering algorithm and is very easily represented as a simple pseudo-code: </p><br><ol><li>  Select the number of clusters <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-230"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-231">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.211ex" height="2.057ex" viewBox="0 -780.1 521.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-6B" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-18"> k </script>  which seems to us optimal for our data. </li><li>  Pour randomly into our data space. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-232"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-233">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processed" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.211ex" height="2.057ex" viewBox="0 -780.1 521.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-6B" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-19"> k </script>  points (centroids). </li><li>  For each point of our data set, calculate which centroid it is closer to. </li><li>  Move each centroid to the center of the sample, which we attributed to this centroid. </li><li>  Repeat the last two steps a fixed number of times, or until the centroids "converge" (this usually means that their displacement from the previous position does not exceed a predetermined small value). </li></ol><br><p>  In the case of an ordinary Euclidean metric for points lying on a plane, this algorithm is very simply written analytically and drawn.  Let's see the corresponding example: </p><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#   ,        X = np.zeros((150, 2)) np.random.seed(seed=42) X[:50, 0] = np.random.normal(loc=0.0, scale=.3, size=50) X[:50, 1] = np.random.normal(loc=0.0, scale=.3, size=50) X[50:100, 0] = np.random.normal(loc=2.0, scale=.5, size=50) X[50:100, 1] = np.random.normal(loc=-1.0, scale=.2, size=50) X[100:150, 0] = np.random.normal(loc=-1.0, scale=.2, size=50) X[100:150, 1] = np.random.normal(loc=2.0, scale=.5, size=50) plt.figure(figsize=(5, 5)) plt.plot(X[:, 0], X[:, 1], 'bo');</span></span></code> </pre> <br><img src="https://habrastorage.org/files/565/72b/72f/56572b72f3ef4cd3bcd4d926d35fe4de.png" width="400"><br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#  scipy   ,    #      ,     from scipy.spatial.distance import cdist #          np.random.seed(seed=42) centroids = np.random.normal(loc=0.0, scale=1., size=6) centroids = centroids.reshape((3, 2)) cent_history = [] cent_history.append(centroids) for i in range(3): #       distances = cdist(X, centroids) # ,        labels = distances.argmin(axis=1) #          centroids = centroids.copy() centroids[0, :] = np.mean(X[labels == 0, :], axis=0) centroids[1, :] = np.mean(X[labels == 1, :], axis=0) centroids[2, :] = np.mean(X[labels == 2, :], axis=0) cent_history.append(centroids)</span></span></code> </pre> <br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#       plt.figure(figsize=(8, 8)) for i in range(4): distances = cdist(X, cent_history[i]) labels = distances.argmin(axis=1) plt.subplot(2, 2, i + 1) plt.plot(X[labels == 0, 0], X[labels == 0, 1], 'bo', label='cluster #1') plt.plot(X[labels == 1, 0], X[labels == 1, 1], 'co', label='cluster #2') plt.plot(X[labels == 2, 0], X[labels == 2, 1], 'mo', label='cluster #3') plt.plot(cent_history[i][:, 0], cent_history[i][:, 1], 'rX') plt.legend(loc=0) plt.title('Step {:}'.format(i + 1));</span></span></code> </pre> <br><img src="https://habrastorage.org/files/f86/352/e26/f86352e26fed47119d2abb4bd4028666.png" width="400"><br><p>  It is also worth noting that even though we considered the Euclidean distance, the algorithm will converge in the case of any other metric, so for various clustering problems, depending on the data, you can experiment not only with the number of steps or the convergence criterion, but also with the metric we consider the distances between points and centroids of clusters. </p><br><p>  Another feature of this algorithm is that it is sensitive to the initial position of the centroid of the clusters in space.  In such a situation, several consecutive runs of the algorithm are rescued, followed by averaging of the resulting clusters. </p><br><h4 id="vybor-chisla-klasterov-dlya-kmeans">  Select the number of clusters for kMeans </h4><br><p>  Unlike the problem of classification or regression, in the case of clustering it is more difficult to choose a criterion by which it would be easy to present the clustering problem as an optimization problem. <br>  In the case of kMeans, the following criterion is common - the sum of squares of distances from points to the centroids of the clusters to which they relate. </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-234"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-235">J</span><span class="MJXp-mo" id="MJXp-Span-236" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-237">C</span><span class="MJXp-mo" id="MJXp-Span-238" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-239" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-240">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-241">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-242">u</span><span class="MJXp-msubsup" id="MJXp-Span-243"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-244" style="margin-right: 0.05em;">m</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-249">K</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-245"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-246">k</span><span class="MJXp-mo" id="MJXp-Span-247">=</span><span class="MJXp-mn" id="MJXp-Span-248">1</span></span></span></span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-250">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-251">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-252">u</span><span class="MJXp-msubsup" id="MJXp-Span-253"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-254" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-255" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-256">i</span><span class="MJXp-mtext" id="MJXp-Span-257">&nbsp;</span><span class="MJXp-mtext" id="MJXp-Span-258">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-259">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-260">n</span><span class="MJXp-mtext" id="MJXp-Span-261">&nbsp;</span><span class="MJXp-msubsup" id="MJXp-Span-262"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-263" style="margin-right: 0.05em;">C</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-264" style="vertical-align: -0.4em;">k</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-265"><span class="MJXp-mo" id="MJXp-Span-266" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-267"><span class="MJXp-mo" id="MJXp-Span-268" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-269"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-270" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-271" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-272" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-273">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-274">m</span><span class="MJXp-msubsup" id="MJXp-Span-275"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-276" style="margin-right: 0.05em;">u</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-277" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mrow" id="MJXp-Span-278"><span class="MJXp-mo" id="MJXp-Span-279" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-280"><span class="MJXp-mrow" id="MJXp-Span-281" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-282" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-283" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-284">2</span></span></span><span class="MJXp-mtext" id="MJXp-Span-285">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-286">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-287">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-288">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-289">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-290">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-291">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-292">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-293">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-294">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-295">w</span><span class="MJXp-mtext" id="MJXp-Span-296">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-297">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-298">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-299">n</span><span class="MJXp-mtext" id="MJXp-Span-300">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-301">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-302">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-303">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-304">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-305">t</span><span class="MJXp-msubsup" id="MJXp-Span-306"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-307" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-308" style="vertical-align: -0.4em;">C</span></span><span class="MJXp-mo" id="MJXp-Span-309" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processed" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="66.749ex" height="3.383ex" viewBox="0 -1039.5 28739 1456.5" role="img" focusable="false" style="vertical-align: -0.969ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-4A" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMAIN-28" x="633" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-43" x="1023" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMAIN-29" x="1783" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMAIN-3D" x="2450" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-73" x="3757" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-75" x="4226" y="0"></use><g transform="translate(4799,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-4B" x="1242" y="488"></use><g transform="translate(878,-327)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-6B" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMAIN-3D" x="521" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMAIN-31" x="1300" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-73" x="7300" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-75" x="7770" y="0"></use><g transform="translate(8342,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-6D" x="0" y="0"></use><g transform="translate(878,-155)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-69" x="1052" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-6E" x="1398" y="0"></use><g transform="translate(1663,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-43" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-6B" x="1011" y="-213"></use></g></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMAIN-7C" x="11821" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMAIN-7C" x="12100" y="0"></use><g transform="translate(12378,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-69" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMAIN-2212" x="13517" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-6D" x="14768" y="0"></use><g transform="translate(15647,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-75" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-6B" x="809" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMAIN-7C" x="16688" y="0"></use><g transform="translate(16966,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMAIN-7C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMAIN-32" x="393" y="675"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-72" x="17949" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-69" x="18400" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-67" x="18746" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-68" x="19226" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-74" x="19803" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-61" x="20164" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-72" x="20694" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-72" x="21145" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-6F" x="21597" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-77" x="22082" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-6D" x="23049" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-69" x="23927" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-6E" x="24273" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-6C" x="25123" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-69" x="25422" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-6D" x="25767" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-69" x="26646" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-74" x="26991" y="0"></use><g transform="translate(27353,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMATHI-43" x="663" y="-219"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/ods/blog/325654/&amp;xid=17259,15700019,15700186,15700190,15700248,15700253&amp;usg=ALkJrhhbCP9ETJEFq73ys3LOVA6lp7FW4A#MJMAIN-2C" x="28460" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-20"> J (C) = \ sum_ {k = 1} ^ K \ sum_ {i ~ \ in ~ C_k} || x_i - \ mu_k || ^ {2} \ rightarrow \ min \ limits_C, </script></p><br><p>  here <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-310"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-311">C</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-21"> C </script>  - many power clusters <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-312"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-313">K</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-22"> K </script>  , <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-314"><span class="MJXp-mtext" id="MJXp-Span-315">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-316">m</span><span class="MJXp-msubsup" id="MJXp-Span-317"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-318" style="margin-right: 0.05em;">u</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-319" style="vertical-align: -0.4em;">k</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-23"> \ mu_k </script>  - cluster centroid <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-320"><span class="MJXp-msubsup" id="MJXp-Span-321"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-322" style="margin-right: 0.05em;">C</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-323" style="vertical-align: -0.4em;">k</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-24"> C_k </script>  . </p><br><p>  It is clear that there is common sense in this: we want the points to be located in a heap near the centers of their clusters.  But here's the ill luck: the minimum of such a functional will be achieved when there are as many clusters as there are points (that is, each point is a cluster of one element). <br>  To solve this issue (choosing the number of clusters), heuristics are often used: choose the number of clusters starting from which the described functional <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-324"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-325">J</span><span class="MJXp-mo" id="MJXp-Span-326" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-327">c</span><span class="MJXp-mo" id="MJXp-Span-328" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-25"> J (c) </script>  falls "not so fast anymore."  Or more formally: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-329"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-330">D</span><span class="MJXp-mo" id="MJXp-Span-331" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-332">k</span><span class="MJXp-mo" id="MJXp-Span-333" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-334" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-335">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-336">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-337">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-338">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-339">c</span><span class="MJXp-mrow" id="MJXp-Span-340"><span class="MJXp-mrow" id="MJXp-Span-341"><span class="MJXp-mo" id="MJXp-Span-342" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-343">J</span><span class="MJXp-mo" id="MJXp-Span-344" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-345"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-346" style="margin-right: 0.05em;">C</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-347" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-348" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-349" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-350">J</span><span class="MJXp-mo" id="MJXp-Span-351" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-352"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-353" style="margin-right: 0.05em;">C</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-354" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-355">k</span><span class="MJXp-mo" id="MJXp-Span-356">+</span><span class="MJXp-mn" id="MJXp-Span-357">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-358" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-359"><span class="MJXp-mo" id="MJXp-Span-360" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span><span class="MJXp-mrow" id="MJXp-Span-361"><span class="MJXp-mrow" id="MJXp-Span-362"><span class="MJXp-mo" id="MJXp-Span-363" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-364">J</span><span class="MJXp-mo" id="MJXp-Span-365" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-366"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-367" style="margin-right: 0.05em;">C</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-368" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-369">k</span><span class="MJXp-mo" id="MJXp-Span-370">‚àí</span><span class="MJXp-mn" id="MJXp-Span-371">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-372" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-373" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-374">J</span><span class="MJXp-mo" id="MJXp-Span-375" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-376"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-377" style="margin-right: 0.05em;">C</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-378" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-379" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-380"><span class="MJXp-mo" id="MJXp-Span-381" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span><span class="MJXp-mtext" id="MJXp-Span-382">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-383">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-384">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-385">g</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-386">h</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-387">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-388">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-389">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-390">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-391">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-392">w</span><span class="MJXp-mtext" id="MJXp-Span-393">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-394">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-395">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-396">n</span><span class="MJXp-mtext" id="MJXp-Span-397">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-398">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-399">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-400">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-401">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-402">t</span><span class="MJXp-msubsup" id="MJXp-Span-403"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-404" style="margin-right: 0.05em;">s</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-405" style="vertical-align: -0.4em;">k</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-26"> D (k) = \ frac {| J (C_k) - J (C_ {k + 1}) |} {| J (C_ {k-1}) - J (C_k) |} \ rightarrow \ min \ limits_k </script></p><br><p>  Consider an example. </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.cluster <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> KMeans inertia = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> k <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> range(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>): kmeans = KMeans(n_clusters=k, random_state=<span class="hljs-number"><span class="hljs-number">1</span></span>).fit(X) inertia.append(np.sqrt(kmeans.inertia_)) plt.plot(range(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">8</span></span>), inertia, marker=<span class="hljs-string"><span class="hljs-string">'s'</span></span>); plt.xlabel(<span class="hljs-string"><span class="hljs-string">'$k$'</span></span>) plt.ylabel(<span class="hljs-string"><span class="hljs-string">'$J(C_k)$'</span></span>);</code> </pre> <br><p><img src="https://habrastorage.org/files/1b0/46d/9bd/1b046d9bd6684ff5a84a6a4e1480156e.png" alt="elbow"></p><br><p>  See that <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-406"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-407">J</span><span class="MJXp-mo" id="MJXp-Span-408" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-409"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-410" style="margin-right: 0.05em;">C</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-411" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-412" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-27"> J (C_k) </script>  falls strongly with increasing number of clusters from 1 to 2 and from 2 to 3 and not so much anymore when changing <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-413"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-414">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-28"> k </script>  from 3 to 4. Hence, in this problem, it is optimal to specify 3 clusters. </p><br><h4 id="slozhnosti">  Difficulties </h4><br><p>  In itself, the solution of the K-means problem is NP-hard (NP-hard), and for the dimension <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-415"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-416">d</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-29"> d </script>  cluster numbers <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-417"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-418">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-30"> k </script>  and numbers of points <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-419"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-420">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-31"> n </script>  is decided for <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-421"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-422">O</span><span class="MJXp-mo" id="MJXp-Span-423" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-424"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-425" style="margin-right: 0.05em;">n</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-426" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-427">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-428">k</span><span class="MJXp-mo" id="MJXp-Span-429">+</span><span class="MJXp-mn" id="MJXp-Span-430">1</span></span></span><span class="MJXp-mo" id="MJXp-Span-431" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-32"> O (n ^ {d k + 1}) </script>  .  To solve this pain, heuristics are often used, for example, MiniBatch K-means, which does not use all datasets for learning, but only small portions (batch) and updates centroids using the average of all centroid updates from all points related to it.  A comparison of the usual K-means and its MiniBatch implementation can be found in the <a href="http://scikit-learn.org/stable/auto_examples/cluster/plot_mini_batch_kmeans.html">scikit-learn documentation</a> . </p><br><p>  <a href="http://scikit-learn.org/stable/modules/generated/sklearn.cluster.KMeans.html">The implementation of the</a> algorithm in scikit-learn has a lot of convenient buns, such as the ability to specify the number of launches via the <code>n_init</code> parameter, which will give more stable centroids for clusters in the case of skewed data.  In addition, these launches can be done in parallel, without sacrificing computation time. </p><br><h3 id="affinity-propagation">  Affinity propagation </h3><br><p>  Another example of a clustering algorithm.  Unlike the K-means algorithm, this approach does not require determining in advance the number of clusters into which we want to split our data.  The basic idea of ‚Äã‚Äãthe algorithm is that we would like our observations to cluster in groups based on how they ‚Äúcommunicate‚Äù or how similar they are to each other. </p><br><p>  Let's create for this some metric of "similarity", determined by the fact that <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-432"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-433">s</span><span class="MJXp-mo" id="MJXp-Span-434" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-435"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-436" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-437" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-438" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-439"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-440" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-441" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-442" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-443" style="margin-left: 0.333em; margin-right: 0.333em;">&gt;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-444">s</span><span class="MJXp-mo" id="MJXp-Span-445" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-446"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-447" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-448" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-449" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-450"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-451" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-452" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-453" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-33-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-33"> s (x_i, x_j)> s (x_i, x_k) </script>  if observation <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-454"><span class="MJXp-msubsup" id="MJXp-Span-455"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-456" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-457" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-34-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-34"> x_i </script>  more like observation <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-458"><span class="MJXp-msubsup" id="MJXp-Span-459"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-460" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-461" style="vertical-align: -0.4em;">j</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-35-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-35"> x_j </script>  than on <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-462"><span class="MJXp-msubsup" id="MJXp-Span-463"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-464" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-465" style="vertical-align: -0.4em;">k</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-36-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-36"> x_k </script>  .  A simple example of this similarity would be the negative square of the distance. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-466"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-467">s</span><span class="MJXp-mo" id="MJXp-Span-468" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-469"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-470" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-471" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-472" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-473"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-474" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-475" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-476" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-477" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-478" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mrow" id="MJXp-Span-479"><span class="MJXp-mo" id="MJXp-Span-480" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-481"><span class="MJXp-mo" id="MJXp-Span-482" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-483"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-484" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-485" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-486" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-487"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-488" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-489" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mrow" id="MJXp-Span-490"><span class="MJXp-mo" id="MJXp-Span-491" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-492"><span class="MJXp-mrow" id="MJXp-Span-493" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-494" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-495" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-496">2</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-37-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-37"> s (x_i, x_j) = - || x_i - x_j || ^ {2} </script>  . </p><br><p>  Now we describe the process of "communication".  To do this, we create two matrices initialized with zeros, one of which <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-497"><span class="MJXp-msubsup" id="MJXp-Span-498"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-499" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-500" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-501">i</span><span class="MJXp-mo" id="MJXp-Span-502">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-503">k</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-38-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-38"> r_ {i, k} </script>  will describe how good <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-504"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-505">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-39-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-39"> k </script>  -th observation is suitable to be a "role model" for <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-506"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-507">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-40-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-40"> i </script>  of this observation in relation to all other potential "examples", and the second - <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-508"><span class="MJXp-msubsup" id="MJXp-Span-509"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-510" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-511" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-512">i</span><span class="MJXp-mo" id="MJXp-Span-513">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-514">k</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-41-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-41"> a_ {i, k} </script>  will describe how correct it would be for <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-515"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-516">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-42-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-42"> i </script>  of that observation to choose <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-517"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-518">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-43-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-43"> k </script>  The second is as such an example.  It sounds a bit confusing, but a little further we will see an example ‚Äúon the fingers‚Äù. </p><br><p>  After that, the matrix data is updated in turn by the rules: </p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-519"><span class="MJXp-merror" id="MJXp-Span-520"><span class="MJXp-mtext" id="MJXp-Span-521">r_&nbsp;{i,&nbsp;k}&nbsp;\&nbsp;leftarrow&nbsp;s_&nbsp;(x_i,&nbsp;x_k)&nbsp;-&nbsp;\&nbsp;max_&nbsp;{k&nbsp;'\&nbsp;neq&nbsp;k}&nbsp;\&nbsp;left&nbsp;\&nbsp;{a_&nbsp;{i,&nbsp;k'}&nbsp;+&nbsp;s&nbsp;(x_i,&nbsp;x_k&nbsp;')&nbsp;\&nbsp;right&nbsp;\}</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-44-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-44"> r_ {i, k} \ leftarrow s_ (x_i, x_k) - \ max_ {k '\ neq k} \ left \ {a_ {i, k'} + s (x_i, x_k ') \ right \} </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-522"><span class="MJXp-merror" id="MJXp-Span-523"><span class="MJXp-mtext" id="MJXp-Span-524">a_&nbsp;{i,&nbsp;k}&nbsp;\&nbsp;leftarrow&nbsp;\&nbsp;min&nbsp;\&nbsp;left&nbsp;(0,&nbsp;r_&nbsp;{k,&nbsp;k}&nbsp;+&nbsp;\&nbsp;sum_&nbsp;{i&nbsp;'\&nbsp;not&nbsp;\&nbsp;in&nbsp;\&nbsp;{i,&nbsp;k&nbsp;\}}&nbsp;\&nbsp;max&nbsp;(0,&nbsp;r_&nbsp;{i',&nbsp;k})&nbsp;\&nbsp;right),&nbsp;\&nbsp;\&nbsp;\&nbsp;i&nbsp;\&nbsp;neq&nbsp;k</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-45-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-45"> a_ {i, k} \ leftarrow \ min \ left (0, r_ {k, k} + \ sum_ {i '\ not \ in \ {i, k \}} \ max (0, r_ {i', k}) \ right), \ \ \ i \ neq k </script></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-525"><span class="MJXp-msubsup" id="MJXp-Span-526"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-527" style="margin-right: 0.05em;">a</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-528" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-529">k</span><span class="MJXp-mo" id="MJXp-Span-530">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-531">k</span></span></span><span class="MJXp-mtext" id="MJXp-Span-532">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-533">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-534">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-535">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-536">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-537">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-538">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-539">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-540">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-541">w</span><span class="MJXp-mtext" id="MJXp-Span-542">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-543">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-544">u</span><span class="MJXp-msubsup" id="MJXp-Span-545"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-546" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-547" style="vertical-align: -0.4em;"><span class="MJXp-msup" id="MJXp-Span-548"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-549" style="margin-right: 0.05em;">i</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-550" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mtext" id="MJXp-Span-551">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-552">n</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-553">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-554">q</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-555">k</span></span></span><span class="MJXp-mtext" id="MJXp-Span-556">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-557">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-558">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-559">x</span><span class="MJXp-mo" id="MJXp-Span-560" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mn" id="MJXp-Span-561">0</span><span class="MJXp-mo" id="MJXp-Span-562" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-563"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-564" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-565" style="vertical-align: -0.4em;"><span class="MJXp-msup" id="MJXp-Span-566"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-567" style="margin-right: 0.05em;">i</span><span class="MJXp-mo MJXp-script" id="MJXp-Span-568" style="vertical-align: 0.5em;">‚Ä≤</span></span><span class="MJXp-mo" id="MJXp-Span-569">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-570">k</span></span></span><span class="MJXp-mo" id="MJXp-Span-571" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-46-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-46"> a_ {k, k} \ leftarrow \ sum_ {i '\ neq k} \ max (0, r_ {i', k}) </script></p><br><h3 id="spektralnaya-klasterizaciya">  Spectral clustering </h3><br><p>  Spectral clustering combines several approaches described above to get the maximum amount of profit from complex manifolds of dimension less than the original space. </p><br><p>  For this algorithm to work, we will need to define an adjacency matrix.  You can do this in the same way as for Affinity Propagation above: <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-572"><span class="MJXp-msubsup" id="MJXp-Span-573"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-574" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-575" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-576">i</span><span class="MJXp-mo" id="MJXp-Span-577">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-578">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-579" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mo" id="MJXp-Span-580" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mrow" id="MJXp-Span-581"><span class="MJXp-mo" id="MJXp-Span-582" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-583"><span class="MJXp-mo" id="MJXp-Span-584" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-585"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-586" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-587" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-588" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-589"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-590" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-591" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mrow" id="MJXp-Span-592"><span class="MJXp-mo" id="MJXp-Span-593" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-594"><span class="MJXp-mrow" id="MJXp-Span-595" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-596" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-597" style="vertical-align: 0.5em;"><span class="MJXp-mn" id="MJXp-Span-598">2</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-47-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-47"> A_ {i, j} = - || x_i - x_j || ^ {2} </script>  .  This matrix also describes a complete graph with vertices in our observations and edges between each pair of observations with a weight corresponding to the degree of similarity of these vertices.  For our above selected metric and points lying on the plane, this thing will be intuitive and simple - two points are more similar if the edge between them is shorter.  Now we would like to divide our resulting graph into two parts so that the resulting points in the two graphs are in general more similar to other points inside the resulting "own" half of the graph than to the points in the "other" half.  The formal name of such a task is called the Normalized cuts problem and you can read more about it <a href="http://people.eecs.berkeley.edu/~malik/papers/SM-ncut.pdf">here</a> . </p><br><h3 id="aglomerativnaya-klasterizaciya">  Agglomerative clustering </h3><br><p>  Probably the easiest and most understandable clustering algorithm without a fixed number of clusters is agglomerative clustering.  The intuition of the algorithm is very simple: </p><br><ol><li>  We start with the fact that we pour our cluster on each point </li><li>  Sort pairwise distances between cluster centers in ascending order. </li><li>  Take a couple of the next clusters, glue them together and recalculate the center of the cluster </li><li>  Repeat items 2 and 3 until all the data is glued together in one cluster. </li></ol><br><p>  The very process of finding the nearest clusters can occur using different methods of combining points: </p><br><ol><li>  Single linkage - minimum pairwise distance between points from two clusters <br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-599"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-600">d</span><span class="MJXp-mo" id="MJXp-Span-601" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-602"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-603" style="margin-right: 0.05em;">C</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-604" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-605" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-606"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-607" style="margin-right: 0.05em;">C</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-608" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-609" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-610" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-611">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-612">i</span><span class="MJXp-msubsup" id="MJXp-Span-613"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-614" style="margin-right: 0.05em;">n</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-615" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-616"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-617" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-618" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mtext" id="MJXp-Span-619">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-620">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-621">n</span><span class="MJXp-msubsup" id="MJXp-Span-622"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-623" style="margin-right: 0.05em;">C</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-624" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-625">,</span><span class="MJXp-msubsup" id="MJXp-Span-626"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-627" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-628" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mtext" id="MJXp-Span-629">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-630">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-631">n</span><span class="MJXp-msubsup" id="MJXp-Span-632"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-633" style="margin-right: 0.05em;">C</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-634" style="vertical-align: -0.4em;">j</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-635"><span class="MJXp-mo" id="MJXp-Span-636" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-637"><span class="MJXp-mo" id="MJXp-Span-638" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-639"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-640" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-641" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-642" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-643"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-644" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-645" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mrow" id="MJXp-Span-646"><span class="MJXp-mo" id="MJXp-Span-647" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-648"><span class="MJXp-mo" id="MJXp-Span-649" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-48-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-48"> d (C_i, C_j) = min_ {x_i \ in C_i, x_j \ in C_j} || x_i - x_j || </script></li><li>  Complete linkage - maximum pairwise distance between points from two clusters <br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-650"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-651">d</span><span class="MJXp-mo" id="MJXp-Span-652" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-653"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-654" style="margin-right: 0.05em;">C</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-655" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-656" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-657"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-658" style="margin-right: 0.05em;">C</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-659" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-660" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-661" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-662">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-663">a</span><span class="MJXp-msubsup" id="MJXp-Span-664"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-665" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-666" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-667"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-668" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-669" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mtext" id="MJXp-Span-670">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-671">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-672">n</span><span class="MJXp-msubsup" id="MJXp-Span-673"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-674" style="margin-right: 0.05em;">C</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-675" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-676">,</span><span class="MJXp-msubsup" id="MJXp-Span-677"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-678" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-679" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mtext" id="MJXp-Span-680">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-681">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-682">n</span><span class="MJXp-msubsup" id="MJXp-Span-683"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-684" style="margin-right: 0.05em;">C</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-685" style="vertical-align: -0.4em;">j</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-686"><span class="MJXp-mo" id="MJXp-Span-687" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-688"><span class="MJXp-mo" id="MJXp-Span-689" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-690"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-691" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-692" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-693" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-694"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-695" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-696" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mrow" id="MJXp-Span-697"><span class="MJXp-mo" id="MJXp-Span-698" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-699"><span class="MJXp-mo" id="MJXp-Span-700" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-49-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-49"> d (C_i, C_j) = max_ {x_i \ in C_i, x_j \ in C_j} || x_i - x_j || </script></li><li>  Average linkage - the average pairwise distance between points from two clusters <br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-701"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-702">d</span><span class="MJXp-mo" id="MJXp-Span-703" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-704"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-705" style="margin-right: 0.05em;">C</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-706" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-707" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-708"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-709" style="margin-right: 0.05em;">C</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-710" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-711" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-712" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-713">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-714">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-715">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-716">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-717">c</span><span class="MJXp-mrow" id="MJXp-Span-718"><span class="MJXp-mn" id="MJXp-Span-719">1</span></span><span class="MJXp-mrow" id="MJXp-Span-720"><span class="MJXp-msubsup" id="MJXp-Span-721"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-722" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-723" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-msubsup" id="MJXp-Span-724"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-725" style="margin-right: 0.05em;">n</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-726" style="vertical-align: -0.4em;">j</span></span></span><span class="MJXp-mtext" id="MJXp-Span-727">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-728">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-729">u</span><span class="MJXp-msubsup" id="MJXp-Span-730"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-731" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-732" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-733"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-734" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-735" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mtext" id="MJXp-Span-736">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-737">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-738">n</span><span class="MJXp-msubsup" id="MJXp-Span-739"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-740" style="margin-right: 0.05em;">C</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-741" style="vertical-align: -0.4em;">i</span></span></span></span><span class="MJXp-mtext" id="MJXp-Span-742">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-743">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-744">u</span><span class="MJXp-msubsup" id="MJXp-Span-745"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-746" style="margin-right: 0.05em;">m</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-747" style="vertical-align: -0.4em;"><span class="MJXp-msubsup" id="MJXp-Span-748"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-749" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-750" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mtext" id="MJXp-Span-751">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-752">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-753">n</span><span class="MJXp-msubsup" id="MJXp-Span-754"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-755" style="margin-right: 0.05em;">C</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-756" style="vertical-align: -0.4em;">j</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-757"><span class="MJXp-mo" id="MJXp-Span-758" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-759"><span class="MJXp-mo" id="MJXp-Span-760" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-761"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-762" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-763" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-764" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-765"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-766" style="margin-right: 0.05em;">x</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-767" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mrow" id="MJXp-Span-768"><span class="MJXp-mo" id="MJXp-Span-769" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-770"><span class="MJXp-mo" id="MJXp-Span-771" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-50-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-50"> d (C_i, C_j) = \ frac {1} {n_i n_j} \ sum_ {x_i \ in C_i} \ sum_ {x_j \ in C_j} || x_i - x_j || </script></li><li>  Centroid linkage - the distance between the centroids of the two clusters <br><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-772"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-773">d</span><span class="MJXp-mo" id="MJXp-Span-774" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-775"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-776" style="margin-right: 0.05em;">C</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-777" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-778" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-779"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-780" style="margin-right: 0.05em;">C</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-781" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mo" id="MJXp-Span-782" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-783" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-784"><span class="MJXp-mo" id="MJXp-Span-785" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-786"><span class="MJXp-mo" id="MJXp-Span-787" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mtext" id="MJXp-Span-788">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-789">m</span><span class="MJXp-msubsup" id="MJXp-Span-790"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-791" style="margin-right: 0.05em;">u</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-792" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-793" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-794">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-795">m</span><span class="MJXp-msubsup" id="MJXp-Span-796"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-797" style="margin-right: 0.05em;">u</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-798" style="vertical-align: -0.4em;">j</span></span><span class="MJXp-mrow" id="MJXp-Span-799"><span class="MJXp-mo" id="MJXp-Span-800" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-801"><span class="MJXp-mo" id="MJXp-Span-802" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-51-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-51"> d (C_i, C_j) = || \ mu_i - \ mu_j || </script></li></ol><br><p>  The profit of the first three approaches in comparison with the fourth is that they will not need to recalculate the distances each time after gluing, which greatly reduces the computational complexity of the algorithm. </p><br><p>  According to the results of the implementation of such an algorithm, it is also possible to build a wonderful tree of pasting clusters and looking at it to determine at what stage it would be best for us to stop the algorithm.  Or use the same elbow rule as in k-means. </p><br><p>  Fortunately for us in Python there are already wonderful tools for building such dendrograms for agglomerative clustering.  Consider the example of our clusters of K-means: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> scipy.cluster <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> hierarchy <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> scipy.spatial.distance <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pdist X = np.zeros((<span class="hljs-number"><span class="hljs-number">150</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>)) np.random.seed(seed=<span class="hljs-number"><span class="hljs-number">42</span></span>) X[:<span class="hljs-number"><span class="hljs-number">50</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>] = np.random.normal(loc=<span class="hljs-number"><span class="hljs-number">0.0</span></span>, scale=<span class="hljs-number"><span class="hljs-number">.3</span></span>, size=<span class="hljs-number"><span class="hljs-number">50</span></span>) X[:<span class="hljs-number"><span class="hljs-number">50</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>] = np.random.normal(loc=<span class="hljs-number"><span class="hljs-number">0.0</span></span>, scale=<span class="hljs-number"><span class="hljs-number">.3</span></span>, size=<span class="hljs-number"><span class="hljs-number">50</span></span>) X[<span class="hljs-number"><span class="hljs-number">50</span></span>:<span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>] = np.random.normal(loc=<span class="hljs-number"><span class="hljs-number">2.0</span></span>, scale=<span class="hljs-number"><span class="hljs-number">.5</span></span>, size=<span class="hljs-number"><span class="hljs-number">50</span></span>) X[<span class="hljs-number"><span class="hljs-number">50</span></span>:<span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>] = np.random.normal(loc=<span class="hljs-number"><span class="hljs-number">-1.0</span></span>, scale=<span class="hljs-number"><span class="hljs-number">.2</span></span>, size=<span class="hljs-number"><span class="hljs-number">50</span></span>) X[<span class="hljs-number"><span class="hljs-number">100</span></span>:<span class="hljs-number"><span class="hljs-number">150</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>] = np.random.normal(loc=<span class="hljs-number"><span class="hljs-number">-1.0</span></span>, scale=<span class="hljs-number"><span class="hljs-number">.2</span></span>, size=<span class="hljs-number"><span class="hljs-number">50</span></span>) X[<span class="hljs-number"><span class="hljs-number">100</span></span>:<span class="hljs-number"><span class="hljs-number">150</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>] = np.random.normal(loc=<span class="hljs-number"><span class="hljs-number">2.0</span></span>, scale=<span class="hljs-number"><span class="hljs-number">.5</span></span>, size=<span class="hljs-number"><span class="hljs-number">50</span></span>) distance_mat = pdist(X) <span class="hljs-comment"><span class="hljs-comment"># pdist        Z = hierarchy.linkage(distance_mat, 'single') # linkage ‚Äî    plt.figure(figsize=(10, 5)) dn = hierarchy.dendrogram(Z, color_threshold=0.5)</span></span></code> </pre> <br><p><img src="https://habrastorage.org/files/9c4/f52/c5e/9c4f52c5eb43438aae47215e26b2dcf9.png" alt="Dendrogram"></p><br><h3 id="metriki-kachestva-klasterizacii">  Clustering Quality Metrics </h3><br><p>  The task of assessing the quality of clustering is more complex compared to assessing the quality of classification.  First, such estimates should not depend on the values ‚Äã‚Äãof the labels themselves, but only on the sample partitioning itself.  Secondly, the true labels of objects are not always known; therefore, estimates are also needed to evaluate the quality of clustering using only the unmarked sample. </p><br><p>  Allocate <em>external</em> and <em>internal</em> quality metrics.  External use information about true clustering, while internal metrics do not use any external information and evaluate the quality of clustering based only on the data set.  The optimal number of clusters is usually determined using internal metrics. </p><br><p>  All the metrics below are implemented in <code>sklearn.metrics</code> . </p><br><p>  <strong>Adjusted Rand Index (ARI)</strong> </p><br><p>  It is assumed that the true labels of objects are known.  This measure does not depend on the actual values ‚Äã‚Äãof the labels, but only on the division of the sample into clusters.  Let be <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-803"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-804">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-52-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-52"> n </script>  - the number of objects in the sample.  Denote by <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-805"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-806">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-53-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-53"> a </script>  - the number of pairs of objects that have the same labels and are in the same cluster, through <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-807"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-808">b</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-54-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-54"> b </script>  - the number of pairs of objects with different labels and located in different clusters.  Then the rand index is </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-809"><span class="MJXp-mtext" id="MJXp-Span-810">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-811">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-812">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-813">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-814">t</span><span class="MJXp-mrow" id="MJXp-Span-815"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-816">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-817">I</span></span><span class="MJXp-mo" id="MJXp-Span-818" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-819">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-820">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-821">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-822">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-823">c</span><span class="MJXp-mrow" id="MJXp-Span-824"><span class="MJXp-mn" id="MJXp-Span-825">2</span><span class="MJXp-mo" id="MJXp-Span-826" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-827">a</span><span class="MJXp-mo" id="MJXp-Span-828" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-829">b</span><span class="MJXp-mo" id="MJXp-Span-830" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-831"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-832">n</span><span class="MJXp-mo" id="MJXp-Span-833" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-834">n</span><span class="MJXp-mo" id="MJXp-Span-835" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-836">1</span><span class="MJXp-mo" id="MJXp-Span-837" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-838" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-55-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-55"> \ text {RI} = \ frac {2 (a + b)} {n (n-1)}. </script></p><br>  That is, this is the proportion of objects for which these partitions (initial and obtained as a result of clustering) are ‚Äúconsistent‚Äù.  The Rand Index (RI) expresses the similarity of two different clusters of the same sample.  For this index to give values ‚Äã‚Äãclose to zero for random clusterings for any <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-839"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-840">n</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-56-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-56"> n </script>  and the number of clusters, it is necessary to normalize it.  This is determined by the Adjusted Rand Index: <p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-841"><span class="MJXp-mtext" id="MJXp-Span-842">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-843">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-844">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-845">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-846">t</span><span class="MJXp-mrow" id="MJXp-Span-847"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-848">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-849">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-850">I</span></span><span class="MJXp-mo" id="MJXp-Span-851" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mtext" id="MJXp-Span-852">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-853">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-854">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-855">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-856">c</span><span class="MJXp-mrow" id="MJXp-Span-857"><span class="MJXp-mtext" id="MJXp-Span-858">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-859">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-860">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-861">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-862">t</span><span class="MJXp-mrow" id="MJXp-Span-863"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-864">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-865">I</span></span><span class="MJXp-mo" id="MJXp-Span-866" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-867">E</span><span class="MJXp-mo" id="MJXp-Span-868" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-869">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-870">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-871">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-872">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-873">t</span><span class="MJXp-mrow" id="MJXp-Span-874"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-875">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-876">I</span></span><span class="MJXp-mo" id="MJXp-Span-877" style="margin-left: 0em; margin-right: 0em;">]</span></span><span class="MJXp-mrow" id="MJXp-Span-878"><span class="MJXp-mtext" id="MJXp-Span-879">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-880">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-881">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-882">x</span><span class="MJXp-mo" id="MJXp-Span-883" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mtext" id="MJXp-Span-884">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-885">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-886">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-887">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-888">t</span><span class="MJXp-mrow" id="MJXp-Span-889"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-890">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-891">I</span></span><span class="MJXp-mo" id="MJXp-Span-892" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-893" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-894">E</span><span class="MJXp-mo" id="MJXp-Span-895" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mtext" id="MJXp-Span-896">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-897">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-898">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-899">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-900">t</span><span class="MJXp-mrow" id="MJXp-Span-901"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-902">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-903">I</span></span><span class="MJXp-mo" id="MJXp-Span-904" style="margin-left: 0em; margin-right: 0em;">]</span></span><span class="MJXp-mo" id="MJXp-Span-905" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-57-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-57"> \ text {ARI} = \ frac {\ text {RI} - E [\ text {RI}]} {\ max (\ text {RI}) - E [\ text {RI}]}. </script></p><br><br><p>  This measure is symmetric, does not depend on the values ‚Äã‚Äãand permutations of the labels.  Thus, this index is a measure of the distance between the various partitions of the sample. <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-906"><span class="MJXp-mtext" id="MJXp-Span-907">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-908">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-909">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-910">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-911">t</span><span class="MJXp-mrow" id="MJXp-Span-912"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-913">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-914">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-915">I</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-58-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-58"> \ text {ARI} </script>  takes values ‚Äã‚Äãin the range <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-916"><span class="MJXp-mo" id="MJXp-Span-917" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mo" id="MJXp-Span-918" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mn" id="MJXp-Span-919">1</span><span class="MJXp-mo" id="MJXp-Span-920" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-921">1</span><span class="MJXp-mo" id="MJXp-Span-922" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-59-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-59"> [- 1, 1] </script>  .  Negative values ‚Äã‚Äãcorrespond to "independent" divisions into clusters, values ‚Äã‚Äãclose to zero, to random partitions, and positive values ‚Äã‚Äãindicate that the two partitions are similar (coincide with <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-923"><span class="MJXp-mtext" id="MJXp-Span-924">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-925">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-926">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-927">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-928">t</span><span class="MJXp-mrow" id="MJXp-Span-929"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-930">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-931">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-932">I</span></span><span class="MJXp-mo" id="MJXp-Span-933" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-934">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-60-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-60"> \ text {ARI} = 1 </script>  ). </p><br><p>  <strong>Adjusted Mutual Information (AMI)</strong> </p><br><p>  This measure is very similar to <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-935"><span class="MJXp-mtext" id="MJXp-Span-936">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-937">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-938">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-939">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-940">t</span><span class="MJXp-mrow" id="MJXp-Span-941"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-942">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-943">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-944">I</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-61-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-61"> \ text {ARI} </script>  .  It is also symmetric, independent of the values ‚Äã‚Äãand permutations of the labels.  It is determined using the <a href="https://en.wikipedia.org/wiki/Entropy_(information_theory)">entropy</a> function, interpreting sample partitions as discrete distributions (the probability of assignment to a cluster is equal to the fraction of objects in it).  Index <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-945"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-946">M</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-947">I</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-62-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-62"> MI </script>  defined as <a href="https://en.wikipedia.org/wiki/Mutual_information">mutual information</a> for two distributions corresponding to the partitioning of the sample into clusters.  Intuitively, mutual information measures the share of information common to both partitions: how much information about one of them reduces the uncertainty about the other. </p><br><p>  Similarly <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-948"><span class="MJXp-mtext" id="MJXp-Span-949">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-950">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-951">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-952">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-953">t</span><span class="MJXp-mrow" id="MJXp-Span-954"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-955">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-956">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-957">I</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-63-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-63"> \ text {ARI} </script>  index is determined <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-958"><span class="MJXp-mtext" id="MJXp-Span-959">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-960">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-961">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-962">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-963">t</span><span class="MJXp-mrow" id="MJXp-Span-964"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-965">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-966">M</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-967">I</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-64-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-64"> \ text {AMI} </script>  to get rid of the growth index <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-968"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-969">M</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-970">I</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-65-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-65"> MI </script>  with an increase in the number of classes.  It takes values ‚Äã‚Äãin the range <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-971"><span class="MJXp-mo" id="MJXp-Span-972" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-973">0</span><span class="MJXp-mo" id="MJXp-Span-974" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-975">1</span><span class="MJXp-mo" id="MJXp-Span-976" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-66-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-66"> [0, 1] </script>  .  Values ‚Äã‚Äãclose to zero indicate independence of partitions, and close to unity, their similarity (coincidence with <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-977"><span class="MJXp-mtext" id="MJXp-Span-978">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-979">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-980">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-981">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-982">t</span><span class="MJXp-mrow" id="MJXp-Span-983"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-984">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-985">M</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-986">I</span></span><span class="MJXp-mo" id="MJXp-Span-987" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-988">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-67-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-67"> \ text {AMI} = 1 </script>  ). </p><br><p>  <strong>Homogeneity, fullness, v-measure</strong> </p><br><p>  Formally, these measures are also determined using the functions of entropy and conditional entropy, considering the partitioning of the sample as discrete distributions: </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-989"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-990">h</span><span class="MJXp-mo" id="MJXp-Span-991" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-992">1</span><span class="MJXp-mo" id="MJXp-Span-993" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-994">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-995">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-996">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-997">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-998">c</span><span class="MJXp-mrow" id="MJXp-Span-999"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1000">H</span><span class="MJXp-mo" id="MJXp-Span-1001" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1002">C</span><span class="MJXp-mtext" id="MJXp-Span-1003">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1004">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1005">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1006">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1007">K</span><span class="MJXp-mo" id="MJXp-Span-1008" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-1009"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1010">H</span><span class="MJXp-mo" id="MJXp-Span-1011" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1012">C</span><span class="MJXp-mo" id="MJXp-Span-1013" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-1014" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1015">c</span><span class="MJXp-mo" id="MJXp-Span-1016" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1017">1</span><span class="MJXp-mo" id="MJXp-Span-1018" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mtext" id="MJXp-Span-1019">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1020">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1021">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1022">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1023">c</span><span class="MJXp-mrow" id="MJXp-Span-1024"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1025">H</span><span class="MJXp-mo" id="MJXp-Span-1026" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1027">K</span><span class="MJXp-mtext" id="MJXp-Span-1028">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1029">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1030">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1031">d</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1032">C</span><span class="MJXp-mo" id="MJXp-Span-1033" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mrow" id="MJXp-Span-1034"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1035">H</span><span class="MJXp-mo" id="MJXp-Span-1036" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1037">K</span><span class="MJXp-mo" id="MJXp-Span-1038" style="margin-left: 0em; margin-right: 0em;">)</span></span><span class="MJXp-mo" id="MJXp-Span-1039" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-68-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-68"> h = 1 - \ frac {H (C \ mid K)} {H (C)}, c = 1 - \ frac {H (K \ mid C)} {H (K)}, </script></p><br>  here <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1040"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1041">K</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-69-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-69"> K </script>  - the result of clustering, <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1042"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1043">C</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-70-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-70"> C </script>  - true partitioning of the sample into classes.  In this way, <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1044"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1045">h</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-71-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-71"> h </script>  measures how each cluster consists of objects of one class, and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1046"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1047">c</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-72-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-72"> c </script>  - as far as objects of one class belong to one cluster.  These measures are not symmetrical.  Both values ‚Äã‚Äãtake values ‚Äã‚Äãin the range <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1048"><span class="MJXp-mo" id="MJXp-Span-1049" style="margin-left: 0em; margin-right: 0em;">[</span><span class="MJXp-mn" id="MJXp-Span-1050">0</span><span class="MJXp-mo" id="MJXp-Span-1051" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mn" id="MJXp-Span-1052">1</span><span class="MJXp-mo" id="MJXp-Span-1053" style="margin-left: 0em; margin-right: 0em;">]</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-73-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-73"> [0, 1] </script>  , and larger values ‚Äã‚Äãcorrespond to more accurate clustering.  These measures are not normalized as <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1054"><span class="MJXp-mtext" id="MJXp-Span-1055">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1056">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1057">e</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1058">x</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1059">t</span><span class="MJXp-mrow" id="MJXp-Span-1060"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1061">A</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1062">R</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1063">I</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-74-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-74"> \ text {ARI} </script>  or <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1064"><span class="MJXp-mtext" id="MJXp-Span-1065">&nbsp;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1066"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1067"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">e </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1068"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">x </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1069"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">t </font></font></span><span class="MJXp-mrow" id="MJXp-Span-1070"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1071"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1072"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1073"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I</font></font></span></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and therefore depend on the number of clusters. </font><font style="vertical-align: inherit;">Random clustering will not give zero performance with a large number of classes and a small number of objects. </font><font style="vertical-align: inherit;">In these cases, it is preferable to use</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-75-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-75"> \ text {AMI} </script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1074"><span class="MJXp-mtext" id="MJXp-Span-1075"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ARI</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-76-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-76">\text{ARI}</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> However, when the number of objects is more than 1000 and the number of clusters is less than 10, this problem is not so pronounced and can be ignored. </font></font><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> To account for both quantities </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1076"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1077"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-77-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-77">h</script>  and <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1078"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1079"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> simultaneously entered</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-78-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-78">c</script><font style="vertical-align: inherit;"></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1080"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1081"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">V-</font></font></span></span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> measure as their harmonic mean:</font></font><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-79-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-79">V</script><font style="vertical-align: inherit;"></font></p><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1082"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1083"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">v </font></font></span><span class="MJXp-mo" id="MJXp-Span-1084" style="margin-left: 0.333em; margin-right: 0.333em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">= </font></font></span><span class="MJXp-mn" id="MJXp-Span-1085"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2 </font></font></span><span class="MJXp-mfrac" id="MJXp-Span-1086" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1087"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1088"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c</font></font></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1089"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">h </font></font></span><span class="MJXp-mo" id="MJXp-Span-1090" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">+ </font></font></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1091"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">c</font></font></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1092" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-80-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-80">v = 2\frac{hc}{h+c}.</script></p><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> It is symmetrical and shows how two clustering are similar to each other. </font></font></p><br><p> <strong><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Silhouette</font></font></strong> </p><br><p>      ,        ,     ,    ()    .       .   <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1093"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1094">a</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-81-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-81">a</script> ‚Äî           ,  <math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1095"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1096">b</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-82-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-82">b</script> ‚Äî           (  ,     ).      : </p><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1105"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1106">s</span><span class="MJXp-mo" id="MJXp-Span-1107" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mfrac" id="MJXp-Span-1108" style="vertical-align: 0.25em;"><span class="MJXp-box"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1109">b</span><span class="MJXp-mo" id="MJXp-Span-1110" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1111">a</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box"><span class="MJXp-mo" id="MJXp-Span-1112" style="margin-left: 0.333em; margin-right: 0.333em;">max</span><span class="MJXp-mo" id="MJXp-Span-1113" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1114">a</span><span class="MJXp-mo" id="MJXp-Span-1115" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1116">b</span><span class="MJXp-mo" id="MJXp-Span-1117" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1118" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-83-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex;mode=display" id="MathJax-Element-83">s = \frac{b - a}{\max(a, b)}.</script></p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The silhouette of the sample is the average of the silhouette of the objects in the sample. </font><font style="vertical-align: inherit;">Thus, the silhouette shows how much the average distance to the objects of its cluster differs from the average distance to the objects of other clusters. </font><font style="vertical-align: inherit;">This value is in the range</font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1119"><span class="MJXp-mo" id="MJXp-Span-1120" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[ </font></font></span><span class="MJXp-mo" id="MJXp-Span-1121" style="margin-left: 0.267em; margin-right: 0.267em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">- </font></font></span><span class="MJXp-mn" id="MJXp-Span-1122"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-1123" style="margin-left: 0em; margin-right: 0.222em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, </font></font></span><span class="MJXp-mn" id="MJXp-Span-1124"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1 </font></font></span><span class="MJXp-mo" id="MJXp-Span-1125" style="margin-left: 0em; margin-right: 0em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">]</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-84-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-84">[-1, 1]</script>  .<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Values ‚Äã‚Äãclose to -1 correspond to poor (scattered) clustering, values ‚Äã‚Äãclose to zero indicate that the clusters intersect and overlap, values ‚Äã‚Äãclose to 1 correspond to "dense" clearly selected clusters. </font><font style="vertical-align: inherit;">Thus, the larger the silhouette, the more clearly highlighted the clusters, and they are compact, tightly grouped clouds of points.</font></font><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> With the silhouette you can choose the optimal number of clusters. </font></font><math></math><span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1126"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1127">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-85-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-85">k</script> (   ) ‚Äî   ,   .     ,     ,        ,    ,     . </p><br><p>          ,      MNIST: </p><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> metrics <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> datasets <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> pandas <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> pd <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> sklearn.cluster <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> KMeans, AgglomerativeClustering, AffinityPropagation, SpectralClustering data = datasets.load_digits() X, y = data.data, data.target algorithms = [] algorithms.append(KMeans(n_clusters=<span class="hljs-number"><span class="hljs-number">10</span></span>, random_state=<span class="hljs-number"><span class="hljs-number">1</span></span>)) algorithms.append(AffinityPropagation()) algorithms.append(SpectralClustering(n_clusters=<span class="hljs-number"><span class="hljs-number">10</span></span>, random_state=<span class="hljs-number"><span class="hljs-number">1</span></span>, affinity=<span class="hljs-string"><span class="hljs-string">'nearest_neighbors'</span></span>)) algorithms.append(AgglomerativeClustering(n_clusters=<span class="hljs-number"><span class="hljs-number">10</span></span>)) data = [] <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> algo <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> algorithms: algo.fit(X) data.append(({ <span class="hljs-string"><span class="hljs-string">'ARI'</span></span>: metrics.adjusted_rand_score(y, algo.labels_), <span class="hljs-string"><span class="hljs-string">'AMI'</span></span>: metrics.adjusted_mutual_info_score(y, algo.labels_), <span class="hljs-string"><span class="hljs-string">'Homogenity'</span></span>: metrics.homogeneity_score(y, algo.labels_), <span class="hljs-string"><span class="hljs-string">'Completeness'</span></span>: metrics.completeness_score(y, algo.labels_), <span class="hljs-string"><span class="hljs-string">'V-measure'</span></span>: metrics.v_measure_score(y, algo.labels_), <span class="hljs-string"><span class="hljs-string">'Silhouette'</span></span>: metrics.silhouette_score(X, algo.labels_)})) results = pd.DataFrame(data=data, columns=[<span class="hljs-string"><span class="hljs-string">'ARI'</span></span>, <span class="hljs-string"><span class="hljs-string">'AMI'</span></span>, <span class="hljs-string"><span class="hljs-string">'Homogenity'</span></span>, <span class="hljs-string"><span class="hljs-string">'Completeness'</span></span>, <span class="hljs-string"><span class="hljs-string">'V-measure'</span></span>, <span class="hljs-string"><span class="hljs-string">'Silhouette'</span></span>], index=[<span class="hljs-string"><span class="hljs-string">'K-means'</span></span>, <span class="hljs-string"><span class="hljs-string">'Affinity'</span></span>, <span class="hljs-string"><span class="hljs-string">'Spectral'</span></span>, <span class="hljs-string"><span class="hljs-string">'Agglomerative'</span></span>]) results</code> </pre> <br><table border="1"><thead><tr><th></th><th> ARI </th><th> AMI </th><th> Homogenity </th><th> Completeness </th><th> V-measure </th><th> Silhouette </th></tr></thead><tbody><tr><th> K-means </th><td> 0.662295 </td><td> 0.732799 </td><td> 0.735448 </td><td> 0.742972 </td><td> 0.739191 </td><td> 0.182097 </td></tr><tr><th>  Affinity </th><td> 0.175174 </td><td> 0.451249 </td><td> 0.958907 </td><td> 0.486901 </td><td> 0.645857 </td><td> 0.115197 </td></tr><tr><th> Spectral </th><td> 0.752639 </td><td> 0.827818 </td><td> 0.829544 </td><td> 0.876367 </td><td> 0.852313 </td><td> 0.182195 </td></tr><tr><th> Agglomerative </th><td> 0.794003 </td><td> 0.856085 </td><td> 0.857513 </td><td> 0.879096 </td><td> 0.868170 </td><td> 0.178497 </td></tr></tbody></table><br><h2 id="3-domashnee-zadanie"> 3.   </h2><br><p>         ,    <a href="https://vk.com/mlcourse"> </a>   <a href=""></a> . </p><br><p>  -       Samsung     .  ,          (,   )     . <a href="http://nbviewer.jupyter.org/github/Yorko/mlcourse.ai/blob/master/jupyter_russian/assignments_demo/assignment07_unsupervised_learning.ipynb">Jupyter-</a> , <a href="https://drive.google.com/open%3Fid%3D1qzcrfsNFy-e4TW59v2fqMj_OTom2SIOxtq4MWlI92p0">-  </a> ,     . </p><br><h2 id="4-poleznye-istochniki"> 4.   </h2><br><ul><li> <a href="https://medium.com/open-machine-learning-course/open-machine-learning-course-topic-7-unsupervised-learning-pca-and-clustering-db7879568417">Open Machine Learning Course. Topic 7. Unsupervised Learning: PCA and Clustering</a> </li><li> <a href="https://www.youtube.com/watch%3Fv%3DqmW968tw3AM"></a>      </li><li>      ‚Äì <a href="https://medium.com/open-machine-learning-course/open-machine-learning-course-topic-7-unsupervised-learning-pca-and-clustering-db7879568417">Medium story</a> </li><li> <a href="https://habrahabr.ru/company/io/blog/265089/"></a> "       " </li><li> <a href="https://habrahabr.ru/users/lexxo/topics/"></a> "     (PCA)   " </li><li> <a href="https://habrahabr.ru/post/321216/"></a> "  ,  : Affinity propagation" </li><li> <a href="https://habrahabr.ru/post/322034/"></a> "  ,  : DBSCAN" </li><li> <a href="http://scikit-learn.org/stable/modules/clustering.html"></a>     scikit-learn (.) </li><li> <a href="http://stats.stackexchange.com/questions/2691/making-sense-of-principal-component-analysis-eigenvectors-eigenvalues">Q&amp;A</a>  PCA     (.) </li><li> <a href="https://github.com/diefimov/MTH594_MachineLearning/blob/master/ipython/Lecture10.ipynb"></a>  k-Means  EM-     (.) </li><li> <a href="https://github.com/esokolov/ml-course-hse/blob/master/2016-fall/lecture-notes/lecture12-unsupervised.pdf"></a> "  "     </li></ul><br><p> <em>     <a href="https://habr.com/users/yorko/" class="user_link">yorko</a> ( ).      <a href="https://github.com/Yorko/mlcourse.ai/blob/master/jupyter_russian/topic07_unsupervised/topic7_pca_clustering.ipynb"></a> Jupyter  <a href="">GitHub-</a> .</em> </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/325654/">https://habr.com/ru/post/325654/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../325644/index.html">We read binary files of iOS-applications. Part 2: Swift</a></li>
<li><a href="../325646/index.html">3D graphics on the web</a></li>
<li><a href="../325648/index.html">How to make friends Telegram-bot with telephony</a></li>
<li><a href="../325650/index.html">Oscillating link model using symbolic and numerical solutions of a differential equation on SymPy and NumPy</a></li>
<li><a href="../325652/index.html">Zabbix Moscow Meetup in the office of Badoo on April 15</a></li>
<li><a href="../325656/index.html">Summer is coming - it's time to apply to the summer school (internship) of Intel</a></li>
<li><a href="../325658/index.html">Symfony Flex, what your symfony 4 application will look like</a></li>
<li><a href="../325660/index.html">The State of Reactive in JS: A Practical Review of FRP Libraries</a></li>
<li><a href="../325664/index.html">How I learned to create my mobile apps</a></li>
<li><a href="../325666/index.html">Import Substitution in I2P: Signature in accordance with GOST R 34.10-2012</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>