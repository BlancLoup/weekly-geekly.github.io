<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>(M) VC Framework Locomotive</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="For several days I have been engaged in the selection of the Node.js framework for solving several demo tasks. I passed 4 frameworks ( Locomotive , Ex...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">🔎</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">📜</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">⬆️</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">⬇️</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>(M) VC Framework Locomotive</h1><div class="post__text post__text-html js-mediator-article">  For several days I have been engaged in the selection of the Node.js framework for solving several demo tasks.  I passed 4 frameworks ( <a href="http://locomotivejs.org/">Locomotive</a> , <a href="http://expressjs.com/">Express</a> , <a href="http://geddyjs.org/">Geddy</a> , <a href="http://sailsjs.org/">Sails</a> ) and I decided to start the cycle of my articles with Locomotive. <br><br>  Locomotive came to my attention upon the recommendation of my friend, who told me: “Listen, there is an interesting new framework implementing MVC over Express.” - and that interested me, which later resulted in the addition of Locomotive to the list of “experimental”. <br><a name="habracut"></a><br><h2>  Locomotive architecture and common concepts </h2><br>  Locomotive presents itself as: “Strictly adhering to the MVC pattern and REST principles, which is good to write with well-designed applications“ - but I don’t want to talk about “ <a href="http://en.wikipedia.org/wiki/Model_2">MVC</a> ” inside Locomotive; to end.  Such a statement came about as part of the “Model” in my opinion should be implemented at least in some form, but in the documentation of the Locomotive the author referred to the article <a href="http://martinfowler.com/bliki/PolyglotPersistence.html">“polyglot persistence”</a> and said that you can choose Database &amp; ORM yourself and “tie” to the framework, this author’s approach has been a bit rastroil, since the calculation was, when choosing this framework, to the fact that he really implements <a href="http://en.wikipedia.org/wiki/Model_2">MVC (Model2)</a> in full.  Let's return to what is implemented there. <br>  “View” is implemented by Express, which in turn is integrated with such templates as <a href="http://jade-lang.com/">Jade</a> , <a href="https://github.com/visionmedia/ejs">Ejs</a> and <a href="https://github.com/visionmedia/express/wiki">many others</a> . <br>  “Controller” is basically fully implemented, there is a base controller class, you can actually process the Request from the client and return the Response.  Inside each method is the action of the controller, inside each action it is possible to get the parameters of the routing directly from the current context: <br><br><pre><code class="hljs actionscript"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> SearchController = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Controller(); SearchController.find = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.query = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.param(<span class="hljs-string"><span class="hljs-string">'query'</span></span>); <span class="hljs-comment"><span class="hljs-comment">// execute search query... } module.exports = SearchController;</span></span></code> </pre> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Also available are “action assistants” allowing you to climb right before / after performing a particular action (in Locomotive this is called “ <a href="http://locomotivejs.org/guide/filters/">Filters</a> ”): <br><br><pre> <code class="hljs javascript">PhotosController.before(<span class="hljs-string"><span class="hljs-string">'show'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">next</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> self = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.param(<span class="hljs-string"><span class="hljs-string">'id'</span></span>)) { next(); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> next(“<span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>”); } }); PhotosController.show = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.render(); }</code> </pre><br><br>  In this example, we insert the “action helper” to be executed immediately before the “show” action, thereby adding a layer where we can check the identifier parameter and decide whether to continue the execution of the request or its completion.  You can also add an “action helper” that will be executed before any action in the controller: <br><br><pre> <code class="hljs actionscript">PhotosController.before(<span class="hljs-string"><span class="hljs-string">'*'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(next)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//       PhotosController });</span></span></code> </pre><br><br>  Well, besides “action assistants”, Locomotive has support for the “content negotiations” mechanism (http://en.wikipedia.org/wiki/Content_negotiation), that is, there are several ways to display the submission within the action depending on the format requested by the client. In short, it looks like this: <br><br><pre> <code class="hljs pgsql">PhotosController.<span class="hljs-keyword"><span class="hljs-keyword">index</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">function</span></span>() { this.respond({ <span class="hljs-string"><span class="hljs-string">'xml'</span></span>: { <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>: <span class="hljs-string"><span class="hljs-string">'feed'</span></span> }, <span class="hljs-string"><span class="hljs-string">'html'</span></span>: { <span class="hljs-keyword"><span class="hljs-keyword">template</span></span>: <span class="hljs-string"><span class="hljs-string">'index'</span></span> } }); }</code> </pre><br><br>  That is, the PhotosController controller will return the presentation in one of two formats, depending on which format the user requested in the headers.  With this value of the Accept header, the action will automatically return the registered index template: <br><br> <code>Accept: text/html;</code> <br> <br>  In fact, there are a lot of “big buns” around these opportunities, but I will not go into details, I see no reason to rewrite the documentation. <br><br>  And the last thing I found interesting in Locomotive is how they expanded Express <a href="http://locomotivejs.org/guide/routing/">routing</a> .  They implemented match () which allows you to create routes with “placeholder”: <br><br><pre> <code class="hljs scala"> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.<span class="hljs-keyword"><span class="hljs-keyword">match</span></span>(<span class="hljs-symbol"><span class="hljs-symbol">'songs</span></span>/:title', { controller: <span class="hljs-symbol"><span class="hljs-symbol">'song</span></span>s', action: <span class="hljs-symbol"><span class="hljs-symbol">'sho</span></span>w' });</code> </pre><br><br>  and added in my opinion an interesting “sugar”, registration is not just routes but the whole resources manipulated through REST.  That is such a line: <br><br><pre> <code class="hljs kotlin"> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.resources(<span class="hljs-string"><span class="hljs-string">'photos'</span></span>);</code> </pre><br><br>  Will make available to you such routes as: <br><br><table><tbody><tr><th>  Method: </th><th>  Route: </th><th>  Promapit on action: </th></tr><tr><td>  Get </td><td>  / photos </td><td>  index </td></tr><tr><td>  Get </td><td>  / photos / new </td><td>  new </td></tr><tr><td>  POST </td><td>  / photos </td><td>  create </td></tr><tr><td>  Get </td><td>  / photos /: id </td><td>  show </td></tr><tr><td>  Get </td><td>  / photos /: id / edit </td><td>  edit </td></tr><tr><td>  PUT </td><td>  / photos /: id </td><td>  update </td></tr><tr><td>  DELETE </td><td>  / photos /: id </td><td>  destroy </td></tr></tbody></table><br><br>  And you will be able to describe the behavior of these routes by the PhotosController controller with the corresponding actions from the column “Promapit to action”.  The functionality itself is simple but sometimes useful to save time.  There are a lot of customizations around these “tweaks” so you don’t need to think: “AAAAAA, what to do if I only need show and edit” - the developer <a href="http://locomotivejs.org/guide/resources/">took care</a> of that too. <br><br><h2>  Testing the ease of installation and configuration </h2><br>  “I did it, I installed and configured Locomotive + Socket.io and did all the demos I wanted,” I would like to say so, but there were a lot of problems.  Locomotive can be installed as easily as Express: <br><br><pre> <code class="bash hljs">npm install locomotive -g</code> </pre><br>  and then create a project: <br><pre> <code class="bash hljs">lcm create project</code> </pre><br>  and run: <br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> project &amp;&amp; lcm server</code> </pre><br><br>  Everything is fine, bye, if you open the browser at <a href="http://localhost:3000/">http: // localhost: 3000</a> then Locomotive will greet you cheerfully. <br>  But my goal was to set up so Locomotive so that it could properly handle Web socket requests and download files. <br>  There are no problems with uploading files, since Locomotive is built on top of Express, and also how it works in Express is the same with Locomotive. <br>  But with Web Sockets there was a little not pleasant situation.  For some reason, the developer of Locomotive considered that the creation of an Express (app) object should be closed as part of the framework, thereby cutting off any possibility to wrap an Express for example in Express.io (of course, you can stupidly patch the code, but this is not our method).  Then I abandoned the idea of ​​using Express.io, although it was best suited to Locomotive, since Express.io is an excellent fit for Express, over which Locomotive is written.  Then I decided to connect Socket.io directly, but even here I was disappointed.  For example, references on which people <a href="https://groups.google.com/forum/%2523!topic/locomotivejs/WnKmRpr-i1k">cannot solve this problem without “castes”</a> , and the developer of Locomotive is not particularly in a hurry to <a href="https://github.com/jaredhanson/locomotive/pull/88">“merge pull requests” on Github</a> .  Yes, and how the development of a campaign in general does not go over this framework, judging by the history of commits on Github. <br><br><br><h2>  Finally </h2><br>  In conclusion, I can say that in principle, the Locomotive add-on is not bad, but in my opinion it is not absolutely expandable, that is, I wouldn’t risk further expanding on it, since I would have to patch the framework itself a lot. <br>  But if your tasks, such as making “Landing Page”, “Business card”, then Locomotive is very suitable for this. <br><br>  Used literature: <br><br>  <a href="http://locomotivejs.org/guide/">http://locomotivejs.org/guide</a> </div><p>Source: <a href="https://habr.com/ru/post/197066/">https://habr.com/ru/post/197066/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../197048/index.html">IT students forced to work on the assembly of the PlayStation 4</a></li>
<li><a href="../197056/index.html">Google starts paying rewards for fixing vulnerabilities in open source projects</a></li>
<li><a href="../197058/index.html">Metric # 25 - A podcast about technologies, products, and services from the IT world</a></li>
<li><a href="../197060/index.html">The process of testing mobile applications</a></li>
<li><a href="../197062/index.html">Details about the Nexus 5</a></li>
<li><a href="../197068/index.html">Audiofocus - control access to the audio subsystem</a></li>
<li><a href="../197074/index.html">CFD 3D: a simple water simulator</a></li>
<li><a href="../197076/index.html">Frankenpad: history of the phenomenon</a></li>
<li><a href="../197078/index.html">Cable connectivity management system AMPTRAC from TE connectivity</a></li>
<li><a href="../197080/index.html">We connect Asterisk to Avaya under the H.323 protocol</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>