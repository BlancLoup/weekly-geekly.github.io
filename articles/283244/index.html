<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>F1 2015: a new level of realism on the PC</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="F1 2015 is the latest game from the Formula One series. It was released by Codemasters, based on a special version of their EGO game engine. The game ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>F1 2015: a new level of realism on the PC</h1><div class="post__text post__text-html js-mediator-article">  <a href="http://www.formula1-game.com/us/home">F1 2015</a> is the latest game from the Formula One series.  It was released by Codemasters, based on a special version of their EGO game engine.  The game was created almost completely from scratch, the new engine has significantly improved the quality of the picture, and the capabilities of artificial intelligence. <br><br>  EGO - the first development of Codemasters, aimed at the eighth generation of gaming consoles (PS4 and Xbox One) and the PC platform.  The architecture of the new engine was designed to work with multi-core processors, which are used in the above-mentioned consoles.  In addition, the company sought to create a scalable platform that would effectively use the resources of modern computers. <br><br><img src="https://habrastorage.org/files/579/3e2/102/5793e2102f824743a309b8772489ea9b.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In November 2015, a fix pack was released, which added to the EGO an updated sound subsystem and better support for the particle system, in the processing of which the microprocessor is involved.  As a result, the game was able to use the capabilities of the best gaming computers at full capacity. <br><br>  In this article we will talk about how Codemasters improved their game engine, and what they managed to achieve. <br><a name="habracut"></a><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/03d/cc9/2a4/03dcc92a4b7e38c7b457b047b2ff20c1.jpg"></div><br>  <i><font color="#999999">F1 2015</font></i> <br><br><h2>  <font color="#0071c5">Adapt to PC hardware</font> </h2><br>  Modern microprocessors for computers are, in a first approximation, a wide range of clock frequencies and a different number of cores.  One of the components of the success of the game is the ability to adapt to the various hardware characteristics of the systems. <br><br>  Games developed in those days, when computers usually used processors with one or two cores, were designed for the availability of a limited number of threads.  The same was true for games for early generations of game consoles. <br><br>  The main streams were allocated to perform rendering and calculations associated with the game logic.  To solve smaller problems using the remaining system resources.  On a PC, with this design approach, preference was given to processors with very high single-threaded performance. <br><br>  Nowadays, everything has changed.  So, the eighth-generation consoles, both PS4 and Xbox One, are now equipped with eight-core processors.  Each of them is a highly efficient computing unit with relatively low productivity.  The game involves six to seven such cores.  What remains is intended for the operating system. <br><br>  With modern computers - the same story.  They install processors with the number of cores from two to eight.  At the same time, if the core, using technology like Intel Hyper-Threading (Intel HT), supports simultaneous multithreading technology, it looks to the OS as two logical processors. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/d21/f19/45f/d21f1945fa454cadb8bb25f4e61301ee.jpg"></div>  <i><font color="#999999">RedBull 2016 car</font></i> <br><br>  This means that the PC-game can use up to 16 logical processors, some of the resources which go to the operating system.  Therefore, the old approach is not applicable to new hardware, and if the code for the consoles can be optimized for a specific configuration, then the games for computers need to be able to adapt to the available resources. <br><br><h2>  <font color="#0071c5">The first tests on the PC</font> </h2><br>  When the game's release date was nearing July 10, 2015, it became clear that the new engine effectively uses multi-core processors, and that its performance indicators seriously differ from the early F1 versions, which were designed for the previous generation of consoles.  Here is a comparison of workloads on the CPU and GPU for F1 2014 (left), and F1 2015 (right), which run with maximum quality settings and no limited frame rate. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/9ca/e5f/2e8/9cae5f2e8cb19ab1762ea125d4a1fbe0.jpg"></div><br>  <i><font color="#999999">Analysis of F1 2014 (left) and F1 2015 (right) in GPUView</font></i> <br><br>  Images are made using the Microsoft GPUView (this tool is included in the Windows Performance Toolkit, as part of the <a href="https://dev.windows.com/en-us/downloads/windows-10-sdk">Windows Platform SDK</a> ).  It shows how well work is distributed between the processor and the video core.  GPUView, in addition, can be used to find problems with synchronization and insufficient loading of the video card.  This can be seen at the top of the image, below it is shown in an enlarged view. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/781/760/694/78176069410b3b950e5062a676160524.jpg"></div><br>  <i><font color="#999999">GPU load in F1 2014 and F1 2015</font></i> <br><br>  The purple line breaks in the upper left of the image indicate interruptions in the GPU in F1 2014. This means that the video card is idle and does nothing useful.  At the same time, the performance of F1 2014, on the studied high-performance systems, does not rest on the capabilities of the GPU.  At 1080p, the game was limited only by processor performance. <br><br><img src="https://habrastorage.org/files/2cb/e55/230/2cbe55230d504abd9e1f598497086dce.jpg"><br>  <i><font color="#999999">Car Ferrari 2016</font></i> <br><br>  The corresponding line on the right (blue) does not contain gaps.  This means that in F1 2015 the GPU is always loaded.  In the figure, which shows a complete picture of the system load, the lines below the yellow separator show the load on the processor threads.  In F1 2014 (left), one thread is almost constantly loaded, it limits the performance.  Take a closer look at this part of the image. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/568/aec/04a/568aec04ad29d63419bad32bb3f9a072.jpg"></div><br>  <i><font color="#999999">Load distribution on threads</font></i> <br><br>  The different colors used to color the stripes represent the logical processors of the system.  Changing the color of the stream means that it is periodically executed on different logical processors within the same frame. <br><br>  One more stream loaded with calculations can be seen in the lower part of the left image relating to F1 2014. This stream is processing graphics driver commands.  At the same time, in the image on the right (for F1 2015), all flows have some idle time, that is, there is no noticeable relationship between the flows. <br><br>  If you combine the analysis of CPU and GPU, you can see that F1 2014 was limited to the critical path through the engine, which prepares data for the graphics API, loading one stream.  Thus, F1 2014 is a classic example of using an engine designed to run on game consoles of previous generations, when the load is optimized for good performance on fast dual-core processors, with some improvements in the transition to quad-core.  But adding more cores does not give tangible benefits, since the limiting factor is the only main rendering stream. <br><br>  The new engine, on the other hand, significantly reduces the processor overload associated with preparing data for a video card, taking full advantage of the Intel HT technology and evenly distributing the load between logical processors. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/48e/a20/94e/48ea2094e60ae1d0f26c74bf141ac6bc.jpg"></div><br>  <i><font color="#999999">Analysis of F1 2015 in GPUView at 60 FPS</font></i> <br><br>  The company's programmers quickly discovered that computers were much faster than the consoles for which they performed most of the optimizations.  Achieving the usual frame rate of 60 FPS (16 ms for computing is required) on the consoles required a lot of effort.  And when tested on the 4th generation of Intel Core processors (for example, Intel Core i5-4670), it turned out that the processor performed all the necessary work in less time than is required to create a frame.  In many cases - faster than 10 ms. <br><br>  The above figure shows an analysis of the game in GPUView with a screen refresh rate limit set to 60 Hz.  Faster processors, such as the 6th generation Intel Core i7-6900K, make the imbalance even more noticeable. <br><br>  This is how the analysis of the game looks like with an unlocked frame rate in a system with an installed Intel Core i7-5960x 5th generation and an NVIDIA GTX980 video card. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ec3/d57/ad5/ec3d57ad5665df8d264f6ba355b4606f.jpg"></div><br>  <i><font color="#999999">A game with an unlocked frame rate running on an Intel Core i7-5960x with 8 cores (16 threads) in GPUView</font></i> <br><br>  In comparison with the quad-core processor (the very first figure, which compares F1 2014 and 2015), in a system based on Intel Core i7-5960x with 16 logical processors, the CPU stands idle a considerable part of the time needed to prepare the frame. <br>  All this means that the new engine benefits not only from an increase in single-threaded performance, but, most importantly, it can benefit from additional processor cores. <br><br>  The result shows that the Intel Core i7-5960x with six cores involved can bypass the quad-core i7-6700k, whose clock frequency is higher. <br><br>  These initial tests, which showed that the GPU was already fully loaded, changed the optimization priorities on the PC.  Improvements related to the video card continued, but instead of spending developers' resources on optimizing the rendering subsystem on the CPU (such as transferring part of the video core work), the studio began to explore other ways to optimize processor usage to improve the user experience of the game and improve its performance. realistic <br><br><h2>  <font color="#0071c5">Improved realism</font> </h2><br>  The developers had a difficult and interesting task.  It was to improve the realism of the game, make it more attractive without affecting the gameplay (due to the requirements for network multiplayer mode) and without adding much more work from the GPU.  In this regard, from the changes in artificial intelligence and improve the accuracy of game physics immediately refused, because such improvements should be achievable on the hardware of any PC that meets the minimum requirements of the game.  It is necessary in order not to put in an unequal position the players using different computers in multiplayer mode. <br><br><img src="https://habrastorage.org/files/f98/9d4/525/f989d45254554794801f1c56fa932e89.png"><br>  <i><font color="#999999">Mercedes-Benz F1 W07 Hybrid car, presented in 2016</font></i> <br><br>  Even in single-user mode, any changes in the behavior of cars can be difficult, since they require very careful rebalancing of the machine control system.  Instead, Codemasters focused on two ways to increase realism.  In particular, these are improvements in the field of sounding the game using the updated sound subsystem and an increase in the number of dynamic visual design elements due to the updated particle system.  These subsystems were chosen because they were already based on the CPU and were previously limited by the capabilities of the consoles.  The PC architecture gave developers the opportunity to improve the immersive effect using techniques that were initially abandoned due to hardware limitations. <br><br><h2>  <font color="#0071c5">Sound playing</font> </h2><br>  Improving the gaming sound was the first direction of optimization.  This approach, on the one hand, can be scaled depending on the available hardware, on the other hand, it allows to improve the gaming experience without affecting the gameplay. <br>  Sound support in F1 2015 is implemented using an intermediate subsystem, which creates its own stream for mixing sound by means of the processor. <br><br>  Earlier in Codemasters found that if this thread is overloaded, or its execution will be delayed, it will result in noticeable interruptions in sound.  To prevent interruptions on consoles, a separate core was allocated to the ‚Äúsound‚Äù stream.  This allowed us to guarantee uninterrupted sound processing. <br><br>  The computer has a separate logical processor for the sound subsystem.  Other game tasks use the remaining resources.  On consoles for such threads, a binding to the processor core is used, and on computers, the SetThreadIdealProcessor () command is used, which helps the operating system in assigning priorities. <br><br>  Even if a separate core or logical processor is allocated to the stream, it is important to mix at a sufficient speed.  As a result, the maximum number of sound sources was limited to the amount that can be processed in the worst-case scenario, for example, in an accident.  Initially, the limitation on the sources of sound was established as follows: 5 cars, plus a player‚Äôs car. <br><br>  With a much more powerful processor, with a potentially large number of processor cores, to handle mixing tasks, the operating system is unlikely to attempt to schedule the execution of some additional tasks on the logical processor assigned to the sound processing flow.  Accordingly, it was possible to add support for high-quality sound to the PC version of the game.  Namely, we are talking about the following improvements. <br><br><ul><li>  An increase in the number of cars contributing to the sound picture that is developing around the player.  Namely, from 6 (5 cars that control artificial intelligence and one player‚Äôs car) to 11 (10 opponents and one player respectively). <br><br></li><li>  Removing some restrictions on the number of objects, as a result, more sound sources are reproduced when moving from one object to another, thus avoiding sudden "cliffs" of sound. <br><br></li><li>  Replaces some of the reverb effects of the used sound processing subsystem with more advanced ones.  The use of more complex algorithms, processing more reflections of sounds.  Use pre-created pulse files for reliable simulation of various environmental conditions.  For example, this passage near the stands, the movement of bridges, tunnels.  In addition, barriers around the track and cars passing by contribute to the sound picture. <br></li></ul><br><h2>  <font color="#0071c5">Particle system and weather simulation</font> </h2><br>  Another improvement in the game was the updated particle system.  The previous version of this system was limited by the available resources of the CPU and GPU game consoles.  The visual component was built on the basis of these limitations.  The particle system was already based on the CPU.  This is what Andrew Wright, a graphics programmer from Codemasters, tells about. <br><br>  "We assumed (and, I must say, correctly) that we will be more limited by GPU resources than CPU, so the development of a particle system has always been approached from the point of view of its efficient parallel processing on a CPU." <br><br>  This means that a team of programmers started working on system improvements, which can be scaled depending on the amount of available processor resources.  Moreover, they could do this so that the improvements, at the same time, do not necessarily lead to an increase in the load on the video core.  The fact that the support of the particle system is assigned to the processor has other advantages, which Andrew talked about: <br>  ‚ÄúThe system based on the CPU is very flexible.  It handles collision trails for individual types of particles specifically designed for this ‚Äî basically something like gravel and grass.  This also works for particles that are not visible, that is, a rapid movement of the camera will show previously invisible particles in some intermediate phase of motion.  Collisions can cause sound effects.  This part of the work is very difficult to implement on the GPU. " <br><br>  The first part of the task was to increase the number of particles created with small and almost imperceptible changes in their graphic design.  In particular, the particle size was reduced, and their density per unit of space increased.  These changes give the same visible effect at some distance, but near the picture becomes much more detailed.  This was done for various effects created by the tire's interaction with the road (both on the asphalt road and beyond).  Here is what it looks like. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/12b/156/cb0/12b156cb0c31ac1b309c8946ee48a138.png"></div><br>  <i><font color="#999999">Improved effect on gravel outside the track</font></i> <br><br>  In a similar way, the effect of smoking tires was improved.  Here, particles of relatively large sizes were replaced by much smaller ones, which made it possible to better convey the shape of a cloud of smoke.  This made it possible to improve the volumetric illumination used for smoke, since smaller particles allow for a better mathematical representation of how light passes through smoke-filled space.  Here is what it looks like. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1b6/008/be0/1b6008be0022f25fb4556387032fe17c.png"></div><br>  <i><font color="#999999">Improved tire look</font></i> <br><br>  Although the particle system improvements described above are quite significant, they are visible only in short periods, for example, when a player or artificial intelligence loses control of the car and it flies off the track. <br><br>  The developers quickly realized that the updated particle system could be used to significantly improve the simulation of weather conditions, namely rain.  The weather does not depend on the player‚Äôs ability to keep the track, therefore, improved visual effects can be observed not only at special moments of the game. <br><br>  One of the major improvements of the game, on which Codemasters places special emphasis in promotional materials, is the improvement of car management.  In particular, the behavior of cars on a wet road is significantly improved.  Driving in the rain is an important part of real Formula 1 racing. Many of the tracks are known for the extreme weather conditions that influence the race.  The table shows the probability of precipitation during the race in the Champion and Pro game modes.  On average, when carrying out 34% of game races it rains, at least some of the races lasting up to four hours. <br><br>  <i><font color="#999999">Chance of precipitation</font></i> <br><table><tbody><tr><td>  Australia (Melbourne) <br></td><td>  Malaysia (Kuala Lumpur) <br></td><td>  Bahrain (Sahir) <br></td><td>  China (Shanghai) <br></td><td>  Spain (Catalonia) <br></td><td>  Monaco (Monte Carlo) <br></td><td>  Canada (Montreal) <br></td><td>  Japan (Suzuka) <br></td><td>  Russia (Sochi) <br></td><td>  United States (Austin) <br></td></tr><tr><td>  26.00% <br></td><td>  55.00% <br></td><td>  0.00% <br></td><td>  48.00% <br></td><td>  36.00% <br></td><td>  38.00% <br></td><td>  53.00% <br></td><td>  33.00% <br></td><td>  34.00% <br></td><td>  24.00% <br></td></tr><tr><td>  Austria (Red Bull Ring) <br></td><td>  United Kingdom (Silverstone) <br></td><td>  Germany (Hockenheim) <br></td><td>  Hungary (Budapest) <br></td><td>  Belgium (Spa-Francorchamps) <br></td><td>  Italy (Monza) <br></td><td>  Singapore <br></td><td>  Brazil (Sao Paulo) <br></td><td>  Abu Dhabi (Yas Marina) <br></td><td>  Mexico <br></td></tr><tr><td>  43.00% <br></td><td>  31.00% <br></td><td>  37.00% <br></td><td>  39.00% <br></td><td>  47.00% <br></td><td>  26.00% <br></td><td>  39.00% <br></td><td>  40.00% <br></td><td>  3.00% <br></td><td>  28.00% <br></td></tr></tbody></table><br>  The transition to smaller particles, more closely spaced in space, means that the behavior of water droplets can be modeled with much higher accuracy.  The particle system processes nonlinear changes in particle characteristics during their existence for their properties such as color, transparency, violation of surface smoothness, angular resistance, linear resistance, and the effect of gravity.  All this, moreover, is consistent with the wind simulation system, which is used to simulate rain. <br><br><img src="https://habrastorage.org/files/173/48a/037/17348a03735e40f7bbde6f5e1ad3aeab.png">  <i><font color="#999999">Car MP4-31 McLaren 2016</font></i> <br><br>  In the drawings below, you can see debug images showing the behavior of small splashes of water from the wheels of the car and their interaction with the air that passes through the casing.  The resulting effect is to create a spiral vortex emanating from the rear of the machine. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c38/7d7/e83/c387d7e83e9a7994941c3528c26cafb8.png"></div><br>  <i><font color="#999999">A twist debugging image showing the motion of water splashes.</font></i> <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/d30/3d6/fe5/d303d6fe5820a9c9140c80cba681f3eb.png"></div><br>  <i><font color="#999999">Twirl debugging image, back view</font></i> <br><br>  The use of smaller particles also means that the existing lighting model works much better with water droplets.  Light from sources of illumination, for example, from some parts of cars, can be modeled much more accurately on small particles than on large ones, representing large volumes of droplets.  The picture below shows the lighting of traces of water spray. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/382/7a0/a41/3827a0a412b60a46302c889d9659add9.png"></div><br>  <i><font color="#999999">Lighting improvement</font></i> <br><br>  Another area in which improvements have been made is the interaction of the car with water on the road surface.  This and water whirlwinds behind the car, which capture water from the ground, and splashes from the wheels on the road flooded with rain.  All this allows to improve the visual connection of the car with the road, to achieve the same effect, which is achieved thanks to the shadows on a sunny day. <br><br>  Here's what a wet ride looks like before and after upgrades. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/1d8/3e3/1b9/1d83e31b988747d2a81889abfe20b26d.png"></div><br>  <i><font color="#999999">Water interaction on the road</font></i> <br><br>  But the drops of water that form the trail behind a passing car in the game (left) and when debugging in the <a href="https://software.intel.com/en-us/gpa">Intel INDE Graphics Performance Analyzer for DirectX</a> . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ff5/904/520/ff590452008f354c171ab78b645110ce.png"></div><br>  <i><font color="#999999">Trail of water droplets</font></i> <br><br>  The latest improvement was an improved rain simulation.  Initially, a simple algorithm was used in the game, using video card resources, which output several thousand particles of rain in each frame, applying gravity to each drop, which caused them to fall.  In the new rain simulation, most of the updated subsystem has moved to the processor, which made it possible to interact with the airflow data used in other parts of the game.  The number of raindrops was increased tenfold, and the individual droplets were reduced so that the pixel coverage was about the same.  The figure below shows the debug images of the rain taken from the same position.  On the bottom image - 217 thousand drops, on the top, representing the previous version of the game, only 21 thousand.  Despite the increasing number of primitives, the actual number of pixels affected by the improvement increased slightly from 72 thousand to 119. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/09c/7c9/368/09c7c9368a619e10b103a894d294eef1.png"></div><br>  <i><font color="#999999">Debug rain simulation</font></i> <br><br>  By increasing the number of raindrops and mist, the developers set up the transparency used in the particle system so that the resulting misting effect, visible from a distance, turns out to be the same as it was before.  This is necessary so that the graphical settings do not change the gameplay. <br><br><h2>  <font color="#0071c5">CPU load balancing in new conditions</font> </h2><br>  Usually, the video card was the limiting factor in PC performance for F1 2015.  The load was especially high on low-cost devices.  The most important part of developing and implementing new effects was ensuring that the extra particles did not increase the load on the GPU.  The second important factor in computing resources was the achievement of a good distribution of the computations running on the processor.  A proper load balancing between the available CPU resources was needed, and it was impossible to prevent the load from increasing in the sequence of engine operations responsible for rendering. <br><br>  Control over the load on the GPU is achieved through two approaches. <br><br>  The first is that vertex processing has been moved from the vertex shader to the CPU.  This reduced the amount of work done on the vertices on the video card.  This approach did not lead to a complete removal of the load from the video core, but it was reduced by half.  Thus, the processing of ten times more particles meant a fivefold increase in the cost of conducting operations with vertices. <br><br>  The second significant change was to reduce the cost of filling the frame, for example, when rendering rain.  The number of drops increased tenfold, but the number of pixels it affected increased only 1.65 times.  In the case of the turbulence of the water dust, which remain behind the machine, the changes were even more significant.  Thus, the increase in the number of vertices from 3 thousand to 70, in fact, led to a decrease in the number of processed pixels from 5,800 thousand to 2,500 thousand, that is, the pixel fill rate required to implement this effect was halved.  As a result, the effect, which is used to create 20 times more particles, did not require a serious increase in the load on the video card when displaying the image. <br><br>  The load balancing on the CPU was done by distributing the particle-related calculations between as many logical processors as possible.  The figure below shows the load distribution on systems with four and six cores (in both the first and second cases with Intel HT technology enabled).  The purple and red blocks show particle processing systems and weather simulations during a very heavy rain on a six-core processor (12 logic processors).  On such a processor, 6 of 12 processors are engaged in calculations for a particle system.  On the quad core, respectively, five of the eight are involved, but their resources have to be shared with other tasks in the engine. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/0c7/bec/248/0c7bec248f59d2e68914f5e8e6cfa779.png"></div><br>  <i><font color="#999999">CPU load balancing for a 6-core system (left) and a 4-core system (right)</font></i> <br><br>  The game engine involved in F1 2015 uses a task-based system for load sharing.  At the same time there are presets for 2, 4, 8, 12 and 16 logical processors.  The system tries to schedule tasks so as to reduce any dependencies and not overload one of the processors. <br><br><h2>  <font color="#0071c5">How has the look of the game</font> </h2><br>  The figure below shows a comparison of the original (left) and significantly improved (right) particle system.  Pay attention that the water dust in the second case is more clearly tied to the car that raises it into the air. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/46b/e93/6dc/46be936dc751d18c1662f5ef30e6df10.png"></div><br>  <i><font color="#999999">Water whirls that cause cars</font></i> <br><br>  Improvements in the treatment of sprays that cars raise from the road, losing traction with it, are shown in the figure below.  At the same time, individual drops are noticeable on the background of the F1 2015 logo at high quality settings.  In addition, improvements in tire interaction with the track can be seen. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/c14/4e5/b99/c144e5b99c011f02c609083c972228b6.png"></div><br>  <i><font color="#999999">Skid</font></i> <br><br><h2>  <font color="#0071c5">Performance scaling</font> </h2><br>  F1 2015 has a built-in performance test that uses the current graphics settings and can be configured to run in various weather conditions.  The figure shows the data obtained when running the embedded test in a system with an Intel Core i7-5960x, with a frequency fixed at 3.0 GHz (this is its base frequency), and an NVIDIA TitanX video card.  There you can see a list of used settings.  The data shown here is the average number of frames per second obtained after the test was fully completed. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/38b/c87/617/38bc87617655d505720aadf9524a8b00.jpg"></div><br>  <i><font color="#999999">Performance scaling on multi-core systems</font></i> <br><br>  The number of physical processor cores was configured via BIOS.  The remaining parameters of the system remained unchanged.  Tests were conducted with and without Intel HT technology. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/b32/b50/ad4/b32b50ad4749027710dd1c50a6d15d95.png"></div><br>  <i><font color="#999999">Test settings</font></i> <br><br>  On a system in which only 2 cores were turned on, with Intel HT technology turned off, the game did not start, since such a configuration does not meet the minimum system requirements.  In general, ceteris paribus, the inclusion of Intel HT increased performance in much the same way as with the addition of two additional cores.  A comparison of performance in a configuration with two cores and Intel HT enabled, and in a configuration with Intel HT and four cores, gave an increase in frame rate by 79%.  The transition to the 6-core configuration added another 17%.  Using the same 8-core configuration with Intel HT turned on gave a performance increase of 27% compared to the 4-core configuration and Intel HT.  Here it is necessary to take into account the fact that the obtained results cannot be considered as some absolute values.  We can only argue that they reflect the results of testing on a specific system. <br><br>  ,           ,   ‚Äì   ,   ,  ,    ,  ,            . <br><br>          20 ,        .          4-    .           . ,    Intel Core i7-5960x       ,     4- ,    ,     . <br><br><h2>  <font color="#0071c5">findings</font> </h2><br> F1 2015 ‚Äì   ,  ,            .    CPU  GPU          .    ,      ,  Codemasters     F1 2015.     ,  ‚Äì   .         . <br><br>        Intel HT     ,  Codemasters       .            . </div><p>Source: <a href="https://habr.com/ru/post/283244/">https://habr.com/ru/post/283244/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../283226/index.html">Runtime programming industrial robot on RCML</a></li>
<li><a href="../283228/index.html">You do not know Node: a brief overview of the main features</a></li>
<li><a href="../283230/index.html">Material Design: philosophy and practice</a></li>
<li><a href="../283238/index.html">Welcome to the DotNext conference</a></li>
<li><a href="../283242/index.html">Taming the elephant or what is HUE</a></li>
<li><a href="../283248/index.html">9 secrets of online payments. Part 5: Mobile Payments</a></li>
<li><a href="../283250/index.html">Sale of PHDays VI tickets closes.</a></li>
<li><a href="../283252/index.html">Lossless data compression algorithms: what they say about markets</a></li>
<li><a href="../283254/index.html">9 secrets of online payments. Part 6: one click payment</a></li>
<li><a href="../283256/index.html">Trend Analysis in Mobile Broadband Access (MBB)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>