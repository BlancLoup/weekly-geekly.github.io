<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Add iAd advertising banners to your iPhone apps.</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In April of this year, during the presentation of the new iOS 4 operating system (the former iPhone OS), Steve Jobs also introduced the new Apple plat...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Add iAd advertising banners to your iPhone apps.</h1><div class="post__text post__text-html js-mediator-article"> In April of this year, during the presentation of the new iOS 4 operating system (the former iPhone OS), Steve Jobs also introduced the new Apple platform for mobile advertising - iAd.  According to Apple, their main task is to give developers the opportunity to earn free and low-cost applications by placing in the latest advertising banners.  Payment will go both for displaying an advertising banner and for clicks on it.  In the second case, the payment will be significantly higher. <br><br>  The main idea of ‚Äã‚ÄãiAd is a combination of interactivity, which is provided by the use of a smartphone or tablet, with the emotionality of an advertisement, in which both audio and video are involved.  For these purposes, creating advertisements uses Java Script, HTML5, CSS3 and multitouch.  All this allows you to create interesting and eye-catching commercials applications.  Examples of such advertisements we could <a href="http://www.youtube.com/watch%3Fv%3D32wOPLCtj9E">see at the presentation of the new operating system (in English)</a> . <br><br>  The main problem of mobile advertising today, according to Apple, is that when a user clicks on an advertising banner, the user leaves the application - moving, more often, to the advertiser's site.  With iAd, we can get around this trouble.  After clicking on the banner advertisement appears on top of your application.  The user can close it at any time and return to your application at the exact moment in which he left it. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Based on the iAd Programming Guide and the video from WWDC 2010, I sketched a brief overview-translation of this new technology.  It will not be about creating colorful advertisements themselves, but about placing those in your applications. <br><br><a name="habracut"></a><br><br>  The first thing you need to do to place an ad in your application is to add to your Xcode project <b>iAd.framework</b> .  It is contained in the iOS 4 SDK.  Well, do not forget to add #import &lt;iAd / iAD.h&gt; where necessary.  Developers are offered to use two banners to choose from - 320 x 50 pixels.  for portrait layout and 480 x 32 pix.  for landscape.  The basis of this banner is the <b>ADBannerView</b> class, which is a subclass of UIView.  Therefore, all you need is to embed this view into your hierarchy of interface controls.  You can do this both programmatically and through Interface Builder - a new UI element appeared there - Ad BannerView. <br><br> <a href=""><img height="600" width="375" src="http://img227.imageshack.us/img227/9302/20100625112541.png"></a> <br><br>  Apple strongly recommends placing the banner on top or bottom of the screen and not placing it on the moving parts of elements such as ScrollView and TableView ‚Äî this reduces the impressions (and as a result your money), and the user is uncomfortable to ‚Äúcatch‚Äù such a banner. <br><br>  Let's just create a new project in Xcode based on the View-based Application template and add an ad banner to it.  Our application will be called iAdEx.  Change the code in iAdExViewController.h <br><br><pre> <code class="hljs scala">#<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> &lt;<span class="hljs-type"><span class="hljs-type">UIKit</span></span>/<span class="hljs-type"><span class="hljs-type">UIKit</span></span>.h&gt; #<span class="hljs-keyword"><span class="hljs-keyword">import</span></span> &lt;iAd/iAd.h&gt; <span class="hljs-meta"><span class="hljs-meta">@interface</span></span> iAdExViewController : <span class="hljs-type"><span class="hljs-type">UIViewController</span></span> <span class="hljs-string"><span class="hljs-string">"&lt;"</span></span><span class="hljs-type"><span class="hljs-type">ADBannerViewDelegate</span></span><span class="hljs-string"><span class="hljs-string">"&gt;"</span></span> <span class="hljs-comment"><span class="hljs-comment">//  ,    ADBannerViewDelegate { ADBannerView *adView; BOOL bannerIsVisible; } @property (nonatomic,assign) BOOL bannerIsVisible; @end</span></span></code> </pre><br><br>  and in iAdExViewController.m we change the viewDidLoad method <br><br><pre> <code class="hljs objectivec">- (<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>)viewDidLoad { adView = [[ADBannerView alloc] initWithFrame:<span class="hljs-built_in"><span class="hljs-built_in">CGRectZero</span></span>]; adView.frame = <span class="hljs-built_in"><span class="hljs-built_in">CGRectOffset</span></span>(adView.frame, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">-50</span></span>); adView.requiredContentSizeIdentifiers = [<span class="hljs-built_in"><span class="hljs-built_in">NSSet</span></span> setWithObject:ADBannerContentSizeIdentifier320x50]; adView.currentContentSizeIdentifier = ADBannerContentSizeIdentifier320x50; [<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.view addSubview:adView]; adView.delegate=<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.bannerIsVisible=<span class="hljs-literal"><span class="hljs-literal">NO</span></span>; [<span class="hljs-keyword"><span class="hljs-keyword">super</span></span> viewDidLoad]; }</code> </pre><br><br>  Let's dwell a little bit more on the properties <i>requiredContentSizeIdentifiers</i> and <i>currentContentSizeIdentifier</i> . <br>  In the first property, you specify all kinds of banners that you are going to use in your application.  And the second property is what type of banner you will use at this particular moment.  Since I am still writing the simplest application, we‚Äôll continue with the same banner size and portrait orientation, and below I will make the banner change depending on the orientation of the phone. <br><br>  Let's stop for a second and discuss.  The device receives advertising banners from the network.  What happens if we are in a place where there is no connection?  Or some interruptions with Apple c server advertising?  Then our ADBannerView will be empty.  Not only is it not beautiful, it also takes the place of our application in vain.  Apple strongly advises to use, as they call it, ‚Äúthe ideal realization‚Äù - when in the absence of advertising for some reason the banner is removed from the application screen, and when the connection is restored and an advertisement is received - it is again displayed on the screen.  We knowingly attributed <i>ADBannerViewDelegate</i> in the description of our class, and now it can receive messages from the banner.  In case of successful ad acceptance, the banner will send us a message <i>bannerViewDidLoadAd</i> , and in case of any problems with this, <i>didFailToReceiveAdWithError</i> message.  We now implement the required methods for this in our application. <br><br><pre> <code class="hljs ruby">- (void)<span class="hljs-symbol"><span class="hljs-symbol">bannerViewDidLoadAd:</span></span>(ADBannerView *)banner { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.bannerIsVisible) { [UIView <span class="hljs-symbol"><span class="hljs-symbol">beginAnimations:</span></span>@<span class="hljs-string"><span class="hljs-string">"animateAdBannerOn"</span></span> <span class="hljs-symbol"><span class="hljs-symbol">context:</span></span>NULL]; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>          <span class="hljs-number"><span class="hljs-number">50</span></span>  banner.frame = CGRectOffset(banner.frame, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">50</span></span>); [UIView commitAnimations]; <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.bannerIsVisible = YES; } } - (void)<span class="hljs-symbol"><span class="hljs-symbol">bannerView:</span></span>(ADBannerView *)banner <span class="hljs-symbol"><span class="hljs-symbol">didFailToReceiveAdWithError:</span></span>(NSError *)error { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.bannerIsVisible) { [UIView <span class="hljs-symbol"><span class="hljs-symbol">beginAnimations:</span></span>@<span class="hljs-string"><span class="hljs-string">"animateAdBannerOff"</span></span> <span class="hljs-symbol"><span class="hljs-symbol">context:</span></span>NULL]; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   ,    ,   -     banner.frame = CGRectOffset(banner.frame, <span class="hljs-number"><span class="hljs-number">0</span></span>, -<span class="hljs-number"><span class="hljs-number">50</span></span>); [UIView commitAnimations]; <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.bannerIsVisible = NO; } }</code> </pre> <br><br>  Run <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/327/865/b9f/327865b9fac9091eae3dd05c9fae637a.png" alt="image"><br><br>  Click on the banner <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/a6c/498/652/a6c4986523850f2f92c016e655e205ed.png" alt="image"><br><br>  So we implemented everything correctly, as comrades from Apple ask us.  If we now launch the application, we will see that there is a banner, it shows a test ad, and if we click on it, then a large test advertisement will open.  But there is one problem.  It's good to me that I have a test application that does nothing at all, except as a banner shows.  And you, probably, have games and music players, and other interactive applications.  If you do the same thing as me, you will notice that your application will continue to play music or video while the ad is showing and it turns out to be a mess.  And if you have a game and you need to urgently respond to the event - then users generally will shy away from advertising in your application.  In order to solve these issues, we will implement the <i>bannerViewActionShouldBegin</i> methods in our application, when a large advertisement starts to unfold and <i>bannerViewActionDidFinis</i> h, when minimized. <br><br><pre> <code class="hljs ruby">- (BOOL)<span class="hljs-symbol"><span class="hljs-symbol">bannerViewActionShouldBegin:</span></span>(ADBannerView *)banner <span class="hljs-symbol"><span class="hljs-symbol">willLeaveApplication:</span></span>(BOOL)willLeave { NSLog(@<span class="hljs-string"><span class="hljs-string">"Banner view is beginning an ad action"</span></span>); BOOL shouldExecuteAction = YES; <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>         <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!willLeave &amp;&amp; shouldExecuteAction) { <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>       /<span class="hljs-regexp"><span class="hljs-regexp">/ [video pause]; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ [audio pause]; } return shouldExecuteAction; } - (void)bannerViewActionDidFinish:(ADBannerView *)banner { /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/   ,    /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ [video resume]; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ [audio resume]; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/   }</span></span></code> </pre> <br><br>  Separately dwell on <i>BOOL shouldExecuteAction</i> .  I indicated - YES.  You, too, should try as often as possible to say YES to your ADBannerView.  Thus, you allow him to turn around full screen after the click.  If you have an important process in the application, and you do not want to allow this process to be interrupted, then you can reply to this message - NO and the advertisement will not open.  However, Apple asks us very much whether or not to do this at all or only in emergency cases.  Think yourself - there is a banner - the user clicks on it - but there is no advertising.  Disorder!  As the iAd direction manager at WWDC said: ‚ÄúYou can answer NO, but I can‚Äôt even imagine what the situation should be.‚Äù <br><br>  All that is left of the "ryushechek" we still have to do is change the banner depending on the orientation of the phone.  If you remember, during initialization, we specified the requested banners for portrait orientation only.  Therefore, we need to correct this line now. <br><br> <code>- (void)viewDidLoad { <br> ... <br> adView.requiredContentSizeIdentifiers = [NSSet setWithObjects:ADBannerContentSizeIdentifier320x50,ADBannerContentSizeIdentifier480x32,nil]; <br> ... <br> }</code> <br> <br>  and this is how the following methods will look like <br><br><pre> <code class="hljs pgsql">- (<span class="hljs-type"><span class="hljs-type">BOOL</span></span>)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation { // <span class="hljs-keyword"><span class="hljs-keyword">Return</span></span> YES <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> supported orientations <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (interfaceOrientation == UIInterfaceOrientationPortrait|UIInterfaceOrientationPortrait); } - (<span class="hljs-type"><span class="hljs-type">void</span></span>)willRotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (UIInterfaceOrientationIsLandscape(toInterfaceOrientation)) adView.currentContentSizeIdentifier = ADBannerContentSizeIdentifier480x32; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> adView.currentContentSizeIdentifier = ADBannerContentSizeIdentifier320x50; }</code> </pre> <br><br>  The result after turning the simulator: <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/d7e/53c/495/d7e53c495568c791b02d76484cecf240.png" alt="image"><br><br>  That is, when you change the orientation of the phone, we change the <i>currentContentSizeIdentifier</i> property of our ADBannerView.  Now we can watch advertising banners in our application and in landscape orientation.  In the screenshot ‚Äúin the album‚Äù it turned out not very nice because of the shifting by 50 pixels of the banner - but this is already you correct yourself. <br><br>  More about a couple of small things that were mentioned at WWDC.  Apple engineers are urging you to write a line for the object ADBannerView .delegate = nil;  Very, very much asked.  In our particular example, this would look like: <br><br><pre> <code class="hljs objectivec">- (<span class="hljs-keyword"><span class="hljs-keyword">void</span></span>)dealloc { adView.delegate=<span class="hljs-literal"><span class="hljs-literal">nil</span></span>; [adView release]; [<span class="hljs-keyword"><span class="hljs-keyword">super</span></span> dealloc]; }</code> </pre> <br><br>  We are done with the program part.  We made a banner, made it work in two orientations, learned to handle the events and errors of this banner. <br><br>  Now briefly about the payment - to get money for the reflection of advertising from the iAd Network - you will need another contract with Apple, which you can create as standard through the developer portal.  In the process of setting up your application on the portal, you will answer the questions: ‚ÄúIs the target audience of your application under 17 years old?‚Äù And set up words and URL exceptions ‚Äî ads with which words you would not want to show.  For example, you would not want to see your competitors in your application.  Well, then - wait for the arrival of your check with money. <br><br>  The work of iAd is expected to begin on July 1 - so roll up your sleeves and append applications - there is still time.  While on the developer forum there is information that test ads appear unstable.  Indeed, while I was writing an article today, ads appeared at the launch of the application, then did not appear.  But everything has its charms - but I also tested the method of the appearance of a banner, when advertising was finally received from the network. </div><p>Source: <a href="https://habr.com/ru/post/97546/">https://habr.com/ru/post/97546/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../97534/index.html">Briefly about the competence of employees OpSoSov</a></li>
<li><a href="../97536/index.html">Dance of Nao robots from Aldebaran Robotics at the exhibition Shanghai Expo 2010</a></li>
<li><a href="../97537/index.html">Toshiba Satellite L500-1WP Review</a></li>
<li><a href="../97544/index.html">Krugokamera: Introduction</a></li>
<li><a href="../97545/index.html">Problems with the iPhone 4 antenna were predicted on June 10 by a Danish professor</a></li>
<li><a href="../97547/index.html">How to add a Silverlight build to the GAC</a></li>
<li><a href="../97550/index.html">Now Android OS can call a taxi</a></li>
<li><a href="../97556/index.html">Stop snooping around my browser.</a></li>
<li><a href="../97557/index.html">Visual Studio 2010 in Windows 7 Taskbar</a></li>
<li><a href="../97559/index.html">Mozilla loves HTML5 more Flash</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>