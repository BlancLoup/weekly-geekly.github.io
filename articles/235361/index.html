<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Cubietruck. Road mini server. Part 3</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Configuring the HUAWEI E3372 modem 
 Install the usb-switchmodem package 


sudo apt-get install usb-modeswitch  
 We connect the modem and look with ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Cubietruck. Road mini server. Part 3</h1><div class="post__text post__text-html js-mediator-article"><h4>  <b>Configuring the HUAWEI E3372 modem</b> </h4><br>  Install the <b>usb-switchmodem package</b> <br><pre><code class="bash hljs">sudo apt-get install usb-modeswitch</code> </pre> <br>  We connect the modem and look with the help of the command, which network card will appear after the connection: <br><pre> <code class="bash hljs">ifconfig -a</code> </pre><br><a name="habracut"></a><br>  Interface <b>eth1 has appeared</b> <br><pre> <code class="bash hljs">eth1 Link encap:Ethernet HWaddr 0c:5b:8f:27:9a:64 BROADCAST MULTICAST MTU:1500 Metric:1 RX packets:0 errors:0 dropped:0 overruns:0 frame:0 TX packets:0 errors:0 dropped:0 overruns:0 carrier:0 collisions:0 txqueuelen:1000 RX bytes:0 (0.0 B) TX bytes:0 (0.0 B)</code> </pre><br>  Or you can see the same thing in the dmesg message log: <br><pre> <code class="bash hljs">dmesg</code> </pre><br>  A view should appear. <br><pre> <code class="bash hljs">cdc_ether 3-1:1.0: eth1: register <span class="hljs-string"><span class="hljs-string">'cdc_ether'</span></span> at usb-sw-ehci-1, CDC Ethernet Device, 0c:5b:8f:27:9a:64</code> </pre><br>  Configuring the <b>eth1</b> interface in the <b>/ etc / network / interfaces</b> file <br><pre> <code class="bash hljs">sudo nano /etc/network/interfaces</code> </pre><br>  Add strings <br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># allow-hotplug eth1 iface eth1 inet dhcp</span></span></code> </pre><br>  Now we take out the modem and after 5 seconds we put in place.  Check whether the interface received eth1 address from the modem <br><pre> <code class="bash hljs">eth1 Link encap:Ethernet HWaddr 0c:5b:8f:27:9a:64 inet addr:192.168.8.100 Bcast:192.168.8.255 Mask:255.255.255.0 inet6 addr: fe80::e5b:8fff:fe27:9a64/64 Scope:Link UP BROADCAST RUNNING MULTICAST MTU:1500 Metric:1 RX packets:17 errors:0 dropped:0 overruns:0 frame:0 TX packets:12 errors:0 dropped:0 overruns:0 carrier:0 collisions:0 txqueuelen:1000 RX bytes:4366 (4.2 KiB) TX bytes:1364 (1.3 KiB)</code> </pre><br>  Make sure that interface eth1 received the address 192.168.8.100 <br>  Check which gateway is installed by default. <br><pre> <code class="bash hljs">ip route</code> </pre><br><pre> <code class="bash hljs">default via 192.168.1.10 dev eth0 192.168.1.0/24 dev eth0 proto kernel scope link src 192.168.1.247 192.168.8.0/24 dev eth1 proto kernel scope link src 192.168.8.100</code> </pre><br>  As the gateway, we can see the interface eth0 192.168.1.10.  This means that we will go to the Internet through the eth0 network, and we need to go through the eth1 modem.  To do this, remove the default gateway <br><pre> <code class="bash hljs">sudo route del default</code> </pre><br>  And add modem 192.168.8.1 as a gateway. <br><pre> <code class="bash hljs">sudo route add default gw 192.168.8.1</code> </pre><br>  Check <br><pre> <code class="bash hljs">default via 192.168.8.1 dev eth1 192.168.1.0/24 dev eth0 proto kernel scope link src 192.168.1.247 192.168.8.0/24 dev eth1 proto kernel scope link src 192.168.8.100</code> </pre><br>  Now we go online via modem HUAWEI E3372 <br><br>  So far, only this method is used. <br>  Now I understand how to do that: <br>  1. With simultaneous connections to both the network and the modem, the gateway would be eth0 <br>  2. If the connection is lost or there is no connection on the eth0 interface upon power up, the gateway would automatically switch to eth1 <br><br>  If anyone has experience in this matter, please help. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <a href="http://habrahabr.ru/post/235355/">Cubietruck.</a>  <a href="http://habrahabr.ru/post/235355/">Road mini server.</a>  <a href="http://habrahabr.ru/post/235355/">Part 1</a> <br>  <a href="http://habrahabr.ru/post/235199/">Cubietruck.</a>  <a href="http://habrahabr.ru/post/235199/">Road mini server.</a>  <a href="http://habrahabr.ru/post/235199/">Part 2</a> </div><p>Source: <a href="https://habr.com/ru/post/235361/">https://habr.com/ru/post/235361/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../235345/index.html">Segment - corporate data networks, Huawei equipment testing report</a></li>
<li><a href="../235347/index.html">As we laid the cable under the river bottom</a></li>
<li><a href="../235353/index.html">Smartphone Meizu MX4 officially presented</a></li>
<li><a href="../235355/index.html">Cubietruck. Road mini server. Part 1</a></li>
<li><a href="../235357/index.html">Conversion increase: how to create a product card that you want to buy</a></li>
<li><a href="../235365/index.html">The book "When I spoke ... About education, IT and not only"</a></li>
<li><a href="../235367/index.html">Incoming and outgoing calls in the call center</a></li>
<li><a href="../235369/index.html">Version Control Systems: Fossil Part I</a></li>
<li><a href="../235371/index.html">Is it possible to "break" the Internet?</a></li>
<li><a href="../235375/index.html">Emojli: how we accidentally made the application and why we no longer want to do it</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>