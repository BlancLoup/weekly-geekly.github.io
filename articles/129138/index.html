<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Fraudulent Android applications. Poking the enemy</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I‚Äôm a developer of an Android application and I‚Äôm following up on new links to it with Google subscriptions. This morning, I was happy to find a lette...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Fraudulent Android applications. Poking the enemy</h1><div class="post__text post__text-html js-mediator-article">  I‚Äôm a developer of an <a href="http://hypocampo.ru/">Android application</a> and I‚Äôm following up on new links to it with Google subscriptions.  This morning, I was happy to find a letter in the box, in which there was a <a rel="nofollow" href="http://androides-os.com/programm/322-hypocampo-geoplanirovschik.html">new link</a> to my application.  All perfectly!  And the review is positive, and the number of downloads is different from 0; only the version is for some reason old and ... the size of the APK is 3 megabytes against the original ~ 200K <br><br>  After downloading and unpacking the APK (remember that the APK is just a ZIP archive), it showed ‚Äústuffing‚Äù of 153 PNG files (renamed for some reason to .temp) with a <a href="http://lurkmore.ru/%25D0%25A1%25D0%25B2%25D0%25B8%25D0%25B4%25D0%25B5%25D1%2582%25D0%25B5%25D0%25BB%25D1%258C_%25D0%25B8%25D0%25B7_%25D0%25A4%25D1%2580%25D1%258F%25D0%25B7%25D0%25B8%25D0%25BD%25D0%25BE">witness from Fryazino</a> and the ‚Äúapplication‚Äù itself ... <br><br>  As expected, there is nothing left of the original application.  No icons, no more code.  And upon further consideration (it seems that) ALL files on <b>androides-os.com</b> are one and the same program!  I downloaded several different programs from different sections and they were all the same size and with the same content! 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Inside there was something that, by a quick analysis of resources, turned out to be an application requesting activation by sending an SMS.  Let's try to figure out where and what is sent ... <br><br><a name="habracut"></a><br><br>  We cannot get pure Java code from the APK, but you can get a set of instructions from VM Dalvik, which is quite readable by the eyes without additional software.  Using the dexdump utility from the Android SDK, we will dump a set of Dalvik instructions into a file ... <br><br><pre><code class="hljs swift">dexdump -d -f -h classes.dex &gt; <span class="hljs-built_in"><span class="hljs-built_in">dump</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">dump</span></span></code> </pre> <br><br>  Since it is assumed that the application is sending SMS, we will look for the string " <b>sendTextMessage</b> " in the dump - this is the SDK function for sending text messages.  The search is successful, there is one entry in the <b>activate ()</b> method <br><br>  In brief, the main details of the method (obtained by manual ‚Äúdecompiling‚Äù dalvik instructions): <br><pre> <code class="java hljs"> <span class="hljs-comment"><span class="hljs-comment">// private HashMap&lt;String, ActivationScheme&gt; activationSchemes; // private static String CURRENT_ACTIVATION_SCHEME = "1"; ActivationScheme o = activationSchemes.get(CURRENT_ACTIVATION_SCHEME); ArrayList&lt;Pair&lt;String, String&gt;&gt; l = o.list; // first -    // second -  ? for(Pair o2: l) { StringBuilder b; String sec = String.valueOf(o2.second); // WTF??? b = new StringBuilder(sec); b.append("+"); String s3 = schemes.get("2"); // private HashMap&lt;String, String&gt; schemes; b.append(s3); String result = b.toString(); // "pair.second"+schemes[2] String frst = o2.first; // v1 // mgr == TelephonyManager mgr.sendTextMessage(frst, null, result, /* PendingIntent.getBroadcast(...) */, null); }</span></span></code> </pre><br><br>  Those.  There is a certain set of "activation schemes" consisting of a list of pairs of lines, one of which is the number to which the SMS should be sent, and the other is what to actually send. <br>  Let's try to find activation schemes ... in the dump there is a method <b>initActivationSchemes</b> where you can find the following code: <br><br><pre> <code class="java hljs"> ArrayList al = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList(); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-string"><span class="hljs-string">"250"</span></span>.equals(currentMCC)) { <span class="hljs-comment"><span class="hljs-comment">// MCC == Mobile Country Code ArrayList&lt;Pair&lt;String, String&gt;&gt; aP = new ArrayList&lt;Pair&lt;String, String&gt;&gt;(); Pair&lt;String, String&gt; p = new Pair&lt;String, String&gt;("4129", "bb031"); aP.add(p); p = new Pair&lt;String, String&gt;("4129", "bb031"); aP.add(p); ActivationScheme sc = new ActivationScheme(aP); activationScheme.put(CURRENT_ACTIVATION_SCHEME, sc); }</span></span></code> </pre><br><br>  Those.  for Russia ( <a href="http://ru.wikipedia.org/wiki/Mobile_Country_Code">MCC == 250</a> ), an activation scheme is created from sending two SMS to number 4129 ... The method along with the MCC 250 also has other country codes, and, accordingly, an activation scheme for them.  For each country picked up a certain paid number. <br><br>  There is some neponyatka.  Despite the fact that 250 is Russia, number 4129 (at least according to the information I was able to find) breaks through as Ukrainian.  Maybe I made a mistake when ‚Äúdecompiling‚Äù and accidentally ‚Äúwrote down‚Äù codes for Ukraine in the Russian block ... <br><br>  Actually, what the application looks like ... <br>  Install is it: <br><img src="https://habrastorage.org/storage1/2aeb6319/b45d0bcb/e705a456/4f9ef3ff.png"><br><br>  At startup, everything is very straightforward: <br><img src="https://habrastorage.org/storage1/51c8e69b/9d4463a3/6587cb9f/aa4a1acf.png"><br><br>  There is even an "offer": <br><img src="https://habrastorage.org/storage1/f93cb618/af384b15/c02f2260/db0185ce.png"><br><br>  The same ‚Äúoffer‚Äù seems to be available here: <a rel="nofollow" href="http://depositfmobi.ru/ofert">http://depositfmobi.ru/ofert</a> <br>  I went to the site by the name of the package application: com.depositmobi. <br><br>  What is interesting is the depositmobi and <a rel="nofollow" href="http://depositmobi.com/search.php%3Fp%3Dq%26s%3D236%26q%3Dorange%2520anna%2520fgshah">"QIP. Files"</a> and <a rel="nofollow" href="http://depositmobi.ru/search.php%3Fp%3Dr%26s%3D278%26q%3DAsphalt%25206%253A%2520Adrenaline%2520HD">"Rapidshare"</a> at the same time! <br><br>  What is the result?  A very simple way of fraud.  We make a website, pump SEO for it using the necessary keywords, pump up thematic news there and fill it with the simplest program for sending SMS to premium numbers by supplying it with an ‚Äúoffer‚Äù to cover your ass ... Can you do something with such comrades in legal ways? </div><p>Source: <a href="https://habr.com/ru/post/129138/">https://habr.com/ru/post/129138/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../129127/index.html">New Trojan for Mac OS X shows a PDF document</a></li>
<li><a href="../129128/index.html">Screwing SageTex to LyX under Windows</a></li>
<li><a href="../129132/index.html">Preparation of the project for work with the investor</a></li>
<li><a href="../129136/index.html">Introduction to gen_event: Account Change Notifications</a></li>
<li><a href="../129137/index.html">Startup from Hong Kong has created an interesting device to help lose weight</a></li>
<li><a href="../129141/index.html">Luxoft Personnel presents the results of a study of the labor market of IT specialists in Russia and Ukraine (June-September 2011)</a></li>
<li><a href="../129142/index.html">Droider Show # 8. Operation "Successor"</a></li>
<li><a href="../129144/index.html">Olympics 2014: how to help a foreigner to cope with the Russian language</a></li>
<li><a href="../129145/index.html">The story of one "very Chinese" phone</a></li>
<li><a href="../129146/index.html">The hard way novice in the top 5 Russian App Store</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>