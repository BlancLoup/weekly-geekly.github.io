<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Search for repetitions in a two-dimensional array, or the right tool</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day. 

 In varying degrees, interested in algorithms. Stumbled upon a fresh article 
 "Search for repetitions in a two-dimensional array, or comp...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Search for repetitions in a two-dimensional array, or the right tool</h1><div class="post__text post__text-html js-mediator-article">  Good day. <br><br>  In varying degrees, interested in algorithms.  Stumbled upon a fresh article <br>  "Search for repetitions in a two-dimensional array, or computational complexity on an example" <a href="http://habrahabr.ru/post/141258/">http://habrahabr.ru/post/141258/</a> .  The author of the <a href="http://habrahabr.ru/users/singerofthefall/" class="user_link">article</a> , <a href="http://habrahabr.ru/users/singerofthefall/" class="user_link">Singerofthefall</a> , quite interestingly talks about solving the problem and optimizing the algorithm.  Very interesting.  However, in my opinion, first of all, it was necessary to determine not the algorithm, but the tool that will solve the problem.  And so the tool was chosen wrong, hence all the complexity and optimization. <br>  To solve the author's problem, the database tools were most suitable, respectively, and it was necessary to use them. <br><a name="habracut"></a><br>  There are 2 possible ways. <br><ol><li>  Referring to the xls file as a database, you can read more here <a href="http://vbadud.blogspot.com/2008/05/using-excel-as-database.html">http://vbadud.blogspot.com/2008/05/using-excel-as-database.html</a> </li><li>  Distillation of data in the database and processing and subsequent output. </li></ol><br>  Because  at work I often encounter a similar task, processing a two-dimensional array, but not in xls files, but in AutoCAD and with coordinates, then I will try to show how it works. <br><br><h5>  Simplest solution </h5><br><ol><li>  We create a DB, for simplicity I use DAO.  If speed is critical, it makes sense to create a base on Ramdisk. </li><li>  Create a table for receiving data </li><li>  We overtake the initial data in the table </li><li>  We execute the simplest SQL query, grouping and sorting data. </li><li>  Display the data. </li></ol>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="hljs sql">'  ,       IDE VBA      "Ioeaea! Auiieiaiea i?ia?aiiu i?a?aaii!" Sub grid() Dim retObj As AcadObject Dim retPnt As Variant Dim db As DAO.Database Dim rst As Recordset Dim ssetObj As AcadSelectionSet Dim Items As Object Dim handle As String mesto_db = Environ("APPDATA") &amp; "\" name_db = Environ("UserName") &amp; "_grid" <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> fs1 = CreateObject(<span class="hljs-string"><span class="hljs-string">"Scripting.FileSystemObject"</span></span>) fs1.CreateTextFile mesto_db &amp; name_db &amp; <span class="hljs-string"><span class="hljs-string">".mdb"</span></span> fs1.DeleteFile mesto_db &amp; name_db &amp; <span class="hljs-string"><span class="hljs-string">".mdb"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> db = DAO.CreateDatabase(mesto_db &amp; name_db &amp; <span class="hljs-string"><span class="hljs-string">".mdb"</span></span>, dbLangCyrillic) db.Execute <span class="hljs-string"><span class="hljs-string">"CREATE TABLE Tabl1 "</span></span> &amp; <span class="hljs-string"><span class="hljs-string">"(x REAL, y REAL, h CHAR(10));"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">On</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Error</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Resume</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> ssetObj = ThisDrawing.SelectionSets(<span class="hljs-string"><span class="hljs-string">"Boxa"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> Err &lt;&gt; <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> Err.Clear <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> ssetObj = ThisDrawing.SelectionSets.Add(<span class="hljs-string"><span class="hljs-string">"Boxa"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> ssetObj.Clear ssetObj.SelectOnScreen <span class="hljs-keyword"><span class="hljs-keyword">On</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Error</span></span> <span class="hljs-keyword"><span class="hljs-keyword">GoTo</span></span> fuck Dim temp_block <span class="hljs-keyword"><span class="hljs-keyword">As</span></span> AcadBlockReference <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Each</span></span> item <span class="hljs-keyword"><span class="hljs-keyword">In</span></span> ssetObj <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> item.ObjectName = <span class="hljs-string"><span class="hljs-string">"AcDbBlockReference"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> item.EffectiveName = <span class="hljs-string"><span class="hljs-string">"SV"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Attributes</span></span> = item.GetAttributes BlockProperties = item.GetDynamicBlockProperties point = item.insertionPoint point1 = CLng(point(<span class="hljs-number"><span class="hljs-number">0</span></span>)) point2 = CLng(point(<span class="hljs-number"><span class="hljs-number">1</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> temp_block = item handle = CStr(temp_block.handle) db.Execute <span class="hljs-string"><span class="hljs-string">"INSERT INTO Tabl1 (x,y,h) VALUES ("</span></span> &amp; point1 &amp; <span class="hljs-string"><span class="hljs-string">", "</span></span> &amp; point2 &amp; <span class="hljs-string"><span class="hljs-string">", \'"</span></span> &amp; handle &amp; <span class="hljs-string"><span class="hljs-string">"\');"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> rst = db.OpenRecordset(<span class="hljs-string"><span class="hljs-string">"SELECT x, y, h FROM Tabl1 GROUP BY x, y, h ORDER BY x, y, h ;"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> rst.RecordCount &gt; <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> rst.MoveFirst <span class="hljs-keyword"><span class="hljs-keyword">Do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">While</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Not</span></span> rst.EOF = <span class="hljs-literal"><span class="hljs-literal">True</span></span> X0 = rst.Fields(<span class="hljs-number"><span class="hljs-number">0</span></span>) Y0 = rst.Fields(<span class="hljs-number"><span class="hljs-number">1</span></span>) rst.MoveNext <span class="hljs-keyword"><span class="hljs-keyword">Loop</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> fuck: <span class="hljs-keyword"><span class="hljs-keyword">If</span></span> Err &lt;&gt; <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Then</span></span> ThisDrawing.Utility.Prompt (vbCrLf &amp; <span class="hljs-string"><span class="hljs-string">"Error!"</span></span> &amp; vbCrLf) rst.Close db.Close <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span> db = <span class="hljs-keyword"><span class="hljs-keyword">Nothing</span></span> ssetObj.Clear ssetObj.Delete <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> Sub</code> </pre> <br><br><h5>  Execution speed: </h5><br>  Number of points - lead time <br>  100 * 100 - 5.89 seconds <br>  200 * 200 - 24.73 seconds <br>  400 * 200 - 47.33 seconds <br>  Linear dependence <br><br><h5>  Conclusion: </h5><br>  The conclusions in the article to which I referred at the beginning are very good and I use both of them for them. <br>  I will add only the third point, that always the best result will give the most suitable tool. <br><br><h5>  PS </h5><br>  1. In the note to the tag (source) VBA though not specified, but it works. <br>  2. You can use the Collection to track repetitions in an array. <br><pre> <code class="hljs vbscript"> <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> x_col As <span class="hljs-keyword"><span class="hljs-keyword">New</span></span> Collection <span class="hljs-keyword"><span class="hljs-keyword">Dim</span></span> txt_arr() As Variant <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> Q = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">To</span></span> <span class="hljs-built_in"><span class="hljs-built_in">UBound</span></span>(txt_arr) x_col_Item = txt_arr(Q) x_col.Add x_col_Item, <span class="hljs-built_in"><span class="hljs-built_in">CStr</span></span>(x_col_Item) <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span></code> </pre><br>  When adding an item to the collection with a key already in it, you will get an error.  Processing it will get a set of only repetitive elements. </div><p>Source: <a href="https://habr.com/ru/post/141441/">https://habr.com/ru/post/141441/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../141433/index.html">Facebook Developer Garage in faces</a></li>
<li><a href="../141434/index.html">TeamLab Document Editor on canvas: erasing the lines between desktop and online</a></li>
<li><a href="../141438/index.html">Rendering the other way around. GPU Hough Transformation</a></li>
<li><a href="../141439/index.html">We write the first project on the Play Framework 2.0</a></li>
<li><a href="../141440/index.html">Data Filters on ASP.NET MVC and Entity Framework</a></li>
<li><a href="../141442/index.html">Accelerate your Arduino</a></li>
<li><a href="../141444/index.html">Django Gmap v3 Widget - geolocation with search, saving coordinates and addresses in JSONField</a></li>
<li><a href="../141447/index.html">Verify compliance with the coding standards for PHP through git</a></li>
<li><a href="../141448/index.html">CodeIgniter Command Line library - a small assistant for working with CLI</a></li>
<li><a href="../141450/index.html">Build: markitUp, fancybox, elFinder - a great replacement for WYSIWYG editors</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>