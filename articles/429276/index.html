<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Variational autocoders: theory and working code</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Variational autocoder (autoencoder) is a generative model that learns to map objects into a given hidden space. 

 Ever wondered how the variational a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Variational autocoders: theory and working code</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/oj/04/18/oj04189ynqaberjqtksdmbjefmy.jpeg"><br><br>  <i><font color="gray">Variational autocoder (autoencoder) is a generative model that learns to map objects into a given hidden space.</font></i> <br><br>  Ever wondered how the variational auto-encoder (VAE) model works?  Want to know how VAE generates new examples like the data set on which it was trained?  After reading this article, you get a theoretical idea of ‚Äã‚Äãthe inner workings of VAE, and you can also implement it yourself.  Then, I‚Äôll show you the VAE work code, which is trained on typing handwritten numbers, and we‚Äôll have some fun while generating new numbers! <br><a name="habracut"></a><br><h1>  Generative models </h1><br>  VAE is a generative model ‚Äî it estimates the probability density (PDF) of the training data.  If such a model is trained in natural images, it will assign a high probability value to the lion image, and a low value to the random nonsense image. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The VAE model is also able to take examples from a trained PDF, which is the coolest part, since it will be able to generate new examples similar to the original data set! <br><br>  I will explain VAE using the <a href="https://en.wikipedia.org/wiki/MNIST_database">MNIST</a> handwritten dialing.  The input data for the model are images in the format <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>m</mi><mi>a</mi><mi>t</mi><mi>h</mi><mi>b</mi><mi>b</mi><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>R</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>28</mn><mo>&amp;#xD7;</mo><mn>28</mn></mrow></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.587ex" height="2.539ex" viewBox="0 -987.6 6280.6 1093.4" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-74" x="1658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-68" x="2019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-62" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-62" x="3025" y="0"></use><g transform="translate(3455,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-52" x="0" y="0"></use><g transform="translate(759,410)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-32"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-38" x="500" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-D7" x="1001" y="0"></use><g transform="translate(1258,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-32"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-38" x="500" y="0"></use></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>m</mi><mi>a</mi><mi>t</mi><mi>h</mi><mi>b</mi><mi>b</mi><msup><mrow class="MJX-TeXAtom-ORD"><mi>R</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mn>28</mn><mo>√ó</mo><mn>28</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-1"> \ mathbb {R} ^ {28 √ó 28} </script>  .  The model should estimate the likelihood of how the input data looks like a digit. <br><br><h1>  Image modeling task </h1><br>  The interaction between pixels is a difficult task.  If the pixels are independent of each other, then you need to study the PDF of each pixel independently, which is easy.  The sample is also simple - we take each pixel separately. <br><br>  But in digital images there are clear dependencies between pixels.  If you see the beginning of the four on the left half, then be very surprised if the right half is the completion of zero.  But why?.. <br><br><h1>  Hidden space </h1><br>  You know that on each image there is one digit.  Sign in <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>m</mi><mi>a</mi><mi>t</mi><mi>h</mi><mi>b</mi><mi>b</mi><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>R</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>28</mn><mo>&amp;#xD7;</mo><mn>28</mn></mrow></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.587ex" height="2.539ex" viewBox="0 -987.6 6280.6 1093.4" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-74" x="1658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-68" x="2019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-62" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-62" x="3025" y="0"></use><g transform="translate(3455,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-52" x="0" y="0"></use><g transform="translate(759,410)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-32"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-38" x="500" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-D7" x="1001" y="0"></use><g transform="translate(1258,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-32"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-38" x="500" y="0"></use></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>m</mi><mi>a</mi><mi>t</mi><mi>h</mi><mi>b</mi><mi>b</mi><msup><mrow class="MJX-TeXAtom-ORD"><mi>R</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mn>28</mn><mo>√ó</mo><mn>28</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-2"> \ mathbb {R} ^ {28 √ó 28} </script>  does not explicitly contain this information.  But it must be somewhere ... This "somewhere" is a hidden space. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/85b/f1f/a9f/85bf1fa9f3d48d24d98dfe5b61de55c1.jpg"><br><br>  You can think of the hidden space as <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>m</mi><mi>a</mi><mi>t</mi><mi>h</mi><mi>b</mi><mi>b</mi><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>R</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>k</mi></mrow></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.877ex" height="2.539ex" viewBox="0 -987.6 4683.3 1093.4" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-74" x="1658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-68" x="2019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-62" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-62" x="3025" y="0"></use><g transform="translate(3455,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-52" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-6B" x="1074" y="581"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>m</mi><mi>a</mi><mi>t</mi><mi>h</mi><mi>b</mi><mi>b</mi><msup><mrow class="MJX-TeXAtom-ORD"><mi>R</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>k</mi></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-3"> \ mathbb {R} ^ {k} </script>  where each vector contains <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.211ex" height="2.057ex" viewBox="0 -780.1 521.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-6B" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-4"> k </script>  parts of the information needed to render the image.  Suppose the first dimension contains a number represented by a digit.  The second dimension can be width.  The third is the corner, and so on. <br><br>  We can imagine the process of drawing a human figure in two steps.  First, a person determines, consciously or not, all the attributes of the number that he intends to move.  Further, these solutions are transformed into strokes on paper. <br><br>  VAE is trying to simulate this process: at a given image <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-78" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-5"> x </script>  we want to find at least one hidden vector capable of describing it;  one vector containing instructions for generating <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-78" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-6"> x </script>  .  Formulating it according to the <a href="https://en.wikipedia.org/wiki/Law_of_total_probability">formula of total probability</a> , we get <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mtext>&amp;#xA0;</mtext><mi>i</mi><mi>n</mi><mi>t</mi><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo><mi>p</mi><mo stretchy=&quot;false&quot;>(</mo><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo><mi>d</mi><mi>z</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="24.015ex" height="2.66ex" viewBox="0 -832 10339.6 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-28" x="751" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-78" x="1141" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-29" x="1713" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-3D" x="2380" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-69" x="3687" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-6E" x="4032" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-74" x="4633" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-70" x="4994" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-28" x="5498" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-78" x="5887" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-7C" x="6460" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="6738" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-29" x="7207" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-70" x="7596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-28" x="8100" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="8489" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-29" x="8958" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-64" x="9347" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="9871" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mtext>&nbsp;</mtext><mi>i</mi><mi>n</mi><mi>t</mi><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>z</mi><mo stretchy="false">)</mo><mi>p</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mi>d</mi><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-7"> P (x) = \ int p (x | z) p (z) dz </script>  . <br><br>  Let's put a reasonable sense into this equation: <br><br><ul><li>  Integral means that candidates must be sought in the entire hidden space. </li><li>  For each candidate <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.088ex" height="1.455ex" viewBox="0 -520.7 468.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-8"> z </script>  we ask the question: is it possible to generate <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-78" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-9"> x </script>  using instructions <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.088ex" height="1.455ex" viewBox="0 -520.7 468.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-10"> z </script>  ?  Big enough <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.619ex" height="2.66ex" viewBox="0 -832 2850 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-28" x="751" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-78" x="1141" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-7C" x="1713" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="1992" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-29" x="2460" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-11"> P (x | z) </script>  ?  For example, if <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.088ex" height="1.455ex" viewBox="0 -520.7 468.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-12"> z </script>  encodes information about the number 7, then image 8 is impossible.  However, image 1 is valid because 1 and 7 are similar. </li><li>  We found good <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.088ex" height="1.455ex" viewBox="0 -520.7 468.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-13"> z </script>  ?  Fine!  But wait a second ... as far as <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.088ex" height="1.455ex" viewBox="0 -520.7 468.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-14"> z </script>  probably? <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.643ex" height="2.66ex" viewBox="0 -832 1999 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-28" x="751" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="1141" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-29" x="1609" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-15"> P (z) </script>  big enough?  Consider an image of an inverted digit 7. The ideal match would be a hidden vector describing view 7, where the angle size is set to 180 ¬∞.  However, such <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.088ex" height="1.455ex" viewBox="0 -520.7 468.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-16"> z </script>  unlikely, because usually the numbers do not write at an angle of 180 ¬∞. </li></ul><br>  The goal of VAE training is to maximize <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.884ex" height="2.66ex" viewBox="0 -832 2103 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-28" x="751" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-78" x="1141" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-29" x="1713" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-17"> P (x) </script>  .  We will model <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.619ex" height="2.66ex" viewBox="0 -832 2850 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-28" x="751" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-78" x="1141" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-7C" x="1713" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="1992" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-29" x="2460" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-18"> P (x | z) </script>  using multidimensional Gaussian distribution <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>m</mi><mi>a</mi><mi>t</mi><mi>h</mi><mi>c</mi><mi>a</mi><mi>l</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>N</mi></mrow><mo stretchy=&quot;false&quot;>(</mo><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>i</mi><mi>g</mi><mi>m</mi><msup><mi>a</mi><mn>2</mn></msup><mtext>&amp;#xA0;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><mi>I</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="31.899ex" height="2.901ex" viewBox="0 -935.7 13734.1 1249" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-74" x="1658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-68" x="2019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-63" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-61" x="3029" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-6C" x="3559" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-4E" x="3857" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-28" x="4746" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-66" x="5135" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-28" x="5686" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="6075" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-29" x="6544" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-2C" x="6933" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-73" x="7628" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-69" x="8098" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-67" x="8443" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-6D" x="8924" y="0"></use><g transform="translate(9802,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-32" x="748" y="513"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-63" x="11036" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-64" x="11469" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-6F" x="11993" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-74" x="12478" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-49" x="12840" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-29" x="13344" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>m</mi><mi>a</mi><mi>t</mi><mi>h</mi><mi>c</mi><mi>a</mi><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mi>N</mi></mrow><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo>,</mo><mtext>&nbsp;</mtext><mi>s</mi><mi>i</mi><mi>g</mi><mi>m</mi><msup><mi>a</mi><mn>2</mn></msup><mtext>&nbsp;</mtext><mi>c</mi><mi>d</mi><mi>o</mi><mi>t</mi><mi>I</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-19"> \ mathcal {N} (f (z), \ sigma ^ 2 \ cdot I) </script>  . <br><br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.176ex" height="2.66ex" viewBox="0 -832 1798 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-66" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-28" x="550" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="940" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-29" x="1408" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-20"> f (z) </script>  modeled using neural network. <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>i</mi><mi>g</mi><mi>m</mi><mi>a</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.86ex" height="2.298ex" viewBox="0 -728.2 2953.5 989.6" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-73" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-69" x="719" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-67" x="1065" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-6D" x="1545" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-61" x="2424" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>s</mi><mi>i</mi><mi>g</mi><mi>m</mi><mi>a</mi></math></span></span><script type="math/tex" id="MathJax-Element-21"> \ sigma </script>  Is a hyperparameter for multiplying the identity matrix <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>I</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.172ex" height="2.057ex" viewBox="0 -780.1 504.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-49" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>I</mi></math></span></span><script type="math/tex" id="MathJax-Element-22"> I </script>  . <br><br>  It should be borne in mind that <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.279ex" height="2.419ex" viewBox="0 -780.1 550.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-66" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-23"> f </script>  - this is what we will use to generate new images using a trained model.  Overlaying a Gaussian distribution is for educational purposes only.  If we take the Dirac delta function (i.e. deterministic <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi><mo>=</mo><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.604ex" height="2.66ex" viewBox="0 -832 3704.6 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-78" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-3D" x="850" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-66" x="1906" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-28" x="2457" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="2846" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-29" x="3315" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-24"> x = f (z) </script>  ), then we will not be able to train the model using a gradient descent! <br><br><h1>  Wonders of Hidden Space </h1><br>  The hidden space approach has two big problems: <br><br><ol><li> What information does each dimension contain?  Some dimensions may refer to abstract elements, such as style.  Even if it was easy to interpret all the dimensions, we don‚Äôt want to assign labels to the data set.  This approach does not scale to other data sets. </li><li>  Hidden space can be confused when there is a correlation between measurements.  For example, a very quickly drawn figure can simultaneously lead to the appearance of both angular and thinner strokes.  Determining these dependencies is difficult. </li></ol><br><h1>  Deep learning comes to the rescue </h1><br>  It turns out that each distribution can be generated by applying a fairly complex function on a standard multidimensional Gaussian distribution. <br><br>  Choose <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.643ex" height="2.66ex" viewBox="0 -832 1999 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-28" x="751" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="1141" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-29" x="1609" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-25"> P (z) </script>  as a standard multidimensional Gaussian distribution.  Thus, simulated by the neural network <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.279ex" height="2.419ex" viewBox="0 -780.1 550.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-66" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-26"> f </script>  can be divided into two phases: <br><br><ol><li>  The first layers map the Gaussian distribution to the true distribution over the hidden space.  We will not be able to interpret the measurement, but it does not matter. </li><li>  Subsequent layers will be displayed from hidden space in <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.619ex" height="2.66ex" viewBox="0 -832 2850 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-28" x="751" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-78" x="1141" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-7C" x="1713" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="1992" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-29" x="2460" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-27"> P (x | z) </script>  . </li></ol><br><h1>  So how do we train this beast? </h1><br>  Formula for <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.884ex" height="2.66ex" viewBox="0 -832 2103 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-28" x="751" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-78" x="1141" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-29" x="1713" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-28"> P (x) </script>  insoluble, so we approximate it by the Monte Carlo method: <br><br><ol><li>  Selection <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><merror><mtext>\&amp;#xA0;{z_i&amp;#xA0;\}&amp;#xA0;_&amp;#xA0;{i&amp;#xA0;=&amp;#xA0;1}&amp;#xA0;^&amp;#xA0;n</mtext></merror></math>" role="presentation"><span class="noError" aria-hidden="true" style="display: inline-block;">\&nbsp;{z_i&nbsp;\}&nbsp;_&nbsp;{i&nbsp;=&nbsp;1}&nbsp;^&nbsp;n</span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><merror><mtext>\&nbsp;{z_i&nbsp;\}&nbsp;_&nbsp;{i&nbsp;=&nbsp;1}&nbsp;^&nbsp;n</mtext></merror></math></span></span><script type="math/tex" id="MathJax-Element-29"> \ {z_i \} _ {i = 1} ^ n </script>  from previous <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.643ex" height="2.66ex" viewBox="0 -832 1999 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-28" x="751" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="1141" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-29" x="1609" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-30"> P (z) </script></li><li>  Approximation with <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mtext>&amp;#xA0;</mtext><mi>a</mi><mi>p</mi><mi>p</mi><mi>r</mi><mi>o</mi><mi>x</mi><mtext>&amp;#xA0;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>1</mn></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>n</mi></mrow><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>u</mi><msubsup><mi>m</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><msub><mi>z</mi><mi>i</mi></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="35.595ex" height="2.901ex" viewBox="0 -832 15325.5 1249" role="img" focusable="false" style="vertical-align: -0.969ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-28" x="751" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-78" x="1141" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-29" x="1713" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-61" x="2353" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-70" x="2882" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-70" x="3386" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-72" x="3889" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-6F" x="4341" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-78" x="4826" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-66" x="5649" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-72" x="6199" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-61" x="6651" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-63" x="7180" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-31" x="7614" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-6E" x="8114" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-73" x="8965" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-75" x="9434" y="0"></use><g transform="translate(10007,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-6D" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-6E" x="1242" y="499"></use><g transform="translate(878,-308)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-31" x="1124" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-50" x="12134" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-28" x="12885" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-78" x="13275" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-7C" x="13847" y="0"></use><g transform="translate(14126,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-69" x="658" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-29" x="14936" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mtext>&nbsp;</mtext><mi>a</mi><mi>p</mi><mi>p</mi><mi>r</mi><mi>o</mi><mi>x</mi><mtext>&nbsp;</mtext><mi>f</mi><mi>r</mi><mi>a</mi><mi>c</mi><mrow class="MJX-TeXAtom-ORD"><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>n</mi></mrow><mtext>&nbsp;</mtext><mi>s</mi><mi>u</mi><msubsup><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><msub><mi>z</mi><mi>i</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-31"> P (x) \ approx \ frac {1} {n} \ sum_ {i = 1} ^ n P (x | z_i) </script></li></ol><br>  Fine!  So, just try a lot of different <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.088ex" height="1.455ex" viewBox="0 -520.7 468.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-32"> z </script>  and start the back propagation party! <br><br>  Unfortunately, since <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-33-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-78" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-33"> x </script>  very multidimensional, a lot of samples are required to get a reasonable approximation.  I mean, if you try <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-34-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.088ex" height="1.455ex" viewBox="0 -520.7 468.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-34"> z </script>  what are the chances of getting an image that looks something like <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-35-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-78" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-35"> x </script>  ?  This, by the way, explains why <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-36-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.619ex" height="2.66ex" viewBox="0 -832 2850 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-28" x="751" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-78" x="1141" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-7C" x="1713" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="1992" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-29" x="2460" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-36"> P (x | z) </script>  must assign a positive probability value to any possible image, otherwise the model will not be able to learn: sampling <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-37-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.088ex" height="1.455ex" viewBox="0 -520.7 468.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-37"> z </script>  will lead to an image that is almost certainly different from <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-38-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-78" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-38"> x </script>  , and if the probability is 0, then the gradients will not be able to spread. <br><br>  How to solve this problem? <br><br><h1>  Cut the way! </h1><br><img src="https://habrastorage.org/getpro/habr/post_images/6cd/5ec/950/6cd5ec950b20f02602c83e7ed4c90ae4.jpg"><br><br>  Most samples <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-39-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.088ex" height="1.455ex" viewBox="0 -520.7 468.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-39"> z </script>  from the sample will not add anything to <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-40-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.884ex" height="2.66ex" viewBox="0 -832 2103 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-28" x="751" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-78" x="1141" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-29" x="1713" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-40"> P (x) </script>  - they are too far beyond its borders.  Now, if you knew in advance where to select them ... <br><br>  Can enter <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-41-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.712ex" height="2.66ex" viewBox="0 -832 2890 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-51" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-28" x="791" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="1181" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-7C" x="1649" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-78" x="1928" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-29" x="2500" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi><mo stretchy="false">(</mo><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-41"> Q (z | x) </script>  .  This <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-42-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.838ex" height="2.419ex" viewBox="0 -780.1 791.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-51" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-42"> Q </script>  will be trained to assign high probability values ‚Äã‚Äãto those <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-43-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.088ex" height="1.455ex" viewBox="0 -520.7 468.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-43"> z </script>  which are likely to generate <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-44-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-78" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-44"> x </script>  .  Now it is possible to carry out a Monte-Carlo estimation, taking far fewer samples from <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-45-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.838ex" height="2.419ex" viewBox="0 -780.1 791.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-51" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-45"> Q </script>  . <br><br>  Unfortunately, there is a new problem!  Instead of maximizing <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-46-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mtext>&amp;#xA0;</mtext><mi>i</mi><mi>n</mi><mi>t</mi><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo><mi>d</mi><mi>z</mi><mo>=</mo><mtext>&amp;#xA0;</mtext><mi>m</mi><mi>a</mi><mi>t</mi><mi>h</mi><mi>b</mi><mi>b</mi><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>z</mi><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>i</mi><mi>m</mi><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msub><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="52.271ex" height="3.021ex" viewBox="0 -832 22505.4 1300.8" role="img" focusable="false" style="vertical-align: -1.089ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-28" x="751" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-78" x="1141" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-29" x="1713" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-3D" x="2380" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-69" x="3687" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-6E" x="4032" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-74" x="4633" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-50" x="4994" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-28" x="5746" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-78" x="6135" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-7C" x="6708" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="6986" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-29" x="7455" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-50" x="7844" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-28" x="8596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="8985" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-29" x="9454" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-64" x="9843" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="10367" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-3D" x="11113" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-6D" x="12419" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-61" x="13298" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-74" x="13827" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-68" x="14189" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-62" x="14765" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-62" x="15195" y="0"></use><g transform="translate(15624,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-45" x="0" y="0"></use><g transform="translate(738,-187)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-73" x="822" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-69" x="1291" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-6D" x="1637" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-50" x="2515" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-28" x="3267" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="3656" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-29" x="4125" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-50" x="19655" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-28" x="20406" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-78" x="20796" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-7C" x="21368" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="21647" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-29" x="22115" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mtext>&nbsp;</mtext><mi>i</mi><mi>n</mi><mi>t</mi><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>z</mi><mo stretchy="false">)</mo><mi>P</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mi>d</mi><mi>z</mi><mo>=</mo><mtext>&nbsp;</mtext><mi>m</mi><mi>a</mi><mi>t</mi><mi>h</mi><mi>b</mi><mi>b</mi><msub><mrow class="MJX-TeXAtom-ORD"><mi>E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>z</mi><mtext>&nbsp;</mtext><mi>s</mi><mi>i</mi><mi>m</mi><mi>P</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></mrow></msub><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-46"> P (x) = \ int P (x | z) P (z) dz = \ mathbb {E} _ {z \ sim P (z)} P (x | z) </script>  we maximize <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-47-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>m</mi><mi>a</mi><mi>t</mi><mi>h</mi><mi>b</mi><mi>b</mi><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>z</mi><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>i</mi><mi>m</mi><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msub><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="25.469ex" height="3.021ex" viewBox="0 -832 10965.8 1300.8" role="img" focusable="false" style="vertical-align: -1.089ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-74" x="1658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-68" x="2019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-62" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-62" x="3025" y="0"></use><g transform="translate(3455,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-45" x="0" y="0"></use><g transform="translate(738,-187)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-73" x="822" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-69" x="1291" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-6D" x="1637" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-51" x="2515" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-28" x="3307" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="3696" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-7C" x="4165" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-78" x="4443" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-29" x="5016" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-50" x="8115" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-28" x="8867" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-78" x="9256" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-7C" x="9829" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="10107" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-29" x="10576" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>m</mi><mi>a</mi><mi>t</mi><mi>h</mi><mi>b</mi><mi>b</mi><msub><mrow class="MJX-TeXAtom-ORD"><mi>E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>z</mi><mtext>&nbsp;</mtext><mi>s</mi><mi>i</mi><mi>m</mi><mi>Q</mi><mo stretchy="false">(</mo><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>x</mi><mo stretchy="false">)</mo></mrow></msub><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-47"> \ mathbb {E} _ {z \ sim Q (z | x)} P (x | z) </script>  .  How are they related to each other? <br><br><h1>  Variation output </h1><br>  Variational conclusion is the topic of a separate article, so I will not dwell on it here in detail.  I can only say that these distributions are related by the following equation: <br><br><p></p><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-48-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>l</mi><mi>o</mi><mi>g</mi><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>X</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mtext>&amp;#xA0;</mtext><mi>m</mi><mi>a</mi><mi>t</mi><mi>h</mi><mi>c</mi><mi>a</mi><mi>l</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>K</mi><mi>L</mi></mrow><mo stretchy=&quot;false&quot;>[</mo><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>]</mo><mo>=</mo><mtext>&amp;#xA0;</mtext><mi>m</mi><mi>a</mi><mi>t</mi><mi>h</mi><mi>b</mi><mi>b</mi><msub><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>E</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>z</mi><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>i</mi><mi>m</mi><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></mrow></msub><mo stretchy=&quot;false&quot;>[</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>]</mo><mo>&amp;#x2212;</mo><mtext>&amp;#xA0;</mtext><mi>m</mi><mi>a</mi><mi>t</mi><mi>h</mi><mi>c</mi><mi>a</mi><mi>l</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>K</mi><mi>L</mi></mrow><mo stretchy=&quot;false&quot;>[</mo><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="102.028ex" height="3.021ex" viewBox="0 -832 43928.7 1300.8" role="img" focusable="false" style="vertical-align: -1.089ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-6C" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-6F" x="298" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-67" x="784" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-50" x="1264" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-28" x="2016" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-58" x="2405" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-29" x="3258" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-2212" x="3869" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-6D" x="5120" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-61" x="5998" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-74" x="6528" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-68" x="6889" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-63" x="7466" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-61" x="7899" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-6C" x="8429" y="0"></use><g transform="translate(8727,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-4B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-4C" x="889" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-5B" x="10298" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-51" x="10577" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-28" x="11368" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="11758" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-7C" x="12226" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-78" x="12505" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-29" x="13077" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-7C" x="13467" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-7C" x="13745" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-50" x="14024" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-28" x="14775" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="15165" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-7C" x="15633" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-78" x="15912" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-29" x="16484" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-5D" x="16874" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-3D" x="17430" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-6D" x="18737" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-61" x="19615" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-74" x="20145" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-68" x="20506" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-62" x="21083" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-62" x="21512" y="0"></use><g transform="translate(21942,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-45" x="0" y="0"></use><g transform="translate(738,-187)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-73" x="822" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-69" x="1291" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-6D" x="1637" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-51" x="2515" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-28" x="3307" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="3696" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-7C" x="4165" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-78" x="4443" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-29" x="5016" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-5B" x="26602" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-6C" x="26881" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-6F" x="27179" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-67" x="27665" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-50" x="28145" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-28" x="28897" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-78" x="29286" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-7C" x="29859" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="30137" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-29" x="30606" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-5D" x="30995" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-2212" x="31496" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-6D" x="32747" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-61" x="33625" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-74" x="34155" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-68" x="34516" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-63" x="35093" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-61" x="35526" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-6C" x="36056" y="0"></use><g transform="translate(36354,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-4B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-4C" x="889" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-5B" x="37925" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-51" x="38204" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-28" x="38995" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="39385" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-7C" x="39853" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-78" x="40132" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-29" x="40704" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-7C" x="41094" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-7C" x="41372" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-50" x="41651" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-28" x="42402" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="42792" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-29" x="43260" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-5D" x="43650" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>l</mi><mi>o</mi><mi>g</mi><mi>P</mi><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo><mo>‚àí</mo><mtext>&nbsp;</mtext><mi>m</mi><mi>a</mi><mi>t</mi><mi>h</mi><mi>c</mi><mi>a</mi><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mi>K</mi><mi>L</mi></mrow><mo stretchy="false">[</mo><mi>Q</mi><mo stretchy="false">(</mo><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>x</mi><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>P</mi><mo stretchy="false">(</mo><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>=</mo><mtext>&nbsp;</mtext><mi>m</mi><mi>a</mi><mi>t</mi><mi>h</mi><mi>b</mi><mi>b</mi><msub><mrow class="MJX-TeXAtom-ORD"><mi>E</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>z</mi><mtext>&nbsp;</mtext><mi>s</mi><mi>i</mi><mi>m</mi><mi>Q</mi><mo stretchy="false">(</mo><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>x</mi><mo stretchy="false">)</mo></mrow></msub><mo stretchy="false">[</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>z</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo>‚àí</mo><mtext>&nbsp;</mtext><mi>m</mi><mi>a</mi><mi>t</mi><mi>h</mi><mi>c</mi><mi>a</mi><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mi>K</mi><mi>L</mi></mrow><mo stretchy="false">[</mo><mi>Q</mi><mo stretchy="false">(</mo><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>x</mi><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>P</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-48"> log P (X) - \ mathcal {KL} [Q (z | x) || P (z | x)] = \ mathbb {E} _ {z \ sim Q (z | x)} [log P (x | z)] - \ mathcal {KL} [Q (z | x) || P (z)] </script></p><br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-49-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>m</mi><mi>a</mi><mi>t</mi><mi>h</mi><mi>c</mi><mi>a</mi><mi>l</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>K</mi><mi>L</mi></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.608ex" height="2.057ex" viewBox="0 -780.1 5428.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-74" x="1658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-68" x="2019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-63" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-61" x="3029" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-6C" x="3559" y="0"></use><g transform="translate(3857,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-4B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-4C" x="889" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>m</mi><mi>a</mi><mi>t</mi><mi>h</mi><mi>c</mi><mi>a</mi><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mi>K</mi><mi>L</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-49"> \ mathcal {KL} </script>  is the <a href="https://en.wikipedia.org/wiki/Kullback%25E2%2580%2593Leibler_divergence">Kullback ‚Äì Leibler distance</a> , which intuitively evaluates the similarity of the two distributions. <br><br>  After a moment, you will see how to maximize the right side of the equation.  At the same time, the left side is also maximized: <br><br><ul><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-50-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.884ex" height="2.66ex" viewBox="0 -832 2103 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-28" x="751" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-78" x="1141" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-29" x="1713" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-50"> P (x) </script>  maximized. </li><li>  how far <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-51-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.712ex" height="2.66ex" viewBox="0 -832 2890 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-51" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-28" x="791" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="1181" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-7C" x="1649" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-78" x="1928" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-29" x="2500" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi><mo stretchy="false">(</mo><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-51"> Q (z | x) </script>  from <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-52-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.619ex" height="2.66ex" viewBox="0 -832 2850 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-28" x="751" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="1141" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-7C" x="1609" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-78" x="1888" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-29" x="2460" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-52"> P (z | x) </script>  - the <i>present</i> prior unknown will be minimized. </li></ul><br>  The meaning of the right side of the equation is that we have a voltage here: <br><br><ol><li>  On the one hand, we want to maximize how good <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-53-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-78" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-53"> x </script>  must be decoded from <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-54-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>i</mi><mi>m</mi><mi>Q</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.44ex" height="2.419ex" viewBox="0 -780.1 3203.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-73" x="718" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-69" x="1188" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-6D" x="1533" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-51" x="2412" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi><mtext>&nbsp;</mtext><mi>s</mi><mi>i</mi><mi>m</mi><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-54"> z \ sim Q </script>  . </li><li>  On the other hand, we want <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-55-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.712ex" height="2.66ex" viewBox="0 -832 2890 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-51" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-28" x="791" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="1181" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-7C" x="1649" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-78" x="1928" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-29" x="2500" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi><mo stretchy="false">(</mo><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-55"> Q (z | x) </script>  ( <i>encoder</i> ) was similar to the previous one <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-56-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>P</mi><mo stretchy=&quot;false&quot;>(</mo><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.643ex" height="2.66ex" viewBox="0 -832 1999 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-50" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-28" x="751" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="1141" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-29" x="1609" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-56"> P (z) </script>  (multidimensional Gaussian distribution).  This can be viewed as a regularization. </li></ol><br>  Minimization of divergence <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-57-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>m</mi><mi>a</mi><mi>t</mi><mi>h</mi><mi>c</mi><mi>a</mi><mi>l</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>K</mi><mi>L</mi></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.608ex" height="2.057ex" viewBox="0 -780.1 5428.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-74" x="1658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-68" x="2019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-63" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-61" x="3029" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-6C" x="3559" y="0"></use><g transform="translate(3857,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-4B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-4C" x="889" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>m</mi><mi>a</mi><mi>t</mi><mi>h</mi><mi>c</mi><mi>a</mi><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mi>K</mi><mi>L</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-57"> \ mathcal {KL} </script>  performed easily with the right choice of distributions.  We will model <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-58-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.712ex" height="2.66ex" viewBox="0 -832 2890 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-51" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-28" x="791" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="1181" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-7C" x="1649" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-78" x="1928" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-29" x="2500" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi><mo stretchy="false">(</mo><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-58"> Q (z | x) </script>  as a neural network, the output of which is the parameters of a multi-dimensional Gaussian distribution: <br><br><ul><li>  the average <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-59-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>m</mi><msub><mi>u</mi><mi>Q</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.483ex" height="2.057ex" viewBox="0 -520.7 2360.7 885.9" role="img" focusable="false" style="vertical-align: -0.848ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-6D" x="250" y="0"></use><g transform="translate(1128,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-75" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-51" x="809" y="-218"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>m</mi><msub><mi>u</mi><mi>Q</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-59"> \ mu_Q </script></li><li>  diagonal covariance matrix <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-60-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>S</mi><mi>i</mi><mi>g</mi><mi>m</mi><msub><mi>a</mi><mi>Q</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.801ex" height="2.66ex" viewBox="0 -780.1 3789.2 1145.2" role="img" focusable="false" style="vertical-align: -0.848ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-53" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-69" x="895" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-67" x="1241" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-6D" x="1721" y="0"></use><g transform="translate(2600,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-51" x="748" y="-218"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>S</mi><mi>i</mi><mi>g</mi><mi>m</mi><msub><mi>a</mi><mi>Q</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-60"> \ Sigma_Q </script></li></ul><br>  Then divergence <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-61-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>m</mi><mi>a</mi><mi>t</mi><mi>h</mi><mi>c</mi><mi>a</mi><mi>l</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>K</mi><mi>L</mi></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.608ex" height="2.057ex" viewBox="0 -780.1 5428.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-74" x="1658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-68" x="2019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-63" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-61" x="3029" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-6C" x="3559" y="0"></use><g transform="translate(3857,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-4B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-4C" x="889" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>m</mi><mi>a</mi><mi>t</mi><mi>h</mi><mi>c</mi><mi>a</mi><mi>l</mi><mrow class="MJX-TeXAtom-ORD"><mi>K</mi><mi>L</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-61"> \ mathcal {KL} </script>  becomes analytically solvable, which is great for us (and for gradients). <br><br>  Part of the <i>decoder is a</i> bit more complicated.  At first glance, I want to say that this task is unsolvable by the Monte Carlo method.  But sampling <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-62-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.088ex" height="1.455ex" viewBox="0 -520.7 468.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-62"> z </script>  of <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-63-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.838ex" height="2.419ex" viewBox="0 -780.1 791.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-51" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-63"> Q </script>  will not allow gradients to propagate through <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-64-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.838ex" height="2.419ex" viewBox="0 -780.1 791.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-51" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-64"> Q </script>  because sampling is not a differentiated operation.  This is a problem, since then the weights of the layers that produce <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-65-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>S</mi><mi>i</mi><mi>g</mi><mi>m</mi><msub><mi>a</mi><mi>Q</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.801ex" height="2.66ex" viewBox="0 -780.1 3789.2 1145.2" role="img" focusable="false" style="vertical-align: -0.848ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-53" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-69" x="895" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-67" x="1241" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-6D" x="1721" y="0"></use><g transform="translate(2600,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-51" x="748" y="-218"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>S</mi><mi>i</mi><mi>g</mi><mi>m</mi><msub><mi>a</mi><mi>Q</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-65"> \ Sigma_Q </script>  and <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-66-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>m</mi><msub><mi>u</mi><mi>Q</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.483ex" height="2.057ex" viewBox="0 -520.7 2360.7 885.9" role="img" focusable="false" style="vertical-align: -0.848ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-6D" x="250" y="0"></use><g transform="translate(1128,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-75" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-51" x="809" y="-218"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>m</mi><msub><mi>u</mi><mi>Q</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-66"> \ mu_Q </script>  . <br><br><h1>  The trick of the new parameterization </h1><br>  We can replace <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-67-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.838ex" height="2.419ex" viewBox="0 -780.1 791.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-51" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-67"> Q </script>  deterministic parametrized transformation of non-parametric random variable: <br><br><ol><li>  A sample of the standard (without parameters) Gaussian distribution. </li><li>  Multiply the sample by the square root <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-68-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>S</mi><mi>i</mi><mi>g</mi><mi>m</mi><msub><mi>a</mi><mi>Q</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.801ex" height="2.66ex" viewBox="0 -780.1 3789.2 1145.2" role="img" focusable="false" style="vertical-align: -0.848ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-53" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-69" x="895" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-67" x="1241" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-6D" x="1721" y="0"></use><g transform="translate(2600,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-51" x="748" y="-218"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>S</mi><mi>i</mi><mi>g</mi><mi>m</mi><msub><mi>a</mi><mi>Q</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-68"> \ Sigma_Q </script>  . </li><li>  Adding to the result <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-69-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>m</mi><msub><mi>u</mi><mi>Q</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.483ex" height="2.057ex" viewBox="0 -520.7 2360.7 885.9" role="img" focusable="false" style="vertical-align: -0.848ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-6D" x="250" y="0"></use><g transform="translate(1128,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-75" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-51" x="809" y="-218"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>m</mi><msub><mi>u</mi><mi>Q</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-69"> \ mu_Q </script>  . </li></ol><br>  As a result, we obtain a distribution equal to <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-70-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.838ex" height="2.419ex" viewBox="0 -780.1 791.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-51" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-70"> Q </script>  .  Now the sampling operation comes from the standard Gaussian distribution.  Therefore, gradients can propagate through <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-71-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>S</mi><mi>i</mi><mi>g</mi><mi>m</mi><msub><mi>a</mi><mi>Q</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.801ex" height="2.66ex" viewBox="0 -780.1 3789.2 1145.2" role="img" focusable="false" style="vertical-align: -0.848ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-53" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-69" x="895" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-67" x="1241" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-6D" x="1721" y="0"></use><g transform="translate(2600,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-61" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-51" x="748" y="-218"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>S</mi><mi>i</mi><mi>g</mi><mi>m</mi><msub><mi>a</mi><mi>Q</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-71"> \ Sigma_Q </script>  and <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-72-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>m</mi><msub><mi>u</mi><mi>Q</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.483ex" height="2.057ex" viewBox="0 -520.7 2360.7 885.9" role="img" focusable="false" style="vertical-align: -0.848ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-6D" x="250" y="0"></use><g transform="translate(1128,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-75" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-51" x="809" y="-218"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>m</mi><msub><mi>u</mi><mi>Q</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-72"> \ mu_Q </script>  , since now these are deterministic paths. <br><br>  Result?  The model will be able to learn how to adjust the parameters. <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-73-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.838ex" height="2.419ex" viewBox="0 -780.1 791.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-51" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi></math></span></span><script type="math/tex" id="MathJax-Element-73"> Q </script>  : she will concentrate around good <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-74-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.088ex" height="1.455ex" viewBox="0 -520.7 468.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-74"> z </script>  that are capable of producing <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-75-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-78" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-75"> x </script>  . <br><br><h1>  Putting it all together </h1><br>  A VAE model can be hard to understand.  We looked at a lot of material here that is hard to digest. <br><br>  Let me summarize all the steps for implementing VAE. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f9a/d5e/84a/f9ad5e84a0ad478de43edffaeb85997d.png"><br><br>  On the left we have the definition of a model: <br><br><ol><li>  The input image is transmitted through the encoder network. </li><li>  The encoder gives the distribution parameters <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-76-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.712ex" height="2.66ex" viewBox="0 -832 2890 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-51" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-28" x="791" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="1181" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-7C" x="1649" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-78" x="1928" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-29" x="2500" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi><mo stretchy="false">(</mo><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-76"> Q (z | x) </script>  . </li><li>  Hidden vector <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-77-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.088ex" height="1.455ex" viewBox="0 -520.7 468.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-77"> z </script>  is taken from <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-78-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.712ex" height="2.66ex" viewBox="0 -832 2890 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-51" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-28" x="791" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="1181" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-7C" x="1649" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-78" x="1928" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-29" x="2500" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi><mo stretchy="false">(</mo><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-78"> Q (z | x) </script>  .  If the coder is well trained, then in most cases <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-79-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.088ex" height="1.455ex" viewBox="0 -520.7 468.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-79"> z </script>  contain a description <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-80-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-78" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-80"> x </script>  . </li><li>  Decoder decodes <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-81-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.088ex" height="1.455ex" viewBox="0 -520.7 468.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-81"> z </script>  in the image. </li></ol><br>  On the right side we have a loss function: <br><br><ol><li>  Recovery error: the output should be similar to the input. </li><li><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-82-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.712ex" height="2.66ex" viewBox="0 -832 2890 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-51" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-28" x="791" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="1181" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-7C" x="1649" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-78" x="1928" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-29" x="2500" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi><mo stretchy="false">(</mo><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-82"> Q (z | x) </script>  should be similar to the previous one, that is, a multidimensional standard normal distribution. </li></ol><br>  To create new images, you can directly select the hidden vector from the previous distribution and decode it into an image. <br><br><h1>  Working code </h1><br>  Now let's take a closer look at VAE and look at the working code.  You will understand all the technical details necessary for implementing VAE.  As a bonus, I will show an interesting trick: how to assign specific roles to some dimensions of the hidden vector so that the model starts generating pictures of the indicated numbers. <br><br><pre><code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> numpy <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> np <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> tensorflow <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> tf <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> tensorflow.examples.tutorials.mnist <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> input_data <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> matplotlib.pyplot <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> plt np.random.seed(<span class="hljs-number"><span class="hljs-number">42</span></span>) tf.set_random_seed(<span class="hljs-number"><span class="hljs-number">42</span></span>) %matplotlib inline</code> </pre> <br>  I remind you that models are trained on <a href="https://en.wikipedia.org/wiki/MNIST_database">MNIST</a> - a set of handwritten numbers.  Input images come in the format <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-83-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>&amp;#xA0;</mtext><mi>m</mi><mi>a</mi><mi>t</mi><mi>h</mi><mi>b</mi><mi>b</mi><msup><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>R</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mn>28</mn><mo>&amp;#xD7;</mo><mn>28</mn></mrow></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.587ex" height="2.539ex" viewBox="0 -987.6 6280.6 1093.4" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-74" x="1658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-68" x="2019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-62" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-62" x="3025" y="0"></use><g transform="translate(3455,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-52" x="0" y="0"></use><g transform="translate(759,410)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-32"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-38" x="500" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-D7" x="1001" y="0"></use><g transform="translate(1258,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-32"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-38" x="500" y="0"></use></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>&nbsp;</mtext><mi>m</mi><mi>a</mi><mi>t</mi><mi>h</mi><mi>b</mi><mi>b</mi><msup><mrow class="MJX-TeXAtom-ORD"><mi>R</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mn>28</mn><mo>√ó</mo><mn>28</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-83"> \ mathbb {R} ^ {28 √ó 28} </script>  . <br><br><pre> <code class="python hljs">mnist = input_data.read_data_sets(<span class="hljs-string"><span class="hljs-string">'MNIST_data'</span></span>) input_size = <span class="hljs-number"><span class="hljs-number">28</span></span> * <span class="hljs-number"><span class="hljs-number">28</span></span> num_digits = <span class="hljs-number"><span class="hljs-number">10</span></span></code> </pre> <br>  Next, we define the hyperparameters. <br><br>  Feel free to play with different values ‚Äã‚Äãto get an idea of ‚Äã‚Äãhow they affect the model. <br><br><pre> <code class="python hljs">params = { <span class="hljs-string"><span class="hljs-string">'encoder_layers'</span></span>: [<span class="hljs-number"><span class="hljs-number">128</span></span>], <span class="hljs-comment"><span class="hljs-comment">#       'decoder_layers': [128], #    (CNN ,     ) 'digit_classification_layers': [128], #   ,   'activation': tf.nn.sigmoid, #      'decoder_std': 0.5, #   P(x|z)   'z_dim': 10, #    'digit_classification_weight': 10.0, #   ,   'epochs': 20, 'batch_size': 100, 'learning_rate': 0.001 }</span></span></code> </pre> <br><h1>  Model </h1><br><img src="https://habrastorage.org/getpro/habr/post_images/b4c/517/a64/b4c517a642595b511407c91c2f2b50e8.jpg"><br><br>  The model consists of three subnets: <br><br><ol><li>  Gets <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-84-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-78" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-84"> x </script>  (image) encodes it into a distribution <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-85-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>Q</mi><mo stretchy=&quot;false&quot;>(</mo><mi>z</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mo stretchy=&quot;false&quot;>|</mo></mrow><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.712ex" height="2.66ex" viewBox="0 -832 2890 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-51" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-28" x="791" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="1181" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-7C" x="1649" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-78" x="1928" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-29" x="2500" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi><mo stretchy="false">(</mo><mi>z</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-85"> Q (z | x) </script>  on the hidden space. </li><li>  Gets <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-86-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>z</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.088ex" height="1.455ex" viewBox="0 -520.7 468.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>z</mi></math></span></span><script type="math/tex" id="MathJax-Element-86"> z </script>  in the hidden space (image code representation), decodes it into the corresponding image <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-87-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mo stretchy=&quot;false&quot;>(</mo><mi>z</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.176ex" height="2.66ex" viewBox="0 -832 1798 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-66" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-28" x="550" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-7A" x="940" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-29" x="1408" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-87"> f (z) </script>  . </li><li>  Gets <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-88-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMATHI-78" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-88"> x </script>  and determines the figure in comparison with the 10-dimensional layer, where the i-th value contains the probability of the i-th number. </li></ol><br>  The first two subnets are the basis of pure VAE. <br><br>  The third is an <a href="http://ruder.io/multi-task/index.html">auxiliary task</a> that uses some of the hidden dimensions to encode a digit found in an image.  Let me explain why: we have previously discussed that we don‚Äôt care what information each dimension of hidden space contains.  The model can learn to code any information that it considers valuable for its task.  Since we are familiar with the data set, we know the importance of a measurement that contains a type of digit (that is, its numerical value).  And now we want to help the model by providing it with this information. <br><br>  Given a type of digit, we directly encode it, that is, we use a vector of size 10. These ten numbers are associated with a hidden vector, so when decoding this vector into an image, the model will use digital information. <br><br>  There are two ways to provide direct coding vector models: <br><br><ol><li>  Add it as input to the model. </li><li>  Add it as a label, so the model will calculate the forecast itself: we will add another subnet that predicts a 10-dimensional vector, where the loss function is the cross entropy with the expected direct encoding vector. </li></ol><br>  Choose the second option.  Why?  Well, then when testing, you can use the model in two ways: <br><br><ol><li>  Specify the image as input and display the hidden vector. </li><li>  Specify a hidden vector as input and generate an image. </li></ol><br>  Since we want to support the first option, we cannot give the model a figure as input, because we do not want to know it during testing.  Therefore, the model must learn to predict it. <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">encoder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x, layers)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> layer <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> layers: x = tf.layers.dense(x, layer, activation=params[<span class="hljs-string"><span class="hljs-string">'activation'</span></span>]) mu = tf.layers.dense(x, params[<span class="hljs-string"><span class="hljs-string">'z_dim'</span></span>]) var = <span class="hljs-number"><span class="hljs-number">1e-5</span></span> + tf.exp(tf.layers.dense(x, params[<span class="hljs-string"><span class="hljs-string">'z_dim'</span></span>])) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> mu, var <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">decoder</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(z, layers)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> layer <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> layers: z = tf.layers.dense(z, layer, activation=params[<span class="hljs-string"><span class="hljs-string">'activation'</span></span>]) mu = tf.layers.dense(z, input_size) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> tf.nn.sigmoid(mu) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">digit_classifier</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x, layers)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> layer <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> layers: x = tf.layers.dense(x, layer, activation=params[<span class="hljs-string"><span class="hljs-string">'activation'</span></span>]) logits = tf.layers.dense(x, num_digits) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> logits</code> </pre> <br><pre> <code class="python hljs">images = tf.placeholder(tf.float32, [<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>, input_size]) digits = tf.placeholder(tf.int32, [<span class="hljs-keyword"><span class="hljs-keyword">None</span></span>]) <span class="hljs-comment"><span class="hljs-comment">#        encoder_mu, encoder_var = encoder(images, params['encoder_layers']) #     ,  #     eps = tf.random_normal(shape=[tf.shape(images)[0], params['z_dim']], mean=0.0, stddev=1.0) z = encoder_mu + tf.sqrt(encoder_var) * eps # classify the digit digit_logits = digit_classifier(images, params['digit_classification_layers']) digit_prob = tf.nn.softmax(digit_logits) #     ,  #    decoded_images = decoder(tf.concat([z, digit_prob], axis=1), params['decoder_layers'])</span></span></code> </pre> <br><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#    ,    #    loss_reconstruction = -tf.reduce_sum( tf.contrib.distributions.Normal( decoded_images, params['decoder_std'] ).log_prob(images), axis=1 ) #         . #      , #         #  ,  KL-   # ,    loss_prior = -0.5 * tf.reduce_sum( 1 + tf.log(encoder_var) - encoder_mu ** 2 - encoder_var, axis=1 ) loss_auto_encode = tf.reduce_mean( loss_reconstruction + loss_prior, axis=0 ) # digit_classification_weight      , #      loss_digit_classifier = params['digit_classification_weight'] * tf.reduce_mean( tf.nn.sparse_softmax_cross_entropy_with_logits(labels=digits, logits=digit_logits), axis=0 ) loss = loss_auto_encode + loss_digit_classifier train_op = tf.train.AdamOptimizer(params['learning_rate']).minimize(loss)</span></span></code> </pre> <br><h1>  Training </h1><br><img src="https://habrastorage.org/getpro/habr/post_images/8ee/8ff/109/8ee8ff10924b6d1cefd27567e49f3a9f.jpg"><br><br>  We will tutor the optimization model of two loss functions - VAE and classification - using <a href="https://en.wikipedia.org/wiki/Stochastic_gradient_descent">SGD</a> . <br><br>  At the end of each epoch, we select hidden vectors and decode them into images in order to visually observe how the generative power of the model improves according to epochs.  The sampling method is as follows: <br><br><ol><li>  Explicitly specify the dimensions that are used to categorize by the number we want to generate.  For example, if we want to create an image of digit 2, then we set measurements <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-89-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>[</mo><mn>0010000000</mn><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.918ex" height="2.66ex" viewBox="0 -832 5562 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-5B" x="0" y="0"></use><g transform="translate(278,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-30"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-30" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-31" x="1001" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-30" x="1501" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-30" x="2002" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-30" x="2502" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-30" x="3003" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-30" x="3503" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-30" x="4004" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-30" x="4504" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/429276/&amp;xid=17259,15700022,15700186,15700190,15700248,15700253&amp;usg=ALkJrhiktTszK2-PJE_AqauROg0jyQCpMw#MJMAIN-5D" x="5283" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">[</mo><mn>0010000000</mn><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-89"> [0010000000] </script>  . </li><li>  Make a random sample from other dimensions of the multidimensional normal distribution.  These are the values ‚Äã‚Äãfor the different digits that are generated in a given era.  So we get an idea of ‚Äã‚Äãwhat is encoded in other dimensions, for example, handwriting style. </li></ol><br>  The meaning of step 1 is that after convergence, the model should be able to classify a digit in the input image according to these measurement settings.  However, they are also used at the decoding stage to create an image.  That is, the decoder subnet knows: when the measurements correspond to digit 2, it must generate a picture with this digit.  Therefore, if you manually set the measurement to the number 2, we get the generated image of this number. <br><br><pre> <code class="python hljs">samples = [] losses_auto_encode = [] losses_digit_classifier = [] <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> tf.Session() <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> sess: sess.run(tf.global_variables_initializer()) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> epoch <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> xrange(params[<span class="hljs-string"><span class="hljs-string">'epochs'</span></span>]): <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> _ <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> xrange(mnist.train.num_examples / params[<span class="hljs-string"><span class="hljs-string">'batch_size'</span></span>]): batch_images, batch_digits = mnist.train.next_batch(params[<span class="hljs-string"><span class="hljs-string">'batch_size'</span></span>]) sess.run(train_op, feed_dict={images: batch_images, digits: batch_digits}) train_loss_auto_encode, train_loss_digit_classifier = sess.run( [loss_auto_encode, loss_digit_classifier], {images: mnist.train.images, digits: mnist.train.labels}) losses_auto_encode.append(train_loss_auto_encode) losses_digit_classifier.append(train_loss_digit_classifier) sample_z = np.tile(np.random.randn(<span class="hljs-number"><span class="hljs-number">1</span></span>, params[<span class="hljs-string"><span class="hljs-string">'z_dim'</span></span>]), reps=[num_digits, <span class="hljs-number"><span class="hljs-number">1</span></span>]) gen_samples = sess.run(decoded_images, feed_dict={z: sample_z, digit_prob: np.eye(num_digits)}) samples.append(gen_samples)</code> </pre> <br>  Let's check that both loss functions look good, that is, decrease: <br><br><pre> <code class="python hljs">plt.subplot(<span class="hljs-number"><span class="hljs-number">121</span></span>) plt.plot(losses_auto_encode) plt.title(<span class="hljs-string"><span class="hljs-string">'VAE loss'</span></span>) plt.subplot(<span class="hljs-number"><span class="hljs-number">122</span></span>) plt.plot(losses_digit_classifier) plt.title(<span class="hljs-string"><span class="hljs-string">'digit classifier loss'</span></span>) plt.tight_layout()</code> </pre> <br><img src="https://habrastorage.org/webt/tv/qy/qo/tvqyqo9chfeudddlg2hzqtmlcea.png"><br><br>  In addition, let's derive the generated images and see if the model is really able to create pictures with handwritten numbers: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">plot_samples</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(samples)</span></span></span><span class="hljs-function">:</span></span> IMAGE_WIDTH = <span class="hljs-number"><span class="hljs-number">0.7</span></span> plt.figure(figsize=(IMAGE_WIDTH * num_digits, len(samples) * IMAGE_WIDTH)) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> epoch, images <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> enumerate(samples): <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> digit, image <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> enumerate(images): plt.subplot(len(samples), num_digits, epoch * num_digits + digit + <span class="hljs-number"><span class="hljs-number">1</span></span>) plt.imshow(image.reshape((<span class="hljs-number"><span class="hljs-number">28</span></span>, <span class="hljs-number"><span class="hljs-number">28</span></span>)), cmap=<span class="hljs-string"><span class="hljs-string">'Greys_r'</span></span>) plt.gca().xaxis.set_visible(<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> digit == <span class="hljs-number"><span class="hljs-number">0</span></span>: plt.gca().yaxis.set_ticks([]) plt.ylabel(<span class="hljs-string"><span class="hljs-string">'epoch {}'</span></span>.format(epoch + <span class="hljs-number"><span class="hljs-number">1</span></span>), verticalalignment=<span class="hljs-string"><span class="hljs-string">'center'</span></span>, horizontalalignment=<span class="hljs-string"><span class="hljs-string">'right'</span></span>, rotation=<span class="hljs-number"><span class="hljs-number">0</span></span>, fontsize=<span class="hljs-number"><span class="hljs-number">14</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span>: plt.gca().yaxis.set_visible(<span class="hljs-keyword"><span class="hljs-keyword">False</span></span>) plot_samples(samples)</code> </pre> <br><div style="text-align:center;"><img src="https://habrastorage.org/webt/nq/uo/sm/nquosmxgman_ehoi6pbbnmdcgqc.png"></div><br><h1>  Conclusion </h1><br>  It's nice to see that a simple network of direct distribution (without fancy bundles) generates beautiful images in just 20 epochs.  The model quickly learned how to use specific measurements for numbers: in the 9th era, we already see the sequence of numbers that we were trying to generate. <br><br>  Each epoch used different random values ‚Äã‚Äãfor other dimensions, so the style is different between eras, but similar within them: at least within some.  For example, in the 18th all the numbers are fatter compared to the 20th. <br><br><h4>  Notes </h4><br>  The article is based on my experience and the following sources: <br><br><ul><li>  <a href="https://pure.uva.nl/ws/files/17891313/Thesis.pdf">Variational inference and deep learning: a new synthesis</a> </li><li>  <a href="https://arxiv.org/abs/1606.05908">Guide to Variational Car Encoders</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/429276/">https://habr.com/ru/post/429276/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../429266/index.html">What salaries for IT specialists are offered by My Circle employers, data for May-October 2018</a></li>
<li><a href="../429268/index.html">Giant spider and minotaur on the streets of toulouse</a></li>
<li><a href="../429270/index.html">Adult journalism: from Russia to the Kremlin</a></li>
<li><a href="../429272/index.html">A brief snapshot of React and Redux functional web development: Chapter 1. Welcome to React</a></li>
<li><a href="../429274/index.html">Startup: how to live up to the round</a></li>
<li><a href="../429278/index.html">Promising magnetic recording technology MAMR: what awaits us in the near future?</a></li>
<li><a href="../429280/index.html">As a vulnerability in REG.RU allowed to get registration data of any domain</a></li>
<li><a href="../429282/index.html">Microsoft fixed a bug with the "deactivation" of licenses for Windows 10</a></li>
<li><a href="../429286/index.html">How to speed up machine learning on a GPU - a new open source platform is introduced</a></li>
<li><a href="../429288/index.html">Developer! Stop thinking you are not a good enough specialist; that's not true.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>