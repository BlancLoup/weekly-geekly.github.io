<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Operators?. ?? and |>: future JavaScript features you'll like</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Justin Fuller, the author of the material, the translation of which we are publishing today, offers to consider three new features that are expected t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Operators?. ?? and |>: future JavaScript features you'll like</h1><div class="post__text post__text-html js-mediator-article"> Justin Fuller, the author of the material, the translation of which we are publishing today, offers to consider three new features that are expected to appear in JavaScript in the foreseeable future.  He will first talk about the JS development process, and then provide an overview of these features and show examples of their use.  <code>?.</code> about operators <code>?.</code>  <code>??</code>  and <code>|&gt;</code> . <br><br><h2>  <font color="#3AC1EF">About ECMAScript and JavaScript Development</font> </h2><br> <a href="https://habrahabr.ru/company/ruvds/blog/353446/"><img align="left" src="https://habrastorage.org/getpro/habr/post_images/405/987/b15/405987b152ff04ab9244c47f8bc8e939.png"></a>  If you are already familiar with the features of the work of the <a href="http://www.ecma-international.org/memento/TC39.htm">ECMA TC39</a> working group, and how it performs the selection and processing of suggestions for improving JavaScript, you may well skip this section.  If you are one of those who are interested to find out about it - here is a brief overview of what the TC39 does. <br><br>  JavaScript is an implementation of a standard called <a href="https://en.wikipedia.org/wiki/ECMAScript">ECMAScript</a> , which was created to standardize language <a href="https://en.wikipedia.org/wiki/Category:JavaScript_dialect_engines">implementations</a> that appeared in the early years of web browsers. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      There are eight <a href="https://en.wikipedia.org/wiki/ECMAScript">editions of</a> the ECMAScript standard and seven releases (the fourth edition of the standard did not come out, after the third one there is the fifth one).  The developers of <a href="https://en.wikipedia.org/wiki/JavaScript_engine">JavaScript-engines</a> begin to implement innovations of the language after the release of the standard.  <a href="https://kangax.github.io/compat-table/es6/">Here</a> you can see that not every engine realizes all the possibilities, while some engines take more time to introduce innovations than others.  Although this state of affairs is not ideal, it‚Äôs still better than a complete lack of standards. <br><a name="habracut"></a><br><h2>  <font color="#3AC1EF">suggestions</font> </h2><br>  New features of the language are initially the so-called sentences, which, before being included in the standard, undergo a harmonization procedure.  If the proposal is deemed useful and backward compatible with all that already exists, it will be included in the next edition of the standard. <br><br>  The proposal review process consists of five steps described in <a href="https://tc39.github.io/process-document/">this document</a> .  At the very beginning of the proposal is in a state of draft (strawman), this is the same as <a href="">Stage 0</a> .  At this step, the proposal has either not yet been submitted to the technical committee, or it has not yet been rejected, but it does not yet meet the criteria for moving on to the next stage of approval.  Those opportunities, which we will discuss below, have already passed Stage 0. <br><br>  I would like to recommend readers to avoid using JS innovations in production, proposals describing which are at the stage of Stage 0. It is better to wait for them to move to more stable stages of agreement.  The purpose of this recommendation is to help you avoid problems in the event that the proposal is rejected or is very much changed. <br><br><h2>  <font color="#3AC1EF">Testing system</font> </h2><br>  Materials in which they talk about new features of programming languages ‚Äã‚Äãoften contain code fragments taken out of context.  Sometimes these features are used to create some learning applications.  However, we will not do either one or the other here.  Since I am a big fan of <a href="https://en.wikipedia.org/wiki/Test-driven_development">TDD</a> , I believe that the best way to learn some new technology is to test it. <br><br>  We will use here to master the JS features described, what Jim Newkirk calls <a href="https://smile.amazon.com/Test-Driven-Development-Kent-Beck/dp/0321146530/ref%3Dsmi_www_rco2_go_smi_2609328962%3F_encoding%3DUTF8%26%252AVersion%252A%3D1%26%252Aentries%252A%3D0%26ie%3DUTF8">learning tests</a> .  Such tests are not based on statements about code written in a certain language.  They are built on the analysis of statements concerning the language itself.  The same approach may be useful when learning the API of third-party developers, and when mastering any possibility of a language. <br><br><h2>  <font color="#3AC1EF">Transporters</font> </h2><br>  If you are not familiar with transpilers, then you may have a question about how we are going to use features of the language that are not yet implemented.  It should be noted here that JavaScript is constantly evolving, and it takes time to implement its new features, which are interesting for programmers, in common engines.  As a result, in the JS ecosystem there is such a thing as <a href="https://scotch.io/tutorials/javascript-transpilers-what-they-are-why-we-need-them">transpilers</a> . <br><br>  They allow you to convert the code written in JS using the latest features, which, for example, are not yet included in the standards and are not implemented by popular engines, into JS code that is understood by the existing JavaScript program execution environments.  This will allow, for example, to use in the code even sentences of the Stage 0 level, and what happens after processing the code with the transpiler can be done, for example, in modern browsers or in the Node.js environment.  This is done by <a href="https://babeljs.io/repl/">converting the</a> new code in such a way that it, for the runtime environment, looks like code written on one of the JS versions it supports. <br><br>  One of the most popular JavaScript transpilers is <a href="https://babeljs.io/">Babel</a> , very soon we will talk about how to use it. <br><br><h2>  <font color="#3AC1EF">Work environment preparation</font> </h2><br>  If you want to repeat on your own everything that we will talk about - you can do this by setting up an npm project and installing the necessary dependencies.  It is assumed that you now have <a href="https://nodejs.org/en/">Node.js</a> and <a href="https://www.npmjs.com/">NPM</a> installed. <br><br>  In order to prepare for our experiments, run the following command, being in the directory designated for these experiments: <br><br><pre> <code class="hljs mel">npm init -f &amp;&amp; npm i ava@1<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>-beta<span class="hljs-number"><span class="hljs-number">.3</span></span> @babel/preset-<span class="hljs-keyword"><span class="hljs-keyword">env</span></span>@7<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>-beta<span class="hljs-number"><span class="hljs-number">.42</span></span> @babel/preset-stage<span class="hljs-number"><span class="hljs-number">-0</span></span>@7<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>-beta<span class="hljs-number"><span class="hljs-number">.42</span></span> @babel/register@7<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>-beta<span class="hljs-number"><span class="hljs-number">.42</span></span> @babel/polyfill@7<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>-beta<span class="hljs-number"><span class="hljs-number">.42</span></span> @babel/plugin-transform-runtime@7<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>-beta<span class="hljs-number"><span class="hljs-number">.42</span></span> @babel/runtime@7<span class="hljs-number"><span class="hljs-number">.0</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span>-beta<span class="hljs-number"><span class="hljs-number">.42</span></span> --save-dev</code> </pre> <br>  Then add the following to the <code>package.json</code> file: <br><br><pre> <code class="hljs perl"><span class="hljs-string"><span class="hljs-string">"scripts"</span></span>: { <span class="hljs-string"><span class="hljs-string">"test"</span></span>: <span class="hljs-string"><span class="hljs-string">"ava"</span></span> }, <span class="hljs-string"><span class="hljs-string">"ava"</span></span>: {    <span class="hljs-string"><span class="hljs-string">"require"</span></span>: [        <span class="hljs-string"><span class="hljs-string">"@babel/register"</span></span>,   <span class="hljs-string"><span class="hljs-string">"@babel/polyfill"</span></span>   ] }</code> </pre> <br>  Next, create a <code>.babelrc</code> file with the following contents: <br><br><pre> <code class="hljs json">{  <span class="hljs-attr"><span class="hljs-attr">"presets"</span></span>: [      [<span class="hljs-string"><span class="hljs-string">"@babel/preset-env"</span></span>, {          <span class="hljs-attr"><span class="hljs-attr">"targets"</span></span>: {              <span class="hljs-attr"><span class="hljs-attr">"node"</span></span>: <span class="hljs-string"><span class="hljs-string">"current"</span></span>          }   }],     <span class="hljs-string"><span class="hljs-string">"@babel/preset-stage-0"</span></span>  ],  <span class="hljs-attr"><span class="hljs-attr">"plugins"</span></span>: [      <span class="hljs-string"><span class="hljs-string">"@babel/plugin-transform-runtime"</span></span> ] }</code> </pre> <br>  Now you are ready to write tests that explore new JS features. <br><br><h2>  <font color="#3AC1EF">1. Operator?</font> </h2><br>  In the course of writing applications in JavaScript, we are constantly working with objects.  However, sometimes these objects do not have the structure that we expect from them.  For example, an object with data.  Such an object can be obtained, for example, as a result of a database query or when accessing a certain API. <br><br><pre> <code class="hljs haskell"><span class="hljs-title"><span class="hljs-title">const</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class"> = { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">user</span></span></span><span class="hljs-class">: {   </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">address</span></span></span><span class="hljs-class">: {     </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">street</span></span></span><span class="hljs-class">: '</span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Pennsylvania</span></span></span><span class="hljs-class"> </span><span class="hljs-type"><span class="hljs-class"><span class="hljs-type">Avenue</span></span></span><span class="hljs-class">',   }, }, };</span></span></code> </pre> <br>  This object describes a registered user.  And here is a similar object, but in this case the user whom he describes did not complete the registration. <br><br><pre> <code class="hljs haskell"><span class="hljs-title"><span class="hljs-title">const</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">data</span></span></span><span class="hljs-class"> = { </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">user</span></span></span><span class="hljs-class">: {}, };</span></span></code> </pre> <br>  If you try to access the <code>street</code> property of the <code>address</code> object nested in this ‚Äúincomplete‚Äù object, expecting that it will look the same as an object containing all the necessary data, you may encounter the following error: <br><br><pre> <code class="hljs pgsql">console.log(data.<span class="hljs-keyword"><span class="hljs-keyword">user</span></span>.address.street); // Uncaught TypeError: Cannot <span class="hljs-keyword"><span class="hljs-keyword">read</span></span> property <span class="hljs-string"><span class="hljs-string">'street'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> undefined</code> </pre> <br>  In order to avoid this, in the current conditions, it is necessary to use the following construction to refer to the <code>street</code> property: <br><br><pre> <code class="hljs kotlin"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> street = <span class="hljs-keyword"><span class="hljs-keyword">data</span></span> &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>.user &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>.user.address &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>.user.address.street; console.log(street); <span class="hljs-comment"><span class="hljs-comment">// undefined</span></span></code> </pre> <br>  I believe that all this, firstly, looks bad, secondly, it is hard to write, and thirdly, such constructions turn out to be too long. <br><br>  It is in such situations that the optional sequences or optional chains, represented by the operator, looking like a question mark with a dot ( <code>?.</code> ), Can by the way turn out to be. <br><br><pre> <code class="hljs pgsql">console.log(data.<span class="hljs-keyword"><span class="hljs-keyword">user</span></span>?.address?.street); // undefined</code> </pre> <br>  It looks better, and it is easier to build such structures.  I am sure you will agree with this statement.  Convinced of the usefulness of this new opportunity, explore it.  Let's write a test by putting the code in the file <code>optional-chaining.test.js</code> .  We, in this section, will gradually supplement this file with new tests. <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> test <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'ava'</span></span>; const <span class="hljs-keyword"><span class="hljs-keyword">valid</span></span> = { <span class="hljs-keyword"><span class="hljs-keyword">user</span></span>: {   address: {     street: <span class="hljs-string"><span class="hljs-string">'main street'</span></span>,   }, }, }; <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> getAddress(data) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> data?.<span class="hljs-keyword"><span class="hljs-keyword">user</span></span>?.address?.street; } test(<span class="hljs-string"><span class="hljs-string">'Optional Chaining returns real values'</span></span>, (t) =&gt; { const result = getAddress(<span class="hljs-keyword"><span class="hljs-keyword">valid</span></span>); t.<span class="hljs-keyword"><span class="hljs-keyword">is</span></span>(result, <span class="hljs-string"><span class="hljs-string">'main street'</span></span>); });</code> </pre> <br>  This test allows us to verify that the operator <code>?.</code>  , in the event that an object looks like it is expected, it works in the same way as the way to access the properties of an object through a point.  Now let's check the behavior of this operator in a situation where the object is not what we consider it. <br><br><pre> <code class="hljs coffeescript">test(<span class="hljs-string"><span class="hljs-string">'Optional chaining returns undefined for nullish properties.'</span></span>, <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(t)</span></span></span><span class="hljs-function"> =&gt;</span></span> { t.<span class="hljs-keyword"><span class="hljs-keyword">is</span></span>(getAddress(), <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>); t.<span class="hljs-keyword"><span class="hljs-keyword">is</span></span>(getAddress(<span class="hljs-literal"><span class="hljs-literal">null</span></span>), <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>); t.<span class="hljs-keyword"><span class="hljs-keyword">is</span></span>(getAddress({}), <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>); });</code> </pre> <br>  And this is how optional sequences work when they are used to access array elements: <br><br><pre> <code class="hljs coffeescript">const valid = { user: {   address: {     street: <span class="hljs-string"><span class="hljs-string">'main street'</span></span>,     neighbors: [       <span class="hljs-string"><span class="hljs-string">'john doe'</span></span>,       <span class="hljs-string"><span class="hljs-string">'jane doe'</span></span>,     ],   }, }, }; function getNeighbor(data, number) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> data?.user?.address?.neighbors?.[number]; } test(<span class="hljs-string"><span class="hljs-string">'Optional chaining works for array properties'</span></span>, <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(t)</span></span></span><span class="hljs-function"> =&gt;</span></span> { t.<span class="hljs-keyword"><span class="hljs-keyword">is</span></span>(getNeighbor(valid, <span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-string"><span class="hljs-string">'john doe'</span></span>); }); test(<span class="hljs-string"><span class="hljs-string">'Optional chaining returns undefined for invalid array properties'</span></span>, <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(t)</span></span></span><span class="hljs-function"> =&gt;</span></span> { t.<span class="hljs-keyword"><span class="hljs-keyword">is</span></span>(getNeighbor({}, <span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>); });</code> </pre> <br>  Sometimes it happens that we do not know whether any function is implemented in the object.  For example, this situation is common when working with browsers.  Outdated browsers may not contain implementations of certain functions.  Thanks to the operator <code>?.</code>  we can find out whether a feature of interest is implemented in an object or not.  Here's how to do it: <br><br><pre> <code class="hljs kotlin"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">data</span></span> = { user: {   address: {     street: <span class="hljs-string"><span class="hljs-string">'main street'</span></span>,     neighbors: [       <span class="hljs-string"><span class="hljs-string">'john doe'</span></span>,       <span class="hljs-string"><span class="hljs-string">'jane doe'</span></span>,     ],   },   getNeighbors() {     <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>.user.address.neighbors;   } }, }; function getNeighbors(<span class="hljs-keyword"><span class="hljs-keyword">data</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">data</span></span>?.user?.getNeighbors?.(); } test(<span class="hljs-string"><span class="hljs-string">'Optional chaining also works with functions'</span></span>, (t) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> neighbors = getNeighbors(<span class="hljs-keyword"><span class="hljs-keyword">data</span></span>); t.<span class="hljs-keyword"><span class="hljs-keyword">is</span></span>(neighbors.length, <span class="hljs-number"><span class="hljs-number">2</span></span>); t.<span class="hljs-keyword"><span class="hljs-keyword">is</span></span>(neighbors[<span class="hljs-number"><span class="hljs-number">0</span></span>], <span class="hljs-string"><span class="hljs-string">'john doe'</span></span>); }); test(<span class="hljs-string"><span class="hljs-string">'Optional chaining returns undefined if a function does not exist'</span></span>, (t) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> neighbors = getNeighbors({}); t.<span class="hljs-keyword"><span class="hljs-keyword">is</span></span>(neighbors, undefined); });</code> </pre> <br>  Expressions will not be executed if something is wrong in the chain.  If we talk about the internal implementation of this mechanism, then our expression is converted approximately to the following: <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">value</span></span> == <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> ? <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>[<span class="hljs-keyword"><span class="hljs-keyword">some</span></span> expression here]: undefined;</code> </pre> <br>  As a result, after the operator <code>?.</code>  nothing will be executed if the value is represented as <code>undefined</code> or <code>null</code> .  You can look at this rule in action using the following test: <br><br><pre> <code class="hljs coffeescript">let neighborCount = <span class="hljs-number"><span class="hljs-number">0</span></span>; function getNextNeighbor(neighbors) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> neighbors?.[++neighborCount]; } test(<span class="hljs-string"><span class="hljs-string">'It short circuits expressions'</span></span>, <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(t)</span></span></span><span class="hljs-function"> =&gt;</span></span> { const neighbors = getNeighbors(data); t.<span class="hljs-keyword"><span class="hljs-keyword">is</span></span>(getNextNeighbor(neighbors), <span class="hljs-string"><span class="hljs-string">'jane doe'</span></span>); t.<span class="hljs-keyword"><span class="hljs-keyword">is</span></span>(getNextNeighbor(<span class="hljs-literal"><span class="hljs-literal">undefined</span></span>), <span class="hljs-literal"><span class="hljs-literal">undefined</span></span>); t.<span class="hljs-keyword"><span class="hljs-keyword">is</span></span>(neighborCount, <span class="hljs-number"><span class="hljs-number">1</span></span>); });</code> </pre> <br>  As you can see, optional sequences can reduce the need for <code>if</code> constructs, in third-party libraries like <code>lodash</code> , and in using clumsy constructs that use <code>&amp;&amp;</code> . <br><br><h3>  <font color="#3AC1EF">‚ñçOperator? .. and performance</font> </h3><br>  You probably noticed that using optional sequences means an additional load on the system.  The thing is that every time an operator is used <code>?.</code>  , the system is forced to conduct additional checks.  Operator Abuse <code>?.</code>  can significantly affect the performance of programs. <br><br>  I would advise you to use this feature together with some kind of verification system that allows you to analyze objects when they are received from somewhere or when they are created.  Does this reduce the need to use the design <code>?.</code>  and limit its impact on performance. <br><br><h2>  <font color="#3AC1EF">2. Operator ??</font> </h2><br>  Here are some common operations that can be encountered while working with JavaScript.  Usually they look like a single expression, the meaning of which is as follows: <br><br><ol><li>  Checking the value for <code>undefined</code> and <code>null</code> . </li><li>  Specifies the default value. </li><li>  Ensuring that the appearance of the values <code>0</code> , <code>false</code> , and <code>''</code> does not result in the use of the default value. </li></ol><br>  Here is an example of a similar expression: <br><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">value</span></span> != <span class="hljs-literal"><span class="hljs-literal">null</span></span> ? <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> : <span class="hljs-string"><span class="hljs-string">'default value'</span></span>;</code> </pre> <br>  You can meet and illiterately written version of this expression: <br><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">value</span></span> || <span class="hljs-string"><span class="hljs-string">'default value'</span></span></code> </pre> <br>  The problem with the second example is that the third item in the above list is not fulfilled here.  The appearance of the number <code>0</code> here, the value <code>false</code> or the empty string will be recognized as <code>false</code> , and this is not what we need.  That is why the test for <code>null</code> and <code>undefined</code> should be carried out explicitly: <br><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">value</span></span> != <span class="hljs-literal"><span class="hljs-literal">null</span></span></code> </pre> <br>  This expression is similar to this: <br><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">value</span></span> !== <span class="hljs-literal"><span class="hljs-literal">null</span></span> &amp;&amp; <span class="hljs-keyword"><span class="hljs-keyword">value</span></span> !== undefined</code> </pre> <br>  In such situations, the new operator, called ‚Äúunion with <code>null</code> value‚Äù ( <a href="https://github.com/tc39/proposal-nullish-coalescing">nullish coalescence</a> ), which looks like two question marks ( <code>??</code> ), will be very useful.  In this situation, you can now use the following design: <br><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">value</span></span> ?? <span class="hljs-string"><span class="hljs-string">'default value'</span></span>;</code> </pre> <br>  This protects us from accidentally using default values ‚Äã‚Äãwhen values ‚Äã‚Äãthat are recognized as <code>false</code> appear in expressions, but it allows us to detect <code>null</code> and <code>undefined</code> values ‚Äã‚Äãwithout resorting to the ternary operator and checking the form <code>!= null</code> . <br><br>  Now, having become acquainted with this operator, we can write tests in order to test it in action.  These tests will be <code>nullish-coalescing.test.js</code> in the file <code>nullish-coalescing.test.js</code> . <br><br><pre> <code class="hljs coffeescript"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> test <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'ava'</span></span>; test(<span class="hljs-string"><span class="hljs-string">'Nullish coalescing defaults null'</span></span>, <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(t)</span></span></span><span class="hljs-function"> =&gt;</span></span> { t.<span class="hljs-keyword"><span class="hljs-keyword">is</span></span>(<span class="hljs-literal"><span class="hljs-literal">null</span></span> ?? <span class="hljs-string"><span class="hljs-string">'default'</span></span>, <span class="hljs-string"><span class="hljs-string">'default'</span></span>); }); test(<span class="hljs-string"><span class="hljs-string">'Nullish coalescing defaults undefined'</span></span>, <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(t)</span></span></span><span class="hljs-function"> =&gt;</span></span> { t.<span class="hljs-keyword"><span class="hljs-keyword">is</span></span>(<span class="hljs-literal"><span class="hljs-literal">undefined</span></span> ?? <span class="hljs-string"><span class="hljs-string">'default'</span></span>, <span class="hljs-string"><span class="hljs-string">'default'</span></span>); }); test(<span class="hljs-string"><span class="hljs-string">'Nullish coalescing defaults void 0'</span></span>, <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(t)</span></span></span><span class="hljs-function"> =&gt;</span></span> { t.<span class="hljs-keyword"><span class="hljs-keyword">is</span></span>(void <span class="hljs-number"><span class="hljs-number">0</span></span> ?? <span class="hljs-string"><span class="hljs-string">'default'</span></span>, <span class="hljs-string"><span class="hljs-string">'default'</span></span>); }); test(<span class="hljs-string"><span class="hljs-string">'Nullish coalescing does not default 0'</span></span>, <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(t)</span></span></span><span class="hljs-function"> =&gt;</span></span> { t.<span class="hljs-keyword"><span class="hljs-keyword">is</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span> ?? <span class="hljs-string"><span class="hljs-string">'default'</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); }); test(<span class="hljs-string"><span class="hljs-string">'Nullish coalescing does not default empty strings'</span></span>, <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(t)</span></span></span><span class="hljs-function"> =&gt;</span></span> { t.<span class="hljs-keyword"><span class="hljs-keyword">is</span></span>(<span class="hljs-string"><span class="hljs-string">''</span></span> ?? <span class="hljs-string"><span class="hljs-string">'default'</span></span>, <span class="hljs-string"><span class="hljs-string">''</span></span>); }); test(<span class="hljs-string"><span class="hljs-string">'Nullish coalescing does not default false'</span></span>, <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(t)</span></span></span><span class="hljs-function"> =&gt;</span></span> { t.<span class="hljs-keyword"><span class="hljs-keyword">is</span></span>(<span class="hljs-literal"><span class="hljs-literal">false</span></span> ?? <span class="hljs-string"><span class="hljs-string">'default'</span></span>, <span class="hljs-literal"><span class="hljs-literal">false</span></span>); });</code> </pre> <br>  From these tests it can be understood that the default values ‚Äã‚Äãare used for <code>null</code> , <code>undefined</code> and <code>void 0</code> (it is converted to <code>undefined</code> ).  In this case, the default values ‚Äã‚Äãdo not apply in cases where values ‚Äã‚Äãappear in the expression that are perceived as false, such as <code>0</code> , an empty string, and <code>false</code> . <br><br><h2>  <font color="#3AC1EF">3. Operator |&gt;</font> </h2><br>  In functional programming, there is such a thing as <a href="https://medium.com/javascript-scene/composing-software-an-introduction-27b72500d6ea">composition</a> .  This is an action representing a chaining of several function calls.  Each function accepts, as input, the output of the previous function.  Here is an example of the composition prepared by means of ordinary JavaScript: <br><br><pre> <code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doubleSay</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">str</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> str + <span class="hljs-string"><span class="hljs-string">", "</span></span> + str; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">capitalize</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">str</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> str[<span class="hljs-number"><span class="hljs-number">0</span></span>].toUpperCase() + str.substring(<span class="hljs-number"><span class="hljs-number">1</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">exclaim</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">str</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> str + <span class="hljs-string"><span class="hljs-string">'!'</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> result = exclaim(capitalize(doubleSay(<span class="hljs-string"><span class="hljs-string">"hello"</span></span>))); result <span class="hljs-comment"><span class="hljs-comment">//=&gt; "Hello, hello!"</span></span></code> </pre> <br>  This is so common that function composition facilities exist in a variety of libraries that support functional programming, for example, such as <a href="">lodash</a> and <a href="http://ramdajs.com/docs/">ramda</a> . <br><br>  Thanks to the new <a href="https://github.com/tc39/proposal-pipeline-operator">pipeline operator</a> , which looks like a combination of a vertical bar and a ‚Äúmore‚Äù ( <code>|&gt;)</code> sign, you can stop using third-party libraries and rewrite the above example as follows: <br><br><pre> <code class="hljs swift"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> result = <span class="hljs-string"><span class="hljs-string">"hello"</span></span> |&gt; doubleSay |&gt; capitalize |&gt; exclaim; result <span class="hljs-comment"><span class="hljs-comment">//=&gt; "Hello, hello!"</span></span></code> </pre> <br>  The purpose of this statement is to improve the readability of chains of function calls.  In addition, in the future, this operator will be used in the construction of partial application of functions.  Now it can be done as follows: <br><br><pre> <code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> result = <span class="hljs-number"><span class="hljs-number">1</span></span> |&gt; (<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_</span></span></span><span class="hljs-function"> =&gt;</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.max(<span class="hljs-number"><span class="hljs-number">0</span></span>, _)); result <span class="hljs-comment"><span class="hljs-comment">//=&gt; 1 let result = -5 |&gt; (_ =&gt; Math.max(0, _)); result //=&gt; 0</span></span></code> </pre> <br>  Having dealt with the basics, we will write the tests, placing them in the file <code>pipeline-operator.test.js</code> : <br><br><pre> <code class="hljs javascript"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> test <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'ava'</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">doubleSay</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">str</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> str + <span class="hljs-string"><span class="hljs-string">", "</span></span> + str; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">capitalize</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">str</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> str[<span class="hljs-number"><span class="hljs-number">0</span></span>].toUpperCase() + str.substring(<span class="hljs-number"><span class="hljs-number">1</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">exclaim</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">str</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> str + <span class="hljs-string"><span class="hljs-string">'!'</span></span>; } test(<span class="hljs-string"><span class="hljs-string">'Simple pipeline usage'</span></span>, (t) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> result = <span class="hljs-string"><span class="hljs-string">"hello"</span></span>   |&gt; doubleSay   |&gt; capitalize   |&gt; exclaim; t.is(result, <span class="hljs-string"><span class="hljs-string">'Hello, hello!'</span></span>); }); test(<span class="hljs-string"><span class="hljs-string">'Partial application pipeline'</span></span>, (t) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> result = <span class="hljs-number"><span class="hljs-number">-5</span></span>   |&gt; <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_ =&gt; </span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">Math</span></span></span></span><span class="hljs-function"><span class="hljs-params">.max(</span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params">, _</span></span></span><span class="hljs-function">)); </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">t</span></span></span><span class="hljs-function">.</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">is</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">result, </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span></span><span class="hljs-function">); }); </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">test</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'Async pipeline'</span></span></span></span><span class="hljs-function"><span class="hljs-params">, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">async</span></span></span></span><span class="hljs-function"><span class="hljs-params"> (t</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> asyncAdd = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">number</span></span></span><span class="hljs-function">) =&gt;</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Promise</span></span>.resolve(number + <span class="hljs-number"><span class="hljs-number">5</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> subtractOne = <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">num1</span></span></span><span class="hljs-function">) =&gt;</span></span> num1 - <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> result = <span class="hljs-number"><span class="hljs-number">10</span></span>   |&gt; asyncAdd   |&gt; <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">async</span></span></span></span><span class="hljs-function"><span class="hljs-params"> (num</span></span></span><span class="hljs-function">) =&gt;</span></span> subtractOne(<span class="hljs-keyword"><span class="hljs-keyword">await</span></span> num)); t.is(<span class="hljs-keyword"><span class="hljs-keyword">await</span></span> result, <span class="hljs-number"><span class="hljs-number">14</span></span>); });</code> </pre> <br>  Analyzing these tests, you can see that when using an asynchronous function declared in the pipeline using the <code>async</code> , you need to wait for the value to appear using the <code>await</code> keyword.  The point here is that the value becomes a <code>Promise</code> object.  There are several <a href="https://github.com/tc39/proposal-pipeline-operator">proposals for changes</a> aimed at supporting structures of the <code>|&gt; await asyncFunction</code> , but they have not yet been implemented and the decision on their future fate has not yet been made. <br><br><h2>  <font color="#3AC1EF">Results</font> </h2><br>  We hope you enjoyed the expected JS features to which this material is dedicated.  <a href="https://github.com/JustinDFuller/javascript-proposals-tests">Here is a</a> repository with tests that we dealt with in this material.  But for convenience, there are links to the innovations discussed here: the <a href="https://github.com/TC39/proposal-optional-chaining">operator?</a>  <a href="https://github.com/tc39/proposal-nullish-coalescing">operator ??</a>  <a href="https://github.com/tc39/proposal-pipeline-operator">operator |&gt;</a> . <br><br>  <b>Dear readers!</b>  How do you feel about the emergence of new features of JS, which we talked about? <br><br> <a href="https://ruvds.com/ru-rub/"><img src="https://habrastorage.org/files/1ba/550/d25/1ba550d25e8846ce8805de564da6aa63.png"></a> </div><p>Source: <a href="https://habr.com/ru/post/353446/">https://habr.com/ru/post/353446/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../353434/index.html">Choose Yii2 or laravel</a></li>
<li><a href="../353436/index.html">How the Internet of Things shifts analytics to the periphery</a></li>
<li><a href="../353438/index.html">Features of setting up and launching PVS-Studio in Docker using the example of Azure Service Fabric code</a></li>
<li><a href="../353440/index.html">Shine and Poverty Java for Desktop</a></li>
<li><a href="../353444/index.html">We write the plugin for Unity correctly. Part 2: Android</a></li>
<li><a href="../353448/index.html">Great, we are going to devOps-ping. So, 15 years of planning?</a></li>
<li><a href="../353458/index.html">Code generation during application operation: real examples and techniques</a></li>
<li><a href="../353460/index.html">RTCP REMB: we twist the video call settings in the browser</a></li>
<li><a href="../353462/index.html">How to get into Microsoft, Amazon or Twitter without a prestigious college diploma</a></li>
<li><a href="../353464/index.html">Online statistics in Telegram</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>