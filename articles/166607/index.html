<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>AXFR - return</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This article is about a long-known bug in the configuration of dns-servers - permission to transfer the zone to any user. And how I wrote a small scan...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>AXFR - return</h1><div class="post__text post__text-html js-mediator-article">  This article is about a long-known bug in the configuration of dns-servers - permission to transfer the zone to any user.  And how I wrote a small scanner to check the configuration of the dns servers of the most popular sites.  And where were vulnerable banks, state.  sites, providers and many other important resources. <br><br><h3>  AXFR requests </h3><br><blockquote>  DNS zone transfer, AXFR - type of DNS transaction.  It is one of the mechanisms for replicating DNS databases between servers ¬© wikipedia </blockquote><br><a name="habracut"></a><br>  When the DNS server receives an AXFR request, it sends all the data that it knows to the requested domain.  It is implied that such a request will come from the DNS server that is trying to perform a zone transfer (transfer the domain to itself, replicate).  But if the DNS server is configured incorrectly, any user can access this data. <br><br><h3>  Why is this a security bug? </h3><br>  I want to remind you about the hacking of Valve, when the hacker stole the source code for Half-Life 2 (at that time, the development cost ~ $ 1 million per month).  To begin with, the hacker sent an AXFR DNS query to the ValveSoftware.com server.  After receiving data on the domain, Gembe (hacker) received all the information, including the subdomains ValveSoftware.com. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Read more <a href="http://habrahabr.ru/post/165607/">here</a> . <br><br>  You can also read about AXFR in the Metasploit Penetration Testing Cookbook, chapter 2: <br><br><blockquote>  Authoritative records <br>  for a domain between multiple servers.  This method is responsible for transferring the primary and secondary servers.  A misconfigured DNS server can respond to your query and provide information about the queried domain. </blockquote><br><br>  <i>(I hope, already read translations from <a href="https://habrahabr.ru/users/levinkv/" class="user_link">levinkv</a> ).</i> <br><br>  Very often sites have ‚Äúsecret‚Äù subdomains (dev. *, Test. * And similar) for internal use.  Usually, these domains have an insecure configuration (included stacktrace for dev domains as an example) or features being developed. <br><br><h3>  Scanning </h3><br>  I downloaded the top popular sites according to <a href="">Alexa</a> and checked about 25k domains, ~ 2k were vulnerable.  Also I selected some sites manually.  Some of the vulnerable sites (already fixed): <br><br><ul><li>  wikipedia.org (consider that there is no bug <a href="https://gerrit.wikimedia.org/r/gitweb%3Fp%3Doperations/puppet.git%3Ba%3Dblob%3Bf%3Dtemplates/powerdns/pdns.conf.erb%3Bh%3Dbbd20e74954c842a98db3762e71b403f24370d95%3Bhb%3DHEAD">[link]</a> ); </li><li>  xda-developers.com; </li><li>  megaupload.com (closed); </li><li>  topface.com; </li><li>  liveinternet.ru (just closed my ticket marked ‚Äúdoes not require an answer‚Äù, not fixed); </li><li>  kinopoisk.ru; </li><li>  exler.ru. </li></ul><br>  And some other, very famous and large resources that I can not mention here (or there is no answer).  But some facts without naming resources: <br><br>  Hosters, parking DNS services are vulnerable.  One of the resources in this way gave me ~ 3.2mln customer records for this site (client = domain). <br><br>  Some large security companies are also vulnerable. <br><br>  Many payment systems, airline websites, banks, and providers are subject to this bug. <br><br>  I spent a lot of time reporting those.  support in this regard.  Many admins immediately ruled the configuration to be correct, but some admins do not consider this a bug (wikipedia.org as an example) and maybe they are right (but I don‚Äôt think so) and some have not responded.  It used to be that there are simply no contacts at all for communication, but <br><br><h3>  <a href="http://habrahabr.ru/post/166459/">The road to hell is paved with good intentions.</a> </h3><br>  After the next report, the response was not very pleasant communication, after which I immediately stopped scanning and sending letters to the admins. <br><br>  Funny fact.  On one of the university sites, the domain ‚Äúmuonline.NAMEOFUNIVERSITY‚Äù was found, which is the server of the popular MMORPG - MU Online (similar to WoW, LineAge2, etc.).  Waiting for statistics online on the main page of the university :) <br><div style="text-align:center;"><img src="https://habrastorage.org/storage2/727/9f7/890/7279f789035c82e517ff510e12072ba1.jpg"></div><br><br><h3>  Check your domain </h3><br>  I wrote a small service that can help in checking your domain, more precisely, its DNS servers, on their configuration to receive AXFR requests - <a href="http://sergeybelove.ru/tools/axfr-test">http://sergeybelove.ru/tools/axfr-test</a> (perhaps this will allow your resource to avoid disastrous consequences).  You can also use the dig utility to do this. <br><br><h3>  Fix? </h3><br>  Restrict IP addresses that are allowed to perform transfer zones.  Bind example: <br> <code>allow-transfer { <br> first_ip; <br> second_ip; <br> };</code> <br>  and <br> <code>rndc reconfig</code> </div><p>Source: <a href="https://habr.com/ru/post/166607/">https://habr.com/ru/post/166607/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../166597/index.html">Competition for the best scheme of the Moscow metro</a></li>
<li><a href="../166599/index.html">3D printing and Nokia Lumia 820</a></li>
<li><a href="../166601/index.html">Bypassing cycles through hard links</a></li>
<li><a href="../166603/index.html">AgileBaseCamp Conference: VALUE Driven Development, February 2nd, Kiev</a></li>
<li><a href="../166605/index.html">The Copyright Act in the digital age: the greatest legal scam in the world</a></li>
<li><a href="../166609/index.html">Is it hard to work as a programmer?</a></li>
<li><a href="../166611/index.html">ReSpeller - spelling plugin for ReSharper</a></li>
<li><a href="../166623/index.html">NIST SP800-125 translation. Full Virtualization Technology Security Guide</a></li>
<li><a href="../166625/index.html">Excel for Windows 2.x in Russian</a></li>
<li><a href="../166627/index.html">We put into practice the knowledge gained in the course An course to Interactive Programming in Python (coursera.org)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>