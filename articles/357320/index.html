<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Mass mailing of documents using 0day vulnerability in Word has begun</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The espionage campaigns used by Finspy and Latenbot used the same 0day vulnerability in Word, and the documents had the same date and time of the last...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Mass mailing of documents using 0day vulnerability in Word has begun</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/geektimes/post_images/821/325/52d/82132552dec58256ad64c90fd7cc8a9f.png"><br>  <i>The espionage campaigns used by Finspy and Latenbot used the same 0day vulnerability in Word, and the documents had the same date and time of the last edition</i> <br><br>  A few days ago, in the public domain, even before the patch was released, <a href="https://geektimes.ru/post/287934/">information about the new 0day vulnerability in Word</a> was published (in all versions for all supported operating systems).  It was reported that the vulnerability allows you to silently execute arbitrary code on the victim's computer and install malicious software through an RTF document.  Briefly described the mechanism of the malware. <br><br>  The sophisticated nature of the attack and the use of 0day in a popular product hinted that vulnerability was purposefully used against important targets, and the attack itself was carried out by hackers who were close to special services and government agencies.  So it happened. <br><a name="habracut"></a><br>  Recall that the first attacks using this 0day in January of the current year.  If <a href="https://support.office.com/en-us/article/What-is-Protected-View-d6f09ac7-e6b9-4495-8e43-2bbcdbcb6653">Office Protected View is</a> disabled in Microsoft Word, then when you open the document, the exploit starts automatically.  After this, the winword.exe process makes an HTTP request to the remote server, from where it downloads the HTA file (HTML application), disguised as an RTF document.  The HTA file is automatically launched and executes a malicious script. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/geektimes/post_images/2ed/abf/832/2edabf832e2bc6edf64ae387ae60006c.png"><br><br>  This script closes the original infected Word file, and instead it shows the user a fake text document.  The original winword.exe process closes to hide the window that OLE2Link displays from the user. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/26e/cd5/4a4/26ecd54a4b71eaccaadd6883a8a3471a.png"><br><br>  At the same time, the script downloads additional malicious code from a remote server for installation on a computer.  Using the .hta version, the exploit authors effectively bypass all the memory protection measures implemented by Microsoft, as well as anti-virus protection and most other protection methods. <br><br>  Let's just say the main thing. <br><br>  First, the vulnerability has already been assigned a number by classifier: <a href="http://www.cve.mitre.org/cgi-bin/cvename.cgi%3Fname%3DCVE-2017-0199">CVE-2017-0199</a> . <br><br>  Secondly, Microsoft finally <a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-0199">released patches</a> for MS Office 2007, 2010, 2010, 2013 and Windows Vista, 7, Server 2008, Server 2012. <br><br>  Now, FireEye experts have laid out a more detailed technical analysis in two parts ( <a href="https://www.fireeye.com/blog/threat-research/2017/04/cve-2017-0199-hta-handler.html">1</a> , <a href="https://www.fireeye.com/blog/threat-research/2017/04/cve-2017-0199_useda.html">2</a> ), so that some of the details begin to become clear. <br><br>  FireEye published information about two documents that attackers used to attack. <br><br>  FireEye has information that the vulnerability CVE-2017-0199 was used for state espionage.  This 0day was used in attacks with the delivery of old known malware Finspy and Latenbot in January and March 2017, and the last Dridex attack began after the disclosure of information about the vulnerability on April 7.  But the similarity between the implementation of these three attacks indicates that their organizers received the code from one source, writes FireEye. <br><br>  The very first of the three attacks was the attack with the delivery of Finspy, first discovered on January 25, 2017.  During the attack, a Russian-language document was circulated, allegedly under the authorship of the Ministry of Defense of the Russian Federation and published in the Donetsk People‚Äôs Republic.  The document is called "Scout Satellite". <br><br><img src="https://habrastorage.org/files/134/5e8/75a/1345e875aa6348388a11883aa3c9e0f7.png"><br><br>  When you open the document SPUTNIK SPETNIK.doc (MD5: c10dabb05a38edd8a9a0ddda1c9af10e), an exploit was launched that already downloaded the payload from the IP address 95.141.38.110, including the Finspy trojan.  It had universal functionality: searching for documents on a disk, listening to Skype conversations, etc. In addition to the Trojan, a dummy document was downloaded that was shown to the victim instead of the original one. <br><br>  FireEye was unable to determine the target of the attack, but the company stresses that the Finspy tool was sold by the Gamma Group to customers from different countries.  At the same time, almost simultaneously, the 0day-vulnerability was used to spread the <a href="https://www.fireeye.com/blog/threat-research/2015/12/latentbot_trace_me.html">Latentbot malware</a> .  The organizers of both attacks received the code probably from the same source, as indicated by the same date and time of the last edition of the malicious documents used in both campaigns: 2016-11-27 22:42:00 (see the screenshot at the beginning of the article). <br><br>  After the information about 0day came into open access, someone started a spam campaign, distributing infected documents in large quantities.  In this case, the malware Dridex is installed on the infected computers.  The spam campaign continues to the present, so do not be surprised if you receive an email with an attachment in RTF or DOC format (there will still be an RTF document inside). </div><p>Source: <a href="https://habr.com/ru/post/357320/">https://habr.com/ru/post/357320/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../357310/index.html">WikiLeaks uncovered the method used by the CIA to conceal the country of origin of spyware malware</a></li>
<li><a href="../357312/index.html">The Shadow Brokers Group has published new NSA exploits</a></li>
<li><a href="../357314/index.html">In Dallas, an hour and a half could not turn off 156 sirens of civil defense</a></li>
<li><a href="../357316/index.html">Arrested tor exit-node operator in Russia</a></li>
<li><a href="../357318/index.html">DoS attack on the MikroTik line of equipment and virtual RouterOS</a></li>
<li><a href="../357322/index.html">Chrome 58 will patch protection against homographic attacks</a></li>
<li><a href="../357324/index.html">The raid on Russian hackers began</a></li>
<li><a href="../357326/index.html">Evgeny Kaspersky can go on the settlement agreement with Microsoft</a></li>
<li><a href="../357328/index.html">Titanium's young load server operator got two years in prison</a></li>
<li><a href="../357330/index.html">Google Chrome will continue to ‚Äútighten the screws‚Äù (from October)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>