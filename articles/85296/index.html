<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Check grammar Open Office in your WEB-application</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In projects where you need to process a lot of multilingual content, it is almost impossible to do without a good grammar checker. Writing each module...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Check grammar Open Office in your WEB-application</h1><div class="post__text post__text-html js-mediator-article"><img src="http://tastyoptions.net/images/Open%20Office%20Logo.png" align="left" alt="image">  In projects where you need to process a lot of multilingual content, it is almost impossible to do without a good grammar checker.  Writing each module for a particular language will take a lot of time and money.  Moreover, it is necessary to understand the language very well, to be a linguist and at the same time to relate the language to mathematical formulas.  The task is not easy.  In this case, an effective method would be to take a ready-made solution and integrate it into the application.  How to do this in a simple way, using the tools of Open Office, I will discuss in this article. <br><a name="habracut"></a><br><br>  To begin with, let's try to figure out what the grammar packages in OO actually consist of.  As an example, let's look at the Russian grammar files.  From the site of OO we download the archive with the grammar language pack.  Inside the archive we will find three files: readme.txt, ru_RU.dic, ru_RU.aff.  Everything is clear with the Readme - you can read it if necessary.  The file with the dic extension is a dictionary with words that are found in Russian.  Naturally, there are not all the words, and it will need to be replenished.  The second file with the AFF extension is a grammar file.  The format of this file will be either MySpell or Aspell.  In any case, it is suitable for our module. <br><br>  Now that we have dealt with the formats of these files, let's proceed to the module itself.  For it, we need the Hunspell API, which can be found in the link at the bottom of the article.  The API is written by another developer and is suitable for the most primitive grammar checker.  We will write in Java.  For tests, we will write a simple servlet that will receive the word as a parameter, check it, and return the corrected result to us if the word is incorrectly written.  There are a lot of articles written on how to create a WEB application in the Java environment, so we will not dwell on this.  We start immediately with the most important thing.  Let's make a small form consisting of an input field and a button: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> &lt;html&gt;
     &lt;head&gt;
         &lt;meta http-equiv = "Content-Type" content = "text / html; charset = UTF-8"&gt;
         &lt;title&gt; JSP Page &lt;/ title&gt;
     &lt;/ head&gt;
     &lt;body&gt;
         &lt;form method = "POST" action = "http: // localhost: 8080 / SpellChecker / spellChecker"&gt;
             &lt;input type = "text" name = "input" /&gt;
             &lt;input type = "submit" name = "submit" /&gt;
         &lt;/ form&gt;
     &lt;/ body&gt;
 &lt;/ html&gt;
</pre><br><br>  Now, let's do the servlet itself.  In the servlet, we will receive data from the form, send it to the Hunspell library, process the response, and send it back to the form.  Consider the methods that will do this: <br><br><pre> 1. protected void processRequest (HttpServletRequest request, HttpServletResponse response)
 2. throws ServletException, IOException {
 3. response.setContentType ("text / html; charset = UTF-8");
 4. PrintWriter out = response.getWriter ();
 5. try {
 6. String input = request.getParameter ("input");
 7. List &lt;String&gt; list = check (input);
 8. request.setAttribute ("output", list);
 9. Iterator iter = list.iterator ();
 10. while (iter.hasNext ()) {
 11. out.println ((String) iter.next ());
 12. }
 13.
 14.} finally {
 15. out.close ();
 sixteen. }
 17.}
</pre><br><br>  Consider everything in stages: <br>  1 and 2 lines declare the function that processes the request.  On the 3rd line in the answer, we put that the type of the result will be an HTML page encoded with UTF-8 in order to avoid misunderstandings with special characters (signs).  Next, on line 4, initialize the container to display the data, and open the stream.  Here the fun begins.  The parameter, located on the 6th line, contains the input data, ie the word that needs to be checked for grammar.  We pass it to the check function (String string), which we will analyze later.  In short, I will say that this function checks our word for errors, and provides a list with corrections as an answer.  After that, we iterate over the list of fixes (line 9-12), and output this list to the stream, that is, display the list on the screen.  On line 15 we close the stream. <br><br><pre>
 1.public List &lt;String&gt; check (String input) {
 2. List &lt;String&gt; list = new ArrayList ();
 3. List &lt;String&gt; stemList = new ArrayList ();
 4. try {
 5. String newInput = "";
 6. if (input! = Null) {
 7. newInput = new String (input.getBytes ("ISO-8859-1"), "UTF-8");
 eight. }
 9. Hunspell hunspell = Hunspell.getInstance ();
 10. Dictionary dict = hunspell.getDictionary ("ru-RU");
 11. if (dict.misspelled (newInput)) {
 12. list = dict.suggest (newInput);
 13.} else {
 14. list.add (newInput);
 15. }
 sixteen.
 17.} catch (FileNotFoundException ex) {
 18. Logger.getLogger (spellChecker.class.getName ()). Log (Level.SEVERE, null, ex);
 19.} catch (UnsupportedEncodingException ex) {
 20. Logger.getLogger (spellChecker.class.getName ()). Log (Level.SEVERE, null, ex);
 21.}
 22. list.addAll (stemList);
 23. return list;
 24.}
</pre><br><br>  And here is the function check (String string).  On lines 2 and 3 we make two new lists.  We will insert the final result into the first one, and use the second one as a temporary buffer.  Lines 5-8 encode our request in UTF-8, because the dictionary understands only this encoding.  On the 9th line we initialize Hunspell, and on 10 we indicate which dictionary we will use.  In this case, it is a Russian dictionary.  The grammar checker files (ru_RU.dic, ru_RU.aff) must be in the same directory as the program, so let's not forget to transfer them there.  Next (line 11) is checking whether the word is spelled correctly.  If the word is written incorrectly (11-13), then we get the results of how to correctly write this word.  If the word is written correctly (13-15), then we return it back.  Everything is extremely simple and brief.  Lines 17 through 21 are error handlers.  The first processing (FileNotFoundException) goes to the absence of grammar files, and the second (UnsupportedEncodingException) refers to the function that encodes our request in UTF-8, and processes the support of the encoding.  On the 22nd line we transfer everything from the temporary buffer (stemList) to the result (list), and on the 23rd line we return it. <br><br>  Let me remind you once again that you need to transfer the AFF and DIC files to the folder with the application, so that the program can use them.  If this cannot be done, then you can specify the full path to the dictionary in line 10.  The extension does not need to be specified. <br><br>  If desired, this servlet can be converted into a small service that will communicate via XML.  Connect to it more languages ‚Äã‚ÄãHunspell, which are free, and are constantly replenished.  Also, you can connect the language recognition library, which I will discuss in the next article. <br><br>  Now I will share with you links where you can take all this stuff: <br>  Hunspell API - <a href="http://dren.dk/hunspell.html">dren.dk/hunspell.html</a> <br>  OpenOffice dictionaries - <a href="http://wiki.services.openoffice.org/wiki/Dictionaries">wiki.services.openoffice.org/wiki/Dictionaries</a> <br><br>  Also, dictionaries can be found on the pages of developers.  There they are much "fresher". </div><p>Source: <a href="https://habr.com/ru/post/85296/">https://habr.com/ru/post/85296/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../85287/index.html">Multi-modular extension cord from Soon Mo Kang</a></li>
<li><a href="../85289/index.html">Russian equipment. Part 4. Review</a></li>
<li><a href="../85292/index.html">Windows 7 crashes before installing on a computer!</a></li>
<li><a href="../85293/index.html">Sterility must be reliable.</a></li>
<li><a href="../85295/index.html">Silicon Valley is dedicated</a></li>
<li><a href="../85297/index.html">Kindle Waterproof Case</a></li>
<li><a href="../85298/index.html">Download Google Docs without a browser</a></li>
<li><a href="../85300/index.html">The underwater world of the Internet or where they drown optics in the world's oceans</a></li>
<li><a href="../85301/index.html">LaTeX + Diploma</a></li>
<li><a href="../85303/index.html">Window to the world</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>