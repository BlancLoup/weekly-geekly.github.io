<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>uLogin on the ASP.Net website</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It took a few days ago to tie uLogin to the asp.net site, but on the move to find the finished code somehow did not work. Definitely someone will face...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>uLogin on the ASP.Net website</h1><div class="post__text post__text-html js-mediator-article">  It took a few days ago to tie uLogin to the asp.net site, but on the move to find the finished code somehow did not work.  Definitely someone will face this issue ... <br><br><a name="habracut"></a><br>  On my choice whether to use uLogin (a <a href="http://habrahabr.ru/post/130893/">review on Habr√©</a> ) in my projects were affected by <a href="http://www.liveinternet.ru/rating/ru/month.html">some numbers</a> .  We will not go into the credibility of the resource, for me, for some reason, that was enough.  The service is quite simple and conveniently made - you specify the address of your site, select the buttons of the required authorization providers and get a couple of pieces of code that need to be placed on your site.  If the html code doesn‚Äôt particularly depend on what the site is created on, then the proposed php code somehow didn‚Äôt fit me.  The result was what turned out :) <br><br>  I placed the resulting html on the master page of the site. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">script</font> <font color="#ff0000">src</font> <font color="#0000ff">="http://ulogin.ru/js/ulogin.js"</font> <font color="#0000ff">&gt;&lt;/</font> <font color="#800000">script</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">div</font> <font color="#ff0000">id</font> <font color="#0000ff">="uLogin"</font> <font color="#ff0000">x-ulogin-params</font> <font color="#0000ff">="display=small;optional=email,sex;fields=first_name,last_name,photo;providers=vkontakte,facebook,twitter,odnoklassniki,google;hidden=yandex,mailru,livejournal,openid,liveid;redirect_uri=http%3A%2F%2Fmysite.ru%2Fauth.aspx"</font> <font color="#0000ff">&gt;&lt;/</font> <font color="#800000">div</font> <font color="#0000ff">&gt;</font></font> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <ol><li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">&lt;</font> <font color="#800000">script</font> <font color="#ff0000">src</font> <font color="#0000ff">="http://ulogin.ru/js/ulogin.js"</font> <font color="#0000ff">&gt;&lt;/</font> <font color="#800000">script</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">div</font> <font color="#ff0000">id</font> <font color="#0000ff">="uLogin"</font> <font color="#ff0000">x-ulogin-params</font> <font color="#0000ff">="display=small;optional=email,sex;fields=first_name,last_name,photo;providers=vkontakte,facebook,twitter,odnoklassniki,google;hidden=yandex,mailru,livejournal,openid,liveid;redirect_uri=http%3A%2F%2Fmysite.ru%2Fauth.aspx"</font> <font color="#0000ff">&gt;&lt;/</font> <font color="#800000">div</font> <font color="#0000ff">&gt;</font> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="black"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">&lt;</font> <font color="#800000">script</font> <font color="#ff0000">src</font> <font color="#0000ff">="http://ulogin.ru/js/ulogin.js"</font> <font color="#0000ff">&gt;&lt;/</font> <font color="#800000">script</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">div</font> <font color="#ff0000">id</font> <font color="#0000ff">="uLogin"</font> <font color="#ff0000">x-ulogin-params</font> <font color="#0000ff">="display=small;optional=email,sex;fields=first_name,last_name,photo;providers=vkontakte,facebook,twitter,odnoklassniki,google;hidden=yandex,mailru,livejournal,openid,liveid;redirect_uri=http%3A%2F%2Fmysite.ru%2Fauth.aspx"</font> <font color="#0000ff">&gt;&lt;/</font> <font color="#800000">div</font> <font color="#0000ff">&gt;</font> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></font></code> </li> </ol> <code><font color="gray"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">script</font> <font color="#ff0000">src</font> <font color="#0000ff">="http://ulogin.ru/js/ulogin.js"</font> <font color="#0000ff">&gt;&lt;/</font> <font color="#800000">script</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">div</font> <font color="#ff0000">id</font> <font color="#0000ff">="uLogin"</font> <font color="#ff0000">x-ulogin-params</font> <font color="#0000ff">="display=small;optional=email,sex;fields=first_name,last_name,photo;providers=vkontakte,facebook,twitter,odnoklassniki,google;hidden=yandex,mailru,livejournal,openid,liveid;redirect_uri=http%3A%2F%2Fmysite.ru%2Fauth.aspx"</font> <font color="#0000ff">&gt;&lt;/</font> <font color="#800000">div</font> <font color="#0000ff">&gt;</font></font> * This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  The address redirect_uri indicates where the user will be sent (with the uLogin token) after he passes authorization through the provider he chooses.  Having received token, you need to go to uLogin and ask for information about the user. <br><br><blockquote><ol><li>  <font color="#0000ff">string</font> link = <font color="#0000ff">string</font> .Format ( <font color="#A31515">"http://ulogin.ru/token.php?token={0}&amp;host={1}"</font> , Request.Form [ <font color="#A31515">"token"</font> ], </li><li>  Request.ServerVariables [ <font color="#A31515">"SERVER_NAME"</font> ]); </li><li></li><li>  WebRequest reqGET = WebRequest.Create (link); </li><li>  <font color="#0000ff">string</font> answer = <font color="#A31515">""</font> ; </li><li></li><li>  <font color="#0000ff">using</font> (WebResponse resp = reqGET.GetResponse ()) </li><li>  { </li><li>  <font color="#0000ff">using</font> ( <font color="#2B91AF">Stream</font> stream = resp. GetResponseStream ()) </li><li>  { </li><li>  <font color="#0000ff">if</font> (stream! = <font color="#0000ff">null</font> ) </li><li>  <font color="#0000ff">using</font> (StreamReader sr = <font color="#0000ff">new</font> StreamReader (stream)) </li><li>  { </li><li>  answer = sr.ReadToEnd (); </li><li>  } </li><li>  } </li><li>  } </li></ol></blockquote><br><br>  In response, we get a jSON string, which I decided to part with as follows: <br><br><blockquote><ol><li>  <font color="#0000ff">public</font> <font color="#0000ff">class</font> JSONHelper </li><li>  { </li><li>  <font color="#0000ff">public</font> <font color="#0000ff">static</font> T Deserialise &lt;T&gt; ( <font color="#0000ff">string</font> json) </li><li>  { </li><li>  T obj = Activator. CreateInstance &lt;T&gt; (); </li><li>  <font color="#0000ff">using</font> (MemoryStream ms = <font color="#0000ff">new</font> MemoryStream ( <font color="#2B91AF">Encoding</font> .Unicode.GetBytes (json))) </li><li>  { </li><li>  DataContractJsonSerializer serialiser = <font color="#0000ff">new</font> DataContractJsonSerializer (obj.GetType ()); </li><li>  obj = (T) serialiser.ReadObject (ms); </li><li>  } </li><li>  <font color="#0000ff">return</font> obj; </li><li>  } </li><li>  } </li><li></li><li>  <font color="#0000ff">public</font> <font color="#0000ff">class</font> iUser </li><li>  { </li><li>  <font color="#0000ff">public</font> <font color="#0000ff">string</font> Network { <font color="#0000ff">get</font> ;  <font color="#0000ff">set</font> ;  } </li><li>  <font color="#0000ff">public</font> <font color="#0000ff">string</font> Uid { <font color="#0000ff">get</font> ;  <font color="#0000ff">set</font> ;  } </li><li>  <font color="#0000ff">public</font> <font color="#0000ff">string</font> FirstName { <font color="#0000ff">get</font> ;  <font color="#0000ff">set</font> ;  } </li><li>  <font color="#0000ff">public</font> <font color="#0000ff">string</font> LastName { <font color="#0000ff">get</font> ;  <font color="#0000ff">set</font> ;  } </li><li>  <font color="#0000ff">public</font> <font color="#0000ff">string</font> Email { <font color="#0000ff">get</font> ;  <font color="#0000ff">set</font> ;  } </li><li>  <font color="#0000ff">public</font> <font color="#0000ff">string</font> Sex { <font color="#0000ff">get</font> ;  <font color="#0000ff">set</font> ;  } </li><li></li><li>  <font color="#0000ff">public</font> <font color="#0000ff">override</font> <font color="#0000ff">string</font> ToString () </li><li>  { </li><li>  <font color="#0000ff">return</font> <font color="#0000ff">string</font> .Format ( <font color="#A31515">"network = {0}, uid = {1}, first_name = {2}, last_name = {3}"</font> , Network, Uid, FirstName, LastName); </li><li>  } </li><li>  } </li></ol></blockquote><br><br>  You can ask <a href="http://ulogin.ru/faq.html">several other attributes for</a> uLogin.  I added some to the optional parameter so as not to upset the user with unnecessary questions (let‚Äôs enter the email address if the provider cannot transfer it) <br><br>  It remains to deserialize: <br><br><blockquote><ol><li>  iUser usr = JSONHelper.Deserialise &lt;iUser&gt; (answer); </li></ol></blockquote><br><br>  Well, then everyone decides for himself what to do with the data obtained.  As an example - put yourself in the database and send the user a cookie with a token for authorization on the site. <br><br>  I tested on my accounts.  Maybe more extensive use will be able to identify existing bugs. <br>  I hope that the decision was not only short, but also useful. </div><p>Source: <a href="https://habr.com/ru/post/142631/">https://habr.com/ru/post/142631/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../142624/index.html">+1 extension for google chrome</a></li>
<li><a href="../142625/index.html">EDS in the browser: problems, solutions, personal experience</a></li>
<li><a href="../142626/index.html">Boundaries that lead to unlimited success</a></li>
<li><a href="../142627/index.html">LINQ extensions for Azure Table Storage that implement Or and Contains</a></li>
<li><a href="../142630/index.html">The author of "John the Ripper" will speak at PHDays 2012</a></li>
<li><a href="../142632/index.html">LINQ to Objects in C ++</a></li>
<li><a href="../142633/index.html">Remote control over servers. Problem solved. All DRAC!</a></li>
<li><a href="../142637/index.html">Image to URI, easy way to convert</a></li>
<li><a href="../142639/index.html">Sony Interactive Projector</a></li>
<li><a href="../142640/index.html">jQuery plugin for playing music from youtube</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>