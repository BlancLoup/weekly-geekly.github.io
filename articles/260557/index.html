<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>XARA vulnerabilities in OS X and iOS</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today a report was published by a group of information security specialists devoted to the study of attacks based on the ways of communicating with ea...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>XARA vulnerabilities in OS X and iOS</h1><div class="post__text post__text-html js-mediator-article">  Today a report was published by a group of information security specialists devoted to the study of attacks based on the ways of communicating with each other various applications on OS X and iOS - <i>(XARA, from Cross-App Resource Access)</i> .  For those who are too lazy to read <a href="https://drive.google.com/file/d/0BxxXk1d3yyuZOFlsdkNMSGswSGs/view">all 26 pages of the original article</a> , I decided to prepare a short review of it. <br><br>  For a start, two short points: <br><ul><li>  First, most of the publicly disclosed vulnerabilities concern OS X. Everything is much calmer in iOS. </li><li>  Secondly, everything is actually quite sad. </li></ul><br><a name="habracut"></a><br>  And now more about the vulnerabilities: <br><br>  <b>1. Interception of data transmitted via URL schemes.</b> <br>  In iOS (as well as in OS X), applications can communicate with each other through URL schemes.  What it looks like: <br>  As an example, let us take a situation where an e-mail <i>arriving</i> at our favorite mobile email <i>service, BlaBalPochta</i> , contains an address.  Our mailer is smart enough, and when you click on this address, it <i>pushes the</i> user to, say, the <i>BlaBlaKarta</i> navigation application.  The only way to implement such a transition in iOS is to call the following link in the first application: <br>  <i><b>blablamaps: // 55,678 + 32,432</b></i> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The system picks up a call to such a URL and checks which of the installed applications can handle it.  If such an application is found, then a transition occurs, and the opened program itself decides how to deal with the data (in our case, the coordinates). <br><br>  All the fun begins when not one, but two applications declare that they work with a URL of this kind.  The authors identified the following operating system rules: <br><ul><li>  OSX will transfer the user to the application that <b>first declared</b> that it works with this scheme. </li><li>  iOS will transfer the user to the application that <b>last stated</b> that it works with this scheme. </li></ul><br>  The curious point is that, unlike the same Android, the user is not given the choice of which of the applications should open.  There are no additional authentication mechanisms, nothing. <br><br>  Thus, the vulnerability is exploited as follows: <br>  We create our application, <i>BlaBlaHijack</i> , in whose properties we indicate the ability to process <i>blablamaps</i> URL scheme, and give it to the user.  Unlike <i>BlaBlaMaps</i> , our malware will not open the map, but simply send these coordinates to our server. <br><br>  The same scheme works with any data transmitted between applications - for example, tokens received during authorization via Facebook or Twitter. <br><br>  The weak link of such schemes usually lies in the method of transferring the malicious program to the attacked user.  What is especially remarkable is that Apple does not maintain any common directory of URL schemes, so this application <b>will quietly be moderated</b> and will be available for download. <br><br>  <b>2. Modify keychain permissions on OS X</b> <br>  Unlike iOS, each of the properties stored in Keychain on OS X can be assigned additional access rights (Access Control List), which will list which applications are granted access to it.  We illustrate the vulnerabilities associated with this mechanism on the next members of the <i>BlaBlaSoftware</i> family. <br><br>  A user downloads a very popular application from the Mac App Store, <i>BlaBlaBook</i> is a hipster social network.  Like any other decent application, when entering authorization data, it tries to save them to Keychain.  And here another mechanism comes into effect - before creating a new record, the system will check if there is already a record in the keyring with such parameters.  This is done so that when updating software, user data does not fly.  If such a record is found, its contents will be overwritten, if not, a new one will be created.  And if in the second case the ACL is set by the <i>BlaBlaBook</i> application, then in the first case - the ACL will not change. <br><br>  So, back to the vulnerability.  The day before installing <i>BlaBlaBook, the</i> user downloaded another application, <i>BlaBlaHijacker</i> , already mentioned by us.  This malware first added an entry to Keychain with the same parameters that are required by the original application, and added all the rights in the ACL.  Thus, when a user tries to save his password, two applications already have access to it - <i>BlaBlaBook</i> and <i>BlaBlaHijacker</i> . <br>  Interestingly, the malicious application does not have to be installed first - any third-party application has the ability to delete a specific entry in Keychain and rewrite it with its own. <br><br>  <b>3. Access to the sandbox</b> <br>  It is well known that all applications in OS X work within their sandbox and do not have access to other programs.  These sandboxes are represented in the file system by folders named with the unique identifier of the application.  Mac App Store when checking all published programs checks this ID for uniqueness, therefore, it would seem, there should be no repetitions. <br><br>  It is difficult to include additional subroutines in the original application - helpers, frameworks, whatever, which has its own Bundle ID.  Each of these routines runs in its sandbox.  The vulnerability lies in the fact that Apple does not check for the uniqueness of the identifiers of these helpers - as a result of which two different applications can work in the same sandbox and get full access to each other's data. <br><br>  This vulnerability is best demonstrated by the <a href="https://discussions.agilebits.com/discussion/comment/212590/">case of the popular 1Password password manager and its 1Password Mini extension</a> . <br><br>  <b>4. WebSocket communication vulnerabilities</b> <br>  In short, WebSocket is a protocol through which a server can communicate with a client.  It is integrated as part of the HTML5 standard, and allows WebView content in the browser to access any other application in the system, passing data through a specific TCP port.  And, of course, there is no authentication, and in this case, anyone can listen to this port.  The extension in the browser can not check with whom exactly it communicates. <br><br>  Example exploitation of vulnerabilities - as in the previous case, <i>1Password</i> .  Its browser extension collected the user-entered passwords and credit card numbers in various forms, and sent them to the application through port 6263.  Further actions are simple - we write a program that listens to the same port, logs all the data, and collect a good database.  Again, all this is quietly tested in the App Store. <br><br>  Apple has been aware of all the mentioned vulnerabilities since last fall - and, according to information from the report, it takes at least six months to fix these vulnerabilities. <br><br>  Once again I will mention that iOS concerns only the first of the considered vulnerabilities. <br><br>  <b>Useful links:</b> <br><ul><li>  <a href="https://drive.google.com/file/d/0BxxXk1d3yyuZOFlsdkNMSGswSGs/view">Original report</a> (required reading, seriously) </li><li>  <a href="https://discussions.agilebits.com/discussion/comment/212590">Discussion on the 1Password forums</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/260557/">https://habr.com/ru/post/260557/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../260543/index.html">How to pass "test free data recovery software" (part 1)</a></li>
<li><a href="../260545/index.html">The guys who make the talking robot for a smart home, distribute fees</a></li>
<li><a href="../260547/index.html">The best usability solutions for online shopping: we make the client happy</a></li>
<li><a href="../260549/index.html">4 scripts to handle the most complex Email from clients</a></li>
<li><a href="../260553/index.html">Sending Nginx logs to Google Analytics</a></li>
<li><a href="../260559/index.html">AngularJS directive for remembering e-mail</a></li>
<li><a href="../260561/index.html">ECMAScript 2015 official release</a></li>
<li><a href="../260565/index.html">TEETH based on Intel Edison will find a way to motivate you to brush your teeth and send a report to the cloud</a></li>
<li><a href="../260569/index.html">Jii: Active Record for Node.js with API from Yii 2</a></li>
<li><a href="../260571/index.html">ECMAScript 2015 Specification Approved</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>