<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We did you mean part two</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello 

 Not so long ago I wrote about the correct did you mean . 
 Despite all my improvements, guess-ing still often was wrong, and gave out strange...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We did you mean part two</h1><div class="post__text post__text-html js-mediator-article"><h2>  Hello </h2><br><img src="http://zame-dev.org/pub/search-guess-demo-new/img/search-guess-illust.png" align="left"><br>  Not so long ago I wrote about the <a href="http://restorer.habrahabr.ru/blog/41090.html">correct did you mean</a> . <br>  Despite all my improvements, guess-ing still often was wrong, and gave out strange results. <br><br>  However, recently, I managed to significantly improve the quality of guess-inga, and I decided that it would be nice to write a ‚Äúpatch‚Äù to my previous article :) <br><br><br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  Pre-intro </h2><br>  Anticipating in advance the accusations of doing unnecessary work in our age (‚Äúwhy do we need all this if there is aspell / lucene / substitute to taste‚Äù), <br>  I will also answer in advance that: <br><ol><li>  Lucene / SpellChecker is far from perfect, and in some cases loses to my solution </li><li>  Aspell is good, but Aspellov suggest-ing, being written in php, inhibits godlessly </li></ol><br><br><br><h2>  Ingredients </h2><br>  Everything is designed for PHP4 / PHP5 + MySQL <br><br><br><h2>  Bug work </h2><br>  Problem number one is the selection of the initial array of words.  In the previous version, I used soundex for this purpose, but the result did not suit me at all, because along with the words <br>  having a chance to be the right result, the words were chosen completely far from the result. <br><br>  The second problem is the very function of determining the distance between words.  The function used by me in the previous version works, of course, better than the editing distance (like <br>  Levenshtein distance), but still for some cases works just the same magic way. <br><br><br><h2>  Selection of the initial array of words </h2><br>  Unlike the first time, when it was necessary to quickly give out something working, the second time was more time, so I decided to smoke a materiel in the form of a wiki and various <br>  open source programs with suggesting function.  As a result, a search based on n-gram was chosen. <br><br>  Those who wish to enrich themselves with knowledge, I suggest to proceed to <a href="http://en.wikipedia.org/wiki/N-gram">Wikipedia</a> , but I still tell you very briefly: <br>  n-gram is a n-character substring.  For example, for the stock line you can select 2 x 4-gram: stoc and tock (as well as 3 x 3-gram-a and 4 x 2-gram-a). <br><br>  Ideally, each n-gram should be represented as a vector in n-dimensional space, and the distance between them should be calculated using the scalar product of these vectors, <br>  but in order to do this, it is necessary to do it (I have not found ready-made solutions).  And do laziness.  As a result, I stopped at the solution applied in SpellChecker (plugin for Lucene). <br><br>  Create a table for the indices (suppose it is called <b>guess_index</b> ), with the following fields: <br><blockquote>  <b>id</b> - what about without it <br>  <b>word</b> - the word itself <br>  <b>gram1</b> - 1- <b>grames</b> (n-grames inside fields are separated by spaces) <br>  <b>gram2</b> - 2-gram <br>  <b>gram3</b> - 3-gram <br>  <b>gram4</b> - 4-gram <br></blockquote><br>  To search for possible options, we divide the search word into n-grames, and find all the records with matching n-grames in the corresponding fields. <br>  Example for the word <b>bakc</b> : <br><blockquote>  <b>1-gram:</b> bakc <br>  <b>2-gram:</b> ba ak kc <br>  <b>SQL:</b> WHERE gram1 LIKE '% b%' OR gram1 LIKE '% a%' OR gram1 LIKE '% k%' OR gram1 LIKE '% c%' OR gram2 LIKE '% ba%' OR gram2 LIKE '% ak%' OR gram2 LIKE '% kc%' <br></blockquote><br>  Further, for all the found words, we calculate their rating: each n-gram-a match adds a point to the result, the starting n-gram-a match - 3 points, the final one - 2 points. <br>  Then we normalize the result by dividing it by the minimum of the number of n-gram-s in the desired word and the number of n-gram-s in the word from the base <br>  (it may be worth dividing by the maximum, but for my case the minimum gives the best results). <br><br>  All this can be seen in the function of the function of the file <a href="http://zame-dev.org/pub/search-guess-demo-new/view-code.php%3Ffile%3Dincl%252Fsearch_guess.php">search_guess.php</a> <br><br><br><br><h2>  We get the result </h2><br>  To begin with, sort the resulting array of words by rating and, sparing nothing, we‚Äôll erase half (the words with a low rating are unlikely to be the desired ones, but <br>  in the result due to the magic in words_dist). <br><br>  Ideally, the function words_dist should consider: <br><ol><li>  The number of extra / missing letters, and non-linear (the more mistakes there are, the more likely it is that another word was meant). </li><li>  Change letters in places.  Again, the greater the distance between the exchange letters, the more likely it is that another word was meant. </li><li>  Do not confuse clerks (incorrect letters in the same place) with changing letters in places. </li><li>  For all the preceding paragraphs, consider the possibility of such an error when typing on the keyboard (the distance from the typed letter to the desired letter on the keyboard). </li><li>  The word rating obtained by n-gram search. </li></ol><br>  But as a result, I just modified the previous version :) (see the function words_dist from the file <a href="http://zame-dev.org/pub/search-guess-demo-new/view-code.php%3Ffile%3Dincl%252Fsearch_guess.php">search_guess.php</a> ), <br>  but he became better honestly :) <br><br><br><br><h2>  Exceptions </h2><br>  However sad it may sound, some words are simply impossible to find with the help of such an implementation of n-gram search, for example, ma <b>gr</b> in - margin. <br>  Currently, the best way out of the situation (the result / amount of time spent on implementation) I consider the exception table, which will be listed <br>  pairs of the wrong word / correct word. <br><br><br><h2>  Demo </h2><br>  I invite you to <a href="http://zame-dev.org/pub/search-guess-demo-new/">try out the work</a> "guessing" :) <br><br><br><h2>  Conclusion </h2><br>  The year will soon be 2009, and on many sites and forums (especially forums) there is still a poorly understood search (or nonexistent).  I hope my articles <br>  will help to bring the quality of search to the search giants a bit :) <font color="#AAAAAA">(well, or, if it‚Äôs really lazy to do, Google Custom Search is a good way out)</font> <br><br>  Link to the topic: <a href="http://habrahabr.ru/blog/webdev/24953.html">Yandex-like search do it yourself</a> . <br><br><br></div><p>Source: <a href="https://habr.com/ru/post/26966/">https://habr.com/ru/post/26966/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../269649/index.html">Accelerate OSB</a></li>
<li><a href="../26965/index.html">Gmail Superstars: Mail Sort</a></li>
<li><a href="../269651/index.html">0xDBE 1.0 Preview available</a></li>
<li><a href="../269657/index.html">NoSQL era behind</a></li>
<li><a href="../269659/index.html">We write own gateway for Thrift API</a></li>
<li><a href="../269661/index.html">The basic structure of the module Magento [Magento Certification]</a></li>
<li><a href="../269663/index.html">Vulnerabilities in Plategka.com service including XSS</a></li>
<li><a href="../269665/index.html">Pixar's 22 storytelling rules</a></li>
<li><a href="../269667/index.html">Java evolution by reading lines from a file</a></li>
<li><a href="../269669/index.html">Brilliance and Poverty HTML5 - Access to Sensors</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>