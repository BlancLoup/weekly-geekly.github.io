<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Security Week 14: ShadowHammer and supply chain</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The main news of last week is a targeted attack on Asus device owners through the hacked Asus Live Update utility. Researchers at Kaspersky Lab discov...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Security Week 14: ShadowHammer and supply chain</h1><div class="post__text post__text-html js-mediator-article">  The main news of last week is a targeted attack on Asus device owners through the hacked Asus Live Update utility.  Researchers at Kaspersky Lab discovered an attack in January of this year: an infected <a href="https://www.asus.com/ph/support/FAQ/1009776/">utility</a> for updating drivers on laptops and computers with Asus components was signed with a legitimate certificate and distributed from the manufacturer‚Äôs servers.  Modification of the utility provided hackers with full access to all affected systems, but they used this opportunity only when the MAC address of one of the network adapters of the system coincided with the list of systems of interest. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/md/6g/rq/md6grqh8rixw6n73ixw1z4gzdsc.png"></div><br>  In this case, an additional malware was downloaded from a server created in March 2018 and stopped working before an attack was detected - for the time being with unknown targets.  The attack is remarkable both for its complexity and secrecy.  Most likely, it was preceded by more large-scale events in order to gather information and identify ‚Äúpromising‚Äù victims.  Although it is too early to talk about the exact attribution of the attack, there are data linking it with earlier incidents with the 2017 <a href="https://threatpost.ru/zloumyshlenniki-sobirali-dannye-cherez-ccleaner/22340/">CCleaner</a> utility.  The full attack study will be published next week and presented at the <a href="https://sas.kaspersky.com/">Security Analyst Summit</a> conference at Kaspersky Lab.  In this post - a brief description of the incident and some conclusions. <br><a name="habracut"></a><br>  Original sources: <a href="https://threatpost.ru/asus-shadowhammer-apt-campaign-god-what-a-mess/31998/">news</a> , <a href="https://securelist.com/operation-shadowhammer/89992/">excerpts</a> from the Kaspersky Lab study, a detailed article on <a href="https://motherboard.vice.com/en_us/article/pan9wn/hackers-hijacked-asus-software-updates-to-install-backdoors-on-thousands-of-computers">Motherboard</a> , an official <a href="https://www.asus.com/News/hqfgVUyZ6uyAyJe1">statement</a> from Asus.  You can check the MAC address of your Asus device using <a href="https://shadowhammer.kaspersky.com/">this</a> online service. <br><br><h2>  What happened </h2><br>  From June to November 2018, an infected version of Asus Live Update was heard from Asus servers.  The program is pre-installed on laptops from this manufacturer, but is also available for owners of computers based on Asus motherboards.  It allows you to download the latest BIOS, firmware and device drivers and install them automatically.  The malicious application was uploaded to the vendor‚Äôs servers, signed with the company's legitimate certificates, and was distributed as a software update.  On Reddit there is a <a href="https://www.reddit.com/r/ASUS/comments/8qznaj/asusfourceupdaterexe_is_trying_to_do_some_mystery/">discussion of the</a> strange behavior of the utility, although it has not yet been established whether the incident mentioned in the thread is related to this attack. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div style="text-align:center;"><img src="https://habrastorage.org/webt/uq/uk/b3/uqukb3mdghr2a0oz0vxz1jdomky.png"></div><br>  Although the utility was ‚Äúupdated‚Äù, in fact it was an outdated version of the program with additional malicious functionality (analysis of malicious code by an independent researcher is <a href="https://www.vkremez.com/2019/03/lets-learn-dissecting-operation.html">here</a> ).  It can be concluded that Asus‚Äôs infrastructure was partially compromised: the attackers had access to the update server and digital certificates, but not to the source code of the application and the build servers.  Detection of a malicious utility has become possible thanks to tests of a new technology aimed at detecting attacks in the supply chain (in English - supply chain) - when attackers either attack software or hardware one way or another before being delivered to the end consumer-victim, or compromise service tools and device management during operation - those that are trusted. <br><br><h2>  Who suffered </h2><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/bq/jc/4f/bqjc4fylyl61ynjjlgdzeembha8.png"></div><br><br>  If you count all those who flew the utility "with a peg", then tens of thousands of users have suffered, most of them from Russia, Germany and France.  But this is only according to Kaspersky Lab.  Later, Symantec provided its own data - they counted 13 thousand infected systems, with <i>a</i> greater share of users from the United States.  This is clearly not all affected, most likely the malware was on hundreds of thousands of systems.  But on most attacked computers, the utility did nothing, it only checked the MAC addresses with its own database.  In case of coincidence with the command server (for it the asushotfix [.] Com domain was registered), additional software was loaded.  In some cases, the trigger was a combination of the MAC addresses of the wired and wireless network modules. <br><br><div class="oembed"><twitter-widget class="twitter-tweet twitter-tweet-rendered" id="twitter-widget-0" style="position: static; visibility: visible; display: block; transform: rotate(0deg); max-width: 100%; width: 500px; min-width: 220px; margin-top: 10px; margin-bottom: 10px;" data-tweet-id="1110399512143638528"></twitter-widget><script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></div><br>  Of the two hundred samples of the infected utility, we managed to extract about 600 MAC addresses of the systems to which the ShadowHammer attack was really aimed.  What was done to them later was not yet clear: the command server had stopped working until the researchers had detected the attack.  The known facts end there, the conclusions begin. <br><br>  The complexity of the attack is now hardly anyone can be surprised - there are examples of targeted attacks with much more serious investments in R &amp; D.  An important feature of the ShadowHammer operation is that it is a successful attack on the supply chain.  Infected software is distributed from the manufacturer‚Äôs servers, signed by the manufacturer‚Äôs certificate ‚Äî there is no reason for the client to trust such a scenario.  In this case, we are dealing with a pre-installed utility, but previously other programs, which the user usually installs on his own, were successfully attacked.  Kaspersky Lab experts have reason to believe that the latest ShadowHammer attack is related to two incidents two years ago. <br><br>  In the first case, the CCleaner utility already mentioned above was modified; it was also distributed from the manufacturer‚Äôs servers.  In the second case, a manufacturer of device management software in the corporate network NetSarang was attacked.  It is possible that there were other attacks in which attackers collected the MAC addresses of the victims' computers of interest.  In this story there is a hint at one of the real reasons for the massive infection of IoT devices - IP cameras, routers, and the like.  It is not always possible to get to the data of interest through an infected device, but enough information can be collected for use in the next, more targeted operation. <br><br><div class="oembed"><twitter-widget class="twitter-tweet twitter-tweet-rendered" id="twitter-widget-1" style="position: static; visibility: visible; display: block; transform: rotate(0deg); max-width: 100%; width: 500px; min-width: 220px; margin-top: 10px; margin-bottom: 10px;" data-tweet-id="1110176246187651073"></twitter-widget><script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></div><br>  Of course, the question of trust in hardware and software manufacturers arises: if a software update or driver arrives from a vendor, is it safe or not?  Perhaps, it‚Äôs still necessary to be trusted, otherwise the point of vulnerability can simply move to another place.  Prompt response to such incidents by the manufacturer is also welcome.  In the case of Asus, according to Kaspersky Lab, almost two months passed from the first notification (end of January) to the official confirmation of the problem (March 26).  I wonder what technologies will be used for the rapid detection of such attacks?  There is a lot of work to do both for security vendors and vendors.  The cases of using a legitimate certificate to sign malware are sporadic, but the mere presence of a digital signature can no longer serve as the sole criterion for evaluating software. <br><br>  <i>Disclaimer: The opinions expressed in this digest may not always coincide with the official position of Kaspersky Lab.</i>  <i>Dear editors generally recommend to treat any opinions with healthy skepticism.</i> </div><p>Source: <a href="https://habr.com/ru/post/446354/">https://habr.com/ru/post/446354/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../446344/index.html">Building blocks distributed applications. Second approximation</a></li>
<li><a href="../446346/index.html">Develop applications for Android - as if to be (demonetized) by YouTube</a></li>
<li><a href="../446348/index.html">Simple JSON-RPC-like API for PHP</a></li>
<li><a href="../446350/index.html">What eventually killed AirPower</a></li>
<li><a href="../446352/index.html">Protection without protection</a></li>
<li><a href="../446360/index.html">The exhibition ‚ÄúNedra-2019. Study of. Intelligence service. Production"</a></li>
<li><a href="../446362/index.html">3 Key Qualities for a Successful Product Manager: Dmitry Orlov, Senior Product Manager</a></li>
<li><a href="../446364/index.html">Jokes and references from the Simpsons in English, which need to be explained</a></li>
<li><a href="../446366/index.html">ZX Spectrum 128k do it yourself. Part 2</a></li>
<li><a href="../446370/index.html">"Well, again, the weather station"? Not quite</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>