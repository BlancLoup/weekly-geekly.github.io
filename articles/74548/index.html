<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Adding scripting capabilities to your applications using Active scripting</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently, I noticed some interest of habra people to such a topic as scripting. There were articles about Lua , about V8 (JavaScript engine Google Chr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Adding scripting capabilities to your applications using Active scripting</h1><div class="post__text post__text-html js-mediator-article">  Recently, I noticed some interest of habra people to such a topic as scripting.  There were articles about <a title="Lua" href="http://habrahabr.ru/blogs/development/74382/">Lua</a> , about <a href="http://habrahabr.ru/blogs/development/72474/">V8</a> (JavaScript engine Google Chrome).  I would like to talk about the use of technology <strong>Active Scripting</strong> (also known as ActiveX Scripting) from Microsoft. <br>  This is the technology used to implement application support scripts.  This is how the JavaScript engine of everyone's favorite IE browser works;) However, do not rush to conclusions.  Yes, the same V8 engine works many times faster, but this technology has its advantages and possible applications, which I will also discuss. <br><a name="habracut"></a><br><h1>  Introducing Active Scripting </h1><br>  Actually, this technology is nothing particularly difficult.  So, in order. <br>  To begin with, the technology is based on COM (Component Object Model - Component Object Model).  The main components are the <strong>host application</strong> and the <strong>script engine</strong> . <br><br>  <strong>Host application</strong> provides an ‚Äúenvironment‚Äù for script engines and provides it with some set of objects with which the script can operate; <br>  <strong>Script engine</strong> is responsible for parsing, running and debugging scripts in a particular language. <br><br>  Abstraction of modules is at a high level, the host application does not even care what language is used for scripts, since all the work on parsing and running the script is performed by the script engine module. <br>  We can both write our own scripting engine for some exotic language, and vice versa, use ready-made engines (JScript or VBScript) in our application by implementing the script script module.  This article is dedicated to the latter. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h1>  Where to use </h1><br>  The most tangible benefits of using Active Scripting can be obtained if your application is also based on COM.  In this case, you can directly fully interact with your COM objects from the script.  There are some points that need to be taken into account (this mainly refers to the types of methods accepted and returned values). <br>  However, even if your application does not use COM, it is enough just to implement a small ‚Äúlayer‚Äù in the form of a COM object that will ensure the interaction of the script and your code. <br><br><h1>  Where to begin? </h1><br>  And I think it‚Äôs best to start with a simple example.  You can download it <a title="HelloWorld.zip" href="http://ifolder.ru/14887982">from here</a> .  And further on in the course of the article I will give pieces of code from it, explaining certain points.  The example is a console application written in C ++ using the ATL library.  In this example, the JavaScript engine is used, and further on in the text of the article I will talk about the JScript implementation of the script engine.  Just because I love JavaScript and can't stand VBS :) Besides, as I said before, this has nothing to do with the implementation of the script host.  So, we proceed to the practical part. <br><br><h1>  Implementing Script Host </h1><br>  As already mentioned, in order to use ready-made scripting engines, you need to implement your script host module.  It is a normal COM object containing the implementation of the IActiveScriptSite and IActiveScriptSiteWindow interfaces.  In order not to complicate the example, I did not make a full-fledged COM object, but I managed with the usual C ++ class inherited from IActiveScriptSite and IActiveScriptSiteWindow: <br><br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">class</font> CMyScriptHost : <font color="#0000ff">public</font> IActiveScriptSite, <br> <font color="#0000ff">public</font> IActiveScriptSiteWindow</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  Let's start with the implementation of the IUnknown interface common to all COM objects (our class inherited it indirectly from the IActiveScriptSite and IActiveScriptSiteWindow interfaces).  There is nothing complicated, just three methods: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">STDMETHOD(QueryInterface)(REFIID riid, <font color="#0000ff">void</font> * * ppvObj); <br> STDMETHOD_(ULONG, AddRef)(); <br> STDMETHOD_(ULONG, Release)();</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  AddRef increases the reference count;  Rlease - reduces and also deletes the object when the counter becomes equal to 0;  QueryInterface returns a pointer to an object if it is asked for one of the supported interfaces. <br><br>  In the implementation of the interface IActiveScriptSite while everywhere there are stubs <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">STDMETHOD(GetLCID)( <br> LCID *plcid ); <font color="#008000">// address of variable for language identifier</font> <br> STDMETHOD(GetItemInfo)( <br> LPCOLESTR pstrName, <font color="#008000">// address of item name</font> <br> DWORD dwReturnMask, <font color="#008000">// bit mask for information retrieval</font> <br> IUnknown **ppunkItem, <font color="#008000">// address of pointer to item's IUnknown</font> <br> ITypeInfo **ppTypeInfo); <font color="#008000">// address of pointer to item's ITypeInfo</font> <br> STDMETHOD(GetDocVersionString)( <br> BSTR *pbstrVersionString); <font color="#008000">// address of document version string</font> <br> STDMETHOD(OnScriptTerminate)( <br> <font color="#0000ff">const</font> VARIANT *pvarResult, <font color="#008000">// address of script results</font> <br> <font color="#0000ff">const</font> EXCEPINFO *pexcepinfo); <font color="#008000">// address of structure with exception information</font> <br> STDMETHOD(OnStateChange)( <br> SCRIPTSTATE ssScriptState); <font color="#008000">// new state of engine</font> <br> STDMETHOD(OnScriptError)( <br> IActiveScriptError *pase); <font color="#008000">// address of error interface</font> <br> STDMETHOD(OnEnterScript)( <font color="#0000ff">void</font> ); <br> STDMETHOD(OnLeaveScript)( <font color="#0000ff">void</font> );</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  The only exception is the OnScriptError method, a string with information about the error is formed in it and then output using the MessageBox ªa: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">STDMETHODIMP CMyScriptHost::OnScriptError(IActiveScriptError *pase) <br> { <br> <font color="#0000ff">#ifdef</font> _DEBUG <br> EXCEPINFO Exception; <br> HRESULT hr = pase-&gt;GetExceptionInfo(&amp;Exception); <br> <font color="#0000ff">if</font> (SUCCEEDED(hr)) <br> { <br> CString sErrLog = _T( <font color="#A31515">""</font> ); <br> sErrLog += _T( <font color="#A31515">"EXCEPINFO"</font> ); <br> sErrLog += _T( <font color="#A31515">"\n\rDescription: "</font> ); <br> sErrLog += Exception.bstrDescription; <br> sErrLog += _T( <font color="#A31515">"\n\rSource: "</font> ); <br> sErrLog += Exception.bstrSource; <br> <br> CComBSTR bsSrcLineText; <br> hr = pase-&gt;GetSourceLineText(&amp;bsSrcLineText); <br> <font color="#0000ff">if</font> (SUCCEEDED(hr)) <br> { <br> sErrLog += _T( <font color="#A31515">"\n\rSource line text: "</font> ); <br> sErrLog += bsSrcLineText; <br> } <br> <br> DWORD dwSourceContext = 0; <br> ULONG ulLineNumber = 0; <br> LONG lCharacterPosition = 0; <br> <br> hr = pase-&gt;GetSourcePosition(&amp;dwSourceContext, &amp;ulLineNumber, &amp;lCharacterPosition); <br> <font color="#0000ff">if</font> (SUCCEEDED(hr)) <br> { <br> CString sSourceContext; <br> sErrLog += _T( <font color="#A31515">"\n\rSource context: "</font> ); <br> sSourceContext.Format(_T( <font color="#A31515">"%d"</font> ), dwSourceContext); <br> sErrLog += sSourceContext; <br> <br> CString sLineNumber; <br> sErrLog += _T( <font color="#A31515">"\n\rLine number: "</font> ); <br> sLineNumber.Format(_T( <font color="#A31515">"%d"</font> ), ulLineNumber); <br> sErrLog += sLineNumber; <br> <br> CString sCharPos; <br> sErrLog += _T( <font color="#A31515">"\n\rCharacterPosition: "</font> ); <br> sCharPos.Format(_T( <font color="#A31515">"%d"</font> ), lCharacterPosition); <br> sErrLog += sCharPos; <br> } <br> <br> ::MessageBox(0, sErrLog, COLE2T(Exception.bstrSource), 0); <br> } <br> <font color="#0000ff">#endif</font> <font color="#008000">// _DEBUG</font> <br> <br> <font color="#0000ff">return</font> S_OK; <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  In the implementation of the IActiveScriptSiteWindow, so far, too, stubs. <br><br>  Next, we add to our class two fields for storing pointers to the script engine object: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">CComPtr&lt;IActiveScript&gt; m_pEngine; <font color="#008000">// reference to the scripting engine</font> &lt;br&gt;CComQIPtr&lt;IActiveScriptParse&gt; m_pParser; <font color="#008000">// reference to the IActiveScriptParse interface of the scripting engine</font></font> &lt;br&gt;&lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  In fact, these variables point to different interfaces of the same object. <br><br>  Now we add several methods to our class: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">HRESULT Initialize();&lt;br&gt;HRESULT Close();&lt;br&gt;HRESULT PutScript(CString sScriptText);&lt;br&gt;HRESULT CallJSFunction(CString sFuncName, VARIANT *varResult);</font> &lt;br&gt;&lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  The Initialize () method, as you probably guessed, initializes the script host: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">HRESULT CMyScriptHost::Initialize()&lt;br&gt;{&lt;br&gt;  HRESULT hr = E_FAIL;&lt;br&gt;&lt;br&gt; <font color="#008000">//First, create the scripting engine with a call to CoCreateInstance,</font> &lt;br&gt; <font color="#008000">//placing the created engine in m_Engine.</font> &lt;br&gt;&lt;br&gt;  hr = m_pEngine.CoCreateInstance(CComBSTR(_T( <font color="#A31515">"JScript"</font> )));&lt;br&gt; <font color="#0000ff">if</font> (SUCCEEDED(hr) &amp;&amp; m_pEngine)&lt;br&gt;  {&lt;br&gt;    m_pParser = m_pEngine;&lt;br&gt; <font color="#0000ff">if</font> (m_pParser)&lt;br&gt;    {&lt;br&gt; <font color="#008000">//The engine needs to know the host it runs on.</font> &lt;br&gt;      hr = m_pEngine-&gt;SetScriptSite( <font color="#0000ff">this</font> );&lt;br&gt;      ATLASSERT(SUCCEEDED(hr));&lt;br&gt;&lt;br&gt; <font color="#008000">//Initialize the script engine so it's ready to run.</font> &lt;br&gt;      hr = m_pParser-&gt;InitNew();&lt;br&gt;      ATLASSERT(SUCCEEDED(hr));&lt;br&gt;    }&lt;br&gt;  }&lt;br&gt;&lt;br&gt; <font color="#0000ff">return</font> hr;&lt;br&gt;}</font> &lt;br&gt;&lt;br&gt; <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  First we create the script engine object and store it in m_pEngine.  Then we get a pointer to the IActiveScriptParse interface of the same object and save it to m_pParser (for those unfamiliar with ATL, getting the interface is hidden, because a smart interface pointer, CComQIPtr, which gets the right interface when it is assigned a value).  Next, install the engine of its site (i.e. host) - itself.  Initialize the script engine. <br><br>  The Close () method ensures the correct completion of the script: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">HRESULT CMyScriptHost::Close() <br> { <br> HRESULT hr = E_FAIL; <br> <br> <font color="#0000ff">if</font> (m_pEngine) <br> { <br> <font color="#0000ff">if</font> (m_pParser) <br> m_pParser.Release(); <br> <br> <font color="#008000">// Disconnect the host application from the engine. This will prevent the</font> <br> <font color="#008000">// further firing of events. Event sinks that are in progress are</font> <br> <font color="#008000">// completed before the state changes.</font> <br> m_pEngine-&gt;SetScriptState(SCRIPTSTATE_DISCONNECTED); <br> <br> <font color="#008000">// Call to InterruptScriptThread to abandon any running scripts and force</font> <br> <font color="#008000">// a cleanup of all script elements.</font> <br> m_pEngine-&gt;InterruptScriptThread(SCRIPTTHREADID_ALL, NULL, 0 ); <br> m_pEngine-&gt;Close(); <br> <br> m_pEngine.Release(); <br> <br> hr = S_OK; <br> } <br> <br> <font color="#0000ff">return</font> hr; <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  The PutScript method () transferred to it the script text feeds the parser and starts the engine by calling SetScriptState (SCRIPTSTATE_CONNECTED): <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">HRESULT CMyScriptHost::PutScript( CString sScriptText ) <br> { <br> HRESULT hr = E_FAIL; <br> <br> <font color="#008000">//Pass the script to be run to the script engine with a call to ParseScriptText</font> <br> hr = m_pParser-&gt;ParseScriptText(sScriptText, NULL, NULL, NULL, 0, 0, 0, NULL, NULL); <br> hr = m_pEngine-&gt;SetScriptState(SCRIPTSTATE_CONNECTED); <br> <br> <font color="#0000ff">return</font> hr; <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  Finally, the CallJSFunction () method calls a function with the specified name and returns the result as a variable of type VARIANT: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">HRESULT CMyScriptHost::CallJSFunction( CString sFuncName, VARIANT *varResult ) <br> { <br> HRESULT hr; <br> CComPtr&lt;IDispatch&gt; pDispScript; <br> <br> hr = m_pEngine-&gt;GetScriptDispatch( NULL, &amp;pDispScript ); <br> <br> <font color="#0000ff">if</font> ( SUCCEEDED(hr) &amp;&amp; pDispScript ) <br> { <br> hr = pDispScript.Invoke0(sFuncName, varResult); <br> } <br> <br> <font color="#0000ff">return</font> hr; <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  <em>Note that now no parameters are passed to the JavaScript function, but this is very simple: we use instead of the Invoke0 method Invoke1, Invoke2 or InvokeN and pass parameters in variables of type VARIANT.</em> <br><br>  That's all, now we have the necessary minimum to run a simple script. <br><br><h1>  Hello World! </h1><br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">int</font> _tmain( <font color="#0000ff">int</font> argc, _TCHAR* argv[]) <br> { <br> CoInitialize(NULL); <br> <br> CMyScriptHost* myScriptHost = <font color="#0000ff">new</font> CMyScriptHost(); <font color="#008000">//    Script host`</font> <br> myScriptHost-&gt;AddRef(); <br> <br> HRESULT hr = E_FAIL; <br> <br> hr = myScriptHost-&gt;Initialize(); <br> <font color="#0000ff">if</font> (SUCCEEDED(hr)) <br> { <br> <font color="#008000">//      test</font> <br> <font color="#008000">//      -    "Hello, World!"</font> <br> CString sScriptText = _T( <font color="#A31515">"function test() { \ <br> return 'Hello, World!'; \ <br> }"</font> ); <br> <br> hr = myScriptHost-&gt;PutScript(sScriptText); <br> <font color="#0000ff">if</font> (SUCCEEDED(hr)) <br> { <br> CComVariant varResult; <font color="#008000">//    </font> <br> hr = myScriptHost-&gt;CallJSFunction(_T( <font color="#A31515">"test"</font> ), &amp;varResult); <font color="#008000">//   test  </font> <br> <font color="#0000ff">if</font> (SUCCEEDED(hr)) <br> { <br> _tprintf(_T( <font color="#A31515">"Result: %s\n\r"</font> ), COLE2T(varResult.bstrVal)); <font color="#008000">//  </font> <br> _tprintf(_T( <font color="#A31515">"\n\rPress any key to exit..."</font> )); <br> _gettch(); <br> } <br> } <br> <br> myScriptHost-&gt;Close(); <font color="#008000">//   </font> <br> } <br> <br> myScriptHost-&gt;Release(); <br> <br> CoUninitialize(); <br> <font color="#0000ff">return</font> 0; <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  Compile, run.  We see in the console: <br><br>  Result: Hello, World! <br><br>  Press any key to exit ... <br><br>  Perhaps, for the first time is enough.  In the next article I will talk about the deeper interaction of the script with the compiled code. <br><br>  PS In the CMyScriptHost class, the example partially uses <a href="http://zserg.habrahabr.ru/">zserg</a> code - the guru of everything and <a href="http://zserg.habrahabr.ru/">everyone</a> in programming :) <br>  PPS My first article on Habr√©, healthy criticism and suggestions are welcome <br>  PPPS The parser doesn‚Äôt really like the word Script, everywhere I wrote it exclusively in small letters.  See the correct spelling in the example code. <br></div><p>Source: <a href="https://habr.com/ru/post/74548/">https://habr.com/ru/post/74548/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../74538/index.html">Cap of happiness</a></li>
<li><a href="../74541/index.html">Visual Studio 2010: countdown</a></li>
<li><a href="../74543/index.html">Network problems in Ubuntu 9.10 Karmic Koala</a></li>
<li><a href="../74544/index.html">Manage Rhythmbox by ssh</a></li>
<li><a href="../74545/index.html">Making a Google Wave: First Experience</a></li>
<li><a href="../74549/index.html">SanDisk Sansa Clip + mp3 player review</a></li>
<li><a href="../74550/index.html">HabraWar - python-robots</a></li>
<li><a href="../74554/index.html">Beagleboard - the future for ARM</a></li>
<li><a href="../74555/index.html">Myka Bittorrent a year later</a></li>
<li><a href="../74556/index.html">Inter-AS MPLS VPN Option A</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>