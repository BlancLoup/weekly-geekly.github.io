<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Hacker's guide to neural networks. Schemes of real values. Schemes with several logical elements</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Content: 
 Chapter 1: Real Value Schemes  Part 1: 


 : ‚Ññ1:   
 Part 2: 


  ‚Ññ2:  
 Part 3: 


  ‚Ññ3:  
 Part 4: 


   
 Part 5: 


  ¬´¬ª " " 
 Part 6: ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Hacker's guide to neural networks. Schemes of real values. Schemes with several logical elements</h1><div class="post__text post__text-html js-mediator-article">  Content: <br><div class="spoiler">  <b class="spoiler_title">Chapter 1: Real Value Schemes</b> <div class="spoiler_text">  <a href="http://habrahabr.ru/company/paysto/blog/244723/">Part 1:</a> <br><pre><code class="html hljs xml">  :        ‚Ññ1:   </code> </pre> <br>  <a href="http://habrahabr.ru/company/paysto/blog/244935/">Part 2:</a> <br><pre> <code class="html hljs xml">  ‚Ññ2:  </code> </pre><br>  <a href="http://habrahabr.ru/company/paysto/blog/245051/">Part 3:</a> <br><pre> <code class="html hljs xml">  ‚Ññ3:  </code> </pre><br>  <a href="http://habrahabr.ru/company/paysto/blog/245403/">Part 4:</a> <br><pre> <code class="javascript hljs">        </code> </pre><br>  <a href="http://habrahabr.ru/company/paysto/blog/246093/">Part 5:</a> <br><pre> <code class="javascript hljs">   ¬´¬ª   <span class="hljs-string"><span class="hljs-string">" "</span></span></code> </pre><br>  <a href="http://habrahabr.ru/company/paysto/blog/246397/">Part 6:</a> <br><pre> <code class="javascript hljs">     </code> </pre><br></div></div><br><div class="spoiler">  <b class="spoiler_title">Chapter 2: Machine Learning</b> <div class="spoiler_text">  <a href="http://habrahabr.ru/company/paysto/blog/246523/">Part 7:</a> <br><pre> <code class="javascript hljs">  </code> </pre><br>  <a href="http://habrahabr.ru/company/paysto/blog/246849/">Part 8:</a> <br><pre> <code class="javascript hljs">        (SVM)</code> </pre><br>  <a href="http://habrahabr.ru/company/paysto/blog/246973/">Part 9:</a> <br><pre> <code class="javascript hljs">  SVM   </code> </pre><br>  <a href="http://habrahabr.ru/company/paysto/blog/247033/">Part 10:</a> <br><pre> <code class="javascript hljs">   :  </code> </pre><br></div></div><br><br>  You will probably say: ‚ÄúThe analytical gradient is quite simple, if you take the derivative for your simple expressions.  But it is useless.  What will I do when expressions get much bigger?  Wouldn't the equations get huge and complex pretty quickly? ‚Äù  Good question.  Yes, expressions are becoming much more complicated.  But no, it does not make everything much more difficult. <br><br>  As we will see later, each logical element will exist by itself, completely unaware of the nuances of a huge and complex scheme, of which it is a part.  He will only worry about his original values, and will calculate his local derivatives in the same way as described in the previous section, except that there will be one additional multiplication that he will need to perform. <br><a name="habracut"></a><br><blockquote>  One additional multiplication will transform one (useless) logic element into a gear in a complex mechanism, which is a whole neural network. </blockquote>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Probably stop praising him.  I hope I aroused your interest.  Let's delve into the details and include two logical elements in our next example: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/b44/9ae/e75/b449aee752c2444781a6251ae3f766df.PNG" alt="image"></div><br><br>  The expression we are calculating at the moment looks like this: <b>f (x, y, z) = (x + y) z</b> .  Let's build the code structure to represent the logic elements as functions: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> forwardMultiplyGate = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a, b</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> a * b; }; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> forwardAddGate = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a, b</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> a + b; }; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> forwardCircuit = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">x,y,z</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> q = forwardAddGate(x, y); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> f = forwardMultiplyGate(q, z); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> f; }; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> x = <span class="hljs-number"><span class="hljs-number">-2</span></span>, y = <span class="hljs-number"><span class="hljs-number">5</span></span>, z = <span class="hljs-number"><span class="hljs-number">-4</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> f = forwardCircuit(x, y, z); <span class="hljs-comment"><span class="hljs-comment">//   -12</span></span></code> </pre><br><br>  In the above example, I use <b>a</b> and <b>b</b> as local variables in the functions of the logic elements.  Thus, we will not confuse them with the initial values ‚Äã‚Äãof the <b>x, y, z</b> scheme.  As before, we are interested in finding derivatives with respect to these three initial values: <b>x, y, z</b> .  But how are we going to count them now, when we have several logical elements? <br><br>  To begin with, let's pretend that the + element is not here, and that we have only two variables in the scheme: q, z and one logical element *.  Notice that q is the resulting value of the logical element +.  If we do not need to worry about x and y, but only about q and z, then we return to only one logical element, since only the element * is involved, and we know what the (analytical) derivatives of the previous section are.  We can write them (in this case, replacing x, y with q, z) as follows: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/d25/bfb/84a/d25bfb84aeb448749a530449b6d03fc4.PNG" alt="image"></div><br><br>  Everything is quite simple: these are gradient expressions with respect to q and z.  But wait, we do not need a gradient with respect to q, but only with respect to the initial values: x and y.  Fortunately, q is calculated as a function of x and y (by adding in our example).  We can write the gradient for the addition logic in the same way, even simpler: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/c92/cab/5e1/c92cab5e18fa436bbeddaf15510c341c.PNG" alt="image"></div><br><br>  Everything is correct, the derivatives are simply equal to 1, regardless of the actual x and y values.  If you think about it, then it makes sense, because to make the result of one logical element of addition higher, we need a positive change of x and y, regardless of their values. <br><br>  <b>Back propagation error</b> <br><br>  Finally, we are ready to use the Chain rule: we know how to calculate the q gradient with respect to x and y (this is in the case of one logical element - +).  And we know how to calculate the gradient of our final result with respect to q.  The chain rule tells us how to combine these approaches to get the final result gradient with respect to x and y, which we are ultimately interested in.  Best of all, the chain rule simply states that the right thing is to take and multiply the gradients to link them.  For example, the final derivative for x would be: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/5e4/19f/5e9/5e419f5e99de4104a2aad02760bba73d.PNG" alt="image"></div><br><br>  There are a lot of characters, so again, this may seem complicated, but these are just two numbers that are multiplied together.  Here is the code: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//   var x = -2, y = 5, z = -4; var q = forwardAddGate(x, y); // q  3 var f = forwardMultiplyGate(q, z); //   -12 //           // wrt ‚Äì   ¬´ ¬ª ("with respect to") var derivative_f_wrt_z = q; // 3 var derivative_f_wrt_q = z; // -4 //           var derivative_q_wrt_x = 1.0; var derivative_q_wrt_y = 1.0; //   var derivative_f_wrt_x = derivative_q_wrt_x * derivative_f_wrt_q; // -4 var derivative_f_wrt_y = derivative_q_wrt_y * derivative_f_wrt_q; // -4</span></span></code> </pre><br><br>  That's all.  We calculated the gradient and now we can allow our original values ‚Äã‚Äãto react a bit to it.  Let's add gradients to the top of the original values.  The output value of the circuit needs to be done more than -12! <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//  ,  : [-4, -4, 3] var gradient_f_wrt_xyz = [derivative_f_wrt_x, derivative_f_wrt_y, derivative_f_wrt_z] //      /: var step_size = 0.01; x = x + step_size * derivative_f_wrt_x; // -2.04 y = y + step_size * derivative_f_wrt_y; // 4.96 z = z + step_size * derivative_f_wrt_z; // -3.97 //        : var q = forwardAddGate(x, y); // q  2.92 var f = forwardMultiplyGate(q, z); //   -11.59, ,  -12!</span></span></code> </pre><br><br>  Seems to work!  Let's now try to intuitively interpret what has just happened.  The circuit wants to produce higher values ‚Äã‚Äãas a result.  The last logical element saw the initial values <b>q = 3, z = -4</b> and calculated the result -12.  By ‚Äúpushing‚Äù up, this output value applied a force on both <b>q and z</b> : to increase the output value, the ‚Äúwants‚Äù circuit would increase the value of <b>z</b> , as can be seen from the positive value of the derivative <b>(derivative_f_wrt_z = +3)</b> .  Again, the size of this derivative can be interpreted as the magnitude of the force.  On the one hand, a large downward force was applied to q, since the <b>derivative_f_wrt_q = -4</b> .  In other words, the scheme wants to reduce <b>q</b> by applying a force equal to 4 to it. <br><br>  Now we come to the second logical element - <b>"+"</b> , which gives the output value <b>q</b> .  By default, the logical element <b>+</b> calculates its derivatives, which tell us how to change x and y to make q larger.  BUT!  Here is <b>an important point</b> : the gradient of the <b>q</b> value was calculated as a negative number ( <b>derivative_f_wrt_q = -4</b> ), so the circuit wants to reduce the <b>q</b> module by applying a force equal to 4!  Therefore, if the logical element <b>+</b> wants to help make the final output value larger, it must listen to the gradient signals coming from above.  In particular, in this case, he should push x, y in the opposite direction from where he could push them under normal conditions, and with a force equal to 4, so to speak.  Multiplication by -4, used in the chain rule, leads to the following: instead of applying a positive force of +1 on both x and y (local derivative), the total gradient of the circuit in x and y becomes <b>1 x -4 = -4</b> .  This makes sense: the circuit wants x and y to become smaller, since this will lead to a decrease in q, which, in turn, will increase f. <br><br><blockquote>  If this makes sense to you, then you understand the reverse propagation of an error. </blockquote><br><br>  Let's repeat what we learned: <br><br>  In the previous section, we saw that in the case of one logical element (or one expression), we can take the derivative of an analytical gradient using a simple calculation.  We interpreted the gradient as a force or a push to the original values, which pushes them in a direction that can make the result of this logical element higher. <br><br>  In the case of several logical elements, everything remains approximately the same: each logical element exists independently, unaware of the scheme in which it is included.  Some source values ‚Äã‚Äãarrive, and the logical element calculates the result and the derivative with respect to the source values.  The only difference at this stage is that suddenly something can push this logical element from above.  This is the gradient of the final output value of the circuit in relation to the result that this logical element calculated.  It is the circuit that asks the logical element to result in a larger or smaller number, applying a certain force.  The logical element simply takes this force and multiplies it by all the forces that it has calculated before for its initial values ‚Äã‚Äã(chain rule).  This led to the desired results: <br><br>  1. If a logical positive impulse from above turns out to be a logical element, it also pushes its own initial values, differentiated by the force applied to it from above <br>  2. And if there is a negative push on it, it means that the circuit wants its value to decrease, not increase, so it will apply push force to its original values ‚Äã‚Äãin order to make its own output value smaller. <br><br><blockquote>  A good example to keep in mind: we push the result of the circuit and this leads to a downward push through the whole circuit down to the original values. </blockquote><br><br>  Isn't that great?  The only difference between a scenario with one logical element and several interacting logical elements that arbitrarily compute complex expressions is the additional multiplication that occurs in each logical element. </div><p>Source: <a href="https://habr.com/ru/post/245403/">https://habr.com/ru/post/245403/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../245387/index.html">ReSharper 9, dotTrace 6, dotCover 3, dotMemory 4.2 and dotPeek 1.3 are available for download.</a></li>
<li><a href="../245391/index.html">Gaming Industry News Digest: November</a></li>
<li><a href="../245393/index.html">Yandex opens a new direction of its activity - Yandex Data Factory</a></li>
<li><a href="../245397/index.html">Bank statements and PHP is just</a></li>
<li><a href="../245401/index.html">How we tried to implement Yandex.Kassa</a></li>
<li><a href="../245405/index.html">How to use the GamePad in the browser and in Windows applications on HTML and JavaScript?</a></li>
<li><a href="../245407/index.html">HackDay for Superheroes, tha last call</a></li>
<li><a href="../245411/index.html">How to make online logging from scratch</a></li>
<li><a href="../245415/index.html">6 ways: how to add security for Rest service in Java</a></li>
<li><a href="../245419/index.html">From the experience of translating style guides</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>