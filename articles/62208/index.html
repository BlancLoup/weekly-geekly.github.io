<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Opera Unite for web developers</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="How to create a simple counter as a service Opera Unite? 
 This will help you understand how to generally write web applications on Opera Unite (also ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Opera Unite for web developers</h1><div class="post__text post__text-html js-mediator-article">  How to create a simple counter as a service Opera Unite? <br>  This will help you understand how to generally write web applications on Opera Unite (also called ‚Äúservices‚Äù or ‚Äúplugins‚Äù). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8ca/30e/819/8ca30e819c8b568dbdd779a9f8f300ce.jpg" alt="image"><br><br>  15 lines javascript + 7 on XML. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a>  Obviously, first download <a href="http://unite.opera.com/">Opera Unite</a> , install it (if Opera is already installed, an update will be made if desired). <br><br>  Create any folder where you need to create 2 files: <br><br>  1. Create config.xml: <br><br><pre>  &lt;widget&gt;
   &lt;widgetname&gt; Test &lt;/ widgetname&gt;
   &lt;feature name = "http://xmlns.opera.com/webserver"&gt;
     &lt;param name = "type" value = "service" /&gt;
     &lt;param name = "servicepath" value = "test" /&gt;
   &lt;/ feature&gt;
 &lt;/ widget&gt; </pre><br><br>  2. Create an index.html file: <br><br><pre> &lt;script&gt;
 var counter = 0;
 window.onload = function () {
     webserver = opera.io.webserver
     if (webserver) {
         webserver.addEventListener ('_ index', start_page, false);
     }
 }
 function start_page (r) {// spaces are not necessary, just habr it replaces with (r)
     counter ++;
     var o = r.connection.response;
     o.write ('This page has been seen &lt;b&gt;' + counter + 'times &lt;/ b&gt; !!');
     o.close ();
 }
 &lt;/ script&gt;
 &lt;html&gt; &lt;title&gt; My Application &lt;/ title&gt; &lt;/ html&gt;
</pre><br><br>  This is clearly not the most complete example.  You can expand it by taking out the script in a separate file. <br><br>  * Activate Opera Unite if it is not active (Opera will ask about it in the next step, so you can skip it) <br><br>  4. Drag and drop config.xml into Opera.  She will ask - whether to install?  We confirm. <br><br>  <b>All is ready.</b>  <b>We see the picture at the beginning of the post.</b> <br>  (In English - how to make a <a href="http://dev.opera.com/articles/view/opera-unite-developer-primer/">simple blog in 60 lines of JavaScript</a> ) <br><br>  5. If we change something in index.html - the old version will be shown - debugging solution: Right click on the Unite icon -&gt; ‚ÄúManage Services‚Äù (or F4), right click on ‚ÄúTest‚Äù -&gt; ‚ÄúStop service‚Äù, then the same, only "Start service".  Sources will reboot.  The counter will be reset (persistence problem, I'm still looking for how to solve, most likely something with the fileio library + JSON will be or REST databases). <br><br>  6. To share your creativity with someone, copy the URL (F8 - Ctrl + C in Opera) and change it like this: <br><br>  unite: // -&gt; http: // <br><br>  so that, <br><br>  unite: //my_compute.my_opera_login.operaunite.com/test/ <br><br>  becomes <br><br>  http://my_compute.my_opera_login.operaunite.com/test/ <br><br>  7. Use <a href="http://dev.opera.com/libraries/markuper/">Markuper</a> for HTML templates. <br><br>  Should I use Unite for web development?  I have a lot of different thoughts on this, but I don‚Äôt have time to translate them.  If the English order - read <a href="http://unitehowto.com/Why">http://unitehowto.com/Why</a> . <br><br>  If very briefly: <br><ul><li>  For PHP / MySQL programmers, this will not be cool (this is not an insult, but as a fact, like 3D modelers - SketchUp is not cool, functions and flexibility are not enough) </li><li>  The load will not be a problem for most, then - PHP / MySQL or see below. </li><li>  It is perfect for prototyping a web application or creating local applications (for example, billing for my clients). </li><li>  For non-specialists in PHP / MySQL and other server languages ‚Äã‚Äã- the most it is for creating websites - web applications. </li><li>  Creating applications on Unite is sooooo easy.  There are many pros and few cons, but a big minus is to keep the browser open. </li><li>  Cross-platform (win / lin / mac) </li><li>  "Server" -side (fast) javascript! </li><li>  In the end, someone will make a V8-based production server under * nix / * BSD in order to directly publish applications that have been debugged on the local Opera (approximately like Google App Engine).  (It may even be a module for nginx) </li></ul><br><br>  I will, as far as finding a solution to these problems, publish the answers on <a href="http://unitehowto.com/">unitehowto.com</a> . <br><br><h4>  How to make the counter not reset </h4><br><br>  The problem persistence solved (Opera, let's more small examples!) <br><br>  1. Modify the config.xml: <br><br> <code>&lt;widget&gt; <br> &lt;widgetname&gt;Test&lt;/widgetname&gt; <br> <i><b>&lt;feature name="http://xmlns.opera.com/fileio"&gt; <br> &lt;/feature&gt;</b></i> <br> &lt;feature name="http://xmlns.opera.com/webserver"&gt; <br> &lt;param name="type" value="service"/&gt; <br> &lt;param name="servicepath" value="test"/&gt; <br> &lt;/code&gt; <br> &lt;/widget&gt;</code> <br> <br>  This is what we connect the permission of Opera to use the file system (there it‚Äôs all tricky in sandboxes).  Now we change the script: <br><br><pre>  var counter = 0; </pre><br>  replace with <br><br><pre> var dir = opera.io.filesystem.mountSystemDirectory ('storage');
 try {
	 stream = dir.open (dir.resolve ('/ storage / newfile'), opera.io.filemode.READ);
	 if (stream) {
		 var counter = parseInt (stream.readLine ());
		 stream.close ();
	 };
 } catch (err) {// message: FILE_NOT_FOUND_ERR
	 var counter = 0;
 };
</pre><br><br>  Opera declares the .exists () method, but I never found it (I tried almost all the options to call it), and dir.open (...) immediately gives an exception if there is no file. <br><br>  For information on how to access files in another sandbox (not in / storage /) - read the <a href="">fileio</a> (english) docks. <br><br>  With these lines we load the variable from the file (/ storage / newfile) - in fact, this file will be stored by the user somewhere in / Documents and settings /..../ Local settings /..../ 4393408934 / (and .), i.e.  - this is not an absolute path, but a path inside the sandbox. <br><br>  In theory, we would need to save the JSON representation of the object, then we can store complex nested structures, and not just Int. <br><br>  At the end of start_page we add saving: <br><br><pre>	 var stream = dir.open ('/ storage / newfile', opera.io.filemode.WRITE);
	 stream.writeLine (counter);
	 stream.close ();
</pre><br><br>  This is not the best option - to save the file after each request, but in my opinion, window.onunload was forgotten in Opera (window.onload was done). <br><br>  Full source with preservation: <a href="">t9.zip</a> <br><br><h4>  Debugging scripts, pitfalls </h4><br>  Remember that this is the alpha release of Opera, so all that has been said is without charge: <br><br>  Reload source: ‚ÄúStop service‚Äù -&gt; ‚ÄúStart service‚Äù -&gt; (check Error Console) -&gt; F5.  (Sometimes you also need a reinstallation.) <br><br>  You can try to find a hint of what happened in Tools -&gt; Advanced -&gt; Error Console, but there are also errors with meaningless names often.  [Update] Open the URL <a href="">opera: config # UserPrefs | Exceptions Have Stacktrace</a> , check this box, do not forget to click the Save button below.  This makes errors in the Error Console readable. <br><br>  Syntax errors are checked by the Error Console immediately after each ‚ÄúStop service‚Äù -&gt; ‚ÄúStart service‚Äù. <br><br>  If you change the config.xml - you have to change the name of the directory where it lies and reinstall the script (by dragging), otherwise the opera will take the old version from memory. <br><br>  In no case do not use alert () and window.onunload in scripts (killed the opera, sent the bug report). <br><br>  The ‚ÄúResource not found‚Äù error can mean either a syntax error or anything else. <br><br>  In general, while that debugging is horror. <br><br>  But, in general, Opera is giants!  Make a web that truly p2p now is power!  And those problems that are described here and under the link "/ Why" are described - I think they will fix it. <br><br><img src="http://habrahabr.ru/media/userpic/avatar/14/45/58/31055.png"><br>  Yoi Haji <br>  <a href="http://yoihj.habrahabr.ru/blog/">view from Habra</a> </div><p>Source: <a href="https://habr.com/ru/post/62208/">https://habr.com/ru/post/62208/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../62200/index.html">Give Internet, Yota-Magister</a></li>
<li><a href="../62202/index.html">Questions about .NET ‚Ññ2</a></li>
<li><a href="../62203/index.html">Procedure for resolving methods in Python</a></li>
<li><a href="../62204/index.html">Fan table under the laptop</a></li>
<li><a href="../62206/index.html">Netbook Review / UMPC Kohjinsha SC3</a></li>
<li><a href="../62212/index.html">New tourist service Turometr.ru</a></li>
<li><a href="../62214/index.html">Ubiquity + habrahabr</a></li>
<li><a href="../62215/index.html">New exploit threatens iPhone</a></li>
<li><a href="../62216/index.html">NOKIA-QUEST IS ENCRYPTED IN "F5" NEWSPAPER</a></li>
<li><a href="../62219/index.html">Habravchani love active offline?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>