<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Indoor Air Quality Monitor</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It is wonderful to live on the shore of a mountain lake, among virgin, nature. Breathe only clean air filled with the aroma of herbs. But few who do i...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Indoor Air Quality Monitor</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/600/6bf/d8d/6006bfd8d4d36041bb0cad3261c600d7.jpg" alt="image"><br><br>  It is wonderful to live on the shore of a mountain lake, among virgin, nature.  Breathe only clean air filled with the aroma of herbs.  But few who do it.  And in the metropolis, at home and in the office, you can achieve the highest possible air quality. <br><br>  To do this, first of all you need to see and understand what surrounds us?  What kind of air do we breathe?  We have already become accustomed to thermometers, barometers, instruments showing humidity.  But these devices do not tell us anything about the quality of the surrounding air.  So we will listen to advice that is not always true, be guided by rumors, not knowing for sure whether we are doing the right thing. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      One of these myths is that in cities there is disgusting air, dirty and poisonous.  And instead of oxygen, solid exhaust from cars.  We take it for granted and do not try to rectify the situation, even where we can do it, in our own home or office.  Even those who have small children, or problems with allergies, put their efforts into the blind, not controlling the results. <br><br>  There are many useful devices that allow us to increase the quality of the air in our house - humidifiers, ionizers, air washers, intake ventilation and filters. <br><br>  But this is not enough.  You need a device that you can directly measure the air quality in your home.  What would you understand and understand what you breathe.  As the temperature on the thermometer. <br><a name="habracut"></a><br>  What can give such a device? <br><br>  Many people think that in the city, the air is dirty on the street, where there are cars and factories.  And the air in the room is cleaner.  But this is not at all the case.  It is enough to measure.  A person exhales 100 times more CO2 than he inhales.  And in a hermetically sealed room, especially if there are several people present, the air becomes suffocating very quickly.  The house has a lot of furniture and finishing materials that emit toxic substances.  The apartment quickly accumulates dust, which can cause serious harm to your health.  Indoor air is 4-8 times dirtier than outside, and 8-10 times more toxic.  And you can measure it and see if you have the appropriate devices.  And to understand how often you should air the room, in any weather. <br><br>  One of the serious air pollutants is dust.  A carrier of infections, a favorite environment for saprophyte ticks and a serious allergen - dust pollutes the air most. <br><br>  In the house where there are allergies, it is recommended to take radical measures: change curtains and drapes to the blinds, remove carpets, books, decorative textiles and plush toys.  And even upholstered furniture to change to analogues in leather upholstery.  Books, souvenirs, every little thing - to store under glass.  And of course it is important to know that your efforts are not in vain and the amount of dust in the house is minimal.  And this can also be measured and seen. <br><br>  The danger is fraught with home furnishings, furniture, varnishes, paints, chipboard, MDF, some plastics can release phenols, formaldehydes, etc.  It does not matter what the price of furniture made of chipboard - all the same, the compounds harmful to the body will "fly" into the air. <br><br>  But even with this disaster, you can effectively deal with it, including airing the room.  Just need to see the enemy in the face.  Measure and control. <br><br>  Actually, what I propose is a device for quality control, the main parameters of the ambient air.  which I did for myself.  And I share with you his design.  The device is available for self-assembly, anyone who knows how to hold a soldering iron in his hand. <br><br>  In the continuation and development of the past theme of the <a href="https://habrahabr.ru/post/301296/">CO2</a> sensor, I improved the device and bring to your attention a new version, now integrated air quality monitoring. <br><br>  2 more sensors were added to the device.  PMS5003 dust sensor and formaldehyde sensor ZE08-CH20.  Also, the device got a DS3231 watch and learned how to make MP3-TF-16P sounds.  Were thrown out the temperature and humidity sensor.  They were of little use.  Due to the fact that the filling heats up the readings of these sensors were very different from reality. <br><br>  The basis of the device, as before, is the controller ESP8266 dev kit 1 and the CO2 sensor MH-Z19.  Just as in the first version of the device, the sensor is connected via PWM.  An analog switch 74HC4052 was used to connect the rest of the sensors, the screen (it all hangs on one contact) and the module that makes the sounds.  The controller is connected in series to the formaldehyde and dust sensor.  After that, it switches to the screen and displays information.  If it is necessary to sound, the controller switches the switch to the sound module. <br><br>  Sensors of dust, formaldehyde and sound module communicate with the controller via UART.  At the time of polling sensors, or playing sounds, the UART controller switches to alternative contacts and at that moment USB communication with the computer is impossible. <br><br>  In this model, I used a large 2.8 ‚Äùscreen with a resolution of 240x320 pixels.  With SPI interface based on ILI9341 controller. <br><br>  There is no control other than the power button on the device.  Just plug into the outlet (the device has a 5v power supply built-in) and you can monitor the readings. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e8a/60c/cac/e8a60ccac7de113b810d1944b5b6e7e3.jpg" alt="image"><br><br>  The following information is displayed on the screen: In the upper left corner is a clock with a date and a month.  On the right of the clock, the formaldehyde sensor reads in ¬µg / m·∂ü.  The next row is the dust sensor reading.  There are 3 values.  The first dust is less than 1 micron in diameter, the particles are farther than 2.5 microns and the particles to the right are up to 10 microns.  Values ‚Äã‚Äãare displayed in ¬µg / m·∂ü.  Under the dust sensor readings a line of small numbers is displayed.  This is for the most inquisitive, it lists the values ‚Äã‚Äãof the dust particles of different fractions.  The data are given - the number of particles per 1 liter of air. <br><br>  Below is a graph of measurements of CO2 content in air, approximately in the last half hour. <br><br>  At the very bottom, the current value of CO2 concentration in ppm.  On the right there is a traffic light indicating a hazard or the safety of a given concentration of CO2.  The green signal indicates that the concentration is less than 900 ppm and good air quality, yellow is about a stuffy atmosphere and concentrations from 900 to 1500 ppm.  The red signal indicates that the concentration of carbon dioxide is above 1500ppm and it is dangerous for health and badly affects the state of health. <br><br>  When the level of CO2 concentration reaches 900ppm, sneezing is heard from the device.  If the level rises above 1500ppm, the device ‚Äúcoughs‚Äù. <br><br>  On the front side of the device there is a sticker on which are described what parameters of the device what they mean and what are normal, high and dangerous concentrations of gases and dust. <br><br>  Sensors: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/574/69f/b62/57469fb62e9aaa16776089128c69a812.jpg" alt="image"><br><br>  CO2 Sensor MH-Z19 - A non-dispersive infrared sensor (or NDIR sensor) is a simple spectroscopic sensor used as a carbon dioxide detector.  The measurement limit is up to 5000ppm and the lower limit is about 400ppm (natural CO2 level in the atmosphere).  Passport accuracy 50ppm.  The response time is about 30 seconds.  When power is applied, the first minute and a half gives the maximum or minimum readings, then it turns on and outputs real data.  Information from the sensor is obtained by PWM.  At the time of reading, the controller measures the duty cycle of the signal at the sensor output and converts it into the CO2 level by the formula. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cbd/80c/a10/cbd80ca102d9c7cbdea368fe01d20495.jpg" alt="image"><br><br>  Sensor dust PMS5003.  NDIR dust sensor measuring dust concentration divided into 3 fractions of 1, 2.5 and 10 microns separately.  It also has a dust particle counter divided into 6 fractions.  Accuracy declared 10%.  The sensor is used in active mode.  This means that he automatically automatically sends information to the UART at set intervals.  When it is necessary to obtain information from the sensor, the controller connects to it by means of a switch and waits for the next data transmission. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/faa/cb0/c7e/faacb0c7ec64976ee604549c4fe46551.jpg" alt="image"><br><br>  Formaldehyde sensor ZE08-CH2O Thermally stabilized electrochemical sensor.  This sensor is also used in active mode.  He independently, every second sends data to the UART and when the controller switches the switch to it, the data is read. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a40/04b/1cc/a4004b1cc99ffe49bb9fee8a484e4476.jpg" alt="image"><br><br>  To extract various sounds and sound alarms about the condition of the air, a miniature UART-controlled MP3 player - MP3-TF-16P is used.  This board has on board a micro SD card reader, on which sound files are recorded in mp3 format.  There is also a power amplifier and a speaker on the 8th can be connected.  Selection and playback of files recorded on the sd card is controlled by UART from the device controller.  The program has built-in protection against alerts at night.  After 10:00 pm and before 8:00 am no beep sounds. <br><br>  To display the time and date, the DS3231 clock module is used, which operates according to the I2C protocol.  The stated accuracy is 2 minutes per year. <br><br>  An analog switch 74HC4052 is used to switch the ESP8266 main controller between sensors, a screen and a sound module.  This is a dual switch with 4 lines.  ESP8266 uses D9, D10 pins for UART, but we cannot use these pins, since they are connected to the USB adapter built on the controller board.  Fortunately, it is possible to switch the UART outputs to alternative contacts D7, D8.  But these same contacts are used by the ISP bus through which the controller is connected to the display.  In order to deal with this zoo and use the switch.  It has 2 inputs and 4 outputs.  At one point, each input can be connected to one of 4 outputs.  A sensor, or display, or sound module is connected to each output.  According to the control pins, the controller selects which device to connect to at the moment.  When displayed, the controller connects to the display, when reading data to the sensor, and when playing sounds to the mp3 player. <br><br>  The device also uses a fan that blows the closed case with air so that the sensors respond adequately to changes in the atmosphere around the device.  The speed of the fan is controlled by the controller, as if the fan does not reduce it is too much buzzing. <br><br>  The total cycle of polling sensors and displaying information is 5 seconds. <br><br>  Device layout: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ea1/081/5cf/ea10815cfd5bf0d7378ac874563957f9.png" alt="image"><br><br>  Circuit board: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/00b/9cc/b75/00b9ccb75c0af72cdb1d737da1d72a2d.png" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/4c3/7c4/40f/4c37c440f9e6fbbc3ae9ad816a2eda0f.jpg" alt="image"><br><br>  ‚Üí <a href="">Firmware file</a> <br>  ‚Üí <a href="">Script file:</a> <br><br>  ‚Üí <a href="http://www.kirillb.ru/publ/dlja_samostojatelnoj_sborki/opisanie_pribora/sborka_monitora_po_shagam/6-1-0-8">Here is a step by step guide how to assemble the device</a> <br>  ‚Üí <a href="http://www.kirillb.ru/publ/dlja_samostojatelnoj_sborki/opisanie_pribora/proshivaem_esp8266_pod_monitor_vozdukha/6-1-0-10">Here is the firmware manual</a> </div><p>Source: <a href="https://habr.com/ru/post/322080/">https://habr.com/ru/post/322080/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../322068/index.html">How I learned to code, created a web application and launched it on Product Hunt in 2 months</a></li>
<li><a href="../322070/index.html">How to write your keyboard for Android</a></li>
<li><a href="../322072/index.html">How computers were advertised in the 1990s</a></li>
<li><a href="../322076/index.html">Basic principles of machine learning on the example of linear regression</a></li>
<li><a href="../322078/index.html">Telegram bot, webhook and 50 lines of code</a></li>
<li><a href="../322082/index.html">Transition from Google Analytics to Firebase</a></li>
<li><a href="../322084/index.html">How slyamzit Habr in a quick way</a></li>
<li><a href="../322088/index.html">Benefits of Enterprise Mobility Management with Citrix XenMobile</a></li>
<li><a href="../322092/index.html">‚ÄúProgramming as a way of creative implementation‚Äù or Corona SDK for those who want</a></li>
<li><a href="../322094/index.html">Introduction to lock-free programming</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>