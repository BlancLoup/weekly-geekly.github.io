<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Catastrophic backtracking in regular expressions</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Is it possible to kill a system with a simple and innocent regular routine? Yes you can. 

 For example: 



>>> r = '(a+)*b'  
 Just yes. Innocent - ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Catastrophic backtracking in regular expressions</h1><div class="post__text post__text-html js-mediator-article">  Is it possible to kill a system with a simple and innocent regular routine?  Yes you can. <br><br>  For example: <br><br><pre><code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>r = <span class="hljs-string"><span class="hljs-string">'(a+)*b'</span></span></code> </pre> <br>  Just yes.  Innocent - like yes.  Certainly stupid, because the brackets and the asterisk are superfluous, but it should work.  Let's try: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>re.findall(<span class="hljs-string"><span class="hljs-string">'(a+)*b'</span></span>, <span class="hljs-string"><span class="hljs-string">'aaaaaab'</span></span>) [<span class="hljs-string"><span class="hljs-string">'aaaaaa'</span></span>]</code> </pre><br>  Cool, working, let's go drink beer. <br><br>  But no ... <br><a name="habracut"></a><br>  If the string in which we are looking for does not contain the desired pattern, for example, just <i>'aaaaaa'</i> , the compiler will try to find it with the following algorithm: <br><br>  1. The whole drain satisfies <i>'a +'</i> , but we do not find the <i>'b'</i> , a step back. <br>  2. Now <i>'a +'</i> satisfies only <i>'aaaaa'</i> (everything except the last one), the latter satisfies the repetition <i>'*'</i> , <i>'b'</i> is still not found, a step back. <br>  3. The first <i>'a +'</i> satisfies only <i>'aaaa'</i> , the last two <i>'aa'</i> satisfy the repetition of <i>'*'</i> , <i>'b'</i> is still not found, a step backwards. <br>  4. The first <i>'a +'</i> satisfies <i>'aaaa'</i> , the last but one <i>'a'</i> satisfies one repeat of <i>'*'</i> , the next <i>'a'</i> still does not repeat another <i>'*'</i> , <i>'b'</i> ... <br><br>  Well, you understand - and so on.  Up to complete search of a line. <br><br>  Some statistics: <br><pre> <code class="python hljs"><span class="hljs-meta"><span class="hljs-meta">&gt;&gt;&gt; </span></span>timeit.timeit(<span class="hljs-string"><span class="hljs-string">"import re; re.findall('(a+)*n', 'a'*20)"</span></span>, number=<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-number"><span class="hljs-number">0.24741506576538086</span></span> &gt;&gt;&gt; timeit.timeit(<span class="hljs-string"><span class="hljs-string">"import re; re.findall('(a+)*n', 'a'*22)"</span></span>, number=<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-number"><span class="hljs-number">0.99283289909362793</span></span> &gt;&gt;&gt; timeit.timeit(<span class="hljs-string"><span class="hljs-string">"import re; re.findall('(a+)*n', 'a'*24)"</span></span>, number=<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-number"><span class="hljs-number">3.9849259853363037</span></span></code> </pre><br>  As you can see, the execution time grows exponentially.  For larger strings, Python 2.6 on FreeBSD promptly throws out RuntimeError, but on Windows, that same Python cheerfully looks through all the combinations.  Strings with more than 30 characters did not dare to test :) <br><br>  The post is inspired by today's question on <a href="http://stackoverflow.com/questions/8010005/python-re-infinite-execution">stackoverflow</a> and the long-read and successfully forgotten note <a href="http://www.regular-expressions.info/catastrophic.html">Runaway Regular Expressions: Catastrophic Backtracking</a> . <br><br>  PS It turns out that on Habr√© there is already an article about backtracking and atomic groups, there the described problem is considered deeper and more severe - <a href="http://habrahabr.ru/blogs/regex/56765/">Atomic grouping, or Not one step back!</a>  :) </div><p>Source: <a href="https://habr.com/ru/post/131915/">https://habr.com/ru/post/131915/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../131906/index.html">Which social network to post? Instruction</a></li>
<li><a href="../131907/index.html">Microsoft has released a patch for Windows that prevents the Duqu worm from entering the system</a></li>
<li><a href="../131908/index.html">External interrupts for 8-bit avr, using buttons</a></li>
<li><a href="../131909/index.html">All-In-One Note: All Inclusive</a></li>
<li><a href="../131910/index.html">Lazy computing</a></li>
<li><a href="../131916/index.html">Redis, hiredis, libev and multithread. Part 1</a></li>
<li><a href="../131917/index.html">Competition for the creation of HTML5 applications with a prize pool of $ 50,000</a></li>
<li><a href="../131918/index.html">Difficult questions - simple answers or not an ordinary question and answer service</a></li>
<li><a href="../131919/index.html">Macros in Scala, Eugene Burmaco. Screencast, slides and photo with scalaby # 6</a></li>
<li><a href="../131920/index.html">PhpBB 3 spam protection without captcha</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>