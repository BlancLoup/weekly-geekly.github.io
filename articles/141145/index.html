<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Radix Tree structure for data compression</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This topic is about the use of Radix Tree on a practical example. A radix tree or a residual tree is a data structure formed on the principle of stori...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Radix Tree structure for data compression</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/3fa/b90/329/3fab90329e69ccfbc31bac91c1176a5c.png" align="right">  This topic is about the use of Radix Tree on a practical example.  <a href="http://en.wikipedia.org/wiki/Radix_tree">A radix tree</a> or a residual tree is a data structure formed on the principle of storing values ‚Äã‚Äãin a leaf node.  Intermediate nodes are an element of the final value.  This can be a bit for numbers, a character for strings, or a digit for a number, as in the example below.  The above compression algorithm using Radix Tree is used in a real embeded system for storing the parameters of a telephone firewall. <br><a name="habracut"></a><br><br><h4>  Technical task </h4><br>  So the original data. <br>  Suppose we have a phone book, or more simply, a list of contacts.  With every contact <br>  related attribute set.  For the program "telephone firewall" - these may be Boolean attributes: <br>  outgoing / incoming call, work during business / non-working time, allow / block or auto answer <br>  when calling.  The task is to store a list of contacts and their attributes in the phone‚Äôs memory, in a compressed form.  In conditions of a limited amount of available memory. <br><br>  So, a more detailed technical task looks like this: <br>  - There is a .INI file with a set of rules for each number.  The rule contains a phone number <br>  and the actual boolean attributes applicable to it.  The rooms are <i>unique</i> . <br>  Example .INI file, where 12345 is a phone number: <br>  [RULES] <br>  R0000 = 12345,0,0,0,0,0,0,0,0,0,0,0,0 <br>  R0001 = 123764465,0,0,0,0,1,0,1,0,0,0 <br>  ... <br>  R0765 = ... 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      - Internal rule representation: <br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">class</font> NumberEntry <br> { <br> <font color="#0000ff">string</font> number     ; <br> <font color="#0000ff">bool</font> attCalledNumber    ; <br> <font color="#0000ff">bool</font> attCallingNumber  ; <br> <font color="#0000ff">bool</font> attInboundCall    ; <br> <font color="#0000ff">bool</font> attOutboundCall    ; <br> <font color="#0000ff">bool</font> attWorkingHours    ; <br> <font color="#0000ff">bool</font> attNonWorkingHours  ; <br> <font color="#0000ff">bool</font> attBlocked    ; <br> <font color="#0000ff">bool</font> attAllowed    ; <br> <font color="#0000ff">bool</font> attPrefix    ; <br> <font color="#0000ff">bool</font> attAutoAnswer    ; <br> };</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  - For the existing set of rules, you should build an intermediate <i>extended</i> graph. <br>  In the Graph, each node can be marked as a sheet.  For example, take the following set of hypopthetic numbers: <br>  012345 <br>  012346 <br>  01234567 # <br>  54647 <br>  5463 <br>  54638 <br><br>  An intermediate graph should be constructed: <br><img src="https://habrastorage.org/storage2/7c3/cf1/467/7c3cf14674c653adfe655aae250a6821.png"><br>  <i>Figure 1. Extended (not compressed) graph from TK.</i> <br><br>  - Advanced Graph is built according to the following rules: <br>  The last digit of each number in the list indicates a leaf node.  Attributes associated with the number <i>only</i> refer to the leaf node.  In the graph, any node can be marked as a sheet.  For the example above, the number 5 in number 01234 <b>5</b> represents a leaf node, although it is also part of the number 01234 <b>5</b> 67 # <br><br>  - After all the numbers are added to the <i>intermediate graph</i> (Expanded), it should be compressed.  So that each node of the intermediate graph <br>  (eg 0xxx5xxx #), replaced by a sequence of compact nodes (Compact Nodes, without 'x'). <br><br>  The nodes of the extended and compact graph are represented by the following structures: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">#pragma</font> pack(push, 1) <font color="#008000">//    1   MS C++</font> <br> <font color="#0000ff">#define</font> K_MAX_EXPANDED_NODES    12 <font color="#008000">//    .   0-9, *  #</font> <br> <font color="#0000ff">struct</font> SG_Y_DigitElement <font color="#008000">//   , 4 </font> <br> { <br> UINT  digit       : 4; <font color="#008000">//  0-9 . '*'   0xA, '#'  0xB.  12 ,  4 </font> <br> UINT   nextNodeOffset     : 13; <font color="#008000">//    ,    </font> <br> BOOL  leafNode      : 1; <font color="#008000">//  ?</font> <br> <br> BOOL   attCalledNumber    : 1; <font color="#008000">// .     </font> <br> BOOL   attCallingNumber    : 1; <br> BOOL   attInboundCall    : 1; <br> BOOL   attOutboundCall    : 1; <br> BOOL   attWorkingHours    : 1; <br> BOOL   attNonWorkingHours  : 1; <br> BOOL   attBlocked      : 1; <br> BOOL   attAllowed      : 1; <br> BOOL   attPrefix      : 1; <br> BOOL   attAutoAnswer    : 1; <br> BOOL   attReserved1    : 1; <br> BOOL   attReserved2    : 1; <br> BOOL   attReserved3    : 1; <br> BOOL   attReserved4    : 1; <br> } <br> <br> typedef SG_Y_DigitElement SG_Y_ExpandedNode[K_MAX_EXPANDED_NODES]; <br> <br> <font color="#0000ff">struct</font> SG_Y_CompactNode <font color="#008000">//    5 .  +</font> <br> { <br> UINT8  nodeLen   : 4; <br> UINT8  reserved   : 4; <br> <font color="#008000">/*     */</font> <br> SG_Y_DigitElement  digits; <br> } ; <br> <font color="#0000ff">#pragma</font> pack(pop)</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  - Based on the extended graph, which is represented by an array of elements of type SG_Y_ExpandedNode, a compact graph is constructed with nodes of type SG_Y_CompactNode.  Thus, data is compressed by removing empty elements, denoted by 'x', from SG_Y_ExpandedNode.  For the extended graph in the example above, the compact graph will look like this after compression (the green number for the number of digits in the compact node, the nodeLen field of the SG_Y_CompactNode structure): <br><img src="https://habrastorage.org/storage2/8e3/48f/f8c/8e348ff8c4db86008d22173a99ba3c95.png"><br>  <i>Figure 2. Compressed graph of TK.</i> <br><br>  - It should be noted that pointers to nodes (the nextNodeOffset field in SG_Y_DigitElement), in both columns represent an index relative to the first byte of the graph.  Both graphs are represented by arrays. <br><br>  - To summarize the terms of reference: <br><ul><li>  The input is a .INI file with firewall rules for the phone number. </li><li>  Read the rules in the list of type NumberEntry </li><li>  We form an intermediate extended graph based on the list.  Where the leaf node of the graph contains attributes related to the number. </li><li>  We generate a compressed graph by removing empty elements from the extended </li></ul><br><br><h4>  Build an intermediate graph </h4><br>  The first step of the algorithm is trivial.  We assume that the rules are read and added to the list.  We have a set of numbers in the list, which is input to the graph generator.  Here and in the attached sources, the term graph generator (GraphGenerator) is used to denote the class of the build and compression algorithm that implements. <br><br>  We proceed directly to the construction of an intermediate extended graph (Expanded). <br>  Pay attention again to Figure 1. This intermediate graph can be represented by a binary tree built on the principle of the Radix Tree (or the Russian equivalent - the tree of residues).  Let's take a closer look at this data structure. <br><br>  Adding an item to Radix Tree is as follows: <br>  - Every i-th bit of the added value is taken. <br>  - The element is pushed down the tree, based on the current bit.  If the i-th bit is 0, then we go to the left, otherwise to the right. <br>  And so on until all significant bits of the value have been processed. <br>  - As a result, the Radix Tree leaf node will denote the value itself.  So, going from the root to the leaf node, <br>  get all the bits of the value.  An illustration of the approach can be found <a href="http://korzh.net/2010-11-derevo-ostatkov-ili-radix-tree.html">here</a> .  In the Russian wiki description of the Radix Tree yet. <br><br>  For example, take three numbers: <b>0123, 01234, 123</b> .  Then at the first iteration, the tree is built from top to bottom, creating 4 nodes (0,1,2,3-leaf).  In the second iteration, when adding the number 01234, we will follow the same path when adding the elements 0, 1, 2 and 3, since the nodes for these numbers have already been created.  But when adding the last element, being in the node with a value of 3, we create a new leaf node 4. And at the third iteration, adding the number 123, the right side occurs. <br><br>  If we present the obtained tree as a graph, where the node on the right is a ‚Äúbrother‚Äù and the node on the left is a ‚Äúson‚Äù, we get the following picture <br><img src="https://habrastorage.org/getpro/habr/post_images/905/d32/6e1/905d326e1bbab2ec2c15873046423cdb.png"><br>  <i>Figure 3. Link graph</i> <br><br>  Apply the add algorithm to Radix Tree for our extended graph.  The graph node is represented by an array of 12 possible values ‚Äã‚Äã(0-9 * #).  That is, we use the expandedNode [digit] mapping to check and set the node value. <br>  In the figure below, expandedGraph is represented as an array of nodes expandedNode.  '-' indicates an empty element, blue - indicates a leaf node.  Let me remind you that the leaf node in our task contains number attributes. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b10/d9a/bad/b10d9abad99d0387f20f9531b0172371.png"><br>  <i>Figure 4. Extended (uncompressed) graph</i> <br><br>  I think the idea of ‚Äã‚Äãusing Radix Tree is becoming clearer and from the picture itself it is clear that compression can be done by removing empty elements. <br><br><h4>  Compression.  Building a compact graph. </h4><br>  The compression algorithm is relatively simple, and can be described in two sentences.  We have an expanded graph of expandedGraph, represented as an array from expandedNode. <br>  - We take non-empty elements (numbers) from the node expandedGraph [i].  We transfer them to a compressed graph, which is represented by an array of SG_Y_CompactNode.  Set the length of a compact node as the number of non-empty elements. <br>  - Apply a compression procedure for each child node.  Changing links to child elements relative to the beginning of CompactGraph. <br><br>  The compression algorithm is recursive.  We select non-empty elements from the node, and lay them out sequentially in a compressed graph, specifying the length of the node.  Thus, from the extended view node <br>  "01 -----------" we get a compact node '[2] 01', where [2] is the length of the node. <br>  Recursively call the procedure for the child elements '0' and '1'.  Then we associate '0' and '1' with the children relative to the beginning of the squeezed graph. <br><br><img src="https://habrastorage.org/storage2/2d0/ff2/490/2d0ff24908608b08ca8aa1cc593098d5.png"><br>  <i>Figure 5. The result is a compressed graph.</i> <br><br><h4>  Conclusion </h4><br>  - The use of the algorithm is best suited for compressing and storing phone numbers.  Prefixes like <u>codes of mobile operators</u> , country or city <u>codes</u> , allow to store these codes in the root nodes of the graph.  The implementation is directly used in the software of a large telecommunications company. <br>  However, it can be used for any data sequences.  For example, to store Latin character data without case-sensitive, the size of a graph node must be increased to 26 elements.  Accordingly, under the digit field, select 5 bits. <br>  If attributes are not required, then the size of SG_Y_DigitElement can be reduced up to 2 bytes.  For example, 5 bits for a character value, 10 bits for a pointer to the next node, and 1 bit for a sheet marker. <br>  Obviously, restrictions on the number of addressable entries are limited to the nextNodeOffset field.  In our example, 13 bits is enough to address 8192 entries. <br><br>  <a href="">Here is the implementation of the algorithm</a> </div><p>Source: <a href="https://habr.com/ru/post/141145/">https://habr.com/ru/post/141145/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../141140/index.html">Overview of the navigation program Progorod for Android</a></li>
<li><a href="../141141/index.html">Three and a half programs for backup</a></li>
<li><a href="../141142/index.html">Asynchronous state machine: ideology and technology</a></li>
<li><a href="../141143/index.html">Let the morning be kind or Sleep as Android</a></li>
<li><a href="../141144/index.html">JIRA 4.1 integration with Active Directory</a></li>
<li><a href="../141146/index.html">8-bit google maps</a></li>
<li><a href="../141148/index.html">OpenStreetMap News No. 16: a new license and data deletion, OSM is now on site No. 1 in Japan and in the PROGOROD, on-demand map to search for the missing child</a></li>
<li><a href="../141150/index.html">Wikidata: the first new project of the Wikimedia Foundation since 2006</a></li>
<li><a href="../141151/index.html">April 1st on the Internet</a></li>
<li><a href="../141152/index.html">10 million hits a day with WordPress on the server for $ 15</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>