<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Camera support and digit recognition in Opera browser</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I was confused yesterday on excellent. It seemed to me to be boring and sad to enter account numbers for an apartment in the window ‚ÄúGosuslug‚Äù and dec...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Camera support and digit recognition in Opera browser</h1><div class="post__text post__text-html js-mediator-article">  I was confused yesterday on excellent.  It seemed to me to be boring and sad to enter account numbers for an apartment in the window ‚ÄúGosuslug‚Äù and decided to make automatic <a href="http://bolknote.ru/files/opera-cam-recog.html">number recognition</a> , simultaneously studying the work with the camera from the browser. <br><a name="habracut"></a><br><img src="https://habrastorage.org/getpro/habr/post_images/4d6/cd3/45f/4d6cd345fc12234a6c9ad67cb18f8d93.jpg" alt="Recognition" width="660" height="351"><br><br>  Access to the camera is an <a href="http://dev.w3.org/2011/webrtc/editor/webrtc.html">experimental standard</a> , so few of the browsers can boast it, I used a special build <a href="http://snapshot.opera.com/labs/camera/">Opera-Labs-Camera</a> , which can be taken from the Opera snapshots site.  My example will work accordingly, only there, if you want to try, you need to download it. <br><br>  Generally speaking, there is a similar API in Chrome, you only need to <a href="http://www.webrtc.org/running-the-demos">enable it in the config</a> , I did support it, but did not test it. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      API turned out to be simple.  All that needs to be done is to connect the VIDEO tag with the source of the stream video in a special way;  Then I take the video frame 10 times per second and put it in CANVAS (in the screenshot it‚Äôs colored), from there I cut a small area, translate into grayscale, take 75% of the average color and translate everything in b / w. <br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> vid = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">'video-stream'</span></span>); <span class="hljs-comment"><span class="hljs-comment">//   ‚Äî   navigator.getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia; if (navigator.getUserMedia) { //  getUserMedia     ‚Äî callback,  ,  //  ,      navigator.getUserMedia('video', function (stream) { //   ,      VIDEO  vid.src = window.webkitURL ? window.webkitURL.createObjectURL(stream) : stream; }); }</span></span></code> </pre> <br><br>  Most of the three hours that I spent on it, I did the recognition of numbers.  The algorithms that I found on the Internet were very monstrous, and it was boring to rewrite what was done, so I tried several options that came to my mind. <br><br>  As a result, the following algorithm recognizes best of all. <br><br><img src="https://habrastorage.org/storage2/f57/170/78a/f5717078a99aa9ec58351d3f9f4783ce.png" width="450" height="481"><br><br>  At first I obviously break the image into numbers, this is completely uninteresting, but I will briefly describe it.  Moving from the bottom, I look for the lower boundary for the appearance of black pixels, then continue to move until they disappear.  Same left and right.  Then about the same way I look for the boundaries of numbers, discarding too short sequences and interrupting too long (if there are stains on the paper or numbers stuck together). <br><br>  So turn out the rectangles of the numbers. <br><br>  The rest is drawn on the picture - each digit is conventionally divided by a vertical line in the middle.  To the left and right of the line I consider the number of transitions to black color, moving from the center, line by line.  Combinations of pairs of numbers are obtained. <br><br>  For example, in the picture to the left and right of the lines there will be one transition, except for line No. 4, where there will be no transition to the right. <br><br>  I thin them out - the same consecutive ones are replaced by one value.  As a result, the entry for the ‚Äúsix‚Äù will look like this: 1 | 1, 1 | 0, 1 | 1.  The vertical bar here symbolizes my dividing line. <br><br>  Chains are obtained that already characterize the figure quite well, although some figures are not able to recognize this pattern.  Therefore, I consider the number of b / w transitions also in my speculative vertical line. <br><br>  For example, ‚Äú0‚Äù and ‚Äú8‚Äù give the combination ‚Äú1 | 1‚Äù, but differ in the number of transitions on the middle line: two and three, respectively. <br><br>  Actually, on the top screenshot in a large text field, as you can see these combinations.  First there is the number in order, then the indicator for the middle line and, after the colon, two numbers on the left and right sides. <br><br>  Algorithm "noise", due to the fact that the hand is trembling with the paper, because of the lighting.  Therefore, I accumulate statistics and indicate the number that was recognized in this position more often than others.  I reset the statistics if the number of objects on the screen has changed. <br><br>  Not an ideal algorithm, but I didn‚Äôt have a goal to make a production decision. <br><br>  I do not quote the code, it is quite voluminous, available <a href="http://bolknote.ru/files/opera-cam-recog.html">by reference</a> . </div><p>Source: <a href="https://habr.com/ru/post/141624/">https://habr.com/ru/post/141624/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../141543/index.html">We are creating Society 2.0 or a new project from the creators of Web-Observer</a></li>
<li><a href="../141544/index.html">Customize custom blue screen of death</a></li>
<li><a href="../141546/index.html">Part I. InterSystems GlobalsDB .Net - reconnaissance in force with peeping under the hood</a></li>
<li><a href="../141547/index.html">Integration releases in SberTech</a></li>
<li><a href="../141623/index.html">9 major mistakes made in the first year of our startup</a></li>
<li><a href="../141625/index.html">Mixlr - service for music broadcasts</a></li>
<li><a href="../141626/index.html">Devbar: poll results</a></li>
<li><a href="../141627/index.html">Adult .RU</a></li>
<li><a href="../141628/index.html">New version of NetWrix File Server Change Reporter has been released (v 3.3) - software for auditing file servers</a></li>
<li><a href="../141630/index.html">AD Audit Program Overview: Active Directory Change Reporter</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>