<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Elegant login form to admin panel on Laravel and Sentry</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="When creating websites, you have to spend some time on the login and password entry form for accessing the control panel. To speed up the development ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Elegant login form to admin panel on Laravel and Sentry</h1><div class="post__text post__text-html js-mediator-article"> When creating websites, you have to spend some time on the login and password entry form for accessing the control panel.  To speed up the development process, I want to share a recipe for preparing a simple, convenient and elegant login form to the admin panel. <br><br>  The article contains a description of some basic techniques for using Laravel in the development of sites and will be useful to those who are starting to master this framework.  For example, using Ubuntu 12.04, PostgreSQL 9.3, Nginx 1.1.19, PHP 5.5.7, Composer and a fresh project created using Laravel 4.1.  Under the control of PostgreSQL, the examples database is rotated, to which the user of examples with the same password has access.  Nginx is configured in such a way that when contacting <code><a href="http://examples.loc/"></a> examples.loc</code>  <code><a href="http://examples.loc/"></a> examples.loc</code> browser <code><a href="http://examples.loc/"></a> examples.loc</code> opens the main stub page that comes with the Laravel bundled, with the words "You have arrived." <br><a name="habracut"></a><br>  All paths to editable files are relative to the project directory. <br><br><h4>  Environment </h4><br>  First I set up the local environment in Laravel.  To do this, create the <code>app/config/local</code> directory and add the <code>database.php</code> file to it: <br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-comment"><span class="hljs-comment">/** * app/config/local/database.php */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'default'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'pgsql'</span></span>, <span class="hljs-string"><span class="hljs-string">'connections'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'pgsql'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'driver'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'pgsql'</span></span>, <span class="hljs-string"><span class="hljs-string">'host'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'localhost'</span></span>, <span class="hljs-string"><span class="hljs-string">'database'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'examples'</span></span>, <span class="hljs-string"><span class="hljs-string">'username'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'examples'</span></span>, <span class="hljs-string"><span class="hljs-string">'password'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'examples'</span></span>, <span class="hljs-string"><span class="hljs-string">'charset'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'utf8'</span></span>, <span class="hljs-string"><span class="hljs-string">'prefix'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">'schema'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'public'</span></span>, ), ), );</code> </pre><br>  I ask Laravel to use the <code>local</code> environment by default.  To do this, edit the bootstrap / start.php file and replace the line <code>'your-machine-name'</code> with <code>'*'</code> : <br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//   bootstrap/start.php $env = $app-&gt;detectEnvironment(array( 'local' =&gt; array('*'), ));</span></span></code> </pre>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Sentry connection </h4><br>  A link to the instructions for connecting Sentry can be found at the end of the article.  Briefly, I do the following. <br>  I <code>"cartalyst/sentry": "2.0.*"</code> line <code>"cartalyst/sentry": "2.0.*"</code> to <code>composer.json</code> <code>"cartalyst/sentry": "2.0.*"</code> In the <code>require</code> block. <br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//  composer.json { "name": "laravel/laravel", "description": "The Laravel Framework.", "keywords": ["framework", "laravel"], "license": "MIT", "require": { "laravel/framework": "4.1.*", "cartalyst/sentry": "2.0.*" }, ...</span></span></code> </pre><br>  I execute the command: <br> <code>$ composer update</code> <br> <div class="spoiler">  <b class="spoiler_title">$ Character is not necessary to dial</b> <div class="spoiler_text">  The $ symbol means that you need to type <code>composer update</code> on the command line. </div></div><br>  I add to the list of service providers in the file app / config / app.php: <br> <code>'Cartalyst\Sentry\SentryServiceProvider',</code> <br> <br>  I add to the list of aliases in the file app / config / app.php: <br> <code>'Sentry' =&gt; 'Cartalyst\Sentry\Facades\Laravel\Sentry',</code> <br> <br>  Perform Sentry migrations: <br> <code>$ php artisan migrate --package=cartalyst/sentry</code> <br> <br>  I publish the Sentry configuration file: <br> <code>$ php artisan config:publish cartalyst/sentry</code> <br> <br>  I open for editing <code>app/config/packages/cartalyst/sentry/config.php</code> .  I find in it the string <code>'login_attribute' =&gt; 'email'</code> and replace it with <code>'login_attribute' =&gt; 'username'</code> , in order for Sentry to authenticate the user by his login, and not by e-mail. <br><br>  During the Sentry migrations, a <code>users</code> table was created, in which there is an <code>email</code> field, but no <code>username</code> .  Therefore, in order for Sentry to work, you must add the missing field.  To do this, create a migration: <br> <code>$ php artisan migrate:make alter_users_add_username</code> <br> <br>  A file will appear in the <code>app/database/migration</code> directory, which will consist of the current date and time and ends with <code>alter_users_add_username.php</code> .  I edit it as follows: <br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-comment"><span class="hljs-comment">/** * app/database/migration/0000_00_00_000000_alter_users_add_username.php */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Illuminate</span></span>\<span class="hljs-title"><span class="hljs-title">Database</span></span>\<span class="hljs-title"><span class="hljs-title">Migrations</span></span>\<span class="hljs-title"><span class="hljs-title">Migration</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AlterUsersAddUsername</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Migration</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** * Run the migrations. * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> void */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">up</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Schema::table(<span class="hljs-string"><span class="hljs-string">'users'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($table)</span></span></span><span class="hljs-function"> </span></span>{ $table-&gt;string(<span class="hljs-string"><span class="hljs-string">'username'</span></span>); }); } <span class="hljs-comment"><span class="hljs-comment">/** * Reverse the migrations. * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> void */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">down</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Schema::table(<span class="hljs-string"><span class="hljs-string">'users'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($table)</span></span></span><span class="hljs-function"> </span></span>{ $table-&gt;dropColumn(<span class="hljs-string"><span class="hljs-string">'username'</span></span>); }); } }</code> </pre><br>  To verify the migration I perform: <br> <code>$ php artisan migrate</code> <br> <br>  To verify that the migration is successfully rolled back, I run: <br> <code>$ php artisan migrate:rollback</code> <br> <br>  I create another migration that adds a superuser entry to the <code>users</code> table: <br> <code>$ php artisan migrate:make add_user_admin</code> <br> <br>  I find a file in the <code>app/database/migrate</code> directory that ends with <code>add_user_admin.php</code> and edit it: <br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-comment"><span class="hljs-comment">/** * app/database/migration/0000_00_00_000001_add_user_admin.php */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">use</span></span> <span class="hljs-title"><span class="hljs-title">Illuminate</span></span>\<span class="hljs-title"><span class="hljs-title">Database</span></span>\<span class="hljs-title"><span class="hljs-title">Migrations</span></span>\<span class="hljs-title"><span class="hljs-title">Migration</span></span>; <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AddUserAdmin</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Migration</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** * Run the migrations. * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> void */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">up</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ $user = Sentry::createUser(<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'username'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'admin'</span></span>, <span class="hljs-string"><span class="hljs-string">'email'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'admin@examples.loc'</span></span>, <span class="hljs-string"><span class="hljs-string">'password'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'password'</span></span>, <span class="hljs-string"><span class="hljs-string">'activated'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-string"><span class="hljs-string">'permissions'</span></span> =&gt; <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'superuser'</span></span> =&gt; <span class="hljs-number"><span class="hljs-number">1</span></span>, ), )); } <span class="hljs-comment"><span class="hljs-comment">/** * Reverse the migrations. * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> void */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">down</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ User::where(<span class="hljs-string"><span class="hljs-string">'username'</span></span>, <span class="hljs-string"><span class="hljs-string">'='</span></span>, <span class="hljs-string"><span class="hljs-string">'admin'</span></span>)-&gt;firstOrFail()-&gt;delete(); } }</code> </pre><br>  I check how migrations are rolling and rolling back.  And I turn to creating a controller that will be responsible for authenticating users. <br><br><h4>  Login form </h4><br>  In the <code>app/controllers</code> directory <code>app/controllers</code> create the file <code>AuthController.php</code> : <br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-comment"><span class="hljs-comment">/** * app/controllers/AuthController.php */</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AuthController</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BaseController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** *    * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> Illuminate\View\View */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getLogin</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ $title = <span class="hljs-string"><span class="hljs-string">''</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> View::make(<span class="hljs-string"><span class="hljs-string">'auth.login'</span></span>, compact(<span class="hljs-string"><span class="hljs-string">'title'</span></span>)); } }</code> </pre><br>  The <code>getLogin()</code> method passes the page title via the <code>$title</code> variable to the <code>auth.login</code> , which serves to display the login page to the admin panel. <br><br>  I create representation <code>auth.login</code> .  To do this, add the <code>auth</code> directory to the <code>app/views</code> directory and create the <code>login.blade.php</code> file in it: <br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">/** * app/views/auth/login.blade.php */</span></span> @extends(<span class="hljs-string"><span class="hljs-string">'layout'</span></span>) @section(<span class="hljs-string"><span class="hljs-string">'main'</span></span>) &lt;div <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">container</span></span></span><span class="hljs-class">"&gt; </span></span>{{ Form::open(<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'class'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'form-signin'</span></span>)) }} @<span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!$errors-&gt;isEmpty()) &lt;div <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">alert</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">alert</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">danger</span></span></span><span class="hljs-class">"&gt; @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">foreach</span></span></span><span class="hljs-class"> ($</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">errors</span></span></span><span class="hljs-class">-&gt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">all</span></span></span><span class="hljs-class">() </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">as</span></span></span><span class="hljs-class"> $</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">error</span></span></span><span class="hljs-class">) &lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">p</span></span></span><span class="hljs-class">&gt;</span></span>{{ $error }}&lt;/p&gt; @<span class="hljs-keyword"><span class="hljs-keyword">endforeach</span></span> &lt;/div&gt; @<span class="hljs-keyword"><span class="hljs-keyword">endif</span></span> &lt;h2 <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">form</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">signin</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">heading</span></span></span><span class="hljs-class">"&gt;</span></span>{{ $title }}&lt;/h2&gt; {{ Form::text(<span class="hljs-string"><span class="hljs-string">'username'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'class'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'form-control'</span></span>, <span class="hljs-string"><span class="hljs-string">'placeholder'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">''</span></span>)) }} {{ Form::password(<span class="hljs-string"><span class="hljs-string">'password'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'class'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'form-control'</span></span>, <span class="hljs-string"><span class="hljs-string">'placeholde'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">''</span></span>)) }} &lt;label <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class">="</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">checkbox</span></span></span><span class="hljs-class">"&gt; </span></span>{{ Form::checkbox(<span class="hljs-string"><span class="hljs-string">'remember-me'</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>) }}   &lt;/label&gt; {{ Form::submit(<span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'class'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'btn btn-lg btn-primary btn-block'</span></span>)) }} {{ Form::close() }} &lt;/div&gt; @stop</code> </pre><br>  The <code>login.blade.php</code> template extends the <code>layout.blade.php</code> template.  Therefore, I create it in the <code>app/views</code> directory: <br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">/** * app/views/layout.blade.php */</span></span> &lt;!DOCTYPE html&gt; &lt;html&gt; &lt;head&gt; &lt;meta charset=<span class="hljs-string"><span class="hljs-string">"utf-8"</span></span>&gt; &lt;title&gt;{{ $title }}&lt;/title&gt; @section(<span class="hljs-string"><span class="hljs-string">'styles'</span></span>) {{ HTML::style(<span class="hljs-string"><span class="hljs-string">'//netdna.bootstrapcdn.com/bootstrap/3.0.3/css/bootstrap.min.css'</span></span>) }} {{ HTML::style(URL::asset(<span class="hljs-string"><span class="hljs-string">'styles/base.css'</span></span>)) }} @show &lt;/head&gt; &lt;body&gt; @<span class="hljs-keyword"><span class="hljs-keyword">yield</span></span>(<span class="hljs-string"><span class="hljs-string">'main'</span></span>) @section(<span class="hljs-string"><span class="hljs-string">'scripts'</span></span>) {{ HTML::script(<span class="hljs-string"><span class="hljs-string">'//netdna.bootstrapcdn.com/bootstrap/3.0.3/js/bootstrap.min.js'</span></span>) }} @show &lt;body&gt; &lt;/html&gt;</code> </pre><br>  After there is a controller method and the representation returned to it, it is necessary to set up routing so that GET requests sent to <code><a href="http://examples.loc/login"></a> examples.loc/login</code>  <code><a href="http://examples.loc/login"></a> examples.loc/login</code> , processed by the <code>getLogin()</code> method.  To do this, add the following code to the file <code>app/routes.php</code> : <br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//  app/routes.php ... Route::group(array('before' =&gt; 'guest'), function () { Route::get('login', array( 'as' =&gt; 'auth.login', 'uses' =&gt; 'AuthController@getLogin' )); });</span></span></code> </pre><br>  Using <code>Route::get()</code> define a route called <code>auth.login</code> , which sends GET requests to the <code>/login</code> method of <code>getLogin()</code> <code>AuthController</code> . <br>  Also put the auth.login <code>auth.login</code> into groups of routes.  Before any route included in this group, the <code>guest</code> filter will be executed.  This filter means that GET requests to the <code>/login</code> address will only be processed if the user is a guest, i.e.  not authorized <br><br>  I will rewrite the <code>guest</code> filter so that it uses Sentry.  To do this, in the file <code>app/filters.php</code> will change the <code>guest</code> filter code: <br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//  app/filters.php ... Route::filter('guest', function() { if (Sentry::check()) return Redirect::to('/'); }); ...</span></span></code> </pre><br>  Now you can see what the login form in the browser looks like.  To do this, go to <code><a href="http://examples.loc/login"></a> examples.loc/login</code>  <code><a href="http://examples.loc/login"></a> examples.loc/login</code> and ... <br><br>  I see the error message <code>Call to undefined method Illuminate\Cookie\CookieJar::get()</code> . <br><br>  With a little google google, I‚Äôm finding out that Sentry 2.0 is compatible with Laravel 4.0, but not compatible with 4.1.  It's good that Sentry 2.1 has already been released.  To get rid of the error, change the version of Sentry in <code>composer.json</code> to 2.1: <br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//  composer.json { "name": "laravel/laravel", "description": "The Laravel Framework.", "keywords": ["framework", "laravel"], "license": "MIT", "require": { "laravel/framework": "4.1.*", "cartalyst/sentry": "2.1.*" }, ...</span></span></code> </pre><br>  I execute the command: <br> <code>$ composer update</code> <br> <br>  Once again I try to open <code><a href="http://examples.loc/login"></a> examples.loc/login</code>  <code><a href="http://examples.loc/login"></a> examples.loc/login</code> and see the login form and password.  In order for the form to look elegant, you need to add a little CSS.  To do this, in the <code>public</code> directory, create a <code>styles</code> directory and add the <code>base.css</code> file <code>base.css</code> : <br><pre> <code class="css hljs"><span class="hljs-comment"><span class="hljs-comment">/** * public/style/base.css */</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">body</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">padding-top</span></span>: <span class="hljs-number"><span class="hljs-number">40px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">padding-bottom</span></span>: <span class="hljs-number"><span class="hljs-number">40px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">background-color</span></span>: <span class="hljs-number"><span class="hljs-number">#eee</span></span>; } <span class="hljs-selector-class"><span class="hljs-selector-class">.form-signin</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">max-width</span></span>: <span class="hljs-number"><span class="hljs-number">330px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">padding</span></span>: <span class="hljs-number"><span class="hljs-number">15px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">margin</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span> auto; } <span class="hljs-selector-class"><span class="hljs-selector-class">.form-signin</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.form-signin-heading</span></span>, <span class="hljs-selector-class"><span class="hljs-selector-class">.form-signin</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.checkbox</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">margin-bottom</span></span>: <span class="hljs-number"><span class="hljs-number">10px</span></span>; } <span class="hljs-selector-class"><span class="hljs-selector-class">.form-signin</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.form-signin-heading</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">text-align</span></span>: center; } <span class="hljs-selector-class"><span class="hljs-selector-class">.form-signin</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.checkbox</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">font-weight</span></span>: normal; } <span class="hljs-selector-class"><span class="hljs-selector-class">.form-signin</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.form-control</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">position</span></span>: relative; <span class="hljs-attribute"><span class="hljs-attribute">font-size</span></span>: <span class="hljs-number"><span class="hljs-number">16px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">height</span></span>: auto; <span class="hljs-attribute"><span class="hljs-attribute">padding</span></span>: <span class="hljs-number"><span class="hljs-number">10px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">-webkit-box-sizing</span></span>: border-box; <span class="hljs-attribute"><span class="hljs-attribute">-moz-box-sizing</span></span>: border-box; <span class="hljs-attribute"><span class="hljs-attribute">box-sizing</span></span>: border-box; } <span class="hljs-selector-class"><span class="hljs-selector-class">.form-signin</span></span> <span class="hljs-selector-class"><span class="hljs-selector-class">.form-control</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:focus</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">z-index</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>; } <span class="hljs-selector-class"><span class="hljs-selector-class">.form-signin</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">input</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[type="text"]</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">margin-bottom</span></span>: -<span class="hljs-number"><span class="hljs-number">1px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">border-bottom-left-radius</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">border-bottom-right-radius</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>; } <span class="hljs-selector-class"><span class="hljs-selector-class">.form-signin</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">input</span></span><span class="hljs-selector-attr"><span class="hljs-selector-attr">[type="password"]</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">margin-bottom</span></span>: <span class="hljs-number"><span class="hljs-number">10px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">border-top-left-radius</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">border-top-right-radius</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>; }</code> </pre><br><br><h4>  Controllers </h4><br>  Now the form is displayed beautifully, but when you click on the "Login" button, an error 404 is returned. So you need to add to the <code>AuthController</code> a POST request handler sent to the <code>/login</code> address. <br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-comment"><span class="hljs-comment">/** * app/controllers/AuthController.php */</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AuthController</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BaseController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** *    * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> Illuminate\View\View */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getLogin</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ $title = <span class="hljs-string"><span class="hljs-string">''</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> View::make(<span class="hljs-string"><span class="hljs-string">'auth.login'</span></span>, compact(<span class="hljs-string"><span class="hljs-string">'title'</span></span>)); } <span class="hljs-comment"><span class="hljs-comment">/** *      * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> Illuminate\Http\RedirectResponse */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">postLogin</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Input::flash(); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { $credentials = <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'username'</span></span> =&gt; Input::get(<span class="hljs-string"><span class="hljs-string">'username'</span></span>), <span class="hljs-string"><span class="hljs-string">'password'</span></span> =&gt; Input::get(<span class="hljs-string"><span class="hljs-string">'password'</span></span>) ); $user = Sentry::authenticate($credentials, Input::get(<span class="hljs-string"><span class="hljs-string">'remember-me'</span></span>)); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">Exception</span></span> $e) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Redirect::to(route(<span class="hljs-string"><span class="hljs-string">'auth.login'</span></span>)) -&gt;withErrors(<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>($e-&gt;getMessage())); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Redirect::intended(route(<span class="hljs-string"><span class="hljs-string">'admin'</span></span>)); } <span class="hljs-comment"><span class="hljs-comment">/** *   * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> Illuminate\Http\RedirectResponse */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getLogout</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Sentry::logout(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Redirect::route(<span class="hljs-string"><span class="hljs-string">'auth.login'</span></span>); } }</code> </pre><br>  In the <code>postLogin()</code> method, the data passed through the form is stored in the session using <code>Input::flash()</code> .  In the <code>try</code> block, the Sentry attempts to authenticate the user.  If the user sets the ‚ÄúRemember me‚Äù checkbox in the login and password entry form, then the second parameter in <code>Sentry::authenticate()</code> will be passed to <code>true</code> and the Sentry will remember the user in case of successful authentication.  If authentication for any reason is not successful, then in the <code>catch</code> the <code>Redirect::to()</code> method will send us to the login and password entry page in the place with an error message.  In the case of successful authentication, the <code>Redirect::intended()</code> method will send the user to the page he intended to enter when he was redirected to the login and password entry form.  If such a page is not set, then the page at the address <code>/admin</code> is opened, with which a route is named <code>admin</code> . <br><br>  The <code>getLogin()</code> method is the <code>getLogin()</code> implement as you can log off the user.  After logging out, the user will be redirected to the login and password entry page. <br><br>  Before proceeding to setting up routing, you need to add a method that will handle requests sent to <code>/admin</code> .  To do this, edit the file <code>app/controllers/HomeController.php</code> as follows: <br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-comment"><span class="hljs-comment">/** * app/controllers/HomeController.php */</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HomeController</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BaseController</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">showWelcome</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> View::make(<span class="hljs-string"><span class="hljs-string">'hello'</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getAdmin</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> link_to(route(<span class="hljs-string"><span class="hljs-string">'auth.logout'</span></span>), <span class="hljs-string"><span class="hljs-string">''</span></span>); } }</code> </pre><br>  The <code>getAdmin()</code> method simply displays the ‚ÄúExit‚Äù link on the page, when clicked, the user will be logged out. <br><br><h4>  Routing </h4><br>  Now, in order for the new methods to process the request, <code>app/routes.php</code> edit it in the <code>app/routes.php</code> : <br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">/** * app/routes.php */</span></span> Route::get(<span class="hljs-string"><span class="hljs-string">'/'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> View::make(<span class="hljs-string"><span class="hljs-string">'hello'</span></span>); }); Route::group(<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'before'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'guest'</span></span>), <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Route::get(<span class="hljs-string"><span class="hljs-string">'login'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'as'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'auth.login'</span></span>, <span class="hljs-string"><span class="hljs-string">'uses'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'AuthController@getLogin'</span></span> )); Route::post(<span class="hljs-string"><span class="hljs-string">'login'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'before'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'csrf'</span></span>, <span class="hljs-string"><span class="hljs-string">'uses'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'AuthController@postLogin'</span></span> )); }); Route::group(<span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'before'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'auth'</span></span>), <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ Route::get(<span class="hljs-string"><span class="hljs-string">'admin'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'as'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'admin'</span></span>, <span class="hljs-string"><span class="hljs-string">'uses'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'HomeController@getAdmin'</span></span>, )); Route::get(<span class="hljs-string"><span class="hljs-string">'logout'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>( <span class="hljs-string"><span class="hljs-string">'as'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'auth.logout'</span></span>, <span class="hljs-string"><span class="hljs-string">'uses'</span></span> =&gt; <span class="hljs-string"><span class="hljs-string">'AuthController@getLogout'</span></span> )); });</code> </pre><br>  The first group of routes, before which the <code>guest</code> filter is executed, contains the routing for the <code>/login</code> address for GET and POST requests.  The <code>guest</code> filter means that requests from only guests will be processed at the <code>/login</code> address, i.e.  unauthorized users. <br><br>  The second group of routes, before which the <code>auth</code> filter is executed, contains routing for the <code>/admin</code> and <code>/logout</code> addresses.  The <code>auth</code> filter means that only addresses from authorized users will be processed at these addresses. <br><br>  You also need to edit the <code>auth</code> filter so that it uses Sentry.  To do this, open the file <code>app/filters.php</code> change the <code>auth</code> filter as follows: <br><pre> <code class="php hljs"><span class="hljs-comment"><span class="hljs-comment">//  app/filters.php ... Route::filter('auth', function() { if (!Sentry::check()) return Redirect::guest(route('auth.login')); }); ...</span></span></code> </pre><br><br>  Now you can try to login to admin panel using admin username and password password.  An unauthorized user will not be able to access the <code>/admin</code> page, it will be available only after successful authentication.  Also, after authentication, it will be impossible to enter the <code>/login</code> page, as there will be a redirect to the main page. <br><br>  I hope this example will help novice developers to better understand some elements of Laravel. <br><br><h4>  Related Links </h4><br>  <a href="">getcomposer.org/doc/00-intro.md#installation-nix</a> <br>  <a href="http://laravel.com/docs/installation">laravel.com/docs/installation#install-laravel</a> <br>  <a href="https://cartalyst.com/manual/sentry/installation/laravel-4">cartalyst.com/manual/sentry/installation/laravel-4</a> <br><br>  UPD <br>  Sample code <a href="https://github.com/bskton/examples/tree/eform">github.com/bskton/examples/tree/eform</a> </div><p>Source: <a href="https://habr.com/ru/post/206908/">https://habr.com/ru/post/206908/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../206894/index.html">Tree list on ASP.NET MVC 4</a></li>
<li><a href="../206896/index.html">All that merge: ribosomal software architecture</a></li>
<li><a href="../206898/index.html">Backing up web projects on Yandex.Disk without OOP and models</a></li>
<li><a href="../206900/index.html">Is Telegram Safe? Or as I was looking for a bookmark in MTProto</a></li>
<li><a href="../206904/index.html">FTCA Data Clustering Algorithm</a></li>
<li><a href="../206910/index.html">Wake On Lan After Power Failure (or Out of G3)</a></li>
<li><a href="../206912/index.html">My fanless HTPC in HD-PLEX</a></li>
<li><a href="../206914/index.html">Programming for iOS. For professionals</a></li>
<li><a href="../206918/index.html">Graphing tools for .NET. Part 2</a></li>
<li><a href="../206920/index.html">TCP / IP stack organization for MK based on the embedded module Tibbo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>