<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>What does it cost us to build a PCI-E riser</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Once upon a time I collected myself a mini-computer . But here's the ill luck - 3D modeling and what a sin to hide - banal toys made this box take a l...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>What does it cost us to build a PCI-E riser</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/p2/bj/wm/p2bjwmqo6yot_eufjkklj-p9oqu.jpeg"><br><br>  Once upon a time I collected myself a <a href="https://habr.com/post/398875/">mini-computer</a> .  But here's the ill luck - 3D modeling and what a sin to hide - banal toys made this box take a lot of thought, and make me nervous.  But you can't just take and connect a video card to it - there is a PCI-E X4 slot, but there is no space in the case.  Yes, and nutrition will not be able to provide (if not to talk about quite a budget gags).  What are the solutions to this problem on the market, what they did not suit me and what happened in the end, I will try to describe in this article.  I ask under the cut, who is not afraid of a <b>large number of pictures</b> ! <br><a name="habracut"></a><br><h4>  <font color="#9cc2ce">Prologue</font> </h4><br>  To connect the video card, a 4-line PCI-E riser with additional power was required with the ability to control it if the power supply was separate.  So, the usual loop-outs and many are painfully familiar due to mining a riser with a USB cable as an interface cable. <br><br><img src="https://habrastorage.org/webt/z3/-v/qf/z3-vqfkmh5u-8rf9nk5d6btibjs.png"><br>  <font color="gray"><i>Bulk products with bulk quality</i></font> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      But that of more or less satisfying my requests can be found in the vast network: <br><br><ul><li>  <u>PE4C V4.1</u> - first of all, the board installed in the slot obviously did not fit into my PC in terms of dimensions.  And the HDMI cables themselves are pretty hard, and there are 2 of them here too!  And the price of ~ $ 140 seemed to me not quite humane. <br><br><img src="https://habrastorage.org/webt/o_/6f/gp/o_6fgpmt7rycyfm4d6gzqdzrvq8.jpeg"><br></li></ul><br><ul><li>  <u>EXP GDC</u> - there was a version for the pci-e x4 slot, but it also had the inhuman price, 2 previously encountered HDMI cables.  Now I can‚Äôt even find her picture - it was rarely sold outside of China.  But for the pci-e x4 slot, the board is even bigger than the PE4C <br><br><img src="https://habrastorage.org/webt/5t/lh/5y/5tlh5y3hjqp6ubkdkoasdcbzwt0.jpeg"><br>  <font color="gray"><i>Version for M2.</i></font>  <font color="gray"><i>And for a regular PCI-E slot, it‚Äôs as if nothing has sunk</i></font> <br></li></ul><br><ul><li>  <u>ADT-Link riser</u> - was not presented at the time of my throwing.  And now the information on them is not thick.  But it seemed to me <s>wildly</s> strange to vary so much the price of the device from the length of the loop. <br><br><img src="https://habrastorage.org/webt/wn/ae/nx/wnaenxuhmyhic2x2yeevmleii7g.jpeg"><br></li></ul><br>  Not finding a suitable solution for myself, I had to choose from two options - to score or make it myself.  It is clear that for the first version the article could have been completed on this, but I, perhaps, will continue. <br><br><h4>  <font color="#9cc2ce">Design</font> </h4><br>  After talking in various communities dedicated to this topic, it was decided to make the riser versatile, not just for yourself - to the laptop (via Mini Pci-E, M2 or even MXM) and to the computer in slot x16 without limitation to only 4 data lines ! <br><br>  Here is a list of requirements that I set for myself: <br><br><ul><li>  Power supply only 12v.  3.3v receive at the riser itself using dc-dc converter. </li><li>  Power management is not dependent on the type of power supply used (controlled by ATX or normal power supply at 12v) </li><li>  Connection of various adapters through detachable cables of the same type (without soldering). </li><li>  Split the x16 interface into 4 groups.  Thus for the x1-x4 interface - 1 cable, x8 - 2 cables and 4 cables for x16. </li><li>  Sometimes I see a situation when a video card connected to a laptop through EXP GDC was fed by a notebook power supply unit to 19v (a plug is present, it is necessary to plug in) prompted to add an indication of the input voltage within acceptable limits: 12v ¬± 5%. </li></ul><br><h4>  <font color="#9cc2ce">Implementation</font> </h4><br>  Desires are described, courage has accumulated enough - it's time to embody!  The riser is essentially an extension cord.  And the cable is its main part.  As such, varieties of LVDS cables were used - the so-called micro coaxial cable assembly.  They are often used to connect the matrix displays of various devices. <br><br><img src="https://habrastorage.org/webt/pj/er/0f/pjer0feihmdlcf3js7dpts-z_xw.png"><br>  <font color="gray"><i>18+ bare cable</i></font> <br><br><img src="https://habrastorage.org/webt/sb/zy/ce/sbzycezhtq51c9qlmn1pow8wva8.png"><br>  <font color="gray"><i>30 lived and only 2mm in diameter</i></font> <br><br>  Although it is extremely difficult to find them on the open market, I managed to find a manufacturer in China ready to manufacture such cables in any quantity (even 1pc) of any length and with a suitable connector. <br><br>  When the choice of interface cable was finished, I was finally able to work on the design of the riser board and the selection of components.  In the end, the designed boards were ordered, the components were purchased and everything was put together: <br><br><img src="https://habrastorage.org/webt/vv/mo/qz/vvmoqzz8uiuk_tpq6kuu3j3gebo.jpeg"><br>  <font color="gray"><i>Top of the board</i></font> <br><br><img src="https://habrastorage.org/webt/r7/r1/sj/r7r1sjjqoryuinebpfp_vbta-co.jpeg"><br>  <font color="gray"><i>Bottom of the board</i></font> <br><br><ol><li>  Power connector 8pin (15A maximum current), combined with a turn-on signal (for ATX power supplies) </li><li>  The indication of the supply voltage within the acceptable limits (+ 12v ¬± 5%) on the window comparator.  Green LED - voltage is normal, red - out of range </li><li>  Power management - Mosfet for the case of using a power source without control and giving a PS ON signal.  The control signal is the 3.3v power supply on the host. </li><li>  Step-down DC \ DC to get 3.3v </li><li>  Cooler connector </li><li>  LVDS connectors for interface cables </li><li>  PCI-E x16 slot </li><li>  Protection against short circuit and over voltage - fuse and TVS diode. </li><li>  Connecting additional power video card </li></ol><br>  On the other side of the cable, the adapter board for the slot of the end device: <br><br><img src="https://habrastorage.org/webt/yo/k4/mw/yok4mw0n4kfakoz02-wz0sdkyhc.jpeg"><br><br>  The weighty minus of such a solution (as well as among analogs) is that you cannot quickly connect / disconnect a riser without having to disassemble a laptop / computer.  And the connectors themselves are not intended for external use and have low mechanical strength and low resource.  Therefore, I additionally made such an adapter with more reliable connectors (the cable itself with such connectors cannot be made immediately ... for reasonable money): <br><br><img src="https://habrastorage.org/webt/j4/jz/ww/j4jzwwivpvc5wn2o_ifthhzvmcu.jpeg"><br>  <font color="gray"><i>Similar connectors were used in docking stations for smartphones, tablets and other devices.</i></font> <br><br><img src="https://habrastorage.org/webt/fw/o8/z5/fwo8z5ygz-xrb5rkktvomw-2ljg.jpeg"><br>  <font color="gray"><i>Connection using 2 cables, and these adapters connect them</i></font> <br><br><h4>  <font color="#9cc2ce">Testing</font> </h4><br>  All components on the board are soldered, cables are connected - it's time to cross your fingers and test! <br><br> <a href=""><img src="https://habrastorage.org/webt/rr/0k/k-/rr0kk-g4bbpgdbyh5bqqt921ofw.jpeg"></a> <br>  <font color="gray"><i>The photo is a prototype and has differences from the final version.</i></font> <br><br> <a href=""><img src="https://habrastorage.org/webt/lf/tm/bj/lftmbj8hmxxvdbe4kq8yy9uuqdo.jpeg"></a> <br>  <font color="gray"><i>As they connected with 2 interface cables, they got PCI-E x8.</i></font> <br><br> <a href=""><img src="https://habrastorage.org/webt/lz/tf/hv/lztfhvmz7pevnyjetd92pqlytgq.jpeg"></a> <br>  <font color="gray"><i>When passing various tests, there were no problems and the video card worked stably under load, and the bus frequency increased (gen3)</i></font> <br><br>  For testing, I managed to get a laptop with an M2 Key M slot with NVME support - MSI GE62 6QD.  But for the prototype, an adapter was made with M + B keys for greater versatility, so it is possible to use only 2 lines out of 4 available: <br><br><img src="https://habrastorage.org/webt/9r/n5/4v/9rn54vaeb-xawf7yk2brqiyqric.jpeg"><br>  <font color="gray"><i>Since this was a prototype, the use of electrical tape and the removal of dc / dc on a separate fee is quite appropriate.</i></font> <br><br><img src="https://habrastorage.org/webt/fy/sz/sp/fyszspm12mxmhpjypn5tmcn8tig.jpeg"><br>  <font color="gray"><i>Starting a laptop with EGPU.</i></font>  <font color="gray"><i>BP starts automatically when you turn on the laptop</i></font> <br><br> <a href=""><img src="https://habrastorage.org/webt/ys/kc/vh/yskcvhwvjr4gpt4peovc6xez95s.jpeg"></a> <br>  <font color="gray"><i>Due to the presence of an integrated and discrete graphics card in the laptop, I had to tinker with installing drivers</i></font> <br><br> <a href=""><img src="https://habrastorage.org/webt/y1/xc/88/y1xc88bommcd9fphyak-6ypcvra.jpeg"></a> <br>  <font color="gray"><i>Work under load</i></font> <br><br>  Unfortunately, these glands were in my possession for an extremely short time and I did not have the opportunity to conduct more detailed testing after receiving the final version of the riser.  So it was necessary to be content only with such iron: <br><br><ul><li>  MP Asus Q87T </li><li>  CPU Core I3 4150T </li><li>  RAM 2 * 4GB Crucial DDR3L SO-DIMM PC-12800 </li><li>  Intel Dual-Band Wireless-AC 7260 Wi-Fi / BT Module </li><li>  SSD mSATA 120GB Crucial M500 </li><li>  HDD 2.5` Seagate Momentus 500GB </li><li>  MSI RX 560 4Gb </li></ul><br><img src="https://habrastorage.org/webt/iy/7l/7u/iy7l7uysi3amdu4sobxmthwp4-y.jpeg"><br>  <font color="gray"><i>What was it all about?</i></font> <br><br>  Of course, the configuration is far from productive and to get a significant advantage from connecting to the x4 bus instead of x1 did not work in various tests.  Often it all came down to a weak iron. <br><br><img src="https://habrastorage.org/webt/ah/7e/kg/ah7ekg0jws0yqnvyatvwh9-jwzi.png"><br>  <font color="gray"><i>Difference within error</i></font> <br><br>  MOBA-type games (WOT, for example) showed indifference to the bus on this configuration - if there is enough video memory there is no need to load data in closed small locations. <br><br>  But in online games with an open world, especially in places of mass gathering of players, the difference is quite noticeable.  Here are 3 FPS measurements in Black Desert: <br><table><tbody><tr><td>  Measuring </td><td>  min </td><td>  avg </td><td>  max </td></tr><tr><td colspan="4">  pci-e x4 gen1 ‚âà pci-e x1 gen3 </td></tr><tr><td>  one </td><td>  five </td><td>  28 </td><td>  51 </td></tr><tr><td>  2 </td><td>  five </td><td>  29 </td><td>  49 </td></tr><tr><td>  3 </td><td>  five </td><td>  29 </td><td>  51 </td></tr><tr><td colspan="4">  pci-e x4 gen3 </td></tr><tr><td>  one </td><td>  7 </td><td>  31 </td><td>  56 </td></tr><tr><td>  2 </td><td>  6 </td><td>  thirty </td><td>  51 </td></tr><tr><td>  3 </td><td>  7 </td><td>  31 </td><td>  53 </td></tr></tbody></table><br><h4>  <font color="#9cc2ce">Plans and Results</font> </h4><br>  The project, though, was started as a universal and not only for itself, but it did not find much popularity.  I did not find it at all.  Nevertheless, I got what I wanted and invaluable experience and knowledge.  As they say a negative result is also a result! <br><br>  They also often ask me why I did not try to implement support for the now-fashionable Thunderbolt3 interface.  The problem is that this interface will require licensing from Intel.  And no documentation on the controllers just will not give.  There is even a narrow circle of developers of solutions on Thunderbolt3 under the patronage of the same Intel.  I was naturally not accepted there. <br><br>  Although there were rumors that this interface would be open and accessible to everyone, but at the moment it‚Äôs just rumors and the standard has remained closed.  But I would love to try to develop the project in this direction. <br><br>  Quite a few questions were about the connection option instead of MXM video cards.  There were plans for such an option, but I had to give it up for two reasons - the funds for R &amp; D came to an end and I couldn‚Äôt test it on anything. <br><br>  In general, I will be very happy to hear comments and suggestions from swaggers.  Thanks for attention! <br><br><h4>  <font color="#9cc2ce">PS</font> </h4><br>  Since this is generally my first experience in developing an electronic device, I had to turn to more experienced people in this regard for help, so I want to say a big thank you to <a href="https://habr.com/users/nordicenergy/" class="user_link">NordicEnergy</a> and <a href="https://habr.com/users/paging/" class="user_link">Paging</a> for advice and answers to my (sometimes stupid) questions! <br><br><h4>  <a href="https://github.com/kotproger/CPR"><font color="red">Project files</font></a> </h4></div><p>Source: <a href="https://habr.com/ru/post/435086/">https://habr.com/ru/post/435086/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../435076/index.html">How marketers working with Google monetize our discomfort</a></li>
<li><a href="../435078/index.html">What if artificial intelligence makes actors immortal?</a></li>
<li><a href="../435080/index.html">Guide: Thymeleaf + Spring. Part 2</a></li>
<li><a href="../435082/index.html">Silicon Valley Yoda</a></li>
<li><a href="../435084/index.html">How to work with async / await in JavaScript cycles</a></li>
<li><a href="../435088/index.html">Chinese streaming giant Tencent Music came out for an IPO - what it means and what to expect competitors</a></li>
<li><a href="../435090/index.html">Hyundai motor group introduced the concept of wireless charging and autonomous parking</a></li>
<li><a href="../435094/index.html">Gamepad from Sega Mega Drive and Raspberry Pi Part 2 (the final six-button)</a></li>
<li><a href="../435096/index.html">The effect of warm tube radio</a></li>
<li><a href="../435098/index.html">ADB vs Spy Cam & Mic</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>