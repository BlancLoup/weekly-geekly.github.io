<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Personal experience: how we transferred the infrastructure from one data center to the US to another</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We in King Servers are faced with the need to change one of our foreign data centers. The data center was located in the US state of California, and i...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Personal experience: how we transferred the infrastructure from one data center to the US to another</h1><div class="post__text post__text-html js-mediator-article"> <a href="https://habrahabr.ru/company/kingservers/blog/347582/"><img src="https://habrastorage.org/webt/92/xe/oa/92xeoa0wbewswyv57iwe-jrh7-g.png"></a> <br><br>  We in <a href="https://king-servers.com/%3Futm_source%3Dhabrahabr%26utm_medium%3Dpereezd_king">King Servers are</a> faced with the need to change one of our foreign data centers.  The data center was located in the US state of California, and it was necessary to look for a new one in the same region.  Today we will talk about how the relocation took place, share our impressions of it and give a couple of tips to those who still have to face the infrastructure sites in the United States. <a name="habracut"></a><br><br><h2>  Why change the data center </h2><br>  The development of the company's infrastructure has gradually led to the fact that we are no longer satisfied with the conditions of our current data center.  Despite the fact that the data center had a Tier2 standard, in just a year we faced a number of problems, such as power failure in some of the racks or a complete drop in the Internet channel. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In addition, the site was not Carrier-neutral - in practice, this meant that communication services were provided only by one company that owned the data center.  Therefore, in the moments of failures on its channels, the connection disappeared completely, which could not suit us or our clients. <br><br>  After weighing all the pros and cons, we decided to migrate the infrastructure to a new data center, where it would be possible to use two independent power lines simultaneously and connect to several providers. <br><br><h2>  Process of moving </h2><br>  Both data centers were located close to each other, at a distance of 20 km.  Old in the city of Fremont, and the new in Santa Clara. <br><br><img src="https://habrastorage.org/webt/7z/x4/xi/7zx4xilsbqqj1vb9i1cetebqzry.png"><br><br>  Preparing for the move thoroughly - pre-purchased consumables required for mounting servers in racks, new power cables and patch cords to reduce the time for dismantling in the old data center. <br><br><img src="https://habrastorage.org/webt/an/qa/ly/anqalytbwkjg-nq4lxh_yq1ruag.png"><br><br>  <i>Relocation stocks</i> <br><br>  We also installed a second router in a new data center and organized the simultaneous operation of our networks in both data centers. <br><br>  As a result, a plan was developed, involving a phased transfer of infrastructure to a new location - so we could continue to work and not cause unnecessary inconvenience to users. <br><br>  Initially, we wanted to use the services of a specialized company for the transportation of equipment, but in the process of negotiations with several companies we found out that they could transport our equipment either in large quantities with large downtime for customers, or small parts with minimum downtime, but the price increased significantly under such conditions.  As a result, it was decided to send several of our engineers across half the globe and perform the work on their own.  Even taking into account flights, accommodation and transport rent, such a move was 2 times cheaper than the minimum price list from Californian moving companies. <br><br>  The first stage of work included an exit to the old data center to assess the infrastructure - not all engineers of our team have been there before, and some last time came a couple of years ago, and during this time many different works were carried out by data center employees.  It was necessary to check and install the equipment - as it turned out, not everything was as good as on our last visit. <br><br>  The racks used cables with excess length, some servers were mounted without using a sled and tightly screwed to the rack.  It became clear that the time for dismantling would take much more than we had planned.  Fortunately, the spare materials were enough to do without the complete dismantling of all the iron, and we still fit into the migration schedule. <br><br><img src="https://habrastorage.org/webt/ky/ab/yj/kyabyjhcshdke1hqthvgvpuxel8.png"><br><br>  <i>We can not say that we were pleased with what he saw in the old DC</i> <br><br>  This was followed by a reconnaissance trip to the new data center to look around and explore the new racks. <br><br>  During the first visit to the new data center, our engineers first of all evaluated its manufacturability.  In the old data center everything was very strict - the data center employees not only checked the engineers' documents very meticulously, but also accompanied them when they moved to and near their racks.  This entailed temporary delays, as it was often necessary to wait until such an attendant was free.  The new site turned out to be much more democratic in this regard, which allowed us to work faster. <br><br>  According to the plan, the team of engineers had to come to the old data center, pick up 15-20 servers, then install them in racks at the new location, turn them on, and after that everything had to work without requiring additional intervention from our side. <br><br>  Not without difficulties - for example, it suddenly turned out that the Cisco router that we planned to use to organize the tunnel did not work the way it was planned after transporting the test part of the servers not used by clients and testing, it became clear that it would not sustain the traffic of the clients. <br><br>  We had to quickly change the network layout and use additional routers to share the load from the clients and allow the network to last a couple of days during the migration.  The setup time was no longer included in any of our plans, which nevertheless caused a deviation from the schedule. <br><br>  Also, not all servers started immediately after transportation.  Some of our clients administer dedicated servers independently and close all access to us, including monitoring.  On some servers, the disks were not in the best condition, and even a neat shutdown with the correct shutdown did not save the system from failures due to damaged file systems and crashed raids. <br><br>  In each new batch of the transported servers, a couple of similar problems were encountered, and the technical support engineers after the migration of each batch of servers carried out work to restore their functionality. <br><br><img src="https://habrastorage.org/webt/rq/us/z5/rqusz5pxffahb64b423utfsw2ia.png"><br><br><h2>  Total: general impressions </h2><br>  In American data centers everything is very strict, it is not easy to get even minimal access to your own equipment - for every action you need to get approval, which can only be given by a manager who is not necessarily physically located in the DC.  Then you need to create a ticket in the helpdesk system and wait for its resolution. <br><br>  You can also meet quite tough conditions, for example, on the use of data center resources - so in our new data center there is a restriction that prohibits keeping your hardware in a warehouse for a long time (more than 1-2 days).  We needed more time, and in order to get permission for longer storage, we had to obtain manager approval by the scheme described above.  ID (passport or rights), as in principle in the United States, is constantly being asked at local data centers; you also need to be prepared for this. <br><br>  On the other hand, from an organizational point of view, the use of DC in California turned out to be very pleasant.  All the conditions stipulated in the contracts were always fulfilled, which we did not always manage to achieve in Russia.  For example, once our move to a new data center failed due to the fact that its engineers did not have time to prepare the racks - although the terms of preparation were clearly specified in the contract (we told about our adventures in <a href="https://habrahabr.ru/company/kingservers/blog/339644/">this material</a> ). <br><br>  In addition, local engineers were very friendly and always met us halfway - for example, when we had a shortage of cables so that we would not be interrupted and go to the store to buy new ones, our colleagues allocated resources from their stocks to us. <br><br><h2>  Conclusion: what you need to know when working with American data centers </h2><br>  In conclusion, we list it again somewhat <br><br><ul><li>  <b>In the US, not all data centers are very technically advanced</b> - so you should not choose the first available option, but rather spend more time searching.  Perhaps, the cost of services of a more innovative data center will be more expensive, but at a certain size of infrastructure, better conditions may bring savings on the repair, maintenance and replacement of iron. </li><li>  <b>It is necessary to strictly follow the rules</b> - the United States is a country where laws are enforced, even if it seems not always logical.  But if the rules say that the client cannot move two steps away from his desk, then in order to do this, the manager‚Äôs permission must be obtained ‚Äî and in the process sign a number of papers and show the ID several times. </li><li>  <b>Everyone is very friendly, but in any case, you only need to hope for yourself</b> - the famous American positivity is not a myth, and it applies to data center engineers, who always don‚Äôt mind helping.  However, this does not mean that you need to relax - for example, no one will fix for you when preparing for migration. </li></ul><br><h2>  More useful links and materials from <a href="https://www.king-servers.com/">King Servers</a> : </h2><br><ul><li> <a href="https://www.king-servers.com/try/%3Futm_source%3Dkingsite%26utm_campaign%3Dbiz-special">Free infrastructure test from King Servers</a> </li><li>  <a href="https://roem.ru/09-11-2017/263138/baza-znanij/">How and why we created a knowledge base</a> </li><li>  <a href="https://habrahabr.ru/company/kingservers/blog/339644/">How to choose a data center for an IT project in Russia: uptime, money and overall adequacy</a> </li><li>  <a href="https://habrahabr.ru/company/kingservers/blog/344402/">Popularity statistics of operating systems in IaaS: Ubuntu is still number one, CentOS popularity is growing</a> </li><li>  <a href="https://habrahabr.ru/company/kingservers/blog/323660/">When the ‚Äúcloud‚Äù breaks down: what can be done in this situation?</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/347582/">https://habr.com/ru/post/347582/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../347572/index.html">The story of how two graduates of "mathex" made the first sales</a></li>
<li><a href="../347574/index.html">We use Apple Pay and Troika card as a pass to work</a></li>
<li><a href="../347576/index.html">Object in a case or Optional in Java 8 and Java 9. Part 2: ‚ÄúHow it is done in Java 8‚Äù</a></li>
<li><a href="../347578/index.html">‚ÄúWhen you tell a true story, they believe it much more‚Äù - Interview with Oleg Shelaev, part 2</a></li>
<li><a href="../347580/index.html">On Lee effect waves: Pitonizing DAF generation</a></li>
<li><a href="../347584/index.html">Disable triggers in ZABBIX on schedule</a></li>
<li><a href="../347586/index.html">How I made AI to identify fake news with an accuracy of 95% and almost went crazy</a></li>
<li><a href="../347588/index.html">Tough and flexible IT skills: everything is more and less serious than I would like to think</a></li>
<li><a href="../347590/index.html">Open science school hackathon DeepHack.Babel</a></li>
<li><a href="../347592/index.html">Telegram bot for complex quests</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>