<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>AD called JSMPP</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Apparently in the life of every programmer there comes a time when he becomes necessary to learn how to send SMS messages. Yesterday this moment came ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>AD called JSMPP</h1><div class="post__text post__text-html js-mediator-article">  Apparently in the life of every programmer there comes a time when he becomes necessary to learn how to send <a href="http://ru.wikipedia.org/wiki/SMS">SMS</a> messages.  Yesterday this moment came at me.  I must say at once that this need is in no way connected with advertising mailings and other spam.  It was necessary to send SMS messages for purely peaceful purposes, as part of the reaction to events detected during equipment monitoring. <br><br>  The importance of having the possibility of such distribution is difficult to overestimate.  Indeed, having sent the accident notice to the contact person's EMail, we cannot count on an immediate response.  It is not known when the addressee will read his mail.  SMS is delivered much faster. <br><br>  Our company has long been successfully using its own implementation of <a href="http://ru.wikipedia.org/wiki/SMPP">SMPP</a> service, and the thought of using a ready SMPP client in Java seemed logical to me.  Bravely typing the words "java smpp client" into the <a href="https://www.google.ru/">google</a> search bar, I immediately found the <a href="http://code.google.com/p/jsmpp/">library</a> I needed.  About what happened next, tells my today's post. <br><a name="habracut"></a><br>  As for building projects, I use <a href="http://maven.apache.org/">maven</a> , first of all, I downloaded the latest version of the <a href="http://code.google.com/p/jsmpp/downloads/detail%3Fname%3Djsmpp-2.1.0-all.zip">library</a> from the site, loaded it into the local repository with the following command: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre><code class="bash hljs">mvn install:install-file -Dfile=jsmpp-2.1.0.jar -DgroupId=org.jsmpp -DartifactId=smpp -Dversion=2.1.0 -Dpackaging=jar</code> </pre> <br>  after which he created a pom-file: <br><br><div class="spoiler">  <b class="spoiler_title">pom.xml</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">project</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://maven.apache.org/POM/4.0.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xsi:schemaLocation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">modelVersion</span></span></span><span class="hljs-tag">&gt;</span></span>4.0.0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">modelVersion</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>com.acme.ae.tests.smpp<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>SMPPTest<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>1.0.0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">packaging</span></span></span><span class="hljs-tag">&gt;</span></span>jar<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">packaging</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span>smppTest-${project.version}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url</span></span></span><span class="hljs-tag">&gt;</span></span>http://maven.apache.org<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">properties</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">project.build.sourceEncoding</span></span></span><span class="hljs-tag">&gt;</span></span>UTF-8<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">project.build.sourceEncoding</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">resource_dir</span></span></span><span class="hljs-tag">&gt;</span></span>${project.basedir}/src/main/resources<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">resource_dir</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">properties</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">finalName</span></span></span><span class="hljs-tag">&gt;</span></span>${project.name}-${project.version}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">finalName</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">resources</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">resource</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">directory</span></span></span><span class="hljs-tag">&gt;</span></span>${resource_dir}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">directory</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">resource</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">resources</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">build</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependencies</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>org.jsmpp<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>smpp<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>2.1.0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependencies</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">project</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br>  Preparation of the test application looked quite standard: <br><br><div class="spoiler">  <b class="spoiler_title">Test.java</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.acme.ae.tests.smpp; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Test</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException </span></span>{ } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">stop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException </span></span>{ } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-function"> </span></span>{ Test t = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Test(); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { t.start(); t.test(); } <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span> { t.stop(); } } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception e) { System.out.println(e.toString()); } } }</code> </pre><br></div></div><br>  This was followed by a study of an <a href="">example</a> courtesy of the developers.  A translation <a href="https://sms-service.kz/smpp34rus.pdf">specification was</a> used as the second source of inspiration. <br><br>  To connect to the server, in full accordance with the above-mentioned example, the following code was used: <br><br><div class="spoiler">  <b class="spoiler_title">Server connection</b> <div class="spoiler_text"><pre> <code class="java hljs"> ... <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> SMPPSession session = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException </span></span>{ session = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> SMPPSession(); session.connectAndBind(SMPP_IP, SMPP_PORT, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BindParameter( BindType.BIND_TX, SMPP_LOGIN, SMPP_PASS, <span class="hljs-string"><span class="hljs-string">"cp"</span></span>, TypeOfNumber.UNKNOWN, NumberingPlanIndicator.UNKNOWN, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>)); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">stop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> IOException </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (session != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { session.unbindAndClose(); } } ...</code> </pre><br></div></div><br>  The purpose of the parameters here is quite clear from the context.  The remaining parameters were taken from the sample code without changes.  Since we're only going to send messages, we use BindType.BIND_TX. <br><br>  The message transfer code (or rather the encoding job), taken from the example, refused to compile: <br><br><pre> <code class="java hljs">... <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GeneralDataCoding(Alphabet.ALPHA_DEFAULT, MessageClass.CLASS1, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>) ...</code> </pre><br>  After comparing the source code of the downloaded library (the latest available version 2.1.0) with the source code on <a href="https://github.com/uudashr/jsmpp">GitHub</a> , it turned out that the developers, for some reason I did not understand, changed the designer's signature: <br><br><pre> <code class="diff hljs"><span class="hljs-deletion"><span class="hljs-deletion">- public GeneralDataCoding(boolean compressed, boolean containMessageClass, - MessageClass messageClass, Alphabet alphabet) { + public GeneralDataCoding(Alphabet alphabet, MessageClass messageClass, + boolean compressed) throws IllegalArgumentException { ... }</span></span></code> </pre><br>  Since I used the old version, I had to make adjustments to the code (the sender and receiver addresses in the code are changed): <br><br><div class="spoiler">  <b class="spoiler_title">Short Message Transfer</b> <div class="spoiler_text"><pre> <code class="java hljs"> ... <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> TimeFormatter timeFormatter = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AbsoluteTimeFormatter(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">test</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> PDUException, ResponseTimeoutException, InvalidResponseException, NegativeResponseException, IOException </span></span>{ String messageId = session.submitShortMessage( <span class="hljs-string"><span class="hljs-string">"CMT"</span></span>, TypeOfNumber.ALPHANUMERIC, NumberingPlanIndicator.UNKNOWN, <span class="hljs-string"><span class="hljs-string">"ACME"</span></span>, TypeOfNumber.INTERNATIONAL, NumberingPlanIndicator.ISDN, <span class="hljs-string"><span class="hljs-string">"7XXXXXXXXXX"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ESMClass(), (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>)<span class="hljs-number"><span class="hljs-number">0</span></span>, (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>)<span class="hljs-number"><span class="hljs-number">1</span></span>, timeFormatter.format(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Date()), <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> RegisteredDelivery(SMSCDeliveryReceipt.DEFAULT), (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>)<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GeneralDataCoding( <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, MessageClass.CLASS1, Alphabet.ALPHA_DEFAULT), (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>)<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-string"><span class="hljs-string">"jSMPP simplify SMPP on Java platform"</span></span>.getBytes()); System.out.println(<span class="hljs-string"><span class="hljs-string">"Message submitted, message_id is "</span></span> + messageId); } ...</code> </pre><br></div></div><br>  Running the code for execution was not successful.  When attempting to create SMPPSession, an exception was thrown: <br><br><pre> <code class="java hljs">Exception in thread <span class="hljs-string"><span class="hljs-string">"main"</span></span> java.lang.NoClassDefFoundError: org/slf4j/LoggerFactory at org.jsmpp.session.AbstractSession.&lt;clinit&gt;(AbstractSession.java:<span class="hljs-number"><span class="hljs-number">51</span></span>) at com.amfitel.m2000.ae.tests.smpp.Test.start(Test.java:<span class="hljs-number"><span class="hljs-number">56</span></span>) at com.amfitel.m2000.ae.tests.smpp.Test.main(Test.java:<span class="hljs-number"><span class="hljs-number">179</span></span>) Caused by: java.lang.ClassNotFoundException: org.slf4j.LoggerFactory at java.net.URLClassLoader$<span class="hljs-number"><span class="hljs-number">1</span></span>.run(URLClassLoader.java:<span class="hljs-number"><span class="hljs-number">202</span></span>) at java.security.AccessController.doPrivileged(Native Method) at java.net.URLClassLoader.findClass(URLClassLoader.java:<span class="hljs-number"><span class="hljs-number">190</span></span>) at java.lang.ClassLoader.loadClass(ClassLoader.java:<span class="hljs-number"><span class="hljs-number">307</span></span>) at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:<span class="hljs-number"><span class="hljs-number">301</span></span>) at java.lang.ClassLoader.loadClass(ClassLoader.java:<span class="hljs-number"><span class="hljs-number">248</span></span>) ... <span class="hljs-number"><span class="hljs-number">3</span></span> more</code> </pre><br>  Indeed, in <a href="http://code.google.com/p/jsmpp/wiki/GettingStarted">GettingStarted</a> there was a <a href="http://code.google.com/p/jsmpp/wiki/GettingStarted">scant</a> mention of using <a href="http://www.slf4j.org/">SLF4J</a> .  I had to add a dependency in pom.xml: <br><br><pre> <code class="xml hljs"> ... <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>org.slf4j<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>slf4j-api<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>1.6.1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> ...</code> </pre><br>  The version number (1.6.1, not 1.4.3, as was stated in GettingStarted) was taken from a <a href="">pom-file</a> on GitHub.  Now an unpleasant error began to be written to the log, but at least the connection to the server was established: <br><br><pre> <code class="java hljs">SLF4J: Failed to load <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> "</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">org</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">slf4j</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">impl</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">StaticLoggerBinder</span></span></span><span class="hljs-class">". </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SLF4J</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Defaulting</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">to</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">no</span></span></span><span class="hljs-class">-</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">operation</span></span></span><span class="hljs-class"> (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NOP</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">logger</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">implementation</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SLF4J</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">See</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">http</span></span></span><span class="hljs-class">://</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">www</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">slf4j</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">org</span></span></span><span class="hljs-class">/</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">codes</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">html</span></span></span><span class="hljs-class">#</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">StaticLoggerBinder</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">for</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">further</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">details</span></span></span><span class="hljs-class">.</span></span></code> </pre><br><div class="spoiler">  <b class="spoiler_title">Remark</b> <div class="spoiler_text">  The problem was solved by adding another dependency, also taken from the source code on <a href="">GitHub</a> : <br><br><pre> <code class="xml hljs"> ... <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>org.slf4j<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>slf4j-log4j12<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>1.6.1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dependency</span></span></span><span class="hljs-tag">&gt;</span></span> ...</code> </pre><br>  After its addition, a normal log was formed, in accordance with the settings specified in log4j.properties.  Thanks <a href="https://habrahabr.ru/users/googolplex/" class="user_link">Googolplex</a> for the advice. <br></div></div><br>  Sending a message was also successful, but on the phone, instead of letters, ‚Äúsquares‚Äù came.  <a href="http://www.wireshark.org/download.html">WireShark</a> came to the <a href="http://www.wireshark.org/download.html">rescue</a> : <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6b4/f3e/c70/6b4f3ec704be3ce9c1dcb66ea8c7299f.png" alt="image"><br><br>  Our SMPP server developer, argued that, for normal sending of messages in Latin, 0 should be sent to Data Coding. I must say that the process of generating various numeric codes dictated by the specification is not obvious when using the JSMPP API.  After a brief meditation on the source code, the problem was solved: <br><br><pre> <code class="diff hljs"> ... new GeneralDataCoding( false, false, - MessageClass.CLASS1, + MessageClass.CLASS0, Alphabet.ALPHA_DEFAULT) ...</code> </pre><br>  Now it was necessary to learn to send long messages and messages using Cyrillic.  To send long messages, I didn‚Äôt get tricky with MESSAGE_PAYLOAD, using the approach suggested in the <a href="">example</a> from the developers. <br><br>  To transfer Cyrillic, it was necessary to change the encoding and translate the message to UCS-2.  From a practical point of view, the latter was poured into the presentation of the text as a sequence of bytes in UTF-16 encoding (you can read about the difference between UCS-2 and UTF-16 <a href="http://www.unicode.org/faq/basic_q.html">here</a> ).  As a result, the message sending code looked like this: <br><br><div class="spoiler">  <b class="spoiler_title">Transmission of a long Cyrillic message</b> <div class="spoiler_text"><pre> <code class="java hljs">GeneralDataCoding coding = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GeneralDataCoding( <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, MessageClass.CLASS0, Alphabet.ALPHA_UCS2); <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> totalSegments = <span class="hljs-number"><span class="hljs-number">3</span></span>; Random random = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Random(); OptionalParameter sarMsgRefNum = OptionalParameters.newSarMsgRefNum((<span class="hljs-keyword"><span class="hljs-keyword">short</span></span>)random.nextInt()); OptionalParameter sarTotalSegments = OptionalParameters.newSarTotalSegments(totalSegments); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; totalSegments; i++) { <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> seqNum = i + <span class="hljs-number"><span class="hljs-number">1</span></span>; String message = <span class="hljs-string"><span class="hljs-string">" "</span></span> + seqNum + <span class="hljs-string"><span class="hljs-string">" of "</span></span> + totalSegments + <span class="hljs-string"><span class="hljs-string">" "</span></span>; OptionalParameter sarSegmentSeqnum = OptionalParameters.newSarSegmentSeqnum(seqNum); String messageId = session.submitShortMessage( <span class="hljs-string"><span class="hljs-string">"CMT"</span></span>, TypeOfNumber.ALPHANUMERIC, NumberingPlanIndicator.UNKNOWN, <span class="hljs-string"><span class="hljs-string">"ACME"</span></span>, TypeOfNumber.INTERNATIONAL, NumberingPlanIndicator.ISDN, <span class="hljs-string"><span class="hljs-string">"7XXXXXXXXXX"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ESMClass(), SMPP_PROTOCOL_ID, <span class="hljs-comment"><span class="hljs-comment">// (byte)0 SMPP_PRIORITY_FLAG, // (byte)1 null, null, new RegisteredDelivery(SMSCDeliveryReceipt.DEFAULT), SMPP_REP_IF_P_FLAG, // (byte)0 coding, (byte)0, message.getBytes(Charset.forName("UTF-16")), sarMsgRefNum, sarSegmentSeqnum, sarTotalSegments); System.out.println("Message submitted, message_id is " + messageId); }</span></span></code> </pre><br></div></div><br>  Concluding this article, I want to emphasize that it was written not for the purpose of criticizing JSMPP.  The SMPP specification is complex in itself, and the library's developers have done everything possible to facilitate its use as much as possible.  Small flaws, in such a project, are inevitable. <br><br>  I did not write this post for the purpose of scolding anyone, but only because I wanted to make it easier for other people to walk around the rake he himself walked.  Please do not take my grumbling too seriously. <br></div><p>Source: <a href="https://habr.com/ru/post/202142/">https://habr.com/ru/post/202142/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../202130/index.html">Package Manager for Delphi</a></li>
<li><a href="../202132/index.html">Artificial Intelligence for Android with Open API</a></li>
<li><a href="../202134/index.html">Using the power of js in all aspects of a web project</a></li>
<li><a href="../202138/index.html">Path to automate Java removal (JDK and JRE) on Windows</a></li>
<li><a href="../202140/index.html">SonataMediaBundle. Russian version of the translation file xliff</a></li>
<li><a href="../202144/index.html">Start Sandbox Championship Russian AI Cup</a></li>
<li><a href="../202146/index.html">It seems to me that the software hell is already close ...</a></li>
<li><a href="../202150/index.html">About cloud backups: use Rackspace CloudFiles</a></li>
<li><a href="../202152/index.html">Life hacking: in any incomprehensible situation, multiply by three</a></li>
<li><a href="../202154/index.html">Copy-Paste and muons</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>