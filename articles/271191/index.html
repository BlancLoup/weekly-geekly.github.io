<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to analyze a file for malware?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="If you believe the latest report from Verizon for 2015, then today 70-90% of all malicious code is unique for each organization and therefore situatio...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to analyze a file for malware?</h1><div class="post__text post__text-html js-mediator-article">  If you believe the latest report from Verizon for 2015, then today 70-90% of all malicious code is unique for each organization and therefore situations often occur when an organization has a channel (mail, Web, flash drive, mobile device, etc.) .) comes a file that causes suspicion, but the antivirus is ‚Äúsilent‚Äù and does not signal anything about this file.  How to be in this situation?  Let the file get into the network and start spreading over it?  Or delete it?  Or put in quarantine?  Or maybe there is a way to still analyze the file and issue a verdict on it?  Albeit without the name of a virus or trojan.  Yes, there is such an option - it is called the Threat Intelligence Platform. <br><a name="habracut"></a><br>  So, we have antiviruses installed in our organization at workstations.  On the mail server is also antivirus.  Anti-Virus is even integrated via ICAP or WCCP with a firewall.  Can we be sure that everything that falls into our network is pure as a tear of a baby?  Alas ... As the <a href="https://www.youtube.com/watch%3Fv%3DGZsbkMC3l50">statistics of</a> various companies show, the average time of network hacking / compromise detection (time-to-detect, TTD) is 200 (!) Days.  Imagine two hundred days you do not know that you have already attacked and pull out of you confidential information.  And suddenly, at some point in time you see this picture on the screen of your computer. <br><br><img src="https://habrastorage.org/files/9ce/1c1/9b4/9ce1c19b4814401cafd8e46a43de6bee.png" alt="image"><br><br>  In the dynamics, and we are talking about TeslaCrypt encryption, it all looks even more <a href="https://www.youtube.com/watch%3Fv%3DugsRf6hRT_8">interesting</a> (until 2:30, everything is boring and ordinary): 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/ugsRf6hRT_8%3Ffeature%3Doembed&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj0EkzXok6i1B5UdRWJdV4H0OGsxg" frameborder="0" allowfullscreen=""></iframe><br><br>  You damn your antivirus, which caught nothing and already hoping a little, start communicating with the antivirus company.  What if they help and decrypt the hard drive.  But alas ... the antivirus company is not able to help you.  Its task is to sell and maintain the antivirus, and not to work for you for free, being engaged in the analysis of your suspicious files.  Perhaps over time, antivirus analysts will parse the file you sent and equip your antivirus with knowledge of it.  But it will be only later, but for now you are facing the dilemma of ‚Äú <a href="http://lukatsky.blogspot.ru/2015/10/blog-post_29.html">Pay or not pay extortionists?</a> ‚Äù At the recently held in Kazan conference ‚ÄúInformation Security Code‚Äù I conducted a blitz survey on the topic: ‚ÄúIf you sent suspicious files to antivirus companies, then Did you get a positive and prompt response? ‚Äù  Alas, I can not boast of the forest raised in response to this question. <br><br>  Suppose you learned a lesson from what happened and the next time you receive a suspicious file you want to do something with it.  But what?  At the hearing of many service <a href="https://www.virustotal.com/">Virus Total</a> , which is presented by many as a means of analyzing malicious code.  But it is not so.  VirusTotal is essentially an automation tool for scanning more than 50 antiviruses to detect malicious code uploaded to the portal (or not to detect).  VirusTotal simply automates the process of launching fifty antiviruses and gives you a verdict - detected or not.  If there is no information about your file in the anti-virus database, then VirusTotal will not tell you anything either.  In other words, the task of VirusTotal is to check the effectiveness of antiviruses, but not to help you analyze your files. <br><br><img src="https://habrastorage.org/files/971/77d/bf5/97177dbf5f55403b8cabd8ce25edef4a.png" alt="image"><br><br>  You can try to refer to another free resource - <a href="https://malwr.com/">Malwr</a> , which is a sandbox in which you can analyze suspicious files for malware. <br><br><img src="https://habrastorage.org/files/535/03f/18b/53503f18bf0b4f36b616380b07559ba3.png" alt="image"><br><br>  However, the number of analysis methods on this service is not so great and modern malicious code, especially designed specifically for circumventing sandboxes (and this is becoming more and more), may go unnoticed by Malwr.  In addition to it, there are a number of other platforms for analyzing malicious code.  At the forum held in Moscow on the IT Security and Response Center for the SOC Forum, I gave a separate <a href="http://www.slideshare.net/lukatsky/threat-intelligence-soc">report</a> with a brief overview of such platforms.  Among others, I mentioned our own platform - <b>Cisco AMP Threat Grid</b> , which I would like to talk about in more detail. <br><br><img src="https://habrastorage.org/files/569/d5c/b77/569d5cb773844100a5fb236b10541faa.png" alt="image"><br><br>  But for starters, I would like to <a href="https://www.youtube.com/watch%3Fv%3D_Jz-6styFRw">show</a> how it works on the example of the analysis of the TeslaCrypt coder, the result of which I showed in the picture above: <br><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/_Jz-6styFRw%3Ffeature%3Doembed&amp;xid=17259,15700019,15700186,15700191,15700248,15700253&amp;usg=ALkJrhjgt2UsiTi9Uz6UnXx7wEiZRO2zxw" frameborder="0" allowfullscreen=""></iframe><br><br>  This platform extends the functionality of our malware detection solution - the Cisco Advanced Malware Protection (AMP) platform, which, being installed on firewalls, intrusion prevention systems, E-mail and Web protection systems, as well as on routers and end devices (PCs under Windows, Linux, Mac, Android), allows you to automatically <b>detect</b> known and unknown malicious code in automatic mode.  For the <b>study of the</b> files that got into the organization not through the network or are suspicious, Cisco offers the <a href="http://www.slideshare.net/CiscoRu/amp-threat-grid">Cisco AMP Threat Grid service</a> , which allows <b>analyzing</b> any files for damage.  Cisco AMP can transfer files to the Threat Grid service automatically, but you can also use it as a portal for analysts of incident response services, incident investigation services, information security monitoring centers.  The video above shows just the work through the portal. <br><br>  Please note - the analysis is carried out in just a few minutes and in fully automatic mode.  You just need to download the file you are interested in and after some time get the generated report in a readable format.  You can also get the report in JSON format to connect to your own systems and even get a PCAP file for additional analysis using any network incident investigation systems.  For example, if you run this PCAP file through Wireshark or Cisco NGIPS, you can create signatures for intrusion detection systems that can detect the analyzed malicious code in the future. <br><br>  In addition to Cisco solutions, you can also automatically upload data to the Threat Grid service using other solutions, some of which are also known in the former Soviet Union: <br><ul><li>  General Dynamics Fidelis </li><li>  Guidance Software EnCase Cybersecurity </li><li>  RSA Security Analytics </li><li>  TripWire Enterprise 360 </li><li>  Splunk Enterprise </li><li>  Malformity Labs Maltego </li><li>  IBM QRadar </li><li>  HP ArcSight </li><li>  Mcafee nitro </li></ul><br><br>  But the analysis of malicious code can be carried out not only in the AMP Threat Grid cloud.  For specific applications (weak Internet, isolated network or other cases), it is possible to use a special Cisco AMP Threat Grid Appliance device, which is located on the customer's network and performs all the analysis of files uploaded to it. <br><br><img src="https://habrastorage.org/files/2c8/c54/fbd/2c8c54fbd2994658b4789ca4a32225cf.jpg" alt="image"><br><br>  The result of the Cisco AMP Threat Grid is a calculation of the threat rating (on a 100 point scale) with a detailed explanation of why a decision was made.  About 450 different indicators in downloadable files are dynamically and statically analyzed - working with files, working with memory, working with the registry, working with the network, etc.  For each parameter, the report contains a detailed description.  Here's how, for example, a <a href="http://www.slideshare.net/CiscoRu/analysis-report-55133729">report</a> looks like on the same TeslaCrypt coder.  And this is how the <a href="http://www.slideshare.net/CiscoRu/zeus-cisco-amp-threat-grid">report</a> looks like a Zeus banking Trojan. <br><br>  In modern conditions, when the malicious code is <a href="https://www.youtube.com/watch%3Fv%3DuJOQJuhWR-E">changing</a> very actively and the established traditional means of detection are not able to recognize and block the threat in time, it remains to take the process in hand, expanding it by analyzing suspicious files using the Threat Intelligence Platform.  And the Cisco AMP Threat Grid can help accomplish this. <br><br>  Shl.  Probably many have heard such an abbreviation - CIS, <a href="https://www.cisecurity.org/">Center of Internet Security</a> , which is known for issuing guides to the secure configuration of various platforms, devices, operating systems, etc.  The CIS also created the <a href="https://msisac.cisecurity.org/">MS-ISAC</a> - Multi-State Information Sharing and Analysis Center.  It also uses Cisco AMP Threat Grid to analyze malicious code, which is then promptly reported to various organizations connected to it. </div><p>Source: <a href="https://habr.com/ru/post/271191/">https://habr.com/ru/post/271191/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../271179/index.html">Results of the Russian Developers Cup 2015</a></li>
<li><a href="../271181/index.html">My PHP 7 migration experience</a></li>
<li><a href="../271183/index.html">The Chrome Dev Summit live, second day</a></li>
<li><a href="../271185/index.html">Upsource 2.5: smart email notification, new Review page design, improvements in IDE plugin and much more</a></li>
<li><a href="../271189/index.html">Using WordPress AJAX Handler</a></li>
<li><a href="../271193/index.html">"Red Card": what is behind the warning of malware?</a></li>
<li><a href="../271195/index.html">Flexbox for interfaces in all its glory: Implementing Tracks (Part 1)</a></li>
<li><a href="../271197/index.html">Nim Tutorial (Part 1)</a></li>
<li><a href="../271199/index.html">Main announcements of the Microsoft Connect conference () and the virtual conference Visual Studio Connect 2015 in Russia on December 4</a></li>
<li><a href="../271201/index.html">Why constantly writing code is so important - how not to become a catfish</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>