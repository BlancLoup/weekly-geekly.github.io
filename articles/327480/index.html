<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Java and isomorphic React</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="To create isomorphic applications on React , Node.js is usually used as the server side. But, if the server is written in Java, then you should not gi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Java and isomorphic React</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/a00/62d/591/a0062d591c0c4d89b7e5b32c1521d77c.png" alt="image"><br><br>  To create <a href="http://isomorphic.net/">isomorphic applications</a> on <a href="https://facebook.github.io/react/">React</a> , Node.js is usually used as the server side.  But, if the server is written in Java, then you should not give up the isomorphic application: Java includes an embedded javascript engine (Nashorn), which can cope with HTML server rendering with React. <br><br>  The code for the application that demonstrates server rendering of React with a Java server is on <a href="https://github.com/complit-s/java-examples/tree/master/react-redux-isomorphic-example">GitHub</a> .  The article will be reviewed: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  A Java server in the style of microservice based on <a href="https://netty.io/">Netty</a> and <a href="https://en.wikipedia.org/wiki/Java_API_for_RESTful_Web_Services">JAX-RS</a> (in the <a href="http://resteasy.jboss.org/">Resteasy</a> implementation) for processing web requests, with the ability to run in <a href="https://www.docker.com/">Docker</a> . </li><li>  Dependency Injection using the <a href="http://docs.oracle.com/javaee/6/tutorial/doc/giwhl.html">CDI</a> library (in the <a href="http://docs.jboss.org/weld/reference/latest/en-US/html/environments.html">Weld SE</a> implementation). </li><li>  Build javascript bundle using <a href="https://webpack.js.org/">Webpack 2</a> . </li><li>  Set up HTML rewriting on the server using React. </li><li>  Start debugging with support for ‚Äúhot‚Äù reloading pages and styles using <a href="https://webpack.js.org/configuration/dev-server/">Webpack dev server</a> . </li></ul><a name="habracut"></a><br><h2>  Java server </h2><br>  Consider the creation of a Java server in the style of microservice (a self-contained jar that does not require the use of any servlet containers).  As a library for dependency management, we will use the CDI standard (Contexts and Dependency Injection), which came from the world of Java EE, but it can be used in Java SE applications.  The CDI implementation, Weld SE, is a powerful and well-documented dependency management library.  For CDI, there are many binders to other libraries, for example, the application uses CDI binders for JAX-RS and Netty.  It is enough in the src / main / resources / META-INF directory to create the beans.xml file (declaration that this module supports CDI), mark the classes with standard attributes, initialize the container, and inject dependencies.  Classes marked with special annotations will register automatically (manual registration is also available). <br><br><pre><code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">//  . public static void main(String[] args) { //  JUL     SLF4J. SLF4JBridgeHandler.removeHandlersForRootLogger(); SLF4JBridgeHandler.install(); LOG.info("Start application"); //  CDI  http://weld.cdi-spec.org/ final Weld weld = new Weld(); //  . weld.property(Weld.SHUTDOWN_HOOK_SYSTEM_PROPERTY, false); final WeldContainer container = weld.initialize(); //  Netty      JAX-RS,    CDI . final CdiNettyJaxrsServer nettyServer = new CdiNettyJaxrsServer(); ............... //  web . nettyServer.start(); .............. //   TERM   . try { final CountDownLatch shutdownSignal = new CountDownLatch(1); Runtime.getRuntime().addShutdownHook(new Thread(() -&gt; { shutdownSignal.countDown(); })); try { shutdownSignal.await(); } catch (InterruptedException e) { } } finally { //    CDI . nettyServer.stop(); container.shutdown(); LOG.info("Application shutdown"); SLF4JBridgeHandler.uninstall(); } } //  ,    ""    @ApplicationScoped public class IncrementService { .............. } //   @NoCache @Path("/") @RequestScoped @Produces(MediaType.TEXT_HTML + ";charset=utf-8") public class RootResource { /** *   {@link IncrementService}. */ @Inject private IncrementService incrementService; .............. }</span></span></code> </pre> <br>  For testing classes with CDI dependencies, the <a href="http://arquillian.org/">Arquillian</a> extension for JUnit is <a href="http://arquillian.org/">used</a> . <br><br><div class="spoiler">  <b class="spoiler_title">Modular test</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">/** *   {</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@link</span></span></span><span class="hljs-comment"> IncrementResource}. */</span></span> <span class="hljs-meta"><span class="hljs-meta">@RunWith</span></span>(Arquillian.class) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">IncrementResourceTest</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Inject</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> IncrementResource incrementResource; <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment">  ,       CDI. */</span></span> <span class="hljs-meta"><span class="hljs-meta">@Deployment</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> JavaArchive </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createDeployment</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ShrinkWrap.create(JavaArchive.class) .addClass(IncrementResource.class) .addAsManifestResource(EmptyAsset.INSTANCE, <span class="hljs-string"><span class="hljs-string">"beans.xml"</span></span>); } <span class="hljs-meta"><span class="hljs-meta">@Test</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getATest</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Map&lt;String, Integer&gt; response = incrementResource.getA(); assertNotNull(response.get(<span class="hljs-string"><span class="hljs-string">"value"</span></span>)); assertEquals(Integer.valueOf(<span class="hljs-number"><span class="hljs-number">1</span></span>), response.get(<span class="hljs-string"><span class="hljs-string">"value"</span></span>)); } .............. <span class="hljs-comment"><span class="hljs-comment">/** *    {</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@link</span></span></span><span class="hljs-comment"> IncrementService}.   RequestScoped: * Arquillian         . * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment">   {</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@link</span></span></span><span class="hljs-comment"> IncrementService}. */</span></span> <span class="hljs-meta"><span class="hljs-meta">@Produces</span></span> <span class="hljs-meta"><span class="hljs-meta">@RequestScoped</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> IncrementService </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getIncrementService</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> IncrementService service = mock(IncrementService.class); when(service.getA()).thenReturn(<span class="hljs-number"><span class="hljs-number">1</span></span>); when(service.incrementA()).thenReturn(<span class="hljs-number"><span class="hljs-number">2</span></span>); when(service.getB()).thenReturn(<span class="hljs-number"><span class="hljs-number">2</span></span>); when(service.incrementB()).thenReturn(<span class="hljs-number"><span class="hljs-number">3</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> service; } }</code> </pre><br></div></div><br>  We will configure the processing of web requests via the embedded web-server - Netty.  For writing handler functions, we will use another standard, also derived from Java EE, JAX-RS.  As an implementation of the JAX-RS standard, select the Resteasy library.  A <a href="https://github.com/resteasy/Resteasy/tree/master/server-adapters/resteasy-netty4-cdi">resteasy-netty4-cdi</a> module is used to connect Netty, CDI and <a href="https://github.com/resteasy/Resteasy/tree/master/server-adapters/resteasy-netty4-cdi">Resteasy</a> .  JAX-RS is configured using the heir class javax.ws.rs.core.Application.  Usually, request handlers and other JAX-RS components are registered there.  When using CDI and Resteasy, it is sufficient to indicate that JIX-RS components will use CDI-registered request handlers (marked with JAX-RS: Path annotation) and other JAX-RS components, called providers (marked with JAX-RS annotation: Provider) .  More information about Resteasy can be found in the <a href="http://docs.jboss.org/resteasy/docs/3.1.2.Final/userguide/html/index.html">documentation</a> . <br><br><div class="spoiler">  <b class="spoiler_title">Netty and JAX-RS Application</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-function"> </span></span>{ ............... <span class="hljs-comment"><span class="hljs-comment">//  Netty      JAX-RS,    CDI . //  JAX-RS   Resteasy http://resteasy.jboss.org/ final CdiNettyJaxrsServer nettyServer = new CdiNettyJaxrsServer(); //  Netty (  ). final String host = configuration.getString( AppConfiguration.WEBSERVER_HOST, AppConfiguration.WEBSERVER_HOST_DEFAULT); nettyServer.setHostname(host); final int port = configuration.getInt( AppConfiguration.WEBSERVER_PORT, AppConfiguration.WEBSERVER_PORT_DEFAULT); nettyServer.setPort(port); //  JAX-RS. final ResteasyDeployment deployment = nettyServer.getDeployment(); //     JAX-RS (   ). deployment.setInjectorFactoryClass(CdiInjectorFactory.class.getName()); //  ,   JAX-RS        . deployment.setApplicationClass(ReactReduxIsomorphicExampleApplication.class.getName()); //  web . nettyServer.start(); ............... } /** *          JAX-RS */ @ApplicationScoped @ApplicationPath("/") public class ReactReduxIsomorphicExampleApplication extends Application { /** *   CDI  Resteasy. */ @Inject private ResteasyCdiExtension extension; /** * @return        JAX-RS. */ @Override @SuppressWarnings("unchecked") public Set&lt;Class&lt;?&gt;&gt; getClasses() { final Set&lt;Class&lt;?&gt;&gt; result = new HashSet&lt;&gt;(); //   CDI  Resteasy      JAX-RS. result.addAll((Collection&lt;? extends Class&lt;?&gt;&gt;) (Object)extension.getResources()); //   CDI  Resteasy     JAX-RS. result.addAll((Collection&lt;? extends Class&lt;?&gt;&gt;) (Object)extension.getProviders()); return result; } }</span></span></code> </pre><br></div></div><br>  All static files (javascript bundles, css, images) are placed in the classpath (src / main / resources / webapp), they will fit into the resulting jar file.  To access such files, a URL handler of the form {fileName:. *}. {Ext} is used, which loads the file from the classpath and gives it to the client. <br><br><div class="spoiler">  <b class="spoiler_title">Static Request Handler</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">/** *     . * &lt;p&gt;       {filename}.{ext}&lt;/p&gt; */</span></span> <span class="hljs-meta"><span class="hljs-meta">@Path</span></span>(<span class="hljs-string"><span class="hljs-string">"/"</span></span>) <span class="hljs-meta"><span class="hljs-meta">@RequestScoped</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">StaticFilesResource</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> Date START_DATE = DateUtils.setMilliseconds(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Date(), <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-meta"><span class="hljs-meta">@Inject</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Configuration configuration; <span class="hljs-comment"><span class="hljs-comment">/** *     .    classpath. * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> fileName    . * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> ext  . * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> uriInfo URL ,    . * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> request   . * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment">        404 -  . * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@throws</span></span></span><span class="hljs-comment"> Exception   . */</span></span> <span class="hljs-meta"><span class="hljs-meta">@GET</span></span> <span class="hljs-meta"><span class="hljs-meta">@Path</span></span>(<span class="hljs-string"><span class="hljs-string">"{fileName:.*}.{ext}"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Response </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getAsset</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( @PathParam(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"fileName"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> String fileName, @</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PathParam</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">"ext"</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> String ext, @Context UriInfo uriInfo, @Context Request request) </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> Exception </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(StringUtils.contains(fileName, <span class="hljs-string"><span class="hljs-string">"nomin"</span></span>) || StringUtils.contains(fileName, <span class="hljs-string"><span class="hljs-string">"server"</span></span>)) { <span class="hljs-comment"><span class="hljs-comment">//    . return Response.status(Response.Status.NOT_FOUND) .build(); } //  ifModifiedSince .     classpath, //       . final ResponseBuilder builder = request.evaluatePreconditions(START_DATE); if (builder != null) { //   . return builder.build(); } //      classpath. final String fileFullName = "webapp/static/" + fileName + "." + ext; //  . final InputStream resourceStream = ResourceUtilities.getResourceStream(fileFullName); if(resourceStream != null) { //  ,     . final String cacheControl = configuration.getString( AppConfiguration.WEBSERVER_HOST, AppConfiguration.WEBSERVER_HOST_DEFAULT); //     . return Response.ok(resourceStream) .type(URLConnection.guessContentTypeFromName(fileFullName)) .cacheControl(CacheControl.valueOf(cacheControl)) .lastModified(START_DATE) .build(); } //   . return Response.status(Response.Status.NOT_FOUND) .build(); } }</span></span></code> </pre><br></div></div><br><h2>  HTML server rendering on React </h2><br>  To build bundles when building a Java application, you can use the maven plugin <a href="https://github.com/eirslett/frontend-maven-plugin">frontend-maven-plugin</a> .  It loads and locally saves NodeJs of the required version locally, builds bundles using a webpack.  It is enough to run the usual Java project building with the mvn command (or in the IDE that supports integration with maven).  Client javascript, styles, package.json, webpack configuration file will be placed in the src / main / frontend directory, the resulting bundle in src / main / resources / webapp / static / assets. <br><br><div class="spoiler">  <b class="spoiler_title">Configure fronend-maven-plugin</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">plugin</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span>com.github.eirslett<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">groupId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span>frontend-maven-plugin<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">artifactId</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">configuration</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">nodeVersion</span></span></span><span class="hljs-tag">&gt;</span></span>v${node.version}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">nodeVersion</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">npmVersion</span></span></span><span class="hljs-tag">&gt;</span></span>${npm.version}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">npmVersion</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">installDirectory</span></span></span><span class="hljs-tag">&gt;</span></span>${basedir}/src/main/frontend<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">installDirectory</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">workingDirectory</span></span></span><span class="hljs-tag">&gt;</span></span>${basedir}/src/main/frontend<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">workingDirectory</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">configuration</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">executions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--  nodejs  npm  . --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">execution</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id</span></span></span><span class="hljs-tag">&gt;</span></span>nodeInstall<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">goals</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">goal</span></span></span><span class="hljs-tag">&gt;</span></span>install-node-and-npm<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">goal</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">goals</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">execution</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--   npm  src/main/frontend/package.json. --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">execution</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id</span></span></span><span class="hljs-tag">&gt;</span></span>npmInstall<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">goals</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">goal</span></span></span><span class="hljs-tag">&gt;</span></span>npm<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">goal</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">goals</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">execution</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--     webpack. --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">execution</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id</span></span></span><span class="hljs-tag">&gt;</span></span>webpackBuild<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">id</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">goals</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">goal</span></span></span><span class="hljs-tag">&gt;</span></span>webpack<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">goal</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">goals</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">configuration</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">skip</span></span></span><span class="hljs-tag">&gt;</span></span>${webpack.skip}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">skip</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">arguments</span></span></span><span class="hljs-tag">&gt;</span></span>${webpack.arguments}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">arguments</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">srcdir</span></span></span><span class="hljs-tag">&gt;</span></span>${basedir}/src/main/frontend/app<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">srcdir</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">outputdir</span></span></span><span class="hljs-tag">&gt;</span></span>${basedir}/src/main/resources/webapp/static/assets<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">outputdir</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">triggerfiles</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">triggerfile</span></span></span><span class="hljs-tag">&gt;</span></span>${basedir}/src/main/frontend/webpack.config.js<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">triggerfile</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">triggerfile</span></span></span><span class="hljs-tag">&gt;</span></span>${basedir}/src/main/frontend/package.json<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">triggerfile</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">triggerfiles</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">configuration</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">execution</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">executions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">plugin</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br>  To set up your own HTML page generator in JAX-RS, you need to create some kind of class, create a handler for it with annotations Provider, implementing the javax.ws.rs.ext.MessageBodyWriter interface, and return it as a response to the web request handler. <br>  Server rendering is performed using the Nashorn engine built into Java javascript.  This is a single-threaded scripting engine: to process several simultaneous requests, you need to use several cache engine instances, a free instance is taken for each request, HTML is rendered, then it is returned to the pool ( <a href="https://commons.apache.org/proper/commons-pool/">Apache Commons Pool 2</a> ). <br><br><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">/** *    web-. */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ViewResult</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String template; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Map&lt;String, Object&gt; viewData = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HashMap&lt;&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Map&lt;String, Object&gt; reduxInitialState = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HashMap&lt;&gt;(); .............. } <span class="hljs-comment"><span class="hljs-comment">/** *   ,   {</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@link</span></span></span><span class="hljs-comment"> ViewResult}   HTML. * &lt;p&gt; *      React      HTML (React Isomorphic), *      ,    React. * &lt;/p&gt; */</span></span> <span class="hljs-meta"><span class="hljs-meta">@Provider</span></span> <span class="hljs-meta"><span class="hljs-meta">@ApplicationScoped</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ViewResultBodyWriter</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MessageBodyWriter</span></span></span><span class="hljs-class">&lt;</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ViewResult</span></span></span><span class="hljs-class">&gt; </span></span>{ .............. <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ObjectPool&lt;AbstractScriptEngine&gt; enginePool = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-meta"><span class="hljs-meta">@PostConstruct</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">initialize</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//   . final boolean useIsomorphicRender = configuration.getBoolean( AppConfiguration.WEBSERVER_ISOMORPHIC, AppConfiguration.WEBSERVER_ISOMORPHIC_DEFAULT); final int minIdleScriptEngines = configuration.getInt( AppConfiguration.WEBSERVER_MIN_IDLE_SCRIPT_ENGINES, AppConfiguration.WEBSERVER_MIN_IDLE_SCRIPT_ENGINES_DEFAULT); LOG.info("Isomorphic render: {}", useIsomorphicRender); if(useIsomorphicRender) { //     React  ,    // javascript . Javascript , //          javascript. final GenericObjectPoolConfig config = new GenericObjectPoolConfig(); config.setMinIdle(minIdleScriptEngines); enginePool = new GenericObjectPool&lt;AbstractScriptEngine&gt;(new ScriptEngineFactory(), config); } } @PreDestroy public void destroy() { if(enginePool != null) { enginePool.close(); } } .............. @Override public void writeTo( ViewResult t, Class&lt;?&gt; type, Type genericType, Annotation[] annotations, MediaType mediaType, MultivaluedMap&lt;String, Object&gt; httpHeaders, OutputStream entityStream) throws IOException, WebApplicationException { .............. if(enginePool != null &amp;&amp; t.getUseIsomorphic()) { //  React  . try { //      javascript. final AbstractScriptEngine scriptEngine = enginePool.borrowObject(); try { // URL  ,  react-router     . final String uri = uriInfo.getPath() + (uriInfo.getRequestUri().getQuery() != null ? (String) ("?" + uriInfo.getRequestUri().getQuery()) : StringUtils.EMPTY); //    React. final String htmlContent = (String)((Invocable)scriptEngine).invokeFunction( "renderHtml", uri, initialStateJson); //     . enginePool.returnObject(scriptEngine); viewData.put(HTML_CONTENT_KEY, htmlContent); } catch (Throwable e) { enginePool.invalidateObject(scriptEngine); throw e; } } catch (Exception e) { throw new WebApplicationException(e); } } else { viewData.put(HTML_CONTENT_KEY, StringUtils.EMPTY); } //  HTML  . final String pageContent = StrSubstitutor.replace(templateContent, viewData); entityStream.write(pageContent.getBytes(StandardCharsets.UTF_8)); } /** *       javascript. */ private static class ScriptEngineFactory extends BasePooledObjectFactory&lt;AbstractScriptEngine&gt; { @Override public AbstractScriptEngine create() throws Exception { LOG.info("Create new script engine"); //  nashorn   javascript . final AbstractScriptEngine scriptEngine = (AbstractScriptEngine) new ScriptEngineManager().getEngineByName("nashorn"); try(final InputStreamReader polyfillReader = ResourceUtilities.getResourceTextReader(WEBAPP_ROOT + "server-polyfill.js"); final InputStreamReader serverReader = ResourceUtilities.getResourceTextReader(WEBAPP_ROOT + "static/assets/server.js")) { //     ,    nashorn,       . scriptEngine.eval(polyfillReader); //  ,    HTML     React. scriptEngine.eval(serverReader); } //   . ((Invocable)scriptEngine).invokeFunction( "initializeEngine", ResourceUtilities.class.getName()); return scriptEngine; } @Override public PooledObject&lt;AbstractScriptEngine&gt; wrap(AbstractScriptEngine obj) { return new DefaultPooledObject&lt;AbstractScriptEngine&gt;(obj); } } }</span></span></code> </pre><br>  The engine executes Javascript versions of ECMAScript 5.1 and does not support loading modules, therefore the server script, like the client script, will be assembled into bundles using a webpack.  The server bundle and client bundle are built on the basis of a common code base, but they have different entry points.  For some reason, Nashorn cannot execute the minimized bundle (collected by the webpack with the --optimize-minimize key) - crashes, so on the server side you need to execute the unminimized bundle.  To build both types of bundles, you can use the Webpack plugin at the same time: <a href="https://github.com/leftstick/unminified-webpack-plugin">unminified-webpack-plugin</a> . <br><br>  When you first request any page, or if there is no free engine instance, we will initialize a new instance.  The initialization process consists of creating an instance of Nashorn and executing in it server scripts loaded from the classpath.  Nashorn does not implement several ordinary javascript functions, such as setInterval, setTimeout, so you need to include the simplest script-polyfill.  Then the code that forms the HTML pages is loaded directly (just like on the client).  This process is not very fast, on a fairly powerful computer it takes a couple of seconds, so you need a cache of engine instances. <br><br><div class="spoiler">  <b class="spoiler_title">Polyphyl for Nashorn</b> <div class="spoiler_text"><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//   global  javascript . var global = this; //   window  javascript ,     , //       . var window = this; //    ,  Nashorn  console. var console = { error: print, debug: print, warn: print, log: print }; //  Nashorn  setTimeout,  callback -     . function setTimeout(func, delay) { func(); return 0; }; function clearTimeout() { }; //  Nashorn  setInterval,  callback -     . function setInterval(func, delay) { func(); return 0; }; function clearInterval() { };</span></span></code> </pre><br></div></div><br>  HTML rendering on an already initialized engine is much faster.  To get the HTML generated by React, we write the renderHtml function, which we put in the server entry point (src \ server.jsx).  The current URL is transferred to this function, for processing it using react-router, and the initial redux state for the requested page (as JSON).  The same state for redux, in the form of JSON, is placed on the page in the variable window.INITIAL_STATE.  This is necessary so that the element tree built by React on the client matches the HTML generated on the server. <br><br>  Js bundle server entry point: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/** *   HTML   React. * @param {String} url URL  . * @param {String} initialStateJson    Redux     JSON. * @return {String} HTML,  React. */</span></span> renderHtml = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">renderHtml</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">url, initialStateJson</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//  JSON    Redux. const initialState = JSON.parse(initialStateJson) //     react-router (   ). const history = createMemoryHistory() //   Redux    ,   . const store = configureStore(initialState, history, true) //       . const htmlContent = {} global.INITIAL_STATE = initialState //       URL   react-router. match({ routes: routes({history}), location: url }, (error, redirectLocation, renderProps) =&gt; { if (error) { throw error } //  HTML     React. htmlContent.result = ReactDOMServer.renderToString( &lt;AppContainer&gt; &lt;Provider store={store}&gt; &lt;RouterContext {...renderProps}/&gt; &lt;/Provider&gt; &lt;/AppContainer&gt; ) }) return htmlContent.result }</span></span></code> </pre><br>  Js bundle client entry point: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//   Redux. const store = configureStore(initialState, history, false) //      HTML,  React. const contentElement = document.getElementById("content") //   HTML   React. ReactDOM.render(&lt;App store={store} history={history}/&gt;, contentElement)</span></span></code> </pre><br><h2>  HTML / styles reboot support </h2><br>  For the convenience of developing the client side, you can customize the webpack dev server with the support of ‚Äúhot‚Äù reloading of changed pages or styles.  The developer starts the application, launches the webpack dev server on another port (for example, setting the npm run debug command in package.json) and gets the opportunity in most cases not to update the modified pages - the changes are applied on the fly, this applies to both HTML code and style code .  To do this, in the browser, go to the previously configured address of the webpack dev server.  The server builds bundles on the fly, the remaining requests are proxied to the application. <br><br>  package.json: <br><pre> <code class="hljs json">{ <span class="hljs-attr"><span class="hljs-attr">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"java-react-redux-isomorphic-example"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"version"</span></span>: <span class="hljs-string"><span class="hljs-string">"1.0.0"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"private"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-attr"><span class="hljs-attr">"scripts"</span></span>: { <span class="hljs-attr"><span class="hljs-attr">"debug"</span></span>: <span class="hljs-string"><span class="hljs-string">"cross-env DEBUG=true APP_PORT=8080 PROXY_PORT=8081 webpack-dev-server --hot --colors --inline"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"build"</span></span>: <span class="hljs-string"><span class="hljs-string">"webpack"</span></span>, <span class="hljs-attr"><span class="hljs-attr">"build:debug"</span></span>: <span class="hljs-string"><span class="hljs-string">"webpack -p"</span></span> } }</code> </pre><br>  To configure the "hot" reboot, follow the steps below. <br><br>  In the webpack settings file: <br><br><ul><li>  In devtools, specify module-source-map or module-eval-source-map.  When the module-source-map is enabled, debugging information is included in the module body - in this case, breakpoints will work when the page is fully reloaded, but when the pages in the Chrome debugging tools change, duplicate modules appear, each with its own version.  If you enable the module-eval-source-map, then there will be no duplicates, although the breakpoints during the general reload of the page will not work. <br><br><pre> <code class="javascript hljs"> devtool: isHot <span class="hljs-comment"><span class="hljs-comment">//    "" . ? "module-source-map" // "module-eval-source-map" //    production. : "source-map"</span></span></code> </pre><br></li><li>  In devServer, configure the webpack debug server: set the ‚Äúhot‚Äù reboot flag, specify the server port and specify the settings for proxying requests to the application. <br><br><pre> <code class="javascript hljs"> <span class="hljs-comment"><span class="hljs-comment">//     . devServer: { //  . hot: true, //  . port: proxyPort, //        . proxy: { "*": `http://localhost:${appPort}` } }</span></span></code> </pre><br></li><li>  In the entry for the entry point of the client script, connect the module - mediator: react-hot-loader / patch. <br><br><pre> <code class="javascript hljs"> entry: { <span class="hljs-comment"><span class="hljs-comment">//    . main: ["es6-promise", "babel-polyfill"] .concat(isHot //   ""  -  . ? ["react-hot-loader/patch"] //    . : []) .concat(["./src/main.jsx"]), //      . [isProduction ? "server.min" : "server"]: ["es6-promise", "babel-polyfill", "./src/server.jsx"] }</span></span></code> </pre><br></li><li>  In the output in the publicPath setting specify the full URL of the webpack dev server. <br><br><pre> <code class="javascript hljs"> output: { <span class="hljs-comment"><span class="hljs-comment">//   . path: Path.join(__dirname, "../resources/webapp/static/assets/"), publicPath: isHot //    ""  (   ). ? `http://localhost:${proxyPort}/assets/` : "/assets/", filename: "[name].js", chunkFilename: "[name].js" }</span></span></code> </pre><br></li><li>  In the settings of the babel loader, connect plug-ins to support hot boot: syntax-dynamic-import and react-hot-loader / babel. <br><br><pre> <code class="javascript hljs"> { <span class="hljs-comment"><span class="hljs-comment">//  JavaScript (Babel). test: /\.(js|jsx)?$/, exclude: /(node_modules)/, use: [ { loader: isHot //  ""    babel. ? "babel-loader?plugins[]=syntax-dynamic-import,plugins[]=react-hot-loader/babel" : "babel-loader" } ] }</span></span></code> </pre><br></li><li>  In the settings of the style loader, specify the use of the style-loader loader.  In this case, the styles will be inline in javascript code.  When the hot reload of styles is disabled (for example, in production), a bundle of styles is created using the extract-text-webpack-plugin. <br><br><pre> <code class="javascript hljs"> { <span class="hljs-comment"><span class="hljs-comment">//   CSS. test: /\.css$/, use: isHot //   ""       JavaScript . ? ["style-loader"].concat(cssStyles) //  production -    . : ExtractTextPlugin.extract({use: cssStyles, publicPath: "../assets/"}) }</span></span></code> </pre><br></li><li>  Connect the Webpack.NamedModulesPlugin plugin to form the named modules. <br></li></ul><br>  At the client entry point into the application, insert the module update handler.  The handler loads the updated module and starts the HTML rendering process using React. <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//   HTML   React. ReactDOM.render(&lt;App store={store} history={history}/&gt;, contentElement) if (module.hot) { //  ""  . module.hot.accept("./containers/app", () =&gt; { const app = require("./containers/app").default ReactDOM.render(app({store, history}), contentElement) }) }</span></span></code> </pre><br>  In the module where the redux repository is created, insert the module update handler.  This handler loads updated redux converters and replaces old ones with them. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> store = createStore(reducers, initialState, applyMiddleware(...middleware)) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.hot) { <span class="hljs-comment"><span class="hljs-comment">//  ""  Redux-. module.hot.accept("./reducers", () =&gt; { const nextRootReducer = require("./reducers") store.replaceReducer(nextRootReducer) }) } return store</span></span></code> </pre><br>  In the Java application itself, you need to disable building bundles via frontend-maven-plugin and using React server rendering: now webpack dev server begins to answer for building scripts and styles, it does this very quickly and in memory, the processor and disk will not be loaded by rebuilding bundles  To disable rebuilding using frontend-maven-plugin and React server rendering, you can provide a maven: frontendDevelopment profile (you can enable it in an IDE that supports integration with maven).  If necessary, bundles are reassembled manually at any time using a webpack. </div><p>Source: <a href="https://habr.com/ru/post/327480/">https://habr.com/ru/post/327480/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../327468/index.html">Consensus Algorithms: Proof of Share and Proof of Work</a></li>
<li><a href="../327470/index.html">DevExtreme: now on GitHub and with a free license</a></li>
<li><a href="../327472/index.html">Vivaldi 1.9 - plant not transplant</a></li>
<li><a href="../327474/index.html">We write the URL, we get a free icon</a></li>
<li><a href="../327476/index.html">How we learned to upgrade Tenzor's 5,000 servers.</a></li>
<li><a href="../327482/index.html">How do i write code</a></li>
<li><a href="../327484/index.html">My upgrade byndyusoft.Infrastructure | DDD + CQRS + WebApi</a></li>
<li><a href="../327486/index.html">Paparazzo. Powerful, stylish, your own. Part II</a></li>
<li><a href="../327488/index.html">What is the Cyber-Kill Chain and why should it be taken into account in the protection strategy?</a></li>
<li><a href="../327490/index.html">Powershell Empire and FuzzBunch: exploiting the notorious ETERNALBLUE vulnerability</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>