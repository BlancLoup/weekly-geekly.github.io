<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Experience replacing Microsoft Outlook with Mozilla Thunderbird with Exchange Server</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Task 
 There is a company with Windows servers. They raised DNS, WINS, Active Directory, CA, Exchange. Office is installed on user sites with Outlook ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Experience replacing Microsoft Outlook with Mozilla Thunderbird with Exchange Server</h1><div class="post__text post__text-html js-mediator-article"><h4>  Task </h4><br>  There is a company with Windows servers.  They raised DNS, WINS, Active Directory, CA, Exchange.  Office is installed on user sites with Outlook for information exchange, since there is no direct connection between departments and the ability to write to external media is significantly limited.  All licensed.  Quite a typical situation for medium-sized companies. <br><br>  In terms of cost savings, the question arose of sufficient replacement of the Microsoft Office component - Outlook.  There are many advantages of Outlook: pass-through authentication, a convenient and intuitive interface, automatic archiving, flexible and full integration with Exchange, which includes dynamic address books, shared folders, and so on.  Replacing such a product is quite difficult without loss of functionality. <br><br><h4>  Implementation </h4><br>  After some comparisons, Mozilla Thunderbird (currently version 31) was chosen as an alternative client as a free, open source project that supports IMAP and an LDAP address book, as well as with the ability to use add-ons. <br><a name="habracut"></a><br><h5>  Password </h5><br>  The password is sewn into the client and can be viewed in the settings.  Yes, it reduces security, but Thunderbird mail users have guest domain accounts, and are not administrators on local computers.  In addition, it is planned to implement a centralized setting where the password view will be blocked.  This was considered acceptable. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  Mail account </h5><br>  Thunderbird does not work correctly with Russian logins Windows.  Therefore, you must first rename the domain logins of Thunderbird users to the English equivalent.  It is recommended to make logins exactly like mail, to simplify setup, although this is not necessary, especially if the host is a domain, it does not matter. <br><br>  The Exchange server has IIS for accessing mail through a web interface, Outlook Web Access.  A handy thing for remote work with mail, provided that mail for some period is stored on the server.  But the lack of the ability to archive mail from the browser does not allow you to make this mode of operation permanent, because the Exchange server hardware resources are not unlimited, and it is not intended for storage.  Thunderbird has several modes to help <a href="https://wiki.mozilla.org/Thunderbird:Autoconfiguration">set up an account</a> .  The easiest way to alias (CNAME) is DNS <i>autoconfig</i> on the Exchange server: <i>autoconfig.company.loc</i> .  And on the server in IIS, create a <i>mail</i> folder with the file <i>config-v1.1.xml</i> .  The content of the file is quite simple and is described <a href="https://wiki.mozilla.org/Thunderbird:Autoconfiguration:ConfigFileFormat">on the Mozilla website</a> .  In my case it turned out like this: <br><br><pre><code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">clientConfig</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.1"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">emailProvider</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"company.loc"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">domain</span></span></span><span class="hljs-tag">&gt;</span></span>company.loc<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">domain</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">displayName</span></span></span><span class="hljs-tag">&gt;</span></span>Company Exchange Server<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">displayName</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">displayShortName</span></span></span><span class="hljs-tag">&gt;</span></span>Company e-mail<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">displayShortName</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">incomingServer</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"imap"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hostname</span></span></span><span class="hljs-tag">&gt;</span></span>mail.company.loc<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hostname</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port</span></span></span><span class="hljs-tag">&gt;</span></span>993<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">socketType</span></span></span><span class="hljs-tag">&gt;</span></span>SSL<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">socketType</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">authentication</span></span></span><span class="hljs-tag">&gt;</span></span>NTLM<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">authentication</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">username</span></span></span><span class="hljs-tag">&gt;</span></span>%EMAILLOCALPART%<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">username</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">incomingServer</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">incomingServer</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"imap"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hostname</span></span></span><span class="hljs-tag">&gt;</span></span>mail.company.loc<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hostname</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port</span></span></span><span class="hljs-tag">&gt;</span></span>143<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">socketType</span></span></span><span class="hljs-tag">&gt;</span></span>STARTTLS<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">socketType</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">authentication</span></span></span><span class="hljs-tag">&gt;</span></span>NTLM<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">authentication</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">username</span></span></span><span class="hljs-tag">&gt;</span></span>%EMAILLOCALPART%<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">username</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">incomingServer</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">incomingServer</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"pop3"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hostname</span></span></span><span class="hljs-tag">&gt;</span></span>mail.company.loc<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hostname</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port</span></span></span><span class="hljs-tag">&gt;</span></span>995<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">socketType</span></span></span><span class="hljs-tag">&gt;</span></span>SSL<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">socketType</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">authentication</span></span></span><span class="hljs-tag">&gt;</span></span>NTLM<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">authentication</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">username</span></span></span><span class="hljs-tag">&gt;</span></span>%EMAILLOCALPART%<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">username</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pop3</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">leaveMessagesOnServer</span></span></span><span class="hljs-tag">&gt;</span></span>true<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">leaveMessagesOnServer</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">downloadOnBiff</span></span></span><span class="hljs-tag">&gt;</span></span>true<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">downloadOnBiff</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">daysToLeaveMessagesOnServer</span></span></span><span class="hljs-tag">&gt;</span></span>14<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">daysToLeaveMessagesOnServer</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pop3</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">incomingServer</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">outgoingServer</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"smtp"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hostname</span></span></span><span class="hljs-tag">&gt;</span></span>mail.company.loc<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hostname</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port</span></span></span><span class="hljs-tag">&gt;</span></span>587<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">port</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">socketType</span></span></span><span class="hljs-tag">&gt;</span></span>STARTTLS<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">socketType</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">authentication</span></span></span><span class="hljs-tag">&gt;</span></span>NTLM<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">authentication</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">username</span></span></span><span class="hljs-tag">&gt;</span></span>%EMAILLOCALPART%<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">username</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">outgoingServer</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">emailProvider</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">clientConfig</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><br>  The <i>mail</i> folder should be made virtual and explicitly disable the SSL requirement for it. <br><br>  It is worth mentioning that with us, like with many, the domain name from the outside is different from the name of the local domain inside the perimeter.  But mail should be referred to the same everywhere.  Therefore, within Exchange accounts have two addresses: external and internal.  External is used by default.  (Exchange can also use different DNS for internal and external forwarding).  Hence the subtlety;  The user addresses for the settings are external, so the name for the user name is only the name <i>% EMAILLOCALPART%</i> .  In addition, the <i>autoconfig</i> alias (CNAME) must also be created in the copy of the external domain of the root zone of the local DNS. <br><br>  It can be seen that I decided to use two types of access to mail: IMAP and POP3.  The fact is that sometimes very active users come across with a very large amount of mail.  If such a user does not use mail anywhere except for his PC at his workplace (do not forget about OWA), then in the case of Outlook local folders are created and assigned as the main ones for all accounts.  Thus, all mail will be deleted from the Exchange server and stored directly on the user's PC, which does not require any additional archiving, but binds the user to the PC and increases the likelihood of mail loss if the hard disk is damaged.  Otherwise, individual setting of limits on Exchange for such users is required, which I try to avoid in every way.  But you cannot foresee everything.  Therefore, for Thunderbird also left the possibility of simple work with mail in the form of POP3.  Although it is still not useful, frankly. <br><br>  All this allows you to quickly select the desired access method when setting up an account in Thunderbird.  If the host is in the AD domain, then it is better, nevertheless, to tweak by selecting the authentication method "Kerberos / GSSAPI" and not to specify the password in the form. <br><br>  Access to Exchange via IMAP and POP3 is very easy to set up and does not require any special consideration.  Is that additionally you have to configure the certificate with the appropriate server name masks for connectors.  And it also took some additional configuration of the SMTP connector with TLS on Exchange 2007: <br><pre> <code class="dos hljs">Get-ReceiveConnector ‚ÄúClient TLS‚Äù | Add-ADPermission ‚ÄìUser ‚Äúauthenticated users‚Äù -ExtendedRights ms-Exch-SMTP-Accept-Authoritative-Domain-Sender</code> </pre><br>  Otherwise, Thunderbird could not access via SMTP as unauthorized. <br><br><h5>  Profile and certificate </h5><br>  The first launch of the newly installed Thunderbird client is done with the <i>-p</i> key to specify the path for the mail profile.  The default mail profile is created on the system partition, which is unacceptable for us.  The key allows you to specify a folder on the user section for storing the Thunderbird profile (in our case, the d: \ Mail folder).  You should first make sure that the user has the right to change this folder (NTFS rights). <br><br><pre> <code class="dos hljs">"c:\Program Files (x86)\Mozilla Thunderbird\thunderbird.exe" -p</code> </pre><br>  It is worth recalling that the command must be executed from the user context, and not the administrative one.  There were precedents. <br><br>  The first step to configure the running client is to refuse the wizard's suggestions and add the organization root certificate to Thunderbird, because Thunderbird, for some reason, does not use the system certificate base. <br><br><h5>  LDAP Address Book </h5><br>  You must then configure your LDAP address book.  There are a lot of materials on this topic on the Internet, but I didn‚Äôt find a single full-fledged document with adequate parameters, so here‚Äôs my own. <br><br>  1. Open the <i>Address Book</i> window. <br>  2. Call Tools -&gt; Settings -&gt; Compilation -&gt; Autocompletion of addresses and tick the <i>Directory Server</i> <br><img src="https://habrastorage.org/files/b98/9cf/228/b989cf2285c14adc852a45d89316e7ca.PNG"><br>  <sub>The Microsoft Exchange Global Addressbook and Contacts switches in the picture are due to the <a href="https://addons.mozilla.org/ru/thunderbird/addon/exquilla-exchange-web-services/">ExQuilla</a> add-on under test - connecting to Exchange via http.</sub>  <sub>The result - the speed of work is unsatisfactory with a large amount of mail.</sub> <br><br>  3. Actually create an LDAP connection: <br><img src="https://habrastorage.org/files/315/b4a/cec/315b4acec1124f528ae9414dba012255.PNG"><br>  Everything is obvious.  <u>Non-</u> SSL port: <b>3268</b> .  It should be borne in mind that setting up with SSL works significantly slower. <br><br>  Next, switch to the <i>Advanced</i> tab: <br><img src="https://habrastorage.org/files/f65/257/21b/f6525721b132459db4846d13d472512e.PNG"><br>  Here it must be said that the number of displayed results was chosen based on the number of Exchange CALs, plus Active Directory contacts with groups and a small margin.  Authentication method is better to select ‚ÄúSimple‚Äù if the PC is not in the AD domain, otherwise I recommend Kerberos (GSSAPI), and you must remove the user name on the ‚ÄúBasic‚Äù tab. <br><br>  About the <a href="http://social.technet.microsoft.com/wiki/contents/articles/5392.active-directory-ldap-syntax-filters.aspx">filter</a> .  The most interesting.  I use dynamic mailing lists in Exchange, in addition there are many temporarily or permanently disabled accounts in Active Directory, and some accounts are excluded from visibility in the address book for various needs, plus contacts.  It turns out the following filter: <br><pre> <code class="html hljs xml">(&amp;(mailnickname=*)(|(objectcategory=person)(objectclass=msExchDynamicDistributionList))(!(userAccountControl:1.2.840.113556.1.4.803:=2))(!(msExchHideFromAddressLists=TRUE)))</code> </pre><br>  Close the dialogs.  Now open the newly created address book and type @ in the search bar <b>without pressing</b> Enter, since the input will go into a dialog with a password.  In the dialog, type the user password and tick the <i>Save password</i> box.  A mailing list should appear.  It works well.  Simply start typing the name or address of the recipient in the <i>To:</i> line of the new letter to get a list of possible options. <br><br>  Attention!  If in Active Directory you have restricted the list of hosts for an account that you can log in to, then in order to access LDAP on the PDC, you will need to add the name of the controller to this list. <br><br>  Further.  Create a user account.  If everything is pre-configured correctly, the option with the correct setting will be offered instantly. <br><img src="https://habrastorage.org/files/984/955/d10/984955d10b2c40acaee00cabb0d71eab.png"><br>  It remains to click ready and, if the root certificate was previously connected, we will receive the connected mail.  Otherwise, you will have to confirm each certificate. <br><br><h5>  Archiving and other additions </h5><br>  Customize signed folders.  While synchronization is in progress, we set up archiving to local folders: <i>Account Settings -&gt; Copies and Folders -&gt; Message Archives - Store archived messages in: - the ‚ÄúArchives‚Äù folder in: Local folders.</i>  Archiving can be divided into folders, years, months.  In normal mode, Thunderbird can only archive mail manually.  Autoarchiving can be achieved by installing a special plugin ( <a href="https://addons.mozilla.org/ru/thunderbird/addon/awesome-auto-archive/">Awesome Auto Archive)</a> .  It is configured quite simply. <br><br>  Also install the following additions: <br><ul><li>  <a href="https://addons.mozilla.org/ru/thunderbird/addon/minimizetotray-revived/">MinimizeToTray revived</a> - Minimize the current window to tray </li><li>  <a href="https://addons.mozilla.org/ru/thunderbird/addon/lightning/">Lightning</a> - Organizer </li></ul><br>  We get a workable email client.  Access to shared folders can be obtained through OWA by creating a link in the browser or on the desktop to the corresponding OWA section: <pre>  https: //mail.company.loc/Public </pre><br><br><h5>  PST import </h5><br>  Now to the question of <a href="http://kb.mozillazine.org/Import_.pst_files">importing previously archived Outlook mail into Thunderbird</a> .  The described method with the installation of 30-day Outlook does not work.  Thunderbird is thrown, generating an exception.  Tested many different configurations.  In addition, import on Windows x64 is excluded.  I had to go round the way.  There is a working method, but it is quite saturated with manipulations. <br><ol><li>  A free <a href="http://www.coolutils.com/OutlookViewer">Outlook Viewer is being</a> downloaded that can read .pst files - Outlook archives.  Installed on the PC for manipulation. </li><li>  The client pst is taken over the network, opened and the letters are exported to a folder with subfolders (subfolders can be inside the archive) in EML format with attachments.  This is still half the battle! </li><li>  Then in the temporarily installed Thunderbird with the <a href="https://addons.mozilla.org/ru/thunderbird/addon/importexporttools/">ImportExportTools</a> add-on <a href="https://addons.mozilla.org/ru/thunderbird/addon/importexporttools/">installed,</a> create a local folder, for example <i>, Outlook-Archive</i> and right-click on it to <a href="https://addons.mozilla.org/ru/thunderbird/addon/importexporttools/">open the</a> add <i>-</i> on import menu: </li><li><img src="https://habrastorage.org/files/ab9/321/4b9/ab93214b9f884423bf1cdc204733b12d.png"></li><li>  Select the folder with the previously exported letters and import. </li><li>  Now right-click on the folder <i>Archive-Outlook,</i> call the properties of the folder and see where it is located.  Having determined, we transfer (files with the folder name, and subfolders with the folder name) on the user's PC to the user profile in local folders.  Our folder with mail from the archive should appear in the user in Thunderbird after restarting. </li></ol><br><br>  I think to introduce a centralized configuration of users. <br><br>  Work on the run-in is still underway, so I can make additions and changes. </div><p>Source: <a href="https://habr.com/ru/post/233963/">https://habr.com/ru/post/233963/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../233951/index.html">3D cartoon from scratch</a></li>
<li><a href="../233953/index.html">Published records of the conference reports DevCon 2014</a></li>
<li><a href="../233955/index.html">How Yandex.Metrika sells ‚Äúgeneralized statistical information‚Äù of your site to your competitors</a></li>
<li><a href="../233957/index.html">An authorization module for a site using the Wargaming.net Public API</a></li>
<li><a href="../233961/index.html">Copying partitions on a hard disk using GNU / Linux: how to manage a bootable USB flash drive where Acronis was previously needed</a></li>
<li><a href="../233967/index.html">LEO fitness system will become a personal trainer for those who do not have it</a></li>
<li><a href="../233969/index.html">Market analysts and project managers</a></li>
<li><a href="../233971/index.html">OpenVPN Installation and Setup Guide</a></li>
<li><a href="../233973/index.html">Use liquibase plugin for maven</a></li>
<li><a href="../233975/index.html">How not to get lost on the comet Churyumov-Gerasimenko</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>