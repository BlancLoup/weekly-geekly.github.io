<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Why Spritz has become so popular over the past few weeks.</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello, dear cryptographers and mathematicians! 
 It is difficult for me, not professional mathematics and not a cryptographer, to understand immediate...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Why Spritz has become so popular over the past few weeks.</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/3cf/a93/584/3cfa93584d7f4fd6b891cb2c935fc79f.png"><br><br><h2>  Hello, dear cryptographers and mathematicians! </h2><br>  It is difficult for me, not professional mathematics and not a cryptographer, to understand immediately how the encryption algorithm works.  Before you try to deal with the individual functions of a single algorithm.  And also, to understand why the Spritz algorithm is now more discussed by <a href="https://www.schneier.com/blog/archives/2014/10/spritz_a_new_rc.html">experts</a> than, for example, <a href="https://duckduckgo.com/%3Fkh%3D1%26q%3DKeccak%26sites%3Dwww.schneier.com%252Fblog">Keccak</a> .  On Habr√© there were several articles that described the <a href="https://en.wikipedia.org/wiki/Sponge_function">Sponge function</a> , or, in Russian, the sponge ( <a href="http://habrahabr.ru/post/159073/">one</a> , <a href="http://habrahabr.ru/post/168707/">two</a> ).  This function can be used in several ways: as a cryptor / decryptor, as a hash, as a hash with separate domains, to form a message authenticity code (MAC) or simulator, to work as a stream cipher and as a stream cipher with random access, for authentication with associated data (Authenticated Encryption with Associated Data) as a pseudo-random number generator and for generating symmetric keys from passwords. <br><a name="habracut"></a><br>  To figure it out, I used the original <a href="http://people.csail.mit.edu/rivest/pubs/RS14.pdf">article</a> and <a href="http://crypto.2014.rump.cr.yp.to/3de41b60e32a494c8f0fc9c21c67063a.pdf">presentation</a> , as well as the source code from GitHub ( <a href="https://github.com/jedisct1/spritz">C</a> , <a href="https://github.com/therealjampers/spritzjs">JS</a> ). <br><br>  Since I am not an expert, I‚Äôll start with examples.  In particular, from the function hash (M, r). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      M is the input byte array. <br>  r is the length of the output hash of the array in bytes. <br><br>  As can be seen from the example, the input array has a length of 3 bytes, and the output is 32 bytes.  Thus, the array length is increased by 29 bytes. <br><br><h2>  Let's see how this happens. </h2><br>  Initially, the variables and the array of permutations are initialized. <br><br>  i = j = k = z = a = 0; <br>  w = 1; <br><br>  i, j are the positions of two elements. <br>  to - key <br>  z is the last calculated value. <br>  a - the number of used nibbles (nibbles) <br><br>  All of these values ‚Äã‚Äãare initially zero. And the array of permutations initially has ordered values ‚Äã‚Äãfrom 1 to N. In our example, N is 256. <br><br>  w - the width of the hop is 1, but may vary depending on the presence of the greatest common factor with N. <br><br><h2>  Soak up </h2><br>  Then the function is called absorb (M) - absorption, as we remember the array M in the example consists of 3 bytes.  For definiteness, let it be bytes 'A', 'B' and 'C'.  The ‚Äúsponge‚Äù has a rather large size of 256 bytes, for our 3 bytes that need to be absorbed.  For each byte, we call the function absorbByte ('A'), similarly for 'B' and 'C'. <br><br>  Each byte is divided into two nibbla - the older and the younger, and for each of them we call the function absorbNibble ('low 4 bits'), the same for the high 4 bits of a byte. <br>  How does the current nibbla absorb?  The function absorbNibble takes the first byte from the array of permutations (it is equal to 1) and interferes with its position equal to the middle of the array <br>  permutations plus the value of the nibbl itself.  Since code A is equal to 65. Then the lowest nibble is 1, then the new position for the first element is 128 + 1 = 129. <br>  And in the first position we will have the number 129. <br><br>  Next, we increase the count of used nibls by 1 (a = 2). <br><br>  We do the same for the older nibbl and for the remaining 2 bytes.  In total, in our example, 6 permutations should be carried out, according to the number of nibbles used. <br><br><h2>  Shack </h2><br>  After that, run the function shuffle () - shuffle. <br><br>  Here's what she looks like: <br><br><pre><code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/* Shuffle() 1 Whip(2N) 2 Crush() 3 Whip(2N) 4 Crush() 5 Whip(2N) 6 a=0 */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">shuffle</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ whip(TWO_N); crush(); whip(TWO_N); crush(); whip(TWO_N); a = <span class="hljs-number"><span class="hljs-number">0</span></span>; }</code> </pre> <br><br>  The first thing to do is run the update () function - update 2N times.  It is in this function that Spritz differs from RC4 ( <a href="http://crypto.2014.rump.cr.yp.to/3de41b60e32a494c8f0fc9c21c67063a.pdf">presentation</a> , <a href="https://www.schneier.com/blog/archives/2014/10/spritz_a_new_rc.html">analysis</a> ). <br><br><h3>  Compare operations with RC4 </h3><br>  RC4: <br><br><pre> <code class="bash hljs">1: i = i + 1 2: j = j + S[i] 3: SWAP(S[i];S[j]) 4: z = S[S[i] + S[j]] 5: Return z</code> </pre><br><br>  Spritz: <br><br><pre> <code class="bash hljs">1: i = i + w 2: j = k + S[j + S[i]] 2a: k = i + k + S[j] 3: SWAP(S[i];S[j]) 4: z = S[j + S[i + S[z + k]]] 5: Return z</code> </pre><br><br>  Spritz with my modification for better understanding: <br><br><pre> <code class="bash hljs">1: i = i + w 2: j = j + S[i] 2a: j = k + S[j] 2b: k = i + j 3: SWAP(S[i];S[j]) 4a: i = i + S[k+z] // z=S[j] c   4b: j = j + S[i] 4c: z = S[j] 5: Return z</code> </pre><br><br>  4, the operation can be represented as: Ez = S [j + S [i + S [k + z]]] = kzpSipSjpS. <br><br><h3>  Shake and crush </h3><br>  The parameter w appeared - which must be an odd number.  In RC4, it is always 1. <br>  Another dependent parameter, k, has appeared. <br>  The function name Whip (2N) can be translated as shaking, and Crush () as pressure. <br><br>  The Whip function performs operations 1,2,2a, 3.  Then it increases the parameter w by one as many times as the largest common factor for w and N will be found. <br><br>  i runs through all values ‚Äã‚Äãfrom 1 to 512. Suppose that k = 0.  So it is set during initialization.  Then, before the first iteration, j will be equal to 0. And after the first iteration, j = S [S [1]], but S [1] = 129, and if, with absorb, the first and 129 elements were rearranged only once, then j = 1.  Then k at step 2a will take the value k = 129. <br><br>  The Crush () function changes the values ‚Äã‚Äãsymmetric about the center of the array of permutations if the value on the right side is greater than the value on the left side. <br><br><h2>  Squeeze </h2><br>  This is the final operation squeeze (r).  In our output array \ hash, we need to get r bytes.  After calling drip () and update (), the final output () operation is performed: <br><br><pre> <code class="javascript hljs"> <span class="hljs-comment"><span class="hljs-comment">/* Output() 1 z = S[j+S[i+S[z+k]]] 2 return z */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">output</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ z = S[ madd(j, S[ madd(i, S[ madd(z, k) ]) ]) ]; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> z; }</code> </pre><br><br>  As you can see, unlike RC4, this operation depends on the value of z calculated at the previous step.  It turns out several fractal algorithm. <br><br><h2>  Notice </h2><br>  This is a completely new cipher, it will take time before this analysis appears.  As a result of viewing the code, I drew on the following features. <br><br><pre> <code class="javascript hljs"> <span class="hljs-comment"><span class="hljs-comment">/* addition modulo N */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">madd</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">a, b</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (a + b) % N; <span class="hljs-comment"><span class="hljs-comment">// return (a + b) &amp; 0xff; // when N = 256, 0xff = N - 1 } /* subtraction modulo N. assumes a and b are in N-value range */ function msub(a, b) { return madd(N, a - b); }</span></span></code> </pre><br><br>  All summation and subtraction are done on a cyclic buffer with size N (this is specified in the article).  This is probably a feature of this particular implementation, but it seemed to me that in some it is a rather simple summation or difference.  If I understand correctly, the size of the buffer may be different. <br><br>  The code is sensitive to the initial value of w.  During initialization, this parameter is set to 1. What happens if it is set to N? <br><br>  The array of permutations S is initialized with values ‚Äã‚Äãfrom 1 to N, therefore S [i] = i, if the input buffer length is small, then this will be true in subsequent rounds. <br><br>  With a special selection of the key and the initialization vector (IV), it is possible that some operations will be greatly simplified.  And they will have low algebraic complexity in general.  For example, 2a may be equivalent to j = k + (i + j) &lt;&lt; 1. <br><br><h2>  Total </h2><br>  A very interesting approach to encryption is developed in Spritz.  In my opinion, existing implementations require significant refinement.  Also, it will take time before this strong cipher becomes clear or not.  It is already clear that it is slower than RC4.  This cipher is laid out in open access and does not have any license restrictions. <br><br>  Probably, Spritz can become popular as it has the following Sponge functions: AbsorbStop function, Encryption, Hash function, Domain separation hash function, Authentication Encryption with Associated Data (AEAD), Deterministic Random Bit Generator (DRBG) ). <br><br>  Perhaps these functions can be used for distributed databases, for transferring audio and video over the Internet, etc. <br><br>  Also, if respected specialists would like it, I can write the following article, where I will show how to use AEAD to make a one-time digital key that works only for a certain time.  This can be used, in particular, for remote leasing of a car, motel, yacht or apartment or for managing IoT facilities in a hotel or guest house. <br><br>  PS Thanks <a href="http://habrahabr.ru/users/Ivan_83/">Ivan_83</a> for the link. <a href="https://www.pgpru.com/novosti/2014/nizkajaalgebraicheskajaslozhnostjkeccakkeyakoblegchaetkubicheskieataki">Low algebraic complexity Keccak / Keyak facilitates cubic attacks.</a> <a href="https://www.pgpru.com/novosti/2014/nizkajaalgebraicheskajaslozhnostjkeccakkeyakoblegchaetkubicheskieataki"><br></a> </div><p>Source: <a href="https://habr.com/ru/post/243023/">https://habr.com/ru/post/243023/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../243011/index.html">Software renderer - 1: materiel</a></li>
<li><a href="../243013/index.html">Enthusiast designed a homemade 8-bit processor in Minecraft</a></li>
<li><a href="../243015/index.html">At any given time about the third part of Internet users are on-line.</a></li>
<li><a href="../243017/index.html">10 lessons on how to increase productivity, which I learned by working 90 hours a week for a month</a></li>
<li><a href="../243021/index.html">Vibration of the XboxOne gamepad for Unity3d</a></li>
<li><a href="../243025/index.html">New on VPS Search: Notepad Domains and Notepad Servers</a></li>
<li><a href="../243027/index.html">Wargaming Developers Contest: Winners Announcement</a></li>
<li><a href="../243033/index.html">How and why does Yandex disable its own data centers</a></li>
<li><a href="../243035/index.html">We catch snmp mac-notification traps from Cisco devices</a></li>
<li><a href="../243037/index.html">Decorative decorative lamp SDB-Z "Evlampiya"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>