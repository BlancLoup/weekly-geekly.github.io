<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Vulnerability in reCaptcha allows you to activate up to 30 actions on the same token</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I thought for a long time whether it was worth telling, but last night I had some free time, and I nevertheless decided to continue my series of artic...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Vulnerability in reCaptcha allows you to activate up to 30 actions on the same token</h1><div class="post__text post__text-html js-mediator-article">  I thought for a long time whether it was worth telling, but last night I had some free time, and I nevertheless decided to continue my series of articles about small problems in large projects.  Yes, and perhaps this is already known to everyone, and I worry for nothing. <br><br>  We all know the <a href="http://www.google.com/recaptcha">reCaptcha</a> service that Google acquired a couple of years ago.  We see it in many large projects, for example, when registering with <a href="">LiveJournal</a> .  I must say that I like to download files in the list directly from my server, and when on one of the sites from which I occasionally download something, such a thing appeared, it became a bit annoying to me.  When I don‚Äôt like something, I don‚Äôt give up and try to think of a way to avoid it. <br><br>  So I decided to overcome reCaptcha and I think I did it ... <br><a name="habracut"></a><br>  Starting the analysis, first of all, I ask myself questions.  What is the biggest problem of such a large project?  Most likely, this storage of a very large amount of unnecessary information, statuses and actions.  ReCaptcha must create a token, check it and deactivate it. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      If the first two actions can be replaced by encryption (without storage), then deactivating is a bit more complicated.  And the service must perform its "main" function of scanning documents.  Where does all this store?  I'd like to save on this.  And, usually, this is the biggest mistake of developers. <br><br>  How reCaptcha works: <br><ol><li>  The service asks you for two words, if he likes, what you have answered, you are given a token. </li><li>  Time limiter sewn into token </li><li>  After a request for verification from the site, the token is deactivated and cannot be used a second time. </li></ol><br>  It was in these last two points that the weak spot turned out to be.  It is known that the service limits the effect of the token to about five hours.  But, as I found out, reCaptcha does not store your activated token all this time, but it seems to keep the lock list and remove the token from it after about ten minutes of inactivity.  That is, if you did not try to activate this token again for ten minutes, it will be removed from the blocking list.  Thus, in five hours one single token can be used up to <b>thirty times</b> , the main thing here is to be patient and not pull it before the ten-minute interval. <br><br>  How to use it?  Very simple!  By creating 10 tokens, you can activate the action on the site every minute for five hours automatically.  300 activations in just 10 tokens.  I think a very good offer.  More tokens - more often activation. <br><br>  Unfortunately, on the site reCaptcha ( <a href="http://code.google.com/intl/en-EN/apis/recaptcha/intro.html">Google Code</a> ) I have not found a single word about this problem.  However, there is a very simple way to protect against it, it‚Äôs enough to store activated tokens (recaptcha_challenge_field) on the site side for five hours.  After all, the probability of issuing exactly the same token during this time is almost zero. <br><br>  PS Usually my posts are accompanied by a small example of the use of vulnerabilities, but this time I decided that it would be enough just to tell.  Inquisitive mind% username% will be able to test the performance of this method. </div><p>Source: <a href="https://habr.com/ru/post/120265/">https://habr.com/ru/post/120265/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../120258/index.html">Device for replacing news in WiFi traffic</a></li>
<li><a href="../120259/index.html">Version Control with Bundler</a></li>
<li><a href="../120261/index.html">Evolution of the TDL4 rootkit or field reports of recent months</a></li>
<li><a href="../120262/index.html">EasyPay: Payment of fines for traffic violations</a></li>
<li><a href="../120264/index.html">Google's learning rap</a></li>
<li><a href="../120266/index.html">DIY quadcopter: Part I</a></li>
<li><a href="../120267/index.html">Digest Wanted.VC # 4</a></li>
<li><a href="../120268/index.html">Designing visitor behavior for receiving a discount card in an online store</a></li>
<li><a href="../120269/index.html">Multiple inheritance in ActionScript. Traits Language in RASE Beta 10</a></li>
<li><a href="../120272/index.html">Use a bandler instead of practicing rvm gemset per project</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>