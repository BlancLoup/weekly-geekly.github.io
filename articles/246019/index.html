<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Single Page Application in Cloud Storage</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We have already written about how our cloud storage can be used as a platform for hosting static sites ( 1 and 2 ). Today we will talk about how moder...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Single Page Application in Cloud Storage</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/40c/6be/6bc/40c6be6bc8226da2456fc79e224b12a6.png" alt="Single page application" width="100%" height="100%"><br><br>  We have already written about how our <a href="http://storage.selectel.ru/">cloud storage</a> can be used as a platform for hosting static sites ( <a href="http://blog.selectel.ru/staticheskie-sajty-v-oblachnom-xranilishhe/">1</a> and <a href="http://blog.selectel.ru/staticheskie-sajty-nastrojka-i-optimizaciya/">2</a> ).  Today we will talk about how modern sites can be placed on the basis of the repository, which are based on the Single Page Application (SPA) approach that is popular and relevant today. <br><a name="habracut"></a><br><br><h2>  SPA as an approach </h2>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      SPA abbreviation stands for "single page application" ("one-page application").  In the narrow sense, it is used to refer to a one-page site that runs directly on the client in the browser.  In a broader sense, SPA (sometimes also used the abbreviation SPI - ‚Äúsingle page interface‚Äù) means a whole approach to web development, which is becoming increasingly widespread today.  What is the meaning of this approach and why is it becoming more and more popular? <br><br>  Let's start a little from afar.  Today, the most common type of sites are, of course, dynamic sites, in which pages are generated on the server side.  With all the obvious convenience for developers (each request creates a page from scratch), such sites sometimes represent a real headache for customers.  This is not a complete list of the inconveniences that they have to face: <br><br><ul><li>  Even in spite of the fact that some frameworks allow you to return in response a form with the completed data entered by the client last time, the need to reload the page for validation makes working with the site inconvenient. </li><li>  The generation of pages on the server side is associated with serious workloads. </li></ul><br><br>  Often, the described problems are solved in the following way: pages are still generated on the server side, but on the client side, small JavaScript scripts are executed, with the help of which you can, for example, perform form validation before it is sent to the server.  The solution at first glance is not bad, but it also has flaws: <br><br><ul><li>  If before the functions of the frontend and backend were clearly separated (the backend is responsible for generating view and logic, and the frontend is for displaying), now the logic is duplicated on the frontend, which can hardly be called good architectural practice. </li><li>  The code responsible for generating the view has to constantly duplicate and because of this, problems arise: ‚Äúcopy-paste‚Äù, discrepancy of markup, broken selectors, difficulties in maintaining the code, etc. </li></ul><br><br>  Of course, you can live with all this.  But the SPA approach in many cases turns out to be much more effective. <br><br>  From the point of view of this approach, a site is understood not as a set of pages, but as a set of states of the same HTML page.  When the state changes, asynchronous loading of new content occurs without reloading the page itself. <br><br>  SPA is not a website in the classical sense, but an application that runs on the client in the browser.  Therefore, from the user's point of view, there are almost no problems with speed even with a slow or unstable connection to the Internet (for example, when viewing a site from a mobile device).  High speed of work is also ensured due to the fact that not the markup now comes from the server to the client, but the data (mainly in JSON format), and their size is small. <br><br>  Recently, a lot of interesting technological solutions and services have appeared, significantly simplifying the creation and use of SPA.  Consider some of them in more detail. <br><br><h2>  BAAS (Backend as a Service) </h2><br><br>  Technologies that allow drawing the interface on the client side and interact with the server only by sending requests without reloading the page have been around for a long time.  For example, the <a href="http://en.wikipedia.org/wiki/XMLHttpRequest" rel="nofollow">XMLHttpRequest</a> API appeared back in 2000.  But the use of these technologies was difficult: it was necessary to rewrite the backend, which implements the functions of authorizing requests and accessing data. <br><br>  Today, everything has become much easier thanks to the emergence of numerous BaaS-services.  The abbreviation BaaS means Backend as a Service.  BaaS services provide web application developers with a ready-made server infrastructure (located, as a rule, in the cloud).  Thanks to them, you can save time (and often more money) to write server code and focus on improving the application itself and developing its functionality.  Using BaaS, you can connect any backend with any set of functions to an application or website ‚Äî simply add the appropriate library to the page. <br><br>  An example is the <a href="https://mongolab.com/" rel="nofollow">MongoLab</a> service, which allows you to connect a MongoDB cloud database to web applications and sites. <br><br>  Another interesting example is <a href="https://www.firebase.com/">FireBase</a> .  This service is a cloud database and API for realtime applications.  With it, you can, in particular, organize data exchange between the client and the server in real time: you just need to connect a JavaScript library to the page and configure events for data changes.  On the basis of FireBase, it is easy to implement, for example, chat or user activity tape. <br><br>  Among the interesting and noteworthy BaaS-services is also worth highlighting: <br><br><ul><li>  <a href="https://backendless.com/" rel="nofollow">Backendless</a> is a platform that provides ready-made cloud server infrastructure for all types of applications.  With its help, you can add user management functionality, user data storage, real-time messaging, sending notifications, geolocation, file management and much more. </li><li>  <a href="http://www.syncano.com/" rel="nofollow">Syncano</a> is a service that provides API for real-time applications, similar in functionality to Firebase. </li><li>  <a href="http://quickblox.com/" rel="nofollow">QuickBlox</a> is an interesting product from Russian developers (see also the <a href="http://habrahabr.ru/post/163699/" rel="nofollow">detailed article on Habr√©</a> ). </li></ul><br><br>  You can also find a brief overview of BaaS services <a href="http://habrahabr.ru/post/150729/" rel="nofollow">here</a> . <br><br>  Our cloud storage can also be used as an external backend.  With it, you can, for example, integrate file management functionality into web applications and sites. <br><br>  When using storage as an external backend, special attention should be paid to two key points: authentication and work with content.  The authentication key (token) can be obtained using a <a href="https://support.selectel.ru/storage/api_info/">request to auth.selcdn.ru</a> . <br><br>  Then it will need to be specified as the value of the X-Auth-Token header in all requests for working with data.  Answers to these requests will include an Access-Control-Allow-Origin header with a value of "*", allowing access to the repository from any external domain. <br><br>  As an example of a web application using the repository API, we can cite <a href="http://blog.selectel.ru/fotogalereya-i-drugie-novye-vozmozhnosti-oblachnogo-xranilishha/">our photo gallery</a> (we already wrote about it; see also the <a href="https://github.com/selectel/photo-gallery">repository on GitHub</a> ). <br><br><h2>  HTML5 History API </h2><br><br>  Each page of a dynamic site has its own URL.  SPA is arranged so that they can change the state of the page without changing the URL.  But in this case there is a problem: the user will not be able to save the link and then return to the previously visited section.  It can be solved in several ways. <br><br>  First, you can use a hash fragment (the part of the link that comes after the ‚Äú#‚Äù character).  In the hash fragment is placed the "virtual" address of the page, which can restore the previous state.  If the user reloads the page, the JavaScript code, after reading the hash value, loads the necessary data and displays the corresponding section.  This option is used on many sites, but it should be noted that similar URLs (for example, ‚Äú <a href="http://example.com/base/">example.com/base/#</a> ! / Section1 / page2‚Äù) do not look very natural.  In addition, they consist of two entities: a ‚Äúreal‚Äù address, at which a page is requested from a web server, and a ‚Äúvirtual‚Äù one, which denotes a logical partition. <br><br>  Secondly, you can use the <a href="http://diveintohtml5.info/history.html" rel="nofollow">HTML5 History API</a> (see also the <a href="http://habrahabr.ru/post/123106/" rel="nofollow">article on Habr√©</a> ).  The History API allows you to completely change the URL of a page within the current domain without reloading it.  In browsers that support this API, there are no differences between the URLs used when loading the page and the URLs specified from JavaScript. <br><br>  Calls to the History API functions are also associated with the native browser buttons "Forward" and "Back" and history: when you click the "Back" button, the browser raises the popstate event, which can be processed in JavaScript code and display the previous section.  See how it works, for example, <a href="http://html5demos.com/history" rel="nofollow">here</a> . <br><br>  In order for the site to use the URL scheme described, the web server must be properly configured.  It is necessary to make so that instead of non-existent pages the main SPA page is given - usually it is index.html.  In this case, the client browser will load JavaScript, which already draws the necessary site file based on the current page address. <br><br>  In the nginx settings, this is written as: <br><br><pre> location / {rewrite. * /index.html;  }
</pre><br><br>  If the SPA is hosted on services like GitHub Pages or our repository, then the settings should be set via the control panel. <br><br><h2>  Search engine optimization </h2><br><br>  SPA indexing by search engines is a separate issue.  If the site is completely generated on the client side, then it will be poorly indexed, although recently there have been improvements in this regard: bots gradually begin to perform JavaScript when indexing. <br><br>  One of the ways to solve this problem is the following: pages snapshots are generated specifically for bots.  Generate pages should be different depending on whether the HTML5 History API is used or not. <br><br>  In the case of using hash fragments, <a href="https://developers.google.com/webmasters/ajax-crawling/" rel="nofollow">Google</a> and <a href="" rel="nofollow">Yandex</a> offer the same approach: to separate the ‚Äúreal‚Äù and ‚Äúvirtual‚Äù addresses, use ‚Äú#!‚Äù Instead of ‚Äú#‚Äù;  Search bots, having seen the link with this delimiter, will use the special query parameter ‚Äú_escaped_fragment_‚Äù in the URL and place in it the part of the address following after the hash. <br><br>  The web server must process such requests in a special way and return full HTML pages so that bots can index them.  (The need for this arises due to the fact that the part of the URL after the ‚Äú#‚Äù according to the standard is not part of the HTTP request.) It is also recommended to use a special meta tag (see the links above) because  Some pages may not contain links with "#!". <br><br>  If full-fledged URLs are used for addressing, then making the site indexed is even simpler: it is enough to generate a page on the server corresponding to the specified address.  A bot visiting the site will receive a page with content and successfully index it. <br><br>  If the site is opened in a browser, the page will first be displayed in accordance with the HTML markup, and then JavaScript will enter into action;  with further links, the page will not be reloaded.  This behavior can be realized by intercepting the events of clicking on links and canceling their native behavior.  In this case, the bot will follow the link (the ‚Äúhref‚Äù attribute), and we will be able to control all the transitions, processing the event as we need. <br><br>  Note also that this approach allows you to optimize the site loading speed: modern browsers render HTML from the server much faster, and loading JavaScript scripts, their parsing and page rendering through the DOM usually takes longer. <br><br>  How to generate an HTML page with only JavaScript code that works directly with the DOM?  This can be done in several ways. <br><br>  First, you can install <a href="http://phantomjs.org/" rel="nofollow">PhantomJS</a> (this is the so-called ‚Äúheadless‚Äù WebKit-based browser, managed via an API) and configure it to generate snapshots of pages (see the practical example <a href="http://lawsonry.com/2014/05/diy-angularjs-seo-with-phantomjs-the-easy-way/" rel="nofollow">here</a> ). <br><br>  Secondly, you can use the <a href="https://www.npmjs.com/package/prerender" rel="nofollow">prerender</a> tool or the <a href="http://prerenderer.io/" rel="nofollow">Prerenderer.io</a> service, which are also based on PhantomJS. <br><br>  Thirdly, in some modern frameworks (for example, <a href="http://derbyjs.com/" rel="nofollow">DerbyJS</a> and <a href="https://facebook.github.io/react/" rel="nofollow">React</a> ) this function is already implemented (see also the example here: <a href="https://github.com/mhart/react-server-example" rel="nofollow">react-server-example</a> ). <br><br><h2>  SPA accommodation </h2><br><br>  In the modern Internet there are many sites where you can place SPA.  Consider the most popular ones. <br><br><h3>  Dropbox </h3><br><br>  The easiest option is to place the SPA in <a href="http://dropbox.com/" rel="nofollow">Dropbox</a> .  To do this, you need to create a directory for the SPA in the Dropbox public directory, place all the necessary files into it, then select the index.html file and open the context menu by clicking the right mouse button.  In the menu, select the item ‚ÄúDropbox ‚Üí Share link.‚Äù  After that, the link will be created and copied to the clipboard, on which the application will be available through the browser. <br>  Recently, attempts have been made to expand the possibilities for placing sites on Dropbox (you can read about this, for example, <a href="http://lifehacker.ru/2012/10/05/kak-khostit-svojj-sajjt-na-dropbox-chast-2/" rel="nofollow">here</a> ).  However, they do not solve the main problem: Dropbox has quite severe (up to complete blocking) traffic restrictions on public links.  Therefore, the described option can be recommended except for demonstration of SPA to friends and colleagues. <br><br><h3>  Github pages </h3><br><br>  <a href="http://pages.github.com/" rel="nofollow">GitHub Pages</a> is a free platform for hosting static sites and SPA.  To place the SPA on GitHub Pages, you need to create a repository for it on GitHub and place the static files in the gh-pages branch for Project Pages or in the master branch for User / Organization Pages.  All changes will need to be committed to this repository.  More help is available in the <a href="https://help.github.com/categories/github-pages-basics/" rel="nofollow">official documentation</a> . <br><br><h3>  Bit balloon </h3><br><br>  <a href="http://www.bitballoon.com/" rel="nofollow">Bit Balloon</a> is a new service, but already quite popular. <br>  Each registered user is provided with 10 MB of free disk space.  To place a SPA on it, simply download all the necessary files.  The service will automatically minify JS, HTML and CSS, as well as connect the CDN. <br><br>  Premium account costs $ 5 per month.  For owners of paid accounts, various additional options are available - in particular, attaching your own domains and connecting various external services. <br><br><h3>  Selectel storage </h3><br><br>  Our <a href="http://storage.selectel.ru/">cloud storage</a> is a convenient place for hosting SPA.  In general, the procedure for placing SPA almost does not differ from the procedure for placing static sites about which we have already written in one of the previous posts.  It includes the following steps: <br><ol><li>  Creating a public container and attaching a domain: by the link above, everything is described in detail, we will not discuss this in detail. </li><li>  Customization of special pages: the customization procedure was recently improved by us.  We have added another option to customize the processing of non-existent pages (‚ÄúError 404: page‚Äù).  Now you can specify a file that will be displayed when a non-existing page is requested, and you can also set a response code (200 or 404) for it, without redirecting to another URL: </li></ol><br><br><img src="https://habrastorage.org/getpro/habr/post_images/797/614/f6b/797614f6bd1b87e116295c8507826093.png" alt="Selectel cloud storage" width="100%" height="100%"><br><br>  This allows you to use full URLs (see the section on the History API). <br><br>  The undoubted advantages of our storage over other sites (including those described above) include low cost and flexible payment system (no fixed tariffs; payment is charged only for the amount of stored data and outgoing traffic - you can count <a href="http://storage.selectel.ru/stoimost" rel="nofollow">here</a> ), as well as the presence of CDN and flexible system of settings for container parameters and exported files. <br><br><h2>  Conclusion </h2><br><br>  In this article, we talked about another aspect of using our repository as a platform for hosting single-page sites.  We hope that it will be useful to you. <br>  If you already use our repository to host the SPA, share your experience and impressions. All your wishes and suggestions will be taken into account in future work. <br><br>  Readers who for one reason or another can not leave comments here are invited <a href="http://blog.selectel.ru/spa-v-oblachnom-xranilishhe/">to our blog</a> . </div><p>Source: <a href="https://habr.com/ru/post/246019/">https://habr.com/ru/post/246019/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../246009/index.html">Category: essence of composition</a></li>
<li><a href="../246011/index.html">The easiest deploy application on Ruby on Rails</a></li>
<li><a href="../246013/index.html">Get free: how to manage your time with the help of "Tomato" technology</a></li>
<li><a href="../246015/index.html">How performance tracking and billing can improve your OpenStack cloud performance</a></li>
<li><a href="../246017/index.html">Information objects or the reason for one misconception</a></li>
<li><a href="../246021/index.html">Install and configure CA Infrastructure Management. Part one. Performance management</a></li>
<li><a href="../246023/index.html">Mobile game on Unity. The first pancake ...</a></li>
<li><a href="../246025/index.html">Grab full control over someone else's Digital Ocean cloud (Doorkeeper vulnerability)</a></li>
<li><a href="../246027/index.html">A tale about how I disassembled Supaplex and almost wrote a clone with 3D graphics</a></li>
<li><a href="../246029/index.html">Dnipropetrovsk Ciklum Speakers' Corner with Igor Kryzhanovsky: UX is not UI. ‚ÄúThe Art of Washing the Elephant‚Äù, December 18</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>