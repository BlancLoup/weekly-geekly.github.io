<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ATM cash withdrawal forecast using a simple neural network</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Perhaps you have ever met an ATM in the "Out of service" mode. 

 One of the possible reasons for this condition is the lack of electricity money in t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>ATM cash withdrawal forecast using a simple neural network</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/fab/d78/966/fabd78966c4947e588a28c979f9c5391.jpg"><br><br>  Perhaps you have ever met an ATM in the "Out of service" mode. <br><br>  One of the possible reasons for this condition is the lack of <s>electricity</s> money in the cassettes. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      To avoid this, it is interesting for banks to know the future - how much cash will be withdrawn from ATMs and when the money runs out completely. <br><br>  Under the cut solution of this problem using a simple neural network. <br><br><a name="habracut"></a><br><br>  First, let's understand what a neural network is.  From an amateurish point of view, a neural network can be represented as a kind of ‚Äúblack box‚Äù, which accepts an input and outputs a certain set of parameters.  Teaching a neural network means training it on a reference set of input and output data, which is called a training set. <br><br>  <b>Consider a simple example.</b> <br><br>  We will learn using the neural network to find the value of the "Exclusive" OR "function. <br><br><img src="https://habrastorage.org/files/595/ff8/3cf/595ff83cf2d34ef28ea19c10ff47c5af.png"><br><br>  Here, on the left, <b>a</b> and <b>b</b> are input parameters, and on the right, <b>a‚äïb</b> is the output parameter.  By training a neural network on the truth table, we can feed any combinations of zeros and ones to the network input and get the right result at the output.  The attentive reader has noticed that whatever value of zeros and ones we take after the training, it will coincide with one of the training pairs.  In real life, this is usually not the case. <br><br>  <b>Let's return to our ATMs.</b> <br><br>  To make predictions, you first need to <s>come up with</s> identifying signs on which the amount of withdrawn funds depends.  This is done by analyzing statistics and applying common sense.  So it was found that the amount of withdrawn money on the same days of the week is usually similar.  As a result, we obtained the following neural network: <br><br><img src="https://habrastorage.org/files/0f7/9d5/fcf/0f79d5fcff3046d49eb31c4f2c3847d8.png"><br><br>  For the forecast for Monday ‚ÄúWeek 3‚Äù, the input for the neural network is supplied with data for the two previous Mondays.  This neural network is good, but is not able to predict the peaks of withdrawing cash on specific dates of the month (salary?).  They are well predicted by the following neural network: <br><br><img src="https://habrastorage.org/files/552/60b/f46/55260bf463ea4aa6bcb7ce16cc10d5a5.png"><br><br>  For the forecast for the 5th day of ‚ÄúMonth 3‚Äù, data for 4, 5, 6 numbers of the two previous months are fed in (this helps to improve the forecast if the ‚Äúpeak‚Äù day is postponed by ¬± 1 day due to a weekend or holiday). <br><br>  As a result, one could use the average value of the predictions of the two previous neural networks.  But the best solution was to combine them into one big neuron: <br><br><img src="https://habrastorage.org/files/798/54d/412/79854d4127904d219d8050bcb9c9733f.png"><br><br>  In order not to <s>violate the corporate secret of</s> inflating an article, some important technical details (types of neurons, types of training, data normalization, etc.) were omitted in it.  But I hope that the uninitiated reader has an idea of ‚Äã‚Äãhow this thing works. <br><br><div class="spoiler">  <b class="spoiler_title">Hostess note</b> <div class="spoiler_text">  The implementation of the <a href="http://www.heatonresearch.com/">Encog machine learning framework</a> (available under .Net, Java and C ++) was used.  It allows high-level creation of neural networks, indicating the types of neurons and their number in each layer of the network: <br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> network = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BasicNetwork(); network.AddLayer(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BasicLayer(<span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>)); network.AddLayer(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BasicLayer(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ActivationSigmoid(), <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>)); network.AddLayer(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BasicLayer(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ActivationSigmoid(), <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>)); network.Structure.FinalizeStructure(); network.Reset();</code> </pre> <br>  If you do not want to understand the rather complex mathematics of neurons and teaching methods, I recommend finding a ready-made library for your language. <br></div></div></div><p>Source: <a href="https://habr.com/ru/post/265979/">https://habr.com/ru/post/265979/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../265965/index.html">API for validator from Yandex. And why do the micro-mark validators give different answers?</a></li>
<li><a href="../265967/index.html">And these people forbid me to pick one's nose ... (in continuation of the theme of the sled for the HDD)</a></li>
<li><a href="../265969/index.html">Safe dynamic update of records on MS DNS from Linux</a></li>
<li><a href="../265971/index.html">Small usefulness for a GLPI + FusionInventory bundle</a></li>
<li><a href="../265975/index.html">Entertaining 40 gigabit</a></li>
<li><a href="../265981/index.html">Program from scratch. Now is the right time to start</a></li>
<li><a href="../265983/index.html">Connecting Asterisk via OKS-7</a></li>
<li><a href="../265985/index.html">1C: Summer School 2015 - how to organize a ‚Äúsmart‚Äù vacation for young programmers - part 2. Interesting things</a></li>
<li><a href="../265987/index.html">EMC VNXe1600 Storage System Overview</a></li>
<li><a href="../265989/index.html">Underground carders market. Translation of the book "KingPIN". Chapter 11. "Script's Twenty-Dollar Dumps"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>