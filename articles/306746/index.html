<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Basics of reactive programming for Android on a practical example</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="1. Introduction to reactive programming 
 Developing a complex Android application with many network connections, user interaction and animation means...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Basics of reactive programming for Android on a practical example</h1><div class="post__text post__text-html js-mediator-article"><h4>  1. Introduction to reactive programming </h4><br>  Developing a complex Android application with many network connections, user interaction and animation means writing code that is full of nested callbacks.  And as the project progresses, such code becomes not only cumbersome and difficult to understand, but also difficult to develop, maintain, and is subject to many subtle errors. <br><br>  ReactiveX or functional reactive programming offers an alternative approach that can significantly reduce application code and create elegant, understandable applications for managing asynchronous tasks and events.  In reactive programming, the consumer responds to the data as it comes in and propagates the changes of the event to the registered observers. <br><br>  RxJava is an open-source Java implementation of ReactiveX.  The basic building blocks of a reactive code are Observables and Subscribers.  More information about the basic framework can be found in the article <a href="https://habrahabr.ru/post/265269/">Grokay * RxJava, part one: the basics</a> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      RxAndroid is an extension to RxJava that allows the scheduler to run code in the main and additional threads of the Android application and provides the transfer of results from the created additional threads to the main one for aggregation and interaction with the user interface. <br>  In order to more fully understand the basic principles of reactive programming, consider a practical example for the Android platform.  And let's start with setting up the environment for development. <br><a name="habracut"></a><br><h4>  2. Preparing the environment </h4><br>  We connect the main libraries and assign dependencies in the dependencies {} section of the buil.gradle configuration file: <br><pre><code class="java hljs">dependencies { compile <span class="hljs-string"><span class="hljs-string">'io.reactivex:rxandroid:1.2.1'</span></span> compile <span class="hljs-string"><span class="hljs-string">'io.reactivex:rxjava:1.1.6'</span></span> }</code> </pre> <br>  We include support for lambda expressions - we use the new features of the Java 8 language on the Android N platform. To use the features of the Java 8 language, you also need to connect the new Jack compiler, for which you add to the build.gradle file: <br><pre> <code class="java hljs">android { ... defaultConfig { ... jackOptions { enabled <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> } } compileOptions { sourceCompatibility JavaVersion.VERSION_1_8 targetCompatibility JavaVersion.VERSION_1_8 } }</code> </pre><br>  <i><u>Note:</u> Jack is only supported in Android Studio 2.1 and you also need to upgrade to JDK 8.</i> <br><br>  When making changes in the gradle configuration file, a warning appears about the need to synchronize the project and to apply all changes click the Sync Now link in the top right. <br><br><h4>  3. Create a basic example. </h4><br>  Due to the fact that the use of RxAndroid in most cases is associated with projects with multi-thread processing of network connections - consider a simple example of processing the results of site parsing. <br>  To display the results, create a simple layout: <br><pre> <code class="java hljs">&lt;?xml version=<span class="hljs-string"><span class="hljs-string">"1.0"</span></span> encoding=<span class="hljs-string"><span class="hljs-string">"utf-8"</span></span>?&gt; &lt;RelativeLayout xmlns:android=<span class="hljs-string"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span> ...&gt; &lt;ScrollView android:layout_width=<span class="hljs-string"><span class="hljs-string">"wrap_content"</span></span> android:layout_height=<span class="hljs-string"><span class="hljs-string">"wrap_content"</span></span> android:id=<span class="hljs-string"><span class="hljs-string">"@+id/scrollView"</span></span> &gt; &lt;TextView android:layout_width=<span class="hljs-string"><span class="hljs-string">"wrap_content"</span></span> android:layout_height=<span class="hljs-string"><span class="hljs-string">"wrap_content"</span></span> android:id=<span class="hljs-string"><span class="hljs-string">"@+id/textView"</span></span> /&gt; &lt;/ScrollView&gt; &lt;/RelativeLayout&gt;</code> </pre><br>  For parsing, create a simple WebParsing class with two getURLs and getTitle methods: <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">WebParsing</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> List&lt;String&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getURLs</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String url)</span></span></span><span class="hljs-function"> </span></span>{ Document doc; List&lt;String&gt; stringList = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { doc = Jsoup.connect(url).get(); Elements select = doc.select(<span class="hljs-string"><span class="hljs-string">"a"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (Element element : select) { stringList.add(element.attr(<span class="hljs-string"><span class="hljs-string">"href"</span></span>)); } } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (IOException e) { e.printStackTrace(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> stringList; } }</code> </pre><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getTitle</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String url)</span></span></span><span class="hljs-function"> </span></span>{ String title; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { Document doc = Jsoup.connect(url).get(); title = doc.title(); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (MalformedURLException mue) { mue.printStackTrace(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (HttpStatusException hse) { hse.printStackTrace(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (IOException e) { e.printStackTrace(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (IllegalArgumentException iae) { iae.printStackTrace(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> title; }</code> </pre><br>  The getURLs method scans the site contents and returns a list of all found links, and the getTitle method returns the site Title by reference. <br><br><h4>  4. We connect the reactivity </h4><br>  In order to use the features of RxAndroid based on the above methods, we will create two corresponding Observables: <br><pre> <code class="java hljs">Observable&lt;List&lt;String&gt;&gt; queryURLs(String url) { WebParsing webParsing = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> WebParsing(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Observable.create( <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Observable.OnSubscribe&lt;List&lt;String&gt;&gt;() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">call</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Subscriber&lt;? </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">super</span></span></span></span><span class="hljs-function"><span class="hljs-params"> List&lt;String&gt;&gt; subscriber)</span></span></span><span class="hljs-function"> </span></span>{ subscriber.onNext(webParsing.getURLs(url)); subscriber.onCompleted(); } }).subscribeOn(Schedulers.io()).observeOn(AndroidSchedulers.mainThread()); }</code> </pre><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-function">Observable&lt;String&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">queryTitle</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String url)</span></span></span><span class="hljs-function"> </span></span>{ WebParsing webParsing = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> WebParsing(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Observable.create(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Observable.OnSubscribe&lt;String&gt;() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">call</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Subscriber&lt;? </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">super</span></span></span></span><span class="hljs-function"><span class="hljs-params"> String&gt; subscriber)</span></span></span><span class="hljs-function"> </span></span>{ subscriber.onNext(webParsing.getTitle(url)); subscriber.onCompleted(); } }).subscribeOn(Schedulers.io()).observeOn(AndroidSchedulers.mainThread()); }</code> </pre><br>  The first Observable will generate a list of URL links found on the site, the second will generate a Title.  Let us examine the example of the first method in detail and line by line: <br><ol><li>  <i><b>Observable &lt;List&gt; queryURLs (String url)</b></i> - the string declares the Observable method, which takes as an input parameter a link to the site for parsing and returns the result of the parsing as a list of &lt;List&gt; links from the specified site; <br>  <i><b>WebParsing webParsing = new WebParsing ()</b></i> - creates a variable to access our parsing functions; <br>  <i><b>return Observable.create</b></i> - creates an Observable that returns a list of links; <br>  <i><b>new Observable.OnSubscribe &lt;List&gt; ()</b></i> - the string declares the OnSubscribe interface with one method (see below) that will be called when subscribing; <br>  <i><b>public void call (Subscriber &lt;? super List&gt; subscriber)</b></i> - overloads the call method, which will be called after the Subscriber subscription; <br>  <i><b>subscriber.onNext (webParsing.getURLs (url))</b></i> - calls the onNext method for transmitting Subscriber data whenever data is generated.  This method takes as a parameter the object emitted by the Observable; <br>  <i><b>subscriber.onCompleted ()</b></i> - Observable calls the onCompleted () method after it calls onNext one last time, if no errors were detected; <br>  <i><b>subscribeOn (Schedulers.io ())</b></i> - the subscribeOn method subscribes all Observable upstream to Schedulers.io (); <br>  <i><b>observeOn (AndroidSchedulers.mainThread ())</b></i> - the observeOn method allows you to get results in the main application stream. </li></ol><br><h4>  5. Start the first reactive application. </h4><br>  So, Observables are created, we will implement the simplest example based on the first method above, which will display a list of site links: <br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">example0</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">final</span></span></span></span><span class="hljs-function"><span class="hljs-params"> TextView textView, String url)</span></span></span><span class="hljs-function"> </span></span>{ queryURLs(url) .subscribe(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Action1&lt;List&lt;String&gt;&gt;() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">call</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;String&gt; urls)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (String url: urls) { String string = (String) textView.getText(); textView.setText(string + url + <span class="hljs-string"><span class="hljs-string">"\n\n"</span></span>); } } }); }</code> </pre><br>  We wrap our implemented example in the MainExample class and call it in MainActivity: <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainActivity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AppCompatActivity</span></span></span><span class="hljs-class"> </span></span>{ TextView textView; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">protected</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bundle savedInstanceState)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState); setContentView(R.layout.activity_main); textView = (TextView) findViewById(R.id.textView); MainExample mainExample = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MainExample(); mainExample.example0(textView, <span class="hljs-string"><span class="hljs-string">"https://yandex.ru/"</span></span>); } }</code> </pre><br><h4>  6. Increase reactivity - using operators </h4><br>  Observable can transform the output using operators and it can be used between the Observable and Subscriber to manipulate data.  There are a lot of <a href="https://github.com/ReactiveX/RxJava/wiki/Alphabetical-List-of-Observable-Operators">operators</a> in RxJava, so for a start we will consider the most demanded ones. <br>  And let's start by getting rid of the cycle in the subscriber and forcing the observer to consistently emit the data of the resulting link array, and the from () operator will help us with this: <br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">example1</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">final</span></span></span></span><span class="hljs-function"><span class="hljs-params"> TextView textView, String url)</span></span></span><span class="hljs-function"> </span></span>{ queryURLs(url) .subscribe(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Action1&lt;List&lt;String&gt;&gt;() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">call</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;String&gt; urls)</span></span></span><span class="hljs-function"> </span></span>{ Observable.from(urls) .subscribe(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Action1&lt;String&gt;() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">call</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String url)</span></span></span><span class="hljs-function"> </span></span>{ String string = (String) textView.getText(); textView.setText(string + url + <span class="hljs-string"><span class="hljs-string">"\n\n"</span></span>); } }); } }); }</code> </pre><br>  It looks not quite nice and a bit confusing, so apply the following flatMap () operator, which accepts data emitted by one Observable and returns data emitted by another Observable, thus substituting one Observable for another: <br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">example2</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">final</span></span></span></span><span class="hljs-function"><span class="hljs-params"> TextView textView, String url)</span></span></span><span class="hljs-function"> </span></span>{ queryURLs(url) .flatMap(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Func1&lt;List&lt;String&gt;, Observable&lt;String&gt;&gt;() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Observable&lt;String&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">call</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;String&gt; urls)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Observable.from(urls); } }) .subscribe(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Action1&lt;String&gt;() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">call</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String url)</span></span></span><span class="hljs-function"> </span></span>{ String string = (String) textView.getText(); textView.setText(string + url + <span class="hljs-string"><span class="hljs-string">"\n\n"</span></span>); } }); }</code> </pre><br>  In the next step, we will still unload our Subscriber and use the map () operator, through which we can convert one data element to another.  The map () operator can also convert data and generate data of the type we need, which is different from the original one.  In our case, the observer will generate a list of strings, and the subscriber will only display them on the screen: <br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">example3</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">final</span></span></span></span><span class="hljs-function"><span class="hljs-params"> TextView textView, String url)</span></span></span><span class="hljs-function"> </span></span>{ queryURLs(url) .flatMap(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Func1&lt;List&lt;String&gt;, Observable&lt;String&gt;&gt;() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Observable&lt;String&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">call</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;String&gt; urls)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Observable.from(urls); } }) .map(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Func1&lt;String, String&gt;() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">call</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String url)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> textView.getText() + url + <span class="hljs-string"><span class="hljs-string">"\n\n"</span></span>; } }) .subscribe(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Action1&lt;String&gt;() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">call</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String url)</span></span></span><span class="hljs-function"> </span></span>{ textView.setText(url); } }); }</code> </pre><br>  We considered the main features and now it's time to use lambdas to simplify our code: <br><pre> <code class="java hljs">queryURLs(url) .flatMap(urls -&gt; Observable.from(urls)) .map(url1 -&gt; textView.getText() + url1 + <span class="hljs-string"><span class="hljs-string">"\n\n"</span></span>) .subscribe(url1 -&gt; { textView.setText(url1); });</code> </pre><br>  or even easier: <br><pre> <code class="java hljs">queryURLs(url) .flatMap(Observable::from) .map(url1 -&gt; textView.getText() + url1 + <span class="hljs-string"><span class="hljs-string">"\n\n"</span></span>) .subscribe(textView::setText);</code> </pre><br>  Let's compare the construction above with the resulting code and feel the power and simplicity of lambda expressions. <br><br><h4>  7. Increase capacity </h4><br>  In the next step, we complicate our processing and use the flatMap () operator to connect the second prepared queryTitle () method, which also returns an observer.  This method returns the Title of the site by reference to the site.  Let's create an example in which we will form and display a list of site headers by the links found on the web page, i.e.  instead of the resulting list of links to sites in the previous example, we display the headers (Title) of these sites: <br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">example4</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">final</span></span></span></span><span class="hljs-function"><span class="hljs-params"> TextView textView, String url)</span></span></span><span class="hljs-function"> </span></span>{ queryURLs(url) .flatMap(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Func1&lt;List&lt;String&gt;, Observable&lt;String&gt;&gt;() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Observable&lt;String&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">call</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(List&lt;String&gt; urls)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Observable.from(urls); } }) .flatMap(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Func1&lt;String, Observable&lt;String&gt;&gt;() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> Observable&lt;String&gt; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">call</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String url)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> queryTitle(url); } }) .subscribe(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Action1&lt;String&gt;() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">call</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String title)</span></span></span><span class="hljs-function"> </span></span>{ textView.setText(title); } }); }</code> </pre><br>  or in abbreviated form: <br><pre> <code class="java hljs">queryURLs(url) .flatMap(Observable::from) .flatMap(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>::queryTitle) .subscribe(textView::setText);</code> </pre><br>  add map () to form a list of headers: <br><pre> <code class="java hljs">queryURLs(url) .flatMap(Observable::from) .flatMap(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>::queryTitle) .map(url1 -&gt; textView.getText() + url1 + <span class="hljs-string"><span class="hljs-string">"\n\n"</span></span>) .subscribe(textView::setText);</code> </pre><br>  using the filter () operator, we filter out empty lines with the value null: <br><pre> <code class="java hljs">queryURLs(url) .flatMap(Observable::from) .flatMap(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>::queryTitle) .filter(title -&gt; title != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) .map(url1 -&gt; textView.getText() + url1 + <span class="hljs-string"><span class="hljs-string">"\n\n"</span></span>) .subscribe(textView::setText);</code> </pre><br>  using the take () operator, we take only the first 7 headers: <br><pre> <code class="java hljs">queryURLs(url) .flatMap(Observable::from) .flatMap(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>::queryTitle) .filter(title -&gt; title != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) .take(<span class="hljs-number"><span class="hljs-number">7</span></span>) .map(url1 -&gt; textView.getText() + url1 + <span class="hljs-string"><span class="hljs-string">"\n\n"</span></span>) .subscribe(textView::setText);</code> </pre><br>  The last example showed that combining a set of methods plus using a large number of available operators plus lambda expressions and we get from several lines a powerful handler for various data streams. <br><br>  All the examples given in the article are posted <a href="https://github.com/vladv75/RxAndroidExample">here</a> . <br><br><h4>  Sources: </h4><br><ol><li>  <a href="http://reactivex.io/RxJava/javadoc/">Official documentation</a> </li><li>  <a href="https://habrahabr.ru/post/265269/">Grokay * RxJava, Part One: The Basics</a> </li><li>  <a href="http://code.tutsplus.com/tutorials/getting-started-with-reactivex-on-android--cms-24387">Getting Started With ReactiveX on Android</a> </li><li>  <a href="http://www.vogella.com/tutorials/RxJava/article.html">RxJava - Tutorial</a> </li><li>  <a href="https://www.captechconsulting.com/blogs/getting-started-with-rxjava-and-android">Getting Started with RxJava and Android</a> </li><li>  <a href="https://www.ykode.com/2015/02/20/android-frp-rxjava-retrolambda.html">Reactive Programming with RxJava in Android</a> </li><li>  <a href="https://medium.com/swlh/party-tricks-with-rxjava-rxandroid-retrolambda-1b06ed7cd29c">Party tricks with RxJava, RxAndroid &amp; Retrolambda</a> </li></ol></div><p>Source: <a href="https://habr.com/ru/post/306746/">https://habr.com/ru/post/306746/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../306734/index.html">Migration to the cloud. Simple steps to improve business performance</a></li>
<li><a href="../306736/index.html">Graphic password does not allow the viewer to steal himself.</a></li>
<li><a href="../306738/index.html">AppCode 2016.2: new refactorings and inspections, live templates, improvements to code autocompletion, and all this is about Swift</a></li>
<li><a href="../306742/index.html">Responsive Search for UITableView</a></li>
<li><a href="../306744/index.html">Personal ranking of deputies each using JavaScript and Chrome browser</a></li>
<li><a href="../306748/index.html">Space error: $ 370 000 000 for Integer overflow</a></li>
<li><a href="../306754/index.html">Security Week 30: PHP-porn vulnerability, eavesdropping on keyboards, UAC bypass in Windows 10</a></li>
<li><a href="../306756/index.html">Review of physics in Sonic games. Parts 7 and 8: springs and gizmos, super speeds</a></li>
<li><a href="../306760/index.html">Linux UEFI / BIOS Update</a></li>
<li><a href="../306766/index.html">FreePBX: the simplest set of customer responsibility</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>