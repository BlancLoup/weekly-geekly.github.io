<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Sensu - monitoring framework</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A bit of history 
 In 2011, a movement emerged in the DevOps environment, united under the hashtag #monitoringsucks , and criticized the existing moni...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Sensu - monitoring framework</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/a16/322/fcf/a16322fcfb367876c18186d43a1d9649.png"><br><br><h5>  A bit of history </h5><br>  In 2011, a movement emerged in the DevOps environment, united under the hashtag <b>#monitoringsucks</b> , and criticized the existing monitoring systems for lack of flexibility.  What exactly did not suit them - <a href="https://speakerdeck.com/obfuscurity/the-state-of-open-source-monitoring">this presentation</a> perfectly illustrates. <br>  In short, people want a certain API standard for interaction between the monitoring components, and of the appearance of these components themselves, in order to build flexible and intelligent monitoring out of them. <br><br>  The result of this wave of discontent was the massive discussion of problems and drawing attention to interesting <a href="http://sensuapp.org/"><b>tools</b></a> like <a href="http://sensuapp.org/"><b>Sensu</b></a> and <a href="http://riemann.io/"><b>Riemann</b></a> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In 2013, the hashtag in the community has changed - now it is <b>#monitoringlove</b> .  This happened due to the development of opensource monitoring tools. <br><br>  Of the new tools, Sensu is of the greatest interest.  I didn‚Äôt seriously consider Riemann, because at the moment he doesn‚Äôt have any means to ensure fault tolerance, and I don‚Äôt like the idea of ‚Äã‚Äãwriting a config on Clojure. <br><br>  It is about Sensu that I will tell in this article, I will describe the basic principles of work and give an example of solving a typical monitoring task. <br><a name="habracut"></a><br><h6>  Key facts about Sensu: </h6><br>  * Written in Ruby, uses EventMachine (I would prefer Python, but ok). <br>  * Configs in JSON <br>  * Can use Nagios plugins. <br>  * Works through RabbitMQ, in PUSH mode, when clients themselves send to the server <br>  results of checks as soon as they are ready. <br>  * There are DEB, RPM and even MSI packages. <br>  * There are modules for puppet and cookbook for Chef. <br><br>  The image below shows the layout of Sensu.  In my opinion, everything is very logical, and this scheme of work gives scaling and fault tolerance out of the box. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ce4/c91/257/ce4c91257df636449ed570790428f355.png"><br><br>  The system consists of three main components: sensu-server, sensu-api, and sensu-client on clients.  A sensu-dashboard is also available.  Installation is trivial and covered in detail in the documentation, for the latest currently version 0.12, it is available <a href="http://sensuapp.org/docs/0.12/guide">here</a> .  As I already mentioned, there are deb, rpm and msi packages. <br><br><h5>  Basic concepts </h5><br><br>  In order to understand how it all works, you need to understand the terminology.  I do not aim to translate official documentation, but I want to give basic concepts so that it is clear what will be discussed in the future. <br><br>  We have the following entities: <br><br><h6>  Client (Client) </h6><br>  This is a server with the sensu-client installed and configured, which publishes information about itself in RabbitMQ and is thus registered in the Sensu monitoring system.  From the Sensu server, he receives a set of checks, and performs them, adding the result to RabbitMQ. <br><br>  For self-identification, he needs a configuration that looks something like this (taken from the documentation): <br><br><pre><code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"client"</span></span>: { <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"i-424242"</span></span>, <span class="hljs-string"><span class="hljs-string">"address"</span></span>: <span class="hljs-string"><span class="hljs-string">"127.0.0.1"</span></span>, <span class="hljs-string"><span class="hljs-string">"subscriptions"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"production"</span></span>, <span class="hljs-string"><span class="hljs-string">"webserver"</span></span>, <span class="hljs-string"><span class="hljs-string">"mysql"</span></span> ] } }</code> </pre> <br><br>  Everything is pretty obvious, with the exception of "subscriptions" (subscriptions).  Subscriptions are a list of the roles associated with this server and determine the list of checks performed on it.  More fine-tuning is described in the <a href="http://sensuapp.org/docs/0.12/clients">official documentation</a> , from the useful you can add any fields, the values ‚Äã‚Äãof which can be used in the checks, as well as the time interval that must pass to generate an event when the client leaves offline. <br><br><h6>  Check </h6><br>  Checks determine the commands that will be run on clients and their parameters.  Fully compatible with Nagios plugins, i.e.  use exit code as a criterion for successful verification, and STDOUT or STDERR as the data source.  Checks are configured in the sensu-server configuration, a typical check looks like this (example from the documentation): <br><br><pre> <code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"checks"</span></span>: { <span class="hljs-string"><span class="hljs-string">"chef_client"</span></span>: { <span class="hljs-string"><span class="hljs-string">"command"</span></span>: <span class="hljs-string"><span class="hljs-string">"check-chef-client.rb"</span></span>, <span class="hljs-string"><span class="hljs-string">"subscribers"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"production"</span></span> ], <span class="hljs-string"><span class="hljs-string">"interval"</span></span>: <span class="hljs-number"><span class="hljs-number">60</span></span> <span class="hljs-string"><span class="hljs-string">"handlers"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"pagerduty"</span></span>, <span class="hljs-string"><span class="hljs-string">"irc"</span></span> ] } } }</code> </pre><br><br>  From interesting here again, subscriptions and handlers.  Subscriptions determine which clients will run this command. <br><br>  A set of handlers determines the list of commands that will be executed when processing data from this check.  About them we will talk further. <br><br>  It is worth noting that verification can be a ‚Äúmetric‚Äù (metric), i.e.  the data from its STDOUT will always be simply transferred to handlers.  Thus, you can send these metrics somewhere to store or draw graphs (for example, in Graphite).  Details in the <a href="http://sensuapp.org/docs/0.12/checks">documentation</a> . <br><br><h6>  Handlers </h6><br>  Handlers define the commands that will be run on the monitoring server upon receipt of data from checks, and their parameters.  For example, this handler, when receiving a non-zero exit code from any check, will execute the command <code>mail -s 'sensu event' email@address.com</code> (example from the documentation): <br><br><pre> <code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"handlers"</span></span>: { <span class="hljs-string"><span class="hljs-string">"mail"</span></span>: { <span class="hljs-string"><span class="hljs-string">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"pipe"</span></span>, <span class="hljs-string"><span class="hljs-string">"command"</span></span>: <span class="hljs-string"><span class="hljs-string">"mail -s 'sensu event' email@address.com"</span></span> } } }</code> </pre><br><br>  It's all obvious, a bunch of handlers in <a href="https://github.com/sensu/sensu-community-plugins">the plugin repository</a> .  You can send in Pagerduty, and send letters, and in Graylog2 send in gelf.  Details in the <a href="http://sensuapp.org/docs/0.12/handlers">documentation</a> . <br><br>  All of the above is already enough to build a working system.  There are also mutators, extensions and APIs, but this is not important for us now. <br><br><h5>  Getting to the fun </h5><br><br>  Sensu is positioned as a ‚Äúmonitoring framework‚Äù, and this means that ‚Äúout of the box‚Äù there is nothing familiar about enterprise systems like Zabbix out of the box.  All functionality is added thanks to plugins. <br><br>  Let's try to do something useful.  Let's take a simple task - perform checks regarding Redis on clients, in case of problems, display an alert on the <a href="http://shopify.github.io/dashing/">Dashing</a> panel, as well as send a message to the history in Graylog2 and email to admin@example.com.  And also remove metrics from Redis and send it to storage in Graphite, and then also perform checks on the aggregated keys. <br><br>  Clients have addresses 192.168.1.2N, Graphite is deployed at 192.168.1.80:8082, RabbitMQ and Redis also at 192.168.1.80.  Graylog2 listens on 192.168.1.81, Dashing is also deployed there. <br><br><h6>  Configuration </h6><br><br>  Let's start with the client configuration. <br><br>  Suppose we have N servers in the role of redis. <br><br>  The client configuration looks like this: <br><br>  <b>/etc/sensu/config.json</b> <br><pre> <code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"client"</span></span>: { <span class="hljs-string"><span class="hljs-string">"graphite_server"</span></span>: <span class="hljs-string"><span class="hljs-string">"192.168.1.80:8082"</span></span>, <span class="hljs-string"><span class="hljs-string">"address"</span></span>: <span class="hljs-string"><span class="hljs-string">"192.168.1.2N"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"clientN"</span></span>, <span class="hljs-string"><span class="hljs-string">"subscriptions"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"redis"</span></span> ] } <span class="hljs-string"><span class="hljs-string">"rabbitmq"</span></span>: { <span class="hljs-string"><span class="hljs-string">"vhost"</span></span>: <span class="hljs-string"><span class="hljs-string">"/sensu"</span></span>, <span class="hljs-string"><span class="hljs-string">"host"</span></span>: <span class="hljs-string"><span class="hljs-string">"192.168.1.80"</span></span>, <span class="hljs-string"><span class="hljs-string">"password"</span></span>: <span class="hljs-string"><span class="hljs-string">"password"</span></span>, <span class="hljs-string"><span class="hljs-string">"port"</span></span>: <span class="hljs-number"><span class="hljs-number">5672</span></span>, <span class="hljs-string"><span class="hljs-string">"user"</span></span>: <span class="hljs-string"><span class="hljs-string">"sensu"</span></span> } }</code> </pre><br><br>  and placed on each of the N clients. <br><br>  All other configuration files are only on the Sensu server. <br><br>  Basic settings: <br><br>  <b>/etc/sensu/conf.d/settings.json</b> <br><br><pre> <code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"api"</span></span>: { <span class="hljs-string"><span class="hljs-string">"host"</span></span>: <span class="hljs-string"><span class="hljs-string">"192.168.1.80"</span></span>, <span class="hljs-string"><span class="hljs-string">"port"</span></span>: <span class="hljs-number"><span class="hljs-number">4567</span></span> }, <span class="hljs-string"><span class="hljs-string">"redis"</span></span>: { <span class="hljs-string"><span class="hljs-string">"host"</span></span>: <span class="hljs-string"><span class="hljs-string">"192.168.1.80"</span></span>, <span class="hljs-string"><span class="hljs-string">"port"</span></span>: <span class="hljs-number"><span class="hljs-number">6379</span></span> }, <span class="hljs-string"><span class="hljs-string">"rabbitmq"</span></span>: { <span class="hljs-string"><span class="hljs-string">"vhost"</span></span>: <span class="hljs-string"><span class="hljs-string">"/sensu"</span></span>, <span class="hljs-string"><span class="hljs-string">"host"</span></span>: <span class="hljs-string"><span class="hljs-string">"192.168.1.80"</span></span>, <span class="hljs-string"><span class="hljs-string">"password"</span></span>: <span class="hljs-string"><span class="hljs-string">"password"</span></span>, <span class="hljs-string"><span class="hljs-string">"port"</span></span>: <span class="hljs-number"><span class="hljs-number">5672</span></span>, <span class="hljs-string"><span class="hljs-string">"user"</span></span>: <span class="hljs-string"><span class="hljs-string">"sensu"</span></span> }, <span class="hljs-string"><span class="hljs-string">"mailer"</span></span>: { <span class="hljs-string"><span class="hljs-string">"mail_from"</span></span>: <span class="hljs-string"><span class="hljs-string">"sensu@example.com"</span></span>, <span class="hljs-string"><span class="hljs-string">"smtp_port"</span></span>: <span class="hljs-string"><span class="hljs-string">"25"</span></span>, <span class="hljs-string"><span class="hljs-string">"mail_to"</span></span>: <span class="hljs-string"><span class="hljs-string">"admin@example.com"</span></span>, <span class="hljs-string"><span class="hljs-string">"smtp_address"</span></span>: <span class="hljs-string"><span class="hljs-string">"localhost"</span></span> }, <span class="hljs-string"><span class="hljs-string">"dashing"</span></span>: { <span class="hljs-string"><span class="hljs-string">"auth_token"</span></span>: <span class="hljs-string"><span class="hljs-string">"YOUR_AUTH_TOKEN"</span></span>, <span class="hljs-string"><span class="hljs-string">"host"</span></span>: <span class="hljs-string"><span class="hljs-string">"http://192.168.1.81:8088"</span></span> }, <span class="hljs-string"><span class="hljs-string">"gelf"</span></span>: { <span class="hljs-string"><span class="hljs-string">"server"</span></span>: <span class="hljs-string"><span class="hljs-string">"192.168.1.81"</span></span> <span class="hljs-string"><span class="hljs-string">"port"</span></span>: <span class="hljs-string"><span class="hljs-string">"12201"</span></span>, } }</code> </pre><br><br>  As you can see, we configured not only Sensu itself, but also parameters for dashing handlers, gelf and mailer. <br><br>  Now we define these handlers themselves: <br><br>  <b>/etc/sensu/conf.d/handlers.json</b> <br><pre> <code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"handlers"</span></span>: { <span class="hljs-string"><span class="hljs-string">"default"</span></span>: { <span class="hljs-string"><span class="hljs-string">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"set"</span></span>, <span class="hljs-string"><span class="hljs-string">"handlers"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"mailer"</span></span>, <span class="hljs-string"><span class="hljs-string">"dashing"</span></span>, <span class="hljs-string"><span class="hljs-string">"gelf"</span></span> ] }, <span class="hljs-string"><span class="hljs-string">"gelf"</span></span>: { <span class="hljs-string"><span class="hljs-string">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"pipe"</span></span>, <span class="hljs-string"><span class="hljs-string">"command"</span></span>: <span class="hljs-string"><span class="hljs-string">"/etc/sensu/handlers/gelf.rb"</span></span> }, <span class="hljs-string"><span class="hljs-string">"mailer"</span></span>: { <span class="hljs-string"><span class="hljs-string">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"pipe"</span></span>, <span class="hljs-string"><span class="hljs-string">"command"</span></span>: <span class="hljs-string"><span class="hljs-string">"/etc/sensu/handlers/mailer.rb"</span></span> }, <span class="hljs-string"><span class="hljs-string">"dashing"</span></span>: { <span class="hljs-string"><span class="hljs-string">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"pipe"</span></span>, <span class="hljs-string"><span class="hljs-string">"command"</span></span>: <span class="hljs-string"><span class="hljs-string">"/etc/sensu/handlers/dashing.rb"</span></span> }, <span class="hljs-string"><span class="hljs-string">"graphite"</span></span>: { <span class="hljs-string"><span class="hljs-string">"mutator"</span></span>: <span class="hljs-string"><span class="hljs-string">"only_check_output"</span></span>, <span class="hljs-string"><span class="hljs-string">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"amqp"</span></span>, <span class="hljs-string"><span class="hljs-string">"exchange"</span></span>: { <span class="hljs-string"><span class="hljs-string">"durable"</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span>, <span class="hljs-string"><span class="hljs-string">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"topic"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"metrics"</span></span> } } } }</code> </pre><br><br>  It's simple.  Notice that in Graphite we helmet data through AMQP.  Handlers must be decomposed on the monitoring server in / etc / sensu / handlers. <br><br>  Now we will configure the checks that will be performed on the clients: <br><br>  <b>/etc/sensu/conf.d/checks.json</b> <br><pre> <code class="javascript hljs">{ <span class="hljs-string"><span class="hljs-string">"checks"</span></span>: { <span class="hljs-string"><span class="hljs-string">"redis_processes"</span></span>: { <span class="hljs-string"><span class="hljs-string">"interval"</span></span>: <span class="hljs-number"><span class="hljs-number">60</span></span>, <span class="hljs-string"><span class="hljs-string">"command"</span></span>: <span class="hljs-string"><span class="hljs-string">"/etc/sensu/plugins/processes/check-procs.rb -p redis -c 8 -C 0 -w 7 -W 1"</span></span>, <span class="hljs-string"><span class="hljs-string">"subscribers"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"redis"</span></span>, ], <span class="hljs-string"><span class="hljs-string">"handlers"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"default"</span></span> ] }, <span class="hljs-string"><span class="hljs-string">"redis_memory"</span></span>: { <span class="hljs-string"><span class="hljs-string">"dependencies"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"redis_processes"</span></span> ], <span class="hljs-string"><span class="hljs-string">"command"</span></span>: <span class="hljs-string"><span class="hljs-string">"/etc/sensu/plugins/redis/check-redis-memory.rb -c 204800 -w 51200"</span></span>, <span class="hljs-string"><span class="hljs-string">"interval"</span></span>: <span class="hljs-number"><span class="hljs-number">60</span></span>, <span class="hljs-string"><span class="hljs-string">"subscribers"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"redis"</span></span>, ], <span class="hljs-string"><span class="hljs-string">"handlers"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"default"</span></span> ] }, <span class="hljs-string"><span class="hljs-string">"redis_metric"</span></span>: { <span class="hljs-string"><span class="hljs-string">"handlers"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"graphite"</span></span> ], <span class="hljs-string"><span class="hljs-string">"interval"</span></span>: <span class="hljs-number"><span class="hljs-number">60</span></span>, <span class="hljs-string"><span class="hljs-string">"dependencies"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"redis_processes"</span></span> ], <span class="hljs-string"><span class="hljs-string">"command"</span></span>: <span class="hljs-string"><span class="hljs-string">"/etc/sensu/plugins/redis/redis-graphite.rb --scheme stats.:::name:::.redis"</span></span>, <span class="hljs-string"><span class="hljs-string">"subscribers"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"redis"</span></span>, ], <span class="hljs-string"><span class="hljs-string">"type"</span></span>: <span class="hljs-string"><span class="hljs-string">"metric"</span></span> }, <span class="hljs-string"><span class="hljs-string">"redis_keys_from_graphite"</span></span>: { <span class="hljs-string"><span class="hljs-string">"interval"</span></span>: <span class="hljs-number"><span class="hljs-number">60</span></span>, <span class="hljs-string"><span class="hljs-string">"command"</span></span>: <span class="hljs-string"><span class="hljs-string">"/etc/sensu/plugins/graphite/check-data.rb -s :::graphite_server::: -t stats.:::name:::.redis.db0.keys -w 500 -c 900 -a 120"</span></span>, <span class="hljs-string"><span class="hljs-string">"subscribers"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"redis"</span></span> ], <span class="hljs-string"><span class="hljs-string">"dependencies"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"redis_processes"</span></span> ], <span class="hljs-string"><span class="hljs-string">"handlers"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"default"</span></span> ] } } }</code> </pre><br><br>  Checks are carried out by Sensu plug-ins, which need to be expanded on clients in / etc / sensu / plugins.  For those familiar with Nagios, there is nothing new here, only the redis_metric metric is interesting, from which we put data into Graphite, and then in the redis_keys_from_graphite check we get and check the data in the last 10 minutes.  In general, almost every plugin has a key - help, which gives quite reasonable information about the use. <br><br>  That's the whole configuration.  Everything is clear, everything can be stored in the repository, and that's fine. <br><br>  Of course, you need to configure another Dashing and Graphite, but I will leave this outside of the article.  Instructions for configuring Sensu + Graphite can be found <a href="http://joemiller.me/2012/02/02/sensu-and-graphite/">here</a> , but with Dashing everything is clear. <br><br>  And also Sensu has a simple dashboard on which you can see a list of clients, checks, and triggered alerts.  Through the API and using the dashboard, you can turn off the generation of alerts for any hosts or checks, as well as see the general state of the system. <br>  It looks something like this (the screen is not mine): <br><img src="https://habrastorage.org/getpro/habr/post_images/454/ab3/558/454ab3558143fba52fd3e999a01c58e8.png"><br><br><h5>  findings </h5><br><br>  As we can see, Sensu assumes only the role of a router and an organizer, and all the dirty work is done by external programs.  This allows you to keep the small size of the source code, and the overall simplicity of the system.  Registering clients through RabbitMQ allows you to get rid of the mechanism of "detecting" clients, which is especially convenient for clouds.  Scaled everything is very simple, an example of HA + load balancing can be seen <a href="http://failshell.io/sensu/high-availability-sensu/">here</a> . <br><br>  I have been using Sensu in production, in parallel with Zabbix, for about a month now, and in the test version I used a couple of months.  Sensu's flexibility allowed us to set up monitoring of key parameters and project metrics with output to the Dashing panel, while I have been using Zabbix for a very long time, and he is now engaged in more comprehensive monitoring.  In general, for many projects, especially in the clouds, Sensu would be an excellent choice, because it provides the ability to flexibly route events, and is also well adapted to the dynamic nature of the clouds.  In the presentations, I met numbers in thousands of servers monitored by Sensu, so there is no problem with performance. <br><br>  In conclusion, I want to point out the cons and pros of Sensu (all IMHO): <br><br><h6>  Cons Sensu </h6><br><br><ul><li>  Available notification handlers are scanty on settings.  This is now the main disadvantage if you do not use services like PagerDuty.  The only solution is to write your cunning handler. </li><li>  Config in json, not in yaml. </li><li>  We need an external keeper of metrics, he is also a graphical chart maker. </li><li>  Not too complete documentation.  Fortunately, the project is simple, you can figure it out just by reading the code. </li></ul><br><br><h6>  Sensu advantages </h6><br><br><ul><li>  Config can be stored in git, decompose everything using Chef / Puppet. </li><li>  Scalable. </li><li>  Fault tolerance. </li><li>  Flexibility to choose a storage system. </li><li>  Nagios plugin support. </li><li>  Auto-connect customers. </li><li>  Subscription mechanism. </li><li>  Data is published by customers as they are generated. </li><li>  The results of the checks can be flexibly sent to different handlers. </li></ul></div><p>Source: <a href="https://habr.com/ru/post/205804/">https://habr.com/ru/post/205804/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../205786/index.html">The fifth issue of TsODY.RF magazine</a></li>
<li><a href="../205790/index.html">Finding the best position when comparing digitized images</a></li>
<li><a href="../205796/index.html">IBM Research Developed a Method for Bose-Einstein Condensate Production Using a Polymer Film</a></li>
<li><a href="../205798/index.html">Life after chekina</a></li>
<li><a href="../205800/index.html">Bubble Cavity Simulation Receives Gordon Bell Award</a></li>
<li><a href="../205808/index.html">15 things of today that our children won't find</a></li>
<li><a href="../205810/index.html">Rostelecom + Tele2 Russia =?</a></li>
<li><a href="../205812/index.html">Picaso 3D Designer Review - a new milestone in bulk printing</a></li>
<li><a href="../205816/index.html">Meet RENTMANIA-online rental platform</a></li>
<li><a href="../205820/index.html">Webinar: ‚ÄúEfficient and secure migration from Windows XP to Windows 8.1‚Äù</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>