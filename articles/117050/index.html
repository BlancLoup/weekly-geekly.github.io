<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Dd command and everything related to it</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="On UNIX systems, there is one very ancient command called dd. It is designed to copy something somewhere byte-by-byte. At first glance, nothing outsta...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Dd command and everything related to it</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage/38507233/507e35a7/f990fd90/c60d32a0.png"><br>  On UNIX systems, there is one very ancient command called dd.  It is designed to copy something somewhere byte-by-byte.  At first glance, nothing outstanding, but if you consider all the features of this universal tool, you can perform quite complex operations without involving additional software, for example: perform a backup of the MBR, create data dumps from various drives, mirror media, restore data from a backup on media and more, and, when combining the capabilities of dd and supporting the cryptographic algorithms of the Linux kernel, you can even create encrypted files that contain whole files  yy system. <br>  Again, in the note I will describe the most frequently used examples of using the command, which greatly facilitate the work on UNIX systems. <br><a name="habracut"></a><br>  I will start with a small example, clearly illustrating the main parameters of the command: <br><br>  <i># dd if = / dev / urandom of = / dev / null bs = 100M count = 5</i> <br><br>  Options: <br><ul><li>  <b>if:</b> indicates the source, i.e.  to where we copy from.  Specifies a file that can be either a regular file or a device file. </li><li>  <b>of:</b> indicates the destination file.  The same thing, we can write both in a regular file and directly in the device. </li><li>  <b>bs: the</b> number of bytes to be written at a time.  You can think of this argument as the size of the piece of data that will be written or read, and the number of pieces is regulated by the next parameter. </li><li>  <b>count:</b> just the number that indicates: how many pieces will be copied. </li></ul><br>  Thus, the described command reads 5 * 100 megabytes from the / dev / urandom device to the / dev / null device.  Giving this command a sense load, it turns out that the system will generate 500 megabytes of random values ‚Äã‚Äãand write them into a null device.  Of course, the only thing this command will do is load the processor for a few seconds.  Consider examples from practice: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>Creating a disk image:</b> <br><br>  <i># dd if = / dev / cdrom of = image.iso</i> <br><br>  The command will read data from the device and write to the file until it reaches the end of the device.  If the disk is broken, you can try to read it, ignoring read errors: <br><br>  <i># dd if = / dev / cdrom of = image.iso conv = noerror</i> <br><br>  The ‚Äúconv‚Äù parameter allows you to connect several filters applicable to the data stream.  The ‚Äúnoerror‚Äù filter just turns off the program shutdown when it encounters a read error.  Thus, some data from the disk can still be read.  In exactly the same way, I saved the data from my Corsair flash drive, which was bent: I found the right position when there was a contact, and made a file system dump. <br>  By the way, such images can be connected using the mount command with the "-o loop" key: <br><br>  <i># mount -o loop image.iso / mnt / image</i> <br><br>  If something does not work, the process is divided into 2 levels: <br><br>  <i># losetup -e / dev / loop0 image.iso</i> <i><br></i>  <i># mount / dev / loop0 / mnt / image</i> <br><br>  If this does not work, then the image file system has flown. <br><br>  <b>Work with media</b> <br><br>  A very simple, though not optimal solution for cloning a hard disk: <br><br>  <i># dd if = / dev / sda of = / dev / sdb bs = 4096</i> <br><br>  All the same byte copying with a buffer size of 4 KB.  The disadvantage of this method is that when any sections are full, all bits will be copied, which is not beneficial when copying sections with a small fullness.  To reduce copying time when manipulating large amounts of data, you can simply transfer the MBR to a new medium (I will describe how), re-read the kernel partition table (using the same fdisk), create file systems, and simply copy the files (remembering to save access rights to files). <br><br>  Alternatively, you can even make a backup of the partition on the network.  Destroying ssh keys will work such a scheme: <br><br>  <i># dd if = / dev / DEVICE |</i>  <i>ssh user @ host "dd of = / home / user / DEVICE.img".</i> <br><br>  I once read a study, according to which a very large proportion of hard drives in the flea market undergo data recovery without the involvement of something specialized, and contains confidential information.  So that nothing could be restored on the carrier - you can score it with zeros: <br><br>  <i># dd if = / dev / zero of = / dev / DEVICE</i> <br><br>  I think it is clear what you need to replace DEVICE.  After giving lectures on Linux, I began to follow very carefully what I was writing. <br>  You can check the same dd, but converting the data to hex: <br><br>  <i># dd if = / dev / sda |</i>  <i>hexdump -C</i> <br><br>  Must be sprinkled with zeros. <br><br>  <b>Operations with MBR</b> <br><br>  MBR is located in the first 512 bytes of the hard disk, and consists of a partition table, bootloader and a pair of additional.  byte.  Sometimes, it has to be backed up, restored, etc.  Backup runs like this: <br><br>  <i># dd if = / dev / sda of = mbr.img bs = 512 count = 1</i> <br><br>  You can restore easier: <br><br>  <i># dd if = mbr.img of = / dev / sda</i> <br><br>  The reasons for these frauds with the MBR may be different, but I want to tell one feature taken from experience: after restoring a long-standing copy of the MBR, where one of the partitions was ext3, and later became FAT and was used by Windows, the partition stopped seeing Windows.  The reason is the partition ID, which is stored in the MBR.  If UNIX mounts file systems according to the superblock, then Windows is guided by partition IDs from the MBR.  Therefore, you should always check partition IDs with fdisk, especially if there are Windows on the computer. <br><br>  <b>File generation</b> <br><br>  With dd, you can generate files and then use them as containers of other file systems, even in encrypted form.  The technology is as follows: <br>  With dd, a file is created that is clogged with zeros (it is not rational to score with random numbers: long and pointless): <br><br>  <i># dd if = / dev / zero of = image.crypted bs = 1M count = 1000</i> <br><br>  Created a file size of almost gigabytes.  Now you need to make this file a block device and, at the same time, pass it through the linux kernel encryption mechanism.  I will choose the blowfish algorithm.  Module loading: <br><br>  <i># modprobe cryptoloop</i> <i><br></i>  <i># modprobe blowfish</i> <br><br>  Associate an image with a block device with encryption enabled: <br><br>  <i># losetup -e blowfish / dev / loop0 image.crypted</i> <br><br>  The team will ask you to enter a password, which will be the key to the image.  If the key is entered incorrectly, the system will not be mounted.  You can recreate the data in the image using the new key, but you will not have access to the old data. <br>  Create a file system and mount: <br><br>  <i># mkfs.ext2 / dev / loop0</i> <i><br></i>  <i># mount / dev / loop0 / mnt / image</i> <br><br>  The image is ready to write data.  After you finish working with it, you need to remember to unmount it and disconnect it from the block loop device: <br><br>  <i># umount / dev / loop0</i> <i><br></i>  <i># losetup -d / dev / loop0</i> <br><br>  Now the encrypted image is ready. <br><br>  I wrote out the main ideas, but the set of tasks that can be solved with the help of a small program whose name consists of two letters is much wider.  The ‚Äúdd‚Äù program is a vivid example of what IT's called the ‚ÄúUNIX way‚Äù: one program is part of the mechanism, performs only its task, and performs it well.  In the hands of a person who knows his business, who has a non-standard approach to solving a problem, such small programs will help to quickly and effectively solve complex tasks that, at first glance, should be solved by large specialized packages. </div><p>Source: <a href="https://habr.com/ru/post/117050/">https://habr.com/ru/post/117050/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../117044/index.html">British Bank closes the site until April 2012</a></li>
<li><a href="../117045/index.html">Plugin Overview ++</a></li>
<li><a href="../117046/index.html">20 years of Linux: a brief history</a></li>
<li><a href="../117048/index.html">Fresh IE9 exploit: details</a></li>
<li><a href="../117049/index.html">Top 5 custom video contests on the Internet</a></li>
<li><a href="../117051/index.html">Origami and augmented reality</a></li>
<li><a href="../117053/index.html">About miracles</a></li>
<li><a href="../117058/index.html">Positive Hack Days 2011: Intro</a></li>
<li><a href="../117063/index.html">Calculate editorial distance</a></li>
<li><a href="../117064/index.html">Connection of additional services from your provider</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>