<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Tiling in 2D games on Unity, scaling material</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="When developing 2D games on Unity, it is often necessary to make a multitude of elements of different sizes from the same material. The simplest examp...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Tiling in 2D games on Unity, scaling material</h1><div class="post__text post__text-html js-mediator-article">  When developing 2D games on Unity, it is often necessary to make a multitude of elements of different sizes from the same material.  The simplest example is the tiles of earth, grass, stone, and other elements in all kinds of platformers.  As a rule, the same tiles by default use the same material (otherwise the number of materials created in advance would be too large).  Often, it may be inconvenient to make a level frame from elementary tiles because of too many objects at a level, so instead of elementary tiles, large tiles are used - the same tiles, only on a larger scale.  Suppose we need to ‚Äúplant‚Äù two patches of grass above the ground: <br><br><img src="http://rghost.ru/17539941/image.png" alt="image"><br><br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In this picture, there are 9 separate grass tiles, 1x1 in size, on the ground.  With Ctrl + C, Ctrl + V, the eight tiles on the right were successfully placed, but if the level should be on the order of a couple hundred grass tiles and the levels themselves are a few dozen, then the placement of single tiles will take too much time.  The optimal solution for such tasks is scaling a single tile.  Those.  in this case, you will need to copy a piece of grass and stretch the resulting object along the X axis eight times (for example, in the editor's inspector), you get this thing: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cdb/3e4/e58/cdb3e4e5839dcdc8cb76fc26421afae7.png" alt="image"><br><br>  It is hardly possible to call the result obtained acceptable.  For normal scaling, in addition to the object itself, you need to change the scale of the material of this object (again in the editor, in the Inspector tab), namely the Tiling parameter: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6b7/653/060/6b7653060dc0b645293453b3ebf8efdc.png" alt="image"><br><br>  We get the following result: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d5d/6bc/6ff/d5d6bc6ffff2735ccd91d3172a886748.png" alt="image"><br><br>  As you can see, a block of eight tiles looks as it was intended, but a block of one tile to the left has shrunk eight times.  The thing is that these two objects use the same material, so changes in the material of one object entail changes in the material of another object. <br>  This problem can be solved in the following way: each object has a transform.sharedMaterial component - this is a common material, as well as a transfrom.material component - when this component changes, a copy of the material used by the object is created, which the object will use in the future, and can be changed without affecting other objects.  Create a simple script: <br><br>  <i>TexTilingScript.js</i> <br><br><pre><code class="javascript hljs">scaleMaterial(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">scaleMaterial</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//       renderer.material.mainTextureScale.x = transform.localScale.x; renderer.material.mainTextureScale.y = transform.localScale.y; }</span></span></code> </pre> <br><br>  This script creates and scales new material for an object during object initialization.  Add this script to both objects.  If you click Play, we get the following result: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/463/39b/bcb/46339bbcb64428e86a02b9597e0d7490.png" alt="image"><br><br>  It would seem that life is beautiful, but there is one "but": this result is obtained only during the "game", while editing is still sad: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c43/dc9/754/c43dc97545272e597b599e146715601b.png" alt="image"><br><br>  It is an expected result, because  the script is executed only during the application launch.  In order for the material to be correctly scaled during editing, you must add a handler for this script to the editor.  To do this, create another script in the Assets / Editor folder: <br><br>  TexTilingEditorScript.js <br><br><pre> <code class="javascript hljs">@CustomEditor(TexTilingScript) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TexTilingEditorScript</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Editor</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnSceneGUI</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//    TexTilingScript     ,     var script = target as TexTilingScript; //        script.scaleMaterial(); } }</span></span></code> </pre><br><br>  This script will call the scaleMaterial function for an object that has a TexTilingScript component every time such an object is selected on the screen (for example, it is selected with the mouse), and saves the resulting changes: <br><br><img src="http://rghost.ru/17540261/image.png" alt="image"><br><br>  Everything is fine, except for one thing - an error appears in the Log-e: <br>  Instantiating material due to calling renderer.material during edit mode.  This will leak materials into the scene.  You most want to use renderer.sharedMaterial instead. <br>  The fact is that by changing the material of the object during editing - we create a new temporary material, which after launching the application will be deleted.  I sincerely do not understand why the Unity developers designed this case as an error, and not as a warning, since  Such an alignment is quite acceptable and does not lead to any conflicts.  But if anyone bothers red - you can follow their advice - for scaling, you can use not renderer.material, but renderer.sharedMaterial - in this case, while editing the selected object, its proportions will be correct, but other objects with the same material will be distorted nevertheless, this option can be considered acceptable and convenient.  Add a new scaleSharedMaterial () function to TexTilingScript: <br><br>  TexTilingScript.js <br><br><pre> <code class="javascript hljs">scaleMaterial(); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">scaleMaterial</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//       renderer.material.mainTextureScale.x = transform.localScale.x; renderer.material.mainTextureScale.y = transform.localScale.y; } function scaleSharedMaterial() { //   ,      renderer.sharedMaterial.mainTextureScale.x = transform.localScale.x; renderer.sharedMaterial.mainTextureScale.y = transform.localScale.y; }</span></span></code> </pre><br><br>  Now in the TexTilingEditorScript script, we will change the called function: <br><br><br>  TexTilingEditorScript.js <br><br><pre> <code class="javascript hljs">@CustomEditor(TexTilingScript) <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">TexTilingEditorScript</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Editor</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">OnSceneGUI</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">//    TexTilingScript     ,     var script = target as TexTilingScript; //     script.scaleSharedMaterial(); } }</span></span></code> </pre><br><br>  Now the ‚Äúerror‚Äù does not appear, but in order for the material of the object to scale correctly during editing, you must first select it.  Also quite acceptable option. <br>  Well, another solution to this problem is to create in advance for each object its own material.  But not everyone will like to have in the source code of the project a hundred pre-created materials, when you can do with just one, so the use of scripts is one of the best solutions. <br><br>  All scripts are written in JavaScript.  Unity 3.3, Pro. </div><p>Source: <a href="https://habr.com/ru/post/126333/">https://habr.com/ru/post/126333/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../126322/index.html">Windows Phone Camp - a few days before the launch in Russia!</a></li>
<li><a href="../126327/index.html">Will Mars be as big as the full moon in August 2011?</a></li>
<li><a href="../126328/index.html">Digest Wanted.VC # 10</a></li>
<li><a href="../126330/index.html">Another physics engine in JavaScript</a></li>
<li><a href="../126332/index.html">Two-layer project management model</a></li>
<li><a href="../126338/index.html">Automation SVN + Apache + LDAP</a></li>
<li><a href="../126340/index.html">Google will buy Motorola Mobility for 12.5 billion dollars</a></li>
<li><a href="../126342/index.html">$ 20k per person: InCube launches startup accelerator</a></li>
<li><a href="../126343/index.html">Google acquired Motorola's mobile business for $ 12.5 billion</a></li>
<li><a href="../126350/index.html">Mobile communication in the hauls and stations of the Moscow metro</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>