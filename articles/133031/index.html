<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Call paging on Cisco CallManager</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello to all! 
 I can not help but share the experience of implementing such a necessary feature as call paging on Cisco CallManager. This should work...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Call paging on Cisco CallManager</h1><div class="post__text post__text-html js-mediator-article">  Hello to all! <br>  I can not help but share the experience of implementing such a necessary feature as call paging on Cisco CallManager.  This should work like this: <br><ol><li>  the subscriber picks up the phone, presses the function access key and starts broadcasting; </li><li>  Predefined phones receive and reproduce sound through their hands-free speakers. </li></ol><br>  Unfortunately, despite the fact that paging is a standard feature of any traditional PBX, CCM does not know how.  However, thanks to the XML browser built into the 7900 series phones, paging (and not only) can be implemented as a service. <br><a name="habracut"></a><br><h5>  Theory </h5><br>  Here is a good guide about this.  From it, you can learn that communication with the phone consists in the transfer to it of certain XML objects that cause it to take some action.  There are few actions: display text, menu or image, make a call, play a sound and, what interests us most, transfer sound from a microphone to RTP at a given address or receive RTP and play sound to a speaker (using g.711u). <br>  I used only two objects (the syntax is described in the same guide): <br><ul><li>  CiscoIPPhoneExecute - execute a command or open a URL.  To control the transmission of an audio stream, use the RTPRx and RTPTx commands; </li><li>  CiscoIPPhoneText - display text on the phone display.  In addition to the actual text and title, this object can contain SoftKeyItem elements - programmable keys.  You can assign actions to them (separately for pressing and releasing), similar to the CiscoIPPhoneExecute object. </li></ul><br><h5>  Implementation </h5><br>  The most primitive implementation might look something like this: <br><ol><li>  let's say phones play RTP from a given port: <br><pre> &lt;CiscoIPPhoneExecute&gt;
 &lt;ExecuteItem Priority = "0" URL = "RTPMRx: 239.0.0.45: 20480: 90" /&gt;
 &lt;/ CiscoIPPhoneExecute&gt;
</pre><br>  Pay attention to the RTPMRx command - after a series of experiments, I decided to send out the sound by multicast.  The address is chosen arbitrarily, the port number must be even and in the range of 20480-32768; </li><li>  on the phone from which paging is performed, we will create a minimal interface: a text label and two buttons, ‚Äústart‚Äù and ‚Äúexit‚Äù: <br><pre> &lt;CiscoIPPhoneText&gt;
   &lt;Title&gt; Alert &lt;/ Title&gt;
   &lt;Prompt&gt; Click Start &lt;/ Prompt&gt;
   &lt;Text&gt; Alert &lt;/ Text&gt;
   &lt;SoftKeyItem&gt;
     &lt;Name&gt; Start &lt;/ Name&gt;
     &lt;URL&gt; RTPTx: Stop &lt;/ URL&gt;
     &lt;URLDown&gt; RTPMTx: 239.0.0.45: 20480 &lt;/ URLDown&gt;
     &lt;Position&gt; 1 &lt;/ Position&gt;
   &lt;/ SoftKeyItem&gt;
   &lt;SoftKeyItem&gt;
     &lt;Name&gt; Log Out &lt;/ Name&gt;
     &lt;URL&gt; SoftKey: Exit &lt;/ URL&gt;
     &lt;URLDown&gt; http://10.1.1.65/page_stop.php &lt;/ URLDown&gt;
     &lt;Position&gt; 4 &lt;/ Position&gt;
   &lt;/ SoftKeyItem&gt;
 &lt;/ CiscoIPPhoneText&gt;
</pre><br>  By pressing the ‚ÄúStart‚Äù button, the phone receives a command from the URLDown element, RTPMTx: 239.0.0.45: 20480, and starts sending an audio stream to the specified address.  When the subscriber releases the button, the phone executes the RTPTx: Stop command from the URL element; </li><li>  Unfortunately, I did not find a way to execute two commands for one user action, so after releasing the ‚ÄúStart‚Äù button, the receiving phones continue to play RTP (which is already gone).  Therefore, when you press the ‚ÄúExit‚Äù button, one more object is called for each phone that listens to the phone: <br><pre> &lt;CiscoIPPhoneExecute&gt;
 &lt;ExecuteItem Priority = "0" URL = "RTPMRx: Stop" /&gt;
 &lt;/ CiscoIPPhoneExecute&gt;
</pre><br></li></ol><br>  I implemented it all on php + mysql (for storing phone addresses. I was already too lazy to figure out how to get them from the CCM database), but I warn you right away - I‚Äôm not even a close programmer, so all that you see <a href="http://pastebin.com/SmvuZ88U">here</a> and <a href="http://pastebin.com/dnf5Tf04">here</a> is real govnokod.  Proceed with caution. <br><br><h5>  What else can be done from this </h5><br>  And a lot of things: weather forecast / currency rates / news, text messaging, reminders / alarm clocks, even heard about the broadcast images from surveillance cameras.  And yes, for the most curious, it is noticed that when the microphone is turned on remotely, the phone signals this only with an unremarkable icon on the display ... </div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/133031/">https://habr.com/ru/post/133031/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../133025/index.html">In the footsteps of Citrix Synergy in Barcelona</a></li>
<li><a href="../133026/index.html">Mobile solutions are becoming a popular destination for startups.</a></li>
<li><a href="../133027/index.html">Opening 9 virtual offices</a></li>
<li><a href="../133028/index.html">Freescale has introduced a universal medical platform.</a></li>
<li><a href="../133029/index.html">North Korea is actively developing its mobile industry.</a></li>
<li><a href="../133032/index.html">Proxy RSS feed with Python</a></li>
<li><a href="../133033/index.html">VMware View Client with PCoIP support and USB for Linux on Linux</a></li>
<li><a href="../133034/index.html">Trying to just explain complex, for beginners, things in javascript</a></li>
<li><a href="../133035/index.html">Bike music</a></li>
<li><a href="../133036/index.html">We make calendars in different number systems</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>