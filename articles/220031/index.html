<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Writing Penguin Daycare Simulator on Go (Google App Engine) and Lua (Corona SDK)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="1. Introduction 
 This project is a simple example of using Google App Engine in a mobile application. 

 The server part provides a list of penguins ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Writing Penguin Daycare Simulator on Go (Google App Engine) and Lua (Corona SDK)</h1><div class="post__text post__text-html js-mediator-article"><img width="314" src="https://habrastorage.org/getpro/habr/post_images/01f/d8f/666/01fd8f6669207a22ce0a776cf8ac7b6b.jpg" align="left"><br><h4>  1. Introduction </h4><br>  This project is a simple example of using Google App Engine in a mobile application. <br><br>  The server part provides a list of penguins in JSON format.  The mobile client requests this list via HTTP or HTTPS. <br>  The server part also records certain events in the database, namely the number of visits to a particular penguin and the number of button presses: feed the fish and scratch the tummy. <br>  Each penguin has <code>Name</code> , <code>Bio</code> description fields and counter fields. <br><a name="habracut"></a><br><h4>  2. Subtleties of translation </h4><br>  I thought how to translate Penguin Daycare Simulator into Russian, but ‚Äúkindergarten‚Äù as ‚Äúdaycare‚Äù is not suitable, ‚Äúday care‚Äù too.  Therefore, it remained without translation. <br><br><h4>  3. Preparation </h4><br>  If you do not have Google App Engine Go SDK installed, then go to the <a href="https://cloud.google.com/products/app-engine/">Google App Engine</a> link, click "Try it now" and follow all the points.  Give your project a name, select Go, download and install the SDK.  Make sure that the environment variables ( <code>PATH</code> , <code>GOROOT</code> , <code>GOPATH</code> , <code>APPENGINE_DEV_APPSERVER</code> ) are <code>APPENGINE_DEV_APPSERVER</code> , for this you should see the <code>goapp</code> command in the <code>goapp</code> .  Looking ahead, I‚Äôll say that to upload a simple project to the GAE server and start it, you need to run the <code>goapp deploy</code> command in the project directory.  She will ask you for the email of the google account on which the project should be located.  It is important that the project name matches on app.yaml and on the site.  But in this project modules are used and the loading process is somewhat different. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      As an IDE for Go, I recommend <a href="https://code.google.com/p/golangide/">LiteIDE</a> , and for Lua and Corona SDK - <a href="http://studio.zerobrane.com/">ZeroBrane Studio</a> .  Download Corona SDK on their <a href="https://developer.coronalabs.com/downloads/corona-sdk">website</a> . <br><br><h4>  4. Clint server </h4><br>  The picture below shows a very complex pattern of communication between the client (left) and the server (right). <br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/651/409/1fc/6514091fcdecb8b9d7517b9856a420da.jpg"></div><br><br>  Apparently the client requests only a list of penguins and sends only three events.  Communication takes place over HTTP, but you can use HTTPS for free.  This can be attributed to one of the advantages of using GAE - there is no need to pay for an SSL certificate and customize working with it. <br><br>  Since everything works over HTTP, it is possible to execute requests directly in the browser without using a special client. <br><br>  <a href="http://penguin-daycare-simulator.appspot.com/">penguin-daycare-simulator.appspot.com</a> <br>  A simple greeting, not used by the mobile client, but lets say whether the service is working.  You can replace http with https and make sure that it works too. <br><br>  <a href="http://penguin-daycare-simulator.appspot.com/penguins">penguin-daycare-simulator.appspot.com/penguins</a> <br>  This is the most important request.  With it, the mobile client receives a list of all the penguins that are currently supervised. <br>  For more convenient viewing of this data, I recommend the <a href="https://chrome.google.com/webstore/detail/jsonview/chklaanhfefbnpoihckbnefhakgolnmc">JSONview</a> extension for Chrome. <br><br>  <a href="http://penguin-daycare-simulator.appspot.com/stat/visit">penguin-daycare-simulator.appspot.com/stat/visit</a> <br>  <a href="http://penguin-daycare-simulator.appspot.com/stat/fish">penguin-daycare-simulator.appspot.com/stat/fish</a> <br>  <a href="http://penguin-daycare-simulator.appspot.com/stat/bellyrub">penguin-daycare-simulator.appspot.com/stat/bellyrub</a> <br>  These three queries increase the corresponding counters for any penguin.  <code>Id</code> penguin <code>Id</code> passed as a POST parameter.  The server does not return anything in response, but you can, if you want, add the ‚ÄúOK‚Äù line to the response or another signal of successful operation. <br><br><h4>  5. More screenshots, more screenshots! </h4><br><img width="314" src="https://habrastorage.org/getpro/habr/post_images/87d/c76/d41/87dc76d41075ec775ddd22dd8ac37126.jpg" align="left"><img width="314" src="https://habrastorage.org/getpro/habr/post_images/f4f/bd6/465/f4fbd6465a0d11fb23417805e9936a3e.jpg" align="left"><br><br clear="all">  Already before the publication of the article, I remembered about this penguin <br><div class="spoiler">  <b class="spoiler_title">Watch the positive</b> <div class="spoiler_text"><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/3wTWWjYTe1I%3Ffeature%3Doembed&amp;xid=25657,15700022,15700186,15700191,15700253&amp;usg=ALkJrhj9hSS6R5-ywyUaFPBLB3ayCYK1aQ" frameborder="0" allowfullscreen=""></iframe></div></div><br><h4>  6. Server part - Google App Engine </h4><br>  Now we can go directly to the code.  Consider the project file structure on Go. <br><pre> <code class="bash hljs">PenguinDaycareSimulatorServer/ ‚îú‚îÄ‚îÄ default/ ‚îÇ  ‚îú‚îÄ‚îÄ app.go ‚îÇ  ‚îú‚îÄ‚îÄ default.yaml ‚îÇ  ‚îî‚îÄ‚îÄ penguins.json ‚îú‚îÄ‚îÄ static/ ‚îÇ  ‚îú‚îÄ‚îÄ favicon.ico ‚îÇ  ‚îî‚îÄ‚îÄ static.yaml ‚îî‚îÄ‚îÄ dispatch.yaml</code> </pre><br>  <code>default</code> and <code>static</code> are modules.  The project for GAE can be divided into modules, and can work without them.  In this case, only three files are <code>app.yaml</code> : <code>app.yaml</code> , <code>app/app.go</code> and <code>penguins.json</code> .  Initially, it was in my project (you can see the first commit on GitHub), but I wanted to add the <code>max_concurrent_requests</code> setting, which is responsible for how many simultaneous requests can be processed by one instance of your application.  The default value is only 10. Go is clearly capable of more.  The maximum value is 500. If the load grows and this value is exceeded, additional copies of your application are launched and the load is distributed between them.  If you want to fit only in free quotas for GAE, then the use of this setting is highly desirable.  If the application does not cope with such a load, then lower this value and switch to paid billing. <br><br>  So this setting is available only for modules.  And your application should have at least 2 modules so that GAE considers it modular. <br><br>  <code>static</code> is a very simple module that one could do without (if it were not for the GAE constraint above), its task is only to give a <code>favicon.ico</code> file statically. <br><br>  <code>default</code> is the main module that does all the work. <br><br>  The <code>*.yaml</code> files are settings and descriptions.  One for each module and one <code>dispatch.yaml</code> file, which describes which URLs which module handles which URLs. <br><div class="spoiler">  <b class="spoiler_title">dispatch.yaml</b> <div class="spoiler_text"><pre> <code class="bash hljs">application: penguin-daycare-simulator dispatch: - url: <span class="hljs-string"><span class="hljs-string">"*/favicon.ico"</span></span> module: static - url: <span class="hljs-string"><span class="hljs-string">"*/"</span></span> module: default</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">static.yaml</b> <div class="spoiler_text"><pre> <code class="bash hljs">application: penguin-daycare-simulator module: static version: 1 runtime: python27 api_version: 1 threadsafe: <span class="hljs-literal"><span class="hljs-literal">true</span></span> handlers: - url: /favicon.ico static_files: favicon.ico upload: favicon.ico</code> </pre> </div></div><br><div class="spoiler">  <b class="spoiler_title">default.yaml</b> <div class="spoiler_text"><pre> <code class="bash hljs">application: penguin-daycare-simulator module: default version: 1 runtime: go api_version: go1 automatic_scaling: max_concurrent_requests: 500 handlers: - url: /.* script: _go_app</code> </pre> </div></div><br>  Note that in the <code>static.yaml</code> runtime Python is specified, not Go.  This is done because GAE swears if you try to upload a module to Go without the Go files themselves.  However, he does not swear in Python and PHP in this situation. <br><div class="spoiler">  <b class="spoiler_title">off topic</b> <div class="spoiler_text">  The attentive reader here may argue that ‚Äúthe worse PHP is for Python to upload static files‚Äù and try to unleash holywar, but Python is closer to me personally, that's why I chose it.  Anyone else can use PHP for this purpose.  Of course, this is all meaningless, since neither Python nor PHP are involved in this process. <br></div></div><br>  <code>handlers</code> in <code>default.yaml</code> indicate which executable files are handled by specific URLs.  In our case, app.go handles all incoming requests (taking into account <code>dispatch.yaml</code> ).  Description URL is very flexible, uses regular expressions.  However, if for Python and PHP you can use different files to process different URLs within a single module, then for Go it should be one single file, which is designated as "_go_app".  Further, already inside the program on Go, you can select handlers for different URLs and split the entire application into several files, if necessary. <br><br>  More about configuration and yaml files can be read <a href="https://developers.google.com/appengine/docs/go/config/appconfig">here</a> . <br><br>  <code>penguins.json</code> is a JSON file containing the names and descriptions of all the penguins used. <br><div class="spoiler">  <b class="spoiler_title">penguins.json</b> <div class="spoiler_text"><pre> <code class="bash hljs">[ {<span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"1"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Tux"</span></span>, <span class="hljs-string"><span class="hljs-string">"bio"</span></span>: <span class="hljs-string"><span class="hljs-string">"Beloved Linux mascot"</span></span> }, {<span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"2"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Skipper"</span></span>, <span class="hljs-string"><span class="hljs-string">"bio"</span></span>: <span class="hljs-string"><span class="hljs-string">"Small combat squad leader"</span></span> }, {<span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"3"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Lolo"</span></span>, <span class="hljs-string"><span class="hljs-string">"bio"</span></span>: <span class="hljs-string"><span class="hljs-string">"Russian adventurer"</span></span> }, {<span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"4"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"Gunter"</span></span>, <span class="hljs-string"><span class="hljs-string">"bio"</span></span>: <span class="hljs-string"><span class="hljs-string">"The darkest character in Adventure Time"</span></span> }, {<span class="hljs-string"><span class="hljs-string">"id"</span></span>: <span class="hljs-string"><span class="hljs-string">"5"</span></span>, <span class="hljs-string"><span class="hljs-string">"name"</span></span>: <span class="hljs-string"><span class="hljs-string">"The Penguin"</span></span>, <span class="hljs-string"><span class="hljs-string">"bio"</span></span>: <span class="hljs-string"><span class="hljs-string">"Na, na, na, na, na, na, na, na, na, na... The Penguin! "</span></span> } ]</code> </pre> </div></div><br>  Adding, editing penguins occurs through this file. <br><br>  Now we come to <code>app.go</code> - the heart of the entire application.  It is convenient to look at the full listing immediately on GitHub - <a href="">app.go.</a> <br><br>  The simplified structure of this file is: <br><pre> <code class="bash hljs">package app    . import (...)   : Id, , , . <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> penguin struct {...}  ()  . var penguins []penguin     . <span class="hljs-built_in"><span class="hljs-built_in">type</span></span> penguinEntity struct {...} . func <span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">init</span></span></span></span>() {...}  penguins.json   penguins. func <span class="hljs-function"><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">loadPenguinsJson</span></span></span></span>() {...}  / -   . func rootHandler(w http.ResponseWriter, r *http.Request) {...}  /penguins -        JSON. func penguinsHandler(w http.ResponseWriter, r *http.Request) {...}   /<span class="hljs-built_in"><span class="hljs-built_in">stat</span></span>/visit -  . func visitHandler(w http.ResponseWriter, r *http.Request) {...}   /<span class="hljs-built_in"><span class="hljs-built_in">stat</span></span>/fish -   . func fishHandler(w http.ResponseWriter, r *http.Request) {...}   /<span class="hljs-built_in"><span class="hljs-built_in">stat</span></span>/bellyrub -    . func bellyrubHandler(w http.ResponseWriter, r *http.Request) {...}</code> </pre> <br>  When you start the application, the init () function is started first, which reads from the penguins.json file and sets which function is responsible for different requests from the client.  You could already use them on the links at the beginning of the article. <br><br>  <code>penguinsHandler()</code> serializes the penguins slice into JSON format <code>json.Marshal()</code> function and gives it to clients via <code>fmt.Fprint()</code> . <br><br>  <code>visitHandler()</code> , <code>fishHandler()</code> , <code>bellyrubHandler()</code> act according to the same logic - we take the penguin from the database, increment the corresponding parameter by one and write it back to the database.  The database - <a href="https://developers.google.com/appengine/docs/go/datastore/">Datastore</a> - is not SQL compatible, that is, it is a NoSQL solution.  The description of her work is worthy of a separate article. <br><br>  Since many operations on GAE are charged separately, including access to Datastore, you should avoid unnecessary use of resources.  For example, when requesting statistics for all penguins, it is not necessary to provide relevant data.  You can cache this query with a cache lifetime of say 10 minutes.  To do this, I entered the additional variable <code>lastUpdateTime</code> - the timestamp of the last update of the <code>penguins</code> slice.  And with each query <code>/penguins</code> I call the <code>updatePenguinsStatistics()</code> function, which checks whether the cache has expired and updates the counter readings for each penguin in the <code>penguins</code> slice. <br><br>  To force an update manually, I added an additional request <a href="http://penguin-daycare-simulator.appspot.com/update">/ update</a> and the corresponding <code>updateHandler()</code> handler. <br><br>  Each request is processed in its own goroutine, so you need to protect the <code>penguins</code> slice from possible simultaneous recording or reading while writing.  <code>RWMutex</code> is used for this - read or write mutex.  Its use is more efficient than simple <code>Mutex</code> . <br><br>  To avoid paid consumption of resources, you can also enter a deferred entry into the database, accumulating the values ‚Äã‚Äãof all incoming events. <br><br>  To upload a project to the GAE server, you need to execute three commands in the terminal in the project directory: <br><pre> <code class="bash hljs">goapp deploy default/default.yaml goapp deploy static/static.yaml appcfg.py update_dispatch .</code> </pre><br>  In the future, when changing app.go, you only need to run <code>goapp deploy default/default.yaml</code> . <br><br>  In conclusion about the server part, I‚Äôll say that in order to increase free limits I recommend connecting paid billing, but at the same time set the maximum cost per day equal to $ 1.  However, some free quotas are increasing, and you still do not spend anything. <br><br><h4>  7. Client part - Corona SDK </h4><br>  Corona SDK is a cross-platform framework for developing mobile applications for Android, iOS, Windows Phone (soon) and HTML5 (in development).  I have been using this product for quite some time now, writing games both for clients as a freelancer and for myself.  I note a decent speed and speed of creating applications. <br><br>  Let's start also with the project file structure.  There are more files here, mainly due to the icons and pictures, so I'm cleaning up under the spoiler. <br><div class="spoiler">  <b class="spoiler_title">file structure</b> <div class="spoiler_text"><pre> <code class="bash hljs">PenguinDaycareSimulator/ ‚îú‚îÄ‚îÄ images/ ‚îÇ  ‚îú‚îÄ‚îÄ penguins/ ‚îÇ  ‚îÇ  ‚îú‚îÄ‚îÄ 1.png ‚îÇ  ‚îÇ  ‚îú‚îÄ‚îÄ 1@2x.png ‚îÇ  ‚îÇ  ‚îú‚îÄ‚îÄ 2.png ‚îÇ  ‚îÇ  ‚îú‚îÄ‚îÄ 2@2x.png ‚îÇ  ‚îÇ  ‚îú‚îÄ‚îÄ 3.png ‚îÇ  ‚îÇ  ‚îú‚îÄ‚îÄ 3@2x.png ‚îÇ  ‚îÇ  ‚îú‚îÄ‚îÄ 4.png ‚îÇ  ‚îÇ  ‚îú‚îÄ‚îÄ 4@2x.png ‚îÇ  ‚îÇ  ‚îú‚îÄ‚îÄ 5.png ‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ 5@2x.png ‚îÇ  ‚îú‚îÄ‚îÄ background.jpg ‚îÇ  ‚îú‚îÄ‚îÄ background@2x.jpg ‚îÇ  ‚îú‚îÄ‚îÄ button-over.png ‚îÇ  ‚îú‚îÄ‚îÄ button-over@2x.png ‚îÇ  ‚îú‚îÄ‚îÄ button.png ‚îÇ  ‚îú‚îÄ‚îÄ button@2x.png ‚îÇ  ‚îú‚îÄ‚îÄ dot-off.png ‚îÇ  ‚îú‚îÄ‚îÄ dot-off@2x.png ‚îÇ  ‚îú‚îÄ‚îÄ dot.png ‚îÇ  ‚îú‚îÄ‚îÄ dot@2x.png ‚îÇ  ‚îú‚îÄ‚îÄ fish.png ‚îÇ  ‚îú‚îÄ‚îÄ fish@2x.png ‚îÇ  ‚îú‚îÄ‚îÄ hand.png ‚îÇ  ‚îú‚îÄ‚îÄ hand@2x.png ‚îÇ  ‚îú‚îÄ‚îÄ popup.png ‚îÇ  ‚îî‚îÄ‚îÄ popup@2x.png ‚îú‚îÄ‚îÄ lib/ ‚îÇ  ‚îú‚îÄ‚îÄ api.lua ‚îÇ  ‚îú‚îÄ‚îÄ app.lua ‚îÇ  ‚îî‚îÄ‚îÄ utils.lua ‚îú‚îÄ‚îÄ scenes/ ‚îÇ  ‚îú‚îÄ‚îÄ choose.lua ‚îÇ  ‚îú‚îÄ‚îÄ menu.lua ‚îÇ  ‚îî‚îÄ‚îÄ penguin.lua ‚îú‚îÄ‚îÄ Default-568h@2x.png ‚îú‚îÄ‚îÄ Icon-60.png ‚îú‚îÄ‚îÄ Icon-60@2x.png ‚îú‚îÄ‚îÄ Icon-72.png ‚îú‚îÄ‚îÄ Icon-72@2x.png ‚îú‚îÄ‚îÄ Icon-76.png ‚îú‚îÄ‚îÄ Icon-76@2x.png ‚îú‚îÄ‚îÄ Icon-Small-40.png ‚îú‚îÄ‚îÄ Icon-Small-40@2x.png ‚îú‚îÄ‚îÄ Icon-Small-50.png ‚îú‚îÄ‚îÄ Icon-Small-50@2x.png ‚îú‚îÄ‚îÄ Icon-Small.png ‚îú‚îÄ‚îÄ Icon-Small@2x.png ‚îú‚îÄ‚îÄ Icon-hdpi.png ‚îú‚îÄ‚îÄ Icon-ldpi.png ‚îú‚îÄ‚îÄ Icon-mdpi.png ‚îú‚îÄ‚îÄ Icon-ouya.png ‚îú‚îÄ‚îÄ Icon-xhdpi.png ‚îú‚îÄ‚îÄ Icon-xxhdpi.png ‚îú‚îÄ‚îÄ Icon.png ‚îú‚îÄ‚îÄ Icon@2x.png ‚îú‚îÄ‚îÄ build.settings ‚îú‚îÄ‚îÄ config.lua ‚îî‚îÄ‚îÄ main.lua</code> </pre> </div></div><br>  You can still pay attention only to Lua files. <br><br>  <code>config.lua</code> , <code>build.settings</code> - project configuration files for Corona SDK.  Specify a portrait or landscape view has the application, the reference screen resolution, zoom method and other different settings.  If the Corona SDK is new to you, you can ignore these files for now. <br><br>  Also at the root you will find a bunch of icons for iOS and Android, plus <code>Default-568h@2x.png</code> for iPhone 5 to work correctly. Inside the images / directory there are regular files and their doubled HD versions <code>@2x</code> .  Now, in principle, it is already possible not to support devices with screens like the iPhone 3GS, their percentage is very small, but nonetheless non-zero.  To fully support the iPad Retina, you will already need <code>@4x</code> files and a line in <code>config.lua</code> , but most games work fine. <br><br>  Corona SDK launches the application starting from the <code>main.lua</code> file, the necessary libraries are connected to it, some variables are declared and a transition to the stage with the Enter the Daycare button takes place.  All scenes (screens) of the application are stored in different files and collected in the <code>scenes/</code> directory, and I placed all user libraries in <code>lib/</code> .  The developer is free to place these files as he wants, I prefer so. <br><br>  <code>lib/</code> contains <code>app.lua</code> and <code>utils.lua</code> - together this is my collection of useful functions for working with the Corona SDK.  In <code>app.lua</code> , convenient wrappers are implemented over the standard Corona SDK functions for displaying images, text, buttons, etc. <br><br>  The transition from <code>main.lua</code> to <code>scenes/menu.lua</code> done through the line <br><pre> <code class="lua hljs">storyboard.gotoScene(<span class="hljs-string"><span class="hljs-string">'scenes.menu'</span></span>)</code> </pre> <br>  Where, in turn, the penguin request is already running on the server.  Here is the main piece of code from <code>menu.lua</code> . <br><pre> <code class="lua hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">scene:createScene</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(event)</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> group = self.view app.newText{g = group, text = <span class="hljs-string"><span class="hljs-string">'Penguin Daycare'</span></span>, size = <span class="hljs-number"><span class="hljs-number">32</span></span>, x = _CX, y = _CY - <span class="hljs-number"><span class="hljs-number">150</span></span>} app.newText{g = group, text = <span class="hljs-string"><span class="hljs-string">'Simulator'</span></span>, size = <span class="hljs-number"><span class="hljs-number">32</span></span>, x = _CX, y = _CY - <span class="hljs-number"><span class="hljs-number">110</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> pleaseWait = app.newText{g = group, text = <span class="hljs-string"><span class="hljs-string">'Please Wait'</span></span>, size = <span class="hljs-number"><span class="hljs-number">16</span></span>, x = _CX, y = _CY} <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> button = app.newButton{g = group, x = _CX, y = _CY, text = <span class="hljs-string"><span class="hljs-string">'Enter the Daycare'</span></span>, onRelease = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> storyboard.gotoScene(<span class="hljs-string"><span class="hljs-string">'scenes.choose'</span></span>, {effect = <span class="hljs-string"><span class="hljs-string">'slideLeft'</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">time</span></span> = app.duration}) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>} button.isVisible = <span class="hljs-literal"><span class="hljs-literal">false</span></span> app.api:getPenguins(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> pleaseWait.isVisible = <span class="hljs-literal"><span class="hljs-literal">false</span></span> button.isVisible = <span class="hljs-literal"><span class="hljs-literal">true</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br>  Three lines of text and one button are created.  The button is hidden until we get a response from the server.  The request itself is executed by the <code>app.api:getPenguins()</code> function, with a callback function as its argument. <br><br>  After clicking on the button, we get to the scene of the penguin selection, also give only the main part of the code from the file <code>choose.lua</code> . <br><pre> <code class="lua hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">scene:createScene</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(event)</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> group = self.view self.backButton = app.newButton{g = group, x = _L + <span class="hljs-number"><span class="hljs-number">10</span></span>, y = _T + <span class="hljs-number"><span class="hljs-number">10</span></span>, w = <span class="hljs-number"><span class="hljs-number">48</span></span>, h = <span class="hljs-number"><span class="hljs-number">32</span></span>, rp = <span class="hljs-string"><span class="hljs-string">'TopLeft'</span></span>, text = <span class="hljs-string"><span class="hljs-string">'Back'</span></span>, fontSize = <span class="hljs-number"><span class="hljs-number">14</span></span>, onRelease = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> storyboard.gotoScene(<span class="hljs-string"><span class="hljs-string">'scenes.menu'</span></span>, {effect = <span class="hljs-string"><span class="hljs-string">'slideRight'</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">time</span></span> = app.duration}) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">gotoPenguin</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ind)</span></span></span></span> storyboard.gotoScene(<span class="hljs-string"><span class="hljs-string">'scenes.penguin'</span></span>, {effect = <span class="hljs-string"><span class="hljs-string">'slideLeft'</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">time</span></span> = app.duration, params = ind}) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> slideView = newSlideView{g = group, x = <span class="hljs-number"><span class="hljs-number">0</span></span>, y = _CY, dots_y = <span class="hljs-number"><span class="hljs-number">180</span></span>, onRelease = gotoPenguin} <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span>, #app.api.penguins <span class="hljs-keyword"><span class="hljs-keyword">do</span></span> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> p = app.api.penguins[i] <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> slide = display.newGroup() app.newImage(<span class="hljs-string"><span class="hljs-string">'images/popup.png'</span></span>, {g = slide, w = <span class="hljs-number"><span class="hljs-number">300</span></span>, h = <span class="hljs-number"><span class="hljs-number">335</span></span>}) app.newImage(<span class="hljs-string"><span class="hljs-string">'images/penguins/'</span></span> .. p.id .. <span class="hljs-string"><span class="hljs-string">'.png'</span></span>, {g = slide, w = <span class="hljs-number"><span class="hljs-number">200</span></span>, h = <span class="hljs-number"><span class="hljs-number">256</span></span>}) app.newText{g = slide, x = <span class="hljs-number"><span class="hljs-number">0</span></span>, y = <span class="hljs-number"><span class="hljs-number">-140</span></span>, text = p.name, size = <span class="hljs-number"><span class="hljs-number">18</span></span>, color = <span class="hljs-string"><span class="hljs-string">'white'</span></span>} app.newText{g = slide, x = <span class="hljs-number"><span class="hljs-number">0</span></span>, y = <span class="hljs-number"><span class="hljs-number">140</span></span>, text = p.bio, size = <span class="hljs-number"><span class="hljs-number">14</span></span>, color = <span class="hljs-string"><span class="hljs-string">'white'</span></span>, w = <span class="hljs-number"><span class="hljs-number">220</span></span>, align = <span class="hljs-string"><span class="hljs-string">'center'</span></span>} slideView:addSlide(slide) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> slideView:makeDots() slideView:gotoSlide(<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br>  Here, <code>newSlideView()</code> is a function that creates a simple widget with which you can scroll through slides with penguins.  The code for this widget is located right at <code>choose.lua</code> at the beginning of the file. <br><br>  A slide is created for each penguin.  Images of penguins are stored inside the application and correspond to the penguin Id.  This case can be fixed by storing images on the GAE server or any other.  To upload images from the network to the Corona SDK, there is a <code>display.loadRemoteImage()</code> function or a lower-level <code>network.download()</code> . <br><br>  By clicking on the slide, the <code>gotoPenguin()</code> function is <code>gotoPenguin()</code> , which receives the number (not <code>Id</code> ) of the penguin in the array (table) of all the penguins obtained.  This function makes the transition to the final scene of <code>penguin.lua</code> , passing the same argument to this scene. <br><div class="spoiler">  <b class="spoiler_title">penguin.lua</b> <div class="spoiler_text"><pre> <code class="lua hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">scene:createScene</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(event)</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> group = self.view <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> background = app.newImage(<span class="hljs-string"><span class="hljs-string">'images/background.jpg'</span></span>, {g = group, w = <span class="hljs-number"><span class="hljs-number">384</span></span>, h = <span class="hljs-number"><span class="hljs-number">640</span></span>, x = _CX, y = _CY}) self.backButton = app.newButton{g = group, x = _L + <span class="hljs-number"><span class="hljs-number">10</span></span>, y = _T + <span class="hljs-number"><span class="hljs-number">10</span></span>, w = <span class="hljs-number"><span class="hljs-number">48</span></span>, h = <span class="hljs-number"><span class="hljs-number">32</span></span>, rp = <span class="hljs-string"><span class="hljs-string">'TopLeft'</span></span>, text = <span class="hljs-string"><span class="hljs-string">'Back'</span></span>, fontSize = <span class="hljs-number"><span class="hljs-number">14</span></span>, onRelease = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> storyboard.gotoScene(<span class="hljs-string"><span class="hljs-string">'scenes.choose'</span></span>, {effect = <span class="hljs-string"><span class="hljs-string">'slideRight'</span></span>, <span class="hljs-built_in"><span class="hljs-built_in">time</span></span> = app.duration}) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> ind = event.params <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> p = app.api.penguins[ind] <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> visitsLabel = app.newText{g = group, x = _CX, y = _T + <span class="hljs-number"><span class="hljs-number">20</span></span>, text = <span class="hljs-string"><span class="hljs-string">'Visits: '</span></span> .. p.visit_count, size = <span class="hljs-number"><span class="hljs-number">18</span></span>, color = <span class="hljs-string"><span class="hljs-string">'white'</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> fishLabel = app.newText{g = group, x = _CX, y = _T + <span class="hljs-number"><span class="hljs-number">40</span></span>, text = <span class="hljs-string"><span class="hljs-string">'Fish: '</span></span> .. p.fish_count, size = <span class="hljs-number"><span class="hljs-number">18</span></span>, color = <span class="hljs-string"><span class="hljs-string">'white'</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> bellyrubsLabel = app.newText{g = group, x = _CX, y = _T + <span class="hljs-number"><span class="hljs-number">60</span></span>, text = <span class="hljs-string"><span class="hljs-string">'Belly rubs: '</span></span> .. p.bellyrub_count, size = <span class="hljs-number"><span class="hljs-number">18</span></span>, color = <span class="hljs-string"><span class="hljs-string">'white'</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> penguin = app.newImage(<span class="hljs-string"><span class="hljs-string">'images/penguins/'</span></span> .. p.id .. <span class="hljs-string"><span class="hljs-string">'.png'</span></span>, {g = group, w = <span class="hljs-number"><span class="hljs-number">200</span></span>, h = <span class="hljs-number"><span class="hljs-number">256</span></span>, x = _CX, y = _CY - <span class="hljs-number"><span class="hljs-number">25</span></span>}) app.newButton{g = group, x = _CX - <span class="hljs-number"><span class="hljs-number">80</span></span>, y = _B - <span class="hljs-number"><span class="hljs-number">50</span></span>, w = <span class="hljs-number"><span class="hljs-number">128</span></span>, h = <span class="hljs-number"><span class="hljs-number">48</span></span>, text = <span class="hljs-string"><span class="hljs-string">'Fish'</span></span>, fontSize = <span class="hljs-number"><span class="hljs-number">14</span></span>, onRelease = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> fish = app.newImage(<span class="hljs-string"><span class="hljs-string">'images/fish.png'</span></span>, {g = group, x = penguin.x, y = penguin.y + <span class="hljs-number"><span class="hljs-number">200</span></span>, w = <span class="hljs-number"><span class="hljs-number">512</span></span>, h = <span class="hljs-number"><span class="hljs-number">188</span></span>}) fish.alpha = <span class="hljs-number"><span class="hljs-number">0.8</span></span> transition.to(fish, {<span class="hljs-built_in"><span class="hljs-built_in">time</span></span> = <span class="hljs-number"><span class="hljs-number">400</span></span>, alpha = <span class="hljs-number"><span class="hljs-number">1</span></span>, y = penguin.y, xScale = <span class="hljs-number"><span class="hljs-number">0.1</span></span>, yScale = <span class="hljs-number"><span class="hljs-number">0.1</span></span>, transition = easing.outExpo, onComplete = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(obj)</span></span></span></span> transition.to(fish, {<span class="hljs-built_in"><span class="hljs-built_in">time</span></span> = <span class="hljs-number"><span class="hljs-number">400</span></span>, alpha = <span class="hljs-number"><span class="hljs-number">0</span></span>, onComplete = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(obj)</span></span></span></span> display.<span class="hljs-built_in"><span class="hljs-built_in">remove</span></span>(obj) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>}) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>}) app.api:sendFish(p.id) p.fish_count = p.fish_count + <span class="hljs-number"><span class="hljs-number">1</span></span> fishLabel:setText(<span class="hljs-string"><span class="hljs-string">'Fish: '</span></span> .. p.fish_count) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>} app.newButton{g = group, x = _CX + <span class="hljs-number"><span class="hljs-number">80</span></span>, y = _B - <span class="hljs-number"><span class="hljs-number">50</span></span>, w = <span class="hljs-number"><span class="hljs-number">128</span></span>, h = <span class="hljs-number"><span class="hljs-number">48</span></span>, text = <span class="hljs-string"><span class="hljs-string">'Belly rub'</span></span>, fontSize = <span class="hljs-number"><span class="hljs-number">14</span></span>, onRelease = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> hand = app.newImage(<span class="hljs-string"><span class="hljs-string">'images/hand.png'</span></span>, {g = group, x = penguin.x - <span class="hljs-number"><span class="hljs-number">40</span></span>, y = penguin.y + <span class="hljs-number"><span class="hljs-number">30</span></span>, w = <span class="hljs-number"><span class="hljs-number">80</span></span>, h = <span class="hljs-number"><span class="hljs-number">80</span></span>, rp = <span class="hljs-string"><span class="hljs-string">'TopLeft'</span></span>}) transition.to(hand, {<span class="hljs-built_in"><span class="hljs-built_in">time</span></span> = <span class="hljs-number"><span class="hljs-number">1200</span></span>, x = penguin.x + <span class="hljs-number"><span class="hljs-number">40</span></span>, transition = easing.swing3(easing.outQuad), onComplete = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(obj)</span></span></span></span> display.<span class="hljs-built_in"><span class="hljs-built_in">remove</span></span>(obj) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>}) app.api:sendBellyrub(p.id) p.bellyrub_count = p.bellyrub_count + <span class="hljs-number"><span class="hljs-number">1</span></span> bellyrubsLabel:setText(<span class="hljs-string"><span class="hljs-string">'Belly rubs: '</span></span> .. p.bellyrub_count) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>} app.api:sendVisit(p.id) p.visit_count = p.visit_count + <span class="hljs-number"><span class="hljs-number">1</span></span> visitsLabel:setText(<span class="hljs-string"><span class="hljs-string">'Visits: '</span></span> .. p.visit_count) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> </div></div><br>  In <code>penguin.lua</code> , the background image, the image of the selected penguin is loaded, several text labels and two action buttons are displayed.  When you click on them, the action is animated and the request is sent to the server through the <code>app.api:sendFish()</code> and <code>app.api:sendBellyrub()</code> .  And <code>app.api:sendVisit()</code> is called immediately after creating the scene.  After calling each of these functions, the corresponding text labels are updated, even if there is no Internet.  This can be corrected by entering a check for receiving a response from the server for each request and providing callback functions. <br><br>  Finally, all work with the server is carried out in the file <code>lib/api.lua</code> . <br><div class="spoiler">  <b class="spoiler_title">api.lua</b> <div class="spoiler_text"><pre> <code class="lua hljs"><span class="hljs-keyword"><span class="hljs-keyword">local</span></span> _M = {} <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> app = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'lib.app'</span></span>) _M.hostname = <span class="hljs-string"><span class="hljs-string">'http://penguin-daycare-simulator.appspot.com'</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_M:getPenguins</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(callback)</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> url = <span class="hljs-string"><span class="hljs-string">'/penguins#'</span></span> .. <span class="hljs-built_in"><span class="hljs-built_in">math</span></span>.<span class="hljs-built_in"><span class="hljs-built_in">random</span></span>(<span class="hljs-number"><span class="hljs-number">1000</span></span>, <span class="hljs-number"><span class="hljs-number">9999</span></span>) network.request(self.hostname .. url , <span class="hljs-string"><span class="hljs-string">'GET'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(event)</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> event.isError <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> response = json.decode(event.response) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> response <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> self.penguins = response callback() <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_M:sendVisit</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(id)</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> url = <span class="hljs-string"><span class="hljs-string">'/stat/visit'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> request = {body = <span class="hljs-string"><span class="hljs-string">'id='</span></span> .. id} network.request(self.hostname .. url , <span class="hljs-string"><span class="hljs-string">'POST'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(event)</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> event.isError <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> app.alert(<span class="hljs-string"><span class="hljs-string">'Network error'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>, request) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_M:sendFish</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(id)</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> url = <span class="hljs-string"><span class="hljs-string">'/stat/fish'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> request = {body = <span class="hljs-string"><span class="hljs-string">'id='</span></span> .. id} network.request(self.hostname .. url , <span class="hljs-string"><span class="hljs-string">'POST'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(event)</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> event.isError <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> app.alert(<span class="hljs-string"><span class="hljs-string">'Network error'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>, request) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_M:sendBellyrub</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(id)</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> url = <span class="hljs-string"><span class="hljs-string">'/stat/bellyrub'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">local</span></span> request = {body = <span class="hljs-string"><span class="hljs-string">'id='</span></span> .. id} network.request(self.hostname .. url , <span class="hljs-string"><span class="hljs-string">'POST'</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(event)</span></span></span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> event.isError <span class="hljs-keyword"><span class="hljs-keyword">then</span></span> app.alert(<span class="hljs-string"><span class="hljs-string">'Network error'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">end</span></span>, request) <span class="hljs-keyword"><span class="hljs-keyword">end</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> _M</code> </pre> </div></div><br>  As you might guess, working with the server is done by simple POST requests.  In the case of <code>getPenguins()</code> , the response from the server is converted from JSON format to an array (table) by the <code>json.decode()</code> function and placed in the field (property) of the module. <br><br>  As you can see, it is very easy to send POST requests and respond to their responses in the Corona SDK.  Accordingly, the very simple integration with Google App Engine came out.  I do not describe what each line does, I hope the syntax is intuitive. <br><br><h4>  8. References </h4><br>  The sources are on my GitHub: <br><ul><li>  Google App Engine - <a href="https://github.com/Lerg/PenguinDaycareSimulatorServer">github.com/Lerg/PenguinDaycareSimulatorServer</a> </li><li>  Corona SDK - <a href="https://github.com/Lerg/PenguinDaycareSimulator">github.com/Lerg/PenguinDaycareSimulator</a> </li></ul><br>  You can install the client on Android 2.3.3+, here is the <a href="">APK</a> ( <a href="">mirror</a> ). <br>  Either download the Corona SDK, download the source from GitHub and launch it in the Corona Simulator. <br><br>  <a href="https://habrahabr.ru/users/m0sth8/" class="user_link">M0sTH8</a>     . <br><br>     <a href="https://twitter.com/SergeyLerg">@SergeyLerg</a> <br><br>  That's all.  Thanks for attention! </div><p>Source: <a href="https://habr.com/ru/post/220031/">https://habr.com/ru/post/220031/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../220019/index.html">HD FPV on Raspberry Pi</a></li>
<li><a href="../220021/index.html">From the IT preacher to the designer of medical robots: future professions in IT and robotics</a></li>
<li><a href="../220023/index.html">Use of encryption in Russian companies</a></li>
<li><a href="../220025/index.html">Secure payment card do it yourself</a></li>
<li><a href="../220027/index.html">Who does BillGates attack?</a></li>
<li><a href="../220033/index.html">The digest of interesting materials from the world of web development and IT for the last week ‚Ññ105 (April 13 - 19, 2014)</a></li>
<li><a href="../220035/index.html">Google‚Äôs Universal Analytics came out of Beta and is available at Funding.To</a></li>
<li><a href="../220037/index.html">Ruby on Rails Developer Competency Matrix</a></li>
<li><a href="../220041/index.html">Family stories, dining table and sales growth</a></li>
<li><a href="../220043/index.html">MetaPhone: the importance of phone metadata</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>