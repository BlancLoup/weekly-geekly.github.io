<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Place a layer with traffic jams on our J.Map map</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The Yandex.Maps API currently does not allow ‚Äúautomatically‚Äù mapping a layer with traffic jams ( UPD : meaning the officially documented method, accom...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Place a layer with traffic jams on our J.Map map</h1><div class="post__text post__text-html js-mediator-article">  The Yandex.Maps API currently does not allow ‚Äúautomatically‚Äù mapping a layer with traffic jams ( <b>UPD</b> : meaning the officially documented method, accompanying controls, etc ...) However, this problem is still solved quite simply using API. <br><br>  The API has methods for <a href="">placing</a> its own <a href="">layer</a> on the map.  The map layer is characterized by the source of tiles ( <a href="">YMaps.TileDataSource</a> ).  To create a source, you must specify a URL pattern with tiles. <br><br><h3>  Tile source </h3><br>  The first problem is to find out the source address used by Ya.karty.  It is easy to solve - we look at the map with traffic jams using FireBug and see at the very top &lt;img /&gt; with [src = http: //trf.maps.yandex.net/tiles? L = trf &amp; x = 2500 &amp; y = 1244 &amp; z = 12 &amp; tm = 1267986241] Here x, y and z are tile coordinates and map zoom information.  tm - time stamp for which data on traffic are given.  Without the tm parameter, the tile server gives 404 ... <br><a name="habracut"></a><br><h3>  Traffic updates </h3><br>  The second problem is to find out the current time stamp for which traffic jams are given.  Let's use FireBug again. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      You can find a request to the address of <a href="">trf.maps.yandex.net/trf/stat.js</a> in the exchange log with the server <a href="">.</a> In response, a script comes with a call to YMaps.TrafficLoader.onLoad ('stat', "JSON_packed_data");  Inside the data transmitted by the second argument, there is a timestamp parameter that coincides with the current tm parameter when loading tiles.  PROFIT! <br><br>  <a href="http://maps.yandex.ru/">On the main Ya. Map,</a> YMaps.TrafficLoader is defined, on a normal page with a map - no. <br><br>  As a result, code was written that defines the YMaps.TrafficLoader object, the onLoad method in it and uses the obtained information to create a new layer, a TileDataSource for it, and add a layer to the map.  Data is updated every 5 minutes. <br><br>  <a href="">Download traffic.js</a> . <br><br>  You need to connect after loading the API, before loading the code that creates the map on your page.  In the map initialization code, you need to call YMaps.TrafficLoader.init (mapObject), where mapObject is the instance of <a href="">YMaps.Map</a> containing your map.  In my <a href="">case, I invoke</a> initialization on the event <a href="">geocoder.Events.Load</a> . <br><br>  <b>UPD</b> : Transferred from the Yandex blog to Web development. </div><p>Source: <a href="https://habr.com/ru/post/86857/">https://habr.com/ru/post/86857/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../86846/index.html">OAuth authorization using the example of Desktop Twitter client</a></li>
<li><a href="../86847/index.html">Data conversion, or deepening in Talent Open Studio</a></li>
<li><a href="../86848/index.html">Ribbon Development (‚ÄúWhy the Interface, Part 1)</a></li>
<li><a href="../86850/index.html">Soyuz Telecom plans in early April to begin providing WiMAX in seven locations in various regions and territories of Russia</a></li>
<li><a href="../86852/index.html">Parable about interception of errors</a></li>
<li><a href="../86860/index.html">Charged Trojan</a></li>
<li><a href="../86863/index.html">"Live" for communication with your site visitors</a></li>
<li><a href="../86864/index.html">Creative Future - the main creative rally of 2010</a></li>
<li><a href="../86865/index.html">40 creative menus (translation)</a></li>
<li><a href="../86866/index.html">Repair of power supplies from routers and other Asus and D-Link equipment in 10 minutes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>