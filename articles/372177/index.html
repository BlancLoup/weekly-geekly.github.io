<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Radio transmission using HackRF</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="HackRF is a unique device designed for enthusiasts and radio amateurs who are passionate about the study of radio signals and everything connected wit...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Radio transmission using HackRF</h1><div class="post__text post__text-html js-mediator-article">  HackRF is a unique device designed for enthusiasts and radio amateurs who are passionate about the study of radio signals and everything connected with it. <br><img src="https://habrastorage.org/files/827/ad7/1b1/827ad71b16464e74bfdeaef86bd2f0ea.jpg"><br>  The uniqueness of HackRF in its technical parameters - at a price of about $ 300, the device allows not only to receive, but also to transmit radio signals in the 1 MHz to 6 GHz band with a bandwidth of up to 20 MHz.  The use of HackRF is practically not covered in Habr√© and Hiktatimes, it's time to fill this gap. <br><br>  As for the reception of radio signals, everything is simple, and practically does not differ from the popular 10-dollar RTL-SDR, about which only the laziest did not write.  The necessary DLL is put, the program is started, in general, that's all.  Those who have not heard of such a ‚Äúmiracle‚Äù can read here on the site: <br>  <a href="https://habrahabr.ru/post/149698/">habrahabr.ru/post/149698</a> <br>  <a href="https://habrahabr.ru/post/149702/">habrahabr.ru/post/149702</a> <br>  <a href="https://habrahabr.ru/post/280454/">habrahabr.ru/post/280454</a> <br>  <a href="https://habrahabr.ru/post/200914/">habrahabr.ru/post/200914</a> <br><br>  With the reception, everything is quite simple and trivial, the technology is cheap and long-established.  With the transfer of all a bit more complicated.  What we now do. <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Low level -  /  ++ </h4><br>  The first way is to communicate directly with the device.  HackRF has a library with an open API, an example of its use can be found on the author‚Äôs website in the hackrf_transfer utility: <a href="">github.com/mossmann/hackrf/blob/master/host/hackrf-tools/src/hackrf_transfer.c</a> .  For those who have worked with a sound card at least once, the principle will be clear - a callback function is called a certain number of times per second, the buffer for which must be filled with data.  It would seem simple, but there is one ‚Äúbut‚Äù - HackRF is SDR.  Software Defined Radio.  This means that simply sending a WAV file to the buffer will not come out, nothing will be transmitted.  We must programmatically form an integrated (IQ) signal for the entire required receiver band, so that its DAC, in turn, sends ‚Äúthis‚Äù on the air.  It is also necessary to set a number of settings (frequency, gain, bandwidth), which can also be viewed in the source. <br><br>  HackRF supports work with various bandwidths, from 1 to 20 MHz, and this band needs to be formed programmatically.  We will not do this.  Mathematics is needed rather seriously, so let's go straight to the second method - using the GNU Radio package. <br><br><h4>  GNU Radio </h4><br>  GNU Radio is an open and free software package designed for digital signal processing for scientific, educational or commercial purposes.  The system consists of a large number of ready-made blocks that have an interface in Python, the blocks themselves are written in C ++.  GNU Radio also includes the GNURadio Companion visual editor, which allows you to visually connect blocks into a ready-made ‚Äúdevice‚Äù without using a programming language at all. <br><br>  So, install drivers for Hack RF, install GNU Radio (it can be installed on Linux or Mac OS, or downloaded as a Linux Live CD), run in the console ‚Äúgnuradio-companion‚Äù.  Now everything is ready, you can proceed to the transfer. <br><br>  Formally, HackRF can transmit anything within its bandwidth, for example, knowing the data transfer protocol, you can drive a radio-controlled machine or control the doorbell.  Consider the most trivial examples: amplitude (AM) and frequency (FM) modulation. <br><br><h5>  Frequency modulation </h5><br>  To transmit in FM mode, run gnuradio-companion and create such a graph in the program. <br><img src="https://habrastorage.org/files/cda/c5b/f6f/cdac5bf6f16f43bd9d951aeedbb871aa.png"><br><br>  Its structure is quite simple.  The WAV file with a sampling frequency of 44100 was selected as the source, the Multiply Const block multiplies the signal by 2 (the original sound was rather quiet), the next WBFM Transmit block and does all the ‚Äúmagic‚Äù - converts our real signal with a frequency of 44100 into a complex signal with a sampling frequency of 88200. The next Resampler block increases the sampling rate to the 2.4 MHz selected for this example.  The transmission frequency is set to 87.5 MHz, it was the lowest FM radio frequency supported by my smartphone, and it was free from FM stations. <br><br>  The result - we launch the graph in GNU Radio, the red TX LED lights up on HackRF, our file is heard in the smartphone. <br><br>  It is interesting to see how it really works.  In the GNU Radio console you can see the following output: <br>  Executing /opt/local/Library/Frameworks/Python.framework/Versions/2.7/Resources/Python.app/Contents/MacOS/Python -u /Users/XXXX/Documents/Projects/Gnuradio/top_block.py <br><br>  Its content is a finished program on Python that implements our program! <br><div class="spoiler">  <b class="spoiler_title">Source</b> <div class="spoiler_text"><pre><code class="python hljs"><span class="hljs-comment"><span class="hljs-comment">################################################## # GNU Radio Python Flow Graph # Title: Top Block # Generated: Sun May 1 18:29:52 2016 ################################################## if __name__ == '__main__': import ctypes import sys if sys.platform.startswith('linux'): try: x11 = ctypes.cdll.LoadLibrary('libX11.so') x11.XInitThreads() except: print "Warning: failed to XInitThreads()" from gnuradio import analog from gnuradio import blocks from gnuradio import eng_notation from gnuradio import filter from gnuradio import gr from gnuradio.eng_option import eng_option from gnuradio.filter import firdes from grc_gnuradio import wxgui as grc_wxgui from optparse import OptionParser import osmosdr import time import wx class top_block(grc_wxgui.top_block_gui): def __init__(self): grc_wxgui.top_block_gui.__init__(self, title="Top Block") ################################################## # Variables ################################################## self.samp_rate = samp_rate = 2.4e6 ################################################## # Blocks ################################################## self.rational_resampler_xxx_1 = filter.rational_resampler_ccc( interpolation=int(samp_rate), decimation=88200, taps=None, fractional_bw=None, ) self.osmosdr_sink_0 = osmosdr.sink( args="numchan=" + str(1) + " " + "" ) self.osmosdr_sink_0.set_sample_rate(samp_rate) self.osmosdr_sink_0.set_center_freq(87.5e6, 0) self.osmosdr_sink_0.set_freq_corr(6, 0) self.osmosdr_sink_0.set_gain(10, 0) self.osmosdr_sink_0.set_if_gain(30, 0) self.osmosdr_sink_0.set_bb_gain(20, 0) self.osmosdr_sink_0.set_antenna("", 0) self.osmosdr_sink_0.set_bandwidth(0, 0) self.blocks_wavfile_source_0 = blocks.wavfile_source("/Users/XXXX/Documents/Projects/sample.wav", True) self.blocks_multiply_const_vxx_0 = blocks.multiply_const_vff((2, )) self.analog_wfm_tx_0 = analog.wfm_tx( audio_rate=44100, quad_rate=88200, tau=75e-6, max_dev=75e3, ) ################################################## # Connections ################################################## self.connect((self.analog_wfm_tx_0, 0), (self.rational_resampler_xxx_1, 0)) self.connect((self.blocks_multiply_const_vxx_0, 0), (self.analog_wfm_tx_0, 0)) self.connect((self.blocks_wavfile_source_0, 0), (self.blocks_multiply_const_vxx_0, 0)) self.connect((self.rational_resampler_xxx_1, 0), (self.osmosdr_sink_0, 0)) def get_samp_rate(self): return self.samp_rate def set_samp_rate(self, samp_rate): self.samp_rate = samp_rate self.osmosdr_sink_0.set_sample_rate(self.samp_rate) def main(top_block_cls=top_block, options=None): tb = top_block_cls() tb.Start(True) tb.Wait() if __name__ == '__main__': main()</span></span></code> </pre> <br></div></div><br>  It can be saved in a separate folder and used as you like, modified, etc. This is quite convenient, since  allows for example, to add your UI, to make a launch on a schedule, in general, everything is limited only by the imagination of the programmer. <br><br>  We slightly modify the graph to start the program in the ‚Äúnarrow FM‚Äù mode, which is used in radios and baby monitors: <br><img src="https://habrastorage.org/files/a12/1f6/923/a121f69238ab4965bd032b2a32de8a1b.png"><br><br>  The difference is small - we installed the NBFM block, and the transmission frequency was set to 433.075 MHz - the first channel of the LPD-band.  Turn on the radio and hear the sound.  By the way, GNU Radio allows you to use as a source not only a WAV file, but also a microphone, so the program is easy to remake to transmit voice messages. <br><br><h5>  Amplitude modulation </h5><br>  For those who have left the grandmother's HF-range receiver (although at least a Degen 1103 or IC-R9500 is better, of course), it will be interesting to try the AM mode.  To do this, create the following graph: <br><img src="https://habrastorage.org/files/49d/d0e/4d6/49dd0e4d6170458c941351596080daf3.png"><br><br>  Here we use the Hilbert transform unit to convert data into a complex signal.  Otherwise, the essence has not changed, the signal is resampled to the desired sampling rate and sent to HackRF. <br><br><h5>  More SDR </h5><br>  Finally, we show that HackRF can do much more than just a walkie-talkie from the Svyaznoy with a price of 1000r.  This is a full-fledged Software Defined Radio, where you can transmit anything.  To show the ease of working with ‚Äúnumbers‚Äù in GNU Radio, we add the graph of FM translations so that HackRF broadcasts information simultaneously on 2 frequencies. <br><img src="https://habrastorage.org/files/6b4/a9f/db7/6b4a9fdb78bd42318b7225bbbac543fc.png"><br><br>  Here we add the second file, repeat the same structure.  But the data obtained is multiplied by a complex sinusoidal signal with a frequency of 125 kHz, which is equivalent to a frequency shift of these 125 kHz, as a result, the second data stream will be broadcast at a frequency of 433075 + 125 = 433200, which corresponds to the 6th LPD channel.  Now HackRF simultaneously transmits 2 audio files at 2 different frequencies.  You can add and 3rd, everything is limited only by the bandwidth and power of the computer. <br><br>  That's all.  Those interested in the topic of GNU Radio can find tutorials on the net, there are quite a lot of them. <br><br>  Finally.  HackRF is not a full-fledged radio station, its power is too low and is about 20mW, and the efficiency of a regular antenna is less than 1%.  It is rather a device for experimenting with signals in the ‚Äúnear zone‚Äù, within the office or apartment.  If someone wants to experiment with more powerful signals, you should definitely follow the rules of the distribution of the radio frequency spectrum, so as not to interfere with others. </div><p>Source: <a href="https://habr.com/ru/post/372177/">https://habr.com/ru/post/372177/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../372167/index.html">Controlling ventilation with the MT8057 carbon dioxide detector</a></li>
<li><a href="../372169/index.html">‚ÄúSmart Home‚Äù from Beltelecom. Part 1</a></li>
<li><a href="../372171/index.html">Inertial tracker based on Arduino and GY-85</a></li>
<li><a href="../372173/index.html">On Mars, they actually found the Beagle 2 probe missing 12 years ago.</a></li>
<li><a href="../372175/index.html">Test drive a new smartphone Xiaomi or How to save on a free Xiaomi Mi4S?</a></li>
<li><a href="../372179/index.html">New Half-Life Speed ‚Äã‚ÄãRecord 2: 41 minutes</a></li>
<li><a href="../372181/index.html">WhatsApp blocked for 100 million users in Brazil for 72 hours by decision of a provincial judge</a></li>
<li><a href="../372183/index.html">Solar electricity has fallen in price by 50% in the last 16 months</a></li>
<li><a href="../372185/index.html">Gadget Posting Tail turns a dog into a blogger</a></li>
<li><a href="../372187/index.html">Riders get the unfair advantage of a motorcycle from behind.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>