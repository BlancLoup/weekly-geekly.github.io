<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We work with notifications in Windows Phone 8.1</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello to all! 

 Today we will talk about new features related to notifications in Windows / Windows Phone 8.1. Let's discuss what types of notificati...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We work with notifications in Windows Phone 8.1</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/4f4/418/112/4f441811246740718e4d9068c9da2ae3.PNG"><br><br>  Hello to all! <br><br>  Today we will talk about new features related to <b>notifications</b> in Windows / Windows Phone 8.1.  Let's discuss what types of notifications exist, how to organize them in your application, and also note one of the main innovations for Windows Phone devices - the <b>Notification</b> Center <b>(Action Center)</b> . <br><a name="habracut"></a><br><h5>  Notifications </h5><br>  Notifications in Windows Phone is an important way for an application to interact with the user.  They help the user to learn about updating information in the application, notify him about the actions of other users or remind about the necessary activities. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Notifications can come from any service or locally from an application. <br><br>  In Windows / Windows Phone 8.1, there are several <b>ways to display</b> notifications: <br><br><img src="https://habrastorage.org/files/83d/34e/365/83d34e365fef476c8a6731118352cb56.png"><br><br>  The user can receive a notification in the form of information on the application tile or with the help of a small black icon. <br><br>  More information about the possibilities of <b>living tiles</b> can be found in the following <a href="http://channel9.msdn.com/Series/Building-Apps-for-Windows-Phone-8-1/14">course</a> . <br><br>  In addition to this, the following ways of displaying notifications are available: <br><ul><li>  <b>Toast - notifications</b> - when you receive this type of notification, a text notification appears at the top of the device screen.  At the same time, the application may currently be inactive.  By clicking on this message, you can quickly switch to the appropriate application. </li><li>  <b>Raw notifications</b> - with this type of notification, the content is transferred directly to the application.  The application processes the contents of the notification according to its own algorithm.  These notifications do not have their own UI.  Like other push notifications, the WNS service delivers them to an application from a cloud or any external service. </li></ul><br><h6>  Toast - notifications </h6><br>  To work with Toast notifications, you need to connect this way of displaying notifications in the <b>application manifest</b> .  We will not be able to send Toast notifications until we indicate that the application can send them. <br>  Fortunately, it is very simple - switch the appropriate setting in <b>Package.appxmanifest</b> to ‚ÄúYes‚Äù: <br><br><img src="https://habrastorage.org/files/a45/b3e/faa/a45b3efaafb14d6c990d536d5bd1c72f.png"><br><br>  We send a Toast notification using the following XML code: <br><pre><code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">toast</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">visual</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">binding</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">template</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ToastText04"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">text</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag">&gt;</span></span>headline text<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">text</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">text</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2"</span></span></span><span class="hljs-tag">&gt;</span></span>body text<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">text</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">binding</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">visual</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">toast</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Note that this XML schema is standard for any kind of notification. <br>  When you click on Toast - the user will be able to launch the application. <br><br>  For the Windows platform, there are as many as 8 display templates for Toast notifications, but on Windows Phone 8.1, they have only one fixed appearance, regardless of the template specified by the developer: <br><br><img src="https://habrastorage.org/files/cb1/54c/c98/cb154cc98b0f495b8fabbebb48ff98ef.png"><br><br>  However, the logic of the operation of Toast - notifications on both platforms <b>will be the same</b> . <br><br><h5>  Ways to implement notifications </h5><br>  For all Windows devices, there are several ways to implement the notification mechanism: <br><ul><li>  <b>Scheduled Notifications.</b>  Such notifications will queue up system tasks and run at a given fixed time; <br><br><img src="https://habrastorage.org/files/471/a1f/1c1/471a1f1c118a45d7ba98f7155c7d07ab.png"><br><br>  <b>How it works:</b> <br>  Inside the application, a notification scheduler API is used that accesses the system queue schedule.  The system checks the queue and at the time specified for the notification sends an update to the tile or Toast. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> scheduleToast = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ScheduledToastNotification( xmlDoc, DateTimeOffset.UtcNow + TimeSpan.FromDays(<span class="hljs-number"><span class="hljs-number">1.0</span></span>) ); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> toastNotify = ToastNotificationManager.CreateToastNotifier(); toastNotify.AddToSchedule(scheduleToast);</code> </pre><br><br>  Using the ScheduledToastNotification class, we create an object that is responsible for a scheduled notification, in which, using previously demonstrated XML code, we specify the content and set the time at which the notification should be displayed.  And using the ToastNotificationManager class, we create a toastNotify object for which the function of adding a notification to the AddToSchedule () system queue is implemented. </li><li>  <b>Periodic updates (Periodic)</b> - extract data for notifications from the specified URL and display them with the specified periodicity - once per hour / at 6 hours / at 12 hours; <br><br><img src="https://habrastorage.org/files/199/2b0/d12/1992b0d1278e4c20ba42c7bb49dd6277.png"><br><br>  <b>How it works:</b> <br>  In the application, we turn to Windows System Services, indicating that we need notifications at intervals of 0.5 / 6/12 hours.  These services, in turn, communicate with the tile and icon update API a certain number of times, using an HTTP request to receive XML notification data that can be sent to a tile or icon. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> periodic = TileUpdateManager.CreateTileUpdaterForApplication(); Uri myTileFeed = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Uri(<span class="hljs-string"><span class="hljs-string">"http://mysite.com/tileRSS.xml"</span></span>); periodic.StartPeriodicUpdate(myTileFeed, PeriodicUpdateRecurrence.Hour);</code> </pre><br><br>  Using the TileUpdateManager class, we create a periodic object that provides periodic tile updates.  Next, create the URI channel myTileFeed, to which the data for the notification in xml format will be translated.  An object of type PeriodicUpdateRecurrence allows you to set the required frequency of notifications coming from the myTileFeed channel. <br>  There is an easier way to implement periodic notifications using the Package.appxmanifest file settings: <br><br><img src="https://habrastorage.org/files/02e/cf6/166/02ecf61669424835b69c6f8a09d2e189.png"><br><br>  You only need to select the frequency and specify the URI channel. <br></li><li>  <b>Local application notifications (Local);</b> <br><br><img src="https://habrastorage.org/files/d0b/e74/17b/d0be7417b5dc4fd197581262248d39c5.png"><br><br>  <b>How it works:</b> <br>  The application uses updates of tiles and icons for notifications; in the background mode it already refers to the Toast API of notifications. <br><br><pre> <code class="cs hljs">BadgeNotification newBadge = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BadgeNotification(badgeDoc); BadgeUpdater update = BadgeUpdateManager.CreateBadgeUpdaterForApplication(); update.Update(newBadge);</code> </pre><br><br>  Create an icon using an object of the BadgeNotification type and the Update () function implemented for an object of the BadgeUpdater type, instantly updating the icon. <br></li></ul><br><br>  Below is a table of the possibility of using methods for implementing notifications depending on their type: <br><br><img src="https://habrastorage.org/files/592/14c/c48/59214cc4880747f1a1d4fba45cd67791.png"><br><br>  Let's not disregard the last way to implement notifications - <b>push notifications</b> .  Consider it in more detail. <br><br><h5>  Push notifications </h5><br>  Prior to the current release, for this type of notification in Windows 8.0 and Windows Phone 8.0, two different services were used: <b>Microsoft Push Notification Services (MPNS)</b> for phones and <b>Windows Notification Services (WNS)</b> for other Windows devices. <br><br>  However, now Push notifications for any Windows / Windows Phone 8.1 devices are implemented via WNS. <br><br>  What are the benefits for developers using WNS: <br><ul><li>  The same approach for any device on Windows; </li><li>  Unified application registration process for push notifications; </li><li>  Unified push notification template for Windows / Windows Phone 8.1 platforms. </li></ul><br><br>  <b>How it works:</b> <br><ol><li>  The Windows Phone 8.1 application communicates with the Windows Notification Client platform to obtain an application channel URI that is unique to each device and application; </li><li>  Further, the URI channel must be registered in the cloud service; </li><li>  The cloud service authenticates the WNS service by providing its data (SID packet and private key), and provides access that allows the service to send notifications.  Now you can send push notifications using this service; </li><li>  The cloud service, at the appropriate time, sends a push notification to the WNS service; </li><li>  WNS communicates with the Windows Notification Client platform, which updates any of the specified notification types. <br><br><img src="https://habrastorage.org/files/7f3/a69/a8d/7f3a69a8d59b4df4b8dcfd5884e1b9a9.png"><br></li></ol><br><br>  Read more about how the WNS service works <a href="http://msdn.microsoft.com/en-us/library/windows/apps/hh465435.aspx">here</a> . <br><br>  Below we <b>implement the push-notification mechanism</b> in the application step by step, performing a number of necessary actions: <br><br>  To begin, we will make all the necessary preparations in <a href="https://dev.windows.com/ru-ru/dashboard">the Development Center</a> using our developer account: <br><br><img src="https://habrastorage.org/files/bc0/539/071/bc05390717dc462a902fd05baa492303.png" width="389"><br><br>  Click <b>Submit App</b> and reserve the name of the intended application: <br><br><img src="https://habrastorage.org/files/437/bc4/af8/437bc4af85c14364850207974758413d.png" width="433"><br><br>  Complete the App Info: <br><br> <a href=""><img src="https://habrastorage.org/files/db9/543/f19/db9543f195e444a3a81d1f8e9ece5bd4.png" width="425"></a> <br><br>  Go down below and in <b>More Options,</b> find the settings required for WNS: <br><br><img src="https://habrastorage.org/files/633/87b/af7/63387baf7e8e45a5b686ba54dfea4491.png"><br><br>  Follow the link <b>here</b> : <br><br> <a href=""><img src="https://habrastorage.org/files/259/98c/e19/25998ce19c1349009638e9eab0df18b9.png"></a> <br><br>  And we get all the necessary data for further work. <br><br>  In <a href="http://aka.ms/getvsrus">Visual Studio,</a> we will create a test universal application: <br><br> <a href=""><img src="https://habrastorage.org/files/884/1a8/183/8841a818318d4ff280506b0e59a580c6.png"></a> <br><br>  In the solution browser, right-click on the project for Windows Phone and select <b>Associate App with the Store</b> : <br><br> <a href=""><img src="https://habrastorage.org/files/923/19b/655/92319b655a394889a8d8705cad719fd8.png" width="465"></a> <br><br>  The binding wizard will start: <br><br> <a href=""><img src="https://habrastorage.org/files/2cf/289/e56/2cf289e5691a476a990bc5c21258bc82.png" width="470"></a> <br><br>  Log in using a developer account and select the application that we registered before: <br><br> <a href=""><img src="https://habrastorage.org/files/9bd/f6f/22d/9bdf6f22d68d402c80638841eb1074c5.png" width="470"></a> <br><br>  All data is filled automatically: <br><br> <a href=""><img src="https://habrastorage.org/files/3ac/bb1/7bc/3acbb17bcc454c1b89625e7f8c0a8fc0.png" width="471"></a> <br><br>  After clicking on <b>Associate</b> , a <b>Package.StoreAssociation.xml</b> file will be created in the Windows Phone project. <br><br>  Log in to the <a href="https://manage.windowsazure.com/">Azure</a> Control Panel and click the <b>Create</b> button: <br><br> <a href=""><img src="https://habrastorage.org/files/2e4/baf/b0b/2e4bafb0b73c493790334dc1a316fe8e.png"></a> <br><br>  Click on <b>Application Services -&gt; Service Bus -&gt; Notification Hub</b> <br><br> <a href=""><img src="https://habrastorage.org/files/c83/fd9/c16/c83fd9c1683f4dbcafceae3df3dd635e.png"></a> <br><br>  Click on <b>Quickly create</b> and fill in the necessary data: <br><br> <a href=""><img src="https://habrastorage.org/files/22a/264/022/22a26402274b419481c22f950a6b4036.png"></a> <br><br>  Create a new Notification Hub: <br><br> <a href=""><img src="https://habrastorage.org/files/8e2/837/f92/8e2837f92f57487c8f65142d587d3224.png"></a> <br><br>  Click on the newly created <b>TestDemoPushHub-ns</b> namespace and find the newly created notification hub: <br><br> <a href=""><img src="https://habrastorage.org/files/fd6/f26/5de/fd6f265decbd46b2988bfe2e9b034ebe.png"></a> <br><br>  Let us go to the settings of the notification hub, where we fill in the required fields with the previously noted data: <br><br> <a href=""><img src="https://habrastorage.org/files/1a4/d79/101/1a4d7910172642dcaaa7af1f1d1fbd06.png"></a> <br><br>  The notification hub is now configured as a WNS service.  The following information will be needed to connect the application to the notification hub: <br><br> <a href=""><img src="https://habrastorage.org/files/504/c16/65f/504c1665fe91458c91111a835dd165d2.png" width="482"></a> <br><br>  This information can be obtained by clicking on the <b>"Connection Information"</b> button: <br><br> <a href=""><img src="https://habrastorage.org/files/213/91b/688/21391b688e6c4e90b518896bb790b499.png"></a> <br><br>  We connect our application to the notification hub. <br><br>  Right-click on the solution in Visual Studio: <br><br> <a href=""><img src="https://habrastorage.org/files/ccd/a61/153/ccda611531c94c52ad6b4f4debe0d19b.png" width="378"></a> <br><br>  In the <b>Manage NuGet Packages</b> dialog box, look for WindowsAzure.Messaging.Managed and click <b>Install</b> : <br><br> <a href=""><img src="https://habrastorage.org/files/4e2/1a1/4f2/4e21a14f25de4a388be918ab7a81eb31.png"></a> <br><br>  Next, select the installation package for the desired project: <br><br><img src="https://habrastorage.org/files/7fd/377/1b7/7fd3771b754e49568cdb8716fb81aeb0.png"><br><br>  Now we have downloaded, installed and added links to <b>Azure Messaging</b> libraries to all projects using the WindowsAzure.Messaging.Managed NuGet package. <br><br>  Open the <b>App.xaml.cs</b> file from the shared <b>Shared</b> project and include the following libraries: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Windows.Networking.PushNotifications; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Microsoft.WindowsAzure.Messaging; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Windows.UI.Popups;</code> </pre><br>  In the same place, we add the InitNotifictionAsync method: <br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">async</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">InitNotificationsAsync</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> channel = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> PushNotificationChannelManager.CreatePushNotificationChannelForApplicationAsync(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> hub = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> NotificationHub(<span class="hljs-string"><span class="hljs-string">"TestDemoPushHub"</span></span>, <span class="hljs-string"><span class="hljs-string">"Endpoint=sb://testdemopushhub-ns.servicebus.windows.net/;SharedAccessKeyName=DefaultListenSharedAccessSignature;SharedAccessKey=z2Sj7sgwGpkvTyE/H5QyiffCpwCjV/PmJBY1h4WhXac="</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> result = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> hub.RegisterNativeAsync(channel.Uri); <span class="hljs-comment"><span class="hljs-comment">// Displays the registration ID so you know it was successful if (result.RegistrationId != null) { var dialog = new MessageDialog("Registration successful: " + result.RegistrationId); dialog.Commands.Add(new UICommand("OK")); await dialog.ShowAsync(); } }</span></span></code> ", "Endpoint = sb: //testdemopushhub-ns.servicebus.windows.net/; SharedAccessKeyName = DefaultListenSharedAccessSignature; SharedAccessKey = z2Sj7sgwGpkvTyE / H5QyiffCpwCjV / PmJBY1h4WhXac ="); <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">async</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">InitNotificationsAsync</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> channel = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> PushNotificationChannelManager.CreatePushNotificationChannelForApplicationAsync(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> hub = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> NotificationHub(<span class="hljs-string"><span class="hljs-string">"TestDemoPushHub"</span></span>, <span class="hljs-string"><span class="hljs-string">"Endpoint=sb://testdemopushhub-ns.servicebus.windows.net/;SharedAccessKeyName=DefaultListenSharedAccessSignature;SharedAccessKey=z2Sj7sgwGpkvTyE/H5QyiffCpwCjV/PmJBY1h4WhXac="</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> result = <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> hub.RegisterNativeAsync(channel.Uri); <span class="hljs-comment"><span class="hljs-comment">// Displays the registration ID so you know it was successful if (result.RegistrationId != null) { var dialog = new MessageDialog("Registration successful: " + result.RegistrationId); dialog.Commands.Add(new UICommand("OK")); await dialog.ShowAsync(); } }</span></span></code> </pre><br>  This method gets the URI channel for the application from the WNS, then registers this URI channel with the notification hub.  When creating the hub variable, we will not forget to specify the name of our notification hub and the connection string with Listen access: <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> hub = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> NotificationHub(<span class="hljs-string"><span class="hljs-string">"&lt;hub name&gt;"</span></span>, <span class="hljs-string"><span class="hljs-string">"&lt;connection string with listen access&gt;"</span></span>); (<span class="hljs-string"><span class="hljs-string">"TestDemoPushHub"</span></span>, <span class="hljs-string"><span class="hljs-string">"Endpoint=sb://testdemopushhub-ns.servicebus.windows.net/;SharedAccessKeyName=DefaultListenSharedAccessSignature;SharedAccessKey=z2Sj7sgwGpkvTyE/H5QyiffCpwCjV/PmJBY1h4WhXac="</span></span>);</code> </pre><br>  Where the data for the necessary variables is obtained from <b>the connection information for the</b> notification hub in Azure: <br><br>  <b>hub name</b> = TestDemoPush; <br>  <b>connection string listen access</b> = DefaultListenSharedAccessSignature; <br><br>  In the OnLaunched event handler in App.xaml.cs, add a call to the InitNotificationsAsync () method. <br><br>  This is necessary so that the URI channel for your notifications is registered each time the application is launched. <br><br>  In the solution browser, find and configure the <b>Package.appxmanifest</b> file: <br><br><img src="https://habrastorage.org/files/fda/361/343/fda361343eef4eac8ca6f8019dba58d6.png"><br><br>  Set the <b>Toast capable</b> setting to Yes. <br>  Now the application is ready to receive notifications. <br><br>  The main function of the application is to show the result of the channel registration: <br><br><img src="https://habrastorage.org/files/814/39a/92b/81439a92b46e472d845f9939d4312f5c.png" width="176" height="294"><br><br>  Send notifications to the application. <br><br>  Create a console application through which we will send push notifications: <br><br> <a href=""><img src="https://habrastorage.org/files/bb7/988/f64/bb7988f64d1a4d89bdab89136344095f.png"></a> <br><br>  Click <b>Tools-&gt; NuGet Package Manager-&gt; Package Manager Console</b> <br><br><img src="https://habrastorage.org/files/e70/f75/977/e70f75977eca40bab609080aeebb16cd.png"><br><br>  Thus, we will add the link to Azure Service Bus SDK. <br><br>  Let's connect the following library in the project: <b>using Microsoft.ServiceBus.Notifications;</b> <br><br>  And add a method for sending notifications: <br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">async</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SendNotificationAsync</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { NotificationHubClient hub = NotificationHubClient .CreateClientFromConnectionString(<span class="hljs-string"><span class="hljs-string">"&lt;connection string with full access&gt;"</span></span>, <span class="hljs-string"><span class="hljs-string">"&lt;hub name&gt;"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> toast = <span class="hljs-string"><span class="hljs-string">@"&lt;toast&gt;&lt;visual&gt;&lt;binding template=""ToastText01""&gt;&lt;text id=""1""&gt;Hello from a .NET App!&lt;/text&gt;&lt;/binding&gt;&lt;/visual&gt;&lt;/toast&gt;"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">await</span></span> hub.SendWindowsNativeNotificationAsync(toast); }</code> </pre><br>  In the method, we create an object of type NotificationHubClient, where we fill in the necessary data for the connection: <br><br>  <b>connection string with full access</b> = DefaultFullSharedAccessSignature (of your Service Bus); <br>  <b>hub name</b> = TestDemoPushHub. <br><br>  And then we create and fill in the data of the variable itself, which is responsible for the content of the notification: <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">toast</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">visual</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">binding</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">template</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ToastText01</span></span></span><span class="hljs-tag">""&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">text</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">1</span></span></span><span class="hljs-tag">""&gt;</span></span>Hello, guys!<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">text</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">binding</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">visual</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">toast</span></span></span><span class="hljs-tag">&gt;</span></span>";</code> </pre><br>  In the body of the program, call the written method: <br>  SendNotificationAsync (); <br><br>  We launch and receive push notifications from the <b>TestDemoPush</b> application to the phone: <br><br><img src="https://habrastorage.org/files/0b1/86d/7f1/0b186d7f17cb40ab9048fc61726121e7.png"><br><br>  Let's look at the notifications in <b>the Notification Center</b> : <br><br><img src="https://habrastorage.org/files/5fc/29a/ce5/5fc29ace5ab648a5a811bed7dd18b64f.png"><br><br>  When you click on any of them go to the application. <br><br><h5>  Notification Center </h5><br>  A few more words about one of the key innovations in Windows Phone 8.1 - <b>the Notification Center (Action Center).</b>  Called it swipe down from the top of the screen.  All new messages, notifications, mentions and reminders from various applications get into it.  Also in the Notification Center are four switches that can be changed to call any settings. <br><br>  Now users <b>choose</b> which of the applications can display notifications in the Notification Center, and application developers have received special APIs that enable them to choose which of the actions will be available from the notification center.  Using these APIs and mechanisms, application developers can manage pop-up notifications. <br><br>  <b>New features for developers:</b> <br><ul><li>  Delete one or more notifications; </li><li>  Tagging and notification groups; </li><li>  Replacing outdated notification with a new one; </li><li>  Setting the notification validity period; </li><li>  ‚ÄúGoast Toast‚Äù - notifications that appear only in the Notification Center. </li></ul><br>  Notification Center is available only for the phone. <br><br>  Learn more about the capabilities of the Notification Center for Developers in this <a href="http://channel9.msdn.com/series/Building-Apps-for-Windows-Phone-8-1/14">course</a> . <br><br><h5>  Conclusion </h5><br>  Notifications in Windows Phone 8.1 are a whole set of various tools, giving the developer the opportunity to choose the way his application communicates with the user.  Nevertheless, I advise you to pay particular attention to the incredibly convenient and powerful WNS service, whose benefits were particularly noticeable on mobile devices. <br><br><h5>  useful links </h5><br>  <a href="http://channel9.msdn.com/Series/Building-Apps-for-Windows-Phone-8-1/22">Channel 9: Building Apps for Windows Phone 8.1</a> <br>  <a href="http://azure.microsoft.com/en-us/documentation/articles/notification-hubs-windows-store-dotnet-get-started/">Microsoft Azure: Getting Started with Notification Hubs</a> <br>  <a href="http://www.microsoftvirtualacademy.com/training-courses/publication-and-promotion-applications-in-windows-store-rus">MVA: Placement and promotion of applications in the Windows Store</a> <br>  <a href="http://www.microsoftvirtualacademy.com/">Microsoft Virtual Academy (MVA) Training Courses</a> <br>  <a href="http://azure.microsoft.com/ru-ru/">Microsoft Azure Portal</a> <br>  <a href="https://dev.windows.com/ru-ru/dashboard">Windows Development Center</a> <br>  <a href="http://aka.ms/getvsrus">Download free or trial Visual Studio 2013</a> <br>  <a href="http://aka.ms/storepublish">How to publish an application in the Windows Store</a> <br>  <a href="http://1drv.ms/1lkhJ2Y">Download sample application from this article.</a> </div><p>Source: <a href="https://habr.com/ru/post/234727/">https://habr.com/ru/post/234727/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../234715/index.html">How we built the engineering infrastructure for Phistech data center</a></li>
<li><a href="../234717/index.html">New Life Telebreeze Player</a></li>
<li><a href="../234719/index.html">Metasploit Secrets</a></li>
<li><a href="../234721/index.html">Database Development Solutions</a></li>
<li><a href="../234723/index.html">Data mining. Optimization of orders for goods in the pharmacy (pharmacy)</a></li>
<li><a href="../234729/index.html">Protecting the site from scanning and chaotic intensive requests</a></li>
<li><a href="../234731/index.html">Algorithm for adopting someone else's project or what to do when managers have a honeymoon</a></li>
<li><a href="../234735/index.html">Changing the structure of sections on Habrahabr</a></li>
<li><a href="../234737/index.html">Flask Mega-Tutorial, Part 11: Email Support</a></li>
<li><a href="../234739/index.html">InFocus M512 - a budget device for Snapdragon 400 and with support for 4G networks</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>