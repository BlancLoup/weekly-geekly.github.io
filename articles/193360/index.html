<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How will the ‚ÄúNoSQL‚Äù architect help and ... will it help?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently, more and more people are talking about ‚ÄúNoSQL‚Äù - a straight ‚Äúfashionable‚Äù trend has been formed. ‚ÄúTechnology‚Äù is beginning to actively use w...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How will the ‚ÄúNoSQL‚Äù architect help and ... will it help?</h1><div class="post__text post__text-html js-mediator-article">  Recently, more and more people are talking about ‚ÄúNoSQL‚Äù - a straight ‚Äúfashionable‚Äù trend has been formed.  ‚ÄúTechnology‚Äù is beginning to actively use well-known reputable companies, including  in high-load projects with large amounts of data - and someone admires, and someone pours himself with gasoline and a torch jumps from the 35th floor with a shout: " <a href="http://ru.wikipedia.org/wiki/ACID">SQL ACID</a> forever!" <br><img src="https://habrastorage.org/storage3/f38/9c4/de8/f389c4de877d6bac6e284638f804ba94.jpg"><br><br>  Moreover, no matter what product they talk about, be it <a href="http://www.mongodb.org/">MongoDB</a> or <a href="http://cassandra.apache.org/">Cassandra</a> , one often has to observe religious enthusiasm and awe, as if it were a matter of something new and sacred. <br><br><a name="habracut"></a><br>  And the brain-breaking sketches of architectures flashing in the network, such as a circle of data centers operating in the ‚Äúmaster of replication‚Äù on several continents, are especially thrilling: <br><img src="https://habrastorage.org/storage3/784/0b4/39a/7840b439a75d2cb984f8cfa923939ab0.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/storage3/2d2/953/167/2d29531671f759c284938d671c7c5454.png"><br><br>  But ... when you begin to seriously use the "new" technology in combat projects, you understand <a href="http://www.allthingsdistributed.com/2007/10/amazons_dynamo.html">where it all came from</a> , what is the reason for these or other architectural solutions: data centers and other mysticism - a practical and simple, "muroch" understanding is formed - that you want to share with colleagues, so as not to make architectural mistakes and not floated on a raft across the ocean.  About this, in principle, article. <br><img src="https://habrastorage.org/storage3/2e4/99f/052/2e499f052114474b7e0d525e6a7eca1a.png"><br><br><h4>  What is not satisfied with the good old <a href="http://ru.wikipedia.org/wiki/ACID">ACID</a> ? </h4><br>  Well, everything seems to be provided for - atomicity, consistency, transaction isolation, and secure commit.  Try, build, exploit.  ISO SQL registered <a href="http://ru.wikipedia.org/wiki/%25D0%25A3%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B5%25D0%25BD%25D1%258C_%25D0%25B8%25D0%25B7%25D0%25BE%25D0%25BB%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25BD%25D0%25BE%25D1%2581%25D1%2582%25D0%25B8_%25D1%2582%25D1%2580%25D0%25B0%25D0%25BD%25D0%25B7%25D0%25B0%25D0%25BA%25D1%2586%25D0%25B8%25D0%25B9">transaction isolation levels</a> - well, what else was not enough for complete happiness when you can determine everything? <br><br>  What caused the appearance of the <a href="http://ru.wikipedia.org/wiki/%25D0%25A2%25D0%25B5%25D0%25BE%25D1%2580%25D0%25B5%25D0%25BC%25D0%25B0_CAP">‚ÄúCAP heresy‚Äù</a> in the style to choose only 2 of the three?  :-) <br><ul><li>  data consistency </li><li>  availability </li><li>  resistance to separation </li></ul><br><img src="https://habrastorage.org/storage3/7e8/979/bd1/7e8979bd12995a15b4038c7794816d2e.jpg"><br><br>  The answer is obvious - businesses need new, ‚Äúsupersonic‚Äù data storage capabilities: <br><ul><li>  the base must always be available for writing and reading and server-type cases restart, the network has dropped - it hurts to hit </li><li>  intensive growth of data volumes and stricter requirements for their accessibility, incl.  due to the rapid development of the global network - in one database, well, they just stopped to fit </li><li>  There are a lot of customers in different parts of the world and you need to save orders as quickly as possible, etc. </li><li>  the rapid growth of web services, the emergence of mobile devices </li></ul><br><br><h4>  What is not satisfied with the "classic" cluster database? </h4><br>  From popular: <br><ul><li>  <a href="http://ru.wikipedia.org/wiki/Oracle_RAC">Oracle RAC</a> - apparently expensive and difficult, heavy, and how to scatter it across different continents? </li><li>  <a href="http://www.mysql.com/products/cluster/">MySQL cluster</a> is a quick wizard, but there are a lot of pitfalls and limitations, such as storing data only in memory, but it still works well for some cases. </li><li>  <a href="http://codership.com/content/using-galera-cluster">galera cluster for mysql</a> - yes, honest master, write where you want (but should know where exactly), but there is no ‚Äúseparation resistance‚Äù, it can hang in the absence of a quorum or go insane, it creaks when it falls and drops when geo-distributed use because  synchronously transmits data to all copies;  yes and no sharding data between masters </li></ul><br><br>  And e-business requires and requires: <br><ul><li>  the base must always be available, you can not lose a customer‚Äôs order or his cart;  even if synchronization between database nodes is missing </li><li>  the base should be accessible everywhere (Europe and the USA), and, of course, synchronize data between copies </li><li>  the base should scale indefinitely with increasing data </li><li>  the base must scale to the load: write, read </li></ul><br>  It is clear that this stream of demands slowly but surely led to suicide ... but <br><br><h4>  The answer of programmers is possible! </h4><br>  ... But if you ask programmers for a long time to do the impossible, they will! <br><img src="https://habrastorage.org/storage3/656/518/b79/656518b79447815d6c31a531a8b611b1.jpg"><br><br><blockquote>  Not everyone knows that C is enough for full-fledged programming, and for people with a sense of beauty, you can pour out your soul and in C ++ - not so, under pressure from business: ‚ÄúHow can you program faster and everyone can?‚Äù - the technologies that are powerful the hardware now even works: C #, java, python, ruby ‚Äã‚Äã... </blockquote><br><br>  So, not so much time passed as at the beginning of this century ‚ÄúNoSQL‚Äù <a href="http://kkovacs.eu/cassandra-vs-mongodb-vs-couchdb-vs-redis">products appeared</a> and it became possible: <br><ul><li>  write to any cluster member, always! </li><li>  place cluster elements on different continents and read from local ones! </li><li>  cut down any node of the cluster and the system will not go crazy! </li><li>  add cluster nodes when the soul desires, and this will allow to scale both the recording and the reading! </li></ul><br><br>  And, apparently, <a href="http://www.allthingsdistributed.com/2007/10/amazons_dynamo.html">Amazon has made porridge with DynamoDB</a> : <br><blockquote>  DynamoDB is a result of 15 years of education. </blockquote><br>  and then ideas began to be cloned as Facebook's <a href="http://en.wikipedia.org/wiki/Apache_Cassandra">Cassandra</a> : <br><blockquote>  It was the Avakash Lakshman and Prashant Malik.  It was released on Google code in July 2008. </blockquote><br>  And of course, without <a href="http://en.wikipedia.org/wiki/BigTable">Google, BigTable was</a> not there. <br><br>  What kind of silver bullet is this? <br><br><h4>  And sew seven hats?  And seven I shall sew ... </h4><br>  During the in-depth study of ‚ÄúNoSQL‚Äù products, and the last product with which I worked closely was Amazon DynamoDB (very similar to Apache Cassandra) - ‚Äúhidden pitfalls and restrictions‚Äù began to appear, which can only be called ‚Äúpay for permissiveness‚Äù: <br><br><h5>  You can write to any node of the cluster, and read ... </h5><br>  And read, by default, outdated <s>non-consistent</s> information :-) And as you like - the information is distributed with limited speed.  Of course, you can check the box and read the information just recorded - but you have to wait, sir. <br><br><h5>  You can place cluster nodes on different continents, but ... </h5><br>  But again, you need to know that information takes time - so that it spreads across continents and the application should be able to handle it (we see the switch of responsibility, damn ... again to the programmer :-)). <br><br><h5>  You can turn off any node in the cluster, chop network cables with an ax, but ... </h5><br>  Cluster separation resistance is implemented using technologies similar to versioning - but from time to time it will be necessary to launch a search for mismatches of the ‚ÄúAnti-entropy using Merkle trees‚Äù type. <br><img src="https://habrastorage.org/storage3/ef1/d14/836/ef1d148369be81b66c0c85dbc02583aa.png"><br><br><h5>  Add cluster nodes when the soul desires </h5><br>  You can, but you still have to configure the rest of the nodes, sometimes with a crowbar and a soldering iron. <br>  And then - more interesting. <br><br><h4>  Amazon DynamoDB Limitations </h4><br>  In our projects, we use DynamoDB - the advanced ‚ÄúNoSQL‚Äù solution from Amazon.  Let's look at it in more detail below. <br><br><h5>  Data types - frankly little </h5><br>  Number, string, binary data.  Forget about DATETIME (they can be emulated by timestamp, but sometimes it becomes uncomfortable). <br><br><h5>  Indices can be added only ... immediately </h5><br>  Indices need to be specified immediately; there should be no more than them - 5 per table.  And add them to the existing table - you can not, you need to delete it, recreate and reload the data there.  Peaceful sleep architect - provided. <br><br><h5>  Data size </h5><br>  You can store any amount of data, but ... the size of one "table row" with the names and values ‚Äã‚Äãof the "columns" should not exceed 64KB.  True, the number of "columns" is not limited. <br>  And on one cluster node (with a single value of the main hash key index), if there are additional indexes, <a href="http://docs.aws.amazon.com/amazondynamodb/latest/developerguide/LSI.html">you cannot</a> store more than 10GB, so that. <br>  Apparently nothing wrote "columns."  In NoSQL, the notions of a data schema are often just not there, so there can be different ‚Äúcolumns‚Äù or ‚Äúattributes‚Äù in each ‚Äúrow of the table‚Äù. <br><br><h5>  Requests ... </h5><br>  <a href="http://docs.aws.amazon.com/amazondynamodb/latest/APIReference//API_Query.html">You can select data</a> only for one index (there is also a main (hash key) index, but you cannot make range selections on it - only constant ones).  Sort by only one index. <br>  Forget about the complex ‚ÄúWHERE, GROUP BY‚Äù, not to mention the subqueries - ‚ÄúNoSQL‚Äù engines simply emulate them and can execute very slowly. <br>  You can perform <a href="http://docs.aws.amazon.com/amazondynamodb/latest/developerguide/LowLevelPHPScanning.html">more complex selections</a> - but by using a full table scan (the notorious table scan) and then elementwise filtering the results on the server side, which is long and expensive. <br><br><h5>  Transactions - and what is it? </h5><br>  Transactions ... sometimes they are needed :-), and only an atomic update of individual entities is guaranteed (there are really nice buns with readings-increments in one operation).  So transactions will have to be emulated - otherwise you would like if the data is ‚Äúsmeared‚Äù across 20 servers / data centers of the entire terrestrial ball? <br><br><h5>  Attributes with dances </h5><br>  Often in ‚ÄúNoSQL‚Äù, incl.  DynamoDB is starting to sneer at the <a href="http://ru.wikipedia.org/wiki/%25D0%259A%25D0%25BE%25D0%25B4%25D0%25B4,_%25D0%25AD%25D0%25B4%25D0%25B3%25D0%25B0%25D1%2580">founders of relational</a> <a href="http://en.wikipedia.org/wiki/Christopher_J._Date">theory</a> and create horror-like strings in lines: <br>  user = john blog_post_ $ ts1 = 12 blog_post_ $ ts2 = 33 blog_post_ $ ts3 = 69 ... <br><br>  where $ ts1-3 is the timestamp of the user's posts to the blog. <br><br>  Yes, it is convenient to get a list of publications for one request.  But the work of the programmer is increasing. <br><br><h4>  findings </h4><br>  1) Before choosing a repository for the ‚ÄúNoSQL‚Äù project, recall the reasons for the appearance of a <s>Frankenstein of</s> this class of products, which is often nothing but a set of ‚Äúmemcached‚Äù similar servers with fairly simple logic built on and, accordingly, saving data and simple sampling will be Indeed, flying, but something more complicated ... will have to be shamanized on the application side. <br>  2) Once again, reread <a href="http://ru.wikipedia.org/wiki/%25D0%25A2%25D0%25B5%25D0%25BE%25D1%2580%25D0%25B5%25D0%25BC%25D0%25B0_CAP">Brewer's theorem</a> and find the dirty tricks :-) <br>  3) Carefully review the documentation for the product used - especially restrictions.  Most likely you will meet many surprises - and you will need to carefully prepare for them. <br>  4) And finally look at Codd‚Äôs eyes. <br><img src="https://habrastorage.org/storage3/c49/5dc/3d7/c495dc3d7ad9d79fad04cbe7c178d6b3.jpg"><br><br>  Yes, you get a very reliable, high-availability, flexible solution that supports flexible replication schemes - but you have to pay, alas, with the most severe denormalization and complexity of the application's logic (including emulating transactions, juggling with heavy data inside the application, etc.).  The choice is yours! <br><br>  Good luck to all! </div><p>Source: <a href="https://habr.com/ru/post/193360/">https://habr.com/ru/post/193360/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../193342/index.html">Survey-check social magic</a></li>
<li><a href="../193344/index.html">Review Sony Xperia Z Ultra: 6.44 ‚Ä≥ screen and the rejection of the title of the tablet</a></li>
<li><a href="../193350/index.html">The 5th course and University graduates</a></li>
<li><a href="../193354/index.html">In Australian quarries, huge dump truck robots are commissioned.</a></li>
<li><a href="../193356/index.html">FSF responded to the release of new models of iPhone</a></li>
<li><a href="../193364/index.html">Our bicycle startup</a></li>
<li><a href="../193366/index.html">Build a career in a large organization. Tips & tricks</a></li>
<li><a href="../193368/index.html">7 ways to improve the design process of responsive design</a></li>
<li><a href="../193370/index.html">Run LendWings. Part 1. Belarusian swamp</a></li>
<li><a href="../193372/index.html">Methods for determining the location of the user</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>