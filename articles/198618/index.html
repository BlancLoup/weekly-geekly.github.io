<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Harbor - new face xBase family</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="For reference: xBase is a family of programming systems, DBMS, originating from dBase (1980). They are united by a common programming language (of cou...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Harbor - new face xBase family</h1><div class="post__text post__text-html js-mediator-article">  For reference: xBase is a family of programming systems, DBMS, originating from dBase (1980).  They are united by a common programming language (of course, with variations inherent in a specific implementation) and tools for accessing relational databases of the DBF format built into this language.  Actually, dBase began as a DBMS with a language designed for database maintenance.  It is a procedural programming language, it belongs to the group of interpreted languages ‚Äã‚Äãand has many, if not all, of their generic features, such as, for example, dynamic typing. <br><br>  Clipper, the immediate predecessor of Harbor, was created in 1985 with the goal of increasing dBase III performance.  To do this, the source code of the program was converted at the compilation stage into a byte-code that was embedded in the executable file along with the virtual machine intended for the execution of this byte-code.  Thus, Clipper produced a standalone exe file, which did not require an external interpreter to run and run, as in the case of dBase or FoxBase (another popular xBase product). <a name="habracut"></a><br><br>  In the late 80s and early 90s, Clipper was very popular, it was one of the main programming tools for applications related to the use of databases, primarily accounting, management, banking.  The language was upgraded from version to version, new subsystems were added.  Among the latter, the Extend System and RDD should be especially noted.  The Extend System (extension system) is designed to communicate with modules written in C ‚Äî function calls, parameter passing, and return values.  RDD - Replaceable Database Drivers (replaceable database drivers) is a technology that allows linking another standard special library to work with a different type of database, without changing a single line of code.  This is how Clipper applications worked, for example, with Novell's Btrieve (if anyone remembers, there was such a client-server non-SQL DBMS). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      XBase systems have always been perceived as intended primarily for working with databases and, possibly, with the increasing popularity of SQL, they began to go out of trend.  And if everything was more or less well with Fox, Microsoft bought it and made a popular product Visual Foxpro based on it, which a few years ago (in 2006, according to Wikipedia), was in the 12th place on the <a href="http://www.tiobe.com/index.php/tiobe_index">TIOBE</a> list, Clipper's business was much worse.  Computer Associates, which has owned it since the early 90s, has relied on other products.  Clipper stayed away from the main road, the problems that were not resolved were not solved, and in 1997 Computer Associates announced the closure of its further development, leaving the programmers writing on it alone with the 16-bit programming system. <br><br>  Many of those who thought about their future, migrated to other platforms, but those who believed that the advantages of Clipper, being realized in the modern programming environment, would be in demand even further, remained.  Several such implementations were created (xBase ++, Clip, Harbor), one of which, the most successful for this day, I will give a speech - I ask you to forgive me for such a long, but, in my opinion, necessary introduction. <br><br>  So, Harbor.  The project started in 1999, the official site is <a href="http://www.harbour-project.org/">www.harbour-project.org</a> .  The current version is 3.0 (stable), 3.2 (development). <br><br>  Like Clipper, Harbour translates the source code of the program into bytecode, but, unlike its predecessor, the Harbor compiler does not create object files, but <i>with</i> files that need to be ‚Äúfed‚Äù to the compiler.  For example, this is the simplest function that displays a greeting on the console: <br><br><pre><code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> Hello ? "Hello" <span class="hljs-keyword"><span class="hljs-keyword">Return</span></span> Nil</code> </pre> <br><br>  he broadcasts in (comments are mine): <br><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">// HB_FUNC  : // #define HB_FUNC( funcname ) HB_EXTERN_C_ HB_EXPORT HARBOUR HB_FUN_##funcname ( void ) HB_FUNC( HELLO ) { // - static const HB_BYTE pcode[] = { 36,2,0,176,2,0,106,6,72,101,108,108,111,0, 20,1,36,3,0,100,110,7 }; //    ( - )   - hb_vmExecute( pcode, symbols ); }</span></span></code> </pre><br><br>  Consider the byte code in more detail: <br><br><pre> <code class="cpp hljs"> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> HB_BYTE pcode[] = { <span class="hljs-number"><span class="hljs-number">36</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-comment"><span class="hljs-comment">// 36 - ,      //  ,    - 2 176,2,0, // 176 -     ,  //  ,    106,6,'H','e','l','l','o','\0', // 106 -      20,1, // 20 -       //  , 1 -   36,3,0, // 36 - ,      //  ,    - 3 100, // 100 -  Nil    110, // 110 -        7 // 7 -     };</span></span></code> </pre><br><br>  Your project may include source code on Harbor ( <i>* .prg</i> ), on C, special object files and libraries.  Since the code can be embedded in the <i>prg</i> file, it must be entered into <i>#pragma BEGINDUMP</i> ... <i>#pragma ENDDUMP</i> and, of course, it must comply with the EXTEND SYSTEM conventions (I mentioned it when I spoke about Clipper).  Below is an example of such a symbiosis: <br><br><pre> <code class="cpp hljs">Function Main ? Sinus( <span class="hljs-number"><span class="hljs-number">30</span></span> ), Sinus( <span class="hljs-number"><span class="hljs-number">60</span></span> ) ? Return Nil <span class="hljs-meta"><span class="hljs-meta">#</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">pragma</span></span></span><span class="hljs-meta"> BEGINDUMP #</span><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">include</span></span></span><span class="hljs-meta"> </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;math.h&gt; #include "hbapi.h" #include "hbapiitm.h" #define PI 3.14159265 //   ,    HB_FUNC( SINUS ) { // hb_parnd( n ) -  EXTEND SYSTEM,  n-   //  double  Harbour  // hb_retnd( d ) -  EXTEND SYSTEM,  double  d //   Harbour  hb_retnd( sin( hb_parnd( 1 ) * PI / 180 ) ); } #pragma ENDDUMP</span></span></span></span></code> </pre><br><br>  It was not by chance that I paid so much attention to C in Harbor.  Expanded (sorry for the involuntary tautology), compared with Clipper, Extend System and Item API, providing access from C code to Harbor's internal structures, its variables, arrays, objects, allows us to talk about the symbiosis of two languages, I consider this one of the most important features of Harbor .  Due to this, the Harbor has already been ‚Äúovergrown‚Äù with a large number of modules - shells for various products that have a C API and the list of such modules, both open source and commercial, is constantly growing (currently I am thinking about OpenCV).  Of course, C is used in Harbor not only to create shells for finished products, but also for independent development - new RDD, GUI libraries, etc. Sometimes, in the context of some applications, I view Harbor as a shell for C code - to facilitate the implementation of the user interface , access to the database, etc. <br><br>  Built-in access to the database, this generic feature of xBase, is another topic that you want to pay special attention to.  It is, indeed, very convenient - to be able, without using external DBMS, with the help of only built-in language tools to produce all the necessary database manipulations - creation, modification, updating, editing, searching.  In the case when the amount of information stored in the database is relatively small, using an external DBMS seems completely unnecessary, for such applications and MySQL looks like a monster (and some even put MS SQL on it) - xBase approach here looks like the most adequate solution.  However, Harbor can also be used (and is used) quite successfully for large DBs. <br><br>  I will cite a small piece of code that demonstrates typical data access constructs - for those who have not encountered xBase languages ‚Äã‚Äãbefore.  Of course, the arsenal of tools for working with the database in Harbor is much richer than that used in these few lines. <br><br><pre> <code class="hljs cmake"><span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Test</span></span> Local aStru := { {<span class="hljs-string"><span class="hljs-string">"FAMILY"</span></span>,<span class="hljs-string"><span class="hljs-string">"C"</span></span>,<span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>}, {<span class="hljs-string"><span class="hljs-string">"IMYA"</span></span>,<span class="hljs-string"><span class="hljs-string">"C"</span></span>,<span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>}, {<span class="hljs-string"><span class="hljs-string">"OTCHES"</span></span>,<span class="hljs-string"><span class="hljs-string">"C"</span></span>,<span class="hljs-number"><span class="hljs-number">16</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>}, ; {<span class="hljs-string"><span class="hljs-string">"TELEFON"</span></span>,<span class="hljs-string"><span class="hljs-string">"C"</span></span>,<span class="hljs-number"><span class="hljs-number">10</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>} } //    mytable      dbCreate( <span class="hljs-string"><span class="hljs-string">"mytable"</span></span>, aStru ) //  mytable USE mytable //        INDEX <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> FAMILY TAG FAMILY INDEX <span class="hljs-keyword"><span class="hljs-keyword">ON</span></span> TELEFON TAG TELEFON //   APPEND BLANK REPLACE FAMILY WITH <span class="hljs-string"><span class="hljs-string">""</span></span>, IMYA WITH <span class="hljs-string"><span class="hljs-string">""</span></span>, OTCHES WITH <span class="hljs-string"><span class="hljs-string">""</span></span>, ; TELEFON WITH <span class="hljs-string"><span class="hljs-string">"9101682020"</span></span> ... //     ,   ordSetFocus( <span class="hljs-string"><span class="hljs-string">"TELEFON"</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> dbSeek( <span class="hljs-string"><span class="hljs-string">"9101682020"</span></span> ) //   ,   REPLACE TELEFON WITH <span class="hljs-string"><span class="hljs-string">"9102875555"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ENDIF</span></span> ... <span class="hljs-keyword"><span class="hljs-keyword">Return</span></span> Nil</code> </pre><br><br>  Database access facilities are not limited to standard ones.  There are RDDs written for client-server DBMSs, like DBF-based (commercial Advantage Database Server from Sybase and open source LetoDb), and SQL.  There are modules that provide access through ODBC and ADO, there are modules for MySQL, PostgreSQL, SQLite, which use the C API of these DBMS. <br><br>  Harbor has further developed all the features of Clipper, which made it a high-level language that is convenient to program ‚Äî automatic allocation and freeing of memory, garbage collection, so-called raw arrays, the ability to compile and execute code fragments in run-time, in dynamics.  Added full implementation of OOP.  Preprocessor, retaining all the power of Clipper, expanded with some constructions taken from C. However, I will not list all the innovations here, but simply refer to the section of my site <a href="http://www.kresin.ru/hrbfaq.html">Harbor for beginners</a> . <br><br>  Yes, I seem to have forgotten to say that Harbor is a cross-platform, open source system.  It exists on 32-bit and 64-bit platforms, on Windows, Linux, Unix, Mac OS X, QNX, OS / 2, it seems, and on Android, and something else that I have not seen. <br><br>  I would be glad if this article is of interest.  In this case, it will be possible to consider some aspects in more detail. </div><p>Source: <a href="https://habr.com/ru/post/198618/">https://habr.com/ru/post/198618/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../198608/index.html">USB Standard Organization vs Open Source</a></li>
<li><a href="../198610/index.html">Mikeysoft - BBS sysop, ceased to exist in 1995</a></li>
<li><a href="../198612/index.html">Questions for an interview middle / senior iOS Developer</a></li>
<li><a href="../198614/index.html">Parsing URLs in Zend Framework 2</a></li>
<li><a href="../198616/index.html">iPad Air (5), iPad Mini Retina, OS X, iLife, iWorks</a></li>
<li><a href="../198620/index.html">HTML Academy, Habr and Crowd Funding</a></li>
<li><a href="../198622/index.html">Maria Bondarenko - Managing customer experience (talk from SPM Conference)</a></li>
<li><a href="../198626/index.html">Confederate Express - a game about survival in the harsh retro tones, ‚Äúwritten‚Äù by the masters of modern pixel art (Kickstarter Campaign)</a></li>
<li><a href="../198632/index.html">Making your personal Skype, step by step instructions for creating WebRTC applications</a></li>
<li><a href="../198634/index.html">Mobile Studio Positioning</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>