<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Transfer user folders to another HDD</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Based on this post with a few additions. I could not leave a comment to the above post, so I am writing a new article. 

 I decided to upgrade my Mac ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Transfer user folders to another HDD</h1><div class="post__text post__text-html js-mediator-article">  <i>Based on <a href="http://geektimes.ru/post/144305/">this post</a> with a few additions.</i>  <i>I could not leave a comment to the above post, so I am writing a new article.</i> <br><br>  I decided to upgrade my Mac mini (late 2012), equipping it with an Intel X25-M 160GB SSD.  Operating system - Yosemite 10.10.1.  I stuck the SSD under the article with iFixit - there is nothing complicated, I ordered the SSD cable from our friends from the ‚Äúheavenly‚Äù.  I decided to do this in such a way - operating systems and programs on the SSD, user data on the HDD. <br><a name="habracut"></a><br>  Since I prefer unix way, I decided to mount the HDD in / Users <br><br>  First, I copied a boot disk with the help of Carbon Copy Cloner, besides user data (/ Users) to the SSD.  Next, I moved the / Users / username / folder to the root of the HDD and rebooted from the Recovery section.  To do this, we clamp alt at boot and select Recovery (in principle, you can boot from any bootable USB flash drive with OS X on board). <br>  I deleted all partitions and files from the HDD except / username, cleared the / Users folder on the SSD so that the disk was mounted. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The mounting process is described in the above post in the ‚ÄúMethod 2‚Äù section, so I will not repeat it again, although there is only one addition.  When defining a disk UUID with the command: <br><br><pre><code class="bash hljs">diskutil info /Volumes/HDD/ | grep UUID</code> </pre> <br>  On the output, get two UUID codes - logical volume and partition.  Need to take the first in the list. <br><br><pre> <code class="bash hljs"> Volume UUID: 409AF953-4812-38DA-A0D9-4B0C5C49BC8E Disk / Partition UUID: 00000DAE-5F23-0000-586C-0000281D0000</code> </pre><br>  In principle, it is possible to specify in the mount options not the UUID, but simply the name of the disk in / dev /.  For example, / dev / disk1s2 - I usually do it on linux. <br><br>  The name of the desired disk can be defined with the command: <br><pre> <code class="bash hljs">diskutil list</code> </pre><br>  Regarding SSD mount option - noatime.  I didn‚Äôt do anything on my own - my default OS installed SSD with this option.  Perhaps this is a feature of Yosemite. <br><pre> <code class="bash hljs">macmini:~ home$ mount /dev/disk0s2 on / (hfs, <span class="hljs-built_in"><span class="hljs-built_in">local</span></span>, journaled, noatime) devfs on /dev (devfs, <span class="hljs-built_in"><span class="hljs-built_in">local</span></span>, nobrowse) /dev/disk1s2 on /Users (hfs, <span class="hljs-built_in"><span class="hljs-built_in">local</span></span>, journaled) map -hosts on /net (autofs, nosuid, automounted, nobrowse) map auto_home on /home (autofs, automounted, nobrowse)</code> </pre><br>  TRIM activated with <a href="http://www.macupdate.com/app/mac/43656/chameleon-ssd-optimizer">Chameleon SSD Optimizer</a> . <br><br>  Hibernation file moved here - /Users/.vm <br>  The procedure is described normally in the post. <br>  Check if hibernate and its mode is working. <br><pre> <code class="bash hljs">sudo pmset -g</code> </pre><br><br>  <b>What is not specified</b> <br>  It is also necessary to transfer the swap to HDD.  The procedure is described in detail <a href="http://apple.stackexchange.com/questions/1465/how-can-i-move-virtual-memory-swap-files-to-a-different-drive-or-partition">here</a> . <br><br>  Briefly set out the procedure: <br>  To begin with we define in what folder the swap will lie.  I decided in the same where the hibernation file is /Users/.vm <br><pre> <code class="bash hljs">sudo mkdir /Users/.vm</code> </pre><br>  Naturally, my OS is already loaded with SSD and the HDD is mounted in / Users. <br>  Open the terminal and make a backup of the swap settings file. <br><pre> <code class="bash hljs">$ <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /System/Library/LaunchDaemons $ sudo cp com.apple.dynamic_pager.plist{,_bak}</code> </pre><br>  Convert binary settings file to XML. <br><pre> <code class="bash hljs">sudo plutil -convert xml1 com.apple.dynamic_pager.plist</code> </pre><br>  Open the settings file with any editor, I used vim. <br><pre> <code class="bash hljs">sudo vim com.apple.dynamic_pager.plist</code> </pre><br>  Change the same lines to the following. <br><pre> <code class="bash hljs">&lt;key&gt;ProgramArguments&lt;/key&gt; &lt;array&gt; &lt;string&gt;/bin/bash&lt;/string&gt; &lt;string&gt;-c&lt;/string&gt; &lt;string&gt;/bin/wait4path /Users/.vm &amp;am;&amp;am; /sbin/dynamic_pager -F /Users/.vm/swapfile&lt;/string&gt; &lt;/array&gt;</code> </pre><br>  For those who do not know how to use vim - press ‚Äúi‚Äù for editing, at the end of editing press ‚ÄúEsc‚Äù and in order to write the file <br>  ": wq". <br><br>  Convert back to binary: <br><pre> <code class="bash hljs">sudo plutil -convert binary1 com.apple.dynamic_pager.plist</code> </pre><br>  <b>IMPORTANT MOMENT</b> - in the above listing com.apple.dynamic_pager.plist in codes &amp; am <b>p</b> ;  the letter <b>p</b> is the Russian <b>era</b> ! <br>  Therefore, it is better not to copy, but to reprint.  Otherwise he couldn‚Äôt do it - forum scripts convert <b>&amp; am;</b>  in <b>&amp;</b> . <br><br>  Reboot.  If something goes wrong - we boot into verbose mode (Command-v when loaded) or single mode (Command-s when loaded) and restore the settings file from the backup. <br>  The author also explains why it is necessary to use the waith4path console utility - the dynamic_page process (swap management) <br>  It runs at a very early stage of the launch of the OS and other disks besides the root may not have time to mount at this stage, which will lead to problems. <br><br>  See if the swap was created in a new way. <br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /Users/.vm $ ls -la</code> </pre><br>  I have a lot of RAM, so I had to launch a bunch of programs in order for the kernel to start writing in a swap. <br>  If everything is OK, delete the old swap. <br><pre> <code class="bash hljs">$ <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /private/var/vm $ sudo rm swapfile*</code> </pre><br>  Check if swap is enabled. <br><pre> <code class="bash hljs">sysctl vm.swapusage</code> </pre><br>  Another important point - we exclude the folder with the hibernation file and the swap from TimeMachine. <br>  In order not to create a backup of the swap and hibernation file.  I have the same folder for this: <br><pre> <code class="bash hljs">sudo tmutil addexclusion -p /Users/.vm</code> </pre><br>  Checking: <br><pre> <code class="bash hljs">tmutil isexcluded /Users/.vm</code> </pre><br>  And they also recommend that you exclude swaps from indices, but the following command will work only if you have a swap and a hibernation file on a separate logical volume. <br>  A kind of linux way. <br><pre> <code class="bash hljs">sudo mdutil -i off /pathtoswap &amp;&amp; sudo mdutil -E /pathtoswap</code> </pre><br>  Check the indexing can be so. <br><pre> <code class="bash hljs">sudo mdutil -s /pathtoswap</code> </pre><br>  Successes! </div><p>Source: <a href="https://habr.com/ru/post/376153/">https://habr.com/ru/post/376153/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../376139/index.html">How to "bend" the light? Or a brief excursion into the world of fiber optics</a></li>
<li><a href="../376143/index.html">Free cookies as an incentive not to use the smartphone during lectures</a></li>
<li><a href="../376145/index.html">ICam: instructions for use. Review and lifehacks</a></li>
<li><a href="../376147/index.html">Review: SLA DLP in Russian. How to respond to foreign monsters?</a></li>
<li><a href="../376149/index.html">The trailer of the film ‚ÄúIllusion of lights: the way to the unprecedented‚Äù</a></li>
<li><a href="../376155/index.html">Helvetica and Times New Roman owner bought Emoji</a></li>
<li><a href="../376157/index.html">Absolute Rings: Examples of Alternative Mice</a></li>
<li><a href="../376159/index.html">Happy Birthday Facebook!</a></li>
<li><a href="../376161/index.html">Infographics "Online payments in 2014: 8 facts from PayOnline"</a></li>
<li><a href="../376163/index.html">Drones deliver tea in China</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>