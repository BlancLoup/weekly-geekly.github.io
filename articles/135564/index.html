<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Looking through the engine through the exhaust pipe, or how to get the normal keyboard controls in FIFA 12</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="How did it happen 
 In the long hidden past 
 Was the world just like ours 
 Once beautiful, but every flower dies ... 
 - All Mankind, "Break the spe...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Looking through the engine through the exhaust pipe, or how to get the normal keyboard controls in FIFA 12</h1><div class="post__text post__text-html js-mediator-article"><h4>  How did it happen </h4><br><blockquote>  <i>In the long hidden past</i> <i><br></i>  <i>Was the world just like ours</i> <i><br></i>  <i>Once beautiful, but every flower dies ...</i> <br>  - All Mankind, "Break the spell" </blockquote><br>  The plot of the story is trivial.  Once upon a time, in a distant galaxy there was a great game called ‚ÄúFifa‚Äù.  It would have remained so if its bad people from EA did not want to finally kill the keyboard controls in the name of gamepads in 2010. <br>  I decided to <s>take retribution in the name of the moon</s> to return the normal keyboard controls back.  Chronicles of beaver fighting with a donkey can be viewed under the cut. <br><a name="habracut"></a><br><h4>  As it was before </h4><br>  Until the landmark 2010, the fifa had quite a decent keyboard control.  The greatest advantage of the gamepad (at least, in my opinion) was the significantly greater availability of special <s>street</s> techniques for working with the ball (the right analog stick was used for them).  In the keyboard version, both sticks (both motion and feints) were tied to the usual arrows, and pressing the left shift allowed you to perform clever tricks.  In fact, this is quite a tolerable decision, with which you can play: with some arrows I can control a running man and, when necessary, perform tricks while holding LShift. <br><br><h4>  How keyboardists were killed in Fifa 11 </h4><br>  A very simple.  In this version, the right stick was completely transferred to the numpad, and the movement was left on the arrows. <br>  What's wrong with that?  It is exceptional that now these are <b>different</b> buttons.  All the usual scheme based on sifta, flew to hell, and it was clear that to restore such a scheme is not possible.  It worked, keyboardists became much less than in 10k. <br>  It should be noted that I was going for a long time.  I tolerated such management for a whole year, but just a couple of days ago, the cup of patience was completely overflowing. <br><br><h4>  The beginning of the fighting </h4><br>  Brewing tea stronger, I downloaded the WDK, opened an example of a keyboard filter, and decided to adjust it for my own needs.  But the trouble was that it was my first (and almost unsuccessful) driver creation experience.  In short, after about fifty reboots of the virtual machine (changing the keyboard driver required a reboot), I got a bit bored with picking up the code at six o'clock in the morning, and I fell asleep. <br>  Morning, as you know, is always wiser than evening, and it brought a fresh thought.  If FIFA loves a gamepad so much - why not?  We'll emulate it ... I must say, many guys did this using the thing called KeyToJoy.  She didn‚Äôt know what I wanted, but she was popular, because in the 11th Fife, for example, the keyboard wasn‚Äôt a full controller at all.  I'll <b>warn you right away</b> , a search for this keyword once led me to the archive where the virus was sitting.  I warned. <br>  In general, I decided that it would be nice to find some gamepad emulator, preferably with open code, and fix it so that the keyboard controls are as close as possible to my usual. <br>  And found.  Here it is: <a href="http://vjoystick.sourceforge.net/site/index.php/">VJoy homepage</a> . <br>  The author of this product is a great guy and just a good person, because he provided him with an excellent example of work, which was not difficult to remake in the necessary way. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  Installing a virtual gamepad </h5><br>  Nothing complicated.  Downloading the distribution kit (link to the site above), click ‚Äúnext‚Äù several times - and that's it. <br>  No, really.  And what is there to write about? <br><br><h5>  Device settings </h5><br>  After installation, you will need to configure the gamepad parameters (the number of buttons, axes ...), which will require the <a href="http://sourceforge.net/projects/vjoystick/files/Beta/241211/vJoyConf.exe/download">vJoyConf utility</a> .  There, too, everything is very simple.  For FIFA, 10 buttons (A, B, X, Y, start, back, LT, RT, LB, RB), four axes (x, y, z, rz), D-Pad with four directions are enough.  The program does not reflect the current settings of the virtual gamepad, but only allows you to set new ones, so do not be afraid that the ‚Äúsettings have not been saved‚Äù - everything is preserved there. <br><br><h5>  Customized where to check? </h5><br>  Everything is very simple - we launch the applet ‚Äúgaming devices‚Äù of the control panel (joy.cpl in ‚Äúexecute‚Äù is the fastest access option) and look at our virtual gamepad.  What to do with him?  Nothing yet, because  nobody controls it yet. <br><br><h5>  We control the joystick </h5><br>  And for this we need, for example, MS Visual C ++ Express.  Well, yes, now we will listen to the keyboard and tell our gamepad what buttons to consider to be pressed.  And what, to me in fifu without tricks or something to play? <br>  So, <a href="http://sourceforge.net/projects/vjoystick/files/Client/240811/vJoyClient%2528Stand%2520Alone%2529.zip/download">here the</a> creator of VJoy gives the world a simple C ++ console application that sends the gamepad commands to set a new state. <br>  The example code is well documented, and in a couple of minutes it is remade as required by us in the context of a specific task (for the game in fifu).  For example, this code provides a much-needed switch from left stick to right stick: <br><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> shift = <span class="hljs-number"><span class="hljs-number">0</span></span>!=GetAsyncKeyState(VK_LSHIFT); <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> leftKey = <span class="hljs-number"><span class="hljs-number">0</span></span>!=GetAsyncKeyState(VK_LEFT); <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> rightKey = <span class="hljs-number"><span class="hljs-number">0</span></span>!=GetAsyncKeyState(VK_RIGHT); <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> upKey = <span class="hljs-number"><span class="hljs-number">0</span></span>!=GetAsyncKeyState(VK_UP); <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> downKey = <span class="hljs-number"><span class="hljs-number">0</span></span>!=GetAsyncKeyState(VK_DOWN); Y = X = <span class="hljs-number"><span class="hljs-number">0x3fff</span></span>; <span class="hljs-comment"><span class="hljs-comment">//     Z = ZR = 0x3fff; //    .  . //       . if(!leftKey != !rightKey) { if (!shift) X = leftKey ? 0 : 0x7FFF; //      else Z = leftKey ? 0 : 0x7FFF; } if(!upKey != !downKey) { if(!shift) Y = upKey ? 0 : 0x7FFF; else ZR = upKey ? 0 : 0x7FFF; } //-    ,    //     if (!DeviceIoControl (hDevice, IoCode, pPositionMessage, IoSize, NULL, 0, &amp;bytes, NULL)) { _tprintf(_T("Ioctl to vJoy device failed\n")); break; }</span></span></code> </pre> <br><br>  In fact, everything is very simple.  We trace buttons, we transfer them to the gamepad. <br>  What is the bonus?  Obviously, the complexity of the logic of pressing buttons can be absolutely any, <br>  and not just ‚Äúone keyboard button = one gamepad button‚Äù, as it happens in simple ready-made emulators.  You can customize as you like, and this may be of interest. <br><br><h4>  Conclusion </h4><br>  Who needs all this?  I don‚Äôt know, I‚Äôm just writing about how I conceived something and successfully executed it.  Suddenly someone such a decision would be useful? <br><br>  A few words about the resulting emulator.  The full source of raw, non-configurable, but the working product can be seen <a href="http://pastebin.com/u0FxAXdG">here</a> , in them, I think, there is nothing that should be written separately and in detail.  Moreover, from the point of view of performance, this thing is not very effective, I am sure that it can be done much more intelligently if you sit longer with it.  However, on that momentous evening, my hands were too much itchy to try out the creation, so as soon as the compiler spat out the exe file, all thoughts of modifications instantly disappeared somewhere. <br><br>  It is also worth noting that in order to introduce the new joystick to the fifa, you need to slightly think about the buttonDataSetup.ini file in the user directory of the fifa.  I'm not sure that these details (also settable independently in five to ten minutes) make sense to give here, but if anyone is interested in this question, then I will cover it. <br><br>  UPD.  <a href="http://pastebin.com/j0Qdvx39">New version of the feeder</a> .  Now it emulates the analog stick smoother, which has a positive effect on the perception quality of the game of tricks.  At the same time, the feeder is smart enough not to create a delay in response to abrupt changes in the direction of movement.  You never know, suddenly someone takes advantage. </div><p>Source: <a href="https://habr.com/ru/post/135564/">https://habr.com/ru/post/135564/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../135558/index.html">You calendar 2012</a></li>
<li><a href="../135559/index.html">Rockbox for everyone</a></li>
<li><a href="../135561/index.html">Brainfuck on tape with unlimited bit cells</a></li>
<li><a href="../135562/index.html">How to get access to other mailboxes on mail.ru</a></li>
<li><a href="../135563/index.html">Some questions on .NET and C #</a></li>
<li><a href="../135565/index.html">ISO 8601 and ECMAScript - a headache from different interpretations of standards</a></li>
<li><a href="../135568/index.html">Fog computing</a></li>
<li><a href="../135570/index.html">Robot-turtle on ATMega8</a></li>
<li><a href="../135571/index.html">Digital Eyepiece for Microscope DIY</a></li>
<li><a href="../135572/index.html">Improving interaction with small controls through a touch interface</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>