<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to get a lot of server for little money: options for the earth and the cloud</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the comments to one of the previous articles about the choice of server 1C raised an interesting question about the rationality of the configuratio...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to get a lot of server for little money: options for the earth and the cloud</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/files/ef3/099/a64/ef3099a6460041e185e528ef2351818b.png" alt="image alt text"></p><br><p>  In the comments to one of the previous articles <a href="https://habrahabr.ru/company/pc-administrator/blog/305878/">about the choice of server 1C</a> raised an interesting question about the rationality of the configuration "for growth".  I decided to cover this issue in more detail, taking into account several options for acquiring a server and renting resources in a public cloud.  We will try to spend the budget with maximum benefit for the cause. <a name="habracut"></a></p><br><p>  For clarity, let's imagine that we choose iron for a small abstract company. </p><br><h1>  Meet - LLC "UFO" </h1><br><p>  The UFO limited liability company employs about 20 people and it needs three 1C bases of the following configurations: </p><br><ol><li><p>  Salary and Personnel Management; </p><br></li><li><p>  Accounting; </p><br></li><li>  Trade management. </li></ol><br><p>  The platform is a classic based on Microsoft Windows Server and Microsoft SQL.  Since 1C runs on the same machine as SQL, you can use the added benefit of <a href="http://tavalik.ru/shared-memory-1spredpriyatie-8-i-ms-sql-server">Shared Memory</a> . </p><br><blockquote>  In my practice, administrators sometimes forget about setting Shared Memory, and this alone increases the speed by 10-15% </blockquote><p>  A <a href="http://v8.1c.ru/overview/Term_000000121.htm">thin client is</a> suitable for access to the databases, which will make it possible not to depend on the performance of the user computers and not to raise the terminal server. </p><br><p>  For estimating the size of bases, I mainly used my past experience: </p><br><ul><li><p>  2 GB, Salary and Personnel Management, the user - one personnel officer; </p><br></li><li><p>  1 GB, Accounting - two accountants; </p><br></li><li>  5 GB, Trade Management - nineteen users, including accountants. </li></ul><br><p>  Selection of the server configuration for 1C is a creative process, so we arm ourselves with <a href="http://larga.ru/about/news/158/305070/">useful articles on this subject</a> , recall the <a href="https://habrahabr.ru/company/pc-administrator/blog/305878/">previous publication of the Server Mall</a> and get the following requirements: </p><br><ul><li><p>  Processor: 4 cores; </p><br></li><li><p>  RAM: from 16 GB; </p><br></li><li>  Disk system: RAID1, at least 200 GB. </li></ul><br><p>  But the minimum recommended configuration does not take into account periodic bursts of reporting periods and all-in-one hands-on.  In addition, after a year, such a server may not be enough for a comfortable work of the increased number of users. </p><br><p><img src="https://habrastorage.org/files/73d/239/af3/73d239af3c434925bcf9f90799d1b2d0.jpg" alt="image alt text"></p><br><p>  In general, I added SSD disks to these requirements and counted a new server in <a href="http://www.ascod.ru/products/configurator/">the vendor configurator Supermicro</a> : </p><br><table><tbody><tr><td></td><td>  Model </td><td>  Price </td></tr><tr><td>  Platform </td><td>  Supermicro SYS5019SM 1520 </td><td>  48 000 ‚ÇΩ </td></tr><tr><td>  CPU </td><td>  Intel Xeon E3-1230 V5 </td><td>  21 760 ‚ÇΩ </td></tr><tr><td>  RAM </td><td>  2 √ó Kingston KVR21E15D8 / 8 </td><td>  7 680 ‚ÇΩ </td></tr><tr><td>  Drives </td><td>  2 √ó Intel SSDSC2BB240G601 </td><td>  29 440 ‚ÇΩ </td></tr><tr><td>  Raid Controller </td><td>  Adaptec ASR6405 </td><td>  27 510 ‚ÇΩ </td></tr><tr><td>  Sled </td><td>  Supermicro MCP2200000x </td><td>  $ 280 </td></tr><tr><td>  Adapter for disks 2.5 " </td><td>  Supermicro MCP220000x </td><td>  1,024 ‚ÇΩ </td></tr><tr><td>  Total </td><td></td><td>  136 694 ‚ÇΩ </td></tr></tbody></table><br><p>  Remember this figure and return to the planning. </p><br><h1>  And what will happen next year? </h1><br><p>  Small companies tend to grow, so let's imagine that the state has almost doubled.  Now the size of the bases and the number of users looks like this: </p><br><ul><li><p>  4 GB is occupied by the <strong>Salary and Personnel Management</strong> , the number of personnel officers is two; </p><br></li><li><p>  2 GB - <strong>Accounting</strong> , four accountants; </p><br></li><li>  40 GB - <strong>Trade Management</strong> , thirty-eight employees work with it. </li></ul><br><blockquote>  The base "Management of Trade" is growing faster, because usually it is the organization's document flow </blockquote><p>  A greater number of users and an increased volume of databases inevitably lead to problems with speed.  Within the framework of the article, we will not consider diagnostics and studying the causes of such a situation, but simply add 1C resources. </p><br><p>  There are several options: </p><br><ul><li><p>  <strong>Upgrade an</strong> existing server; </p><br></li><li>  <strong>Rent a</strong> part of the resources in the cloud. </li></ul><br><blockquote>  If the performance slipped without a significant increase in the number of users, then it is still worth doing diagnostics.  As a rule, the reasons are intricate processing and reports that are found even in typical configurations.  Or blocking SQL, low memory and insufficient cache in SQL.  I recommend the materials of <a href="http://www.gilev.ru/">Gilev</a> ; they helped me more than once. </blockquote><p>  In the spirit of the times, first consider the intricate cloud option. </p><br><h1>  Scalable to the cloud </h1><br><p>  In the case of the UFO LLC scenario, two popular cloud types are suitable for scaling the service: </p><br><ul><li><p>  <strong>SaaS</strong> (rental application).  You can transfer two small bases to the cloud and free up resources for third base. </p><br></li><li><p>  <strong>IaaS</strong> (rent virtual machines).  There are several options: </p><br><ul><li><p>  Deliver two bases to a cloud-based virtual machine by installing a second 1C-enterprise server and getting something similar to SaaS, but with full control over the system; </p><br></li><li><p>  Transfer to the cloud application server 1C, at the same time losing the benefits of working through <strong>shared memory</strong> ; </p><br></li><li>  Make SQL <a href="https://habrahabr.ru/post/263267/">readonly</a> replica.  It can be useful if some users only generate complex reports that block tables and prevent others from working.  But finalization of the 1C configuration and user training in this mode will be needed. </li></ul><br></li></ul><br><p>  If we evaluate SaaS, then we need two databases with a total volume of 6 GB per six users.  For evaluation, I used the calculator of the first <a href="http://www.arenda1c.ru/materials/tarifs.html">SaaS provider</a> found in the search.  It turned out <strong>5 700</strong> ‚ÇΩ per month. </p><br><p><img src="https://habrastorage.org/files/6e3/2cc/90b/6e32cc90ba664681aa4d90ef73b28649.jpg" alt="image alt text"></p><br><blockquote>  Migrating some databases to the cloud will unload the server, but if users complain about the speed of a certain database, this may not solve the problem.  In addition to the obvious disadvantages of the cloud solution, you will have to redo the database exchange scheme, since the provider can block the work of the main exchange methods (COM, SMB, FTP).  Also, using them outside the intranet is not secure. </blockquote><p>  Now let's estimate the cost of a cloud-based virtual machine with a <a href="https://selectel.ru/services/vpc/">calculator</a> from one of the VPS providers issued by the search engine, which would fit all the above scenarios: </p><br><ul><li><p>  80 GB of space for the base and the system on fast drives; </p><br></li><li><p>  4 processor cores; </p><br></li><li>  At least 8 GB of RAM; </li></ul><br><p>  Total <strong>$ 6 400</strong> per month. </p><br><blockquote>  In one of my past companies, it was necessary to repost all documents in four years in the main working base.  In order not to paralyze the rest of this work, it was decided to rent a server in the cloud.  They deployed a copy of the database on it, set up a night exchange, and literally within a month, all the postings were made without affecting the production </blockquote><p>  In terms of a year, renting resources in the IaaS-cloud will cost the company $ 76,800, which is even less interesting in the long run.  But this option is suitable for solving a temporary performance problem with peak loads. </p><br><p>  We will now descend from the clouds to the ground and consider the traditional option of saving the "User Experience". </p><br><h1>  Upgrade or purchase immediately "in reserve" </h1><br><p>  Performance problems are often not associated with the processor, but with the disk system and memory.  Therefore, we will double the memory of the UFO LLC server and move from RAID1 to RAID10. </p><br><blockquote>  Using RAID10 will improve read / write speed and add reliability.  This is one of the most successful options when using four disks.  In addition, when replacing any of them with the subsequent reassembly of the array, the performance will not be that bad (compared to the same RAID5) </blockquote><p>  As for the upgrade price in the future, it is difficult to build forecasts.  But in our basic version, fresh iron is used, so for a rough estimate, it is permissible to use the actual price. </p><br><p>  To exclude from the cost of the assembly service and the warranty on the server, we calculate the components at the average price of <strong>Yandex Market</strong> : </p><br><ul><li><p>  RAM: <strong>2 pcs</strong> .  Kingston KVR21E15D8 / 8 - <strong>$ 612</strong> </p><br></li><li>  Disk system: <strong>2 pcs</strong> .  Intel SSDSC2BB240G601 - <strong>$ 27,200</strong> </li></ul><br><p>  Total <strong>33 600 ‚ÇΩ</strong> . </p><br><p>  Now let's calculate the cost of the server "in a year", adding up the price of the basic configuration and upgrade: </p><br><p>  <strong>136 694 + 33,600 = 170 $ 294</strong> </p><br><p>  Even with the hypothetical price reduction of outdated components, an updated server is unlikely to cost less <strong>than $ 150,000</strong> .  It turns out that to lay the upgrade of the new equipment in the original estimate is quite expensive.  At least for a business it looks like an unnecessary waste of money. </p><br><h1>  Using the restored server </h1><br><p>  Since we are considering economically viable options to buy more server for less money, then we estimate the version of the restored (refurbished) branded server.  We already know the configuration and its changes in the future, so let's turn to the <a href="http://servermall.ru/">green button for the price on the Server Mall website</a> . </p><br><p><img src="https://habrastorage.org/files/35b/dfe/15c/35bdfe15cb2643a18a35e6cccd4716b4.jpg" alt="image alt text"></p><br><p>  After studying the price list and consulting with the company's sales department, I found one interesting option based on IBM.  Immediately bring the original version of the Supermicro and the new IBM on the plate: </p><br><table><tbody><tr><td></td><td>  Supermicro </td><td>  Ibm </td></tr><tr><td>  Platform </td><td>  Supermicro SYS5019SM 1520 </td><td>  IBM x3250 M4 </td></tr><tr><td>  CPU </td><td>  Intel Xeon E3-1230 V5 </td><td>  Intel Xeon E3-1270 V2 </td></tr><tr><td>  RAM </td><td>  16 GB DDR4 </td><td>  24 GB DDR3 </td></tr><tr><td>  Drives </td><td>  2 √ó Intel SSDSC2BB240G601 </td><td>  4 √ó Intel SSDSC2BB240G601 </td></tr><tr><td>  Raid Controller </td><td>  Adaptec ASR6405 </td><td>  ServeRaid m5014 </td></tr></tbody></table><br><p>  The restored server resembles the option "Supermicro after upgrade", with the same 4 SSD drives and a <a href="http://www.cpubenchmark.net/compare.php%3Fcmp%255B%255D%3D1192%26cmp%255B%255D%3D2693">similar processor</a> with a <a href="http://www.cpubenchmark.net/compare.php%3Fcmp%255B%255D%3D1192%26cmp%255B%255D%3D2693">speed of</a> <strong>129 000 ‚ÇΩ</strong> .  The difference in price with the original version, you can even increase the amount of RAM up to 32 GB. </p><br><p>  If you discard the stereotypes of ‚Äúyes, this is the same / used‚Äù and compare the facts, then a budget server comes up with a considerable margin of performance, a <a href="https://habrahabr.ru/company/pc-administrator/blog/308830/">three-year warranty</a> and IBM proprietary management software.  There are also <strong>two power supply units</strong> , which gives greater fault tolerance and the ability not to shut down the server even when moving to another rack. </p><br><p>  There are also disadvantages: </p><br><ul><li><p>  Memory obsolete type; </p><br></li><li><p>  The processor supports no more than 32 GB of RAM; </p><br></li><li>  Lower system bus. </li></ul><br><p>  Despite this, the server will cope with the maintenance of 1C. </p><br><h1>  What chooses UFO LLC </h1><br><p>  The choice of the fictional company "UFO" may not coincide with yours, so there is no sense in voicing it.  I will simply compare the ways to improve performance in the table: </p><br><table><tbody><tr><td></td><td>  SaaS </td><td>  IaaS </td><td>  Upgrade nat.  server </td><td>  Refurbished server initially </td></tr><tr><td>  Complexity of implementation </td><td>  Small </td><td>  Large </td><td>  Insignificant </td><td>  Missing </td></tr><tr><td>  Serviceability </td><td>  Yes </td><td>  Not </td><td>  Yes </td><td>  Yes </td></tr><tr><td>  System control </td><td>  Not full </td><td>  Full </td><td>  Full </td><td>  Full </td></tr><tr><td>  User experience </td><td>  Yes </td><td>  Depending on the implementation </td><td>  Yes </td><td>  Yes </td></tr><tr><td>  Further scaling </td><td>  Yes </td><td>  Yes </td><td>  Yes </td><td>  Yes (up to 32 GB of memory) </td></tr><tr><td>  Initial payment </td><td>  136 694 ‚ÇΩ * </td><td>  136 694 ‚ÇΩ * </td><td>  136 694 ‚ÇΩ </td><td>  129 000 ‚ÇΩ </td></tr><tr><td>  Cost of the second year </td><td>  68 400 ‚ÇΩ ** </td><td>  76 800 ‚ÇΩ ** </td><td>  $ 33,600 </td><td>  0 ‚ÇΩ </td></tr></tbody></table><br><p>  * The cost of acquiring the basis of the solution is a physical server. </p><br><p>  ** Paid monthly during the entire rental period. </p><br><p>  <strong>If you have your own examples of real use of the 1C and SQL bundles in the hybrid infrastructure with the cloud - tell us in the comments, it is very interesting to read.</strong> </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/309934/">https://habr.com/ru/post/309934/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../309918/index.html">How to stop being afraid and fall in love with mbed [Part 2]</a></li>
<li><a href="../309920/index.html">Fax in the City (T.38)</a></li>
<li><a href="../309922/index.html">Writing Hello World on FASM</a></li>
<li><a href="../309928/index.html">Customize Windows Store for Business</a></li>
<li><a href="../309930/index.html">Arguments for function tree</a></li>
<li><a href="../309936/index.html">Overview of Node.js packages for parsing command line options</a></li>
<li><a href="../309938/index.html">We get rid of binary dependencies with composite assembly in Gradle 3.1</a></li>
<li><a href="../309940/index.html">Azure Active Directory now in the new ARM portal</a></li>
<li><a href="../309942/index.html">Presenter Template in Laravel</a></li>
<li><a href="../309944/index.html">Useful properties of jitter</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>