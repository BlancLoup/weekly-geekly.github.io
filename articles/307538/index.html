<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>QRLJacking: a new type of attack threatens the security of users of a number of services and instant messengers</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="QR authentication is not as secure as is commonly believed. 



 Mohamed Baset (Mohamed Baset) - a specialist in information security, has developed a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>QRLJacking: a new type of attack threatens the security of users of a number of services and instant messengers</h1><div class="post__text post__text-html js-mediator-article">  <i>QR authentication is not as secure as is commonly believed.</i> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bd6/43c/ff1/bd643cff1a6eea7a47263793ff9cdc54.jpg" width="734" height="489"><br><br>  Mohamed Baset (Mohamed Baset) - a specialist in information security, has developed a method of attacking users of instant messengers.  This method is based on the use of QR codes.  Now QR codes are used for authentication in many applications, including WeChat, Line and WhatsApp.  SQRL (Secure QR Logins) was considered a completely safe method, but it looks like it is not. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The method shown by Baset includes both technology and social engineering.  Such hybrid attack methods are used by attackers quite often.  In order to attack the user of the instant messenger, the attacker must in some way force the victim to scan a special QR code.  The easiest way to use phishing is here. <br><a name="habracut"></a><br><img src="https://habrastorage.org/getpro/habr/post_images/56f/8d4/108/56f8d41080830254977969e9aa038e53.jpg"><br><br>  The method consists of the following steps: <br><br>  1. The attacker initiates a client QR-session and clones the QR-login code to a phishing page; <br>  2. The victim is sent a link to this page.  The page looks quite safe; <br>  3. The victim scans the fake QR code, and the application sends a secret token that completes the authentication process; <br>  4. The attacker receives confirmation and can now control the victim‚Äôs account. <br><br>  In order for the method to be more or less effective, the attacker must create a script that clones the temporary QR codes and updates them on the phishing site.  The fact is that QR-Login limits the time of validity of QR-codes.  The main condition of the attack - the victim and the attacker must be online at the same time. <br><br>  QRLJacking has already been tested on a number of instant messengers, including QRLJacking on WhatsApp, WeChat, Line, Weibo, QQ Instant Messaging, QQ Mail, Alibaba.  All attacks, according to the developer, were completed successfully. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c61/6c6/d3c/c616c6d3c0cd38e31b0c4c3bf0aa23fa.jpg"><br><br>  The source code of the proof-of-concepp is published by Basset on <a href="https://github.com/OWASP/QRLJacking/wiki">GitHub</a> . <br><br>  In order to test the script in the work, <b>you need to configure the server part</b> : <br><br>  1. Download "qrHandler.php" on the server.  This script converts the string base64 QR-code into a valid image in jpg format.  The default image file name is tmp.jpg.  It is located in the root folder of the script files and is updated each time a php file is requested.  To attract users, you can fake WhatsApp page, you can create a website with some attractive application for messenger users, etc. <br>  2. Update the file "phishing.html", which is the source of the phishing web page. <br><br>  <b>Client configuration (attacker's browser)</b> <br><br>  1. Open Firefox <br>  2. Register ‚Äúabout: config‚Äù and, of course, agree to be careful; <br>  3. We look for the string ‚Äúsecurity.csp.enable‚Äù and change the value to false.  After the script is tested, it is better to return everything back; <br>  4. Install the add-on <a href="https://addons.mozilla.org/en-US/firefox/addon/greasemonkey">Greasemonkey</a> , make sure that the file ‚ÄúWhatsAppQRJackingModule.js‚Äù is up and running. <br>  5. Now everything is ready.  Try opening the ‚Äú <a href="https://web.whatsapp.com/">web.whatsapp.com</a> ‚Äù example, waiting for the WhatsApp session to load.  Greasemonkey starts working using the WhatsApp module; <br>  6. We send a direct link to the phishing page of the victim. <br><br>  <b>We look at the result:</b> <br><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/4QwyBXiZhG0%3Ffeature%3Doembed&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhiGfIsyYQmKyErNFGKdljHwgJIZCQ" frameborder="0" allowfullscreen=""></iframe><br><br><h3>  What resources are vulnerable? </h3><br>  According to the developer, the QRLJacking method can be used not only for instant messengers, but also for other services.  List of vulnerable resources and services below: <br><br>  <b>Chats</b> : WhatsApp, WeChat, Line, Weibo, QQ Instant Messaging <br>  <b>Mailers</b> : QQ Mail, Yandex Mail <br>  <b>eCommerce:</b> Alibaba, Aliexpress, Taobao, Tmall, 1688.com, Alimama, Taobao Trips <br>  <b>Online banking:</b> AliPay, Yandex Money, TenPay <br>  <b>Identification services:</b> Yandex Passport (Yandex Mail, Yandex Money, Yandex Maps, Yandex Videos, etc ...) <br>  <b>Mobile Software:</b> AirDroid <br>  <b>Other services:</b> MyDigiPass, Zapper &amp; Zapper WordPress Login by QR Code plugin, Trustly App, Yelophone, Alibaba Yunos </div><p>Source: <a href="https://habr.com/ru/post/307538/">https://habr.com/ru/post/307538/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../307528/index.html">Analyzing NetFlow v.9 of Cisco ASA using Logstash (ELK)</a></li>
<li><a href="../307530/index.html">Writing a multiplatform bot for transferring money from card to card using Microsoft Bot Framework V1</a></li>
<li><a href="../307532/index.html">10 years of online security</a></li>
<li><a href="../307534/index.html">VMware Virtual SAN 6.2: The Technology Future</a></li>
<li><a href="../307536/index.html">How I increased my productivity with streaming</a></li>
<li><a href="../307540/index.html">Microsoft fixes vulnerabilities in Windows</a></li>
<li><a href="../307542/index.html">When should you think about optimizing your IT infrastructure?</a></li>
<li><a href="../307544/index.html">From Slides Defined to Software Defined Networking. Part 1</a></li>
<li><a href="../307548/index.html">Welcome to Tarantool meetup August 25</a></li>
<li><a href="../307550/index.html">The collapse of the cloud technology exchange. What's next?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>