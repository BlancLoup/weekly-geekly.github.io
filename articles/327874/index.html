<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Support for Visual Studio 2017 and Roslyn 2.0 in PVS-Studio: sometimes using ready-made solutions is not so easy</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article I want to tell you about the problems that the PVS-Studio developers faced with the support of the new version of Visual Studio. In ad...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Support for Visual Studio 2017 and Roslyn 2.0 in PVS-Studio: sometimes using ready-made solutions is not so easy</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/ff3/c21/e35/ff3c21e3516a9111f5c7ab2996684b41.png" align="left">  In this article I want to tell you about the problems that the PVS-Studio developers faced with the support of the new version of Visual Studio.  In addition, I will try to answer the question: why is the support of our C # analyzer based on a ‚Äúready-made solution‚Äù (in this case, Roslyn) turned out to be more costly in some situations than our ‚Äúself-written‚Äù C ++ analyzer. <br><a name="habracut"></a><br>  With the release of the new version of Visual Studio - 2017, Microsoft introduces a large number of innovations for its "flagship" IDE.  These include: <br><br><ul><li>  C # 7.0 support; </li><li>  new versions of .NET Core / .NET Standard; </li><li>  New features from C ++ 11 and C ++ 14 standards; </li><li>  IntelliSense improvements for many of the supported languages; </li><li>  "Lightweight" loading of projects and new tools for tracking the performance of IDE extensions; </li><li>  new modular installation system, and more. </li></ul><br>  The PVS-Studio 6.14 version, which supports Visual Studio 2017, was released only 10 days after the release of this IDE.  We began work on supporting the new VS much earlier - at the end of last year.  Of course, far from all the innovations in Visual Studio hurt the work of PVS-Studio, however, the latest release of this IDE turned out to be especially difficult for us in terms of supporting it in all components of our product.  The most heavily affected was not our ‚Äútraditional‚Äù C ++ analyzer (support for the new version of Visual C ++ was quite fast), but the components responsible for interaction with the MSBuild build system and the Roslyn platform (on which our C # analyzer is based). <br><br>  Also, the new version of Visual Studio was the first since the C # analyzer appeared in PVS-Studio (which we released in parallel with the first Roslyn release in Visual Studio 2015), and the C ++ analyzer on Windows was more closely integrated with the MSBuild build system.  Therefore, due to the difficulties encountered in updating these components, support for the new VS has become the most costly for us in the entire history of our product. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h2>  What solutions from Microsoft are used by PVS-Studio? </h2><br>  Most likely, you know, PVS-Studio is a static analyzer for C / C ++ / C # languages, running on Windows and Linux.  What does PVS-Studio consist of?  First of all, this is, of course, a cross-platform C ++ analyzer and a set of (mostly) cross-platform utilities for its integration into various building systems. <br><br>  However, on the Windows platform, most of our users use a technology stack for developing software from Microsoft, i.e.  Visual C ++ / C #, Visual Studio, MSBuild, etc.  For them, we have the tools to work with the analyzer from the Visual Studio environment (IDE plugin), and the command line utility for testing C ++ / C # MSBuild projects.  The same utility ‚Äúunder the hood‚Äù is also used by our VS plugin.  This utility for analyzing the structure of projects directly uses the API provided by MSBuild itself.  Our C # analyzer is based on the .NET Compiler Platform (Roslyn), and is currently only available for Windows users. <br><br>  So, we see that on the Windows platform, PVS-Studio uses Microsoft‚Äôs ‚Äúnative‚Äù tools for integration into Visual Studio, analysis of the build system and analysis of C # code.  With the release of the new version of Visual Studio, all these components have also been updated. <br><br><h2>  What has changed for us with the release of Visual Studio 2017 </h2><br>  In addition to updating versions of MSBuild and Roslyn, Visual Studio 2017 also contains a number of innovations that have touched our product.  Coincidentally, a number of our components ceased to work, which were used without any changes by us during several previous releases of Visual Studio, and some of them have been working since the days of Visual Studio 2005 (which we no longer support).  Let us consider in more detail these changes. <br><br><h3>  New order of installation of Visual Studio 2017 </h3><br>  The new <a href="https://docs.microsoft.com/en-us/visualstudio/install/install-visual-studio">modular installation system</a> , which allows the user to select only the components he needs to work, has been completely ‚Äúuntied‚Äù from using the Windows system registry.  Theoretically, this made the development environment more ‚Äúportable‚Äù, and allowed to install several different editions of Visual Studio on the same system.  All this, however, significantly influenced the developers of extensions, as  all the code that previously allowed to determine the presence of the installed environment itself or its individual components ceased to work. <br><br><p><img src="https://habrastorage.org/getpro/habr/post_images/b22/7f4/172/b227f4172f108d453264e2ba6fb2545a.png" alt="Figure 1 - New Visual Studio Installer"></p><br>  <font color="#999999"><i>Figure 1 - New Visual Studio Installer</i></font> <br><br>  To obtain information about the instances of Visual Studio installed on the system, developers are now encouraged to use COM interfaces, in particular, <a href="https://msdn.microsoft.com/en-us/library/microsoft.visualstudio.setup.configuration.isetupconfiguration(v%3Dvs.150).aspx">ISetupConfiguration</a> .  I think many will agree that the usability of COM interfaces is inferior to reading from the registry.  And if, for example, for the C # code at least the wrappers of these interfaces already exist, we had to work a lot to adapt our installer based on InnoSetup.  In fact, here Microsoft changed one Windows-specific technology to another.  In my opinion, the gain from such a transition is rather doubtful, especially since VS has so far failed to completely abandon the use of the registry.  At least in this version. <br><br>  A more significant consequence of this transition, in addition to the rather subjective ease of use, for us was the fact that it indirectly affected the work of the MSBuild 15 libraries used by us, and their backward compatibility with previous versions of MSBuild.  The reason for this is that the new version of MSBuild also stopped using the registry.  We had to update all the MSBuild components we use, because  Roslyn directly depends on them.  I will tell you more about the consequences of these changes later. <br><br><h3>  Changes in the C ++ MSBuild framework </h3><br>  By MSBuild infrastructure for C ++, I first of all mean the interlayer that is responsible for directly calling the compiler when building Visual C ++ projects.  This layer has the name PlatformToolset in MSBuild and is responsible for preparing the environment in which the C ++ compiler runs.  PlatformToolset also provides backward compatibility with previous versions of Visual C ++ compilers.  It allows you to work with the latest version of MSBuild to build projects that use previous versions of the Visual C ++ compiler. <br><br>  For example, you can build a project that uses the C ++ compiler from Visual Studio 2015 in MSBuild 15 / Visual Studio 2017, if this version of the compiler is installed on the system.  This can be useful, because  allows you to start using the new version of the IDE on the project right away, without first porting the project to the new version of the compiler (which is not always easy). <br><br>  PVS-Studio fully supports PlatformToolsets and uses the native MSBuild API to prepare the C ++ analyzer environment, thereby allowing the analyzer to check the source code as close as possible to how it is compiled. <br><br>  Such close integration with MSBuild made it possible for us earlier to fairly easily maintain the new versions of the C ++ compiler from Microsoft.  More precisely, to support his assembly environment, because  directly supporting compiler features (for example, syntax and header files using this syntax) is not included in the issues covered in this article.  We simply added a new PlatformToolset to the list of supported. <br><br>  In the new version of Visual C ++, the order of setting the compiler environment has undergone noticeable changes, again ‚Äúbreaking‚Äù our code that worked for all versions earlier, starting with Visual Studio 2010. And although PlatformToolsets from previous versions of the compiler still work, to support the new toolset I had to write a separate branch of code.  By a strange coincidence (and perhaps not a coincidence), MSBuild developers also changed the naming pattern of the C ++ toolset: v100, v110, v120, v140 in previous versions, and v141 in the latest version (while Visual Studio 2017 still has version 15.0). <br><br>  In the new version, the structure of vcvars scripts was completely changed, to which the deployment of the compiler environment is tied.  These scripts set the environment variables required for the compiler, complement PATH with paths to binary directories and system C ++ libraries, etc.  The analyzer also needs an identical environment for work, in particular, for preprocessing source files before starting the analysis itself. <br><br>  It can be said that the new version of the deployment scripts, in a sense, is made ‚Äúneater‚Äù, and, most likely, it is easier to maintain and expand (it is possible that the update of these scripts was caused by the inclusion of clang support in the new version of Visual C ++ compiler), but from the point of view of the developers of the C ++ analyzer, this added to our work. <br><br><h2>  C # PVS-Studio analyzer </h2><br>  Together with Visual Studio 2017, Roslyn 2.0 and MSBuild 15 were released. It may seem that to support these new versions in PVS-Studio C # it will be enough just to update the packages used by Nuget in your projects.  After that, our analyzer will immediately have access to all the ‚Äúgoodies‚Äù of new versions, such as support for C # 7.0, new types of .NET Core projects, etc. <br><br>  Indeed, updating the packages we use and rebuilding the C # analyzer was quite simple.  However, the very first launch of such a new version on our tests showed that ‚Äúeverything broke‚Äù.  Further experiments showed that the C # analyzer works correctly only on the system where Visual Studio 2017 \ MSBuild 15 is installed. Just the fact that our distribution contains the correct versions of the Roslyn \ MSBuild libraries we use was not enough.  The release of the new version of C # analyzer "as is" would entail a deterioration in the analysis results of all our users working with previous versions of C # compilers. <br><br>  When we created the first version of the C # analyzer that used Roslyn 1.0, we tried to make our analyzer as ‚Äúindependent‚Äù solution as possible, not requiring the user to have any third-party installed components in the system.  In this case, the main requirement for the user system is the collection of the checked project - if the project is collected, then it can be checked by the analyzer.  Obviously, on Windows, building Visual C # projects (csproj) requires at least an MSBuild and C # compiler. <br><br>  We immediately abandoned the idea of ‚Äã‚Äãrequiring our users to install the latest versions of MSBuild and Visual C # along with a C # analyzer.  If a user normally builds a project, for example, in Visual Studio 2013 (which in turn uses MSBuild 12), the requirement to install MSBuild 15 will look redundant.  We, on the contrary, try to lower the ‚Äúthreshold‚Äù to start using our analyzer. <br><br>  Microsoft's Web installers proved to be very demanding of the size of the downloads they need - while our distribution has a size of about 50 megabytes, the installer, for example, for Visual C ++ 2017 (which is also needed for the C ++ analyzer) estimated the amount of data to download at 3 gigabytes.  As a result, as we found out later, the presence of these components would still not be enough for the C # analyzer to work correctly. <br><br><h3>  How PVS-Studio interacts with Roslyn </h3><br>  When we first started developing our C # analyzer, we had 2 ways to interact with the Roslyn platform. <br><br>  The first option was to use the <i>Diagnostics API</i> analyzers specially created for the development of .NET.  This API provides the ability, inheriting from the abstract class <i>DiagnosticAnalyzer</i> , to implement its "diagnostics".  Using the <i>CodeFixProvider</i> class <i>,</i> users could implement automatic fixes for such warnings. <br><br>  The undoubted advantage of this approach is the full power of the existing infrastructure of Roslyn.  Diagnostic rules are immediately available in the Visual Studio code editor, they can be automatically applied both when editing code in the IDE editor and when starting a project reassembly.  This approach does not require the analyzer developer to open the project files and source files on his own - everything will be done as part of the work of the native Roslyn compiler.  If we would go this way initially, then we most likely would not have problems with switching to the new Roslyn, at least in this form, as now. <br><br>  The second option was to implement a fully autonomous analyzer, by analogy with how PVS-Studio C ++ works.  We stopped at it, because  decided to make the C # parser infrastructure as close as possible to the existing C / C ++ tool.  In the future, this made it possible to quickly adapt both the current C ++ diagnostics (of course, not all, but that part of them that was relevant for C #), and more ‚Äúadvanced‚Äù <a href="https://www.viva64.com/ru/b/0466/">analysis techniques</a> . <br><br>  Roslyn provides opportunities for the implementation of this approach: we open the Visual C # project files on our own, build syntax trees from the source code and implement our own mechanism for traversing them.  All this is done using the MSBuild and Roslyn APIs.  Thus, we got full control over all stages of the analysis, and do not depend on the work of the compiler or IDE. <br><br>  No matter how attractive the ‚Äúfree‚Äù integration with the Visual Studio code editor seemed to be, we chose to use our own IDE interface, as it presents much more features than the standard Error List (where such warnings will be issued).  Using the <i>Diagnostics API would</i> also limit us to compiler versions based on Roslyn, i.e.  coming together with Visual Studio 2015 and 2017, while the independent analyzer allowed us to support all previous versions. <br><br>  During the creation of the C # analyzer, we were faced with the fact that Roslyn was very tightly tied to MSBuild.  Of course, here I am talking about the Windows version of Roslyn, with the Linux version we, unfortunately, have not yet had to work, so I can not say how things are there. <br><br>  I will say right away that the Roslyn API for working with MSBuild projects, in my opinion, remains quite raw even in version 2.0.  When creating a C # analyzer, we had to write many different ‚Äúcrutches‚Äù, since  Roslyn incorrectly did some things (incorrectly = ‚Äúnot the way MSBuild would have done when building the same projects‚Äù), which eventually led to false positives and analysis errors when checking source files. <br><br>  Roslyn‚Äôs MSBuild obsession is what led to the problems we encountered when upgrading to Visual Studio 2017. <br><br><h3>  Roslyn and MSBuild </h3><br>  For the analyzer to work, we, for the most part, need to get two entities from Roslyn: the syntactic tree of the code being tested and the semantic model of this tree, i.e.  the value of syntactic constructions representing its nodes ‚Äî types of class fields, return values ‚Äã‚Äãand method signatures, etc.  And if to obtain a syntactic tree using Roslyn, it is enough to have a file with the source code, then to generate a semantic model of this file, it is necessary to compile the project that includes it. <br><br>  Updating Roslyn to version 2.0 resulted in errors in the semantic model on our tests (as indicated by the <a href="https://www.viva64.com/ru/w/V051/">V051</a> messages of the analyzer).  Such errors usually manifest themselves in the results of the analyzer as falsely negative / false positives, i.e.  some good messages disappear and bad messages appear. <br><br>  For the semantic model Roslyn provides the so-called.  Workspace API, which can open. NET MSBuild projects (in our case it is csproj and vbproj) and get the ‚Äúcompilation‚Äù of such projects.  In this context, we are talking about the <i>Compilation</i> service class object in Roslyn, which abstracts in itself the preparation and call of the C # compiler.  From such a ‚Äúcompilation‚Äù we can get directly the semantic model.  Errors in compilation ultimately lead to errors in the semantic model. <br><br>  Now let's look at how Roslyn interacts with MSBuild to get a ‚Äúcompilation‚Äù of the project.  The following is a diagram illustrating this interaction in a simplified form: <br><br><p><img src="https://habrastorage.org/getpro/habr/post_images/1a6/c37/660/1a6c37660470fbdc173909813e7987c6.png" alt="Figure 2 - Roslyn and MSBuild interaction diagram"></p><br>  <font color="#999999"><i>Figure 2 - Roslyn and MSBuild interaction diagram</i></font> <br><br>  The diagram is divided into 2 segments - PVS-Studio and Build Tools.  The PVS-Studio segment contains components that come with our analyzer in the distribution kit - MSBuild and Roslyn libraries that implement the APIs we use.  The Build Tools segment includes an assembly system infrastructure that must be present in the system for the API data to work correctly. <br><br>  After the analyzer has requested a compilation object from the Workspace API (to obtain a semantic model), Roslyn launches the project build, or, in MSBuild terminology, execution of the csc assembly task.  After starting the assembly, control passes to MSBuild, which performs all the preparatory steps in accordance with its build scripts. <br><br>  It should be noted that this is not a ‚Äúnormal‚Äù build (it will not lead to the generation of binary files), but the so-called  design mode.  The ultimate goal of this step is to get Roslyn all the information that would have been provided to the compiler during the "real" build.  If the assembly is tied up with some pre-assembly steps (for example, running scripts to auto-generate part of the source files), all such actions will also be performed by MSBuild, as if it were a normal assembly. <br><br>  Having obtained the management, MSBuild, or rather, the library that comes with PVS-Studio, will start searching the system for the installed build tools (toolsets).  Having found a suitable toolset, it will attempt to instantiate the steps described in the build script.  Toolsets correspond to MSBuild instances installed on the system.  For example, MSBuild 14 (Visual Studio 2015) installs the toolset 14.0, MSBuild 12 - 12.0, etc. <br><br>  The toolset contains all typical build scripts for MSBuild projects.   (, csproj)        (,    ). Toolset   ,      :    ,    .      ,   MSBuild,   ,         (..  MSBuild ,    PVS-Studio)     . <br><br>     Build Tools.     csc. MSBuild   ,     ,      tasks   toolset'. Tasks  ‚Äî  xml ,    ,    task'.          ,    csc.          (   command line  csc.exe).   ,   ¬´¬ª ,  ,    ,    .  Roslyn          ‚Äî         (      ,    ),    , \    .. <br><br>  ,   -    - ¬´  ¬ª, Roslyn          ,    , ..      MSBuild Execution API.        (      MSBuild Evaluation API).          .     ‚Äî   .NET Core ,          ‚Äî    ,     .     ¬´¬ª csproj            (define')   ,          . <br><br><h3>  Something went wrong </h3><br> , ,   ,     ,   ¬´¬ª PVS-Studio   C# , ,      Roslyn  MSBuild.      ,   Build Tools    PVS-Studio  ¬´  ¬ª , ,   .   ,       MSBuild  ,      ,       .    ,        Visual C#,   2010  Visual Studio.   Roslyn      C#       Visual Studio ‚Äî 2015. <br><br>  ,   ,    ,   MSBuild 15.       Visual Studio 2015 (MSBuild 14).         ¬´¬ª  Roslyn ‚Äî   MSBuild      toolset.  toolset  , MSBuild   toolset   ‚Äî      MSBuild .  And since Roslyn 2.0     MSBuild 15,    toolset'    . <br><br>    ,   toolset   , MSBuild   toolset  ‚Äî  ¬´¬ª     ,   toolset 4- .  4-?    toolset   4-   MSBuild    ,   .NET Framework 4 (   MSBuild   framework').      targets ,  csc task' ,   ,      . <br><br>            Roslyn? -,     ,     Visual Studio 2015, ..  ( Roslyn 1.0)  MSBuild  . <br><br> -,   MSBuild,    ,       , ,  ,    toolset'.      MSBuild   toolset'  ,  MSBuild 15     config    MSBuild.exe.   MSBuild  ¬´ ¬ª ‚Äî      <i>c:\Program Files (x86)\MSBuild\%VersionNumber%</i> ,           Visual Studio (       ). <br><br>    ¬´¬ª   toolset    ‚Äî       .  ,        toolset ,         ‚Äî      app.config  MSBuild.exe,    ,       MSBuild.exe,   PVS-Studio_Cmd.exe.     MSBuild      .     COM ,       <i>ISetupConfiguration</i> , MSBuild   toolset    Visual Studio. , standalone  MSBuild,  ,  COM    ‚Äî     Visual Studio. <br><br> , , -, ,    ,  ,         ,       .  ,         ,  Visual Studio 2015 \ MSBuild 14.  ,        ,        . <br><br>   Roslyn  ,         toolset.  ,   toolset  ¬´¬ª?   ,     MSBuild API   C++    C++ .  Since      ,      .  , Roslyn    ,  toolset   ,       (   , ..      Nuget ).           . ,        .      ? <br><br>   ,   ,     ,        ‚Äî PVS-Studio_Cmd.exe. ,     toolset'     dll .     Roslyn 2.0,   , ,  Microsoft.CodeAnalysis.dll,    2.0.             PVS-Studio_Cmd.exe ( C# ). ,      2015 Visual Studio,     toolset 14.0. , MSBuild   tasks    .  Since C#    toolset' (,    Visual Studio 2015)  Roslyn  1.3, , , MSBuild      Microsoft.CodeAnalysis.dll  1.3.     , ..           . <br><br>       ?         AppDomain'?      Roslyn (..   ,    ),      \      , ..        ,   workspace',     . <br><br>      C#    backend      C++  C#  solution ,   2   backend' ‚Äî  Roslyn 1.0  2.0 .        : <br><br><ul><li>       (,          ); </li><li>      (  ifdef'        C# 7.0); </li><li> , ,  ‚Äî           Roslyn. </li></ul><br>      .    Visual Studio 2015   3 ,        Roslyn  ‚Äî  1.0  1.3.   , ,  2.1  ,    backend',         ,           ,      Visual Studio. <br><br>  ,          toolset',   Roslyn, ,  12.0 (Visual Studio 2013).   ,      , ..      ,     . <br><br><h3>          C#  </h3><br>     ,     ¬´¬ª toolset  15.0  .           Roslyn         Visual Studio (          C#).    ,         ¬´¬ª MSBuild 15: <br><br><ul><li>      web  MSBuild; </li><li>       Visual Studio 2017; </li><li>   MSBuild     (c toolset')    Visual Studio 2017. </li></ul><br> ,    ,   Roslyn   ,  ,             Roslyn  MSBuild (,  Roslyn  ¬´¬ª ,    csc.exe   ). ,   toolset'      props  targets ,    toolset  .    xml    MSBuild ,      ‚Äî         . <br><br>    , ,  ¬´¬ª  MSBuild     ¬´¬ª toolset  .   MSBuild   : <i>Running without any defined toolsets. Most functionality limited. Likely will not be able to build or evaluate a project. (eg reference to Microsoft.*.dll without a toolset definition or Visual Studio instance installed)</i> .    ,    MSBuild ,     -    ,     MSBuild.exe.      ,     ,  ¬´     ¬ª. <br><br>     MSBuild 15   toolset? ,   toolset   app.config   MSBuild.exe. ,          (PVS-Studio_Cmd.exe)     MSBUILD_EXE_PATH         .    !      MSBuild    Release Candidate 4.      ,     master  MSBuild  GitHub'.      ,  master'    toolset'    ‚Äî   appconfig' toolset   ,      MSBuild.exe.        0    MSBuild.exe,       MSBUILD_EXE_PATH   PVS-Studio_Cmd.exe. <br><br>      MSBuild  . ,   toolset'   ,   MSBuild ‚Äî   . ,      WebApplication, Portable, .NET Core .     Visual Studio,         MSBuild.   ¬´¬ª MSBuild  ,  ,  .        ¬´ ¬ª toolset.       ( MSBuildExtensionsPath)  toolset'    ,   PVS-Studio_Cmd.exe       . ,     WebApplication   Visual Studio 2015, , ,     , ,   extension'  toolset'  14.0,          .    MSBuild        props\targets ,       . <br><br>   C#            Visual Studio,    -  MSBuild.           -     MSBuild,     toolset',            PVS-Studio. <br><br><h2> PVS-Studio , Lightweight Solution Load </h2><br>    Visual Studio 2017,     ,    ,     ‚Äî ¬´lightweight solution load¬ª. <br><br><p><img src="https://habrastorage.org/getpro/habr/post_images/dca/166/61b/dca16661bdb10b02aec90335656e4e5d.png" alt=" 3 - lightweight solution load"></p><br> <font color="#999999"><i> 3 ‚Äî lightweight solution load</i></font> <br><br>       IDE    ,       .    ¬´lightweight solution load¬ª      (  )    Visual Studio.    (         )    :     (    ),  .        <a href="https://docs.microsoft.com/en-us/visualstudio/ide/optimize-visual-studio-startup-time"><u></u></a> . <br><br>            : <br><br><ul><li>  ,       ,      ,      IDE; </li><li>        ; </li><li>  ¬´ ¬ª,   ,      PVS-Studio  Visual Studio 2017       . </li></ul><br>      ,   ,         . ,  ,         Visual Studio 2017    ¬´lightweight solution load¬ª,   <a href="https://docs.microsoft.com/en-us/visualstudio/extensibility/lightweight-solution-load-extension-impact"><u></u></a> . <br><br>    ¬´ ¬ª,      RC Visual Studio ¬´ ¬ª  Microsoft    ,         ,     .   ‚Äî   ,  ,           PVS-Studio. <br><br>   ?   ,          ,    Visual Studio 2  ‚Äî      Visual Studio,  2-  ‚Äî    Visual Studio SDK (   Visual Studio ).  -   Visual Studio SDK   RC      Visual Studio 2017.  ..        SDK   (    ,    ‚Äì       ),        .  ,        PVS-Studio,    .    ,     ,                . <br><br><h2>  Conclusion </h2><br>  Visual Studio 2017   ¬´¬ª    PVS-Studio     .       ‚Äî     MSBuild\Visual Studio,  C#    PVS-Studio (    ). <br><br>           C#,  ,   Roslyn      .      ‚Äî       4 .   , ,     C++ ,               C#.    .    ,          ¬´¬ª,        Roslyn / Visual Studio.       C#,  Roslyn, -      (  MSBuild  Visual Studio),      .  Roslyn  MSBuild      standalone  . <br><br>    ,      ¬´¬ª  C++    -  , , Clang.  ,            C++ . ,        ,   ,          ¬´ ¬ª,      . <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/8d2/41b/5bf/8d241b5bf34747169141ed7c1997143b.png"></div><br><br>        ,      : Paul Eremeev. <a href="http://www.viva64.com/en/b/0503/">Support of Visual Studio 2017 and Roslyn 2.0 in PVS-Studio: sometimes it's not that easy to use ready-made solutions as it may seem</a> <br><br><div class="spoiler">  <b class="spoiler_title">Read the article and have a question?</b> <div class="spoiler_text">  Often our articles are asked the same questions.  We collected answers to them here: <a href="http://www.viva64.com/ru/a/0085/">Answers to questions from readers of articles about PVS-Studio, version 2015</a> .  Please review the list. </div></div></div><p>Source: <a href="https://habr.com/ru/post/327874/">https://habr.com/ru/post/327874/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../327860/index.html">New processor architecture solves the problem of combinatorial optimization</a></li>
<li><a href="../327862/index.html">Experiments on the Olympiad problem</a></li>
<li><a href="../327866/index.html">Continuation of the experiment: passers-by draw famous logos from memory</a></li>
<li><a href="../327868/index.html">Authentication in OpenSSH Putty by JaCarta PKI</a></li>
<li><a href="../327872/index.html">Benefits of the Hierarchical Work Structure (WBS) for IT project managers</a></li>
<li><a href="../327882/index.html">Pitfalls during project team meetings</a></li>
<li><a href="../327886/index.html">SeaMonkey Project officially requests support</a></li>
<li><a href="../327888/index.html">Ros. Navigation stack</a></li>
<li><a href="../327890/index.html">Ruby on Rails agreement. Part 1</a></li>
<li><a href="../327892/index.html">Email is personal data?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>