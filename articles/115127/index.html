<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>"Correct" html parsing</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The first time I launched Eclipse in the spring, read books in English, installed the SDK, played a little and abandoned it. At the beginning of winte...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>"Correct" html parsing</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage/habraeffect/5e/35/5e35d0784ed5c88de9fdc62eb4b0685d.jpg" alt="Logo"><br><br>  The first time I launched Eclipse in the spring, read books in English, installed the SDK, played a little and abandoned it.  At the beginning of winter, I bought myself the first Android-based smartphone, but once again I was pushed back to the development by a recent post, which said that you can do with the knowledge of C #, which, unlike Java, I am familiar with.  One evening was enough for me to understand that I would not sit down for a bunch of Visual Studio and Monodroid, I later read this <a href="http://www.codeproject.com/Articles/149715/MonoDroid-Part-1-Installation.aspx">post</a> , where I fully agreed with the author. <br><br>  After a short introduction, I‚Äôll move on to the topic topic.  Quite a large number of applications for mobile devices interact with sites and it is no secret that sometimes you need to get some information from the page - this can be the exchange rate or something else, and there is no desire to do this through a browser. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Most developers get the html code of the page and overtake it in xml, which is the wrong approach, because html is the ‚Äúcorrect‚Äù xml is not always, like they wrote in Habr√© that the html tag is not required for the browser (a modern browser should display the page without it ) or there will simply be errors, then <a href="http://java-source.net/open-source/html-parsers">libraries</a> come to the rescue.  Of these, I chose <a href="http://htmlcleaner.sourceforge.net/">HtmlCleaner</a> . <br><br>  Under the cut, I'll tell you how to connect this library, and also write a simple parser at stackoverflow.com. <br><a name="habracut"></a><br>  I will not tell you how to install the Android SDK, Eclipse and ADT Plugin, if these words do not tell you, then visit these two links: <br>  <a href="http://developer.android.com/sdk/installing.html">Installing the SDK</a> <br>  <a href="http://developer.android.com/sdk/eclipse-adt.html">ADT Plugin for Eclipse</a> <br><br>  The main page on stackoverflow.com is as follows: <br><br><img src="https://habrastorage.org/storage/habraeffect/29/9e/299e6349844d71d0f6248c155099420f.png" alt="Home page"><br><br>  I will parse the information highlighted by the red rectangles. <br><br>  Everything is designed for beginners, so there will be a lot of pictures.  At this stage, you should have a fully configured Eclipse, to create a project, click File -&gt; New -&gt; Project ... and select the Android Project, then fill out the form: <br><br><img src="https://habrastorage.org/storage/habraeffect/2b/23/2b23a9dfa83227f96cd0a55526978cfc.png" alt="New project"><br><br>  I am writing for my device, so I chose version 2.2, the second important parameter is the package name, which should be unique, it is accepted that this is the name of the site on the contrary, plus the name of the application.  Tests will not create, so feel free to click Finish.  A project has been created, I recommend that you study which files and where they are, but I‚Äôll say from my own experience that I was immediately scared of the number of files that appeared when Eclipse first started. <br><br>  Let's start editing the res \ layout \ main.xml file, here I‚Äôll delete the TextView and add two controls: Button and ListView, change the identifiers, install the android for the button: layout_width = "fill_parent" and android: text = "Get data".  The finished result looks like this: <br><br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="utf-8"</font> ? <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">LinearLayout</font> <font color="#ff0000">xmlns:android</font> <font color="#0000ff">="http://schemas.android.com/apk/res/android"</font> <br> <font color="#ff0000">android:orientation</font> <font color="#0000ff">="vertical"</font> <br> <font color="#ff0000">android:layout_width</font> <font color="#0000ff">="fill_parent"</font> <br> <font color="#ff0000">android:layout_height</font> <font color="#0000ff">="fill_parent"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">Button</font> <font color="#ff0000">android:id</font> <font color="#0000ff">="@+id/parse"</font> <br> <font color="#ff0000">android:layout_height</font> <font color="#0000ff">="wrap_content"</font> <br> <font color="#ff0000">android:layout_width</font> <font color="#0000ff">="fill_parent"</font> <br> <font color="#ff0000">android:text</font> <font color="#0000ff">=" "</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">Button</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">ListView</font> <font color="#ff0000">android:id</font> <font color="#0000ff">="@+id/listViewData"</font> <br> <font color="#ff0000">android:layout_height</font> <font color="#0000ff">="wrap_content"</font> <br> <font color="#ff0000">android:layout_width</font> <font color="#0000ff">="match_parent"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">ListView</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">LinearLayout</font> <font color="#0000ff">&gt;</font></font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  This is the simplest interface, in case you make an application and decide to publish it in the market, you must change it, put the same background through android: background = "@ drawable / File_No_expansion", etc. <br><br>  For parsing we need to download the <a href="http://htmlcleaner.sourceforge.net/download.php">htmlcleaner-2.2.jar library</a> , then it should be added by adding to Build Paths.  A good manual how to do this can be found <a href="http://www.wikihow.com/Add-JARs-to-Project-Build-Paths-in-Eclipse-(Java)">here</a> if you have any difficulties. <br><br>  First of all, you need to specify that our application needs the Internet, otherwise it will not work for you, we will add to the AndroidManifest.xml file: <br><br><blockquote> <code><font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">uses-permission</font> <font color="#ff0000">android:name</font> <font color="#0000ff">="android.permission.INTERNET"</font> <font color="#0000ff">/&gt;</font></font> <br></code> </blockquote><br>  Now we create the HtmlHelper class, which will do the main work: <br><br><blockquote> <code><font color="black"><font color="#0000ff">public</font> <font color="#0000ff">class</font> HtmlHelper { <br> TagNode rootNode; <br> <br> <font color="#008000">//</font> <br> <font color="#0000ff">public</font> HtmlHelper(URL htmlPage) throws IOException <br> { <br> <font color="#008000">//  HtmlCleaner</font> <br> HtmlCleaner cleaner = <font color="#0000ff">new</font> HtmlCleaner(); <br> <font color="#008000">// html  </font> <br> rootNode = cleaner.clean(htmlPage); <br> } <br> <br> <font color="#2B91AF">List</font> &lt;TagNode&gt; getLinksByClass( <font color="#2B91AF">String</font> CSSClassname) <br> { <br> <font color="#2B91AF">List</font> &lt;TagNode&gt; linkList = <font color="#0000ff">new</font> <font color="#2B91AF">ArrayList</font> &lt;TagNode&gt;(); <br> <br> <font color="#008000">//  </font> <br> TagNode linkElements[] = rootNode.getElementsByName( <font color="#A31515">"a"</font> , <font color="#0000ff">true</font> ); <br> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; linkElements != <font color="#0000ff">null</font> &amp;&amp; i &lt; linkElements.length; i++) <br> { <br> <font color="#008000">//   </font> <br> <font color="#2B91AF">String</font> classType = linkElements[i].getAttributeByName( <font color="#A31515">"class"</font> ); <br> <font color="#008000">//      ,    </font> <br> <font color="#0000ff">if</font> (classType != <font color="#0000ff">null</font> &amp;&amp; classType.equals(CSSClassname)) <br> { <br> linkList.add(linkElements[i]); <br> } <br> } <br> <br> <font color="#0000ff">return</font> linkList; <br> } <br> }</font> <br></code> </blockquote><br><br>  In the main class, we set the listener for the button and call asynchronously parsing using <a href="http://developer.android.com/reference/android/os/AsyncTask.html">AsyncTask</a> , I immediately did using stream creation and then updated the interface through the handler, but I read that this is not the best solution and AsyncTask is better for this purpose that the application is running, I will call a dialog that will inform about the process.  Actually the main class is as follows: <br><br><blockquote> <code><font color="black"><font color="#0000ff">public</font> <font color="#0000ff">class</font> StackParser extends Activity { <br> <font color="#008000">/** Called when the activity is first created. */</font> <br> @Override <br> <font color="#0000ff">public</font> <font color="#0000ff">void</font> onCreate(Bundle savedInstanceState) { <br> super.onCreate(savedInstanceState); <br> setContentView(R.layout.main); <br> <br> <font color="#008000">// </font> <br> Button button = (Button)findViewById(R.id.parse); <br> <font color="#008000">// onClick </font> <br> button.setOnClickListener(myListener); <br> } <br> <br> <font color="#008000">// </font> <br> <font color="#0000ff">private</font> ProgressDialog pd; <br> <font color="#008000">// OnClickListener   </font> <br> <font color="#0000ff">private</font> OnClickListener myListener = <font color="#0000ff">new</font> OnClickListener() { <br> <font color="#0000ff">public</font> <font color="#0000ff">void</font> onClick(View v) { <br> <font color="#008000">//  </font> <br> pd = ProgressDialog.show(StackParser. <font color="#0000ff">this</font> , <font color="#A31515">"Working..."</font> , <font color="#A31515">"request to server"</font> , <font color="#0000ff">true</font> , <font color="#0000ff">false</font> ); <br> <font color="#008000">// </font> <br> <font color="#0000ff">new</font> ParseSite().execute( <font color="#A31515">"http://www.stackoverflow.com"</font> ); <br> } <br> }; <br> <br> <font color="#0000ff">private</font> <font color="#0000ff">class</font> ParseSite extends AsyncTask&lt; <font color="#2B91AF">String</font> , Void, <font color="#2B91AF">List</font> &lt; <font color="#2B91AF">String</font> &gt;&gt; { <br> <font color="#008000">// </font> <br> <font color="#0000ff">protected</font> <font color="#2B91AF">List</font> &lt; <font color="#2B91AF">String</font> &gt; doInBackground( <font color="#2B91AF">String</font> ... arg) { <br> <font color="#2B91AF">List</font> &lt; <font color="#2B91AF">String</font> &gt; output = <font color="#0000ff">new</font> <font color="#2B91AF">ArrayList</font> &lt; <font color="#2B91AF">String</font> &gt;(); <br> <font color="#0000ff">try</font> <br> { <br> HtmlHelper hh = <font color="#0000ff">new</font> HtmlHelper( <font color="#0000ff">new</font> URL(arg[0])); <br> <font color="#2B91AF">List</font> &lt;TagNode&gt; links = hh.getLinksByClass( <font color="#A31515">"question-hyperlink"</font> ); <br> <br> <font color="#0000ff">for</font> (Iterator&lt;TagNode&gt; iterator = links.iterator(); iterator.hasNext();) <br> { <br> TagNode divElement = (TagNode) iterator.next(); <br> output.add(divElement.getText().toString()); <br> } <br> } <br> <font color="#0000ff">catch</font> (Exception e) <br> { <br> e.printStackTrace(); <br> } <br> <font color="#0000ff">return</font> output; <br> } <br> <br> <font color="#008000">//   </font> <br> <font color="#0000ff">protected</font> <font color="#0000ff">void</font> onPostExecute( <font color="#2B91AF">List</font> &lt; <font color="#2B91AF">String</font> &gt; output) { <br> <font color="#008000">//  </font> <br> pd.dismiss(); <br> <font color="#008000">// ListView</font> <br> ListView listview = (ListView) findViewById(R.id.listViewData); <br> <font color="#008000">//     doInBackground</font> <br> listview.setAdapter( <font color="#0000ff">new</font> ArrayAdapter&lt; <font color="#2B91AF">String</font> &gt;(StackParser. <font color="#0000ff">this</font> , <br> android.R.layout.simple_list_item_1 , output)); <br> } <br> } <br> }</font> <br></code> </blockquote><br><br>  If you did everything with me, then you should have obtained the following file hierarchy: <br><br><img src="https://habrastorage.org/storage/habraeffect/a6/91/a691670a8a416ce1eb41f9946ef548d9.png" alt="Files"><br><br>  And after starting the application should look like this: <br><br><img src="https://habrastorage.org/storage/habraeffect/4e/2f/4e2fdbe144a06a17be2629adc873b1c1.png" alt="application screenshots"><br><br>  Download link: <a href="">application</a> <br><br><h4>  Conclusion </h4><br>  We learned that there are quite a lot of libraries for parsing, got acquainted with one of them, wrote an application that parses the site in the background and, when ready, shows us the result of its work.  In principle, it can be further developed, after which it is possible that it will become popular in certain circles, the first thing that comes to mind is when you click on a question to open this question in a new window through WebView. <br><habracut></habracut></div><p>Source: <a href="https://habr.com/ru/post/115127/">https://habr.com/ru/post/115127/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../115111/index.html">Opera launched Opera Mobile Store</a></li>
<li><a href="../115115/index.html">Updated version of Speedtest.net</a></li>
<li><a href="../115118/index.html">About why we will use HTML (5) instead of Silverlight</a></li>
<li><a href="../115122/index.html">Android Development Tutorial. Part 2/?</a></li>
<li><a href="../115124/index.html">Adobe released Flash to HTML5 Converter</a></li>
<li><a href="../115129/index.html">Vertex data normalization: getGenders</a></li>
<li><a href="../115135/index.html">Simple HTML parsing library</a></li>
<li><a href="../115136/index.html">Web Platform Installer: review of the third version</a></li>
<li><a href="../115137/index.html">How to write a game in two days</a></li>
<li><a href="../115139/index.html">Supercomputer on the third generation of Loongson processors</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>