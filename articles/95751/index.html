<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The parochial "Pionernet" with the eyes of a technician. Part two</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="So, the notes of the technician about the realities of the small town ‚ÄúPionernet‚Äù are continuing. 
 The first part turned out to be interesting, albei...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The parochial "Pionernet" with the eyes of a technician. Part two</h1><div class="post__text post__text-html js-mediator-article">  So, the notes of the technician about the realities of the small town ‚ÄúPionernet‚Äù are continuing. <br>  <a href="http://razersun.habrahabr.ru/blog/95220/">The first part</a> turned out to be interesting, albeit with a bias in ‚Äúorganizational problems‚Äù. <br>  I will try to fill the gap and recall the technical aspects of the work.  In particular: the organization of the overall network structure, the modernization of the segments without decommissioning, laying and terminating optical cables. <br>  Welcome under the cat: <br><a name="habracut"></a><br><br><h4>  Network structure </h4><br>  Perhaps it is worth noting that the city is relatively modern, the number of floors of the building is mainly 5-9-16 floors.  Geographically, it consists of two ‚Äúmacro-districts‚Äù distant from each other, divided into ‚Äúmicro-districts‚Äù of 20-40 houses each. <br>  When I first started working, the optical backbone network was made in the form of two rings covering ‚Äúmacro districts‚Äù, with one point of presence per ‚Äúmicrodistrict‚Äù, from which chains of blunt switches on copper twisted pair diverged from house to house.  Connectivity between the "macro-regions" was organized by the leased fiber of one of the "opsos". <br>  If you try to recall the scheme, then it resembled the scheme of the Moscow metro, from which a part was removed within the circle line, and looked like this: <br><img src="https://habrastorage.org/storage/habraeffect/8c/6e/8c6e18a71277d998f87a7e73bb9cc4c8.png" alt="image"><br>  At that time, we wanted to get a stable, mainline star, from which only later to organize a smart level of access. <br><br><h5>  First stage.  How it was. </h5><br>  The optical network itself was a terrifying view.  Multimode fiber in places already crumbling from old age, covered with splice plates.  Long probes could easily be made from several pieces of cable of different fibers, manufacturer, and even b / usnosti.  Couplings at the welding sites were rare - most of the connections were packed in a cassette and put in a ‚Äúbeer bottle‚Äù, hanging upside down. <br>  The ending in the boxes also did without crosses.  Cable, fiber, splice plates and tails were tied with twisted pair pieces to plywood, and went into a switch.  At points that were considered ‚Äúexemplary,‚Äù a cassette was used instead of plywood. <br>  The situation was quite normal when a single-mode eight-fiber two-module cable leaving a point, on the way, in a bottle, turned into a single-module one, then, in another bottle, it diverged into two multi-mode 4 fiber cables - one went further into the ring, and another one of some kind of organization ... <br>  Naturally, this structure did not suffer from quality and stability since birth. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      There were no circuits for optical connections and cross-connects.  We collected fragmentary information about the cable structure, which was stored in the heads of installation and engineering, and began to think. <br>  At first, a week without getting out of the roofs, on a satellite image of the city in the ‚ÄúSAS Planet‚Äù, they estimated with the routes an approximate diagram of the passage of cables, climbed into all points and bottles, as they could trace the cross.  Then they forced the authorities to order a used reflectometer and welding machine. <br>  Dumas ended with the purchase of a bay of 8 fiber single-mode and single-module cables, couplings, 19 inch equipment boxes, crosses and piles of optical passivation. <br>  A month later, we received a technique: an Anritsu reflectometer and an Ericsson FSU 905 welding machine, which to this day serve us faithfully.  A month later came the materials. <br>  From that day on, it was announced ‚ÄúAbsolutely not‚Äù to bottles and splice plates. <br><br><h5>  Laying a new structure. </h5><br>  Jointly, we decided that we would fix the 8 fiber cable in separate sections along the route of the old rings, and unfold the rings into stars as they were laid, with the collection at the aggregation points.  In total, 15 rays of a star in one center and 11 in another were counted, the rings were disconnected on the opposite diameter from the center of aggregation, and each point was switched through its WDM-SFP into its fiber. <br>  They did it as follows: In the center, two ports with conventional duplex SFPs were allocated - in them, already with new fiber, the old ring was decreasing as it worked, and 16 ports with WDM modules.  The cable in the aggregation center was welded to the cross, and the first fibers were connected to the six ports of the switch, the last pair was used to support the old structure. <br>  Then, next to the existing one on the ring point, they installed a new box and an electrician for equipment transfer, hung a section of cable, scalded it, transferred equipment, switched a point to one fiber in a new cable, the rest of the fibers were crossed through, except for the last pair that went to the old cable and closed the ever decreasing ring. <br>  Both structures worked simultaneously, only one grew and the second squeezed: <br><img src="https://habrastorage.org/storage/habraeffect/d6/f0/d6f0f01e39045b1dcc2de747733fbe39.png" alt="image"><br>  When three points remained in the ring, and the last two fibers were involved on each side, they did not disturb them, laid, terminated and crossed the last sections of the new cable, then the engineers and installers went to the night shift, and in 5 hours of a tight schedule moved and switched all three points. <br><br>  The second "makrorayon" was remade in the same way.  There we did without night work, because the star had 11 rays, and 16 fibers were enough to narrow the ring to two points, and then open the ring and switch them to 1 fiber.  We even had a reserve of 4 fibers, well, he does not pull a pocket.  True, in the first ‚Äúmacro-district‚Äù we have no spare fibers left, since  15 of them were used in the star, and one more from each side we used to connect aggregation centers to each other, but this problem is now being solved. <br><br><h5>  What happened. </h5><br>  Thus, we got two logical stars on virtually the same rings that were in the beginning.  But now each point was completely independent of the performance of the others, equipped with uninterrupted power, optical cross-country, plus we got rid of ‚Äújinn in bottles‚Äù.  In addition, they made their own link between the aggregation points, leaving the rented fiber as a hot reserve. <br><img src="https://habrastorage.org/storage/habraeffect/12/8c/128c4b1f5328084fba6c56acb4bbc182.png" alt="image"><br>  The idle time of the point and the microdistrict dependent on it, on average, 2-4 hours is quite an acceptable result, given the volume and complexity of the work. <br>  As they were laid, the old sections, and the boxes where the equipment was located, were dismantled.  The removed pieces of optics, organoleptically and by reflectograms, were checked for aptitude, and sent to the warehouse.  The boxes and the best part of the cables were later used when replacing copper inter-house communications. <br><br><h4>  Second phase.  Access level. </h4><br>  After putting the stars into operation, there were practically no problems on the highways.  To this day, the inconvenience is delivered only by long-term power outages, which the bespereboyniki cannot cope with, but this is apparently chronic. <br>  But with the growth of the network and the number of subscribers other problems began to emerge - stupid switches on a twisted pair did not cope with the load from one and a half - two hundred clients in the segment.  There are customers who have organized their own "access" networks, with rings and broadband storms from all kinds of borg and ice chats. <br>  There is a need to solve customer access problems. <br>  For this it was necessary to ‚Äúumnify‚Äù at home.  And at the same time really do FTTB.  At one to five access houses decided to put one switch in the middle of the house, in the attic.  In multiple-access buildings - one switch to five entrances. <br>  It was decided to connect the switches into rings, which are closed on the rays of the main star. <br><br>  For tests and development of technology, we chose one of the most densely populated, and therefore problematic areas, consisting of three huge round houses in 25-30 entrances, and several 3-4 family access dormitories.  By approximate calculations it turned out 23 points, in fact it turned out 25. <br>  For a couple of months, we purchased a cable, the same as for the highways ‚Äî I liked it very much, the switches ‚Äî by the decision of the authorities ‚Äî dlink, 3526 models on houses and 3028G on a star beam, and proceeded to installation. <br>  Physically it was impossible to close the cable to the ring in any way, so they were laid in both directions to the extreme points, but the switches switched on overlapping switches. <br>  The link, coming out of the root switch to the first horn, fell not on the next in order - but through one from it and so on until the end of the ‚Äúhorn‚Äù.  There he turned around and walked back through the missed switches of the first half, past the root, to the other end of the horn.  There he turned around again and, with passes in the second horn, returned to the root. <br><img src="https://habrastorage.org/storage/habraeffect/a1/aa/a1aa6468450ec7b347a13757cf2fec9e.png" alt="image"><br>  The resulting ring, according to RSTP, is opened by one of the switches in the middle, which in the event of a signal loss from one side turns to the other, if it is turned off by itself, it simply physically breaks it. <br>  The circuit is simple and stable.  When de-energized on one switch, we lose only it.  To lose the whole ring is entirely at risk only if two adjacent points are disconnected simultaneously.  But this was in my memory once when half of the neighborhood was disconnected. <br>  Client transfer was carried out gradually, after commissioning of the entire ring.  As the transfer proceeded, the copper structure was dismantled, all customers were reduced to smart equipment.  It was partially used, so we could not immediately turn it off, we did the same as with the optics in the old ring.  When customers were carried away from the previous switch, the next one was switched on with a temporary cable from the optical one closest to it. <br><br>  All work took two months, fixing the erection teams of the assembly team allowed during the transfer - about a month.  After that, the neighborhood from the accident generator turned into one of the most silent harbors of the network.  For the second year, 5-7 emergency tickets are received from there per month, no more. <br>  As a result, according to the results of the installation and a couple of months of operation, the scheme was approved for further use. <br>  In the same way, we remade another 9 micro-districts in the first ‚Äúmacro-district‚Äù, and 7 in the second.  The average length of the rings is from 12 to 30 switches.  Given that the rings are mostly passive, and only pass BPDU packets - the convergence time is about 5 seconds. <br><br>  In one neighborhood, the scheme had to be slightly changed.  The development did not allow one ring to cover the entire neighborhood.  Therefore, a small ring of 12 switches covering half the microdistrict was made, and a separate cable was connected to seven houses remote from the rest of the houses.  For them purchased a media converter chassis, and a Dlink 3100-24 switch.  Each of the switches on these houses was switched on via a SFP bundle converter to 3100-24.  It turned out a kind of regional "mini star". <br>  But the feature on this site is not in the circuit, but in the method of unwinding the cable.  Since it was laid in one piece with end-to-end plants to the places of future installation of equipment, it was decided not to cut it at the points, but to get one fiber each.  As a result, two centimeter notches were made directly on the cable at a distance of 40-50 cm and the module was opened.  In one incision, the desired fiber was sought and eaten, after which the incision was sealed.  The cut fiber was carefully removed in the second cut and terminated.  The incision site and the fiber supply were retracted to the cassette, and the end switch went to the switch. <br>  The work is difficult and almost jewelry.  I spent a week and a half on splitting seven points, but it was worth it.  When in the future, when repairing roofs, our cable was bent almost 180 degrees, and judging by the trace of free fiber, in this place, even after extension, there was a decent signal drop - none of the points stopped working.  If there were 5-7 connectors on the way, it would hardly have been so rosy. <br><br><h4>  Future plans. </h4><br>  There are always enough fronts, plans for the summer to transfer four more microdistricts to FTTB (Building), to start changing the ring in one of the ‚Äúmacro districts‚Äù for 24 fiber cables, plus the whole administration plans to connect a couple of cottage villages around the city to the network.  In addition, recently, businessmen became more active citizens, who in their dreams see unlimited gigabit Internet directly to the office, which does not reduce our troubles. <br>  According to general results, over the last year we had one emergency visit to repair optics, which was torn down by a tree that fell in a thunderstorm, whereas three years ago we went to emergency heels once a month - the bottle flooded after the rain, the signal disappeared, and other troubles welcomed us almost weekly. <br>  The average number of emergency tickets per week, in the past two years, if it does not fall, it does not grow exactly, this is with a triple increase in the subscriber base.  In addition, the initial diagnostics on the ticket is now often reduced to viewing the log and the state of the switch port.  That is much easier and faster to go to the place of an emergency or assembly crew. <br>  Intra-district rings and trunk lines designed for skipping 1 Gbit / s are now loaded at peak hours by 30-45%, so we have room to grow and the network can work for another couple of years according to the transport capability, although it is already preparing an adequate change ... <br><br>  Still in the plans, notes on copper house communications, and met interesting in setting up the equipment. </div><p>Source: <a href="https://habr.com/ru/post/95751/">https://habr.com/ru/post/95751/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../95744/index.html">Microsoft stops paying for using Bing</a></li>
<li><a href="../95745/index.html">Independent study of circuit design. Synthesis of automata on triggers. Part 1</a></li>
<li><a href="../95747/index.html">If doctors were admins</a></li>
<li><a href="../95749/index.html">Build JavaEE application by maven</a></li>
<li><a href="../95750/index.html">WWDC'10-tote</a></li>
<li><a href="../95753/index.html">Habrability test</a></li>
<li><a href="../95755/index.html">WebMoney Root Certificate Expiration - What to do</a></li>
<li><a href="../95757/index.html">On the organization of the working atmosphere and space</a></li>
<li><a href="../95758/index.html">Implicitly setting the value of a Date object?</a></li>
<li><a href="../95759/index.html">Invitation to broadcast the opening of WWDC 2010</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>