<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Linux for professionals: video editing (and a bit of compositing)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello colleagues. I think the time has come to continue the once-started ‚ÄúLinux for Professionals‚Äù cycle. Today I would like to talk about the install...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Linux for professionals: video editing (and a bit of compositing)</h1><div class="post__text post__text-html js-mediator-article">  Hello colleagues.  I think the time has come to continue <a href="http://habrahabr.ru/post/197036/">the once-started</a> ‚ÄúLinux for Professionals‚Äù cycle.  Today I would like to talk about the installation of the video on the example of the video that we shot last summer for our Prague project with an electronic GPS audio guide. <br><br>  Actually video (to be precise, this is a demo mini-movie). <br><br><iframe src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://player.vimeo.com/video/82562396&amp;xid=17259,15700019,15700186,15700190,15700253&amp;usg=ALkJrhiMype2SQSDxdsqHCB8i5aBYprabQ" width="560" height="315" frameborder="0" title="Prague Electronic Tour Guide [interactive non-linear GPS audiobook demo film]" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen=""></iframe>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The whole cycle of post-processing and editing is performed using software running Linux. <br><br>  In truth, there is one nuance.  I first used the AI ‚Äã‚Äãrunning under Wine to prepare titles.  This was due in part to the fact that I, being bound by the framework, did not pay due attention to the search for native alternatives.  In fact, as it turned out, such an alternative, completely lying on the surface, exists.  Below I will tell more. <br><br>  So, in order. <br><a name="habracut"></a><br>  Go into the shooting process, I think, there is no special meaning.  The only thing probably worth saying is that we shot on a Canon EOS 600D with standard firmware; for recording sound, we used a wired microphone-buttonhole connected directly to the camera. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/391/a2b/a8b/391a2ba8bbdc3fd4ba664210b2742bb7.jpg"><br><br>  It should be noted that I was somewhat worried about the sound quality, because there is no visual monitor in the standard firmware, as well as a direct output for headphones.  Moreover, when listening to the test sound at the site, overloads seemed to be noticeable.  Therefore, we decided to reduce the level slightly.  As it turned out later - in vain.  In the files, the sound was noticeably below average.  And the file that we recorded at the beginning showed quite a normal sound level without overloads. <br><br>  Generally speaking, if you intend to shoot professional video on any Canon DSLR, I would recommend using the <a href="http://www.magiclantern.fm/">Magic lantern</a> .  In our case, I frankly missed this moment, in part, being busy with visual and organizational tasks and the desire to have time to take everything off in sunny weather. <br><br>  As a result, after two days of filming, we burned out under the scorching sun, but, in general, satisfied with the result, we received 10GB HD materials as 1080p compressed with the H.264 codec. <br><br><br><h4>  Material preparation </h4><br><br>  If you have ever worked with HD 1080p futage, you must know how slow installation can be, unless the hardware can handle multiple H.264 streams at the same time.  Therefore, in order to facilitate the process, it is necessary to pre-convert all the material to some more digestible codec and lower the resolution, so that later you can ‚Äúswap‚Äù the files with the original ones and ‚Äúcount‚Äù the final film. <br><br>  I decided that the best would be to convert to the good old DV50 widescreen, as long as this codec does not provide interframe interpolation and has worked well with <a href="http://kdenlive.org/">Kdenlive</a> .  I have been using the latter for a long time for editing and consider it to be the best professional open source installation tool. <br><br>  In general, without thinking twice, I charged the conversion: <br><br><pre> # / bin / bash
 if [$ # -lt 2];  then
	 echo "Video HD&gt; PAL converter."
	 echo "Usage: $ 0 &lt;target directory&gt; l"
	 echo "c - convert, l - file list"
 else
	 mkdir "$ 1 / PAL"
	 ls "$ 1" |  grep -E .MOV |  while read file; 
	 do
		 if ["$ 2" == "c"];  then  
			 avconv -i "$ 1 / $ file" -target pal-dv50 -aspect 16: 9 -threads 0 "PAL / $ file"
		 fi
		 if ["$ 2" == "l"];  then  
			 echo "$ 1 / PAL / $ file"
		 fi
	 done
 fi
</pre><br><br>  Kdenlive has no codeb restrictions pertaining to Adobe products.  Everything for which codecs are installed in your system will be loaded and played.  But in fairness, it should be noted that all kinds of encoding formats that are not intended for nonlinear processing can lead to a drop in the installation.  What is a big plus - Kdenlive is able to independently save and restore the project after the fall.  However, in any case, it is good practice to periodically press the ‚Äúsave‚Äù button after each key stage.  However, obviously, this is a matter of course. <br><br><blockquote>  <i>A small digression, which aims to demonstrate how much more flexible approach is the use of Open Source products made in accordance with POSIX standards.</i> <i><br><br></i>  <i>Some time ago, in the ru_filmmaker community, a colleague <a href="http://ru-filmmaker.livejournal.com/1414585.html">asked a question</a> : how to turn 720p 25 fps with half frames in 1080p 50 fps without semi-fields.</i>  <i>Like, by mistake they removed the part not in that capacity.</i>  <i>What to do now is not very clear.</i>  <i>The situation was aggravated by, as far as I understand, the need to process a certain amount of such material.</i>  <i>As the author himself writes, it turned out that there are no standard ways to do this using Adobe products.</i>  <i>In any case, no matter how straightforward the way to do it was missing.</i>  <i>The reason for this is clear, there are standard tasks.</i>  <i>As part of standard tasks, the toolkit provides solutions embedded in a monolithic interface.</i>  <i>This approach assumes the remarkable profit skills of the developers.</i>  <i>After all, indeed, you need to assume all the ways of using your toolkit in order to ‚Äúclose‚Äù all hypothetically possible nuances.</i>  <i>Another thing is POSIX.</i>  <i>A toolbox that is not directly related makes it possible to solve almost any problem.</i> <i><br><br></i>  <i>I was first decided to offer a simple bash skipt, which breaks the video into frames, then with the help of <a href="http://www.imagemagick.org/">ImageMagic it</a> divides each frame into half-fields, saves and collects the final video.</i>  <i>However, he quickly discovered that this problem was solved in one line with the help of <a href="http://ffmpeg.org/">ffmpeg</a> , and informed the author of the question there.</i> <i><br><br></i>  <i>Or something else.</i>  <i>For example, do you know that Kdenlive stores the editing sheet in XML and allows you to ‚Äúrender‚Äù a movie from the command line?</i>  <i>Any inquisitive experimenter's mind immediately gives rise to a lot of ideas about how this can be used :)</i> </blockquote><br><br>  So, the video is ready.  Need to mount. <br><br><br><h4>  Installation </h4><br><br>  As I wrote above, I use Kdenlive for editing.  I once tried many different tools, and I can say that, in my opinion, Kdenlive is by far the best.  There is also a <a href="http://openshot.org/">competing OpenShot</a> level.  But for now, neither in terms of performance, nor in terms of the interface, does Kdenlive even reach close.  Kdenlive is the recognized standard.  And, judging by the level of discussions on the project site‚Äôs forum, the guys who ‚Äúate more than one dog‚Äù in the video production make it. <br><br>  Since the task of learning to use the toolkit goes beyond the scope of the objectives of this series of publications, I will not describe the entire installation process.  It is simple and in general for any person who has the skills to work with any other installation product (FinalCut, Adobe Premiere, Avid), does not present any particular difficulties.  In my subjective opinion, Kdenlive interface is most similar to Final Cut. <br><br><blockquote>  <i>Moments to which I would like to draw attention:</i> <i><br></i>  <i>a) In the new version of Kdenlive, it became possible to load not only sequences with an alpha channel, but also transparent (32 bit) AVI, saved without compression.</i>  <i>What I successfully used to create titles (about this below)</i> <i><br></i>  <i>b) After replacing the clips with the original ones (this will also be discussed below), fragments in which the playback speed has been changed are compressed for some reason.</i>  <i>This is solved by changing the parameters to the original and back.</i> </blockquote><br><br><br><h4>  Sound </h4><br><br>  For sound processing, I use the well-proven <a href="http://audacity.sourceforge.net/">Audacity</a> .  There is, in principle, everything that a sound engineer needs + a large number of additional filters written by third-party developers. <br><br>  In our video there is a pair of "windy" frames.  Accordingly, I decided to tweak a little the frequency characteristics of the sound in these fragments, so that, if possible, mask the wind noise and highlight the voice.  + slightly processed all the sound with a compressor in order to achieve b / m acceptable sound on small speakers and speakers built into pocket smartphones. <br><br><br><h4>  Post-processing video </h4><br><br>  After the shooting, it turned out that the sensitive skin of our actress in the sun was completely orange and covered in places, sorry for the details, very noticeable pimples, which I decided to retouch.  This stage was the most painstaking. <br><br>  Being an inquiring character, I decided that I would not deviate from the chosen paradigm and would try to solve this problem with the tools available for Linux software.  In general, having spent the day exploring all the possible new products and realizing that nothing fundamentally changed in this aspect since 2007, I decided that the only way I can do is use AE running under Wine. <br><br>  It should be noted that Open Source compositing in Linux is still a stumbling block.  Those.  No, there is of course <a href="http://www.thefoundry.co.uk/products/nuke-product-family/nuke/">Nuke</a> .  Nuke, by the way, is such a great tool that many put it head and shoulders above all of the software for cinema-video composing that exists today.  And I unconditionally share this point of view.  But!  Nuke is a proprietary and commercial product.  Alas.  So I left this option for the time being as well. <br><br>  There is also a composer built into Blender node.  He is great in everything.  In addition to no tracking at that time.  In the latest version, <a href="http://wiki.blender.org/index.php/Doc:2.6/Manual/Motion_Tracking">tracking finally appeared</a> .  But last fall he was not there yet to speak.  It became clear that the only way out was AE under <a href="http://www.winehq.org/">Wine</a> . <br><br>  After getting acquainted with the Wine base, it turned out that version 6.5 behaves the best.  And I just had a CD from Adobe AE 6 from ancient times. Having rummaged through the network, I discovered that Adob ‚Äã‚Äãhas <a href="">open FTP</a> with old software copies, which I used. <br><br>  How long, how short, but the matter is argued. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e1b/ed6/0a1/e1bed60a140e71d32391b2749e9b9ad5.jpg"><br>  <sub>AE running in Mate environment (ex Gnome)</sub> <br><br>  However, after some exercises, it turned out that AE, for some reason, from time to time, still, falls during the render.  The place of failure was all the time different, which made me think that it was not the source code and not the timeline.  In general, having rummaged on the web, I found the same reason and hurried to share with the visitors winehq, now I share with the respected readers of this article: <br><br><blockquote>  <i>Tips:</i> <i><br></i>  <i>1. To get rid of the stubborn falls, do the following: press Shift key + select Edit -&gt; Preferences ... the subsection ‚ÄúSecret‚Äù will appear there.</i>  <i>In the window that opens, enter the magic value "20" and close the window.</i>  <i>After that, everything will work like a clock :)</i> <i><br></i>  <i>2. By default, AE uses only 2GB (for any amount of memory you have installed), in order to allocate more, you need to set the / PAE and / 3GB commands in the boot.ini</i> </blockquote><br><br>  The original, by the way, has already fallen asleep in ‚Äúin Einstein-Bose condensate‚Äù.  However, there was another <a href="http://forums.creativecow.net/thread/2/978612">proof</a> on Creative Cow. <br><br>  Then everything was elementary.  I "blew away the dust" from the old software.  Everything worked and surprisingly briskly.  I drew a static in <a href="http://inkscape.org/">InkSkape</a> , and then exported everything to EPS.  He pulled into AE and made an animation.  The resulting video is calculated without compression in 32bit AVI with alpha channel. <br><br>  Here we must make some digression.  The fact is that I, as already mentioned above, was in a hurry to post a video on the site, and did not bother to investigate the issue thoroughly enough.  However, after some time, and to be precise, immediately before the new year, reading <a href="http://digilinux.ru/">DigiLinux</a> news <a href="http://digilinux.ru/">feed,</a> I came across another note about <a href="http://www.synfig.org/">Synfig</a> .  Since the animation animation has always been somewhat on the periphery of my professional interests, I have never paid much attention to this project.  Those.  I knew that he was there and, judging from the screenshots and the frequency of notes about him here and there, this is some kind of quite popular product.  But ... and then a thought struck me.  And what if you try this thing as a compositor for titles. <br><br>  In general, without hesitation, I set up Synfig, and what do you think ... So it turned out.  Synfig was quite acceptable for this kind of venture.  Hooray!  problem solved.  I was just planning to upgrade the video, attach the final ‚Äúpachot‚Äù, twist the colors and finally put the video on the server directly in good quality, bypassing the Vimeo recompression and getting rid of Flash and annoying logos over the image in one.  So the find was very helpful. <br><br>  In general, I dig deeper, and made the same titles in Synfig. <br><br>  Nevertheless, it should be noted that this task was not an easy one.  After AE, the Synfig interface is quite unusual.  And everything that concerns the work with key personnel and non-linear timings, in my opinion, leaves much to be desired.  But, nevertheless, within the framework of the task, a solution was found.  At the output, I received the usual PNG sequence with the alpha channel, which I easily converted into the same 32-bit avishki using ffmpeg. <br><br><blockquote>  <i>Note:</i> <i><br></i>  <i>If you are a media designer working in Linux, then surely, just like me, use InkScape for vector graphics.</i>  <i>The new version of Synfig has a long-awaited import of SVG.</i>  <i>However, as practice has shown, it works in a strange way.</i>  <i>Those.</i>  <i>all combined objects ‚Äúfall apart‚Äù when exporting to parts.</i>  <i>Solution: use the <a href="https://github.com/nikitakit/svg2sif">InkScape plugin instead</a> .</i>  <i>It saves in original synfig sif format.</i> </blockquote><br><br>  After I "podrihoval" pimples and prepared new captions, it remained only to collect the final version. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/628/3d7/c83/6283d7c83ca837502bb5c159070fa018.jpg"><br>  <sub>Mounting roller Electronic Tour Guide in Kdenlive</sub> <br><br>  At the beginning of the article I mentioned that I used recalculated snippets.  So, I was already prepared for some malfunctions after the replacement, but the reverse replacement procedure turned out to be surprisingly simple.  Like many modern open source applications, Kdenlive saves the montage into a structured XML file.  That is, this banal text file is convenient for viewing, analyzing and "parsing" by third-party applications.  So I just opened the saved montage in a pluma text editor and, using a template, replaced all the paths with HD-leading sources. <br><br>  After loading, I changed the frame format and the only thing I discovered was the resizing problem mentioned above.  After correcting the size, it remained only to ‚Äúcalculate‚Äù the video with different codecs and upload the video to the server. <br><br><br><h4>  We are in the process :) </h4><br><br><img src="https://habrastorage.org/getpro/habr/post_images/53f/449/998/53f449998b12e5963d2082ea113bd212.jpg"><br>  <sub>Shooting an epic film about our Prague GPS audio guide</sub> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b78/9be/6de/b789be6de63ae907d998076bf4a0d85d.jpg"><br>  <sub>Prague GPS Guide, Continued Shooting</sub> <br><br><br><h4>  Film crew </h4><br><br>  <sub>Yulya Belenkova tourist storyteller</sub> <sub><br></sub>  <sub>Evgeny Epifantsev operator</sub> <sub><br></sub>  <sub>Yuri Yakovlev Assistant and Photographer</sub> <sub><br></sub>  <sub>Dmitry Shalnov copywriter, director and editor of an epic film :)</sub> <sub><br><br></sub>  <sub>Special thanks to Mikhail Spivakov for editing the translation, as well as Alina Kazakevich for participating in the preliminary shootings.</sub> <sub><br></sub> <br><br><br><h4>  List of used and mentioned open source software </h4><br><br><ul><li>  <a href="http://kdenlive.org/">Kdenlive</a> - video montage </li><li>  <a href="http://ffmpeg.org/">FFmpeg</a> is a fully featured console video processing tool. </li><li>  <a href="http://audacity.sourceforge.net/">Audacity</a> - editing and processing sound </li><li>  <a href="http://www.winehq.org/">Wine</a> is a Windows API translator and set of libraries that allows running Win applications on POSIX compatible operating systems (such as Linux, Mac OSX, &amp; BSD) in native mode. </li><li>  <a href="http://www.blender.org/">Blender</a> is a professional tool for compositing and working with 3D graphics. </li><li>  <a href="http://www.synfig.org/">Synfig</a> - a tool for creating two-dimensional vector animation </li><li>  <a href="http://inkscape.org/">InkScape</a> - a tool for working with vector graphics </li><li>  <a href="https://github.com/nikitakit/svg2sif">SIF exporter</a> - plugin for saving SIF files from InkScape. </li><li>  <a href="http://www.magiclantern.fm/">Magic Lantern</a> is an alternative firmware with an expanded set of video features and open source, designed to run on Canon EOS cameras. </li></ul><br><br><br><h4>  useful links </h4><br><br><ul><li>  <a href="https://ru.wikipedia.org/wiki/POSIX">POSIX</a> (English Portable Operating System Interface for Unix) - Portable Interface for Unix Operating Systems (wiki article) </li><li>  <a href="http://appdb.winehq.org/objectManager.php%3FsClass%3Dversion%26iId%3D7429">Wine database page related to AE 6.5 health</a> </li><li>  <a href="http://forums.creativecow.net/thread/2/978612">The tips are useful, as it turned out, for setting up the specified version of AE for Wine on creativecow.net</a> </li><li>  <a href="http://digilinux.ru/">DigiLinux</a> is a Russian-language edition dedicated to tools for creating multimedia content in Linux. </li></ul><br><br>  <sub>PS The video added to the article is Vimeo, as long as Habra, alas, does not support adding html5 video directly.</sub>  <sub>So the quality of compression is noticeably worse here.</sub>  <sub>If you want to see the original - it is on the site of the project <a href="http://electronictourguide.com/">Electronic Tour Guide</a> .</sub> <sub><br></sub> </div><p>Source: <a href="https://habr.com/ru/post/221531/">https://habr.com/ru/post/221531/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../221519/index.html">Sapper: Royal Engineer</a></li>
<li><a href="../221521/index.html">Asynchronous Php extension to work with Cassandra without Thrift</a></li>
<li><a href="../221525/index.html">One approach to debugging solutions for SharePoint</a></li>
<li><a href="../221527/index.html">Is fundamental education in CS important and a view from Yandex on professions in the world of information technology?</a></li>
<li><a href="../221529/index.html">The seventh issue of TsODY.RF magazine</a></li>
<li><a href="../221539/index.html">FZ-229 - hands off the main mobile account</a></li>
<li><a href="../221543/index.html">Installing Archlinux on an Android phone in the second section of SD or just a subfolder of the system memory card</a></li>
<li><a href="../221545/index.html">Unity3d Lessons from Unity 3D Student (B21-B24)</a></li>
<li><a href="../221549/index.html">Parse.com reduces prices</a></li>
<li><a href="../221551/index.html">How to set up integration between Bugzilla and 3SL Cradle</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>