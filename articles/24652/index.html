<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Custom shortcuts in Windows using Autohotkey</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Following the recent and not so recent publications about shortcuts in Windows ( 1 , 2 ) and Linux decided to write about how using Autohotkey (Window...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Custom shortcuts in Windows using Autohotkey</h1><div class="post__text post__text-html js-mediator-article"> Following the recent and not so recent publications about shortcuts in Windows ( <a href="http://habrahabr.ru/blog/windows/39804.html">1</a> , <a href="http://habrahabr.ru/blog/i_am_clever/39635.html">2</a> ) and <a href="http://habrahabr.ru/blog/linux/39898.html">Linux</a> decided to write about how using <a href="http://www.autohotkey.com/">Autohotkey</a> (Windows-only, <a href="">installer</a> , <a href="">portable (zip) version</a> ) you can set your own keyboard shortcuts for those commands for which no shortcuts are provided for in the system by default.  In many ways, my role here was played by the desire to have the same shortcuts in Windows as on the Mac, on which I once worked a lot. <br><br><a name="habracut"></a>  Autohotkey is not just a hotkey manager, but a truly universal tool for manipulating Windows, and implementing custom shortcuts is not the only task that it helps to solve ( <a href="http://www.autohotkey.com/docs/">documentation in English</a> , <a href="http://www.script-coding.info/AutoHotkeyTranslation.html">Russian</a> ).  Autohotkey uses its own scripting language, quite simple, and for professional programmers, as I suspect, is completely elementary.  A number of scripts written in AHK have been published on the program's forum, including entire applications (batch renames, code editors, web development tools, etc.). <br><br>  You can use shortcuts of various types: regular keyboard shortcuts, shortcuts that use the mouse (buttons and scroll wheel), double clicks and clicks, combining different mouse buttons, double / triple keystrokes, modifiers themselves (Ctrl, Alt, etc.), joystick buttons, etc.  In addition, you can force shortcuts to work only in certain applications, and this opens up space for correcting shortcuts that you think are ‚Äúincorrect‚Äù in programs where there is no possibility to change their capabilities (see the example with Windows Media Player). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      I did not include commands that can perform other similar programs (for example, <a href="http://www.bcheck.net/apps/">Hoekey</a> , which is limited in functionality, but eats up very little memory - about 100-500 KB, unlike Autohotkey, which eats about 2-7 MB).  This includes system commands that allow you to open the Control Panel via hotkey, launch the current screensaver, etc.  If anything, I can put the relevant examples in a separate topic.  <a href="http://www.autohotkey.com/forum/viewtopic.php%3Ft%3D27029">An indispensable script for changing the layout and converting text from one layout to another was</a> written by our compatriot <a href="http://www.autohotkey.com/forum/profile.php%3Fmode%3Dviewprofile%26u%3D2029">wOxxOm</a> from the <a href="http://www.autohotkey.com/forum/">Autohotkey forum</a> .  All scripts are working and tested on WinXP, although Autohotkey works under Vista, to ensure the performance of all the examples under it is not possible. <br><br>  The following are the abbreviations, the command assigned to it, and the corresponding code to be inserted into the Autohotkey.ini file.  And, of course, all shortcuts can be changed to your taste.  Just change part of the script to double colon. <br><br>  <b>Clear the cart with <em>Shift + Alt + Backspace</em></b> <br> <code>+!Backspace:: FileRecycleEmpty <br></code> <br><br>  <b>Close any windows with <em>Ctrl + Q</em> (like on Linux)</b> <br> <code>$^q:: <br> IfWinActive ahk_class WMPlayerApp <br> PostMessage, 0x10 <br> else <br> WinClose, A <br> return <br></code> <br><br>  <b>Minimize / maximize windows with <em>Ctrl + Win + mouse wheel</em></b> <br> <code>^#WheelUp:: WinMaximize A <br> ^#WheelDown:: WinRestore A <br></code> <br><br>  <b><em>Win + Shift + C</em> - copy to the clipboard the path to the selected file in Explorer</b> <br> <code>#+c:: <br> clipboard = <br> Send, ^c <br> ClipWait, 2 <br> Sort, clipboard <br></code> <br><br>  <b>Minimize the windows to the title bar by pressing the <em>tilde (`)</em></b> <br> <code>ws_MinHeight = 25 <br> <br> OnExit, ExitSub <br> return <br> <br> `:: <br> Sleep, 200 <br> WinGet, ws_ID, ID, A <br> Loop, Parse, ws_IDList, | <br> { <br> IfEqual, A_LoopField, %ws_ID% <br> { <br> StringTrimRight, ws_Height, ws_Window%ws_ID%, 0 <br> WinMove, ahk_id %ws_ID%,,,,, %ws_Height% <br> WinSet, AlwaysOnTop, off, A <br> StringReplace, ws_IDList, ws_IDList, |%ws_ID% <br> return <br> } <br> } <br> WinGetPos,,,, ws_Height, A <br> WinSet, AlwaysOnTop, on, ahk_id %ws_ID% <br> ws_Window%ws_ID% = %ws_Height% <br> WinMove, ahk_id %ws_ID%,,,,, %ws_MinHeight% <br> ws_IDList = %ws_IDList%|%ws_ID% <br> return <br> <br> ExitSub: <br> Loop, Parse, ws_IDList, | <br> { <br> if A_LoopField = ; First field in list is normally blank. <br> continue ; So skip it. <br> StringTrimRight, ws_Height, ws_Window%A_LoopField%, 0 <br> WinMove, ahk_id %A_LoopField%,,,,, %ws_Height% <br> } <br> ExitApp <br></code> <br><br>  <b>Move the windows with the <em>Win key held down</em> (or whatever)</b> <br> <code>#LButton:: <br> CoordMode, Mouse <br> MouseGetPos, EWD_MouseStartX, EWD_MouseStartY, EWD_MouseWin <br> WinGetClass, EWD_Win_Class, ahk_id %EWD_MouseWin% <br> If EWD_Win_Class = ProgMan <br> Return <br> WinGet, State, MinMax, ahk_id %EWD_MouseWin% <br> If State = 1 <br> { <br> SplashImage,, W160 H27 B1 FM8 WM400 CT000080,,  ,, Calibri <br> SetTimer, Remove_Splash, 600 <br> Return <br> <br> Remove_Splash: <br> SetTimer, Remove_Splash, Off <br> SplashImage, Off <br> Return <br> } <br> WinGetPos, EWD_OriginalPosX, EWD_OriginalPosY,,, ahk_id %EWD_MouseWin% <br> SetTimer, EWD_WatchMouse, 10 <br> Return <br> <br> EWD_WatchMouse: <br> EWD_Work = 1 <br> GetKeyState, EWD_LButtonState, LButton, P <br> If EWD_LButtonState = U <br> { <br> SetTimer, EWD_WatchMouse, off <br> EWD_Work = <br> Return <br> } <br> GetKeyState, EWD_EscapeState, Escape, P <br> If EWD_EscapeState = D <br> { <br> SetTimer, EWD_WatchMouse, off <br> EWD_Work = <br> WinMove, ahk_id %EWD_MouseWin%,, %EWD_OriginalPosX%, %EWD_OriginalPosY% <br> Return <br> } <br> CoordMode, Mouse <br> MouseGetPos, EWD_MouseX, EWD_MouseY <br> WinGetPos, EWD_WinX, EWD_WinY,,, ahk_id %EWD_MouseWin% <br> SetWinDelay, -1 <br> WinMove, ahk_id %EWD_MouseWin%,, EWD_WinX + EWD_MouseX - EWD_MouseStartX, EWD_WinY + EWD_MouseY - EWD_MouseStartY <br> EWD_MouseStartX := EWD_MouseX <br> EWD_MouseStartY := EWD_MouseY <br> Return <br></code> <br><br>  <b>Resize windows with the <em>right mouse button while holding the Win key</em></b> <br> <code>LWin &amp; RButton:: <br> CoordMode, Mouse ; Switch to screen/absolute coordinates. <br> MouseGetPos, SWM_MouseStartX, SWM_MouseStartY, SWM_MouseWin <br> WinGetPos, SWM_WinX, SWM_WinY, SWM_WinW, SWM_WinH, ahk_id %SWM_MouseWin% <br> WinGetClass, SWM_Win_Class, ahk_id %SWM_MouseWin% <br> If SWM_Win_Class = ProgMan <br> Return <br> WinGet, State, MinMax, ahk_id %SWM_MouseWin% <br> If State = 1 <br> { <br> SplashImage,, W160 H26 B1 FM8 WM400 CT000080,,  ,, Calibri <br> SetTimer, Remove_Splash, 600 <br> Return <br> } <br> GetKeyState, SMW_LCtrlState, LCtrl <br> if SMW_LCtrlState=D <br> { <br> WinClose, ahk_id %SWM_MouseWin% <br> return <br> } <br> SWM_ResizeTypeX=0 <br> SWM_ResizeTypeY=0 <br> if (SWM_MouseStartX &lt; SWM_WinX+SWM_WinW/2) <br> SWM_ResizeTypeX=1 <br> if (SWM_MouseStartY &lt; SWM_WinY+SWM_WinH/2) <br> SWM_ResizeTypeY=1 <br> SetTimer, SWM_WatchMouse_Resize, 10 <br> return <br> <br> SWM_WatchMouse_Move: <br> GetKeyState, SMW_LButtonState, LButton, P <br> if SMW_LButtonState = U <br> { <br> SetTimer, SWM_WatchMouse_Move, off <br> return <br> } <br> Gosub SWM_GetMouseAndWindowPos <br> SWM_WinX += %SWM_DeltaX% <br> SWM_WinY += %SWM_DeltaY% <br> SetWinDelay, -1 <br> WinMove, ahk_id %SWM_MouseWin%,, %SWM_WinX%, %SWM_WinY% <br> return <br> <br> SWM_WatchMouse_Resize: <br> GetKeyState, SMW_RButtonState, RButton, P <br> if SMW_RButtonState = U <br> { <br> SetTimer, SWM_WatchMouse_Resize, off <br> return <br> } <br> Gosub SWM_GetMouseAndWindowPos <br> if SWM_ResizeTypeX <br> { <br> SWM_WinX += %SWM_DeltaX% <br> SWM_WinW -= %SWM_DeltaX% <br> } <br> else <br> SWM_WinW += %SWM_DeltaX% <br> if SWM_ResizeTypeY <br> { <br> SWM_WinY += %SWM_DeltaY% <br> SWM_WinH -= %SWM_DeltaY% <br> } <br> else <br> SWM_WinH += %SWM_DeltaY% <br> SetWinDelay, -1 <br> WinMove, ahk_id %SWM_MouseWin%,, %SWM_WinX%, %SWM_WinY%, %SWM_WinW%, %SWM_WinH% <br> return <br> <br> SWM_GetMouseAndWindowPos: <br> CoordMode, Mouse <br> MouseGetPos, SWM_MouseX, SWM_MouseY <br> SWM_DeltaX = %SWM_MouseX% <br> SWM_DeltaX -= %SWM_MouseStartX% <br> SWM_DeltaY = %SWM_MouseY% <br> SWM_DeltaY -= %SWM_MouseStartY% <br> SWM_MouseStartX = %SWM_MouseX% <br> SWM_MouseStartY = %SWM_MouseY% <br> WinGetPos, SWM_WinX, SWM_WinY, SWM_WinW, SWM_WinH, ahk_id %SWM_MouseWin% <br> return <br></code> <br><br>  <b><em>Alt + H</em> - show / hide hidden files in Explorer</b> <br> <code>!H::GoSub,CheckActiveWindow <br> <br> CheckActiveWindow: <br> ID := WinExist("A") <br> WinGetClass,Class, ahk_id %ID% <br> WClasses := "CabinetWClass ExploreWClass" <br> IfInString, WClasses, %Class% <br> GoSub, Toggle_HiddenFiles_Display <br> Return <br> <br> Toggle_HiddenFiles_Display: <br> RootKey = HKEY_CURRENT_USER <br> SubKey = Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced <br> <br> RegRead, HiddenFiles_Status, % RootKey, % SubKey, Hidden <br> <br> if HiddenFiles_Status = 2 <br> RegWrite, REG_DWORD, % RootKey, % SubKey, Hidden, 1 <br> else <br> RegWrite, REG_DWORD, % RootKey, % SubKey, Hidden, 2 <br> PostMessage, 0x111, 28931,,, ahk_id %ID% <br> Return <br></code> <br><br>  <b>Climb the directory up by clicking the <em>middle mouse button</em> in the explorer</b> <br> <code>~MButton:: <br> MouseGetPos,,,,hovercontrol <br> if hovercontrol = SysListView321 <br> Send {Backspace} <br> else if hovercontrol = #327701 <br> Send {Backspace} <br> Return <br></code> <br><br>  <b>Create a new folder in Explorer by double clicking on any empty space inside the window</b> <br> <code>#IfWinActive ahk_class CabinetWClass <br> ~LButton:: <br> SetKeyDelay, , 50 <br> MouseGetPos, , , , ctrl <br> ControlGet, sel, List, Count Selected, SysListView321, A <br> If DllCall("GetDoubleClickTime") &gt; A_TimeSincePriorHotkey <br> and A_ThisHotkey = A_PriorHotkey <br> and ctrl = "SysListView321" <br> and sel = 0 <br> SendEvent, !fwf <br> Return <br> #IfWinActive <br></code> <br><br>  <b>Change the transparency of the window <em>Ctrl + Shift + mouse wheel</em></b> <br> <code>OnExit EXIT <br> ^+WheelDown:: <br> ^+WheelUp:: <br> Sleep 50 <br> MouseGetPos cx, cy, Win_Id <br> WinGetClass Class, ahk_id %Win_Id% <br> If Class in Progman,Shell_TrayWnd <br> Return <br> IfEqual N%Win_Id%,, { <br> WinGet T, Transparent, ahk_id %Win_Id% <br> IfEqual T,, SetEnv T,255 <br> List = %List%%Win_Id%,%T%, <br> N%Win_Id% = %T% <br> } <br> IfEqual A_ThisHotKey,^+WheelUp, EnvAdd N%Win_Id%,12 <br> Else N%Win_Id% -= 12 ;Transparency changing step <br> IfGreater N%Win_Id%,255, SetEnv N%Win_Id%,255 <br> IfLess N%Win_Id%,40, SetEnv N%Win_Id%,40 <br> WinSet Transparent, % N%Win_Id%, ahk_id %Win_Id% <br> TrayTip,,% "Transparency: " N%Win_Id% <br> Return <br> <br> EXIT: <br> Loop Parse, List, `, <br> If (A_Index &amp; 1) <br> Id = %A_LoopField% <br> Else <br> Winset Transparent, %A_LoopField%, ahk_id %Id% <br> ExitApp <br></code> <br><br>  <b>Close the windows in the taskbar area <em>Ctrl + middle mouse button</em></b> <br> <code>^MButton:: <br> SetBatchLines, -1 <br> CoordMode, Mouse, Screen <br> SetMouseDelay, -1 <br> SetKeyDelay, -1 <br> MouseGetPos, ClickX, ClickY, WindowUnderMouseID <br> WinActivate, ahk_id %WindowUnderMouseID% <br> <br> ; WM_NCHITTEST <br> SendMessage, 0x84,, ( ClickY &lt;&lt; 16 )|ClickX,, ahk_id %WindowUnderMouseID% <br> WM_NCHITTEST_Result =%ErrorLevel% <br> /* <br> #define HTERROR (-2) <br> #define HTTRANSPARENT (-1) <br> #define HTNOWHERE 0 <br> #define HTCLIENT 1 <br> #define HTCAPTION 2 <br> #define HTSYSMENU 3 <br> #define HTGROWBOX 4 <br> #define HTSIZE HTGROWBOX <br> #define HTMENU 5 <br> #define HTHSCROLL 6 <br> #define HTVSCROLL 7 <br> #define HTMINBUTTON 8 <br> #define HTMAXBUTTON 9 <br> #define HTLEFT 10 <br> #define HTRIGHT 11 <br> #define HTTOP 12 <br> #define HTTOPLEFT 13 <br> #define HTTOPRIGHT 14 <br> #define HTBOTTOM 15 <br> #define HTBOTTOMLEFT 16 <br> #define HTBOTTOMRIGHT 17 <br> #define HTBORDER 18 <br> #define HTREDUCE HTMINBUTTON <br> #define HTZOOM HTMAXBUTTON <br> #define HTSIZEFIRST HTLEFT <br> #define HTSIZELAST HTBOTTOMRIGHT <br> #if(WINVER &gt;= 0x0400) <br> #define HTOBJECT 19 <br> #define HTCLOSE 20 <br> #define HTHELP 21 <br> */ <br> <br> ;Close window with titlebar click <br> If WM_NCHITTEST_Result in 2,3,8,9,20,21 <br> { <br> PostMessage, 0x112, 0xF060,,, ahk_id %WindowUnderMouseID% ; 0x112 = WM_SYSCOMMAND, 0xF060 = SC_CLOSE <br> Return <br> } <br> <br> ;Close taskbar program click <br> IfWinActive, ahk_class Shell_TrayWnd <br> { <br> MouseClick, Right, %ClickX%, %ClickY% <br> Sleep, 50 <br> Send, c <br> WinWaitNotActive, ahk_class Shell_TrayWnd,, 0.5 <br> If ErrorLevel =1 <br> Send, !{Tab} <br> Return <br> } <br> <br> If GetKeyState("MButton", "P") <br> MouseClick, Middle, %ClickX%, %ClickY%,, Down <br> Else <br> MouseClick, Middle, %ClickX%, %ClickY% <br> Return <br></code> <br><br>  <b>Change the appearance of folders in the explorer using <em>Win + number keys</em></b> <br> <code>#1::PostMessage, 0x111, 28717,,, ahk_class CabinetWClass ;  <br> +#1::PostMessage, 0x111, 28719,,, ahk_class CabinetWClass ;  <br> #2::PostMessage, 0x111, 28718,,, ahk_class CabinetWClass ;   <br> #3::PostMessage, 0x111, 28715,,, ahk_class CabinetWClass ;  <br> #4::PostMessage, 0x111, 28716,,, ahk_class CabinetWClass ;  <br></code> <br><br>  <b>Change the system volume using <em>Win + mouse wheel</em></b> <br> <code>#WheelUp:: <br> SoundSet +5 <br> SoundSet, +5, wave <br> return <br> <br> #WheelDown:: <br> SoundSet -5 <br> SoundSet, -5, wave <br> return <br></code> <br><br>  <b><em>Scroll Lock</em> - change the layout of the selected text</b> <br><pre> <code class="hljs dos">$~ScrollLock::RecodeTextENRU() RecodeTextENRU() { StringCaseSense On AutoTrim,Off clipSave:=clipAnsi() send ^{Insert} sleep,<span class="hljs-number"><span class="hljs-number">50</span></span> dest= text:=clipAnsi() StringCaseSense,On prevCharToEN=<span class="hljs-number"><span class="hljs-number">0</span></span> ;  RUtoEN=F&lt;DULT:PBQRKVYJGHCNEA{WXIO}SM"&gt;Zf,dult;pbqrkvyjghcnea[wxio]sm'.z RUtoSP1=.,/"‚Ññ;:? RUtoSP2=[];',.{}:"&lt;&gt;/?|@#$^&amp; ;" ABCDEFGHIJKLMNOPQRSTUVWXYZ ENtoRU= loop,parse,text { destChar=<span class="hljs-variable"><span class="hljs-variable">%A_LoopField%</span></span> ; check explicit (non punctuations) ranges ifGreaterOrEqual,A_LoopField, prevCharToEN=<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> A_LoopField between A and Z prevCharToEN=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> A_LoopField between a and z prevCharToEN=<span class="hljs-number"><span class="hljs-number">0</span></span> ; to Russian ifEqual,prevCharToEN,<span class="hljs-number"><span class="hljs-number">0</span></span> { StringGetPos,i,RUtoEN,<span class="hljs-variable"><span class="hljs-variable">%A_LoopField%</span></span> ifEqual,<span class="hljs-keyword"><span class="hljs-keyword">ErrorLevel</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span> Transform,destChar,chr,% i + <span class="hljs-number"><span class="hljs-number">0</span></span>xC0 <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { StringGetPos,i,RUtoSP2,<span class="hljs-variable"><span class="hljs-variable">%A_LoopField%</span></span> ifEqual,<span class="hljs-keyword"><span class="hljs-keyword">ErrorLevel</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span> StringMid,destChar,RUtoSP1,% i+<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span> } } ; to English because nothing changed ifEqual,destChar,<span class="hljs-variable"><span class="hljs-variable">%A_LoopField%</span></span> { StringGetPos,i,ENtoRU,<span class="hljs-variable"><span class="hljs-variable">%A_LoopField%</span></span> ifEqual,<span class="hljs-keyword"><span class="hljs-keyword">ErrorLevel</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span> Transform,destChar,chr,% i + (i&gt;=<span class="hljs-number"><span class="hljs-number">26</span></span> ? <span class="hljs-number"><span class="hljs-number">71</span></span> : <span class="hljs-number"><span class="hljs-number">65</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> ; check .,;':"[]{} { StringGetPos,i,RUtoSP1,<span class="hljs-variable"><span class="hljs-variable">%A_LoopField%</span></span> ifEqual,<span class="hljs-keyword"><span class="hljs-keyword">ErrorLevel</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,StringMid,destChar,RUtoSP2,% i+<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span> } ifNotEqual,destChar,<span class="hljs-variable"><span class="hljs-variable">%A_LoopField%</span></span> prevCharToEN=<span class="hljs-number"><span class="hljs-number">1</span></span> } dest=<span class="hljs-variable"><span class="hljs-variable">%dest%</span></span><span class="hljs-variable"><span class="hljs-variable">%destChar%</span></span> } ; decide compatibility of unicode clipboard WinGetClass,<span class="hljs-built_in"><span class="hljs-built_in">cls</span></span>,A <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-built_in"><span class="hljs-built_in">cls</span></span> <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> TMsgEditor,wndclass_desked_gsk { ControlGetFocus,<span class="hljs-built_in"><span class="hljs-built_in">cls</span></span>,A ifInString,<span class="hljs-built_in"><span class="hljs-built_in">cls</span></span>,TXTRichEdit clipSetUnicode(dest) <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> Clipboard=<span class="hljs-variable"><span class="hljs-variable">%dest%</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> clipSetUnicode(dest) sleep,<span class="hljs-number"><span class="hljs-number">50</span></span> send +{Insert} sleep <span class="hljs-number"><span class="hljs-number">50</span></span> clipSetUnicode(clipSave) LangSwitch() } ; read unicode clipboard into ansi string clipAnsi() { StringLen,L,Clipboard L:=(L+<span class="hljs-number"><span class="hljs-number">1</span></span>)*<span class="hljs-number"><span class="hljs-number">4</span></span> transform,ca_Clip,unicode varSetCapacity(ca_WideText,L,<span class="hljs-number"><span class="hljs-number">0</span></span>) varSetCapacity(ca_AnsiText,L,<span class="hljs-number"><span class="hljs-number">0</span></span>) ; <span class="hljs-built_in"><span class="hljs-built_in">Convert</span></span> UTF-<span class="hljs-number"><span class="hljs-number">8</span></span> to UTF-<span class="hljs-number"><span class="hljs-number">16</span></span>. CP_UTF8=<span class="hljs-number"><span class="hljs-number">65001</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> dllCall("MultiByteToWideChar",uint,<span class="hljs-number"><span class="hljs-number">65001</span></span>, uint,<span class="hljs-number"><span class="hljs-number">0</span></span>, str,ca_Clip , uint,-<span class="hljs-number"><span class="hljs-number">1</span></span>, str,ca_WideText, uint,L/<span class="hljs-number"><span class="hljs-number">2</span></span>) dllCall("WideCharToMultiByte",uint,<span class="hljs-number"><span class="hljs-number">0</span></span>, uint,<span class="hljs-number"><span class="hljs-number">0</span></span>, str,ca_WideText , uint,-<span class="hljs-number"><span class="hljs-number">1</span></span>, str,ca_AnsiText, uint,L/<span class="hljs-number"><span class="hljs-number">2</span></span>, uint,<span class="hljs-number"><span class="hljs-number">0</span></span>, uint,<span class="hljs-number"><span class="hljs-number">0</span></span>) ; <span class="hljs-built_in"><span class="hljs-built_in">Convert</span></span> UTF-<span class="hljs-number"><span class="hljs-number">16</span></span> to ANSI. CP_ACP=<span class="hljs-number"><span class="hljs-number">0</span></span> return ca_AnsiText } ;-------------------------------------------------------------- ; <span class="hljs-built_in"><span class="hljs-built_in">copy</span></span> ansi string to clipboard <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> unicode <span class="hljs-built_in"><span class="hljs-built_in">mode</span></span> clipSetUnicode(cu_AnsiText) { StringLen,L,cu_AnsiText L:=(L+<span class="hljs-number"><span class="hljs-number">1</span></span>)*<span class="hljs-number"><span class="hljs-number">4</span></span> varSetCapacity(cu_WideText,L,<span class="hljs-number"><span class="hljs-number">0</span></span>) varSetCapacity(cu_UTFtext,L,<span class="hljs-number"><span class="hljs-number">0</span></span>) ; ANSI to UTF-<span class="hljs-number"><span class="hljs-number">16</span></span>. CP_ACP=<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> dllCall("MultiByteToWideChar",uint,<span class="hljs-number"><span class="hljs-number">0</span></span>, uint,<span class="hljs-number"><span class="hljs-number">0</span></span>, str,cu_AnsiText , uint,-<span class="hljs-number"><span class="hljs-number">1</span></span>, str,cu_WideText, uint,L/<span class="hljs-number"><span class="hljs-number">2</span></span>) dllCall("WideCharToMultiByte",uint,<span class="hljs-number"><span class="hljs-number">65001</span></span>, uint,<span class="hljs-number"><span class="hljs-number">0</span></span>, str,cu_WideText , uint,-<span class="hljs-number"><span class="hljs-number">1</span></span>, str,cu_UTFtext, uint,L/<span class="hljs-number"><span class="hljs-number">2</span></span>, uint,<span class="hljs-number"><span class="hljs-number">0</span></span>, uint,<span class="hljs-number"><span class="hljs-number">0</span></span>) ; <span class="hljs-built_in"><span class="hljs-built_in">Convert</span></span> UTF-<span class="hljs-number"><span class="hljs-number">16</span></span> to UTF-<span class="hljs-number"><span class="hljs-number">8</span></span>. CP_UTF8=<span class="hljs-number"><span class="hljs-number">65001</span></span> transform,clipboard,unicode,<span class="hljs-variable"><span class="hljs-variable">%cu_UTFtext%</span></span> }</code> </pre><br><br>  <b>Change the current layout by pressing the <em>right Ctrl</em></b> <br> <code><code>$~RControl::LangSwitch(1) <br> $~RControl up::LangSwitch(2) <br> <br> LangSwitch( iKeyDownUp=0 ) <br> { <br> static tickLast <br> IfEqual,iKeyDownUp,1 <br> { tickLast=%A_TickCount% <br> return <br> } <br> IfEqual,iKeyDownUp,2 <br> If( A_TickCount-tickLast&gt;200 ) <br> return <br> <br> HKL:=DllCall("GetKeyboardLayout", "uint",GetThreadOfWindow(), "uint") <br> <br> HKLnum:=DllCall("GetKeyboardLayoutList","uint",0,"uint",0) <br> VarSetCapacity( HKLlist, HKLnum*4, 0 ) <br> DllCall("GetKeyboardLayoutList","uint",HKLnum,"uint",&amp;HKLlist) <br> loop,%HKLnum% <br> { if( NumGet( HKLlist, (A_Index-1)*4 ) = HKL ) <br> { HKL:=NumGet( HKLlist, mod(A_Index,HKLnum)*4 ) <br> break <br> } <br> } <br> ControlGetFocus,ctl,A <br> SendMessage,0x50,0,HKL,%ctl%,A ;WM_INPUTLANGCHANGEREQUEST <br> <br> ;show traytip <br> LOCALE_SENGLANGUAGE=0x1001 <br> LOCALE_SENGCOUNTRY=0x1002 <br> VarSetCapacity( sKbd, 260, 0 ) <br> VarSetCapacity( sCountry, 260, 0 ) <br> DllCall("GetLocaleInfo","uint",HKL&gt;&gt;16,"uint",LOCALE_SENGLANGUAGE, "str",sKbd, "uint",260) <br> DllCall("GetLocaleInfo","uint",HKL &amp; 0xFFFF,"uint",LOCALE_SENGCOUNTRY, "str",sCountry, "uint",260) <br> traytip,%sKbd%,%sCountry% <br> SetTimer,REMOVE_TOOLTIP,500 ;0.5 second <br> return <br> REMOVE_TOOLTIP: <br> SetTimer,REMOVE_TOOLTIP,off <br> traytip <br> return <br> } <br> <br> ;returns first thread for the ;sets optional to pipe | separated thread list for the GetProcessThreadOrList( processID, byRef list="" ) <br> { <br> ;THREADENTRY32 { <br> THREADENTRY32_dwSize=0 ; DWORD <br> THREADENTRY32_cntUsage = 4 ;DWORD <br> THREADENTRY32_th32ThreadID = 8 ;DWORD <br> THREADENTRY32_th32OwnerProcessID = 12 ;DWORD <br> THREADENTRY32_tpBasePri = 16 ;LONG <br> THREADENTRY32_tpDeltaPri = 20 ;LONG <br> THREADENTRY32_dwFlags = 24 ;DWORD <br> THREADENTRY32_SIZEOF = 28 <br> <br> TH32CS_SNAPTHREAD=4 <br> <br> hProcessSnap := DllCall("CreateToolhelp32Snapshot","uint",TH32CS_SNAPTHREAD, "uint",0) <br> ifEqual,hProcessSnap,-1, return <br> <br> VarSetCapacity( thE, THREADENTRY32_SIZEOF, 0 ) <br> NumPut( THREADENTRY32_SIZEOF, thE ) <br> <br> ret=-1 <br> <br> if( DllCall("Thread32First","uint",hProcessSnap, "uint",&amp;thE )) <br> loop <br> { <br> if( NumGet( thE ) &gt;= THREADENTRY32_th32OwnerProcessID + 4) <br> if( NumGet( thE, THREADENTRY32_th32OwnerProcessID ) = processID ) <br> { th := NumGet( thE, THREADENTRY32_th32ThreadID ) <br> IfEqual,ret,-1 <br> ret:=th <br> list .= th "|" <br> } <br> NumPut( THREADENTRY32_SIZEOF, thE ) <br> if( DllCall("Thread32Next","uint",hProcessSnap, "uint",&amp;thE )=0) <br> break <br> } <br> <br> DllCall("CloseHandle","uint",hProcessSnap) <br> StringTrimRight,list,list,1 <br> return ret <br> } <br> <br> ; Returns thread owning specified window handle <br> ; default = Active window <br> GetThreadOfWindow( hWnd=0 ) <br> { <br> IfEqual,hWnd,0 <br> hWnd:=WinExist("A") <br> DllCall("GetWindowThreadProcessId", "uint",hWnd, "uintp",id) <br> GetProcessThreadOrList( id, threads ) <br> IfEqual,threads, <br> return 0 <br> CB:=RegisterCallback("GetThreadOfWindowCallBack","Fast") <br> lRet=0 <br> lParam:=hWnd <br> loop,parse,threads,| <br> { NumPut( hWnd, lParam ) <br> DllCall("EnumThreadWindows", "uint",A_LoopField, "uint",CB, "uint",&amp;lParam) <br> if( NumGet( lParam )=true ) <br> { lRet:=A_LoopField <br> break <br> } <br> } <br> DllCall("GlobalFree", "uint", CB) <br> return lRet <br> } <br> <br> GetThreadOfWindowCallBack( hWnd, lParam ) <br> { <br> IfNotEqual,hWnd,% NumGet( 0+lParam ) <br> return true <br> NumPut( true, 0+lParam ) <br> return 0 <br> } <br> <br> <br> <b><em>Ctrl+Shift+Win+Escape/Ctrl+Shift+Win+Alt+Escape</em> -    / </b> <br> #+^Escape:: ;shutdown timer <br> InputBox, minutes ,Sleeptimer, Put the minutes before shutdown below:,,200,140 <br> if ErrorLevel <br> exit <br> else <br> Sleep, (minutes*60*1000) <br> Shutdown, 8 <br> return <br> <br> #+!^Escape:: ;restart timer <br> InputBox, minutes ,Sleeptimer, Put the minutes before restart below:,,200,140 <br> if ErrorLevel <br> exit <br> else <br> Sleep, (minutes*60*1000) <br> Shutdown, 2 <br> return <br></code> <br> <br> <b> Windows Media Player      <em>Space</em> (     )</b> <br> <code>~Space:: <br> IfWinActive, ahk_class WMPTransition <br> { <br> PostMessage, 0x111, 32808, 0, , Windows Media Player <br> } <br> IfWinActive, ahk_class WMPlayerApp <br> { <br> PostMessage, 0x111, 32808, 0, , Windows Media Player <br> } <br> return <br> <br></code> <br> <br></code> </div><p>Source: <a href="https://habr.com/ru/post/24652/">https://habr.com/ru/post/24652/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../246509/index.html">Create an emotional stress tracker.</a></li>
<li><a href="../246511/index.html">MultiCAD.NET: calculation of the total length of the segments in the drawing</a></li>
<li><a href="../246515/index.html">How I was looking for an idea for a startup in Silicon Valley</a></li>
<li><a href="../246517/index.html">We connect NTFS to write to Mac OS X Yosemite 10.10</a></li>
<li><a href="../246519/index.html">How we did cashback service kubish.ru</a></li>
<li><a href="../246521/index.html">LIVR - ‚Äúlanguage independent validation rules‚Äù or data validation without ‚Äúproblems‚Äù</a></li>
<li><a href="../246523/index.html">Hacker's guide to neural networks. Chapter 2: Machine Learning. Binary classification</a></li>
<li><a href="../246525/index.html">ReactOS Tech Talk at the faculty of the VMK MSU</a></li>
<li><a href="../246527/index.html">Redmine task requests. How we improved them and how we use them</a></li>
<li><a href="../24653/index.html">The reaction of the humanities girl to her newly installed Ubuntu. The first day.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>