<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Hack Hill's cipher? Easy</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Purpose: Hack the Hill cipher 
 Good day, dear readers! Today I wanted to share a way that helped me uncover the text that was encrypted using Hill‚Äôs ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Hack Hill's cipher? Easy</h1><div class="post__text post__text-html js-mediator-article"><h2>  Purpose: Hack the Hill cipher </h2><br>  Good day, dear readers!  Today I wanted to share a way that helped me uncover the text that was encrypted using Hill‚Äôs method.  I will not describe what Hill method is: experienced craftsmen have already tried to convey to me the features of this method.  <a href="https://habrahabr.ru/post/332714">Link to post</a> . <br><br><h3>  What do we have? </h3><br>  I will say right away that there was neither a plaintext nor a key on my hands.  It was known that the text of <b>6286</b> characters was encoded with a <b>7 x 7</b> matrix.  Therefore, for our convenience, we divide the text into <b>898</b> lines of <b>7</b> characters each.  The text does not contain the letters <b>''</b> and <b>''</b> .  In order to prudence, I will not give all the encrypted text, but only part of it: <br><br> <code>...</code> <br> <br>  Seemingly pointless nonsense, for now ... 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  How are we going to break? </h3><br>  Consider a brute force attack.  It was stated above that two letters are excluded from the alphabet, therefore all linear combinations when encrypting (as well as when decrypting) are taken <b>mod 31</b> (taking into account that this is a simple number, the text becomes a bit more secure). <br>  If we consider brute force inverse key matrices, then we will have to go through <math> </math> $ inline $ 31 ^ {49} $ inline $   combinations (this number is approximately 75 characters).  Therefore, this method is eliminated instantly, though!  If from this set it would be possible to sort through a subset of <b>non-degenerate matrices in</b> some more or less fast way, then perhaps the task would be easier.  Unfortunately, I don‚Äôt know such a way and am not sure that such a one exists at all! <br><a name="habracut"></a><br><h3>  TO <cut>  How to be? </cut></h3><br>  I propose to slightly "soften" our attack and use <cut>  with sharpness.  Imagine that we know the original matrix and take one of its lines.  Let it be the <b>first line</b> .  If we apply the multiplication of the <b>first key line</b> to the <b>first block of</b> size 7, then we will get the <b>first letter</b> of the plaintext.  If we multiply by the second block, we have the <b>seventh letter</b> of plaintext, etc.  In this way, we can get 898 characters of plaintext and collect some statistics from it!  Great, then we have to pick up those seven lines of keys that satisfy some criteria.  With this criterion, I took the <b><a href="https://ru.wikipedia.org/wiki/%25D0%2598%25D0%25BD%25D0%25B4%25D0%25B5%25D0%25BA%25D1%2581_%25D1%2581%25D0%25BE%25D0%25B2%25D0%25BF%25D0%25B0%25D0%25B4%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B9">index of</a></b> Russian <b><a href="https://ru.wikipedia.org/wiki/%25D0%2598%25D0%25BD%25D0%25B4%25D0%25B5%25D0%25BA%25D1%2581_%25D1%2581%25D0%25BE%25D0%25B2%25D0%25BF%25D0%25B0%25D0%25B4%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B9">coincidences</a></b> .  To do this, you need to collect all 898 letters, calculate the frequency for each letter and calculate their coincidence index (IC).  the recalculation of the information system directly caused doubts for the following reason: the use of the <b>double</b> type prevents the program from running quickly.  I was lucky to find the finest <a href="http://www.threaded.com/cryptography2.htm">article</a> about <b>FI-test</b> for mono-alphabeticity.  Very briefly: <br><br><ul><li>  Calculates the "critical" point <math> </math> $ inline $ PHI (p) = 0.0529 * N * (N-1) $ inline $   where N is the length of the text; </li><li>  Random text is taken, calculated <math> </math> $ inline $ PHI (o) = \ sum F (F- 1) $ inline $   where F is the number of times a letter occurs in the text; </li><li>  We learn how much better <math> </math> $ inline $ PHI (O) $ inline $   approximates <math> </math> $ inline $ PHI (P) $ inline $   . </li></ul><br>  Rather, you notice that there is nothing new there.  All the same can be done by breaking the Vizhener cipher.  However, this will allow us to use only integer types in the program, due to which the conversion performance will only accelerate. <br><br><h3>  Start breaking ... </h3><br>  Immediately make a reservation: yes, I am a <s>cattle</s> coder.  I have no doubt that the professionals of the C language will find something to complain about here :).  The program was parallelized on 8 threads. <br>  I will say that for our text <math> </math> $ inline $ PHI (p) = 0.0529 * 898 * 897 = 42611 $ inline $   .  I will give the code of one stream: <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> chast[<span class="hljs-number"><span class="hljs-number">898</span></span>]; <span class="hljs-comment"><span class="hljs-comment">/*   */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> mass[<span class="hljs-number"><span class="hljs-number">31</span></span>]; <span class="hljs-comment"><span class="hljs-comment">/*   */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> c1; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> c2; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> c3; <span class="hljs-keyword"><span class="hljs-keyword">register</span></span> __int32 PHI_O; <span class="hljs-comment"><span class="hljs-comment">/*PHI(O)*/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> k1 = <span class="hljs-number"><span class="hljs-number">0</span></span>; k1 &lt; <span class="hljs-number"><span class="hljs-number">4</span></span>; k1++) { <span class="hljs-comment"><span class="hljs-comment">/*   for ...*/</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> k7 = <span class="hljs-number"><span class="hljs-number">0</span></span>; k7 &lt; <span class="hljs-number"><span class="hljs-number">31</span></span>; k7++) { <span class="hljs-comment"><span class="hljs-comment">/*       PHI(o) */</span></span> <span class="hljs-built_in"><span class="hljs-built_in">memset</span></span>(mass, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">sizeof</span></span>(mass)); PHI_O = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">/*     */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">898</span></span>; i++) { c1 = k1 * sym[<span class="hljs-number"><span class="hljs-number">7</span></span> * i] + k2 * sym[<span class="hljs-number"><span class="hljs-number">7</span></span> * i + <span class="hljs-number"><span class="hljs-number">1</span></span>]; c2 = k3 * sym[<span class="hljs-number"><span class="hljs-number">7</span></span> * i + <span class="hljs-number"><span class="hljs-number">2</span></span>] + k4 * sym[<span class="hljs-number"><span class="hljs-number">7</span></span> * i + <span class="hljs-number"><span class="hljs-number">3</span></span>]; c3 = k5 * sym[<span class="hljs-number"><span class="hljs-number">7</span></span> * i + <span class="hljs-number"><span class="hljs-number">4</span></span>] + k6 * sym[<span class="hljs-number"><span class="hljs-number">7</span></span> * i + <span class="hljs-number"><span class="hljs-number">5</span></span>] + k7* sym[<span class="hljs-number"><span class="hljs-number">7</span></span> * i + <span class="hljs-number"><span class="hljs-number">6</span></span>]; chast[i] = (c1 + c2 + c3) % <span class="hljs-number"><span class="hljs-number">31</span></span>; <span class="hljs-comment"><span class="hljs-comment">/* - */</span></span> mass[chast[i]]++; <span class="hljs-comment"><span class="hljs-comment">/*    */</span></span> } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i = <span class="hljs-number"><span class="hljs-number">0</span></span>; i &lt; <span class="hljs-number"><span class="hljs-number">31</span></span>; i++) PHI_O += mass[i] * (mass[i] - <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(PHI_O &gt; <span class="hljs-number"><span class="hljs-number">39000</span></span>) { <span class="hljs-built_in"><span class="hljs-built_in">cout</span></span> &lt;&lt; PHI_O &lt;&lt; <span class="hljs-string"><span class="hljs-string">'\n'</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">printf</span></span>(<span class="hljs-string"><span class="hljs-string">"%d %d %d %d %d %d %d\n"</span></span>, k1, k2, k3, k4, k5, k6, k7); } } <span class="hljs-comment"><span class="hljs-comment">/*      */</span></span> }</code> </pre> <br>  So one thread goes through <math> </math> $ inline $ 4 * 31 ^ {6} $ inline $   lines of the matrix of the key and made fi-test.  As a result, I received a lot of candidates for the "good" keys.  Some were so elegant that their IP of 898 characters was <b>0.0529</b> !  <i>All is not gold that glitters</i> .  I was not too lazy to recalculate the frequency of letters obtained using the key-string and noticed an amazing thing: <br><br>  <i>This series of letters fully satisfied the criterion of the fi-test, but the frequency of the letters was not plausible.</i>  In other words, the letter ‚Äúb‚Äù could meet as often as the letter ‚Äúo‚Äù occurs in a natural text, and ‚Äúo‚Äù could not be met at all, but the IP property was preserved.  I have not been able to give this a <i>mathematical</i> explanation.  I rule out that this is a coincidence.  So, we had to <i><s>separate flies from cutlets</s></i> to choose the best candidates, which are well combined with the frequency of the letters of our beloved and native Russian language.  Surprisingly, such a tough selection was satisfied by the candidacies of several fighters: <br><br><ul><li>  3 16 5 24 17 20 25 </li><li>  6 30 5 1 13 12 3 </li><li>  7 11 18 12 17 27 15 </li><li>  12 17 0 15 5 16 1 </li><li>  15 19 27 14 21 10 2 </li><li>  25 14 27 20 22 21 22 </li><li>  29 3 1 10 30 28 26 </li></ul><br>  There is nothing left ... Arrange them in the right sequence.  To do this, I had to create a key matrix, change the line indexes between each other using the permutation function (i.e., the permutation went only between indices) and apply the resulting matrix to the ciphertext, I output the whole thing to a text file (wonderfully) and tried to catch at least for some meaningful text.  Looking for ... looking for ... stop!  It seems something turned out!  Yes! <br><br><img src="https://image.ibb.co/gCVYEw/image.png" alt="image"><br><br>  By the way, find among 7!  lines of meaningful text is very easy, take no more than 2 minutes.  It seems that is all! <br><br><h3>  findings </h3><br>  Calculations on the CPU on 8 threads took me 10 hours.  The computer puffed like a steam locomotive.  Faced with difficulties more than once.  First, there were heaps of errors inside the code, which after 10 hours gave an incorrect result.  Secondly, it was difficult to find a suitable criterion.  Thirdly, the program was not given a good optimization (in this article I brought a piece of non-optimized code).  With regard to the <b>theoretical</b> side of the question: <a href="https://eprint.iacr.org/2015/802.pdf">Divide and conquer</a> . <br><br>  This article is a must-read for anyone interested in classical cryptanalysis.  The technique is great for <i>small</i> texts when you do not apply your frequency analysis skills broadly.  The ‚Äúhard‚Äù method is recursive in the sense that it strongly depends on all previous results.  For this reason, it cannot be parallelized (by the way, it cannot be optimized even if it is desired), but the method is dynamic and should lead to the correct result (in theory). <br><br>  What in <b>practice</b> ?  <b>CUDA</b> <s>without him</s> !  If I had my own titan farm (at least stuff 10), Hill‚Äôs cipher would have been ripped apart in less than a minute.  The concept of parallel computing on CUDA, like a pack of hungry piranhas, does not give a chance to remain crypto-resistant to this encryption method, compressing time several thousand times.  I am not a huge expert in this matter, but I almost do not doubt that this idea is easily implemented and I hope someone will implement it (if they really want to). <br><br>  It's all!  I hope my article will be just a little useful for you!  Thanks for attention. </cut></div><p>Source: <a href="https://habr.com/ru/post/345876/">https://habr.com/ru/post/345876/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../345858/index.html">Russian AI Cup 2017 - the story of second place</a></li>
<li><a href="../345860/index.html">Where it is more profitable to buy currency: banks vs exchange</a></li>
<li><a href="../345864/index.html">Import and convert LinguaLeo vocabulary to Anki flashcards</a></li>
<li><a href="../345870/index.html">Translation of the article by the founder of Debian, Jan Murdoch, ‚ÄúHow I Found myself in Linux‚Äù</a></li>
<li><a href="../345874/index.html">Publish the application in the AppStore. A play without dialogue in several acts</a></li>
<li><a href="../345880/index.html">IT history lawyer. Life is business outsourcing. Part 1</a></li>
<li><a href="../345882/index.html">Exhaustive javascript reference for your next job interview. Part 1</a></li>
<li><a href="../345884/index.html">Don't you program yourself a burnout?</a></li>
<li><a href="../345886/index.html">Why programmers need restrictions</a></li>
<li><a href="../345890/index.html">Third cosmic speed for MS SQL Server</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>