<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Download, play sound, use microphone in ActionScript 3.0</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The Flash Builder 4.5 package and, in fact, the ActionScript 3.0 language provides programmers with ample opportunities to use sound and microphone in...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Download, play sound, use microphone in ActionScript 3.0</h1><div class="post__text post__text-html js-mediator-article">  The Flash Builder 4.5 package and, in fact, the ActionScript 3.0 language provides programmers with ample opportunities to use sound and microphone in their flex programs and regular flash drives in particular.  Why is it necessary?  First of all, it can be useful in creating programs such as all sorts of voice chats.  Also, these elements can also be applied in the field of information security - for example, in voice recognition systems.  But in this example and in this particular article, it will be said not so much about this as about the general rules for the use of these elements.  It should also be noted that the work will be carried out with a flex-application. <br><a name="habracut"></a><br><h4>  Microphone connection </h4><br>  Let's start working with a microphone, for which we open, for example, Flash Builder 4.5 and create a Flex project on the AIR platform (a special platform that allows you to create not ‚Äúflash drives‚Äù with the .swf format, but full-fledged applications - if you wish, even with the installation file and digital signature ).  After which we can begin work.  In order for the program to recognize the microphone connected to the computer, you need to register the following code: <br><pre><code class="actionscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> micro:Microphone = Microphone.getMicrophone();</code> </pre> <br>  After executing this line of code, the program will select the first detected sound recorder.  If no devices were connected, the <b>getMicrophone ()</b> method will return <i>null</i> .  It may be that several recording devices will be connected to one computer, in which case any of them can be accessed.  The following code selects the second of the connected devices: <br><pre> <code class="actionscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> micro:Microphone = Microphone.getMicrophone(<span class="hljs-number"><span class="hljs-number">2</span></span>);</code> </pre><br>  If the second device does not exist, the value <i>null</i> will also be returned.  The index property itself, indicating the number of the device being requested, is of type int, that is, an integer type. <br>  It should be noted that if the microphone has never been used in flash programs on your computer, Flash Player will display a special window asking for permission or blocking of this microphone.  When the user selects one of the options, an event of the type STATUS will start, which can be traced.  First you need to bind to this type of event a function that will be triggered when these events occur. <br><pre> <code class="actionscript hljs">micro.addEventListener(StatusEvent.STATUS, onStatus);</code> </pre><br>  This line of code can, for example, be entered into the event handler for pressing any button, or you can write it into the onCreationComplete function ‚Äî then the handler will be bound to events immediately after the program is turned on. <br><pre> <code class="actionscript hljs"><span class="hljs-meta"><span class="hljs-meta-keyword"><span class="hljs-meta"><span class="hljs-meta-keyword">import</span></span></span><span class="hljs-meta"> mx.controls.Alert;</span></span> <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onStatus</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(e:StatusEvent)</span></span></span><span class="hljs-function">:void</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(e.code == <span class="hljs-string"><span class="hljs-string">"Microphone.Unmuted"</span></span>) Alert.show(<span class="hljs-string"><span class="hljs-string">" ."</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(e.code == <span class="hljs-string"><span class="hljs-string">"Microphone.Muted"</span></span>) Alert.show(<span class="hljs-string"><span class="hljs-string">"  ."</span></span>); }</code> </pre><br>  In this short example, we create a STATUS event listener, which, when it receives a signal about the corresponding event, executes the body of the onStatus function.  In this case, e.code is the value that is passed to the handler after pressing one of the buttons ‚Äî enable or disable. <br>  Now let's try to record something by speaking into the microphone.  When any sounds come into the microphone, an event of type SAMPLE_DATA is activated.  To record sound from a microphone, we first create some kind of storage for it.  This will help us to create a variable of such data type as ByteArray. <br><pre> <code class="actionscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> bArr:ByteArray = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ByteArray;</code> </pre><br>  Now, as in the previous example, we add an event listener to our micro variable. <br><pre> <code class="actionscript hljs">micro.addEventListener(SampleDataEvent.SAMPLE_DATA, onSampleC);</code> </pre><br>  After that, we write the handler function for the SAMPLE_DATA event. <br><pre> <code class="actionscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onSampleC</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(e:SampleDataEvent)</span></span></span><span class="hljs-function">:void</span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> sample:Number; bArr.clear(); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(e.data.bytesAvailable){ sample = e.data.readFloat(); bArr.writeFloat(sample); } }</code> </pre><br>  In this example, we first clear our bArr byte array so that when the program is reused, the second record is not recorded after the first one into the same array.  After that, we read the sound in our array as bytes, until it stops. <br>  The Microphone class also has another interesting method.  It allows you to send sound from a microphone to a sound-reproducing device (that is, speakers).  It looks like this: <br><pre> <code class="actionscript hljs">micro.setLoopBack(<span class="hljs-literal"><span class="hljs-literal">true</span></span>);</code> </pre><br>  But along with this method, you must use one more: <br><pre> <code class="actionscript hljs">mic.setUseEchoSuppression(<span class="hljs-literal"><span class="hljs-literal">true</span></span>);</code> </pre><br>  This method involves the use of special echo cancellation technology.  Even with it, the sound can be slightly distorted, and without it, when using micro.setLoopBack (true);  You can even damage your speakers. <br>  It is also possible to adjust the volume of the sound coming through the microphone.  For this is the parameter gain.  For example, by creating an HSlider object on a form, you can write a handler function for the slider movement event, creating a simple volume control.  To do this, we write the function: <br><pre> <code class="actionscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onSlCh</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:void </span></span>{ micro.gain = sl.value; }</code> </pre>  where sl is the id parameter value of the HSlider object. <br><br><h4>  Sound reproduction </h4><br>  The main sound object in ActionScript 3.0 is an instance of the Sound class.  That he has such a method as play (), which allows you to play sound through speakers or headphones.  Our first task will be downloading and playing audio in mp3 format.  First of all, to load any mp3-file into an object of the class Sound, you need to create a so-called URLRequest - set the path to the file.  For example: <br><pre> <code class="actionscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> urlr:URLRequest = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> URLRequest(<span class="hljs-string"><span class="hljs-string">"sample.mp3"</span></span>);</code> </pre><br>  In this example, the sound is loaded from the folder of the created application project and is called sample.mp3.  If you need to download a sound file from another local disk, you should create a URLRequest variable like this: <br><pre> <code class="actionscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> urlr:URLRequest = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> URLRequest(<span class="hljs-string"><span class="hljs-string">"C:/sample.mp3"</span></span>);</code> </pre><br>  After that, you can immediately register the following code: <br><pre> <code class="actionscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> snd:Sound = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Sound(urlr);</code> </pre><br>  And run the method <br><pre> <code class="actionscript hljs">snd.play();</code> </pre>  hanging it on a handler, for example, pressing a button. <br><br>  You can do it differently, playing the sound when it is loaded and ready to use.  To do this, once again use the event handler functions.  Create an event handler that is activated when the audio file is loaded into the program: <br><pre> <code class="actionscript hljs">snd.addEventListener(Event.COMPLETE, onSndReady);</code> </pre><br>  In this case, the snd variable should be created not in the same way as in the previous example, but as follows: <br><pre> <code class="actionscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> urlr:URLRequest = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> URLRequest(<span class="hljs-string"><span class="hljs-string">"C:/sample.mp3"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> snd:Sound = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Sound();</code> </pre><br>  In the handler function of any button press event, write <br><pre> <code class="actionscript hljs">snd.load();</code> </pre><br>  This method will load the sound file specified in the urlr, and when the download is complete, send the COMPLETE event. <br>  At first, we will not pass any variables to the Sound class constructor. <br>  After this, create the specified onSndReady function: <br><pre> <code class="actionscript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onSndReady</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(e:Event)</span></span></span><span class="hljs-function">:void </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> lsnd:Sound = e.target <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> Sound; lsnd.play(); }</code> </pre><br>  As a result, as soon as the sound file specified in urlr is loaded into the program, it will be played. <br>  It is also quite simple to write a function that will track the sound loading during its preparation for playback.  To do this, on the form of the program you should create, for example, a TextArea object.  Having set the value of its id = txt property, we will write the connection of the load event listener using the already familiar scheme: <br><pre> <code class="actionscript hljs">snd.addEventListener(ProgressEvent.PROGRESS, onLoading);</code> </pre><br>  After that, we will write a function that in our improvised text log txt will display the value of the loaded data as a percentage: <br><pre> <code class="actionscript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onLoading</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(e:ProgressEvent)</span></span></span><span class="hljs-function">:void </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> loaded:int = Math.round(<span class="hljs-number"><span class="hljs-number">100</span></span> *(e.bytesLoaded / e.bytesTotal)); txt.text += <span class="hljs-string"><span class="hljs-string">"   "</span></span>+loaded+<span class="hljs-string"><span class="hljs-string">"%."</span></span>; }</code> </pre><br>  As a result, the percentage of audio file loading will be displayed in the log called txt. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Finally, you should talk about some additional parameters of the play () method. <br>  It has two of them - it is the startTime parameter, specified in milliseconds, and the loops parameter, which indicates how many times the downloaded sound should be repeated. <br>  For example, snd.play (1000,3) will play the sound loaded into snd starting from 1 second and then repeat it three times. <br>  This concludes the article on loading and playing audio, as well as using the microphone in ActionScript 3.0 and their most common uses.  Thank you for your attention and good luck in writing your own programs. </div><p>Source: <a href="https://habr.com/ru/post/167263/">https://habr.com/ru/post/167263/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../167245/index.html">Translation SDL Game Framework Series. Part 3 - SDL Events</a></li>
<li><a href="../167247/index.html">Object-disoriented language</a></li>
<li><a href="../167249/index.html">Apple released iOS 6.1 beta 5</a></li>
<li><a href="../167257/index.html">Interview with the creator of C ++ STL, 1995 Part 2</a></li>
<li><a href="../167261/index.html">Using Python in a multithreaded C ++ application and true multithreading in Python</a></li>
<li><a href="../167265/index.html">Communication between windows of one browser by means of cookies</a></li>
<li><a href="../167269/index.html">Setting up multiple Postfix instances on the same server</a></li>
<li><a href="../167273/index.html">Custom JavaScript and CSS on mobile devices</a></li>
<li><a href="../167277/index.html">Flying phone or wand</a></li>
<li><a href="../167279/index.html">The predestination of the development of information waves</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>