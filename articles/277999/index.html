<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>An example of using the inventory and reporting features in System Center Configuration Manager</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The author of the article is Mikhail Glazyrin, system and network engineer, Khabarovsk Airport 
 Hello. Today I would like to talk about the most rare...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>An example of using the inventory and reporting features in System Center Configuration Manager</h1><div class="post__text post__text-html js-mediator-article"><blockquote>  <i>The author of the article is Mikhail Glazyrin, system and network engineer, Khabarovsk Airport</i> </blockquote><br>  Hello.  Today I would like to talk about the most rarely used features in System Center Configuration Manager - inventory and reporting. <br><br>  I don‚Äôt even know why it happened, but from experience, administrators who installed SCCM in their infrastructure rarely use these two functions.  Of course, the killer features of SCCM are the automation of system deployment and software installation.  In third place in terms of popularity is the management of the corporate antivirus System Center Endpoint Protection.  About the inventory and monitoring in SCCM, many people know at the level of "seen in the management console, but never clicked." <a name="habracut"></a>  It even goes to the point that particularly careless (and I will explain below why) administrators generally disable the inventory functionality in the SCCM client's default policy to supposedly speed up the load and reduce the load on client systems.  I‚Äôll say right away that the load from inventory using Configuration Manager tools is an order of magnitude lower than using some other common products (for example, the same Everest).  Inventory takes place solely on a schedule, and not every download or every user login, thereby not slowing down the load on client machines. <br><br>  In this article, we will configure SCCM to proactively monitor the status of hard disks in client machines, but first - a few words about the inventory. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      More specifically - about the hardware inventory.  SCCM has a software inventory based on the collection of information about files and their availability; it will not be discussed in this article.  The hardware inventory is all built on WMI, so you can collect any parameters that are available for querying through this interface.  SCCM comes standard with many predefined classes covering most needs for collecting information about client machines.  Of course, it is not necessary to collect them all.  To configure the inventory information, in the SCCM console, open Administration -&gt; Client Settings, properties Default Client Policy -&gt; Hardware Inventory -&gt; Set Classes.  Here you can choose what you want to build using SCCM, up to the parameters of the WMI classes.  You can assign different inventory policies to different device collections, for example, to enable the collection of battery and power information only for a collection of mobile devices.  Such granularity saves the space occupied by the SCCM site database, reduces the load on client machines and, which is important for me personally, corresponds to the best practice ‚Äúnecessary sufficiency‚Äù. <br><br><h1>  Life story </h1><br>  Once the technical support department of our company was puzzled by the possibility of centralized SMART data collection from client machines.  Unfortunately, the search did not reveal an acceptable solution in terms of convenience and centralization, and we turned to the tools built into Windows.  Windows systems of all currently relevant versions have the SMART data collection functionality from the drives installed in the system.  Unfortunately, the system analyzes the information on how and what parameters I could not find, but what is important for us now is that the result of this activity is a WMI parameter, which can be read with the help of SCCM.  By the way, this is the same parameter that is responsible for the output of such a familiar window to many: <br><br><img src="https://habrastorage.org/files/c71/309/a1b/c71309a1b3d846bf9c1c99abe8dd831b.png"><br><br>  However, the average user simply closes the window, without giving it any meaning.  We will collect this status from all of our computers in order to finally know where to replace the disk. <br><br>  It is in the <i>root \ wmi namespace</i> , the class is called <i>MSStorageDriver_FailurePredictStatus</i> .  A query to this class returns parameters, including the system name of the disk device and its health (part of the output is omitted): <br><br><pre><code class="hljs vbscript">PS C:\Windows\system32&gt; <span class="hljs-keyword"><span class="hljs-keyword">Get</span></span>-WmiObject -namespace root\wmi -<span class="hljs-keyword"><span class="hljs-keyword">class</span></span> MSStorageDriver_FailurePredictStatus Active : <span class="hljs-literal"><span class="hljs-literal">True</span></span> InstanceName : SCSI\Disk&amp;Ven_ATA&amp;Prod_WDC_WD5003AZEX<span class="hljs-number"><span class="hljs-number">-0</span></span>\<span class="hljs-number"><span class="hljs-number">4</span></span>&amp;<span class="hljs-number"><span class="hljs-number">15828421</span></span>&amp;<span class="hljs-number"><span class="hljs-number">0</span></span>&amp;<span class="hljs-number"><span class="hljs-number">030000</span></span>_0 PredictFailure : <span class="hljs-literal"><span class="hljs-literal">False</span></span> Reason : <span class="hljs-number"><span class="hljs-number">0</span></span> Active : <span class="hljs-literal"><span class="hljs-literal">True</span></span> InstanceName : SCSI\Disk&amp;Ven_ATA&amp;Prod_OCZ-VERTEX3\<span class="hljs-number"><span class="hljs-number">4</span></span>&amp;<span class="hljs-number"><span class="hljs-number">15828421</span></span>&amp;<span class="hljs-number"><span class="hljs-number">0</span></span>&amp;<span class="hljs-number"><span class="hljs-number">050000</span></span>_0 PredictFailure : <span class="hljs-literal"><span class="hljs-literal">False</span></span> Reason : <span class="hljs-number"><span class="hljs-number">0</span></span> ...</code> </pre> <br>  In this output, we are interested in the <i>PredictFailure</i> parameter.  We will assemble it by simply adding a new class in the <b>Hardware Inventory Classes</b> window.  The procedure of adding has no difficulties.  As a result, we obtain the following picture: <br><br><img src="https://habrastorage.org/files/8af/5b6/342/8af5b6342d904cf0b9dc14e8329b679f.jpg"><br><br>  After passing the next inventory cycle on a schedule, our parameter will appear in the computer resources: <br><br><img src="https://habrastorage.org/files/ddb/e19/5c6/ddbe195c6429452685d5f3d80dc822e9.jpg"><br><br>  Of course, it would be quite possible to stop at this, but why, if you can go to the end and force SCCM to send us information about computers with problem disks? <br><br>  To do this, we use the functionality of generating reports. <br><br>  Reporting in SCCM works entirely on the basis of SQL Server Reporting Services (and the SCCM management console in the Monitoring -&gt; Reporting section is actually a front-end to simplify working with them).  "Out of the box" immediately after installing the product, we get a fairly large number of various, and most importantly, useful reports.  They can be used in a one-time mode, and create a subscription.  In the latter case, they can be received by mail (useful for obtaining regular information about the state of the infrastructure on certain parameters), or laid out on a network drive (for example, if you need to have at hand an up-to-date registry of any information). <br><br>  To edit reports you need <a href="https://www.microsoft.com/en-us/download/details.aspx%3Fid%3D29072">SQL Server Report Builder</a> .  Before modifying a standard report, it is a good idea to first save it under a new name so that you can return to it if necessary.  To upload statistics on potentially problematic hard drives, we will have to create a new report from scratch.  Yes, I am ready to admit that creating a report from scratch is not a very trivial procedure: you will need knowledge in the area of ‚Äã‚Äãwriting SQL queries and the structure of the SCCM database.  And if the information on the first in abundance, then on the second it is not so much. <br><br>  You can go the way of cheating and somewhat simplify your life by first creating a request through the interface available in the section Monitoring -&gt; Queries. <br><br><img src="https://habrastorage.org/files/5c6/1f0/014/5c61f001463446ffba87c16127e1dc8d.jpg"><br><br>  Then you can just see its source code in the request properties: <br><br><img src="https://habrastorage.org/files/9ee/1a0/30f/9ee1a030f15e4db496adbe65d698d62e.jpg"><br><br>  This is the place where the main problem scares people from creating reports in SCCM.  After all, queries are written in SQL-like language WQL, and reports work directly from the database, and they don‚Äôt know about any WQL.  If you try to insert such a query directly into the Report Builder, it is reasonable to say that he does not know what <i>SMS_R_System</i> and <i>SMS_G_System are</i> .  Everything will become much easier if you know that these objects are views in the SCCM database.  Moreover, objects beginning with <i>SMS_R_System</i> correspond to species whose name begins with <i>v_R</i> , and objects <i>SMS_G_System correspond</i> to <i>v_GS</i> .  Thus, it is sufficient to simply convert the WQL query to SQL.  In our example, <i>SMS_G_System_MSSTORAGEDRIVER_FAILUREPREDICTSTATUS</i> will become <i>v_GS_ MSSTORAGEDRIVER_FAILUREPREDICTSTATUS</i> .  In general, if you have any doubts - do not be afraid to open the SCCM database in the SQL Management Studio, everything will become much clearer.  All objects, parameters and properties are clearly there: <br><br><img src="https://habrastorage.org/files/41e/db1/917/41edb1917a334ec0b0a319423e81ae00.jpg"><br><br>  After you have written a request, it is simple to make a report using the Report Builder wizard. <br><br><img src="https://habrastorage.org/files/c73/dd1/ca5/c73dd1ca55d848a19ca9504e1df90925.jpg"><br><br>  After that, you can request our new report directly from the SCCM console: <br><br><img src="https://habrastorage.org/files/b32/00e/1ad/b3200e1ad709439ab31b8165991362a0.jpg"><br><br>  Of course, you can subscribe to the new report in the same way as to any other.  It should be remembered that it makes little sense to automatically generate a report more often than we collect new data from client machines.  Our technical support department receives this report by mail every week from Monday morning as an attached PDF file. </div><p>Source: <a href="https://habr.com/ru/post/277999/">https://habr.com/ru/post/277999/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../277983/index.html">Software Internet gateway for a company not already small (Shorewall, QoS in full width). Part 3</a></li>
<li><a href="../277987/index.html">Go in terms of PHP programmer</a></li>
<li><a href="../277989/index.html">View design pattern in languages ‚Äã‚Äãwith dependent types</a></li>
<li><a href="../277991/index.html">What does the VxRail hyper-convergent system look like? Online demo, functionality, availability to order</a></li>
<li><a href="../277995/index.html">Hooks are easy (part 3)</a></li>
<li><a href="../278001/index.html">Performance and multithreading at the JPoint 2016 Java Conference</a></li>
<li><a href="../278005/index.html">Implementing a stable UART, at a speed of 921600 baud or more, in Verilog language under FPGA</a></li>
<li><a href="../278007/index.html">What mobile devices do public transport passengers prefer?</a></li>
<li><a href="../278009/index.html">Set operations using Google Guava</a></li>
<li><a href="../278011/index.html">Fees for developers and a terminal based on the Russian microprocessor Baykal-T</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>