<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We open possibilities of map in nginx</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="map is a powerful directive that can make your configs simple and straightforward. 
 Perhaps this is the most undervalued directive, due to the fact t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We open possibilities of map in nginx</h1><div class="post__text post__text-html js-mediator-article">  map is a powerful directive that can make your configs simple and straightforward. <br>  Perhaps this is the most undervalued directive, due to the fact that not everyone knows all its capabilities. <br>  In a compact form, it helps to handle variables, GET parameters, headers, cookies, and backend sets (upstream). <br>  I will try to reveal its capabilities to users. <br><a name="habracut"></a><br>  For simplicity, in the examples, the map directive will be adjacent to the directives from location. <br>  In a real config, the map location is in the http block. <br><div class="spoiler">  <b class="spoiler_title">A brief description of the map</b> <div class="spoiler_text">  This is a directive that sets the value of one variable (right), depending on the other (left). <br>  It looks like this: <br><pre><code class="nginx hljs"><span class="hljs-attribute"><span class="hljs-attribute">map</span></span> <span class="hljs-variable"><span class="hljs-variable">$arg_one</span></span> <span class="hljs-variable"><span class="hljs-variable">$var_two</span></span> { "one" "two"; }</code> </pre> <br>  Regular expressions can be used on the left, including named selections. <br>  On the right side there can be strings, variables and regexp selections from the left side. <br>  The map directive is described in the http block. <br>  A full description can be found in the <a href="http_map_module.html">documentation</a> . <br></div></div><br><h4>  Replace if with map </h4><br><div class="spoiler">  <b class="spoiler_title">If features in nginx</b> <div class="spoiler_text">  if in nginx is implemented in its own way, it is rather obvious. <br>  In short, it is described on a <a href="http://wiki.nginx.org/IfIsEvil">special page</a> . <br>  As far as I understand, if in nginx is from the category when the world revolves around you, and not vice versa. <br>  For each if in location, nginx generates two config files for itself, with if = true and with if = false. <br>  Plus, some directives behave strangely, or do not work at all next to if in one location. <br>  Therefore, when working with if, there is always a chance of not the behavior you expected. <br>  For guaranteed behavior, if it is better to replace with map. <br></div></div><br>  Consider the examples of substitutions, from simple to complex. <br><br><h5>  Set variable one value </h5><br>  To do this, you most likely have already written this structure: <br><pre> <code class="nginx hljs"><span class="hljs-attribute"><span class="hljs-attribute">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$arg_one</span></span> = <span class="hljs-string"><span class="hljs-string">"one"</span></span>) { <span class="hljs-attribute"><span class="hljs-attribute">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$var_two</span></span> <span class="hljs-string"><span class="hljs-string">"two"</span></span>; }</code> </pre><br>  You can do this with the map: <br><pre> <code class="nginx hljs"><span class="hljs-attribute"><span class="hljs-attribute">map</span></span> <span class="hljs-variable"><span class="hljs-variable">$arg_one</span></span> <span class="hljs-variable"><span class="hljs-variable">$var_two</span></span> { "one" "two"; }</code> </pre><br>  And in the right place, just use <code>$var_two</code> . <br>  Even in such a simple case, the map has advantages: <br><ul><li>  no matter how many more if, or other directives will be in the location, this variable will get its value; </li><li>  for nginx it is less expensive, since the value of the variable will be calculated only at the time of use; </li></ul><br><h5>  Set a variable to one of several values. </h5><br>  I suppose that for this purpose they are already resorting to a map, but sometimes there is a variant with several if: <br><pre> <code class="nginx hljs"><span class="hljs-attribute"><span class="hljs-attribute">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$arg_one</span></span> = <span class="hljs-string"><span class="hljs-string">"one"</span></span>) { <span class="hljs-attribute"><span class="hljs-attribute">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$var_two</span></span> <span class="hljs-string"><span class="hljs-string">"two"</span></span>; } <span class="hljs-attribute"><span class="hljs-attribute">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$arg_one</span></span> = <span class="hljs-string"><span class="hljs-string">"three"</span></span>) { <span class="hljs-attribute"><span class="hljs-attribute">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$var_two</span></span> <span class="hljs-string"><span class="hljs-string">"four"</span></span>; }</code> </pre><br>  You can do this with the map: <br><pre> <code class="nginx hljs"><span class="hljs-attribute"><span class="hljs-attribute">map</span></span> <span class="hljs-variable"><span class="hljs-variable">$arg_one</span></span> <span class="hljs-variable"><span class="hljs-variable">$var_two</span></span> { "one" "two"; "three" "four"; }</code> </pre><br>  Already visible gain in compactness and readability. <br>  If you still need to edit the conditions, you need to correct the line in the map. <br><br><h5>  Nested if (dependent on several conditions) </h5><br>  I found questions on nginx mailing lists about nested if, when you need to take into account several conditions. <br>  Nested if cannot be done, you can make a crutch from several if. <br>  And you can write one map. <br>  You may not know, but in the source part (where the first variable) you can specify not one variable, but the whole text containing several variables, in quotes. <br>  For example, you need to block users with the ‚ÄúHackYou‚Äù user-agent, hacking ‚ÄúPOST‚Äù with a request to the address "/ admin / some / url". 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      This, in principle, can be done with if: <br><pre> <code class="nginx hljs"><span class="hljs-attribute"><span class="hljs-attribute">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$http_user_agent</span></span> <span class="hljs-regexp"><span class="hljs-regexp">~ "HackYou")</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$block</span></span> <span class="hljs-string"><span class="hljs-string">"A"</span></span>; } <span class="hljs-attribute"><span class="hljs-attribute">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$method</span></span> = <span class="hljs-string"><span class="hljs-string">"POST"</span></span>) { <span class="hljs-attribute"><span class="hljs-attribute">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$block</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${block}</span></span></span><span class="hljs-string">B"</span></span>; } <span class="hljs-attribute"><span class="hljs-attribute">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$uri</span></span> = <span class="hljs-string"><span class="hljs-string">"/admin/some/url"</span></span>) { <span class="hljs-attribute"><span class="hljs-attribute">set</span></span> <span class="hljs-variable"><span class="hljs-variable">$block</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${block}</span></span></span><span class="hljs-string">C"</span></span>; } <span class="hljs-attribute"><span class="hljs-attribute">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$block</span></span> = <span class="hljs-string"><span class="hljs-string">"ABC"</span></span>) { <span class="hljs-attribute"><span class="hljs-attribute">return</span></span> <span class="hljs-number"><span class="hljs-number">403</span></span>; }</code> </pre><br>  You can do this with the map: <br><pre> <code class="nginx hljs"><span class="hljs-attribute"><span class="hljs-attribute">map</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$http_user_agent</span></span></span><span class="hljs-string">:</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$method</span></span></span><span class="hljs-string">:</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$uri</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-variable"><span class="hljs-variable">$block</span></span> { "HackYou:POST:/admin/some/url" "1"; } <span class="hljs-attribute"><span class="hljs-attribute">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$block</span></span>) { <span class="hljs-attribute"><span class="hljs-attribute">return</span></span> <span class="hljs-number"><span class="hljs-number">403</span></span>; }</code> </pre><br>  The colon is just for convenience. <br>  In this example, a ‚Äúpoint of no return‚Äù occurs in the direction of the map. <br>  If the number of conditions grows (for example, several user-agents), it will not be possible to implement them with an if set, or it will be too cumbersome. <br><br><h4>  http headers </h4><br>  If you need to add headers depending on some conditions, with if this can be a problem. <br><br>  For example, this design: <br><pre> <code class="nginx hljs"><span class="hljs-attribute"><span class="hljs-attribute">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$arg_a</span></span> = <span class="hljs-string"><span class="hljs-string">"1"</span></span>) { <span class="hljs-attribute"><span class="hljs-attribute">add_header</span></span> X-one <span class="hljs-string"><span class="hljs-string">"one"</span></span>; } <span class="hljs-attribute"><span class="hljs-attribute">add_header</span></span> X-two <span class="hljs-string"><span class="hljs-string">"two"</span></span>;</code> </pre><br>  It will give only one header (X-one, if arg_a = true, and X-two, if false). <br>  This is a lack of add_header and developers will not fix it. <br>  And if you have multiple ifs with headers, you may not be able to add several different headers at the same time. <br><br>  But here comes the map: <br><pre> <code class="nginx hljs"><span class="hljs-attribute"><span class="hljs-attribute">map</span></span> <span class="hljs-variable"><span class="hljs-variable">$arg_a</span></span> <span class="hljs-variable"><span class="hljs-variable">$header_one</span></span> { "1" "one"; } <span class="hljs-attribute"><span class="hljs-attribute">add_header</span></span> X-one <span class="hljs-variable"><span class="hljs-variable">$header_one</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">add_header</span></span> X-two <span class="hljs-string"><span class="hljs-string">"two"</span></span>;</code> </pre><br>  Multiple headers - multiple map. <br>  If the variable is empty, nginx simply does not create a header. <br>  In general, in the case of if, the headers_more module can help; it lacks the add_header lack of if. <br>  The headers_more module is interesting in itself, with its help you can flexibly manage any headers, both of the response and the request (for the backend). <br>  Paired with the map directive, this module can implement many Wishbacks, including the generation of several cookies. <br><br><h4>  Upstream choice </h4><br>  In directives like proxy_pass (fastcgi_pass and other * _pass), where you can specify upstream as a backend, you can use variables. <br>  Those.  This definition works: <br><pre> <code class="nginx hljs"><span class="hljs-attribute"><span class="hljs-attribute">proxy_pass</span></span> http://<span class="hljs-variable"><span class="hljs-variable">$php_backend</span></span>;</code> </pre><br>  This is stated in the <a href="http_proxy_module.html">documentation</a> : <br><blockquote>  In this case, the server name is searched among the described server groups and, if not found, is determined using the resolver. </blockquote><br>  Paired with the map, it gives us a field for fantasy. <br>  Here is a rough example - let's say we need this: <br>  There is a cook userid. <br>  If its value is the first number from 0 to 4, then send requests to upstream old_php_backend. <br>  If from 5 to 9 - on new_php_backend. <br>  If there is no cookie, or it is empty, or the first character is not a number, then on default_php_backend. <br><br>  Usually done with if, rewrite and multiple location: <br><pre> <code class="nginx hljs"><span class="hljs-attribute"><span class="hljs-attribute">location</span></span> /some/url/ { <span class="hljs-attribute"><span class="hljs-attribute">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$cookie_userid</span></span> <span class="hljs-regexp"><span class="hljs-regexp">~ "~^[0-4]")</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">rewrite</span></span><span class="hljs-regexp"><span class="hljs-regexp"> ^(.+)$</span></span> /old/<span class="hljs-variable"><span class="hljs-variable">$1</span></span> <span class="hljs-literal"><span class="hljs-literal">last</span></span>; } <span class="hljs-attribute"><span class="hljs-attribute">if</span></span> (<span class="hljs-variable"><span class="hljs-variable">$cookie_userid</span></span> <span class="hljs-regexp"><span class="hljs-regexp">~ "~^[5-9]")</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">rewrite</span></span><span class="hljs-regexp"><span class="hljs-regexp"> ^(.+)$</span></span> /new/<span class="hljs-variable"><span class="hljs-variable">$1</span></span> <span class="hljs-literal"><span class="hljs-literal">last</span></span>; } <span class="hljs-attribute"><span class="hljs-attribute">proxy_pass</span></span> http://default_php_backend; } <span class="hljs-attribute"><span class="hljs-attribute">location</span></span> /old/some/url/ { internal; <span class="hljs-attribute"><span class="hljs-attribute">rewrite</span></span><span class="hljs-regexp"><span class="hljs-regexp"> ^/old/(.+)$</span></span> <span class="hljs-variable"><span class="hljs-variable">$1</span></span> <span class="hljs-literal"><span class="hljs-literal">break</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">proxy_pass</span></span> http://old_php_backend; } <span class="hljs-attribute"><span class="hljs-attribute">location</span></span> /new/some/url/ { internal; <span class="hljs-attribute"><span class="hljs-attribute">rewrite</span></span><span class="hljs-regexp"><span class="hljs-regexp"> ^/new/(.+)$</span></span> <span class="hljs-variable"><span class="hljs-variable">$1</span></span> <span class="hljs-literal"><span class="hljs-literal">break</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">proxy_pass</span></span> http://new_php_backend; }</code> </pre><br>  Using map makes it all easier: <br><pre> <code class="nginx hljs"><span class="hljs-attribute"><span class="hljs-attribute">map</span></span> <span class="hljs-variable"><span class="hljs-variable">$cookie_userid</span></span> <span class="hljs-variable"><span class="hljs-variable">$php_backend</span></span> { "~^[0-4]" "old_php_backend"; "~^[5-9]" "new_php_backend"; <span class="hljs-attribute"><span class="hljs-attribute">default</span></span> <span class="hljs-string"><span class="hljs-string">"default_php_backend"</span></span>; } <span class="hljs-attribute"><span class="hljs-attribute">location</span></span> /some/url/ { <span class="hljs-attribute"><span class="hljs-attribute">proxy_pass</span></span> http://<span class="hljs-variable"><span class="hljs-variable">$php_backend</span></span>; }</code> </pre><br>  It really works, it is applied on a loaded service, and there are no problems with it. <br>  The main thing is not to forget about default, so that there is always where to send the request. <br>  This technique can also be used with geo / split_clients. <br>  For example, in split_clients, allocate 1% of requests and send them to a separate backend for tests. <br><br><h4>  Variables from map can be used in another map </h4><br>  This code works: <br><pre> <code class="nginx hljs"><span class="hljs-attribute"><span class="hljs-attribute">map</span></span> <span class="hljs-variable"><span class="hljs-variable">$arg_a</span></span> <span class="hljs-variable"><span class="hljs-variable">$var_a</span></span> { "0" "1"; } <span class="hljs-attribute"><span class="hljs-attribute">map</span></span> <span class="hljs-variable"><span class="hljs-variable">$var_a</span></span> <span class="hljs-variable"><span class="hljs-variable">$var_b</span></span> { "1" "2"; } <span class="hljs-attribute"><span class="hljs-attribute">map</span></span> <span class="hljs-variable"><span class="hljs-variable">$var_b</span></span> <span class="hljs-variable"><span class="hljs-variable">$var_c</span></span> { "2" "3"; }</code> </pre><br>  When you refer to <code>$var_c</code> , three map directives will work in sequence. <br>  With the GET parameter a = 0, <code>$var_c</code> will contain ‚Äú3‚Äù. <br>  nginx chews a chain of 12 maps, I haven't tried any further. <br>  You can try, for the sake of interest, find out the maximum length of the chain. <br>  Usually I have a pair of map'ov, which depend on each other. <br>  It is useful for me to form complex headers and cookies using nginx (when you need to add text to the header, send one header to the backend and another to the client). <br>  This can come in handy as an example development with nested if. <br>  In one map, we calculate <code>$var_a</code> , in another map, we calculate <code>$var_b</code> , and the third map depends on <code>"$var_a:var_b</code> ". <br><br>  The map also works with variables from geo and split_clients. <br>  In geo and split_clients, the resultant variable can be assigned only a simple string; you cannot use variables or regular expressions. <br>  If you, depending on ip, need something more complicated than a simple line, geo + map will help you. <br>  A bunch of split_clients + map will help you, for example, flexibly change the headers for 1% of users. <br><br>  For example: <br><pre> <code class="nginx hljs"><span class="hljs-attribute"><span class="hljs-attribute">split_clients</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">${remote_addr}</span></span></span><span class="hljs-string">XXX"</span></span> <span class="hljs-variable"><span class="hljs-variable">$test_percent</span></span> { 1% "1"; * "0"; } <span class="hljs-attribute"><span class="hljs-attribute">map</span></span> <span class="hljs-string"><span class="hljs-string">"</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$test_percent</span></span></span><span class="hljs-string">:</span><span class="hljs-variable"><span class="hljs-string"><span class="hljs-variable">$http_user_agent</span></span></span><span class="hljs-string">"</span></span> <span class="hljs-variable"><span class="hljs-variable">$test_mobile_users</span></span> { "~*^1:.*iphone.*" "X-tester: iphone"; } <span class="hljs-attribute"><span class="hljs-attribute">more_set_input_headers</span></span> <span class="hljs-variable"><span class="hljs-variable">$test_mobile_users</span></span>;</code> </pre><br>  If the user's ip got into the test 1% of users, and there is the word iphone in his user-agent, then the header ‚ÄúX-tester: iphone‚Äù is sent along with the request for the backend. <br>  Developers need to respond to this header and give a test version of the site for iPhones. <br><br><h4>  Conclusion </h4><br>  As you can see, map helps to make complex logic with a small number of commands. <br>  It allows you to get rid of if in most cases. <br>  And together with other directives, creates clever conversions in several lines. <br>  I hope these features will help you, on the one hand, to reduce configs, and on the other - to implement cunning Wishlist. </div><p>Source: <a href="https://habr.com/ru/post/231277/">https://habr.com/ru/post/231277/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../231267/index.html">A tale about a white bull or how to stay invisible behind glass</a></li>
<li><a href="../231269/index.html">Fast creation of graphic resources from mdpi to xxhdpi</a></li>
<li><a href="../231271/index.html">Stanford is experimenting with carbon coating for lithium batteries</a></li>
<li><a href="../231273/index.html">Batteries leaked? Do not worry, we will refund your money!</a></li>
<li><a href="../231275/index.html">Convenient binary data source instead of Stream</a></li>
<li><a href="../231279/index.html">‚ÄúNo complications‚Äù home video surveillance: AdvoCam-HappyCam review</a></li>
<li><a href="../231281/index.html">Sass maps: responsive design without routine computing</a></li>
<li><a href="../231285/index.html">Financing innovation. Introduction</a></li>
<li><a href="../231287/index.html">Aspect oriented programming in Android</a></li>
<li><a href="../231289/index.html">Experience in the development and production of prototypes of BLE sockets</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>