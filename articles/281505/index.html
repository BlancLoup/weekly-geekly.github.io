<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How we implemented DevOps: infrastructure-as-code using Microsoft Azure and Azure Resource Manager</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! The next issue of the article from the series ‚ÄúHow we implemented DevOps‚Äù from the Vorlon.JS team. Vorlon.JS is a node.js-based tool that allow...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How we implemented DevOps: infrastructure-as-code using Microsoft Azure and Azure Resource Manager</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/288/1c9/955/2881c995584947a7b841751f12eacdac.png" width="600"><br><br><blockquote>  <i>Hello!</i>  <i>The next issue of the article from the series <a href="https://habrahabr.ru/search/%3Fq%3D%255Bjourney2devops%255D%26target_type%3Dposts">‚ÄúHow we implemented DevOps‚Äù</a> from the Vorlon.JS team.</i>  <i>Vorlon.JS is a node.js-based tool that allows web developers a convenient way to remotely test, control and debug a web application, especially on mobile and embedded systems.</i>  <i>In their blog on MSDN, the team described the phased introduction of DevOps practices into the organization of work on Vorlon.JS and the selection of tools for solving daily tasks.</i>  <i>Vorlon.JS is an <a href="http://github.com/microsoftdx/vorlonjs">open source project</a> .</i> </blockquote>  Microsoft offers a large number of <a href="https://www.visualstudio.com/products/free-developer-offers-vs">tools</a> that can be used to implement DevOps practices, and we will talk about some of them in this cycle. <br><br>  Cycle content: <br><ul><li>  <a href="https://habrahabr.ru/company/microsoft/blog/280446/">Project Planning and Management with Visual Studio Team Services</a> </li><li>  <a href="https://habrahabr.ru/company/microsoft/blog/281024/">Continuous integration with GitHub and Visual Studio Team Services build system</a> </li><li>  <b>Infrastructure-as-code with Microsoft Azure and Azure Resource Manager</b> </li><li>  Release Management in Visual Studio Team Services </li><li>  Testing in production environment with Microsoft Azure App Service and Web Apps </li></ul><br>  What is Infrastructure-as-a-code? 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Infrastructure-as-code is an opportunity to improve the methods of creating and managing application deployment environments at all stages of its life cycle, from the development environment to the production environment.  It allows you to describe (declare) the final desired state of the environment. <br><br>  Suppose you are deploying an application that must run on a web farm of 4 servers. <br><a name="habracut"></a><br>  The application stores and retrieves data from an Azure SQL database and optimizes load times using the Redis Cache service.  The Infrastructure-as-code approach will allow you to write a script that will create the entire environment in an idempotent way (that is, with an identical result, even with multiple executions). <br><br>  Another important feature: by describing the infrastructure by a script, you can manage its versions.  Thus, the source code repository allows you to improve the way developers interact with the operating team, and therefore becomes their common tool.  By controlling the versions of the infrastructure scripts in the source code repository, you can restore an arbitrary version of the application and its environment at any time, for example, to fix the error. <br><br><h4>  Infrastructure-as-code and Microsoft Azure </h4><br>  Using the infrastructure-as-code approach in Microsoft Azure is very simple: use Azure Resource Manager and deployment templates. <br><br>  What are Azure Resource Manager and resource groups? <br><br>  Azure Resource Manager (ARM), as the name implies, is the service for managing all the resources created in Azure.  The first version of Microsoft Azure ARM was missing, and when creating services for an application, developers faced a problem: all services were created as single elements, without any cross-references or dependencies.  Managing a multi-resource application was not easy. <br><br>  ARM works with resource providers.  Each resource provider (for example, Microsoft.Compute, Microsoft.Storage, Microsoft.Network, and others) is used to create a base resource, and ARM manages all providers. <br><br>  Not all services have been transferred to ARM, but many services.  Some of them are duplicated.  For example, the Azure portal allows you to create virtual machines using a classic provider or use a new one that works with ARM.  To create a new infrastructure, it is recommended to use ARM providers, if available. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a93/689/224/a93689224a38097880ed13c251080aeb.png"><br><br>  When using ARM, all resources created will be placed in a resource group.  This logical entity is intended to group resources in Microsoft Azure.  Resource groups open up many new convenient features, such as using tags or getting billing data for an entire application, rather than for individual services. <br><br>  When you deploy a new resource using ARM, you must first create a resource group to which the new resource will be assigned, or use an existing one.  Of course, resources from the same resource group can be deployed in different data centers. <br><br>  Another advantage of ARM compared to older providers: you can describe a group of resources using JSO files and ARM will deploy resources not sequentially, but in parallel, that is much faster. <br><br>  The Deplon folder of the Vorlon.JS project contains a number of scenarios that serve to deploy the infrastructure of development, testing and production environments.  In fact, we used the same script (azuredeploy.json) for development and testing environments with different parameter files, which allowed us to configure each resource for each environment: <br><br> <a href=""><img width="640" height="273" src="https://habrastorage.org/getpro/habr/post_images/c90/8d9/3d9/c908d93d952b29650d9de97f3ecd46f2.png"></a> <br><br>  For a production environment, other deployment templates are used because we use Azure Web Apss functionality (deployment slots) that are not needed in the other two environments. <br><br>  In addition, there are several PowerShell scripts in the Deployment folder that are used in the release management process.  We will talk about this in the next post. <br><br>  More information about Azure Resource Manager and resource groups is available in the documentation at the <a href="">link</a> . <br><br><h4>  Get started with Azure Resource Manager and Resource Groups </h4><br>  Perhaps <a href="https://github.com/MicrosoftDX/Vorlonjs/tree/dev/DeploymentTools">ARM Vorlon.JS project templates</a> are not the easiest material to read, but I want you to know that working with ARM is very simple. <br><br>  Firstly, there are many templates <a href="https://github.com/Azure/azure-quickstart-templates">in this GitHub repository</a> that will allow you to get down to business quickly.  You can read them, modify them, or even try to deploy them ‚Äî to do this, click the Deploy to Azure button in the readme section of the desired template.  You will be taken to the Azure portal, where you just need to enter the parameters and click OK to start the deployment. <br><br> <a href=""><img width="640" height="497" src="https://habrastorage.org/getpro/habr/post_images/46c/e80/ec5/46ce80ec529c53d6bdf352f9fb6a7057.png"></a> <br><br>  Visual Studio and the latest version of the Microsoft Azure SDK / Tools contain a user interface for working with Azure Resource Manager templates. <br><br>  First, create an Azure Resource Group project in Visual Studio: <br><br> <a href=""><img width="640" height="444" src="https://habrastorage.org/getpro/habr/post_images/3ef/6b1/37f/3ef6b137fa1274064b9625ead1884dd2.png"></a> <br><br>  The wizard prompts help you create a resource group.  For example, you can create a resource group consisting of a web application and an Azure SQL database: <br><br> <a href=""><img width="640" height="483" src="https://habrastorage.org/getpro/habr/post_images/38b/d54/389/38bd54389751b5a906fb02c5d17ca50c.png"></a> <br><br>  Visual Studio will generate the following solution: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7b1/48d/3bf/7b148d3bf15bc3c4ee7cd990c2396696.png"><br><br>  The Scripts folder contains a PowerShell script with which you can deploy a resource group to Azure. <br><br>  The Templates folder contains two JSON files: an Azure Resource Manager template with a description of the infrastructure and a parameter file with the parameters necessary for the script.  You can create multiple copies of the second file for different environments. <br><br>  The Tools folder contains the AzCopy.exe executable file.  This is an Azure version of a copy robot that allows you to load content (such as an application package or database backup) into Azure during deployment. <br><br>  When you open the ARM template, the JSON Outline window will appear on the side (JSON Structure): <br><br> <a href=""><img width="640" height="348" src="https://habrastorage.org/getpro/habr/post_images/e2a/f70/290/e2af7029023e15025c312731bcb69fe1.png"></a> <br><br>  The window serves to navigate through the template: select a resource from the list - and its presentation will be highlighted in the JSON file. <br><br>  In addition, in this window you can add resources to the template.  Right-click on the resource node and select Add New Resource: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0bf/877/a84/0bf877a84a6e0e9b113f6fd72a224fca.png"><br><br>  The wizard opens again, and you can add any of a variety of resources to your template: <br><br> <a href=""><img width="640" height="483" src="https://habrastorage.org/getpro/habr/post_images/3c8/bfe/a81/3c8bfea815183e71d3420927631659ea.png"></a> <br><br>  As you can see, if the resource being created depends on other resources, the system will offer to create them too. <br><br>  The prepared template can be deployed to Microsoft Azure.  Right-click on the template and select New Deployment: <br><br> <a href=""><img width="640" height="167" src="https://habrastorage.org/getpro/habr/post_images/645/bec/f5b/645becf5b3cdd2bb13119cfc408ff408.png"></a> <br><br>  Enter your Azure credentials and resource group name and select the subscription within which the group will be created. <br><br>  There is another way - to open and run the PowerShell script from the Scripts folder: <br><br> <a href=""><img width="640" height="339" src="https://habrastorage.org/getpro/habr/post_images/c16/f55/a1e/c16f55a1ec89b0fc98effd3379ceb72f.png"></a> <br><br>  In Vorlon.JS, we set the templates that will be used to automatically prepare the release of an application using Visual Stusio Team Services.  These templates can be viewed directly on GitHub: <a href="https://github.com/MicrosoftDX/Vorlonjs/tree/dev/DeploymentTools">https://github.com/MicrosoftDX/Vorlonjs/tree/dev/DeploymentTools</a> <br><br>  Storing the infrastructure in the form of a code template with the source code of the application is a good practice: you can manage the versions of the application at the same time as the infrastructure dependent on it.  Imagine, for example, that a user reports an error in the old version.  If you have not only source code, but also infrastructure templates, then you can extract the version with an error, restore the environment in a few minutes and start debugging. <br><br>  You are now familiar with the basics of using the Infrastructure-as-code approach in Microsoft Azure. <br><br>  In the next article in this series, you'll learn how we use the Azure Resource Manager and Release Management templates in Visual Studio Team Services to automatically prepare your environments and deploy the application immediately after successfully completing the build. <br><br>  Stay in touch! <br><br><h4>  About the authors </h4><br><img src="https://habrastorage.org/files/1f6/2b9/f58/1f62b9f5871741a1a3eaa583b41c2afa.jpg" align="left" width="150"><br>  Julien Corioland is a technology evangelist from Microsoft, France.  The main direction of work is the Microsoft Azure application platform.  He helps developers create cloud-based applications, and also belongs to the Vorlon.JS tool development group, in which he helps to implement DevOps practices. <br><br>  We are pleased to announce that the developers of the Vorlon.JS project - Julien Corioland and Ettiene Margraff will speak at the DevCon 2016 conference, where they will talk about their experience of implementing practices live exclusively for the participants of the DevOps Intensive by hands. <br><br>  If you have questions about this <a href="https://blogs.technet.microsoft.com/devops/2016/01/12/vorlonjs-a-journey-to-devops-introducing-the-blog-post-series/">series of publications</a> or about the DevOps methodology, you can contact the author directly via Twitter: <a href="http://twitter.com/jcorioland">twitter.com/jcorioland</a> <br><br><h4>  useful links </h4><br><ul><li>  Visual Studio 2015, Visual Studio Team Services, Visual Studio Code: <a href="https://www.visualstudio.com/ru-ru/products/free-developer-offers-vs.aspx">free offers for developers</a> </li><li>  Additional and free tools and services in <a href="https://www.visualstudio.com/ru-ru/products/visual-studio-dev-essentials-vs.aspx">Visual Studio Dev Essentials</a> </li><li>  <a href="https://msdn.microsoft.com/ru-ru/mt627843.aspx">Laboratory work</a> on the development, testing and management of the life cycle of software for Visual Studio 2015 </li></ul></div><p>Source: <a href="https://habr.com/ru/post/281505/">https://habr.com/ru/post/281505/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../281495/index.html">C # math expression parser - amateur experience</a></li>
<li><a href="../281497/index.html">Experiments with malloc</a></li>
<li><a href="../281499/index.html">Macros in Emacs: form teams for processing</a></li>
<li><a href="../281501/index.html">Project Tofino - the new Mozilla browser</a></li>
<li><a href="../281503/index.html">Interfaces: How not to do the option of unsubscribing from the email-list</a></li>
<li><a href="../281509/index.html">5G core networks: flexibility opens up new business opportunities</a></li>
<li><a href="../281511/index.html">// BUILD / 2016: how it was</a></li>
<li><a href="../281513/index.html">What we lack in java</a></li>
<li><a href="../281515/index.html">How to determine the best time for a transaction in the stock market: Trend following algorithms</a></li>
<li><a href="../281517/index.html">How to write a bloom filter in C ++</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>