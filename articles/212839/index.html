<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>SIP Security Essay</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The Internet is a great medium for communication. Communicating through letters, chat, voice or video. If video calling is new enough, people have bee...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>SIP Security Essay</h1><div class="post__text post__text-html js-mediator-article">  The Internet is a great medium for communication.  Communicating through letters, chat, voice or video.  If video calling is new enough, people have been using the phone for a hundred years.  With the laying of new Internet highways and the development of programs like the <a href="http://www.google.com/loon/">Internet with balloons,</a> access to the network will soon be even among penguins in Antarctica.  And since there is such coverage, why use telephone lines?  Why not let the voice on the Internet channels? <br><br>  One solution to this problem is the SIP (Session Initiation Protocol) protocol.  This is a protocol with an interesting history, but now we will touch only on some of its features.  SIP is a session establishment protocol for subsequent data transfer;  transmits information in the clear.  The data may include subscriber credentials - login, domain, password (in open or hashed form), as well as many other interesting fields.  Note that in some cases, authentication may be absent altogether (the connection is configured on both sides as an IP: port pair).  Consider several threats that arise when using the SIP protocol, and the ways to implement these threats. <br><br> <a href="http://habrahabr.ru/company/pt/blog/212839/"><img src="https://habrastorage.org/getpro/habr/post_images/d1f/b44/62b/d1fb4462b157fbb7f9ac179984e1bf30.png" alt="image"></a> <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Threats </h4><br>  Let us turn to the analysis of bad things that can be done using the protocol.  Note that for the implementation of some attacks, an attacker must be on the path of traffic from the client to the server (or organize a MITM attack). <br><br><h4>  Identity theft </h4><br>  Since the protocol transmits data in the clear, anyone who has the ability to "listen" to traffic coming from us can learn a lot of interesting things.  For example, take the authentication process.  The password in SIP is hashed using MD5, which, firstly, has long been strongly <a href="http://www.kb.cert.org/vuls/id/836068">discouraged</a> from being used anywhere, and secondly, can be picked up (for example, using <a href="http://www.darknet.org.uk/2008/08/sipcrack-sip-login-dumper-hashpassword-cracker/">SIPcrack</a> ).  It looks like this: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cc0/c33/687/cc0c3368702db5aedd283ae27142ffb3.png" alt="image"><br><br>  The obtained credentials can be used in various interesting schemes.  If the victim is a <a href="http://ru.wikipedia.org/wiki/Triple_Play">Triple Play</a> client, the attacker can gain access to all services the subscriber has subscribed to.  What is much more dangerous is that the SIP account obtained can be used in fraudulent schemes with PRS numbers, as well as for running a large number of calls to expensive destinations (the amounts that the subscriber will have to pay for other people's conversations can be very, very significant). <br><br>  In more detail about selection of the SIP password: <a href="http://www.sipsorcery.com/mainsite/Help/SIPPasswordSecurity">www.sipsorcery.com/mainsite/Help/SIPPasswordSecurity</a> <br><br><h4>  Wiretap </h4><br>  SIP sound itself does not transmit.  The real-time transport protocol (RTP) is used to transfer the payload (for example, the audio stream).  The protocol is friendly and does not encrypt the transmitted data.  Here the question immediately arises: can not a person who is sitting in the middle and ‚Äúfriendly‚Äù listen to our traffic - listen to our conversation?  Full  For example, using <a href="http://www.oxid.it/cain.html">Cain</a> , popular in the people, which not only kindly helps to implement the MITM, but also gives you an opportunity to listen to the intercepted conversation.  The information thus obtained can obviously be used for the purpose of blackmail or espionage. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0a9/35a/dd1/0a935add135f6c588b88a08a419f01d3.png" alt="image"><br><br><h4>  Call tracking </h4><br>  Since the transmitted SIP data is not encrypted, an attacker who has the ability to listen to packets coming from the victim's client can analyze information about calls, including who and when the victim is calling.  In the future, this information will be useful, for example, when using social engineering. <br><br><h4>  NAT attack </h4><br>  If the client of the victim does not have a white IP address, the attacker who has a public address with him will be able to make calls at the expense of the victim.  Such a situation may arise if the Internet provider provides access to the network through NAT, for which, in addition to the legitimate subscriber, there may be a bunch of obscure people. <br><br>  This is often found in business centers: many small firms go through a local provider‚Äôs NAT. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/197/d35/c08/197d35c08c3e9617bfa815e3673ff32c.png" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/8f7/393/891/8f7393891f2640b2e44958878e2e3838.png" alt="image"><br><br>  As you can see in the picture, the IP address of the calling party is already in the packet that came to the provider before the broadcast (NAT), but this field is not checked when the connection is established (the white IP address is checked), and there can be both a legitimate subscriber address and address of the attacker. <br><br><h4>  Issuing yourself as a provider (using DNS) </h4><br>  By attacking a client‚Äôs DNS server with a MITM attack or DNS cache poisoning (for example, using a <a href="http://unixwiz.net/techtips/iguide-kaminsky-dns-vuln.html">Kaminsky attack</a> ), an attacker can impersonate a provider by sending all calls through his system. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b9b/91f/1ef/b9b91f1ef786f85a6609e4d8714bb82c.png" alt="image"><br><br><h4>  Call Forwarding </h4><br>  By carrying out an MITM attack, the attacker has the ability to redirect client calls to an arbitrary number, including a non-existent one (leading to DoS). <br><br><img src="https://habrastorage.org/getpro/habr/post_images/bcc/33e/101/bcc33e101004f8f3d8d9a9f99f29e8f9.png" alt="image"><br><br>  By intercepting INVITE packets, the attacker responds to the request with a packet with code 301 Moved Permanently, redirecting the call. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2f9/45e/a57/2f945ea57fbb2ff1d1f363dd8eecdf80.png" alt="image"><br><br><h4>  Disconnection </h4><br>  An attacker, knowing or selecting the CallID, FromTag, ToTag, fields, has the ability to terminate active sessions by sending pre-formed malicious packets containing SIP BYE-request, for example, using <a href="http://www.secdev.org/projects/scapy/">scapy</a> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d44/c9c/f9f/d44c9cf9f19feb3b51116a71039efaa2.png" alt="image"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/e2c/b33/473/e2cb3347377821059e6da392fcf5794c.png" alt="image"><br><br><br><h4>  Fake calls </h4><br>  Since SIP uses the UDP protocol most often, various spoofing attacks are possible.  For example, you can generate a bunch of requests with a call to the victim subscriber.  This leads to a denial of service for the victim‚Äôs PBX, paralyzing the entire telephony system. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/9c7/36c/00f/9c736c00fc3587e1ae8459b394b0c500.png" alt="image"><br><br><h4>  Conclusion </h4><br>  Unfortunately, despite the fact that there are long-standing methods of protection against most of the listed threats, all market participants - both operators (which is the saddest thing!) And their clients - actively ignore security measures.  Therefore, watch your back - the provider will not think for you! <br><br>  <b>Author</b> : Ilya Safronov. </div><p>Source: <a href="https://habr.com/ru/post/212839/">https://habr.com/ru/post/212839/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../212825/index.html">Anti-rootkit for Userland-RootKit Azazel "on the knee"</a></li>
<li><a href="../212831/index.html"># 3dprintexpo: Russia's first exhibition of three-dimensional printing</a></li>
<li><a href="../212833/index.html">Lshell instead of chroot ssh</a></li>
<li><a href="../212835/index.html">Tame ZoG (Part 3: Football of the Kumsk Valley)</a></li>
<li><a href="../212837/index.html">The basics of creating a 2D character in Godot. Part 2: compiling templates, a little about GDScript, movement and animation of the hero</a></li>
<li><a href="../212841/index.html">Portal migration from SharePoint 2010 to SharePoint 2013. What has changed and how to live with it</a></li>
<li><a href="../212843/index.html">Monthly digest of interesting IT-projects on Kickstarter ‚Ññ1</a></li>
<li><a href="../212847/index.html">Denormalization of trees</a></li>
<li><a href="../212849/index.html">Rare PDA Casio Cassiopeia A-11A</a></li>
<li><a href="../212851/index.html">We look at closed profiles in LinkedIn</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>