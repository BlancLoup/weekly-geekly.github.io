<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Duplex asynchronous data exchange for the web, mobile and desktop in one implementation</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="To send data from the server to the client, it does not matter whether it is the web, mobile or desktop, there are enough technicians. But the problem...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Duplex asynchronous data exchange for the web, mobile and desktop in one implementation</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/1f6/6f7/769/1f66f7769b67fed9182253da92c53579.png" align="left">  To send data from the server to the client, it does not matter whether it is the web, mobile or desktop, there are enough technicians.  But the problem is that they are all different and if you need to implement an alert about the same event for clients on all major platforms, you will have to duplicate this same alert code.  That's why I want to share with the community my practice of working with a single product called <a href="http://www.lightstreamer.com/">LightStreamer</a> . <br><a name="habracut"></a><br>  I will say right away - this is not advertising and I have no relation to the developers and will not receive any remuneration for my work (except moral, for sharing my experience). <br><br>  So, LightStreamer is a server running on Java and as a result it can be run on both Windows and Linux machines + if development is done on Amazon, then you can use the ready Amazon Machine Image with LightStreamer on board <a href="http://download.lightstreamer.com/">download.lightstreamer.com</a> . <br>  The installation package (actually the archived folder) already contains a demo license, the limitations of which are reduced to only 20 simultaneously connected clients, which, you see, is quite enough for development, but if not, you can order an evaluation without limitations for 60 days.  Here is a <a href="http://www.lightstreamer.com/licenseTypes.htm">list of available licenses</a> . <br><br>  Installation instructions are set out in /Lightstreamer/GETTING_STARTED.TXT which is located inside the archive.  Everything is very simple (I will describe for Windows): <br>  - unpack, preferably to the root of the disk because the archive contains fairly long file paths; <br>  - we specify TCP ports on which the server will hang in /Lightstreamer/conf/lightstreamer_conf.xml, by default 8080 and 8888; <br>  - in /Lightstreamer/bin/windows/LS.bat in the JAVA_HOME variable we specify where the JDK is installed (if not installed, install); <br>  - and start the server / Lightstreamer/bin/windows/Start_LS_as_Application.bat. <br>  For the test, open <a href="http://localhost:8080/">http: // localhost: 8080</a> (we specify the same port that was specified in /Lightstreamer/conf/lightstreamer_conf.xml) and should see the welcome page with links to preinstalled demos. <br>  It is also possible instead of HTTP to use HTTPS and <a href="http://www.lightstreamer.com/latest/Lightstreamer_Allegro-Presto-Vivace_5_1_Colosseo/Lightstreamer/DOCS-SDKs/Clustering.pdf">clustering with a load balancer.</a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Well, the server is installed, but there‚Äôs little use - you need to teach it to handle our requests and give answers.  For this, there is an adapter mechanism (something like plug-ins).  That is, we need to write an adapter that will process requests from our clients and let the server know that such an adapter exists to send requests to it. <br><br><h5>  Writing adapter </h5><br>  The / Lightstreamer / DOCS-SDKs / folder contains the SDK.  To write an adapter in .NET, you need to implement the Lightstreamer.Interfaces.Data.IDataProvider interface from /Lightstreamer/DOCS-SDKs/sdk_adapter_dotnet/lib/DotNetAdapter_N2.dll <br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Threading; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Lightstreamer.Interfaces.Data; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">HelloWorldAdapter</span></span> : <span class="hljs-title"><span class="hljs-title">IDataProvider</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> IItemEventListener _listener; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">volatile</span></span> <span class="hljs-keyword"><span class="hljs-keyword">bool</span></span> go; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Init</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IDictionary parameters, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> configFile</span></span></span><span class="hljs-function">)</span></span> { } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">bool</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">IsSnapshotAvailable</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> itemName</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SetListener</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">IItemEventListener eventListener</span></span></span><span class="hljs-function">)</span></span> { _listener = eventListener; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Subscribe</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> itemName</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (itemName.Equals(<span class="hljs-string"><span class="hljs-string">"greetings"</span></span>)) { <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Thread(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ThreadStart(Run)).Start(); } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Unsubscribe</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> itemName</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (itemName.Equals(<span class="hljs-string"><span class="hljs-string">"greetings"</span></span>)) { go = <span class="hljs-literal"><span class="hljs-literal">false</span></span>; } } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Run</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { go = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> c = <span class="hljs-number"><span class="hljs-number">0</span></span>; Random rand = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Random(); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (go) { IDictionary eventData = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Hashtable(); eventData[<span class="hljs-string"><span class="hljs-string">"message"</span></span>] = c % <span class="hljs-number"><span class="hljs-number">2</span></span> == <span class="hljs-number"><span class="hljs-number">0</span></span> ? <span class="hljs-string"><span class="hljs-string">"Hello"</span></span> : <span class="hljs-string"><span class="hljs-string">"World"</span></span>; eventData[<span class="hljs-string"><span class="hljs-string">"timestamp"</span></span>] = DateTime.Now.ToString(<span class="hljs-string"><span class="hljs-string">"s"</span></span>); _listener.Update(<span class="hljs-string"><span class="hljs-string">"greetings"</span></span>, eventData, <span class="hljs-literal"><span class="hljs-literal">false</span></span>); c++; Thread.Sleep(<span class="hljs-number"><span class="hljs-number">1000</span></span> + rand.Next(<span class="hljs-number"><span class="hljs-number">2000</span></span>)); } } }</code> </pre> <br><h5>  Running adapter </h5><br>  To start we need a console aplikuha <br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Net.Sockets; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> Lightstreamer.DotNet.Server; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">DataAdapterLauncher</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] args</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> host = <span class="hljs-string"><span class="hljs-string">"localhost"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> reqrepPort = <span class="hljs-number"><span class="hljs-number">6661</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> notifPort = <span class="hljs-number"><span class="hljs-number">6662</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { DataProviderServer server = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DataProviderServer(); server.Adapter = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HelloWorldAdapter(); TcpClient reqrepSocket = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TcpClient(host, reqrepPort); server.RequestStream = reqrepSocket.GetStream(); server.ReplyStream = reqrepSocket.GetStream(); TcpClient notifSocket = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TcpClient(host, notifPort); server.NotifyStream = notifSocket.GetStream(); server.Start(); System.Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Remote Adapter connected to Lightstreamer Server."</span></span>); System.Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Ready to publish data..."</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception e) { System.Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Could not connect to Lightstreamer Server."</span></span>); System.Console.WriteLine(<span class="hljs-string"><span class="hljs-string">"Make sure Lightstreamer Server is started before this Adapter."</span></span>); System.Console.WriteLine(e); } } }</code> </pre><br><h5>  Filling adapter to server </h5><br>  In the folder / Lightstreamer / adapters / create a new folder and copy into it / Lightstreamer/DOCS-SDKs/sdk_adapter_remoting_infrastructure/lib/ls-proxy-adters.jar.  In the same place, we create a new /lib/adapters.xml file with content. <br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">adapters_conf</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"HelloWorld"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">metadata_provider</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">adapter_class</span></span></span><span class="hljs-tag">&gt;</span></span>com.lightstreamer.adapters.metadata.LiteralBasedProvider<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">adapter_class</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">metadata_provider</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">data_provider</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">adapter_class</span></span></span><span class="hljs-tag">&gt;</span></span>com.lightstreamer.adapters.remote.data.RobustNetworkedDataProvider<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">adapter_class</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">classloader</span></span></span><span class="hljs-tag">&gt;</span></span>log-enabled<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">classloader</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"request_reply_port"</span></span></span><span class="hljs-tag">&gt;</span></span> 6661<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">param</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"notify_port"</span></span></span><span class="hljs-tag">&gt;</span></span> 6662<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">param</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">data_provider</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">adapters_conf</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  The name can beat anyone - it will be indicated when writing the client and that's it.  As you can see the ports are the same as when starting the adapter. <br><br><h5>  Client writing </h5><br>  For example, give the simplest JavaScript client <br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://cdnjs.cloudflare.com/ajax/libs/require.js/1.0.7/require.min.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://code.jquery.com/jquery-2.1.0.min.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"C:/Lightstreamer/DOCS-SDKs/sdk_client_javascript/lib/lightstreamer.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="javascript"><span class="javascript"> </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">require</span></span></span><span class="javascript">([</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"LightstreamerClient"</span></span></span><span class="javascript">,</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"Subscription"</span></span></span><span class="javascript">,</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"StaticGrid"</span></span></span><span class="javascript">],</span><span class="hljs-function"><span class="hljs-keyword"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="javascript"><span class="hljs-function">(</span></span><span class="hljs-params"><span class="javascript"><span class="hljs-function"><span class="hljs-params">LightstreamerClient,Subscription,StaticGrid</span></span></span></span><span class="javascript"><span class="hljs-function">) </span></span></span><span class="javascript">{ </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">var</span></span></span><span class="javascript"> lsClient = </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">new</span></span></span><span class="javascript"> LightstreamerClient(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"http://localhost:8080"</span></span></span><span class="javascript">, </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"HelloWorld"</span></span></span><span class="javascript">); lsClient.connect(); </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">var</span></span></span><span class="javascript"> lsSubscription = </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">new</span></span></span><span class="javascript"> Subscription(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"MERGE"</span></span></span><span class="javascript">,[</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'greetings'</span></span></span><span class="javascript">],[</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'greetings'</span></span></span><span class="javascript">, </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'message'</span></span></span><span class="javascript">, </span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'timestamp'</span></span></span><span class="javascript">]); lsSubscription.addListener({ </span><span class="hljs-attr"><span class="javascript"><span class="hljs-attr">onItemUpdate</span></span></span><span class="javascript">: </span><span class="hljs-function"><span class="hljs-keyword"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="javascript"><span class="hljs-function">(</span></span><span class="hljs-params"><span class="javascript"><span class="hljs-function"><span class="hljs-params">updateObject</span></span></span></span><span class="javascript"><span class="hljs-function">) </span></span></span><span class="javascript">{ $(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"#message"</span></span></span><span class="javascript">).text(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'Message='</span></span></span><span class="javascript"> + updateObject.getValue(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"message"</span></span></span><span class="javascript">)); $(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"#timestamp"</span></span></span><span class="javascript">).text(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'TimeStamp='</span></span></span><span class="javascript"> + updateObject.getValue(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"timestamp"</span></span></span><span class="javascript">)); } }); lsClient.subscribe(lsSubscription); }); </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"message"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">br</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"timestamp"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><h5>  Result </h5><br>  And as a result we received automatically updated data on the client: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/04e/3bd/9e7/04e3bd9e77449a20c0734492101cdff9.gif" alt="image"><br>  In order for a client to receive unique data that relates to him, for example messages in a chat, instead of just 'greetings' (the second parameter), you need to transfer the user‚Äôs ID and on the adapter side to retrieve his messages on this side. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Subscription(<span class="hljs-string"><span class="hljs-string">"MERGE"</span></span>,[<span class="hljs-string"><span class="hljs-string">'userID123'</span></span>],[<span class="hljs-string"><span class="hljs-string">'greetings'</span></span>, <span class="hljs-string"><span class="hljs-string">'message'</span></span>, <span class="hljs-string"><span class="hljs-string">'timestamp'</span></span>])</code> </pre><br>  You can also transfer not only one parameter, but several parameters, separated by a comma, a colon, and so on.  and accordingly, on the adapter side, all this is parsing. <br>  In the process of development, I encountered the inconvenience of debug on a server on which there is no studio and found out that instead of localhost in the DataAdapterLauncher class, you can transfer the address of the machine where the server is and thus it is possible without having a local server to debug. <br><br><h5>  At last </h5><br>  Judging by the <a href="http://www.lightstreamer.com/doc">www.lightstreamer.com/doc</a> adapter, you can write to: <br><ul><li>  Java </li><li>  .NET </li><li>  Node js </li></ul><br>  A list of platforms for customers more: <br><ul><li>  avaScript </li><li>  Android </li><li>  iOS </li><li>  Windows phone </li><li>  Winrt </li><li>  Blackberry </li><li>  Java ME </li><li>  Flash </li><li>  Flex </li><li>  Silverlight </li><li>  .NET </li><li>  Java SE </li><li>  OS X </li></ul><br>  PS <br>  Adapter pages for example on <a href="https://github.com/Weswit/Lightstreamer-example-HelloWorld-adapter-dotnet">github</a> 'e. </div><p>Source: <a href="https://habr.com/ru/post/220343/">https://habr.com/ru/post/220343/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../220333/index.html">Report on the passage of the first round of the Russian Code Cup</a></li>
<li><a href="../220335/index.html">Want to manage the product? What are all product managers silent</a></li>
<li><a href="../220337/index.html">Automation testing UI. From Coded UI to Cruciatus</a></li>
<li><a href="../220339/index.html">Ibm and red hat</a></li>
<li><a href="../220341/index.html">Deploy Ratpack app on Heroku</a></li>
<li><a href="../220351/index.html">Blogs are small media.</a></li>
<li><a href="../220353/index.html">iOS / PSW.SSLCredsThief.A for iOS c jailbreak</a></li>
<li><a href="../220355/index.html">A new biotechnology department has been created at DARPA</a></li>
<li><a href="../220357/index.html">Docsvision start - and continue</a></li>
<li><a href="../220359/index.html">The architecture of the online game server on the example of Skyforge</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>