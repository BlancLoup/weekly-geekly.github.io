<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Google suggests strengthening JSON with Jsonnet</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Google has opened the source code for its Jsonnet project, a configuration language that replaces standard JSON and adds new features without backward...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Google suggests strengthening JSON with Jsonnet</h1><div class="post__text post__text-html js-mediator-article">  Google has opened the <a href="https://github.com/google/jsonnet">source code for</a> its <a href="http://google.github.io/jsonnet/doc/">Jsonnet</a> project, a configuration language that replaces standard JSON and adds new features without backward compatibility.  Among such opportunities: comments, links, arithmetic and conditional operators, arrays and work with objects, import, functions, local variables.  Jsonnet programs are translated into a JSON-compatible data format. <br><br>  <strong>Comments</strong>  Jsonnet accepts C (/ * ... * /) and C ++ (//) comments <br><br>  <strong>References</strong>  The <b>self</b> keyword can be used to reference the current object.  The <b>$</b> operator allows you to use the root object. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <strong>Arithmetic and conditional operators</strong> .  The <b>+</b> operator can add numbers, strings, arrays, and objects.  Operators <b>==</b> and <b>! =</b> Return true or false.  The <b>if</b> operator works like a ternary operator?: In C. Further, a few examples with language operators and the result.  Examples are taken <a href="https://github.com/google/jsonnet/tree/master/examples">from the project page</a> . <br><pre>  // bar_menu.3.jsonnet
 {
     foo: 3,     
     bar: 2 * self.foo, // Multiplication.
     baz: "The value" + self.bar + "is"
          + (if self.bar&gt; 5 then "large" else "small") + ".",
     array: [1, 2, 3] + [4],
     obj: {a: 1, b: 2} + {b: 3, c: 4},
     equality: 1 == "1",
 }
</pre><a name="habracut"></a><br>  Result: <br><pre>  {
    "foo": 3,
    "bar": 6,
    "baz": "The value 6 is large.",
    "array": [1, 2, 3, 4],
    "obj": {a: 1, b: 3, c: 4},
    "equality": false
 }
</pre><br>  <strong>Creating arrays and objects</strong> .  To create arrays and objects, use the construction with the for operator, as shown in the example below: <br><pre>  {
     foo: [1, 2, 3],
     bar: [x * x for x in self.foo if x&gt; = 2],
     baz: {["field" + x]: x for x in self.foo},
     obj: {["foo" + "bar"]: 3},
 }
</pre><br><br>  Result: <br><pre>  {
    "foo": [1, 2, 3],
    "bar": [4, 9],
    "baz": {
       "field1": 1,
       "field2": 2,
       "field3": 3
    },
    "obj": {"foobar": 3}
 }
</pre><br>  <strong>Modularity</strong>  Code written in Jsonnet can be split into several files and then merged using the import statement.  Internal mechanics is simple gluing files. <br><br>  <strong>Functions</strong> .  Jsonnet values ‚Äã‚Äãmay contain functions.  They are marked as hidden fields and are not translated into JSON.  An example of such a function is presented below: <br><pre>  // bar_menu_utils.jsonnet
 {
     equal_parts (size, ingredients) ::
         if std.length (ingredients) == 0 then
             error "No ingredients specified."
         else [
             {kind: i, qty: size / std.length (ingredients)}
             for i in ingredients
         ],
     id :: function (x) x,
 }
</pre><br>  Jsonnet also includes local variables, a method for inheriting objects by importing, calculated and optional fields. <br><br>  The language engine is written in C ++ 11 with the provision of a C-style API wrapper for easier porting to other languages.  The development team can immediately provide libraries for C and Python.  The implementation for C ++ can be compiled in JS with Emscripten.  An <a href="https://github.com/yosuke-furukawa/node-jsonnet">unofficial package</a> for nodejs is still available. <br><br>  Full specifications can be found on the <a href="http://google.github.io/jsonnet/doc/spec.html">specification</a> page. <br><br><h1>  Some comparison with other languages. </h1><br>  <strong>Json</strong>  Actually, JSON describes all the data literally.  Jsonnet has more free syntax and comments to make it easier for people to read data. <br><br>  <strong>Yaml</strong>  It is also some JSON extension that allows you to generate the correct JSON.  The syntax of the language is very compact and the files in YAML are much shorter than they are later in JSON format.  Despite the fact that the language was created for the same purposes as Jsonnet, Jsonnet loses the creation, transmission and refinement of data.  In particular, YAML and Jsonnet have different points of view on what should mean "1 + 1".  YAML says that this is the string ‚Äú1 + 1‚Äù, whereas Jsonnet believes that the result should be 2. <br><br>  <strong>Other languages ‚Äã‚Äãwith patterns.</strong>  Jsonnet is a template language that generates data from algorithms with interleaving of literal data with computational structures.  Most of these languages ‚Äã‚Äãconsider programs and the result as plain text.  This means that the output can get an incorrect result, if we are talking about JSON.  Most of these template languages ‚Äã‚Äãdo not have knowledge of the syntax of the output and cannot verify the result for correctness.  Jsonnet lacks such a flaw, as it is a highly specialized tool. <br><br>  <a href="http://google.github.io/jsonnet/doc/comparisons.html">Comparison</a> with other tools and languages ‚Äã‚Äãsuch as Haskel, Nix, Coil, Pystachio and others can be found in detail in the Jsonnet manual. <br><br><h1>  Questions and answers </h1><br>  In the original topic appeared interesting questions and answers from the lead developer of the project David Cunningham (David Cunningham). <br><br>  <strong>Q</strong> : <em>Why not take advantage of the already existing open standard</em> <em><a href="https://github.com/edn-format/edn">EDN</a></em> <em>?</em>  <em>In my opinion, it has all the same features and there are already ports for different languages.</em> <br><br>  <strong>Answer</strong> : Good question, but EDN is not very similar to Jsonnet.  EDN is ‚Äúdata only‚Äù, it knows nothing about calculations or abstractions.  It is expandable, and you can add the missing constructs, but then you will receive in fact a new language that will not be understood by other systems. <br><br>  When we created Jsonnet, we thought that we needed to follow common standards.  We chose JSON because of its popularity, but we also tried to follow existing programming models (mainly js and python) as closely as possible. <br><br>  I also want to note that Jsonnet can be integrated into systems that work with EDN, because it is possible to generate EDN using our system.  You only need to write a special function "manifest".  This work has been done for INI files, Lua and Python configuration files. <br><br>  Finally, Jsonnet is available for 3 languages ‚Äã‚Äã(C, Python, Javascript) and for any language that can work with the C interface.  Ports to other languages ‚Äã‚Äãare scheduled, possibly via porting to Haxe. <br><br>  <strong><em>Question</em></strong>  <em>I really like the project, but the developers had to use standard JavaScript</em> <em>functions, and not reinvent from in stdlib</em> <em>.</em>  <em>The basic functions are missing and adding new ones is not an easy task, so this is a kind of limiter and I, unfortunately, returned to the old JSON preprocessor.</em> <br><br>  <strong>The answer is</strong> .  Stdlib is definitely the weakest part of the project and what needs to be rewritten is improved and documented before we release version 1.0.  We are looking forward to your feedback, especially with real-life examples. <br><br>  In general, it is possible to extend stdlib yourself and write your own library for Jsonnet.  The example below first uses a small trick to add the add2 method to stdlib: <br><pre>  local std2 = std {// Temporarily define std2 to avoid self-reference.
    add2 (x) :: x + 2,
 };
 local std = std2;  // Bind std2 over std.

 // Rest of Jsonnet file below:
 {
    foo: std.add2 (10), // Expands to 12.
 }
</pre><br>  In general, it may not be possible to copy functions from supported languages, since the semantics may not make sense in Jsonnet.  However, we understand that to have unreasonable differences will not help anyone.  And this is the main reason why the stdlib functions responsible for formatting text exactly match the% operator in Python. <br><hr><br>  Based on materials: <br><ul><li>  <a href="http://www.infoq.com/news/2015/04/jsonnet">http://www.infoq.com/news/2015/04/jsonnet</a> - the topic is fresh and the owner of the library is in touch, so you can ask around directly in the topic. </li><li>  <a href="http://google.github.io/jsonnet/doc/">http://google.github.io/jsonnet/doc/</a> </li></ul><br><br>  And again we want to draw your attention to the upcoming <b>API &amp; Backend</b> (C #) conference.  If you have something to tell about the details of the implementation and management of the API, the service on the backend.  If you have interesting cases related to the generation of complex messages: headers and content - <b><a href="http://goo.gl/forms/EW8h028Ssc">we are waiting for your stories</a></b> ! </div><p>Source: <a href="https://habr.com/ru/post/256363/">https://habr.com/ru/post/256363/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../256353/index.html">Using the driver keys of the lower and upper levels of the IR2110 - an explanation and examples of schemes</a></li>
<li><a href="../256355/index.html">godebug - cross-platform debugger for Go</a></li>
<li><a href="../256357/index.html">IT resources under control</a></li>
<li><a href="../256359/index.html">The correct bonus for your new server</a></li>
<li><a href="../256361/index.html">New spam: How scammers use interactive robots from the cloud</a></li>
<li><a href="../256365/index.html">We implement secure VPN protocol</a></li>
<li><a href="../256367/index.html">PKCS7 file structure</a></li>
<li><a href="../256373/index.html">CCTV on OS X</a></li>
<li><a href="../256377/index.html">Hacken und minen</a></li>
<li><a href="../256379/index.html">First sales experience at Unity Asset Store</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>