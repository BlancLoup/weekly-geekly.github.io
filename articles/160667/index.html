<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Managing Parallels Automation for Cloud Infrastructure with API</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Last time we talked about Cloud servers based on Parallels Automation for Cloud Infrastructure (PACI) - estimated prices and functionality. Including,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Managing Parallels Automation for Cloud Infrastructure with API</h1><div class="post__text post__text-html js-mediator-article">  <a href="http://habrahabr.ru/company/infobox/blog/159801/">Last time</a> we talked about Cloud servers based on Parallels Automation for Cloud Infrastructure (PACI) - estimated prices and functionality.  Including, briefly mentioned the presence of an API for managing servers.  Today we will take a closer look at actions available through the API and examples of basic commands. <br><br>  Unfortunately, the previous post was not very highly rated, but we received interesting questions, a lot of feedback, and a few bug reports from habrayers who joined the <a href="http://infobox.ru/habr-cloud-test/">testing</a> .  We will try to cover the topics raised by you in this and the following posts. <br><br>  As we have already said, the basis of our cloud is Parallels Automation for Cloud Infrastructure, a module of the Parallels Automation billing and provisioning system.  The product comes with an excellent RESTful API.  We will not cite the entire listing with API teams - it can be viewed <a href="http://download.pa.parallels.com/poa/5.4/doc/pdf/POA%2520RESTful%2520API%2520Guide/paci-restful-api-guide-5.4.pdf">in the official documentation</a> .  Better show some examples of this way of managing virtual machines and containers. <br><br clear="all"><br clear="all"><img src="https://habrastorage.org/storage2/e44/0f8/721/e440f8721a57a54ef7f2bd22b169115b.jpg">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br><br><h2>  Syntax and punctuation </h2><br>  Working with cloud resources is done by sending API requests to the PACI management server.  Answers come in XML format, the code is as readable and user-oriented as possible, rather than processed by a soulless parser, so all fields have intelligible names.  In addition, you can easily automate the management, and the XML itself can be parsed without any problems, if you suddenly need it. <br><br>  You need to contact the API at the address of the PACI managing server (we will reduce it to baseURL in the future): <br><br><pre><code class="php hljs">https:<span class="hljs-comment"><span class="hljs-comment">//{ip_address | hostname}:port/paci/version</span></span></code> </pre> <br>  If everything is more or less clear with the ip_address of the hostname and port, then the remaining two fields should focus.  / paci / should always look like / paci /, and nothing else.  And the version is specified in the v1.0 format (the numbers, respectively, may change in future versions of PACI). <br><br>  Thus, the finished baseURL will look like this: <br><br><pre> <code class="html hljs xml">https://109.120.*.*:4465/paci/v1.0</code> </pre><br>  Further communication with the virtual server is carried out using the baseURL extension ‚Äúto the right‚Äù - we simply set / and add additional parameters to the baseURL.  / ve - access to the virtual server, and since the server usually has its own identifier, after / ve the server name / my-server-01 is appended. <br><br>  The baseURL string with two additional parameters takes the form: <br><br><pre> <code class="html hljs xml">https://109.120.*.*:4465/paci/v1.0/ve/my-server-01</code> </pre><br>  Which is equivalent to the line: <br><br><pre> <code class="html hljs xml">baseURL/ve/my-server-01</code> </pre><br>  Some queries allow the definition of additional parameters.  Often the parameters are optional, but very useful.  All additional parameters are listed after the question mark. <br><br>  An example of such a request is the following line: <br><br><pre> <code class="html hljs xml">GET baseURL/ve?subscription=1000001</code> </pre><br>  With the syntax, we more or less figured out, now move on to the possibilities. <br><br><br clear="all"><h2>  What actions are available through the API? </h2><br>  The possibilities are quite wide.  Innocent features are available: <br><ul><li>  listing and monitoring existing virtualok </li><li>  creating new and managing already created servers </li><li>  image deployment </li><li>  cloning existing systems </li><li>  setting available resources to the server </li></ul><br>  And more serious things: <br><ul><li>  creating new images </li><li>  management of already created server images </li><li>  creating, configuring, and, of course, removing the load balancer </li><li>  connecting and disconnecting servers from the balancer </li></ul><br><br><h3>  Server management </h3><br>  As you already know, you can view the list of servers with the command <br><br><pre> <code class="html hljs xml">GET baseURL/ve/</code> </pre><br>  In response, a simple XML will come: <br><br><pre> <code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ve-list</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ve-info</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">subscription-id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1000001"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Habr1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">state</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"CREATED"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">description</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Habr Example 1"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ve-info</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">subscription-id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1000002"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Habr2"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">state</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"CREATED"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">description</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Habr Example 2"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ve-list</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  The description of the fields is in the documentation, but their names, in principle, speak for themselves. <br><br>  You can stop or start a ready server by a simple request: <br><br><pre> <code class="html hljs xml">PUT baseURL/ve/{ve-name}/start|stop</code> </pre><br>  Instead of {ve-name} we insert the server name (the name field from the answer above), and after it we add a command to start or stop the server.  Again, it‚Äôs easier than simple and there‚Äôs nothing to stop here. <br><br>  Slightly more difficult is the creation of a new server from the console.  This command has a lot of additional parameters, and restrictions on the use of certain resources will have to be remembered or peeped in the cheat sheet, since this is not a GUI with sliders.  If the allowed parameters are exceeded, you will get error 406: ‚ÄúSubscription limit for VE number exceeded". <br><br>  The team itself looks like this: <br><br><pre> <code class="html hljs xml">POST baseURL/ve/</code> </pre><br>  But then all the magic begins.  In addition to the request itself, it is also necessary to generate an XML body in which all the parameters of the required server will be written: <br><br><pre> <code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ve</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span>HabrExample1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span>VE Linux 40<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">subscription-id</span></span></span><span class="hljs-tag">&gt;</span></span>1000001<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">subscription-id</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">cpu</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">number</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">power</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1500"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ram-size</span></span></span><span class="hljs-tag">&gt;</span></span>256<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ram-size</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bandwidth</span></span></span><span class="hljs-tag">&gt;</span></span>100<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">bandwidth</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">no-of-public-ip</span></span></span><span class="hljs-tag">&gt;</span></span>1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">no-of-public-ip</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">no-of-public-ipv6</span></span></span><span class="hljs-tag">&gt;</span></span>0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">no-of-public-ipv6</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ve-disk</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">local</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">size</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"20"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">platform</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">template-info</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"centos-6-x86_64"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">os-info</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">technology</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"CT"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"linux-free"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">platform</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">backup-schedule</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"daily"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">admin</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">login</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"root"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">password</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"152eyyBHO"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ve</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  If everything is correct, the answer will come about the successful creation of a new virtual machine: <br><br><pre> <code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pwd-response</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">message</span></span></span><span class="hljs-tag">&gt;</span></span>VE create initiated<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">message</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">password</span></span></span><span class="hljs-tag">&gt;</span></span>152eyyBHO<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">password</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pwd-response</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br><img src="https://habrastorage.org/storage2/00f/249/81b/00f24981b8610dd15cf086a0b7859679.jpg"><br><br><h3>  Image Management </h3><br>  The functionality embodied in this group of commands allows you to save great time and resources when deploying and scaling new systems. <br><br>  The following examples imply that the images have already been prepared, and you have read their list with the team. <br><br><pre> <code class="html hljs xml">GET baseURL/image</code> </pre><br>  Suppose the server answered us that there is such an image: <br><br><pre> <code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">image-list</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">image-info</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">image-of</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"HabrExample3"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">active</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">load-balancer</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">subscriptionid</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"100001"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">created</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2012-11-11 19:19:19.84091+04"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">size</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"3"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"lbimage"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">image-list</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Want to deploy another server out of it?  Nothing is easier!  Standard request: <br><br><pre> <code class="html hljs xml">POST baseURL/ve/{subscription-id}/{ve-name}/from/{image-name}</code> </pre><br>  in our case turns into <br><br><pre> <code class="html hljs xml">POST baseURL/ve/1000003/Habr3/from/HabrExample3</code> </pre><br>  On this, in fact, work with creating a server from an image ends, but no one bothers to create a new server simply by cloning an existing one: <br><br><pre> <code class="html hljs xml">POST baseURL/ve/{ve-name}/clone-to/{new-server-name}</code> </pre><br><br><h3>  Balancer Management </h3><br>  The list of available balancers is ‚Äúordered‚Äù in the same way as many other lists of available services, services and opportunities: <br><br><pre> <code class="html hljs xml">GET baseURL/load-balancer</code> </pre><br>  In response, a short XML comes with information about the load balances created: <br><br><pre> <code class="html hljs xml"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">lb-list</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">load-balancer</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">state</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"STARTED"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">subscription-id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"LB1"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">load-balancer</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">state</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"STARTED"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">subscription-id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"LB2"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">lb-list</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  It is easy to connect any existing server to the balancer already operating: <br><br><pre> <code class="html hljs xml">POST baseURL/load-balancer/{lb-name}/{ve-name}</code> </pre><br>  Yes, and disconnect no more difficult: <br><br><pre> <code class="html hljs xml">DELETE baseURL/load-balancer/{lb-name}/{ve-name}</code> </pre><br><br><h3>  Utilities </h3><br>  So far, only functions have fallen into this part of the API.  One of them is the list of available for use ‚Äúpre-installed‚Äù server OS: <br><br><pre> <code class="html hljs xml">GET baseURL/template/{name}</code> </pre><br>  List of presets for automatic backup: <br><br><pre> <code class="html hljs xml">GET baseURL/schedule</code> </pre><br><br><h2>  PHP code examples </h2><br><br>  GET request for a server list: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $mainStr = <span class="hljs-string"><span class="hljs-string">"http://109.120.166.3:4465/paci/v1.0/"</span></span>; $queryStr = <span class="hljs-string"><span class="hljs-string">'ve'</span></span>; $url = $mainStr.$queryStr; $process = curl_init(); curl_setopt($process, CURLOPT_URL, $url); curl_setopt($process, CURLOPT_HEADER, <span class="hljs-number"><span class="hljs-number">1</span></span>); curl_setopt($process, CURLOPT_USERPWD, <span class="hljs-string"><span class="hljs-string">'&lt;login&gt;:&lt;password&gt;'</span></span>); curl_setopt($process, CURLOPT_RETURNTRANSFER, <span class="hljs-keyword"><span class="hljs-keyword">TRUE</span></span>); $head = curl_exec($process); curl_close($process); <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre><br>  XML response: <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ve-list</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ve-info</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">subscription-id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1000001"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"web1"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">state</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"CREATED"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">description</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Web server 1"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ve-info</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">subscription-id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1000002"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"web2"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">state</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"CREATED"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">description</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Web server 2"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ve-list</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  PUT request to start / stop the server: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $mainStr = <span class="hljs-string"><span class="hljs-string">"http://109.120.166.3:4465/paci/v1.0/"</span></span>; $queryStr = <span class="hljs-string"><span class="hljs-string">'ve/&lt;ve-name&gt;/&lt;start | stop&gt;'</span></span>; $url = $mainStr.$queryStr; $process = curl_init(); curl_setopt($process, CURLOPT_URL, $url); curl_setopt($process, CURLOPT_HTTPHEADER, <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'Content-Type: application/xml'</span></span>)); curl_setopt($process, CURLOPT_PUT, <span class="hljs-number"><span class="hljs-number">1</span></span>); curl_setopt($process, CURLOPT_HEADER, <span class="hljs-number"><span class="hljs-number">1</span></span>); curl_setopt($process, CURLOPT_USERPWD, <span class="hljs-string"><span class="hljs-string">'&lt;login&gt;:&lt;password&gt;'</span></span>); curl_setopt($process, CURLOPT_RETURNTRANSFER, <span class="hljs-keyword"><span class="hljs-keyword">TRUE</span></span>); $head = curl_exec($process); curl_close($process); <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre><br><br>  XML response: <br><pre> <code class="xml hljs"> * VE START initiated</code> </pre><br><br>  POST request for server creation: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $mainStr = <span class="hljs-string"><span class="hljs-string">"http://109.120.166.3:4465/paci/v1.0/"</span></span>; $queryStr = <span class="hljs-string"><span class="hljs-string">'ve'</span></span>; $serverInfo = <span class="hljs-string"><span class="hljs-string">'&lt;?xml version="1.0" encoding="UTF-8"?&gt; &lt;ve&gt; &lt;name&gt;Web40&lt;/name&gt; &lt;description&gt;VE Linux 40&lt;/description&gt; &lt;subscription-id&gt;1000001&lt;/subscription-id&gt; &lt;cpu number="2" power="1600"/&gt; &lt;ram-size&gt;512&lt;/ram-size&gt; &lt;bandwidth&gt;100&lt;/bandwidth&gt; &lt;no-of-public-ip&gt;2&lt;/no-of-public-ip&gt; &lt;no-of-public-ipv6&gt;2&lt;/no-of-public-ipv6&gt; &lt;ve-disk local="true" size="3"/&gt; &lt;platform&gt; &lt;template-info name="centos-6-x86_64"/&gt; &lt;os-info technology="CT" type="linux-free"/&gt; &lt;/platform&gt; &lt;backup-schedule name="daily"/&gt; &lt;admin login="root" password="qwwqq45"/&gt; &lt;/ve&gt; '</span></span>; $url = $mainStr.$queryStr; $process = curl_init(); curl_setopt($process, CURLOPT_URL, $url); curl_setopt($process, CURLOPT_HTTPHEADER, <span class="hljs-keyword"><span class="hljs-keyword">array</span></span>(<span class="hljs-string"><span class="hljs-string">'Content-Type: application/xml'</span></span>)); curl_setopt($process, CURLOPT_POST, <span class="hljs-number"><span class="hljs-number">1</span></span>); curl_setopt($process, CURLOPT_HEADER, <span class="hljs-number"><span class="hljs-number">1</span></span>); curl_setopt($process, CURLOPT_USERPWD, <span class="hljs-string"><span class="hljs-string">'&lt;login&gt;:&lt;password&gt;'</span></span>); curl_setopt($process, CURLOPT_RETURNTRANSFER, <span class="hljs-keyword"><span class="hljs-keyword">TRUE</span></span>); curl_setopt($process, CURLOPT_POSTFIELDS, $serverInfo); $head = curl_exec($process); curl_close($process); <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre><br>  XML response: <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pwd-response</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">message</span></span></span><span class="hljs-tag">&gt;</span></span>VE create initiated<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">message</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">password</span></span></span><span class="hljs-tag">&gt;</span></span>152eyyBHO<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">password</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">pwd-response</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  DELETE request to delete the server <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $mainStr = <span class="hljs-string"><span class="hljs-string">"http://109.120.166.3:4465/paci/v1.0/"</span></span>; $queryStr = <span class="hljs-string"><span class="hljs-string">'ve/&lt;ve-name&gt;'</span></span>; $url = $mainStr.$queryStr; $process = curl_init(); curl_setopt($process, CURLOPT_URL, $url); curl_setopt($process, CURLOPT_CUSTOMREQUEST, <span class="hljs-string"><span class="hljs-string">"DELETE"</span></span>); curl_setopt($process, CURLOPT_HEADER, <span class="hljs-number"><span class="hljs-number">1</span></span>); curl_setopt($process, CURLOPT_USERPWD, <span class="hljs-string"><span class="hljs-string">'&lt;login&gt;:&lt;password&gt;'</span></span>); curl_setopt($process, CURLOPT_RETURNTRANSFER, <span class="hljs-keyword"><span class="hljs-keyword">TRUE</span></span>); $head = curl_exec($process); curl_close($process); <span class="hljs-meta"><span class="hljs-meta">?&gt;</span></span></code> </pre><br>  XML response: <br><br><pre> <code class="xml hljs"> * VE DELETE initiated</code> </pre><br><br>  <b>Non-commercial testing of Cloud Servers will continue until February 1, 2013. The development of the service largely depends on your feedback.</b>  <b><a href="http://infobox.ru/habr-cloud-test">Join now</a> !</b> <br><br>  For authors of the best reviews of the service, we have <a href="http://blog.infobox.ru/2012/11/24/iipphone5-za-obzory-oblaka/">prepared prizes</a> . <br><br><br clear="all"><br clear="all"><h3>  Our previous posts on the topic </h3><br>  <a href="http://habrahabr.ru/company/infobox/blog/159801/">Cloud servers from Infobox</a> <br><br><h3>  Links to materials mentioned </h3><br>  <a href="http://download.pa.parallels.com/poa/5.4/doc/pdf/POA%2520RESTful%2520API%2520Guide/paci-restful-api-guide-5.4.pdf">Official Documentation on Using APIs in Parallels Automation for Cloud Infrastructure (PDF)</a> <br><br>  <a href="http://habrahabr.ru/company/infobox/blog/">Infobox blog</a> </div><p>Source: <a href="https://habr.com/ru/post/160667/">https://habr.com/ru/post/160667/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../160653/index.html">Amazon Redshift: New Petabyte Data Warehouse</a></li>
<li><a href="../160655/index.html">Installing Window7 (64Bit) on a GPT disk, on motherboards with EFI, without USB / DVD</a></li>
<li><a href="../160661/index.html">Is your website ready for Retina?</a></li>
<li><a href="../160663/index.html">Internet via fast router, Wake on Lan via slow</a></li>
<li><a href="../160665/index.html">Flurry: China will soon overtake the United States by the number of smartphones</a></li>
<li><a href="../160669/index.html">Desire HD: Which firmware is better?</a></li>
<li><a href="../160675/index.html">About the absence of hot swap drives in the BX924 S3</a></li>
<li><a href="../160677/index.html">SCSS and cross-platform gradient (well, almost)</a></li>
<li><a href="../160679/index.html">Pseudo web sockets</a></li>
<li><a href="../160681/index.html">Create an AD user through the web interface</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>