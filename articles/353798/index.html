<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Package Registry on Ethereum</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today, only the lazy one does not start another useless project on the blockchain; in this lesson I will tell you how to do something of practical use...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Package Registry on Ethereum</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/webt/rr/bi/vc/rrbivckyzipev2k-krcnejx3gqm.jpeg"></p><br><p>  Today, only the lazy one does not start another useless project on the blockchain; in this lesson I will tell you how to do something of practical use.  As an example, take a package registry like npm using only a digital signature, a decentralized Swarm repository and Ethereum-based smart contracts. </p><a name="habracut"></a><br><blockquote>  <strong>Warning</strong> This is an evaluation version of a contract requiring an audit. </blockquote><br><h2 id="motivaciya">  Motivation </h2><br><p>  The code registry on the blockchain has a number of advantages over the usual one: </p><br><ul><li>  digital signature confirmation. </li><li>  global access. </li><li>  tokenization </li></ul><br><p>  Consider each of the points separately: </p><br><h3 id="podtverzhdenie-cifrovoy-podpisyu">  Digital Signature Verification </h3><br><p>  This is an important point in building a trusted environment.  The code must be signed by a developer you trust.  In the case of the blockchain, this happens automatically.  Today, if desired, any large repository can be attacked, and the code in it is replaced, you can hardly find out about it.  The blockchain repository protects us from spoofing by storing a confirmed hash sum. </p><br><h3 id="globalnyy-dostup">  Global access </h3><br><p>  I think that everything here is clearly distributed storage enables global uncensored data access. </p><br><h3 id="tokenizaciya">  Tokenization </h3><br><p>  The package can be managed and owned by one or several participants or even an organization.  Today, all accounts and data are in most cases registered for employees, and as a result, if you are dismissed, the transfer of rights to such resources can become a problem. </p><br><p>  Tokenization allows a company owning a package to put it on a balance sheet, deposit it in intangible assets, sell it, and so is more pitiful.  Also, when selling the company itself, tokenized assets will be easily taken into account and included in the price. </p><br><h2 id="tehnologii">  Technology </h2><br><p>  To implement such a solution, we will use a smart contract on the Ethereum blockchain and the Swarm distributed file system.  For those who don't know, Swarm is a decentralized file storage like ipfs, only from the developers of Ethereum.  Immediately, I note that the launch of Swarm is scheduled for the 4th quarter of this year and the code may change slightly, but the overall concept will remain the same. </p><br><p>  Files in swarm are stored as directories.  Each directory contains a manifest - a list of all files in the directory.  The manifest is essentially JSON with an array of file paths and their hashes.  Each directory is assigned a bzz-address, which is the top of the Merkel tree for the files listed in the manifest.  To identify files, a hash sum protected from the <a href="https://ru.wikipedia.org/wiki/%25D0%2590%25D1%2582%25D0%25B0%25D0%25BA%25D0%25B0_%25D1%2583%25D0%25B4%25D0%25BB%25D0%25B8%25D0%25BD%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5%25D0%25BC_%25D1%2581%25D0%25BE%25D0%25BE%25D0%25B1%25D1%2589%25D0%25B5%25D0%25BD%25D0%25B8%25D1%258F">attack by deleting a message is used</a> ; to do this, before taking the hash sum, the length of the data is added to the beginning of the data as a 64-bit number with a byte order from the lowest to the highest. </p><br><h2 id="algoritm">  Algorithm </h2><br><ol><li>  The package is registered (by name) with a smart contract, we get a hash name. </li><li>  The code is loaded into swarm, we get the bzz-address. </li><li>  A new version of the package is registered in the smart contract with the received bzz-address. </li></ol><br><h2 id="realizaciya">  Implementation </h2><br><h3 id="model-dannyh">  Data model </h3><br><p> The version is stored according to the principles of semver without named branches ( <code>alpha</code> , <code>rc0</code> , etc. are not supported).  All packages are stored in the list, where the key is the package name and the value is the version tree.  It looks like this: </p><br><pre> <code class="hljs ruby">/<span class="hljs-regexp"><span class="hljs-regexp">/  struct Package { address owner; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/    uint8 latestMajor; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/     mapping(uint8 =&gt; Major) majors; } /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/   ,   . struct Major { /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/    uint8 latestMinor; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/    mapping(uint8 =&gt; Minor) minors; } /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/   ,   . struct Minor { /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/    uint16 latestBuild; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/  . mapping(uint16 =&gt; Build) builds; } /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/      bzz-. struct Build { /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/ bzz- bytes32 bzz; /</span></span><span class="hljs-regexp"><span class="hljs-regexp">/  bool isPublished; }</span></span></code> </pre> <br><h3 id="pamyat-kontrakta">  Contract memory </h3><br><p>  Three contracts are used for the work of the contract: </p><br><pre> <code class="hljs pgsql">//  . <span class="hljs-keyword"><span class="hljs-keyword">mapping</span></span>(bytes32 =&gt; Package) packages; //       . <span class="hljs-keyword"><span class="hljs-keyword">mapping</span></span>(bytes32 =&gt; bytes) names; //   . <span class="hljs-keyword"><span class="hljs-keyword">mapping</span></span>(bytes32 =&gt; address) transfers;</code> </pre> <br><h3 id="registraciya-paketa">  Package Registration </h3><br><p>  Package registration is necessary in order to link the package name and the owner, as well as convert the name into a hash.  Name hashing is necessary in order to work with a package having a name of any length always take the same time / consume the same amount of gas: </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">function</span></span> register(bytes _name) <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">returns</span></span>(bytes32) { // ,      require(_name.length &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>); //     bytes32 <span class="hljs-type"><span class="hljs-type">name</span></span> = resolve(_name); // ,      require(packages[<span class="hljs-type"><span class="hljs-type">name</span></span>].owner == address(<span class="hljs-number"><span class="hljs-number">0</span></span>)); //   packages[<span class="hljs-type"><span class="hljs-type">name</span></span>] = Package(msg.sender, <span class="hljs-number"><span class="hljs-number">0</span></span>); //         names[<span class="hljs-type"><span class="hljs-type">name</span></span>] = _name; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-type"><span class="hljs-type">name</span></span>; }</code> </pre> <br><p>  Call from JS: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> Web3 = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'web3'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> {abi} = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'./contract.js'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> web3 = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Web3(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Web3(<span class="hljs-string"><span class="hljs-string">'https://rinkeby.infura.io/'</span></span>)); <span class="hljs-comment"><span class="hljs-comment">// Initialize contract instance const reg = new web3.eth.Contract(abi, '0x57147069B117fD911Da6c43F3fBdC54a7A7D8C1d'); reg.methods.register('hello_world').send() .then((hash) =&gt; console.log(hash));</span></span></code> </pre> <br><h3 id="zagruzka-v-swarm">  Swarm Download </h3><br><p>  The data in Sqarm is loaded via the HTTP protocol, while to download the directory you can put the files in the tar archive: </p><br><pre> <code class="bash hljs">tar -c * | curl -H <span class="hljs-string"><span class="hljs-string">"Content-Type: application/x-tar"</span></span> --data-binary @- http://localhost:8500/bzz:/</code> </pre> <br><p>  As a result, we get a 32-bit top of the Merkel tree (bzz-address), for example: </p><br><pre> <code class="hljs">1e0e21894d731271e50ea2cecf60801fdc8d0b23ae33b9e808e5789346e3355e</code> </pre> <br><p>  To get files from swarm you need to get a <a href="https://swarm-guide.readthedocs.io/en/latest/simpleuser.html">list of files</a> : </p><br><pre> <code class="bash hljs">curl -s http://localhost:8500/bzz-list:/ccef599d1a13bed9989e424011aed2c023fce25917864cd7de38a761567410b8/ | jq . &gt; { <span class="hljs-string"><span class="hljs-string">"common_prefixes"</span></span>: [ <span class="hljs-string"><span class="hljs-string">"dir1/"</span></span>, <span class="hljs-string"><span class="hljs-string">"dir2/"</span></span>, <span class="hljs-string"><span class="hljs-string">"dir3/"</span></span> ], <span class="hljs-string"><span class="hljs-string">"entries"</span></span> : [ { <span class="hljs-string"><span class="hljs-string">"path"</span></span>: <span class="hljs-string"><span class="hljs-string">"file.txt"</span></span>, <span class="hljs-string"><span class="hljs-string">"contentType"</span></span>: <span class="hljs-string"><span class="hljs-string">"text/plain"</span></span>, <span class="hljs-string"><span class="hljs-string">"size"</span></span>: 9, <span class="hljs-string"><span class="hljs-string">"mod_time"</span></span>: <span class="hljs-string"><span class="hljs-string">"2017-03-12T15:19:55.112597383Z"</span></span>, <span class="hljs-string"><span class="hljs-string">"hash"</span></span>: <span class="hljs-string"><span class="hljs-string">"94f78a45c7897957809544aa6d68aa7ad35df695713895953b885aca274bd955"</span></span> } ] }</code> </pre> <br><blockquote>  For experiments, you can use the site <a href="https://swarm-gateways.org/">https://swarm-gateways.org/</a> . </blockquote><br><h3 id="registraciya-novoy-versii">  Register a new version </h3><br><p>  To register a new version, simply call the register method with the name hash, version numbers (major, minor, build) and bzz addresses. </p><br><pre> <code class="hljs matlab"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">publish</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(bytes32 _package, uint8 _major, uint8 _minor, uint16 _build, bytes32 _bzz)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">public</span></span></span><span class="hljs-function"> { </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Package</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">storage</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">package</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">packages</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[_package]</span></span></span><span class="hljs-function">; //   . </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">require</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(package.owner == msg.sender)</span></span></span><span class="hljs-function">; //     </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">require</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(hasBuild(_package, _major, _minor, _build)</span></span></span><span class="hljs-function"> == </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">false</span></span></span><span class="hljs-function">); //    </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">package</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">majors</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[_major]</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">minors</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[_minor]</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">builds</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[_build]</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Build</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(_bzz, true)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Major</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">memory</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">major</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">package</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">majors</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[_major]</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Minor</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">memory</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">minor</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">package</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">majors</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[_major]</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">minors</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[_minor]</span></span></span><span class="hljs-function">; //      </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(package.latestMajor &lt; _major)</span></span></span><span class="hljs-function"> { </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">package</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">latestMajor</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_major</span></span></span><span class="hljs-function">; } //        . </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(major.latestMinor &lt; _minor)</span></span></span><span class="hljs-function"> { </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">package</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">majors</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[_major]</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">latestMinor</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_minor</span></span></span><span class="hljs-function">; } //      . </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(minor.latestBuild &lt; _build)</span></span></span><span class="hljs-function"> { </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">package</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">majors</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[_major]</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">minors</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[_minor]</span></span></span><span class="hljs-function">.</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">latestBuild</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">_build</span></span></span><span class="hljs-function">; } </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">emit</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Published</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(_package, _major, _minor, _build)</span></span></span><span class="hljs-function">; }</span></span></code> </pre> <br><pre> <code class="javascript hljs">reg.methods.publish(hash, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, bzz).send();</code> </pre> <br><h3 id="peredacha-prav">  Transfer of rights </h3><br><p>  As mentioned above, the ownership of the package can be transferred, methods that implement this functionality: <code>transfer</code> and <code>receive</code> .  The <code>transfer</code> method assigns a new owner, after which the new owner can receive the packet by calling the <code>receive</code> method. </p><br><blockquote>  Until the call is <code>receive</code> , the packet is kept by the current owner.  This protects against erroneous actions, as well as requires confirmation by the host country, which allows you to make a transfer deal bilateral: no one can impose ownership on you without your consent. </blockquote><br><h2 id="metody-kontrakta">  Contract methods </h2><br><ul><li>  register - register a contract. </li><li>  resolve - converts the name to the hash. </li><li>  publish - register a new version.  Generates an event <code>Published</code> . </li><li>  unpublish - version revocation.  Generates an <code>Unpublished</code> event. </li><li>  getOwner - returns the current owner of the package. </li><li>  hasBuild - returns the status of the last published build. </li><li>  isPublished - returns the version status. </li><li>  getLatestMajorVersion - get the number of the last major version of the package. </li><li>  getLatestMinorVersion - get the number of the last minor version of the package for the specified major version. </li><li>  getLatestBuildVersion - get the latest build number for the specified minor version. </li><li>  transfer - transfer of the package to the new owner. </li><li>  receive - receive the packet by the new owner. </li></ul><br><h2 id="ogranicheniya">  Restrictions </h2><br><p>  This scheme excludes the possibility of recalling major or minor versions.  Only certain builds can be recalled.  It is also impossible to recall the latest build of the minor version.  To do this, you must first publish a new one, and then recall the previous build.  This eliminates the need to go through the version tree to reassign the latest version and thus reduces the amount of gas consumed. </p><br><h2 id="zaklyuchenie">  Conclusion </h2><br><p>  In this form, all versions of packages become globally identifiable by hash, which allows, for example, to bind CVE numbers to specific versions of code.  And due to the use of blockchain and distributed structure, changes in your code are guaranteed to reach users. </p><br><p>  If you have any ideas on how to improve this code, leave issues or PR, watch for changes, well, put the stars, I would be grateful. </p><br><h3 id="ssylki">  Links </h3><br><ul><li>  <a href="https://github.com/ethmx/contracts">Repository</a> on github. </li><li>  Photo by <a href="https://unsplash.com/photos/8EzNkvLQosk">Maarten van den Heuvel</a> . </li></ul><br><h2 id="pometki-i-zamechaniya">  Notes and notes </h2><br><p>  Answers to questions in the <a href="https://habrahabr.ru/post/353798/">comments of</a> <a href="https://habrahabr.ru/users/StanislavL/">StanislavL</a> : </p><br><blockquote>  Why do I need to add versions with a number less than the current one? </blockquote><p>  Some versions of packages have LTS support, so the situation when the major and minor versions get into the release is quite likely. </p><br><blockquote>  There is no possibility of multiple ownership. </blockquote><p>  This functionality can be very different for each group of developers, so it must be implemented in a third-party contract, which will be the owner.  This simplifies the registry code and eliminates binding to a single implementation. </p><br><blockquote>  What is the point of burning gas (= spending money) in the registration of the next build? </blockquote><p>  Semver assumes that the package code itself is versioned by builds, major and minor branches point to the interface.  In other words, the contract code between adjacent builds can be rewritten to 100%, but the interface will remain the same. </p><br><blockquote>  There is an event event <code>Transfered(bytes32 indexed package)</code> ; <br>  but no <code>OwnershipChanged</code> .  I would add not only the package, but also the address of the candidate candidate. </blockquote><p>  The <code>Transfered</code> event is <code>OwnershipChanged</code> : it is called when the receiving party has called receive and the owner has changed.  The candidate's address does not enter the log in order not to waste additional gas, since this data can be obtained from the transaction. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/353798/">https://habr.com/ru/post/353798/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../353780/index.html">Comparison of the speed of different variants of Unity3D script interaction</a></li>
<li><a href="../353782/index.html">Video from the first Badoo PHP Meetup 04/07/2018</a></li>
<li><a href="../353784/index.html">ReactOS 0.4.8: We lured Dr. Watson</a></li>
<li><a href="../353790/index.html">Go: Good, bad, angry</a></li>
<li><a href="../353792/index.html">Final of the International Student Programming Olympiad Live</a></li>
<li><a href="../353800/index.html">Microsoft Office Security: VBA Macros</a></li>
<li><a href="../353802/index.html">Using Multifactor Authentication in Citrix Based on Aladdin RD Solutions - Webinar</a></li>
<li><a href="../353804/index.html">Flask Mega-Tutorial, Part XX: The Magic of JavaScript</a></li>
<li><a href="../353806/index.html">My experience using Google AdWords Express</a></li>
<li><a href="../353808/index.html">OPA and SPIFFE - two new projects at CNCF for cloud application security</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>