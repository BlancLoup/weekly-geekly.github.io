<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>The interaction of Android devices on the local network</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Suppose we are writing a game for Android, which implies some kind of networking between devices. Moreover, our devices are in the same network and we...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>The interaction of Android devices on the local network</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/444/d83/ada/444d83ada308c743f83881f514ed8aee.png"><br><br>  Suppose we are writing a game for Android, which implies some kind of networking between devices.  Moreover, our devices are in the same network and we want the interaction between them to be carried out quickly, which means that the option of data exchange via the Internet does not suit us.  Oh yeah, another little fly in the ointment - we want to reach the largest possible audience, for which we need to support Android 2.3. <br>  <b>What do we do?</b>  Let's talk about this, but at the same time we will consider the relatively new features of the Android SDK for connecting two or more devices. <br><a name="habracut"></a><br><h4>  What is it for and who is it for? </h4><br>  Once, having gone from a previous job and immersed in a well-deserved rest, I began to write a network game that people in one local network can play.  And immediately faced with the fact that for the normal functioning of such a game, it is not enough for us to build network interaction - we need to make normal and fast detection of devices on the network.  Actually, in this article I will share my experience in implementing solutions for this problem. <br>  I‚Äôll just say that the article is intended more for those who have experience in Android development, have written several applications and want to expand their horizons, as well as improve their professional skills. <br><br><h4>  What possible solutions exist? </h4><br><ol><li>  <a href="http://developer.android.com/training/connect-devices-wirelessly/nsd.html">Android Network Service Discovery</a> .  Simple and effective way to detect devices.  On Android Developer there is a step-by-step guide on how to connect NSD, there is an example of NsdChat, which can be downloaded in the same place.  But there is one significant disadvantage - this method is supported only starting from API Level 16, that is, from Android 4.1 Jelly Bean; </li><li>  The second solution offered to us on the Android Developer website is <a href="http://developer.android.com/training/connect-devices-wirelessly/wifi-direct.html">Wi-Fi Peer-to-Peer</a> .  The problem with this method is the same - it is supported only starting from API Level 16; </li><li>  There is a strange solution, which is proposed by some programmers on Stack Overflow - to independently scan the local network for the presence of a server.  That is, go to all network addresses.  It already sounds like a strange bike, and now imagine that the port of our server is automatically assigned.  Thus, scanning even the smallest network becomes quite a long and laborious task; </li><li>  Finally, we can look at the Java libraries and write something using them.  For example, <a href="http://jmdns.sourceforge.net/">JmDNS</a> . </li></ol><br>  The latter method looks quite adequate and seems to provide us with the required speed and convenience of detecting devices on the network for the end user. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  So... </h4><br>  I armed myself with JmDNS and decided to try to build several classes that would simplify the writing of the applications described above to the maximum.  But for starters, I had to slightly cut duplicate .class files from the JmDNS jar package (the problem is described <a href="http://home.heeere.com/tech-androidjmdns.html">here</a> ): <br><br><pre><code class="bash hljs">mkdir unjar <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> unjar jar xf ../jmdns.jar jar cfm ../jmdns.jar META-INF/MANIFEST.MF javax/</code> </pre> <br><br>  Next, I took the NsdChat source code from Android Developer and changed its utility class, which is responsible for initializing sockets and organizing network interaction.  I also wrote a wrapper for JmDNS <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.content.Context; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.net.wifi.WifiInfo; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.net.wifi.WifiManager; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.util.Log; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.IOException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.net.InetAddress; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.jmdns.JmDNS; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.jmdns.ServiceEvent; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.jmdns.ServiceInfo; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> javax.jmdns.ServiceListener; <span class="hljs-comment"><span class="hljs-comment">/** * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@author</span></span></span><span class="hljs-comment"> alwx * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@version</span></span></span><span class="hljs-comment"> 1.0 */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">NetworkDiscovery</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String DEBUG_TAG = NetworkDiscovery.class.getName(); <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String TYPE = <span class="hljs-string"><span class="hljs-string">"_alwx._tcp.local."</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String SERVICE_NAME = <span class="hljs-string"><span class="hljs-string">"LocalCommunication"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Context mContext; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> JmDNS mJmDNS; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ServiceInfo mServiceInfo; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> ServiceListener mServiceListener; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> WifiManager.MulticastLock mMulticastLock; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">NetworkDiscovery</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Context context)</span></span></span><span class="hljs-function"> </span></span>{ mContext = context; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { WifiManager wifi = (WifiManager) mContext.getSystemService(android.content.Context.WIFI_SERVICE); WifiInfo wifiInfo = wifi.getConnectionInfo(); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> intaddr = wifiInfo.getIpAddress(); <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[] byteaddr = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>[]{ (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>) (intaddr &amp; <span class="hljs-number"><span class="hljs-number">0xff</span></span>), (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>) (intaddr &gt;&gt; <span class="hljs-number"><span class="hljs-number">8</span></span> &amp; <span class="hljs-number"><span class="hljs-number">0xff</span></span>), (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>) (intaddr &gt;&gt; <span class="hljs-number"><span class="hljs-number">16</span></span> &amp; <span class="hljs-number"><span class="hljs-number">0xff</span></span>), (<span class="hljs-keyword"><span class="hljs-keyword">byte</span></span>) (intaddr &gt;&gt; <span class="hljs-number"><span class="hljs-number">24</span></span> &amp; <span class="hljs-number"><span class="hljs-number">0xff</span></span>) }; InetAddress addr = InetAddress.getByAddress(byteaddr); mJmDNS = JmDNS.create(addr); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (IOException e) { Log.d(DEBUG_TAG, <span class="hljs-string"><span class="hljs-string">"Error in JmDNS creation: "</span></span> + e); } } <span class="hljs-comment"><span class="hljs-comment">/** * starts server with defined names on given port * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> port server port */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">startServer</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> port)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { wifiLock(); mServiceInfo = ServiceInfo.create(TYPE, SERVICE_NAME, port, SERVICE_NAME); mJmDNS.registerService(mServiceInfo); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (IOException e) { Log.d(DEBUG_TAG, <span class="hljs-string"><span class="hljs-string">"Error in JmDNS initialization: "</span></span> + e); } } <span class="hljs-comment"><span class="hljs-comment">/** * performs servers discovery * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> listener listener, that will be called after successful discovery * (see {</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@link</span></span></span><span class="hljs-comment"> me.alwx.localcommunication.connection.NetworkDiscovery.OnFoundListener} */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">findServers</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">final</span></span></span></span><span class="hljs-function"><span class="hljs-params"> OnFoundListener listener)</span></span></span><span class="hljs-function"> </span></span>{ mJmDNS.addServiceListener(TYPE, mServiceListener = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ServiceListener() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">serviceAdded</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ServiceEvent serviceEvent)</span></span></span><span class="hljs-function"> </span></span>{ ServiceInfo info = mJmDNS.getServiceInfo(serviceEvent.getType(), serviceEvent.getName()); listener.onFound(info); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">serviceRemoved</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ServiceEvent serviceEvent)</span></span></span><span class="hljs-function"> </span></span>{ } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">serviceResolved</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ServiceEvent serviceEvent)</span></span></span><span class="hljs-function"> </span></span>{ mJmDNS.requestServiceInfo(serviceEvent.getType(), serviceEvent.getName(), <span class="hljs-number"><span class="hljs-number">1</span></span>); } }); } <span class="hljs-comment"><span class="hljs-comment">/** * closes connection &amp; unregisters all services */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">reset</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mJmDNS != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mServiceListener != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>) { mJmDNS.removeServiceListener(TYPE, mServiceListener); mServiceListener = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; } mJmDNS.unregisterAllServices(); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (mMulticastLock != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; mMulticastLock.isHeld()) { mMulticastLock.release(); } } <span class="hljs-comment"><span class="hljs-comment">/** * accuires Wi-Fi lock */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">wifiLock</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ WifiManager wifiManager = (WifiManager) mContext.getSystemService(android.content.Context.WIFI_SERVICE); mMulticastLock = wifiManager.createMulticastLock(SERVICE_NAME); mMulticastLock.setReferenceCounted(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); mMulticastLock.acquire(); } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">interface</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">OnFoundListener</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onFound</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(ServiceInfo info)</span></span></span></span>; } }</code> </pre><br><br>  Here are 4 basic functions for Network Discovery: <br><ol><li>  <b>startServer</b> to create a server and register the corresponding service in the local network; </li><li>  <b>findServers</b> to find servers; </li><li>  <b>reset</b> to finish working with Network Discovery and then free up resources; </li><li>  <b>wifiLock</b> to request a Wi-Fi block. </li></ol><br><br>  At the end, I wrote a universal class ConnectionWrapper for the full organization of detection, as well as messaging on the local network.  Thus, the creation of a server in the final application is as follows: <br><pre> <code class="java hljs">getConnectionWrapper().startServer(); getConnectionWrapper().setHandler(mServerHandler);</code> </pre><br>  And here is mServerHandler, used for receiving and processing messages: <br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Handler mServerHandler = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MessageHandler(MainActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>) { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onMessage</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String type, JSONObject message)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (type.equals(Communication.Connect.TYPE)) { <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String deviceFrom = message.getString(Communication.Connect.DEVICE); Toast.makeText(getApplicationContext(), <span class="hljs-string"><span class="hljs-string">"Device: "</span></span> + deviceFrom, Toast.LENGTH_SHORT).show(); } } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (JSONException e) { Log.d(DEBUG_TAG, <span class="hljs-string"><span class="hljs-string">"JSON parsing exception: "</span></span> + e); } } };</code> </pre><br>  Sending messages is even easier: <br><pre> <code class="java hljs">getConnectionWrapper().send( <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HashMap&lt;String, String&gt;() {{ put(Communication.MESSAGE_TYPE, Communication.ConnectSuccess.TYPE); }} );</code> </pre><br>  And finally, the method to detect and connect to the server: <br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">connect</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ getConnectionWrapper().findServers(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> NetworkDiscovery.OnFoundListener() { <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onFound</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(javax.jmdns.ServiceInfo info)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (info != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span> &amp;&amp; info.getInet4Addresses().length &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>) { getConnectionWrapper().stopNetworkDiscovery(); getConnectionWrapper().connectToServer( info.getInet4Addresses()[<span class="hljs-number"><span class="hljs-number">0</span></span>], info.getPort(), mConnectionListener ); getConnectionWrapper().setHandler(mClientHandler); } } }); }</code> </pre><br>  As you can see, everything is very simple.  And most importantly, it all works in any version of Android for up to two devices.  But to make it work for a conditionally unlimited number of devices is very easy, and the obvious solution will come to you almost immediately after a detailed study of the Connection class.  Let it be for homework. <br>  Oh yes, all the code is available for everyone to learn and use in <a href="https://github.com/alwx/android-jmdns">my repository on GitHub.</a>  .  And, of course, I do not exclude the fact that some things can be done better and easier, so do not hesitate to fork and do pull requests. </div><p>Source: <a href="https://habr.com/ru/post/208132/">https://habr.com/ru/post/208132/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../208112/index.html">Module for determining the sources of site visitors for Ruby on Rails</a></li>
<li><a href="../208114/index.html">Dances with a tambourine on New Year's Eve or the second life of old cars</a></li>
<li><a href="../208116/index.html">Script monitoring the availability of ports on the network with notification by email (bash)</a></li>
<li><a href="../208120/index.html">Lectures from Yandex for those who want to spend the holidays with benefit. Discrete analysis and probability theory</a></li>
<li><a href="../208122/index.html">"With you, the game for 100 bucks!" Or why Indiegogo is not Go-Go</a></li>
<li><a href="../208136/index.html">Pieces of code in the headers of letters on Yandex. Mail</a></li>
<li><a href="../208138/index.html">Approaches to optimizing (web) applications</a></li>
<li><a href="../208144/index.html">2014 through the eyes of Isaac Asimov: predictions from 1964</a></li>
<li><a href="../208146/index.html">The initiative against reducing the limit of purchases abroad from 1,000 to 150 euros per month</a></li>
<li><a href="../208148/index.html">The digest of interesting materials from the world of web development and IT for the last week No. 90 (December 29 - January 4, 2014)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>