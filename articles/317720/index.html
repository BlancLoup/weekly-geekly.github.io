<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Exotic HTTP Headers</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi Habrahabr! This article will demonstrate the effect of using some important and exotic HTTP headers, most of which are related to security. 

 X-XS...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Exotic HTTP Headers</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/0e9/205/ad6/0e9205ad6abaf074912779548ad43610.png"><br>  Hi Habrahabr!  This article will demonstrate the effect of using some important and exotic HTTP headers, most of which are related to security. <br><a name="habracut"></a><br><h1>  X-XSS-Protection </h1><br>  An XSS (cross-site scripting) attack is a type of attack in which malicious code can be injected into an attacked page. <br><br>  For example, like this: <br><br><pre><code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span>Hello, <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="actionscript"><span class="actionscript">alert(</span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">'hacked'</span></span></span><span class="actionscript">)</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h1</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  This type of attack is easy to detect and the browser can easily deal with it: if the source code contains a part of the request, then this may be a threat. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      And the <b>X-XSS-Protection</b> header controls this browser behavior. <br><br>  Accepted values: <br><br><ul><li>  <b>0</b> filter off <br></li><li>  <b>1</b> filter included.  If an attack is detected, the browser will remove the malicious code. <br></li><li>  <b>one;</b>  <b>mode = block</b> .  The filter is enabled, but if an attack is detected, the page will not be loaded by the browser. <br></li><li>  <b>one;</b>  <b>report = http: // domain / url</b> .  the filter is turned on and the browser clears the page of malicious code, while reporting an attempted attack.  It uses the Chromium function to send a report on the violation of content protection policy (CSP) to a specific address. <br></li></ul><br>  Create a web server sandbox on node.js to see how this works. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> express = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'express'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> app = express() app.use(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">req, res</span></span></span><span class="hljs-function">) =&gt;</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (req.query.xss) res.setHeader(<span class="hljs-string"><span class="hljs-string">'X-XSS-Protection'</span></span>, req.query.xss) res.send(<span class="hljs-string"><span class="hljs-string">`&lt;h1&gt;Hello, </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${req.query.user || </span></span><span class="hljs-string"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-string">'anonymous'</span></span></span></span><span class="hljs-string"><span class="hljs-subst">}</span></span></span><span class="hljs-string">&lt;/h1&gt;`</span></span>) }) app.listen(<span class="hljs-number"><span class="hljs-number">1234</span></span>)</code> </pre> <br>  I will use Google Chrome 55. <br><br><h3>  No title </h3><br><pre> <code class="hljs perl">http:<span class="hljs-regexp"><span class="hljs-regexp">//localhost</span></span>:<span class="hljs-number"><span class="hljs-number">1234</span></span>/?user=%3Cscript%3Ealert(%27hacked%27)%3C/script%3E</code> </pre> <br>  Nothing happens, the browser successfully blocks the attack.  Chrome, by default, blocks the threat and reports this to the console. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/183/72c/803/18372c803f742576162d29888b75f185.png"><br><br>  He even highlights the problem area in the source code. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/807/7ac/06d/8077ac06d960fe4e9d46afd25faece3c.png"><br><br><h3>  X-XSS-Protection: 0 </h3><br><pre> <code class="hljs perl">http:<span class="hljs-regexp"><span class="hljs-regexp">//localhost</span></span>:<span class="hljs-number"><span class="hljs-number">1234</span></span>/?user=%3Cscript%3Ealert(%27hacked%27)%3C/script%3E&amp;xss=<span class="hljs-number"><span class="hljs-number">0</span></span></code> </pre> <br>  Oh no! <br><br><img src="https://habrastorage.org/getpro/habr/post_images/462/335/628/46233562803227d7a7c01ff47de11048.png"><br><br><h3>  X-XSS-Protection: 1 </h3><br><pre> <code class="hljs perl">http:<span class="hljs-regexp"><span class="hljs-regexp">//localhost</span></span>:<span class="hljs-number"><span class="hljs-number">1234</span></span>/?user=%3Cscript%3Ealert(%27hacked%27)%3C/script%3E&amp;xss=<span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre> <br>  The page has been cleared due to an explicit title. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/3d8/cee/9a3/3d8cee9a3ee9f7f02c6cc89e653697ad.png"><br><br><h3>  X-XSS-Protection: 1;  mode = block </h3><br><pre> <code class="hljs perl">http:<span class="hljs-regexp"><span class="hljs-regexp">//localhost</span></span>:<span class="hljs-number"><span class="hljs-number">1234</span></span>/?user=%3Cscript%3Ealert(%27hacked%27)%3C/script%3E&amp;xss=<span class="hljs-number"><span class="hljs-number">1</span></span>;%20mode=block</code> </pre> <br>  In this case, the attack will be prevented by blocking the page loading. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/5e4/0ab/87f/5e40ab87f2c5bd37b1ec01ab09a3151f.png"><br><br><h3>  X-XSS-Protection: 1;  report = http: // localhost: 1234 / report </h3><br><pre> <code class="hljs perl">http:<span class="hljs-regexp"><span class="hljs-regexp">//localhost</span></span>:<span class="hljs-number"><span class="hljs-number">1234</span></span>/?user=%3Cscript%3Ealert(%27hacked%27)%3C/script%3E&amp;xss=<span class="hljs-number"><span class="hljs-number">1</span></span>;%20report=http:<span class="hljs-regexp"><span class="hljs-regexp">//localhost</span></span>:<span class="hljs-number"><span class="hljs-number">1234</span></span>/report</code> </pre> <br>  The attack was prevented and the message was sent to the appropriate address. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/238/cbf/61c/238cbf61cde686c134f704efc90ca2a6.png"><br><br><h1>  X-Frame-Options </h1><br>  With this header you can protect yourself from the so-called Clickjacking [Clickjacking]. <br><br>  Imagine that an attacker has a YouTube channel and wants more subscribers. <br><br>  He can create a page with the ‚ÄúDo not click‚Äù button, which will mean that everyone will click on it.  But over the button there is an absolutely transparent iframe and in this frame there is a channel page with a subscription button.  Therefore, when you click on the button, the user actually subscribes to the channel, unless of course he was logged into YouTube. <br><br>  Let's demonstrate it. <br><br>  First you need to install an <a href="https://chrome.google.com/webstore/detail/ignore-x-frame-headers/gleekbfjekiniecknbkamfmkohkpodhe/">extension</a> to ignore this header. <br><br>  Create a simple page. <br><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag">&gt;</span></span><span class="css"><span class="css"> </span><span class="hljs-selector-tag"><span class="css"><span class="hljs-selector-tag">button</span></span></span><span class="css"> { </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">background</span></span></span><span class="css">: red; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">color</span></span></span><span class="css">: white; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">padding</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">10px</span></span></span><span class="css"> </span><span class="hljs-number"><span class="css"><span class="hljs-number">20px</span></span></span><span class="css">; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">border</span></span></span><span class="css">: none; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">cursor</span></span></span><span class="css">: pointer; } </span><span class="hljs-selector-tag"><span class="css"><span class="hljs-selector-tag">iframe</span></span></span><span class="css"> { </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">opacity</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">0.8</span></span></span><span class="css">; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">z-index</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">1</span></span></span><span class="css">; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">position</span></span></span><span class="css">: absolute; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">top</span></span></span><span class="css">: -</span><span class="hljs-number"><span class="css"><span class="hljs-number">570px</span></span></span><span class="css">; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">left</span></span></span><span class="css">: -</span><span class="hljs-number"><span class="css"><span class="hljs-number">80px</span></span></span><span class="css">; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">width</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">500px</span></span></span><span class="css">; </span><span class="hljs-attribute"><span class="css"><span class="hljs-attribute">height</span></span></span><span class="css">: </span><span class="hljs-number"><span class="css"><span class="hljs-number">650px</span></span></span><span class="css">; } </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">style</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span>Do not click his button!<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">button</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iframe</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"https://youtu.be/dQw4w9WgXcQ?t=3m33s"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">iframe</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><img src="https://habrastorage.org/files/cd7/ba1/915/cd7ba1915274453da06427b63af9bbd2.png"><br><br>  As you can see, I placed a frame with a subscription right above the button ( <b>z-index: 1</b> ) and therefore, if you try to click on it, the frame is actually pressed.  In this example, the frame is not completely transparent, but this is corrected by the <b>opacity</b> value <b>: 0</b> . <br><br>  In practice, this will not work, because YouTube has the right title, but I hope the meaning of the threat is clear. <br><br>  To prevent a page from being used in a frame, use the <b>X-Frame-Options</b> header. <br><br>  Accepted values: <br><br><ul><li>  <b>deny</b> does not load the page at all. </li><li>  <b>sameorigin</b> does not load if the source does not match. </li><li>  <b>allow-from: DOMAIN,</b> you can specify the domain from which the page can be loaded into the frame. </li></ul><br>  We will need a web server for demonstration. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> express = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'express'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">let</span></span> port <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> [<span class="hljs-number"><span class="hljs-number">1234</span></span>, <span class="hljs-number"><span class="hljs-number">4321</span></span>]) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> app = express() app.use(<span class="hljs-string"><span class="hljs-string">'/iframe'</span></span>, (req, res) =&gt; res.send(<span class="hljs-string"><span class="hljs-string">`&lt;h1&gt;iframe&lt;/h1&gt;&lt;iframe src="//localhost:1234?h=</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${req.query.h || </span></span><span class="hljs-string"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-string">''</span></span></span></span><span class="hljs-string"><span class="hljs-subst">}</span></span></span><span class="hljs-string">"&gt;&lt;/iframe&gt;`</span></span>)) app.use(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">req, res</span></span></span><span class="hljs-function">) =&gt;</span></span> {   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (req.query.h) res.setHeader(<span class="hljs-string"><span class="hljs-string">'X-Frame-Options'</span></span>, req.query.h)   res.send(<span class="hljs-string"><span class="hljs-string">'&lt;h1&gt;Website&lt;/h1&gt;'</span></span>) }) app.listen(port) }</code> </pre> <br><h3>  No title </h3><br>  Everyone will be able to embed our website at <b>localhost: 1234</b> into the frame. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/296/987/7e9/2969877e936f709b69d6c7d44ae7f1d8.png"><br><br><h3>  X-Frame-Options: deny </h3><br>  The page generally can not be used in the frame. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/222/a5a/8d4/222a5a8d448326802fb3a16281f2937d.png"><br><br><h3>  X-Frame-Options: sameorigin </h3><br>  Only pages with the same source will be able to embed in the frame.  The sources match if the domain, port, and protocol are the same. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f95/25a/78c/f9525a78cc65a1aa5ef664b122f8bcac.png"><br><br><h3>  X-Frame-Options: allow-from <a href="http://localhost/">localhost</a> : 4321 </h3><br>  It seems that Chrome ignores this option, because  there is a Content-Security-Policy header (it will be described below).  It does not work in Microsoft Edge. <br><br>  Below is Mozilla Firefox. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ed9/b6b/2d1/ed9b6b2d12c28d82040fd8ecfdff9132.png"><br><br><h1>  X-Content-Type-Options </h1><br>  This header prevents attacks with the substitution of MIME types ( <b>&lt;script src = "script.txt"&gt;</b> ) or unauthorized hotlink ( <b>&lt;script src = "https://raw.githubusercontent.com/user/repo/branch/file.js"&gt;</b> ) <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> express = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'express'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> app = express() app.use(<span class="hljs-string"><span class="hljs-string">'/script.txt'</span></span>, (req, res) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (req.query.h) res.header(<span class="hljs-string"><span class="hljs-string">'X-Content-Type-Options'</span></span>, req.query.h) res.header(<span class="hljs-string"><span class="hljs-string">'content-type'</span></span>, <span class="hljs-string"><span class="hljs-string">'text/plain'</span></span>) res.send(<span class="hljs-string"><span class="hljs-string">'alert("hacked")'</span></span>) }) app.use(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">req, res</span></span></span><span class="hljs-function">) =&gt;</span></span> { res.send(<span class="hljs-string"><span class="hljs-string">`&lt;h1&gt;Website&lt;/h1&gt;&lt;script src="/script.txt?h=</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${req.query.h || </span></span><span class="hljs-string"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-string">''</span></span></span></span><span class="hljs-string"><span class="hljs-subst">}</span></span></span><span class="hljs-string">"&gt;&lt;/script&gt;`</span></span>) }) app.listen(<span class="hljs-number"><span class="hljs-number">1234</span></span>)</code> </pre><br><h3>  No title </h3><br><pre> <code class="hljs objectivec">http:<span class="hljs-comment"><span class="hljs-comment">//localhost:1234/</span></span></code> </pre> <br>  Although <b>script.txt</b> is a text file with type <b>text / plain</b> , it will run as a script. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6c1/232/9a3/6c12329a31ba23eccadb7f7a4ef8ff02.png"><br><br><h3>  X-Content-Type-Options: nosniff </h3><br><pre> <code class="hljs ruby"><span class="hljs-symbol"><span class="hljs-symbol">http:</span></span>/<span class="hljs-regexp"><span class="hljs-regexp">/localhost:1234/</span></span><span class="hljs-string"><span class="hljs-string">?h</span></span>=nosniff</code> </pre> <br>  This time the types do not match and the file will not be executed. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/57e/346/af1/57e346af1ea05595e4ebb33b0b5858c1.png"><br><br><h1>  Content-Security-Policy </h1><br>  This is a relatively young headline and helps reduce the risks of XSS attack in modern browsers by specifying in the header what resources can be loaded on the page. <br><br>  For example, you can ask the browser not to execute inline skrpity and download files from only one domain.  Inline skrpity can look not only as <b>&lt;script&gt; ... &lt;/ script&gt;</b> , but also as <b>&lt;h1 onclick = "..."&gt;</b> . <br><br>  Let's see how it works. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> request = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'request'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> express = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'express'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">let</span></span> port <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> [<span class="hljs-number"><span class="hljs-number">1234</span></span>, <span class="hljs-number"><span class="hljs-number">4321</span></span>]) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> app = express() app.use(<span class="hljs-string"><span class="hljs-string">'/script.js'</span></span>, (req, res) =&gt; {   res.send(<span class="hljs-string"><span class="hljs-string">`document.querySelector('#</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${req.query.id}</span></span></span><span class="hljs-string">').innerHTML = ' </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${req.query.id}</span></span></span><span class="hljs-string">-'`</span></span>) }) app.use(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">req, res</span></span></span><span class="hljs-function">) =&gt;</span></span> {   <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> csp = req.query.csp   <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (csp) res.header(<span class="hljs-string"><span class="hljs-string">'Content-Security-Policy'</span></span>, csp)   res.send(<span class="hljs-string"><span class="hljs-string">`     &lt;html&gt;     &lt;body&gt;       &lt;h1&gt;Hello, </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${req.query.user || </span></span><span class="hljs-string"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-string">'anonymous'</span></span></span></span><span class="hljs-string"><span class="hljs-subst">}</span></span></span><span class="hljs-string">&lt;/h1&gt;       &lt;p id="inline"&gt;   inline-?&lt;/p&gt;       &lt;p id="origin"&gt;   origin-?&lt;/p&gt;       &lt;p id="remote"&gt;   remote-?&lt;/p&gt;       &lt;script&gt;document.querySelector('#inline').innerHTML = ' inline-'&lt;/script&gt;       &lt;script src="/script.js?id=origin"&gt;&lt;/script&gt;       &lt;script src="//localhost:1234/script.js?id=remote"&gt;&lt;/script&gt;     &lt;/body&gt;     &lt;/html&gt;     `</span></span>) }) app.listen(port) }</code> </pre> <br><h3>  No title </h3><br>  It works the way you expected. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4eb/5ba/20e/4eb5ba20e0edc142d395ac8f5f5ff54d.png"><br><br><h3>  Content-Security-Policy: default-src 'none' </h3><br><pre> <code class="hljs perl">http:<span class="hljs-regexp"><span class="hljs-regexp">//localhost</span></span>:<span class="hljs-number"><span class="hljs-number">4321</span></span>/?csp=default-src%20%27none%27&amp;user=%3Cscript%3Ealert(%27hacked%27)%3C/script%3E</code> </pre> <br>  <b>default-src</b> applies the rule for all resources (images, scripts, frames, etc.), the value <b>'none'</b> blocks everything.  Below is a demonstration of what is happening and the errors shown in the browser. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/936/d51/002/936d51002cfc365c016621841ab273c6.png"><br><br>  Chrome refused to run any scripts.  In this case, it will not even work to download <b>favicon.ico</b> . <br><br><h3>  Content-Security-Policy: default-src 'self' </h3><br><pre> <code class="hljs perl">http:<span class="hljs-regexp"><span class="hljs-regexp">//localhost</span></span>:<span class="hljs-number"><span class="hljs-number">4321</span></span>/?csp=default-src%20%27self%27&amp;user=%3Cscript%3Ealert(%27hacked%27)%3C/script%3E</code> </pre> <br>  Now you can use resources from one source, but still you can not run external and inline-scripts. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f53/54b/3c9/f5354b3c9f4a563574325d824e125bc3.png"><br><br><h3>  Content-Security-Policy: default-src 'self';  script-src 'self' 'unsafe-inline' </h3><br><pre> <code class="hljs perl">http:<span class="hljs-regexp"><span class="hljs-regexp">//localhost</span></span>:<span class="hljs-number"><span class="hljs-number">4321</span></span>/?csp=default-src%20%27self%27;%20script-src%20%27self%27%20%27unsafe-inline%27&amp;user=%3Cscript%3Ealert(%27hacked%27)%3C/script%3E</code> </pre> <br>  This time we allowed the execution and inline-scripts.  Please note that the XSS attack in the request was also blocked.  But this will not happen if both <b>unsafe-inline</b> and <b>X-XSS-Protection are</b> simultaneously put <b>: 0</b> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/2d0/53d/e65/2d053de65445f00fdeb2a81fd3a578f6.png"><br><br><h3>  Other values </h3><br>  The site <a href="https://content-security-policy.com/">content-security-policy.com</a> beautifully shows many examples. <br><br><ul><li>  <b>default-src 'self' will</b> only allow resources from one source <br></li><li>  <b>script-src 'self' www.google-analytics.com ajax.googleapis.com will</b> allow Google Analytics, Google AJAX CDN and resources from one source. <br></li><li>  <b>default-src 'none';</b>  <b>script-src 'self';</b>  <b>connect-src 'self';</b>  <b>img-src 'self';</b>  <b>style-src 'self';</b>  allow images, scripts, AJAX and CSS from one source and prevent the download of any other resources.  For most sites, this is a good initial setup. <br></li></ul><br>  I did not check this, but I think the following headings are equivalent: <br><br><ul><li>  <b>frame-ancestors 'none'</b> and <b>X-Frame-Options: deny</b> <br></li><li>  <b>frame-ancestors 'self'</b> and <b>X-Frame-Options: sameorigin</b> <br></li><li>  <b>frame-ancestors localhost: 4321</b> and <b>X-Frame-Options: allow-from <a href="http://localhost/">localhost</a> : 4321</b> <br></li><li>  <b>script-src 'self'</b> without <b>'unsafe-inline'</b> and <b>X-XSS-Protection: 1</b> <br></li></ul><br>  If you look at the headers of facebook.com or twitter.com, you will notice that these sites use a lot of CSP. <br><br><h1>  Strict-Transport-Security </h1><br>  HTTP Strict Transport Security (HSTS) is a security policy mechanism that protects a site from an unsafe connection attempt. <br><br>  Let's say we want to connect to <b>facebook.com</b> .  If you do not type <b>https: //</b> before the request, then the protocol, by default, will be selected HTTP and therefore the request will look like <b>http://facebook.com</b> . <br><br><pre> <code class="bash hljs">$ curl -I facebook.com HTTP/1.1 301 Moved Permanently Location: https://facebook.com/</code> </pre> <br>  After that, we will be redirected to a secure version of Facebook. <br><br>  If you connect to a public WiFi point that belongs to an attacker, then the request can be intercepted and instead of facebook.com, the attacker can substitute a similar page to find out the login and password. <br><br>  To protect against such an attack, you can use the above header, which tells the client to use the <b>https</b> version of the site next time. <br><br><pre> <code class="bash hljs">$ curl -I https://www.facebook.com/ HTTP/1.1 200 OK Strict-Transport-Security: max-age=15552000; preload</code> </pre> <br>  If a user was logged in to Facebook at home, and then tried to open it from an unsafe access point, then nothing threatens him, because  browsers remember this header. <br><br>  But what will happen if you connect to an insecure network for the first time?  In this case, the defense will not work. <br><br>  But browsers have a trump card in this case.  They have a predefined list of domains for which you should only use HTTPS. <br><br>  You can send your domain to <a href="https://hstspreload.appspot.com/">this</a> address.  There you can also find out if the title is used correctly. <br><br>  Accepted values: <br><br><ul><li>  <b>max-age = 15552000</b> time, in seconds, which the browser should remember about the title. <br></li><li>  <b>includeSubDomains</b> If you specify this optional value, the header also applies to all subdomains. <br></li><li>  <b>preload</b> if the site owner wants the domain to fall into a predefined list supported by Chrome (and used by Firefox and Safari). <br></li></ul><br>  And if you need to switch to HTTP before the expiration of the <b>max-age,</b> or if the <b>preload is</b> set?  You can set the value <b>max-age = 0</b> and then the rule for switching to the https version will stop working. <br><br><h1>  Public key pins </h1><br>  HTTP Public Key Pinning (HPKP) is a security policy mechanism that allows HTTPS sites to protect themselves from fraudulent or fraudulent certificates. <br><br>  Accepted values: <br><br><ul><li>  <b>Pin-sha256 = "&lt;sha256&gt;"</b> in quotes is Base64-encoded fingerprint Subject Public Key Information (SPKI).  You can specify multiple pins for different public keys.  In the future, some browsers may use other hashing algorithms besides SHA-256. <br></li><li>  <b>max-age = &lt;seconds&gt; the</b> time, in seconds, that the browser remembers that only the listed keys should be used to access the site. <br></li><li>  <b>includeSubDomains</b> if you specify this optional parameter, the header applies to all subdomains. <br></li><li>  <b>report-uri = "&lt;URL&gt;"</b> if you specify a URL, then in case of a key verification error, the corresponding message will be sent to the specified address. <br></li></ul><br>  Instead of the <b>Public-Key-Pins</b> header, you can use the <b>Public-Key-Pins-Report-Only</b> , in this case, only key matching error messages will be sent, but the browser will still load the page. <br><br>  Facebook does this: <br><br><pre> <code class="bash hljs">$ curl -I https://www.facebook.com/ HTTP/1.1 200 OK ... Public-Key-Pins-Report-Only:     max-age=500;     pin-sha256=<span class="hljs-string"><span class="hljs-string">"WoiWRyIOVNa9ihaBciRSC7XHjliYS9VwUGOIud4PB18="</span></span>;     pin-sha256=<span class="hljs-string"><span class="hljs-string">"r/mIkG3eEpVdm+u/ko/cwxzOMo1bk4TyHIlByibiA5E="</span></span>;     pin-sha256=<span class="hljs-string"><span class="hljs-string">"q4PO2G2cbkZhZ82+JgmRUyGMoAeozA+BSXVXQWB8XWQ="</span></span>;     report-uri=<span class="hljs-string"><span class="hljs-string">"http://reports.fb.com/hpkp/"</span></span></code> </pre> <br>  Why do you need it?  Are not trusted certificate authorities (CA) enough? <br><br>  An attacker can create a certificate for facebook.com and, by deceit, force the user to add it to their trust store or he can be an administrator. <br><br>  Let's try to create a certificate for facebook. <br><br><pre> <code class="bash hljs">sudo mkdir /etc/certs <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> -e <span class="hljs-string"><span class="hljs-string">'US\nCA\nSF\nFB\nXX\nwww.facebook.com\nno@spam.org'</span></span> | \ sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 \   -keyout /etc/certs/facebook.key \   -out /etc/certs/facebook.crt</code> </pre> <br>  And make it trusted on the local system. <br><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment"># curl sudo cp /etc/certs/*.crt /usr/local/share/ca-certificates/ sudo update-ca-certificates # Google Chrome sudo apt install libnss3-tools -y certutil -A -t "C,," -n "FB" -d sql:$HOME/.pki/nssdb -i /etc/certs/facebook.crt # Mozilla Firefox #certutil -A -t "CP,," -n "FB" -d sql:`ls -1d $HOME/.mozilla/firefox/*.default | head -n 1` -i /etc/certs/facebook.crt</span></span></code> </pre> <br>  And now we will launch a web server using this certificate. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> fs = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'fs'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> https = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'https'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> express = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'express'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> options = { <span class="hljs-attr"><span class="hljs-attr">key</span></span>: fs.readFileSync(<span class="hljs-string"><span class="hljs-string">`/etc/certs/</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${process.argv[</span></span><span class="hljs-number"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-number">2</span></span></span></span><span class="hljs-string"><span class="hljs-subst">]}</span></span></span><span class="hljs-string">.key`</span></span>), <span class="hljs-attr"><span class="hljs-attr">cert</span></span>: fs.readFileSync(<span class="hljs-string"><span class="hljs-string">`/etc/certs/</span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">${process.argv[</span></span><span class="hljs-number"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-number">2</span></span></span></span><span class="hljs-string"><span class="hljs-subst">]}</span></span></span><span class="hljs-string">.crt`</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> app = express() app.use(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">req, res</span></span></span><span class="hljs-function">) =&gt;</span></span> res.send(<span class="hljs-string"><span class="hljs-string">`&lt;h1&gt;hacked&lt;/h1&gt;`</span></span>)) https.createServer(options, app).listen(<span class="hljs-number"><span class="hljs-number">443</span></span>)</code> </pre> <br>  Switch to server <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> 127.0.0.1 www.facebook.com | sudo tee -a /etc/hosts sudo node server.js facebook</code> </pre> <br>  Let's see what happened <br><br><pre> <code class="bash hljs">$ curl https://www.facebook.com &lt;h1&gt;hacked&lt;/h1&gt;</code> </pre> <br>  Fine.  <b>curl</b> confirms the certificate. <br><br>  Since I already went to Facebook and Google Chrome saw his headlines, he should report the attack but allow the page, right? <br><br><img src="https://habrastorage.org/getpro/habr/post_images/8bb/143/0dc/8bb1430dc8d261f0b541f16176906c80.png"><br><br>  Nope  Keys were not checked due to local root certificate [Public-key pinning bypassed].  It is interesting‚Ä¶ <br><br>  Well, what about <a href="http://www.google.com/">www.google.com</a> ? <br><br><pre> <code class="bash hljs"><span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> -e <span class="hljs-string"><span class="hljs-string">'US\nCA\nSF\nGoogle\nXX\nwww.google.com\nno@spam.org'</span></span> | \ sudo openssl req -x509 -nodes -days 365 -newkey rsa:2048 \   -keyout /etc/certs/google.key \   -out /etc/certs/google.crt sudo cp /etc/certs/*.crt /usr/<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/share/ca-certificates/ sudo update-ca-certificates certutil -A -t <span class="hljs-string"><span class="hljs-string">"C,,"</span></span> -n <span class="hljs-string"><span class="hljs-string">"Google"</span></span> -d sql:<span class="hljs-variable"><span class="hljs-variable">$HOME</span></span>/.pki/nssdb -i /etc/certs/google.crt <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> 127.0.0.1 www.google.com | sudo tee -a /etc/hosts sudo node server.js google</code> </pre> <br>  The same result.  I think this is a feature. <br><br>  But in any case, if you don‚Äôt add these certificates to your local storage, you won‚Äôt be able to open sites, because there is no option to continue an insecure connection in Chrome or add an exception in Firefox. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/dae/d44/06c/daed4406c111ea9c96d3d12b04a7d5dc.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/0a2/b0d/1b2/0a2b0d1b2fe197e341551ccc8aef667b.png"><br><br><h1>  Content-Encoding: br </h1><br>  The data is compressed using <a href="https://github.com/google/brotli">Brotli</a> . <br><br>  The algorithm promises better compression than gzip and a comparable unarching speed.  <a href="https://www.chromestatus.com/feature/5420797577396224">Supported by Google Chrome</a> . <br><br>  Of course, for him there is a module in node.js. <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> shrinkRay = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'shrink-ray'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> request = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'request'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> express = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'express'</span></span>) request(<span class="hljs-string"><span class="hljs-string">'https://www.gutenberg.org/files/1342/1342-0.txt'</span></span>, (err, res, text) =&gt; { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (err) <span class="hljs-keyword"><span class="hljs-keyword">throw</span></span> <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Error</span></span>(err) <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> app = express() app.use(shrinkRay()) app.use(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">req, res</span></span></span><span class="hljs-function">) =&gt;</span></span> res.header(<span class="hljs-string"><span class="hljs-string">'content-type'</span></span>, <span class="hljs-string"><span class="hljs-string">'text/plain'</span></span>).send(text)) app.listen(<span class="hljs-number"><span class="hljs-number">1234</span></span>) })</code> </pre> <br>  Initial size: 700 Kb <br>  Brotli: 204 Kb <br>  Gzip: 241 Kb <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6d9/e38/d00/6d9e38d008f7f6b59bde1db852c407ec.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/d1b/bf0/784/d1bbf0784fee4c85257cd33856752340.png"><br><br><h1>  Timing-Allow-Origin </h1><br>  Using the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Resource_Timing_API/Using_the_Resource_Timing_API">Resource Timing API,</a> you can find out how long it took to process resources on a page. <br><br>  Since load time information can be used to determine whether a user has visited a page before (taking note that resources can be cached), the standard is considered vulnerable if such information is given to any hosts. <br><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="javascript"><span class="javascript"> setTimeout(</span><span class="hljs-function"><span class="hljs-keyword"><span class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span></span><span class="javascript"><span class="hljs-function">(</span></span><span class="hljs-params"></span><span class="javascript"><span class="hljs-function"><span class="hljs-params"></span>) </span></span></span><span class="javascript">{ </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">console</span></span></span><span class="javascript">.log(</span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">window</span></span></span><span class="javascript">.performance.getEntriesByType(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">'resource'</span></span></span><span class="javascript">)) }, </span><span class="hljs-number"><span class="javascript"><span class="hljs-number">1000</span></span></span><span class="javascript">) </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">img</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://placehold.it/350x150"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">img</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/local.gif"</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  It seems that if you do not specify <b>Timing-Allow-Origin</b> , then you can get detailed information about the time of operations (domain search, for example) only for resources with one source. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6cd/347/6e5/6cd3476e538418ad2b4a10333b96cbea.png"><br><br>  You can use it like this: <br><br><ul><li>  Timing-Allow-Origin: * <br></li><li>  Timing-Allow-Origin: http://foo.com http://bar.com <br></li></ul><br><h1>  Alt-svc </h1><br>  Alternate Services [Alternative Services] allow resources to be located in different parts of the network and can be accessed using different protocol configurations. <br><br>  This is used by Google: <br><br><ul><li>  alt-svc: quic = ": 443";  ma = 2,592,000;  v = "36,35,34" <br></li></ul><br>  This means that the browser, if it wishes, can use <a href="https://ma.ttias.be/googles-quic-protocol-moving-web-tcp-udp/">QUIC</a> , this is HTTP over UDP, through port 443 for the next 30 days (ma = 2592000 seconds, or 720 hours, that is, 30 days).  I have no idea what the parameter <b>v</b> , version means? <br><br><h1>  P3p </h1><br>  Below are a few P3P headers I have met: <br><br><ul><li>  P3P: CP = "This is not a P3P policy!"  See <a href="https://support.google.com/accounts/answer/151657%3Fhl%3Den">support.google.com/accounts/answer/151657?hl=en</a> for more info. ‚Äù <br></li><li>  P3P: CP = ‚ÄúFacebook does not have a P3P policy.  Learn why here: <a href="http://fb.me/p3p">fb.me/p3p</a> ¬ª <br></li></ul><br>  Some browsers require third party cookies to support the P3P protocol to indicate privacy measures. <br><br>  The organization that founded P3P, the World Wide Web Consortium (W3C), suspended work on the protocol several years ago because modern browsers do not fully support the protocol.  As a result, P3P is outdated and does not include the technologies that are currently used on the network, so most sites do not support P3P. <br><br>  I did not go too deep, but apparently the title is needed for IE8 to accept third party cookies. <br><br>  For example, if privacy setting in IE is high, then all cookies from sites that do not have a compact privacy policy will be blocked, but those that have headers like the ones mentioned above will not be blocked. </div><p>Source: <a href="https://habr.com/ru/post/317720/">https://habr.com/ru/post/317720/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../317710/index.html">Survival Guide for a Western IT Company</a></li>
<li><a href="../317712/index.html">The logic of consciousness. Part 9. Artificial neural networks and minicolumns of the real cortex.</a></li>
<li><a href="../317714/index.html">Immigration with the Crimea to Russia</a></li>
<li><a href="../317716/index.html">Gogland: JetBrains New Go IDE</a></li>
<li><a href="../317718/index.html">Russian software in the offices of companies - current realities and prospects, opinions and experience of experts</a></li>
<li><a href="../317722/index.html">Instructions: How to choose the right indicators for monitoring and optimization, so that IT businesses grow faster</a></li>
<li><a href="../317724/index.html">How Discord processes more than 1,000,000 push requests per minute with Elixir GenStage</a></li>
<li><a href="../317726/index.html">Splitting text into sentences using Tomita Parser</a></li>
<li><a href="../317728/index.html">Button or link?</a></li>
<li><a href="../317730/index.html">How IT professionals work. Maxim Zelinsky, Sberbank-Technology</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>