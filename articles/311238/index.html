<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Google Photos can not delete files from the SD card</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Many Android users are faced with an annoying problem associated with accessing applications to the SD card. One of these applications is Google Photo...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Google Photos can not delete files from the SD card</h1><div class="post__text post__text-html js-mediator-article">  Many Android users are faced with an annoying problem associated with accessing applications to the SD card.  One of these applications is Google Photos.  Once everything was fine.  But in Android 4.4 Google introduced a new system configuration, which prohibits applications from writing to the sd card.  It‚Äôs extremely inconvenient to delete images through the gallery and then delete them in google photos again. <br><br>  For myself, I solved the problem of rutting the device and correcting the configuration.  Details on the video: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/3QjpifxBLs0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      But for ordinary users, everything should work without root.  About how to implement this, I propose to discuss in this article.  I invite representatives of Google, Android developers and all interested in habrakat. <br><a name="habracut"></a><br>  Some users have been deprived of functionality without warning.  I have seen user comments with the following situation.  Previously, they stored photos on the sd card and used google photo without any problems.  Then the phone manufacturer offered to make an OTA update (up to 4.4 or higher), to which users agreed.  But they could not even think that they would lose their functionality.  Now google photo cannot delete snapshots, and in order to relieve the process of managing snapshots, we have to store them in the internal memory, which in itself is painful. <br><br><h1>  What is the matter here </h1><br>  Google has long wanted to prohibit unhindered access to applications to the sd card.  This is explained by the fact that when you delete an application, the system cannot find out which files belong to the application, thus the sd card is cluttered.  And in Android 4.4 google introduced such a thing as SAF (Storage Access Framework).  They prohibited applications from changing anything on the sd card, with the exception of the application‚Äôs personal directory.  And if the application asks, it gives the right to read (but not write) everything on the sd card. <br><br>  Quote <a href="http://www.androidpolice.com/2014/02/17/external-blues-google-has-brought-big-changes-to-sd-cards-in-kitkat-and-even-samsung-may-be-implementing-them/">from here</a> : <br><blockquote>  Just to sum up, here are the options 3rd-party apps have on KitKat: <br>  An app without any permissions: <br>  Automatic backup and automatic storage <br>  With WRITE_EXTERNAL_STORAGE, they also have: <br>  Read the file storage on the primary (built-in) storage <br>  Read (not write) SD card storage </blockquote><br>  That is, for applications that are not pre-installed on the phone, and in my case google photo was not pre-installed, there is no official way to manage files at all!  Google, I do not understand how you could do that.  Do not finish a feature - complete it.  But why in consumer devices to introduce something that does not work yet? <br><br><h1>  What to do in this situation? </h1><br>  As I said above, I have already solved the problem for myself by correcting the system configuration (I need root).  What about "simple" users who haven't heard about root?  I have a few ideas on how to solve this problem.  Some of them are suitable only for Google, and some may be able to implement the community.  So what are the options? <br><br><h2>  Option "Personal Directory" </h2><br>  Google should make it work as far as possible.  It is clear that they can not advise to rant the device.  But what about the private directory /storage/extSdCard/Android/data/com.google.android.apps.photos?  What are they storing there?  Most likely there is not a basket, because the files being deleted into the basket are located in /data/user/0/com.google.android.apps.photos/files/trash_files.  I don‚Äôt know, it‚Äôs not customary in Android to store user data in such directories.  Just offering a working version. <br><br>  Those.  If the application sees that it works on Android 4.4 and does not have access rights, then display a message like ‚ÄúNo access.  We suggest in the settings of your system camera to set the save to the directory /storage/extSdCard/Android/data/com.google.android.apps.photos/DCIM.  Keep in mind that when you delete google photos, all pictures will be deleted. "  The application is now ignoring this directory.  If you put a snapshot into it, the catalog will not appear in the selection list for synchronization. <br><br>  Most likely this is a dead option, since the camera must be systemic (otherwise it will not be able to write to someone else's directory on the sd card), and the system camera will most likely not be able to select the directory to save (on S4 it does not know exactly). <br><br><h2>  Option "Not a bug, but a feature" </h2><br>  But it turns out the developers have found a <a href="http://www.androidpolice.com/2014/04/06/external-blues-redux-apps-still-have-a-loophole-for-writing-to-the-sd-card-on-kitkat-but-for-how-long/">loophole</a> , all the same allowing applications to manipulate files.  I myself checked: I restored the original platform.xml (in which there is no write access to the sd card), rebooted, installed the total commander, and ... Uninstalling works!  And even the <a href="http://www.ghisler.ch/board/viewtopic.php%3Ft%3D34834%26start%3D15">code</a> is. <br><br>  Here the decision is for Google, maybe this decision is unacceptable for them.  But as for me, there is nothing wrong with taking advantage of the bug as a feature, because they have to make everything work. <br><br><h2>  Option "Everything is bad, but you upgrade" </h2><br>  The article says that not all devices will work such a hack.  There's nothing left but to just show the message that there is no access.  The truth in it, you can hint that it would help the root, or the transition to another version of Android, and the older one also comes down. <br><br><h2>  Option "Bookmark" </h2><br>  I also had an idea that Google could update their google services (and this is a system application) so that it could be accessed by a non-system google photos application with a request to delete a file.  And you will not need root.  Will google go for it? <br><br><h2>  Solution for more recent versions of Android </h2><br>  In Android 5.0, google has improved SAF, and now applications can ask the user to provide write access to specific directories. <br><br>  Quote <a href="http://www.androidpolice.com/2014/11/04/android-5-0-makes-sd-cards-great-again-extends-api-to-allow-full-directory-access-automatic-mediastore-and-improves-security/">from here</a> : <br><blockquote>  Access to secondary shared storage devices <br>  In this case, we‚Äôve introduced APIs that make it possible for SD cards. <br><br>  We‚Äôve heard that we‚Äôve added that we‚Äôve added it to the ACTION_OPEN_DOCUMENT_TREE intent.  AppsProvider document, including by the device, is supported by the device.  There is no way for any additional user interaction.  Just like the other document intents, apps can persist this access across reboots. <br><br>  This gives apps accessibility.  You can choose your SD card;  the choice is theirs. </blockquote><br>  But even on Android 5 google photo does not use this feature, but simply reports that it does not have access.  I believe that <b>before synchronizing a directory, an application must first request write access to it via SAF so that snapshots can be deleted</b> .  This can be done directly from the same activity where you select with the switch which directories you want to synchronize (Settings - Startup and Sync - Select folders).  Google, why aren't you doing this? <br><br><h1>  Summarize </h1><br>  <b>This is how the application behaves now:</b> <br><blockquote>  The user pressed the trash can <br>  Is there direct access to write to the sd card? <br>  Yes - delete the picture. <br>  No - print the message that there is no access. </blockquote><br>  <b>It should be:</b> <br><blockquote>  The user pressed the trash can <br>  Is there direct access / through a loophole to write to the sd card? <br>  Yes - delete the picture. <br>  No - then <br>  - We are working on Android 5.0+? <br>  - Yes ‚Äî request access to the directory via SAF and delete the snapshot. <br>  - No - (i.e. most likely it is 4.4. But it can be a specially modified 4.3-, configured as in 4.4) then: <br>  - - Display a message: ‚ÄúNo access, but root or Android version will help you‚Äù or ‚ÄúConfigure the system camera to save pictures in /storage/extSdCard/Android/data/com.google.android.apps.photos/DCIM‚Äù, or ‚ÄúUpdate google servies, we will give access to the record through them‚Äù at the discretion of google. </blockquote><br><h1>  Looking for developers </h1><br>  If there are representatives of google here, pass the information to the developers.  Because this topic has been <a href="https://productforums.google.com/d/msg/photos/qGMRXWax-b8/Fg7EcnOhCAAJ">discussed</a> for a long time, but Google does not correct the situation. <br><br>  And for habrayusers who know how to develop on Android, I want to ask a question.  Is it possible to change the application as I said, but on my own, without waiting for google?  I know about the digital signature discrepancy, but in our case it does not matter.  After all, all this is needed only if the application is not a system.  And if it is not a system one, then you can remove it and then install it with a different signature.  I saw a modified application instead of youtube - OGYouTube.  Perhaps this is just what I describe. <br><br>  Fill out <a href="https://goo.gl/forms/2xT9ePFkIw">this</a> form if you had / have a problem described. <br><br><div class="spoiler">  <b class="spoiler_title">Poll results</b> <div class="spoiler_text">  Number of replies: 101 (at the time of September 20, 2016): <br><img src="https://habrastorage.org/files/23d/62c/6e9/23d62c6e9d3a4eb397992abd8de1b8af.png"><br><img src="https://habrastorage.org/files/f28/14b/d4a/f2814bd4a18b45a5a3af95a20b87b441.png"><br><img src="https://habrastorage.org/files/2aa/214/155/2aa21415576c445588104e68033ef0ab.png"><br><img src="https://habrastorage.org/files/4b5/2b7/547/4b52b75472f048929129512fefa169b3.png"><br><img src="https://habrastorage.org/files/fda/919/285/fda9192853e040d89ea5cc580c82d8c7.png"><br><img src="https://habrastorage.org/files/b98/125/a2c/b98125a2c2aa42c79ebc85be15a46c47.png"><br><img src="https://habrastorage.org/files/995/339/841/995339841e714a09a336a88aeb57a702.png"><br><img src="https://habrastorage.org/files/191/586/17b/19158617bb0043e5a9f1d1f7c6382986.png"><br><img src="https://habrastorage.org/files/351/b5e/ea6/351b5eea6f134c29bc7725c22e0c39ee.png"><br></div></div><br>  On this I think I did my job.  Now google go.  Or community. </div><p>Source: <a href="https://habr.com/ru/post/311238/">https://habr.com/ru/post/311238/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../311226/index.html">JSX: antipattern or not?</a></li>
<li><a href="../311230/index.html">Alexey Igoshin (HomeApp) changes the rules of the game on the Russian real estate market using information technology</a></li>
<li><a href="../311232/index.html">Using autoencoders to build a recommendation system</a></li>
<li><a href="../311234/index.html">learnopengl. Lesson 1.3 - Hello Window</a></li>
<li><a href="../311236/index.html">New NetApp Storage Systems Running ONTAP 9.1</a></li>
<li><a href="../311240/index.html">Change the paradigm of decision making in the IT business or pity your liver</a></li>
<li><a href="../311242/index.html">Microsoft introduced Windows Defender Application Guard protection technology for the Edge web browser</a></li>
<li><a href="../311248/index.html">VIPER Book</a></li>
<li><a href="../311250/index.html">Using drag-and-drop between different Activities in Android 7 Nougat</a></li>
<li><a href="../311252/index.html">Applicants for the Nobel Prize 2016</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>