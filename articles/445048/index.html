<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Delaunay triangulation algorithm using the sweeping line method</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good day! 

 In this article I will describe in detail the algorithm that I got as a result of using the idea of ‚Äã‚Äãa ‚Äúsweeping line‚Äù to construct the ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Delaunay triangulation algorithm using the sweeping line method</h1><div class="post__text post__text-html js-mediator-article">  Good day! <br><br>  In this article I will describe in detail the algorithm that I got as a result of using the idea of ‚Äã‚Äãa ‚Äúsweeping line‚Äù to construct the Delaunay triangulation on the plane.  There are several ideas in it that I have never met anywhere when I read articles about triangulation. <br>  Perhaps someone will also find them unusual.  I will try to do everything in the best traditions and include the following things in the story: a description of the data structures used, a description of the steps of the algorithm, proof of correctness, time estimates, and a comparison with an iterative algorithm using a kD-tree. <br><a name="habracut"></a><br><h2>  Definitions and problem statement </h2><br><h4>  Triangulation </h4><br>  It is said that triangulation is given on the set of points on the plane, if some pairs of points are connected by an edge, any end face in the resulting graph forms a triangle, the edges do not intersect, and the graph is maximal in the number of edges. <br><br><p><img src="https://habrastorage.org/webt/go/f6/x5/gof6x5u4p967b-k_rkp5vur3-wc.png" width="511" height="300"></p>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Delaunay triangulation </h4><br>  Delaunay triangulation is such a triangulation in which for any triangle it is true that there are no points from the original set inside the circle described around it. <br><br><p><img src="https://habrastorage.org/webt/fz/vv/az/fzvvaz-xuli8vyiit6xskbrysfa.png" width="508" height="300"></p><br><br>  <i>Note</i> : for a given set of points in which no 4 points are on the same circle, there is exactly one Delaunay triangulation. <br><br><h4>  Delone condition </h4><br>  Let triangulation be given on a set of points.  We say that a certain subset of points satisfies the Delone condition if the triangulation bounded on this subset is a Delaunay triangulation for it. <br><br><h4>  Criterion for Delaunay Triangulation </h4><br>  The fulfillment of the Delaunay condition for all points forming a quadrilateral in triangulation is equivalent to the fact that this triangulation is a Delaunay triangulation. <br><br>  <i>Note</i> : for nonconvex quadrilaterals, the Delone condition is always satisfied, and for convex quadrangles (whose vertices do not lie on one circle) there are exactly 2 possible triangulations (one of which is the Delaunay triangulation). <br><br><p><img src="https://habrastorage.org/webt/32/qt/bv/32qtbvo-eil1x1o3w5-h86hb_ee.png" width="470" height="300"></p><br><br>  <b>The task is to construct a Delaunay triangulation for a given set of points.</b> <br><br><h2>  Algorithm Description </h2><br><h4>  Visible points and visible edges </h4><br>  Let a minimal convex hull (further MBO) of a finite set of points (edges connecting some of the points so that they form a polygon containing all points of the set) and a point A outside the shell be given.  Then the point of the plane is called visible for point A, if the segment connecting it with point A does not intersect the MBO. <br><br>  The edge of the MVO is said to be visible for point A if its ends are visible for A. <br><br>  In the following image, the edges visible for the red dot are marked in red: <br><br><p><img src="https://habrastorage.org/webt/lv/jz/s9/lvjzs9fxcxn1yqvu4aqdo8mohwy.png" width="456" height="400"></p><br><br>  <i>Note</i> : the Delaunay triangulation contour is the MVO for the points on which it is built. <br><br>  <i>Note 2</i> : in the algorithm, the edges visible for the added point A form a chain, that is, several successive edges of the MVO <br><br><h4>  Storage of triangulation in memory </h4><br>  There are some standard methods, well described in the book Skvortsova [1].  Due to the specifics of the algorithm, I will offer my version.  Since I want to check the 4-gons on the Delone condition, we consider their structure.  Each 4-gon in triangulation consists of 2 triangles with a common edge.  Each edge has exactly 2 triangles adjacent to it.  Thus, each quadrilateral in triangulation is generated by an edge and two vertices located opposite the edge in adjacent triangles. <br>  Since two triangles and their adjacency are reconstructed along the edge and two vertices, we can restore triangulation in all such structures.  Accordingly, it is proposed to store an edge with two vertices in the set and perform a search by edge (an ordered pair of vertices). <br><br><p><img src="https://habrastorage.org/webt/kp/yx/hf/kpyxhfrurcwtwf53gvu37-nkdko.png" width="309" height="200"></p><br><br><h3>  Algorithm </h3><br>  The idea of ‚Äã‚Äãa sweeping straight line is that all points are sorted in one direction, and then processed in turn. <br><br><ol><li>  Sort all points along some straight line (for simplicity by the coordinate <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMATHI-78" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-1"> x </script>  ). </li><li>  Construct a triangle on the first 3 points. <br><br>  Further, for each next point, we will perform steps that preserve the invariant that there is a Delaunay triangulation for already added points and, accordingly, an MBO for them. </li><li>  Add the triangles formed by the visible edges and the point itself (that is, we add edges from the point in question to all the ends of the visible edges). </li><li>  Let us check on the Delone condition all quadrilaterals generated by visible edges.  If somewhere the condition is not fulfilled, then we rebuild the triangulation in the quadrilateral (I remind you that there are only two) and recursively run the test for quadrilaterals generated by the edges of the current quadrilateral (because only in them after changing the Delone condition could be broken). </li></ol><br>  <i>Note</i> : in step (4) with a recursive start, you can not check the quadrilaterals generated by the edges emanating from the point considered at this iteration (there are always two of four).  Most often they will be non-convex, for convex proof is purely geometric, I leave it to the reader.  Further, we assume that only 2 recursive starts are performed for each rebuild. <br><br><h4>  Delone check </h4><br>  Methods for checking quadrilaterals on the Delone condition can be found in the same book [1].  I will only note that when choosing a method with trigonometric functions, if there is an inaccurate implementation, negative sine values ‚Äã‚Äãcan be obtained, it makes sense to take them modulo. <br><br><h4>  Search for visible edges </h4><br>  It remains to understand how to effectively find the visible edges.  Note that the previous added point S is in the MBO at the current iteration, since it has the greatest coordinate <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMATHI-78" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-2"> x </script>  , and also visible for the current point.  Then, noting that the ends of the visible edges form a continuous chain of visible points, we can go from point S in both directions along the MVO and collect the edges while they are visible (the visibility of the edge is checked using the vector product).  Thus, it is convenient to store the MBO as a doubly linked list, at each iteration removing visible edges and adding 2 new ones from the point in question. <br><br><p><img src="https://habrastorage.org/webt/n9/0_/ub/n90_ubf1nbeabdhapitulxvuxgo.png" width="429" height="500"></p><br><br><h4>  The visualization of the algorithm </h4><br>  Two red dots - added and previous.  The red edges at each moment make up the recursion stack from step (4): <br><br><p><img src="https://habrastorage.org/webt/yq/0a/jc/yq0ajcb3zw7403xa4mvtds17xcs.gif"></p><br><br><h2>  Algorithm correctness </h2><br>  To prove the correctness of the algorithm, it suffices to prove the invariant is preserved in steps (3) and (4). <br><br><h4>  Step (3) </h4><br>  After step (3), obviously, we get some triangulation of the current set of points. <br><br><h4>  Step (4) </h4><br>  In the process of executing step (4), all quadrangles that do not satisfy the Delone condition are on the recursion stack (follows from the description), which means that at the end of step (4), all quadrangles satisfy the Delaunay condition, that is, the Delaunay triangulation is indeed constructed.  Then it remains to prove that the process in step (4) will ever end.  This follows from the fact that all edges added during rebuilding come from the current vertex under consideration (that is, in the step <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.211ex" height="2.057ex" viewBox="0 -780.1 521.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMATHI-6B" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-3"> k </script>  they are no more than <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi><mo>&amp;#x2212;</mo><mn>1</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.214ex" height="2.178ex" viewBox="0 -780.1 2244.9 937.7" role="img" focusable="false" style="vertical-align: -0.366ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMATHI-6B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMAIN-2212" x="743" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMAIN-31" x="1744" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>‚àí</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-4"> k-1 </script>  ) and from the fact that after adding these edges we will not consider quadrilaterals generated by them (see previous remark), and therefore, we add no more than once. <br><br><h2>  Time complexity </h2><br>  On average, on a uniform, normal distribution, the algorithm works quite well (the results are given below in the table).  There is an assumption that his time is <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mi>N</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.647ex" height="2.66ex" viewBox="0 -832 4584 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMAIN-28" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMATHI-4E" x="1153" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMATHI-6C" x="2041" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMATHI-6F" x="2340" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMATHI-67" x="2825" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMATHI-4E" x="3306" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMAIN-29" x="4194" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-5"> O (NlogN) </script>  .  In the worst case, there is an estimate. <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.76ex" height="2.901ex" viewBox="0 -935.7 2910.5 1249" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMAIN-28" x="763" y="0"></use><g transform="translate(1153,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMATHI-4E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMAIN-32" x="1292" y="513"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMAIN-29" x="2520" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-6"> O (N ^ 2) </script>  . <br><br><p><img src="https://habrastorage.org/webt/bw/9s/qt/bw9sqtpuuwm9vtnsdcfhhluyaew.png"></p><br><br>  Let's look at the time of work in parts and understand which of them has the greatest impact on the final time: <br><br><h4>  Sort by direction </h4><br>  For sorting we will use the estimate <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mi>N</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.647ex" height="2.66ex" viewBox="0 -832 4584 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMAIN-28" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMATHI-4E" x="1153" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMATHI-6C" x="2041" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMATHI-6F" x="2340" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMATHI-67" x="2825" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMATHI-4E" x="3306" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMAIN-29" x="4194" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-7"> O (NlogN) </script>  . <br><br><h4>  Search for visible edges </h4><br>  To begin with, we show that the total time spent searching for visible edges is <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mi>N</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.646ex" height="2.66ex" viewBox="0 -832 2431 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMAIN-28" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMATHI-4E" x="1153" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMAIN-29" x="2041" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-8"> O (N) </script>  .  Note that at each iteration we find all visible edges and another 2 (the first not visible) in linear time.  In step (3) we add new 2 edges to the MVO.  Thus, in all, in the changing for the duration of the MBO algorithm, no more than <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>2</mn><mi>N</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.226ex" height="2.057ex" viewBox="0 -780.1 1389 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMAIN-32" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMATHI-4E" x="500" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-9"> 2N </script>  edges, which means that there will be no more visible edges <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>2</mn><mi>N</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.226ex" height="2.057ex" viewBox="0 -780.1 1389 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMAIN-32" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMATHI-4E" x="500" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-10"> 2N </script>  .  We will also find <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>2</mn><mi>N</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.226ex" height="2.057ex" viewBox="0 -780.1 1389 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMAIN-32" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMATHI-4E" x="500" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-11"> 2N </script>  edges that are not visible.  Thus, in total there will be no more <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>4</mn><mi>N</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.226ex" height="2.057ex" viewBox="0 -780.1 1389 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMAIN-34" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMATHI-4E" x="500" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>4</mn><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-12"> 4N </script>  edges that corresponds to the time <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mi>N</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.646ex" height="2.66ex" viewBox="0 -832 2431 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMAIN-28" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMATHI-4E" x="1153" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMAIN-29" x="2041" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-13"> O (N) </script>  . <br><br><h4>  Building new triangles </h4><br>  The total time to build triangles from step (3) with visible edges already found, obviously <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mi>N</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.646ex" height="2.66ex" viewBox="0 -832 2431 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMAIN-28" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMATHI-4E" x="1153" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMAIN-29" x="2041" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-14"> O (N) </script>  . <br><br><h4>  Rebuilding triangulation </h4><br>  It remains to deal with step (4).  First, we note that checking the Delone condition and rebuilding if it is not fulfilled are quite expensive actions (although they work for <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.745ex" height="2.66ex" viewBox="0 -832 2043 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMAIN-28" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMAIN-31" x="1153" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMAIN-29" x="1653" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-15"> O (1) </script>  ).  Only on checking the condition of Delone can take about 28 arithmetic operations.  Let's look at the average number of rebuilds during this step.  Practical results on some distributions are given below.  For them, I really want to say that the average number of rebuilds grows at a logarithmic speed, but we will leave it as just an assumption. <br><br><p><img src="https://habrastorage.org/webt/vm/ld/5u/vmld5u3pzetnfsdkyjx2cuhkabg.png"></p><br><br>  Here I also want to note that the average number of rebuilds per point can vary greatly from the direction along which the sorting is performed.  So on a million evenly distributed on a long low rectangle with an aspect ratio of 100,000: 1, this number varies from 1.2 to 24 (these values ‚Äã‚Äãare achieved by sorting the data horizontally and vertically, respectively).  Therefore, I see the sense to choose the direction of sorting in an arbitrary way (in this example, with an arbitrary choice, on average, there were about 2 rebuilds) or to select it manually if the data is known in advance. <br><br>  Thus, the main time of the program usually takes a step (4).  If it is performed quickly, then it makes sense to think about accelerating the sorting. <br><br><h4>  Worst case </h4><br>  At worst on <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.211ex" height="2.057ex" viewBox="0 -780.1 521.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMATHI-6B" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-16"> k </script>  th iteration happens <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>k</mi><mo>&amp;#x2212;</mo><mn>1</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.214ex" height="2.178ex" viewBox="0 -780.1 2244.9 937.7" role="img" focusable="false" style="vertical-align: -0.366ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMATHI-6B" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMAIN-2212" x="743" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMAIN-31" x="1744" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>‚àí</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-17"> k-1 </script>  recursive call in step (4), that is, summing over all i, we get the asymptotics in the worst case <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.76ex" height="2.901ex" viewBox="0 -935.7 2910.5 1249" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMAIN-28" x="763" y="0"></use><g transform="translate(1153,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMATHI-4E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMAIN-32" x="1292" y="513"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMAIN-29" x="2520" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><msup><mi>N</mi><mn>2</mn></msup><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-18"> O (N ^ 2) </script>  .  The following picture illustrates a beautiful example in which the program can work for a long time (1100 rebuildings on average when adding a new point with input data of 10,000 points). <br><br><p><img src="https://habrastorage.org/webt/mq/jm/xe/mqjmxeapcrztwr_rrelmjd9to4e.png" width="355" height="400"></p><br><br><h2>  Comparison with an iterative algorithm for constructing a Delaunay triangulation using a kD-tree </h2><br><h4>  Description of the iterative algorithm </h4><br>  I will briefly describe the above algorithm.  When entering the next point with the help of a kD-tree (I advise you to read about it somewhere, if you do not know) we find a triangle already built close to it.  Then by detour in depth we are looking for a triangle into which the point itself falls.  We finish the edges at the vertices of the found triangle and actually perform step (4) from our algorithm for new quadrangles.  Since a point can be outside of triangulation, for simplicity, it is proposed to cover all points with a large triangle (build it in advance), this will solve the problem. <br><br><h4>  Similarity of algorithms </h4><br>  In fact, if points are added in the order sorted by direction, then our algorithm actually works in the same way as iterative, except that the number of rebuilds is less.  The following animation demonstrates this very well.  The points on it were added from right to left, and all of them are covered with a large triangle, which is subsequently removed. <br><p><img src="https://habrastorage.org/webt/va/hk/hv/vahkhve0ibbfy9mh3daeqcqkxjk.gif"></p><br><br><h4>  Algorithm Differences </h4><br>  In an iterative algorithm, localization of a point (search for the desired triangle) occurs on average for <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi><mo stretchy=&quot;false&quot;>(</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.583ex" height="2.66ex" viewBox="0 -832 3695.5 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMATHI-4F" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMAIN-28" x="763" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMATHI-6C" x="1153" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMATHI-6F" x="1451" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMATHI-67" x="1937" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMATHI-4E" x="2417" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/445048/&amp;xid=25657,15700019,15700186,15700191,15700253,15700256,15700259&amp;usg=ALkJrhiUCOY6UHDxoz_Rv70fCfq4GiFh8g#MJMAIN-29" x="3306" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>l</mi><mi>o</mi><mi>g</mi><mi>N</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-19"> O (logN) </script>  , on the above distributions, on average, 3 rebuilds take place (as shown in [1]) under the condition of an arbitrary order of points supply.  Thus, the sweeping straight line gains time from the iterative algorithm in localization, but loses it in rebuilds (which, I recall, are rather heavy).  In addition, the iterative algorithm works online, which is also its distinguishing feature. <br><br><h2>  Conclusion </h2><br>  Here I just show some interesting triangulations resulting from the operation of the algorithm. <br><br><h4>  Beautiful pattern </h4><br><p><img src="https://habrastorage.org/webt/tm/gz/0w/tmgz0wuwxltnm3qsyylyz_lfbhs.png" width="703" height="600"></p><br><br><h4>  Normal distribution, 1000 points </h4><br><p><img src="https://habrastorage.org/webt/gu/1g/ga/gu1ggatmijtapwt1macmzovasuo.png" width="648" height="600"></p><br><br><h4>  Uniform distribution, 1000 points </h4><br><p><img src="https://habrastorage.org/webt/vt/er/mn/vtermnwtifbyshrnan2nckbkqqw.png" width="686" height="600"></p><br><br><h4>  Triangulation, built on the locations of all cities of Russia </h4><br><p><img src="https://habrastorage.org/webt/tz/fw/bj/tzfwbjwjhaevthspbs3gsxv89oy.png"></p><br><p><img src="https://habrastorage.org/webt/ex/fw/9e/exfw9epur4gydutw6ok3dxpt1vc.png"></p><br><br>  Here you can see an example of my code for this algorithm: <br>  <a href="https://github.com/Vemmy124/Delaunay-Triangulation-Algorithm">github.com/Vemmy124/Delaunay-Triangulation-Algorithm</a> <br><br>  <b>Thanks for attention!</b> <br><br><h3>  Literature </h3><br>  [1] Skvortsov A.V.  Delaunay triangulation and its application.  - Tomsk: Publishing house Tom.  University, 2002. - 128 p.  ISBN 5-7511-1501-5 </div><p>Source: <a href="https://habr.com/ru/post/445048/">https://habr.com/ru/post/445048/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../445036/index.html">What was the first iPhone?</a></li>
<li><a href="../445038/index.html">Leaks of secret information found in 100,000 repositories on GitHub</a></li>
<li><a href="../445040/index.html">We build models, ‚Äúsell‚Äù management knowledge management and correct the survivor‚Äôs mistake.</a></li>
<li><a href="../445042/index.html">Delphic programmer success story from Ulan-Ude</a></li>
<li><a href="../445044/index.html">Go application in production systems. Validators</a></li>
<li><a href="../445052/index.html">Why it is impossible to set the font size of the visited link</a></li>
<li><a href="../445054/index.html">Now AI classifies lung cancer as well as laboratory diagnostics specialists.</a></li>
<li><a href="../445056/index.html">Review of web development courses</a></li>
<li><a href="../445058/index.html">Tesla autopilot learned to determine the change of the strip of neighboring cars</a></li>
<li><a href="../445060/index.html">Organize data retrieval using Spring Data Key-Value Repositories</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>