<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Why is everything: the answer to Yandex from the developers of Shop-Script</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We are the developers of the script of the online store Shop-Script , which, willy-nilly, became implicated in yesterday's story that Yandex indexed t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Why is everything: the answer to Yandex from the developers of Shop-Script</h1><div class="post__text post__text-html js-mediator-article">  We are the developers of the script of the online store <a href="http://www.shop-script.ru/">Shop-Script</a> , which, willy-nilly, became implicated in yesterday's story that Yandex <a href="http://habrahabr.ru/blogs/infosecurity/124898/">indexed the</a> private data of customers of many online stores.  The article dealt with stores operating on the basis of the Shop-Script engine.  I understand that I can get a lot of angry criticism from those who believe that the fault is completely on the engine developer, however, I consider it necessary to reflect our position and I will try to objectively describe what happened, discuss possible solutions. <br><br>  Yesterday, of course, it was unexpected to find out about the current situation.  The first thing we did was to check if all stores were subject to this problem.  It turned out that not all.  There was a suggestion that the problem could be in stores that installed any plugin or third-party server module.  But it turned out that this was not the case.  All stores that have pages with private customer data appeared in Yandex search results were united by one thing - the <i>installed Yandex.Metrica code</i> .  Exactly, as in the <a href="http://habrahabr.ru/blogs/infosecurity/124387/">recent</a> case with MegaFon. <br><br>  Next is about where the links to private pages came from, and how they could get into the Yandex index, the magnitude of the problem and possible solutions. <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The problem was the following: <br><ol><li>  In the online store based on Shop-Script you can place an order without mandatory registration.  That is, without entering a username and password. </li><li>  After an order is placed, a notification about the order is sent to the buyer via e-mail, in which there is a direct link to the page with detailed information about the order, its status, the ability to pay for the order and see its processing history.  Since the order is issued by an unregistered user, this page is opened by the link from the notification letter (in the link, authentication occurs by a hash, in which all parameters are passed, of course, in a GET request).  No password is requested from the user, as there is no password in this context.  Requiring registration for ordering in the online store, you see, is completely inconvenient for the buyer, and you need to show him the page with the history of the order. </li><li>  Yandex indexed such pages.  More precisely, the pages that were visited by buyers (clicked on the links from the letters of notification). </li><li>  Google and other search engines indexed the same pages after the information about it appeared in the news feeds on Habr√© and became ‚Äúpublic domain‚Äù. </li></ol><br>  Operational decision, we did the following: screwed user authorization by last name.  If the user followed the link from the order-notification letter, we first ask him for the last name, and only if he entered it correctly, we show information about the order.  Of course, you can say that this is also not a very beautiful solution, however, in this case it is the only parameter on which you could ‚Äúrely‚Äù.  Plus, we added a redirect that ‚Äúeats‚Äù all the ‚Äúproblematic‚Äù GET parameters at once, without giving them Yandex.Metrica (more on this later in the post).  The patch and the updated version are <a href="http://blog.webasyst.ru/shop-script-private-data-indexed-problem-summer-2011/">published</a> in a blog on our site. <br><br>  Now the fun part.  From where Yandex could learn about the addresses (URL), which were sent only to the user personally by e-mail?  Since all the affected online stores have one common feature - the installed Yandex.Metrica code - it is easy to conclude that the addresses that Yandex.Metrica fixes went to the general Yandex index.  These addresses have never been publicly documented on the side of the online store Shop-Script, so it would be wrong to say that the addresses are in public sources.  <a href="">Yandex's answer</a> with five points about how Yandex can learn about the new page, we read, but did not find the answer to this question.  Now, of course, it is obvious how the addresses were ‚Äúmerged‚Äù, and, of course, we will take this into account in the future.  (By the way, many thanks to the author of the <a href="">first comment</a> in the discussion ‚ÄúWhy is everything‚Äù on the Yandex website for its constructiveness and good examples.) <br><br>  The scale of the current situation lies in the fact that the practice of passing authentication parameters as GET parameters in a letter or in any case is used very widely.  And this means that cases like the case of MegaFon and ours can and will arise in the future with other sites, engines and services.  This is obvious and is only a matter of time.  The case of "Megaphone" paid good attention to this problem. <br><br>  Take, for example, at least common services of online tracing of parcels by shipment number.  The sender of the parcel is not registered on the site, and simply receives the address on the trace page, for example, by e-mail.  You can add the address to your favorites in order to check the status regularly (I, for example, do this all the time), you can send to the recipient.  At the same time, it cannot be said that a similar system of online tracing of shipments is a priori incorrectly constructed, because it does not require the user to enter authorization data - in this case, there is no username and password.  Do not force the sender to receive an account on the Post of Russia. <br><br>  Examples of notifications when the user receives an e-mail link that leads directly to the account (with automatic authorization) can be found on the Internet in abundance.  As far as I know, the Yandex My Circle service uses such a system to authorize users. <br><br>  Now let's talk about the solution. <br><br>  As in the case of Megaphone, the main omission of the developers was called the incorrectly formed (or missing) robots.txt file.  I agree that the presence of correct instructions in the file in this case would help to prevent the problem, however, in a general sense, this is an incomplete solution, since robots.txt is just instructions of a recommendatory, not a prescriptive nature.  It‚Äôs good that robots.txt take the search bots into account today, but how this will be handled in the future is an open question.  Suddenly something in the bot will break.  Or the bot will not search ... <br><br>  In this regard, the issue can be completely (in the most general case) solved, of course, only by introducing a mandatory user authorization to view all private pages.  In cases where this is unacceptable, and the user needs to immediately show some private information immediately after clicking on a link with explicitly specified GET parameters (as in the example of sending tracing), it is technically reasonable to immediately PHP link to the page after clicking on the link without these parameters, memorizing them in session.  This will allow not to bring the parameters to the JS-counter installed on the page (Yandex.Metric, Google Analytics, whatever it is) - and I would recommend that developers pay attention to this, make such redirects in their projects.  However, this is also a partial solution, because suddenly the address will be noticed before the redirect by the installed bar or browser plugin.  Well, or introduce additional authorization by indirect parameters (as was done with checking the name) ... <br><br>  I do not make any accusations, however, I believe that Yandex should review the method of adding new addresses to the general search index and abolish the practice of turning any address visited by a user into a public one, no matter how tricky this address was recorded.  This practice is at least <i>unethical</i> .  And do it better as soon as possible, until the problem has become too massive. <br><br>  Learn from the mistakes of others, and try to do it on time.  Thanks for attention. <br><br>  <strong>UPD:</strong> It seems the problem is only gaining momentum.  Now, here, train tickets: <a href="http://news.yandex.ru/yandsearch%3Fcl4url%3Dwww.ria.ru%252Fsociety%252F20110725%252F407118103.html">http://news.yandex.ru/yandsearch?cl4url=www.ria.ru%2Fsociety%2F20110725%2F407118103.html</a> </div><p>Source: <a href="https://habr.com/ru/post/124968/">https://habr.com/ru/post/124968/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../124957/index.html">For whom the counter is created or ...</a></li>
<li><a href="../124963/index.html">Calculations with a floating point at a compilation stage</a></li>
<li><a href="../124964/index.html">Receipt of a Range object copied from Excel to the clipboard via IMoniker</a></li>
<li><a href="../124965/index.html">What is consulting about? And for what?</a></li>
<li><a href="../124966/index.html">The strange behavior of the dev server when using the GAE Plugin for Eclipse Indigo (3.7)</a></li>
<li><a href="../124969/index.html">Is there life on the site?</a></li>
<li><a href="../124970/index.html">Intel Data Center Tour</a></li>
<li><a href="../124972/index.html">Create a match-3 game using Flash and ActionScript</a></li>
<li><a href="../124974/index.html">Objective-C: a rubist look</a></li>
<li><a href="../124975/index.html">Google +1 plus has gone on sale: what will come of the social network crossing with a search</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>