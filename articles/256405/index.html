<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Interview with Serge</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="We bring to your attention the interview with Sergey Semenov aka Serge (on Habr√© ion2 ), one of the most productive developers in the KolibriOS projec...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Interview with Serge</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/332/ac0/97c/332ac097cb7bfba245943a942c69f564.png" align="left">  We bring to your attention the interview with <b>Sergey Semenov</b> aka <b>Serge</b> (on Habr√© <a href="http://habrahabr.ru/users/ion2/" class="user_link">ion2</a> ), one of the most productive developers in the KolibriOS project. <br><a name="habracut"></a><br>  The interview was conducted by <b>Sergei Kuzmin</b> aka <b>Wildwest</b> (on Habr√© <a href="http://habrahabr.ru/users/w__w/" class="user_link">W__W</a> ) <br><br>  <b>Do you have a hobby?</b> <br><br>  Once I pasted ships and airplanes.  Now the hobby has become programming iron, reading documentation and studying someone else's code. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>How and when did you become interested in computers and programming?</b>  <b>What books were helpful to you?</b> <br><br>  At first there were programmable calculators and the first articles in the journal "Science and Life".  It was 1985.  Before that, the home computer seemed to me as unreal as a flight to the moon.  Then came the Spark 1080, in which I studied assembler 8080. <br>  From the books ‚ÄúSimple and Clear about Borland C ++‚Äù, excellent ‚ÄúLearn Yourself Programming in Windows for 21 Days‚Äù by Charles Calvert, our ‚ÄúC Programming Language for Personal Computer‚Äù and ‚ÄúUsing Turbo Assembler when developing programs‚Äù.  Of course, ‚ÄúProgramming at the hardware level‚Äù of Kulakov and two dozen other books, Straustrup among them.  But the honorary place on the bookshelf is occupied by the three volumes of the IA-32 Intel Architecture Software Developer's Manual and the optimization guide.  There was a time when Intel sent these bricks all over the world. <br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text">  Warm lamp manuals to <br><img src="https://habrastorage.org/files/b5b/1e8/c3a/b5b1e8c3ab1b4f6d9187fc8314ce1665.JPG"><br><br>  and after the update <br><img src="https://habrastorage.org/files/8bd/50e/b7a/8bd50eb7adbf429c8ebc2e872df4036b.JPG"><br></div></div><br>  <b>What OS did you try?</b>  <b>What is your home, work and favorite OS?</b> <br><br>  DOS 3.0, 4.0, 5.0 and almost all of Windows: 3.1, 95, 95OSR2, 98, NT4.0, XP, Win7. <br>  It is now worth 8.1. It suits me perfectly, but it was more convenient to reload into Hummingbirds from previous ones.  I also used different Linux and settled on the Debian Jessie and KDE desktop. <br><br>  <b>What programming languages ‚Äã‚Äãdo you know and why did you learn them?</b>  <b>Which ones do you like more than others and why?</b> <br><br>  The courses at the university were introduced to <a href="http://en.wikipedia.org/wiki/PL/M">PL / M</a> , and the school was tortured with Yershol.  The institute was an obligatory fortran, at work <a href="http://en.wikipedia.org/wiki/Clarion_(programming_language)">Clarion</a> 2.0.  I used <a href="http://en.wikipedia.org/wiki/Turbo_Pascal">Borland Pascal 7.0 for a</a> while, but then I got tired of this terrible syntax and switched to <a href="https://en.wikipedia.org/wiki/C_(programming_language)">C.</a>  Since then, 20 years have passed. <br><br>  <b>What can you say about your projects (previous and current) that are not related to KolibriOS?</b> <br><br>  Now there are no such. <br><br>  <b>How and when did you find KolibriOS?</b>  <b>Did he immediately start developing for her?</b>  <b>Why do you program for it?</b> <br><br>  In 2001, Computerra had a <a href="http://compulenta.computerra.ru/archive/os/127017/">little note about MenuetOS</a> .  Probably they wrote about some other Menuet, because the freshly pumped 0.38 terribly slowed down and looked scary.  From time to time I checked new versions, until in 2006 I came across a Hummingbird.  The new system was much prettier in appearance and worked faster.  Then I got to the forum and got into the discussion about processing IRQ.  Someone was wrong again.  So it sucked.  I have always been interested in playing with iron.  Hummingbirds are convenient because there are no complex HAL layers between the core and the iron.  Everything is very simple, visual and the kernel is compiled and loaded instantly.  This is important when doing it a hundred times. <br><br>  <b>What did you do and do in the KolibriOS project?</b>  <b>Describe the current state of your projects and their history.</b> <br><br>  The first project was the sound subsystem.  At Hummingbird, there was an ac97wav player by <b>Ivan Poddubny</b> , which worked directly with the controller and codec.  The problem was that the program could not process interrupts from the controller and the sound went with clicks, and secondly it was the exclusive access to the hardware.  It was necessary to make a downloadable driver and a system mixer, so that several programs could simultaneously produce sound.  There were no special problems with the controller driver for the AC97, although it was stupid to burn headphones, but I had to test the code in unreal mode DOS, because the kernel had zero support for loadable drivers.  It was impossible to allocate virtual memory in the kernel, zamapit physical page to the desired address, set the IRQ handler, etc.  There was not even an internal function to download the file.  I had to do it through a call to the kernel 0x40.  As a result, I had to write page and virtual memory management, a driver loader, redo the IRQ processing, before the sound appeared in the Hummingbird. <br>  The second big job, still unfinished, was overcoming the legacy of the ‚Äúhard Finnish past.‚Äù  First, in the Codex code, symbolic variable names were not used.  In the early revisions, Hummingbirds had to wade through <br><blockquote>  mov eax, [0xFE00] <br>  shr eax, 1 <br>  mov [0xFB0A], ax <br>  mov eax, [0xFE04] <br>  shr eax, 1 <br>  mov [0xFB0C], ax <br></blockquote><br>  or <br><blockquote><br>  mov edi, [0x3004];  the last process (number) <br>  movzx esi, word [0xC400 + edi * 2] <br>  shl esi, 5 <br>  add esi, window_data <br></blockquote><br>  Secondly, the ‚Äúsmall assembler core‚Äù was eating memory in completely wild quantities.  For a byte variable, typical allocation of a kilobyte was typical; for a buffer of tens of kilobytes, the addresses were absolute, so they were aligned to beautiful round values.  It was all from poverty.  If the kernel is not able to dynamically allocate memory, it remains to reserve statically and with a margin.  Gradually, all absolute addresses were replaced by symbolic labels and the appetite of the kernel was reduced by about three times. <br>  There were also a lot of small and not so much changes in the core and an endless epic with video cards.  First there was an assembler driver for the ATI R100-R500, which included hardware cursors.  Then AMD introduced <a href="http://www.x.org/wiki/radeonhd">radeonhd</a> and in Kolibri it became possible to change the video mode.  After a few months, the Linux kernel followed the Hummingbird :-) transferred to KMS and the new driver was ported again.  At the end of '11, a driver for the i915 appeared, and after two years, the Mesa driver i965 and the first ‚Äúiron‚Äù gears spun.  At the same time, ffmpeg was ported and a video player based on it was made.  + Ported several popular libraries: <a href="http://websvn.kolibrios.org/listing.php%3Frepname%3DKolibri%2BOS%26path%3D%252Fcontrib%252Fsdk%252Fsources%252Fcairo%252F%26">cairo</a> , <a href="http://websvn.kolibrios.org/listing.php%3Frepname%3DKolibri%2BOS%26path%3D%252Fcontrib%252Fsdk%252Fsources%252Ffreetype%252F%26">freetype</a> , <a href="http://websvn.kolibrios.org/listing.php%3Frepname%3DKolibri%2BOS%26path%3D%252Fcontrib%252Fsdk%252Fsources%252Flibpng%252F%26">libpng</a> , <a href="http://websvn.kolibrios.org/listing.php%3Frepname%3DKolibri%2BOS%26path%3D%252Fcontrib%252Fsdk%252Fsources%252Fzlib%252F%26">zlib</a> , <a href="http://websvn.kolibrios.org/listing.php%3Frepname%3DKolibri%2BOS%26path%3D%252Fcontrib%252Fsdk%252Fsources%252FMesa%252F%26">mesa</a> .  The last project was <a href="http://websvn.kolibrios.org/listing.php%3Frepname%3DKolibri%2BOS%26path%3D%252Fprograms%252Fdevelop%252Fbinutils%252F%26">binutils</a> : ar as ld objcopy strip, all you need to link directly to Kolibri. <br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text">  <a href="http://board.kolibrios.org/viewtopic.php%3Ff%3D38%26t%3D1277">FPlay</a> video player <br><img src="https://habrastorage.org/files/608/c81/553/608c81553db349909bcaa82ef081c4c8.png"><br><br>  Demo <a href="http://board.kolibrios.org/viewtopic.php%3Ff%3D24%26t%3D1674">Cairo</a> <br><img src="https://habrastorage.org/files/9b5/4fd/ab0/9b54fdab0c054c66862068a973a5f4db.png"><br><br>  Built-in Kolibri font (left) vs Droid Sans Mono and FreeType 2.5 <br><img src="https://habrastorage.org/files/310/24b/91d/31024b91dd1947ec8398a6c1b5be7115.png"><br></div></div><br>  <b>Tell me about the kernel kernels you are developing.</b> <br><br>  kolibri-acpi is more correct to call kolibri-next.  Here the code is tested before being included in the main core. <br><br>  Kolibri-process - improved support for multi-threaded applications.  Changes are uploaded to the main core, the branch is removed as unnecessary. <br><br>  kolibri_pe - history and motives better read on the forum.  The initial part of the work was successfully completed.  The kernel code in C and assembler was linked using ld in a PE DLL with a fixed base address.  The kernel was loaded with GRUB, jumped from protected in real mode, showed our favorite blue boot screen with a choice of options, turned on the graphics mode and returned to the protected mode.  The first nail in the project cover was hammered by AMD.  A redonehd driver appeared, which I immediately switched to.  The second nail was from CCP Games. <br><br>  <b>The results are presented on the project's <a href="http://ftp.kolibrios.org/users/Serge/new/">FTP server</a> , in a nightly build.</b>  <b>Which of these projects was the most difficult?</b> <br><br>  Porting Doom.  There was already a version for the Minuet, so the work seemed not too complicated, the main task was to add sound.  But the damn program crashed after the download and it was completely incomprehensible what was the matter.  I had to tinker with debugging for a week before it turned out that id Software and Open Watcom determine sizeof (bool) differently.  Then everything went like clockwork. <br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text">  Port <a href="http://board.kolibrios.org/viewtopic.php%3Ff%3D41%26t%3D1205">doom</a> <br><img src="https://habrastorage.org/files/ca0/613/b2b/ca0613b2b1f844aeaa4fa4e1839658ab.png"><br></div></div><br>  <b>You programmed for devices from different companies, read the documentation.</b>  <b>Were there any difficult moments when there was a limitation on the part of the iron or of the OS?</b> <br><br>  Hummingbirds do not have ACPI and Device Manager support.  This creates many problems.  For example, the kernel still handles interrupts in the prehistoric 8259A mode, and the BIOS often assigns common IRQ lines to different PCI devices.  In theory, such a separation of lines should work, but in real life it is not.  The kernel can work in the APIC mode, but this requires some preparatory actions from the user and, unfortunately, a positive result is not guaranteed. <br>  The enumeration of devices on the PCI bus gives information about the resources used, but without ACPI it is incomplete.  Sometimes devices (i915 Gen3 gpu) require an unoccupied range of physical addresses, and the kernel does not have enough data to back it up.  And then there is the ancient SoundBlaster, capable of working only in the first 16Mb, and for it you have to statically reserve memory. <br><br>  <b>Drivers for sound and video cards, library porting, video player ... What's next?</b> <br><br>  Plans for 3D drivers for AMD Radeon and hardware video decoding in Fplay.  Unfortunately, there are several obstacles along the way.  Fplay uses ffmpeg, and its developers are not very friendly with the developers of VAAPI and libVA, probably because the latter have their own gstreamer.  On the other hand, ffmpeg does everything perfectly with vdpau, so the decoder will work on the Radeon as soon as r600 and radeonsi are ready for Galluim3D.  But they depend on llvm, and porting llvm instead of the expected code generates ... It is not known exactly what and how llvm generates, because tracing a twenty-megabyte binary is a bit difficult without a debugger with source code support. <br><br>  <b>Often, newbies come and ask about rewriting individual parts of the OS, porting to other hardware platforms.</b>  <b>From time to time even <i>forklung</i> single developers appear, for example from <i>mike.dld</i> , <i>art_zh</i> , etc.</b>  <b>How do you feel about this?</b> <br><br>  I am calm.  I started the fork myself, and then I quit. <br><br>  <b>Is compatibility with hardware platforms or other operating systems important for KolibriOS?</b> <br><br>  Hummingbird assembly system for x86.  It hardly makes sense to talk about other hardware platforms. <br><br>  <b>You basically write and port programs in C ++.</b>  <b>What tools do you use in development?</b> <br><br>  We have a <a href="">ghc</a> -4.8.2 and binutils-2.24 based <a href="">toolchain</a> in Windows and Linux versions and a small set of necessary libraries, including libstdc ++. <br><br>  <b>Is it often necessary to edit the standard compiler libraries by adding missing functions?</b>  <b>How fully is POSIX supported?</b> <br><br>  C / C ++ programs use <a href="http://board.kolibrios.org/viewtopic.php%3Ff%3D24%26t%3D1587">newlib</a> as a standard library.  It all started with a video player based on ffpmeg.  The first version had the minimum required number of functions.  With each new project, I add the required functions to newlib.  This is of course wrong, but porting the standard library is quite a tedious task.  In menuetlibc POSIX is supported in a larger volume.  In general, all the difficulties with POSIX are surmountable, it takes a little perseverance and patience. <br><br>  <b>Can you give any advice to aspiring programmers?</b>  <b>What languages ‚Äã‚Äãshould I try?</b>  <b>What advise developers of new OS?</b>  <b>How to start?</b>  <b>What textbooks to read?</b> <br><br>  Previously, I would advise you to examine the assembler for the target platform in order to understand what your code will eventually turn into.  And now everything is cross-platform, interpretable and unknown on what it will be executed.  But for OS developers, there are a few tips: <br><ol><li>  Join an existing project or find like-minded people.  Three heads are four times better than one. </li><li>  You should not start development with a microkernel, especially alone.  It will be harder for you to develop drivers and applications. </li><li>  When you come up with your ‚Äúunique, unparalleled API,‚Äù think about POSIX.  Sooner or later you will need compatibility. </li></ol><br><br>  Well, now I want to ask you, our readers, on what topics related to Hummingbird, would you like to see the articles? </div><p>Source: <a href="https://habr.com/ru/post/256405/">https://habr.com/ru/post/256405/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../256389/index.html">Scrum sprint simulation. We solve problems of interaction with the client and within the team.</a></li>
<li><a href="../256393/index.html">How to make Xamarin Studio a little better?</a></li>
<li><a href="../256397/index.html">Transferring a project from iOS designers to developers</a></li>
<li><a href="../256401/index.html">Compare Visual Studio Community 2013 with Visual Studio 2013 Express. Features of the license agreement</a></li>
<li><a href="../256403/index.html">We unify the behavior of LINQ to IEnumerable and LINQ to IQueriable in terms of working with null values. Part two. Its implementation of IQueryProvider</a></li>
<li><a href="../256407/index.html">Worm apples [WITHOUT JailBreak]</a></li>
<li><a href="../256409/index.html">New graphics mode: CGA in 1024 colors</a></li>
<li><a href="../256411/index.html">Interference: as a tram, radar detector and poorly crimped cable can affect the satellite channel</a></li>
<li><a href="../256413/index.html">Analysis of weather station data based on Arduino</a></li>
<li><a href="../256415/index.html">Overview of Wireframesketcher features on the example of creating a site layout</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>