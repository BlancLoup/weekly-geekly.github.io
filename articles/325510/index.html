<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Teach TensorFlow to draw Cyrillic</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi Habr! In recent years, new approaches to learning neural networks have significantly expanded the scope of practical application of machine learnin...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Teach TensorFlow to draw Cyrillic</h1><div class="post__text post__text-html js-mediator-article">  Hi Habr!  In recent years, new approaches to learning neural networks have significantly expanded the scope of practical application of machine learning.  And the emergence of a large number of good high-level libraries provided an opportunity to test their skills to specialists of different levels of training. <br><br>  Having some experience in machine learning, I have so far not dealt specifically with neural networks.  In the wake of their rapid popularity, it was decided to fill this gap and at the same time try to write an article about it. <br><br>  I set myself two goals.  The first is to come up with a task that is complex enough to deal with problems arising in real life when solving it.  And second, to solve this problem with the use of one of the modern libraries, having understood the peculiarities of working with them. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      TensorFlow was chosen as a library.  And for the task and its solution, I ask under the cat ... <br><a name="habracut"></a><br><h3>  Task selection </h3><br>  Trying to come up with a task, I was guided by the following considerations: <br><br><ul><li>  This should be something more complicated and interesting than the standard <a href="https://www.tensorflow.org/get_started/mnist/beginners">MNIST</a> classification, as I was looking for opportunities to face the specific features of neural network training; </li><li>  A forward feed neural network was planned as an architecture, since familiarity is always better to start with simple things; </li><li>  Training should work fast enough on a regular gaming video card, since everything was done in free time from the main work. </li></ul><br>  Wandering through the internet and studying the material, I, among other things, came across the following articles: <br><br><ul><li>  <a href="https://habr.com/ru/post/325510/">[1]</a> A neural algorithm of artistic style <a href="http://arxiv.org/abs/1508.06576">[arXiv]</a> which presents an image processing approach in the style of famous artists.  The development of this direction later led to the emergence of the popular service Prisma; </li><li>  <a href="https://habr.com/ru/post/325510/">[2]</a> Learning to Generate Chairs, Tables and Cars with Convolutional Networks <a href="">[arXiv]</a> in which a method for generating images, in particular chairs, according to specified parameters such as color or angle of view, is proposed. </li></ul><br>  These articles, as well as the requirement for learning speed, prompted me to the idea of ‚Äã‚Äãthe problem. <br><br><h3>  Task </h3><br>  For most fonts available on the web, only Latin versions exist.  And what if using only images of Latin letters to restore its Cyrillic version while maintaining the original style? <br><br>  Immediately make a reservation, I did not set out to make the final product ready for use in publishing.  My goal was to learn how to work with neural networks.  Therefore, I limited myself to working with raster images of 64 √ó 64 pixels. <br><br><h3>  Library selection </h3><br>  Among the existing <a href="http://deeplearning.net/software_links/">zoo of</a> packages and libraries, my choice fell on <a href="https://tensorflow.org/">TensorFlow</a> for the following reasons: <br><br><ul><li>  The library is rather low-level in comparison, for example, with <a href="https://keras.io/">Keras</a> , which on the one hand promised some amount of sample code, and on the other hand the possibility to sort out the details and try non-standard architectures; </li><li>  TensorFlow supports multi-machine / video learning.  Therefore, the acquired skills of working with the library can be useful on real practical problems; </li><li>  The <a href="https://www.tensorflow.org/get_started/summaries_and_tensorboard">TensorBoard</a> tool in TensorFlow makes it easy to follow the learning process online.  Among other things, this made it possible to detect errors in the code in the early stages of learning and not to waste time on obviously bad architectures and parameter sets. </li></ul><br><h3>  Network architecture </h3><br>  All fonts have individual features.  An ordinary user will soon remember about italics or thickness, and a specialist in typographer will not forget about antiques, grotesques and other beautiful words. <br><br>  Such individual characteristics are difficult to formalize.  When learning neural networks, a typical approach to solving this problem is to use an embedding layer.  In short, an attempt is made to match a one-dimensional number vector to the object being modeled.  The semantics of the individual components of the vector will remain unknown, however, oddly enough, the whole vector allows to model the object in the context of the task.  The most famous example of this approach is the <a href="http://mccormickml.com/2016/04/19/word2vec-tutorial-the-skip-gram-model/">Word2Vec</a> model. <br><br>  I decided to match each font vector <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.279ex" height="2.419ex" viewBox="0 -780.1 550.5 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-66" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-1"> f </script>  and each letter is a vector <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>l</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.693ex" height="2.057ex" viewBox="0 -780.1 298.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-6C" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi></math></span></span><script type="math/tex" id="MathJax-Element-2"> l </script>  .  Picture <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>I</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.172ex" height="2.057ex" viewBox="0 -780.1 504.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-49" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>I</mi></math></span></span><script type="math/tex" id="MathJax-Element-3"> I </script>  specific letters for this font is obtained using a neural network <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>G</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.827ex" height="2.057ex" viewBox="0 -780.1 786.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-47" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi></math></span></span><script type="math/tex" id="MathJax-Element-4"> G </script>  The input to which is fed two vectors corresponding to the font and letter. <br><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mi>I</mi><mo>=</mo><mi>G</mi><mo stretchy=&quot;false&quot;>[</mo><mi>f</mi><mo>,</mo><mi>l</mi><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.396ex" height="2.66ex" viewBox="0 -832 4476.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-49" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMAIN-3D" x="782" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-47" x="1838" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMAIN-5B" x="2625" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-66" x="2903" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMAIN-2C" x="3454" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-6C" x="3899" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMAIN-5D" x="4197" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>I</mi><mo>=</mo><mi>G</mi><mo stretchy="false">[</mo><mi>f</mi><mo>,</mo><mi>l</mi><mo stretchy="false">]</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-5"> I = G [f, l] </script></p>  It is important to note that the same vector <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>l</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="0.693ex" height="2.057ex" viewBox="0 -780.1 298.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-6C" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi></math></span></span><script type="math/tex" id="MathJax-Element-6"> l </script>  used when constructing images of a single letter in different font styles (similarly for a separate font). <br><div style="text-align:center;"><img src="https://habrastorage.org/files/ff4/518/069/ff4518069d204d8a8b290f31fd8ab02c.png"></div><br>  As a network <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>G</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.827ex" height="2.057ex" viewBox="0 -780.1 786.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-47" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi></math></span></span><script type="math/tex" id="MathJax-Element-7"> G </script>  a deconvolution neural network acts.  The image above is taken from the <a href="https://blog.openai.com/generative-models/">openai.com</a> blog for a demonstration.  More detail about the deployment operation used and the number of layers in the network will be discussed later. <br><br><h3>  Model training </h3><br>  Learning set <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>T</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.636ex" height="2.057ex" viewBox="0 -780.1 704.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-54" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>T</mi></math></span></span><script type="math/tex" id="MathJax-Element-8"> T </script>  consists of images of Russian and Latin letters.  For each image, the letter and font used is known. <br><div style="text-align:center;"><img src="https://habrastorage.org/files/5be/a13/ffe/5bea13ffe87943b7ba81bcde9142c06a.png"></div><br>  At the training stage, we are looking for network weights <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>G</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.827ex" height="2.057ex" viewBox="0 -780.1 786.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-47" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi></math></span></span><script type="math/tex" id="MathJax-Element-9"> G </script>  and embedding vectors for all letters and fonts from the training set using one of the variations of the stochastic gradient method. <br><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><mtext>&amp;#xA0;</mtext><mi>u</mi><mi>n</mi><mi>d</mi><mi>e</mi><mi>r</mi><mi>s</mi><mi>e</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>G</mi><mo>,</mo><mi>l</mi><mo>,</mo><mi>f</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>&amp;#xA0;</mtext><mi>a</mi><mi>r</mi><mi>g</mi><mtext>&amp;#xA0;</mtext><mi>m</mi><mi>i</mi><mi>n</mi></mrow><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>u</mi><msub><mi>m</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>I</mi><mtext>&amp;#xA0;</mtext><mi>i</mi><mi>n</mi><mi>T</mi></mrow></msub><mi>L</mi><mo stretchy=&quot;false&quot;>(</mo><mi>I</mi><mo>,</mo><mi>G</mi><mo stretchy=&quot;false&quot;>[</mo><msub><mi>f</mi><mi>I</mi></msub><mo>,</mo><msub><mi>l</mi><mi>I</mi></msub><mo stretchy=&quot;false&quot;>]</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="47.426ex" height="2.66ex" viewBox="0 -832 20419.5 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-75" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-6E" x="822" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-64" x="1423" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-65" x="1946" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-72" x="2413" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-73" x="2864" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-65" x="3334" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-74" x="3800" y="0"></use><g transform="translate(4162,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-47" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMAIN-2C" x="786" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-6C" x="1231" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMAIN-2C" x="1530" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-66" x="1975" y="0"></use></g><g transform="translate(6687,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-61" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-72" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-67" x="1231" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-6D" x="1961" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-69" x="2840" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-6E" x="3185" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-73" x="10723" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-75" x="11193" y="0"></use><g transform="translate(11765,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-6D" x="0" y="0"></use><g transform="translate(878,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-69" x="858" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-6E" x="1203" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-54" x="1804" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-4C" x="14518" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMAIN-28" x="15199" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-49" x="15589" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMAIN-2C" x="16093" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-47" x="16538" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMAIN-5B" x="17325" y="0"></use><g transform="translate(17603,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-66" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-49" x="693" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMAIN-2C" x="18551" y="0"></use><g transform="translate(18996,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-6C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-49" x="422" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMAIN-5D" x="19751" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMAIN-29" x="20029" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtext>&nbsp;</mtext><mi>u</mi><mi>n</mi><mi>d</mi><mi>e</mi><mi>r</mi><mi>s</mi><mi>e</mi><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mi>G</mi><mo>,</mo><mi>l</mi><mo>,</mo><mi>f</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mtext>&nbsp;</mtext><mi>a</mi><mi>r</mi><mi>g</mi><mtext>&nbsp;</mtext><mi>m</mi><mi>i</mi><mi>n</mi></mrow><mtext>&nbsp;</mtext><mi>s</mi><mi>u</mi><msub><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><mi>I</mi><mtext>&nbsp;</mtext><mi>i</mi><mi>n</mi><mi>T</mi></mrow></msub><mi>L</mi><mo stretchy="false">(</mo><mi>I</mi><mo>,</mo><mi>G</mi><mo stretchy="false">[</mo><msub><mi>f</mi><mi>I</mi></msub><mo>,</mo><msub><mi>l</mi><mi>I</mi></msub><mo stretchy="false">]</mo><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-10"> \ underset {G, l, f} {\ arg \ min} \ sum_ {I \ in T} L (I, G [f_I, l_I]) </script></p>  As a loss function <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>L</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.583ex" height="2.057ex" viewBox="0 -780.1 681.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-4C" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi></math></span></span><script type="math/tex" id="MathJax-Element-11"> L </script>  the total <a href="https://www.tensorflow.org/api_docs/python/tf/nn/sigmoid_cross_entropy_with_logits">cross entropy</a> between the predicted and real pixels is used (the pixel value is scaled from zero to one). <br><br><h3>  Image Recovery </h3><br>  Trained neural network <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>G</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.827ex" height="2.057ex" viewBox="0 -780.1 786.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-47" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi></math></span></span><script type="math/tex" id="MathJax-Element-12"> G </script>  and embedding vectors of Cyrillic and Latin characters are used in the above task of restoring Cyrillic fonts. <br><br>  Suppose we have entered the Latin font <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>u</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-75" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>u</mi></math></span></span><script type="math/tex" id="MathJax-Element-13"> u </script>  missing in the training set.  We can try to restore his embedding vector. <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>f</mi><mi>u</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.312ex" height="2.419ex" viewBox="0 -780.1 995.3 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-66" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-75" x="693" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mi>u</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-14"> f_u </script>  using only images of Latin letters <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.764ex" height="2.057ex" viewBox="0 -780.1 759.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-52" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi></math></span></span><script type="math/tex" id="MathJax-Element-15"> R </script>  .  To do this, we solve the following optimization problem: <br><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msub><mi>f</mi><mi>u</mi></msub><mo>=</mo><mtext>&amp;#xA0;</mtext><mi>u</mi><mi>n</mi><mi>d</mi><mi>e</mi><mi>r</mi><mi>s</mi><mi>e</mi><mi>t</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>f</mi></mrow><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mtext>&amp;#xA0;</mtext><mi>a</mi><mi>r</mi><mi>g</mi><mtext>&amp;#xA0;</mtext><mi>m</mi><mi>i</mi><mi>n</mi></mrow><mtext>&amp;#xA0;</mtext><mi>s</mi><mi>u</mi><msub><mi>m</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>I</mi><mtext>&amp;#xA0;</mtext><mi>i</mi><mi>n</mi><mi>R</mi></mrow></msub><mi>L</mi><mo stretchy=&quot;false&quot;>(</mo><mi>I</mi><mo>,</mo><mi>G</mi><mo stretchy=&quot;false&quot;>[</mo><mi>f</mi><mo>,</mo><msub><mi>l</mi><mi>I</mi></msub><mo stretchy=&quot;false&quot;>]</mo><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="47.417ex" height="2.66ex" viewBox="0 -832 20415.6 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-66" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-75" x="693" y="-213"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMAIN-3D" x="1273" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-75" x="2579" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-6E" x="3151" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-64" x="3752" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-65" x="4275" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-72" x="4742" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-73" x="5193" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-65" x="5663" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-74" x="6129" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-66" x="6491" y="0"></use><g transform="translate(7041,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-61" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-72" x="779" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-67" x="1231" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-6D" x="1961" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-69" x="2840" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-6E" x="3185" y="0"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-73" x="11077" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-75" x="11547" y="0"></use><g transform="translate(12119,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-6D" x="0" y="0"></use><g transform="translate(878,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-49" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-69" x="858" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-6E" x="1203" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-52" x="1804" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-4C" x="14911" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMAIN-28" x="15592" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-49" x="15982" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMAIN-2C" x="16486" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-47" x="16931" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMAIN-5B" x="17718" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-66" x="17996" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMAIN-2C" x="18547" y="0"></use><g transform="translate(18992,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-6C" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-49" x="422" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMAIN-5D" x="19747" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMAIN-29" x="20026" y="0"></use></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>f</mi><mi>u</mi></msub><mo>=</mo><mtext>&nbsp;</mtext><mi>u</mi><mi>n</mi><mi>d</mi><mi>e</mi><mi>r</mi><mi>s</mi><mi>e</mi><mi>t</mi><mrow class="MJX-TeXAtom-ORD"><mi>f</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mtext>&nbsp;</mtext><mi>a</mi><mi>r</mi><mi>g</mi><mtext>&nbsp;</mtext><mi>m</mi><mi>i</mi><mi>n</mi></mrow><mtext>&nbsp;</mtext><mi>s</mi><mi>u</mi><msub><mi>m</mi><mrow class="MJX-TeXAtom-ORD"><mi>I</mi><mtext>&nbsp;</mtext><mi>i</mi><mi>n</mi><mi>R</mi></mrow></msub><mi>L</mi><mo stretchy="false">(</mo><mi>I</mi><mo>,</mo><mi>G</mi><mo stretchy="false">[</mo><mi>f</mi><mo>,</mo><msub><mi>l</mi><mi>I</mi></msub><mo stretchy="false">]</mo><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-16"> f_u = \ underset {f} {\ arg \ min} \ sum_ {I \ in R} L (I, G [f, l_I]) </script></p>  This problem can already be solved by the method of ordinary gradient descent (or any other), since the power of the set <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>R</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.764ex" height="2.057ex" viewBox="0 -780.1 759.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-52" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>R</mi></math></span></span><script type="math/tex" id="MathJax-Element-17"> R </script>  about two or three dozen letters. <br><br>  Further, using the embedding vectors of Cyrillic symbols and embedding vectors obtained at the learning stage <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub><mi>f</mi><mi>u</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.312ex" height="2.419ex" viewBox="0 -780.1 995.3 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-66" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-75" x="693" y="-213"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mi>u</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-18"> f_u </script>  , we can easily restore the corresponding images using the network <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>G</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.827ex" height="2.057ex" viewBox="0 -780.1 786.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/325510/&amp;xid=17259,15700022,15700186,15700191,15700248,15700253&amp;usg=ALkJrhj7fDjb6Y44EjSaPCUea987PcliYg#MJMATHI-47" x="0" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>G</mi></math></span></span><script type="math/tex" id="MathJax-Element-19"> G </script>  . <br><br><h3>  Training sample preparation </h3><br>  As is often the case, a significant proportion of the time was spent preparing the training set.  It all started with the fact that I went to well-known sites in narrow circles and downloaded the font collections available there.  The unzipped size of all files was ~ 14 GB. <br><br>  At first it turned out that for different fonts letters of the same size can occupy a different number of pixels.  To combat this, a program was written that selects the font size to fit all its characters into an 64 by 64 pixel image. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/a81/ae7/4f9/a81ae74f9c7c4a42a29ae32f8d5a9c2e.png"></div><br>  Further, all the fonts were conditionally divided into three types - classical, exotic and ornamental.  On the latter, anything other than Cyrillic and Latin characters can be depicted, for example, emoticons or pictures.  On exotic fonts, all the letters are in place, but depicted in a special way.  For example, on exotic fonts, colors can be inverted, frames added, a record can be used, and so on. <br><br>  By sight, ornamental fonts made up a large proportion of the collection, and nothing but noise could be considered.  There was a problem of their filtering.  Unfortunately, using metadata this did not work.  Instead, I began to count the number of monochrome areas in black and white images of individual letters and compare it with the reference value.  For example, letter A corresponds to the reference number three, and letter T two.  If there are a lot of letters in the font with differences from the reference values, it is considered noise. <br><br>  As a result, much of the exotic fonts were also screened out.  I was not very upset because I did not harbor any special illusions about the generalizing ability of the network being developed.  The total size of the collection turned out to be ~ 6000 fonts. <br><br><h3>  About convolutional neural networks </h3><br>  If you've read this far, I think you have an idea about convolution neural networks.  If not, there is enough material on this topic in the network.  Here I just want to mention two points about convolution networks: <br><br><ul><li>  Their ability to produce at the output of the last layers a number of characteristics of the original image, a combination of which can be used in its analysis ( <a href="https://habr.com/ru/post/325510/">[3]</a> Deep Convolutional Neural Networks as Generic Feature Extractors <a href="http://www.inb.uni-luebeck.de/publications/pdfs/HeBaKaMa15.pdf">[PDF]</a> ); </li><li>  These global characteristics are obtained through the sequential calculation of local characteristics in the inner layers of the neural network. </li></ul><br>  In the context of the article, the first statement suggests an analogy between the resulting characteristics and the embedding layer described above.  And the second gives an intuitive rationale to try to gradually restore the local characteristics of the original image from the global ones. <br><br><h3>  Deconvolution </h3><br>  The convolution + ReLu + maxpooling function used in convolutional networks is not reversible.  The literature suggests several ways <a href="https://habr.com/ru/post/325510/">[2]</a> <a href="https://habr.com/ru/post/325510/">[4] of</a> its ‚Äúrecovery‚Äù.  I decided to use the simplest one ‚Äî convolution transpose + ReLu, which is essentially a linear function + the simplest nonlinear activation function.  The main thing for me was to preserve the property of locality. <br><br>  TensorFlow has a function <a href="https://www.tensorflow.org/api_docs/python/tf/nn/conv2d_transpose">conv2d_transpose</a> , which performs this linear transformation.  The main problem I encountered here was to imagine exactly how the calculation was performed in order to rationally find the parameters.  Here, an illustration for a one-dimensional case from the article <a href="https://habr.com/ru/post/325510/">[5]</a> MatConvNet - Convolutional Neural Networks for MATLAB (p. 30) <a href="">[arXiv]</a> came to my aid: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/a8b/001/e60/a8b001e603d8436983e7a4f5ed7e241d.png"></div><br>  As a result, I stopped at the parameters stride = [2, 2] and kernel = [4, 4].  This allowed in each deconvolution layer to double the length and width of the image and use groups of 4 neighboring pixels to calculate the neurons of the next layer. <br><br><h3>  Learning process </h3><br>  When learning the network, I came across two points that I think would be useful to share. <br>  Firstly, it turned out to be very important to balance the number of Cyrillic and Latin images in the training set.  First, the Latin characters in my training sample turned out much more, as a result, the network drew them better, to the detriment of the quality of the recovery of Cyrillic characters. <br><br>  Secondly, with the training, a gradual decrease in the learning rate of the gradient descent helped.  I did this manually, following the error in the TensorBoard, but in TensorFlow there are opportunities to automate this process, for example using the <a href="https://www.tensorflow.org/api_docs/python/tf/train/exponential_decay">tf.train.exponential_decay</a> function. <br><br>  I didn‚Äôt have to use other useful tricks like regularization, <a href="https://www.tensorflow.org/api_docs/python/tf/nn/dropout">dropout</a> , <a href="https://www.tensorflow.org/api_docs/python/tf/nn/batch_normalization">batch normalization</a> , as without them it turned out to achieve results acceptable for my purposes. <br><br><h3>  Network Summary </h3><br>  The dimension of embedding layer 64 is both for symbols and for fonts. <br><br>  4 deconvolution layers of inner layers 8 √ó 8 √ó 128 ‚Üí 16 √ó 16 √ó 64 ‚Üí 32 √ó 32 √ó 32 ‚Üí 64 √ó 64 √ó 16, stride = [2, 2], kernel = [4, 4], ReLu activation <br>  1 convolution layer 64 √ó 64 √ó 16 ‚Üí 64 √ó 64 √ó 1, stride = [1, 1], kernel = [4, 4], sigmoid activation <br><br><h3>  results </h3><br>  To demonstrate the results, an informational reason was recently found when at once two Russian projects <a href="https://www.opennet.ru/opennews/art.shtml%3Fnum%3D45732">MoiOffice</a> and <a href="https://www.opennet.ru/opennews/art.shtml%3Fnum%3D45236">Astra Linux</a> released free font collections.  These fonts were not used in the training set.  On the left is the original font, on the right is the output of the neural network.  For compactness, only Cyrillic letters are given that have no Latin analogs. <br><br><h4>  XOCourserBold </h4><br><div style="text-align:center;"> <a href=""><img src="https://habrastorage.org/files/f5b/363/b2e/f5b363b2e00d470c8758aff242b2eee8.png"></a> </div><br><h4>  PTAstraSansItalic </h4><br><div style="text-align:center;"> <a href=""><img src="https://habrastorage.org/files/199/ee9/49b/199ee949bdb64050985eb18dea12b63d.png"></a> </div><br><h4>  XOThamesBoldItalic </h4><br><div style="text-align:center;"> <a href=""><img src="https://habrastorage.org/files/0e8/21d/382/0e821d382140440f923496113ed59710.png"></a> </div><br><h4>  PTAstraSerifRegular </h4><br><div style="text-align:center;"> <a href=""><img src="https://habrastorage.org/files/019/d67/56a/019d6756a9e84e69804388ca634cb69e.png"></a> </div><br><h4>  Rest </h4><br>  The remaining results lay out a separate <a href="https://mega.nz/">archive</a> . <br><br><h3>  Total </h3><br>  Having received these results, I believe that I have achieved my goals.  Although it is worth noting that they are far from ideal (especially noticeable for some Italic fonts) and there are still a lot of things that can be added, improved and tested. <br>  What is the article, to judge you. <br><br><h3>  Related Links </h3><br>  [ <a name="1"></a>  1] Gatys, Ecker, Bethge, A neural algorithm of artistic style <a href="http://arxiv.org/abs/1508.06576">[arXiv]</a> <br>  [ <a name="2"></a>  2] Dosovitskiy, Springenberg, Tatarchenko, Brox, Learning to Generate Chairs, Tables and Cars with Convolutional Networks <a href="">[arXiv]</a> <br>  [ <a name="3"></a>  3] Hertel, Barth, K√§ster, Martinetz, Deep Convolutional Neural Networks as Generic Feature Extractors <a href="http://www.inb.uni-luebeck.de/publications/pdfs/HeBaKaMa15.pdf">[PDF]</a> <br>  [ <a name="4"></a>  4] Zeiler, Krishnan, Taylor, Fergus, Deconvolutional Networks <a href="http://www.matthewzeiler.com/pubs/cvpr2010/cvpr2010.pdf">[PDF]</a> <br>  [ <a name="5"></a>  5] Vedaldi, Lenc, MatConvNet - Convolutional Neural Networks for MATLAB <a href="">[arXiv]</a> </div><p>Source: <a href="https://habr.com/ru/post/325510/">https://habr.com/ru/post/325510/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../325494/index.html">Why in the standard library there are no tools to combat hanging links and how to fix it?</a></li>
<li><a href="../325498/index.html">Facilitating the reversal of Golang binaries or why even write scripts in IDA</a></li>
<li><a href="../325502/index.html">Spectral analysis of signals from non-linear links of ACS in Python</a></li>
<li><a href="../325504/index.html">We automate everything: the new version of OneBox Next (CRM + ERP) is available for free</a></li>
<li><a href="../325508/index.html">Posting 3CX on Google Compute Engine</a></li>
<li><a href="../325512/index.html">Report and presentations with Moscow JS in the Superjob office</a></li>
<li><a href="../325514/index.html">Registration and authorization of the user on the site - one click - through the custom Facebook button. 2017</a></li>
<li><a href="../325516/index.html">Conference DUMP-2017: Section "Testing"</a></li>
<li><a href="../325518/index.html">Authenticating OAuth2 in-app using Google Sign-In. Continuous access to Google APIs</a></li>
<li><a href="../325522/index.html">Bash scripts: start</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>