<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>MVC on pure javascript</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Design patterns are often embedded in popular frameworks. For example, the MVC pattern (Model-View-Controller, Model-View-Controller) can be found lit...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>MVC on pure javascript</h1><div class="post__text post__text-html js-mediator-article">  Design patterns are often embedded in popular frameworks.  For example, the MVC pattern (Model-View-Controller, Model-View-Controller) can be found literally everywhere.  In JavaScript, it is difficult to separate the framework from the design pattern implemented in it, and, often, the authors of the framework interpret MVC in their own way and impose their vision on the programmers. <br><br> <a href="https://habrahabr.ru/company/ruvds/blog/333856/"><img src="https://habrastorage.org/web/15a/297/2e6/15a2972e6c594b4ababce741a52e95bd.jpg"></a> <br><br>  How exactly a particular MVC implementation will look like depends entirely on the framework.  As a result, we get a lot of different implementations, which is confusing and leads to confusion.  This is especially noticeable when several frameworks are used in one project.  This situation made me wonder: ‚ÄúIs there a better way?‚Äù. <br><a name="habracut"></a><br>  The MVC pattern is good for client frameworks, however, relying on something ‚Äúmodern‚Äù, you need to remember that tomorrow something new will appear, and what is modern today will become obsolete.  This is also a problem, and I would like to explore alternatives to frameworks and see what all this can lead to. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The MVC design pattern appeared a few decades ago.  I suppose it‚Äôs worth investing time in any programmer.  This template can be used without binding to any frameworks. <br><br><h2>  <font color="#3AC1EF">Is MVC implementation another framework?</font> </h2><br>  For a start, I would like to dispel one common myth when equating design patterns and frameworks.  These are different things. <br><br>  A template is a rigorous approach to solving a problem.  To implement the template, for which the programmer is responsible for the details, you need a certain level of skill.  The MVC pattern allows you to follow the principle of separation of responsibilities and promotes the writing of clean code. <br><br>  The frameworks are not tied to specific design patterns.  In order to distinguish the framework from the template, you can use the so-called Hollywood principle: ‚Äúdo not call us, we will call you‚Äù.  If there is a certain dependency in the system and at the same time you are forced to use it in a certain situation - this is a framework.  The similarity of frameworks with Hollywood lies in the fact that the developers who use them are like actors who are forced to strictly follow movie scripts.  Such programmers do not have the right to vote. <br><br>  Should I avoid client frameworks?  Everyone will answer this question himself, however, here are some good reasons to refuse them: <br><br><ul><li>  The frameworks complicate decisions and increase the risk of failures. <br></li><li>  The project is highly dependent on the framework, which leads to the appearance of <a href="https://github.com/Droogans/unmaintainable-code">hard-</a> to-maintain <a href="https://github.com/Droogans/unmaintainable-code">code</a> . <br></li><li>  When new versions of frameworks appear, it is difficult to rewrite existing code for them. <br></li></ul><br><h2>  <font color="#3AC1EF">MVC pattern</font> </h2><br>  The MVC design pattern hails from the 1970s.  He appeared at the Xerox PARC Research Center while working on the Smalltalk programming language.  The template has passed the test of time in the development of graphical user interfaces.  He came to web programming from desktop applications and proved to be effective in a new field of application. <br><br>  In essence, MVC is a way of clearly dividing responsibilities.  As a result, the design of the solution based on it is clear even to a new programmer who, for some reason, joined the project.  As a result, even to someone who was not familiar with the project, it is easy to understand it, and, if necessary, to contribute to its development. <br><br><h2>  <font color="#3AC1EF">MVC implementation example</font> </h2><br>  To make it more fun, write a web application that will be devoted to penguins.  By the way, these cute creatures, similar to plush toys, live not only in the Antarctic ice.  In total there are about a dozen species of penguins.  It's time to look at them.  Namely, our application will consist of a single web page, on which the penguin information viewing area is located and a couple of buttons that allow you to view the penguin catalog. <br><br>  When creating an application, we will use the MVC template, strictly following its principles.  In addition, the process of solving the problem will involve the methodology of <a href="http://www.extremeprogramming.org/">extremal programming</a> , as well as unit tests.  Everything will be done in JS, HTML and CSS - no frameworks, nothing more. <br><br>  Having mastered this example, you will learn enough to integrate MVC into your own projects.  In addition, since software built using this template is perfectly testable, you will also learn about unit tests for our training project.  Understandably, if necessary, you can also adopt them. <br><br>  We will adhere to the ES5 standard for cross-browser compatibility.  We believe that the MVC pattern is well deserved in order for its implementation to use the well-known, proven features of the language. <br><br>  So let's get started. <br><br><h3>  General project overview </h3><br>  The demo project will consist of three main components: the controller, the view and the model.  Each of them has its own area of ‚Äã‚Äãresponsibility and is focused on solving a specific task. <br><br>  This is how it looks like a schematic. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/24b/538/8c6/24b5388c6f410e7388338602538b6236.png"><br>  <i><font color="#999999">Project outline</font></i> <br><br>  <b>The</b> <code>PenguinController</code> <b>controller</b> <code>PenguinController</code> event handling and serves as an intermediary between the view and the model.  He finds out what happened when the user performs an action (for example, clicks a button or presses a key on the keyboard).  Client application logic can be implemented in the controller.  In larger systems in which you need to handle a lot of events, this element can be divided into several modules.  The controller is the entry point for events and the only mediator between the view and the data. <br><br>  <b>The</b> <code>PenguinView</code> interacts with the DOM.  DOM is the browser API that is used to work with HTML.  In MVC, only the view is responsible for changing the DOM.  A view can connect UI event handlers, but event handling is the controller's prerogative.  The main task solved by the presentation is to control what the user sees on the screen.  In our project, the view will perform manipulations with the DOM using JavaScript. <br><br>  <b>The</b> <code>PenguinModel</code> <b>model</b> <code>PenguinModel</code> responsible for working with data.  In client JS, this means performing Ajax operations.  One of the advantages of the MVC pattern is that all interaction with the data source, for example - with the server, is concentrated in one place.  This approach helps programmers who are not familiar with the project understand it.  The model in this design pattern is engaged exclusively in working with JSON or objects that come from the server. <br><br>  If the implementation of MVC violates the above division of responsibilities of components, we get one of the possible MVC anti-patterns.  The model should not work with HTML.  A view should not perform Ajax requests.  The controller should play the role of an intermediary, not caring about the details of the implementation of other components. <br><br>  If the web developer, when implementing MVC, does not pay enough attention to the division of responsibility of components, everything, as a result, turns into one web component.  As a result, despite the good intentions, it turns out a mess.  This is due to the fact that increased attention is paid to the capabilities of the application and all that is associated with user interaction.  However, the division of responsibilities of components in the areas of program capabilities is not the same as the division of functions. <br><br>  I think in programming it is worth striving for a clear separation of functional areas of responsibility.  As a result, each task is provided with a uniform way to solve it.  This makes the code more understandable, allows new programmers connecting to the project to more quickly understand the code and begin to work on it productively. <br><br>  Perhaps enough reasoning, it's time to look at the working example, the code of which is posted on <a href="https://codepen.io/SitePoint/pen/RgEoOe">CodePen</a> .  You can experiment with it. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/15a/664/c6f/15a664c6f2a5c12a562b1885b4dc56e9.png"><br>  <i><font color="#999999">CodePen application</font></i> <br><br>  Consider this code. <br><br><h3>  Controller </h3><br>  The controller interacts with the view and model.  The components necessary for the operation of the controller are in its constructor: <br><br><pre> <code class="hljs actionscript"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> PenguinController = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PenguinController</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(penguinView, penguinModel)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.penguinView = penguinView; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.penguinModel = penguinModel; };</code> </pre> <br>  The constructor uses <a href="https://en.wikipedia.org/wiki/Inversion_of_control">inversion control</a> , modules are embedded in it in accordance with this idea.  Inversion control allows you to embed any components that meet certain high-level contracts.  This can be considered as a convenient way to abstract from implementation details.  This approach helps to write clean code in javascript. <br><br>  Then events related to user interaction are activated: <br><br><pre> <code class="hljs javascript">PenguinController.prototype.initialize = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">initialize</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.penguinView.onClickGetPenguin = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.onClickGetPenguin.bind(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); }; PenguinController.prototype.onClickGetPenguin = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onClickGetPenguin</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">e</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> target = e.currentTarget; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> index = <span class="hljs-built_in"><span class="hljs-built_in">parseInt</span></span>(target.dataset.penguinIndex, <span class="hljs-number"><span class="hljs-number">10</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.penguinModel.getPenguin(index, <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.showPenguin.bind(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>)); };</code> </pre> <br>  Note that event handlers use application state data stored in the DOM.  In this case, this information is enough for us.  The current state of the DOM is what the user sees in the browser.  Application state data can be stored directly in the DOM, but the controller should not independently affect the state of the application. <br><br>  When an event occurs, the controller reads the data and makes decisions about further actions.  At the moment we are talking about the callback function <code>this.showPenguin()</code> : <br><br><pre> <code class="hljs pgsql">PenguinController.prototype.showPenguin = <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> showPenguin(penguinModelData) { var penguinViewModel = {   <span class="hljs-type"><span class="hljs-type">name</span></span>: penguinModelData.name,   imageUrl: penguinModelData.imageUrl,   size: penguinModelData.size,   favoriteFood: penguinModelData.favoriteFood }; penguinViewModel.previousIndex = penguinModelData.<span class="hljs-keyword"><span class="hljs-keyword">index</span></span> - <span class="hljs-number"><span class="hljs-number">1</span></span>; penguinViewModel.nextIndex = penguinModelData.<span class="hljs-keyword"><span class="hljs-keyword">index</span></span> + <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (penguinModelData.<span class="hljs-keyword"><span class="hljs-keyword">index</span></span> === <span class="hljs-number"><span class="hljs-number">0</span></span>) {   penguinViewModel.previousIndex = penguinModelData.count - <span class="hljs-number"><span class="hljs-number">1</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (penguinModelData.<span class="hljs-keyword"><span class="hljs-keyword">index</span></span> === penguinModelData.count - <span class="hljs-number"><span class="hljs-number">1</span></span>) {   penguinViewModel.nextIndex = <span class="hljs-number"><span class="hljs-number">0</span></span>; } this.penguinView.render(penguinViewModel); };</code> </pre> <br>  The controller, based on the state of the application and on the event that occurred, finds the index corresponding to the data set about the penguin, and informs the presentation about what needs to be displayed on the page.  The controller takes the necessary data from the model and converts it into an object with which the view can work. <br><br>  The unit tests presented here are based on the AAA model (Arrange, Act, Assert - placement, action, approval).  Here is the unit test for the standard penguin information script: <br><br><pre> <code class="hljs pgsql">var PenguinViewMock = <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> PenguinViewMock() { this.calledRenderWith = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; }; PenguinViewMock.prototype.render = <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> render(penguinViewModel) { this.calledRenderWith = penguinViewModel; }; // Arrange var penguinViewMock = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> PenguinViewMock(); var controller = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> PenguinController(penguinViewMock, <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); var penguinModelData = { <span class="hljs-type"><span class="hljs-type">name</span></span>: <span class="hljs-string"><span class="hljs-string">'Chinstrap'</span></span>, imageUrl: <span class="hljs-string"><span class="hljs-string">'http://chinstrapl.jpg'</span></span>, size: <span class="hljs-string"><span class="hljs-string">'5.0kg (m), 4.8kg (f)'</span></span>, favoriteFood: <span class="hljs-string"><span class="hljs-string">'krill'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">index</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span>, count: <span class="hljs-number"><span class="hljs-number">5</span></span> }; // Act controller.showPenguin(penguinModelData); // <span class="hljs-keyword"><span class="hljs-keyword">Assert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span>.strictEqual(penguinViewMock.calledRenderWith.name, <span class="hljs-string"><span class="hljs-string">'Chinstrap'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span>.strictEqual(penguinViewMock.calledRenderWith.imageUrl, <span class="hljs-string"><span class="hljs-string">'http://chinstrapl.jpg'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span>.strictEqual(penguinViewMock.calledRenderWith.size, <span class="hljs-string"><span class="hljs-string">'5.0kg (m), 4.8kg (f)'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span>.strictEqual(penguinViewMock.calledRenderWith.favoriteFood, <span class="hljs-string"><span class="hljs-string">'krill'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span>.strictEqual(penguinViewMock.calledRenderWith.previousIndex, <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span>.strictEqual(penguinViewMock.calledRenderWith.nextIndex, <span class="hljs-number"><span class="hljs-number">3</span></span>);</code> </pre> <br>  The stub <code>PenguinViewMock</code> implements the same contract as the actual view module.  This allows you to write unit tests and check, in the Assert block, whether everything works as it should. <br><br>  The <code>assert</code> object is taken from <a href="https://nodejs.org/api/assert.html">Node.js</a> , but you can use a similar object from the <a href="http://chaijs.com/">Chai</a> library.  This allows you to write tests that can be performed both on the server and in the browser. <br><br>  Note that the controller does not care about the implementation details.  It relies on a contract that provides a view, like <code>this.render()</code> .  It is this approach that you must follow to write clean code.  The controller, with this approach, can entrust the component with the execution of those tasks that this component has declared possible.  This makes the project structure transparent, which improves the readability of the code. <br><br><h3>  Representation </h3><br>  A view cares only about DOM elements and connecting event handlers.  For example: <br><br><pre> <code class="hljs actionscript"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> PenguinView = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PenguinView</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(element)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.element = element; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.onClickGetPenguin = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; };</code> </pre> <br>  Here's how the impact of the view on what the user sees is implemented in the code: <br><br><pre> <code class="hljs xml">PenguinView.prototype.render = function render(viewModel) { this.element.innerHTML = '<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h3</span></span></span><span class="hljs-tag">&gt;</span></span>' + viewModel.name + '<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">h3</span></span></span><span class="hljs-tag">&gt;</span></span>' +   '<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">img</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"penguin-image"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"' + viewModel.imageUrl +     '"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">alt</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"' + viewModel.name + '"</span></span></span><span class="hljs-tag"> /&gt;</span></span>' +   '<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">b</span></span></span><span class="hljs-tag">&gt;</span></span>Size:<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">b</span></span></span><span class="hljs-tag">&gt;</span></span> ' + viewModel.size + '<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>' +   '<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">b</span></span></span><span class="hljs-tag">&gt;</span></span>Favorite food:<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">b</span></span></span><span class="hljs-tag">&gt;</span></span> ' + viewModel.favoriteFood + '<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">p</span></span></span><span class="hljs-tag">&gt;</span></span>' +   '<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"previousPenguin"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"previous button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"javascript:void(0);"</span></span></span><span class="hljs-tag">' +     ' </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-penguin-index</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"' + viewModel.previousIndex + '"</span></span></span><span class="hljs-tag">&gt;</span></span>Previous<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> ' +   '<span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"nextPenguin"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"next button"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"javascript:void(0);"</span></span></span><span class="hljs-tag">' +     ' </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">data-penguin-index</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"' + viewModel.nextIndex + '"</span></span></span><span class="hljs-tag">&gt;</span></span>Next<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span>'; this.previousIndex = viewModel.previousIndex; this.nextIndex = viewModel.nextIndex; //             var previousPenguin = this.element.querySelector('#previousPenguin'); previousPenguin.addEventListener('click', this.onClickGetPenguin); var nextPenguin = this.element.querySelector('#nextPenguin'); nextPenguin.addEventListener('click', this.onClickGetPenguin); nextPenguin.focus(); }</code> </pre> <br>  Note that the main task of the view is to turn the data obtained from the model into HTML and change the state of the application.  Another task is to connect event handlers and transfer functions to the controller. Event handlers are connected to the DOM after the state changes.  This approach allows you to easily and conveniently manage events. <br><br>  In order to test all this, we can check the update of the elements and the state change of the application: <br><br><pre> <code class="hljs pgsql">var ElementMock = <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> ElementMock() { this.innerHTML = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; }; // -,   ,    ElementMock.prototype.querySelector = <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> querySelector() { }; ElementMock.prototype.addEventListener = <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> addEventListener() { }; ElementMock.prototype.focus = <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> focus() { }; // Arrange var elementMock = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> ElementMock(); var <span class="hljs-keyword"><span class="hljs-keyword">view</span></span> = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> PenguinView(elementMock); var viewModel = { <span class="hljs-type"><span class="hljs-type">name</span></span>: <span class="hljs-string"><span class="hljs-string">'Chinstrap'</span></span>, imageUrl: <span class="hljs-string"><span class="hljs-string">'http://chinstrap1.jpg'</span></span>, size: <span class="hljs-string"><span class="hljs-string">'5.0kg (m), 4.8kg (f)'</span></span>, favoriteFood: <span class="hljs-string"><span class="hljs-string">'krill'</span></span>, previousIndex: <span class="hljs-number"><span class="hljs-number">1</span></span>, nextIndex: <span class="hljs-number"><span class="hljs-number">2</span></span> }; // Act <span class="hljs-keyword"><span class="hljs-keyword">view</span></span>.render(viewModel); // <span class="hljs-keyword"><span class="hljs-keyword">Assert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span>(elementMock.innerHTML.indexOf(viewModel.name) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span>(elementMock.innerHTML.indexOf(viewModel.imageUrl) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span>(elementMock.innerHTML.indexOf(viewModel.size) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span>(elementMock.innerHTML.indexOf(viewModel.favoriteFood) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span>(elementMock.innerHTML.indexOf(viewModel.previousIndex) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span>(elementMock.innerHTML.indexOf(viewModel.nextIndex) &gt; <span class="hljs-number"><span class="hljs-number">0</span></span>);</code> </pre> <br>  We reviewed the view and controller.  They solve most of the tasks assigned to the application.  Namely, they are responsible for what the user sees and allow him to interact with the program through the event mechanism.  It remains to deal with where the data is taken from, which are displayed on the screen. <br><br><h3>  Model </h3><br>  In the MVC pattern, the model is busy interacting with the data source.  In our case - with the north.  For example: <br><br><pre> <code class="hljs actionscript"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> PenguinModel = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">PenguinModel</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(XMLHttpRequest)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.XMLHttpRequest = XMLHttpRequest; };</code> </pre> <br>  Note that the <code>XMLHttpRequest</code> module is embedded in the model constructor.  This is, among other things, a hint for other programmers regarding the components needed by the model.  If a model needs different ways of working with data, other modules can be embedded in it.  As in the cases discussed above, unit tests can be prepared for the model. <br><br>  Get the penguin data based on the index: <br><br><pre> <code class="hljs pgsql">PenguinModel.prototype.getPenguin = <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> getPenguin(<span class="hljs-keyword"><span class="hljs-keyword">index</span></span>, fn) { var oReq = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> this.XMLHttpRequest(); oReq.onload = <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> onLoad(e) {   var ajaxResponse = <span class="hljs-type"><span class="hljs-type">JSON</span></span>.parse(e.currentTarget.responseText);   //     ,        var penguin = ajaxResponse[<span class="hljs-keyword"><span class="hljs-keyword">index</span></span>];   penguin.<span class="hljs-keyword"><span class="hljs-keyword">index</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">index</span></span>;   penguin.count = ajaxResponse.length;   fn(penguin); }; oReq.<span class="hljs-keyword"><span class="hljs-keyword">open</span></span>(<span class="hljs-string"><span class="hljs-string">'GET'</span></span>, <span class="hljs-string"><span class="hljs-string">'https://codepen.io/beautifulcoder/pen/vmOOLr.js'</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); oReq.send(); };</code> </pre> <br>  Here you can connect to the server and download data from it.  Check the component using the unit test and conditional test data: <br><br><pre> <code class="hljs pgsql">var LIST_OF_PENGUINS = <span class="hljs-string"><span class="hljs-string">'[{"name":"Emperor","imageUrl":"http://imageUrl",'</span></span> + <span class="hljs-string"><span class="hljs-string">'"size":"36.7kg (m), 28.4kg (f)","favoriteFood":"fish and squid"}]'</span></span>; var XMLHttpRequestMock = <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> XMLHttpRequestMock() { //      ,     this.onload = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; }; XMLHttpRequestMock.prototype.<span class="hljs-keyword"><span class="hljs-keyword">open</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> <span class="hljs-keyword"><span class="hljs-keyword">open</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">method</span></span>, url, async) { //  ,      <span class="hljs-keyword"><span class="hljs-keyword">method</span></span>  url <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">method</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span>(url); //  Ajax  ,      :-) <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span>.strictEqual(async, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); }; XMLHttpRequestMock.prototype.send = <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> send() { //     Ajax- this.onload({ currentTarget: { responseText: LIST_OF_PENGUINS } }); }; // Arrange var penguinModel = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> PenguinModel(XMLHttpRequestMock); // Act penguinModel.getPenguin(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> onPenguinData(penguinData) { // <span class="hljs-keyword"><span class="hljs-keyword">Assert</span></span> <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span>.strictEqual(penguinData.name, <span class="hljs-string"><span class="hljs-string">'Emperor'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span>(penguinData.imageUrl); <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span>.strictEqual(penguinData.size, <span class="hljs-string"><span class="hljs-string">'36.7kg (m), 28.4kg (f)'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span>.strictEqual(penguinData.favoriteFood, <span class="hljs-string"><span class="hljs-string">'fish and squid'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span>.strictEqual(penguinData.<span class="hljs-keyword"><span class="hljs-keyword">index</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">assert</span></span>.strictEqual(penguinData.count, <span class="hljs-number"><span class="hljs-number">1</span></span>); });</code> </pre> <br>  As you can see, the model is only concerned with the raw data.  This means working with Ajax and with JavaScript objects.  If you don‚Äôt fully own the Ajax theme in javascript, here‚Äôs some <a href="https://www.sitepoint.com/guide-vanilla-ajax-without-jquery/">useful stuff</a> . <br><br><h2>  <font color="#3AC1EF">Unit Tests</font> </h2><br>  With any rules for writing code, it is important to check what happened.  The MVC design pattern does not regulate how to solve the problem.  Within the framework of the template, the boundaries are quite free, without crossing which you can write clean code.  This gives freedom from the dominance of addictions. <br><br>  I usually strive to have a complete set of unit tests covering each use case of a product.  These tests can be viewed as guidelines for using code.  Such an approach makes the project more open, understandable for any programmer who wants to participate in its development. <br><br>  Experiment with a <a href="https://codepen.io/SitePoint/pen/zzyoXw">complete set of</a> unit tests.  They will help you better understand the design pattern described here.  Each test is designed to test a specific use case of the program.  Unit tests will help to clearly separate the tasks, and, when implementing a project‚Äôs functionality, not to be distracted by its other parts. <br><br><h2>  <font color="#3AC1EF">About the development of the educational project</font> </h2><br>  Our project implements only the basic functionality necessary to demonstrate the implementation of MVC.  However, it can be expanded.  For example, here are some of the possible improvements: <br><br><ul><li>  Add a screen with a list of all the penguins. <br></li><li>  Add keyboard event handling to organize an alternative way to switch between penguin cards.  Similarly, you can, for mobile devices, add gesture control on the touchscreen. <br></li><li>  Add SVG diagram for data visualization.  For example, you can display generalized information about penguin sizes. <br></li></ul><br>  If you want to develop this project as an exercise, keep in mind that the above are just a few ideas.  You can easily, with the use of MVC, implement other functionality. <br><br><h2>  <font color="#3AC1EF">Results</font> </h2><br>  We hope you appreciate the advantages that the MVC design pattern and disciplined approach to the architecture and project code provide.  A good design pattern, on the one hand, does not interfere with work, on the other hand, it contributes to the writing of clean code.  He, in the process of solving a problem, does not allow you to turn off the right path.  This increases the efficiency of the programmer. <br><br>  Programming is the art of sequential problem solving, splitting the system into small parts that implement a certain functional.  In MVC, this means strict adherence to the principle of separation of the areas of functional responsibility of the components. <br><br>  Developers usually believe that they are not amenable to the action of emotions, that their actions are always logical.  However, when trying to simultaneously solve several problems, a person finds himself in a difficult psychological situation.  The load is too high.  Working in such a state badly affects the quality of the code.  At a certain point, the logic fades into the background, as a result, the risk of errors increases, the quality of the code deteriorates. <br><br>  That is why it is recommended to split projects into small tasks and solve them in turn.  A disciplined approach to MVC implementation and the preparation of unit tests for various parts of the system contribute to calm and productive work. <br><br>  Dear readers!  What design patterns do you use in your JS projects? </div><p>Source: <a href="https://habr.com/ru/post/333856/">https://habr.com/ru/post/333856/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../333846/index.html">Photographing objects in C #: Chronicle and comparison of images, reconstruction of the state of the image</a></li>
<li><a href="../333848/index.html">What is the power of Redux?</a></li>
<li><a href="../333850/index.html">Security in the era of the Internet of Things: stories of hacking video-babies, pacemakers and supercars</a></li>
<li><a href="../333852/index.html">SwiftyBeaver iOS Guide: Logging Platform for Swift</a></li>
<li><a href="../333854/index.html">Overview-rating providers virtual servers Windows: 2017</a></li>
<li><a href="../333858/index.html">Results of the first round of CTFzone</a></li>
<li><a href="../333862/index.html">What to read about neural networks</a></li>
<li><a href="../333864/index.html">Bitfury Group conducted the 1st transaction in the Lightning Network using the bitcoin protocol</a></li>
<li><a href="../333866/index.html">Developer Life in Cyprus</a></li>
<li><a href="../333868/index.html">Cooking cache correctly</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>