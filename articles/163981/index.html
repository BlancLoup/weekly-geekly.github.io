<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Zen Reports and% XML.Writer to generate Excel reports in Cach√©</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="As it is known, MS Excel of the latest versions supports the description of the document structure in xml format. This circumstance allows you to crea...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Zen Reports and% XML.Writer to generate Excel reports in Cach√©</h1><div class="post__text post__text-html js-mediator-article">  As it is known, MS Excel of the latest versions supports the description of the document structure in xml format.  This circumstance allows you to create reports in Excel using the generation of xml-files.  There are several ways to create xml in Cach√© DBMS.  In this article, we will consider two, perhaps the most convenient, ways of efficient programmatic report generation in MS Excel: using Zen Reports and using the% XML.Writer class. <br><a name="habracut"></a><br>  As an example of the MS Excel report, the printed form of the curriculum is taken from the curriculum management system, which <a href="http://habrahabr.ru/company/intersystems/blog/149704/">has</a> already been written about <a href="http://habrahabr.ru/company/intersystems/blog/149704/">here</a> , so we proceed directly to the formulation of the problem and how to solve it.  It is required to receive the report of the curriculum in MS Excel format, which should consist of the schedule of the educational process (title page) and the content of the curriculum (a list of all disciplines, their characteristics and calculated parameters).  A fragment of the curriculum report is presented in the figure, the final report can be viewed <a href="https://dl.dropbox.com/u/81078622/Report.xls">here</a> . <br><img src="https://habrastorage.org/storage2/0c6/c02/b1f/0c6c02b1ff9ada6b40ae3f5e6a8bc435.jpg"><br><br><h4>  The general scheme of the report </h4><br>  In Cache, there are several ways to manually produce reports (here the possibilities of semi-automatic assembly based on DeepSee will not be considered).  The most convenient method is implemented in ZEN and includes a set of tools that provides a complete cycle of the process of generating reports in XHTML and PDF.  A description of this process can be found in the <a href="">documentation</a> .  Nevertheless, this method can be used only partially to solve our problem. <br>  Consider a general reporting mechanism in MS Excel format using both ZEN technology and other Cach√© features (see figure below). <br><img src="https://habrastorage.org/storage2/1fa/c8c/43a/1fac8c43aa33f3141887181faefc8b49.jpg"><br>  This scheme of forming an xls document includes three stages: 1) data from the database is converted using the Zen Reports technology or the standard Cach√© technology into an xml file (input xml);  2) using the XSL transformation mechanism (eXtensible Stylesheet Language), modifies a previously prepared report template in xml format;  3) an Excel document (xls) is generated by filling in the xml report template, extended with XSL inserts, with data from the input xml. <br><br><h4>  The structure of the input xml file </h4><br>  Since xml is used as a data source for our report, the xml-file structure should be as convenient as possible for passing the steps described above and, ultimately, for generating a report.  There are no additional special restrictions on the structure of the xml file. <br>  Based on the specifics of our task and the structure of the database, the root element of the input xml is ‚ÄúCurriculum‚Äù, which contains all the information about the curriculum and includes the following elements: <br><ul><li>  Curriculum name </li><li>  The sum of the forms of control for the entire curriculum: examinations;  credits;  course projects;  coursework </li><li>  The sum of hours in all disciplines of the curriculum: just with the exam;  total for SES (state educational standard);  classroom hours;  CSR (independent work on a course project or work);  hours of independent work </li><li>  The sum of hours for each discipline for each semester of the curriculum: hours at a lecture;  laboratory hours;  practical training hours;  clock on the DAC </li><li>  Amount of credits () for the whole curriculum </li></ul><br>  Also in the "Curriculum" contains cycles "Cicl", each of which consists of its own elements.  Similarly, the remaining branches of the xml-file are described down to the disciplines and their characteristics. <div class="spoiler">  <b class="spoiler_title">Sample xml-file for the described report.</b> <div class="spoiler_text"><pre><code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xmlversion="1.0" encoding="UTF-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Curriculum</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">CurrName</span></span></span><span class="hljs-tag">&gt;</span></span>  <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">CurrName</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Cicl</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">CiclName</span></span></span><span class="hljs-tag">&gt;</span></span>  1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">CiclName</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">CodeOfCicl</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">CodeOfCicl</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Block</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">BlocName</span></span></span><span class="hljs-tag">&gt;</span></span> 1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">BlocName</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Disciplines</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Discipline</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DiscName</span></span></span><span class="hljs-tag">&gt;</span></span> 1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DiscName</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Exam</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Exam</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Zachet</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Zachet</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">KR</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">KR</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">KP</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">KP</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">chAll</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">chAll</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">chGos</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">chGos</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">chKsr</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">chKsr</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">chAud</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">chAud</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">chSamRab</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">chSamRab</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">naBlock</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">naBlock</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Zet</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Zet</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">semestr1</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Lec</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Lec</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Lab</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Lab</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Pra</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Pra</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">KSR</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">KSR</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">semestr1</span></span></span><span class="hljs-tag">&gt;</span></span> . . . <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Discipline</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Discipline</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DiscName</span></span></span><span class="hljs-tag">&gt;</span></span> 2<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DiscName</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Exam</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Exam</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Zachet</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Zachet</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">KR</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">KR</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">KP</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">KP</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">chAll</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">chAll</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">chGos</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">chGos</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">chKsr</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">chKsr</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">chAud</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">chAud</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">chSamRab</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">chSamRab</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">naBlock</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">naBlock</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Zet</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Zet</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">semestr1</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Lec</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Lec</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Lab</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Lab</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Pra</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Pra</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">KSR</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">KSR</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">semestr1</span></span></span><span class="hljs-tag">&gt;</span></span> . . . <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Discipline</span></span></span><span class="hljs-tag">&gt;</span></span> . . . <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Disciplines</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Block</span></span></span><span class="hljs-tag">&gt;</span></span> . . . <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Cicl</span></span></span><span class="hljs-tag">&gt;</span></span> . . . <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Curriculum</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br></div></div><br><h4>  Formation of initial xml </h4><br>  Consider two ways to get the source xml file: using the% XML.Writer class and using the Zen Reports mechanism. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  Generate source xml using% XML.Writer </h5><br>  The xml structure described above can be obtained through the XML.Writer class, which allows you to: <br><ol><li>  Create root element <br>  <font color="#0000ff">do</font> <font color="#800000">fWriter</font> <font color="#000000">.</font>  <font color="#0000ff">RootElement</font> <font color="#000000">(</font> <font color="#008000">"root element name"</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">do</font> <font color="#800000">fWriter</font> <font color="#000000">.</font>  <font color="#0000ff">EndRootElement</font> <font color="#000000">()</font> </li><li>  Create item <br>  <font color="#0000ff">do</font> <font color="#800000">fWriter</font> <font color="#000000">.</font>  <font color="#0000ff">Element</font> <font color="#000000">(</font> <font color="#008000">"element name"</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">do</font> <font color="#800000">fWriter</font> <font color="#000000">.</font>  <font color="#0000ff">Write</font> <font color="#000000">(</font> <font color="#008000">element value</font> <font color="#000000">)</font> <font color="#000000"><br></font>  <font color="#0000ff">do</font> <font color="#800000">fWriter</font> <font color="#000000">.</font>  <font color="#0000ff">EndElement</font> <font color="#000000">()</font> <br></li><li>  Create attribute <br>  <font color="#0000ff">do</font> <font color="#800000">fWriter</font> <font color="#000000">.</font>  <font color="#0000ff">WriteAttribute</font> <font color="#000000">(</font> <font color="#008000">"attribute name"</font> <font color="#000000">,</font> <font color="#008000">"attribute value"</font> <font color="#000000">)</font> </li></ol><br>  In addition, XML.Writer has a method that allows you to extract all the data from the object passed to it. <br>  <font color="#800000">Writer</font> <font color="#000000">.</font>  <font color="#0000ff">RootObject</font> <font color="#000000">(</font> <font color="#008000">"object name"</font> <font color="#000000">)</font> <br><br>  In the task of generating a curriculum report, the RootObject method did not fit, because  class of discipline has a link to itself, and the work of this method was not correct.  In this regard, all elements of the output xml file were created manually.  For this purpose, the sp.Report.spExcelWriter class was created, including the genWriterData method (iDSelectCur As% Integer) to generate an xml file, to which the id of the selected curriculum is passed.  Using this method, using SQL queries, data is retrieved from the database, and inserted at the right place.  After that, the output xml file is generated using another method OutputToFile ("path \ filename.xml"). <br><br><h5>  Generation of the initial xml using the Zen Reports mechanism </h5><br>  Zen Reports is a high-level mechanism for extracting data from the Cach√© database and converting it into xml, which imposes certain limitations, which will be discussed below.  This method involves the creation of a class Zen-report through Cach√©-studio, inherited from% ZEN.Report.reportPage, in which you need to fill out the XData ReportDefinition block.  For more information about the rules for forming the XData ReportDefinition block and data sampling using an SQL query for an XML representation, please read the <a href="">documentation</a> . <br><div class="spoiler">  <b class="spoiler_title">Here is the content of the XData ReportDefinition block for the report in question.</b> <div class="spoiler_text">  <font color="#000080">XData</font> <font color="#000000">ReportDefinition [</font> <font color="#000080">XMLNamespace</font> <font color="#000000">=</font> <font color="#800080">" <a href="http://www.intersystems.com/zen/report/definition%2522%25C2%25A0">www.intersystems.com/zen/report/definition"</a></font> <font color="#000000">]</font> <font color="#000000"><br></font>  <font color="#000000">{</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">report</font> <font color="#800000">xmlns</font> <font color="#000000">=</font> <font color="#008000">" <a href="http://www.intersystems.com/zen/report/definition%2522%25C2%25A0">www.intersystems.com/zen/report/definition"</a></font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"Curriculum"</font> <font color="#800000">sql</font> <font color="#000000">=</font> <font color="#008000">"SELECT * FROM sp.cCurriculum WHERE ID =?"</font>  <font color="#000000">&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">parameter</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">'..idCurr'</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"CurrName"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"Name"</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"sumurEx"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">"## class (sp.cCurriculum) .getCountFCInCur (% val, 1)"</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"sumurZa"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">"## class (sp.cCurriculum) .getCountFCInCur (% val, 2)"</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"sumurKP"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">"## class (sp.cCurriculum) .getCountFCInCur (% val, 4)"</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"sumurKR"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">"## class (sp.cCurriculum) .getCountFCInCur (% val, 3)"</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"sumCurZET"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">"## class (sp.cCurriculum) .getComTimeInCur (% val, 6)"</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"sumurAll"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">"## class (sp.cCurriculum) .getComTimeInCur (% val, 1)"</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"sumurGos"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">"## class (sp.cCurriculum) .getComTimeInCur (% val, 2)"</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"sumurAud"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">"## class (sp.cCurriculum) .getComTimeInCur (% val, 3)"</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"sumurKsr"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">"## class (sp.cCurriculum) .getComTimeInCur (% val, 4)"</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"sumurSR"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">"## class (sp.cCurriculum) .getComTimeInCur (% val, 5)"</font> <font color="#000000">/&gt;</font> <font color="#000000"><br><br></font>  <font color="#000000">&lt;</font> <font color="#000080">group</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"sumCurseme1"</font> <font color="#000000">&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"sumCurLec"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">"## class (sp.cCurriculum) .getTimeInCur (% val, 1.1)"</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"sumCurLab"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">"## class (sp.cCurriculum) .getTimeInCur (% val, 1,2)"</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"sumCurPra"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">"## class (sp.cCurriculum) .getTimeInCur (% val, 1.3)"</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"sumCurKsr"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">"## class (sp.cCurriculum) .getTimeInCur (% val, 1.4)"</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;/</font> <font color="#000080">group</font> <font color="#000000">&gt;</font> <font color="#000000"><br></font>  <font color="#000000">...</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">group</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"Cicls"</font> <font color="#800000">sql</font> <font color="#000000">=</font> <font color="#008000">"SELECT * FROM sp.cCicl WHERE Curriculum =?"</font>  <font color="#000000">&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">parameter</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">'..idCurr'</font> <font color="#000000">/&gt;</font> <font color="#000000"><br><br></font>  <font color="#000000">&lt;</font> <font color="#000080">group</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"Cicl"</font> <font color="#000000">&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">attribute</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"CiclName"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"Name"</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">attribute</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"CodeOfCicl"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"CodeOfCicl"</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"sumCiclEx"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">"## class (sp.cCicl) .getCountFCInCicl (% val, 1)"</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"sumCiclZa"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">"## class (sp.cCicl) .getCountFCInCicl (% val, 2)"</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"sumCiclKP"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">"## class (sp.cCicl) .getCountFCInCicl (% val, 4)"</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"sumCiclKR"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">"## class (sp.cCicl) .getCountFCInCicl (% val, 3)"</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"sumCiclchAll"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">"## class (sp.cCicl) .getComTimeInCicl (% val, 1)"</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"sumCiclchGos"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">"## class (sp.cCicl) .getComTimeInCicl (% val, 2)"</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"sumCiclchAud"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">"## class (sp.cCicl) .getComTimeInCicl (% val, 3)"</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"sumCiclchKsr"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">"## class (sp.cCicl) .getComTimeInCicl (% val, 4)"</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"sumCiclchSR"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">"## class (sp.cCicl) .getComTimeInCicl (% val, 5)"</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"sumCiclZet"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">"## class (sp.cCicl) .getComTimeInCicl (% val, 6)"</font> <font color="#000000">/&gt;</font> <font color="#000000"><br><br></font>  <font color="#000000">&lt;</font> <font color="#000080">group</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"sumCiclseme1"</font> <font color="#000000">&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"sumCiclLec"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">"## class (sp.cCicl) .getTimeInCicl (% val, 1,1)"</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"sumCiclLab"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">"## class (sp.cCicl) .getTimeInCicl (% val, 1,2)"</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"sumCiclPra"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">"## class (sp.cCicl) .getTimeInCicl (% val, 1,3)"</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"sumCiclKsr"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">"## class (sp.cCicl) .getTimeInCicl (% val, 1.4)"</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;/</font> <font color="#000080">group</font> <font color="#000000">&gt;</font> <font color="#000000"><br></font>  <font color="#000000">...</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">group</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"Blocks"</font> <font color="#800000">sql</font> <font color="#000000">=</font> <font color="#008000">"SELECT * FROM sp.cBlock WHERE Cicl =?"</font>  <font color="#800000">breakOnField</font> <font color="#000000">=</font> <font color="#008000">"ID"</font> <font color="#000000">&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">parameter</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"ID"</font> <font color="#000000">/&gt;</font> <font color="#000000"><br><br></font>  <font color="#000000">&lt;</font> <font color="#000080">group</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"Block"</font> <font color="#000000">&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">attribute</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"BlocName"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"Name"</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"countEx"</font> <font color="#800000">fields</font> <font color="#000000">=</font> <font color="#008000">"Cicl, Name, ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">'## class (sp.cBlock) .getCountFCInBlock (% val ("ID"),% val ("Name"),% val (" Cicl "), 1) '</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"countZa"</font> <font color="#800000">fields</font> <font color="#000000">=</font> <font color="#008000">"Cicl, Name, ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">'## class (sp.cBlock) .getCountFCInBlock (% val ("ID"),% val ("Name"),% val (" Cicl "), 2) '</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"countKR"</font> <font color="#800000">fields</font> <font color="#000000">=</font> <font color="#008000">"Cicl, Name, ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">'## class (sp.cBlock) .getCountFCInBlock (% val ("ID"),% val ("Name"),% val (" Cicl "), 3) '</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"countKP"</font> <font color="#800000">fields</font> <font color="#000000">=</font> <font color="#008000">"Cicl, Name, ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">'## class (sp.cBlock) .getCountFCInBlock (% val ("ID"),% val ("Name"),% val (" Cicl "), 4) '</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"sumBAll"</font> <font color="#800000">fields</font> <font color="#000000">=</font> <font color="#008000">"Cicl, Name, ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">'## class (sp.cBlock) .getComTimeInBlock (% val ("ID"),% val ("Name"),% val (" Cicl "), 1) '</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"sumBGos"</font> <font color="#800000">fields</font> <font color="#000000">=</font> <font color="#008000">"Cicl, Name, ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">'## class (sp.cBlock) .getComTimeInBlock (% val ("ID"),% val ("Name"),% val (" Cicl "), 2) '</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"sumBAud"</font> <font color="#800000">fields</font> <font color="#000000">=</font> <font color="#008000">"Cicl, Name, ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">'## class (sp.cBlock) .getComTimeInBlock (% val ("ID"),% val ("Name"),% val (" Cicl "), 3) '</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"sumBKSR"</font> <font color="#800000">fields</font> <font color="#000000">=</font> <font color="#008000">"Cicl, Name, ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">'## class (sp.cBlock) .getComTimeInBlock (% val ("ID"),% val ("Name"),% val (" Cicl "), 4) '</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"sumBSR"</font> <font color="#800000">fields</font> <font color="#000000">=</font> <font color="#008000">"Cicl, Name, ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">'## class (sp.cBlock) .getComTimeInBlock (% val ("ID"),% val ("Name"),% val (" Cicl "), 5) '</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"sumBZET"</font> <font color="#800000">fields</font> <font color="#000000">=</font> <font color="#008000">"Cicl, Name, ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">'## class (sp.cBlock) .getComTimeInBlock (% val ("ID"),% val ("Name"),% val (" Cicl "), 6) '</font> <font color="#000000">/&gt;</font> <font color="#000000"><br><br></font>  <font color="#000000">&lt;</font> <font color="#000080">group</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"sumBseme1"</font> <font color="#000000">&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"sumBLec"</font> <font color="#800000">fields</font> <font color="#000000">=</font> <font color="#008000">"Cicl, Name, ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">'## class (sp.cBlock) .getTimeInBlock (% val ("ID"),% val ("Name"),% val (" Cicl "), 1,1) '</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"sumBLab"</font> <font color="#800000">fields</font> <font color="#000000">=</font> <font color="#008000">"Cicl, Name, ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">'## class (sp.cBlock) .getTimeInBlock (% val ("ID"),% val ("Name"),% val (" Cicl "), 1,2) '</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"sumBPra"</font> <font color="#800000">fields</font> <font color="#000000">=</font> <font color="#008000">"Cicl, Name, ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">'## class (sp.cBlock) .getTimeInBlock (% val ("ID"),% val ("Name"),% val (" Cicl "), 1,3) '</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"sumBKSR"</font> <font color="#800000">fields</font> <font color="#000000">=</font> <font color="#008000">"Cicl, Name, ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">'## class (sp.cBlock) .getTimeInBlock (% val ("ID"),% val ("Name"),% val (" Cicl "), 1,4) '</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;/</font> <font color="#000080">group</font> <font color="#000000">&gt;</font> <font color="#000000"><br></font>  <font color="#000000">...</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">group</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"Disciplines"</font> <font color="#800000">sql</font> <font color="#000000">=</font> <font color="#008000">"SELECT * FROM sp.cDiscipline WHERE (Blok =? AND Cicl =? And Parent is null)"</font> <font color="#800000">breakOnField</font> <font color="#000000">=</font> <font color="#008000">"ID"</font> <font color="#000000">&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">parameter</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"ID"</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">parameter</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"Cicl"</font> <font color="#000000">/&gt;</font> <font color="#000000"><br><br></font>  <font color="#000000">&lt;</font> <font color="#000080">group</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"Discipline"</font> <font color="#000000">&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"DiscName"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"Name"</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"Exam"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">'## class (sp.cDiscipline) .getFormContr (% val, 1)'</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"Zachet"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">'## class (sp.cDiscipline) .getFormContr (% val, 2)'</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"KR"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">'## class (sp.cDiscipline) .getFormContr (% val, 3)'</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"KP"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">'## class (sp.cDiscipline) .getFormContr (% val, 4)'</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"chAll"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">'## class (sp.cDiscipline) .getComTime (% val, 1)'</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"chGos"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">'## class (sp.cDiscipline) .getComTime (% val, 2)'</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"chKsr"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">'## class (sp.cDiscipline) .getComTime (% val, 4)'</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"chAud"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">'## class (sp.cDiscipline) .getComTime (% val, 3)'</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"chSamRab"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">'## class (sp.cDiscipline) .getComTime (% val, 5)'</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"Zet"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">'## class (sp.cDiscipline) .getComTime (% val, 6)'</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"naBlock"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">'## class (sp.cDiscipline) .getNameBlock (.. idCurr,% val)'</font> <font color="#000000">/&gt;</font> <font color="#000000"><br><br></font>  <font color="#000000">&lt;</font> <font color="#000080">group</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"seme1"</font> <font color="#000000">&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"Lec"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">'## class (sp.cDiscipline) .getTime (% val, 1,1)'</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"Lab"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">'## class (sp.cDiscipline) .getTime (% val, 1,2)'</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"Pra"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">'## class (sp.cDiscipline) .getTime (% val, 1,3)'</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"KSR"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"ID"</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">'## class (sp.cDiscipline) .getTime (% val, 1.4)'</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;/</font> <font color="#000080">group</font> <font color="#000000">&gt;</font> <font color="#000000"><br></font>  <font color="#000000">...</font> <font color="#000000"><br></font>  <font color="#000000">&lt;/</font> <font color="#000080">group</font> <font color="#000000">&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;/</font> <font color="#000080">group</font> <font color="#000000">&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;/</font> <font color="#000080">group</font> <font color="#000000">&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;/</font> <font color="#000080">group</font> <font color="#000000">&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;/</font> <font color="#000080">group</font> <font color="#000000">&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;/</font> <font color="#000080">group</font> <font color="#000000">&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;/</font> <font color="#000080">report</font> <font color="#000000">&gt;</font> <font color="#000000"><br></font>  <font color="#000000">}</font> <br></div></div><br>  Zen Report proposes the use of its own syntax to describe the data structure for the generated xml - this imposes some restrictions on the output xml format.  As a result, the structure of the resulting xml file is slightly different from that described above: the Cicls and Blocks nodes, which contain the Cicl and Block subnodes, are added to the generated xml file. <br>  We show some features of the output related data. <br><br>  Example 1. Passing the ID of the selected curriculum to sql query item. <br>  &lt; <font color="#000080">report</font> <font color="#800000">sql</font> <font color="#000000">=</font> <font color="#008000">"SELECT * FROM sp.cCurriculum WHERE ID =?"</font>  &gt; <br><br>  Next, the parameter with the value of the variable ..idCurr <br>  &lt; <font color="#000080">parameter</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">'..idCurr'</font> <font color="#000000">/&gt;</font> <br><br>  The variable is a property of the ZenReport class and when calling the report generation method, the idCurr value takes the value of the current id's parameter passed to the method. <br><br>  Example 2. Passing a parameter dependent on the result of executing an SQL query, for example, loop-block relationship: <br>  &lt; <font color="#000080">group</font> <font color="#800000">sql</font> <font color="#000000">=</font> <font color="#008000">"SELECT * FROM sp.cCicl WHERE Curriculum =?"</font>  <font color="#000000">&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">parameter</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">'..idCurr'</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">group</font> <font color="#800000">sql</font> <font color="#000000">=</font> <font color="#008000">"SELECT * FROM sp.cBlock WHERE Cicl =?"</font>  <font color="#800000">breakOnField</font> <font color="#000000">=</font> <font color="#008000">"ID"</font> <font color="#000000">&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">parameter</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"ID"</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;/</font> <font color="#000080">group</font> <font color="#000000">&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;/</font> <font color="#000080">group</font> <font color="#000000">&gt;</font> <br><br>  Here the ‚ÄúID‚Äù is transmitted using the attribute breakOnField = ‚ÄúID‚Äù. <br>  We will show the grouping for the "Cycles". <br>  &lt; <font color="#000080">group</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"Cicls"</font> <font color="#800000">sql</font> <font color="#000000">=</font> <font color="#008000">"SELECT * FROM sp.cCicl WHERE Curriculum =?"</font>  <font color="#000000">&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">parameter</font> <font color="#800000">expression</font> <font color="#000000">=</font> <font color="#008000">'..idCurr'</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">group</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"Cicl"</font> <font color="#000000">&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">attribute</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"CiclName"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"Name"</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">attribute</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"CodeOfCicl"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"CodeOfCicl"</font> <font color="#000000">/&gt;</font> <font color="#000000"><br></font>  <font color="#000000">...</font> <font color="#000000"><br></font>  <font color="#000000">&lt;/</font> <font color="#000080">group</font> <font color="#000000">&gt;</font> <font color="#000000"><br></font>  <font color="#000000">...</font> <font color="#000000"><br></font>  <font color="#000000">&lt;/</font> <font color="#000080">group</font> <font color="#000000">&gt;</font> <br><br>  Blocks are grouped similarly. <br>  The modified format of the generated XML file now has the following form. <br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding='utf-8'?&gt;</span></span> ‚Ä¶ <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Cicls</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Cicl</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Blocks</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Block</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Disciplines</span></span></span><span class="hljs-tag">&gt;</span></span>‚Ä¶<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Disciplines</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/ </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Block</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/ </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Blocks</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Cicl</span></span></span><span class="hljs-tag">&gt;</span></span> ‚Ä¶ <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Cicl</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Blocks</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Block</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Disciplines</span></span></span><span class="hljs-tag">&gt;</span></span>‚Ä¶<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Disciplines</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/ </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Block</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/ </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">Blocks</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Cicl</span></span></span><span class="hljs-tag">&gt;</span></span> ‚Ä¶ <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Cicls</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  The loop call will also change during XSL transformations (the general way of applying XSL transformations is described below): <br><pre> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">‚Äù./Cicls/Cicl‚Äù</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  We formulate some rules that should be considered when designing the structure of the output. <br><ol><li>  The Name field will be taken from Table1: <br>  &lt; <font color="#000080">report</font> <font color="#800000">sql</font> <font color="#000000">=</font> <font color="#008000">"SELECT Name FROM Table1"</font> <font color="#000000">&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"A"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"Name"</font> /&gt; </li><li>  The Name field will give an error: <br>  &lt; <font color="#000080">report</font> <font color="#800000">sql</font> <font color="#000000">=</font> <font color="#008000">"SELECT Name FROM Table1"</font> <font color="#000000">&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">attribute</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"A"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"Name"</font> /&gt; </li><li>  The Name field is derived from Table2: <br>  &lt; <font color="#000080">report</font> <font color="#800000">sql</font> <font color="#000000">=</font> <font color="#008000">"SELECT Name FROM Table1"</font> <font color="#000000">&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">group</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"Name"</font> <font color="#800000">sql</font> <font color="#000000">=</font> <font color="#008000">"SELECT Name FROM Table2 WHERE ..."</font> <font color="#000000">&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">element</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"A"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"Name"</font> /&gt; </li><li>  The Name field is derived from Table1: <br>  &lt; <font color="#000080">report</font> <font color="#800000">sql</font> <font color="#000000">=</font> <font color="#008000">"SELECT Name FROM Table1"</font> <font color="#000000">&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">group</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"Name"</font> <font color="#800000">sql</font> <font color="#000000">=</font> <font color="#008000">"SELECT Name FROM Table2 WHERE ..."</font> <font color="#000000">&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">attribute</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"A"</font> <font color="#800000">field</font> <font color="#000000">=</font> <font color="#008000">"Name"</font> /&gt; </li></ol><br><br><h4>  Creating an Excel Template </h4><br>  Before performing the XSL transformation, you need to create an Excel document template into which the data from the xml will be inserted.  The procedure for creating an Excel template consists of three steps. <br>  <b>Step number 1.</b>  Excel creates the appearance of the report. <br>  <b>Step number 2.</b>  The template is saved in the xml table format. <br><div class="spoiler">  <b class="spoiler_title">Fragment of a general view of xml report.</b> <div class="spoiler_text"><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0"?&gt;</span></span> <span class="php"><span class="hljs-meta"><span class="php"><span class="hljs-meta">&lt;?</span></span></span><span class="php">mso-application progid=</span><span class="hljs-string"><span class="php"><span class="hljs-string">"Excel.Sheet"</span></span></span><span class="hljs-meta"><span class="php"><span class="hljs-meta">?&gt;</span></span></span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Workbook</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"urn:schemas-microsoft-com:office:spreadsheet"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:o</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"urn:schemas-microsoft-com:office:office"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:x</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"urn:schemas-microsoft-com:office:excel"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:ss</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"urn:schemas-microsoft-com:office:spreadsheet"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:html</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/TR/REC-html40"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DocumentProperties</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"urn:schemas-microsoft-com:office:office"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Author</span></span></span><span class="hljs-tag">&gt;</span></span>Microsoft Corporation<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Author</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LastAuthor</span></span></span><span class="hljs-tag">&gt;</span></span>AlexandeR<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LastAuthor</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LastPrinted</span></span></span><span class="hljs-tag">&gt;</span></span>2012-10-31T10:28:49Z<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LastPrinted</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Created</span></span></span><span class="hljs-tag">&gt;</span></span>1996-10-08T23:32:33Z<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Created</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LastSaved</span></span></span><span class="hljs-tag">&gt;</span></span>2012-11-24T12:30:48Z<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">LastSaved</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Version</span></span></span><span class="hljs-tag">&gt;</span></span>11.9999<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DocumentProperties</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ExcelWorkbook</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"urn:schemas-microsoft-com:office:excel"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">WindowHeight</span></span></span><span class="hljs-tag">&gt;</span></span>7320<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">WindowHeight</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">WindowWidth</span></span></span><span class="hljs-tag">&gt;</span></span>9720<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">WindowWidth</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">WindowTopX</span></span></span><span class="hljs-tag">&gt;</span></span>120<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">WindowTopX</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">WindowTopY</span></span></span><span class="hljs-tag">&gt;</span></span>120<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">WindowTopY</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">RefModeR1C1</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AcceptLabelsInFormulas</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ProtectStructure</span></span></span><span class="hljs-tag">&gt;</span></span>False<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ProtectStructure</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ProtectWindows</span></span></span><span class="hljs-tag">&gt;</span></span>False<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ProtectWindows</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DisplayInkNotes</span></span></span><span class="hljs-tag">&gt;</span></span>False<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">DisplayInkNotes</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ExcelWorkbook</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Styles</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Style</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ss:ID</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Default"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ss:Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Normal"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="xml"><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Alignment</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ss:Vertical</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"Bottom"</span></span></span></span><span class="xml"><span class="hljs-tag">/&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Borders</span></span></span></span><span class="xml"><span class="hljs-tag">/&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Font</span></span></span></span><span class="xml"><span class="hljs-tag">/&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Interior</span></span></span></span><span class="xml"><span class="hljs-tag">/&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">NumberFormat</span></span></span></span><span class="xml"><span class="hljs-tag">/&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Protection</span></span></span></span><span class="xml"><span class="hljs-tag">/&gt;</span></span></span><span class="xml"> </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Style</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Style</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ss:ID</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"s374"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="xml"><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Alignment</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ss:Horizontal</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"Center"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ss:Vertical</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"Bottom"</span></span></span></span><span class="xml"><span class="hljs-tag">/&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Font</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ss:FontName</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"Arial Cyr"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">x:CharSet</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"204"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">x:Family</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"Swiss"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ss:Bold</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ss:Italic</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span></span><span class="xml"><span class="hljs-tag">/&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Protection</span></span></span></span><span class="xml"><span class="hljs-tag">/&gt;</span></span></span><span class="xml"> </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Style</span></span></span><span class="hljs-tag">&gt;</span></span> . . . <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Worksheet</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ss:Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Table</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Column</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ss:AutoFitWidth</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ss:Width</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"14.25"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ss:Span</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"66"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Row</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Cell</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ss:MergeAcross</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"66"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ss:StyleID</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"s374"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Data</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ss:Type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"String"</span></span></span><span class="hljs-tag">&gt;</span></span>     <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Data</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Cell</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Row</span></span></span><span class="hljs-tag">&gt;</span></span> . . . <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">WorksheetOptions</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"urn:schemas-microsoft-com:office:excel"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PageSetup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PageMargins</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">x:Bottom</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.984251969"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">x:Left</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.78740157499999996"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">x:Right</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.78740157499999996"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">x:Top</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0.984251969"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PageSetup</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Print</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ValidPrinterInfo</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PaperSizeIndex</span></span></span><span class="hljs-tag">&gt;</span></span>9<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">PaperSizeIndex</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HorizontalResolution</span></span></span><span class="hljs-tag">&gt;</span></span>600<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">HorizontalResolution</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">VerticalResolution</span></span></span><span class="hljs-tag">&gt;</span></span>600<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">VerticalResolution</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Print</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Selected</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Panes</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Pane</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Number</span></span></span><span class="hljs-tag">&gt;</span></span>3<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Number</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ActiveRow</span></span></span><span class="hljs-tag">&gt;</span></span>25<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ActiveRow</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ActiveCol</span></span></span><span class="hljs-tag">&gt;</span></span>74<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ActiveCol</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Pane</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Panes</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ProtectObjects</span></span></span><span class="hljs-tag">&gt;</span></span>False<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ProtectObjects</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ProtectScenarios</span></span></span><span class="hljs-tag">&gt;</span></span>False<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">ProtectScenarios</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AllowSort</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">AllowFilter</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">WorksheetOptions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Worksheet</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Worksheet</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ss:Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag">&gt;</span></span> . . . <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Worksheet</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Workbook</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br></div></div><br>  In the above fragment, you can see that the list of styles is first created, which is then used to format the cells.  For example: <br><pre> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Style</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ss:ID</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"s374"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="xml"><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Alignment</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ss:Horizontal</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"Center"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ss:Vertical</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"Bottom"</span></span></span></span><span class="xml"><span class="hljs-tag">/&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Font</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ss:FontName</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"Arial Cyr"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">x:CharSet</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"204"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">x:Family</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"Swiss"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ss:Bold</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">ss:Italic</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span></span><span class="xml"><span class="hljs-tag">/&gt;</span></span></span><span class="xml"> </span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">Protection</span></span></span></span><span class="xml"><span class="hljs-tag">/&gt;</span></span></span><span class="xml"> </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Style</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  The following cell references this style: <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Cell</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ss:MergeAcross</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"66"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ss:StyleID</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"s374"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Data</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ss:Type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"String"</span></span></span><span class="hljs-tag">&gt;</span></span>     <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Data</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Cell</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  The ‚ÄúWorksheet‚Äù element creates sheets in an Excel workbook, for example: <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Worksheet</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ss:Name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag">&gt;</span></span> . . . <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Worksheet</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  The ‚ÄúTable‚Äù element creates a table.  The table consists of the rows ‚ÄúRow‚Äù, and the rows in turn from the cells ‚ÄúCell‚Äù. <br>  <b>Step 3.</b> Through any text editor, changes are made to the xml structure by removing unnecessary attributes.  In our case, the attributes are deleted: ss: ExpandedColumnCount = "67";  ss: ExpandedRowCount = "45";  x: FullColumns = "1";  x: FullRows = ‚Äú1‚Äù, since the curriculum has an arbitrary number of disciplines, and if the ‚ÄúTable‚Äù element retains these attributes, an error will occur when generating an Excel document due to a mismatch in the number of rows and columns.  It is also advisable to remove the ss: Height attribute from &lt;Rowss: AutoFitHeight = "0" ss: Height = "13.5"&gt;, since if the line is very long and the cell says "carry by words", then there will be no word wrapping in generated Excel document. <br><br><h4>  XSL Transformation </h4><br>  To use the standard transformation method (in the class% XML.XSLT.Transformer) xml data in the xls format, you need to prepare a special xml block with embedded XSL constructs.  In our case, the Excel template taken in the previous paragraph was taken as the basis for XSL.  This template needs to be improved using the following XSL constructs: <br><ol><li><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre></li><li><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag"> = </span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">""</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre></li></ol><br>  The &lt;xsl: for-each select = ""&gt; &lt;/ xsl: for-each&gt; construct is used to select each xml element of a given set.  The &lt;xsl: value-of select = "" /&gt; construct allows to display the values ‚Äã‚Äãof the selected node.  Below is a simple example of inserting XSL into an Excel template: <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Table</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Curriculum"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"./Cicl"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Row</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Cell</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Data</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ss:Type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"String"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"./CiclName"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Data</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Cell</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Row</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"./Block"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Row</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Cell</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Data</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ss:Type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"String"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"./BlocName"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Data</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Cell</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Row</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"./Disciplines/Discipline"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Row</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Cell</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Data</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ss:Type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"String"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:value-of</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">select</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"./DiscName"</span></span></span><span class="hljs-tag">/&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Data</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Cell</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Row</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">xsl:for-each</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">Table</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  In the given example, it is shown that in the Excel table, in a nested cycle, all elements of ‚ÄúCicl‚Äù are addressed, then in each cycle (an enlarged group of disciplines) to all elements of ‚ÄúBlock‚Äù, then in each block to / Disciplines / Discipline elements, and after This displays the information corresponding to the specified field &lt;xsl: value-ofselect = "./ DiscName" /&gt;, i.e.  names of disciplines. <br>  After the XSL elements have been inserted at the right places in the template, you can begin the report generation process.  To do this, you can create a special method in a certain class that will transform data from the xml format to xls using the prepared Excel template that can be placed in the XData block of the same class (in the example below, the XData block is called "xsl").  An example of this method is shown below. <br><br>  <font color="#000080">ClassMethod</font> <font color="#000000">generateReportStadyPlan (</font> <font color="#ff00ff">outFileName</font> <font color="#000080">As% String</font> <font color="#000000">)</font> <font color="#000080">As% Status</font> <font color="#000080"><br></font>  <font color="#000000">{</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#800000">xslStream</font> <font color="#000000">=</font> <font color="#000080">## class</font> <font color="#000000">(</font> <font color="#008080">% Dictionary.CompiledXData</font> <font color="#000000">).</font>  <font color="#0000ff">% OpenId</font> <font color="#000000">(..</font> <font color="#0000ff">% ClassName</font> <font color="#000000">(1) _</font> <font color="#008000">"|| xsl"</font> <font color="#000000">).</font>  <font color="#0000ff">Data</font> <font color="#0000ff"><br></font>  <font color="#0000ff">set</font> <font color="#800000">xmlStream</font> <font color="#000000">=</font> <font color="#000080">## class</font> <font color="#000000">(</font> <font color="#008080">% FileBinaryStream</font> <font color="#000000">).</font>  <font color="#0000ff">% New</font> <font color="#000000">()</font> <font color="#000000"><br></font>  <font color="#0000ff">set</font> <font color="#800000">xmlStream</font> <font color="#000000">.</font>  <font color="#0000ff">Filename</font> <font color="#000000">=</font> <font color="#008000">"Path to the xml file"</font> <font color="#008000"><br><br></font>  <font color="#0000ff">set</font> <font color="#800000">outStream</font> <font color="#000000">=</font> <font color="#000080">## class</font> <font color="#000000">(</font> <font color="#008080">% FileCharacterStream</font> <font color="#000000">).</font>  <font color="#0000ff">% New</font> <font color="#000000">()</font> <font color="#000000"><br></font>  <font color="#0000ff">set out</font> <font color="#800000">stream</font> <font color="#000000">.</font>  <font color="#0000ff">TranslateTable</font> <font color="#000000">=</font> <font color="#008000">"UTF8"</font> <font color="#008000"><br></font>  <font color="#0000ff">set out</font> <font color="#800000">stream</font> <font color="#000000">.</font>  <font color="#0000ff">Filename</font> <font color="#000000">=</font> <font color="#800000">outFileName</font> <font color="#800000"><br><br></font>  <font color="#0000ff">set</font> <font color="#800000">sc</font> <font color="#000000">=</font> <font color="#000080">## class</font> <font color="#000000">(</font> <font color="#008080">% XML.XSLT.Transformer</font> <font color="#000000">).</font>  <font color="#0000ff">TransformStream</font> <font color="#000000">(</font> <font color="#800000">xmlStream</font> <font color="#000000">,</font> <font color="#800000">xslStream</font> <font color="#800000">,. OutStream</font> <font color="#000000">)</font> <font color="#000000"><br><br></font>  <font color="#0000ff">if $$$ ISERR</font> <font color="#000000">(</font> <font color="#800000">sc</font> <font color="#000000">)</font> <font color="#0000ff">quit</font> <font color="#800000">sc</font> <font color="#800000"><br><br></font>  <font color="#0000ff">quit out</font> <font color="#800000">stream</font> <font color="#000000">.</font>  <font color="#0000ff">% Save</font> <font color="#000000">()</font> <font color="#000000"><br></font>  <font color="#000000">}</font> <br><br>  <font color="#000080">Xdata</font> <font color="#000000">xsl</font> <font color="#000000"><br></font>  <font color="#000000">{</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">xsl: stylesheet</font> <font color="#800000">version</font> <font color="#000000">=</font> <font color="#008000">"1.0"</font> <font color="#800000">xmlns: xsl</font> <font color="#000000">=</font> <font color="#008000">" <a href="http://www.w3.org/1999/XSL/Transform%2522">www.w3.org/1999/XSL/Transform"</a></font> <font color="#008000"><br></font>  <font color="#800000">xmlns</font> <font color="#000000">=</font> <font color="#008000">"urn: schemas-microsoft-com: office: spreads"</font> <font color="#008000"><br></font>  <font color="#800000">xmlns: o</font> <font color="#000000">=</font> <font color="#008000">"urn: schemas-microsoft-com: office: office"</font> <font color="#008000"><br></font>  <font color="#800000">xmlns: x</font> <font color="#000000">=</font> <font color="#008000">"urn: schemas-microsoft-com: office: excel"</font> <font color="#008000"><br></font>  <font color="#800000">xmlns: ss</font> <font color="#000000">=</font> <font color="#008000">"urn: schemas-microsoft-com: office: spreads"</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">xsl: template</font> <font color="#800000">match</font> <font color="#000000">=</font> <font color="#008000">"/"</font> <font color="#000000">&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">xsl: processing-instruction</font> <font color="#800000">name</font> <font color="#000000">=</font> <font color="#008000">"mso-application"</font> <font color="#000000">&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;</font> <font color="#000080">xsl: text</font> <font color="#000000">&gt; progid = "Excel.Sheet" &lt;/</font> <font color="#000080">xsl: text</font> <font color="#000000">&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;/</font> <font color="#000080">xsl: processing-instruction</font> <font color="#000000">&gt;</font> <font color="#000000"><br><br></font>  <font color="#000000">&lt;! -‚Äî Insert Excel Template -&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;/</font> <font color="#000080">xsl: template</font> <font color="#000000">&gt;</font> <font color="#000000"><br></font>  <font color="#000000">&lt;/</font> <font color="#000080">xsl: stylesheet</font> <font color="#000000">&gt;</font> <font color="#000000"><br></font>  <font color="#000000">}</font> <br><br><h4>  Comparing Zen Reports and% XML.Writer </h4><br><table><tbody><tr><th width="100">  Mechanism </th><th>  Benefits </th><th>  disadvantages </th></tr><tr><td>  Zen Reports </td><td>  1. Eliminates unnecessary routine work. <br>  2. The description of the structure is more concise, there is no unnecessary clutter. <br>  3. Ease of perception <br></td><td>  The structure of the output xml is less controlled, you have to follow certain rules </td></tr><tr><td>  % XML.Writer </td><td>  You can create absolutely any xml structure. </td><td>  Great complexity of the description of the structure </td></tr></tbody></table><br>  Based on the specifics of the <a href="http://www.osp.ru/os/2012/07/13017640/">MAC</a> architecture of <a href="http://www.osp.ru/os/2012/07/13017640/">LAM</a> , in which java-projections are created for Cach√© classes, you can add to the additional benefits of% XML.Writer the possibility of projecting the class sp.Report.spExcelWriter, which generates a report.  On the contrary, in Zen Reports it is impossible to get a projection of a report class inherited from% ZEN.Report.reportPage due to the fact that its methods work with streams. <br>  Thus, the use of XML.Writer is advisable in the case of stringent requirements for the structure of the output xml file, and the use of the Zen Reports mechanism is recommended when creating complex reports, which first require a clear description and a reduction in labor intensity. </div><p>Source: <a href="https://habr.com/ru/post/163981/">https://habr.com/ru/post/163981/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../163969/index.html">High-Load cluster organization with several nodes</a></li>
<li><a href="../163971/index.html">Review of the smartphone Meizu MX2</a></li>
<li><a href="../163973/index.html">Ahead of their time</a></li>
<li><a href="../163975/index.html">Solving a recursive logic puzzle in Oracle SQL</a></li>
<li><a href="../163979/index.html">Benchmark HTML parsers</a></li>
<li><a href="../163983/index.html">Why not make a weekly review of the Habrahabr sandbox?</a></li>
<li><a href="../163985/index.html">Autopsy Apple Macintosh LC 580</a></li>
<li><a href="../163989/index.html">Top 5 Things I Learned from IBM Software for System z for Dummies</a></li>
<li><a href="../163991/index.html">Computer in a molded car drive</a></li>
<li><a href="../163997/index.html">Thank you for being with us! Achieve goals in the new year!</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>