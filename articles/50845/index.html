<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Unity First Steps: DI / IoC & AOP</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 If you have ever heard such words as IoC, DI, AoP, but do not have a clear understanding of these terms, I hope this article will help ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Unity First Steps: DI / IoC & AOP</h1><div class="post__text post__text-html js-mediator-article"><h2>  Introduction </h2><br>  If you have ever heard such words as IoC, DI, AoP, but do not have a clear understanding of these terms, I hope this article will help you to go bust using the example of working with a Microsoft Unity container. <br><a name="habracut"></a><br>  So let's get down to the theory: <br><br><h3>  Inversion of Control (IoC) and Dependency Injection (DI) </h3><br>  For the definition of IoC, we turn to <a href="http://ru.wikipedia.org/wiki/%25D0%259E%25D0%25B1%25D1%2580%25D0%25B0%25D1%2589%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5_%25D0%25BA%25D0%25BE%25D0%25BD%25D1%2582%25D1%2580%25D0%25BE%25D0%25BB%25D1%258F">Wikipedia</a> : <br><br><blockquote>  <strong>Inversion of Control</strong> * (IoC) is an important principle of object-oriented programming that is used to reduce connectivity in computer programs. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      IoC is also known as Dependency Injection Principle.  Dependency Injection is used in almost all frameworks.  It is used by programmers using object-oriented programming languages ‚Äã‚Äãsuch as Smalltalk, C ++, Java, or .NET languages. <br></blockquote><br><br>  <em>* Immediately I wanted to make a reservation that I prefer not to use the Russian-language translation for IoC, but still if I am forced to do this, I will use it as a "control inversion"</em> <br><br>  For the definition of DI also turn to <a href="http://ru.wikipedia.org/wiki/%25D0%2592%25D0%25BD%25D0%25B5%25D0%25B4%25D1%2580%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5_%25D0%25B7%25D0%25B0%25D0%25B2%25D0%25B8%25D1%2581%25D0%25B8%25D0%25BC%25D0%25BE%25D1%2581%25D1%2582%25D0%25B8">Wikipedia</a> : <br><br><blockquote>  Dependency injection (eng. Dependency injection) refers to the process of providing external dependency to a software component and is a specific form of ‚Äúinversion of control‚Äù, where changing the order of communication is the way to obtain the required dependency. <br></blockquote><br><br>  <strong><u>The classic example</u></strong> for determining how tightly your objects are linked to each other is to try to copy a class from your subject area to a new application and try to run it, if that doesn't work, then copy the related classes.  Usually, as a result of these manipulations, your old application is almost entirely copied into the new one. <br><br>  To resolve problems of dependencies of one object from another, usually an object that has a dependency is responsible for creating / obtaining the object it needs (I would like to draw your attention to patterns such as <a href="http://martinfowler.com/articles/injection.html">Factory, Registry</a> ). <br><br>  There are a great many examples of implementation with IoC and DI casting a pseudo-code. Therefore, I don‚Äôt really want the article to grow because of them, and I can hardly provide you with a better understanding than with practical use. <br><br>  I think it will be useful to <a href="http://www.hanselman.com/blog/ListOfNETDependencyInjectionContainersIOC.aspx">list the .NET DI / IoC containers here</a> : <br><br><ul><li>  <a href="http://www.castleproject.org/container/index.html"><strong>Castle windsor</strong></a> </li><li>  <a href="http://structuremap.sourceforge.net/"><strong>Structuremap</strong></a> </li><li>  <a href="http://www.springframework.net/"><strong>Spring.NET</strong></a> </li><li>  <a href="http://code.google.com/p/autofac/"><strong>Autofac</strong></a> </li><li>  <a href="http://codeplex.com/unity"><strong>Unity</strong></a> </li><li>  <a href="http://www.puzzleframework.com/"><strong>Puzzle.NFactory</strong></a> </li><li>  <a href="http://ninject.org/"><strong>Ninject</strong></a> </li><li>  <a href="http://s2container.net.seasar.org/en/index.html"><strong>S2Container.NET</strong></a> </li><li>  <strong><a href="http://docs.codehaus.org/display/PICO/Home">PicoContainer.NET</a></strong> </li><li>  <a href="http://www.codeproject.com/KB/cs/LinFuPart1.aspx"><strong>Linfu</strong></a> </li></ul><br><br><h3>  Aspect-oriented programming (AoP) </h3><br><br>  I admit I am a meticulous admirer of <a href="http://ru.wikipedia.org/wiki/AOP">Wikipedia</a> : <br><br><blockquote>  Aspect-oriented programming (AOP) is a programming paradigm based on the idea of ‚Äã‚Äãseparating functionality, especially cross-cutting functionality, to improve program partitioning into modules. <br></blockquote><br><br>  I would like to add that Aspect-oriented programming (AOP) is also intended to come to the aid of the PLO in order to reduce the amount of code written in applications. <br><br>  Most often, the use of AOP is reduced to the implementation of everyday routine tasks such as logging, caching, validation, and access control.  You can argue and say that you can solve this problem by enveloping your business objects of the <a href="http://www.dofactory.com/Patterns/PatternDecorator.aspx">Decorator</a> template ( <a href="">rus.</a> ), But the fact is that this necessitates changing the consumer code, and AOP allows you to do this easily and naturally. <br><br>  Famous frameworks: <br><br><ul><li>  <a href="http://www.postsharp.org/">Postsharp</a> </li><li>  <a href="https://www.academicresourcecenter.net/curriculum/pfv.aspx%3FID%3D6801">Aspect.NET</a> </li><li>  <a href="http://www.rapier-loom.net/">LOOM.NET</a> </li><li>  <a href="http://www.puzzleframework.com/forum/forum.aspx%3FForum%3D24">Puzzle.NAspect</a> </li><li>  <a href="http://sourceforge.net/projects/aspectdng/">AspectDNG</a> </li><li>  <a href="http://www.castleproject.org/AspectSharp">Aspect #</a> </li><li>  <a href="http://theagiledeveloper.com/articles/Encase.aspx">Encase</a> </li><li>  <a href="http://composestar.sourceforge.net/">Compose *</a> </li><li>  <a href="http://www.seasar.org/en/dotnet/">Seasar.NET</a> </li><li>  <a href="http://dotspect.tigris.org/">DotSpect (.SPECT)</a> </li><li>  How Part Of <a href="http://www.springframework.net/">The Spring .NET Framework Functionality</a> </li></ul><br><br><h3>  About Microsoft Enterprise Library </h3><br>  As you know, in October 2008, Microsoft updated the version of the <a href="http://msdn.microsoft.com/en-us/library/dd203099.aspx">Enterprise Library to 4.1</a> , respectively, one of its components of the <a href="http://msdn.microsoft.com/en-us/library/dd140117.aspx">Unity Application Block to version 1.2</a> .  The Microsoft Enterprise Library is developed by the <a href="http://msdn.microsoft.com/practices">patterns &amp; practices</a> group.  The Microsoft Enterprise Library is a set of functional blocks designed to help developers do their usual routine tasks.  Functional blocks - something like a manual, the source code provided in them can be used "as is", can be expanded or modified by developers according to their needs.  Microsoft Enterprise Library consists of the following blocks: <br><br><ul><li>  <a href="http://msdn.microsoft.com/en-us/library/dd203226.aspx">Caching Application Block</a> .  Developers can use this block to implement caching in their applications.  It also supports cache connectors. </li><li>  <a href="http://msdn.microsoft.com/en-us/library/dd139964.aspx">Cryptography Application Block</a> .  Developers can use this block to implement hashing and symmetric encryption in applications. </li><li>  <a href="http://msdn.microsoft.com/en-us/library/dd203144.aspx">Data Access Application Block</a> .  Developers can use this block to implement standard database actions in their applications. </li><li>  <a href="http://msdn.microsoft.com/en-us/library/dd203116.aspx">Exception Handling Application Block</a> .  Developers and rule editors can use this block to implement a consistent strategy for handling exceptions that occur across all architectural layers of enterprise applications. </li><li>  <a href="http://msdn.microsoft.com/en-us/library/dd139916.aspx">Logging Application Block</a> .  Developers can use this block to implement standard logging functions. </li><li>  <a href="http://msdn.microsoft.com/en-us/library/dd139982.aspx">Policy Injection Application Block</a> .  Developers can use this block to implement interception policies in order to saturate the application with features such as logging, caching, exception handling, and validation at the application level. </li><li>  <a href="http://msdn.microsoft.com/en-us/library/dd203356.aspx">Security Application Block</a> .  Developers can use this block to implement an application authorization and security mechanism. </li><li>  <a href="http://msdn.microsoft.com/en-us/library/dd140117.aspx">Unity Application Block</a> .  Developers can use this block as a lightweight, expandable dependency injection container with support for introducing dependencies into the constructor, the property and the method call, in the same way as the interception implementation, through extensions. </li><li>  <a href="http://msdn.microsoft.com/en-us/library/dd140088.aspx">Validation Application Block</a> .  Developers can use this block to implement validation rules for business objects used in the application. </li></ul><br><br><h3>  About Unity Application Block </h3><br><br>  a lightweight, extensible, injection-dependent container with support for adding dependencies to the constructor, the property and the method call, in the same way as the implementation of interception through extensions.  You can use it with the Enterprise Library (EntLib) to generate objects, both your own and the Enterprise Library.  However, the Unity Application Block differs from the rest of the EntLib function blocks at several key points: <br><br><ul><li>  You can use the Unity Application Block as a standalone dependency injection engine without needing an installed EntLib. </li><li>  The Unity Application Block can be configured using specialized configuration files or in run-time mode using your code. </li><li>  The Unity Application Block is independent of the core EntLib, exactly like the EntLib configuration system.  It contains its own configuration mechanism, although if you prefer, you can use the EntLib configuration mechanism. </li></ul><br><br><h3>  Long-awaited In Action </h3><br><br><h4>  Requirements </h4><br><br>  For the example below, we‚Äôll need: <br><br><ol><li>  Installed <a href="http://www.microsoft.com/downloads/details.aspx%3Fdisplaylang%3Dru%26amp%3BFamilyID%3Dab99342f-5d1a-413d-8319-81da479ab0d7">.NET Framework 3.5 SP1</a> </li><li>  Your favorite IDE (Notepad .. <a href="http://www.microsoft.com/downloads/details.aspx%3FFamilyID%3D3254c868-bcb9-412c-95c6-d100c872ec60%26amp%3BDisplayLang%3Dru">Visual Studio 2008 SP1</a> ) </li><li>  Installed <a href="http://www.codeplex.com/unity/Release/ProjectReleases.aspx%3FReleaseId%3D18855">Unity</a> </li><li>  15-20 min time and some interest </li></ol><br><br><h4>  Process </h4><br><br>  First, create a ConsoleApplication called UnityInAction1. <br><br>  Next, add links to the following assembly: <br><br><ul><li>  Microsoft.Pratices.ObjectBulder2 </li><li>  Microsoft.Pratices.Unity </li><li>  Microsoft.Pratices.Unity.Interception. </li></ul><br><br>  Create an ILogger interface in our application: <br><br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#000000"><font color="#0000ff">namespace</font> UnityInAction1 { <font color="#0000ff">interface</font> ILogger { <font color="#0000ff">void</font> Write( <font color="#0000ff">string</font> msg); } } <br></font> <font color="#808080">* This source code was highlighted with <font color="#808080">Source Code Highlighter</font> .</font></code> <ol><li> <code><font color="#000000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">namespace</font> UnityInAction1 { <font color="#0000ff">interface</font> ILogger { <font color="#0000ff">void</font> Write( <font color="#0000ff">string</font> msg); } } <br> <font color="#808080">* This source code was highlighted with <font color="#808080">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="#000000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">namespace</font> UnityInAction1 { <font color="#0000ff">interface</font> ILogger { <font color="#0000ff">void</font> Write( <font color="#0000ff">string</font> msg); } } <br> <font color="#808080">* This source code was highlighted with <font color="#808080">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="#000000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">namespace</font> UnityInAction1 { <font color="#0000ff">interface</font> ILogger { <font color="#0000ff">void</font> Write( <font color="#0000ff">string</font> msg); } } <br> <font color="#808080">* This source code was highlighted with <font color="#808080">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="#000000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">namespace</font> UnityInAction1 { <font color="#0000ff">interface</font> ILogger { <font color="#0000ff">void</font> Write( <font color="#0000ff">string</font> msg); } } <br> <font color="#808080">* This source code was highlighted with <font color="#808080">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="#000000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">namespace</font> UnityInAction1 { <font color="#0000ff">interface</font> ILogger { <font color="#0000ff">void</font> Write( <font color="#0000ff">string</font> msg); } } <br> <font color="#808080">* This source code was highlighted with <font color="#808080">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="#000000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">namespace</font> UnityInAction1 { <font color="#0000ff">interface</font> ILogger { <font color="#0000ff">void</font> Write( <font color="#0000ff">string</font> msg); } } <br> <font color="#808080">* This source code was highlighted with <font color="#808080">Source Code Highlighter</font> .</font></font></code> </li> <li> <code><font color="#000000"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">namespace</font> UnityInAction1 { <font color="#0000ff">interface</font> ILogger { <font color="#0000ff">void</font> Write( <font color="#0000ff">string</font> msg); } } <br> <font color="#808080">* This source code was highlighted with <font color="#808080">Source Code Highlighter</font> .</font></font></code> </li> </ol> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#000000"><font color="#0000ff">namespace</font> UnityInAction1 { <font color="#0000ff">interface</font> ILogger { <font color="#0000ff">void</font> Write( <font color="#0000ff">string</font> msg); } } <br></font> <font color="#808080">* This source code was highlighted with <font color="#808080">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  Next we implement it in the Logger class: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">using</font> System; </li><li></li><li>  <font color="#0000ff">namespace</font> UnityInAction1 </li><li>  { </li><li>  <font color="#0000ff">class</font> Logger: ILogger </li><li>  { </li><li>  <font color="#0000ff">#region</font> ILogger Members </li><li></li><li>  <font color="#0000ff">public</font> <font color="#0000ff">void</font> Write ( <font color="#0000ff">string</font> msg) </li><li>  { </li><li>  <font color="#2b91af">Console</font> .WriteLine (); </li><li>  <font color="#2b91af">Console</font> .WriteLine ( <font color="#a31515">"*** In logger ***"</font> ); </li><li>  <font color="#2b91af">Console</font> .WriteLine ( <font color="#2b91af">String</font> .Format ( <font color="#a31515">"message {0}"</font> , msg)); </li><li>  } </li><li></li><li>  <font color="#0000ff">#endregion</font> </li><li>  } </li><li>  } </li></ol><br>  <font color="#808080">* This source code was highlighted with <font color="#808080">Source Code Highlighter</font> .</font> </blockquote><br><br>  So our usual application would look: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">using</font> System; </li><li></li><li>  <font color="#0000ff">namespace</font> UnityInAction1 </li><li>  { </li><li>  <font color="#0000ff">class</font> program </li><li>  { </li><li>  <font color="#0000ff">static</font> <font color="#0000ff">void</font> Main ( <font color="#0000ff">string</font> [] args) </li><li>  { </li><li>  ILogger logger = <font color="#0000ff">new</font> Logger (); </li><li>  logger.Write ( <font color="#a31515">"My message"</font> ); </li><li>  <font color="#2b91af">Console</font> .ReadKey (); </li><li>  } </li><li>  } </li><li>  } </li></ol><br>  <font color="#808080">* This source code was highlighted with <font color="#808080">Source Code Highlighter</font> .</font> </blockquote><br><br>  However, from the point of view of the IoC / DI approach, this does not quite suit us, so we want to place our Logger in a container (for example, in order to replace [and it will only be necessary to replace the container configuration site, and not the entire coverage code, as it usually happens] on the stub when testing): <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">using</font> System; </li><li>  <font color="#0000ff">using</font> Microsoft.Practices.Unity; </li><li></li><li>  <font color="#0000ff">namespace</font> UnityInAction1 </li><li>  { </li><li>  <font color="#0000ff">class</font> program </li><li>  { </li><li>  <font color="#0000ff">static</font> <font color="#0000ff">void</font> Main ( <font color="#0000ff">string</font> [] args) </li><li>  { </li><li>  IUnityContainer container = <font color="#0000ff">new</font> UnityContainer (); </li><li>  container.RegisterType &lt;ILogger, Logger&gt; ( <font color="#0000ff">new</font> ContainerControlledLifetimeManager ()); </li><li></li><li>  <font color="#0000ff">var</font> logger = container.Resolve &lt;ILogger&gt; (); </li><li>  logger.Write ( <font color="#a31515">"My message"</font> ); </li><li>  <font color="#2b91af">Console</font> .ReadKey (); </li><li>  } </li><li>  } </li><li>  } </li></ol><br>  <font color="#808080">* This source code was highlighted with <font color="#808080">Source Code Highlighter</font> .</font> </blockquote><br><br>  Well, I think this example is quite enough to start. <br><br>  Now we add the requirement for measuring the execution time of the ILogger.Write () method for all implementations of this interface, it is clear that with the help of the OOP, the implementation of this condition becomes more difficult, therefore we will look at this example from the point of view of AOP.  First, let's override the description of ILogger by introducing a <a href="http://msdn.microsoft.com/en-us/magazine/cc163802.aspx">new</a> .NET <a href="http://msdn.microsoft.com/en-us/magazine/cc163802.aspx">attribute</a> : <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">namespace</font> UnityInAction1 </li><li>  { </li><li>  <font color="#0000ff">interface</font> ILogger </li><li>  { </li><li>  [Stopwatch] </li><li>  <font color="#0000ff">void</font> Write ( <font color="#0000ff">string</font> msg); </li><li>  } </li><li>  } </li></ol><br>  <font color="#808080">* This source code was highlighted with <font color="#808080">Source Code Highlighter</font> .</font> </blockquote><br><br>  Description of the Stopwatch attribute: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">using</font> System; </li><li>  <font color="#0000ff">using</font> Microsoft.Practices.Unity.InterceptionExtension; </li><li></li><li>  <font color="#0000ff">namespace</font> UnityInAction1 </li><li>  { </li><li>  <font color="#0000ff">class</font> Stopwatch: HandlerAttribute </li><li>  { </li><li>  <font color="#0000ff">public</font> <font color="#0000ff">override</font> ICallHandler CreateHandler (Microsoft.Practices.Unity.IUnityContainer container) </li><li>  { </li><li>  <font color="#0000ff">return</font> <font color="#0000ff">new</font> StopwatchCallHandler (); </li><li>  } </li><li>  } </li><li></li><li>  <font color="#0000ff">public</font> <font color="#0000ff">class</font> StopwatchCallHandler: ICallHandler </li><li>  { </li><li>  <font color="#0000ff">public</font> <font color="#0000ff">int</font> Order { <font color="#0000ff">get</font> ;  <font color="#0000ff">set</font> ;} </li><li></li><li>  <font color="#0000ff">public</font> StopwatchCallHandler (): <font color="#0000ff">this</font> (0) {} </li><li></li><li>  <font color="#0000ff">public</font> StopwatchCallHandler ( <font color="#0000ff">int</font> order) </li><li>  { </li><li>  Order = order; </li><li>  } </li><li></li><li>  <font color="#0000ff">#region</font> ICallHandler Members </li><li></li><li>  <font color="#0000ff">public</font> IMethodReturn Invoke (IMethodInvocation input, GetNextHandlerDelegate getNext) </li><li>  { </li><li>  System.Diagnostics.Stopwatch sw = <font color="#0000ff">new</font> System.Diagnostics.Stopwatch (); </li><li>  sw.Start (); </li><li></li><li>  <font color="#0000ff">var</font> result = getNext (). Invoke (input, getNext); </li><li></li><li>  sw.Stop (); </li><li></li><li>  <font color="#2b91af">Console</font> .WriteLine (); </li><li>  <font color="#2b91af">Console</font> .WriteLine ( <font color="#2b91af">String</font> .Format ( <font color="#a31515">"</font> Elapsed <font color="#a31515">time {0} ms"</font> , sw.ElapsedMilliseconds)); </li><li></li><li>  <font color="#0000ff">return</font> result; </li><li>  } </li><li></li><li>  <font color="#0000ff">#endregion</font> </li><li>  } </li><li>  } </li></ol><br>  <font color="#808080">* This source code was highlighted with <font color="#808080">Source Code Highlighter</font> .</font> </blockquote><br><br>  Well, add an extension for our container: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">using</font> System; </li><li>  <font color="#0000ff">using</font> Microsoft.Practices.Unity; </li><li>  <font color="#0000ff">using</font> Microsoft.Practices.Unity.InterceptionExtension; </li><li></li><li>  <font color="#0000ff">namespace</font> UnityInAction1 </li><li>  { </li><li>  <font color="#0000ff">class</font> program </li><li>  { </li><li>  <font color="#0000ff">static</font> <font color="#0000ff">void</font> Main ( <font color="#0000ff">string</font> [] args) </li><li>  { </li><li>  IUnityContainer container = <font color="#0000ff">new</font> UnityContainer (); </li><li>  container.RegisterType &lt;ILogger, Logger&gt; ( <font color="#0000ff">new</font> ContainerControlledLifetimeManager ()); </li><li>  container.AddNewExtension &lt;Interception&gt; (); </li><li>  container.Configure &lt;Interception&gt; () </li><li>  .SetInterceptorFor &lt;ILogger&gt; ( <font color="#0000ff">new</font> TransparentProxyInterceptor ()); </li><li></li><li>  <font color="#0000ff">var</font> logger = container.Resolve &lt;ILogger&gt; (); </li><li>  logger.Write ( <font color="#a31515">"My message"</font> ); </li><li>  <font color="#2b91af">Console</font> .ReadKey (); </li><li>  } </li><li>  } </li><li>  } </li></ol><br>  <font color="#808080">* This source code was highlighted with <font color="#808080">Source Code Highlighter</font> .</font> </blockquote><br><br>  Now every implementation of ILogger.Write () will output measurements of the execution time of this method, isn't that great? <br><br><h4>  Materials </h4><br><br><ul><li>  The writing of this article was initiated by viewing a small <a href="http://www.pnpguidance.net/Screencast/UnityInterceptionExtensionRemotingPolicyInjectorScreencastUnityTutorials.aspx">screencast</a> from <a href="http://www.davidhayden.com/">David Hayden</a> .  Code samples with minor corrections are borrowed from it. </li><li>  When writing an article, I was mainly guided by the basic knowledge that was once gathered from the wonderful book <a href="http://www.books.ru/shop/books/536846%3Fpartner%3Dbutaji">‚ÄúApplying Domain-Driven Design and Patterns‚Äù by Jimmy Nilsson</a> . </li><li>  Just a wonderful wealth of knowledge <a href="http://ru.wikipedia.org/wiki/%25D0%2592%25D0%25B8%25D0%25BA%25D0%25B8%25D0%25BF%25D0%25B5%25D0%25B4%25D0%25B8%25D1%258F">Wikipedia</a> . </li></ul><br><br><h4>  In conclusion </h4><br><br>  I hope this article gives a good start to your research in the field of quality code. <br><br>  PS This is my first post on Habr√©, so a <a href="http://butaji.wordpress.com/">little about myself</a> : the horizon of my interests is very wide, in its technical component it is .NET development (ASP.NET, Sharepoint, WWF, Silverlight), development techniques (Agile, Scrum, XP), engineering techniques (TDD, DDD, MDA, AOP). </div><p>Source: <a href="https://habr.com/ru/post/50845/">https://habr.com/ru/post/50845/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../50836/index.html">Cancel or cancel?</a></li>
<li><a href="../50837/index.html">Rasterization in Inkscape</a></li>
<li><a href="../50840/index.html">3 simple tips that will make your Rails application faster, part # 1</a></li>
<li><a href="../50841/index.html">mp3 bathroom mirror</a></li>
<li><a href="../50843/index.html">netbook poems</a></li>
<li><a href="../50846/index.html">Check file for existence / existence</a></li>
<li><a href="../50847/index.html">netbook poems</a></li>
<li><a href="../50849/index.html">Positive and negative motivation</a></li>
<li><a href="../50850/index.html">New Cities in MyClime</a></li>
<li><a href="../50851/index.html">Base hosting companies, data centers, proxies, bots and satellites.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>