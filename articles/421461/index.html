<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Google Scripts, Docs and Spreadsheets Time Tracker</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The previous article dealt with the approach to the technical task in Decart IT production. When we implemented these changes, projects were conducted...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Google Scripts, Docs and Spreadsheets Time Tracker</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/jz/tg/qb/jztgqbgsgu_y9e8tum1-ivavc_a.png"><br><br>  The <a href="https://habr.com/post/418199/">previous article</a> dealt with the approach to the technical task in Decart IT production.  When we implemented these changes, projects were conducted in cloud Jira, but its potential was used to a minimum.  For a small company, a fairly competent task setting, time tracker, bug tracker and project and team statistics.  It was much more convenient for the team to work with TK as a single document than with separate tasks in Jira, if only because of the ease of navigation in Google Docs (hereinafter - Docs).  At the very beginning of work on a new TZ, thoughts appeared to simplify the process of work, somehow ‚Äúfinishing‚Äù Docs, but a series of projects did not leave time to dive into this question.  And so, when time was found, I made a list of goals that we wanted to achieve: <br><br><ol><li>  Time keeping in docs </li><li>  Reporting on staff time </li><li>  Reporting on project work </li><li>  Reducing the time to work with the system itself in the course of project implementation </li><li>  Avoid duplication of one information in different places. </li><li>  Spend a minimum of company resources </li></ol><br>  But first, let's talk about technology. <br><a name="habracut"></a><br><h2>  Google scripts </h2><br>  Google Apps Script (hereinafter referred to as GAS) is a JavaScript dialect for creating automation scripts and extensions for Google services.  Although GAS is not very popular in the Russian-speaking Internet community, there is no reason to doubt its usefulness.  GAS is a good tool for automating various business processes, as it has a wide range of integrations.  At the moment, the language has classes and methods for working with the following services: Tables, Documents, Forms, Disk, Gmail, Calendar, Contacts, Maps, Groups, Translator. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      One script can work with several services at once, which will allow you to create a combination of tools suitable for your task. <br><br>  Also, with the help of Google Apps Script, you can create full-fledged web applications with graphical HTML interfaces / embed Google Apps Script on your websites.  The simplest example: make a website a form for downloading files from a computer to Google Drive <br><br>  In the end, I would like to note the following advantages: <br><br><ol><li>  Gas is quite easy to use. </li><li>  A wide range of integrations with various services </li><li>  Works in the cloud </li><li>  Convenient tools for debugging and logging </li><li>  The ability to fine-tune access rights </li></ol><br>  As constraints, we note the following: <br><br><ol><li>  Limits on the number of requests, the number of documents created, etc.  The limit on the maximum execution time can force you to spend more time on code optimization than you would like </li><li>  Has some restrictions with CSS </li><li>  You must have a Google account to design and use extensions. </li></ol><br>  In general, GAS is an excellent tool for automating business processes of small companies, but can also be used for more serious tasks. <br><br>  We now turn directly to the implementation. <br><br><h2>  Structure </h2><br>  For storing and visualizing data, we decided to use Google Spreadsheets and built a simple architecture based on three tables. <br><br><h3>  Table ‚ÄúLabor‚Äù </h3><br>  We did it right away for a year.  Sheets - months.  Columns: <br><br><ol><li>  Day of month </li><li>  Who </li><li>  Project </li><li>  Task id </li><li>  Noted time </li><li>  Comment </li></ol><br><img src="https://habrastorage.org/webt/ei/dd/bw/eiddbwzmjssa8wpl4z5tkxutik8.png"><br><br>  In fact, this is our base, on the basis of which other tables are formed.  Each line represents a separate record of labor costs. <br><br><h3>  Table ‚ÄúMonthly Report‚Äù </h3><br>  It is needed so that both the employee and the management saw on which day over which projects and how much was worked.  Sheets - employees.  Columns: <br><br><ol><li>  Day of month </li><li>  Worked for the day </li><li>  Project </li><li>  Task id </li><li>  Task </li><li>  Noted time </li><li>  Comment </li></ol><br><img src="https://habrastorage.org/webt/2i/yu/jp/2iyujp2vucap5magljvazy5m3hu.png"><br><br>  The number and total time for this number are on a separate line, the labor costs themselves are lower. <br><br><h3>  Table ‚ÄúProject Work‚Äù </h3><br>  It allows you to understand the time allotted for the task, how much has already been spent, how many hours each department has left (design, front-end, back-end).  Sheets are product versions.  Columns: <br><br><ol><li>  Section TK (h1 headers) </li><li>  Task id </li><li>  Task </li><li>  On 2 columns on each department: it is fulfilled and an assessment (in hours) </li><li>  Total </li><li>  Balance.  Grade minus spent </li><li>  Who worked on the task and how much spent </li></ol><br><img src="https://habrastorage.org/webt/mb/jg/px/mbjgpxbekpvb5z-89oaug5v235y.png"><br><br>  The last line is a summary of the DL columns. <br><br><h2>  How it works </h2><br>  We wrote this add-on in google scripts, which after installation can be used in any Google Document using the ‚ÄúAdd-ons‚Äù tab.  When all documents are signed with the customer, we make a copy of the TZ, with which we will continue to work.  During project initialization, it is checked whether the table ‚ÄúProject Work‚Äù has already been created.  If not, a new one is created.  If so, a new sheet is added to the old one.  For correct work, of course, it is necessary to name the files according to the template chosen by us, but this can be omitted. <br><br><img src="https://habrastorage.org/webt/-r/ek/ok/-rekokn9snvcxz6f57ctg-iuz_e.png"><br><br>  All tasks should have the following name: <br>  Task_name (design_time_value + time_first_time_value + time_back__time_value) [task_id]. <br>  The ID is generated automatically when the project is initialized. <br><br>  Now the file is ready for work.  To mark the time, you need to put the cursor on the task header, and in the menu select the item ‚ÄúAdd labor costs‚Äù, when you click on it, a window will open. <br><br><img src="https://habrastorage.org/webt/bp/pf/lt/bppfltvw5mjjnz-cb42mfvgbgfq.png"><br><br>  Man-hours are immediately added to all the above tables.  Under the title of the task in Docs appears the line "Participants", where all those who worked on it with the indication of the marked hours are listed. <br><br><img src="https://habrastorage.org/webt/mu/zr/ui/muzrui8cl2gc0_kavywuesmhs9c.png"><br><br><h2>  Bugtracker </h2><br>  For each project, in addition to the files with the TZ versions, we create a file with errors, which in terms of the system is the same version.  Evaluation of tasks (time paid by the Customer) will be zeros. <br><br>  But unlike the file with TZ, it will be constantly replenished.  In this case, we implemented a single addition of the task, as well as a change in the name / evaluation of the task in the tables, if they have changed. <br><br>  To prevent the bugs from being lost in this file, we duplicate the headings of all the fresh tasks into a separate chat in the telegram indicating the project, the level of importance and the responsible developer.  When the bug is fixed, the developer responds with a plus, and the PM checks and removes from the chat all messages related to this bug.  Thus, the goal is an empty chat. <br><br>  Yes, in terms of the bugtracker, we could come up with a more elegant solution, but this approach did not require any modifications from us, and at the same time it showed itself well. <br><br><h2>  Future plans </h2><br>  At the moment we have done the MVP, and in the future we will implement at least task statuses (now it's just a highlight) and basic financial statistics, without turning the project into a Frankenstein monster. <br><br>  Thank you for reading to the end, and have a nice day! </div><p>Source: <a href="https://habr.com/ru/post/421461/">https://habr.com/ru/post/421461/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../421445/index.html">Writing a simple Lisp translator - II</a></li>
<li><a href="../421447/index.html">Redmadrobot iOS Meetup</a></li>
<li><a href="../421451/index.html">How to protect your child from garbage on YouTube and make a custom player with a white list of channels</a></li>
<li><a href="../421453/index.html">Situation: Sonos entered the stock exchange and may "leave the room"</a></li>
<li><a href="../421455/index.html">In Japan, the world's first clinical trials for the treatment of Parkinson's disease using stem cells began.</a></li>
<li><a href="../421463/index.html">Nightlife sky or in search of Perseid - processing</a></li>
<li><a href="../421465/index.html">Mobile DevOps in practice</a></li>
<li><a href="../421467/index.html">Developing a golf ball collecting robot</a></li>
<li><a href="../421469/index.html">Telegram agreed to transfer to the special services [but not Russian] IP-addresses and numbers of some users</a></li>
<li><a href="../421471/index.html">Ad Exchange Server - not like others</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>