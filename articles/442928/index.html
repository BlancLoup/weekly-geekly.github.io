<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We write flexible code using SOLID</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="From the translator: published for you an article by Severin Peres about using the SOLID principles in programming. Information from the article will ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We write flexible code using SOLID</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/fa6/4f8/79c/fa64f879ca7b67d6676536abfb111655.jpg"><br><br>  <i><b>From the translator:</b> published for you <a href="https://medium.com/%40severinperez/writing-flexible-code-with-the-single-responsibility-principle-b71c4f3f883f">an article by Severin Peres</a> about using the SOLID principles in programming.</i>  <i>Information from the article will be useful for both beginners and programmers with experience.</i> <br><br>  If you are developing, you‚Äôve probably heard about the principles of SOLID.  They enable the programmer to write clean, well-structured and easily maintainable code.  It is worth noting that in programming there are several approaches to how to properly perform this or other work.  Different specialists have different ideas and an understanding of the ‚Äúright way‚Äù; everything depends on the experience of each.  Nevertheless, the ideas proclaimed in SOLID are accepted by almost all representatives of the IT community.  They became the starting point for the emergence and development of many good development management methods. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Let's understand what SOLID principles are and how they help us. <br><a name="habracut"></a><br><blockquote>  <b>Skillbox recommends:</b> Practical course <a href="https://skillbox.ru/agima/%3Futm_source%3Dskillbox.media%26utm_medium%3Dhabr.com%26utm_campaign%3DAGIMA%26utm_content%3Darticles%26utm_term%3Dsolid">"Mobile Developer PRO"</a> . <br><br>  <b>We remind:</b> <i>for all readers of "Habr" - a discount of 10,000 rubles when recording for any Skillbox course on the promotional code "Habr".</i> </blockquote><br><h3>  What is SOLID? </h3><br>  This term is an abbreviation, each letter of the term is the beginning of the name of a certain principle: <br><ul><li>  <b>S</b> ingle Responsibility Principle (the principle of sole responsibility).  A module can have one and only one reason for the change. </li><li>  <a href="https://medium.com/%40severinperez/maintainable-code-and-the-open-closed-principle-b088c737262">The <b>O</b> pen / Closed Principle</a> (principle of openness / closeness).  Classes and other elements should be open for expansion, but closed for modification. </li><li>  <a href="https://medium.com/%40severinperez/making-the-most-of-polymorphism-with-the-liskov-substitution-principle-e22609866429">The <b>L</b> iskov Substitution Principle</a> (Liskov substitution principle).  Functions that use the base type should be able to use subtypes of the base type without knowing it. </li><li>  <a href="https://medium.com/%40severinperez/avoiding-interface-pollution-with-the-interface-segregation-principle-5d3859c21013">The <b>I</b> nterface Segregation Principle</a> .  Software entities should not depend on methods that they do not use. </li><li>  <a href="https://medium.com/%40severinperez/effective-program-structuring-with-the-dependency-inversion-principle-2d5adf11f863">The <b>D</b> ependency Inversion Principle</a> .  The modules of the upper levels should not depend on the modules of the lower levels. </li></ul><br><h3>  Principle of sole responsibility </h3><br>  The principle of single responsibility (SRP) states that each class or module in a program should be responsible only for one part of the functionality of this program.  In addition, the elements of this responsibility should be assigned to their class, and not distributed to unrelated classes.  SRP developer and chief evangelist, Robert S. Martin, describes responsibility as the cause of change.  Initially, he proposed this term as one of the elements of his work, Principles of Object-Oriented Design.  The concept includes much of the pattern of connectivity, which was previously defined by Tom DeMarco. <br><br>  Even the concept included several concepts formulated by David Parnassus.  The two main ones are encapsulation and information hiding.  Parnassus argued that the division of the system into separate modules should not be based on the analysis of flowcharts or execution threads.  Any of the modules must contain a specific solution that provides a minimum of information to customers. <br><br>  By the way, Martin gave an interesting example with the company's top managers (COO, CTO, CFO), each of which uses specific business software for a different purpose.  As a result, any of them can introduce changes in software without affecting the interests of other managers. <br><br><h3>  Divine object </h3><br>  As usual, the best way to learn SRP is to see everything in action.  Let's look at the site of the program, which is NOT consistent with the principle of common responsibility.  This is a Ruby code that describes the behavior and attributes of the space station. <br><br>  See an example and try to determine the following: <br>  Responsibilities of those objects that are declared in the class SpaceStation. <br>  Those who may be interested in the work of the space station. <br><br><pre><code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SpaceStation</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">initialize</span></span></span><span class="hljs-class"> @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">supplies</span></span></span><span class="hljs-class"> = {} @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">fuel</span></span></span><span class="hljs-class"> = 0 </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">run_sensors</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">puts</span></span></span><span class="hljs-class"> "----- </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Sensor</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Action</span></span></span><span class="hljs-class"> -----" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">puts</span></span></span><span class="hljs-class"> "</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Running</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sensors!</span></span></span><span class="hljs-class">" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">load_supplies</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">quantity</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">puts</span></span></span><span class="hljs-class"> "----- </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Supply</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Action</span></span></span><span class="hljs-class"> -----" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">puts</span></span></span><span class="hljs-class"> "</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Loading</span></span></span><span class="hljs-class"> </span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment">#{quantity} units of #{type} in the supply hold." if </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@supplies</span></span></span></span><span class="hljs-class"><span class="hljs-comment">[type] </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@supplies</span></span></span></span><span class="hljs-class"><span class="hljs-comment">[type] += quantity else </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@supplies</span></span></span></span><span class="hljs-class"><span class="hljs-comment">[type] = quantity end end def use_supplies(type, quantity) puts "----- Supply Action -----" if </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@supplies</span></span></span></span><span class="hljs-class"><span class="hljs-comment">[type] != nil &amp;&amp; </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@supplies</span></span></span></span><span class="hljs-class"><span class="hljs-comment">[type] &gt; quantity puts "Using #{quantity} of #{type} from the supply hold." </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@supplies</span></span></span></span><span class="hljs-class"><span class="hljs-comment">[type] -= quantity else puts "Supply Error: Insufficient #{type} in the supply hold." end end def report_supplies puts "----- Supply Report -----" if </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@supplies</span></span></span></span><span class="hljs-class"><span class="hljs-comment">.keys.length &gt; 0 </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@supplies</span></span></span></span><span class="hljs-class"><span class="hljs-comment">.each do |type, quantity| puts "#{type} avalilable: #{quantity} units" end else puts "Supply hold is empty." end end def load_fuel(quantity) puts "----- Fuel Action -----" puts "Loading #{quantity} units of fuel in the tank." </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@fuel</span></span></span></span><span class="hljs-class"><span class="hljs-comment"> += quantity end def report_fuel puts "----- Fuel Report -----" puts "#{</span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@fuel</span></span></span></span><span class="hljs-class"><span class="hljs-comment">} units of fuel available." end def activate_thrusters puts "----- Thruster Action -----" if </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@fuel</span></span></span></span><span class="hljs-class"><span class="hljs-comment"> &gt;= 10 puts "Thrusting action successful." </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@fuel</span></span></span></span><span class="hljs-class"><span class="hljs-comment"> -= 10 else puts "Thruster Error: Insufficient fuel available." end end end</span></span></span></span></code> </pre> <br>  Actually, our space station is non-functional (I think that I will not receive a call from NASA in the near foreseeable future), but here there is something to analyze. <br><br>  So, the SpaceStation class has several different responsibilities (or tasks).  All of them can be broken down by type: <br><ul><li>  sensors; </li><li>  supply (consumables); </li><li>  fuel; </li><li>  accelerators. </li></ul><br>  Despite the fact that none of the station staff is defined in the classroom, we can easily imagine who is responsible for what.  Most likely, the scientist controls the sensors, the logistician is responsible for the supply of resources, the engineer is responsible for the fuel reserves, and the pilot controls the accelerators. <br><br>  Can we say that this program does not comply with the SRP?  Yes of course.  But the SpaceStation class is a typical ‚Äúdivine object,‚Äù who knows everything and does everything.  This is the main anti-pattern in object-oriented programming.  For a beginner, such objects are extremely difficult to maintain.  So far, the program is very simple, yes, but imagine what happens if we add new features.  Perhaps our space station will need a medical station or a meeting room.  And the more functions there are, the more SpaceStation will grow.  Well, since this object will be connected with others, the maintenance of the entire complex will become even more difficult.  As a result, we can disrupt the work, for example, accelerators.  If a researcher asks for changes in the work with the sensors, this may well affect the station's communication systems. <br><br>  Violation of the SRP principle can give a short-term tactical victory, but in the end we will ‚Äúlose the war‚Äù, it will be very difficult to serve such a monster in the future.  It is best to divide the program into separate sections of code, each of which is responsible for performing a specific operation.  Understanding this, let's change the SpaceStation class. <br><br>  <b>Assign responsibility</b> <br><br>  Above, we defined four types of operations that are controlled by the SpaceStation class.  When refactoring, we will have them in mind.  Updated code is more consistent with SRP. <br><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SpaceStation</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr_reader</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sensors</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">supply_hold</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">fuel_tank</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">thrusters</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">initialize</span></span></span><span class="hljs-class"> @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">supply_hold</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SupplyHold</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sensors</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Sensors</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">fuel_tank</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FuelTank</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">thrusters</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Thrusters</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class">(@</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">fuel_tank</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Sensors</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">run_sensors</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">puts</span></span></span><span class="hljs-class"> "----- </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Sensor</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Action</span></span></span><span class="hljs-class"> -----" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">puts</span></span></span><span class="hljs-class"> "</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Running</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sensors!</span></span></span><span class="hljs-class">" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SupplyHold</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr_accessor</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">supplies</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">initialize</span></span></span><span class="hljs-class"> @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">supplies</span></span></span><span class="hljs-class"> = {} </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">load_supplies</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">quantity</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">puts</span></span></span><span class="hljs-class"> "----- </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Supply</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Action</span></span></span><span class="hljs-class"> -----" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">puts</span></span></span><span class="hljs-class"> "</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Loading</span></span></span><span class="hljs-class"> </span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment">#{quantity} units of #{type} in the supply hold." if </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@supplies</span></span></span></span><span class="hljs-class"><span class="hljs-comment">[type] </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@supplies</span></span></span></span><span class="hljs-class"><span class="hljs-comment">[type] += quantity else </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@supplies</span></span></span></span><span class="hljs-class"><span class="hljs-comment">[type] = quantity end end def use_supplies(type, quantity) puts "----- Supply Action -----" if </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@supplies</span></span></span></span><span class="hljs-class"><span class="hljs-comment">[type] != nil &amp;&amp; </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@supplies</span></span></span></span><span class="hljs-class"><span class="hljs-comment">[type] &gt; quantity puts "Using #{quantity} of #{type} from the supply hold." </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@supplies</span></span></span></span><span class="hljs-class"><span class="hljs-comment">[type] -= quantity else puts "Supply Error: Insufficient #{type} in the supply hold." end end def report_supplies puts "----- Supply Report -----" if </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@supplies</span></span></span></span><span class="hljs-class"><span class="hljs-comment">.keys.length &gt; 0 </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@supplies</span></span></span></span><span class="hljs-class"><span class="hljs-comment">.each do |type, quantity| puts "#{type} avalilable: #{quantity} units" end else puts "Supply hold is empty." end end end class FuelTank attr_accessor :fuel def initialize </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@fuel</span></span></span></span><span class="hljs-class"><span class="hljs-comment"> = 0 end def get_fuel_levels </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@fuel</span></span></span></span><span class="hljs-class"><span class="hljs-comment"> end def load_fuel(quantity) puts "----- Fuel Action -----" puts "Loading #{quantity} units of fuel in the tank." </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@fuel</span></span></span></span><span class="hljs-class"><span class="hljs-comment"> += quantity end def use_fuel(quantity) puts "----- Fuel Action -----" puts "Using #{quantity} units of fuel from the tank." </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@fuel</span></span></span></span><span class="hljs-class"><span class="hljs-comment"> -= quantity end def report_fuel puts "----- Fuel Report -----" puts "#{</span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@fuel</span></span></span></span><span class="hljs-class"><span class="hljs-comment">} units of fuel available." end end class Thrusters def initialize(fuel_tank) </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@linked</span></span></span></span><span class="hljs-class"><span class="hljs-comment">_fuel_tank = fuel_tank end def activate_thrusters puts "----- Thruster Action -----" if </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@linked</span></span></span></span><span class="hljs-class"><span class="hljs-comment">_fuel_tank.get_fuel_levels &gt;= 10 puts "Thrusting action successful." </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@linked</span></span></span></span><span class="hljs-class"><span class="hljs-comment">_fuel_tank.use_fuel(10) else puts "Thruster Error: Insufficient fuel available." end end end</span></span></span></span></code> </pre> <br>  There are a lot of changes, the program now looks definitely better.  Now our SpaceStation class has become, rather, a container in which operations for dependent parts are initiated, including a set of sensors, a supply system for consumables, a fuel tank, accelerators. <br><br>  For any of the variables, there is now a corresponding class: Sensors;  SupplyHold;  FuelTank;  Thrusters. <br><br>  There are some important changes in this version of the code.  The fact is that individual functions are not only encapsulated in their own classes, they are organized in such a way as to become predictable and consistent.  We group elements with similar functionality in order to follow the principle of connectivity.  Now, if we need to change the principle of the system, moving from a hash structure to an array, just use the class SupplyHold, we will not have to affect other modules.  Thus, if the logistics officer changes something in his section, the remaining elements of the station will remain intact.  However, the SpaceStation class will not even be aware of the changes. <br><br>  Our space station officers are probably excited about the changes, as they may be requesting those they need.  Please note that the code has methods such as report_supplies and report_fuel contained in the classes SupplyHold and FuelTank.  What happens if the Earth asks to change the way reports are generated?  It will be necessary to change both classes, SupplyHold and FuelTank.  And what if you need to change the method of delivery of fuel and consumables?  You may have to change all the same classes again.  And this is a violation of the SRP principle.  Let's fix it. <br><br><pre> <code class="ruby hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SpaceStation</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr_reader</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sensors</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">supply_hold</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">supply_reporter</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">fuel_tank</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">fuel_reporter</span></span></span><span class="hljs-class">, :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">thrusters</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">initialize</span></span></span><span class="hljs-class"> @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sensors</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Sensors</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">supply_hold</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SupplyHold</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">supply_reporter</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SupplyReporter</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class">(@</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">supply_hold</span></span></span><span class="hljs-class">) @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">fuel_tank</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FuelTank</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">fuel_reporter</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FuelReporter</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class">(@</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">fuel_tank</span></span></span><span class="hljs-class">) @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">thrusters</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Thrusters</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class">(@</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">fuel_tank</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Sensors</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">run_sensors</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">puts</span></span></span><span class="hljs-class"> "----- </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Sensor</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Action</span></span></span><span class="hljs-class"> -----" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">puts</span></span></span><span class="hljs-class"> "</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Running</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sensors!</span></span></span><span class="hljs-class">" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SupplyHold</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr_accessor</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">supplies</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr_reader</span></span></span><span class="hljs-class"> :</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">reporter</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">initialize</span></span></span><span class="hljs-class"> @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">supplies</span></span></span><span class="hljs-class"> = {} </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">get_supplies</span></span></span><span class="hljs-class"> @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">supplies</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">end</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">def</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">load_supplies</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">type</span></span></span><span class="hljs-class">, </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">quantity</span></span></span><span class="hljs-class">) </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">puts</span></span></span><span class="hljs-class"> "----- </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Supply</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Action</span></span></span><span class="hljs-class"> -----" </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">puts</span></span></span><span class="hljs-class"> "</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Loading</span></span></span><span class="hljs-class"> </span><span class="hljs-comment"><span class="hljs-class"><span class="hljs-comment">#{quantity} units of #{type} in the supply hold." if </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@supplies</span></span></span></span><span class="hljs-class"><span class="hljs-comment">[type] </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@supplies</span></span></span></span><span class="hljs-class"><span class="hljs-comment">[type] += quantity else </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@supplies</span></span></span></span><span class="hljs-class"><span class="hljs-comment">[type] = quantity end end def use_supplies(type, quantity) puts "----- Supply Action -----" if </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@supplies</span></span></span></span><span class="hljs-class"><span class="hljs-comment">[type] != nil &amp;&amp; </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@supplies</span></span></span></span><span class="hljs-class"><span class="hljs-comment">[type] &gt; quantity puts "Using #{quantity} of #{type} from the supply hold." </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@supplies</span></span></span></span><span class="hljs-class"><span class="hljs-comment">[type] -= quantity else puts "Supply Error: Insufficient #{type} in the supply hold." end end end class FuelTank attr_accessor :fuel attr_reader :reporter def initialize </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@fuel</span></span></span></span><span class="hljs-class"><span class="hljs-comment"> = 0 end def get_fuel_levels </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@fuel</span></span></span></span><span class="hljs-class"><span class="hljs-comment"> end def load_fuel(quantity) puts "----- Fuel Action -----" puts "Loading #{quantity} units of fuel in the tank." </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@fuel</span></span></span></span><span class="hljs-class"><span class="hljs-comment"> += quantity end def use_fuel(quantity) puts "----- Fuel Action -----" puts "Using #{quantity} units of fuel from the tank." </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@fuel</span></span></span></span><span class="hljs-class"><span class="hljs-comment"> -= quantity end end class Thrusters FUEL_PER_THRUST = 10 def initialize(fuel_tank) </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@linked</span></span></span></span><span class="hljs-class"><span class="hljs-comment">_fuel_tank = fuel_tank end def activate_thrusters puts "----- Thruster Action -----" if </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@linked</span></span></span></span><span class="hljs-class"><span class="hljs-comment">_fuel_tank.get_fuel_levels &gt;= FUEL_PER_THRUST puts "Thrusting action successful." </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@linked</span></span></span></span><span class="hljs-class"><span class="hljs-comment">_fuel_tank.use_fuel(FUEL_PER_THRUST) else puts "Thruster Error: Insufficient fuel available." end end end class Reporter def initialize(item, type) </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@linked</span></span></span></span><span class="hljs-class"><span class="hljs-comment">_item = item </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@type</span></span></span></span><span class="hljs-class"><span class="hljs-comment"> = type end def report puts "----- #{</span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@type</span></span></span></span><span class="hljs-class"><span class="hljs-comment">.capitalize} Report -----" end end class FuelReporter &lt; Reporter def initialize(item) super(item, "fuel") end def report super puts "#{</span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@linked</span></span></span></span><span class="hljs-class"><span class="hljs-comment">_item.get_fuel_levels} units of fuel available." end end class SupplyReporter &lt; Reporter def initialize(item) super(item, "supply") end def report super if </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@linked</span></span></span></span><span class="hljs-class"><span class="hljs-comment">_item.get_supplies.keys.length &gt; 0 </span></span><span class="hljs-doctag"><span class="hljs-class"><span class="hljs-comment"><span class="hljs-doctag">@linked</span></span></span></span><span class="hljs-class"><span class="hljs-comment">_item.get_supplies.each do |type, quantity| puts "#{type} avalilable: #{quantity} units" end else puts "Supply hold is empty." end end end iss = SpaceStation.new iss.sensors.run_sensors # ----- Sensor Action ----- # Running sensors! iss.supply_hold.use_supplies("parts", 2) # ----- Supply Action ----- # Supply Error: Insufficient parts in the supply hold. iss.supply_hold.load_supplies("parts", 10) # ----- Supply Action ----- # Loading 10 units of parts in the supply hold. iss.supply_hold.use_supplies("parts", 2) # ----- Supply Action ----- # Using 2 of parts from the supply hold. iss.supply_reporter.report # ----- Supply Report ----- # parts avalilable: 8 units iss.thrusters.activate_thrusters # ----- Thruster Action ----- # Thruster Error: Insufficient fuel available. iss.fuel_tank.load_fuel(100) # ----- Fuel Action ----- # Loading 100 units of fuel in the tank. iss.thrusters.activate_thrusters # ----- Thruster Action ----- # Thrusting action successful. # ----- Fuel Action ----- # Using 10 units of fuel from the tank. iss.fuel_reporter.report # ----- Fuel Report ----- # 90 units of fuel available.</span></span></span></span></code> </pre> <br>  In this latest version of the program, the responsibilities were divided into two new classes, the FuelReporter and the SupplyReporter.  They are both children of the Reporter class.  In addition, we added instance variables to the SpaceStation class so that, if necessary, initialize the desired subclass.  Now, if the Earth decides to change something else, we will edit the subclasses, not the main class. <br><br>  Of course, some classes we still depend on each other.  So, the object SupplyReporter depends on SupplyHold, and the FuelReporter depends on FuelTank.  Of course, boosters should be connected to the fuel tank.  But here everything looks logical, and making changes will not be particularly difficult - editing the code of one object will not greatly affect the other. <br><br>  Thus, we have created a modular code where the responsibilities of each of the objects / classes are precisely defined.  Working with this code is not a problem, its maintenance will be a simple task.  We converted the entire ‚Äúdivine object‚Äù into SRP. <br><br><blockquote>  <b>Skillbox recommends:</b> <br><br><ul><li>  Two-year practical course <a href="https://iamwebdev.skillbox.ru/%3Futm_source%3Dskillbox.media%26utm_medium%3Dhabr.com%26utm_campaign%3DWEBDEVPRO%26utm_content%3Darticles%26utm_term%3Dsolid">"I am a web developer PRO"</a> . </li><li>  Online course <a href="https://skillbox.ru/c-sharp/%3Futm_source%3Dskillbox.media%26utm_medium%3Dhabr.com%26utm_campaign%3DCSHDEV%26utm_content%3Darticles%26utm_term%3Dsolid">"C # developer with 0"</a> . </li><li>  Practical annual course <a href="https://skillbox.ru/php/%3Futm_source%3Dskillbox.media%26utm_medium%3Dhabr.com%26utm_campaign%3DPHPDEV%26utm_content%3Darticles%26utm_term%3Dsolid">"PHP developer from 0 to PRO"</a> . <br></li></ul></blockquote></div><p>Source: <a href="https://habr.com/ru/post/442928/">https://habr.com/ru/post/442928/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../442912/index.html">Rally against runet isolation</a></li>
<li><a href="../442916/index.html">Are pirate FM radio stations relevant today?</a></li>
<li><a href="../442918/index.html">A guide to deploying machine learning models in a production environment as an API using Flask</a></li>
<li><a href="../442922/index.html">Moon mission "Bereshit" - the characteristics of the device, a series of maneuvers and the longest journey to the moon</a></li>
<li><a href="../442926/index.html">"Mouse fuss" in infrared light: the introduction of nanoparticles in the subretinal region of the eye of a mouse</a></li>
<li><a href="../442932/index.html">Yandex has launched a search engine based on Russian patents over the past 95 years</a></li>
<li><a href="../442934/index.html">How to hire people in a huge company with an unpopular stack. Conversation with wrike</a></li>
<li><a href="../442936/index.html">This is a must see: 3D technology helped create smart glasses for engineers</a></li>
<li><a href="../442938/index.html">Remote work with a healthy (?) Employer</a></li>
<li><a href="../442946/index.html">Programming languages: PowerShell captures more and more developers under Linux, macOS and Windows</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>