<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Migration from Check Point from R77.30 to R80.10</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello colleagues, welcome to Check Point R77.30 database migration to R80.10. 

 When using Check Point‚Äôs products, sooner or later the task of migrat...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Migration from Check Point from R77.30 to R80.10</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/sg/d-/lx/sgd-lx6o8mhid8lnqi8jywhdchw.png" alt="image"><br><br>  Hello colleagues, welcome to Check Point R77.30 database migration to R80.10. <br><br>  When using Check Point‚Äôs products, sooner or later the task of migrating existing rules and objects database comes up for the following reasons: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ol><li>  When buying a new device, you need to migrate the database from the old device to the new device (to the current version of GAIA OS or higher). </li><li>  You need to upgrade your device from one version of GAIA OS to a higher version on the local machine. </li></ol><br>  To solve the first problem, only the use of a tool called the Management Server Migration Tool or simply the Migration Tool is suitable.  To solve the problem number 2 can use the solution CPUSE or Migration Tool. <br>  Next, we consider in more detail both methods. <br><a name="habracut"></a><br><h3>  Update to new device </h3><br>  <b>Database Migration</b> involves installing the latest version of Management on a new machine, and then migrating the database from the existing Security Management server to a new one using the Migration Tool.  This method minimizes the risk of updating for an existing configuration. <br><br>  In order to migrate the database using the Migration Tool, you need to meet the <b>requirements</b> : <br><br><ol><li>  The free space on the disk should be 5 times larger than the size of the archive of the exported database. </li><li>  On the target server, the network settings must match the source server. </li><li>  Creating a backup.  Database export must be made to a remote server. <br>  The GAIA operating system already has the Migration Tool, which can be used when importing a database or for migrating to an operating system version identical to the initial one.  In order to migrate the database to a higher version of the operating system, you need to download the Migration Tool of the corresponding version from the ‚ÄúTools‚Äù section of the Check Point support site R80.10: </li><li>  Backup and migration of SmartEvent / SmartReporter Server.  The 'backup' and 'migrate export' utilities do not include data from the SmartEvent database / SmartReporter database. <br>  For backup and migration, you need to use the utilities 'eva_db_backup' or 'evs_backup'. <br>  Note: Article sk110173 in the CheckPoint Knowledge Base. </li></ol><br>  Consider what features this tool contains: <br><br><img src="https://habrastorage.org/webt/zt/ml/4q/ztml4qao6wgpvlxns-9uuw_fiem.png" alt="image"><br><br>  Before you directly go to the data migration, you must first unzip the downloaded Migration Tool in the folder ‚Äú/ opt / CPsuite-R77 / fw1 / bin / upgrade_tools / &lt;your_folder&gt;‚Äù, export the database using commands from the directory where you unzipped the tool . <br><br>  Before running the command to export or import, close all SmartConsole clients or launch cpstop on the Security Management server. <br><br>  To <b>create a</b> management database <b>export file</b> on the source server: <br><br><ol><li>  Enter expert mode. </li><li>  Run the pre-check tool: pre_upgrade_verifier -p $ FWDIR -c R77 -t R80.10.  If there are errors, correct them before continuing. </li><li>  Run: ./migrate export filename.tgz.  The command exports the contents of the Security Management Server database to a TGZ file. </li><li>  Follow the instructions.  The database is exported to the file you named in the command.  Make sure you define it as TGZ. </li><li>  If SmartEvent is installed on the source server, export the event database. </li></ol><br>  Next, import the database of the security server that you exported.  Before you begin: Install the R80 Security Management Server.  I remind you that the network settings of the new Management Server R80.10 must match the settings of the old server. <br><br>  To <b>import a</b> management server <b>configuration</b> : <br><br><ol><li>  Enter expert mode. </li><li>  Transfer (with FTP, SCP or similar) the exported configuration file to a remote server collected from a source on a new server. </li><li>  Disconnect the source server from the network. </li><li>  Transfer the configuration file from the remote server to the new server. </li><li>  Calculate MD5 for the transferred file and compare with MD5 that was calculated on the source server: # md5sum filename.tgz </li><li>  Import Database: ./migrate import filename.tgz </li><li>  Check for update. </li></ol><br>  Upon completion of 7 points, we summarize that the migration of the database was successful using the Migration Tool, in case of failure, you can always turn on the source server, as a result of which the work will not suffer in any way. <br><br>  It is worth noting that migration from a standalone server is not supported. <br><br><h3>  Local update </h3><br>  <b>CPUSE (Check Point Upgrade Service Engine)</b> allows you to automatically update Check Point products for Gaia OS.  Software update packages are divided into categories, namely major releases, minor releases and Hotfixes.  Gaia automatically finds and displays available software update packages and images relevant to the version of the Gaia operating system you can upgrade to.  With CPUSE, you can make a clean installation of the new version of GAIA OS, and perform a system update with database migration. <br><br>  To upgrade to a higher version or perform a clean installation using CPUSE, the machine must have enough free (unallocated) space ‚Äî at least in the size of the root partition. <br><br>  The transition to the new version is performed on the new hard disk partition, and the ‚Äúold‚Äù partition is converted to Gaia Snapshot (the new partition space is taken from the unallocated space on the hard disk).  Also, before updating the system, it will be correct to make a snapshot and upload it to a remote server. <br><br>  <b>Update process</b> : <br><br><ol><li>  Check the update package (if you haven‚Äôt already done so) - check if the package can be installed without conflict: right-click on the package - click ‚ÄúVerifier‚Äù. <br><br>  The result should be something like this: <br><br><ul><li>  Installation is allowed </li><li>  Upgrade is allowed </li></ul></li><li>  Install the package: right-click the package and click "Upgrade": <br>  CPUSE shows the following warning in the Gaia Portal: After this upgrade, there will be an automatic reboot. </li><li>  You will see the corresponding progress on data migration after upgrading to R80.10: <br><ul><li>  Upgrading Products </li><li>  Importing database </li><li>  Configuring Products </li><li>  Creating SIC Data </li><li>  Stopping processes </li><li>  Starting Processes </li><li>  Installed, self-test passed </li></ul></li><li>  System will automatically reboot </li><li>  Installing a policy in SmartConsole </li></ol><br>  As you can see everything goes very simply, in case of a problem, you can roll back to the old settings using the snapshot made. <br><br><h3>  Practice </h3><br>  In the presented video tutorial contains the theoretical and practical part.  The first half of the video duplicates the theoretical part described, and the practical example shows the data migration using both methods. <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/qx8sK_37ko0" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><h3>  Conclusion </h3><br>  In this lesson, we looked at Check Point solutions for updating and migrating objects and rules databases.  In the case of a new device, there are no other solutions than using the Migration Tool.  If you want to update GAIA OS and you have the desire and the ability to re-deploy the machine, our company advises, based on existing experience, migrate the database using the Migration Tool.  This method minimizes the risk of updating for an existing configuration compared to CPUSE.  Also, when upgrading via CPUSE, many unnecessary old files are saved to disk, and an additional tool is required to remove them, which entails additional actions and new risks. <br><br>  If you do not want to miss future lessons, then subscribe to our group <a href="https://vk.com/ts_solution">VK</a> , <a href="https://www.youtube.com/channel/UCKOESE8nBWQPuQmi994_YMA">Youtube</a> and <a href="http://t.me/tssolution">Telegram</a> .  If for any reason you could not find the document you need or solve your problem with Check Point, feel free to contact <a href="https://tssolution.ru/">us</a> . </div><p>Source: <a href="https://habr.com/ru/post/353470/">https://habr.com/ru/post/353470/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../353460/index.html">RTCP REMB: we twist the video call settings in the browser</a></li>
<li><a href="../353462/index.html">How to get into Microsoft, Amazon or Twitter without a prestigious college diploma</a></li>
<li><a href="../353464/index.html">Online statistics in Telegram</a></li>
<li><a href="../353466/index.html">Uncountable: in search of a finite number</a></li>
<li><a href="../353468/index.html">What's new in AppCode 2018.1</a></li>
<li><a href="../353472/index.html">PostgreSQL 10 partitioning and more</a></li>
<li><a href="../353476/index.html">Aitracking, Emotions and VR: Technology Convergence and Current Research</a></li>
<li><a href="../353478/index.html">Beautiful listing of files and directories in nginx</a></li>
<li><a href="../353480/index.html">Dangerous pickles - malicious serialization in Python</a></li>
<li><a href="../353482/index.html">4. Check Point for maximum. Checking Anti-Virus with Kali Linux</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>