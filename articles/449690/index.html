<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Inside the secret lab Ledger</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Donjon is an information security laboratory for the French company Ledger. Ledger produces hardware wallets that store private keys of cryptocurrency...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Inside the secret lab Ledger</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/up/jj/br/upjjbrleyv4d5avp1jk_jcnsjv4.jpeg"><br><br>  Donjon is an information security laboratory for the French company Ledger.  Ledger produces hardware wallets that store private keys of cryptocurrency owners.  Malefactors hunt for these keys, and the hardware wallet, respectively, protects keys from leakage.  How reliable?  ‚ÄúDonjon‚Äù makes every effort to ensure that such a question does not even arise. <br><a name="habracut"></a><br><img src="https://habrastorage.org/webt/ks/5o/w6/ks5ow6w6ksjg2w449msq746jzl0.jpeg"><br>  <i>These people do everything so that the owners of Ledger wallets can sleep peacefully.</i> <br><br>  For a long time, the existence of the laboratory was kept secret.  It has eight employees who prefer to remain anonymous.  It is only known that these are ‚Äúworld-class specialists‚Äù in cyber security and smart cards.  These "white hackers" are looking for vulnerabilities in Ledger software and hardware, as well as in competitors' products.  The laboratory itself is located in the Paris office of the company.  The workspace is protected by an alarm system, and only the personnel of the Donjon can go there. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In the laboratory are engaged in research of different types of attacks.  <b>Software attacks to</b> which cryptographs are exposed usually consist in the study of the unusual behavior of systems and interfaces.  A typical example of what Donjon is hunting for: the Heartbleed bug of the OpenSSL open cryptographic library.  This famous vulnerability spread in 2012 and consisted in the possibility of unauthorized reading of server memory, extracting from it, including the private key.  It was fixed only in 2014, after which Google launched its Project Zero to prevent similar threats. <br><br><img src="https://habrastorage.org/webt/sb/jv/8n/sbjv8nkjhonhzsaot70zkutb1zq.png"><br>  <a href="https://xkcd.com/1354/"><i>xkcd about what heartbleed is</i></a> <br><br>  Specialists of ‚ÄúDonjon‚Äù apply standard techniques: reverse engineering, statistical analysis, cryptography and fuzzing.  Fuzzing is the transfer of random or unexpected data to a program.  Last October, with its help, hackers found two vulnerabilities in the code of the crypto wallet of the rival firm Trezor. <br><br>  These were buffer overflow errors.  In both cases, the condition in the functions was incorrect;  as often happens in such cases, the code worked, but not in the way its authors wanted.  Read more about this <a href="https://blog.trezor.io/details-about-the-security-updates-in-trezor-one-firmware-1-7-1-5c34278425d8">in the Trezor blog</a> . <br><br><img src="https://habrastorage.org/webt/to/w_/lx/tow_lxn9fv2c-wybh72k6ecw9z4.jpeg"><br><br>  Both vulnerabilities allowed you to remotely disable the wallet, attacking it through the browser, without user intervention.  They affected firmware versions 1.6.2 and 1.6.3, and fixed errors in the new version. <br><br>  As Ledger security director Charles Guillaume honestly said, the company develops only software from scratch.  Chips and electronics provide third-party suppliers.  Therefore, ‚ÄúDonjon‚Äù, like a medieval dungeon, is equipped with ‚Äútorture‚Äù tools in order to methodically test wallets for physical vulnerabilities that may lead to data leakage. <br><br>  Impressive and difficult <b>attacks on third-party channels.</b>  Such attacks are aimed at the physical vulnerabilities of a working device.  If an attacker steals or finds a lost cryptographic chain, he can measure the electromagnetic radiation and the change in power consumption of the device during the execution of the code.  The hacker uses the received data to bypass the protection. <br><br><img src="https://habrastorage.org/webt/re/be/jo/rebejo4ruvxjwtaexgb5_jz9g38.jpeg"><br>  <i>Attack on hardware wallet in progress</i> <br><br>  In practice, this idea allowed Ledger hackers to successfully crack the Trezor One wallet PIN.  The PIN code is needed to access the device, and it gave a generous 15 attempts to enter the correct combination.  "Donjon" learned to guess PIN for five times. <br><br>  The following happened: a purse with a well-known PIN-code was disassembled, and then sensors were installed on its flash memory to measure power consumption and the electromagnetic field.  Random numbers were entered into the wallet, and the oscilloscope wrote data from the probes.  The data was marked as reactions to the correct and incorrect input, and then ‚Äúfed‚Äù to the algorithm for learning. <br><br><img src="https://habrastorage.org/webt/ad/wy/yy/adwyyyig0z6-vmb97ufphz5bogi.jpeg"><br>  <i>The results of the attack.</i>  <i>The future has come, so the robot will understand them</i> <br><br>  Having taught the algorithm to distinguish different reactions, the researchers installed sensors on a second device.  It played the role of a potentially stolen wallet, and exactly the same data was written from it when entering a PIN code.  The algorithm that was trained on the first wallet recognized which numbers were correct and which were not, and guessed the PIN as a whole. <br><br>  Since each new attempt to enter a PIN additionally has an increasing delay, such a hacking is a long process.  To sort through all 15 codes, it might take a whole day of work.  In case of success, the hacker gets unlimited access to other people's assets, so the game is worth the trouble. <br><br>  The result of the experiment "Donzhon" again shared with competitors who took them very seriously and completely rewrote the PIN verification algorithm. <br><br><img src="https://habrastorage.org/webt/7i/7f/aa/7i7faa1uukzxjpxlzwqx8bqaoum.jpeg"><br>  <i>Setup for performing computation error attacks</i> <br><br>  Another favorite hacker technique is Ledger: an <b>attack on calculation errors.</b>  This is a subtype of attack on third-party channels, which implies active intervention in the operation of the device: lowering and increasing the voltage in the circuit, increasing the clock frequency.  A hardware wallet can be affected by ionizing radiation, a laser and an electromagnetic field.  The attack allows you to bypass the PIN entry: increase the voltage, the device goes astray and skips checking the correctness of the entered numbers. <br><br>  An experienced hacker will be able to extract other data that the hardware wallet should protect.  For example, sid, a mnemonic phrase that opens access to all assets at once.  This is a complicated but manageable procedure, and the Donjon team managed to do it with Keepkey, B Wallet, Trezor One and Trezor T purses. <br><br><img src="https://habrastorage.org/webt/it/yn/42/ityn42mgblyhndb1jbef_opa4o4.jpeg"><br>  <i>This board in the "Donjon" is used to attack the cryptographic chips</i> <br><br>  Unfortunately, the details of the latest hacking "Donzhon" does not disclose.  Hackers have a very strict ‚Äúcode of honor‚Äù: they first crack the device, then pass the details of the vulnerability to Ledger or competitors and wait for corrections.  Only after that the public is notified that the problem existed. <br><br>  Hackers reported back in December 2018 about the possibility of extracting seed from wallets.  Vulnerability is still not fixed.  According to Guillaume, in principle, nothing can be done with this defect, so the Donjon team will not tell you exactly how the wallets were hacked. <br><br>  To prevent attacks on computational errors in the Ledger cryptographs, a separate Secure Element security chip is used.  These chips are put on credit cards, SIM-cards and biometric passports.  He detects an attempt to attack and actively responds to it.  Secure Element also hides electromagnetic radiation and power consumption to prevent an attacker from ‚Äúlistening‚Äù to himself. <br><br><img src="https://habrastorage.org/webt/q4/sq/b5/q4sqb5cx5xddnihoz7cvtodotfo.jpeg"><br>  <i>Chip ready to attack</i> <br><br>  In many other cryptographs, all calculations take place on a conventional microcontroller.  In Ledger, such an architecture is considered unsafe, including because their own hackers "split" simple chips, like nuts.  Competitors, including Trezor, countered the claim that for such a hacking, you must have physical access to the device and expert knowledge in the field of cryptography.  Most holders of ethereum or bitcoin are much more worried because of remote attacks, so manufacturers concentrate on software security. <br><br><img src="https://habrastorage.org/webt/iz/bh/tw/izbhtwp_3mk2waigsz56zaaybei.jpeg"><br>  <a href="https://xkcd.com/538/"><i>xkcd about hackers everyday life</i></a> <br><br>  A pragmatic approach is bearing fruit in the present.  However, Ledger is looking to the future, which, as the company believes, cryptocurrency exists.  The pickpocket, who pulled a flash drive out of a tourist's pocket yesterday, could not figure out that he had the key to wealth.  In a year, he will know for sure who will sell the stolen hardware cryptocars to someone else hacking them. <br><br>  With the popularization of hardware wallets, ‚Äúmarkets‚Äù for the resale of stolen devices will inevitably appear.  Exactly the same as they exist for resale of stolen credit card data.  In Ledger, sleighs are being prepared in the summer and, therefore, they are already testing other crypto device manufacturers with ideas of complex hacks (with lasers and neural networks). <br><br><img src="https://habrastorage.org/webt/t-/z9/tz/t-z9tztos4h_a774u8wmuyayyfm.jpeg"><br>  <i>Ledger Nano S wallet: certified, secure and fully protected (wrench protection not included)</i> <br><br>  According to Eric Larshevek, CEO of Ledger, the point is not to look for flaws among competitors, but to increase the responsibility of the blockchain industry as a whole.  Now the owner of any crypto wallet is his own bank and his own security system.  Putting responsibility on the shoulders of the client is very convenient for companies that can not certify their goods at all. <br><br>  Meanwhile, the Ledger Nano S wallet was the first on the market to be successfully certified by Agence Nationale de S√©curit√© des Syst√®mes d'Information, the French national cyber security agency.  Ledger is not enough.  ‚ÄúI think the industry needs more safety certification schemes,‚Äù says Guillaume.  While there are no such schemes, Donjon makes every effort to ensure that Ledger hardware wallets are as secure as possible. <br><br>  Written on Ledger.  You can <a href="https://madrobots.ru/p/ledger-nano-s/%3Futm_source%3Dhabr.com%26utm_medium%3Dpr%26utm_campaign%3Ddonjon">purchase hardware wallets of the French company</a> in our online store. <br><br> <a href="http://madrobots.ru/%3Futm_source%3Dhabr.com%26utm_medium%3Dpr%26utm_campaign%3Ddonjon"><img src="https://habrastorage.org/webt/qq/g0/i7/qqg0i7eriq4febfjqqehire4fnw.png"></a> <br> <a href="http://madrobots.ru/about/mails/%3Futm_source%3Dhabr.com%26utm_medium%3Dpr%26utm_campaign%3Ddonjon"><img src="https://habrastorage.org/webt/bv/1y/yw/bv1yywjgl2_cbtzvvtk4rup2jz8.png"></a> </div><p>Source: <a href="https://habr.com/ru/post/449690/">https://habr.com/ru/post/449690/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../449678/index.html">Why software tasks always take longer than you think</a></li>
<li><a href="../449680/index.html">How 5G changes gaming technology</a></li>
<li><a href="../449686/index.html">We talk about one of the key speakers OFFZONE 2019</a></li>
<li><a href="../449688/index.html">Testing the sendBeacon setting to send data</a></li>
<li><a href="../44969/index.html">Married to a programmer</a></li>
<li><a href="../449696/index.html">Participate in the competition for overclocking memory - HyperX Memory OC Competition 2019</a></li>
<li><a href="../4497/index.html">A new worm makes clicking on AdSense links</a></li>
<li><a href="../44970/index.html">Free seminar "IT for small business"</a></li>
<li><a href="../449700/index.html">Why traffic suddenly turns into traffic jam</a></li>
<li><a href="../449702/index.html">The laureates of the international SSH and sudo competitions are on stage again. Under the leadership of the distinguished conductor of Active Directory</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>