<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Design patterns, iOS view developer. Part 1. Strategy</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Content: 


 Part 0. Singleton Single 
 Part 1. Strategy 
 Part 2. The Observer 


 Let me remind you that in this series of articles, I am analyzing ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Design patterns, iOS view developer. Part 1. Strategy</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/files/f68/211/c5f/f68211c5f1eb459ebfb3aa867710072a.jpg"></div><br><h1>  Content: </h1><br><p>  <a href="https://habrahabr.ru/post/320728/">Part 0. Singleton Single</a> <br>  Part 1. Strategy <br>  <a href="https://habrahabr.ru/post/324292/">Part 2. The Observer</a> </p><br><p>  Let me remind you that in this series of articles, I am analyzing the book "Design Patterns" by Eric and Elizabeth Freeman.  And today we will study the pattern "Strategy".  Go. </p><br><h1>  Where do legs (and wings) grow from </h1><br><p> The authors of the book tell us the story of the creation of the SimUDuck application.  Let's start with the implementation of the initial state of the application: we have the abstract <code>Duck</code> class and two of its heirs: <code>MallardDuck</code> and <code>RedheadDuck</code> .  Immediately we are confronted with the first difficulty: there are no abstract classes in Objective-C and Swift. </p><br><p><a name="habracut"></a>  We get out of the situation with those tools that are: for Objective-C we declare the usual <code>Duck</code> class (in it will be the default implementations) and add the <code>AbstractDuck</code> protocol to it (in it there will be abstract methods that must be implemented in the heirs).  It looks like this: </p><br><pre> <code class="hljs pgsql">// Objective-C @protocol AbstractDuck &lt;NSObject&gt; - (<span class="hljs-type"><span class="hljs-type">void</span></span>)display; @<span class="hljs-keyword"><span class="hljs-keyword">end</span></span> @interface Duck : NSObject - (<span class="hljs-type"><span class="hljs-type">void</span></span>)quack; - (<span class="hljs-type"><span class="hljs-type">void</span></span>)swim; @<span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br><p>  Accordingly, the heirs will be as follows: </p><br><pre> <code class="hljs perl">// Objective-C @interface MallardDuck : Duck &lt;AbstractDuck&gt; @end @implementation MallardDuck - (void)display { } @end @interface RedheadDuck : Duck &lt;AbstractDuck&gt; @end @implementation RedheadDuck - (void)display { } @end</code> </pre> <br><p>  In Swift, this is a little easier: the protocol and its extensions are sufficient (in the extension, you can implement some protocol methods by default) </p><br><pre> <code class="hljs objectivec"><span class="hljs-comment"><span class="hljs-comment">// Swift protocol Duck { func quack() func swim() func display() } extension Duck { func quack() { } func swim() { } }</span></span></code> </pre> <br><p>  And the heirs: </p><br><pre> <code class="hljs python">// Swift <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MallardDuck</span></span></span><span class="hljs-class">:</span></span> Duck { func display() { } } <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">RedheadDuck</span></span></span><span class="hljs-class">:</span></span> Duck { func display() { } }</code> </pre> <br><h1>  The application develops and the ducks have the opportunity to fly </h1><br><p>  For this, the corresponding method appears in the <code>Duck</code> parent class.  And soon after that, it turns out that there is another heir - <code>RubberDuck</code> .  Rubber ducks do not fly, and since the method is added to the parent class, it will be available for rubber ducks.  In general: the situation was not simple.  With further expansion of the application, there will be difficulties with the support of the flight functions (and not only with it, with the quacking function the same story) and with other types of ducks (wood, for example). </p><br><p>  First, the authors of the book propose to solve the problem by putting the functions of flight and quacking into separate interfaces (for Objective-c and Swift-protocols) <code>Flyable</code> and <code>Quackable</code> .  But this option is not as good as it seems at first glance.  The slightest change in the flight function, which must be applied to all flying ducks, entails the introduction of the same code in many places of the program.  So this solution is definitely not suitable. </p><br><p>  <i>(referring to the unsuitability of this option, the authors refer to the fact that in interfaces (for us protocols) there are no default implementations, but this is true only for Objective-C, but in Swift the default implementation for flight and quacking could be written in extensions of these protocols and redefine these functions only where necessary and not everywhere)</i> </p><br><p>  Well, and besides, one of the main goals of the pattern is to replace the implementation of behaviors at runtime, so the authors propose to make the implementation of behaviors out of the <code>Duck</code> class. </p><br><p>  To do this, create the protocols <code>FlyBehavior</code> and <code>QuackBehavior</code> : </p><br><pre> <code class="hljs pgsql">// Objective-C @protocol FlyBehavior &lt;NSObject&gt; - (<span class="hljs-type"><span class="hljs-type">void</span></span>)fly; @<span class="hljs-keyword"><span class="hljs-keyword">end</span></span> @protocol QuackBehavior &lt;NSObject&gt; - (<span class="hljs-type"><span class="hljs-type">void</span></span>)quack; @<span class="hljs-keyword"><span class="hljs-keyword">end</span></span></code> </pre> <br><pre> <code class="hljs objectivec"><span class="hljs-comment"><span class="hljs-comment">// Swift protocol FlyBehavior { func fly() } protocol QuackBehavior { func quack() }</span></span></code> </pre> <br><p>  And specific classes that implement these protocols: <code>FlyWithWings</code> and <code>FlyNoWay</code> for <code>FlyBehavior</code> , as well as <code>Quack</code> , <code>Squeak</code> and <code>MuteQuack</code> for <code>QuackBehavior</code> (I'll give an example for <code>FlyWithWings</code> , the rest are implemented in a very similar way): </p><br><pre> <code class="hljs perl">// Objective-C @interface FlyWithWings : NSObject &lt;FlyBehavior&gt; @end @implementation FlyWithWings - (void)fly { <span class="hljs-regexp"><span class="hljs-regexp">//</span></span> fly implementation } @end</code> </pre> <br><pre> <code class="hljs python">// Swift <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">FlyWithWings</span></span></span><span class="hljs-class">:</span></span> FlyBehavior { func fly() { // fly implementation } }</code> </pre> <br><h1>  Delegating our all </h1><br><p>  Now we, in fact, delegate our behavior to any other class that implements the corresponding interface (protocol).  How to tell our duck what its behavior in flight and with quacking should be?  Very simply, we add to our class (in Swift - protocol) <code>Duck</code> two properties: </p><br><pre> <code class="hljs vhdl">// Objective-C @<span class="hljs-keyword"><span class="hljs-keyword">property</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">strong</span></span>, nonatomic) id&lt;FlyBehavior&gt; flyBehavior; @<span class="hljs-keyword"><span class="hljs-keyword">property</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">strong</span></span>, nonatomic) id&lt;QuackBehavior&gt; quackBehavior;</code> </pre> <br><pre> <code class="hljs pgsql">// Swift var flyBehavior: FlyBehavior { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> } var quackBehavior: QuackBehavior { <span class="hljs-keyword"><span class="hljs-keyword">get</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> }</code> </pre> <br><p>  As you can see, they do not have a specific type defined; it is only determined that this is a class that is signed for the corresponding protocol. </p><br><p>  <code>quack</code> <code>fly</code> and <code>quack</code> our parent class (or protocol) <code>Duck</code> with similar ones: </p><br><pre> <code class="hljs pgsql">// Objective-C - (<span class="hljs-type"><span class="hljs-type">void</span></span>)performFly { [self.flyBehavior fly]; } - (<span class="hljs-type"><span class="hljs-type">void</span></span>)performQuack { [self.quackBehavior quack]; }</code> </pre> <br><pre> <code class="hljs objectivec"><span class="hljs-comment"><span class="hljs-comment">// Swift func performFly() { flyBehavior.fly() } func performQuack() { quackBehavior.quack() }</span></span></code> </pre> <br><p>  Now our duck simply delegates its behavior to the corresponding behavioral object.  How do we set the behavior of each duck?  For example, during initialization (example for <code>MallardDuck</code> ): </p><br><pre> <code class="hljs smalltalk">// <span class="hljs-type"><span class="hljs-type">Objective</span></span>-<span class="hljs-type"><span class="hljs-type">C</span></span> - (instancetype)init { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span> = [<span class="hljs-keyword"><span class="hljs-keyword">super</span></span> init]; if (<span class="hljs-keyword"><span class="hljs-keyword">self</span></span>) { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.flyBehavior = [[<span class="hljs-type"><span class="hljs-type">FlyWithWings</span></span> alloc] init]; <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.quackBehavior = [[<span class="hljs-type"><span class="hljs-type">Quack</span></span> alloc] init]; } return <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>; }</code> </pre> <br><pre> <code class="hljs smalltalk">// <span class="hljs-type"><span class="hljs-type">Swift</span></span> init() { <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.flyBehavior = <span class="hljs-type"><span class="hljs-type">FlyWithWings</span></span>() <span class="hljs-keyword"><span class="hljs-keyword">self</span></span>.quackBehavior = <span class="hljs-type"><span class="hljs-type">Quack</span></span>() }</code> </pre> <br><p>  Our pattern is ready :) </p><br><h1>  Conclusion </h1><br><p>  In iOS development, the Strategy pattern can be found, for example, in the <a href="https://habrahabr.ru/company/badoo/blog/281162/">MVP</a> architecture: in it, the presenter is nothing more than a behavioral object for the view controller (the view controller, as you remember, only informs the presenter about the user's actions, but the logic data processing is determined by the presenter), and vice versa: the controller view is a behavioral object for the presenter (the presenter only says "show data to the user", but how it will be shown is decided by the controller view).  You will also find this pattern in VIPER, if, of course, you decide to use it in your application.  :) </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/321182/">https://habr.com/ru/post/321182/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../321172/index.html">Arduino on car wash part 2</a></li>
<li><a href="../321174/index.html">Hacked server CD Projekt RED, developers The Witcher. Leaked database with user data</a></li>
<li><a href="../321176/index.html">WS2801 LED Ribbon Management using Raspberry Pi and iOS</a></li>
<li><a href="../321178/index.html">Virtualized Data Center Design</a></li>
<li><a href="../321180/index.html">Bgp Received-routes vs. Accepted-routes</a></li>
<li><a href="../321184/index.html">The path from the programmer to entrepreneurs (and whether to go on it)</a></li>
<li><a href="../321186/index.html">Plans to develop 3CX and a new training video course for partners and administrators</a></li>
<li><a href="../321188/index.html">Procrastination How to cage the demon who prevented to move towards the goal</a></li>
<li><a href="../321192/index.html">The digest of interesting materials for the mobile developer # 189 (January 30-February 5)</a></li>
<li><a href="../321194/index.html">Blockchain based guide</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>