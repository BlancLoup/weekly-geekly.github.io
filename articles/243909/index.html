<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Chrome CSS bug that destroyed our site</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This is the real story that happened on our site during Thanksgiving Day. 

 The site stopped working suddenly, nothing foreshadowed such a turn. 

 A...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Chrome CSS bug that destroyed our site</h1><div class="post__text post__text-html js-mediator-article">  This is the real story that happened on our site during Thanksgiving Day. <br><br>  The site stopped working suddenly, nothing foreshadowed such a turn. <br><br>  At first, I thought that the problem was with our hosting provider, because problems had already happened to it before.  Our site has already managed to ‚Äúfall‚Äù three times for various reasons, and it looked like a typical problem on their part. <br><a name="habracut"></a><br>  When we tried to open the site, we saw only a blank page, alas.  a couple of times after the update, it was even possible to refresh the page, but it did not scroll down, no link type elements worked.  This was everywhere, not just on the main page. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Without thinking twice, I opened the Chrome developer panel to look into the page ‚Äúconsciousness‚Äù and understand the cause of the error.  All HTML elements were displayed correctly, and the source code itself was loaded correctly.  I saw absolutely everything that I did not see on the page. <br><br>  The next step was to check the logs with errors in cPanel.  Failure. <br><br>  This meant that the reason for this terrible bug was not a hosting company.  And then I realized that we have big problems.  Feeling completely guilty, repenting, I started debugging my code. <br><img src="https://habrastorage.org/files/ad2/8ab/93b/ad28ab93b6ae4196a99743f2e2fb651b.png"><br><h4>  Debugging code </h4><br>  First of all, I checked the JavaScript code through the console.  Nope <br><br>  Surprisingly, everything is fine in JavaScript, but the server is not working.  To my surprise, everything just worked fine in Firefox. <br><br>  Something terrible began to happen, and I realized that.  The site code has not been updated for about a week.  Moreover, it worked well for longer than a year.  How could my creation suddenly stop appearing in Chrome? <br><br>  I typed in Google ‚Äúthe site is scrolling slowly in chrome‚Äù and saw a post mentioning <code>background-size: cover</code> , which caused problems on some resources.  In each post of our blog, there are cover images of articles that use the <code>background-size: cover</code> property to give responsiveness. <br><br>  I deleted this line, but nothing has changed.  Is it possible that there are any other mistakes in using CSS?  For example, any transformation overloading the computer? <br><br>  This image was somewhat unique, which is why I continued to play with its HTML and CSS.  When I added <code>display: none</code> , the rest of the site started working.  Clearing! <br><br>  Thus, I began to remove the properties one by one, until I found the source of the headache: <br><pre> <code class="css hljs"><span class="hljs-selector-tag"><span class="hljs-selector-tag">box-shadow</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">inset</span></span> 0 <span class="hljs-selector-tag"><span class="hljs-selector-tag">-360px</span></span> 360<span class="hljs-selector-tag"><span class="hljs-selector-tag">px</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-160px</span></span> <span class="hljs-selector-id"><span class="hljs-selector-id">#000</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">inset</span></span> 0 290<span class="hljs-selector-tag"><span class="hljs-selector-tag">px</span></span> 330<span class="hljs-selector-tag"><span class="hljs-selector-tag">px</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-160px</span></span> <span class="hljs-selector-id"><span class="hljs-selector-id">#000</span></span>;</code> </pre><br>  Only one line could disable the entire resource! <br><br><h4>  How I fixed it </h4><br>  This <code>box-shadow</code> was not only for aesthetic purposes.  He also created a dark background for the post title and the navigation menu, without which the text would be unreadable. <br><img src="https://habrastorage.org/files/336/505/a64/336505a6471841ebac2bae6ba035fef9.jpg"><br>  It was necessary to somehow return it.  For this, I created two new pseudo-elements <code>position: absolute</code> and another drop of magic with <code>background-image: linear-gradient</code> . <br><pre> <code class="css hljs">&amp;<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:before</span></span>, &amp;<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:after</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">content</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">position</span></span>: absolute; <span class="hljs-attribute"><span class="hljs-attribute">left</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">width</span></span>: <span class="hljs-number"><span class="hljs-number">100%</span></span>; } &amp;<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:before</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">top</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">height</span></span>: $headerHeight + <span class="hljs-number"><span class="hljs-number">20px</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">background-image</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">linear-gradient</span></span>(#000, rgba(0, 0, 0, .6), <span class="hljs-built_in"><span class="hljs-built_in">rgba</span></span>(0, 0, 0, 0)); } &amp;<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:after</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">bottom</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">height</span></span>: <span class="hljs-number"><span class="hljs-number">40%</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">background-image</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">linear-gradient</span></span>(to top, #000, rgba(0, 0, 0, .7), <span class="hljs-built_in"><span class="hljs-built_in">rgba</span></span>(0, 0, 0, 0)); }</code> </pre><br>  The effect was created the same, but only now the site worked. <br><br>  Of course, this is not an ideal way out, though ... With <code>box-shadow</code> , I had the opportunity to create beautiful frames.  With 2 gradients, I can only add a shadow effect to the top and bottom of the image. <br><br><h4>  Actually, what's the problem? </h4><br>  It was not even the code that was replaced by me, but the error still lies in the CSS.  This is a real, open Chrome bug, introduced in its latest version, the M39, <a href="https://code.google.com/p/chromium/issues/detail%3Fid%3D437128">discovered</a> on November 26, 2014. <br><br>  In short, an error occurs in the browser when calculating the parameters of shadows with large numbers.  I noticed that the problem starts at around 200px.  The bug does not affect the use of <code>outset</code> in <code>box-shadow</code> , but only <code>inset</code> . <br><br>  You can watch it in action <a href="http://codepen.io/dmtintner/pen/dPYNzY">here</a> using Chrome. <br><br>  Try scrolling the mouse wheel up and down, and, depending on the speed of your computer, the browser will start to hang more and more.  Make the <code>box-shadow</code> larger (1000px), and everything will stop working altogether.  Then just comment out the known lines, and the browser will return to life. <br><br>  Thinking many other sites once experienced a similar attack.  Personally, I was able to notice this on the website of the <a href="http://toyota.fr/">French division of Toyota</a> , but at the moment the problem has been fixed. <br><br><h4>  Conclusion </h4><br>  A few years ago, such a mistake could be acceptable and even expected.  However, today it is unacceptable, since the possibilities in programming are extremely large, and nobody has forbidden to play with CSS. <br><br>  It may seem to you that <code>box-shadow</code> this size is rare, and you will be wrong.  The 1980px background image is <u>extremely</u> common on large screens, and, unfortunately, there is no other way to handle them besides <code>box-shadow</code> .  I hope that the Chrome team will close this bug. <br><br>  Good luck with your projects. </div><p>Source: <a href="https://habr.com/ru/post/243909/">https://habr.com/ru/post/243909/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../243895/index.html">Security Virtualization. Part 2</a></li>
<li><a href="../243897/index.html">Honeymoon Manager: Part 2</a></li>
<li><a href="../243903/index.html">Web Summit 2014 in Dublin: Report</a></li>
<li><a href="../243905/index.html">Freelance in Turkey</a></li>
<li><a href="../243907/index.html">I hear voices: voice recording for game project</a></li>
<li><a href="../243913/index.html">Modeling pandemics using the Wolfram Language (Mathematica 10) using the example of Ebola</a></li>
<li><a href="../243915/index.html">VPN to every home</a></li>
<li><a href="../243919/index.html">And once again about the recognition of numbers</a></li>
<li><a href="../243927/index.html">Photo tour of the data center from the Australian colocation provider Micron21</a></li>
<li><a href="../243929/index.html">FISCHERTECHNIK: Chemotronics, Ionistors, Electrochemical Supercapacitors Inside the Children's Designer for Programmers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>