<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>PHP page navigation</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Often, when developing and displaying content, it becomes necessary to use page-by-page navigation. Someone is likely to use ready-made solutions from...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>PHP page navigation</h1><div class="post__text post__text-html js-mediator-article">  Often, when developing and displaying content, it becomes necessary to use page-by-page navigation.  Someone is likely to use ready-made solutions from their framework.  Someone may not bother and pound the pages in a simple loop.  Someone has his own work in this direction.  So I just want to share my solution to this problem. <br><a name="habracut"></a><br>  There are many variations of the location and display of buttons, I personally came to the following decision, which in my opinion is the most obvious and convenient.  Suitable for both 5 pages and 5000. <br><br><h2>  HTML code sample </h2><br>  I will not beat around the bush, I will immediately attach an example of the html code generated by the script: <br><br><pre><code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"navigation"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/playlist/1.html?page=6"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/playlist/1.html"</span></span></span><span class="hljs-tag">&gt;</span></span>1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">i</span></span></span><span class="hljs-tag">&gt;</span></span>...<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">i</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/playlist/1.html?page=4"</span></span></span><span class="hljs-tag">&gt;</span></span>4<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/playlist/1.html?page=5"</span></span></span><span class="hljs-tag">&gt;</span></span>5<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/playlist/1.html?page=6"</span></span></span><span class="hljs-tag">&gt;</span></span>6<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"link_active"</span></span></span><span class="hljs-tag">&gt;</span></span>7<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">span</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/playlist/1.html?page=8"</span></span></span><span class="hljs-tag">&gt;</span></span>8<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/playlist/1.html?page=9"</span></span></span><span class="hljs-tag">&gt;</span></span>9<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/playlist/1.html?page=10"</span></span></span><span class="hljs-tag">&gt;</span></span>10<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">i</span></span></span><span class="hljs-tag">&gt;</span></span>...<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">i</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/playlist/1.html?page=17"</span></span></span><span class="hljs-tag">&gt;</span></span>17<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">href</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/playlist/1.html?page=8"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">a</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">div</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><h2>  Build logic </h2><br>  On the settings of the parameters, I will stop a little later after the code is brought, now I will describe the logic of the formation of the numbers themselves. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      I think everything is clear with the ‚ÄúBack‚Äù and ‚ÄúForward‚Äù buttons, besides they can be simply turned off, so I will not focus on them. <br><br>  The first and last page number is always displayed, a kind of ‚ÄúTop‚Äù and ‚ÄúEnd‚Äù buttons. <br><br>  The middle is already formed by a simple algorithm.  Displayed page is viewed and N pages on the sides.  The example displays N = 3 pages.  In principle, everything is simple and clear, but a special trick is used when approaching the edges.  I will describe with examples: <br><br>  <b>Page 1-3</b> (where 3 = N) <br><blockquote>  1 2 3 4 5 6‚Ä¶ 17 </blockquote>  The first N * 2 pages and the last are displayed. <br><br>  <b>Page 4</b> <br><blockquote>  1 2 3 <b>4</b> 5 6 7 ... 17 </blockquote>  The first and further formed line is displayed from 4-3 = 1 to 4 + 3 = 7.  The first page is reserved so numbers are formed from 2 to 7. <br><br>  <b>Page 5</b> <br><blockquote>  1 2 3 4 <b>5</b> 6 7 8‚Ä¶ 17 </blockquote>  from 5-3 = 2 to 5 + 3 = 8. <br><br>  <b>Page 6</b> <br><blockquote>  1 2 3 4 5 <b>6</b> 7 8 9‚Ä¶ 17 </blockquote>  Perhaps in all the navigation that I saw (including Habr), the line would have been formed with a pass, i.e.  1 ... 3 4 5 6 7 8 9 ... 17 <br>  But after all, it is not logical to display ellipsis instead of a single number.  When building the second dot, a similar check is performed. <br><br>  <b>Page 7</b> <br><blockquote>  1 ... 4 5 6 <b>7</b> 8 9 10 ... 17 </blockquote>  The middle is already standard. <br><br>  Forming the end is similar to the beginning <br><br>  <b>Page 12</b> <br><blockquote>  1 ... 9 10 11 <b>12</b> 13 14 15 16 17 </blockquote><br>  <b>Page 13</b> <br><blockquote>  1 ... 10 11 12 <b>13</b> 14 15 16 17 </blockquote><br>  <b>Page 14</b> <br><blockquote>  1 ... 11 12 13 <b>14</b> 15 16 17 </blockquote><br>  <b>Page 15-17</b> <br><blockquote>  1 ... 12 13 14 15 16 17 </blockquote><br><h4>  Redirects </h4><br>  In addition to this, I want to highlight 2 more points from this, it is a check for the existence of the page and a redirect to the "correct" address.  Those.  for example, right there on Habr√©, the first page can be accessed immediately by 2 addresses: <br>  <a href="https://habrahabr.ru/sandbox/page1/">habrahabr.ru/sandbox/page1</a> <br>  <a href="https://habrahabr.ru/sandbox/">habrahabr.ru/sandbox</a> <br><br>  The script does not allow access to the page / 1 / address and performs a redirect to the ‚Äúclean‚Äù address. <br>  Also, if the page number specified is too large, it will be redirected to the last existing one.  For example, the materials were removed or the number of records per page was changed.  I can‚Äôt really say whether it will be useful from the point of view of the CEO, but for users it will seem more convenient to me. <br><br><h2>  PHP code and its use </h2><br><div class="spoiler">  <b class="spoiler_title">Php code</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">PaginateNavigationBuilder</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-comment"><span class="hljs-comment">/** *  URL   *            ,  {page} * : * /some_url{page}.html *    : * /some_url.html * /some_url/page_2.html *   {page}  ,        * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> string */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $baseUrl = <span class="hljs-string"><span class="hljs-string">'/'</span></span>; <span class="hljs-comment"><span class="hljs-comment">/** *    * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> string */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> $tpl = <span class="hljs-string"><span class="hljs-string">'page/{page}/'</span></span>; <span class="hljs-comment"><span class="hljs-comment">/** *   * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> string */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> $wrap = <span class="hljs-string"><span class="hljs-string">"&lt;div class=\"navigation\"&gt;{pages}&lt;/div&gt;"</span></span>; <span class="hljs-comment"><span class="hljs-comment">/** *         * : * $spread = 2 *  9      5 * 1 ... 3 4 5 6 7 ... 9 * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> integer */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> $spread = <span class="hljs-number"><span class="hljs-number">5</span></span>; <span class="hljs-comment"><span class="hljs-comment">/** *     * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> string */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> $separator = <span class="hljs-string"><span class="hljs-string">"&lt;i&gt;...&lt;/i&gt;"</span></span>; <span class="hljs-comment"><span class="hljs-comment">/** *     * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> string */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> $activeClass = <span class="hljs-string"><span class="hljs-string">'link_active'</span></span>; <span class="hljs-comment"><span class="hljs-comment">/** *    * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> integer */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $currentPage = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">/** *   ""  "" * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> bool */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> $nextPrev = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; <span class="hljs-comment"><span class="hljs-comment">/** *   "" * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> string */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> $prevTitle = <span class="hljs-string"><span class="hljs-string">''</span></span>; <span class="hljs-comment"><span class="hljs-comment">/** *   "" * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@var</span></span></span><span class="hljs-comment"> string */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> $nextTitle = <span class="hljs-string"><span class="hljs-string">''</span></span>; <span class="hljs-comment"><span class="hljs-comment">/** *   * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> string $baseUrl URL       */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">__construct</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($baseUrl = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">'/'</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;baseUrl = $baseUrl; } <span class="hljs-comment"><span class="hljs-comment">/** *      * * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> integer $limit    1  * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> integer $count_all     * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> integer $currentPage    * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> mixed       */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">build</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">($limit, $count_all, $currentPage = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( $limit &lt; <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OR</span></span> $count_all &lt;= $limit ) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; $count_pages = ceil( $count_all / $limit ); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( $currentPage &gt; $count_pages ) { header( <span class="hljs-string"><span class="hljs-string">"HTTP/1.0 301 Moved Permanently"</span></span> ); header( <span class="hljs-string"><span class="hljs-string">"Location: "</span></span> . <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;getUrl( $count_pages ) ); <span class="hljs-keyword"><span class="hljs-keyword">die</span></span>( <span class="hljs-string"><span class="hljs-string">"Redirect"</span></span> ); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( $currentPage == <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> $_SERVER[<span class="hljs-string"><span class="hljs-string">'REQUEST_URI'</span></span>] != <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;getUrl( $currentPage ) ) { header( <span class="hljs-string"><span class="hljs-string">"HTTP/1.0 301 Moved Permanently"</span></span> ); header( <span class="hljs-string"><span class="hljs-string">"Location: "</span></span> . <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;getUrl( $currentPage ) ); <span class="hljs-keyword"><span class="hljs-keyword">die</span></span>( <span class="hljs-string"><span class="hljs-string">"Redirect"</span></span> ); } <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;currentPage = intval( $currentPage ); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;currentPage &lt; <span class="hljs-number"><span class="hljs-number">1</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;currentPage = <span class="hljs-number"><span class="hljs-number">1</span></span>; $shift_start = max( <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;currentPage - <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;spread, <span class="hljs-number"><span class="hljs-number">2</span></span> ); $shift_end = min( <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;currentPage + <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;spread, $count_pages<span class="hljs-number"><span class="hljs-number">-1</span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( $shift_end &lt; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;spread*<span class="hljs-number"><span class="hljs-number">2</span></span> ) { $shift_end = min( <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;spread*<span class="hljs-number"><span class="hljs-number">2</span></span>, $count_pages<span class="hljs-number"><span class="hljs-number">-1</span></span> ); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( $shift_end == $count_pages - <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">AND</span></span> $shift_start &gt; <span class="hljs-number"><span class="hljs-number">3</span></span> ) { $shift_start = max( <span class="hljs-number"><span class="hljs-number">3</span></span>, min( $count_pages - <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;spread*<span class="hljs-number"><span class="hljs-number">2</span></span> + <span class="hljs-number"><span class="hljs-number">1</span></span>, $shift_start ) ); } $list = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;getItem( <span class="hljs-number"><span class="hljs-number">1</span></span> ); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ($shift_start == <span class="hljs-number"><span class="hljs-number">3</span></span>) { $list .= <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;getItem( <span class="hljs-number"><span class="hljs-number">2</span></span> ); } <span class="hljs-keyword"><span class="hljs-keyword">elseif</span></span> ( $shift_start &gt; <span class="hljs-number"><span class="hljs-number">3</span></span> ) { $list .= <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;separator; } <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>( $i = $shift_start; $i &lt;= $shift_end; $i++ ) { $list .= <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;getItem( $i ); } $last_page = $count_pages - <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( $shift_end == $last_page<span class="hljs-number"><span class="hljs-number">-1</span></span> ){ $list .= <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;getItem( $last_page ); } <span class="hljs-keyword"><span class="hljs-keyword">elseif</span></span>( $shift_end &lt; $last_page ) { $list .= <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;separator; } $list .= <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;getItem( $count_pages ); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;nextPrev ) { $list = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;getItem( <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;currentPage &gt; <span class="hljs-number"><span class="hljs-number">1</span></span> ? <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;currentPage - <span class="hljs-number"><span class="hljs-number">1</span></span> : <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;prevTitle, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> ) . $list . <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;getItem( <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;currentPage &lt; $count_pages ? <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;currentPage + <span class="hljs-number"><span class="hljs-number">1</span></span> : $count_pages, <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;nextTitle, <span class="hljs-keyword"><span class="hljs-keyword">true</span></span> ); } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> str_replace( <span class="hljs-string"><span class="hljs-string">"{pages}"</span></span>, $list, <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;wrap ); } <span class="hljs-comment"><span class="hljs-comment">/** *   * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> int $page_num   * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> string   */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getUrl</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( $page_num = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">0</span></span></span></span><span class="hljs-function"><span class="hljs-params"> )</span></span></span><span class="hljs-function"> </span></span>{ $page = $page_num &gt; <span class="hljs-number"><span class="hljs-number">1</span></span> ? str_replace( <span class="hljs-string"><span class="hljs-string">'{page}'</span></span>, $page_num, <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;tpl ) : <span class="hljs-string"><span class="hljs-string">''</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( stripos( <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;baseUrl, <span class="hljs-string"><span class="hljs-string">'{page}'</span></span> ) !== <span class="hljs-keyword"><span class="hljs-keyword">false</span></span> ){ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> str_replace( <span class="hljs-string"><span class="hljs-string">'{page}'</span></span>, $page, <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;baseUrl ); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;baseUrl . $page; } } <span class="hljs-comment"><span class="hljs-comment">/** *  / * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> int $page_num   * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> string $page_name  ,       * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@param</span></span></span><span class="hljs-comment"> bool $noclass * </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">@return</span></span></span><span class="hljs-comment"> - span      . */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getItem</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( $page_num, $page_name = </span></span><span class="hljs-string"><span class="hljs-function"><span class="hljs-params"><span class="hljs-string">''</span></span></span></span><span class="hljs-function"><span class="hljs-params">, $noclass = false )</span></span></span><span class="hljs-function"> </span></span>{ $page_name = $page_name ?: $page_num; $className = $noclass ? <span class="hljs-string"><span class="hljs-string">''</span></span> : <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;activeClass; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>( <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;currentPage == $page_num ) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"&lt;span class=\"{$className}\"&gt;{$page_name}&lt;/span&gt;"</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-string"><span class="hljs-string">"&lt;a href=\"{$this-&gt;getUrl($page_num)}\"&gt;{$page_name}&lt;/a&gt;"</span></span>; } } }</code> </pre> </div></div><br>  For clarity, here is an example of building a sandbox navigation: <br>  <a href="https://habrahabr.ru/sandbox/page12/">habrahabr.ru/sandbox/page12</a> <br><br><pre> <code class="php hljs">$navi = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PaginateNavigationBuilder( <span class="hljs-string"><span class="hljs-string">"/sandbox/"</span></span> ); $navi-&gt;tpl = <span class="hljs-string"><span class="hljs-string">"page{page}/"</span></span>; $navi-&gt;spread = <span class="hljs-number"><span class="hljs-number">4</span></span>; $template = $navi-&gt;build( $limit, $count_all, $page_num );</code> </pre> <br><br>  Or if the page number is registered inside the URL: <br>  <a href="http://example.com/some_url/1.html">example.com/some_url/1.html</a> - first page <br>  <a href="http://example.com/some_url/1-page2.html">example.com/some_url/1-page2.html</a> - second page <br><pre> <code class="php hljs">$navi = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PaginateNavigationBuilder( <span class="hljs-string"><span class="hljs-string">"/some_url/1{page}.html"</span></span> ); $navi-&gt;tpl = <span class="hljs-string"><span class="hljs-string">"-page{page}"</span></span>; $template = $navi-&gt;build( $limit, $count_all, $page_num );</code> </pre> <br>  Where <br><br>  <b>$ limit</b> - the number of entries per page <br>  <b>$ count_all</b> - total number of records <br>  <b>$ page_num</b> - page number on which the user is located <br><br>  On this, perhaps, everything.  I will be glad to any constructive criticism. <br><br>  Ps.  Many thanks to all unsubscribing, especially those who scold (and rightly so). <br>  I promise to read everything, take into account and correct. </div><p>Source: <a href="https://habr.com/ru/post/340246/">https://habr.com/ru/post/340246/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../340232/index.html">TextView and Spannable: highlighting parts of a word</a></li>
<li><a href="../340234/index.html">Writing a three-dimensional retro shooter engine from scratch</a></li>
<li><a href="../340236/index.html">Analysis of the case of changing the settings for the size of the data block for recording on tape with Veeam Backup & Replication</a></li>
<li><a href="../340238/index.html">(Without) painful NGINX Ingress</a></li>
<li><a href="../340242/index.html">Search and fix bugs in PHP source</a></li>
<li><a href="../340248/index.html">Creating distributions for different operating systems in Java 9 and 10</a></li>
<li><a href="../340250/index.html">In simple words: smart contracts, Ethereum, ICO</a></li>
<li><a href="../340252/index.html">China is a digital power. Impressions of Huawei Connect 2017</a></li>
<li><a href="../340254/index.html">Jinja2 Extensions Guide</a></li>
<li><a href="../340256/index.html">BlackOasis APT: a new campaign with a new zerodem</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>