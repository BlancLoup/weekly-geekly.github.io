<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Dynamic calls: method comparison</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Dynamic challenges: what is it and why? 

 I think for each developer working in static programming languages, sometimes there was a need to resort to...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Dynamic calls: method comparison</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage/9f944933/20d9c064/e1c22822/1042b663.png"><br><h1>  Dynamic challenges: what is it and why? </h1><br><br>  I think for each developer working in static programming languages, sometimes there was a need to resort to dynamic calls ‚Äî to call a method of something that nothing is yet known about.  Or get some property from some object, which will be known only at run-time. <br><br>  This is sometimes used in algorithms based on so-called duck typing: <blockquote>  If something looks like a duck, swims like a duck and quacks like a duck, then it probably is a duck. </blockquote>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In this article I would like to review the main methods available in Microsoft .NET 4.0, compare their performance and syntax. <br><br><a name="habracut"></a><br><h1>  Main available options </h1><br><br>  First I will list the options that I will analyze in this article.  If any of the options does not seem interesting, just skip.  And if there are any other options worth considering, please write, I will add them to the text. <br><br>  At once I will warn that the considered methods are not completely interchangeable: each has its own peculiarity and scope.  I wanted to compare the complexity of use and the speed of accessing / calling dynamic methods.  This will give the opportunity to choose a particular method based on a specific task. <br><br>  So: <br><br>  - Reflection (Reflection, RTTI, introspection) <br>  - Dictionary of meanings <br>  - Delegate Dictionary <br>  - Dynamic object with a static container <br>  - Dynamic object with Expando <br>  - Dynamic object with call pickup <br>  - Compilation of expressions (Expressions) <br><br><h1>  Testing method </h1><br><br>  So, as the goal is to compare the speed of access to fields / methods, I designed the tests in such a general structure: <br>  - there is a testing container object (ObjectTester), which contains the test object <br>  - the tested object must contain two properties - one whole (A) and one string (B) <br>  - the testing object delegates calls to the A and B objects to be tested. <br>  - the test environment creates an array of 2000 container objects, filling them with data <br>  - the test environment performs a testing operation 2000 times on each object in the array <br>  - the testing operation should receive at least two times the value of properties A and B (two times in order to give an opportunity to check the presence of a cache in the solution) <br>  - for each test method, the test is run 5 times <br><br>  The code is compiled under the Release configuration. <br>  The tests were run on Windows 7 x64, .NET 4.0.30319, Intel Core 2 Quad Q9400 (2666 MHz), 4GB DDR2 <br><br><h2>  Static (non dynamic) implementation </h2><br>  For comparison, as a reference point such an ObjectTester is added, which contains a simple class with two auto-properties and delegates calls to this class. <br><br>  This method will be the fastest, since it is not at all dynamic.  Therefore, we will compare other methods with respect to this. <br><br>  The code is quite simple (by the way, remember the static class, we will use it): <br> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">private</font> <font color="#0000ff">class</font> StaticObject <br> { <br> <font color="#0000ff">public</font> <font color="#0000ff">int</font> A { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <br> <font color="#0000ff">public</font> <font color="#0000ff">string</font> B { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <br> } <br> <br> <font color="#0000ff">private</font> <font color="#0000ff">class</font> StaticObjectTester : ObjectTester <br> { <br> <font color="#0000ff">private</font> <font color="#0000ff">readonly</font> StaticObject _o = <font color="#0000ff">new</font> StaticObject(); <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">override</font> <font color="#0000ff">int</font> A <br> { <br> <font color="#0000ff">get</font> { <font color="#0000ff">return</font> _o.A; } <br> <font color="#0000ff">set</font> { _o.A = <font color="#0000ff">value</font> ; } <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">override</font> <font color="#0000ff">string</font> B <br> { <br> <font color="#0000ff">get</font> { <font color="#0000ff">return</font> _o.B; } <br> <font color="#0000ff">set</font> { _o.B = <font color="#0000ff">value</font> ; } <br> } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code></code> <blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">private</font> <font color="#0000ff">class</font> StaticObject <br> { <br> <font color="#0000ff">public</font> <font color="#0000ff">int</font> A { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <br> <font color="#0000ff">public</font> <font color="#0000ff">string</font> B { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <br> } <br> <br> <font color="#0000ff">private</font> <font color="#0000ff">class</font> StaticObjectTester : ObjectTester <br> { <br> <font color="#0000ff">private</font> <font color="#0000ff">readonly</font> StaticObject _o = <font color="#0000ff">new</font> StaticObject(); <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">override</font> <font color="#0000ff">int</font> A <br> { <br> <font color="#0000ff">get</font> { <font color="#0000ff">return</font> _o.A; } <br> <font color="#0000ff">set</font> { _o.A = <font color="#0000ff">value</font> ; } <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">override</font> <font color="#0000ff">string</font> B <br> { <br> <font color="#0000ff">get</font> { <font color="#0000ff">return</font> _o.B; } <br> <font color="#0000ff">set</font> { _o.B = <font color="#0000ff">value</font> ; } <br> } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code></code> </blockquote> <br><br>  <b>Result:</b> 00: 00: 06.6274538 (+ 0.00%) <br><br>  Pros: <br>  - As quickly as possible <br>  Minuses <br>  - Not dynamic <br><br><h2>  Reflection (Reflection, RTTI, Introspection) </h2><br><br>  I think this is the very first way that comes to mind when you need dynamic challenges. <br><br>  In order to maximize speed, I used static caching PropertyInfo.  Usually in real projects there is always the opportunity to somehow cache the information necessary for reflection. <br><br>  So, as we are interested in the speed of work of exactly reflection, then for data storage we will use the ready-made class with two properties. <br><br>  Test object code: <br> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">private</font> <font color="#0000ff">class</font> ReflectionObjectTester : ObjectTester <br> { <br> <font color="#0000ff">private</font> <font color="#0000ff">static</font> <font color="#0000ff">readonly</font> PropertyInfo PropertyA = <font color="#0000ff">typeof</font> (StaticObject).GetProperty( <font color="#A31515">"A"</font> ); <br> <font color="#0000ff">private</font> <font color="#0000ff">static</font> <font color="#0000ff">readonly</font> PropertyInfo PropertyB = <font color="#0000ff">typeof</font> (StaticObject).GetProperty( <font color="#A31515">"B"</font> ); <br> <font color="#0000ff">private</font> <font color="#0000ff">static</font> <font color="#0000ff">readonly</font> <font color="#0000ff">object</font> [] Empty = <font color="#0000ff">new</font> <font color="#0000ff">object</font> [0]; <br> <font color="#0000ff">private</font> <font color="#0000ff">readonly</font> Object _o = <font color="#0000ff">new</font> StaticObject(); <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">override</font> <font color="#0000ff">int</font> A <br> { <br> <font color="#0000ff">get</font> { <font color="#0000ff">return</font> ( <font color="#0000ff">int</font> ) PropertyA.GetValue(_o, Empty); } <br> <font color="#0000ff">set</font> { PropertyA.SetValue(_o, <font color="#0000ff">value</font> , Empty); } <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">override</font> <font color="#0000ff">string</font> B <br> { <br> <font color="#0000ff">get</font> { <font color="#0000ff">return</font> ( <font color="#0000ff">string</font> ) PropertyB.GetValue(_o, Empty); } <br> <font color="#0000ff">set</font> { PropertyB.SetValue(_o, <font color="#0000ff">value</font> , Empty); } <br> } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> <blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">private</font> <font color="#0000ff">class</font> ReflectionObjectTester : ObjectTester <br> { <br> <font color="#0000ff">private</font> <font color="#0000ff">static</font> <font color="#0000ff">readonly</font> PropertyInfo PropertyA = <font color="#0000ff">typeof</font> (StaticObject).GetProperty( <font color="#A31515">"A"</font> ); <br> <font color="#0000ff">private</font> <font color="#0000ff">static</font> <font color="#0000ff">readonly</font> PropertyInfo PropertyB = <font color="#0000ff">typeof</font> (StaticObject).GetProperty( <font color="#A31515">"B"</font> ); <br> <font color="#0000ff">private</font> <font color="#0000ff">static</font> <font color="#0000ff">readonly</font> <font color="#0000ff">object</font> [] Empty = <font color="#0000ff">new</font> <font color="#0000ff">object</font> [0]; <br> <font color="#0000ff">private</font> <font color="#0000ff">readonly</font> Object _o = <font color="#0000ff">new</font> StaticObject(); <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">override</font> <font color="#0000ff">int</font> A <br> { <br> <font color="#0000ff">get</font> { <font color="#0000ff">return</font> ( <font color="#0000ff">int</font> ) PropertyA.GetValue(_o, Empty); } <br> <font color="#0000ff">set</font> { PropertyA.SetValue(_o, <font color="#0000ff">value</font> , Empty); } <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">override</font> <font color="#0000ff">string</font> B <br> { <br> <font color="#0000ff">get</font> { <font color="#0000ff">return</font> ( <font color="#0000ff">string</font> ) PropertyB.GetValue(_o, Empty); } <br> <font color="#0000ff">set</font> { PropertyB.SetValue(_o, <font color="#0000ff">value</font> , Empty); } <br> } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> </blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">private</font> <font color="#0000ff">class</font> ReflectionObjectTester : ObjectTester <br> { <br> <font color="#0000ff">private</font> <font color="#0000ff">static</font> <font color="#0000ff">readonly</font> PropertyInfo PropertyA = <font color="#0000ff">typeof</font> (StaticObject).GetProperty( <font color="#A31515">"A"</font> ); <br> <font color="#0000ff">private</font> <font color="#0000ff">static</font> <font color="#0000ff">readonly</font> PropertyInfo PropertyB = <font color="#0000ff">typeof</font> (StaticObject).GetProperty( <font color="#A31515">"B"</font> ); <br> <font color="#0000ff">private</font> <font color="#0000ff">static</font> <font color="#0000ff">readonly</font> <font color="#0000ff">object</font> [] Empty = <font color="#0000ff">new</font> <font color="#0000ff">object</font> [0]; <br> <font color="#0000ff">private</font> <font color="#0000ff">readonly</font> Object _o = <font color="#0000ff">new</font> StaticObject(); <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">override</font> <font color="#0000ff">int</font> A <br> { <br> <font color="#0000ff">get</font> { <font color="#0000ff">return</font> ( <font color="#0000ff">int</font> ) PropertyA.GetValue(_o, Empty); } <br> <font color="#0000ff">set</font> { PropertyA.SetValue(_o, <font color="#0000ff">value</font> , Empty); } <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">override</font> <font color="#0000ff">string</font> B <br> { <br> <font color="#0000ff">get</font> { <font color="#0000ff">return</font> ( <font color="#0000ff">string</font> ) PropertyB.GetValue(_o, Empty); } <br> <font color="#0000ff">set</font> { PropertyB.SetValue(_o, <font color="#0000ff">value</font> , Empty); } <br> } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br></code> <br><br>  <b>Result</b> : 00: 01: 32.3217880 (+ 1293.02%) <br><br>  In fact, the use of reflection has increased the execution time by almost 13 times!  A good way to think before using this method. <br><br>  Pros: <br>  - fully run time <br>  Minuses: <br>  - too long <br>  - problems may arise due to the requirement of ‚ÄúReflectionPermission‚Äù rights <br><br><h2>  Dictionary of meanings </h2><br><br>  The meaning of the method is to simply store the values ‚Äã‚Äãin a dictionary (Dictionary &lt;TKey, TValue&gt;).  As a key, we take the name of the field, and the value is the value of the field.  You have to use Object as the value type. <br><br>  Code: <br> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">private</font> <font color="#0000ff">class</font> DictionaryObjectTester : ObjectTester <br> { <br> <font color="#0000ff">private</font> <font color="#0000ff">const</font> <font color="#0000ff">string</font> AName = <font color="#A31515">"A"</font> ; <br> <font color="#0000ff">private</font> <font color="#0000ff">const</font> <font color="#0000ff">string</font> BName = <font color="#A31515">"B"</font> ; <br> <font color="#0000ff">private</font> <font color="#0000ff">readonly</font> Dictionary&lt; <font color="#0000ff">string</font> , Object&gt; _o = <font color="#0000ff">new</font> Dictionary&lt; <font color="#0000ff">string</font> , <font color="#0000ff">object</font> &gt;(); <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">override</font> <font color="#0000ff">int</font> A <br> { <br> <font color="#0000ff">get</font> { <font color="#0000ff">return</font> ( <font color="#0000ff">int</font> ) _o[AName]; } <br> <font color="#0000ff">set</font> { _o[AName] = <font color="#0000ff">value</font> ; } <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">override</font> <font color="#0000ff">string</font> B <br> { <br> <font color="#0000ff">get</font> { <font color="#0000ff">return</font> ( <font color="#0000ff">string</font> ) _o[BName]; } <br> <font color="#0000ff">set</font> { _o[BName] = <font color="#0000ff">value</font> ; } <br> } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code></code> <blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">private</font> <font color="#0000ff">class</font> DictionaryObjectTester : ObjectTester <br> { <br> <font color="#0000ff">private</font> <font color="#0000ff">const</font> <font color="#0000ff">string</font> AName = <font color="#A31515">"A"</font> ; <br> <font color="#0000ff">private</font> <font color="#0000ff">const</font> <font color="#0000ff">string</font> BName = <font color="#A31515">"B"</font> ; <br> <font color="#0000ff">private</font> <font color="#0000ff">readonly</font> Dictionary&lt; <font color="#0000ff">string</font> , Object&gt; _o = <font color="#0000ff">new</font> Dictionary&lt; <font color="#0000ff">string</font> , <font color="#0000ff">object</font> &gt;(); <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">override</font> <font color="#0000ff">int</font> A <br> { <br> <font color="#0000ff">get</font> { <font color="#0000ff">return</font> ( <font color="#0000ff">int</font> ) _o[AName]; } <br> <font color="#0000ff">set</font> { _o[AName] = <font color="#0000ff">value</font> ; } <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">override</font> <font color="#0000ff">string</font> B <br> { <br> <font color="#0000ff">get</font> { <font color="#0000ff">return</font> ( <font color="#0000ff">string</font> ) _o[BName]; } <br> <font color="#0000ff">set</font> { _o[BName] = <font color="#0000ff">value</font> ; } <br> } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code></code> </blockquote> <br><br>  <b>Result:</b> 00: 00: 10.8516518 (+ 63.64%) <br><br>  Pros: <br>  - completely dynamic: you can add and remove <br>  Minuses: <br>  - weak typing of values ‚Äã‚Äã(Object) <br>  - only values, not methods <br><br><h2>  Delegates dictionary </h2><br><br>  In practice, a slightly more complicated version is often used - we do not store values, but methods for obtaining these values.  Or just some dynamic set of functions / actions. <br><br>  Implementation: <br> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">private</font> <font color="#0000ff">class</font> DictionaryDelegateTester : ObjectTester <br> { <br> <font color="#0000ff">private</font> <font color="#0000ff">const</font> <font color="#0000ff">string</font> AName = <font color="#A31515">"A"</font> ; <br> <font color="#0000ff">private</font> <font color="#0000ff">const</font> <font color="#0000ff">string</font> BName = <font color="#A31515">"B"</font> ; <br> <br> <font color="#0000ff">private</font> <font color="#0000ff">readonly</font> Dictionary&lt; <font color="#0000ff">string</font> , Func&lt;Object&gt;&gt; _getters; <br> <font color="#0000ff">private</font> <font color="#0000ff">readonly</font> Dictionary&lt; <font color="#0000ff">string</font> , Action&lt;Object&gt;&gt; _setters; <br> <br> <font color="#0000ff">private</font> <font color="#0000ff">readonly</font> StaticObject _o = <font color="#0000ff">new</font> StaticObject(); <br> <br> <font color="#0000ff">public</font> DictionaryDelegateTester() <br> { <br> _getters = <font color="#0000ff">new</font> Dictionary&lt; <font color="#0000ff">string</font> , Func&lt;Object&gt;&gt; <br> { <br> {AName, () =&gt; _o.A}, <br> {BName, () =&gt; _o.B} <br> }; <br> _setters = <font color="#0000ff">new</font> Dictionary&lt; <font color="#0000ff">string</font> , Action&lt; <font color="#0000ff">object</font> &gt;&gt; <br> { <br> {AName, v =&gt; _o.A = ( <font color="#0000ff">int</font> ) v}, <br> {BName, v =&gt; _o.B = v.ToString()}, <br> }; <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">override</font> <font color="#0000ff">int</font> A <br> { <br> <font color="#0000ff">get</font> { <font color="#0000ff">return</font> ( <font color="#0000ff">int</font> ) _getters[AName](); } <br> <font color="#0000ff">set</font> { _setters[AName]( <font color="#0000ff">value</font> ); } <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">override</font> <font color="#0000ff">string</font> B <br> { <br> <font color="#0000ff">get</font> { <font color="#0000ff">return</font> ( <font color="#0000ff">string</font> ) _getters[BName](); } <br> <font color="#0000ff">set</font> { _setters[BName]( <font color="#0000ff">value</font> ); } <br> } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code></code> <blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">private</font> <font color="#0000ff">class</font> DictionaryDelegateTester : ObjectTester <br> { <br> <font color="#0000ff">private</font> <font color="#0000ff">const</font> <font color="#0000ff">string</font> AName = <font color="#A31515">"A"</font> ; <br> <font color="#0000ff">private</font> <font color="#0000ff">const</font> <font color="#0000ff">string</font> BName = <font color="#A31515">"B"</font> ; <br> <br> <font color="#0000ff">private</font> <font color="#0000ff">readonly</font> Dictionary&lt; <font color="#0000ff">string</font> , Func&lt;Object&gt;&gt; _getters; <br> <font color="#0000ff">private</font> <font color="#0000ff">readonly</font> Dictionary&lt; <font color="#0000ff">string</font> , Action&lt;Object&gt;&gt; _setters; <br> <br> <font color="#0000ff">private</font> <font color="#0000ff">readonly</font> StaticObject _o = <font color="#0000ff">new</font> StaticObject(); <br> <br> <font color="#0000ff">public</font> DictionaryDelegateTester() <br> { <br> _getters = <font color="#0000ff">new</font> Dictionary&lt; <font color="#0000ff">string</font> , Func&lt;Object&gt;&gt; <br> { <br> {AName, () =&gt; _o.A}, <br> {BName, () =&gt; _o.B} <br> }; <br> _setters = <font color="#0000ff">new</font> Dictionary&lt; <font color="#0000ff">string</font> , Action&lt; <font color="#0000ff">object</font> &gt;&gt; <br> { <br> {AName, v =&gt; _o.A = ( <font color="#0000ff">int</font> ) v}, <br> {BName, v =&gt; _o.B = v.ToString()}, <br> }; <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">override</font> <font color="#0000ff">int</font> A <br> { <br> <font color="#0000ff">get</font> { <font color="#0000ff">return</font> ( <font color="#0000ff">int</font> ) _getters[AName](); } <br> <font color="#0000ff">set</font> { _setters[AName]( <font color="#0000ff">value</font> ); } <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">override</font> <font color="#0000ff">string</font> B <br> { <br> <font color="#0000ff">get</font> { <font color="#0000ff">return</font> ( <font color="#0000ff">string</font> ) _getters[BName](); } <br> <font color="#0000ff">set</font> { _setters[BName]( <font color="#0000ff">value</font> ); } <br> } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code></code> </blockquote> <br><br>  <b>Result:</b> 00: 00: 12.3299023 (+ 85.93%) <br><br>  Pros: <br>  - completely dynamic: you can add and remove <br>  Minuses: <br>  - complex syntax <br><br><h2>  Dynamic object with a static container </h2><br><br>  Well, go to the most new type of 'dynamic'.  For him, I immediately apply three methods.  The first is when we store that static type as a ‚Äústorage‚Äù (backed object) for a dynamic: <br><br> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">private</font> <font color="#0000ff">class</font> DynamicObjectTester : ObjectTester <br> { <br> <font color="#0000ff">private</font> <font color="#0000ff">readonly</font> dynamic _o = <font color="#0000ff">new</font> StaticObject(); <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">override</font> <font color="#0000ff">int</font> A <br> { <br> <font color="#0000ff">get</font> { <font color="#0000ff">return</font> _o.A; } <br> <font color="#0000ff">set</font> { _o.A = <font color="#0000ff">value</font> ; } <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">override</font> <font color="#0000ff">string</font> B <br> { <br> <font color="#0000ff">get</font> { <font color="#0000ff">return</font> _o.B; } <br> <font color="#0000ff">set</font> { _o.B = <font color="#0000ff">value</font> ; } <br> } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code></code> <blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">private</font> <font color="#0000ff">class</font> DynamicObjectTester : ObjectTester <br> { <br> <font color="#0000ff">private</font> <font color="#0000ff">readonly</font> dynamic _o = <font color="#0000ff">new</font> StaticObject(); <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">override</font> <font color="#0000ff">int</font> A <br> { <br> <font color="#0000ff">get</font> { <font color="#0000ff">return</font> _o.A; } <br> <font color="#0000ff">set</font> { _o.A = <font color="#0000ff">value</font> ; } <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">override</font> <font color="#0000ff">string</font> B <br> { <br> <font color="#0000ff">get</font> { <font color="#0000ff">return</font> _o.B; } <br> <font color="#0000ff">set</font> { _o.B = <font color="#0000ff">value</font> ; } <br> } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code></code> </blockquote> <br><br>  <b>Result:</b> 00: 00: 10.7193446 (+ 61.65%) <br><br>  Pros: <br>  - can be transmitted in DLR (F #) <br>  - simple syntax <br>  Minuses: <br>  - and still a half times longer <br><br><h2>  Dynamic object with Expando </h2><br>  In fact, in order to more conveniently use dynamic-and add the type <a href="http://msdn.microsoft.com/en-us/library/system.dynamic.expandoobject.aspx">ExpandoObject</a> .  He has a lot of nice little things - he and IDictionary, and IEnumerable. <br><br>  Using: <br> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">private</font> <font color="#0000ff">class</font> ExpandoDynamicObjectTester : ObjectTester <br> { <br> <font color="#0000ff">private</font> <font color="#0000ff">readonly</font> dynamic _o = <font color="#0000ff">new</font> ExpandoObject(); <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">override</font> <font color="#0000ff">int</font> A <br> { <br> <font color="#0000ff">get</font> { <font color="#0000ff">return</font> _o.A; } <br> <font color="#0000ff">set</font> { _o.A = <font color="#0000ff">value</font> ; } <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">override</font> <font color="#0000ff">string</font> B <br> { <br> <font color="#0000ff">get</font> { <font color="#0000ff">return</font> _o.B; } <br> <font color="#0000ff">set</font> { _o.B = <font color="#0000ff">value</font> ; } <br> } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code></code> <blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">private</font> <font color="#0000ff">class</font> ExpandoDynamicObjectTester : ObjectTester <br> { <br> <font color="#0000ff">private</font> <font color="#0000ff">readonly</font> dynamic _o = <font color="#0000ff">new</font> ExpandoObject(); <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">override</font> <font color="#0000ff">int</font> A <br> { <br> <font color="#0000ff">get</font> { <font color="#0000ff">return</font> _o.A; } <br> <font color="#0000ff">set</font> { _o.A = <font color="#0000ff">value</font> ; } <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">override</font> <font color="#0000ff">string</font> B <br> { <br> <font color="#0000ff">get</font> { <font color="#0000ff">return</font> _o.B; } <br> <font color="#0000ff">set</font> { _o.B = <font color="#0000ff">value</font> ; } <br> } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code></code> </blockquote> <br><br>  <b>Result:</b> 00: 00: 09.7034082 (+ 46.3%) <br><br>  Pros: <br>  - can be transmitted in DLR (F #) <br>  - simple syntax and additional features (enumeration) <br>  Minuses: <br>  - practically absent, except for an increase in speed <br><br><h2>  Dynamic object with call pickup </h2><br><br>  Another of the nice features of dynamic is the ability to intercept calls to methods and properties.  We will use: <br> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">private</font> <font color="#0000ff">class</font> PureDynamicObjectTester : ObjectTester <br> { <br> <font color="#0000ff">private</font> <font color="#0000ff">readonly</font> dynamic _o = <font color="#0000ff">new</font> DynamicContainer(); <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">override</font> <font color="#0000ff">int</font> A <br> { <br> <font color="#0000ff">get</font> { <font color="#0000ff">return</font> _o.A; } <br> <font color="#0000ff">set</font> { _o.A = <font color="#0000ff">value</font> ; } <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">override</font> <font color="#0000ff">string</font> B <br> { <br> <font color="#0000ff">get</font> { <font color="#0000ff">return</font> _o.B; } <br> <font color="#0000ff">set</font> { _o.B = <font color="#0000ff">value</font> ; } <br> } <br> <br> <font color="#0000ff">#region</font> Nested type: DynamicContainer <br> <br> <font color="#0000ff">private</font> <font color="#0000ff">class</font> DynamicContainer : DynamicObject <br> { <br> <font color="#0000ff">private</font> <font color="#0000ff">int</font> _a; <br> <font color="#0000ff">private</font> <font color="#0000ff">string</font> _b; <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">override</font> <font color="#0000ff">bool</font> TryGetMember(GetMemberBinder binder, <font color="#0000ff">out</font> <font color="#0000ff">object</font> result) <br> { <br> <font color="#0000ff">if</font> (binder.Name == <font color="#A31515">"A"</font> ) <br> { <br> result = _a; <br> <font color="#0000ff">return</font> <font color="#0000ff">true</font> ; <br> } <br> <font color="#0000ff">if</font> (binder.Name == <font color="#A31515">"B"</font> ) <br> { <br> result = _b; <br> <font color="#0000ff">return</font> <font color="#0000ff">true</font> ; <br> } <br> <font color="#0000ff">return</font> <font color="#0000ff">base</font> .TryGetMember(binder, <font color="#0000ff">out</font> result); <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">override</font> <font color="#0000ff">bool</font> TrySetMember(SetMemberBinder binder, <font color="#0000ff">object</font> <font color="#0000ff">value</font> ) <br> { <br> <font color="#0000ff">if</font> (binder.Name == <font color="#A31515">"A"</font> ) <br> { <br> _a = ( <font color="#0000ff">int</font> ) <font color="#0000ff">value</font> ; <br> <font color="#0000ff">return</font> <font color="#0000ff">true</font> ; <br> } <br> <font color="#0000ff">if</font> (binder.Name == <font color="#A31515">"B"</font> ) <br> { <br> _b = ( <font color="#0000ff">string</font> ) <font color="#0000ff">value</font> ; <br> <font color="#0000ff">return</font> <font color="#0000ff">true</font> ; <br> } <br> <font color="#0000ff">return</font> <font color="#0000ff">base</font> .TrySetMember(binder, <font color="#0000ff">value</font> ); <br> } <br> } <br> <br> <font color="#0000ff">#endregion</font> <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code></code> <blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">private</font> <font color="#0000ff">class</font> PureDynamicObjectTester : ObjectTester <br> { <br> <font color="#0000ff">private</font> <font color="#0000ff">readonly</font> dynamic _o = <font color="#0000ff">new</font> DynamicContainer(); <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">override</font> <font color="#0000ff">int</font> A <br> { <br> <font color="#0000ff">get</font> { <font color="#0000ff">return</font> _o.A; } <br> <font color="#0000ff">set</font> { _o.A = <font color="#0000ff">value</font> ; } <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">override</font> <font color="#0000ff">string</font> B <br> { <br> <font color="#0000ff">get</font> { <font color="#0000ff">return</font> _o.B; } <br> <font color="#0000ff">set</font> { _o.B = <font color="#0000ff">value</font> ; } <br> } <br> <br> <font color="#0000ff">#region</font> Nested type: DynamicContainer <br> <br> <font color="#0000ff">private</font> <font color="#0000ff">class</font> DynamicContainer : DynamicObject <br> { <br> <font color="#0000ff">private</font> <font color="#0000ff">int</font> _a; <br> <font color="#0000ff">private</font> <font color="#0000ff">string</font> _b; <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">override</font> <font color="#0000ff">bool</font> TryGetMember(GetMemberBinder binder, <font color="#0000ff">out</font> <font color="#0000ff">object</font> result) <br> { <br> <font color="#0000ff">if</font> (binder.Name == <font color="#A31515">"A"</font> ) <br> { <br> result = _a; <br> <font color="#0000ff">return</font> <font color="#0000ff">true</font> ; <br> } <br> <font color="#0000ff">if</font> (binder.Name == <font color="#A31515">"B"</font> ) <br> { <br> result = _b; <br> <font color="#0000ff">return</font> <font color="#0000ff">true</font> ; <br> } <br> <font color="#0000ff">return</font> <font color="#0000ff">base</font> .TryGetMember(binder, <font color="#0000ff">out</font> result); <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">override</font> <font color="#0000ff">bool</font> TrySetMember(SetMemberBinder binder, <font color="#0000ff">object</font> <font color="#0000ff">value</font> ) <br> { <br> <font color="#0000ff">if</font> (binder.Name == <font color="#A31515">"A"</font> ) <br> { <br> _a = ( <font color="#0000ff">int</font> ) <font color="#0000ff">value</font> ; <br> <font color="#0000ff">return</font> <font color="#0000ff">true</font> ; <br> } <br> <font color="#0000ff">if</font> (binder.Name == <font color="#A31515">"B"</font> ) <br> { <br> _b = ( <font color="#0000ff">string</font> ) <font color="#0000ff">value</font> ; <br> <font color="#0000ff">return</font> <font color="#0000ff">true</font> ; <br> } <br> <font color="#0000ff">return</font> <font color="#0000ff">base</font> .TrySetMember(binder, <font color="#0000ff">value</font> ); <br> } <br> } <br> <br> <font color="#0000ff">#endregion</font> <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code></code> </blockquote> <br><br>  A bit long came out. <br><br>  <b>Result:</b> 00: 00: 11.1040041 (+ 67.45%) <br><br>  Pros: <br>  - can be transmitted in DLR (F #) <br>  - properties may not even exist <br>  Minuses: <br>  - requires significantly more code <br><br><h2>  Compilation of expressions (Expressions) </h2><br><br>  This method does not use dynamic (although it can be quite easily wrapped into DynamicObject), and is most closely related to the method using reflection.  In fact, he uses reflection, but only to build an expression tree and compile it. <br><br>  In fact, there is an "emitting" of the IL-code.  As a result, we get a huge increase in speed. <br><br>  I wrote the following implementation: I made two extension methods over propertyInfo to get the getter and setter, but not in the form of MethodInfo, as for ordinary reflection, but in the form of Func (getter) and Action (setter).  In fact, my getter looks something like " <code>o =&gt; ((T)o).{name}</code> " and the setter is " <code>(o, v) =&gt; ((T)o).{name} = v</code> ". <br><br>  To make these helper methods easy to read, I put each of the expression nodes in separate variables: <br> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">static</font> Func&lt; <font color="#0000ff">object</font> , T&gt; GetValueGetter&lt;T&gt;( <font color="#0000ff">this</font> PropertyInfo propertyInfo) <br> { <br> <font color="#0000ff">var</font> instance = Expression.Parameter( <font color="#0000ff">typeof</font> (Object), <font color="#A31515">"i"</font> ); <br> <font color="#0000ff">var</font> castedInstance = Expression.ConvertChecked(instance, propertyInfo.DeclaringType); <br> <font color="#0000ff">var</font> property = Expression.Property(castedInstance, propertyInfo); <br> <font color="#0000ff">var</font> convert = Expression. <font color="#2B91AF">Convert</font> (property, <font color="#0000ff">typeof</font> (T)); <br> <font color="#0000ff">var</font> expression = Expression.Lambda(convert, instance); <br> <font color="#0000ff">return</font> (Func&lt; <font color="#0000ff">object</font> , T&gt;)expression.Compile(); <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">static</font> Action&lt; <font color="#0000ff">object</font> ,T&gt; GetValueSetter&lt;T&gt;( <font color="#0000ff">this</font> PropertyInfo propertyInfo) <br> { <br> <font color="#0000ff">var</font> instance = Expression.Parameter( <font color="#0000ff">typeof</font> (Object), <font color="#A31515">"i"</font> ); <br> <font color="#0000ff">var</font> castedInstance = Expression.ConvertChecked(instance, propertyInfo.DeclaringType); <br> <font color="#0000ff">var</font> argument = Expression.Parameter( <font color="#0000ff">typeof</font> (T), <font color="#A31515">"a"</font> ); <br> <font color="#0000ff">var</font> setterCall = Expression.Call( <br> castedInstance, <br> propertyInfo.GetSetMethod(), <br> Expression. <font color="#2B91AF">Convert</font> (argument, propertyInfo.PropertyType)); <br> <font color="#0000ff">return</font> (Action&lt; <font color="#0000ff">object</font> ,T&gt;)Expression.Lambda(setterCall, instance, argument) <br> .Compile(); <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code></code> <blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">static</font> Func&lt; <font color="#0000ff">object</font> , T&gt; GetValueGetter&lt;T&gt;( <font color="#0000ff">this</font> PropertyInfo propertyInfo) <br> { <br> <font color="#0000ff">var</font> instance = Expression.Parameter( <font color="#0000ff">typeof</font> (Object), <font color="#A31515">"i"</font> ); <br> <font color="#0000ff">var</font> castedInstance = Expression.ConvertChecked(instance, propertyInfo.DeclaringType); <br> <font color="#0000ff">var</font> property = Expression.Property(castedInstance, propertyInfo); <br> <font color="#0000ff">var</font> convert = Expression. <font color="#2B91AF">Convert</font> (property, <font color="#0000ff">typeof</font> (T)); <br> <font color="#0000ff">var</font> expression = Expression.Lambda(convert, instance); <br> <font color="#0000ff">return</font> (Func&lt; <font color="#0000ff">object</font> , T&gt;)expression.Compile(); <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">static</font> Action&lt; <font color="#0000ff">object</font> ,T&gt; GetValueSetter&lt;T&gt;( <font color="#0000ff">this</font> PropertyInfo propertyInfo) <br> { <br> <font color="#0000ff">var</font> instance = Expression.Parameter( <font color="#0000ff">typeof</font> (Object), <font color="#A31515">"i"</font> ); <br> <font color="#0000ff">var</font> castedInstance = Expression.ConvertChecked(instance, propertyInfo.DeclaringType); <br> <font color="#0000ff">var</font> argument = Expression.Parameter( <font color="#0000ff">typeof</font> (T), <font color="#A31515">"a"</font> ); <br> <font color="#0000ff">var</font> setterCall = Expression.Call( <br> castedInstance, <br> propertyInfo.GetSetMethod(), <br> Expression. <font color="#2B91AF">Convert</font> (argument, propertyInfo.PropertyType)); <br> <font color="#0000ff">return</font> (Action&lt; <font color="#0000ff">object</font> ,T&gt;)Expression.Lambda(setterCall, instance, argument) <br> .Compile(); <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code></code> </blockquote> <br><br>  As a result, the testing class: <br> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">private</font> <font color="#0000ff">class</font> ExpressionObjectTester : ObjectTester <br> { <br> <font color="#0000ff">private</font> <font color="#0000ff">static</font> <font color="#0000ff">readonly</font> Func&lt; <font color="#0000ff">object</font> , <font color="#0000ff">int</font> &gt; AGetter = <br> <font color="#0000ff">typeof</font> (StaticObject).GetProperty( <font color="#A31515">"A"</font> ).GetValueGetter&lt; <font color="#0000ff">int</font> &gt;(); <br> <br> <font color="#0000ff">private</font> <font color="#0000ff">static</font> <font color="#0000ff">readonly</font> Func&lt; <font color="#0000ff">object</font> , <font color="#0000ff">string</font> &gt; BGetter = <br> <font color="#0000ff">typeof</font> (StaticObject).GetProperty( <font color="#A31515">"B"</font> ).GetValueGetter&lt; <font color="#0000ff">string</font> &gt;(); <br> <br> <font color="#0000ff">private</font> <font color="#0000ff">static</font> <font color="#0000ff">readonly</font> Action&lt; <font color="#0000ff">object</font> , <font color="#0000ff">int</font> &gt; ASetter = <br> <font color="#0000ff">typeof</font> (StaticObject).GetProperty( <font color="#A31515">"A"</font> ).GetValueSetter&lt; <font color="#0000ff">int</font> &gt;(); <br> <br> <font color="#0000ff">private</font> <font color="#0000ff">static</font> <font color="#0000ff">readonly</font> Action&lt; <font color="#0000ff">object</font> , <font color="#0000ff">string</font> &gt; BSetter = <br> <font color="#0000ff">typeof</font> (StaticObject).GetProperty( <font color="#A31515">"B"</font> ).GetValueSetter&lt; <font color="#0000ff">string</font> &gt;(); <br> <br> <font color="#0000ff">private</font> <font color="#0000ff">readonly</font> StaticObject _o = <font color="#0000ff">new</font> StaticObject(); <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">override</font> <font color="#0000ff">int</font> A <br> { <br> <font color="#0000ff">get</font> { <font color="#0000ff">return</font> AGetter(_o); } <br> <font color="#0000ff">set</font> { ASetter(_o, <font color="#0000ff">value</font> ); } <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">override</font> <font color="#0000ff">string</font> B <br> { <br> <font color="#0000ff">get</font> { <font color="#0000ff">return</font> BGetter(_o); } <br> <font color="#0000ff">set</font> { BSetter(_o, <font color="#0000ff">value</font> ); } <br> } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code></code> <blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">private</font> <font color="#0000ff">class</font> ExpressionObjectTester : ObjectTester <br> { <br> <font color="#0000ff">private</font> <font color="#0000ff">static</font> <font color="#0000ff">readonly</font> Func&lt; <font color="#0000ff">object</font> , <font color="#0000ff">int</font> &gt; AGetter = <br> <font color="#0000ff">typeof</font> (StaticObject).GetProperty( <font color="#A31515">"A"</font> ).GetValueGetter&lt; <font color="#0000ff">int</font> &gt;(); <br> <br> <font color="#0000ff">private</font> <font color="#0000ff">static</font> <font color="#0000ff">readonly</font> Func&lt; <font color="#0000ff">object</font> , <font color="#0000ff">string</font> &gt; BGetter = <br> <font color="#0000ff">typeof</font> (StaticObject).GetProperty( <font color="#A31515">"B"</font> ).GetValueGetter&lt; <font color="#0000ff">string</font> &gt;(); <br> <br> <font color="#0000ff">private</font> <font color="#0000ff">static</font> <font color="#0000ff">readonly</font> Action&lt; <font color="#0000ff">object</font> , <font color="#0000ff">int</font> &gt; ASetter = <br> <font color="#0000ff">typeof</font> (StaticObject).GetProperty( <font color="#A31515">"A"</font> ).GetValueSetter&lt; <font color="#0000ff">int</font> &gt;(); <br> <br> <font color="#0000ff">private</font> <font color="#0000ff">static</font> <font color="#0000ff">readonly</font> Action&lt; <font color="#0000ff">object</font> , <font color="#0000ff">string</font> &gt; BSetter = <br> <font color="#0000ff">typeof</font> (StaticObject).GetProperty( <font color="#A31515">"B"</font> ).GetValueSetter&lt; <font color="#0000ff">string</font> &gt;(); <br> <br> <font color="#0000ff">private</font> <font color="#0000ff">readonly</font> StaticObject _o = <font color="#0000ff">new</font> StaticObject(); <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">override</font> <font color="#0000ff">int</font> A <br> { <br> <font color="#0000ff">get</font> { <font color="#0000ff">return</font> AGetter(_o); } <br> <font color="#0000ff">set</font> { ASetter(_o, <font color="#0000ff">value</font> ); } <br> } <br> <br> <font color="#0000ff">public</font> <font color="#0000ff">override</font> <font color="#0000ff">string</font> B <br> { <br> <font color="#0000ff">get</font> { <font color="#0000ff">return</font> BGetter(_o); } <br> <font color="#0000ff">set</font> { BSetter(_o, <font color="#0000ff">value</font> ); } <br> } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code></code> </blockquote> <br><br>  <b>Result</b> : 00: 00: 08.5675928 (+ 29.20%) <br><br>  Pros: <br>  - amazing speed <br>  Minuses <br>  - slightly complicated implementation <br><br><h1>  Summary Table and Conclusions </h1><br><br><table border="1"><tbody><tr><th>  Method name </th><th>  Time </th><th>  Time additive </th></tr><tr><td>  Reflection </td><td>  00: 01: 33.6077139 </td><td>  1311.59% </td></tr><tr><td>  Dictionary of meanings </td><td>  00: 00: 10.8516518 </td><td>  63.64% </td></tr><tr><td>  Delegates dictionary </td><td>  00: 00: 12.3299023 </td><td>  85.93% </td></tr><tr><td>  Dynamic object with a static container </td><td>  00: 00: 10.7193446 </td><td>  61.65% </td></tr><tr><td>  Dynamic object with Expando </td><td>  00: 00: 09.7034082 </td><td>  46.33% </td></tr><tr><td>  Dynamic object with call pickup </td><td>  00: 00: 11.1040041 </td><td>  67.45% </td></tr><tr><td>  Compilation of expressions (Expressions) </td><td>  00: 00: 08.5675928 </td><td>  29.20% </td></tr></tbody></table><br><br>  The conclusions are pretty simple: <br>  - If you need speed - use Expression.  They are not so terrible, if you dig a little, but they give you just amazing results when compared with ordinary reflection (although even with dynamic, it is almost twice as fast on average) <br>  - If you need to use dynamic objects (for example, in conjunction with DLR - F #, IronRuby), then it is better to use ExpandoObject.  It gives excellent results. <br>  - The implementation of dynamic s in .NET is quite effective, even when compared with a dictionary <br><br>  <b>But most importantly:</b> Use dynamic calls only where they are <i>really needed</i> ! <br><br>  A good example is the processing of XML data with a weakly-defined structure.  A bad example is the description of the algorithm.  It is better to always select the necessary interfaces and already operate with concepts describing the behavior. <br><br>  Do not forget - dynamic types practically negate the possibility of refactoring, the possibility of catching errors at the compilation stage, the possibility of effective optimization. <br><br>  I hope this article will help those who think to take advantage of the dynamic capabilities of the language ‚Äî either choose the right method or decide not to use it. <br><br>  Code is available on Google Code <a href="http://code.google.com/p/benchmarking-net/source/checkout">for cloning</a> or <a href="http://code.google.com/p/benchmarking-net/source/browse/">viewing.</a> </div><p>Source: <a href="https://habr.com/ru/post/103558/">https://habr.com/ru/post/103558/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../103548/index.html">Developing an oAuth application for the Twitter API in PHP</a></li>
<li><a href="../103549/index.html">Well Very Simple Task Scheduler</a></li>
<li><a href="../103551/index.html">PyCon Ukraine (October 23-24, Kiev)</a></li>
<li><a href="../103553/index.html">Interview with Dmitry Agafonov [Ubuntu.ru]</a></li>
<li><a href="../103556/index.html">ViewSonic ViewPads Details</a></li>
<li><a href="../103565/index.html">Chumby Hacker Board</a></li>
<li><a href="../103572/index.html">How to catch the "flow", and how to make it not break</a></li>
<li><a href="../103573/index.html">Debian GNU / Linux 5.0.6 released</a></li>
<li><a href="../103575/index.html">HTML5 for web designers. Part 2: The HTML5 Model</a></li>
<li><a href="../103576/index.html">The Japanese introduced advanced Tamagotchi</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>