<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Russification of the Nook reader: what happened (technical side)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In general, I bought myself a Nook reader, read and read for several weeks, and then I wanted to write something for it and this initiative turned int...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Russification of the Nook reader: what happened (technical side)</h1><div class="post__text post__text-html js-mediator-article"><img src="http://mynook.ru/design/header_logo.gif" alt="image"><br><br>  In general, I bought myself a Nook reader, read and read for several weeks, and then I wanted to write something for it and this initiative turned into a russified firmware made with <a href="https://geektimes.ru/users/nilov/" class="user_link">nilov</a> and with the help of various people from nookdevs.org, including JesusFreke and poutine. <br><br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Excuses </h4><br><ul><li>  Personally, I did everything under Linux, but nothing special, which cannot (I think) be done under Windows (and the first versions of the scripts were written under it) or under a poppy. </li><li>  I am new to writing scripts, so I would be happy if someone put them in order or corrected me. </li><li>  And yes, I do not bear any responsibility for what you do with your Nook. </li><li>  In part, this article will be a guide for those who also want to join us. </li></ul><br><h4>  Required software </h4><br><ul><li>  <a href="http://code.google.com/p/nook-rus/">Fresh version of my tulkit</a> </li><li>  <a href="http://developer.android.com/sdk/index.html">Fresh Android SDK with downloaded package for 1.5</a> </li><li>  Text editor </li><li>  Linux </li></ul><br><br><h4>  Description of all utilities and build their firmware </h4><br>  <b>ATTENTION: I beg you very much - do not create thousands of firmware versions!</b>  <b>Let's do it all over-centrally!</b> <br><br><h5>  Getting applications directly from the device: download / download-all utilities </h5><br><br>  These utilities allow you to download applications from your folder to the downloaded folder, and also completely unpacks them into the selected folder (we will need it to get the initial resources and code). <br><br>  The first one gets the names of the system application at the entrance, and the second one does not receive anything and downloads all the applications listed in rus_res / index <br><br>  They look very simple - this is the sequential execution of the adb and apktool utilities: <br> <code>adb pull /system/app/$1.apk downloaded/$1.apk <br> java -jar apktool.jar d -f downloaded/$1.apk extracted/$1/ <br></code> <br><br>  After completing the download-all, we get all the resources we need and now we can proceed to the modification and replacement of resources. <br><br><h5>  Application modification </h5><br><br>  There are some difficulties.  Painlessly, you can change only the resources, and the code will not change, apparently because of the dalvik-machine cache or something like that. <br><br><h5>  Resources </h5><br>  There is nothing complicated in the replacement of resources - we simply unpack the downloads folder into the temporary work /% appname% folder, replace the files there and pack them back, and then perform adb push (not adb install) and download the application to the device.  This method is very convenient for debugging new design, debugging fonts and css-ok in readers, something simplified by this method was used by my acquaintance with mynook.ru when selecting fonts, etc.  =) <br><br><h5>  Code </h5><br>  Everything is absolutely the same as with resources, but there is one thing.  We will not be able to put the application on the device.  When you try to open a new application, Nook simply simply hangs, and a normal adb install will not roll, because  we change system applications.  What is the way out?  The solution is to directly assemble the firmware with the modified code and put them on the device and see how it works.  Yes, it is difficult, but we do not need cardinal changes anyway. <br><br><h5>  Scripts for modifications: process / process-all </h5><br><br>  <a href="http://code.google.com/p/nook-rus/source/browse/trunk/process">Full code process</a> <br><br>  Here I will briefly describe what and where it copies and executes (all files are taken from rus_res /% appname% /) <br><br><ol><li>  For Home and Library, unpack with decompiling the code, for the rest - only resources - <b>here you need to edit if in other applications you will change the code</b> </li><li>  strings.xm -&gt; values ‚Äã‚Äã/ strings.xml </li><li>  styles.xm -&gt; values ‚Äã‚Äã/ styles.xml </li><li>  strings.xm -&gt; values ‚Äã‚Äã/ arrays.xml </li><li>  colors.xm -&gt; values ‚Äã‚Äã/ colors.xml </li><li>  values ‚Äã‚Äã/ * -&gt; values ‚Äã‚Äã/ * </li><li>  xml / * -&gt; xml / * </li><li>  assets / * -&gt; assets / * </li><li>  executes script </li><li>  layouts / * -&gt; res / layout / * </li><li>  drawable / * -&gt; res / drawable / * </li><li>  Is packing </li><li>  Signs with our key </li></ol><br><br><h5>  Russification of most texts: folder sasha and script copy-sasha </h5><br><br>  In the sasha folder (so simply the designer‚Äôs name is with mynook, by the way, he is extremely thankful to him for that. Without him I wouldn‚Äôt have much enthusiasm at least =)) are cut xml files with texts that are glued together and copied to the required places in the rus_res folder. <br><br><h5>  Upload to device: upload / upload-all </h5><br><br>  Let me remind you that this is only for applications with modified resources and with the original code. <br><br>  The code is also extremely simple: <br> <code>adb push %appname%.apk /system/app/%appname%.apk</code> <br> <br><h5>  Create firmware: build-firmware </h5><br><br>  Here, too, everything is very simple =) We will use the standard softrutovskuyu firmware and change it. <br><br>  On the nookdevs.com IRC channel, people gave me a special (not complicated) script for packing / unpacking images and we will also use it. <br><br>  With all this, we can simplify as much as possible the entire course of creating the firmware: unpacking, changing, packing. <br><br>  I will list what we are changing in the firmware at the moment: <br><br><ul><li>  We replace the necessary system applications with our russified applications from the output folder (obtained in the previous steps through the process script). </li><li>  We copy init.rc - it is necessary for FBReader'a </li><li>  We copy our applications - the application manager and our modified wifi locker from nookdevs.com </li><li>  Copy FBReader and its associated hacks - for example, sqlite3root with SUID, as well as replace the boot scripts that govern the rights to sqlite3root, copy the native libraries of the freighter. </li><li>  We copy the Russified UI fonts. </li><li>  Copy wallpaper =) </li></ul><br><br>  Now we have the firmware and we can run it on our ruled Nuke! <br><br>  PS: <br>  there may need to manually create some folders, I do not remember where I already adjusted in the scripts. </div><p>Source: <a href="https://habr.com/ru/post/97666/">https://habr.com/ru/post/97666/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../97660/index.html">10 outstanding iPad apps that will shock you. (Part 1)</a></li>
<li><a href="../97662/index.html">Yandex Direct. Tutorial novice advertiser. Click price in pictures</a></li>
<li><a href="../97663/index.html">Oversan lies?</a></li>
<li><a href="../97664/index.html">Elemental: War of Magic - a new turn-based strategy from the studio Stardock</a></li>
<li><a href="../97665/index.html">Made in CSS: iOS Icons and Others ...</a></li>
<li><a href="../97667/index.html">QR for payment by SMS</a></li>
<li><a href="../97668/index.html">Kinect is not a revolution, or how to use technology for porn</a></li>
<li><a href="../97670/index.html">Making a code ‚Üí Atoms</a></li>
<li><a href="../97671/index.html">10 outstanding iPad apps that will shock you. (Part 2)</a></li>
<li><a href="../97674/index.html">Win32 / Olmarik or TDL3 study in detail</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>