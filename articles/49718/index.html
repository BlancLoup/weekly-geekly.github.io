<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>MVC Framework: a great introduction for beginners</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Necessary digression: not so long ago I posted an article intended for the print edition . The article below has the same fate: it did not go to press...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>MVC Framework: a great introduction for beginners</h1><div class="post__text post__text-html js-mediator-article"><blockquote>  Necessary digression: not so long ago I <a href="http://habrahabr.ru/blogs/ie/48968/">posted an article intended for the print edition</a> .  The article below has the same fate: it did not go to press due to the plight of the magazine.  Like last time, I decided to publish an article on Habr√©, since the subject matter falls under the format.  It should be noted that the article is framed and contains text for the magazine, if it was prepared for Habr, then some parts could be changed.  I hope you enjoy the article. </blockquote><br><img src="http://habradigest.ru/garbage/mvc/mvc.jpg" align="left">  Recently, it is noticeable that Microsoft pays increased attention to the development of its development tools, new tools and software development mechanisms on its .net platform.  The C # language is rapidly developing, the fourth version of which is just around the corner.  Introduced and actively promoted new language F #.  The Entity Framework has been developed for database developers, which is already available as a final version in the first service pack for .Net Framework 3.5 and Visual Studio 2008. Microsoft is actively engaged in the client part of developing web projects.  For our attention, the development path proposed Ajax.Net 4.0.  Internet Explorer 8 is increasingly conforming to standards and is becoming an attractive tool for web programmers, for example, its Developer Tools tab includes a JavaScript profiler.  A very good news recently was the announcement of full support and the inclusion of the jQuery JavaScript library in the next Visual Studio update.  In this light, the question arises, what is the proposed ASP.NET developers?  The answer is MVC Framework.  The purpose of this article is to consider some common problems that programmers may encounter when deciding to use the MVC Framework for their web projects and their solutions. <br><a name="habracut"></a><br><h3>  O MVC </h3><br>  Pattern Model-view-controller or in English Model-view-controller has been used for a long time.  Back in 1979, he was described by Trigve Reenskaug in his work ‚ÄúDeveloping applications on Smalltalk-80: how to use Model-view-controller‚Äù.  Since then, the pattern has established itself as a very successful software architecture. <br><br><div style="text-align:center;"><img src="http://habradigest.ru/garbage/mvc/mvc_1.png"></div><br><br>  The user, working with the interface, controls the controller that intercepts user actions.  Next, the controller notifies the model of user actions, thereby changing the state of the model.  The controller also notifies the view.  The view, using the current state of the model, builds the user interface. <br>  The basis of the pattern is the separation of the application data model, its logic and data presentation from each other.  Thus, following the rule of "divide and conquer", it is possible to build coherent software, in which, firstly, the model does not depend on presentation and logic, and secondly, the user interface is reliably separated from the control logic. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      At the moment, the MVC pattern is implemented in one form or another for most of the programming languages ‚Äã‚Äãused to develop web applications.  PHP has the largest number of implementations, but for Java, Perl, Python, Ruby has its own variants.  Before the advent of the MVC version of Microsoft, for the .NET platform, there were also different versions: Maverick.NET and MonoRail. <br><br><h3>  ASP.NET MVC Framework </h3><br>  On December 10, 2007, Microsoft introduced its version of the MVC implementation for ASP.NET.  It is still based on .aspx, .ascx and .master files, fully supports form-based authentication, roles, data caching, session state management, health monitoring, configuration, provider architecture, and more. <br><br>  On the other hand, the MVC Framework does not involve the use of classic web forms and web controls, it lacks mechanisms such as callbacks (postbacks) and view state (viewstate).  The MVC Framework also offers the use of URL-mapping and REST architecture as a query model, which will positively affect the search engine optimization of web-projects. <br><table><tbody><tr><td>  --- </td><td>  Classic ASP.NET </td><td>  MVC </td></tr><tr><td>  Query model </td><td>  postback </td><td>  REST </td></tr><tr><td>  Data model </td><td>  through the cs-file code of the page (code-behind) </td><td>  determined by MVC pattern </td></tr><tr><td>  Interface development </td><td>  web-controls </td><td>  pure html MVC UI Helpers </td></tr><tr><td>  Auto id generation </td><td>  Yes </td><td>  not </td></tr><tr><td>  Viewstate </td><td>  there is </td><td>  not </td></tr><tr><td>  URL mapping </td><td>  not </td><td>  there is </td></tr></tbody></table><br>  In general, expressing my opinion, I can say that the MVC Framework has proposed a new style for ASP.NET developers that is focused on the quality of client code.  The generated MVC code of the pages does not contain anything automatically generated, there are no bloated identifiers, no huge viewstate, writing client scripts is simplified due to the fact that the page code is pure, created by the HTML programmer himself.  In an era when the concept of web 2.0 firmly entered into our lives full control over the page on the client side - this is the key to the success of any web-project. <br><br><h3>  MVC Framework Versions </h3><br>  From version to version, the MVC Framework is improving, and for the period from September to October, two versions were released that brought a lot of new things, so the following changes occurred in Preview 5: <br><ul><li>  Added support for rendering partial views, in fact, you can insert your custom elements into the view; </li><li>  Added attribute AcceptVerbs, which allows you to set the action for a specific type of request (POST or GET); </li><li>  Added attribute ActionName, which allows you to set the name of the method action.  By default, the names of action and method name are the same, but now it is possible to make them different; </li><li>  Changed the operation of the attribute HandleError.  Now developers can see standard "yellow pages of death" with information about errors; </li><li>  Added support for complex types through ModelBinder. </li></ul><br>  The MVC Framework Beta, released in mid-October, also contains a lot of add-ons: <br><ul><li>  New "Add View" menu in Visual Studio </li><li>  \ Scripts folder and jQuery support </li><li>  Built-in support for Model Binder for complex types </li><li>  Rebuilt Infrastructure Model Binder </li><li>  Improved UpdateModel and TryUpdateModel methods </li><li>  Improved testing of UpdateModel and TryUpdateModel scripts </li><li>  The AcceptVerbs attribute is typed.  Added HttpVerbs listing. </li><li>  Improved default error messages during validation </li><li>  Some helper methods have been modified.  Changed form creation.  Methods of steel extension-methods of class HtmlHelper. </li><li>  Silverlight 2 project support </li><li>  The ASP.NET MVC Futures build for this beta is rendered separately and is not included in the delivery. </li><li>  GAC Assembly Placement Support </li></ul><br><h3>  Tips </h3><br><h4>  How to set on the page html element select </h4><br>  To create an element, use the DropDownList Html class helper method: <br><blockquote>  &lt;% = Html.DropDownList ("", "sampleSelect")%&gt; </blockquote><br>  The first parameter specifies the string that will be added to the list of the element, as the default string, the second parameter is the name of our select. <br>  The most interesting thing is how to add data to select.  Suppose we have the following data model: <br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">class</font> Product <br> { <br> <font color="#0000ff">public</font> <font color="#0000ff">string</font> Name <br> { <br> <font color="#0000ff">get</font> ; <br> <font color="#0000ff">set</font> ; <br> } <br> <font color="#0000ff">public</font> <font color="#0000ff">int</font> Id <br> { <br> <font color="#0000ff">get</font> ; <br> <font color="#0000ff">set</font> ; <br> } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  To place a data set of type Product in select, you must do the following: <br><blockquote>  var products = GetProducts (); <br>  ViewData ["sampleSelect"] = new SelectList (products, "Id", "Name"); </blockquote><br>  Where <br>  GetProducts is a certain method, the data source is in the form of IEnumerable, such data sources should be located in the data model, here is simplified for example; <br>  SelectList is a helper class defined in System.Web.MVC. <br><br>  Here, through ViewData, the set of data created using the SelectList class is passed, the constructor of which, through the first parameter, receives data in the form of products.  The names of the properties defined in the Product class for the values ‚Äã‚Äãand output text in select are passed in the second and third parameters. <br><br><h4>  How to display a user control </h4><br>  In order to display your control, the Html.RenderPartial (...) method presented in preview 5 is used.  In order to use a user control in its projects, it must be created as an MVC View User Control, and not as a regular Web User Control.  The difference is in what class the created element is inherited.  In the case of MVC, the element will be inherited from System.Web.Mvc.ViewUserControl. <br><br>  Displaying a custom item is easy: <br><blockquote>  &lt;% Html.RenderPartial ("SampleUserCtrl");  %&gt; </blockquote><br>  <em>Where SampleUserCtrl is the name of the class that represents the user control.</em> <br><br><h4>  How to assign an attribute class to an element created through an Html class </h4><br>  The HTML helper class is a very useful MVC Framework tool that allows you to consistently create controls on a page.  And, of course, the methods of this class allows you to set the attributes of html-elements.  In the example, we will set a hyperlink with the text SampleLink, the action ActionName with the parameter product.Id tag rel = "nofollow". <br><blockquote>  Html.ActionLink ("SampleLink", ActionName, new {product.Id}, new {rel = "nofollow"}) </blockquote><br>  The problem begins when the attribute name matches the reserved word in C #, which of course is ‚Äúclass‚Äù.  The solution is simple: <br><blockquote>  Html.ActionLink ("SampleLink", ActionName, new {product.Id}, new {@class = "sample-css-class"}) </blockquote><br><h4>  When little ViewData </h4><br>  Sometimes, it is required to transfer data from one action to another.  For example, on the page with the input field during the processing of the entered data, we had an exceptional situation, which must be reported, returning back to the page.  Since the processing of the entered data was done by one action, and the handling of the page is managed by another, then ViewData, which is used in other cases, will not help us. <br>  For such cases, there is TempData in MVC, a data structure that exists only at the time of the request and is then deleted. <br><blockquote>  &lt;% if (TempData ["Message"]! = null) {%&gt; <br>  &lt;% = HttpUtility.HtmlEncode (TempData ["Message"]. ToString ())%&gt; <br>  &lt;%}%&gt; </blockquote><br>  This code will display a message in case it exists.  The message itself is elementary: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">if</font> ( <font color="#2B91AF">String</font> .IsNullOrEmpty(UserText)) <br> { <br> TempData[ <font color="#A31515">"Message"</font> ] = <font color="#A31515">"  "</font> ; <br> <font color="#0000ff">return</font> RedirectToAction( <font color="#A31515">"Index"</font> ); <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><h4>  We share the logic of GET and POST requests </h4><br>  The MVC Framework preview 5 brought, among other things, one remarkable mechanism that allows you to separate the logic for POST and GET requests.  This separation is made through the AcceptVerbs attribute.  For example, let's say we have a form on the main page for entering a login and password.  There is also an action Login, which is responsible for checking the entered login and password, user authentication and authorization.  For security, you can limit the action of this action by forcing it to process only POST requests from the form on the page.  And all other requests to send to another action, which would simply return the same page. <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">[AcceptVerbs( <font color="#A31515">"GET"</font> )] <br> <font color="#0000ff">public</font> ActionResult Login() <br> { <br> <font color="#0000ff">return</font> View( <font color="#A31515">"Index"</font> ); <br> } <br> <br> [AcceptVerbs( <font color="#A31515">"POST"</font> )] <br> <font color="#0000ff">public</font> ActionResult Login( <font color="#0000ff">string</font> userLogin, <font color="#0000ff">string</font> userPass) <br> { <br> [‚Ä¶   ‚Ä¶] <br> <font color="#0000ff">return</font> RedirectToAction( <font color="#A31515">"Index"</font> , <font color="#A31515">"Home"</font> ); <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  In addition, the HttpVerbs enumeration appeared in the MVC Framework Beta, with which you can set the AcceptVerbs attribute parameter to a strongly typed value. <br><blockquote>  [AcceptVerbs (HttpVerbs.Post)] </blockquote><br><h4>  Caching control </h4><br>  MVC Framework allows you to manage the caching of the result of each action.  That is, you can specify how and how much a particular request will be cached on the server or on the client.  For this, there is an analogue of the classic asp.net directive <strong>&lt;% @ OutputCache%&gt;</strong> attribute [OutputCache].  Below are its parameters: <br><table><tbody><tr><td>  Parameter </td><td>  Description </td></tr><tr><td>  VaryByHeader </td><td>  a line with semicolon-separated values ‚Äã‚Äãof http-headers by which conditional caching will be performed </td></tr><tr><td>  VaryByParam </td><td>  sets conditional caching based on the values ‚Äã‚Äãof the query string during GET or parameters during POST </td></tr><tr><td>  VaryByContentEncoding </td><td>  specifies caching condition depending on the contents of the Accept-Encoding http-header directive </td></tr><tr><td>  Duration </td><td>  Duration sets the time value in seconds during which the page or user element is cached. </td></tr><tr><td>  NoStore </td><td>  takes a boolean value.  If true, adds the no-store parameter to the Cache-Control http-header directive. </td></tr><tr><td>  Cacheprofile </td><td>  used to specify a caching profile specified via web.config and the caching section </td></tr><tr><td>  OutputCacheLocation </td><td>  This parameter describes the rule for the cache storage location and takes one of the values ‚Äã‚Äãof the OutputCacheLocation enumeration. </td></tr><tr><td>  VaryByCustom </td><td>  any text to control caching.  If this text is equal to ‚Äúbrowser‚Äù, then caching will be done conditionally by the name of the browser and its major version.  If a string is specified for VaryByCustom, then you must override the GetVaryByCustomString method in the Global.asax file to implement conditional caching. </td></tr></tbody></table><br>  Using OutputCache is very basic.  The following example shows how to cache the result of the action Index for 10 seconds. <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">[OutputCache(Duration = 10)] <br> <font color="#0000ff">public</font> ActionResult Index() <br> { <br> ‚Ä¶ <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><h4>  Complex pages and custom models </h4><br>  Often in the creation of pages involved a lot of the most heterogeneous data.  For example, on the personal page of a user of a portal, there can be data with his selected news, his profile data, data about messages sent by other participants, weather data or date and exact time, and a lot of different data. <br><br>  Such data, when stored in databases, are not stored in one table, but in several, maybe even several dozen.  In this case, if you use the ORM - database object model, then to create a single MVC Framework page, you will have to initialize a lot of list or other variables and fill them with data. <br><br>  In this case, I recommend making your complex data model by implementing the letter M from the word MVC.  Below I will give an example of one of the options for implementing such a model: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">class</font> BankInfoModel <br> { <br> <font color="#0000ff">public</font> Bank Bank; <br> <font color="#0000ff">public</font> <font color="#2B91AF">IEnumerable</font> &lt;BankBranch&gt; BankBranches; <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  A model is created that contains the value of Bank and the transfer of all branches of this bank (for example, for several reasons, we cannot get a list of branches simply through the Bank). <br><br>  To use our model transparently, we need to do the following: remake the base class of our view with <br><blockquote>  public partial class Index: ViewPage </blockquote><br>  on <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">partial</font> <font color="#0000ff">class</font> Index : ViewPage&lt;BankInfoModel&gt;</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  Now, in the view code, an instantiated instance of the BankInfoModel model is available to us via ViewData.Model.  Of course, the controller must initialize it for us, but this is elementary: <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> ActionResult Info( <font color="#0000ff">int</font> ? id) <br> { <br> <font color="#0000ff">var</font> info = <font color="#0000ff">new</font> BankInfoModel {Bank = db.Banks.Single(x =&gt; x.id == id)}; <br> info.BankBranches = info.Bank.LocationBranches <br> .Where(x =&gt; x.Address.Street.cityId == 1).SelectMany(x =&gt; x.BankBranches); <br> <br> <font color="#0000ff">return</font> View(info); <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  <em>Where is the int?</em>  <em>id is a parameter that points to a bank id</em> <br><br>  Using an instance of our model in a view is also simple: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">div</font> <font color="#ff0000">class</font> <font color="#0000ff">="vcard"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">h1</font> <font color="#0000ff">&gt;&lt;</font> <font color="#800000">span</font> <font color="#ff0000">class</font> <font color="#0000ff">="fn org"</font> <font color="#0000ff">&gt;</font> <font>&lt;%</font> =ViewData.Model.Bank.shortName <font>%&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">span</font> <font color="#0000ff">&gt;&lt;/</font> <font color="#800000">h1</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">p</font> <font color="#0000ff">&gt;</font> : <font color="#0000ff">&lt;</font> <font color="#800000">span</font> <font color="#ff0000">class</font> <font color="#0000ff">="fn phone"</font> <font color="#0000ff">&gt;</font> <font>&lt;%</font> =ViewData.Model.Bank.phone <font>%&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">span</font> <font color="#0000ff">&gt;&lt;/</font> <font color="#800000">p</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">div</font> <font color="#0000ff">&gt;</font></font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><h4>  Complex types, ModelBinder </h4><br>  MVC Framework is so arranged that the transfer of form values ‚Äã‚Äãis done through action parameters.  For example, below is a form with two fields for entering login and password data. <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">form</font> <font color="#ff0000">method</font> <font color="#0000ff">="post"</font> <font color="#ff0000">action</font> <font color="#0000ff">="&lt;%= Html.AttributeEncode(Url.Action("</font> <font color="#ff0000">Login</font> <font color="#0000ff">", "</font> <font color="#ff0000">Home</font> <font color="#0000ff">")) %&gt;"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">ul</font> <font color="#0000ff">&gt;&lt;</font> <font color="#800000">li</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">label</font> <font color="#ff0000">for</font> <font color="#0000ff">="txtLogin"</font> <font color="#0000ff">&gt;</font>   <font color="#0000ff">&lt;/</font> <font color="#800000">label</font> <font color="#0000ff">&gt;</font> <font>&lt;%</font> = Html.TextBox( <font color="#A31515">"userLogin"</font> , ‚Äú‚Äù, <font color="#0000ff">new</font> {id = <font color="#A31515">"txtLogin"</font> }) <font>%&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">li</font> <font color="#0000ff">&gt;&lt;</font> <font color="#800000">li</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">label</font> <font color="#ff0000">for</font> <font color="#0000ff">="txtPass"</font> <font color="#0000ff">&gt;</font>   <font color="#0000ff">&lt;/</font> <font color="#800000">label</font> <font color="#0000ff">&gt;</font> <font>&lt;%</font> = Html.Password( <font color="#A31515">"userPass"</font> , ‚Äú‚Äù, <font color="#0000ff">new</font> {id = <font color="#A31515">"txtPass"</font> }) <font>%&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">li</font> <font color="#0000ff">&gt;&lt;</font> <font color="#800000">li</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">input</font> <font color="#ff0000">type</font> <font color="#0000ff">="submit"</font> <font color="#ff0000">value</font> <font color="#0000ff">=""</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">li</font> <font color="#0000ff">&gt;&lt;/</font> <font color="#800000">ul</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">form</font> <font color="#0000ff">&gt;</font></font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  The data that the user entered in this form will be passed into action through the appropriate parameters, as shown below: <br><blockquote>  [AcceptVerbs ("POST")] <br>  public ActionResult Login (string userLogin, string userPass) </blockquote><br>  But what to do when the form contains dozens of input fields?  Is it possible to create dozens of parameters for action?  No, the MVC Framework contains a mechanism that allows you to avoid such an ugly step as numerous method parameters.  Such a mechanism is called ModelBinder.  First, let's declare a class that describes our form: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">class</font> LoginModel <br> { <br> <font color="#0000ff">public</font> <font color="#0000ff">string</font> userLogin { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <br> <font color="#0000ff">public</font> <font color="#0000ff">string</font> userPass { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <br> <br> <font color="#0000ff">public</font> LoginModel() <br> { <br> } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  Then, we need to define a class that implements the IModelBinder interface: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">class</font> LoginModelBinder : IModelBinder <br> { <br> <font color="#0000ff">public</font> <font color="#0000ff">object</font> GetValue(ControllerContext controllerContext, <font color="#0000ff">string</font> modelName, <br> Type modelType, ModelStateDictionary modelState) <br> <br> { <br> LoginModel modelData = <font color="#0000ff">new</font> LoginModel (); <br> modelData.userLogin = controllerContext. <font color="#2B91AF">HttpContext</font> .Request[ <font color="#A31515">"userLogin"</font> ]; <br> modelData.userPass = controllerContext. <font color="#2B91AF">HttpContext</font> .Request[ <font color="#A31515">"userPass"</font> ]; <br> <br> <font color="#0000ff">return</font> modelData; <br> } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  Please note that we define the GetValue method and fill in the model data through the request context. <br><br>  Before the final step, we need to specify the ModelBinder attribute for our LoginModel class: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">[ModelBinder( <font color="#0000ff">typeof</font> (LoginModelBinder))] <br> <font color="#0000ff">public</font> <font color="#0000ff">class</font> LoginModel <br> { <br> <font color="#0000ff">public</font> <font color="#0000ff">string</font> userLogin { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <br> <font color="#0000ff">public</font> <font color="#0000ff">string</font> userPass { <font color="#0000ff">get</font> ; <font color="#0000ff">set</font> ; } <br> <br> <font color="#0000ff">public</font> LoginModel() <br> { <br> } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  In conclusion, we use our constructions to automatically initialize the parameters passed from the form: <br><blockquote>  [AcceptVerbs ("POST")] <br>  public ActionResult Login ([ModelBinder (typeof (LoginModelBinder))] LoginModel loginModelData) </blockquote><br>  This option appeared in the MVC Framework preview 5. <br>  MVC Framework Beta has brought significant improvements in this plan.  Now there is a built-in binder that automatically serves the transfer of standard .NET types.  That is, instead of creating your ModelBinder in the previous example, we can create simplified code: <br><blockquote>  [AcceptVerbs (HttpVerbs.Post)] <br>  public ActionResult Login (LoginModel loginModelData) </blockquote><br>  In addition, the Bind attribute is available for developers, which allows you to manage the prefix of the names of form parameters, so it is possible to change its value or indicate that the prefix will not be at all.  The same attribute allows you to set "white" or "black" lists of form properties that will be associated with the values ‚Äã‚Äãof a complex type parameter. <br><blockquote>  [AcceptVerbs (HttpVerbs.Post)] <br>  public ActionResult Login ([Bind (Prefix = ‚Äù‚Äù, Include = ‚ÄùuserLogin, userPass‚Äù)] LoginModel loginModelData) </blockquote><br>  And although we are not obliged to create our own ModelBinder variants, this tool can still be useful and will be useful for fine-tuning the processing of the values ‚Äã‚Äãof complex types submitted from the form. <br><br><h4>  Interception of the raw errors, incorrect URL </h4><br>  It is known that nothing confuses the user as an incomprehensible error that occurred out of the blue.  Even if such errors occur in your project from time to time, you need to ensure that the user receives the notification as friendly as possible.  For such purpose, error pages, interception of unhandled exceptions, as well as handling 404 http error ‚ÄúPage not found‚Äù are used. <br><br>  To catch unhandled exceptions, you need to create in the Views / Shared folder an Error.aspx page with error information that contains, for example, the following code: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">span</font> <font color="#0000ff">&gt;</font> <br> ! ,      . <font color="#0000ff">&lt;</font> <font color="#800000">br</font> <font color="#0000ff">/&gt;</font> <br>  : <font>&lt;%</font> = ViewData.Model.Exception.Message <font>%&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">span</font> <font color="#0000ff">&gt;</font></font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  In order for all unhandled exceptions to be redirected to our page, each controller must specify the HandleError attribute: <br><blockquote>  [HandleError] <br>  public class HomeController: Controller </blockquote><br>  Further, in order to process all invalid URLs that do not fall under our route specified in global.asax, you need to create another route that would send all invalid requests to a special page: <br><blockquote>  routes.MapRoute ("Error", "{* url}", new <br>  { <br>  controller = "Error", <br>  action = "Http404" <br>  }); </blockquote><br>  As you can see, all incorrect URLs will result in the action Http404 of the Error controller.  You need to create such a controller and add an action: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">class</font> ErrorController : Controller <br> { <br> <font color="#0000ff">public</font> ActionResult Index() <br> { <br> <font color="#0000ff">return</font> RedirectToAction( <font color="#A31515">"Http404"</font> ); <br> } <br> <font color="#0000ff">public</font> ActionResult Http404() <br> { <br> Response.StatusCode = 404; <br> <font color="#0000ff">return</font> View(); <br> } <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  The content of the Http404.aspx view is elementary: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">h1</font> <font color="#0000ff">&gt;</font> 404 <font color="#0000ff">&lt;/</font> <font color="#800000">h1</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">p</font> <font color="#0000ff">&gt;</font>     <font color="#0000ff">&lt;/</font> <font color="#800000">p</font> <font color="#0000ff">&gt;</font></font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  Thus, we catch attempts to navigate the wrong route, but what if the route falls under the pattern, but is still incorrect?  An exit can be a field check with an exception being thrown: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">public</font> ActionResult Info( <font color="#0000ff">int</font> ? id) <br> { <br> <font color="#0000ff">if</font> (!id.HasValue) <br> <font color="#0000ff">throw</font> <font color="#0000ff">new</font> HttpException( <font color="#A31515">"404"</font> ); <br> <br> [ ‚Ä¶ ‚Ä¶ ] <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  To intercept such a custom exception, you must create or modify the customErrors section in web.config: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">customErrors</font> <font color="#ff0000">mode</font> <font color="#0000ff">="RemoteOnly"</font> <font color="#0000ff">&gt;</font> <br> <font color="#0000ff">&lt;</font> <font color="#800000">error</font> <font color="#ff0000">statusCode</font> <font color="#0000ff">="404"</font> <font color="#ff0000">redirect</font> <font color="#0000ff">="~/Error/Http404"</font> <font color="#0000ff">/&gt;</font> <br> <font color="#0000ff">&lt;/</font> <font color="#800000">customErrors</font> <font color="#0000ff">&gt;</font></font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  Thus, all of our custom 404 exceptions will also be redirected to our Http404.aspx page, which will keep the general approach and combine the concept of ‚Äúnot found page‚Äù with both invalid URLs and URLs entered with an error or due to some other unacceptable reasons for handling, for example due to an access violation. <br><br>  It should be noted that for the correct operation of error interception in IIS7, the following parameters must be set in the ‚ÄúError pages‚Äù section of your site settings. <br><div style="text-align:center;"><img src="http://habradigest.ru/garbage/mvc/mvc_2.png"></div><br><h3>  Conclusion </h3><br>  In the article I tried to describe some aspects of working with the MVC Framework.  Many moments are elementary, some are not as simple as they seem, some are well described on the Internet, some are not described at all.  In all cases, the above material can do a good job both for those who are just starting out with the MVC Framework, and for those who already have experience creating web applications with it. <br><br>  The MVC Framework today is just a beta version of the product that will be in the end.  But now this tool allows you to create web applications using all the power of the MVC pattern.  Perhaps when you read this article, the final release of the MVC Framework will be released, which is expected by the end of 2008, but it can be assumed that most of the functions will not be changed. <br><br> <a href="http://progg.ru/MVC-Framework-%25D0%25B1%25D0%25BE%25D0%25BB%25D1%258C%25D1%2588%25D0%25BE%25D0%25B5-%25D0%25B2%25D0%25B2%25D0%25B5%25D0%25B4%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5-%25D0%25B4%25D0%25BB%25D1%258F-%25D0%25BD%25D0%25B0%25D1%2587%25D0%25B8%25D0%25BD%25D0%25B0%25D1%258E%25D1%2589%25D0%25B8%25D1%2585"><img alt="Progg it" src="http://progg.ru/image.axd?url=http%3A%2F%2Fhabrahabr.ru%2Fblogs%2Fnet%2F49718%2F&amp;textBackColor=fa7500&amp;countBackColor=0a0f02"></a> <br></div><p>Source: <a href="https://habr.com/ru/post/49718/">https://habr.com/ru/post/49718/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../49708/index.html">Adobe Flash Player 10.0 for 64-bit Linux</a></li>
<li><a href="../49711/index.html">Look Pic - show everyone! :)</a></li>
<li><a href="../49713/index.html">Based on the game Life</a></li>
<li><a href="../49715/index.html">Education Ruby / Rails despite the articles on Habr√©</a></li>
<li><a href="../49717/index.html">OS usage statistics</a></li>
<li><a href="../49719/index.html">MS Press Free Books</a></li>
<li><a href="../49720/index.html">How to extend the trial of Windows 7 to 120 days</a></li>
<li><a href="../49723/index.html">Functional programming for earthlings - functions</a></li>
<li><a href="../49724/index.html">EntroPay - we pay by credit card to the Internet</a></li>
<li><a href="../49729/index.html">How to make a flush bluetooth socket in C (Linux)?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>