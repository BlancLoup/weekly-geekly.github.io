<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Porting your favorite Android game</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Making the game process is exciting and informative. This is especially noticeable when you make a remake of the ‚Äúclassics‚Äù yourself, guided by the id...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Porting your favorite Android game</h1><div class="post__text post__text-html js-mediator-article">  Making the game process is exciting and informative.  This is especially noticeable when you make a remake of the ‚Äúclassics‚Äù yourself, guided by the ideas of the original and dozens of hours spent on the campaign.  I didn‚Äôt have any significant development experience for Android, so the creation of a working ‚Äúas it should be‚Äù application for a tablet at first looked rather vague, but it‚Äôs no less attractive.  Given the time and opportunity, you can shake off the dust from old games, grease and glue, adding support for ‚Äúlarge‚Äù resolutions and it turns out that they look no worse than modern products laid out on the market, even with an RGB565 palette without an alpha channel.  I assumed that there would be pitfalls and a carefully hidden rake, which lie quietly during development, but are painfully thrashed on the head, it is worth running the game on real hardware.  What was badly missing was a debugger, and the problems that arose only reinforced the desire to achieve the goal.  Under the cut there will be a story about how it all worked. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0e9/c6e/011/0e9c6e0111a11b3209993cd20685c090.jpg" alt="image"><br><a name="habracut"></a><br>  It is necessary to immediately warn that it will probably be a story about bicycles, I have not invented anything that does not google on the open spaces of the ‚ÄúInternet‚Äù.  Also, the Reader is unlikely to see new solutions or mega technologies, but will find tested instructions for building an application using SDL1 / 2 for Android. <br><br>  <b>Hello!</b> <br>  <a href="https://bitbucket.org/dalerank/caesaria/wiki/Home">The Caesar III ¬© remake</a> did not begin as a separate project, but rather a set of fixes for the number of residents, support for ‚Äúlarge‚Äù resolutions and <a href="http://habrahabr.ru/post/221913/">research of the decompiled code of the original game</a> in search of Easter eggs and undocumented modes of operation.  And when the amount of the restored code exceeded half of the total, it became clear that you can try to restore the game.  SDL1.2 was chosen as the rendering library, which has proven itself in other projects, and is still easy to learn and use.  At first, the remake was Linux-only, at the beginning of this year I moved to other platforms (Mac, Windows and Haiku), and then I got <a href="http://www.samsung.com/us/support/owners/product/SGH-I957ZKAATT">such a tablet</a> , and from time to time my head had thoughts ‚Äúit works on one Linux, it should work on another‚Äù. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <b>Attempt number once, successful</b> <br>  SDL version 1.2 ‚Äúout of the box‚Äù does not have the ability to work under android, but there is a wonderful project <a href="https://github.com/pelya/commandergenius">libsdl-android</a> , which allows, using your environment and scripts, to collect code that uses this library in an android application.  The collected application can download resources both from the Internet and unpack from the installer.  Libsdl-android itself contains a large number of libraries that you may need, ranging from bzip2 and various codecs, to the SDL itself and its SDL_image, SDL_mixer, ttf, and other environments.  If the game does not have platform-specific code, then porting takes several steps: <br><div class="spoiler">  <b class="spoiler_title">0. installation and configuration adt</b> <div class="spoiler_text">  # / bin / bash <br>  ARCH = x86_64; <br>  NDK_VERSION = r9; <br>  SDK_VERSION = 20130729; <br>  [$ (TARGET_ARCH) = "i386"] &amp;&amp; ARCH = x86; <br>  echo "Downloading the ndk ..."; <br>  wget --quiet --continue <a href="http://dl.google.com/android/ndk/android-ndk-">dl.google.com/android/ndk/android-ndk-</a> $$ NDK_VERSION-linux - $$ ARCH.tar.bz2; <br>  echo "Extracting the ndk ..."; <br>  tar -xjf android-ndk - $$ NDK_VERSION-linux - $$ ARCH.tar.bz2 -C ~ /; <br>  echo "Downloading the sdk ..."; <br>  wget --quiet --continue <a href="http://dl.google.com/android/adt/adt-bundle-linux-">dl.google.com/android/adt/adt-bundle-linux-</a> $$ ARCH - $$ SDK_VERSION.zip; <br>  echo "Extracting the sdk ..."; <br>  ARCHIVE = `readlink -f adt-bundle-linux - $$ ARCH - $$ SDK_VERSION.zip`; <br>  cd ~; <br>  unzip -o -qq $$ ARCHIVE; <br>  echo "Configure paths ..."; <br>  echo "export ANDROID_SDK = ~ / adt-bundle-linux - $$ ARCH - $$ SDK_VERSION / sdk" &gt;&gt; ~ / .bashrc; <br>  echo "export ANDROID_NDK = ~ / android-ndk - $$ NDK_VERSION" &gt;&gt; ~ / .bashrc; <br>  echo "export NDK_ROOT = \ $$ ANDROID_NDK" &gt;&gt; ~ / .bashrc; <br>  echo "export PATH = \ $$ PATH: \ $$ ANDROID_NDK: \ $$ ANDROID_SDK / tools: \ $$ ANDROID_SDK / platform-tools" &gt;&gt; ~ / .bashrc; <br></div></div><br><div class="spoiler">  <b class="spoiler_title">1. cloning the libsdl-android repository</b> <div class="spoiler_text">  git clone <a href="https://github.com/pelya/commandergenius">github.com/pelya/commandergenius</a> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">2. copying the application sources into the libsdl-android project folder</b> <div class="spoiler_text">  in my case, this is source code cloning via git <br>  cd commandergenius / project / jni / application <br>  git clone <a href="https://bitbucket.org/dalerank/caesaria">bitbucket.org/dalerank/caesaria</a> <br></div></div><br><div class="spoiler">  <b class="spoiler_title">3. creating a configuration file for building a game via libsdl-andlroid</b> <div class="spoiler_text"><br>  In the source folder, you need to create or copy an AndroidAppSettings.cfg file from another project; below, I gave its contents to my config file. <br>  comments are to be deleted, I also omitted the default settings <br>  # The application settings for Android libSDL port <br>  # Name that will be shown to user <br>  AppName = "CaesarIA" <br>  # package name <br>  AppFullName = net.dalerank.caesaria <br>  # internal version of the application <br>  AppVersionCode = 1740 <br>  # this version will be shown to user <br>  AppVersionName = "0.3.1740" <br>  # here you can specify a local or remote archive, which will be unpacked after installation <br>  AppDataDownloadUrl = "!! Game data is 100 Mb | cache.zip" <br>  # version of the library with which the application is going (version 2.0 does not work) <br>  LibSdlVersion = 1.2 <br>  screen orientation <br>  ScreenOrientation = h <br>  # depth of color, supported by 16/24/32 - 16 is the fastest, there are no noticeable differences <br>  VideoDepthBpp = 16 <br>  This and the two following flags are responsible for the OpenGL connection to the applications, <br>  # since I do not use GL, then there is no sense in connecting them <br>  NeedDepthBuffer = n <br>  NeedStencilBuffer = n <br>  NeedGles2 = n <br>  # flag is responsible for storing textures in RAM, if it didn‚Äôt cause problems on a PC, then <br>  # on android without this flag textures may not be displayed <br>  SwVideoMode = y <br>  # mouse emulation, the flag is needed for the following two flags <br>  AppUsesMouse = y <br>  # processing multiple simultaneous clicks <br>  AppUsesMultitouch = y <br>  # emulation of pressing the right mouse button, tapom second finger <br>  AppNeedsTwoButtonMouse = y <br>  # cursor display <br>  ShowMouseCursor = n <br>  # actually yes should be here, but when this flag was enabled, the input field was not removed <br>  AppNeedsTextInput = n <br>  # read permission from the drive <br>  AccessSdCard = y <br>  # if the cache is pulled from the Internet, then you need to put in yes <br>  AccessInternet = n <br>  # the number of built-in SDL virtual buttons, I use my GUI, so there will be no buttons <br>  AppTouchscreenKeyboardKeysAmount = 0 <br>  # SDL saver delay before application start <br>  StartupMenuButtonTimeout = 3000 <br>  # what abi application will be built for <br>  MultiABI = armeabi-v7a <br>  # here you need to specify the library.  besides sdl, which are needed for the application to work <br>  CompiledLibraries = "sdl_mixer sdl_ttf lzma ogg" <br>  # additional compilation flags, I have included RTTI and exceptions <br>  AppCflags = '- O2 -finline-functions -frtti -fexceptions' <br>  # here are the folders where you need to search for the source for the assembly, in addition to the current <br>  AppSubdirsBuild = 'dep dep / smk dep / aes dep / lzma dep / bzip2 dep / libpng source / vfs source / core source / gfx source / game source source / good source / city source / events source / world source / religion ' <br></div></div><br><div class="spoiler">  <b class="spoiler_title">4. setting the path for compiling the desired application</b> <div class="spoiler_text"><br>  $ rm project / jni / application / src <br>  $ ln -s caeasaria project / jni / application / src <br></div></div><br><div class="spoiler">  <b class="spoiler_title">5. assembly apk</b> <div class="spoiler_text"><br>  $. / changeAppSettings.sh -a <br>  $ android update project -p project <br>  $. / build.sh <br></div></div><br><div class="spoiler">  <b class="spoiler_title">6. Signing and installing the application on Android</b> <div class="spoiler_text"><br>  If everything compiles successfully, the MainActivity- [release | debug] -unsigned.apk file will appear in the commandergenius / project / bin folder, which you need to sign and install on the device. <br><br>  $ keytool -genkey -v -keystore rs.keystore -alias caesaria -keyalg RSA -keysize 2048 -validity 10000 <br>  $ jarsigner -verbose -sigalg SHA1withRSA -digestalg SHA1 -keystore rs.keystore ~ ‚Äã‚Äã/ projects / commandergenius / project / bin / MainActivity-release-unsigned.apk caesaria <br>  $ mv ~ / projects / commandergenius / project / bin / MainActivity-release-unsigned.apk ~ / projects / caesaria.apk <br>  $ adb uninstall net.dalerank.caesaria <br>  $ adb install ~ / projects / caesaria.apk <br></div></div> <br><br>  <b>Underwater rocks</b> <br>  0. Definition of the environment: first you need to decide in what environment Windows, Linux or <s>Linux</s> Android will work. <br>  Solution: Check the presence of defines ANDROID / __ ANDROID__. <br><br>  1. Logs: you can watch error messages and other output through <b>abd logcat</b> , but as it turned out standard tools like stdout / printf do not work, you can of course use the output of the log to the file and watch it already, but I wanted some more familiar debugging. <br>  Solution: connect the header file of the android logs <b>#include &lt;android / log.h&gt;</b> , and use the function to display the message <br> <code>__android_log_print(ANDROID_LOG_DEBUG, CAESARIA_PLATFORM_NAME, "%s", str.c_str() ); <br></code> <br>  with familiar printf syntax. <br><br>  2. Using OpenGL: if anyone needs OpenGL, then its close relative GLES lives on mobile platforms. <br>  Solution: connect instead of the standard header files &lt;GLES / gl.h&gt; and &lt;GLES / glext.h&gt;, there are slight differences in the use of textures and rendering, but basically the code (the simple code I used) works almost unchanged. <br><br>  3. Event handling: the SDL_MOUSEBUTTONUP event disappears when you move your finger across the screen, it could be a flaw in the libsdl-android library itself or I lost it somewhere.  It sometimes manifested itself in the absence of reaction of interface elements to user actions, for example, after moving, they stopped at a button, which, in theory, should go to the state if the mouse cursor is above it. <br>  Solution: Specifically for my application - when building for android, a forced update of the state of the elements under the cursor was added while the latter was moving. <br><br>  4. Small interface: the screen resolution of modern mobile devices is comparable to or exceeds the resolution of the monitor used 10-15 years ago, but the physical dimensions are noticeably smaller, which is why the user interface elements themselves look fine and it will not always be convenient to use them. <br>  Solution: Alteration of the interface, which is quite troublesome and it is not always possible to retain the original look. <br><img width="250" src="https://habrastorage.org/files/967/307/b42/967307b424ee4671bf36fdf6420bfa0e.png"><img width="250" src="https://habrastorage.org/files/2c4/5fa/4bf/2c45fa4bf26a463681a8e0a7d1908630.png"><br><br>  <b>One move is equal to two fires</b> (popular wisdom) <br>  It all started with the fact that one of the committers sent a link to the development branch, where they successfully launched the game using the relatively recent SDL2 library, and before that they used version SDL1.2 - 2008 of the release.  I must say that I myself considered the possibility of switching to a new version, especially after viewing the <a href="http://habrahabr.ru/post/189924/">list of changes</a> , which promised normal support for Mac and Android, which is called out of the box.  And then there was a mini-vacation at work, having taken a <s>sledgehammer with a</s> <a href="https://wiki.libsdl.org/MigrationGuide">thicker guide</a> and a large cup of coffee, I began to translate the remake to a new ‚Äúengine‚Äù. <br>  I don‚Äôt want to bore the reader with the technical details of the move, it‚Äôs just that the library itself changed the ideology of the work with the arrival of hardware support, which at first posed certain difficulties while I was not used to it.  The move stretched for a week of evenings and at the end was a correction of the remaining shortcomings and graphic artifacts.  The modifications were completed and the builds for the ‚Äúbig‚Äù OS were prepared, and again there was a need to re-read the instructions for building the application for Android, because libsdl-android is normally adapted to work with SDL1.2, and SDL2 support seems to be abandoned (what the authors themselves and write in readme) <br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text">  SDL 1.3 Android port now, which is more recent and <br>  this port is focused mainly <br>  on SDL 1.2 and compiling existing applications. <br>  It is a port that has been developed very slowly. </div></div><br><br>  I realized the veracity of this text when it was spent several hours in an attempt to launch the port in the old configuration via libsdl-android.  Well, negative experience is also an experience: I will use the available tools. <br><br>  <b>Attempt number two, not entirely successful</b> <br>  SDL2 already contains all the necessary configs to build an application for android, after reading the <a href="http://www.dinomage.com/2013/01/howto-sdl-on-android/">article</a> recommended on the official website, you can try to build something.  Again, there will be several steps, except for installing and configuring adt. <br><div class="spoiler">  <b class="spoiler_title">0. copying an example from the delivery of SDL2</b> <div class="spoiler_text">  <i>$ git clone <a href="https://bitbucket.org/dalerank/caesaria">bitbucket.org/dalerank/caesaria</a></i> <i><br></i>  <i>$ hg clone <a href="http://hg.libsdl.org/SDL">hg.libsdl.org/SDL</a></i> <i><br></i>  <i>$ mkdir caesaria / android</i> <i><br></i>  <i>$ cp SDL / android-project caesaria / android</i> <i><br></i>  <i>$ mkdir caesaria / android / libs</i> <i><br></i>  <i>$ mkdir caesaria / android / data</i> <i><br></i>  <i>$ cp SDL caesaria / android / libs</i> <br><br>  What are all these copies for ???  to make it easier to count relative paths for libraries.  The SDL and company will be in the android / libs folder, and the application icon will be in the android / data folder. <br></div></div><br><div class="spoiler">  <b class="spoiler_title">1. creating a folder structure for a project</b> <div class="spoiler_text">  In the <i>android / android-project / jni folder,</i> create symbolic links to application components <br><br>  $ ln -s ../../libs/SDL SDL <br>  $ ln -s ../../libs/SDL_mixer SDL_mixer <br>  $ ln -s ../../libs/SDL_net SDL_net <br>  $ ln -s ../../src/dep/aes aes <br>  $ ln -s ../../src/source application <br>  $ ln -s ../../src/dep/bzip2 bzip2 <br>  $ ln -s ../../src/dep/freetype freetype <br>  $ ln -s ../../src/dep/libpng libpng <br>  $ ln -s ../../src/dep/lzma lzma <br>  $ ln -s ../../src/dep/smk smk <br>  $ ln -s ../../src/dep/src src <br>  $ ln -s ../../src/dep/ttf ttf <br>  $ ln -s ../../src/dep/zlib zlib <br><br>  A little bit about what I wrote here: <br>  zlib is needed to build freetype, which in turn is needed for SDL_ttf and will be responsible for rendering fonts. <br>  The smk library is needed to play video in the smack format, in this format the videos of the original game are made. <br>  Bzip, lzma and aes are needed to work with zip archives. <br>  libpng is required to download textures for the game. <br>  SDL, SDL_mixer, SDL_net are respectively responsible for drawing, working with sound and the network. <br>  application contains the source of the game itself, which will be compiled into the library libapplication.so <br>  The source code of the library libmain.so is located in the src folder, but for it the lace of java-calls is already written over the c-code, which will allow us to successfully start and please the user with a bright picture. <br>  Project settings and configs for ndk are already kindly provided by the authors of SDL2 <br></div></div><br><div class="spoiler">  <b class="spoiler_title">2. writing configs to build game components</b> <div class="spoiler_text">  In order for the build system to see which libraries we need to work with and compile them, you need to write configs for them, like Macfile.  With high probability, Android.mk will already be present in the library repository, or they can be found on the Internet.  I had to add build config files for the game and the libsmk library. <br><br>  Android.mk for libsmk is very simple and will be understandable to people not related to programming for android <br>  <i># smk / Android.mk</i> <i><br></i>  <i>LOCAL_PATH: = $ (call my-dir)</i> <i><br><br></i>  <i>include $ (CLEAR_VARS)</i> <i><br><br></i>  <i>LOCAL_MODULE: = smk</i> <i><br></i>  <i>LOCAL_SRC_FILES: = $ (subst $ (LOCAL_PATH) / ,, \</i> <i><br></i>  <i>$ (wildcard $ (LOCAL_PATH) / *. c))</i> <i><br><br></i>  <i>include $ (BUILD_SHARED_LIBRARY)</i> <br><br>  The config contains instructions to compile all files with the <b>.c</b> extension found in the current folder (for libsmk this will be jni / smk) <br><br>  Similarly, the config is written to build the library that will represent the game itself. <br><br>  <i># application / Android.mk</i> <i><br></i>  <i>LOCAL_PATH: = $ (call my-dir)</i> <i><br></i>  <i>include $ (CLEAR_VARS)</i> <i><br><br></i>  <i>LOCAL_MODULE: = application</i> <i><br><br></i>  <i>SDL_PATH: = ../../libs/SDL</i> <i><br></i>  <i>SDL_MIXER_PATH: = ../../libs/SDL_mixer</i> <i><br></i>  <i>SDL_NET_PATH: = ../../libs/SDL_net</i> <i><br></i>  <i>GAME_PATH: = $ (LOCAL_PATH)</i> <i><br></i>  <i>DEP_PATH: = ../dep</i> <i><br><br></i>  <i>LOCAL_C_INCLUDES: = \</i> <i><br></i>  <i>$ (LOCAL_PATH) / $ (SDL_PATH) / include \</i> <i><br></i>  <i>$ (LOCAL_PATH) / $ (SDL_MIXER_PATH) \</i> <i><br></i>  <i>$ (LOCAL_PATH) / $ (SDL_NET_PATH) / include \</i> <i><br></i>  <i>$ (LOCAL_PATH) / $ (FREETYPE_PATH) / include \</i> <i><br></i>  <i>$ (LOCAL_PATH) / $ (GAME_PATH) \</i> <i><br></i>  <i>$ (LOCAL_PATH) / $ (DEP_PATH) \</i> <i><br></i>  <i>$ (LOCAL_PATH) / $ (DEP_PATH) / libpng</i> <i><br><br></i>  <i># Add your application source files here ...</i> <i><br></i>  <i>LOCAL_SRC_FILES: = $ (subst $ (LOCAL_PATH) / ,, \</i> <i><br></i>  <i>$ (wildcard $ (GAME_PATH) / *. cpp) \</i> <i><br></i>  <i>$ (wildcard $ (GAME_PATH) / core / *. cpp) \</i> <i><br></i>  <i>$ (wildcard $ (GAME_PATH) / vfs / *. cpp) \</i> <i><br></i>  <i>$ (wildcard $ (GAME_PATH) / objects / *. cpp) \</i> <i><br></i>  <i>$ (wildcard $ (GAME_PATH) / gui / *. cpp) \</i> <i><br></i>  <i>$ (wildcard $ (GAME_PATH) / city / *. cpp) \</i> <i><br></i>  <i>$ (wildcard $ (GAME_PATH) / gfx / *. cpp) \</i> <i><br></i>  <i>$ (wildcard $ (GAME_PATH) / events / *. cpp) \</i> <i><br></i>  <i>$ (wildcard $ (GAME_PATH) / world / *. cpp) \</i> <i><br></i>  <i>$ (wildcard $ (GAME_PATH) / pathway / *. cpp) \</i> <i><br></i>  <i>$ (wildcard $ (GAME_PATH) / walker / *. cpp) \</i> <i><br></i>  <i>$ (wildcard $ (GAME_PATH) / good / *. cpp) \</i> <i><br></i>  <i>$ (wildcard $ (GAME_PATH) / religion / *. cpp) \</i> <i><br></i>  <i>$ (wildcard $ (GAME_PATH) / scene / *. cpp) \</i> <i><br></i>  <i>$ (wildcard $ (GAME_PATH) / sound / *. cpp) \</i> <i><br></i>  <i>$ (wildcard $ (GAME_PATH) / game / *. cpp))</i> <i><br><br></i>  <i>LOCAL_SHARED_LIBRARIES: = SDL2 SDL2_mixer SDL2_net sdl_ttf pnggo lzma bzip2 aes smk</i> <i><br></i>  <i>LOCAL_CPP_FEATURES + = exceptions</i> <i><br></i>  <i>LOCAL_CPP_FEATURES + = rtti</i> <i><br></i>  <i>LOCAL_LDLIBS: = -lGLESv1_CM -llog</i> <i><br><br></i>  <i>include $ (BUILD_SHARED_LIBRARY)</i> <br><br>  It should also be clear, in the LOCAL_C_INCLUDES add the path where you need to look for the header files, in the LOCAL_SRC_FILES add the files with the source code, <br>  in LOCAL_SHARED_LIBRARIES we prescribe the dependencies of the application. <br><br>  The <i>rtti, exceptions</i> flags are responsible for using RTTI and exceptions. <br><br></div></div><br><div class="spoiler">  <b class="spoiler_title">3. build</b> <div class="spoiler_text">  <i>$ cd android-project</i> <i><br></i>  <i>$ android update project -p.</i>  <i>-t android-15</i> <i><br></i>  <i>$ ndk-build V = 1</i> <i><br></i>  <i>$ ant [release | debug]</i> <i><br></i>  <i>$ ant install [r | d]</i> <i><br></i> <br></div></div><br>  Theoretically, after performing the described steps on a connected device or emulator, you will see the installed application. <br><img width="500" src="https://habrastorage.org/files/92b/38c/92d/92b38c92d0c54dc18c3ee0e6537ffaa0.jpg"><br><br>  <b>Rake</b> <br>  1. Where to look for resources ??? <br>  The location of the resources depends on the specific OS implementation, but in most cases the application will have access to the folder <i>/ sdcard / Android / data / package_name / files</i> , using the path itself may be an access error or a file search error. <br>  You can get the full path to the application directory via the SDL_AndroidGetExternalStoragePath () function defined in the SDL_system.h file <br>  2. Using the window creation flags. <br>  Combination SDL_WINDOW_OPENGL |  SDL_WINDOW_SHOWN |  SDL_WINDOW_BORDERLESS does not work on all devices, remove SDL_WINDOW_OPENGL or SDL_WINDOW_BORDERLESS and see which of the flags the program crashes.  I can not explain what this behavior is connected with.  With the SDL_WINDOW_SHOWN flag, one-on-one logs over the logs, as with all flags, but the probability of departure is much less. <br>  3. Too many audio channels. <br>  Departures are observed when calling the function SDL_mixer :: Mix_AllocateChannels (N&gt; 16) with the error that it is impossible to initialize the sound.  It costs me to reduce the number of channels requested, how correctly to solve this problem in this way I do not know. <br>  4. stlport vs gnustl <br>  Departure when using stlport, ran into this bug when crawling a vector using iterators on the Nexus 7 emulator (Android 4.0.3).  Again, I can not explain the fact of this error, it was decided to use gnustl when building the application. <br>  5. My kungfu is stronger than yours. <br>  Using a library with a name similar to the name of one already in the system leads to the loading of someone else's library, which may not have the necessary functions.  The error appeared due to the fact that I am collecting my version of libpng.so, the solution was found on <a href="http://stackoverflow.com/questions/20698905/unsatisfiedlinkerror-in-android-4-4-libdevil-cannot-locate-symbol-png-set-longj">stackoverflow</a> , corrected by replacing the library name <i>libpng.so</i> with <i>libpnggo.so</i> <br><br>  <b>In custody...</b> <br>  Works!  Almost no different from BB!  Am I pleased?  Not really! <br><br>  The fact is that I tinker Krivorukov, skis do not go skiing, but on the tablet the application turned out to be extremely slow (10-12 fps for a very simple picture, the result is dull), I think the fault is in the hands and ignorance of the materiel.  SDL is an excellent library in both reincarnations, and a lot of really good games use it, as well as <a href="https://github.com/pelya/commandergenius/tree/sdl_android/project/jni/application">ported to android</a> . <br><br>  The time spent on the creation of the port is not a pity, a certain experience and a lot of positive emotions were gained when the game took off.  Those who are still trying to try or not, definitely try, do not wait for later! <br><br>  ZY  Behind development of the project it is always possible to look <a href="https://bitbucket.org/dalerank/caesaria/wiki/Home">here</a> . <br><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/_QQ_xlTivvc%3Ffeature%3Doembed&amp;xid=17259,15700021,15700186,15700191,15700253&amp;usg=ALkJrhg5xJYRlkWW8zn6hMzVbbzZkUfwiA" frameborder="0" allowfullscreen=""></iframe></div><p>Source: <a href="https://habr.com/ru/post/233737/">https://habr.com/ru/post/233737/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../233721/index.html">Show Sound # 14 - Podcast about audio equipment, components, formats and technologies</a></li>
<li><a href="../233725/index.html">Tremble, Oculus VR</a></li>
<li><a href="../233729/index.html">How we mastered the vacuum magnetron deposition of films</a></li>
<li><a href="../233733/index.html">Junior required</a></li>
<li><a href="../233735/index.html">Getting CISA. The history of one certificate and assistance to interested</a></li>
<li><a href="../233743/index.html">Conversion optimization: 7 recommendations for using predictive analytics</a></li>
<li><a href="../233745/index.html">This is Science: What's inside a neuromorph chip?</a></li>
<li><a href="../233747/index.html">Onion architecture. Part 1</a></li>
<li><a href="../233749/index.html">3Doodler - review pen 3d-printer</a></li>
<li><a href="../233751/index.html">IBM Simon: the world's first smartphone turned 20 years old</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>