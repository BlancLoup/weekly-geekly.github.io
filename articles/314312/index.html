<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We draw, code under libGDX and other small joys from the life of an indi-developer</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, Habr! In this topic, I would like to share my impressions of the libGDX game engine, talk about the everyday life of an ordinary indie developer, ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We draw, code under libGDX and other small joys from the life of an indi-developer</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/files/657/cf8/84b/657cf884b2db49178941e1577423795a.png"></div><br>  Hi, Habr!  In this topic, I would like to share my impressions of the libGDX game engine, talk about the everyday life of an ordinary indie developer, and lift the veil of secrets over the game that I have been doing the past few months in my office-free time.  I hope these notes will be useful for those who are just starting to do something with libGDX or for those who choose the engine for the ‚Äúgame of their dreams.‚Äù <br><br>  And sorry for the cats.  They have absolutely nothing to do with the igrostroy.  I‚Äôm at the same time learning (trying to learn) to draw and now these training cats of mine are just everywhere!  They demand that they, idlers, be shown to someone. <br><a name="habracut"></a><br><h2>  Drawing </h2><br>  Speaking of drawing.  Of course, I‚Äôm being showered with horny CG artists (and they will be absolutely right), but how can I drag myself from the process!  I never thought drawing was so cool!  I had a long time ago, in the midst of all the rubbish, lying around someone donated a graphics tablet.  Bamboo something there, I think everyone buys the same "to be pampered."  And then, once, I came across a book by Mark Kistler "You can draw in 30 days."  No, naturally, learning to draw in 30 days is all the same as learning C ++ in the same time.  Everyone understands this.  But it turns out, drawing is not some intangible talent there, not elves herding unicorns in the meadows of uncharted islands.  It is just a set of rules, as simple as the syntax of a programming language.  Plus experience, of course!  Hand stuffing  But after all, a good programmer develops in a similar way, solving problems, studying patterns, technologies and following all sorts of best practices. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/b5f/155/e3f/b5f155e3fb7b4f48ba7a7f89ba10f355.png"></div><br>  So, in this book (or rather the book, it is not serious at all) there are all the basic rules to start drawing something more than a stick-pickle.  And when the hand-drawn squiggles stop causing you horror at least, it's cool!  The process itself begins to bring pleasure.  For me personally, this was a revelation. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div style="text-align:center;"><img src="https://habrastorage.org/files/251/0e9/4f3/2510e94f3a134e4ca4b6b557f5242839.png"></div><br>  Still, taking this opportunity, I want to advise a great editor - SketchBook Pro.  It draws and pros, but it is exactly the kind that is not needed by a professional.  Yuzerfrendli, not overloaded with functionality.  A license is relatively inexpensive, unlike Photoshop.  Although this abusive ‚Äúsoftware by subscription‚Äù scheme is used here, the basic functions are available for free. <br><br>  I use only 3 tools: a pencil, a ballpoint pen, a brush.  There is, I don‚Äôt know how to call it correctly, the straightening function on the run of your crooks is a mega useful thing!  We take in one hand a feather, the second for a space (turning and scaling the canvas) and going!  Create creativity. <br><br><h2>  Why not Unity? </h2><br>  But I digress.  When it comes to choosing a game engine, the first and only question that now arises is ‚Äúwhy not Unity, dude?‚Äù.  Therefore!  Because I'm used to Android Studio (I wrote a corporate application lately), I know Java more or less, the Android SDK.  And the use of such a multifunctional monster as Unity for simple 2D games is a little ‚Äúfrom the cannon on the sparrows‚Äù, don't you find?  A stranger IDE, a different approach, again.  And the size of the empty project in 20 MB?  On libGDX, the whole game, along with graphics (which are not so few) weighs less!  I understand that we live in the age of fast Internet, but still, the dependence between the size of the application and the number of installations exists. <br><br>  <i>If you dig deeper, the bottom line is that the warning ‚ÄúThe size of the application is too large, are you sure that you want to download it not via Wi-Fi?‚Äù (Literally, I don‚Äôt remember, but this is the essence) - it cuts off a certain number of impulsive installations.</i> <br><div style="text-align:center;"><img src="https://habrastorage.org/files/32c/bf3/0f0/32cbf30f09fa4ae592cc41a8ee1fa1d1.png"></div><br>  In general, if you have previously dealt with the Android SDK, libGDX is an excellent choice for a smooth transition to cross-platform development.  I will try to formulate all the pros and cons that I learned from the first acquaintance with libGDX. <br><br><h2>  pros </h2><br><ul><li>  Free. <br><br></li><li>  Cross platform  The desktop build is equally seamlessly built and runs under Windows and Mac (there was no way to check on Linux, but I'm sure it is the same).  For HTML, I ran into a small nuance: all the packages that you add should be written into the Core project in gwt.xml, otherwise it won't be built.  With Android, there are no problems at all, I still have iOS in the plans. <br><br></li><li>  Low entry threshold for Android developer.  Same Studio, Same Gradle.  We have a Core-project in which we describe all the game logic and the Android-project - this is, roughly speaking, the MainActivity on which the View lies, and in it the Core-project is executed.  From the core project, we can easily call the platform-specific part that we write in the Android project.  And what is very nice, we implement the platform code (advertising, analytics, gaming services) directly by Google tutorials.  As in the usual application.  That is, no libraries, third-party extensions, and so on! </li></ul><br><h2>  Minuses </h2><br><ul><li>  I have not found a relevant, sensible tutorial.  There is a lot of information, even here, on Habr√©, but usually it comes down to how to display the sprite on the screen.  In practice, it is not necessary, why?  It is more reasonable to use higher level abstractions: Actor, Scene (see below).  When I got acquainted with the new engine, in Quikstart Guide, I would like to see the following: correct scaling of the game for various screens, background loading of resources ( <a href="https://github.com/libgdx/libgdx/wiki/Asset-manager">everything is fine</a> with that), control of screens / scenes and objects on them. </li></ul><br><div style="text-align:center;"><img src="https://habrastorage.org/files/0c7/793/c80/0c7793c805df4939a45a4466f11544e3.png"></div><br>  Continuing to talk about the cons, I have a feeling of a slight understatement in libGDX.  There are excellent abstractions here: Screen is a game screen, Stage is a scene or a layer, Actor is any object on this scene.  In my game I decided to make one Screen and many Stage for all game screens: levels, menus, etc.  From Actor we inherit game objects, then we just do <i>stage.addActor (ball)</i> and that's it.  Further Stage is engaged in drawing, movements, etc.  this object.  So Actor, in itself, does nothing.  It does not display sprites (and 99% of game objects are sprites), you cannot check the collision between two actors, in general, nothing! <br><br>  You have to make your SimpleActor and already inherit game objects from it: <br><br><div class="spoiler">  <b class="spoiler_title">Code</b> <div class="spoiler_text"><pre><code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SimpleActor</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Actor</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> TextureRegion region; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SimpleActor</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(TextureRegion region)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.region = region; setSize(region.getRegionWidth(), region.getRegionHeight()); setBounds(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, getWidth(), getHeight()); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">draw</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Batch batch, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> parentAlpha)</span></span></span><span class="hljs-function"> </span></span>{ batch.draw(region, getX(), getY(), getOriginX(), getOriginY(), getWidth(), getHeight(), getScaleX(), getScaleY(), getRotation()); } }</code> </pre> </div></div><br>  If you need animated game objects (well, where do without them?) We write SimpleAnimatedActor: <br><br><div class="spoiler">  <b class="spoiler_title">Code</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SimpleAnimatedActor</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Actor</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Animation animation; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> TextureRegion currentFrame; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> stateTime; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> started; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">SimpleAnimatedActor</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> frameDuration, Array&lt;TextureRegion&gt; frames)</span></span></span><span class="hljs-function"> </span></span>{ animation = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Animation(frameDuration, frames); currentFrame = animation.getKeyFrame(stateTime); setBorders(frames.get(<span class="hljs-number"><span class="hljs-number">0</span></span>)); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setBorders</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(TextureRegion sample)</span></span></span><span class="hljs-function"> </span></span>{ setSize(sample.getRegionWidth(), sample.getRegionHeight()); setBounds(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, getWidth(), getHeight()); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">start</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ stateTime = <span class="hljs-number"><span class="hljs-number">0</span></span>; started = <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">isFinished</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> animation.isAnimationFinished(stateTime); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">act</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> delta)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.act(delta); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!started) { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } stateTime += delta; currentFrame = animation.getKeyFrame(stateTime); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">draw</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Batch batch, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> parentAlpha)</span></span></span><span class="hljs-function"> </span></span>{ batch.draw(currentFrame, getX(), getY(), getOriginX(), getOriginY(), getWidth(), getHeight(), getScaleX(), getScaleY(), getRotation()); } }</code> </pre></div></div><br>  To implement a primitive collision checker, you can add Polygon to our SimpleActor: <br><br><div class="spoiler">  <b class="spoiler_title">Code</b> <div class="spoiler_text"><pre> <code class="java hljs">Polygon polygon = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Polygon(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span>[]{<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, getWidth(), <span class="hljs-number"><span class="hljs-number">0</span></span>, getWidth(), getHeight(), <span class="hljs-number"><span class="hljs-number">0</span></span>, getHeight()}); polygon.setPosition(getX(), getY()); polygon.setOrigin(getOriginX(), getOriginY()); polygon.setScale(getScaleX(), getScaleY()); polygon.setRotation(getRotation());</code> </pre></div></div><br>  And so on.  Of course, this does not cause any particular difficulties.  But still, I can not understand, why not do something like this in the engine?  And so it is necessary to drag your add code from the project to the project. <br><br><h2>  Fragmentation </h2><br>  How to make the game look equally cool on the zoo of all Android devices?  For me, this is one of the key questions.  Therefore, I will tell you in more detail how I solved the problem of scaling images in libGDX. <br><br>  I like the already classic approach when we show more environment on tablets (4: 3) and less on tablets (16: 9).  At the same time, nothing stretches anywhere, and game objects, one might say, do not change their size.  All the graphics are stored in one resolution, I have it 960x1280 (4: 3).  In the center of the screen we have a ‚Äúplay area‚Äù 720x1280 (16: 9) where all objects with which the player interacts are required to fall, the rest is scenery and can be cut off depending on the particular device.  The easiest way to illustrate this principle with a picture: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/90a/581/ba2/90a581ba261c43da9b5d5ff3dc11f10f.png"></div><br>  LibGDX provides all the features for this.  The only caveat - some objects may need to attach to the edge of the screen.  Like the Home button in the image above.  To do this, we need to know the actual left and right edges of the screen in the game coordinates (with the top and bottom easier - it is always 1280 and 0, respectively).  Let's write some code: <br><br><div class="spoiler">  <b class="spoiler_title">Code</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyGame</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Game</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> SCREEN_WIDTH = <span class="hljs-number"><span class="hljs-number">960f</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> SCREEN_HEIGHT = <span class="hljs-number"><span class="hljs-number">1280f</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> VIEWPORT_LEFT; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> VIEWPORT_RIGHT; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> GameScreen mGameScreen; <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">create</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ mGameScreen = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> GameScreen(); setScreen(mGameScreen); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">resize</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> width, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> height)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.resize(width, height); <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> aspectRatio = (<span class="hljs-keyword"><span class="hljs-keyword">float</span></span>) width / height; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> viewportWidth = SCREEN_HEIGHT * aspectRatio; VIEWPORT_LEFT = (SCREEN_WIDTH - viewportWidth) / <span class="hljs-number"><span class="hljs-number">2</span></span>; VIEWPORT_RIGHT = VIEWPORT_LEFT + viewportWidth; } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dispose</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.dispose(); mGameScreen.dispose(); } }</code> </pre></div></div><br>  What's going on here?  This is the main class of the game, inherited from Game.  Here we create and install the Screen (the screen, in my case, the only one) and override <i>resize ()</i> .  This event for Android is called when the application starts and here we can calculate the left and right edges of the picture (VIEWPORT_LEFT and VIEWPORT_RIGHT). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/07a/b4a/3ae/07ab4a3ae9d14b76a7a577515d9245e6.png"></div><br>  In GameScreen, we need to install <i>FillViewport</i> , it is he who is responsible for ensuring that the image is cropped if the aspect ratio does not match the target.  Viewport is our window to the game world.  They are of several types, the <a href="https://github.com/libgdx/libgdx/wiki/Viewports">documentation</a> about this will tell even better than me, and I just give the code: <br><br><div class="spoiler">  <b class="spoiler_title">Code</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">GameScreen</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">implements</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Screen</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> OrthographicCamera mCamera; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Viewport mViewport; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> AssetManager mAssetManager; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Stage mActiveStage; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GameScreen</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ mCamera = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> OrthographicCamera(); mViewport = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> FillViewport(MyGame.SCREEN_WIDTH, MyGame.SCREEN_HEIGHT, mCamera); mAssetManager = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AssetManager(); mActiveStage = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MyStage(mViewport, mAssetManager); } <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">render</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> delta)</span></span></span><span class="hljs-function"> </span></span>{ mCamera.update(); Gdx.gl.glClearColor(<span class="hljs-number"><span class="hljs-number">65</span></span> / <span class="hljs-number"><span class="hljs-number">255f</span></span>, <span class="hljs-number"><span class="hljs-number">65</span></span> / <span class="hljs-number"><span class="hljs-number">255f</span></span>, <span class="hljs-number"><span class="hljs-number">65</span></span> / <span class="hljs-number"><span class="hljs-number">255f</span></span>, <span class="hljs-number"><span class="hljs-number">1f</span></span>); <span class="hljs-comment"><span class="hljs-comment">//    Gdx.gl.glClear(GL20.GL_COLOR_BUFFER_BIT); mActiveStage.act(delta); mActiveStage.draw(); } @Override public void resize(int width, int height) { mViewport.update(width, height, true); } @Override public void dispose() { mActiveStage.dispose(); mAssetManager.dispose(); } }</span></span></code> </pre></div></div><br>  Here, in general, everything should be intuitively clear, just remember to do <i>mViewport.update (width, height, true)</i> with <i>resize ()</i> . <br><br><h2>  Mechanical Box </h2><br>  Now, when I talked briefly about the engine, I would like to say a few more words about the game itself.  I haven't played games for a year, the corporate quagmire almost sucked me.  But this did not stop me from dreaming.  To dream of a quest, a puzzle as difficult as possible.  Without prompts for money and other fritupleyny nonsense. <br><br>  This is how the idea of ‚Äã‚Äãthe Mechanical Box appeared - a device created with one sole purpose: to reliably protect what is inside.  Where each layer of protection is a separate, independent puzzle with a new game mechanics. <br><br>  A huge plus indie, we can afford to do what we want.  I don't care about the retention rate and other marketing things.  Yes, the gamediz of any commercial studio will shoot itself, having seen the percentage of players stuck on the first level!  And I can just make a game that I would like to play myself. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/ed2/779/048/ed2779048b8549018bb9d914e2893c08.png"></div><br>  In general, in August of this year I started the construction of the Box.  Having drawn a little bit, I realized that I could not draw out such volumes, and my art did not suit me in quality.  He, to put it mildly, peculiar.  As a result, an artist was found at gamedev.ru who agreed to get involved in this adventure.  Surprisingly, it turned out that Vladimir and I live not only in the same city, but also in the neighboring streets.  It was he who gave the Mechanical Box an appropriate appearance.  I even saved as a memory ‚Äúas it was‚Äù and ‚Äúas it became‚Äù.  The difference, I think, is obvious. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/69a/4f1/92c/69a4f192c4824dd5b1eb9bb8a0f38435.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/files/b63/601/acf/b63601acf6b846a3a1cfe29f5a3c0035.png"></div><br>  I am still working on the Mechanical Box, I have some thoughts on the development of this idea.  If you decide to try your hand, the game is already published on Google Play.  I do not give the link, <i>so as not to attract the attention of the UFO once again</i> .  And although the Box was rather quickly dismantled for parts on one popular resource, for a single person, this puzzle is a rather serious challenge.  What, personally, pleases me.  I can even predict where you are stuck.  This is either a level with a crane (how to move the damn claw to the right?), Or three multi-colored squares (this mystery seems easy to me, but the statistics are a stubborn thing).  Or, welcome to the "club of the lost zero" - well, this is already the elite. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/147/195/f56/147195f560b542f899812f57c74b5e7e.png"></div><br>  Thanks for reading, ask questions, write comments! <br>  <i>Do good and throw it into the water.</i> </div><p>Source: <a href="https://habr.com/ru/post/314312/">https://habr.com/ru/post/314312/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../314302/index.html">Improving the function of CDF in Excel</a></li>
<li><a href="../314304/index.html">Hardware invades software at Moscow SECR conference</a></li>
<li><a href="../314306/index.html">First steps in optimizing and polishing the game on Unity3d</a></li>
<li><a href="../314308/index.html">What place does the language of Scala in the IT industry</a></li>
<li><a href="../314310/index.html">Design of Russian cities, where is he?</a></li>
<li><a href="../314314/index.html">Console commands with PHPixie Console</a></li>
<li><a href="../314318/index.html">How we distinguished a trolley from a foreman - video analytics for the hypermarket checkout zone (and a continuation about the cat terminator)</a></li>
<li><a href="../314324/index.html">Aidra boosted botnet infected 3,500 devices in less than a week</a></li>
<li><a href="../314326/index.html">Firefox 52 will remove the battery level API to preserve user data privacy</a></li>
<li><a href="../314328/index.html">Comparing objects by value - 1: Beginning</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>