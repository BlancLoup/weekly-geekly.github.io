<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Genetic algorithm - visual implementation</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="About four years ago, in the university I heard about such an optimization method as a genetic algorithm. He was reported exactly two facts everywhere...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Genetic algorithm - visual implementation</h1><div class="post__text post__text-html js-mediator-article">  <i>About four years ago, in the university I heard about such an optimization method as a genetic algorithm.</i>  <i>He was reported exactly two facts everywhere: he is cool and he does not work.</i>  <i>Rather, it works, but slowly, unreliably, and nowhere should it be used.</i>  <i>But he can beautifully demonstrate the mechanisms of evolution.</i>  <i>In this article, I will show a beautiful way to see the evolutionary processes in person, using the example of this simple method.</i>  <i>You just need a little math, programming, and all this spice up the imagination.</i> <br><br><h4>  Briefly about the algorithm </h4><br>  So what is a genetic algorithm?  First of all, this is a multi-dimensional optimization method, i.e.  method of finding the minimum of a multidimensional function.  Potentially, this method can be used for global optimization, but with this there are difficulties, I will describe them later. <br><br>  The very essence of the method lies in the fact that we modulate the evolutionary process: we have some kind of population (set of vectors) that multiplies, which is affected by mutations and natural selection is made based on minimizing the objective function.  Let us consider these processes in more detail. <br><a name="habracut"></a><br>  So, first of all, our population should <b>multiply</b> .  The basic principle of reproduction is that a descendant resembles its parents.  Those.  we have to specify some sort of inheritance mechanism.  And it would be better if it includes an element of chance.  But the speed of development of such systems is very low - the diversity of genetic drops, the population degenerates.  Those.  the value of the function stops being minimized. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      To solve this problem, a <b>mutation</b> mechanism was introduced, which consists in the random change of some individuals.  This mechanism allows you to bring something new to genetic diversity. <br>  The next important mechanism is <b>selection</b> .  As has been said, selection is the selection of individuals (it is possible from only born, and it is possible from all - practice shows that this does not play a decisive role), which better minimize the function.  Usually, as many individuals are selected as before reproduction so that from epoch to epoch we have a constant number of individuals in the population.  It is also customary to select "lucky ones" - a certain number of individuals, which, perhaps, poorly minimize the function, but will introduce diversity in future generations. <br><br>  These three mechanisms are often insufficient to minimize the function.  So the population degenerates - sooner or later the local minimum clogs the entire population with its value.  When this happens, they carry out a process called <b>shake</b> - <b>up</b> (in nature, analogies are global cataclysms), when almost the entire population is destroyed, and new (random) individuals are added. <br><br>  Here is a description of the classical genetic algorithm, it is simple to implement and there is a place for imagination and research. <br><br><h4>  Formulation of the problem </h4><br>  So, when I decided that I wanted to try to implement this legendary (albeit unlucky) algorithm, we were talking about what would I be minimizing?  Usually they take some terrible multidimensional function with sines, cosines, etc.  But this is not very interesting and generally not obvious.  An unpretentious idea came - an image is perfectly suitable for displaying a multidimensional vector, where the value is responsible for brightness.  Thus, we can introduce a simple function - the distance to our target image, measured in the difference in brightness of pixels.  For simplicity and speed, I took images with a brightness of 0, or 255. <br><br>  From the point of view of mathematics, such optimization is a mere trifle.  The graph of such a function is a huge multidimensional "pit" (like a three-dimensional parabaloid in the figure), which you inevitably roll into if you follow the gradient.  The only local minimum is global. <img src="https://habrastorage.org/files/780/a92/7ce/780a927ce0034845a73c8fe973a3f779.png" alt="image" height="200" align="left">  . <br><br>  The only problem is that already close to the minimum, the number of paths through which you can go down is greatly reduced, and we have as many directions as dimensions (i.e., the number of pixels).  Obviously, this task should not be solved with the help of a genetic algorithm, but we can look at interesting processes occurring in our population. <br><br><h4>  Implementation </h4><br>  All the mechanisms described in the first paragraph were implemented.  Reproduction was carried out by simply crossing random pixels from the "mother" and the "father".  Mutations were made by changing the value of a random pixel in a random individual to the opposite.  And the shaking was made, if the minimum does not change over five steps.  Then an ‚Äúextreme mutation‚Äù is made - the replacement is more intense than usual. <br><br>  I used nonograms (‚ÄúJapanese scanwords‚Äù) as original pictures, but, in truth, you can just take black squares - there is absolutely no difference.  Below are the results for multiple images.  Here, for all but the ‚Äúhouse‚Äù, the number of mutations was 100 on average for each individual, there were 100 individuals in the population, and during reproduction the population increased 4 times.  The lucky ones were 30% in each era.  For the house values ‚Äã‚Äãwere chosen smaller (30 individuals in the population, mutations of 50 per individual). <br><br><img src="https://habrastorage.org/files/049/0d3/ab0/0490d3ab093c468bb6bc59ac86ded092.gif" alt="image" height="300"><img src="https://habrastorage.org/files/09a/061/803/09a0618032f849d88694f2a43d7fbb1d.gif" alt="image" height="300"><img src="https://habrastorage.org/files/ad4/54a/446/ad454a44683a4885908fa53abcf8da8e.gif" alt="image" height="300"><img src="https://habrastorage.org/files/636/cff/a69/636cffa69d8743f98663a2a6fe92fe72.gif" alt="image" height="300"><br><br>  Experimentally, I found that using the ‚Äúlucky ones‚Äù in breeding lowers the rate of aspiration of the population to a minimum, but it helps to get out of stagnation ‚Äî without the ‚Äúlucky ones,‚Äù the stagnation will be constant.  What can be seen from the graphs: the left graph is the development of the ‚ÄúPharaoh‚Äù population with the lucky ones, the right one - without the lucky ones. <br><br><img src="https://habrastorage.org/files/e72/0e2/e9d/e720e2e9da4e43999ff387b7fcfae821.png" alt="image" height="300"><img src="https://habrastorage.org/files/1f4/3a4/14e/1f43a414e6564f98b3e6ecf698f53e6a.png" alt="image" height="300"><br><br>  Thus, we see that this algorithm allows us to solve the problem posed, albeit for a very long time.  Too many shakes, in the case of large images, can solve a larger number of individuals in the population.  I leave the optimal selection of parameters for different dimensions beyond the scope of this post. <br><br><h2>  Global optimization </h2><br>  As it was said, local optimization is a rather trivial task, even for multidimensional cases.  It is much more interesting to see how the algorithm will cope with global optimization.  But for this you first need to build a function with a set of local minima.  And this is not so difficult in our case.  It is enough to take a minimum from the distance to several images (house, dinosaur, fish, boat).  Then the original algorithm will "roll" into some random hole.  And you can just run it several times. <br><br>  But there is a more interesting solution to this problem: you can understand that we have slipped into a local minimum, make a strong shake-up (or even initiate individuals altogether), and further add penalties when approaching a known minimum.  As you can see, the pictures alternate.  I note that we have no right to touch the original function.  But we can memorize local minima and add fines on our own. <br><br>  This picture shows the result when, when a local minimum is reached (severe stagnation), the population simply dies out. <br><br><img src="https://habrastorage.org/files/eb0/d32/8a6/eb0d328a6ff34533bbe230c8af602854.gif" alt="image" height="200"><br><br>  Here the population dies out, and a small fine is added (at the rate of the usual distance to a known minimum).  This greatly reduces the likelihood of repetitions. <br><br><img src="https://habrastorage.org/files/657/039/c99/657039c991e54b11857a95cfb518a7af.gif" alt="image" height="200"><br><br>  It is more interesting when the population does not die out, but simply begins to line up under the new conditions (the next figure).  This is achieved with a fine of 0.000001 * sum ^ 4. In this case, new images become a bit noisy: <br><br><img src="https://habrastorage.org/files/52d/e13/4e9/52de134e9504437eadfc41a896c7a262.gif" alt="image" height="200"><br><br>  This noise is eliminated by limiting the penalty to max (0.000001 * sum ^ 4, 20).  But we see that the fourth local minimum (dinosaur) cannot be reached - most likely because it is too close to some other. <br><br><img src="https://habrastorage.org/files/bad/695/489/bad6954898b44661bf85a1c732d46ca0.gif" alt="image" height="200"><br><br><h4>  Biological interpretation </h4><br><img src="https://habrastorage.org/getpro/habr/post_images/ed9/394/cdb/ed9394cdb5a6cf1297d13409cf014e06.png" alt="image"><br><br>  What conclusions can we draw from modeling, I‚Äôm not afraid of this word?  First of all, we see sexual reproduction is the most important engine of development and adaptability.  But it is not enough.  The role of random, small changes is extremely important.  They provide the emergence of new species of animals in the process of evolution, and in our country it provides a diversity of the population. <br><br>  The most important role in the evolution of the Earth was played by natural disasters and mass extinctions (the extinction of dinosaurs, insects, etc. - there were about ten large ones - see the diagram below).  This was confirmed by our modeling.  And the selection of "lucky ones" showed that the weakest organisms today can in the future be the basis for future generations. <br><br>  As they say, everything is as in life.  This ‚Äúmake yourself evolution‚Äù method clearly shows interesting mechanisms and their role in development.  Of course, there are many more worthwhile evolutionary models (based, of course, on diffures), which take into account more factors that are more close to life.  Of course, there are more efficient optimization methods. <br><br><h4>  PS </h4><br>  I wrote a program on Matlab (or rather, even on Octave), because everything here is a dummy matrix, and there are tools for working with pictures.  The source code is attached. <br><br><div class="spoiler">  <b class="spoiler_title">Source</b> <div class="spoiler_text"><pre><code class="matlab hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">res</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">genetic</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(file)</span></span></span><span class="hljs-function"> %</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">generating</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">global</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AB</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">im2line</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(file)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dim</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">length</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(A(1,:)</span></span></span><span class="hljs-function">); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">count</span></span></span><span class="hljs-function"> = 100; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">reprod</span></span></span><span class="hljs-function"> = 4; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mut</span></span></span><span class="hljs-function"> = 100; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">select</span></span></span><span class="hljs-function"> = 0.7; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">stagn</span></span></span><span class="hljs-function"> = 0.8; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pop</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">round</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(rand(count,dim)</span></span></span><span class="hljs-function">); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">res</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[]</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">B</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[]</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">localmin</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[]</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">localcount</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[]</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">for</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">k</span></span></span><span class="hljs-function"> = 1:300 %</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">reproduction</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">for</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">j</span></span></span><span class="hljs-function"> = 1:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">count</span></span></span><span class="hljs-function"> * </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">reprod</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pop</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[pop; crossingover(pop(floor(rand() * count) + 1,:),pop(floor(rand() * count) + 1,:))]</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> %</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mutation</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">idx</span></span></span><span class="hljs-function"> = 10 * </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(length(res)</span></span></span><span class="hljs-function"> &gt; 5 &amp;&amp; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">std</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(res(1:5)</span></span></span><span class="hljs-function">) == 0) + 1; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">for</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">j</span></span></span><span class="hljs-function"> = 1:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">count</span></span></span><span class="hljs-function"> * </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">mut</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">a</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">floor</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(rand()</span></span></span><span class="hljs-function"> * </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">count</span></span></span><span class="hljs-function">) + 1; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">b</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">floor</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(rand()</span></span></span><span class="hljs-function"> * </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">dim</span></span></span><span class="hljs-function">) + 1; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(a,b)</span></span></span><span class="hljs-function"> = ~</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(a,b)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> %</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">selection</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">val</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">func</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(pop)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">val</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(1:count)</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">val</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(1:count)</span></span></span><span class="hljs-function"> * 10; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">npop</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">zeros</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(count,dim)</span></span></span><span class="hljs-function">; </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[s,i]</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sort</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(val)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">res</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[s(1) res]</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">opt</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(i(1)</span></span></span><span class="hljs-function">,:); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fn</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sprintf</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">('result/%05d-%d.png',k,s(1)</span></span></span><span class="hljs-function">); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">line2im</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(opt*255,fn)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(s(1)</span></span></span><span class="hljs-function"> == 0 || </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">localcount</span></span></span><span class="hljs-function"> &gt; 10) </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">localmin</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[]</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">localcount</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[]</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">B</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[B; opt]</span></span></span><span class="hljs-function">; % </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pop</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">round</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(rand(count,dim)</span></span></span><span class="hljs-function">); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">continue</span></span></span><span class="hljs-function">; % </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">break</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">for</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">j</span></span></span><span class="hljs-function"> = 1:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">floor</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(count * select)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">npop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(j,:)</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(i(j)</span></span></span><span class="hljs-function">,:); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> %</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">adding</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">luckers</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">for</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">j</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(floor(count*select)</span></span></span><span class="hljs-function">+1) : </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">count</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">npop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(j,:)</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(floor(rand()</span></span></span><span class="hljs-function"> * </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">count</span></span></span><span class="hljs-function">) + 1,:); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> %</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">fixing</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">stagnation</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(length(res)</span></span></span><span class="hljs-function"> &gt; 5 &amp;&amp; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">std</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(res(1:5)</span></span></span><span class="hljs-function">) == 0) </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">if</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(localmin == res(1)</span></span></span><span class="hljs-function">) </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">localcount</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">localcount</span></span></span><span class="hljs-function">+1; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">else</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">localcount</span></span></span><span class="hljs-function"> = 1; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">localmin</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">res</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(1)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">for</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">j</span></span></span><span class="hljs-function"> = 1:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">count</span></span></span><span class="hljs-function">*</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">stagn</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">a</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">floor</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(rand()</span></span></span><span class="hljs-function"> * </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">count</span></span></span><span class="hljs-function">) + 1; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">npop</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(a,:)</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">crossingover</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(npop(a,:)</span></span></span><span class="hljs-function">,</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">rand</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(1,dim)</span></span></span><span class="hljs-function">); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">pop</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">npop</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">res</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">res</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(length(res)</span></span></span><span class="hljs-function">:-1:1); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">res</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">crossingover</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(a, b)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">round</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(rand(size(a)</span></span></span><span class="hljs-function">)); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">res</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">a</span></span></span><span class="hljs-function"> .* </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">x</span></span></span><span class="hljs-function"> + </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">b</span></span></span><span class="hljs-function"> .* </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(~x)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">res</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">func</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(v)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">global</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">AB</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">res</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">inf</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">for</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">i</span></span></span><span class="hljs-function"> = 1:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">size</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(A,1)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">res</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">min</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(res,sum(v ~= A(i,:)</span></span></span><span class="hljs-function">,2)); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">for</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">i</span></span></span><span class="hljs-function"> = 1:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">size</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(B,1)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">res</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">res</span></span></span><span class="hljs-function"> + </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">max</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(0.000001 * sum(v == B(i,:)</span></span></span><span class="hljs-function">,2) .^ 4,20); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[]</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">im2line</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(files)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">global</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sz</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[]</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">files</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">cellstr</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(files)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">for</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">i</span></span></span><span class="hljs-function"> = 1:</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">size</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(files,1)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">imorig</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">imread</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(char(files(i,:)</span></span></span><span class="hljs-function">)); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sz</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">size</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(imorig)</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A</span></span></span><span class="hljs-function"> = </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[A; reshape(imorig,[1 size(imorig,1)*size(imorig,2)]</span></span></span><span class="hljs-function">)]; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">A</span></span></span><span class="hljs-function"> / 255; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">function</span></span></span><span class="hljs-function"> </span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">[]</span></span></span><span class="hljs-function"> = </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">line2im</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(im,file)</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">global</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">sz</span></span></span><span class="hljs-function">; </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">imwrite</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(reshape(im*255,sz)</span></span></span><span class="hljs-function">,</span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">file</span></span></span><span class="hljs-function">); </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">end</span></span></span></span></code> </pre> </div></div></div><p>Source: <a href="https://habr.com/ru/post/254759/">https://habr.com/ru/post/254759/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../254749/index.html">Bubot is a very easy Python 3 framework for robot programming and home automation.</a></li>
<li><a href="../254751/index.html">How Wheatfield Diffie helped Bob and Alice trick Eve</a></li>
<li><a href="../254753/index.html">Determine the weight of chess pieces by regression analysis</a></li>
<li><a href="../254755/index.html">From complex to simple: the evolution of interfaces of mobile trading terminals</a></li>
<li><a href="../254757/index.html">We write the postal address, as humans</a></li>
<li><a href="../254761/index.html">Universal Remote for Arduino</a></li>
<li><a href="../254763/index.html">We get acquainted with Fabric.js. Part 3</a></li>
<li><a href="../254765/index.html">Comparative analysis of scanners RSL</a></li>
<li><a href="../254767/index.html">Qooxdoo. Developing a TODO List</a></li>
<li><a href="../254769/index.html">Unfunny April Fool's joke from the developers of Magic Lantern</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>