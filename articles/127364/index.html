<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Represent Lotus Domino data in Oracle Database using the Oracle Data Cartridge Interface and the Domino Java API</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Each of us faced the need to integrate different systems. I would like to talk about how to provide the ability to display data from Lotus Domino usin...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Represent Lotus Domino data in Oracle Database using the Oracle Data Cartridge Interface and the Domino Java API</h1><div class="post__text post__text-html js-mediator-article"> Each of us faced the need to integrate different systems.  I would like to talk about how to provide the ability to display data from Lotus Domino using an SQL select statement in Oracle Database.  Perhaps this topic will not be interesting to many.  But, in my opinion, these two commercial products deserve to write about the opportunities they provide. <br><a name="habracut"></a><br>  Those wishing to understand the topic can preview two documents: <a href="http://download.oracle.com/docs/cd/B10500_01/appdev.920/a96595/dciappa1.htm">Example: Pipelined Table Functions: Interface Approach, part of the Java Implementation of the ODCITable Methods</a> and <a href="http://www.ibm.com/developerworks/lotus/library/ls-Java_access_pt1/">Java Access</a> <br>  Based on them, I created the following example, the purpose of which is to demonstrate the fundamental possibility of using data from a Domino address book in Oracle queries.  It is assumed that both software products are installed in linux in the standard way, and the files and actions themselves are located and executed in the / home / user / java / oracle_domino directory.  Required additional comments can be found in both documents. <br><br>  For starters, domino_names_odci_mem.java: <br><pre> <code class="hljs pgsql"><code class="java"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> lotus.domino.*; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.*; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.io.*; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> oracle.<span class="hljs-keyword"><span class="hljs-keyword">sql</span></span>.*; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.<span class="hljs-keyword"><span class="hljs-keyword">sql</span></span>.*; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.math.*; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> oracle.CartridgeServices.*; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.Calendar; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.text.SimpleDateFormat; <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> domino_StoredCtx { //   ,   domino Vector vnames; } //   SQLData,          <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> domino_names_odci_mem implements SQLData { private BigDecimal key; final static BigDecimal SUCCESS = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> BigDecimal(<span class="hljs-number"><span class="hljs-number">0</span></span>); final static BigDecimal ERROR = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> BigDecimal(<span class="hljs-number"><span class="hljs-number">1</span></span>); //  SQLData String sql_type; <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> String getSQLTypeName() throws SQLException { <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> sql_type; } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> readSQL(SQLInput stream, String typeName) throws SQLException { sql_type = typeName; key = stream.readBigDecimal(); } <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> <span class="hljs-type"><span class="hljs-type">void</span></span> writeSQL(SQLOutput stream) throws SQLException { stream.writeBigDecimal(key); } // ODCI: ODCITableStart,ODCITableFetch,ODCITableClose (  ,   ) static <span class="hljs-built_in"><span class="hljs-built_in">public</span></span> BigDecimal ODCITableStart(STRUCT[] sctx,String param) throws SQLException { <span class="hljs-keyword"><span class="hljs-keyword">Connection</span></span> conn = DriverManager.getConnection("jdbc:default:connection:"); domino_StoredCtx ctx = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> domino_StoredCtx(); StructDescriptor outDesc = StructDescriptor.createDescriptor("DOMINO_NAME", conn); <span class="hljs-keyword"><span class="hljs-keyword">Object</span></span>[] out_attr = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Object</span></span>[<span class="hljs-number"><span class="hljs-number">4</span></span>]; //     <span class="hljs-number"><span class="hljs-number">10</span></span>  <span class="hljs-type"><span class="hljs-type">int</span></span> nrowsval = <span class="hljs-number"><span class="hljs-number">10</span></span>; ctx.vnames = <span class="hljs-built_in"><span class="hljs-built_in">new</span></span> Vector(); try { //     domino       lotus.domino.<span class="hljs-keyword"><span class="hljs-keyword">Session</span></span> <span class="hljs-keyword"><span class="hljs-keyword">session</span></span> = NotesFactory.createSession("ip_of_domino_server:DIIOP_port","user","password"); lotus.domino.<span class="hljs-keyword"><span class="hljs-keyword">Database</span></span> db = <span class="hljs-keyword"><span class="hljs-keyword">session</span></span>.getDatabase("", "names.nsf"); lotus.domino.<span class="hljs-keyword"><span class="hljs-keyword">View</span></span> vw = db.getView("People"); lotus.domino.Document doc = vw.getFirstDocument(); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span>(nrowsval&gt;<span class="hljs-number"><span class="hljs-number">0</span></span> &amp;&amp; doc != <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>){ String shortName = doc.getItemValueString("ShortName"); String altFullName = doc.getItemValueString("AltFullName"); lotus.domino.Name <span class="hljs-type"><span class="hljs-type">name</span></span> = <span class="hljs-keyword"><span class="hljs-keyword">session</span></span>.createName(altFullName); String commonName = <span class="hljs-type"><span class="hljs-type">name</span></span>.getCommon(); String employeeID = doc.getItemValueString("EmployeeID"); out_attr[<span class="hljs-number"><span class="hljs-number">1</span></span><span class="hljs-number"><span class="hljs-number">-1</span></span>] = (<span class="hljs-keyword"><span class="hljs-keyword">Object</span></span>)<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> String(shortName); out_attr[<span class="hljs-number"><span class="hljs-number">2</span></span><span class="hljs-number"><span class="hljs-number">-1</span></span>] = (<span class="hljs-keyword"><span class="hljs-keyword">Object</span></span>)<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> String(commonName); out_attr[<span class="hljs-number"><span class="hljs-number">3</span></span><span class="hljs-number"><span class="hljs-number">-1</span></span>] = (<span class="hljs-keyword"><span class="hljs-keyword">Object</span></span>)<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> String(employeeID); out_attr[<span class="hljs-number"><span class="hljs-number">4</span></span><span class="hljs-number"><span class="hljs-number">-1</span></span>] = (<span class="hljs-keyword"><span class="hljs-keyword">Object</span></span>)<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> String(now()); ctx.vnames.<span class="hljs-keyword"><span class="hljs-keyword">add</span></span>((<span class="hljs-keyword"><span class="hljs-keyword">Object</span></span>)<span class="hljs-built_in"><span class="hljs-built_in">new</span></span> STRUCT(outDesc, conn, out_attr)); nrowsval<span class="hljs-comment"><span class="hljs-comment">--; doc = vw.getNextDocument(doc); } } catch(Exception e) { e.printStackTrace(); } int key; try { //        ODCITableFetch key = ContextManager.setContext(ctx); } catch (CountException ce) { return ERROR; } Object[] impAttr = new Object[1]; impAttr[0] = new BigDecimal(key); StructDescriptor sd = new StructDescriptor("DOMINO_NAMES_ODCI_MEM",conn); sctx[0] = new STRUCT(sd,conn,impAttr); return SUCCESS; } public BigDecimal ODCITableFetch(BigDecimal nrows, ARRAY[] outSet) throws SQLException { Connection conn = DriverManager.getConnection("jdbc:default:connection:"); domino_StoredCtx ctx; try { //    ctx=(domino_StoredCtx)ContextManager.getContext(key.intValue()); } catch (InvalidKeyException ik ) { return ERROR; } // ODCITableFetch  ,      //..  ,     2 ,    ,    if(ctx.vnames==null) return SUCCESS; //     Object out_arr[] = ctx.vnames.toArray(); ArrayDescriptor ad = new ArrayDescriptor("DOMINO_NAMES_TABLE",conn); outSet[0] = new ARRAY(ad,conn,out_arr); // ,       ctx.vnames=null; return SUCCESS; } public BigDecimal ODCITableClose() throws SQLException { domino_StoredCtx ctx; try { ctx=(domino_StoredCtx)ContextManager.clearContext(key.intValue()); } catch (InvalidKeyException ik ) { return ERROR; } return SUCCESS; } //      public static final String DATE_FORMAT_NOW = "yyyy-MM-dd HH:mm:ss"; public static String now() { Calendar cal = Calendar.getInstance(); SimpleDateFormat sdf = new SimpleDateFormat(DATE_FORMAT_NOW); return sdf.format(cal.getTime()); } }</span></span></code><span class="hljs-comment"><span class="hljs-comment"> </span></span><br></code> </pre> <code><code class="java">import lotus.domino.*; import java.util.*; import java.io.*; import oracle.sql.*; import java.sql.*; import java.math.*; import oracle.CartridgeServices.*; import java.util.Calendar; import java.text.SimpleDateFormat; public class domino_StoredCtx { //   ,   domino Vector vnames; } //   SQLData,          public class domino_names_odci_mem implements SQLData { private BigDecimal key; final static BigDecimal SUCCESS = new BigDecimal(0); final static BigDecimal ERROR = new BigDecimal(1); //  SQLData String sql_type; public String getSQLTypeName() throws SQLException { return sql_type; } public void readSQL(SQLInput stream, String typeName) throws SQLException { sql_type = typeName; key = stream.readBigDecimal(); } public void writeSQL(SQLOutput stream) throws SQLException { stream.writeBigDecimal(key); } // ODCI: ODCITableStart,ODCITableFetch,ODCITableClose (  ,   ) static public BigDecimal ODCITableStart(STRUCT[] sctx,String param) throws SQLException { Connection conn = DriverManager.getConnection("jdbc:default:connection:"); domino_StoredCtx ctx = new domino_StoredCtx(); StructDescriptor outDesc = StructDescriptor.createDescriptor("DOMINO_NAME", conn); Object[] out_attr = new Object[4]; //     10  int nrowsval = 10; ctx.vnames = new Vector(); try { //     domino       lotus.domino.Session session = NotesFactory.createSession("ip_of_domino_server:DIIOP_port","user","password"); lotus.domino.Database db = session.getDatabase("", "names.nsf"); lotus.domino.View vw = db.getView("People"); lotus.domino.Document doc = vw.getFirstDocument(); while(nrowsval&gt;0 &amp;&amp; doc != null){ String shortName = doc.getItemValueString("ShortName"); String altFullName = doc.getItemValueString("AltFullName"); lotus.domino.Name name = session.createName(altFullName); String commonName = name.getCommon(); String employeeID = doc.getItemValueString("EmployeeID"); out_attr[1-1] = (Object)new String(shortName); out_attr[2-1] = (Object)new String(commonName); out_attr[3-1] = (Object)new String(employeeID); out_attr[4-1] = (Object)new String(now()); ctx.vnames.add((Object)new STRUCT(outDesc, conn, out_attr)); nrowsval--; doc = vw.getNextDocument(doc); } } catch(Exception e) { e.printStackTrace(); } int key; try { //        ODCITableFetch key = ContextManager.setContext(ctx); } catch (CountException ce) { return ERROR; } Object[] impAttr = new Object[1]; impAttr[0] = new BigDecimal(key); StructDescriptor sd = new StructDescriptor("DOMINO_NAMES_ODCI_MEM",conn); sctx[0] = new STRUCT(sd,conn,impAttr); return SUCCESS; } public BigDecimal ODCITableFetch(BigDecimal nrows, ARRAY[] outSet) throws SQLException { Connection conn = DriverManager.getConnection("jdbc:default:connection:"); domino_StoredCtx ctx; try { //    ctx=(domino_StoredCtx)ContextManager.getContext(key.intValue()); } catch (InvalidKeyException ik ) { return ERROR; } // ODCITableFetch  ,      //..  ,     2 ,    ,    if(ctx.vnames==null) return SUCCESS; //     Object out_arr[] = ctx.vnames.toArray(); ArrayDescriptor ad = new ArrayDescriptor("DOMINO_NAMES_TABLE",conn); outSet[0] = new ARRAY(ad,conn,out_arr); // ,       ctx.vnames=null; return SUCCESS; } public BigDecimal ODCITableClose() throws SQLException { domino_StoredCtx ctx; try { ctx=(domino_StoredCtx)ContextManager.clearContext(key.intValue()); } catch (InvalidKeyException ik ) { return ERROR; } return SUCCESS; } //      public static final String DATE_FORMAT_NOW = "yyyy-MM-dd HH:mm:ss"; public static String now() { Calendar cal = Calendar.getInstance(); SimpleDateFormat sdf = new SimpleDateFormat(DATE_FORMAT_NOW); return sdf.format(cal.getTime()); } }</code> <br></code> <br><br>  Now the shell script that will prepare and display everything. <br>  NCSO.jar in the case of a standard Domino installation can be taken from the directory / local / notesdata / domino / java 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="hljs pgsql"><code class="bash">export ORACLE_SID=MYDB #      sqlplus <span class="hljs-string"><span class="hljs-string">'/as sysdba'</span></span> &lt;&lt;EOF <span class="hljs-keyword"><span class="hljs-keyword">drop</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> udomino <span class="hljs-keyword"><span class="hljs-keyword">cascade</span></span>; / <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">user</span></span> udomino identified <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> "pdomino"; <span class="hljs-keyword"><span class="hljs-keyword">grant</span></span> <span class="hljs-keyword"><span class="hljs-keyword">connect</span></span>,resource <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> udomino; <span class="hljs-keyword"><span class="hljs-keyword">grant</span></span> <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">any</span></span> directory,<span class="hljs-keyword"><span class="hljs-keyword">drop</span></span> <span class="hljs-keyword"><span class="hljs-keyword">any</span></span> directory <span class="hljs-keyword"><span class="hljs-keyword">to</span></span> udomino; exec dbms_java.grant_permission( <span class="hljs-string"><span class="hljs-string">'UDOMINO'</span></span>, <span class="hljs-string"><span class="hljs-string">'SYS:java.net.SocketPermission'</span></span>, <span class="hljs-string"><span class="hljs-string">'ip_of_domino_server:DIIOP_port'</span></span>, <span class="hljs-string"><span class="hljs-string">'connect,resolve'</span></span> ); EOF # Oracle <span class="hljs-keyword"><span class="hljs-keyword">Database</span></span>      jar,   Domino,         #     , .. Oracle ,      loadjava -<span class="hljs-keyword"><span class="hljs-keyword">user</span></span> udomino/pdomino -<span class="hljs-keyword"><span class="hljs-keyword">order</span></span> -resolve -genmissing -<span class="hljs-keyword"><span class="hljs-keyword">verbose</span></span> -resolver "((* UDOMINO) (* PUBLIC) (* -))" NCSO.jar #         sqlplus -S /nolog &lt;&lt;EOF <span class="hljs-keyword"><span class="hljs-keyword">connect</span></span> udomino/pdomino <span class="hljs-keyword"><span class="hljs-keyword">drop</span></span> <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> domino_names_odci_mem; <span class="hljs-keyword"><span class="hljs-keyword">drop</span></span> <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> domino_names_table; <span class="hljs-keyword"><span class="hljs-keyword">drop</span></span> <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> domino_name; <span class="hljs-keyword"><span class="hljs-keyword">drop</span></span> <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> domino_names; <span class="hljs-keyword"><span class="hljs-keyword">drop</span></span> java source domino_names_odci_mem_source; <span class="hljs-keyword"><span class="hljs-keyword">drop</span></span> directory javadir / <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> domino_name <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> ( shn <span class="hljs-type"><span class="hljs-type">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">20</span></span>), fio <span class="hljs-type"><span class="hljs-type">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">256</span></span>), tab_n <span class="hljs-type"><span class="hljs-type">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">20</span></span>), dt <span class="hljs-type"><span class="hljs-type">varchar</span></span>(<span class="hljs-number"><span class="hljs-number">20</span></span>) ); / <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> domino_names_table <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> domino_name; / <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or replace</span></span> directory javadir <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-string"><span class="hljs-string">'/home/user/java/oracle_domino'</span></span>; / <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">and</span></span> compile java source named domino_names_odci_mem_source <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> bfile (javadir,<span class="hljs-string"><span class="hljs-string">'domino_names_odci_mem.java'</span></span>); / <span class="hljs-keyword"><span class="hljs-keyword">show</span></span> errors #   ODCITable <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> domino_names_odci_mem <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">object</span></span> ( key <span class="hljs-type"><span class="hljs-type">integer</span></span>, static <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> ODCITableStart(sctx <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> domino_names_odci_mem,param varchar2) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> number <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">language</span></span> java <span class="hljs-type"><span class="hljs-type">name</span></span> <span class="hljs-string"><span class="hljs-string">'domino_names_odci_mem.ODCITableStart(oracle.sql.STRUCT[],java.lang.String) return java.math.BigDecimal'</span></span>, member <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> ODCITableFetch(self <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> domino_names_odci_mem, nrows <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> number, outSet <span class="hljs-keyword"><span class="hljs-keyword">out</span></span> domino_names_table) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> number <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">language</span></span> java <span class="hljs-type"><span class="hljs-type">name</span></span> <span class="hljs-string"><span class="hljs-string">'domino_names_odci_mem.ODCITableFetch(java.math.BigDecimal, oracle.sql.ARRAY[]) return java.math.BigDecimal'</span></span>, member <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> ODCITableClose(self <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> domino_names_odci_mem) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> number <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> <span class="hljs-keyword"><span class="hljs-keyword">language</span></span> java <span class="hljs-type"><span class="hljs-type">name</span></span> <span class="hljs-string"><span class="hljs-string">'domino_names_odci_mem.ODCITableClose() return java.math.BigDecimal'</span></span> ); / <span class="hljs-keyword"><span class="hljs-keyword">show</span></span> errors <span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">function</span></span> domino_names(param varchar2) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> domino_names_table pipelined <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> domino_names_odci_mem; / EOF #      export NLS_LANG=American_America.UTF8 sqlplus -S /nolog&lt;&lt;EOF <span class="hljs-keyword"><span class="hljs-keyword">connect</span></span> udomino/pdomino <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> serveroutput <span class="hljs-keyword"><span class="hljs-keyword">on</span></span> <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> dbms_java.set_output(<span class="hljs-number"><span class="hljs-number">1000000</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> linesize <span class="hljs-number"><span class="hljs-number">160</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> pagesize <span class="hljs-number"><span class="hljs-number">1000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> feedback <span class="hljs-keyword"><span class="hljs-keyword">off</span></span> col fio <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> a50 col tab_n <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> a10 col shn <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> a20 col dt <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> a20 <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> * <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span>(domino_names(<span class="hljs-string"><span class="hljs-string">'some_string_param'</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">order</span></span> <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> dt; <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span>; EOF</code> <br></code> </pre> <code><code class="bash">export ORACLE_SID=MYDB #      sqlplus '/as sysdba' &lt;&lt;EOF drop user udomino cascade; / create user udomino identified by "pdomino"; grant connect,resource to udomino; grant create any directory,drop any directory to udomino; exec dbms_java.grant_permission( 'UDOMINO', 'SYS:java.net.SocketPermission', 'ip_of_domino_server:DIIOP_port', 'connect,resolve' ); EOF # Oracle Database      jar,   Domino,         #     , .. Oracle ,      loadjava -user udomino/pdomino -order -resolve -genmissing -verbose -resolver "((* UDOMINO) (* PUBLIC) (* -))" NCSO.jar #         sqlplus -S /nolog &lt;&lt;EOF connect udomino/pdomino drop type domino_names_odci_mem; drop type domino_names_table; drop type domino_name; drop function domino_names; drop java source domino_names_odci_mem_source; drop directory javadir / create type domino_name as object ( shn varchar(20), fio varchar(256), tab_n varchar(20), dt varchar(20) ); / create type domino_names_table as table of domino_name; / create or replace directory javadir as '/home/user/java/oracle_domino'; / create and compile java source named domino_names_odci_mem_source using bfile (javadir,'domino_names_odci_mem.java'); / show errors #   ODCITable create type domino_names_odci_mem as object ( key integer, static function ODCITableStart(sctx in out domino_names_odci_mem,param varchar2) return number as language java name 'domino_names_odci_mem.ODCITableStart(oracle.sql.STRUCT[],java.lang.String) return java.math.BigDecimal', member function ODCITableFetch(self in out domino_names_odci_mem, nrows in number, outSet out domino_names_table) return number as language java name 'domino_names_odci_mem.ODCITableFetch(java.math.BigDecimal, oracle.sql.ARRAY[]) return java.math.BigDecimal', member function ODCITableClose(self IN domino_names_odci_mem) return number as language java name 'domino_names_odci_mem.ODCITableClose() return java.math.BigDecimal' ); / show errors create function domino_names(param varchar2) return domino_names_table pipelined using domino_names_odci_mem; / EOF #      export NLS_LANG=American_America.UTF8 sqlplus -S /nolog&lt;&lt;EOF connect udomino/pdomino set serveroutput on call dbms_java.set_output(1000000); set linesize 160 set pagesize 1000 set feedback off col fio for a50 col tab_n for a10 col shn for a20 col dt for a20 select * from table(domino_names('some_string_param')) order by dt; exit; EOF</code> <br></code> <br><br>  As a result, approximately the following will be displayed (at the end): <br><pre> <code class="hljs css"><code class="bash"><span class="hljs-selector-tag"><span class="hljs-selector-tag">SHN</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">FIO</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">TAB_N</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">DT</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">--------------------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">------------------------------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">----------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">--------------------</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">user</span></span>    12305 2011<span class="hljs-selector-tag"><span class="hljs-selector-tag">-08-25</span></span> 11<span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:55</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:14</span></span> ....</code> <br></code> </pre> <code><code class="bash">SHN FIO TAB_N DT -------------------- ------------------------------ ---------- -------------------- user    12305 2011-08-25 11:55:14 ....</code> <br></code> <br><br>  The fact that the result is obtained is the result of many steps to configure, in particular, the Domino server.  Those.  it is impossible to simply put the files ‚Äúwhere necessary‚Äù and execute the shell script.  But, I think, for those who wish, the cited references to documents and an example can help to achieve what they need. </div><p>Source: <a href="https://habr.com/ru/post/127364/">https://habr.com/ru/post/127364/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../127359/index.html">Someone decided to remove all references to himself on the network. What to do?</a></li>
<li><a href="../127360/index.html">Overview of the global video analysis market</a></li>
<li><a href="../127361/index.html">Apache POI 3.8beta4 has been released.</a></li>
<li><a href="../127362/index.html">Droider Chart. Issue 67, applied</a></li>
<li><a href="../127363/index.html">Fantasy? No, Wacom!</a></li>
<li><a href="../127366/index.html">How mailing infrastructure works</a></li>
<li><a href="../127369/index.html">WikiLeaks: another, unusually large portion of documents</a></li>
<li><a href="../127374/index.html">Automatic Web Development Hosts (FreeBSD)</a></li>
<li><a href="../127375/index.html">Interactive diagram on CSS and HTML</a></li>
<li><a href="../127376/index.html">Experience creating an Ajax application</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>