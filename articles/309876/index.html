<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Google Device Lab Winners: Explore Project Tango</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello colleagues! Our small company Vizerra develops custom projects and its own products in the field of augmented and virtual reality (hereinafter r...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Google Device Lab Winners: Explore Project Tango</h1><div class="post__text post__text-html js-mediator-article">  Hello colleagues!  Our small company <a href="http://www.vizerra.ru/">Vizerra</a> develops custom projects and its own products in the field of augmented and virtual reality (hereinafter referred to as ARVR) for a variety of <a href="http://www.vizerra.ru/projects/">customers</a> .  On almost every project we need to come up with some new and unexpected solution.  The ARVR market is very young and many solutions are created during projects.  Thus its development takes place. <br><br><img src="https://habrastorage.org/files/f34/69b/c9e/f3469bc9ee014d0b8a8900de53a3255e.png"><br>  <em>Article winning author Alexander Lavrov, in the framework of the competition <a href="http://special.habrahabr.ru/google/lab">"Device Lab from Google</a></em> . <em><a href="http://special.habrahabr.ru/google/lab">"</a></em> <br><a name="habracut"></a><br>  In this regard, we constantly try new equipment with an eye to its use in projects.  Today we want to talk about this already famous, but low-lit in the Russian-speaking Internet device such as Project Tango.  Most recently, he simply became Tango, marking the transition to the commercial stage of his life and devices for end users began to appear. <br><br>  Our acquaintance with Project Tango began in the spring of this year, when an idea arose to try marker-free tracking for a number of our projects. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      It turned out that to get the device for experiments is very difficult.  We were helped by the Skolkovo Foundation by introducing Google to the Russian office.  The guys were very responsive and gave the much-desired device to their hands. <br><br>  We were able to quickly achieve the results we needed, showed our tests at <a href="https://startupvillage.ru/en">Startup Village,</a> and with a sense of accomplishment, returned the device to Google. <br><br>  A couple of months ago, we found out that <a href="https://special.habrahabr.ru/google/lab/">Google Device Lab</a> had started, and we decided that we needed to pay back good for the good ‚Äî to share our experience with other developers and sat down to write this article.  In the process of writing an article, its concept changed several times.  I wanted to do something useful as usual, and not to describe our next project.  In the end, after consulting we decided that the most useful would be to write a Russian-language full review of Project Tango, taking into account all the bumps we had.  Then we began to combine disparate sources, so that the reader would have created a fairly complete picture after reading this article. <br><br>  And to make it more fun to do this, we used animated miniature models of military equipment from one of our past <a href="http://bit.ly/2b4iWu7">projects</a> as content. <br><br><img src="https://habrastorage.org/files/8d1/c4a/a1d/8d1c4aa1dd3f44418685c4097bba5a3d.png"><br><br><h2>  Hardware </h2><br>  First, let's see what the device itself is. <br><br>  At the time of testing, there were 2 available modifications: <br><br><ol><li>  Tablet "Yellowstone."  Usually when people talk about Tango, the vast majority imagine it is him. </li><li>  Telephone "Peanut".  Honestly, we don‚Äôt know anyone who really held him in his hands. </li></ol><br> <a href="http://www.talkandroid.com/200793-one-developer-shares-his-experience-with-his-project-tango-prototype/"><img src="https://habrastorage.org/files/cc2/e81/e8a/cc2e81e8a7f74c2fbea9c13e762f4084.png"></a> <br><br>  We got for experiments a 7 inch Yellowstone tablet that is part of the Project Tango Tablet Development Kit. <br><br>  The base tablet itself is not surprising in principle.  The device contains a 2.3 GHz quad-core Nvidia Tegra K1 processor, 128GB flash memory, 4 megapixel camera, 1920x1200 resolution touch screen and 4G LTE. <br><br>  The operating system uses Android 4.4 (KitKat).  We have already lost the order of systems under 5.0.  Last year, the minimum requirement for customers was support for devices with Android 5.0. <br><br>  It should be remembered that the device is part of the Development Kit, and not a device for the end user.  For the prototype, it looks great and even convenient to use!  Filling the device is not the most modern, but the device works perfectly.  Obviously, in serial devices, end-manufacturers using the Tango platform can easily use the latest hardware and OS. <br><br>  Much more interesting is the set of built-in sensors.  It seems that at the moment it is the most "pumped" tablet.  How exactly they are used will be discussed later. <br><br><ul><li>  <a href="https://en.wikipedia.org/wiki/Fisheye_lens">Fisheye</a> camera to track movement </li><li>  3D depth sensors </li><li>  Accelerometer </li><li>  Ambient light sensor </li><li>  Barometer </li><li>  Compass </li><li>  GPS </li><li>  Gyroscope </li></ul><br>  In the diagram below you can see the location of external sensors on the device. <br><br> <a href="https://developers.google.com/tango/hardware/tablet"><img src="https://habrastorage.org/files/f50/c3b/8f1/f50c3b8f104542daadddb5027c6ce771.png"></a> <br><br>  For those who like to see ‚Äúwhat is actually inside it,‚Äù we attach a photo of the device in a disassembled form.  Did not disassemble themselves.  Thank you, colleagues from the portal slashgear.com for an interesting photo. <br><br><img src="https://habrastorage.org/files/edf/70d/4af/edf70d4afd7346048fdbacfc09f24d5c.png"><br><br>  Google warns that Tango and Android are not real-time hardware systems.  The main reason is that the Android Linux Kernel cannot provide guarantees of the program execution time on the device.  For this reason, Project Tango can be considered a real-time software system. <br><br><h2>  Principle of the device </h2><br>  To make it clear what will be discussed later during development, let's understand the principle of the device. <br><br>  Firstly, it should be understood that the Tango is not just an experimental tablet, which is demonstrated everywhere, but a new scalable platform that uses computer vision to enable devices to understand their position in relation to the world around them.  That is, it is assumed that computer vision sensors will be added to the usual sensors in a smartphone or tablet. <br><br>  The device works similarly to how we use our human visual apparatus to find our way into the room, and then to know where we are in the room, where the floor, walls and objects around us.  These insights are an integral part of how we move through space in our daily lives. <br><br>  Tango gives mobile devices the ability to determine their position in the world around them using three basic technologies: Motion Tracking, Area Learning (exploring areas of space) and Depth Perception (depth perception).  Each of them individually has its own unique capabilities and limitations.  All together, they allow you to accurately position the device in the outside world. <br><br><img src="https://habrastorage.org/files/6a8/202/84b/6a820284b09a4da7a57bbade34a9c0f2.png" align="right">  <strong>Motion tracking</strong> <br><br>  This technology allows the device to track its own movement and orientation in 3D space.  We can walk with the device as we need and it will show us where it is and in what direction the movement takes place. <br><br>  The result of this technology is the relative position and orientation of the device in space. <br><br>  The key term in the Motion Tracking technology is Pose (posture) - a combination of the position and orientation of the device.  The term sounds, quite frankly, quite specific and, probably, Google decided to emphasize to them its desire to improve the human-machine interface.  Usually, posture refers to the position taken by the human body, the position of the body, head and limbs relative to each other. <br><br>  The Tango API provides the position and orientation of a user device with six degrees of freedom.  The data consists of two main parts: a vector in meters to move and a quaternion for rotation.  Poses are indicated for a particular pair of trajectory points.  In this case, a reference system is used - the totality of the reference body, the associated coordinate <em>system</em> and <em>the</em> time <em>reference system</em> , in relation to which the movement of some bodies is considered. <br><br><img src="https://habrastorage.org/files/441/f8c/750/441f8c7509c44fdda53fecb97a296d1a.png" align="left">  In the context of Tango, this means that when requesting a specific pose, we must indicate the target point to which we are moving relative to the base point of the movement. <br><br>  Tango implements Motion Tracking using visual inertial odometry (visual-inertial odometry or VIO). <br><br>  Odometry is a method of assessing the position and orientation of a robot or other device by analyzing the sequence of images taken by the camera (or cameras) mounted on it.  Standard visual odometry uses images from the camera to determine the change in the position of the device, by searching for the relative position of the various visual features in these images.  For example, if you took a photograph of a building from a distance, and then took another photograph from a closer distance, you can calculate the distance that the camera moves based on the zoom and position of the building in the photographs.  Below you can see images with an example of such a search for visual signs. <br><br><img src="https://habrastorage.org/files/ee9/8eb/fc9/ee98ebfc9e6b4ccab3f866d528508ef3.jpg"><br><br>  Images are the property of <a href="https://developers.google.com/tango/overview/motion-tracking">NASA</a> . <br><br>  Visual inertial odometry complements visual odometry with inertial motion sensors capable of tracking the rotation of the device and its acceleration in space.  This allows the device to calculate its orientation and movement in 3D space with even greater accuracy.  Unlike GPS, motion tracking using the VIO also works indoors.  What was the reason for the emergence of a large number of ideas to create relatively inexpensive indoor navigation systems. <br><br>  Visual inertial odometry provides an improved definition of orientation in space compared to the standard <a href="http://developer.android.com/guide/topics/sensors/sensors_position.html">Android Game Rotation</a> Vector APIs.  It uses visual information that helps to estimate the rotation and linear acceleration more accurately.  Thus, we observe a successful combination of previously known technologies to eliminate their known problems. <br><br>  All of the above is necessary so that when combining the rotation and position tracking in space, we can use the device as a virtual camera in the appropriate 3D space of your application. <br><br> <a href="https://developers.google.com/tango/overview/motion-tracking"><img src="https://habrastorage.org/files/f07/4f6/ff2/f074f6ff2da94a2488beade829c548b7.png"></a> <br><br>  Motion tracking is a basic technology.  It is easy to use, but has several problems: <br><br><ul><li>  The technology does not understand by itself what it is to be around the user.  In Tango, other technologies are responsible for this task: Area Learning and Depth Perception. <br><br></li><li>  Motion Tracking does not "remember" previous sessions.  Each time you start a new motion tracking session, the tracking begins again and reports its position in relation to its starting position in the current session. <br><br></li><li>  Also, judging by the experiments, shaking the device leads to loss of tracking.  This was very clearly manifested when used in a car. <br><br><img src="https://habrastorage.org/files/f35/330/fd7/f35330fd72f648cba165bbbad8181594.png"><br><br></li><li>  When a device is moved over long distances and for long periods of time, small errors accumulate, which can lead to large errors in absolute position in space.  There will be a so-called "drift" (drift).  This is another term borrowed from the real world.  Usually, this requirement means the deviation of a moving vessel from the course under the influence of wind or current, as well as the movement of ice carried by the current.  To combat drift, Tango uses Area Learning to correct these errors.  We will look at this aspect in detail in the next part of the article. </li></ul><br>  &lt;img <br>  src = " <a href="">habrastorage.org/files/72c/374/358/72c37435811a46ecbce09b4ce4952b6c.png</a> " align = "right" /&gt; <strong>Area Learning</strong> <br><br>  People can recognize where they are, noticing the signs they know around them: doorway, stairs, table, etc.  Tango provides the mobile device with the same ability.  With the help of motion tracking technology alone, the device ‚Äúsees‚Äù through the camera the visual features of the area, but does not ‚Äúremember‚Äù them.  With the help of area learning, the device not only ‚Äúremembers‚Äù what it ‚Äúsaw‚Äù, but can also save and use this information.  The result of this technology is the absolute position and orientation of the device in the space already known to him. <br><br>  Tango uses the simultaneous localization and mapping method (SLAM from Simultaneous Simultaneous Localization and Mapping) - a method used in mobile offline tools for building a map in an unknown space or for updating a map in a previously known space while simultaneously monitoring your current location and distance traveled. <br><br>  Published approaches are already used in self-driving cars, unmanned aerial vehicles, autonomous underwater vehicles, planet rovers, home robots, and even inside the human body. <br><br>  In the context of Tango Area learning solves 2 key tasks: <br><br><ol><li>  Improving the accuracy of the trajectory obtained using motion tracking.  This process is called "Drift Correction." <br><br></li><li>  The orientation and positioning of the device itself within the previously studied area.  This process is called Localization. </li></ol><br>  Let's take a closer look at exactly how these tasks are solved. <br><br>  <em>Drift correction</em> <br><br>  As mentioned earlier, area learning remembers visual signs in areas of the real world that the device ‚Äúsaw‚Äù and uses them to correct errors in its position, orientation and movement.  When a device sees a place that it saw earlier in your session, it understands and adjusts its path to match its previous observations. <br><br>  The figure below shows an example of drift correction. <br><br> <a href="https://developers.google.com/tango/overview/area-learning"><img src="https://habrastorage.org/files/fd2/b88/de2/fd2b88de269747c1acb01929c45131d0.png"></a> <br><br>  As soon as we start walking through the well-known Tango area, then we actually get two different trajectories that occur simultaneously: <br><br><ul><li>  The path you follow ("The real trajectory") </li><li>  Path calculated by the device ("Calculated Path") </li></ul><br>  The green line is the real trajectory along which the device moves in real space;  the red line shows how, over time, the calculated trajectory has moved away from the real trajectory.  When the device returns to the origin and realizes that it has already seen this area before, it corrects drift errors and corrects the calculated trajectory to better match the real trajectory. <br><br>  Without drift correction, a game or an application using virtual 3D space in accordance with the real world may encounter inaccuracy in tracking movement after prolonged use.  For example, if a door in the game world corresponds to a door frame in the real world, then errors can cause the door to appear in the game in the wall, and not in the real door frame. <br><br>  <em>Localization</em> <br><br>  After we have passed through the area you need with area learning enabled, we can save in the Area Description File (ADF) what the device "saw." <br><br>  Exploring the area and loading it as an ADF has several advantages.  For example, you can use it to align the device‚Äôs coordinate system with a previously existing coordinate system so that you always appear in the same physical place in a game or application.  The image below shows the search cycle known to the device area. <br><br> <a href="https://developers.google.com/tango/ux/ux-best-practices"><img src="https://habrastorage.org/files/84f/634/2ec/84f6342ec538402397a04a797f3f8bfc.png"></a> <br><br>  There are two ways to create an ADF.  The easiest way to use the application is <a href="https://developers.google.com/tango/tools/explorer">TangoExplorer</a> , and then your application loads the resulting ADF. <br><br> <a href="https://developers.google.com/tango/tools/explorer"><img src="https://habrastorage.org/files/a74/882/c9a/a74882c9aa2c42c99aab2216c148e189.png"></a> <br><br>  We can also use the Tango API to explore the space, save and load the ADF within our application. <br><br>  It should be noted a number of features that should be remembered when using area learning: <br><br><ul><li>  Tango depends on the visual diversity of the area we are going to localize.  If we are in a building with many identical rooms or in a completely empty room with empty walls, it will be difficult for the device to localize itself. <br><br></li><li>  The environment may look completely different from different points of view and positions, and may also change over time (furniture can be moved, lighting will vary depending on the time of day).  Localization is more likely to succeed if localization conditions are similar to those that existed when the ADF was created. <br><br></li><li>  As the environment changes, we can create multiple ADFs for the same physical location under different conditions.  This gives our users the ability to select the file that most closely matches their current conditions.  You can also add multiple sessions to a single ADF to capture visual descriptions of the environment from each position, angle, and with each change in lighting or a change in environment. <br><br></li></ul><br><img src="https://habrastorage.org/files/826/df9/f11/826df9f11e3540cf9168e4e856bd2cbf.png" align="right">  <strong>Depth perception</strong> <br><br>  With this technology, the device can understand the shape of our environment.  This allows you to create "augmented reality", where virtual objects are not only part of our real environment, they can also interact with this environment.  For example, many are already predicting computer games in real space. <br><br> <a href="http://venturebeat.com/2016/01/07/googles-project-tango-will-enable-cool-augmented-reality-games/"><img src="https://habrastorage.org/files/180/78b/872/18078b872b8148bfbf7b5f3acefd5509.png"></a> <br><br>  Tango API provides data on the distance to objects that the camera shoots in the form of a cloud of points.  This format gives (x, y, z) coordinates to the maximum number of points in the scene that can be calculated. <br><br> <a href="https://developers.google.com/tango/overview/depth-perception"><img src="https://habrastorage.org/files/4db/48b/d93/4db48bd93ce44befbddc1a0138be4dd6.png"></a> <br><br>  Each measurement is a floating point value that records the position of each point in meters in the camera's reference system of the scanning depth scene.  A point cloud is associated with color information obtained from an RGB camera.  This association gives us the opportunity to use Tango as a 3D scanner and opens up many interesting opportunities for game developers and creative applications.  Of course, the degree of scanning accuracy cannot be compared with special 3D scanners that give accuracy in fractions of a millimeter.  According to the experience of <a href="https://habrahabr.ru/company/intel/blog/269253/">colleagues, the</a> maximum accuracy of Intel RealSense R200 (used in the Tango) is 2 millimeters, but it can be much worse, because  strongly depends on the distance to the subject, on the shooting conditions, on the reflective properties of the surface, on the movement.  You also need to understand that increasing the accuracy of the image depth leads to an increase in noise in the signal, it is inevitable. <br><br>  However, it should be noted that for the construction of collisions in the game, the placement of virtual furniture in a real apartment, measuring the distances of the current accuracy of the resulting 3D cloud of points is quite enough. <br><br> <a href="http://www.telegraph.co.uk/technology/google/11391989/What-is-Googles-Project-Tango.html"><img src="https://habrastorage.org/files/7b0/f9d/5d6/7b0f9d5d6abf4860bdde6c322bd3f5b4.png"></a> <br><br>  To implement depth perception, we can choose one of the most common depth perception technologies.  Recall that Tango is a platform and includes 3 technologies. <br><br> <a href="http://mesh.brown.edu/3dpgp-2009/homework/hw2/hw2.html"><img src="https://habrastorage.org/files/352/bd3/9c1/352bd39c185d41b3ade642f916e6536c.png"></a> <br><br>  A description of each of them is a topic for a separate large article.  Let's go over them briefly, so that there is an understanding of their role in Tango and the general principles of their functioning. <br><br>  <em>Structured Light</em> <br><br>  Structured light projects a known pattern (usually a grid or horizontal stripes) onto real objects.  Thus, the deformation of this known pattern when applied to the surface allows the computer vision system to obtain information about the depth and surface of objects in the scene relative to the device.  A well-known example of using structured light is 3D scanners. <br><br><img src="https://habrastorage.org/files/f84/bf9/338/f84bf93387474572b847b30616f83e83.png"><br><br>  Invisible structured light is used when the visible pattern interferes with other computer vision methods used in the system.  This is the case of the Tango, which uses an infrared emitter. <br><br>  <em>Time of flight</em> <br><br>  This technology is based on determining the time it takes infrared radiation to fly from the radiation source to the object and return to the camera.  The farther the distance to the surface, the longer it takes. <br><br> <a href="http://www.baslerweb.com/en/products/cameras/3d-cameras/time-of-flight-camera"><img src="https://habrastorage.org/files/d75/651/ae7/d75651ae754240e2814b5ec112543b6e.png"></a> <br><br>  <em>Stereo</em> <br><br>  We did not find accurate information on how this technology works in Tango.  Apparently the implementation is quite standard and the developers did not dwell on this.  At one time, 2 snapshots are taken, the so-called stereo pair.  Based on them, using photogrammetry, the distance to the surfaces is determined.  Thus, for example, satellite imagery of the height of the terrain of the Earth. <br><br> <a href="http://www.geog.ucsb.edu/~jeff/115a/lectures/stereoscopy_and_height_measurement.html"><img src="https://habrastorage.org/files/b05/929/a39/b05929a394c44337b8e98607f99b272d.png"></a> <br><br>  It is important to keep in mind that Structured Light and Time of Flight require the device to have both an infrared (IR) emitter and an IR camera.  Stereo technology is enough 2x cameras and does not require an infrared emitter. <br><br>  Note that the current devices are actually designed to work indoors at moderate distances to the scanned object (from 0.5 to 4 meters).  This configuration provides a fairly large depth at an average distance, while not imposing excessive power requirements for the IR emitter and the performance of the device itself in the processing depth.  For this reason, do not count on scanning very close objects and recognizing gestures. <br><br>  It should be remembered that for a device that perceives depth with the help of an infrared camera, there are some situations where accurate work is difficult. <br><br><ul><li>  When moving too fast, Tango may not have time to build depth and politely asks to move more slowly. <br><br><img src="https://habrastorage.org/files/b7e/6d7/eae/b7e6d7eae7834de1a15cc100f2f07674.png"></li><li>  When moving too fast, Tango may not have time to build depth and politely asks to move more slowly. <br><br><img src="https://habrastorage.org/files/ae8/f82/cc5/ae8f82cc51a6412db53c8313481d4654.png"></li><li>  When moving too fast, Tango may not have time to build depth and politely asks to move more slowly. <br><br><img src="https://habrastorage.org/files/028/99c/181/02899c1812b840f8b9b70570a6154c5f.png"><br></li></ul><br><h2>  Our project with Tango </h2><br>  We reviewed the principles of operation of the device in sufficient detail.  Now let's move from theory to practice.  Let's try to create our first project. <br><br>  Tango provides an SDK for the Unity3D game engine and supports OpenGL and other 3D systems via C or Java.  We use in the work basically Unity3D and all examples will be created further in his development environment. <br><br>  <strong>Integration with unity3D</strong> <br><br>  To develop applications in Unity3D for Project Tango, we need: <br><br><ul><li>  Installed <a href="http://developer.android.com/sdk/index.html">Android SDK</a> 17+ <br></li><li>  <a href="http://unity3d.com/unity/download">Unity</a> (5.2.1 or higher), with an environment tuned for <a href="http://docs.unity3d.com/Manual/android-sdksetup.html">Android</a> development. <br></li><li>  <a href="https://developers.google.com/tango/downloads">Tango Unity SDK</a> . <br></li><li>  For Windows, you should install the <a href="http://developer.android.com/sdk/win-usb.html">Google USB Driver</a> if the device was not automatically recognized. <br></li></ul><br>  <strong>Project Description</strong> <br><br>  We decided to implement the arrangement of miniatures of military equipment using Tango.  The following was not planned intricate sequence of actions: <br><br><ul><li>  The user picks up the Tango tablet; <br></li><li>  On the screen in places where it is possible to place the technique - a green marker is drawn, where it is impossible - a red one: <br></li><li>  The following selection of military equipment is offered: <br></li><li>  The placed equipment can be moved in the plane of the screen using the touch interface, and it will move along the physical surface. <br></li><li>  You can remove the placed technique. <br></li><li>  A restriction has been introduced - 10 placed copies of the equipment, with sufficient optimization of the models, this number can be increased.  If there are more than 10 models, then the very first placed model is replaced and further along the cycle. <br></li></ul><br>  The interface for the demo decided to make it minimalist, but understandable for the user. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/935/3df/34a/9353df34a8445e3d9d3a921082b23bca.png"><br><br>  <strong>Implementation</strong> <br><br>  As a basis, we took resources from TangoSDK / Examples / AugmentedReality with <a href="https://github.com/googlesamples/tango-examples-unity">github</a> and our models from an already <a href="https://play.google.com/store/apps/details%3Fid%3Dcom.vizerra.vdnh9may%26hl%3Dru">implemented project.</a> <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e85/126/9ce/e851269ce1e35b8324d45357037d52a0.png"><br><br>  <b>Implementation description</b> <br><br>  In order to realize our plans, we will describe our actions in steps: <br><br>  - Displaying the image from the camera of the device on the screen, this will help us Tango AR Camera <br><br><img src="https://habrastorage.org/getpro/habr/post_images/fba/89d/e85/fba89de85c70d8e9ecebfd04654d1c64.png"><br><br>  - Next, you need to ensure that the real movement of the device in the virtual scene is repeated.     Motion Tracking       <em>Tango Application</em> ,   <em>Enable Motion Tracking</em> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/792/396/6ea/7923966ead6826e15087592ae2fb8a27.png"><br><br>    ,        ,     ,  ,    ,   .  Tango    <b>Tango Point Cloud</b> ,     . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/33b/3a0/489/33b3a0489b4255c356afff52a818217a.png"><br><br> ‚Äî        : <br><br><img src="https://habrastorage.org/getpro/habr/post_images/01f/a63/ec2/01fa63ec2fa9c8566126a96d90368604.png"><br><br><ol><li>   ,       ‚Äî  UI,       EventSystem. <br><br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We also need to provide data directly to the model of technology. </font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We placed the objects in the scene, in the Prefabs object.</font></font></font></font><br><br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> We have added a script to each button. </font></font></font></font><br><br><pre><script type="text/javascript">function gtElInit() {var lib = new google.translate.TranslateService();lib.translatePage('ru', 'en', function () {});}</script><script type="text/javascript" src="https://translate.google.com/translate_a/element.js?cb=gtElInit&amp;client=wt"></script><code class="hljs">ViecleSpawnScript</code> </pre> <br>  and made a link in the script to the model.  Now our buttons ‚Äúknow‚Äù which model is connected with them. <br><br>  - Now we need to implement the logic that allows you to arrange objects, move them, delete.  We implemented logic in the classroom. <br><br><pre> <code class="hljs">VehicleSpawnRoot</code> </pre><br>  Below you can see its settings: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/620/909/5be/6209095beeb5802398ef0d9c0e27f110.png"><br><br>  <i><b>Instances Limit</b></i> - the maximum number of placed models; <br>  <i><b>Model Scale</b></i> - the scale of the models with the arrangement; <br>  <i><b>Point Cloud</b></i> - link to the Tango Point Cloud object; <br>  <i><b>Placing Mark</b></i> - a link to the marker prefab; <br>  <i><b>Trace Layer Mask</b></i> - setting up layers for which placement is possible; <br>  <i><b>Selection Info</b></i> - a link to an interface element for displaying the name of a vehicle that has been selected. <br><br>  - Our application must constantly draw a marker in the course of its work, the marker will normally be located where the beam ends from the center of the screen to the surface.  The marker is represented by an object in the <b>PlacementMarker</b> scene. <br><br>  - We need to have data - the point of intersection of the beam and the result of the intersection.  Getting the coordinates and the result of the trace we did through asynchronous receiving, launched Coroutine with the function <br><br><pre> <code class="hljs">LazyUpdate</code> </pre> <br>  In this function, the definition of the intersection of the beam with a point cloud cloud Point Tango.  Point Cloud Tango rebuilds Tango itself, so we have a current point cloud and can take data from it. <br></li></ol><br>  The result of the trace can have the following values: <br><br><pre> <code class="hljs ruby">enum ETraceResults { Invalid, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>    NotFound, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>   ,       NotGround, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>     . ExistingObjectCrossing, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>        Valid, <span class="hljs-regexp"><span class="hljs-regexp">//</span></span>     } &lt;ol&gt; &lt;li&gt;</code> </pre> <br>  To model by pressing the button was put on the surface in the class: <br><br><pre> <code class="hljs">VehicleSpawnRoot</code> </pre> <br>  create a function: <br><br><pre> <code class="hljs cs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Spawn</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params"> GameObject prefab </span></span></span><span class="hljs-function">)</span></span></code> </pre> <br>  A prefab with a model for placement is passed to the function.  The function checks the possibility of placement and, if successful, creates a model in the specified coordinates. <br><br>  - We need to create a functional for the possibility of moving the placed model.  The function is responsible for moving the model: <br><br><pre> <code class="hljs cs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UpdateTouchesMove</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span></code> </pre> <br>  We briefly describe how it works: in the function, we get the touch data through <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">Input</span></span>.GetTouch( <span class="hljs-number"><span class="hljs-number">0</span></span> );</code> </pre> <br>  We are looking for the intersection with spaced objects in the scene, and in case of success we mark the object as: <br><br><pre> <code class="hljs">Selected</code> </pre> <br>  We also send to the function of calculating the intersection with the point cloud the position of the beginning of the beam, it will coincide with the position of the finger on the screen. <br><br>  Further, in the process of moving around the screen, the model is set to a new position, if the result of the trace allows you to do this, I remind you, the trace is done in the asynchronous method <br><br><pre> <code class="hljs">LazyUpdate</code> </pre> <br>  It remains to add a function to delete the placed models.  In general, everything is ready, you can run! <br><br>  More information can be found with the project code on <a href="https://github.com/VIZERRA/TangoDemo">gitHub</a> . <br><br><h2>  Publish app to google play </h2><br>  Publishing apps that use the Tango framework requires one additional step in addition to the standard Android publishing process.  In order for the application to be installed only on Tango compatible devices, you must add the following lines to the application manifest file. <br><br><pre> <code class="hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">application</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">...</span></span></span><span class="hljs-tag">&gt;</span></span> ... <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-library</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.vizerra.tangolab"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:required</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"true"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">application</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  If you want to get a single APK for devices with Tango support and without it, then you can determine in Tango the availability of Tango features and use their capabilities in the application itself. <br><br><h2>  Summary </h2><br>  So we went along with you from theoretical foundations to the publication of the application. <br>  It can be safely concluded that the platform can already be used for commercial purposes.  It works quite stable.  The technologies included in it do not conflict with each other and complement each other well, solving the stated problems. <br><br>  In addition, commercial devices began to go with large <a href="http://shop.lenovo.com/us/en/tango/">vendors</a> .  The only fly in the big barrel of honey is a problem when the device is operating in bright light.  I'd like to believe that Google and Intel will solve this problem in the coming years or maybe they are already solving it.  Thank you for your attention and we hope that the article was interesting for you. </div><p>Source: <a href="https://habr.com/ru/post/309876/">https://habr.com/ru/post/309876/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../309864/index.html">Job Schneiders, NTT: ‚ÄúLarge BGP Communities ‚Äî A Solution to the Routing Problem between AS Operators‚Äù</a></li>
<li><a href="../309866/index.html">5 ideas on game analytics</a></li>
<li><a href="../309870/index.html">Google Tango: control the robot in augmented reality mode</a></li>
<li><a href="../309872/index.html">Eddystone beacons to control power consumption</a></li>
<li><a href="../309874/index.html">Business Development for SaaS Services: Strategy Design Design</a></li>
<li><a href="../309878/index.html">How to understand that Agile works</a></li>
<li><a href="../309880/index.html">How we developed the game, where there are no fixed rules</a></li>
<li><a href="../309882/index.html">Using Android device as a thin UI for C ++ programs</a></li>
<li><a href="../309884/index.html">The developer who lives on the roof: chronicles of the past PDUG Picnic</a></li>
<li><a href="../309888/index.html">Key skills of a successful Agile team or how to make Agile work?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>