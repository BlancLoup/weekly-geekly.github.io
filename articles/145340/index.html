<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>AngelScript</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 In the process of reviewing LUA and Python, I singled out for myself that LUA is fast enough, but with a slightly unusual syntax. Pytho...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>AngelScript</h1><div class="post__text post__text-html js-mediator-article"><h4>  Introduction </h4><br>  In the process of reviewing LUA and Python, I singled out for myself that LUA is fast enough, but with a slightly unusual syntax.  Python, on the other hand, has a very simple syntax and a lot of useful libraries, but, unfortunately, it turned out to be rather slow, and it is rather difficult to bind to C ++.  And here at work I was told to use AngelScript, they say, it is convenient for a bunch, faster than LUA and has a C-like syntax.  As soon as I began to study it, I realized that this is the very scripting language of my dream. <br><br><h4>  Preview </h4><br>  Here is what you can read about this language on Wikipedia: <br><br>  <strong>AngelScript</strong> is an engine in which an application can register functions, properties and types that can be used in scripts.  Scripts are compiled into modules.  The number of modules used varies according to needs.  An application can also use different interfaces for each module using configuration groups.  This is especially useful when the application works with several types of scripts, for example, GUI, AI, etc. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The ‚ÄúHello, world‚Äù program in the simplest case looks like this: <br><br><pre><code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ print(<span class="hljs-string"><span class="hljs-string">"Hello world\n"</span></span>); }</code> </pre> <br><a name="habracut"></a><br>  Yes, the syntax of the language pleases from the very beginning.  The language supports both functional programming methods and OOP.  From the very beginning, it impresses with its simplicity of registering functions, variables, types. <br><br>  For example, registering a global variable: <br><br><pre> <code class="cpp hljs">g_Engine-&gt;RegisterGlobalProperty(<span class="hljs-string"><span class="hljs-string">"int SomeVal"</span></span>,&amp;SomeVal);</code> </pre> <br><br>  where SomeVal is a variable of type int. <br><br>  Register global function: <br><pre> <code class="cpp hljs">g_Engine-&gt;RegisterGlobalFunction(<span class="hljs-string"><span class="hljs-string">"void Print(string val)"</span></span>, asFUNCTION(Print), asCALL_CDECL); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Print</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-built_in"><span class="hljs-function"><span class="hljs-params"><span class="hljs-built_in">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> val)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-built_in"><span class="hljs-built_in">cout</span></span>&lt;&lt;val.data(); }</code> </pre><br><br>  Yes, for AngelScript it is not necessary to write binding functions, which is a huge plus in comparison with other languages.  To register your types you have to write a couple of functions.  A factory for creating instances and a reference counter, for the Type-reference type, and constructor and destructor calls, for an object of the Type-Value type. <br><br>  For example, we have a class float3, which we would like to register. <br><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//    class RefC { private: int refC; public: RefC(){refC=1;} void AddRef(){refC++;} void Release() { if(!--refC) delete this; } }; // ,     class float3:public RefC { public: float x; float y; float z; float3(){x=y=z=0;} void Normalize() { float Len=sqrt(x*x+y*y+z*z); Len=Len?Len:1; x/=Len; y/=Len; z/=Len; } } //  float3* Float3FactoryE() { return new float3(); } //     void PrintF3(float3* val) { cout&lt;&lt;"x="&lt;&lt;val-&gt;x&lt;&lt;",y="&lt;&lt;val-&gt;y&lt;&lt;",z="&lt;&lt;val-&gt;z; }</span></span></code> </pre><br><br>  To do this, we register the object as a Type-reference and indicate to it a factory, a reference counter, a method and a function for displaying data on the screen, and this is how it looks. <br><br><pre> <code class="cpp hljs">g_Engine-&gt;RegisterObjectType(<span class="hljs-string"><span class="hljs-string">"float3"</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>,asOBJ_REF); g_Engine-&gt;RegisterObjectMethod(<span class="hljs-string"><span class="hljs-string">"float3"</span></span>,<span class="hljs-string"><span class="hljs-string">" void Normalize()"</span></span>,asMETHOD(float3, Normalize),asCALL_THISCALL); g_Engine-&gt;RegisterObjectBehaviour(<span class="hljs-string"><span class="hljs-string">"float3"</span></span>,asBEHAVE_FACTORY,<span class="hljs-string"><span class="hljs-string">"float3@ new_float3()"</span></span>,asFUNCTION(Float3FactoryE),asCALL_CDECL); g_Engine-&gt;RegisterObjectBehaviour(<span class="hljs-string"><span class="hljs-string">"float3"</span></span>,asBEHAVE_ADDREF,<span class="hljs-string"><span class="hljs-string">"void AddRef()"</span></span>,asMETHOD(float3,AddRef),asCALL_THISCALL); g_Engine-&gt;RegisterObjectBehaviour(<span class="hljs-string"><span class="hljs-string">"float3"</span></span>,asBEHAVE_RELEASE,<span class="hljs-string"><span class="hljs-string">"void Release()"</span></span>,asMETHOD(float3,Release),asCALL_THISCALL); g_Engine-&gt;RegisterGlobalFunction(<span class="hljs-string"><span class="hljs-string">"void Print(float3@ val)"</span></span>,asFUNCTION(PrintF3),asCALL_CDECL);</code> </pre><br><br>  Of course, we will not stop on this, since we need access to the xyz values, so we must also register them, which we do by writing. <br><pre> <code class="cpp hljs">g_Engine-&gt;RegisterObjectProperty(<span class="hljs-string"><span class="hljs-string">"float3"</span></span>,<span class="hljs-string"><span class="hljs-string">"float x"</span></span>,offsetof(float3,x)); g_Engine-&gt;RegisterObjectProperty(<span class="hljs-string"><span class="hljs-string">"float3"</span></span>,<span class="hljs-string"><span class="hljs-string">"float y"</span></span>,offsetof(float3,y)); g_Engine-&gt;RegisterObjectProperty(<span class="hljs-string"><span class="hljs-string">"float3"</span></span>,<span class="hljs-string"><span class="hljs-string">"float z"</span></span>,offsetof(float3,z));</code> </pre><br><br>  Everything is very simple and clear.  Now you can write in the script <br><pre> <code class="cpp hljs">float3@ ObjPos; ObjPos.x=<span class="hljs-number"><span class="hljs-number">1</span></span>; ObjPos.y=<span class="hljs-number"><span class="hljs-number">2</span></span>; ObjPos.z=<span class="hljs-number"><span class="hljs-number">3</span></span>; ObjPos.Normalize(); Print( ObjPos );</code> </pre><br><br>  After executing this script, we will see on the screen the value of the normalized vector. <br><br><h4>  Features </h4><br><br>  I was very pleased with the possibility of operator overloading in AngelScript.  In C ++, there is an operator keyword and an operator symbol for this.  AngelScript uses certain functions for this. <br><br>  ¬¶ - opNeg <br>  ¬¶ ~ opCom <br>  ¬¶ ++ opPreInc <br>  ¬¶ - opPreDec <br>  ¬¶ ++ opPostInc <br>  ¬¶ - opPostDec <br>  ¬¶ == opEquals <br>  ¬¶! = OpEquals <br>  ¬¶ &lt;opCmp <br>  ¬¶ &lt;= opCmp <br>  ¬¶&gt; opCmp <br>  ¬¶&gt; = opCmp <br>  ¬¶ = opAssign <br>  ¬¶ + = opAddAssign <br>  ¬¶ - = opSubAssign <br>  ¬¶ * = opMulAssign <br>  ¬¶ / = opDivAssign <br>  ¬¶ &amp; = opAndAssign <br>  ¬¶ | = opOrAssign <br>  ¬¶ ^ = opXorAssign <br>  ¬¶% = opModAssign <br>  ¬¶ &lt;&lt; = opShlAssign <br>  ¬¶ &gt;&gt; = opShrAssign <br>  ¬¶ &gt;&gt;&gt; = opUShrAssign <br>  ¬¶ + opAdd opAdd_r <br>  ¬¶ - opSub opSub_r <br>  ¬¶ * opMul opMul_r <br>  ¬¶ / opDiv opDiv_r <br>  ¬¶% opMod opMod_r <br>  ¬¶ &amp; opAnd opAnd_r <br>  ¬¶ |  opOr opOr_r <br>  ¬¶ ^ opXor opXor_r <br>  ¬¶ &lt;&lt; opShl opShl_r <br>  ¬¶ &gt;&gt; opShr opShr_r <br>  ¬¶ &gt;&gt;&gt; opUShr opUShr_r <br>  ¬¶ [] opIndex <br><br>  Suppose we want to make it possible for our vector to support the addition of another vector to itself, for this we slightly modify our class. <br><br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">float3</span></span></span><span class="hljs-class">:</span></span><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> RefC { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> x; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> y; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> z; float3(){x=y=z=<span class="hljs-number"><span class="hljs-number">0</span></span>;} <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Normalize</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> Len=<span class="hljs-built_in"><span class="hljs-built_in">sqrt</span></span>(x*x+y*y+z*z); Len=Len?Len:<span class="hljs-number"><span class="hljs-number">1</span></span>; x/=Len; y/=Len; z/=Len; } float3* <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span>+=(float3* _rval) { x+=_rval-&gt;x; y+=_rval-&gt;y; z+=_rval-&gt;z; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>-&gt;AddRef(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>; } };</code> </pre><br>  Only the registered new method remains. <br><pre> <code class="cpp hljs">g_Engine-&gt;RegisterObjectMethod(<span class="hljs-string"><span class="hljs-string">"float3"</span></span>, <span class="hljs-string"><span class="hljs-string">"float3@ opAddAssign(float3@ _rval)"</span></span>, asMETHOD(float3, <span class="hljs-keyword"><span class="hljs-keyword">operator</span></span>+=), asCALL_THISCALL);</code> </pre><br><br>  And now you can safely write like this: <br><br><pre> <code class="cpp hljs">float3@ ObjPos; ObjPos.x=<span class="hljs-number"><span class="hljs-number">1</span></span>; ObjPos.y=<span class="hljs-number"><span class="hljs-number">2</span></span>; ObjPos.z=<span class="hljs-number"><span class="hljs-number">3</span></span>; float3@ ObjOffset; ObjOffset .x=<span class="hljs-number"><span class="hljs-number">3</span></span>; ObjOffset .y=<span class="hljs-number"><span class="hljs-number">1</span></span>; ObjOffset .z=<span class="hljs-number"><span class="hljs-number">5</span></span>; ObjPos+=ObjOffset ; Print( ObjPos );</code> </pre><br>  and we will see on the screen x = 4, y = 3, z = 8. <br><br>  AngelScript supports properties.  It looks like this: <br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyObj</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-function"><span class="hljs-function">type </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_ValueName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; <span class="hljs-function"><span class="hljs-function">type </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">set_ValueName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(type Val)</span></span></span></span>; } MyObj a; type tmp=a.ValueName;<span class="hljs-comment"><span class="hljs-comment">//  get_ValueName a.ValueName = tmp; //  set_ValueName</span></span></code> </pre><br><br>  Also properties are supported for the index operator: <br><pre> <code class="cpp hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyObj</span></span></span><span class="hljs-class"> {</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">float</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_opIndex</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> idx)</span></span></span><span class="hljs-function"> </span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">set_opIndex</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> idx, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">float</span></span></span></span><span class="hljs-function"><span class="hljs-params"> value)</span></span></span></span>; } MyObj a; <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> val=a[<span class="hljs-number"><span class="hljs-number">1</span></span>];<span class="hljs-comment"><span class="hljs-comment">//  get_opIndex a[2]=val;//  set_opIndex</span></span></code> </pre><br><br><h4>  useful links </h4><br>  Developer site <a href="http://www.angelcode.com/">www.angelcode.com</a> <br>  SVN WIP repository <a href="https://angelscript.svn.sourceforge.net/svnroot/angelscript/trunk">angelscript.svn.sourceforge.net/svnroot/angelscript/trunk</a> <br>  Russian manual <a href="http://13d-labs.com/angelscript_manual/main.html">13d-labs.com/angelscript_manual/main.html</a> <br>  Manual in English <a href="http://www.angelcode.com/angelscript/sdk/docs/manual/index.html">www.angelcode.com/angelscript/sdk/docs/manual/index.html</a> <br>  JIT Compiler <a href="https://github.com/BlindMindStudios/AngelScript-JIT-Compiler">github.com/BlindMindStudios/AngelScript-JIT-Compiler</a> </div><p>Source: <a href="https://habr.com/ru/post/145340/">https://habr.com/ru/post/145340/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../145331/index.html">Hack2own: Opera, no one hacked</a></li>
<li><a href="../145334/index.html">Computex 2012 - the second day</a></li>
<li><a href="../145337/index.html">PHP for Android project</a></li>
<li><a href="../145338/index.html">Torrent stream for ubuntu</a></li>
<li><a href="../145339/index.html">Ruby Open Air (06/16/2012) Minsk</a></li>
<li><a href="../145341/index.html">Mobile web trends and two approaches to building mobile applications</a></li>
<li><a href="../145343/index.html">Plotting on WPF form under .NET Framework 4</a></li>
<li><a href="../145344/index.html">We ask the user to report the fall of the site</a></li>
<li><a href="../145345/index.html">LinkedIn hashes base leaked?</a></li>
<li><a href="../145347/index.html">New Solar Impulse record</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>