<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Means of data collection in computer technical expertise</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this article I will talk about some of the features of the various ways of creating copies (images) of information carriers in computer forensics (...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Means of data collection in computer technical expertise</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/files/14b/aad/774/14baad774101462980f25fa4cf5307d2.png" alt="forensics data acquisition"></p><br><p>  In this article I will talk about some of the features of the various ways of creating copies (images) of information carriers in computer forensics (forsensike).  The article will be useful to employees of information security departments who respond to security incidents and conduct internal investigations.  I hope that forensic experts conducting computer and technical expertise (hereinafter referred to as KTE) will find something new in it. </p><a name="habracut"></a><br><p>  To begin with a quote: </p><br><blockquote>  The author believes (and many researchers agree with this) that it is generally undesirable to investigate the original of the carrier during KET.  In order to guarantee that the information remains unchanged, as well as to leave the possibility of a repeated or additional examination, the original must be left untouched.  And all the research carried out with his copy.  This is not only more reliable, but also more convenient, since a copy can be made on a carrier that is better suited for the tools available to the expert, more reliable, faster. <br>  <strong>N.N.</strong>  <strong>Fedotov.</strong>  <strong>Forensic - computer forensics</strong> </blockquote><br><p>  In order for the created image to be forensically reliable, it is necessary, firstly, in the process of creation not to change the contents of the studied carrier, and secondly, after extraction, the image must match the investigated carrier bit by bit.  Such an image will contain not only live files, but also service data, free areas of file systems and areas not partitioned by file systems. </p><br><p>  If you, like an elephant in a china shop, connect the examined media to a normal operating system (OS), then the irreversible happens: in the standard configuration, the OS activates the device immediately after detection, installs file systems and, without asking you, changes its contents.  Windows, for example, without a demand, changes timestamps in file attributes (in some cases), creates hidden Recycle folders, saves configuration information. </p><br><p>  There are two ways to prevent changes to the information on the media: hardware or software. </p><br><h2>  Recording hardware blockers </h2><br><p>  I did not work with hardware solutions, but I will give a little theory from the Internet.  There are <em>record blockers</em> (bridge), through which the studied media are connected to a computer, and there are <em>duplicators</em> that can autonomously create full copies and images of the disks under study. </p><br><p>  <em>The write blockers</em> intercept <em>write</em> commands from the OS and prevent them from being transferred to the storage medium.  When possible, they inform the OS that the device is connected in read-only mode, otherwise the OS just reports write errors.  Some devices use the built-in memory to cache the recorded data and create for the OS the appearance that the data on the disk has really changed. </p><br><p><img src="https://habrastorage.org/files/8b6/06e/b3c/8b606eb3c79a465eb179055334eee8c2.jpg" alt="TD2u Forensic Duplicator"></p><br><p>  Hardware solutions certainly have their advantages, but they also have disadvantages: </p><br><ul><li><p>  They are not cheap.  For example, the T35u record lock has a recommended retail price of $ 349.00, a Tableau TD2u duplicator - $ 1,599.00. </p><br></li><li>  And they are not perfect.  There have been cases where hardware devices have skipped writing commands to a device ( <a href="https://tableau.guidancesoftware.com/index.php%3Fpageid%3Dsupport_notices">example</a> ). </li></ul><br><h2>  Boot disks for computer forensics </h2><br><p>  <a href="http://www.artlebedev.ru/kovodstvo/sections/184/">Software is</a> inevitable in companies with a distributed territorial structure (especially if you do not want to spend half the IT budget on hardware that you may never need).  Software solutions will save you time in case of massive incidents: you can create as many bootable flash drives as you need to investigate computers, and then start creating images on all computers at the same time.  It remains only to determine what software should be on these bootable flash drives. </p><br><h3>  Linux distros </h3><br><p>  You can remove the image with one of the numerous specialized Linux distributions, here are some of them: Rip Linux, DEFT Linux, CAINE, Paladin, Helix, Kali.  In some, you need to choose the mode forensic mode (or something like that) when loading.  Some of these distributions already contain software for image analysis. </p><br><p>  Some problems of the read-only mode for Linux distributions are described <a href="http://www.forensicswiki.org/wiki/Forensic_Live_CD_issues">here</a> .  But the main problem of Linux is the relative difficulty in using, and, as a result, the lack of personnel with sufficient expertise.  In Linux, to capture an image, you will have to use the command line (for example, ftk imager under linux only exists in the console version), where one typo can destroy all the evidence (even if <a href="https://geektimes.ru/post/274364/">this story</a> turned out to be viral advertising, but not just many believed it). </p><br><h3>  Windows boot disks </h3><br><p>  To be able to entrust the creation of an image to any ordinary IT employee, you need to minimize the probability of error.  A special build of Windows Forensic Environment (WinFE), which has a graphical interface in many respects similar to ordinary Windows, while being limited only by necessary functions, copes well with this.  WinFE was created by a computer forensic scientist working at Microsoft.  The build is based on WinPE and works by analogy with ‚Äúforensically sound‚Äù Linux distributions that do not mount partitions during the boot process. </p><br><p><img src="https://habrastorage.org/files/58e/6b3/8d7/58e6b38d7cbf4323913e26a67d0c8dbf.jpg" alt="WinFE Interface"></p><br><p>  Here are a few WinFE strengths: </p><br><ul><li>  You can use Windows forensic applications (portable versions) </li><li>  Most forensic experts are already using Windows. </li><li>  Free (if you have a Windows license) </li><li>  Relatively easy to build and customize. </li><li>  Less opportunity for serious use errors </li></ul><br><p>  The easiest way to build WinFE is a utility from the WinBuilder <a href="http://reboot.pro/files/file/375-mini-winfe/">Mini-WinFE project</a> .  You will need a Windows distribution and software that you want to include in the assembly.  At the output, you will receive an ISO file that can be burned to CD or USB (using <a href="http://rufus.akeo.ie/">Rufus</a> ). </p><br><p>  The main scenario using WinFE: </p><br><ol><li>  Create a bootable WinFE disk. </li><li>  Download WinFE on the analyzed computer. </li><li>  Removing the image of the disks of the investigated computer.  Images are recorded on WinFE media or any other media. </li></ol><br><div class="spoiler">  <b class="spoiler_title">List of software that can be embedded in WinFE</b> <div class="spoiler_text"><p>  Supported applications include - CloneDisk (included) <br>  DMDE (included) <br>  Forensic Acquisition Utilities (included) <br>  FTK Imager (copied from local install) <br>  HWiNFO (included) <br>  LinuxReader (downloaded automatically) <br>  MW Snap (included) <br>  NT Password Edit (included) <br>  Opera (included) <br>  Sumatra PDF Reader (included) <br>  WinHex (copied from local install) <br>  X-Ways Forensics (copied from local install) <br>  Write Protect Tool (included) </p></div></div><br><p>  For the special behavior of WinFE in the procedure for connecting disks, two registry parameters are responsible: </p><br><ul><li>  <em>HKEY_LOCAL_MACHINE \ system \ ControlSet001 \ Services \ MountMgr</em> .  The <em>DWord NoAutoMount</em> parameter is <em>set</em> to <em>1</em> .  After this, the Mount Manager service does not automatically mount any <em>storage device</em> . </li><li>  <em>HKEY_LOCAL_MACHINE \ system \ ControlSet001 \ Services \ partmgr \ Parameters The</em> <em>SanPolicy</em> parameter is <em>set</em> to "3" or "4" depending on the version of Windows. </li></ul><br><p>  There are at least seven versions of WinFE, each available in versions 32 and 64 bits. </p><br><pre><code class="hljs lisp">Windows FE <span class="hljs-number"><span class="hljs-number">2.0</span></span> (<span class="hljs-number"><span class="hljs-number">6.0</span></span>.<span class="hljs-number"><span class="hljs-number">6000</span></span> - Vista) Windows FE <span class="hljs-number"><span class="hljs-number">2.1</span></span> (<span class="hljs-number"><span class="hljs-number">6.0</span></span>.<span class="hljs-number"><span class="hljs-number">6001</span></span> - Vista SP1/Server <span class="hljs-number"><span class="hljs-number">2008</span></span>) Windows FE <span class="hljs-number"><span class="hljs-number">3.0</span></span> (<span class="hljs-number"><span class="hljs-number">6.1</span></span>.<span class="hljs-number"><span class="hljs-number">7600</span></span> - <span class="hljs-number"><span class="hljs-number">7</span></span>/Server <span class="hljs-number"><span class="hljs-number">2008</span></span> R2) Windows FE <span class="hljs-number"><span class="hljs-number">3.1</span></span> (<span class="hljs-number"><span class="hljs-number">6.1</span></span>.<span class="hljs-number"><span class="hljs-number">7601</span></span> - <span class="hljs-number"><span class="hljs-number">7</span></span> SP1/Server <span class="hljs-number"><span class="hljs-number">2008</span></span> R2 SP1) Windows FE <span class="hljs-number"><span class="hljs-number">4.0</span></span> (<span class="hljs-number"><span class="hljs-number">6.2</span></span>.<span class="hljs-number"><span class="hljs-number">9200</span></span> - <span class="hljs-number"><span class="hljs-number">8</span></span>/Server <span class="hljs-number"><span class="hljs-number">2012</span></span>) Windows FE <span class="hljs-number"><span class="hljs-number">5.0</span></span> (<span class="hljs-number"><span class="hljs-number">6.3</span></span>.<span class="hljs-number"><span class="hljs-number">9600</span></span> - <span class="hljs-number"><span class="hljs-number">8.1</span></span>) Windows FE <span class="hljs-number"><span class="hljs-number">5.1</span></span> (<span class="hljs-number"><span class="hljs-number">6.3</span></span>.<span class="hljs-number"><span class="hljs-number">9600</span></span> - <span class="hljs-number"><span class="hljs-number">8.1</span></span> Update <span class="hljs-number"><span class="hljs-number">1</span></span>)</code> </pre> <br><p>  Each version has its own set of features, a <a href="https://technet.microsoft.com/en-us/library/dn293271.aspx">detailed comparison</a> , but I recommend the 32-bit version of Windows FE 5.x (details below). </p><br><p>  So, while booting, WinFE does not mount partitions, but suggests that the user do it himself using the special utility Write Protect Tool (WProtect.exe, by Colin Ramsden).  As the name suggests, this utility prevents writing to disk. </p><br><p><img src="https://habrastorage.org/files/32e/226/787/32e226787e89472787fe7d491d98c663.png" alt="Write Protect Tool Interface" title="Check"></p><br><p>  However, WinFE also had cases of unintentional writing.  It is important that these cases are well studied, refer to older versions of Windows &lt;4.0 and do not affect user data, because  affect only the so-called <em>disk signature</em> - this is 4 bytes in the master boot record (MBR), which Windows adds when you connect the disk, if it has not previously connected to NT-systems.  You can learn more about what a disk signature is in <a href="https://blogs.technet.microsoft.com/markrussinovich/2011/11/06/fixing-disk-signature-collisions/">this article by</a> Mark Russinovich, and <a href="http://reboot.pro/topic/18953-is-winfe-forensically-sound/">this post</a> describes in detail when Windows changes the disk signature. </p><br><p>  The main WinFE blog is now located <a href="http://brettshavers.cc/index.php/brettsblog/tags/tag/winfe">here</a> . </p><br><h2>  Image creation </h2><br><p>  After we have downloaded our trusted OS, you can start creating an image.  The yellow jersey of the leader is in E01 (Encase) format and there are several reasons for this: </p><br><ul><li>  recognized by experts format - this is important if it comes to court. </li><li>  Most forensic utilities have support for this format ‚Äî you will not have to convert an image during the analysis phase. </li><li>  arbitrary compression ratio - it depends on the final size and the time required to create an image, you can choose the desired degree depending on the situation. </li><li>  arbitrary fragment size ‚Äî so that it is convenient to copy the image over the network or save the image on FAT32 file systems, you can split the image into 4000 MB fragments. </li><li>  service fields in which you can save various data (for example, the name of the expert who performs the image removal, the time difference on the examined computer with the actual time, the serial number of the disk from which the image is taken, etc.). </li><li>  integrity control - at the creation stage, the checksum of the image is calculated. </li></ul><br><p>  To create an image in E01 format, it is best to use the time-tested and free <a href="">FTK Imager Lite</a> , which can be included in the WinFE boot disk.  By the way, there is not much point in using the Use AD Encryption function (image protection with a password), since  This protection is easily removed. </p><br><h2>  Conclusion </h2><br><p>  A must-have for those who don‚Äôt have time to read this article: use the WinFE bundled with FTK Imager Lite and save the image in E01 format to capture the image from the computer under investigation. </p><br><p>  PS Outside this article there are tools for flash memory drives ( <a href="https://habrahabr.ru/post/115384/">Flash memory: problems for computer forensics</a> , <a href="https://habrahabr.ru/post/115349/">Erase cannot be recovered</a> ), as well as tools for removing the memory dump from a running system. </p><br><p>  If Habra is interested, then I will talk about how you can analyze the images obtained using open source software. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/283036/">https://habr.com/ru/post/283036/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../283022/index.html">Developers lazy to the edge?</a></li>
<li><a href="../283024/index.html">We delegate the right to restore virtual machines, files and application objects using Enterprise Manager</a></li>
<li><a href="../283026/index.html">How to replace ELK for viewing logs?</a></li>
<li><a href="../283028/index.html">Squid's serious proxy vulnerability can ‚Äúpoison cache‚Äù</a></li>
<li><a href="../283030/index.html">Once again on minimizing boolean functions</a></li>
<li><a href="../283038/index.html">Performance without event loop</a></li>
<li><a href="../283042/index.html">Towards Full Typing with TypeScript, Swashbuckle, and AutoRest</a></li>
<li><a href="../283044/index.html">How data centers are changing right now: Energy efficiency, data storage and the "clouds"</a></li>
<li><a href="../283046/index.html">Explanation of limitations of the demo version of PVS-Studio</a></li>
<li><a href="../283050/index.html">Creating RESTful services on Meteor</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>