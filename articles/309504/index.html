<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We write, collect and run HelloWorld for Android in Notepad. Java 8 and Android N</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Two and a half years ago, I published an article Writing, Collecting, and Running HelloWorld for Android in Notepad . She became very popular and gain...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We write, collect and run HelloWorld for Android in Notepad. Java 8 and Android N</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/files/a0b/9ab/7d7/a0b9ab7d773e46a2acef4fbed3d6a63a.png"></div><br>  Two and a half years ago, I published an article <a href="https://habrahabr.ru/post/210584/">Writing, Collecting, and Running HelloWorld for Android in Notepad</a> .  She became very popular and gained about 80,000 views.  With the advent of new tools, such as <b>Jack ToolChain</b> , it became necessary to <b>reprint and update the article</b> . <br><br>  When I started learning Android, I wanted to <b>completely write and compile an Android application manually</b> - without using an IDE.  However, this task proved to be difficult and took me quite a lot of time.  But as it turned out - this approach has <b>brought great benefits</b> and clarified many subtleties that hide the IDE. <br><br>  <b>Using only a notebook</b> , we will write a very small educational Android application.  And then compile it, build and run on the device - and all through the command line.  Interested?  Then I ask. <br><a name="habracut"></a><br><h2>  Introduction </h2><br>  I was amazed at how complex and confusing the template application in Android Studio is.  It is simply piled up with resources.  And to a lesser extent - code and scripts.  Although all it has to do is display HelloWorld!  In addition, the books and manuals that I have reviewed explain how to create an IDEA or eclipse HelloWorld using dialog boxes - and further narrative is already coming from it.  And what happens "under the hood" - it remains only to guess. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      We will create our own template project, which is ideal to use for educational purposes.  There will be nothing superfluous, only all the most necessary.  And then we will analyze in detail how to assemble and run it on your Android device.  At the end of the article there will be a link to download the archive with the final project - if you have any questions, you can check it out. <br><br>  Thus, you will be 100% aware and understand the composition of your project and the process of its assembly.  Although this test project is designed for training, with a little refinement it can be used as a solid foundation for your real projects. <br><br><h2>  Training </h2><br>  First we need to download and install command line tools.  The link to download them is at the bottom of the page dedicated to Android Studio ( <a href="https://developer.android.com/studio/index.html">https://developer.android.com/studio/index.html</a> ). <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/fd1/0f1/c36/fd10f1c365054093b97a32d2c77ef2c3.png"></div><br>  Android SDK 24 is just Android <u>N</u> ( <u>N</u> ougat / 7).  We accept the conditions, download the installer, run it.  Leave everything by default.  It will be installed in the <i>C: \ Users \ kciray \ AppData \ Local \ Android \ android-sdk directory</i> .  Remember this path, there will be our main tools. <br><br>  Next, run the SDK Manager (from the <b>android-sdk</b> folder) and also install the default set.  It has everything you need, including the new Jack compiler.  You will also need <a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">JDK 8</a> . <br><br>  <b>The main requirement before reading this article</b> is that in addition to the installed software, you should already be able to run the Helloworld that comes with Eclipse or Android Studio on your device.  Those.  you must have a usb driver configured, usb debugging enabled on your device, etc ... Or, an emulator is created and configured.  These are very basic things, and their consideration is beyond the scope of this article - there is enough information on the net.  By the way, reading a couple of chapters from books will also not be superfluous - at least to understand how the manifest works, resources, and indeed the basics of the Java language.  And in this article I will describe what the books are silent about. <br><br><h2>  Writing a project </h2><br>  To get started, create some folder where your project will be.  <b>Let's</b> call it <b>testapp</b> .  In it, create 3 more folders - <b>bin</b> , <b>res</b> and <b>src</b> . <br><br>  Create a blank text file in <b>testapp</b> and change its name to <b>AndroidManifest.xml</b> . <br><br>  Add the following to it: <br><br><pre><code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">manifest</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:android</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://schemas.android.com/apk/res/android"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">package</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"com.example.testapp"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">uses-sdk</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:targetSdkVersion</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"24"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">application</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:label</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"TestApp"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">".MainActivity"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.action.MAIN"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">category</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">android:name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"android.intent.category.LAUNCHER"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">intent-filter</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">activity</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">application</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">manifest</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  It's simple.  We intend to make an application named <b>TestApp</b> , which at startup starts the <b>MainActivity</b> class.  It remains only to write this small class - and the application is ready.  If necessary, edit the <i>android: targetSdkVersion</i> property in the <i>uses-sdk</i> <i>tag</i> ‚Äî <i>install</i> the version that you have. <br><br>  Next - create a simple resource - the string <i>Hello test app</i> .  In fact, we could do without a resource by inserting this line directly into Java code.  But some assembly steps work with resources, and in order to see interesting moments we will work with them. <br><br>  Let's create in the <b>res</b> folder the <b>values</b> folder.  All resources should be divided into folders.  Next, we will create an empty <b>strings.xml</b> file in it, and in it we will write: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">resources</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"hello"</span></span></span><span class="hljs-tag">&gt;</span></span>Hello test app!<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">resources</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  That's all the resources we need.  Simple, isn't it?  Next, we will create a <b>com</b> folder inside <b>src</b> , an <b>example</b> folder in it, then a <b>testapp</b> folder even lower down the hierarchy - and then our class is <b>MainActivity.java</b> .  Add there code: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.example.testapp; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.app.Activity; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.app.AlertDialog; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.os.Bundle; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.Button; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> android.widget.Toast; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MainActivity</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Activity</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onCreate</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bundle savedInstanceState)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onCreate(savedInstanceState); Button button = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Button(<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>); button.setText(<span class="hljs-string"><span class="hljs-string">"Big button"</span></span>); button.setOnClickListener(v -&gt; { <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> AlertDialog.Builder(MainActivity.<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>) .setTitle(<span class="hljs-string"><span class="hljs-string">"From lambda"</span></span>) .setMessage(getString(R.string.hello)) .show(); }); setContentView(button); } }</code> </pre> <br>  This is the simplest Activity that contains one button for the whole screen.  Clicking this button brings up a dialog box that shows a row of resources.  Pay attention to the lambda (construction <b>v -&gt; {...}</b> ).  Jack ToolChain allows us to use many features of Java 8 under the android.  You can read more on <a href="https://developer.android.com/guide/platform/j8-jack.html%3Fhl%3Dru">developer.android.com</a> and <a href="http://source.android.com/source/jack.html">source.android.com</a> . <br><br>  The directory structure should get this <br><br><pre> <code class="hljs pgsql">‚îÇ AndroidManifest.xml ‚îú‚îÄ‚îÄ‚îÄbin ‚îú‚îÄ‚îÄ‚îÄres ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ<span class="hljs-keyword"><span class="hljs-keyword">values</span></span> ‚îÇ strings.xml ‚îÇ ‚îî‚îÄ‚îÄ‚îÄsrc ‚îî‚îÄ‚îÄ‚îÄcom ‚îî‚îÄ‚îÄ‚îÄexample ‚îî‚îÄ‚îÄ‚îÄtestapp MainActivity.java</code> </pre> <br>  And this is actually all that we needed for the simplest project.  For comparison - <br><br><div class="spoiler">  <b class="spoiler_title">HelloWorld from Android Studio (2.1.3)</b> <div class="spoiler_text"><pre> <code class="hljs css">‚îÇ <span class="hljs-selector-class"><span class="hljs-selector-class">.gitignore</span></span> ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">build</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.gradle</span></span> ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">gradle</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.properties</span></span> ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">gradlew</span></span> ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">gradlew</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.bat</span></span> ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">local</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.properties</span></span> ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">MyApplication2</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.iml</span></span> ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">settings</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.gradle</span></span> ‚îÇ ‚îú‚îÄ‚îÄ‚îÄ<span class="hljs-selector-class"><span class="hljs-selector-class">.gradle</span></span> ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ2<span class="hljs-selector-class"><span class="hljs-selector-class">.14</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.1</span></span> ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ<span class="hljs-selector-tag"><span class="hljs-selector-tag">taskArtifacts</span></span> ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">cache</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.properties</span></span> ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">cache</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.properties</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.lock</span></span> ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">fileHashes</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.bin</span></span> ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">fileSnapshots</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.bin</span></span> ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">fileSnapshotsToTreeSnapshotsIndex</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.bin</span></span> ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">taskArtifacts</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.bin</span></span> ‚îÇ ‚îú‚îÄ‚îÄ‚îÄ<span class="hljs-selector-class"><span class="hljs-selector-class">.idea</span></span> ‚îÇ ‚îÇ <span class="hljs-selector-class"><span class="hljs-selector-class">.name</span></span> ‚îÇ ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">compiler</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xml</span></span> ‚îÇ ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">encodings</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xml</span></span> ‚îÇ ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">gradle</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xml</span></span> ‚îÇ ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">misc</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xml</span></span> ‚îÇ ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">modules</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xml</span></span> ‚îÇ ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">runConfigurations</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xml</span></span> ‚îÇ ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">workspace</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xml</span></span> ‚îÇ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ‚îÄ<span class="hljs-selector-tag"><span class="hljs-selector-tag">copyright</span></span> ‚îÇ ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">profiles_settings</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xml</span></span> ‚îÇ ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ<span class="hljs-selector-tag"><span class="hljs-selector-tag">libraries</span></span> ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">animated_vector_drawable_24_2_0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xml</span></span> ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">appcompat_v7_24_2_0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xml</span></span> ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">hamcrest_core_1_3</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xml</span></span> ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">junit_4_12</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xml</span></span> ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">support_annotations_24_2_0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xml</span></span> ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">support_compat_24_2_0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xml</span></span> ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">support_core_ui_24_2_0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xml</span></span> ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">support_core_utils_24_2_0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xml</span></span> ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">support_fragment_24_2_0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xml</span></span> ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">support_media_compat_24_2_0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xml</span></span> ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">support_v4_24_2_0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xml</span></span> ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">support_vector_drawable_24_2_0</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xml</span></span> ‚îÇ ‚îú‚îÄ‚îÄ‚îÄ<span class="hljs-selector-tag"><span class="hljs-selector-tag">app</span></span> ‚îÇ ‚îÇ <span class="hljs-selector-class"><span class="hljs-selector-class">.gitignore</span></span> ‚îÇ ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">app</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.iml</span></span> ‚îÇ ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">build</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.gradle</span></span> ‚îÇ ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">proguard-rules</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.pro</span></span> ‚îÇ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ‚îÄ<span class="hljs-selector-tag"><span class="hljs-selector-tag">libs</span></span> ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ<span class="hljs-selector-tag"><span class="hljs-selector-tag">src</span></span> ‚îÇ ‚îú‚îÄ‚îÄ‚îÄ<span class="hljs-selector-tag"><span class="hljs-selector-tag">androidTest</span></span> ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ<span class="hljs-selector-tag"><span class="hljs-selector-tag">java</span></span> ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ<span class="hljs-selector-tag"><span class="hljs-selector-tag">com</span></span> ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ<span class="hljs-selector-tag"><span class="hljs-selector-tag">example</span></span> ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ<span class="hljs-selector-tag"><span class="hljs-selector-tag">kciray</span></span> ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ<span class="hljs-selector-tag"><span class="hljs-selector-tag">myapplication</span></span> ‚îÇ ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">ApplicationTest</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.java</span></span> ‚îÇ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ‚îÄ<span class="hljs-selector-tag"><span class="hljs-selector-tag">main</span></span> ‚îÇ ‚îÇ ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">AndroidManifest</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xml</span></span> ‚îÇ ‚îÇ ‚îÇ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ‚îÄ<span class="hljs-selector-tag"><span class="hljs-selector-tag">java</span></span> ‚îÇ ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ<span class="hljs-selector-tag"><span class="hljs-selector-tag">com</span></span> ‚îÇ ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ<span class="hljs-selector-tag"><span class="hljs-selector-tag">example</span></span> ‚îÇ ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ<span class="hljs-selector-tag"><span class="hljs-selector-tag">kciray</span></span> ‚îÇ ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ<span class="hljs-selector-tag"><span class="hljs-selector-tag">myapplication</span></span> ‚îÇ ‚îÇ ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">MainActivity</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.java</span></span> ‚îÇ ‚îÇ ‚îÇ ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ<span class="hljs-selector-tag"><span class="hljs-selector-tag">res</span></span> ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ‚îÄ<span class="hljs-selector-tag"><span class="hljs-selector-tag">drawable</span></span> ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ‚îÄ<span class="hljs-selector-tag"><span class="hljs-selector-tag">layout</span></span> ‚îÇ ‚îÇ ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">activity_main</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xml</span></span> ‚îÇ ‚îÇ ‚îÇ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ‚îÄ<span class="hljs-selector-tag"><span class="hljs-selector-tag">mipmap-hdpi</span></span> ‚îÇ ‚îÇ ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">ic_launcher</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.png</span></span> ‚îÇ ‚îÇ ‚îÇ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ‚îÄ<span class="hljs-selector-tag"><span class="hljs-selector-tag">mipmap-mdpi</span></span> ‚îÇ ‚îÇ ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">ic_launcher</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.png</span></span> ‚îÇ ‚îÇ ‚îÇ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ‚îÄ<span class="hljs-selector-tag"><span class="hljs-selector-tag">mipmap-xhdpi</span></span> ‚îÇ ‚îÇ ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">ic_launcher</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.png</span></span> ‚îÇ ‚îÇ ‚îÇ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ‚îÄ<span class="hljs-selector-tag"><span class="hljs-selector-tag">mipmap-xxhdpi</span></span> ‚îÇ ‚îÇ ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">ic_launcher</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.png</span></span> ‚îÇ ‚îÇ ‚îÇ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ‚îÄ<span class="hljs-selector-tag"><span class="hljs-selector-tag">mipmap-xxxhdpi</span></span> ‚îÇ ‚îÇ ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">ic_launcher</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.png</span></span> ‚îÇ ‚îÇ ‚îÇ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ‚îÄ<span class="hljs-selector-tag"><span class="hljs-selector-tag">values</span></span> ‚îÇ ‚îÇ ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">colors</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xml</span></span> ‚îÇ ‚îÇ ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">dimens</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xml</span></span> ‚îÇ ‚îÇ ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">strings</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xml</span></span> ‚îÇ ‚îÇ ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">styles</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xml</span></span> ‚îÇ ‚îÇ ‚îÇ ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ<span class="hljs-selector-tag"><span class="hljs-selector-tag">values-w820dp</span></span> ‚îÇ ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">dimens</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xml</span></span> ‚îÇ ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ<span class="hljs-selector-tag"><span class="hljs-selector-tag">test</span></span> ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ<span class="hljs-selector-tag"><span class="hljs-selector-tag">java</span></span> ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ<span class="hljs-selector-tag"><span class="hljs-selector-tag">com</span></span> ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ<span class="hljs-selector-tag"><span class="hljs-selector-tag">example</span></span> ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ<span class="hljs-selector-tag"><span class="hljs-selector-tag">kciray</span></span> ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ<span class="hljs-selector-tag"><span class="hljs-selector-tag">myapplication</span></span> ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">ExampleUnitTest</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.java</span></span> ‚îÇ ‚îú‚îÄ‚îÄ‚îÄ<span class="hljs-selector-tag"><span class="hljs-selector-tag">build</span></span> ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ<span class="hljs-selector-tag"><span class="hljs-selector-tag">generated</span></span> ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">mockable-android-24</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.jar</span></span> ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ<span class="hljs-selector-tag"><span class="hljs-selector-tag">gradle</span></span> ‚îî‚îÄ‚îÄ‚îÄ<span class="hljs-selector-tag"><span class="hljs-selector-tag">wrapper</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">gradle-wrapper</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.jar</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">gradle-wrapper</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.properties</span></span></code> </pre>  Looks worse than 2 years ago </div></div><br>  Actually, automation through gradle, work with git and IDE are very important things, but at the stage of learning Android <b>I would really like to abstract from them</b> . <br><br><h2>  Assembly </h2><br>  Now we come to the most important and difficult stage.  We will work a lot with the command line, so I recommend that you write all the commands given here into one file and name it <b>Compile.bat</b> .  At the end of the file after the commands, you can add <i>pause</i> so that the result and errors can be seen - if any. <br><br><h3>  Preparation of ways </h3><br>  The first thing we will do for convenience and brevity is to create special variables in which we will store paths.  First of all, let's define our main directories.  You need to replace the paths to the JDK and Android SDK with the ones you have. <br><br><pre> <code class="dos hljs"><span class="hljs-built_in"><span class="hljs-built_in">set</span></span> JAVA_HOME=C:\Program Files\Java\jdk1.<span class="hljs-number"><span class="hljs-number">8</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>_73 <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ANDROID_HOME=C:\Users\kciray\AppData\Local\Android\android-sdk <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> DEV_HOME=<span class="hljs-variable"><span class="hljs-variable">%CD%</span></span></code> </pre> <br>  Next - the path directly to the programs.  I recommend that you browse the catalogs of your SDK and make sure that everything is in place.  Also correct the versions that are present in the paths. <br><br><pre> <code class="dos hljs"><span class="hljs-built_in"><span class="hljs-built_in">set</span></span> JACK_JAR="<span class="hljs-variable"><span class="hljs-variable">%ANDROID_HOME%</span></span>\build-tools\<span class="hljs-number"><span class="hljs-number">24</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">2</span></span>\jack.jar" <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> AAPT_PATH="<span class="hljs-variable"><span class="hljs-variable">%ANDROID_HOME%</span></span>\build-tools\<span class="hljs-number"><span class="hljs-number">24</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">2</span></span>\aapt.exe" <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ANDROID_JAR="<span class="hljs-variable"><span class="hljs-variable">%ANDROID_HOME%</span></span>\platforms\android-<span class="hljs-number"><span class="hljs-number">24</span></span>\android.jar" <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> ADB="<span class="hljs-variable"><span class="hljs-variable">%ANDROID_HOME%</span></span>\platform-tools\adb.exe" <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> JAVAVM="<span class="hljs-variable"><span class="hljs-variable">%JAVA_HOME%</span></span>\bin\java.exe"</code> </pre> <br>  By the way, in older versions, the aapt utility was in platform-tools - and I do not rule out that it and / or others can slip away somewhere else.  So be careful.  If you check everything right now, then the rest of the article should go smoothly. <br><br>  And yet - in a couple of variables let's score our packages and classes.  If you go to change them - you do not have to run on the code - all the settings at the beginning. <br><br><pre> <code class="dos hljs"><span class="hljs-built_in"><span class="hljs-built_in">set</span></span> PACKAGE_PATH=com/example/testapp <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> PACKAGE=com.example.testapp <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> MAIN_CLASS=MainActivity</code> </pre> <br><h3>  Preparing to compile </h3><br>  To begin, I will ask - have you ever wondered how the mysterious class <b>R</b> works?  Actually he confused me at first because of his supernatural capabilities.  How can one at a compilation stage access the XML files in other directories through the class fields?  I assumed that the precompiler was operating there - it turned out that way. <br><br>  Actually, there is a special utility AAPT - it goes through the directories of your resources and creates the very <b>R.java</b> .  It turns out that everything is very simple - it's just a class, which includes other static nested classes with integer constants.  And that's it!  It looks like this: <br><br><div class="spoiler">  <b class="spoiler_title">R.java</b> <div class="spoiler_text"><pre> <code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">/* AUTO-GENERATED FILE. DO NOT MODIFY. * * This class was automatically generated by the * aapt tool from the resource data it found. It * should not be modified by hand. */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.example.testapp; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">R</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">attr</span></span></span><span class="hljs-class"> </span></span>{ } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">string</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> hello=<span class="hljs-number"><span class="hljs-number">0x7f020000</span></span>; } }</code> </pre></div></div><br>  Now let's create it with you.  To do this, use the following commands: <br><br><pre> <code class="dos hljs"><span class="hljs-keyword"><span class="hljs-keyword">call</span></span> <span class="hljs-variable"><span class="hljs-variable">%AAPT_PATH%</span></span> package -f -m -S <span class="hljs-variable"><span class="hljs-variable">%DEV_HOME%</span></span>\res -J <span class="hljs-variable"><span class="hljs-variable">%DEV_HOME%</span></span>\src -M <span class="hljs-variable"><span class="hljs-variable">%DEV_HOME%</span></span>\AndroidManifest.xml -I <span class="hljs-variable"><span class="hljs-variable">%ANDROID_JAR%</span></span></code> </pre> <br>  Let's figure out what's what.  AAPT - Android Asset Packaging Tool - literally "packer android property".  Its options are: <br><br><ul><li>  <i>package</i> - says that we just need to pack resources (and not add or remove) </li><li>  <i>-f</i> - rewriting existing <i>R.java</i> , if any </li><li>  <i>-m</i> - place <i>R.java</i> in the proper packages, and not in the root specified in the <i>-J</i> path </li><li>  <i>-S</i> - after this option, we specify the directory with resources </li><li>  <i>-J</i> - after this option, we specify where to save the resulting <i>R.java</i> </li><li>  <i>-I</i> - after this option, we specify the path to the plug-in library - enable <i>android.jar</i> </li></ul><br>  After its execution, the same <b>R.java</b> file should appear in the src directory.  Check it out. <br><br>  Now there is no magic in our project and it is completely syntactically correct in Java.  And now the fun part.  Remember how classic Java programs are compiled via <b>javac</b> ?  Previously, he was also included in the sequence of assembling Android applications.  We took our source code <i>(*. Java)</i> , obtained from them the JVM byte-code <i>(* .class)</i> and only then from it received the byte-code for Dalvic <i>(* .dex)</i> .  With the advent of Jack ToolChain, we have reduced our build sequence by one step.  From the source <i>(* .java)</i> we immediately get the byte code for Dalvic <i>(* .dex)</i> . <br><br>  Where do you get Jack?  It is located in the <b>build-tools</b> folder as <b>jack.jar</b> and runs as a regular Java archive. <br><br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%JAVAVM%</span></span> -jar <span class="hljs-variable"><span class="hljs-variable">%JACK_JAR%</span></span> --output-dex "<span class="hljs-variable"><span class="hljs-variable">%DEV_HOME%</span></span>\bin" -cp <span class="hljs-variable"><span class="hljs-variable">%ANDROID_JAR%</span></span> -D jack.java.source.version=<span class="hljs-number"><span class="hljs-number">1</span></span>.<span class="hljs-number"><span class="hljs-number">8</span></span> "<span class="hljs-variable"><span class="hljs-variable">%DEV_HOME%</span></span>\src\com\example\testapp\R.java" "<span class="hljs-variable"><span class="hljs-variable">%DEV_HOME%</span></span>\src\com\example\testapp\MainActivity.java"</code> </pre> <br>  The arguments are as follows: <br><br><ul><li>  <i>-jar</i> - Standard option for JVM, indicating that you need to run a Java archive.  Has nothing to do with jack </li><li>  <i>--output-dex</i> - The folder where the final dex file should be placed.  Let it be in bin </li><li>  <i>-D jack.java.source.version = 1.8</i> - ‚ÄúD‚Äù indicates that we are setting a property.  <b>jack.java.source.version</b> allows us to indicate that we are using Java 8. Without it, the lambda will not work and there will be errors.  For a complete list of properties, see the <i>% JAVAVM% -jar% JACK_JAR% --help-properties command.</i> </li><li>  <i>[List of * .java files]</i> - Your source code.  We only have 2 files - <b>R.java</b> and <b>MainActivity.java</b> </li></ul><br>  For a complete list of options for Jack, see the <i>% JAVAVM% -jar% JACK_JAR% --help command.</i> <br><br>  Make sure our classes.dex is in the bin folder.  Now you just have to pack it together with the resources in the APK file.  Let's do it: <br><br><pre> <code class="dos hljs"><span class="hljs-keyword"><span class="hljs-keyword">call</span></span> <span class="hljs-variable"><span class="hljs-variable">%AAPT_PATH%</span></span> package -f -M <span class="hljs-variable"><span class="hljs-variable">%DEV_HOME%</span></span>/AndroidManifest.xml -S <span class="hljs-variable"><span class="hljs-variable">%DEV_HOME%</span></span>/res -I <span class="hljs-variable"><span class="hljs-variable">%ANDROID_JAR%</span></span> -F <span class="hljs-variable"><span class="hljs-variable">%DEV_HOME%</span></span>/bin/AndroidTest.unsigned.apk <span class="hljs-variable"><span class="hljs-variable">%DEV_HOME%</span></span>/bin</code> </pre> <br>  Here the options are similar to those we used when creating <i>R.java</i> : <br><br><ul><li>  <i>package</i> - says that we just need to pack resources (and not add or remove) </li><li>  <i>-f</i> - overwrite existing <i>AndroidTest.unsigned.apk</i> , if any </li><li>  <i>-M</i> - after this option, we specify the path to the manifest file </li><li>  <i>-S</i> - after this option, we specify the directory with resources </li><li>  <i>-I</i> - after this option, we specify the path to the plug-in library - enable <i>android.jar</i> </li><li>  <i>-F</i> - after this option, we specify where to save the resulting <i>AndroidTest.unsigned.apk</i> </li><li>  the last argument is the path to the folder with dex files </li></ul><br>  <i>AndroidTest.unsigned.apk</i> should now appear in the bin folder.  And we called it for a reason!  He does not have a digital signature.  Android prohibits install and run applications without a signature.  But creating it is not as difficult as it may seem at first glance. <br><br><pre> <code class="dos hljs"><span class="hljs-keyword"><span class="hljs-keyword">call</span></span> <span class="hljs-variable"><span class="hljs-variable">%JAVA_HOME%</span></span>/bin/keytool -genkey -validity <span class="hljs-number"><span class="hljs-number">10000</span></span> -dname "CN=AndroidDebug, O=Android, C=US" -keystore <span class="hljs-variable"><span class="hljs-variable">%DEV_HOME%</span></span>/AndroidTest.keystore -storepass android -keypass android -alias androiddebugkey -keyalg RSA -v -keysize <span class="hljs-number"><span class="hljs-number">2048</span></span> <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> <span class="hljs-variable"><span class="hljs-variable">%JAVA_HOME%</span></span>/bin/jarsigner -sigalg SHA1withRSA -digestalg SHA1 -keystore <span class="hljs-variable"><span class="hljs-variable">%DEV_HOME%</span></span>/AndroidTest.keystore -storepass android -keypass android -signedjar <span class="hljs-variable"><span class="hljs-variable">%DEV_HOME%</span></span>/bin/AndroidTest.signed.apk <span class="hljs-variable"><span class="hljs-variable">%DEV_HOME%</span></span>/bin/AndroidTest.unsigned.apk androiddebugkey</code> </pre> <br>  Actually, these lines launch 2 Java utilities that have nothing to do with the Android SDK - but they are necessary.  The first one creates the AndroidTest.keystore file (check its availability), and the second one connects this file to <i>AndroidTest.unsigned.apk</i> .  It turns out the file <i>AndroidTest.signed.apk</i> .  Here is such a wild craft files.  But once you create a bat-script, run it - and it will do it all automatically. <br><br>  I think it is not worth spending time on a detailed analysis of the options of these utilities within this article.  You just need to grasp the point - they take <i>AndroidTest.unsigned.apk</i> , sign it with the <i>AndroidTest.keystore</i> file and save to <i>AndroidTest.signed.apk</i> .  If you wish, you can read <a href="http://developer.android.com/tools/publishing/app-signing.html">in the documentation</a> . <br><br>  You will most likely have the warning " <i>Warning: No -tsa or -tsacert is provided and this jar ...</i> ", but do not pay attention. <br><br><h2>  Launch </h2><br>  Now that we have finally compiled our apk-file, we can run it.  Connect usb to your device, or run the emulator.  And then do <br><br><pre> <code class="dos hljs"><span class="hljs-keyword"><span class="hljs-keyword">call</span></span> <span class="hljs-variable"><span class="hljs-variable">%ADB%</span></span> uninstall <span class="hljs-variable"><span class="hljs-variable">%PACKAGE%</span></span> <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> <span class="hljs-variable"><span class="hljs-variable">%ADB%</span></span> install <span class="hljs-variable"><span class="hljs-variable">%DEV_HOME%</span></span>/bin/AndroidTest.signed.apk <span class="hljs-keyword"><span class="hljs-keyword">call</span></span> <span class="hljs-variable"><span class="hljs-variable">%ADB%</span></span> shell am <span class="hljs-built_in"><span class="hljs-built_in">start</span></span> <span class="hljs-variable"><span class="hljs-variable">%PACKAGE%</span></span>/<span class="hljs-variable"><span class="hljs-variable">%PACKAGE%</span></span>.<span class="hljs-variable"><span class="hljs-variable">%MAIN_CLASS%</span></span></code> </pre> <br>  Actually, the first line removes the program, if it is already there.  For re-launches useful.  The second - installs the APK on your device or emulator.  The third one runs.  Let's take a closer look at her arguments: <br><ul><li>  <i>shell</i> - we want to execute some commands on our device </li><li>  <i>am</i> - use for execution of commands the activity manager </li><li>  <i>start</i> - we want to start some activity </li><li>  the package name and the full class name (including the package) that we start </li></ul><br>  Attention - during installation, a confirmation dialog box may appear on the device.  If it is not approved in time, the installation will occur with the error <b>[INSTALL_FAILED_USER_RESTRICTED]</b> .  Also, you may have a question - why do <i>uninstall / install</i> instead of <i>install -r</i> .  I did so for the purity of the experiment.  The script completely removes all the products of its activities and creates them from scratch with each launch.  Even the keys.  You can use <i>install -r</i> , but then you should remove the code that is responsible for the re-creation of keys.  Otherwise, you will encounter an error <b>[INSTALL_FAILED_UPDATE_INCOMPATIBLE]</b> . <br><br>  If everything went well, you will see something like this: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/e16/8ce/a68/e168cea68dad4af393ea6ad44ea99798.png"></div><br><h2>  Conclusion </h2><br>  After all the files have been assembled, the directory tree should look something like this. <br><br><pre> <code class="hljs css">‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">AndroidManifest</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xml</span></span> ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">AndroidTest</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.keystore</span></span> ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">Clear</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.bat</span></span> ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">Compile</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.bat</span></span> ‚îÇ ‚îú‚îÄ‚îÄ‚îÄ<span class="hljs-selector-tag"><span class="hljs-selector-tag">bin</span></span> ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">AndroidTest</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.signed</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.apk</span></span> ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">AndroidTest</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.unsigned</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.apk</span></span> ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">classes</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.dex</span></span> ‚îÇ ‚îú‚îÄ‚îÄ‚îÄ<span class="hljs-selector-tag"><span class="hljs-selector-tag">res</span></span> ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ<span class="hljs-selector-tag"><span class="hljs-selector-tag">values</span></span> ‚îÇ <span class="hljs-selector-tag"><span class="hljs-selector-tag">strings</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.xml</span></span> ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ<span class="hljs-selector-tag"><span class="hljs-selector-tag">src</span></span> ‚îî‚îÄ‚îÄ‚îÄ<span class="hljs-selector-tag"><span class="hljs-selector-tag">com</span></span> ‚îî‚îÄ‚îÄ‚îÄ<span class="hljs-selector-tag"><span class="hljs-selector-tag">example</span></span> ‚îî‚îÄ‚îÄ‚îÄ<span class="hljs-selector-tag"><span class="hljs-selector-tag">testapp</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">MainActivity</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.java</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">R</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.java</span></span></code> </pre> <br>  Now you can visually see and understand how the assembly of the android application occurs at a lower level.  When you use IDE - if the assembly suddenly goes wrong (and this often happens) - you can get the situation right.  Also note that the final apk-file <b>takes only about 4 kilobytes</b> . <br><br>  <a href="">I post the archive of the project</a> .  Please note that I added another small script there - Clear.bat.  It deletes all files created during the assembly.  And put his launch on top of Compile.bat.  Also added comments using Rem - in steps. <br><br>  Thus, the script produces a <b>complete cleanup and reassembly of the project</b> , including the signature, as well as its removal on the device, installation and launch. <br><br><h4>  My parameters </h4><br>  <b>PC</b> <br><blockquote>  OS: Windows 10 Pro x64 <br>  JDK: 1.8.0_73 <br>  Android SDK: 24 </blockquote><br>  <b>Mobile device</b> <br><blockquote>  Model: Meizu MX4 <br>  Android: 5.1 <br>  OS: Flyme 5.6.8.9 beta </blockquote></div><p>Source: <a href="https://habr.com/ru/post/309504/">https://habr.com/ru/post/309504/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../309490/index.html">PostgreSQL integration with MS SQL Server</a></li>
<li><a href="../309492/index.html">How to make a web-studio effective and start earning? 15 steps from WebCanape</a></li>
<li><a href="../309496/index.html">ASP.NET MVC + VM: splitting complex views into simple ones using view models using the example of an event calendar</a></li>
<li><a href="../309500/index.html">We invite developers to Droidcon Moscow 2016</a></li>
<li><a href="../309502/index.html">Spherical testing in vacuum: How to eat, how it should be, how it will be</a></li>
<li><a href="../309506/index.html">Meet CALayer</a></li>
<li><a href="../309508/index.html">What is a convolutional neural network</a></li>
<li><a href="../309510/index.html">A selection of materials about clouds, data centers and the development of services</a></li>
<li><a href="../309512/index.html">DataArt and GDG invite to RIF-Voronezh 2016</a></li>
<li><a href="../309514/index.html">Focusing on VDI: NetApp All-Flash FAS Storage System</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>