<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Model of watercraft interaction in video games</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Let's talk about vehicle physics. 
 The physics of vehicles in video games is not very much discussed. Articles on the Internet about the physics of t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Model of watercraft interaction in video games</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/files/125/442/d4f/125442d4f6404c418abfc098bcb6d35e.png"></div><br><br><h2>  Let's talk about vehicle physics. </h2><br>  The physics of vehicles in video games is not very much discussed.  Articles on the Internet about the physics of transport in video games are few and superficial;  they are usually devoted to the very basics.  The transport programmer for video games feels today in a relative vacuum.  Perhaps this situation has arisen, because this topic is rather difficult to explain, and maybe we are just ashamed to admit the use of hacks, simplifications and tricks that we bring in comparison with the ‚Äúcorrect‚Äù, realistic simulation of physics.  No matter how it was, video games have unique problems in the simulation of transport, and therefore it is worth writing about it.  This is an exciting topic related to physics, working with the camera, sound, special effects, as well as to human perception and psychology. <br><br>  I decided to first talk about the courts, because I recently worked with them;  I also discovered that their dynamics are not completely understood even at the level of research (although much is understandable).  Models and theories are formulated in such a way that it becomes difficult to apply them directly in video games.  Or they require very resource-intensive simulation methods that are almost impossible to control and adapt to the bizarre needs of developers and players.  But you can write a simplified model that takes into account the important parameters of the vessel.  There is definitely a bit of art, a "leap of faith" and a small amount of "creative" physics that will make Kelvin and Stokes roll over in graves. <br><a name="habracut"></a><br><h2>  Series of articles on the physics of ships </h2><br>  In this series, I will present an algorithm for calculating the most important forces acting on a ship in water.  First of all, I strive to create a model that describes the main dynamic characteristics of the behavior of ships on water, without addressing the complex and resource-intensive calculation of fluid dynamics. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      I will limit myself to reasonable performance costs, for example, less than 1 ms per ship.  The model should be sufficiently universal to simulate the behavior of vessels of various sizes and shapes in conditions from calm to storm. <br><br>  In the first article of this series, we will work with hydrostatic forces, and also lay an important foundation for calculating all other forces involved in the model.  Other forces are the dynamic forces resulting from the movement of the vessel relative to the water.  They will be discussed in the following articles. <br><br><h2>  Meet the buoyancy </h2><br>  Before delving into the algorithm itself, I want to talk a little bit about pushing.  All that is enough for us to do is to calculate the magnitude and point of application of the buoyancy force to the body partially immersed in the liquid. <br><br>  When the body is immersed in a fluid, due to the pressure of the fluid, it exerts a force on the surface of the body.  The more pressure, the more power.  Strength is the result of the movement of a multitude of water particles in a fluid that elastically hits the surface of the body (like perfect billiard balls).  This is a microscopic force, the impact of which is felt even if the water does not move in any particular direction (current) and if the vessel remains stationary;  therefore, it is called hydrostatic force.  The total force of all these atoms or molecules hitting the surface is perpendicular to the surface.  It should also be mentioned that the pressure in water increases at depth (on a planet with gravity), since the greater depth implies that more and more water presses down with its weight.  However, the pressure itself does not have a definite direction, and even if there is no liquid directly above some point of water, the pressure at this point will still depend on the total depth nearby.  ( <a href="https://habr.com/ru/post/307362/">*</a> ) <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/11c/174/c4a/11c174c4ab344494be25e9a6083dce00.png"></div><br>  Increasing the force during immersion is very important for pushing, since the resulting pushing force arises due to the imbalance of the vertical component of hydrostatic forces on the surface of the body.  The horizontal component of hydrostatic forces is always balanced.  This is intuitively understandable - for each individual elementary (closed) volume, it is always possible to find at the same depth an elementary area, directed in the opposite direction.  Since the values ‚Äã‚Äãof hydrostatic forces are the same, but directed in opposite directions, they are balanced.  On the other hand, the vertical component of the hydrostatic forces is not balanced.  In the general case, since the volume is closed, the surfaces whose normals are directed downward are usually at a greater depth than the surfaces whose normals are directed upwards.  Therefore, the pressure forces acting on the surface with downward normals prevail.  The force of pressure acts in the opposite direction to the normals, the resultant force is directed upwards and it can be proved [ <a href="https://habr.com/ru/post/307362/">2</a> ] that its value is equal to ‚Äúthe weight of the displaced fluid‚Äù (the weight of the volume of the body filled with water). <br><br>  We still lack one puzzle piece: so that all of the above leads to pushing, we also need to specify the point of application of hydrostatic force.  The point of application of the buoyancy force is the point relative to which the moments of all hydrostatic forces are balanced.  If we continue the reasoning based on the elementary areas of the submerged body, everything will become a little less obvious.  Since hydrostatic forces increase with greater immersion, the point of application of hydrostatic force to a given horizontal surface is generally lower than the center of the surface.  As shown in Appendix <a href="https://habr.com/ru/post/307362/">A,</a> using the example of a submerged triangle (this is a convenient example, because in games objects usually consist of triangles), the point of application of force is always below the center.  Despite the fact that the sum of all moments of all applied forces is usually below the center of any surface, it is still balanced near the center of gravity of the volume.  A formal proof of this is given in [ <a href="https://habr.com/ru/post/307362/">2</a> ] using the Ostrogradsky-Gauss theorem ( <a href="https://habr.com/ru/post/307362/">**</a> ), or the divergence theorem.  This can also be verified numerically.  I mention this because if you decide to divide the body into small planes, such as triangles, and summarize all hydrostatic forces and their moments, the temptation arises to simplify the calculation of moments, as if the elementary forces for each triangle are attached to its center (which is easy to find ). <br><br>  However, if you do this, you will get the wrong result.  The force will be calculated correctly, but there will be a residual moment relative to the center of the submerged volume, while the vessel can tilt at rest even on a completely flat surface of the water.  This is especially true when using a low-poly mesh object to reduce performance damage, because the error made for each triangle is quite significant.  On the other hand, with a large number of small triangles, the error caused by the simplification is significantly reduced, and the simplification may become quite acceptable.  But there is always a trade-off between the difficulty of calculating the correct center and the number of triangles in the object.  Appendix <a href="https://habr.com/ru/post/307362/">A</a> provides a formula for calculating the location of the point of application of hydrostatic forces on a triangle immersed in a liquid. <br><br><h2>  Two ways to flip the boat </h2><br>  In light of the above, there are two ways to calculate the pushing force.  Volumetric method: by calculating the immersed volume and determining its center of gravity.  Surface method: by determining the immersed surface and the calculation of the force applied to it.  These two methods, when properly applied, should give the same result. <br><br>  Both the volumetric and surface methods without too much approximation require the determination of the coordinates of the intersection of water with the hull.  It looks threatening, especially if we assume that water has a non-flat surface: the calculation looks too resource-intensive and complex.  Perhaps that is why many are inclined to use volume primitives.  For example, spheres: in contrast to the calculation of the intersection of the surface of water with a complex figure, the calculation of the volume of the part of the sphere immersed in water is quick and simple if you take the water in close proximity to the sphere flat.  The volume can even be determined analytically, which means (at least theoretically), the calculation with infinite precision, or with the accuracy allowed by floating point operations (yes, there are many wordplay in this article).  It also seems that the submerged volume will change gradually and smoothly when the ship is raised and lowered in water, and the constancy of the physical model is often preferred in games. <br><br>  But approximating the hull of a standard vessel with the help of spheres can quickly turn into a nightmare, because many spheres of different diameters are required.  Since the spheres are one of the worst options for packing densely in a volume, you will have significant voids between the spheres (Figure 1).  There is an upper limit on the density of packing in the volume, even for spheres with different radii [ <a href="https://habr.com/ru/post/307362/">5</a> ].  The presence of these voids leads to a noticeable impermanence when pushing.  Spheres can be made intersecting, but then the calculated immersed volume will be more than the real one.  Finally, while calculating the intersection of a flat surface with a sphere is simple, calculating the intersection of a sphere with an arbitrary water surface is much more difficult, so we can try to find a solution to calculate the intersection of a ship's hull with water. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/108/7bd/6e4/1087bd6e43f14f639bdfc7d121629410.png"></div><br>  <em><b>Figure 1</b> - Approximation of vessel volume using spheres is not a solution.</em> <br><br>  Body volume can be converted to voxels, i.e.  approximate by a set of simple volume primitives, for example, cubes.  Voxels intersecting with water can also be converted into smaller voxels until the desired accuracy is achieved.  The problem with volume approximations is that they give (fairly coarse) answers to the question ‚Äúhow much water is displaced?‚Äù, But it is rather useless for determining the waterline of a submerged object, which is needed, for example, to apply special effects of water, such as splashes and foam , or to determine the shape of the surface in contact with water, unless of course you use a completely unacceptable number of them. <br><br>  Assuming that we can accurately calculate the surface of the body, immersed in water, we still have a choice between the volumetric and surface methods of calculation.  For the volumetric method, we must close the submerged surface of the body to create a closed volume, calculate its full volume and center of gravity, and then apply a pushing force to it.  With the surface method, we calculate the hydrostatic pressure forces acting on each submerged surface element (triangle), and summarize their linear impulses and angular momentum around the center of gravity of the body. <br><br>  The advantage of the surface method is that it does not need to close the volume, everything is ready for the direct summation of forces.  With the volumetric method, the immersed volume may also consist of several volumes.  It is convenient to use it, for example, for the calculation of catamaran hulls.  However, even if the vessel does not have openings, the intersection with water should represent the closure of two or more volumes, and we must determine which of the volumes each of the immersed triangles belong to, which is an additional difficulty in calculating this method.  The surface approach in this respect is more versatile, it works regardless of the number and shape of the formed volumes, and it does not require a circuit.  That is what I chose for my algorithm. <br><br><h2>  Algorithm structure </h2><br>  I will explain in general terms the structure of the algorithm with some important simplifications that will provide a quick calculation and at the same time sufficient results. <br><br>  The first assumption that I will make is that the surface of the water is described by a grid of triangles whose vertices move with each frame in accordance with the movement of water.  Of course, this is not always the case, but it is always possible to approximate the surface of the water through a grid of triangles.  Later in this article I will tell you how to take the surface of the water and prepare for it a representation in the form of a grid of triangles around the body. <br><br>  The main task will be to determine the coordinates of the intersection between the surface of the water and the surface of the hull.  Having reviewed the implementation of Edouard Halbert [ <a href="https://habr.com/ru/post/307362/">1</a> ], I began to implement the exact solution, taking into account all the options for crossing the water surface and the triangle.  This problem is quite complex, because in theory there are many ways to separate a triangle by a surface.  A surface can cut through one triangle in several places, pass through the center, without touching either side, or plunging into any of the vertices.  Each such submerged area must be divided into triangles (triangulated), but these areas are not necessarily convex, so they are more difficult to triangulate.  In addition, such cases are quite frequent.  Even in relatively calm water, they occur very often and must be processed in such a way that they do not lead to unrealistic discreteness in the size of surfaces considered immersed.  After working for some time on the implementation of an absolutely accurate, but very slow algorithm for calculating intersections, I realized that I needed to find ways to simplify the algorithm, while not sacrificing too much of its overall behavior.  The algorithm I presented here is the result of such simplifications.  I will not tell the details of the first (exact) algorithm, because it is extremely tedious and boring;  In addition, the optimized algorithm works fine and calculates the order of values ‚Äã‚Äãfaster. <br><br>  The optimized algorithm has the following structure: a floating body is approximated using a grid of triangles (its body).  We determine the height above the water of each vertex of this hull.  If the height is negative, then the body is immersed in water.  Triangles, all three peaks located above the water, are considered to be completely not immersed in water.  This simplification, in reality, water may be above the surface of the triangle, but below all three vertices (see Figure 4).  We also consider a triangle completely submerged, if all three vertices are under water, despite the fact that some of the water may be under the triangle on some part of its area.  If only one or two vertices are under water, we divide the triangle into one area under water and one area above water, as shown in Figure 2. If the area under water is not a triangle, we triangulate it.  I made a bold (and theoretically incorrect) assumption that the surface of the water crosses the side of the triangle between the submerged and surface peaks only once.  Figure 3 shows examples of cases where the intersection is not calculated accurately.  At the end we get a list of triangles, each of which is submerged under water.  Then we calculate the hydrostatic and hydrodynamic forces acting on these triangles. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/ac2/8a2/0be/ac28a20be6a94942a175983ab5e3ef21.png"></div><br>  <b>Figure 2</b> - 4 simplified cases of intersection of triangles with a section of water.  From left to right at the triangles are immersed in water, respectively, 0, 1, 2 and 3 vertices.  With 2 submerged vertices, we need to once again triangulate the submerged part.  It should be noted that the intersection with water is not exact due to another simplification, which we will consider. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/af0/0d1/1db/af00d11db9ed4754b449c92da1b7758a.png"></div><br>  <b>Figure 3</b> - Three examples of cases incorrectly handled by an optimized algorithm.  Red areas are indicated by triangles that should be considered under water but not counted.  The two triangles on the left intersect with water, but none of their peaks is under water.  The middle triangle is shown in perspective; it does not intersect with water on either side, but the top of the wave passes through the middle of the triangle.  At the right triangle, there are two peaks under the water, but the water is also under the triangle on the side between these two peaks. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/11b/f73/474/11bf734746f04bd4b0200710cb199f30.png"></div><br>  <b>Figure 4</b> - An example of a case that often occurs when ripples on the water.  The larger right lower triangle of the body intersects water in several areas, one of which does not intersect either side of the triangle.  Worse, the intersected areas could be concave, and fast triangulation would be even more complicated.  Handling all such cases would lead to development time and performance when the game is running.  In addition, it is quite meaningless, because, strictly speaking, the surface of the water itself changes due to the presence of the vessel. <br><br>  For a ship model, such cases are less important than it seems.  In practice, sacrificing accuracy is not a problem if the size of the body triangles is not too large relative to the amplitude and wavelength of the smallest waves that we want to take into account. <br><br>  The main advantage of the proposed approach is that all vertices can be processed in the first pass, regardless of which of the three form a triangle.  After that, all the information needed to process each triangle, which serves as the basis for 0, 1 or 2 immersed triangles, becomes available.  The triangle intersection part is very simple and fast.  Most processing can easily be parallelized if necessary.  We also know the maximum number of immersed triangles that can be obtained: twice the number of triangles of the object's body.  This allows us to allocate all the memory in advance in a simple array. <br><br>  In the next section, we will look at important implementation details, such as a method for approximating the surface of water to optimize the determination of water depth, a method for accurately separating a triangle, only one or two vertices of which are under water, as well as the calculation of buoyancy forces. <br><br><h2>  Implementation details </h2><br><h3>  Water section </h3><br>  To determine the height above the water of each peak, we need a quick way to determine the position of the water below a given point.  It largely depends on the method of simulating water in a game or in its simulation.  If the water is flat or described by a simple function, it can be a quick way to simply determine the height of the water, measuring or evaluating it with each request.  However, in other cases, the algorithm for determining the height of water is resource-intensive and only a limited number of requests can be made.  For example, this happens in the case of methods based on fast Fourier transform, such as Tessendorf waves [ <a href="https://habr.com/ru/post/307362/">4</a> ]. <br><br>  In this case, I propose to measure the height of water once at points at the same distance from the body, thus creating a height map, which will then be used for all subsequent height requests.  I will call this elevation map the ‚Äúwaterway‚Äù.  The water section should be at least not less than the vertical projection of the body.  For example, you can start with a square section of water, whose side is equal to the diagonal of a rectangle, described around the projection.  Like the traditional elevation map, the water section consists of a rectangular area divided into stripes, forming rows and columns intersecting in square cells (Figures 5 and 6).  Each cell itself is divided into 2 triangles.  For each triangle, we calculate the equation of the surface on which it is located, which allows us to quickly determine the projection of a point on it. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/6e7/d48/87b/6e7d4887bdfc48dab7e7d997a31b4a22.png"></div><br>  <b>Figure 5</b> - Section of water size 4x4 and waterline (blue), shown below. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/125/442/d4f/125442d4f6404c418abfc098bcb6d35e.png"></div><br>  <b>Figure 6</b> - Section of water size 5x5 and waterline (blue), shown below. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/4ab/432/fd0/4ab432fd043240cfa384b4abee206252.png"></div><br><br><h2>  Cutting algorithm </h2><br>  When part of the vertices of the triangle is under water, and part is above water, we need to cut it into a piece completely submerged under water, and a piece completely above the water.  There is a way to simplify cutting, fast in calculations and continuous.  By ‚Äúcontinuity,‚Äù I mean the absence of situations where a small change in the height of the peaks leads to unexpectedly strong changes in the submerged area.  This problem did not arise if we precisely cut the triangles into underwater and surface parts, it appears only because of the approximation, and we need to choose the method that behaves well.  This problem became one of my first obstacles, and sometimes leads to instability in pushing out, when the body suddenly begins to jump out or sink significantly, destroying the whole effect. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/fb2/285/85c/fb228585c70245ec81cd93763b77687c.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/files/c92/caf/29b/c92caf29bde84a43b090912b03984a33.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/files/303/b12/3b6/303b123b614d4e59a6956683b01c3b23.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/files/145/5a1/1ff/1455a11ffa4e44bdb7ecf967e55fcd1e.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/files/3fc/02f/7d4/3fc02f7d4eda4cbaa54eeb4b7245f95d.png"></div><br>  <b>Figure 8</b> - Simplified cutting of a triangle when there are two vertices above the water. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/274/8c9/5f5/2748c95f569d42348dfab3069a24d77e.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/files/9d0/6ce/be8/9d06cebe82a941ce89f81f8fd875a601.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/files/5f4/786/203/5f4786203cf141c4820e9678fd84cda9.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/files/3c4/6de/213/3c46de21313b4a798ad1b4b429cd9063.png"></div><br><br><h2>  Calculation of hydrostatic forces </h2><br>  After the cutting algorithm was performed for all the triangles of the mesh object, we received a list of fully immersed triangles.  The buoyant force acting on the body is the sum of all hydrostatic forces acting on each immersed triangle.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Since we are considering a linear force, we can only summarize the vertical component of the hydrostatic force, because we have seen that the other forces balance each other. The force acting on the immersed triangle is:</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/9a9/ec0/868/9a9ec086839846229481f6688508d8fa.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/files/386/e0b/59a/386e0b59acf6450fbbc17a2430730e33.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Do not forget that the application of hydrostatic force to the center of the triangle instead of the actual center of its application leads to residual torque relative to the center of the displaced volume. </font><font style="vertical-align: inherit;">If the number of triangles is small and it is important not to receive any torque, then it is necessary to calculate the point of application of force to the triangle. </font><font style="vertical-align: inherit;">Appendix </font></font><a href="https://habr.com/ru/post/307362/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> presents the formula for determining the center of application of hydrostatic force to two types of triangles, whose base is horizontal, and the top is directed up or down. </font><font style="vertical-align: inherit;">A randomly immersed triangle should be cut into two such triangles, after which two sets of hydrostatic forces and centers of application of forces are calculated and summed.</font></font><br><br><h2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> We put everything together </font></font></h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Figure 10 provides a brief description of the algorithm. </font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/7e4/753/8e6/7e47538e667a4905ab955632defc5579.png"></div><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 10</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Algorithm diagram. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">So, we can summarize the structure of the algorithm as follows (we have assumed that x / z is a horizontal plane, and y is the vertical axis directed upwards):</font></font><br><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">At each simulation step, we update the position of the water section to follow the floating body. </font><font style="vertical-align: inherit;">As you can see from the animated gif in Figure 11, the stretch of water does not follow smoothly behind the vessel. </font><font style="vertical-align: inherit;">When a ship moves horizontally, it shifts from its original position so that the water section loses a row (or column) on one side and adds a row (or column) on the other side. </font><font style="vertical-align: inherit;">When this happens, the coordinates of the water section (say, its southwest corner) change dramatically compared to the previous step.</font></font><br><br></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> After determining the coordinates of the water section for each water grid point, the water height is determined or calculated. </font></font><br><br></li><li>        ,   ,    y   ,     .    ,   . <br><br></li><li>         , ,           . <br><br></li><li>              ,    ,  0, 1  2  . <br><br></li><li>                (  ). <br></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Of course, we can apply many different ways to optimize. </font><font style="vertical-align: inherit;">For example, we can first vertically project the top of the body to accurately determine the involved triangles of cells and calculate the equations of the planes only for these triangles.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/1d5/bb4/648/1d5bb46489764462953b8ddc19c91c00.gif"></div><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Figure 11</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - Dynamic response of the vessel, on which only hydrostatic forces act on a completely flat surface of the water.</font></font><br><br><h2>  Conclusion </h2><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In this article, we present an algorithm for calculating the intersection of an arbitrary grid with the surface of water and the calculation of hydrostatic forces acting on the body described by this grid. If you wrote a program only on the basis of this algorithm, the ship would hover up and down, as if on a spring. The vessel would be pushed out of the water into the air, then fell under the influence of gravity, immersed in water and again pushed out of it. To stabilize the system, you need to add attenuation. The hydrodynamic forces described in the following article are very effective for adding damping as in the real world. But you can cheat by adding damping based on high speeds in all directions of motion, and especially in the vertical direction, so that you get a feeling of calculating hydrodynamic forces using the algorithm described above.</font></font><br><br><h2>  Notes </h2><br>  ( <a name="Asterisk1"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">*) If, for some reason, the pressure at a point of a given depth was lower relative to points at the same depth, then water at points at the same depth, subjected to greater pressure, would very quickly move to a point with less pressure and restore uniform pressure to this depth. The only thing that prevents water from elevated pressure, located at a greater depth, from rising to a depth with less pressure, is gravity; that is why there is a pressure gradient that increases with immersion.</font></font><br><br>  ( <a name="Asterisk2"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">**) By the way, when I studied this theorem in France, it was called the Ostrogradsky theorem. Later, I learned that it is also known as the Gauss theorem. I suppose (almost as a joke) that the reason for this is that the French do not want to associate too many theorems with the Germans, and, if possible, they choose the Russian equivalent more readily. Americans tend to practicality, and to avoid long disputes, they call it simply a divergence theorem. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Appendix A. Hydrostatic forces acting on a triangle immersed in a liquid</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To calculate the hydrostatic forces and moments acting on a triangle completely immersed in liquid, it is useful to divide the triangle into smaller triangles, each of which has an absolutely horizontal side. </font><font style="vertical-align: inherit;">The reason for this is that it is much easier to calculate the hydrostatic forces acting on a triangle with a horizontal side: it can be divided into (practically) rectangular horizontal stripes, on whose surfaces the pressure is the same at any point.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/8fa/ae7/1ba/8faae71ba5d4460ba795174598095fa1.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/files/365/1f4/654/3651f465442944dba68a55a777b6c2ef.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/files/058/d4f/a28/058d4fa281144e53979d6f8472c73c7f.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/files/25d/a70/87c/25da7087c8014e1196eb04014ca6abb8.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/files/c28/216/3f3/c282163f3c0d41669e3f252c8486daf6.png"></div><br><div style="text-align:center;"><img src="https://habrastorage.org/files/dc9/53d/bdb/dc953dbdb3664b84b8b7bd3cc937b480.png"></div><br><br><h2>  Links </h2><br><a name="Ref1"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1. </font></font><a href="https://www.youtube.com/watch%3Fv%3D6NNfmfSMwKs"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Simship. </font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Edouard Halbert.</font></font><br><a name="Ref2"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2. </font></font><a href="http://www.math.ubc.ca/~feldman/m317/buoyancy.pdf"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">"Buoyancy". </font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Joel Feldman.</font></font><br><a name="Ref3"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3. </font></font><a href="http://www.geo.hunter.cuny.edu/~hsalmun/intro2fm07web/lectures/chapter2_2.pdf"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hydrostatic forces on a plane surface.</font></font></a> <br><a name="Ref4"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4. </font></font><a href="http://graphics.ucsd.edu/courses/rendering/2005/jdewall/tessendorf.pdf"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Simulating Ocean Water. </font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Jerry Tessendorf.</font></font><br><a name="Ref5"></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">5. </font></font><a href="http://arxiv.org/pdf/1206.2608v1.pdf"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Upper Bounds For Packing. </font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">David De Laat, Fernando Mario De Oliveira Filho, Frank Vallentin. </font></font><br><br> <i><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">About the author</font></font></b></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : Jacques Kerner - Senior Software Engineer at Avalanche Studios (New York), a specialist in vehicle physics. </font><font style="vertical-align: inherit;">He worked on </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Just Cause 3</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (2015), </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Homefront</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (2011), </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Need for Speed: ProStreet</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (2007), </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Need for Speed: Carbon</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (2006) </font><font style="vertical-align: inherit;">games </font><font style="vertical-align: inherit;">.</font></font><br><br>  <a href="https://habrahabr.ru/post/309036/">The second part</a> . </div><p>Source: <a href="https://habr.com/ru/post/307362/">https://habr.com/ru/post/307362/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../307352/index.html">We draw 3D on an oscillograph</a></li>
<li><a href="../307354/index.html">All programmers think that C ++ supports OOP, except the OOP author.</a></li>
<li><a href="../307356/index.html">Network Evolution to SDN & NFV</a></li>
<li><a href="../307358/index.html">We raise micromonitoring on icinga2 with minimal costs</a></li>
<li><a href="../307360/index.html">Asynchronous programming in 1C via .Net Native VK</a></li>
<li><a href="../307364/index.html">The book "The secrets of CSS. Perfect solutions to daily tasks. ‚Äù</a></li>
<li><a href="../307366/index.html">Modified Geometry Buffer Anti-Aliasing Algorithm</a></li>
<li><a href="../307368/index.html">AI monsters and finding the way with heatmaps</a></li>
<li><a href="../307372/index.html">Cremes is a new advanced cyber spyware malware.</a></li>
<li><a href="../307374/index.html">Alternative to .clearfix</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>