<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Automate testing of Windows applications using Winium</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="What to eat 
 With Winium, we can automate ordinary Windows applications. As a rule, Winium can work with those elements that can be found in windows ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Automate testing of Windows applications using Winium</h1><div class="post__text post__text-html js-mediator-article"><h4>  What to eat </h4><br>  With Winium, we can automate ordinary Windows applications.  As a rule, Winium can work with those elements that can be found in windows using standard Windows tools (as a rule, these elements have a tab order).  These tools are supplied in standard whales (download, for example, <a href="https://developer.microsoft.com/ru-ru/windows/downloads/windows-8-1-sdk">here</a> , after installation, search for them, for example, here: C: \ Program Files (x86) \ Windows Kits \ 8.1 \ bin \ x64).  I consider <i>inspect</i> and <i>uiverify</i> to be the most convenient for me, but the taste and color, as some of my comrades say, are all different markers. <br><a name="habracut"></a><br>  However, in order to automate self-written applications, it would be nice for fellow developers to make sure that the elements have adequate ClassName, Name and AutomationId.  Of course, in certain situations, we can save the transfer of pressing certain keys and clicking the mouse on the coordinates, but this is not a panacea.  It is better to always have a set of pre-prepared ‚Äúlevers‚Äù in the form of descriptions of objects than to rely on the fact that the GUI will always be the same and behave well in different situations. <br><br>  With Winium in normal mode, you can communicate through Selenium using Python and Java;  one way or another, but the stars rose so that the choice fell on Java. <br><br><h4>  Installation </h4><br>  First, we need Winium Desktop Driver.  You can download it, for example, <a href="https://github.com/2gis/Winium.Desktop/releases/">here</a> .  We will be required to unzip this case and run it during tests.  Through it, the Selenium server will communicate with Windows applications. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Secondly, in fact, the Java-IDE (used IntelliJ IDEA Community, for which he thanks a lot) and JDK.  Do not forget to check / set the JAVA_HOME environment variable with the path value to the JDK (in my case - C: \ Program Files \ Java \ jdk1.8.0_131). <br><br>  Thirdly, we also need the Selenium server - go <a href="http://www.seleniumhq.org/download/">here</a> , download the Selenium Standalone Server (JAR file). <br><br>  Next, by setting up the project, we create a new Java project and add it to the External libraries (click the <i>Project Structure</i> button (or Ctrl + Alt + Shift + S), then select <i>Libraries</i> and click the plus sign in the <i>Project Settings</i> ) our selenium JAR file.  That's all you can write. <br><br><h4>  Using </h4><br>  In order for everything to work, you need to run Winium.Desktop.Driver with admin rights at the time of using the tests.  But, since the driver may hang from time to time for one reason or another, it is convenient to run it before each test and kill it at the end.  For example, you can use ProcessBuilder for this purpose: <br><br><pre><code class="java hljs">ProcessBuilder pro = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ProcessBuilder(windriverPath + windriverName, windriverParam); shell = pro.start(); <span class="hljs-comment"><span class="hljs-comment">//&lt; &gt; shell.destroy();</span></span></code> </pre> <br>  where for convenience of deployment you can specify <i>windriverPath</i> , <i>windriverName</i> is the path to the driver and the name of the executable file;  <i>windriverParam</i> - additional launch parameters, if any, are required. <br><br>  At the beginning of the beginning in the code you need to attach the driver variable to the Winium driver itself: <br><br><pre> <code class="java hljs">DesiredCapabilities cap = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DesiredCapabilities(); cap.setCapability(<span class="hljs-string"><span class="hljs-string">"app"</span></span>,<span class="hljs-string"><span class="hljs-string">"&lt;path to executable file&gt;"</span></span>); <span class="hljs-comment"><span class="hljs-comment">//    -  cap.setCapability("launchDelay","5"); //    WebDriver driver = new RemoteWebDriver(new URL("http://localhost:9999"),cap); //      Winium </span></span></code> </pre><br>  If we don‚Äôt want to launch any application, but simply attach to some already running one, then lines 2 and 3 can be safely omitted. <br><br>  In order for us to work with any element, we first need to attach to it.  Three attachment mechanisms are known - <i>By.name</i> - by the Name field, <i>By.className</i> - by the ClassName field, and <i>By.xpath</i> for more sophisticated search conditions.  Also, if we need the first / only element, we can use the <i>findElement</i> method, and if we want to get a list of all such elements, then we need to use the <i>findElements</i> method.  In the second case, the elements will be added in the order of the tab order.  Examples of using: <br><br><pre> <code class="java hljs">WebElement wrk = driver.findElement(By.name(<span class="hljs-string"><span class="hljs-string">"  Name"</span></span>)); <span class="hljs-comment"><span class="hljs-comment">// ,    Name List&lt;WebElement&gt; wrkL = driver.findElements(By.className("  ClassName")); //     ClassName</span></span></code> </pre><br>  We can also attach to elements of another element: <br><br><pre> <code class="java hljs">WebElement wrk1 = wrk.findElement(By.name(<span class="hljs-string"><span class="hljs-string">"  Name"</span></span>));</code> </pre><br>  If the first two attachment mechanisms are very narrowly specialized, i.e.  work strictly in a hierarchical structure and strictly with the Name and ClassName fields, then to work with other cases we need a third mechanism, namely <i>By.xpath</i> . <br><br>  In this mechanism, everything is strictly according to the canons of using xpath (in any case, everything worked as needed from the cases used).  With xpath, you can get and process IsOffscreen, AutomationId, HasKeyboardFocus fields: <br><br><pre> <code class="java hljs">WebElement field = wrk.findElement(By.xpath(<span class="hljs-string"><span class="hljs-string">"*[@HasKeyboardFocus='True']"</span></span>)); <span class="hljs-comment"><span class="hljs-comment">//   wrk,    </span></span></code> </pre><br>  When using xpath, especially if we are working under more complex conditions, it is convenient for tracking possible errors to log the entire line passed to xpath: <br><br><pre> <code class="java hljs">String xpathStr = <span class="hljs-string"><span class="hljs-string">"*[(@AutomationId='"</span></span> + autId + <span class="hljs-string"><span class="hljs-string">"') and (@IsOffscreen='False')]"</span></span>; <span class="hljs-comment"><span class="hljs-comment">//       -  AutomationId = autId     IsOffscreen = False log("Performing xpath search: " + xpathStr); WebElement tWrk = wrk1.findElement(By.xpath(xpathStr));</span></span></code> </pre><br>  Of course, we can search for xpath with elements not only of the current window, but such a search can last quite a long time. <br><br>  There are other ways of searching, but, anyway, it all comes down to those described above.  For example, <a href="https://github.com/2gis/Winium.Desktop/wiki/Finding-Elements">such</a> . <br><br>  We may also need to simulate key input from the keyboard.  In the usual manner, this is done with the <i>sendKeys (‚ÄúCharacter String‚Äù)</i> method of the element.  However, it should be remembered that some symbols are used as service symbols and must be escaped (for example, "+" is Shift, and in order to enter "+", you must pass the sequence "+ =").  For the convenience of using the code, you can write a wrapper that automatically replaces all "+" with "+ =", but here it is more convenient for someone.  You can learn more about the standards for the transmission of key combinations, for example, <a href="https://msdn.microsoft.com/ru-ru/library/office/gg278655.aspx">here</a> .  Nevertheless, there were problems with the correct transmission of key presses on the keyboard, so unfortunately, with the current version of the driver, you will have to look for workarounds. <br><br>  One of these workarounds is clicking the coordinates of a given element with the mouse.  This is not a trivial task, but here you can use Actions: <br><br><pre> <code class="java hljs">Actions builder = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Actions(driver); Action enter = builder .moveToElement(wrk) .moveByOffset(x,y) .click() .build(); enter.perform();</code> </pre><br>  where <i>wrk</i> is the name of WebElement, from the center of which we will move the mouse;  <i>x</i> , <i>y</i> - the distance that we will move (a positive value of <i>x</i> moves the cursor to the right, a positive <i>y</i> - down). <br><br><h4>  Just a little bit about the overall project structure. </h4><br>  As it was already slightly noted above, ‚Äúlevers‚Äù are the main element of interaction with the outside world.  They can be conveniently described by a class with the <i>name</i> , <i>className</i> and <i>automationId</i> fields and stored in separate classes by blocks. <br><br>  Since automated tests often repeat any steps of each other, these procedures are also conveniently arranged in the form of separate static methods and also stored in separate classes by blocks. <br><br>  Everything else can be safely done as usual - classes with tests, a class for running tests, and so on. <br><br><h4>  Conclusion </h4><br>  In general, immersion into the world of Winium is quite interesting and not very difficult.  Thanks to all readers who have read this post to the end.  I really hope that this post will help someone in mastering Winium.  Special thanks to my partner Eugene, with whom we plunged into his jungle.  All good! </div><p>Source: <a href="https://habr.com/ru/post/331292/">https://habr.com/ru/post/331292/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../331280/index.html">Kotlin aftertaste, part 1</a></li>
<li><a href="../331282/index.html">Assessment of connectedness of events using Bayes</a></li>
<li><a href="../331286/index.html">Materials of the student school "Recent Advances in Algorithms"</a></li>
<li><a href="../331288/index.html">CameraTablet - how to make a graphics tablet using a webcam</a></li>
<li><a href="../331290/index.html">New tech trends in finance: why do we need chat bots</a></li>
<li><a href="../331294/index.html">Google Play and 2K installations per day without cash investment (+ statistics and earnings)</a></li>
<li><a href="../331296/index.html">Market applications for cash registers: the first conference CHANGE</a></li>
<li><a href="../331298/index.html">Dynamic Component Rendering in Angular 2</a></li>
<li><a href="../331300/index.html">Vulnerability Stack Clash allows you to get root-privileges in Linux and other operating systems</a></li>
<li><a href="../331302/index.html">Birobidzhan on the bright side: how we have lit up the city for our money</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>