<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Flash + .–†–§. What to do?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Actually, the problem. 
 The flash movie cannot access resources on the server if it is posted on a site with an international name (in particular, th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Flash + .–†–§. What to do?</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/476/83f/965/47683f965a1bdb4a23cd9602b802f5a2.png" align="left">  Actually, the problem. <br>  The flash movie cannot access resources on the server if it is posted on a site with an international name (in particular, the Russian Federation).  Seen in Firefox browser under Windows. <br>  Not a very nice glitch, especially given the prevalence of this browser and this platform ... A quick look at the forums did not bring the desired results, and I had to take up the research.  So, the details ... <br><a name="habracut"></a><br><h3>  <b>Tests</b> </h3><br>  To begin with - a test flash drive.  A code of several lines is enough for our research: <br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> xml = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> XML; xml.onLoad = <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ _root.txt.text = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.toString(); }; xml.load(<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(_root.link) === <span class="hljs-string"><span class="hljs-string">"undefined"</span></span> ? <span class="hljs-string"><span class="hljs-string">"test.xml"</span></span> : _root.link);</code> </pre> <br>  And, of course, you need not to forget the text field with the name txt on the first frame.  The algorithm is simple: load the ‚Äútest.xml‚Äù file and display its contents.  If the ‚Äúlink‚Äù parameter is specified, then XML is loaded from the specified address.  We will make the corresponding ‚Äútest.xml‚Äù the easiest: <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">test</span></span></span><span class="hljs-tag">&gt;</span></span>Test<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">test</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  The files ‚Äútest.swf‚Äù and ‚Äútest.xml‚Äù are uploaded to the server and begin the tests.  For the tests, two domains were used, one RU and one RF, which are synonymous.  Expected result - the flash drive should display the contents of the XML file on any domain.  Cope with the test: <br><ul><li>  Opera 11 (Windows, Linux) </li><li>  Google Chrome 9 (Windows, Linux) </li><li>  Internet Explorer 8 </li><li>  Internet Explorer 6 (punycode address) </li></ul>  Of the common browsers, the test failed only in Firefox (Windows, Linux).  The Lynx and W3M browsers did not participate, for obvious reasons. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  <b>Study</b> </h3><br>  What is wrong?  Let's try to test the download of resources from the server via Firebug. <br><br>  With the domain RU everything is fine: <br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/9de/5f2/c56/9de5f2c567d5417b56729436dec4b702.png" width="512"></a> <br><br>  But with the domain of the Russian Federation something is wrong: <br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/0d3/62c/fe7/0d362cfe7f53e220285e31fd0d76894f.png" width="512"></a> <br><br>  Actually, the problem is visible: the Flash plugin in combination with Firefox makes an address request without encoding the domain name in punycode, which causes the problem. <br><br>  Okay, try differently.  We will do so that the data is loaded from the domain RU.  Add to the address of the parameter "link", which we have provided specifically for this case. <br><blockquote>  It is clear that we will fail because of problems with cross-domain queries.  But since we decided to act consistently - we will be consistent. </blockquote>  Q.E.D: <br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/a71/3ef/203/a713ef2039a808346d2706716375a6b0.png" width="512"></a> <br><br>  Armed with the <a href="http://www.adobe.com/devnet/articles/crossdomain_policy_file_spec.html">documentation</a> , create a file "crossdomain.xml" in the root of the site.  This file will be requested from the RU domain (from the domain where the XML file is located), and it should indicate which flash clips can upload data (or, more precisely, on which domains these clips are published). <br><br>  That's just the question: which domain to allow requests to our XML file?  After all, as we have seen, there are certain problems with a Cyrillic domain name ... <br><br>  We have consistently tested all possible domain names of the Russian Federation: <br><ul><li>  Cyrillic (.rf) </li><li>  Punycode (.xn - p1ai) </li><li>  URL coding, lower case (.% D1% 80% d1% 84) </li><li>  URL coding, upper case (.% D1% 80% D1% 84) </li></ul>  And ... All without success.  All variations on the crossdomain.xml theme of this type did not produce results: <br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">cross-domain-policy</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">allow-access-from</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">domain</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"."</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">allow-access-from</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">domain</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*.."</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">allow-access-from</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">domain</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"xn--80asmaqi.xn--p1ai"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">allow-access-from</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">domain</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*.xn--80asmaqi.xn--p1ai"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">allow-access-from</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">domain</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"%D1%81%D0%B0%D0%B9%D1%82%D0%BD%D0%BD.%D1%80%D1%84"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">allow-access-from</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">domain</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*.%D1%81%D0%B0%D0%B9%D1%82%D0%BD%D0%BD.%D1%80%D1%84"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">allow-access-from</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">domain</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"%d1%81%d0%b0%d0%b9%d1%82%d0%bd%d0%bd.%d1%80%d1%84"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">allow-access-from</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">domain</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*.%d1%81%d0%b0%d0%b9%d1%82%d0%bd%d0%bd.%d1%80%d1%84"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">cross-domain-policy</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  It looked like this: <br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/5cd/868/430/5cd86843017b38fc1758fd6668b5de16.png" width="512"></a> <br><br>  That is, ‚Äúcrossdomain.xml‚Äù is loading, but the flash player decides that XML data from this site cannot be downloaded. <br><br><h3>  <b>Decision</b> </h3><br>  The last option left is to specify "*" as the domain.  Thus, "crossdomain.xml" acquired the following form: <br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">cross-domain-policy</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">allow-access-from</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">domain</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"*"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">cross-domain-policy</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  And - lo and behold! <br> <a href=""><img src="https://habrastorage.org/getpro/habr/post_images/0e4/46f/4b2/0e446f4b2c6750db63aaabc8c8735c45.png" width="512"></a> <br><br><h3>  <b>Morality</b> </h3><br>  The solution to the problem exists.  Without <a href="http://forum.mozilla-russia.org/viewtopic.php%3Fid%3D24640">bullying</a> .  The solution, of course, is not ideal, because access to data through ‚Äúcrossdomain.xml‚Äù opens immediately for all sites.  However, this is not always a problem, because who needs it - they will be able to access the data in another way, not paying attention to ¬´crossdomain.xml¬ª. <br><br>  Regarding whether to specify the host name in the parameters (flashvars), or whether it needs to be included in the flash movie source, the question remains open.  Surely, many developers, in order to protect, prefer to ‚Äúhardcode‚Äù the names of sites in flash drives, and for sure many people prefer to put these addresses into parameters.  I fully admit that both are right, depending on the project and tasks.  And I prefer not to argue on this topic. <br><br><blockquote>  Materials: <br><ul><li>  <a href="">Flash</a> </li><li>  <a href="">ActionScript</a> </li><li>  <a href="">XML</a> </li><li>  <a href="http://sitenn.ru/test/index.html">HTML + SWFObject</a> </li></ul></blockquote></div><p>Source: <a href="https://habr.com/ru/post/113887/">https://habr.com/ru/post/113887/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../113882/index.html">Nokia and Microsoft: Why?</a></li>
<li><a href="../113883/index.html">Google App Engine Caching</a></li>
<li><a href="../113884/index.html">What do you think will be with Yota in the near future?</a></li>
<li><a href="../113885/index.html">2 abandoned projects</a></li>
<li><a href="../113886/index.html">Arkady Moreinis, Glavstart: "I work with startups, but do not sell coffee boxes"</a></li>
<li><a href="../113889/index.html">Full list of patches made in Windows 7 / Windows 2008 Server R2 SP1</a></li>
<li><a href="../113890/index.html">Self-made telepresence robot for only $ 500</a></li>
<li><a href="../113892/index.html">"Samsung: We do not trust our customers!"</a></li>
<li><a href="../113894/index.html">Parrot</a></li>
<li><a href="../113898/index.html">St. Petersburg Alt.Net: 26th Meeting</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>