<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Infinite non-repeating textures using Van's mosaic</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="There are always some problems with textures! It turns out that you can not take any pictures and stick on the model. Then at the junction of the text...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Infinite non-repeating textures using Van's mosaic</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/storage2/fdf/664/949/fdf66494923365fac26842e354b0d547.jpg"><br><br>  There are always some problems with textures!  It turns out that you can not take any pictures and stick on the model.  Then at the junction of the textures, stitches appear, which you are trying to smooth down.  It seems that he has already smoothed everything, but an eye, such a prankster, still notices repetitive patterns and destroys the illusion. <br><br>  You can make the texture bigger so that the repeating pieces are further separated from each other and are not so noticeable.  You can even make it absolutely huge, for a couple of hundred thousand pixels, so that it covers the entire scene without any seams or repetitions.  Such a technique is called mega-texture.  But mega-textures and virtual textures close to them complicate the work with memory, special tools are required to work with them, and in general it is still a young technology. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      How to be?  There is one trick - non-periodic mosaics.  They lack the repeatability problem and are fairly simple to implement.  One of these mosaics was invented by the Chinese mathematician Wang Hao in 1961.  Elements of this mosaic can be represented as rectangles with multi-colored edges.  But in order to understand the principle of its work, you must first understand the classic method of filling areas with textures. <br><a name="habracut"></a><br><img src="https://habrastorage.org/storage2/769/a39/059/769a39059d373472162e3e1b64fe9959.png"><br>  And the classical method is as follows: take the picture you like, we pave a small area with it for the test and immediately see all the bad border places.  After that, we alter the picture so that the right side coincides with the left, and the top with the bottom.  Done, texture can be used. <br><br><img src="https://habrastorage.org/storage2/ef8/a02/f77/ef8a02f772bb8a50cf7468b38ebaf2ec.png"><br><br>  In other words, it is necessary to ensure that the horizontal and vertical edges of adjacent textures smoothly flow into each other.  It turns out a container for the image, which fits well next to other containers. <br><br><img src="https://habrastorage.org/storage2/137/188/59b/13718859bfb976878a2e3ef6a0958bbb.png"><br><br>  Develop the idea further.  Internal filling of containers can be anything.  You can make many different variants of the same texture and pave the area with random tiles from the set.  But whatever one may say, even with this approach, there remains a repeating mesh from the edges of the tile.  Therefore, you need to come up with a way to mix the edges. <br><br><img src="https://habrastorage.org/storage2/21c/2e8/c0b/21c2e8c0b2047a889d6f53d27444a5d6.png"><br><br>  In fact, the right and left sides of one tile do not have to be combined with each other, as long as they are combined with adjacent tiles.  You can make several texture variants with different edges and pack them into an atlas.  Then, during the laying of the textures, simply take a random tile with a edge that matches the adjacent laid tiles. <br><br>  Unfortunately, the size of the atlas for a full set of tiles grows very quickly with the number of facet variations.  The calculation is carried out according to the following formula: <i>N <sup>2</sup> * M <sup>2</sup></i> , where <i>N</i> is the number of horizontal faces, <i>M</i> is the number of vertical faces.  For example, for two options on the horizontal and vertical there are sixteen different tiles.  If you just need a guaranteed opportunity to continue the mosaic, the formula will be simpler: <i>2 * N * M.</i> <br><br><img src="https://habrastorage.org/storage2/779/709/ef1/779709ef1c6f417307186089c132fa65.png"><br><br>  Tiles of satin can pave an arbitrarily large space.  One random tile is taken, the second with a suitable face is applied to it, the third is applied to the second tile, and so on until the end of the row.  When choosing a tile in the second row, neighbors from the first row are additionally taken into account.  The picture above shows an atlas on the left and a mosaic on the right. <br><br><img src="https://habrastorage.org/storage2/f1f/7aa/ca6/f1f7aaca6f88185a2494a618dc51c123.png"><br><br>  How to create an atlas of tiles?  You can take one large picture and put a grid of colored faces on top of it.  Then select the appropriate stitch for each color and multiply it along the grid.  Or go from the reverse: first make a grid, then fill in the empty spaces.  Below are links to more detailed instructions. <br><br><img src="https://habrastorage.org/storage2/0a9/155/78f/0a915578fb2cb91b1fcd2b4635ef1c55.png"><br><br>  In the illustration above, on the left, the simple repetition of the created atlas, on the right, the mosaic of Van collected from it.  The resulting mosaic has no noticeable repetitions, it looks random and fluid. <br><br>  Of course, Van's mosaic is not perfect, it has a problem with the corners of the tiles.  Mosaic solves the problem of horizontals and verticals, but there are still diagonals, because of which artifacts may appear at the junction of four tiles.  But this mosaic is simple and can be used not only for texturing, but also for procedural generation of floor plans or dungeons. <br><br><img src="https://habrastorage.org/storage2/c45/088/0f9/c450880f900f475cff91fb64c4d6f45a.png"><br><br>  I sketched a simple C # code for Unity3d for working with Van's mosaic, you can look at it at the links below. <br><br>  <a href="http://basmanovdaniil.github.io/WangTiles">Unity Web Player</a> |  <a href="">Windows</a> |  <a href="">Linux</a> |  <a href="">Mac</a> |  <a href="https://github.com/BasmanovDaniil/WangTiles">Sources on GitHub</a> <br><br>  Spacebar - new random texture, 1, 2, 3 - select atlas, Esc - exit. <br>  For Linux users: Make the WangTiles file executable using ‚Äúchmod + x WangTiles‚Äù and run. <br><br>  Useful links on the topic: <br>  <a href="http://www.pathofexile.com/forum/view-thread/55091">Instructions for creating atlases</a> <br>  <a href="http://nothings.org/gamedev/herringbone/">Procedural dungeon generation</a> <br>  <a href="http.developer.nvidia.com/GPUGems2/gpugems2_chapter12.html">Read more about creating atlases of different sizes.</a> <br>  <a href="http://robburke.net/mle/wang/">Semi-automatic atlas generator</a> <br><br>  <b>At the request of the workers a small addition about creating atlases:</b> <br><br>  Take the big picture you like, put a grid on top for convenience in Photoshop or wherever. <br><br><img src="https://habrastorage.org/storage2/103/c47/f65/103c47f658da6b28461bd245fd8c4613.jpg"><br><br>  For each color of the grid, you need to select a segment of the image to create a new grid.  Simply multiply each segment and put the copies in columns and columns. <br><br><img src="https://habrastorage.org/storage2/0ad/86a/eb0/0ad86aeb00b7e688050931fdb959187a.jpg"><br><br>  The grid initially turns out very curve and with a bunch of ugly seams.  We apply all the available photoshop magic and make the seams invisible.  In the example below, I just anointed the grid with a little eraser.  It turns out the atlas - a new picture that can be cut into pieces that will be combined with each other. <br><br><img src="https://habrastorage.org/storage2/db5/a55/132/db5a551320ff308775e6be16b1c80105.jpg"><br><br>  Further, without elementary programming is not enough, you can collect everything by hand, but it will take a lot of time.  Use the atlas created in the code, select pieces from it and make a mosaic.  Elementary.  The hardest thing is to make a beautiful satin, but with textures it is always like that. <br><br>  Actually, I just retold the instructions <a href="http://www.pathofexile.com/forum/view-thread/55091">from here</a> .  Read, everything is well painted there. <br><br><img src="https://habrastorage.org/storage2/386/cb5/568/386cb55682e529cc61db5c840eb3de56.png"></div><p>Source: <a href="https://habr.com/ru/post/185760/">https://habr.com/ru/post/185760/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../185746/index.html">Heavy FPV-quadcopter - continued: APM 2.5 and active camera mount</a></li>
<li><a href="../185750/index.html">jQuery plugin for using SVG graphics. Part 1</a></li>
<li><a href="../185752/index.html">Biryulki and Gugloservis</a></li>
<li><a href="../185754/index.html">Unlocking AES-NI on Lenovo U310</a></li>
<li><a href="../185756/index.html">4K video of Saturn and its satellites</a></li>
<li><a href="../185764/index.html">Device file UEFI BIOS, part and a half: UEFI Platform Initialization</a></li>
<li><a href="../185766/index.html">Vkontakte iOS SDK v2</a></li>
<li><a href="../185768/index.html">Oracle 12c Data Redaction. Hiding information from unprivileged users</a></li>
<li><a href="../185770/index.html">QLiveBittorrent - console bittorrent client for viewing files before downloading</a></li>
<li><a href="../185772/index.html">Technology companies recognize sarcasm</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>