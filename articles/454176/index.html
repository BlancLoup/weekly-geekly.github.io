<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Uibook - a tool for visual testing of React-components with media queries</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! My name is Vitaly Rizo, I am a front-end developer at Amplifer. We made Uibook - a simple tool for visual testing of React-components with real...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Uibook - a tool for visual testing of React-components with media queries</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/webt/uz/dp/jl/uzdpjlgxekghnkteead18bo2kr0.png"></p><br><p>  Hello!  My name is Vitaly Rizo, I am a front-end developer at Amplifer.  We <a href="https://amplifr.com/uikit/">made</a> Uibook - a simple tool for visual testing of React-components with real media queries.  I'll tell you how it works and how it can be useful to you. </p><a name="habracut"></a><br><p><img src="https://habrastorage.org/webt/-r/_r/bd/-r_rbdnu4kpwq0dmoa3wrf5izw4.png"></p><br><p><img src="https://habrastorage.org/webt/lu/cw/ay/lucwayw8x5qvod7fyr3ncusud_c.gif"></p><br><h2 id="zachem-sdelali-i-v-chyom-polza">  Why did and what is the use </h2><br><p>  When creating new components, we suffered when refactoring - to check, we had to change attributes through DevTools manually, we could miss some trifles.  Therefore, we decided to make a page where you can quickly test components. </p><br><p>  Uibook allows you to quickly see components in any states and combinations of parameters (props).  With support for media queries, the developer can display desktop and mobile versions of components on one page.  But Uibook is not only useful for developers: </p><br><ul><li>  designers can, on their device, without raising the local server, look at all sorts of component states and submit edits; </li><li>  managers see that even a simple, seemingly popup, can contain a bunch of boundary conditions that developers have to take into account - this helps them to better understand the device interface of the product from the inside; </li><li>  Editors can use the Live Text Editing mode to try on the text for the interface in real components so that it looks flawless. </li></ul><br><h2 id="chem-otlichaetsya-ot-analogov">  What is different from analogues </h2><br><p><img src="https://habrastorage.org/webt/s4/7n/a-/s47na-e7ggmrmf-p3lat-g8_dhc.png"></p><br><p>  You may ask why reinvent the wheel when there are ready-made Storybook, Styleguidist and similar solutions?  My project has a different approach and I highlight three main differences: </p><br><ul><li>  In Uibook, you can immediately see the components in conditions of limited width and height of devices; </li><li>  It does not require a separate builder and easily connects to an existing project with a couple of lines in the configuration file; </li><li>  It is understood that the pages with the components will be publicly accessible, so that any user can find errors and leave feedback. </li></ul><br><p>  Uibook is needed mainly for visual testing, not development, although it is convenient to develop the ‚Äúrepresenting‚Äù part of the project with it.  Did you have to make global changes to the project?  Go through all the pages to make sure all components are displayed correctly. </p><br><p><img src="https://habrastorage.org/webt/cw/w8/-3/cww8-3cti9xohlspaaur_2pifxm.png"></p><br><h2 id="tehnicheskaya-realizaciya">  Technical implementation </h2><br><p>  Uibook is a React-application in which the Pages are transferred - sets of "cases", that is, states of one component (props and callbacks).  Next, Uibook renders the selected Page on one screen using two controllers: with and without media queries. </p><br><p> Since it is impossible to emulate media queries using CSS and JavaScript, we went a simple way: render the component inside the <code>&lt;iframe&gt;</code> if the user specified the width or height of the screen. </p><br><p>  The main controller wraps the component in any custom wrapper, and also allows you to select values ‚Äã‚Äãin the browser.  In the <code>iframe</code> data is transmitted via a link.  Also, the main controller adds hotkeys and the ability to edit text. </p><br><p>  I did not want to have separate builders for the project and visual testing.  Other products force you to do this, which is why you have to store more files, dependencies, it all takes longer to configure, it starts up longer, it‚Äôs harder to build and deploy.  Uibook integrates into the project collector, as it is simply added as a Webpack plugin: </p><br><pre> <code class="javascript hljs">plugins: [ ‚Ä¶ <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> UibookPlugin({ <span class="hljs-attr"><span class="hljs-attr">controller</span></span>: path.join(__dirname, <span class="hljs-string"><span class="hljs-string">'../controllers/uibook.js'</span></span>) }) ]</code> </pre> <br><p>  <em>webpack.config.js</em> </p><br><p>  Uibook creates a separate chunk and does not increase the size of the main application.  It works through WebPack <code>SingleEntryPlugin</code> or <code>MultiEntryPlugin</code> .  It tightens styles and scripts from the main application, taking into account caching ("cachebuster").  Here is how the plugin gets the list of necessary files: </p><br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">let</span></span> files = compilation.chunks.find(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">i</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> i.name === <span class="hljs-string"><span class="hljs-string">'uibook'</span></span> }).files</code> </pre> <br><p>  It then generates the HTML file without dependencies.  After all, this is a very simple task, there is no need to pull the library for this.  We take a template, add imports, add to the issue: </p><br><pre> <code class="javascript hljs"> compilation.assets[outputPath + <span class="hljs-string"><span class="hljs-string">'/index.html'</span></span>] = { ‚Ä¶ }</code> </pre> <br><p>  But if you still have <code>HtmlWebpackPlugin</code> connected, you will have to add <code>uibook</code> to the exceptions, which Uibook will kindly remind you of. </p><br><p><img src="https://habrastorage.org/webt/-i/pm/yp/-ipmypaduk9f0_isxvf3yslp7vo.png"></p><br><h2 id="uibook-ochen-prost">  Uibook is very simple </h2><br><p>  It only has React, Webpack dependencies and <code>create-react-class</code> .  It is written in ES5, so it will work, even if you do not have Babel in the project.  And if there is, then there will be no plug-in conflicts.  Hints are built into Uibook if something is wrong in the configuration file. </p><br><p><img src="https://habrastorage.org/webt/zc/w7/c6/zcw7c6ouopmp2xqeu4owuqfesds.png"></p><br><h2 id="uibook-gibok">  Uibook is flexible </h2><br><p><img src="https://habrastorage.org/webt/bg/wk/th/bgwkth3tdp2m36nzttt9hjmo5aq.gif"></p><br><p>  You can wrap all the components in your controller.  It can be a wrapper for Redux, Context or all at once.  Here is an example with a new Context API: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> UibookStarter({ <span class="hljs-attr"><span class="hljs-attr">wrapper</span></span>: <span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">children, props</span></span></span><span class="hljs-function">) =&gt;</span></span> &lt;Context.Provider value={ props }&gt; { children } &lt;<span class="hljs-regexp"><span class="hljs-regexp">/Context.Provider&gt;, values: { locale: ['ru', 'en'], theme: ['dark', 'light'] }, ‚Ä¶ })</span></span></code> </pre> <br><p>  The list of user keys and their values ‚Äã‚Äãwill be displayed in the top navigation menu. </p><br><h2 id="kak-vnedrit-uibook-v-proekt">  How to implement Uibook in the project </h2><br><p>  For example, we want to add the Button component, which lies in <code>src/button.js</code> .  You need to install the <code>uibook</code> package, create a file controller and a page file.  The file controller is used to import your Uibook tests, and the file page is a set of "cases", combinations of parameters for one component. </p><br><p>  Here's how to do it: </p><br><p>  1) Proceed, <code>$ yarn add uibook</code> ; <br>  2) Here you can use the <code>$ npm init uibook</code> , which will create sample files, or you can do everything manually.  Approximately the structure will be as follows: </p><br><pre> <code class="plaintext hljs">your-project ‚îú‚îÄ‚îÄ uibook ‚îÇ ‚îú‚îÄ‚îÄ button.uibook.js ‚îÇ ‚îî‚îÄ‚îÄ uibook-controller.js ‚îú‚îÄ‚îÄ src ‚îÇ ‚îî‚îÄ‚îÄ button.js ‚îú‚îÄ‚îÄ webpack.config.js ‚îî‚îÄ‚îÄ package.json</code> </pre> <br><p>  3) Connect the plugin in the Webpack configuration file: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">let</span></span> UibookPlugin = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'uibook/plugin'</span></span>) <span class="hljs-built_in"><span class="hljs-built_in">module</span></span>.exports = { ‚Ä¶ plugins: [ <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> UibookPlugin({ <span class="hljs-attr"><span class="hljs-attr">controller</span></span>: path.join(__dirname, <span class="hljs-string"><span class="hljs-string">'../src/uibook-controller.js'</span></span>), }) ], }</code> </pre> <br><p>  <em>webpack.config.js</em> </p><br><p>  4) Write the test in <code>uibook/button.uibook.js</code> .  If you used the <code>init</code> command, this example has already been created: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> UibookCase <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'uibook/case'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> Button <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'../src/button.js'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> PROPS = { <span class="hljs-attr"><span class="hljs-attr">onClick</span></span>: UibookCase.event(<span class="hljs-string"><span class="hljs-string">'onClick'</span></span>) } <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> ButtonUibook = { <span class="hljs-attr"><span class="hljs-attr">component</span></span>: Button, <span class="hljs-attr"><span class="hljs-attr">name</span></span>: <span class="hljs-string"><span class="hljs-string">'Button'</span></span>, <span class="hljs-attr"><span class="hljs-attr">cases</span></span>: [ <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> =&gt;</span></span> &lt;UibookCase props={{ ...PROPS, <span class="hljs-attr"><span class="hljs-attr">isLarge</span></span>: <span class="hljs-literal"><span class="hljs-literal">true</span></span> }}&gt; Large Button &lt;<span class="hljs-regexp"><span class="hljs-regexp">/UibookCase&gt;, () =&gt; &lt;UibookCase props={{ ...PROPS, isDisabled: true }}&gt; Disabled Button &lt;/</span></span>UibookCase&gt; ] } <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> ButtonUibook</code> </pre> <br><p>  <em>button.uibook.js</em> </p><br><p>  5) Import and transfer this uibook test in the file controller: </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> UibookStarter <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'uibook/starter'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> ButtonUibook <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> <span class="hljs-string"><span class="hljs-string">'./button.uibook'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">export</span></span> <span class="hljs-keyword"><span class="hljs-keyword">default</span></span> UibookStarter({ <span class="hljs-attr"><span class="hljs-attr">pages</span></span>: { <span class="hljs-attr"><span class="hljs-attr">Button</span></span>: ButtonUibook, } })</code> </pre> <br><p>  <em>uibook-controller.js</em> </p><br><p>  6) Done!  We start our project as usual (for example, <code>$ yarn start</code> ) and open the <code>/uibook</code> in the browser.  We will see three cases with a button (if you have the <code>/src/button.js</code> component, of course): </p><br><p><img src="https://habrastorage.org/webt/81/6v/ou/816vou1kp4ulmlidd1jerk4vl3g.png"></p><br><h2 id="kak-uibook-pomog-nam">  How Uibook Helped Us </h2><br><p>  We <a href="https://amplifr.com/uikit/">use</a> Uibook in our work for more than a year with the whole team.  Front-end tenders develop new components only through Uibook, simultaneously creating a test file with boundary parameters (props).  It is much faster than writing a parallel controller to see the component in a real web application.  Moreover, this test file will be used later for visual testing after any global changes. </p><br><p>  Andrei Sitnik <a href="https://habr.com/ru/users/iskin/" class="user_link">Iskin</a> , a leading frontend developer at Evil Martians, notes that Uibook makes work calmer: </p><br><blockquote>  Uibook finally gave us the confidence that after updating normalize.css, nothing broke.  Just open and view all the components in a row.  This is where the main feature, <code>@media</code> support, helps a lot.  Developers have less fears, managers have fewer bugs.  Everyone is happy. </blockquote><p><img src="https://habrastorage.org/webt/-r/_r/bd/-r_rbdnu4kpwq0dmoa3wrf5izw4.png"><br>  And the testing process itself has been simplified.  Now the front-end is writing a new component (view-component), simultaneously creating a file with parameters (props).  The controller is not needed at the same time - you can deploy it in the course of development without implementing the component in the web application itself. </p><br><p>  Other front-end developers review the component using a local or closed Uibook: you can click on all the buttons and check that callbacks are invoked.  So we save up to 30 hours each month for testing components. </p><br><p>  Damir Melnikov, frontend developer of Amplifer, also notes the possibility of working together with designers, products and editors: </p><br><blockquote>  Uibook allows me to quickly work on components - try on new styles, follow the mobile version, learn how the component behaves with different input.  In addition, Uibook allows you to quickly share your work with the designer (live layout), editor (for reading interface texts) and other front-end developers. </blockquote><p><img src="https://habrastorage.org/webt/-r/_r/bd/-r_rbdnu4kpwq0dmoa3wrf5izw4.png"><br>  Content-lead "Amplifer" Alexander Marficnyn notes how Uibook simplified the writing of interface texts: </p><br><blockquote>  When you make texts for an interface, you often work blindly and do not see what the inscriptions will look like in a ‚Äúlive‚Äù product.  Uibook solves this problem.  You can not only read old texts, but also create new ones, relying on the limitations of the components and trying on your own drafts on a real interface.  All text elements are editable, it allows you to get a solid result - from the title to even the smallest inscription. <br><br>  And the work process itself has become more transparent - with Uibook you better understand the device of the product and the interface from the inside, you begin to better understand the importance of good text for the interface. </blockquote><p><img src="https://habrastorage.org/webt/-r/_r/bd/-r_rbdnu4kpwq0dmoa3wrf5izw4.png"><br>  ‚åò‚åò‚åò </p><br><p>  <em>I hope that Uibook will be used in your project.</em>  <em>If you have any questions, then see the <a href="https://github.com/vrizo/uibook/">detailed instructions</a> in the repository on Gitkhab.</em>  <em>Or email <a href="https://twitter.com/vitaliirizo">me on twitter</a> or <a href="">email</a> .</em> </p><br><p>  <em>Thanks to Alexander Marfitsin <a href="https://habr.com/ru/users/marfitsin/" class="user_link">marfitsin</a> for help in preparing the article.</em> </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/454176/">https://habr.com/ru/post/454176/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../454166/index.html">June 6 - VeeamON Forum in Moscow</a></li>
<li><a href="../454168/index.html">The main arena of the country. How were updated "Luzhniki" before the World Cup</a></li>
<li><a href="../45417/index.html">Project documentation or Mom told me ...</a></li>
<li><a href="../454170/index.html">Welcome to DroidHeads Meetup June 8</a></li>
<li><a href="../454172/index.html">Sending statistics from a DataFrame to BigQuery using the example of Yandex Yandex Statistics</a></li>
<li><a href="../454178/index.html">An example of calculating the pension IT-person from Moscow</a></li>
<li><a href="../45418/index.html">Do you use code autogeneration based on UML diagrams?</a></li>
<li><a href="../454180/index.html">Schr√∂dinger Cloud Backup</a></li>
<li><a href="../454182/index.html">Full interview with the dean of the Python faculty at GeekBrains - how and why to learn the language to beginners</a></li>
<li><a href="../454184/index.html">KubeCon Europe 2019: How we first visited the main event on Kubernetes</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>