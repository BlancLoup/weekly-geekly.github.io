<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We write your mapper for .NET Standard 2.0</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In today's article, I would like to tell you about a short adventure in writing my mapper for .NET Standard 2.0. The link to github and the results of...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We write your mapper for .NET Standard 2.0</h1><div class="post__text post__text-html js-mediator-article"><p>  In today's article, I would like to tell you about a short adventure in writing my mapper for .NET Standard 2.0.  The link to github and the results of the benchmarks are attached. </p><a name="habracut"></a><br><p>  I think it‚Äôs no secret to any of you what a mapper is and what it is for.  Literally at every step in the process of work, we encounter some examples of mappings (or transformations) of data from one type to another.  These include mapping of records from the repository to the domain model, mapping the response of the remote service to the view model and only then to the domain model, etc.  Often, on the border of the level of abstraction, there are input and output data formats and it is precisely at the moments of interaction of abstractions that such a thing as a mapper can show itself in all its glory, bringing with it a substantial saving of time and effort for the developer and, as a result, taking on share of total system performance. </p><br><p>  Based on this, MVP requirements can also be described: </p><br><ol><li>  Speed ‚Äã‚Äãperformance (less performance &amp; memory impact); </li><li>  Ease of use (clean &amp; easy to use API). </li></ol><br><p>  As for the first point, BenchmarkDotNet and thoughtful implementation, not without some optimizations, will help us with this.  For the second, I wrote a simple unit test, which, in some way, acts as the documentation for the API of our mapper: </p><br><pre><code class="hljs cs">[<span class="hljs-meta"><span class="hljs-meta">TestMethod</span></span>] <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">WhenMappingExist_Then_Map</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> dto = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> CustomerDto { Id = <span class="hljs-number"><span class="hljs-number">42</span></span>, Title = <span class="hljs-string"><span class="hljs-string">"Test"</span></span>, CreatedAtUtc = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DateTime(<span class="hljs-number"><span class="hljs-number">2017</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>), IsDeleted = <span class="hljs-literal"><span class="hljs-literal">true</span></span> }; mapper.Register&lt;CustomerDto, Customer&gt;(); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> customer = mapper.Map&lt;CustomerDto, Customer&gt;(dto); Assert.AreEqual(<span class="hljs-number"><span class="hljs-number">42</span></span>, customer.Id); Assert.AreEqual(<span class="hljs-string"><span class="hljs-string">"Test"</span></span>, customer.Title); Assert.AreEqual(<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DateTime(<span class="hljs-number"><span class="hljs-number">2017</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>), customer.CreatedAtUtc); Assert.AreEqual(<span class="hljs-literal"><span class="hljs-literal">true</span></span>, customer.IsDeleted); }</code> </pre> <br><p>  So, we need to implement only 2 simple methods: </p><br><ol><li>  <code>void Register&lt;TSource, TDest&gt;()</code> ; </li><li>  <code>TDest Map&lt;TSource, TDest&gt;(TSource source)</code> . </li></ol><br><h2 id="registraciya">  check in </h2><br><p>  In fact, the registration process can be carried out when you first call the <code>Map</code> method, thus becoming redundant.  However, I rendered it separately for the following reasons: </p><br><ol><li>  For verification, in the absence of a default constructor (or the inability to perform mapping of the resulting type) in my opinion, this should be reported as early as possible at the configuration stage, thereby observing the Fail fast principle.  Otherwise, the error of the impossibility of creating an instance of a type may overtake us already at the stage of the execution of the infrastructure code or business logic; </li><li>  For expansion, the API is currently extremely simple and under the hood implies mapping based on naming conventions, however, it is likely that very soon we will want to introduce rules for mapping certain fields, the value for assignment of which may be the result of the method .  In this case, in order to also observe the principle of Single Responsible, such a division seems to me quite natural. </li></ol><br><p>  If the <code>Map</code> method in any mapper is the main one and the lion's share of the execution time falls on it, then the <code>Register</code> method is the opposite, for each pair of types it is called only once at the configuration stage.  That is why it is an excellent candidate for accomplishing all the necessary "heavy" manipulations: generating an optimal mapping execution plan and, as a result, further caching the obtained results. </p><br><p>  Thus, its implementation should include: </p><br><ol><li>  Building a plan for creating and initializing an instance of the required type; </li><li>  Caching results. </li></ol><br><h2 id="plan-vypolneniya">  Execution plan </h2><br><p>  In C #, there are not so many ways available to us to create and initialize an instance of a type at runtime, and the higher the level of abstraction of a particular method, the less optimal from the point of view of execution time.  Earlier, I came across a similar choice in my other small project called <a href="https://github.com/FSou1/FsContainer">FsContainer</a> and therefore the following results were not surprising to me. </p><br><pre> <code class="hljs dos">BenchmarkDotNet=v0.<span class="hljs-number"><span class="hljs-number">10</span></span>.<span class="hljs-number"><span class="hljs-number">9</span></span>, OS=Windows <span class="hljs-number"><span class="hljs-number">8</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> (<span class="hljs-number"><span class="hljs-number">6</span></span>.<span class="hljs-number"><span class="hljs-number">3</span></span>.<span class="hljs-number"><span class="hljs-number">9600</span></span>) Processor=Intel Core i5-<span class="hljs-number"><span class="hljs-number">5200</span></span>U CPU <span class="hljs-number"><span class="hljs-number">2</span></span>.<span class="hljs-number"><span class="hljs-number">20</span></span>GHz (Broadwell), ProcessorCount=<span class="hljs-number"><span class="hljs-number">4</span></span> Frequency=<span class="hljs-number"><span class="hljs-number">2143473</span></span> Hz, Resolution=<span class="hljs-number"><span class="hljs-number">466</span></span>.<span class="hljs-number"><span class="hljs-number">5326</span></span> ns, Timer=TSC .<span class="hljs-built_in"><span class="hljs-built_in">NET</span></span> Core SDK=<span class="hljs-number"><span class="hljs-number">2</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span> [Host] : .<span class="hljs-built_in"><span class="hljs-built_in">NET</span></span> Core <span class="hljs-number"><span class="hljs-number">2</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span> (Framework <span class="hljs-number"><span class="hljs-number">4</span></span>.<span class="hljs-number"><span class="hljs-number">6</span></span>.<span class="hljs-number"><span class="hljs-number">00001</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-number"><span class="hljs-number">64</span></span>bit RyuJIT DefaultJob : .<span class="hljs-built_in"><span class="hljs-built_in">NET</span></span> Core <span class="hljs-number"><span class="hljs-number">2</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span> (Framework <span class="hljs-number"><span class="hljs-number">4</span></span>.<span class="hljs-number"><span class="hljs-number">6</span></span>.<span class="hljs-number"><span class="hljs-number">00001</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-number"><span class="hljs-number">64</span></span>bit RyuJIT</code> </pre> <br><pre> <code class="hljs ruby"> <span class="hljs-params"><span class="hljs-params">| Method |</span></span> Mean <span class="hljs-params"><span class="hljs-params">| Error |</span></span> StdDev <span class="hljs-params"><span class="hljs-params">| Median |</span></span> <span class="hljs-params"><span class="hljs-params">|---------------------------- |</span></span>-----------<span class="hljs-symbol"><span class="hljs-symbol">:|----------</span></span><span class="hljs-symbol"><span class="hljs-symbol">:|----------</span></span><span class="hljs-symbol"><span class="hljs-symbol">:|-----------</span></span><span class="hljs-symbol"><span class="hljs-symbol">:|</span></span> <span class="hljs-params"><span class="hljs-params">| ExpressionCtorObjectBuilder |</span></span> <span class="hljs-number"><span class="hljs-number">8.548</span></span> ns <span class="hljs-params"><span class="hljs-params">| 0.2764 ns |</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">4541</span></span> ns <span class="hljs-params"><span class="hljs-params">| 8.608 ns |</span></span> <span class="hljs-params"><span class="hljs-params">| ActivatorCreateInstance |</span></span> <span class="hljs-number"><span class="hljs-number">79.379</span></span> ns <span class="hljs-params"><span class="hljs-params">| 1.6812 ns |</span></span> <span class="hljs-number"><span class="hljs-number">3.1987</span></span> ns <span class="hljs-params"><span class="hljs-params">| 78.890 ns |</span></span> <span class="hljs-params"><span class="hljs-params">| ConstructorInfoInvoke |</span></span> <span class="hljs-number"><span class="hljs-number">164.445</span></span> ns <span class="hljs-params"><span class="hljs-params">| 3.3355 ns |</span></span> <span class="hljs-number"><span class="hljs-number">4.3371</span></span> ns <span class="hljs-params"><span class="hljs-params">| 164.016 ns |</span></span> <span class="hljs-params"><span class="hljs-params">| DynamicMethodILGenerator |</span></span> <span class="hljs-number"><span class="hljs-number">5.859</span></span> ns <span class="hljs-params"><span class="hljs-params">| 0.2455 ns |</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">3015</span></span> ns <span class="hljs-params"><span class="hljs-params">| 5.819 ns |</span></span> <span class="hljs-params"><span class="hljs-params">| NewCtor |</span></span> <span class="hljs-number"><span class="hljs-number">6.989</span></span> ns <span class="hljs-params"><span class="hljs-params">| 0.2615 ns |</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">5741</span></span> ns <span class="hljs-params"><span class="hljs-params">| 6.756 ns |</span></span></code> </pre> <br><p>  Although <code>ConstructorInfo.Invoke</code> and <code>Activator.CreateInstance</code> fairly easy to use, in this list, by a wide margin, they are obvious outsiders due to the fact that they use <code>RuntimeType</code> and <code>System.Reflection</code> in the details of their implementations.  This is quite acceptable in everyday tasks, but it is completely inappropriate within our requirements, where creating an instance of the type is the narrowest bottle neck in terms of performance. </p><br><p>  With regard to the use of <code>Expression</code> and <code>DynamicMethod</code> , here without surprises, the result of execution are pointers to compiled functions that can only be called by passing the corresponding arguments. </p><br><p>  Although the Delegate compiled by generating the IL code on the fly works slightly faster, it does not include the code for initializing the type instance.  Moreover, for me personally, the reproduction of IL instructions via <code>ilgen.Emit</code> is a very nontrivial <code>ilgen.Emit</code> . </p><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> dynamicMethod = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DynamicMethod(<span class="hljs-string"><span class="hljs-string">"Create_"</span></span> + ctorInfo.Name, ctorInfo.DeclaringType, <span class="hljs-keyword"><span class="hljs-keyword">new</span></span>[] { <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">object</span></span>[]) }); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> ilgen = dynamicMethod.GetILGenerator(); ilgen.Emit(OpCodes.Newobj, ctorInfo); ilgen.Emit(OpCodes.Ret); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> dynamicMethod.CreateDelegate(<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(Func&lt;TDest&gt;));</code> </pre> <br><p>  That is why I stopped at the implementation using <code>Expression</code> : </p><br><pre> <code class="hljs vhdl">var <span class="hljs-keyword"><span class="hljs-keyword">body</span></span> = Expression.MemberInit( Expression.<span class="hljs-keyword"><span class="hljs-keyword">New</span></span>(typeof(TDest)), props ); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> Expression.Lambda&lt;Func&lt;TSource, TDest&gt;&gt;(<span class="hljs-keyword"><span class="hljs-keyword">body</span></span>, orig).Compile();</code> </pre> <br><h2 id="keshirovanie">  Caching </h2><br><p>  To cache the compiled delegate, which will later be used to perform the mapping, I chose between <code>Dictionary</code> and <code>Hashtable</code> .  Looking ahead, I would like to note that the key role is played not only by the type of collection, but also by the type of key by which the selection will be carried out.  To check this statement, a separate benchmark was written and the following results were obtained: </p><br><pre> <code class="hljs dos">BenchmarkDotNet=v0.<span class="hljs-number"><span class="hljs-number">10</span></span>.<span class="hljs-number"><span class="hljs-number">9</span></span>, OS=Windows <span class="hljs-number"><span class="hljs-number">8</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> (<span class="hljs-number"><span class="hljs-number">6</span></span>.<span class="hljs-number"><span class="hljs-number">3</span></span>.<span class="hljs-number"><span class="hljs-number">9600</span></span>) Processor=Intel Core i5-<span class="hljs-number"><span class="hljs-number">5200</span></span>U CPU <span class="hljs-number"><span class="hljs-number">2</span></span>.<span class="hljs-number"><span class="hljs-number">20</span></span>GHz (Broadwell), ProcessorCount=<span class="hljs-number"><span class="hljs-number">4</span></span> Frequency=<span class="hljs-number"><span class="hljs-number">2143473</span></span> Hz, Resolution=<span class="hljs-number"><span class="hljs-number">466</span></span>.<span class="hljs-number"><span class="hljs-number">5326</span></span> ns, Timer=TSC .<span class="hljs-built_in"><span class="hljs-built_in">NET</span></span> Core SDK=<span class="hljs-number"><span class="hljs-number">2</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span> [Host] : .<span class="hljs-built_in"><span class="hljs-built_in">NET</span></span> Core <span class="hljs-number"><span class="hljs-number">2</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span> (Framework <span class="hljs-number"><span class="hljs-number">4</span></span>.<span class="hljs-number"><span class="hljs-number">6</span></span>.<span class="hljs-number"><span class="hljs-number">00001</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-number"><span class="hljs-number">64</span></span>bit RyuJIT DefaultJob : .<span class="hljs-built_in"><span class="hljs-built_in">NET</span></span> Core <span class="hljs-number"><span class="hljs-number">2</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span> (Framework <span class="hljs-number"><span class="hljs-number">4</span></span>.<span class="hljs-number"><span class="hljs-number">6</span></span>.<span class="hljs-number"><span class="hljs-number">00001</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-number"><span class="hljs-number">64</span></span>bit RyuJIT</code> </pre> <br><pre> <code class="hljs ruby"> <span class="hljs-params"><span class="hljs-params">| Method |</span></span> Mean <span class="hljs-params"><span class="hljs-params">| Error |</span></span> StdDev <span class="hljs-params"><span class="hljs-params">| |</span></span>-------------------- <span class="hljs-params"><span class="hljs-params">|----------:|</span></span>----------<span class="hljs-symbol"><span class="hljs-symbol">:|----------</span></span><span class="hljs-symbol"><span class="hljs-symbol">:|</span></span> <span class="hljs-params"><span class="hljs-params">| DictionaryTuple |</span></span> <span class="hljs-number"><span class="hljs-number">80.37</span></span> ns <span class="hljs-params"><span class="hljs-params">| 1.6473 ns |</span></span> <span class="hljs-number"><span class="hljs-number">1.6179</span></span> ns <span class="hljs-params"><span class="hljs-params">| |</span></span> DictionaryTypeTuple <span class="hljs-params"><span class="hljs-params">| 49.35 ns |</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">6235</span></span> ns <span class="hljs-params"><span class="hljs-params">| 0.5832 ns |</span></span> <span class="hljs-params"><span class="hljs-params">| HashtableTuple |</span></span> <span class="hljs-number"><span class="hljs-number">103.07</span></span> ns <span class="hljs-params"><span class="hljs-params">| 2.6081 ns |</span></span> <span class="hljs-number"><span class="hljs-number">2.4397</span></span> ns <span class="hljs-params"><span class="hljs-params">| |</span></span> HashtableTypeTuple <span class="hljs-params"><span class="hljs-params">| 71.51 ns |</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">8679</span></span> ns <span class="hljs-params"><span class="hljs-params">| 0.7694 ns |</span></span></code> </pre> <br><p>  Taking this into account, the following conclusions can be made: </p><br><ol><li>  The use of the type <code>Dictionary</code> preferable to <code>Hashtable</code> in terms of the time spent on getting the collection item </li><li>  Use as a <code>TypeTuple</code> ( <a href="">src</a> ) type key is preferable to <code>Tuple&lt;Type, Type&gt;</code> in terms of time spent on <code>Equals</code> &amp; <code>GetHashCode</code> ; </li></ol><br><h2 id="mapping">  Mapping </h2><br><p>  The internal implementation of the <code>Map</code> method should be extremely simple and optimized due to the fact that this method will be called in 99.9% of cases.  Therefore, all we need to do is to quickly find the link to the previously compiled <code>Delegate</code> in the cache and return the result of its execution: </p><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> TDest Map&lt;TSource, TDest&gt;(TSource source) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> key = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> TypeTuple(<span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(TSource), <span class="hljs-keyword"><span class="hljs-keyword">typeof</span></span>(TDest)); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> activator = GetMap(key); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ((Func&lt;TSource, TDest&gt;)activator)(source); }</code> </pre> <br><h2 id="rezultaty">  results </h2><br><p>  As a result, I would like to cite the results of the final measurements of the existing (and currently up to date) mappers: </p><br><pre> <code class="hljs dos">BenchmarkDotNet=v0.<span class="hljs-number"><span class="hljs-number">10</span></span>.<span class="hljs-number"><span class="hljs-number">9</span></span>, OS=Windows <span class="hljs-number"><span class="hljs-number">8</span></span>.<span class="hljs-number"><span class="hljs-number">1</span></span> (<span class="hljs-number"><span class="hljs-number">6</span></span>.<span class="hljs-number"><span class="hljs-number">3</span></span>.<span class="hljs-number"><span class="hljs-number">9600</span></span>) Processor=Intel Core i5-<span class="hljs-number"><span class="hljs-number">5200</span></span>U CPU <span class="hljs-number"><span class="hljs-number">2</span></span>.<span class="hljs-number"><span class="hljs-number">20</span></span>GHz (Broadwell), ProcessorCount=<span class="hljs-number"><span class="hljs-number">4</span></span> Frequency=<span class="hljs-number"><span class="hljs-number">2143473</span></span> Hz, Resolution=<span class="hljs-number"><span class="hljs-number">466</span></span>.<span class="hljs-number"><span class="hljs-number">5326</span></span> ns, Timer=TSC .<span class="hljs-built_in"><span class="hljs-built_in">NET</span></span> Core SDK=<span class="hljs-number"><span class="hljs-number">2</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span> [Host] : .<span class="hljs-built_in"><span class="hljs-built_in">NET</span></span> Core <span class="hljs-number"><span class="hljs-number">2</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span> (Framework <span class="hljs-number"><span class="hljs-number">4</span></span>.<span class="hljs-number"><span class="hljs-number">6</span></span>.<span class="hljs-number"><span class="hljs-number">00001</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-number"><span class="hljs-number">64</span></span>bit RyuJIT DefaultJob : .<span class="hljs-built_in"><span class="hljs-built_in">NET</span></span> Core <span class="hljs-number"><span class="hljs-number">2</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span> (Framework <span class="hljs-number"><span class="hljs-number">4</span></span>.<span class="hljs-number"><span class="hljs-number">6</span></span>.<span class="hljs-number"><span class="hljs-number">00001</span></span>.<span class="hljs-number"><span class="hljs-number">0</span></span>), <span class="hljs-number"><span class="hljs-number">64</span></span>bit RyuJIT</code> </pre> <br><pre> <code class="hljs ruby"> <span class="hljs-params"><span class="hljs-params">| Method |</span></span> Mean <span class="hljs-params"><span class="hljs-params">| Error |</span></span> StdDev <span class="hljs-params"><span class="hljs-params">| |</span></span>----------------------- <span class="hljs-params"><span class="hljs-params">|-----------:|</span></span>----------<span class="hljs-symbol"><span class="hljs-symbol">:|----------</span></span><span class="hljs-symbol"><span class="hljs-symbol">:|</span></span> <span class="hljs-params"><span class="hljs-params">| FsMapperBenchmark |</span></span> <span class="hljs-number"><span class="hljs-number">84.492</span></span> ns <span class="hljs-params"><span class="hljs-params">| 1.6972 ns |</span></span> <span class="hljs-number"><span class="hljs-number">1.6669</span></span> ns <span class="hljs-params"><span class="hljs-params">| |</span></span> ExpressMapperBenchmark <span class="hljs-params"><span class="hljs-params">| 251.161 ns |</span></span> <span class="hljs-number"><span class="hljs-number">4.6736</span></span> ns <span class="hljs-params"><span class="hljs-params">| 4.3717 ns |</span></span> <span class="hljs-params"><span class="hljs-params">| AutoMapperBenchmark |</span></span> <span class="hljs-number"><span class="hljs-number">204.142</span></span> ns <span class="hljs-params"><span class="hljs-params">| 4.2002 ns |</span></span> <span class="hljs-number"><span class="hljs-number">9.1309</span></span> ns <span class="hljs-params"><span class="hljs-params">| |</span></span> MapsterBenchmark <span class="hljs-params"><span class="hljs-params">| 90.949 ns |</span></span> <span class="hljs-number"><span class="hljs-number">1.6393</span></span> ns <span class="hljs-params"><span class="hljs-params">| 1.4532 ns |</span></span> <span class="hljs-params"><span class="hljs-params">| AgileMapperBenchmark |</span></span> <span class="hljs-number"><span class="hljs-number">218.021</span></span> ns <span class="hljs-params"><span class="hljs-params">| 3.0921 ns |</span></span> <span class="hljs-number"><span class="hljs-number">2.7410</span></span> ns <span class="hljs-params"><span class="hljs-params">| |</span></span> CtorMapperBenchmark <span class="hljs-params"><span class="hljs-params">| 7.806 ns |</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>.<span class="hljs-number"><span class="hljs-number">2472</span></span> ns <span class="hljs-params"><span class="hljs-params">| 0.2312 ns |</span></span></code> </pre> <br><p>  The source code of the project is available on github: <a href="https://github.com/FSou1/FsMapper"></a>  <a href="https://github.com/FSou1/FsMapper">https://github.com/FSou1/FsMapper</a> . </p><br><p>  Thank you for reading to the end and, I hope, this article was useful to you.  Write in the comments that in your opinion could still be optimized. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/341502/">https://habr.com/ru/post/341502/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../341490/index.html">Introducing free ordering and extended subscription for freelancers</a></li>
<li><a href="../341492/index.html">Network visibility and Ixia solutions</a></li>
<li><a href="../341494/index.html">Intuitive algorithm development</a></li>
<li><a href="../341496/index.html">Flexible access control at the record object level</a></li>
<li><a href="../341500/index.html">Introduction to frequently used features of ES6. Part 2</a></li>
<li><a href="../341506/index.html">Reed-Solomon codes. Part 2 - Galois Field Arithmetic</a></li>
<li><a href="../341508/index.html">How do we make a map for those who make a map</a></li>
<li><a href="../341510/index.html">Taxes on the sale of Google applications and ads</a></li>
<li><a href="../341512/index.html">FrontFest.Kvartirniki - talking about the future of JavaScript and the fate of the front-end developer</a></li>
<li><a href="../341514/index.html">ITSM lived, ITSM alive, ITSM will live</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>