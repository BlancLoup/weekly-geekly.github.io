<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>SYNful Knock backdoor to attack routers: what's the problem and how to defend</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Representatives of the company Mandiant (owned by FireEye) this week published the results of a study on the security of Cisco routers. They were able...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>SYNful Knock backdoor to attack routers: what's the problem and how to defend</h1><div class="post__text post__text-html js-mediator-article"> <a href="http://habrahabr.ru/company/pt/blog/267141/"><img src="https://habrastorage.org/files/6f2/5b4/a23/6f25b4a23bc146879468c9b9d9c0ce97.jpeg"></a> <br><br>  Representatives of the company Mandiant (owned by FireEye) this week <a href="https://www.fireeye.com/blog/threat-research/2015/09/synful_knock_-_acis.html">published the</a> results of a study on the security of Cisco routers.  They were able to detect a backdoor, with the help of which attackers could carry out previously unknown attacks and collect large amounts of confidential data without attracting attention to themselves. <a name="habracut"></a><br><br><h4>  What is the problem </h4><br>  The backdoor was named SYNful Knock (the news about it was already on Habr√©) and was found on several dozens of routers around the world, including in Russia and Ukraine.  Most infected routers were found in the USA (25 devices), Lebanon (12) comes second, followed by Russia with 8 infected routers. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/files/917/791/996/9177919963e2428b83c1fbad4c756628.png"><br><br>  <i><a href="https://zmap.io/synful/">Zmap</a> data</i> <br><br>  During the attack, attackers do not exploit any serious software vulnerabilities.  Instead, an implant is used ‚Äî a modified Cisco IOS operating system image that allows you to download functional modules from the Internet.  The modules are initialized using HTTP (not HTTPS) and special TCP packets sent to the router interface. <br><br><img src="https://habrastorage.org/files/8f2/294/f90/8f2294f902854e59b83fa3edd97d164d.jpg"><br><br>  In addition, with the help of a password ‚Äúwired‚Äù into a malicious OS image, attackers can gain remote access to the router via the console or telnet.  Bookmarks are activated every time after restarting the device.  For OS substitution, stolen credentials and standard administrator passwords are used (users often forget to change the default password). <br><br>  According to the researchers, Cisco 1841, 2811, and 3825 routers are susceptible to attack. In their blog, the company <a href="http://blogs.cisco.com/security/synful-knock">confirmed</a> the problem. <br><br>  Mandiant specialists point out that detecting a backdoor indicates that other systems are likely to compromise, not just routers ‚Äî such devices usually work outside the perimeter of firewall protection and other means of protection, which makes backdoors especially dangerous for them. <br><br>  The researchers suggest that infected routers could be used to launch attacks against a number of industrial and government organizations. <br><br>  The described attack is similar to the method that Cisco employees themselves presented in August of this year.  Then the company <a href="">warned</a> customers that attackers could replace ROMMON firmware (ROM Monitor) with a malicious copy.  It also did not exploit any vulnerabilities, and hackers accessed the device using real credentials, which may indicate that employees of the organization that owns the router or people who had physical access to the device took part in the attack. <br><br><h4>  Not only Cisco </h4><br>  The attack described is not specific to Cisco routers only: similarly, you can attack network devices from different hardware manufacturers.  In particular, various researchers have <a href="https://www.troopers.de/wp-content/uploads/2012/10/TROOPERS10_Netscreen_of_the_Dead_Graeme_Neilson.pdf">published</a> information about the hacking firmware Juniper equipment. <br><br>  In addition, US intelligence officials <a href="http://www.latimes.com/business/hiltzik/la-fi-hiltzik-20141207-column.html">said</a> that the Chinese network equipment manufacturer Huawei helps industrial espionage in favor of the Chinese government with backdoors built into the firmware. <br><br>  Also in September 2015, independent information security researchers <a href="http://www.theregister.co.uk/2015/09/08/fireeye_0day/">published</a> information on a variety of zero-day vulnerabilities in FireEye products. <br><br><h4>  How to protect </h4><br>  Despite the difficulty of detecting the SYNful Knock backdoor, you can protect yourself with the help of standard security tools ‚Äî for example, the MaxPatrol security analysis system.  To do this, the administrator needs to start Cisco IOS and calculate the checksum of the OS image: <br><br><img src="https://habrastorage.org/files/a7a/0f7/c88/a7a0f7c88c214fea8c0f81e7f073d416.png"><br><br>  Next, this checksum must be entered into MaxPatrol, after which the system will check for its compliance with the real value: <br><br><img src="https://habrastorage.org/files/8fa/893/dc3/8fa893dc3bcb4f588df2aa599c57b8b4.jpg"><br><br>  At first glance, the method seems complicated, since in large organizations the number of network devices can reach several thousand.  However, even in this case, unique images of the operating system, as a rule, are no more than a few dozen, and you can quickly check them all. <br><br>  There is another option for detecting SYNful Knock.  To do this, the administrator must activate the checksum calculation of the OS image in MaxPatrol 8 using the requirement used above.  After a Cisco IOS scan using MaxPatrol, you need to configure the dif-reports and monitor changes to the checksums of the image. <br><br>  The first method, which involves a comparison with values ‚Äã‚Äãfrom <a href="">a Cisco checksum set</a> , is more efficient.  However, given the fact that software changes do not occur so often, the use of dif-reports also allows you to seriously minimize the risk of attack.  In this case, however, the script is missing, in which the image can already be modified by hackers, so experts from Positive Technologies recommend using both methods. <br><br>  We also asked Cisco representatives to comment on the discovery of the SYNful knock backdoor and provide recommendations on how to minimize the associated risks. <br><br><blockquote><img src="https://habrastorage.org/files/45d/683/c0b/45d683c0b0e448dfb467731828b0282b.jpg" width="90" align="left">  <b>Alexey Lukatsky, Cisco Information Security Business Consultant:</b> <br><br>  - The first generation of Cisco routers has been sold in quantities of about 10 million copies.  How serious can be considered the problem encountered by 79 routers?  This is not even a ten thousandth percent.  And not to mention the fact that the affected generation is removed from sales in 2010. <br><br>  Fearing [this problem] is worth those who are not having a service contract to support the purchased equipment and wanting to save money, decided to download a new version of IOS not from the Cisco site.  Fortunately, the number 79 shows that there are not so many such companies.  Of course, one cannot disregard the fact of malicious installation of such a modified network OS.  But without an understanding of the affected organizations to draw any conclusions about the focus of such a threat is premature. <br><br>  To counteract this threat, I would consider three possible scenarios.  The first is to upgrade the infrastructure equipment to the third generation of routers (ISR 4K) or at least the second (ISR G2), which are equipped with appropriate protection mechanisms against IOS image substitution and a number of other threats.  The second scenario is to build a protective chain of network security tools - IPS, ITU, means of monitoring anomalous activity around obsolete models of network equipment, as well as control physical and network access to equipment.  And finally, the third scenario is to implement the recommendations described in our IOS security guides and integrity monitoring.  The best strategy is the combination of all three scenarios. </blockquote></div><p>Source: <a href="https://habr.com/ru/post/267141/">https://habr.com/ru/post/267141/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../267123/index.html">Histogram and box with a mustache on the fingers</a></li>
<li><a href="../267125/index.html">Hexagonal architecture</a></li>
<li><a href="../267127/index.html">Airbnb pricing algorithm secrets</a></li>
<li><a href="../267131/index.html">Application for pumping. How to speed up loading C # / XAML Windows Store apps</a></li>
<li><a href="../267135/index.html">Testing sites using builds: what it is and how it works</a></li>
<li><a href="../267149/index.html">Forwarding DLNA to a remote network</a></li>
<li><a href="../267151/index.html">RailsClub 2015: Interview with Alexander Kirillov</a></li>
<li><a href="../267153/index.html">Microsoft has updated the core of Windows</a></li>
<li><a href="../267155/index.html">Optimizing dynamic memory allocation performance in a multi-threaded library</a></li>
<li><a href="../267157/index.html">Configure SCST Target on CentOS 7 using FC QLogic adapter</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>