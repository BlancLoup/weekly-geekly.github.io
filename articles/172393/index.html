<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>New Trojan with a valid digital signature LLC Mail.Ru disguises as an update of popular programs</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="On a quiet Saturday evening, my mother peacefully Youtube Youtube to care for the cyclamens and suddenly a banner formed to the left of the video (unf...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>New Trojan with a valid digital signature LLC Mail.Ru disguises as an update of popular programs</h1><div class="post__text post__text-html js-mediator-article">  On a quiet Saturday evening, my mother peacefully Youtube Youtube to care for the cyclamens and suddenly a banner formed to the left of the video (unfortunately, there will be no screenshot because the banner could not be reproduced) calling for Skype to be updated.  After clicking on it, there was a redirect to _http: //easyupdate.ru/skype/, which looks something like this ... <br><a name="habracut"></a><br><img src="https://habrastorage.org/storage2/ea0/8f8/f64/ea08f8f6435afbd4cbd9aab85c2b0b95.png"><br><br>  My mother is not a very experienced user and the phrases in the spirit of ‚ÄúYour version of Skype is outdated, its support will end on 03/04/2013, after which you will no longer be able to communicate via Skype‚Äù they are very frightened, so she pressed ‚ÄúCancel‚Äù and called me.  At first, I decided that it would be about a banal Skype update and with a sigh I connected with Teamviewer, just going to poke a couple of buttons and disconnect.  To my shame, with all my many years of experience, I even managed to launch an ‚Äúupdate‚Äù downloaded from easyupdate.ru, but after seeing that the file was signed for some reason by the publisher ‚ÄúLLC Mail.Ru‚Äù and not Skype, at the last moment forbade performance and realized that the evening will be interesting and long.  Having praised my mother for vigilance, I began to study the fresh scheme of filling the botnet. <br><br><h5>  Digital signature puzzle </h5><br>  So, first of all, let's look at the file properties: <br><img src="https://habrastorage.org/storage2/3be/853/a5e/3be853a5ebb332ea853716f04f001026.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Strange, only 74 KB, somehow not enough even for a web installer.  We look at the digital signature, what kind of ‚ÄúLLC Mail.Ru‚Äù is, can someone again drag a similar legal entity name through Thawte? <br><br><img src="https://habrastorage.org/storage2/424/8af/614/4248af614e76ff0070b78952c797de74.png"><br><br>  Strangely, a digital signature certificate is very similar to a real one from Mail.Ru: <br><br><img src="https://habrastorage.org/storage2/d02/04f/b67/d0204fb67a580737b2b4be21249f9ce0.png"><br><br>  They have the same validity period, from 09/12/2011 to 07/02/2014, however, the Mail.ru Agent‚Äôs digital signature has signatures of other parties: Symantec Time Stamping Services Signer.  All exe files are subscribed on the fly before returning to download to the browser, this is indicated by the dynamically changing time of file signing. <br><br>  <b>Total, we have three options:</b> <br>  1. This is the real digital signature of Mail.ru, the private key of which was somehow stolen and is now used to sign Malvari <br>  2. This is a real digital signature Mail.ru, which Mail.ru itself for some reason uses to sign Malvari <br>  3. This is a fake digital signature of Mail.ru, which was somehow compromised (which is unlikely, for RSA 2048 bits) <br><br>  Googling easyupdate.ru, and finding nothing sensible in the output, I looked at all the links for site: easyupdate.ru and found that, besides Skype, there are landing pages for all popular browsers: <br><img src="https://habrastorage.org/storage2/1f3/66c/878/1f366c878892f11fa92e77e182008be6.png"><br><img src="https://habrastorage.org/storage2/ed1/f7d/ba7/ed1f7dba7ee86c436afec86168d84458.png"><br><img src="https://habrastorage.org/storage2/3e2/31f/b43/3e231fb43ca251ae248cb7e68570fe6c.png"><br><img src="https://habrastorage.org/storage2/64f/299/aad/64f299aade49732c784ed662c2f9ff9f.png"><br><br>  They are very much related to the nice pop-up javascript confirmation that the exe file starts downloading without even having to bother to check which button the user pressed, OK or Cancel. <br><br><h5>  Virustotal </h5><br>  Thus, we obtained 5 samples (links lead to the results of scanning the Virustotal files): <br>  <a href="https://www.virustotal.com/ru/file/c5d1e217b1ef2483af530f287036f46ccf87a44b04bdb891df7af2a45fcb18de/analysis/">chromesetup.exe</a> , <a href="https://www.virustotal.com/ru/file/4b26539b44ebd80206a02017aa88cf6fb54735f7e5a66c121bb506b36997ac6a/analysis/">firefox-setup.exe</a> , <a href="https://www.virustotal.com/ru/file/630def167074cf13cc8dd0b22ac2e549759f5b2fc47795ef9d365dbd7e1bbb63/analysis/">ie-setup-full.exe</a> , <a href="https://www.virustotal.com/ru/file/aca3bbd04c749fda6ca3beee6c308f2798610c81c345ce1027ec44c4f68d5618/analysis/">opera_int_setup.exe</a> and <a href="https://www.virustotal.com/ru/file/86d93562b658df70a28477a20fb0d42c2d8752648f75a56cd195bd61c24bf4f2/analysis/">skypesetup.exe</a> <br><br>  opera_int_setup.exe and ie-setup-full.exe have not yet been scanned before me, that is, the spread of the infection was started quite recently, but 8-9 antiviruses out of 46 reacted to the other files. Kaspersky is for some reason the only one who has classified exe as "Not a virus": "not-a-virus: HEUR: Downloader.Win32.LMN.a".  Perhaps this decision was positively influenced by a digital signature, but this is better than the solution of Microsoft‚Äôs built-in antivirus program from Microsoft, which did not see any threat in the samples at all. <br><br>  For chromesetup.exe, information is available on the behavior, apparently provided by some of the anti-virus companies, in particular network activity: <br><img src="https://habrastorage.org/storage2/275/8f0/39e/2758f039ed850a2942a030e59ae4c8e6.png"><br><br>  So, we have two strange domains and a link to the Mail.ru subdomain, let's take a closer look at them: <br>  <b>easyupdate.ru was</b> registered on January 30, 2013 with the hiding of information about the owner (Private person), this service is available and free of charge with most Russian domain registrars.  At the root of the site we are greeted by 404: <br><blockquote>  404 Not Found <br><br>  Found this server! <br>  Powered By LiteSpeed ‚Äã‚ÄãWeb Server <br>  LiteSpeed ‚Äã‚ÄãTechnologies is not responsible for this web site! </blockquote><br>  The second link apparently used a <a href="http://projects.webappsec.org/w/page/13246981/URL%2520Redirector%2520Abuse">URL redirect</a> vulnerability on one of the Mail.ru subdomains, however, it appears that the vulnerability has already been fixed.  Perhaps the attackers decided that such a link is easier to pass through the firewall. <br><br>  The <b>dwnfile.ru</b> domain <b>is</b> registered on February 1, 2013 with hiding information about the owner. <br>  The text of the landing page also contains links to the following domains: <br>  <b>uprgadotesbest.com</b> - was registered on December 26, 2012 through PrivacyProtect.org and currently has the status of "Locked" <br>  <b>uploadeasy.ru</b> - the domain is not registered at all, apparently forgotten in the bustle of rolling out ‚Äúin production‚Äù, cybersquatters, fly in! <br><br>  All domains were registered through Reg.ru. <br><br>  In addition, the Trojan disables the use of a proxy in the registry, which obviously affects the operation of IE and Chrome, Firefox and Opera have their own proxy settings. <br><br><h5>  Affiliate program </h5><br>  Further, the link _http: //dwnfile.ru/get_xml? File_id = 18499626 returns us the following XML: <br><pre><code class="xml">&lt;?xml version="1.0" encoding="utf-8"?&gt;
                    &lt;file&gt;
                        &lt;dltype&gt;simple&lt;/dltype&gt;
                        &lt;name&gt;&lt;![CDATA[chromesetup.exe]]&gt;&lt;/name&gt;
                        &lt;url&gt;&lt;![CDATA[http://easyupdate.ru/chrome/ChromeSetup.exe]]&gt;&lt;/url&gt;
                            &lt;partner_new_url&gt;&lt;![CDATA[http://dwnfile.ru/software_install?guid=$__GUID&amp;sig=$__SIG&amp;file_id=18499626]]&gt;&lt;/partner_new_url&gt;
                        &lt;partner_online_url&gt;&lt;![CDATA[http://dwnfile.ru/online_activity?guid=$__GUID&amp;sig=$__SIG&amp;sid=1469&amp;pid=775]]&gt;&lt;/partner_online_url&gt;
                        &lt;referer&gt;profitraf1&lt;/referer&gt;

                        &lt;internet&gt;&lt;/internet&gt;
                        &lt;referer_inet&gt;profitraf4&lt;/referer_inet&gt;
                        &lt;internet_silent&gt;&lt;/internet_silent&gt;
                        &lt;file_size&gt;&lt;![CDATA[0]]&gt;&lt;/file_size&gt;
                        &lt;partner_new_url_inet&gt;&lt;![CDATA[http://dwnfile.ru/software_install?guid=$__GUID&amp;sig=$__SIG&amp;ovr=$__OVR&amp;file_id=18499626&amp;browser=1]]&gt;&lt;/partner_new_url_inet&gt;
                        &lt;mpcln&gt;&lt;![CDATA[9516]]&gt;&lt;/mpcln&gt;
                    &lt;/file&gt;</code></pre><br>
      ,  ,            ¬´¬ª,  guid ‚Äî       ,  partner    ‚Äî  , ,    ,                 ,                 .   profitraf1,     : <a href="http://profitraf.ru/">profitraf.ru</a><br>
   ,            :<br>
<img src="https://habrastorage.org/storage2/f71/fcc/467/f71fcc467c415452a8af0a3401a0805e.png"><br>
<br>
   , ,     ,   .   ¬´ ¬ª :<br>
<blockquote>            (mp3, ,  ‚Äî   ),     .    ,        ,    profidownload.ru.         (     ).        ,        .       .      .</blockquote><br>
,    ,        .      ,     ,  215 ,     <a href="http://forum.searchengines.ru/showthread.php%3Ft%3D776617">    </a>:<br>
<blockquote>   , ¬´¬ª   ‚Äî  SMS-,     ¬´¬ª .      (  )    ‚Äî Mail.Ru.                .</blockquote><br>
   , ,  ,     Mail.ru  ,     .  ,    ,   ,       .        ,           Windows.<br>
<br>
<h5> </h5><br>
  ,               Mail.ru,         . ,       ,     ¬´¬ª , ,   , ,                   ,   ¬´¬ª .      ,   ,   Mail.ru,    .   ,        ,       ,  .<br>
<br>
<h6>  12 </h6><br>
         . ,    ,                 ¬´easyupdate.ru¬ª.<br>
<br>
 <a href="http://habrahabr.ru/users/mairon/" class="user_link">Mairon</a>  .</div><p>Source: <a href="https://habr.com/ru/post/172393/">https://habr.com/ru/post/172393/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../172383/index.html">Bitcoin network problems - the emergence of two competing block chains</a></li>
<li><a href="../172385/index.html">About today's error in the Bitcoin system</a></li>
<li><a href="../172387/index.html">Grid in the design of interfaces for Windows Phone: a strict teacher or a kind helper? (Part 1)</a></li>
<li><a href="../172389/index.html">SIEM: Frequently Asked Questions</a></li>
<li><a href="../172391/index.html">How to write an online course of study (or prepare other materials for publication on the site) using Evernote</a></li>
<li><a href="../172397/index.html">The software helped to complete the Gaudi plan, which started 130 years ago.</a></li>
<li><a href="../172399/index.html">Contrast measurement in black and white images</a></li>
<li><a href="../172401/index.html">Intel System Studio - software development kit for embedded and mobile systems</a></li>
<li><a href="../172403/index.html">Free the mind from Photoshop - a fresh concept of image processing</a></li>
<li><a href="../172405/index.html">Radio86RK - Soviet homemade computer</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>