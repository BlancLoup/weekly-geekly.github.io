<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ECMAScript Proposal: Array.prototype. {Flat, flatMap}</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="ECMAScript Innovations 





 Hello readers Habr. I bring to your attention an interesting thing that  will soon appear  already appeared in the ECMAS...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>ECMAScript Proposal: Array.prototype. {Flat, flatMap}</h1><div class="post__text post__text-html js-mediator-article"><h3 id="novovvedeniya-v--ecmascript">  ECMAScript Innovations </h3><br><p><img src="https://habrastorage.org/webt/vw/7j/wv/vw7jwvyboqd8w_aoghkrvbjglea.jpeg"></p><br><p>  Hello readers Habr.  I bring to your attention an interesting thing that <del>  will soon appear </del>  already appeared in the ECMAScript standard.  She is already available <del>  nearly </del>  in all browsers and all the functionality too.  This innovation is just sugar-wrapper and it can be solved by your own means and I will show it to you too.  But this sugar will allow us to write less code, because we love it so much.  So, the basic functions are added to the array, in this case there are 2 of them, which will allow us to expand multi-level arrays into one or more nesting levels.  Yes, yes, and all this as they say out of the box </p><a name="habracut"></a><br><h3 id="ecmascript-proposal-arrayprototypeflatflatmap">  ECMAScript Proposal: Array.prototype. {Flat, flatMap} </h3><br><p>  <a href="https://github.com/tc39/proposal-flatMap">This Proposal</a> was once known as <strong>Array.prototype.flat {ten, Map}</strong> .  It has <em>stage</em> status <del>  3 </del>  4 of <strong>TC39</strong> that is already <del>  <em>Candidate</em> </del>  <em>Finished</em> .  I think it is worth a little distraction and talk about this very <strong>TC39</strong> and about the standards, who are familiar with can miss this retreat.  so: </p><br><h3 id="standarty-javascript-i-kak-ego-gotovyat">  JavaScript standards and how it is prepared. </h3><br><h4 id="ecmascript">  ECMAScript </h4><br><p>  <strong>ECMAScript</strong> is a standard that is developed and maintained by <em>ECMA International</em> .  It was adopted by the Ecma General Assembly in June 1997. And more specifically, <strong>ECMAScript</strong> is the <strong>ECMA-262</strong> standard, which is called ‚ÄúECMAScript Language Specification‚Äù.  The standard was created based on the original version of JavaScript from Brendan Aich from Netscape and the JScript interpreter from Microsoft, but has evolved significantly since then. </p><br><p>  <strong>JavaScript</strong> is an implementation of the <strong>ECMAScript</strong> specification.  This means that as the specification has new drafts or published editions, browser and framework developers like Node.js should consistently implement new functionality.  To do this, make changes to the engines that these browsers and frameworks use to interpret and execute JavaScript code. </p><br><p>  Why do you need a specification?  Different browsers use different JavaScript engines, for example, V8 in Chrome, SpiderMonkey in Firefox, and so on.  When you write in JavaScript, you expect that all engines in all environments will parse and execute your code in exactly the same way.  Without a standardized specification, any of these engines would be free to execute JavaScript as it pleases, this is obviously not very good. </p><br><h4 id="tc39">  TC39 </h4><br><p>  <strong>The Ecma International Technical Committee 39</strong> (aka TC39) is a committee of very smart people, it is associated with a group of participants, too, by the way, smart.  They all get together in meetings of the committee about once every two months and discuss in advance prepared lists of issues. <br>  The task of <em>TC39</em> is to support and update the previously mentioned ECMAScript specification, after discussion and consensus.  These include language syntax, semantics, libraries, and related technologies on which the language is based. </p><br><p>  This process is defined by TC39.  It all starts with a draft of the functional, expanding or changing the specification.  Such drafts often come from the developer communities, or from the TC39 members themselves.  If the proposal is worthy, the draft receives the status of the official offer. </p><br><p>  Then, on its way from idea to publication, the proposal goes through several specific stages.  They are numbered from zero to four <em>men programmers</em> : </p><br><pre><code class="plaintext hljs">[‚ÄúStrawman‚Äù, ‚ÄúProposal‚Äù, ‚ÄúDraft‚Äù, ‚ÄúCandidat‚Äù, ‚ÄúFinished‚Äù]</code> </pre> <br><p>  Transition to any of the next stages requires the approval of TC39.  If the proposal has reached stage 4, it can be expected to be included in the next officially published edition of the ECMA-262 specification specification, and as a result it will appear in the environment that executes JavaScript.  You can learn more about this process from <a href="https://docs.google.com/document/d/1QbEE0BsO4lvl7NFTn5WXWeiEIBfaVUF7Dk0hpPpPDzU">the document itself</a> . </p><br><p>  All existing proposals for introductions to the standard can be found <a href="https://github.com/tc39/proposals">here on github</a> <br>  Well, now let's go further ... </p><br><h3 id="arrayprototypeflat">  Array.prototype.flat </h3><br><p>  The <strong><em>flat ()</em></strong> method returns a new array, </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> newArray = arr.flat(depth);</code> </pre> <br><p>  in which all elements of nested arrays were recursively "raised" to the specified <em>depth</em> level. </p><br><p>  <em>Example:</em> </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> arr1 = [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, [<span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>]]; arr1.flat(); <span class="hljs-comment"><span class="hljs-comment">//? [1, 2, 3, 4] const arr2 = [1, 2, [3, 4, [5, 6]]]; arr2.flat(); //? [1, 2, 3, 4, [5, 6]] const arr3 = [1, 2, [3, 4, [5, 6]]]; arr3.flat(2); //? [1, 2, 3, 4, 5, 6]</span></span></code> </pre> <br><p>  There is also a side effect, it removes undefined elements of the array. </p><br><p>  <em>Example:</em> </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> arr4 = [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, , <span class="hljs-number"><span class="hljs-number">4</span></span>, <span class="hljs-number"><span class="hljs-number">5</span></span>]; arr4.flat(); <span class="hljs-comment"><span class="hljs-comment">//? [1, 2, 4, 5]</span></span></code> </pre> <br><h4 id="rubrika-delaem-sami">  Rubric do it yourself </h4><br><p>  Use reduce and concat </p><br><p>  <em>Example:</em> </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> arr1 = [<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>,[<span class="hljs-number"><span class="hljs-number">1</span></span>,<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>, [<span class="hljs-number"><span class="hljs-number">2</span></span>,<span class="hljs-number"><span class="hljs-number">3</span></span>,<span class="hljs-number"><span class="hljs-number">4</span></span>]]]; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">flattenDeep</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">arr1</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> arr1.reduce(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">acc, val</span></span></span><span class="hljs-function">) =&gt;</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Array</span></span>.isArray(val) ? acc.concat(flattenDeep(val)) : acc.concat(val), []); } flattenDeep(arr1); <span class="hljs-comment"><span class="hljs-comment">//? [1, 2, 3, 1, 2, 3, 4, 2, 3, 4]</span></span></code> </pre> <br><h2 id="arrayprototypeflatmap">  Array.prototype.flatMap </h2><br><iframe width="560" height="315" src="https://www.youtube.com/embed/qgrila9cbzg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>  The flatMap () method first applies the function to each element, and then converts the result to a flat structure and places it in a new array.  This is identical to the map function, followed by the use of the flat function with a depth parameter of 1, but the flatMap is often useful because it works a little more efficiently. </p><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> new_array = arr.flatMap(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">callback</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">currentValue[, index[, array]]</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-comment"><span class="hljs-comment">// return element for new_array }[, thisArg])</span></span></code> </pre> <br><p>  <code>callback</code> - The function that produces the elements of the new array takes three arguments: </p><br><ol><li>  <code>currentValue</code> - The current array item being processed. </li><li>  <code>index</code> (optional) - The index of the item being processed in the array. </li><li>  <code>array</code> (optional) - The array to traverse. <br>  <code>thisArg</code> (optional) - The value used as this when calling the callback function. <br>  The return value is a new array, each element of which is the result of the callback function and ‚Äúraised‚Äù to level 1. </li></ol><br><p>  example: </p><br><pre> <code class="javascript hljs">[ { <span class="hljs-attr"><span class="hljs-attr">x</span></span>: <span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-attr"><span class="hljs-attr">y</span></span>: <span class="hljs-number"><span class="hljs-number">2</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">x</span></span>: <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-attr"><span class="hljs-attr">y</span></span>: <span class="hljs-number"><span class="hljs-number">4</span></span> }, { <span class="hljs-attr"><span class="hljs-attr">x</span></span>: <span class="hljs-number"><span class="hljs-number">5</span></span>, <span class="hljs-attr"><span class="hljs-attr">y</span></span>: <span class="hljs-number"><span class="hljs-number">6</span></span> } ].flatMap(<span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">c</span></span></span><span class="hljs-function"> =&gt;</span></span> [cx, cy]) <span class="hljs-comment"><span class="hljs-comment">//? [1, 2, 3, 4, 5, 6] // or const orders = [ { orderId: 42, items: [ {name: 'soap', price: 1.99}, {name: 'shampoo', price: 4.99} ] }, { orderId: 1337, items: [ {name: 'toothpaste', price: 5.59}, {name: 'toothbrush', price: 8.99} ] } ]; orders.flatMap(i =&gt; i.items.map(i =&gt; i.name)); //? ["soap", "shampoo", "toothpaste", "toothbrush"]</span></span></code> </pre><br><h4 id="rubrika-delaem-sami-1">  Rubric do it yourself </h4><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> arr1 = [<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>]; arr1.reduce(<span class="hljs-function"><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">acc, x</span></span></span><span class="hljs-function">) =&gt;</span></span> acc.concat([x * <span class="hljs-number"><span class="hljs-number">2</span></span>]), []); <span class="hljs-comment"><span class="hljs-comment">// [2, 4, 6, 8]</span></span></code> </pre> <br><h2 id="zaklyuchenie">  Conclusion </h2><br><p>  Remember that this functionality is added to the language for a reason.  The reasons why smart people from TC39 do it are improving the quality of language, abstraction, usability, and others.  Examine these innovations in advance, and by the time they are officially published and will be maintained everywhere, you will be able to start working right away without losing time.  You can also position yourself as a JavaScript expert in your organization, able to offer new language features to improve both the code and the product itself. </p><br><p>  ps: while the article was being written :), Proposal moved to <em>stage 4</em> <br>  <code>Array.prototype.{flat,flatMap}</code> to stage 4, per 2019.01.29 TC39 </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/433820/">https://habr.com/ru/post/433820/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../433808/index.html">5 most frequent mistakes that programmers make at the interview</a></li>
<li><a href="../433810/index.html">Problem-oriented approach to projects in Internet marketing</a></li>
<li><a href="../433814/index.html">How to scale down databases in Yandex. Cloud without downtime. Three hosts example</a></li>
<li><a href="../433816/index.html">Where to publish a mobile application</a></li>
<li><a href="../433818/index.html">Compiling and running C # and Blazor inside a browser</a></li>
<li><a href="../433822/index.html">The complete guide to CMake. Part Three: Testing and Packaging</a></li>
<li><a href="../433824/index.html">Habro suicide. Why 1C programmers will save the world</a></li>
<li><a href="../433826/index.html">Persimmon 2.0 Instructions for use</a></li>
<li><a href="../433828/index.html">Using QML Map to Build Airways - Part 1</a></li>
<li><a href="../433830/index.html">New LED Lamp Diall</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>