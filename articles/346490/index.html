<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>What to look at the weekend? Review of the best reports in the public domain. Part Two, JBreak 2017</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="What can be seen in the evening or this weekend? You can watch some movies, or you can - our incessant series called ‚ÄúJava Conferences‚Äù. The only seri...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>What to look at the weekend? Review of the best reports in the public domain. Part Two, JBreak 2017</h1><div class="post__text post__text-html js-mediator-article"><p>  What can be seen in the evening or this weekend?  You can watch some movies, or you can - our incessant series called ‚ÄúJava Conferences‚Äù.  The only series, after watching which you can dramatically increase salary. </p><br><p>  Yesterday's <a href="https://habrahabr.ru/company/jugru/blog/346364">article about the JPoint 2017</a> was surprisingly successful.  She had almost no comments, but at the moment - 88 bookmarks.  That is, the article hit the mark: people bookmark and watch - hooray.  Literally in the first hour, Satan himself came to read it. </p><br><p>  Today we will act according to the old scheme: I look at 10 reports in a row for you, I make a short description of the content so that you can throw out the uninteresting.  In addition, from sites I collect links to slides and descriptions.  The resulting sort and give in order to increase the rating - that is, at the bottom will be the coolest report.  Ratings are not likes on YouTube, but our own evaluation system, it is cooler than likes. </p><br><p><img src="https://habrastorage.org/webt/ih/ic/tp/ihictp3ofgq_w5jskswcfdy5tve.png"><br></p><a name="habracut"></a><br><hr><br><h1 id="10-blesk-i-nischeta-raspredelyonnyh-strimovhttps2017jbreakrutalksthe-splendors-and-miseries-of-the-distributed-streams">  10. <a href="https://2017.jbreak.ru/talks/the-splendors-and-miseries-of-the-distributed-streams/">Glitter and poverty of distributed streams</a> </h1><br><p>  <strong>Speaker</strong> : Victor Gamov;  <strong>rating</strong> : 4.24 ¬± 0.11.  <a href="https://downloads.contentful.com/oxjq45e8ilak/61LonCGxtSCcgauMCuEaIu/1a96b8268950ae767063b80147ecbb34/_gamov_________________________________________________________________________-_JBreak_-_04-04-2017.pdf">Link to the presentation</a> . </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/YcEOi9aOX0s" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>  First slide: </p><br><p><img src="https://habrastorage.org/webt/sr/m5/_j/srm5_jxlr02c40xco668qesl9_c.png"><br></p><br><p>  It is clear that since this is Victor, then it will be a question of Hazelcast, although it is not clear from the first slide.  This is a good introductory report on how to make streams distributed so that they finally stop slowing down (really, and not as always). </p><br><p> With the first example, Victor chooses word counting ‚Äî the classic task of the programming world.  There will be a map <code>&lt;   -&gt; &gt;</code> , you need to count the number of words and display the top.  Will consider files with lyrics Disturbed and Lady Gaga. </p><br><p>  You can do it on Spark, as does Zhenya Borisov.  It is clear that the man-hazelkast can not descend to such a simple level. </p><br><p>  The first example - with the help of streams from the eight, we subtract lines and set on the result of <code>compute</code> - we get a typical word count.  A classification of operations on streams is given: intermediate, terminal, and stateful-blocking, is illustrated by the example of a picture with a burger (which he stole unhindered from a book about lambdas). </p><br><p><img src="https://habrastorage.org/webt/vj/ov/9d/vjov9dmfg4-lxd_hrr-97anpcw4.png"><br></p><br><p>  There is a certain amount of code on the stream with detailed explanations (the algorithms are simple, but they allow you to demonstrate everything well): </p><br><p><img src="https://habrastorage.org/webt/vs/p2/t3/vsp2t30f3jhq4s0bsxazepynkie.png"><br></p><br><p>  The question is not to write it at least somehow, but to make it distributed.  But the interface of the streams of distribution does not imply, you can‚Äôt just take and convert the ready-made code (the maximum can be done within a single process using <code>parallelStream</code> , which is not a fact that will speed up anything at all).  Lambdas are also non-serializable - you can‚Äôt just send them to other nodes.  The results of the execution - too. </p><br><p>  In 2014, at JavaOne, a team of people from Oracle (Goetz, Oliver, Sandoz, ...) told how to use this paradigm for distributed data: they made the engine for Hadoop, <a href="https://www.oracle.com/ru/middleware/coherence/index.html">Coherence</a> , etc. </p><br><p>  In the original design of the stream library, the usual Stream could be inherited from the DistributedStream, but this was not done, because it would require fighting the Java language, dragging the overhead projector, and so on.  Therefore, you need to distributeStream from just Stream.  In Hazle this is done. </p><br><p>  In Coherence there is, for example, RemoteStreams.  There are ready-made collectors for streams, for assembling data in a serialized form.  Infinispan also has a bunch of interesting pieces. </p><br><p>  Except, in fact, the engine, the system should have good usability: we are zhaboprogrammers, we want everything to be just going, figak-figak, DevOps is not about us ‚Äî they were immediately shoved into the cooker and sizzled for the prod.  Hazelcast promises to solve all these things.  Distributed caches, distributed computing, distributed everything, and this is also convenient to use.  Horizontal scaling, vertical scaling, backups directly on neighboring nodes, etc. </p><br><p>  But there are all sorts of problems like OOM. </p><br><p><img src="https://habrastorage.org/webt/1w/nd/ye/1wndyenyecwtphs4pvvpfhlzc7o.png"><br></p><br><p>  To demonstrate all of these pieces, Victor has an application that was loaded on Spring Boot, and an impressive demonstration of how to load data (locally, not on a cluster ‚Äî but on the clouds, too, he says, all this is tested, for example, on Heroku).  Victor does live coding further, and it doesn't make much sense to describe it. </p><br><p>  Then Victor moves on to <a href="https://jet.hazelcast.org/">Hazelcast Jet</a> and Jet Streams - what it is and how it works.  (By the way, don't you think that this is some kind of hell - are there so many products called Jet-something there?) This is for distributed computing, it works on a graph model and is based on the Hazelcast IMDG.  Can be compared with Spark and Flink. </p><br><p><img src="https://habrastorage.org/webt/rt/u0/sb/rtu0sbstzdbvgniyxzatmd_1dn4.png"><br></p><br><p>  All this, of course, is described in detail.  Execution of the graph, tasklets, etc.  Shows demos and benchmarks and draws conclusions based on this.  And then more than 10 minutes of questions and answers. </p><br><p>  In this description, enough information is missing so that the report makes sense to look, and Victor did not crucify me for total spoiling :-) </p><br><p>  For me personally, the report is valuable in that it‚Äôs the thing that you should definitely use in your applications instantly, as distributed streams will be needed. </p><br><h1 id="9-zhiznennyy-cikl-jit-kodahttps2017jbreakrutalkslifecycle-of-a-jit-compiled-code">  9. <a href="https://2017.jbreak.ru/talks/lifecycle-of-a-jit-compiled-code/">The life cycle of the JIT code</a> </h1><br><p>  <strong>Speaker</strong> : Ivan Krylov;  <strong>rating</strong> : 4.29 ¬± 0.07.  <a href="https://assets.contentful.com/oxjq45e8ilak/2tvBFrzcggIKoQ8igOWe6K/b94ad32fdd0dea89bf71a1a17767b4c8/Ivan_Krylov_Code_lifecycle_in_JVM.pdf">Link to the presentation</a> . </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/9valLOxgDbI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>  Krylov is a companion from Azul, and in theory he could have burst into a nightingale about the peculiarities of his cool VM, but he does not do that.  For which he special thanks a lot. </p><br><p>  The talking epigraph to this report is <a href="https://ru.wikipedia.org/wiki/%25D0%2593%25D0%25BE%25D1%2581%25D1%2582%25D0%25B5%25D0%25B2%25D0%25BE%25D0%25B9_%25D0%25B4%25D0%25BE%25D0%25BC_%25D0%25A5%25D0%25B0%25D0%25BD%25D0%25B3_%25D0%259D%25D0%25B3%25D0%25B0">Crazy House</a> : </p><br><p><img src="https://habrastorage.org/webt/ru/az/po/ruazpomfmphdgut4t8kqznlylx0.png"><br></p><br><p>  This is about how HotSpot works.  From my perverted point of view, sometimes it is even good - otherwise life would be much more boring.  From trusted sources, after the death of all the JVM developers, instead of hell, they are sent to develop the JVM. </p><br><p>  The report will be about the transformation of the presentation of code, code profiles, de-optimizations, and the more practical part - 4 APIs for tuning compilation.  Two-thirds of the report is about problems, the rest is practical. </p><br><p>  First, it tells about the pipeline: static verification, non-optimizing compilation, the resulting bytecode, runtime verification, linking, executable code. </p><br><p><img src="https://habrastorage.org/webt/kk/aw/n1/kkawn1ofq5z3aaeysu6z3cy426c.png"><br></p><br><p>  But it can be otherwise: bytecode can come from some ByteBuddy, the virtual machine can be without an interpreter, as in JRockit, the virtual machine can only be with an interpreter and that's it, or it can be a hybrid virtual machine with AOT, as in Excelsior JET. </p><br><p>  Ivan says that the profile is, in fact, counters.  Inaccurate counters for calculating ratios (not absolute values).  Sometimes these counters have additional properties - this allows you to make additional optimizations. </p><br><p>  In addition to the profile, we still need all sorts of small interesting things.  It is illustrated on the features of the compiled Enum (in the compiled form it weighs more than its text - as if it hints that nontrivial logic is sewn inside. This logic can be viewed by bytecode). </p><br><p>  Ivan shows how inlining works in general terms, and tells how once he accidentally broke this inlining (24% regression).  There are standard reasons for breakdowns like: very large methods, too much nesting, special settings flags for virtuals, uninitialized classes, unbalanced monitors, jsr bytecode, etc. </p><br><p>  But inlining can not only help, but also hurt.  For example, when some methods are too often deoptimized.  Virtualka can prohibit inlining in such situations. </p><br><p>  Then we talk about the compilation levels from 1 to 4. It describes the transition scheme, conditions, thresholds (such as one and a half thousand executions for C1) and other interesting things.  If you suddenly think that you understand all this well, then ... most likely, it is not :-) </p><br><p><img src="https://habrastorage.org/webt/jg/dq/gy/jgdqgyxnt05hjuyg5c0yaw8wimg.png"><br></p><br><p>  From this, a transition is made to de-optimizations, how they work, how they are divided into classes: deterministic (constant propagation, rollback (bias locking, tsx), speculative with instantaneous stopping (CHA invalidation). </p><br><p>  A lot of code should be performed according to JVMS requirements: checks for zeroing, going beyond the limits of arrays, dividing by zero, checking types, etc.  So that the code does not slow them down, JIT struggles to prove that these checks are not needed and throw them away.  When the code changes, these optimizations will have to be thrown away.  A long list of reasons for de-optimization is given. </p><br><p>  And the report ends with a detailed description of the API for compiler settings that are related to the issues described above.  Even if you (like me) are more interested in digging into the intestines of the JVM and experimenting, than to really turn the settings on the sale of a bloody enterprise, this section is still worth listening to, because  there is also a lot of "meat" on the topic.  Keys just can not explain, any attempt to explain reveals additional details.  Including, there are explanations about how it works in Azul. </p><br><p><img src="https://habrastorage.org/webt/-g/sh/k4/-gshk4_0y7ylnbxq2sixm4n7gfe.png"><br></p><br><p>  Personally, I will use this report to quickly introduce newcomers to the topic.  This is a good (and most importantly - fast) overview of the topic of optimization and de-optimization that the brain cannot tolerate by excessive immersion. </p><br><h1 id="8-crdt-razreshay-konflikty-luchshe-chem-cassandrahttps2017jbreakrutalkscrdt-conflict-free-synchronization-in-distributed-systems">  8. <a href="https://2017.jbreak.ru/talks/crdt-conflict-free-synchronization-in-distributed-systems/">CRDT.</a>  <a href="https://2017.jbreak.ru/talks/crdt-conflict-free-synchronization-in-distributed-systems/">Solve conflicts better than Cassandra</a> </h1><br><p>  <strong>Speaker</strong> : Andrey Ershov;  <strong>rating</strong> : 4.32 ¬± 0.20.  <a href="https://assets.contentful.com/oxjq45e8ilak/3k9nmTWXbyI6C4AOiusgIy/6baa1ec9c8d34a1a477db0edfc9bf347/Andrey_Ershov._Resolve_conflicts_better__than_Cassandra.pdf">Link to the presentation</a> . </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/AqCwQVv4D1Y" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>  A report on the ALPS-system (Available, Low Latency, Partition Tolerant, Scalable).  Unfortunately, competitive modifications are inevitable in them, and we have to understand which changes are correct.  Most systems, such as Cassandra, use the LWW (last write wins) policy ‚Äî it will be shown why it does not always work.  As an alternative, LWW came up with CRDT, to which the main part is dedicated.  In the end - a lot of links for homework, self-study. </p><br><p>  All this is demonstrated not on the bare theory (which you can read in the paper), but by the example of the task to synchronize data in the webmord, which is dear to the heart of any web-based coder.  All demos are not just drawn on slides, but are shown live (Andrei has 4 applications running on the laptop). </p><br><p><img src="https://habrastorage.org/webt/n7/kd/8a/n7kd8aoh3ivdp7qkwgywecgzyoa.png"><br></p><br><p>  That is, this application is opened in two browser tabs, but these tabs do not communicate with each other directly, but through a database ( <a href="http://basho.com/products/riak-kv/">Riak KV</a> ). </p><br><p>  Problems such as network segmentation are also demonstrated - despite the fact that all applications are running on the same computer.  Iptables is used for this: </p><br><p><img src="https://habrastorage.org/webt/k0/ui/ym/k0uiymzhw1n1hyd2yzbzmgp-vqy.png"><br></p><br><p>  It seems that we will be haunted by references to documents that are worth studying.  In this case, the way data is organized in a key-value database is covered by this must have document: </p><br><p><img src="https://habrastorage.org/webt/mh/xb/s4/mhxbs4nhbg5fxedkpgffljkr-c0.png"><br></p><br><p>  But all such sacred things are instantly demonstrated on a real, understandable example of the type of a distributed basket. </p><br><p><img src="https://habrastorage.org/webt/4y/at/wz/4yatwzso0y6-yahvb1uroesicj4.png"><br></p><br><p>  If it is quite brief, the meaning is as follows: if the same field is being edited from two different tabs, then a conflict may arise.  In the proposed system, in the web interface, not just the last value will be displayed, but directly it will be written: ‚ÄúDo you have a conflict here, what will we do?‚Äù. </p><br><p>  Questions such as response acceleration (asynchronous replication, optimistic UI), network problem solving (network segmentation, offline work, to work in an airplane), etc. are considered.  In short, there are some competitive changes, and the problem with them is solved with the help of CRDT - conflict-free replicated data types. </p><br><p>  It describes what the Strong Eventual Consistency is and, in fact, CRDT (data structures with the SEC property, solving competitive change problems and automatically resolving conflicts).  There are almost any data structures there ‚Äî counters, registers, flags, lists, sets, maps, graphs, and so on ‚Äî all this can be described as CRDT. </p><br><p>  The state-based CRDT is considered (when the state of an object changes, the entire state is transmitted) and their problems.  More precisely, one major problem is a huge amount of data.  Specific implementations are <a href="https://akka.io/">Akka</a> and <a href="https://lasp-lang.readme.io/docs">Lasp</a> . </p><br><p>  Similarly, the operation-based CRDT, advantages and disadvantages. </p><br><p><img src="https://habrastorage.org/webt/qq/rs/di/qqrsdigirqmia8pnlrter-wx9gm.png"><br></p><br><p>  It is proposed to read the book <a href="http://www.springer.com/gp/book/9783642152597">"Reliable and Secure Distributed Programming"</a> , it is obligatory in English, because the Russian translation is fuzzy.  After that, go to the basic description of different types of broadcast: Unreliable, Reliable, FIFO, Global Order.  Discussed causal broadcast in different versions. </p><br><p>  <a href="http://eventuate.io/">Evenuate</a> , <a href="https://github.com/SyncFree/SwiftCloud">swiftcloud,</a> and <a href="http://syncfree.github.io/antidote/">antidotedb are</a> offered as an example of op-based CRDT. </p><br><p>  Based on the discussion of previous types of CRDT, we turn to Delta-CRDT: the requirements are the same as those of state-based, and the size is the same as op-based.  They are implemented by Akka and Riak KV. </p><br><p>  All these types of CRDT are illustrated with a real-life example such as GCounter (grow-only counter) and PNCounter (positive-negative counter) = GCounter + GCounter.  There are problems with counters, and, of course, here we will need Riak Counters.  Next in line is the LWWRegister, Version Vector, MVRegister, GSet, 2PSet, OR-Set, AWMap.  All this with a detailed description. </p><br><p>  What does this mean for me?  IMHO, CRDT - the future of distributed systems.  The field of distributed systems is booming, and you need to maintain your knowledge in step with the times, in particular, read papers and walk on such reports.  And of course, once <a href="https://doc.akka.io/docs/akka/2.5.9/distributed-data.html%3Flanguage%3Djava">in Akka we have written down delta CRDT</a> , this issue should be studied first. </p><br><h1 id="7-java-inspekcii-v-intellij-idea-chto-mozhet-poyti-ne-takhttps2017jbreakrutalksjava-vs-intellij-how-we-develop-code-inspections-jb">  7. <a href="https://2017.jbreak.ru/talks/java-vs-intellij-how-we-develop-code-inspections-jb/">Java Inspection at IntelliJ IDEA: What Can Go Wrong?</a> </h1><br><p>  <strong>Speaker</strong> : Tagir Valeev;  <strong>rating</strong> : 4.33 ¬± 0.12.  <a href="https://assets.contentful.com/oxjq45e8ilak/7FmCnarIjecWmG0484OkOo/b4e1f723131fdebe9cd389e4bf08f169/valeev_inspections__1_.pdf">Link to the presentation</a> . </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/lonT4bKkjeU" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>  First you need to understand that Tagir is <a href="https://habrahabr.ru/users/lany/">@lany</a> , and it is a living embodiment of the <a href="https://habrahabr.ru/hub/java/">Java hub in Habre</a> . </p><br><img width="400" src="https://habrastorage.org/webt/za/lt/1x/zalt1xbtwnnk9vyvxn15u4iypiy.png"><br><p>  If you read his articles, it is easy to see how the average post of Tagir is different, for example, from my average post.  They are not advertising and very high quality.  His reports at conferences are better than posts, and they need to be watched.  At this one could put an end, but being a graphomaniac, I can‚Äôt stop. </p><br><p>  And also, for this report, Tagir was forced to donate my laptop.  He worked best with the projector, or something.  If you look at the lid of the laptop, you will see on it the only round sticker ‚ÄúThis is Sbertech, baby!‚Äù - not the most obvious label for the employee of JetBrains! </p><br><p><img src="https://habrastorage.org/webt/wo/ip/ft/woipfte2yf1cu-ifiddvp_meml0.png"><br></p><br><p>  Okay, to the point.  Report - about writing inspections for ideas. </p><br><p>  The epigraph picture to the report: a normal IDE would definitely help prevent such an error. </p><br><p><img src="https://habrastorage.org/webt/qh/sx/8a/qhsx8ayqykebaanwt6ilde1ufzc.png"><br></p><br><p>  The idea is two thousand inspections, most of which are search and replace. </p><br><p>  An example is given of the Wishlist user Idea to add a transformation from: </p><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">set</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.stream</span></span>()<span class="hljs-selector-class"><span class="hljs-selector-class">.collect</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">Collectors</span></span><span class="hljs-selector-class"><span class="hljs-selector-class">.toList</span></span>())</code> </pre> <br><p>  in a more reasonable view: </p><br><pre> <code class="hljs cs"><span class="hljs-keyword"><span class="hljs-keyword">new</span></span> ArrayList&lt;&gt;(<span class="hljs-keyword"><span class="hljs-keyword">set</span></span>)</code> </pre> <br><p>  For those who are in the tank, Tagir explains why the regular season is not the best way to solve this problem.  You can not represent the code as a set of characters, you need a more abstract model, for example, AST.  However, it is also not enough in a normal situation.  Enough PSI (Program Structure Interface), which is implemented in the Idea. </p><br><p>  With the help of something like this, you can immediately cover a whole class of equivalent records: </p><br><p><img src="https://habrastorage.org/webt/9g/it/bs/9gitbsa4tyrsklvb7ykyfyuknyo.png"><br></p><br><p>  Next Tagir tells about the replacement, what could go wrong at this stage.  There are magic methods that allow you to make a fragment of a PSI tree from a line and replace it. </p><br><p><img src="https://habrastorage.org/webt/-s/wd/bq/-swdbqf_0vp9ryyueexpk_zx_ag.png"><br></p><br><p>  If you write correctly, then the Idea will automatically add the missing imports and other nishtyaki (see the call to <code>shortenClassReferences</code> ).  In addition to imports, code can be normalized in many different ways, for example, by automatically removing unnecessary qualifiers or type conversions. </p><br><p>  The next interesting example is the processing of comments.  In the old inspections, after fixation, they were simply lost, in the new ones - they are trying to keep an eye on this.  Where possible, comments remain in place, but this is not always the case.  For example, if we close the loop with deletion to <code>list.removeIf</code> , and there were comments in the middle of the loop, then all of them will creep up and appear directly above the line calling <code>list.removeIf</code> . </p><br><p>  Similar problems arise from the fact that inspections must take into account the fact that you can build as many round brackets as you like in different places.  Inspections should fall inside the brackets.  Another idea can cycle fold into a stream, and with this there is an additional set of difficulties. </p><br><p>  How semantically are the original and refactored code equivalent?  About this is a separate large block of the report.  In short, changing semantics can sometimes be sacrificed, and some changing semantics inspections are better off by default. </p><br><p><img src="https://habrastorage.org/webt/vn/7k/qu/vn7kquajc_tfytunwqmqvztuplo.png"><br></p><br><p>  The following blocks are about generics and type conversions.  As you might guess, the problems are the car. </p><br><p><img src="https://habrastorage.org/webt/lz/is/ct/lzisct2fwpzq9wcaphm6a4op6ci.png"><br></p><br><p>  And at the end the tin itself is considered an incorrect code.  Unlike the correct code, any can be incorrect, and here especially perverted and heaped tricks are used. </p><br><p>  For me personally, this report is very useful, because writing inspectorates for an Idea is one of the things that I will do without fail.  Why the marketer needs this - I will not explain now, there will be a separate article about it. </p><br><h1 id="6-analyzing-hotspot-crasheshttps2017jbreakrutalksanalyzing-hotspot-crashes">  6. <a href="https://2017.jbreak.ru/talks/analyzing-hotspot-crashes/">Analyzing HotSpot Crashes</a> </h1><br><p>  <strong>Speaker</strong> : Volker Simonis;  <strong>rating</strong> : 4.35 ¬± 0.14.  <a href="https://downloads.contentful.com/oxjq45e8ilak/5CpLBGccgwgS4sW8aCkSgE/c55888970df480556b49111bcf650ccb/Volker_Simonis_Analyzing_HotSpot_Crashes.pdf">Link to the presentation</a> . </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/buPX_nj40Tg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>  Volker is a companion from SAP who systematically tells all the tin about how to repair Java, if you intend to use it as cruelly as he does at work.  Usually there occurs blood-gut-dismemberment, debugging of the falling JVM, traveling through the wilds of C ++ and assembler code, and so on. </p><br><p>  This report is no exception: </p><br><p><img src="https://habrastorage.org/webt/ab/p_/fe/abp_fejvrzny1c3dfyhyo9aw1si.png"><br></p><br><p>  The report begins with a review of the structure of HotSpot VM </p><br><p><img src="https://habrastorage.org/webt/nw/dq/uo/nwdquo5mckx2nzo6_9wzwhl5qme.png"><br></p><br><p>  Volker hints, as it were, that we will need to dig into this when repairing.  In fact, this is such a full-stack task, where our ‚Äústack‚Äù is the guts of the JVM.  The task is divided into two main parts: to understand in which part of the stack an error occurred, and then, using our knowledge of this part, to fix the error. </p><br><p>  By the way, this is one of the few reports by Volker, where there is no real live coding.  It seems that there is too much code to dial it manually: he typed it in advance and packed it into slides with screenshots. </p><br><p>  But you have to understand that, <em>in essence</em> , this is still a debugging process, the purpose of the report is to observe this process, and describe everything step by step in a somewhat meaningless way, so I‚Äôll just say a few words. </p><br><p>  If anyone is interested in how to quickly brighten up the JVM: </p><br><p><img src="https://habrastorage.org/webt/1b/fz/ri/1bfzri3xfdn-fy2rkcsqeilsc8e.png"><br></p><br><p>  It is important that Volker shows his examples very schematically.  Often it is not enough just to copy the code, you need to think a little.  For example, the real code from this crash (just checked) should look something like this: </p><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> sun.misc.Unsafe; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.lang.reflect.Field; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Main</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String[] args)</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">throws</span></span></span><span class="hljs-function"> NoSuchFieldException, IllegalAccessException, ClassNotFoundException </span></span>{ Class&lt;?&gt; c = Class.forName(<span class="hljs-string"><span class="hljs-string">"sun.misc.Unsafe"</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">false</span></span>, Main.class.getClassLoader()); Field theUnsafe = c.getDeclaredField(<span class="hljs-string"><span class="hljs-string">"theUnsafe"</span></span>); theUnsafe.setAccessible(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); Unsafe u = (Unsafe) theUnsafe.get(<span class="hljs-keyword"><span class="hljs-keyword">null</span></span>); u.putInt(<span class="hljs-number"><span class="hljs-number">0x99</span></span>, <span class="hljs-number"><span class="hljs-number">0x42</span></span>); } }</code> </pre><br><p>  Having thrust on a rake, we, following Volker, fiercely study the virtualka's fall logs: </p><br><p><img src="https://habrastorage.org/webt/su/-b/kj/su-bkj-9fecr8uv_9pp3oxdw_l4.png"><br></p><br><p>  We rummage in registers and a stack: </p><br><p><img src="https://habrastorage.org/webt/kj/9p/oh/kj9pohfcoomf4_0q8uwi3zftaq4.png"><br></p><br><p>  We discuss the generation of <code>hs_err.log</code> and the fact that everything is not easy with it: </p><br><p><img src="https://habrastorage.org/webt/ai/4k/nb/ai4knbcmdlrrgmddcy5tfaq-5y4.png"><br></p><br><p>  Explore the places of the fall: </p><br><p><img src="https://habrastorage.org/webt/7l/vq/bu/7lvqbuf9kzkfyccdgksxwnnyq9y.png"><br></p><br><p>  And so on. </p><br><p>  For example, you can paint in the interpreter, but it is not necessary that it is somehow connected with the interpreter.  Maybe we just broke hip.  Or, for example, you can debug Out of Memory in this way (you need to dig, starting with the <code>-XX:+CrashOnOutOfMemoryError</code> flag <code>-XX:+CrashOnOutOfMemoryError</code> and the corresponding log). </p><br><p>  For me, the value of this report is that it gives a specific set of pens that you can grasp.  How specifically to look at the disassembler, what to write in the VM options, how to use the Serviceability Agent, how to use replay files, and so on.  More importantly, you can look at Volker‚Äôs train of thought and try to learn how to think in a similar way. </p><br><p>  Of course, it is not every day that your JVM falls, and there is even less chance that you will be able to fix such a bug (elementary, you may not have so much time to crawl through the logs for days on end).  Usually such bugs will be reported and waited for professionals to fix them.  On the other hand, knowing the things Volker is talking about, you can, without waiting for a fix, come up with some tricky workout (not at the level of fixing the JVM itself, but at the level of easily refactoring your Java code). </p><br><p>    ,       JVM    , ,   -   ,  .   ,        ,     ,   ,   ,     .  , in open source no one can hear your scream.              , ,  ,     ‚Äî . </p><br><h1 id="5-kafka-lyot-a-spark-razgrebaethttps2017jbreakrutalkshandling-with-spark-what-kafka-is-streaming"> 5. <a href="https://2017.jbreak.ru/talks/handling-with-spark-what-kafka-is-streaming/">Kafka ,  Spark !</a> </h1><br><p> <strong></strong> :  ; <strong></strong> : 4.38 ¬± 0.19.  <a href="https://assets.contentful.com/oxjq45e8ilak/3efnYJKcoMAYKuKSouSaIi/7b04e860a24be089991ae91e6b6283af/Alexey_Zinoviev_Spark_Kafka.pdf">Link to the presentation</a> . </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/f5GxvgyHznM" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>           . </p><br><p><img src="https://habrastorage.org/webt/nc/ql/yy/ncqlyyzd8yl0m6dccei1omdfq_0.png"><br></p><br><p>       Spark Streaming  Kafka.        ,   ,     . </p><br><p>   : </p><br><p><img src="https://habrastorage.org/webt/5c/lv/qb/5clvqblqh_o27iggbxdenw85_cw.png"><br></p><br><p> ,        Java,    Scala.   ,      Scala,     . </p><br><p> ,        ¬´real-time¬ª   ,   ,        -,      . </p><br><p>       ,       .  ,         ,         .     5  50 . </p><br><p>  2017     -       .     ,       ,     -  .         (      ,       .. ‚Äî ,      ).     data lake,     :-) </p><br><p><img src="https://habrastorage.org/webt/fx/ni/g4/fxnig4cmmd1qkvql3kbzptrpyh0.png"><br></p><br><p>    ‚Äî Spark.   ,       .      ,        ‚Äî   .   ,    - . </p><br><p>   ‚Äî  .    ,      ..  ,    ‚Äî      ,   . </p><br><p><img src="https://habrastorage.org/webt/2r/aj/pl/2rajplt1ysuaatebhx4hr8dsqyk.png"><br></p><br><p>  ,    cassandra to spark.       ,     . </p><br><p>      ,  . Publish-subscribe,   ..    ,  JMS      ,    ,      ‚Äî  point to point,  publish-subscribe,    ,   fault tolerance  .. </p><br><p>     Kafka.        :         . </p><br><p>        ,   Zookeeper. </p><br><p><img src="https://habrastorage.org/webt/zs/0u/lh/zs0ulhkgpvj6rngup-0qmsvcvfk.png"><br></p><br><p>      .     ,       ,             .    producer, consumer,        . </p><br><p>       ,     ,   dstreams.  ,     .       . </p><br><p>            API. </p><br><p><img src="https://habrastorage.org/webt/s3/51/n3/s351n3zf95yofrsrrqynwakidh8.png"><br></p><br><p>        .       -,      .   ¬´  ¬ª ¬©,     .        . </p><br><p>     ‚Äî   ,      : filter, sort, aggregate, join, foreach, explain  ..     . </p><br><p>         ,  Explain,   : </p><br><p><img src="https://habrastorage.org/webt/s3/51/n3/s351n3zf95yofrsrrqynwakidh8.png"><br></p><br><p>   : </p><br><p><img src="https://habrastorage.org/webt/8i/3m/kt/8i3mktshye9bvddtd4z-qhd4gr0.png"><br></p><br><p>     , ,  ,      ,     .         -. </p><br><p> , ,     . ,         ‚Äî       . ,  . </p><br><p>      ? ,         ,       ¬´¬ª .   ,       ‚Äî        ,  ,      ,       .        ‚Äî  . </p><br><h1 id="4-tehniki-vektorizacii-koda-v-jvmhttps2017jbreakrutalksvector-programming-in-java-jb"> 4. <a href="https://2017.jbreak.ru/talks/vector-programming-in-java-jb/">    JVM</a> </h1><br><p> <strong></strong> :  ; <strong></strong> : 4.47 ¬± 0.11.  <a href="https://assets.contentful.com/oxjq45e8ilak/1ZZZNufmfu2YQymoUcceMG/3225f94992a188d953928bb0d5bdf301/Vectors_2017_JPoint.pdf">Link to the presentation</a> . </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/9Ow9FCd-bSY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>  : ¬´ ,   ?¬ª </p><br><p><img src="https://habrastorage.org/webt/aa/br/b2/aabrb22dmzrgvr02lqg2f8t_z2q.png"><br></p><br><p>    ,        :-) ,     : </p><br><p>    ‚Äî OpenJDK,   , ,    ,    ‚Äî   . </p><br><p> 12     :      . Throughput     .   , ,   .     SIMD. ,     x86:  ,      .. </p><br><p><img src="https://habrastorage.org/webt/gb/rb/q7/gbrbq75wm-dpzydgie7ky8pwalo.png"><br></p><br><p>   : ,       (low-level ). </p><br><p>       .          (  ,  ). Anger Fog    ,      ,     . JVM      ,    ,  JVM    ,   . </p><br><p>       SIMD-,    ,       .   <code>-XX:+UseSuperWord</code>         . </p><br><p><img src="https://habrastorage.org/webt/4e/44/kz/4e44kzovyw2fow9lt_2mqwdk6o8.png"><br></p><br><p>      ( <code>-XX:+PrintCompilation</code> , <code>-XX:+TraceLoopOpts</code> ),     <code>-XX:+PrintAssembly</code>     .     ,     ‚Äî    .   ,          . ,           . </p><br><p><img src="https://habrastorage.org/webt/js/yx/pq/jsyxpqsxw6-i4k-nfe3yzw3qxki.png"><br></p><br><p>         Fused Operations,          JDK.   AVX-512,   10     x86. </p><br><p><img src="https://habrastorage.org/webt/oh/ke/r2/ohker2x5ntilx2fkxa4x4tg0tto.png"><br></p><br><p>    : <code>System.arraycopy</code> , <code>Arrays.copyOf</code> ,   : <code>Arrays.mismatch</code> , <code>ArraysSupport.vectorizedMismatch</code> . </p><br><p>   ,      Java   SIMD  2017 .          Panama,      API.    :   , ,        OpenJDK. </p><br><p><img src="https://habrastorage.org/webt/xs/on/dg/xsondgic7ibptyyhur5ctvyuucq.png"><br></p><br><p>      ,            JVM.               -   OpenJDK,    , ,    (   Graal &amp; Truffle,      ). </p><br><h1 id="3-performans-chto-v-imeni-tebe-moyomhttps2017jbreakrutalksperformance-whats-in-it-for-you"> 3. <a href="https://2017.jbreak.ru/talks/performance-whats-in-it-for-you/">:     ?</a> </h1><br><p> <strong></strong> :  ; <strong></strong> : 4.47 ¬± 0.06.  <a href="https://shipilev.net/talks/jpoint-April2017-perf-keynote.pdf">Link to the presentation</a> . </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/CgRJUqO-dMQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>  ,         ,      JPoint,   JBreak.      . </p><br><p>    , <a href="https://habrahabr.ru/company/jugru/blog/346364/">      JPoint 2017</a> .       ,   . </p><br><h1 id="2-java-9-moduli-pochemu-ne-osgihttps2017jbreakrutalksjava-9-modules-why-not-osgi"> 2. <a href="https://2017.jbreak.ru/talks/java-9-modules-why-not-osgi/">Java 9 .   OSGi?</a> </h1><br><p> <strong></strong> :  ; <strong></strong> : 4.60 ¬± 0.06.  <a href="https://downloads.contentful.com/oxjq45e8ilak/1USdcUmBVe0AOEo8YMyI2a/30b688e60fe404f139a6c813b3dcf0be/Nikita_Lipsky._Java_9_Modules._Why_not_OSGi_.pdf">Link to the presentation</a> . </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/hEnvRXNyDgI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>    ,        OSGi.  ,      (..    JUG.ru Group),   ‚Äî      Java <a href="https://www.excelsiorjet.com/">Excelsior JET</a> ,    17  (     Java ),       .        ,        -  ,     . , ,  Mark Reinhold (   -  OpenJDK,   JET,        ),     . </p><br><p>  Java 9  , , ,    .   ,     ,      ,      .   ,     -  ,        . </p><br><p>        :   ,    Maven  OSGi.   Maven  -  (,   ,       ),   OSGi  . </p><br><p>      -  : </p><br><p><img src="https://habrastorage.org/webt/3r/sy/gt/3rsygtkoltajgpdlzzmkaqb8-6s.png"><br></p><br><p>         :   OpenJDK,  , , .     ,  -,   ‚Äî ,  OpenJDK ,          ‚Äî  (   ). </p><br><p>     ,   OSGi,   ,            . </p><br><p><img src="https://habrastorage.org/webt/ca/r3/-h/car3-hqbzbkacgewq9pamrrlvlg.png"><br></p><br><p>     OSGi.    ,     : </p><br><p><img src="https://habrastorage.org/webt/rr/ac/xw/rracxwi_oisdcdzfmlzkerx_tas.png"><br></p><br><p>    ,    (,        , classloader memory leaks,   ).     ,  OSGi      loading constraints (   ¬´LinkageError¬ª,    ).  ,    ,  <strong></strong>  ‚Äî        .     ,  OSGi  , , . </p><br><p>     .  JVM      .  JVM ( ,    ),      (    ),   (    ). OSGi     !        ,   HotSpot     .   ,     ‚Äî   OpenJDK    ,   .  -,  ,      (, Graal &amp; Truffle!). </p><br><p>    ,     (    ,      ) ‚Äî   . ,     <a href="https://habrahabr.ru/users/pjBooms/">@pjbooms</a>   ,       ,     - . </p><br><p>   ,  Jigsaw      ,        .  ¬´ Jigsaw¬ª: ¬´reliable configruation + strong encapsulation¬ª          : </p><br><p><img src="https://habrastorage.org/webt/bv/tn/uv/bvtnuvxasxfzd2_-ga65_z-ixqc.png"><br></p><br><p>     , . </p><br><p>        ? <strong> .</strong>      ,      advanced     JVM,  must have          .   -    :  OSGi        (  low level ,     ‚Äî       ),     ‚Äî          (   ,  ¬´  ¬ª ‚Äî  ).      ‚Äî     . </p><br><h1 id="1-shenandoah-sborschik-musora-kotoryy-smoghttps2017jbreakrutalksshenandoah-the-garbage-collector-that-could"> 1. <a href="https://2017.jbreak.ru/talks/shenandoah-the-garbage-collector-that-could/">Shenandoah:  ,  </a> </h1><br><p> <strong></strong> :  ; <strong></strong> : 4.62 ¬± 0.06.  <a href="https://shipilev.net/talks/jpoint-April2017-shenandoah.pdf">Link to the presentation</a> . </p><br><iframe width="560" height="315" src="https://www.youtube.com/embed/ZYiQCHxgABI" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><p>  ,         ,      JPoint,   JBreak.     . ¬´ ,  ¬ª     #1    . </p><br><p>    , <a href="https://habrahabr.ru/company/jugru/blog/346364/">      JPoint 2017</a> .       ,   . </p><br><h1 id="zaklyuchenie">  Conclusion </h1><br><p>            <a href="https://2017.jbreak.ru/">JBreak 2017</a> .  ,             . </p><br><p>            .       . </p><br><p>  JBreak  , ,  .   , 4  2018,       <a href="https://2018.jbreak.ru/">JBreak 2018</a> ,     ,    . <a href="https://2018.jbreak.ru/tickets/"> </a>   . </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/346490/">https://habr.com/ru/post/346490/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../346480/index.html">Features scanning antivirus executable files and trust the results of VirusTotal</a></li>
<li><a href="../346482/index.html">Using cucumber as a business rules engine</a></li>
<li><a href="../346484/index.html">The largest events of 2018: design and front-end</a></li>
<li><a href="../346486/index.html">Overview of the procurement of web applications on the Zend Framework 3</a></li>
<li><a href="../346488/index.html">21 tips to make better use of Composer</a></li>
<li><a href="../346492/index.html">A story about how I live via meltdown on your phones using npm</a></li>
<li><a href="../346494/index.html">Expectations and reality - our experience in creating and promoting mobile games</a></li>
<li><a href="../346496/index.html">A new ‚Äúpassword‚Äù vulnerability has been discovered on Mac OS High Sierra.</a></li>
<li><a href="../346498/index.html">Tutorial on the Unreal Engine. Part 9: Artificial Intelligence</a></li>
<li><a href="../346500/index.html">JavaScript features that I didn't know existed</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>