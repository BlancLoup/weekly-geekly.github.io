<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Yandex has released antivirus for sites - Manul</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Yandex search every day shows people more than eight million warnings that the page they want to go to is infected. Often, the site owner remembers th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Yandex has released antivirus for sites - Manul</h1><div class="post__text post__text-html js-mediator-article">  Yandex search every day shows people more than eight million warnings that the page they want to go to is infected.  Often, the site owner remembers that his site can be hacked and malicious code can be placed on it, only when the worst has already happened, the traffic has dropped, and users have managed to become infected. <br><br>  So that webmasters can respond to problems as quickly as possible, we have been sending infection alerts on <a href="https://webmaster.yandex.ru/">Yandex.Webmaster</a> for several years.  In them we give detailed instructions on what to do, and in the most difficult cases webmasters are assisted by our support service. <br><br> <a href="http://habrahabr.ru/company/yandex/blog/256463/"><img src="https://habrastorage.org/files/c4f/2f5/699/c4f2f56997f249e2b4ed2454a37fdfdb.jpg"></a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      However, you always want the best.  One of the main problems we face when communicating with owners of infected sites is finding the source of infection on the server side.  Yandex, which lists thousands of sites every day as infected with a virus and dangerous for human devices, has a regularly updated database of viruses.  And our team has an idea that has grown into a big project - an antivirus for sites.  So we created <a href="http://yandex.ru/promo/manul">Manul</a> , which we decided to put <a href="https://github.com/antimalware/manul/">in open source</a> .  This is a utility that will help the webmaster understand what happened to the site and cure it.  Under the cut, I will tell you more about how it works and what problems it solves. <br><a name="habracut"></a><br>  Infection of the site may occur not only because of its hacking, but also because of placing on it the code of any service that turned out to be not as reliable as you initially thought.  When this happens to important sites for people, it harms not only their owners. <br><br>  Our support team receives dozens of emails from webmasters every day asking for help to cope with the infection.  But we, as a rule, see only the outbreaks of infection and often cannot say with certainty where exactly the malicious code should be searched for on the server.  Similarly, we can not guarantee that the source of infection is only in one place.  Thus, the main work to eliminate the causes of infection falls on the shoulders of the site owner, and because of this, the recovery process may be delayed.  At the same time, we know that most of the problems are simple, but massive infections, calculated, for example, on the long-known vulnerabilities of old versions of CMS and individual components. <br><br>  Therefore, we have an idea to make a simple tool - an anti-virus utility that would collect structured information about the site.  After that, it should be possible to analyze the collected data independently or send it to a specialist.  In addition, I would like such specialists to be like us, as well as studios or individual specialists who are also engaged in the treatment of sites, and if desired, the webmaster could do it himself.  And, of course, the tool should be able to offer a healing script to automate the treatment process from beginning to end.  Especially for ordinary cases. <br><br><img src="https://habrastorage.org/files/fcf/d35/972/fcfd359725f74bdca934756cb24afa5a.jpg"><br><br>  We began to think how this can be realized.  It was clear that this should be an easy to install utility that would not require access to administrator accounts.  Since Yandex informs webmasters about the infection on their website, it will be sufficient if, in the event of such an infection, the utility can be quickly downloaded and installed, and after the treatment ends, it is also easy to delete the folder with the antivirus from the server. <br><br>  Antivirus solutions for sites on the market already existed, but differed from what we would like to see: a free open source tool that is easy to use and which can be developed and supplemented by everyone.  When creating our anti-virus utility, we decided to share our experience with <a href="http://revisium.com/">Revisium</a> . <br><br>  Gregory Zemskov of Revisium had a great experience in scanning and treating sites on the server side, as well as a working solution - the Ai-Bolit script, which already contained a significant part of the desired functionality.  We have combined our knowledge and wishes, and something new has happened - Manul. <br><br><h3>  How does all this work? </h3><br>  The archive with Manul is uploaded to the root directory of the site - for example, via FTP / SFTP, and is unpacked there.  Further work with the tool goes through the browser.  When scanning, Manul collects information about all the files in the root directory and below it ‚Äî about their size, date of last change, and calculates the hash sum.  In parallel, each file is checked for maliciousness by the attached anti-virus database and is marked with one of three check boxes: <br><br><ul><li>  yellow - there is a suspicious code in the file, which, due to various signs, can be malicious; </li><li>  red - the malicious code known to us is present in the file; </li><li>  green - nothing suspicious was found in the file. </li></ul><br>  After completing the check, Manul saves all received information as an XML report.  Code snippets - both suspicious and malicious - are also attached to the report. <br><br><img src="https://habrastorage.org/files/11f/ab7/a54/11fab7a54e484ee794cb873c9901487e.jpg"><br><br>  To view the report there is a separate tool - Log <a href="http://yandex.ru/promo/manul/analyzer/">Analyzer</a> Manul, available online.  It presents a report in the form of a table, allows you to filter files by a set of properties such as size, modification date and others, view fragments of a suspicious code.  For various versions of popular CMS, the Analyzer automatically applies whitelists to immediately filter files from the standard configuration, in which no changes were noticed.  And by clicking the Quarantine and Delete buttons located opposite each file, you can create a script for Manul, which will remove malicious files from the server, and suspicious ones will be placed in the archive for sending for analysis.  You can execute this script by opening Manul and clicking on the Treatment tab. <br><br><img src="https://habrastorage.org/files/e80/36b/3e8/e8036b3e89c248929891b064253359d1.jpg"><br><br>  Manul does not require access to sensitive data (such as passwords).  All actions performed with the files are monitored and confirmed by the site owner.  To prevent third parties from using the tool, it is necessary to protect it with a password when it is first started.  No data about the site and user when using the utility is not automatically sent anywhere. <br><br>  The utility is not demanding to the execution environment and is designed to run even on weak hostings.  But still, for launching, it needs to fulfill certain conditions: the PHP version is at least 5.2 and that it contains ZipArchive modules, DOM and XML.  Manul will also need read access to the web_root / public_html virtual host directory. <br><br><h3>  What next? </h3><br>  We decided to make it so that any webmaster could take advantage of our work.  To do this, we have placed our Anti-Virus on Yandex.Webmaster and now we will always remind about its capabilities along with the notification that the site has been infected with a virus. <br><br>  However, we have decided not to stop at what we have achieved.  We want every developer to have the opportunity not only to use our Manul, but also to give it a new life.  Manul is an open source project posted on <a href="https://github.com/antimalware/manul/">GitHub</a> .  You can take part in its development, add new features or adapt the source code to your own needs. </div><p>Source: <a href="https://habr.com/ru/post/256463/">https://habr.com/ru/post/256463/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../256445/index.html">Performance evaluation of Django Session Engine configurations</a></li>
<li><a href="../256451/index.html">We crack D-Link DIR-890L</a></li>
<li><a href="../256453/index.html">City laboratory of data analysis: we assemble a team</a></li>
<li><a href="../256459/index.html">Image and video analysis. Image classification and object recognition</a></li>
<li><a href="../256461/index.html">Where to get a half million for a cybersecurity startup</a></li>
<li><a href="../256465/index.html">Program of the 2nd International Roboforum</a></li>
<li><a href="../256467/index.html">Game development: 4 years and two new people</a></li>
<li><a href="../256469/index.html">Asynchronous Programming in Dart (Part 1)</a></li>
<li><a href="../256471/index.html">Another way to find out who is logged in to the site using faye + redis</a></li>
<li><a href="../256473/index.html">Again, a harsh open source for state-owned companies and big business with examples of solutions. I believe in him, if that</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>