<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Basics of creating a 2D character in Unity 3D 4.3. Part 2: Running Character</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Part 1: character preparation and animation of rest 
 Part 2: Running Character 
 Part 3: jumping (and falling) 

 Hello. We continue the work begun i...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Basics of creating a 2D character in Unity 3D 4.3. Part 2: Running Character</h1><div class="post__text post__text-html js-mediator-article">  <a href="http://habrahabr.ru/post/211472/">Part 1: character preparation and animation of rest</a> <br>  <b>Part 2: Running Character</b> <br>  <a href="http://habrahabr.ru/post/212309/">Part 3: jumping (and falling)</a> <br><br>  Hello.  We continue the work begun in the first part.  Now we have a platform and a character standing on it with a rest animation.  It is time to teach our character to run left and right on the platform. <br><a name="habracut"></a><br>  Load the scene from the first part.  Let me remind you that last time we imported several sprites into the <i>Assets</i> - <i>Sprites</i> folder.  Just in case, at the bottom of the post again give a link to the sprites.  Among them should be a sprite called <i>Run</i> .  We will use it to create running animation.  To do this, we need to do the same to turn a single sprite into a collection, just like when creating a rest animation.  In brief, let me remind you: select the sprite, set the <i>Sprite Mode</i> property as <i>Multiple</i> in the <i>Inspector</i> window, click on the <i>Sprite Editor</i> below, cut the image in <i>Grid</i> or <i>Automatic</i> mode. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/1a3/366/d0b/1a3366d0b937e0a9bbc6172a0a56fc75.png">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Now in the <i>Hierarchy</i> window, select <i>Character</i> and go to the <i>Animation</i> window.  Click on the field with the <i>Idle</i> animation and select <i>Create New Clip</i> to create a running animation.  Let's save the animation file in the <i>Assets</i> - <i>Animations</i> folder with the name <i>Run</i> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/6a9/8c8/009/6a98c8009f5166566acbff55897eb880.png"><br><br>  The newly created <i>Run</i> animation has become current in the <i>Animation</i> window.  We expand the <i>Run</i> sprite in the <i>Project</i> window, <i>select</i> all <i>Run_0 ... Run_9 files</i> and drag them into the <i>Animation</i> window.  Set while the <i>Sample</i> value is 24. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/41d/5fd/b16/41d5fdb16bea615ba875f679a68d1c7f.png"><br><br>  We have already done all this in the first part, and now there will be something new.  Go to the window <i>Animator</i> .  Now three animations are displayed there: <i>Any State</i> , <i>Idle</i> and <i>Run</i> .  We have to set the conditions for the transition from the <i>Idle</i> animation to the <i>Run</i> animation, that is, from the rest state to the running state.  In the lower left corner there is a <i>Parameters</i> field.  Click on the plus sign, select <i>Float</i> and call the new parameter as <i>Speed</i> .  Thus, we have created a parameter such as a number with a floating point, denoting the speed of movement of the character.  It is precisely depending on the value of this parameter that switching from rest animation to running animation will occur.  Now we right-click on the <i>Idle</i> animation, select <i>Make Transition</i> and left-click on the <i>Run</i> animation.  A line with an arrow will appear between the animations.  Move the rectangles of the animation with the mouse, if it is hard to see.  Click on the line with the arrow.  The <i>Inspector</i> window <i>displays the</i> transition properties between animations.  Let's pay attention to the bottom of the window, in the <i>Conditions</i> section.  Click on the <i>Exit Time</i> parameter and change it to <i>Speed</i> .  The second <i>Greater</i> field is left unchanged, and in the third field we enter the value <i>0.01</i> .  We have created a condition for the transition from rest animation to running animation - it occurs when the value of the speed parameter becomes a little more than zero. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ab9/a78/f96/ab9a78f9658651935b86f43ac7991dd5.png"><br><br>  Now you need to do a reverse transition - from <i>Run</i> to <i>Idle</i> .  We do everything exactly the opposite: <i>Make Transition</i> from <i>Run</i> to <i>Idle</i> , select the transition, in the <i>Conditions</i> set <i>Speed</i> - <i>Less</i> - <i>0.01</i> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/c9e/fab/bf7/c9efabbf72fc496a47817486677d5db2.png"><br><br>  Now we have two animations and transition conditions between them.  But so far nothing will work, because all that we have done is to be ‚Äúrevived‚Äù with the help of a script.  Let's move to the <i>Project</i> window and create a subfolder of <i>Scripts</i> in the <i>Assets</i> folder.  Add a new <i>C # Script to it</i> , name it <i>CharacterControllerScript</i> and open it for editing. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cda/a8c/9c6/cdaa8c9c623e4eb980e77a4979c7944f.png"><br><br>  I will give a full listing of the script with detailed comments, and below I will also explain what is happening in it. <br><pre><code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> UnityEngine; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">CharacterControllerScript</span></span> : <span class="hljs-title"><span class="hljs-title">MonoBehaviour</span></span> { <span class="hljs-comment"><span class="hljs-comment">//   .   public float maxSpeed = 10f; //     / private bool isFacingRight = true; //    private Animator anim; /// &lt;summary&gt; ///   /// &lt;/summary&gt; private void Start() { anim = GetComponent&lt;Animator&gt;(); } /// &lt;summary&gt; ///     FixedUpdate, . .   Animator  ///   Animate Physics = true       /// &lt;/summary&gt; private void FixedUpdate() { // Input.GetAxis   .        -1  1. //    //-1        (  ), //1        (  D) float move = Input.GetAxis("Horizontal"); //      Speed    . //     anim.SetFloat("Speed", Mathf.Abs(move)); //    RigidBody2D.      , //       .  rigidbody2D.velocity = new Vector2(move * maxSpeed, rigidbody2D.velocity.y); //     ,     if(move &gt; 0 &amp;&amp; !isFacingRight) //   Flip(); // .    else if (move &lt; 0 &amp;&amp; isFacingRight) Flip(); } /// &lt;summary&gt; ///           /// &lt;/summary&gt; private void Flip() { //    isFacingRight = !isFacingRight; //   Vector3 theScale = transform.localScale; //      theScale.x *= -1; //   ,  ,    transform.localScale = theScale; } }</span></span></code> </pre> <br><br>  So, we have entered several variables: to set the maximum movement speed, to determine the direction (left / right) and to work with the <i>Animator</i> component.  Almost all actions take place in the <i>FixedUpdate</i> method.  In it, we get the value of the <i>X</i> axis, which changes when you press the left-right or AD keys on the keyboard (if you did not change the corresponding project settings!).  Then set this value to the <i>Speed</i> parameter of the <i>Animator</i> component.  Note that we take the modulus of this value using the <i>Mathf.Abs</i> method, since when creating conditions for the transition between rest and run animations, we compare the value of the parameter with a positive number of <i>0.01</i> .  We do not care here which way the character is running.  What matters is the magnitude of the value.  Next, set the speed of movement along the <i>X</i> axis in accordance with the value of the maximum speed.  And finally, we check in which direction the character is running, and in which direction he is at this moment turned.  If he runs to the right, and turns to the left - turns it to the right by inverting its size along the <i>X</i> axis.  And vice versa.  In this simple way we got rid of the need to do two animations instead of one: for running to the right and for running to the left. <br><br>  Save the script.  In Unity, drag it onto our <i>Character</i> in the <i>Hierarchy</i> window.  Run the game, click left-right or AD. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/52b/932/43c/52b93243cc794855d6fe6ef60b47a986.png"><br><br>  Captain Claw can now run!  The speed of the animation was quick.  It can be reduced by decreasing the <i>Sample</i> value in the <i>Animation</i> window for the <i>Run</i> animation (a value of 12 will be normal).  If simultaneously with the game you can see the <i>Animator</i> window, then you will see that during rest <i>Idle</i> animation (running blue progress bar) works, and during running there is a transition to <i>Run</i> animation, and, accordingly, it works. <br><br>  That's all for now.  It remains for us to deal with jumps ... and find out at the same time a few new things! <br>  <a href="https://drive.google.com/file/d/0B5GzwYagj4HgeFhOTFVvQy10VEk/edit%3Fusp%3Dsharing">Link</a> to sprites. <br><br>  <b>Update:</b> added a video of the result. <br><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/7NMC58e-Wbw%3Ffeature%3Doembed&amp;xid=25657,15700021,15700186,15700190,15700253&amp;usg=ALkJrhiYOTx2B4gviRcROrBcHIlkTpz1zw" frameborder="0" allowfullscreen=""></iframe></div><p>Source: <a href="https://habr.com/ru/post/211847/">https://habr.com/ru/post/211847/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../211831/index.html">NYPD is testing Google Glass</a></li>
<li><a href="../211835/index.html">The largest space telescope in history has received the last three mirrors</a></li>
<li><a href="../211839/index.html">Created a 3D printer that can print carbon fiber parts</a></li>
<li><a href="../211843/index.html">Porridge, sir! Build a project on InterSystems Cach√© using Jenkins</a></li>
<li><a href="../211845/index.html">How I hacked the githab again</a></li>
<li><a href="../211849/index.html">Beginner musicians: why it is worth laying out albums on Jamendo</a></li>
<li><a href="../211851/index.html">On the Poincare conjecture. Lecture in Yandex</a></li>
<li><a href="../211853/index.html">Cross-platform https server with non-blocking sockets. Part 2</a></li>
<li><a href="../211855/index.html">IBM can get rid of semiconductor business</a></li>
<li><a href="../211863/index.html">Polyfill to work around browser forms autocomplete</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>