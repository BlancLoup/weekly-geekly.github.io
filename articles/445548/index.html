<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Cyber ‚Äã‚ÄãQuest from Veeam Support Team</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This winter, or more precisely, on one of the days between Catholic Christmas and New Year, the technical support engineers at Veeam were engaged in u...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Cyber ‚Äã‚ÄãQuest from Veeam Support Team</h1><div class="post__text post__text-html js-mediator-article">  This winter, or more precisely, on one of the days between Catholic Christmas and New Year, the technical support engineers at Veeam were engaged in unusual tasks: they hunted for a group of hackers called ‚ÄúVeeamonymous‚Äù. <br><br><img src="https://habrastorage.org/webt/wr/jm/1d/wrjm1dgthjnkih1hvwzgb_7ogf0.jpeg"><br><br>  About how the guys themselves came up with and spent at work a real quest in reality, with tasks ‚Äúclose to combat,‚Äù said <b>Kirill Stetsko</b> , <b>Escalation Engineer</b> . <br><a name="habracut"></a><br>  <b><i>‚ÄúWhy did you start this at all?‚Äù</i></b> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      - In approximately the same way that people invented Linux at the time - just for fun, for their own pleasure. <br><br>  We wanted to move, and at the same time we wanted to do something useful, something interesting.  Plus, it was necessary to give some emotional relief to the engineers from their everyday work. <br><br>  <b><i>- Who suggested this?</i></b>  <b><i>Whose idea was it?</i></b> <br><br>  - The idea was our manager Katya Egorova, and then the concept and all further ideas were born together.  Originally thought to make a hackathon.  But during the development of the concept, the idea turned into a quest, yet the technical support engineer is a different kind of activity than programming. <br><br>  So, we called friends-comrades-acquaintances, different people helped us with the concept - one person with T2 (second line of support - <i>editor's note</i> ), one person with T3, a couple of people from the SWAT team (quick response team to urgent cases - <i>Ed.</i> ).  They all gathered together, sat down and tried to come up with tasks for our quest. <br><br>  <b><i>- It was very unexpected to find out everything about it, because, as far as I know, the script writers usually work out the quest mechanics, that is, you did not only do this complicated thing, but also with regard to your work, your professional field of activity.</i></b> <br><br>  - Yes, we wanted to do not just entertainment, but to ‚Äúpump over‚Äù the technical skills of engineers.  One of the tasks in our department is the exchange of knowledge and training, but such a quest is an excellent opportunity to give people to ‚Äútouch‚Äù some new techniques for them live. <br><br>  <b><i>- How did you invent the tasks?</i></b> <br><br>  ‚ÄúThey were brainstorming.‚Äù  We had an understanding that we have to do some technical tests, such that they are interesting and at the same time carry new knowledge. <br>  For example, we thought that people should be given to try to sniff traffic, use hex editors, do something for Linux, some slightly deeper things related to our products (Veeam Backup &amp; Replication and others). <br><br>  Also an important part was the concept.  We decided to start from the topic of hackers, anonymous access and the atmosphere of secrecy.  The symbol made the mask of Guy Fawkes, and the name came naturally - Veeamonymous. <br><br><h1>  "In the beginning was the word" </h1><br>  To stir up interest, we decided before the event to arrange a PR company in the quest theme: we hung posters announcing our office.  And after a few days, they secretly painted them themselves with spray cans and launched a ‚Äúduck‚Äù, they say, some attackers spoiled the posters, even put a photo with proof‚Ä¶. <br><br>  <b><i>- So you did it yourself, that is, a team of organizers ?!</i></b> <br><br>  - Yes, on Friday, at about 9 o'clock, when everyone had already left, we walked and drew a green letter ‚ÄúV‚Äù from cylinders.) Many of the participants in the quest never realized who did this - people came to us and asked who spoiled the posters ?  Someone very seriously approached this issue and arranged a whole investigation on this topic. <br><br>  For the quest, we also wrote audio files, ‚Äúripped out‚Äù sounds: for example, when an engineer logs into our [production CRM] system, then there is an answering machine robot that speaks all sorts of phrases, numbers ... Here we are from those words that he has written down, made up more or less meaningful phrases, well, maybe a little bit of curves - for example, we got ‚ÄúNo friends to help you‚Äù in the audio file. <br><br>  The IP address, for example, we represented in binary code, everything, again, with the help of these numbers [spoken by the robot], all kinds of frightening sounds were added.  They shot the video themselves: in the video we have a man sitting in a black hood and in the mask of Guy Fawkes, but in fact there is not one person, but three, because two stand behind him and keep the ‚Äúbackground‚Äù from the blanket :). <br><br>  <b><i>- Well, you are confused, just say.</i></b> <br><br>  - Yes, we caught fire.  In general, we first came up with our technical tasks, and then composed a literary-game outline on the subject of what allegedly happened.  According to the scenario, the participants hunted for a group of hackers called ‚ÄúVeeamonymous‚Äù.  The idea was also in the fact that we kind of ‚Äúbreak the 4th wall‚Äù, that is, we transfer events into reality - we drew from a can, for example. <br><br>  One of the native speakers of English from our department helped us with the literary processing of the text. <br><br>  <b><i>- Wait, but what for a native speaker?</i></b>  <b><i>Have you done this in English?</i></b> <br><br>  - Yes, we did for the St. Petersburg and Bucharest offices, so everything was in English. <br><br>  For the first experience we tried to make everything just work, so the script was linear and fairly simple.  Added more entourage: secret texts, ciphers, pictures. <br><br><img src="https://habrastorage.org/webt/5x/hw/0z/5xhw0zunwexogn9q2gpev-n1rbk.jpeg"><br><br>  We also used memes: there were a lot of pictures on the topics of investigations, UFOs, some popular horror stories - some teams were distracted by this, tried to find some hidden messages there, apply their knowledge of steganography and other things ... but, of course, there is nothing like that It was. <br><br><h1>  About thorns </h1><br>  However, in the process of preparation, we also encountered unexpected tasks for ourselves. <br><br>  Many fought over them and solved any questions that suddenly arose, but about a week before the quest they all thought that everything was gone. <br><br>  Probably worth a little talk about the technical basis of the quest. <br><br>  Everything was done on our internal ESXi lab.  We had 6 teams, so it was necessary to allocate 6 resource pools.  So, for each team we deployed a separate pool with the necessary virtual machines (the same IP).  But since all this was on servers that are on the same network, the current configuration of our VLANs did not allow us to isolate the machines in different pools.  And, for example, during the test run, we received situations when the machine from one pool connected to the machine from another. <br><br>  <b><i>- How could you correct the situation?</i></b> <br><br>  ‚ÄúAt first they thought for a long time, tested all sorts of options with permissions, separate vLANs to machines.  In the end, they did this - each team sees only the Veeam Backup server, through which all further work takes place, but does not see the hidden podpulul, which contains: <br><br><ul><li>  several windows machines </li><li>  Windows core server </li><li>  Linux machine </li><li>  VTL (Virtual Tape Library) pair </li></ul><br>  All pools are assigned a separate group of ports on the vDS switch and their Private VLAN.  This double isolation is just necessary to completely eliminate the possibility of network interaction. <br><br><h1>  About the brave </h1><br>  <b><i>- Anyone could take part in the quest?</i></b>  <b><i>How were the teams formed?</i></b> <br><br>  - It was our first experience of holding such an event, and the capabilities of our laboratory were limited to 6 teams. <br><br>  At first, as I said, we conducted a PR company: using posters and a newsletter, we were told that a quest would be held.  We even had some clues - phrases in binary code were encrypted on the posters themselves.  In this way, we became interested in people, and people already agreed among themselves with friends, with friends, and cooperated.  As a result, more willing people responded than we had pools, so we had to make a selection: we invented a simple test task and sent it to everyone who responded.  It was a logical task, it had to be solved for speed. <br><br>  The team allowed up to 5 people.  The captain was not required there, the idea was in cooperation, in communication with each other.  Someone is strong, for example, in Linux, someone is strong in tapes (backups on tapes), and everyone, seeing the task, could invest their efforts in a common solution.  Everyone communicated with each other, found a solution. <br><br><img src="https://habrastorage.org/webt/iq/db/69/iqdb69g4yhty019g5atmhlnlz9a.jpeg"><br><br>  <b><i>- And at what point did the event start?</i></b>  <b><i>Did you have some kind of ‚Äúhour X‚Äù?</i></b> <br><br>  - Yes, we had a strictly appointed day, we chose it so that there was less workload in the department.  Naturally, we notified the team leaders in advance that such and such teams are invited to participate in the quest, and they should be given some relief [regarding loading] on this day.  It turned out that it should be the end of the year, December 28, Friday.  They expected to take about 5 hours, but all the teams managed faster. <br><br>  <b><i>- Everyone was on an equal footing, did everyone have the same tasks based on real-life cases?</i></b> <br><br>  - Well, yes, each of the compilers took some stories from personal experience.  We knew about something that could be in reality, and it would be interesting for a person to ‚Äúfeel‚Äù it, look, figure it out.  They took some more specific things, such as data recovery from damaged tapes.  Someone with clues, but most teams coped on their own. <br><br>  Or it was necessary to apply the magic of fast scripts - for example, we had a story that a kind of ‚Äúlogical bomb‚Äù ‚Äútore up‚Äù a multivolume archive into random folders on a tree, and it was necessary to collect data.  You can do it manually - one by one to find and copy [files], or you can write a script using a mask. <br><br>  In general, we tried to adhere to the point of view that one problem can be solved in different ways.  For example, if you are a little more experienced or you want to ‚Äúget confused‚Äù, then you can solve it faster, and there is a direct solution to the problem ‚Äúhead on‚Äù - but at the same time you will spend more time on the task.  That is, almost every task had several solutions, and it was interesting which ways teams would choose.  So nonlinearity was precisely in the choice of a solution. <br><br>  By the way, the Linux-task turned out to be the most difficult - only one team decided it by itself, without prompts. <br><br>  <b><i>- And you could take tips?</i></b>  <b><i>How in this quest ??</i></b> <br><br>  - Yes, it was possible to take, because we understood that people were different, and those who lacked some knowledge could get into the same team, so in order not to delay the passage, and not to lose interest in the competition, we decided that we would hints.  For this, each team was watched by a man from the organizers.  Well, we made sure that no one cheaters. <br><br><img src="https://habrastorage.org/webt/my/ae/re/myaerew8nfuxe9uzmdqjmt1mets.jpeg"><br><br><h1>  About stars </h1><br>  <b><i>- And there were prizes for the winners?</i></b> <br><br>  - Yes, we tried to make the most pleasant prizes both for all participants and for the winners: the winners received designer sweatshirts with the Veeam logo and the phrase, encoded in hexadecimal code, in black).  All participants received a Guy Fawkes mask and a branded bag with a logo and the same code. <br><br>  <b><i>- So you have everything in the real quest was!</i></b> <br><br>  - Well, we wanted to do a cool, adult thing, and it seems to me that we did it. <br><br>  <b><i>- And there is!</i></b>  <b><i>And what was the reaction in the end to those who participated in this quest?</i></b>  <b><i>Did you achieve your goals?</i></b> <br><br>  - Yes, many then approached, saying that they clearly saw their weak points and wanted to tighten them.  Someone stopped being afraid of certain technologies - for example, dumping blocks from tapes and trying to get something out of there ... Someone realized that he needed to pull up Linux, and so on.  We tried to give a fairly wide range of tasks, but not quite trivial. <br><br><img src="https://habrastorage.org/webt/wc/3e/-c/wc3e-cruhmsxo_edjwj5e54xv7m.jpeg"><br>  <i>Winning team</i> <br><br><h1>  "Who wants, he will achieve!" </h1><br>  <b><i>- From those who prepared the quest, it took a lot of effort?</i></b> <br><br>  - In fact yes.  But this was most likely due to the fact that we had no experience in preparing such quests, such infrastructures.  (Let's make a reservation that this is not our real infrastructure - it just had to perform some kind of gaming functions.) <br><br>  For us it was a very interesting experience.  At first, I was skeptical, because the idea seemed to me even too cool, I thought that it was very difficult to implement.  But they started to do it, they started to plow, they started to catch fire, and in the end we did it.  And there were even virtually no overlays. <br><br>  In general, we spent 3 months.  For the most part, we invented the concept, discussed what we can implement.  In the process, of course, something changed, because we understood that we for some reason do not have the technical ability to do this.  On the move, we had to redo something, but so that the whole canvas, history and logic did not break.  We tried not only to give a list of technical tasks, but to make it go down in history, to be coherent and logical.  The main work was the last month, that is, 3-4 weeks before day X. <br><br>  <b><i>- That is, apart from your main activity, did you allocate time for preparation?</i></b> <br><br>  - We did this in parallel with the main work, yes. <br><br>  <b><i>- Are you being asked to do more?</i></b> <br><br>  - Yes, we have many requests to repeat. <br><br>  <b><i>- And you?</i></b> <br><br>  - We have new ideas, new concepts, we want to attract more people and stretch it in time - both the selection process and the game process itself.  In general, we are inspired by the ‚ÄúCicada‚Äù project, it is possible to google it - this is a very cool IT topic, people from all over the world come together to create branches, on forums, they use cipher translation and solve riddles, and so on. <br><br>  <b><i>- The idea was excellent, just respect for the idea and implementation, because it is really worth it.</i></b>  <b><i>I sincerely wish that this enthusiasm is not lost in you, so that all your new projects will also be successful.</i></b>  <b><i>Thank!</i></b> <br><br><img src="https://habrastorage.org/webt/dk/pe/hj/dkpehjwkout1oh28ojhaf9pdqwg.jpeg"><br><br>  <b><i>- Yes, but will it be possible to look at an example of a task that you definitely will not reuse?</i></b> <br><br>  - I suspect that we will not reuse any of them.  Therefore, I can tell you about the progress of the quest. <br><br><div class="spoiler">  <b class="spoiler_title">Bonus track</b> <div class="spoiler_text">  At the very beginning, players have the name of a virtual machine and credentials from vCenter.  Having logged into it, they see this car, but it does not start.  Here we must guess that something is wrong with the .vmx file.  After downloading it, they see the hint needed for the second step.  In fact, it says that the database used by Veeam Backup &amp; Replication is encrypted. <br>  After removing the hint, downloading the .vmx file back and successfully turning on the machine, they see that there is indeed a base64-encrypted base on one of the disks.  Accordingly, the task is to decrypt it and get a full-featured Veeam server. <br><br>  It is a little about a virtualka on which all this occurs.  As we remember, according to the plot, the main character of the quest is a rather dark personality and is engaged in something that is clearly not too legal.  Therefore, his work computer should have quite a hacker view that we had to create, despite the fact that it is Windows.  First of all, the mass of props was added, such as information on major hacks, DDoS attacks and the like.  Then they installed all typical software and put different dumps, files with hashes, etc. everywhere.  Just like in the movies.  Among other things, there were folders named for the principle of closed-case *** and open-case *** <br>  To go further, players need to restore hints from files in backups. <br><br>  Here it must be said that at the beginning, the players were given quite a bit of information, and most of the data (such as IP, logins and passwords) they receive during the quest, finding hints in backups or files scattered on the machines.  Initially, backup files are on the Linux repository, but the folder itself is mounted on the server (mounted) with the <i>noexec</i> flag, so the agent responsible for restoring files cannot start. <br><br>  After repairing the repository, the participants get access to all the content and can finally restore any information.  It remains to understand which one.  And for this they just need to examine the files stored on this machine, determine which ones are broken and what needs to be restored. <br><br>  At this stage, the scenario shifts away from general IT knowledge to specific Veeam functions. <br><br>  In this particular example (when you know the file name, but you do not know where to look for it), you need to use the search function in Enterprise Manager, and so on.  As a result, after the restoration of the entire logical chain, the players have one more login / password and the output of nmap.  This brings them to the Windows Core server, and by RDP (so that life does not seem to be honey). <br><br>  The main feature of this server: with the help of a simple script and several dictionaries, an absolutely meaningless folder and file structure was formed there.  And when you login, you receive a welcome message like "A logical bomb exploded here, so you have to collect hints for further steps in pieces." <br><br>  The following hint was divided into a multi-volume archive (40-50 pieces) and randomly decomposed into these folders.  Our intention was that players should show their talents in writing simple PowerShell scripts in order to put together a multi-volume archive using a well-known mask and get the required data.  (But it turned out like in that joke - some of the subjects turned out to be unusually physically developed.) <br><br>  The archive contained a photo of the cassette (with the inscription ‚ÄúLast Supper - Best Moments‚Äù), which gave a hint of using the connected tape library, where there was a cassette with a similar name.  That's just one problem - it turned out to be inoperable so much that it wasn‚Äôt even cataloged.  Here began probably the most hardcore part of the quest.  We erased the header from the cassette, so in order to restore the data from it, you just have to smash the ‚Äúraw‚Äù blocks and view them in the hex editor to find the markers of the beginning of the files. <br>  We find the marker, look at the offset, multiply the block by its size, add the offset and use the internal tool to try to recover the file from a specific block.  If everything is done correctly and the mathematics has come together, then the players have the .wav file in their hands. <br><br>  In it, using a voice generator, among other things, a binary code is dictated, which is revealed in another IP. <br><br>  This, it turns out, is a new Windows server, where everything hints at the need to use Wireshark, only it is not there.  The main trick is that there are two systems installed on this machine - only the disk from the second is disabled via the device manager offline, and the logical chain makes it necessary to reboot.  After that, it turns out that by default a completely different system should be loaded, where Wireshark is installed.  And we all this time were on the secondary OS. <br><br>  There is nothing special to do here, it is enough to turn on capture on a single interface.  A relatively careful examination of the dump clearly reveals the left packet sent from the auxiliary machine at regular intervals, in which there is a link to the youtube video, where players are asked to call a certain number.  The first caller will listen to the congratulations on the first place, the rest - an invitation to HR (joke)). <br></div></div><br>  By the way, we have open <a href="https://careers.veeam.ru/departments/support">vacancies</a> for technical support engineers and interns.  Welcome to the team! </div><p>Source: <a href="https://habr.com/ru/post/445548/">https://habr.com/ru/post/445548/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../445534/index.html">WebAuthn standard officially completed</a></li>
<li><a href="../445536/index.html">Asterisk. Dialplan Askozia 6. Outgoing calls</a></li>
<li><a href="../445538/index.html">‚ÄúSmart‚Äù home in terms of vulnerability: dealing with vectors and attack mechanics</a></li>
<li><a href="../445542/index.html">Optishokz earphones for those who do not like the sun and love music</a></li>
<li><a href="../445544/index.html">Digest news from the world of PostgreSQL. Issue number 15</a></li>
<li><a href="../445554/index.html">Firefox team released Lockbox password manager for its users</a></li>
<li><a href="../445556/index.html">Steam turbines: how hot steam turns into electricity</a></li>
<li><a href="../445558/index.html">OpenShift 4.0 - getting ready for the hyper-jump</a></li>
<li><a href="../445560/index.html">Cryptography in Java. KeyPair class</a></li>
<li><a href="../445562/index.html">Bloomberg: McDonald's will buy a personalization technology developer for $ 300 million</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>