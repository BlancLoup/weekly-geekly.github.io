<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How I managed to owe Amazon $ 12,000 in 1 day</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I am the head of a small IT company from Zelenograd. We are engaged in the integration of 1C programs and telephony. The company employs a little less...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How I managed to owe Amazon $ 12,000 in 1 day</h1><div class="post__text post__text-html js-mediator-article">  I am the head of a small IT company from Zelenograd.  We are engaged in the integration of 1C programs and telephony.  The company employs a little less than 20 people, and it so happens that I myself am responsible for the entire IT infrastructure. <br><br>  In principle, I love to do this and get acquainted with various new technologies.  One of these technologies has become virtualization and, in particular, such an interesting service as Amazon AWS. <br><br>  It is often necessary to quickly deploy multiple virtual machines with white IP addresses for laboratory purposes, use them for a couple of days, and nail them without regret.  In Amazon terminology, this service is called EC2, and allows you to perform such manipulations in minutes.  It is very convenient and worth a penny, because  Payment is according to the hourly rate. <br><a name="habracut"></a><br>  So, back in 2011, I actively studied Asterisk and used the service, at the end of the month they charged $ 20 to $ 30 from my card.  Then the need for the service disappeared, I turned off all the cars, made some backups and started receiving monthly bills of $ 3.66 and somehow didn‚Äôt get to know what this amount was charged for. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  First swallow </h4><br>  We started a new project and there was a need to create a fault-tolerant configuration.  I, of course, remembered Amazon AWS.  I went to the admin panel, looked at what appeared new, walked through the menu items, figured out what 3.66 was written off for, it was a backup of a virtual machine of 50 gigabytes in size, deleted it, and went to sleep with a sense of accomplishment. <br><br>  Monday morning, a lot of work and in a hundred letters from customers and colleagues, an obscure letter from Amazon with the following content: <br><br><div class="spoiler">  <b class="spoiler_title">Account Closure: Please Read</b> <div class="spoiler_text">  Greetings from Amazon Web Services, <br>  Please read this Amazon Web Services account. <br><br>  At Amazon Web Services, we routinely perform customer reviews.  It can be a third-party without your permission.  Please review your AWS account for unauthorized activity per directions below.  It seems like you‚Äôve got it. <br><br>  If your activity is not authorized, your account will be secured.  You need to reset your password when you return to our site.  Just click on ‚ÄúYour Account‚Äù at the top of our Home Page and select ‚ÄúForgot your Password?‚Äù When you‚Äôve entered your email address, you‚Äôll receive an email with a personalized link.  Click the link from the e-mail and follow the directions provided.  Your new password will be effective immediately.  If there is no unauthorized activity please reply. <br><br>  In addition to resetting your password, it‚Äôs possible to check your unused password.  EC2 instances, IAM users, and IAM users for access control keys. <br></div></div><br><br>  And I am not strong in English either, well, I think that's eccentric, I went there yesterday and pressed all the buttons there after half a year, and they are already beating the panic, okay, I'll go in the evening to continue what I started ... <br><br><h4>  In the evening </h4><br>  Before bed, I like to do something useful, especially from 12 to 2 nights.  I opened the letter, entered the account, and I see ... that I have 20 virtual machines running, and these are quite powerful, and therefore expensive. <br><br><img src="https://habrastorage.org/files/73a/475/d3d/73a475d3d3894620aa4befbb505f0183.png"><br><br>  Heart pounding, I select them in a crowd and for a couple of seconds I try to remove, it does not work, then I just stop.  Well, I think, reptiles were hacked, I got a hundred other dollars, and in fact all my cards are tied to my account. <br><br>  I go to billing, and there is such a picture: <br><br><img src="https://habrastorage.org/files/1cd/ebb/8a3/1cdebb8a35b2454d800ee04cfc55fc7b.png"><br><br>  It turns out that I did not run 20 machines, but 140. On <b>every continent</b> , in <b>every Amazonian data center</b> .  That's what I got! <br><br>  Characteristics of rented cars: <br><br><img src="https://habrastorage.org/files/169/710/5f5/1697105f56914054905d38fdbe7c3573.png"><br><br>  For the next hour, I tried to stop all this, changed the login password, turned on two-factor authentication, and created a case for help desk with the question: ‚ÄúWhat should I do with this all?‚Äù <br><br><h4>  In the morning </h4><br>  In the morning I looked at the price for my car, well, about half the amount is.  Naturally, I didn‚Äôt have any desire to part with such a huge amount, as of today.  Case continued to hang in the status of not considered, but I had another "fun" story, about how to get on $ 12000, and I have a rather careful attitude to security issues and the question: "How did I get this password?" Continued me torment <br><br>  I tried to untie my cards from Amazon billing, to which he replied with a refusal and a request to go to the Amazon.com site and manipulate my account there. <br><br>  Amazon.com met me with a couple of questions about who my first leader is and what is the name of a childhood friend, and allowed me to untie my credit card.  Half done. <br><br>  Then the bell rings on the cell, with clearly not Russian country code.  Since I do not speak any languages ‚Äã‚Äãexcept 1C, C ++, C # and PHP, I didn‚Äôt pick up the phone.  Fortunately, after 15 minutes I saw the first answer of the support. <br><br>  A small conversation ensued with the help of a colleague and Google translator.  Support understood the situation and began to give me assignments.  Change passwords, delete all virtual machines in all data centers, remove all bids at auctions for the purchase of computing power.  And since I didn't have anything in my account at all, I politely asked me to delete everything centrally, which I also politely refused. <br><br>  Each virtual machine was protected from deletion, I had to go into the settings and remove a special check mark.  This entertainment took me another hour and a half.  When I deleted the machines, I noticed that they all had the same time to create and launch them, so they were created by some kind of script. <br><br>  After removing all 140 cars, I decided to go over all the tabs and check if everything is ok.  And what do I see?  Right before my eyes, new cars appear, cluster together and start.  And this is after the change of all passwords and the inclusion of two-factor authentication ... <br><br>  I turn off the machines, read attentively the support task again, and I see a line about the rotation of the API keys.  Here's a pancake, I find them in the depths of the authorization system settings, I look at the date - 2011, and without regret I delete nafig, I don‚Äôt even remember, I myself created them or received a load during registration. <br><br>  After that, I still have about 40 minutes to remove the new 60 cars. <br><br>  I inform the support of the quest, to which I get an answer that my question will be submitted to the financial group, the amount is not small and do not expect a quick answer. <br><br>  Here is an extract from my account: <br><br><img src="https://habrastorage.org/files/d8d/460/0fb/d8d4600fb1764c3381dd33ae9884476e.png"><br><br><h4>  Call from Luxembourg </h4><br>  After some time, the bell rings again.  Again, I do not take, to no purpose to moo something into the phone, not understanding the issues.  In the mail there is a letter, in Russian, from some dude who is responsible for the European segment, with the question of when you can call and talk.  I was delighted, finally it is possible to communicate with a Russian-speaking person and find out prospects.  Please call me back. <br><br>  The dude seems to be a sales manager, wondering what my project is, which required so much power and whether I need a discount or some kind of help.  I explained the situation, said that I had been hacked, gave the case number.  The person at that end reacted with understanding to the problem, sympathized and said to contact for any questions.  It's nice when the company has a human face. <br><br><h4>  To be continued... </h4><br>  From the useful, I have already included two-factor authorization wherever I could.  I tortured my MacBook with various antiviruses that did not find anything. <br><br>  It took about 5 days, while there is no news, the amount of debt hangs behind me, April 4 is a settlement day ... <br><br>  upd.  There is a suspicion that the hacking occurred after the attack on the Bitrix site, in which the S3 storage was connected and the API key was specified, because the day before the hacking, in the productive protection module it was written that 314K hacking attempts were reflected, and 1800 forms were filled out on my website feedback :( <br><br>  upd2.  The guys from Bitrix support conducted an analysis of the site logs.  An attempt to attack was, trying to find passwords to the admin panel, use SQL injections and XSS vulnerabilities, but there is no confirmation of hacking. <br>  More API key is not used anywhere ... Amazon is silent. <br><br>  upd3.  The issue is resolved, as a one-time action I agreed to write off the debt.  Respect guys from Amazon :) <br><img src="https://habrastorage.org/files/e80/07f/d19/e8007fd1991b4d2285fe0ab2f7b73eaa.png"><br><br>  I asked them logs with IP addresses.  I want to understand all the same, hijacked the password or API keys.  I have static IP addresses both at home and at work, and I can set up the first unauthorized entry by logs. </div><p>Source: <a href="https://habr.com/ru/post/357764/">https://habr.com/ru/post/357764/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../357754/index.html">DropBox gives 3 GB for installing the Carousel application and 1 GB for installing the MailBox</a></li>
<li><a href="../357756/index.html">YouTube launches new video viewing mode</a></li>
<li><a href="../357758/index.html">Officially, support appeared 360 panoramic video in Youtube</a></li>
<li><a href="../357760/index.html">Thebat.net mail domain is closing</a></li>
<li><a href="../357762/index.html">Now you can store in the cloud the keys and the house</a></li>
<li><a href="../357766/index.html">Amazon for $ 59.99 per year offers unlimited cloud</a></li>
<li><a href="../357768/index.html">Youtube: activate the experimental interface</a></li>
<li><a href="../357770/index.html">How much does Amazon Web Services earn?</a></li>
<li><a href="../357772/index.html">Hackers who earned a burglary of private Photobucket service accounts were arrested</a></li>
<li><a href="../357774/index.html">Amazon S3 crossed with BitTorrent</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>