<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Wi-Fi networks: penetration and protection. 2) Kali. Hiding SSID. MAC filtering. WPS</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The first part of the cycle was very vividly met by the habrasoobshchestvo, which inspired me to accelerate the writing of the next part. Many useful ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Wi-Fi networks: penetration and protection. 2) Kali. Hiding SSID. MAC filtering. WPS</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/86a/21e/ea2/86a21eea2fd83bf4d9788eca3755693c.png" height="250"><br><br>  <a href="http://habrahabr.ru/post/224955/">The first part of the cycle</a> was very vividly met by the habrasoobshchestvo, which inspired me to accelerate the writing of the next part.  Many useful comments were left on the previous article, for which I am sincerely grateful.  As they say, you want to find flaws in your knowledge - write an article on Habr. <br><br>  In this article, we will talk about how you can detect ‚Äúhidden‚Äù networks, bypassing MAC filtering on an access point and why WPS (QSS in TP-LINK terminology) is a ‚Äúbackdoor in every home‚Äù.  Before that, let‚Äôs see how the wireless adapter and antenna work, and how <i>Kali Linux</i> (ex. <i>Backtrack</i> ) will help us in tests for penetrating wireless networks. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      All this has already been described in one way or another, both here and on other resources, but this cycle is intended to collect the scattered theory and practice together, in simple language, with conclusions that everyone can understand. <br><br>  Before reading, I strongly advise you to familiarize yourself with the <a href="http://habrahabr.ru/post/224955/">materiel</a> - it is short, but all our further actions and conclusions are based on it. <br><br>  <b>Table of contents:</b> <br>  <b>1)</b> <a href="http://habrahabr.ru/post/224955/">materiel</a> <br>  <b>2)</b> Kali.  Hiding SSID.  MAC filtering.  WPS <br>  <b>3)</b> <a href="http://habrahabr.ru/post/226431/">WPA.</a>  <a href="http://habrahabr.ru/post/226431/">OpenCL / CUDA.</a>  <a href="http://habrahabr.ru/post/226431/">Pick statistics</a> <br><a name="habracut"></a><br><h4>  Kali ... Kali Linux </h4><br>  Having learned about the existing mechanisms for protecting wireless networks in the <a href="http://habrahabr.ru/post/224955/">first part, it</a> ‚Äôs time to use this knowledge in practice and try to hack something (of course, our own).  If it works out - our defense is no good. <br><br>  All the manipulations will be carried out using <i>Kali Linux</i> - <a href="http://kali.org/">kali.org</a> .  This is a <i>Debian-</i> based build that was previously known as <a href="http://backtrack-linux.org/"><i>Backtrack</i></a> .  If this is your first acquaintance with this system, then I advise you to start right away with <i>Kali</i> , as there is everything that was in <i>Backtrack</i> , but more fresh. <br><br>  (Readers suggest that there are other similar builds - for example, <a href="http://wifiway.org/">wifiway.org</a> . However, I didn‚Äôt work with them.) <br><br>  Under Windows, you can also do a lot of the above, but the main problem is the lack of / poor support for the monitor mode of wireless adapters, which makes it difficult to catch packets.  Who cares - pay attention to <i>CommView</i> and <i>Elcomsoft</i> utilities.  They all require special drivers. <br><br>  <i>Kali is</i> very convenient to use from a flash drive - does it have a legacy from <i>Debian Wheezy</i> ( <s>do I have a nose for this?</s> ) Has a <b>persistence mode</b> that allows you to boot in three modes: work without saving data (read only), working with saving them on a separate section on a flash drive, the so-called persistence, or work without saving in live / vanilla mode (that is, read only and without using data in persistence - the original clean version of the distribution). <br><br>  But, of course, anyone who wants to install it on a hard disk can easily do this from the bootloader and from an already running shell.  The OS (LVM) supports encrypted partitions.  In addition, you can make your own assembly <i>Kali</i> - add packages, configure the bootloader, and more.  All this is described in detail in the <a href="http://docs.kali.org/">documentation</a> and does not cause problems, although the assembly requires a couple of hours of time. <br><br>  So, let's say you <a href="http://www.kali.org/downloads/">downloaded the ISO</a> and burn it to a USB flash drive (for * nix - <code>dd</code> , for Windows - <a href="http://sourceforge.net/projects/win32diskimager/">Win32DiskImager</a> ).  What's next? <br><br><h5>  Persistence mode </h5><br>  This article is not a guide to Linux, but I myself had problems launching this mode, so I decided to specifically describe its work. <br><br>  You can also use <i>Kali</i> in the Live CD mode, but if you want to be able to save the system state between reboots (data and settings), you need to create a separate <b>ext2</b> partition on a flash drive called <b>persistence</b> , for which you can use <b>GParted</b> as part of <i>Kali</i> itself and split USB flash drive while working with it.  When the partition is created, mount it and write there a single file named <b>persistence.conf</b> and the following contents: <br><pre> <code class="hljs objectivec">/ <span class="hljs-keyword"><span class="hljs-keyword">union</span></span></code> </pre><br>  Next, with each <i>Kali</i> boot, you need to specify in which mode to start the system.  To do this, in the bootloader, when the first <code>Live (i686-pae)</code> item is highlighted <code>Live (i686-pae)</code> (similarly to x64), press <b>Tab</b> - the kernel boot line appears.  We add space and type of load to the end: <br><br><ul><li>  <b>persistence</b> , ‚Äúcomplete consistency‚Äù - loading all data on a partition and saving changed data while it is working </li><li>  <b>persistence persistence-read-only</b> , ‚Äúpersistence without saving changes‚Äù - note that these are two words and you need to specify both, separated by a space, since without the first this mode will not start (it will be live mode).  In this mode, previously saved data to the partition will be loaded, but changes during this session will not be saved and after shutdown the distribution will return to its original state </li></ul><br>  If you do not specify the type of download, the system will be started in live (vanilla) mode - the <b>persistence</b> section will not be used and after loading it can be mounted and made some changes.  All data and settings during live mode will not be saved and are only stored in temporary memory. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/e30/51e/6ec/e3051e6ecb4771b640e93a11b4ce4251.png"></div><br>  In order not to drive in these modes at each boot, you can create your own <i>Kali</i> build (see the <a href="http://docs.kali.org/live-build/generate-updated-kali-iso">instructions on the site</a> ) - there is a boot loader setting where you can enter the necessary modes so that they are initially loaded into <code>persistence persistence-read-only</code> - in my opinion, this is the convenient, as initially set up everything you need, and then each session begins with a clean slate. <br><br><h4>  Use the tools, Luke </h4><br>  <s>The meeting is over, we are diverging, we are diverging.</s> <br><br>  Well, that got to the terminal.  Let's see who shines around us with ultra-waves. <br><br><h5>  Modes of Wi-Fi adapter </h5><br>  But first you need to transfer our wireless adapter (network card) to the ‚Äúhacker mode‚Äù - <b>monitor mode</b> . <br><br>  The fact is that every Wi-Fi adapter, or rather, an antenna, at the physical level picks up any signals sent by devices in range.  An antenna cannot "not receive" extraneous packets.  But the driver can work in three modes ( <a href="http://lazysolutions.blogspot.ch/2008/10/difference-promiscuous-vs-monitor-mode.html">actually 6</a> , but this is beyond the scope of this article): <br><br><ol><li>  <b>Client mode</b> (also <b>managed mode</b> ) - packets that are not intended for this adapter - are discarded, and the rest are transmitted inside the OS as ‚Äúreceived‚Äù.  In this mode, damaged packets are also discarded.  Normal operation "without whistles." </li><li>  <b>Monitor mode</b> (also <b>rfmon mode</b> ) - the driver does not filter packets and transmits everything that the antenna catches to the OS.  Packets with an incorrect checksum are <i>not</i> discarded and can be seen, for example, in <b>Wireshark</b> . </li><li>  <b>Promiscuous mode</b> - ‚Äúhalf way‚Äù monitor mode.  The driver will transfer packets received within the network to which we are currently connected (associated) to the OS, but unlike the normal mode, packets destined for other clients of this network will not be dropped.  Packets of other networks will be ignored.  It is clear that this only works when you can successfully connect and log in to a network (open or not).  Unlike the monitor, this mode is supported by fewer adapters.  When working in this mode, as well as in client mode, the driver will remove low-level channel headers from packets sent to the OS. </li></ol><br>  We need just the monitor mode - in the client mode we are not interested in looking at the packets that we intended ourselves, and for the promiscious mode we need to first connect to a certain network.  With the exception of damaged packets and the presence of 802.11 headers, the monitor mode can be the same and more than the random mode, and is supported by the lion's share of adapters.  The only problem is that not all adapters can simultaneously transmit data in monitor mode, but I personally had no problems with it. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/576/4f3/a29/5764f3a297e05703ce8bef1820f67ada.png"></div><br>  In the picture above, the bold lines show the packets that we intercept in different modes, and the broken lines are the packets caught by our antenna, but discarded by the driver due to the selected mode. <br><br>  We open the terminal and execute: <br><pre> <code class="bash hljs">airmon-ng start wlan0</code> </pre><br>  <b>wlan0</b> is the device ID of the adapter.  In * nix this is <b>wlan</b> + sequence number ( <b>wlan0, wlan1, wlan2</b> , etc.).  The adapter number can be found by running <b>ifconfig</b> or <b>iwconfig</b> (this one will only display the wireless adapter devices and their specific information). <br><br>  If <b>airmon-ng</b> displays a message <code>(monitor mode enabled on mon0)</code> , it means that the adapter has been successfully switched to monitoring mode. <br><br>  Please note that in the commands that we will execute further, the adapter identifier is also indicated, but the virtual one is <b>mon0</b> ( <code>mon1</code> , etc.), and not the initial one is <b>wlan0</b> .  <b>mon0</b> is an adapter created by <b>airmon-ng</b> , designed to work with monitor functions. <br><br>  Now this mode is supported by 80-90% of all adapters (in my experience), the most common of them are Atheros, Intel and TP-LINK.  The latter produces external adapters with interchangeable antennas up to $ 30 (I used the <a href="http://www.tp-linkru.com/products/details/%3Fcategoryid%3D%26model%3DTL-WN722NC">TL-WN722NC</a> + <a href="http://www.tp-linkru.com/products/details/%3Fcategoryid%3D2473%26model%3DTL-ANT2408CL">TL-ANT2408CL</a> - also, thanks to the USB, they can be connected to VMware).  A list of supported adapters is available on the <a href="http://aircrack-ng.org/doku.php%3Fid%3Dcompatibility_drivers%26DokuWiki%3D3524419c318530965780af7c3250d11f">Aircrack-ng wiki</a> . <br><br><h5>  Wireless channels </h5><br>  Wi-Fi is a technology of data transmission over the air, <s>that is, for free</s> using the same mechanism as in radio stations.  And just like in radio stations, if you transmit too much data on one frequency (usually 2.4 GHz), then you will not be able to make out what is related to it.  For this there is a division into channels. <br><br>  There are 13 channels in total, although the last channel, the thirteenth channel, is <s>unhappy and</s> is forbidden in some countries, so 1-12 are used most often.  However, the 13th can be turned on by choosing a country such as Bolivia (BO) for the wireless adapter, or any other where this frequency is allowed.  Yes, the technical possibility, as often happens, is in any adapter, but is blocked by ethical preferences. <br><br>  In addition, there is the 14th channel (the Japanese, as always, distinguished themselves) and the frequency of 5 GHz with 23 more channels.  In general, the 2.4 GHz channels partially overlap, plus their width can be 20 and 40 MHz.  This topic is confusing due to the presence of different versions of the standard - anyone interested can read in <a href="https://en.wikipedia.org/wiki/List_of_WLAN_channels">Wikipedia</a> .  We have enough of what has already been said.  So far, 5 GHz are used less frequently, but the techniques described below apply to this frequency as well. <br><br>  Some people use channel 13 to hide their networks, but this method is not even considered here, since it is enough to transfer the adapter to the desired region, as he sees them.  For example: <br><pre> <code class="bash hljs">ifconfig wlan0 down iw wlan0 reg <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> BO ifconfig wlan0 up iwconfig wlan0 channel 13</code> </pre><br>  Any wireless adapter can only receive and transmit data on one channel at a time.  However, the current channel can be changed as often as desired - to obtain complete information about wireless broadcasts around <b>airodump-ng</b> ( <s>after the advertisement</s> below) switches the channel several times a second and catch everything that comes across.  This is called <i>channel hopping</i> .  System programs do this ‚Äî for example, <code>NetworkManager</code> for GNOME, which shows the list of wireless networks in the upper right corner. <br><br>  If the channel is not fixed, then some packets may be lost - the adapter has switched to the next channel, and at this time a new packet has passed through the previous channel, but its antenna has not caught yet.  This is critical when you are trying to intercept handshake, so this command is used to disable all programs that use a wireless adapter and do not allow to fix the channel: <br><pre> <code class="bash hljs">airmon-ng check <span class="hljs-built_in"><span class="hljs-built_in">kill</span></span></code> </pre><br>  Without <b>kill</b> , a list of all suspicious processes will be displayed, and with <b>kill</b> they will be completed.  After that, the adapter will remain entirely at your disposal.  The above command is recommended to perform before any action other than a simple network overview, since the wireless adapter is a shared resource;  several programs can use it simultaneously (for example, you can catch a list of networks in <b>airodump-ng</b> and select WPS in <b>reaver</b> at the same time), but any of them can switch the channel, so it is important to fix it when it starts (usually the parameter is called <b>-c</b> or <b>- channel</b> ). <br><br><h5>  Antenna overclock </h5><br>  In addition to manipulating the region, <b>ifconfig</b> may try to force the adapter to operate at a higher power than it does by default.  The result strongly depends on the type of adapter and region, with long use it can spoil the device <s>and generally fry your nose</s> , so use it at your own peril and risk.  If successful, the antenna will be able to pick up weaker signals. <br><br><pre> <code class="bash hljs">ifconfig wlan0 down <span class="hljs-comment"><span class="hljs-comment">#       . iw reg set BO iwconfig wlan0 txpower 500mW # : iwconfig wlan0 txpower 30 ifconfig wlan0 up</span></span></code> </pre><br>  Typical power is 15‚Äì20 dBm.  If there is an error, there will be a message of type <code>Invalid argument</code> , however it may not be - after execution, check the <i>txpower</i> value in <b>iwconfig</b> . <br><br><a name="airodump"></a><br><h5>  They are among us </h5><br><img src="https://habrastorage.org/getpro/habr/post_images/208/dc4/79a/208dc479ae3ab5ec0407a5c0542f9271.jpg"><br><br>  We carry out: <br><pre> <code class="bash hljs">airodump-ng mon0</code> </pre><br>  <b>airodump-ng</b> - a command to collect packages on the radio.  It displays two tables in the console.  At the top, the found wireless networks are displayed, at the bottom, the clients connected to them, or not connected, but with an active wireless adapter broadcasting some packets (for example, searching for a network with a specific name). <br><br>  The latter, by the way, is particularly interesting, since we can kindly provide them with the network we are looking for and see what is fashionable now in Odnoklassniki?  On this topic the other day by Comrad <a href="https://habrahabr.ru/users/karasikovsergey/" class="user_link">KarasikovSergey</a> , an <a href="http://habrahabr.ru/post/225059/">article</a> was published using <b>Karma</b> - but since this is already on the verge of sabotage penetration in this cycle, we will not touch upon this topic.  But this is really a problem and you should ensure that your device does not cling to all networks without your permission, including the known ones - the authenticity of access points is not checked and you may well end up on the attacker's network.  In all senses. <br><br><div class="spoiler">  <b class="spoiler_title">But we are in XP SP2 ...</b> <div class="spoiler_text">  It is interesting to recall Windows XP SP2, which, instead of disconnecting the network adapter while inactive to the network, began to request an ESSID consisting of a random set of characters ‚Äî perhaps in order to save on falling asleep and then warming up the adapter.  As a result, if you create a nearby point with such a name that is easy to trace through <b>airodump-ng</b> - XP connects to it, but looking at the connection status the user will never know about it (since it is ‚Äúinactive‚Äù) and in the end it will be very I'm surprised to find a working Skype <s>and lost passwords</s> .  Direct communication with space! <br></div></div><br>  But back to our waves.  Below is a sample output of <b>airodump-ng</b> : <br><br><pre> <code class="hljs objectivec"> CH <span class="hljs-number"><span class="hljs-number">1</span></span> ][ Elapsed: <span class="hljs-number"><span class="hljs-number">6</span></span> mins ][ <span class="hljs-number"><span class="hljs-number">2014</span></span><span class="hljs-number"><span class="hljs-number">-06</span></span><span class="hljs-number"><span class="hljs-number">-06</span></span> <span class="hljs-number"><span class="hljs-number">12</span></span>:<span class="hljs-number"><span class="hljs-number">45</span></span> BSSID PWR Beacons <span class="hljs-meta"><span class="hljs-meta">#Data, #/s CH MB ENC CIPHER AUTH ESSID 00:18:E7:xx:xx:xx -67 108 0 0 11 54e. WPA2 CCMP PSK infolan22451 F8:1A:67:xx:xx:xx -88 132 0 0 1 54e. WPA2 CCMP PSK TP-LINK 48:5B:39:xx:xx:xx -1 0 0 0 5 -1 </span><span class="hljs-meta-string"><span class="hljs-meta"><span class="hljs-meta-string">&lt;length: 0&gt;</span></span></span><span class="hljs-meta"> BSSID STATION PWR Rate Lost Frames Probe (not associated) 4C:B1:99:xx:xx:xx -73 0 - 1 0 66 dlink 48:5B:39:xx:xx:xx 1C:7B:21:xx:xx:xx -81 0 - 1 0 21</span></span></code> </pre><br>  <b>Columns of the first table with available wireless networks:</b> <br><br><ol><li>  <b>BSSID</b> is the unique MAC address of the wireless network.  By analogy with the MAC address of network cards, these are 6 numbers in hexadecimal format, separated by a colon, for example: <code>AA:00:BB:12:34:56</code> .  It is passed to most other teams. </li><li>  <b>PWR</b> - signal level.  This is a negative number;  the closer it is to 0, the stronger the signal.  Usually for comfortable work this number is up to -50, for video calls - up to -65, for VoIP - up to -75.  Values ‚Äã‚Äãbelow -85 and in particular below -90 can be considered an extremely weak level.  The number depends on both transmitter power and antenna gain in your adapter (external adapters have a gain of 0-12 dB, external 1-2 meter omnidirectional antennas up to 24 dB) </li><li>  <b>Beacons</b> - the number of ‚Äúbeacons‚Äù transmitted by this access point ‚Äî packets that alert nearby devices to the existence of this wireless network, the signal level, its name (BSSID / ESSID), and other information.  Used to connect.  By default, access points are usually set to transmit beacons every 100 ms (10 times per second), but the interval can be increased to 1 / sec.  The absence of a beacon does not indicate the absence of a wireless network - in the hidden (hidden) mode, the access point does not transmit beacons, but you can connect to it if you know the exact name of the network.  About the method of detection of such networks - below. </li><li>  <b>#Data</b> is the number of data packets that came from this access point.  This could be HTTP traffic, ARP requests, authorization requests (handshake), and so on.  If no client is connected to the network or if it does not transmit anything, then this value does not change and may be 0. </li><li>  <b># / s</b> is the number of data packets per second.  <b>#Data</b> divided by the time of monitoring this network. </li><li>  <b>CH</b> - channel number.  As already described above, the entire available Wi-Fi spectrum is divided into 14 channels;  the access point and, accordingly, the clients transmit data on a specific channel and this column indicates which channel this access point and its clients are tied to </li><li>  <b>MB</b> is the transmission rate (channel width) in Mbps.  A dot at the end indicates that the access point supports a short preamble.  You can see the values ‚Äã‚Äã11, 54, 54e.  We are usually a little worried </li><li>  <b>ENC</b> - type of wireless network - OPN (open), WEP, WPA, WPA2.  Based on this parameter, we select the appropriate attack pattern. </li><li>  <b>CIPHER</b> - type of data encryption after handshake.  Could be TKIP and CCMP (see the review in the <a href="http://habrahabr.ru/post/224955/">first part</a> ). </li><li>  <b>AUTH</b> - authentication mechanism for transferring a temporary key.  Maybe PSK (common authorization with a single password for WPA (2)), MGT (WPA (2) Enterprise with a separate server with RADIUS keys), OPN (public). </li><li>  <b>ESSID</b> is the name of the wireless network.  This is what you see in the "Wireless Manager" in Windows and indicate in the settings of the access point.  Since this is a custom name, it may not be unique, and for all internal operations, the BSSID is used (that is, the MAC address of the adapter at the access point), and this is simply the display name. </li></ol><br>  Sometimes you can see <b>-1</b> in some columns, and <code>&lt;length: 0&gt;</code> in the last column.  These are signs of a wireless network that does not broadcast its data in the clear, but responds only when the client has made an explicit connection request with the correct ESSID and password.  In addition, the access point may not transmit any beacons at all and will become active only when a client who knows her name connects to it.  If you leave <b>airodump-ng</b> running for a long time and if a new client connects to the hidden network in this period, the line corresponding to the ‚Äúhidden‚Äù network will be automatically opened and the channel number, ESSID and protection data will appear there.  In this case, it may be necessary to fix the channel in order not to miss the moment of connection (see below). <br><br>  <b>Columns of the second table with wireless clients:</b> <br><br><ol><li>  <b>BSSID</b> - MAC address of the access point to which the client is connected (see the first table).  If <b>not</b> specified, the client is disconnected from all networks, but the adapter is working (it may be looking for available networks). </li><li>  <b>STATION</b> - client's MAC address.  Once these addresses were sewn into the adapter at the factory and could not be changed, but today it can be configured in the overwhelming majority of cases.  In Linux / Mac, there are regular tools for this, in Windows it is more difficult and the support depends on the driver.  The MAC address is exactly the same as in wired networks, literally transmitted in every packet from this client, and this is the main reason why MAC filtering is almost useless. </li><li>  <b>PWR</b> - signal level from the client.  The closer to 0, the closer the client / signal is more powerful (see the first table). </li><li>  <b>Rate</b> - when <b>airodump-ng is</b> launched with a channel lock (see below), this column will show the transmission frequency of data packets from the access point to the client (to the left of the hyphen) and from the client back (to the right). </li><li>  <b>Lost</b> is the number of lost packets that our system (not the client) did not register.  This is easy to calculate, since there is a counter in the transmitted packets. </li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Frames</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> or </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Packets</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - the number of data packets that we caught from this client (see </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#Data</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in the first table).</font></font></li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Probe</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - a list of ESSID-names of wireless networks to which the client tried to connect. </font><font style="vertical-align: inherit;">It may not list those networks that you see around, but those to which the client has connected before, or hidden networks. </font><font style="vertical-align: inherit;">Based on this, you can organize an attack like </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Karma</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , as mentioned earlier.</font></font></li></ol><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Startup options airodump-ng</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (can be combined; in more detail in the following sections):</font></font><br><br><ul><li> <code>airodump-ng -c 3 mon0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - fix channel number 3 - full packet reception without loss when switching to other channels (due to overlapping frequencies, neighboring channels can be included in the list). </font></font></li><li> <code>airodump-ng -w captures.pcap mon0</code> ‚Äî       <code>captures.pcap</code> ‚Äî   offline-    WEP/WPA (    ). </li><li> <code>airodump-ng --essid " " mon0</code> ‚Äî   (/)       .      ,         . </li><li> <code>airodump-ng --bssid 01:02:03:AA:AA:FF mon0</code> ‚Äî   MAC-   (BSSID).  <b>--essid</b> . </li></ul><br><h4>  ‚Ä¶   </h4><br><img src="https://habrastorage.org/getpro/habr/post_images/134/d0a/607/134d0a6078336b3474d461ff1b1fadfa.jpg" height="250"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Often in everyday life you can hear that the hidden network is very difficult to detect / connect / hack / carry (underline the necessary). However, as already shown, the ‚Äúhidden‚Äù network is nothing more than a network that does not transmit beacons about its existence 10 times per second, or that transmit them, but with an empty ESSID and other fields. The difference ends there. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As soon as a client connects to such a network, it sends its ESSID and password, and if such a network exists within range, the access point responds to the request and carries out all the usual authorization and data transfer procedures. And if the client has already been connected before - you can see it in the list of active adapters ... and disconnect. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Each connected client communicates with the base station on its BSSID - and this is exactly what we see in both </font><b><font style="vertical-align: inherit;">airodump-ng</font></b><font style="vertical-align: inherit;"> tables</font></font><b><font style="vertical-align: inherit;"></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">We can ‚Äúdisconnect‚Äù the client from the network, after which he will have to connect again - and at this moment </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">airodump-ng will</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> take over the handshake with all identifiers and keys. </font><font style="vertical-align: inherit;">Or we can just leave the laptop turned on for a couple of hours with </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">airodump-ng</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> on the desired channel and wait. </font><font style="vertical-align: inherit;">By the way, in case of successful ‚Äúopening‚Äù in the upper right corner there will be a message of the type </font></font><code>[ Decloak: 00:00:11:11:22:22 ]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">with the BSSID of the access point, the conspiracy of which we opened.</font></font><br><br><a name="aireplay"></a><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Disabling clients is provided in all wireless standards and is done using </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aireplay-ng</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (all three utilities already familiar to us are part of the </font></font><a href="http://www.aircrack-ng.org/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Aircrack-ng</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> project </font><font style="vertical-align: inherit;">, which contains in its collection all sorts of tools for working with subtle matters):</font></font><br><pre> <code class="bash hljs">aireplay-ng wlan0 --deauth 5 -a AP_BSSID -c CLIENT_BSSID</code> </pre><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Warning:</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> this command is an exception and accepts the identifier of a </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">real</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> wireless adapter, rather than </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mon0</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , created using </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">airmon-ng</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If you get an error about the unfixed channel and / or </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">airodump-ng</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> at the top right corner </font></font><code>[ fixed channel -1 ]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, it means that some program or service causes the adapter to jump from channel to channel (it may be the same </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">airodump-ng</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) and you need to close it with using </font></font><code>airmon-ng check kill</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, as described at the beginning.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The command above simulates the situation when the access point informs the client that the old key is invalid (and that it should be updated by repeating the handshake, that is, by transferring the password and network name again). Messages are sent to the client's address, allegedly from the access point, that they should disconnect from the network and update the session data. Since this type of packets is not protected by encryption (that is, the command can be executed even before authentication), it is impossible to counteract it for the simple reason that it is impossible to establish the ‚Äúidentity‚Äù of the one who sends it ‚Äî the MAC addresses in the packets are fake and are set to those values ‚Äã‚Äãthat we passed after </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-a</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-c</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . You can only monitor for too frequent trips and take some action. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">After </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">--deauth</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">There is a number of deauthorization packets that will be sent both ways. </font><font style="vertical-align: inherit;">3-5 is usually enough, you can specify 30 or more. </font><font style="vertical-align: inherit;">For brevity, </font></font><code>--deauth</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">you can replace with </font></font><code>-0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(zero). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">So, let's say in the second table </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">airodump-ng</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> we see the following line:</font></font><br><br><pre> <code class="hljs css"><span class="hljs-selector-tag"><span class="hljs-selector-tag">BSSID</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">STATION</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">PWR</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Rate</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Lost</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Frames</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">Probe</span></span> 4<span class="hljs-selector-tag"><span class="hljs-selector-tag">F</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:B1</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:A4</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:05</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:5C</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:21</span></span> 5<span class="hljs-selector-tag"><span class="hljs-selector-tag">B</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:23</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:15</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:00</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:C8</span></span><span class="hljs-selector-pseudo"><span class="hljs-selector-pseudo">:57</span></span> <span class="hljs-selector-tag"><span class="hljs-selector-tag">-54</span></span> 0 <span class="hljs-selector-tag"><span class="hljs-selector-tag">-</span></span> 1 0 1266 <span class="hljs-selector-tag"><span class="hljs-selector-tag">homenet</span></span>, <span class="hljs-selector-tag"><span class="hljs-selector-tag">XCom</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The first column is the value for </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-a</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (base station MAC), the second is for </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-c</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (client MAC). </font><font style="vertical-align: inherit;">Restart </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">airodump-ng</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and fix it on channel 5 (this is the channel of our attacked station), and then disconnect the client in the next terminal window:</font></font><br><br><pre> <code class="bash hljs">airodump-ng -c5 mon0 aireplay mon0 -0 5 -a 4F:B1:A4:05:5C:21 -c 5B:23:15:00:C8:57</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If the signal is strong enough, the number of packets is large and the client / access point heard us - they will disconnect from each other, then they will transmit the network information again when connected, and </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">airodump-ng</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> will show them and the line </font></font><code>[ Decloak ]</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As you can see, this trick with hiding beacons can be used for home networks, to which someone connects a couple of times a day, and even then not always - but for corporate networks it definitely doesn‚Äôt, as it is revealed by literally one team and protection from it not. In my opinion, even for private networks, this is rather an inconvenience than a benefit - you need to enter a name manually, and it is not clear whether the base station is active at all or not. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Also, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-c</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">(client MAC) can be omitted - then broadcast packets will be sent on behalf of the access point to disconnect all clients. </font><font style="vertical-align: inherit;">However, today it rarely works - the drivers ignore such packages, as they legitimately believe that the matter is unclean - the access point always knows who is connected to it, and sends out directed packets for a specific client.</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> MAC filtering is so easy </font></font></h4><br><img src="https://habrastorage.org/getpro/habr/post_images/524/85c/adb/52485cadbaaee86240da4ab5640472ad.jpg" height="250"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Very often I hear recommendations that the first thing after creating a network is to limit the list of its clients to a certain set of MAC addresses, and then the password is completely useless. However, this restriction is as easy as finding hidden networks. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In fact, each client ‚Äî whether connected to the network or not ‚Äî reveals its MAC address when transmitting any packet. In the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">airodump-ng</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> table, </font><font style="vertical-align: inherit;">these addresses are visible in the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">STATION</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> column </font><font style="vertical-align: inherit;">. Accordingly, as soon as we saw the network, where for some reason we couldn‚Äôt go (Linux usually reports about it </font></font><code>Unspecified failure</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">at the connection stage, and Windows thinks for a long time, after which it reports an unknown error), and right there we see a client connected to this network - we we can take its MAC address and change it to it. The consequences may be different.</font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and may even knock</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . If we do this with an active client, a clone will appear on the network and the client may ‚Äúbog down‚Äù, since it will receive replies to packets that it has not sent. As a result, it can turn off, and can continue to work, warning about the user's problem or not. But the option is better - write it to the MAC and connect when it leaves. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In Linux, you can change the MAC of your adapter as follows (works for both wired and wireless networks):</font></font><br><br><pre> <code class="bash hljs">ifconfig wlan0 down ifconfig wlan0 hw ether 00:11:22:AA:AA:AA ifconfig wlan0 up</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">You must first disable any </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mon-</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> interfaces. </font><font style="vertical-align: inherit;">Check whether the substitution has earned, you can </font><b><font style="vertical-align: inherit;">call</font></b></font><code>ifconfig wlan0</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - in the line </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Hwaddr</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> should be the above MAC. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In addition, in * nix there is </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">macchanger</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - with its help you can set yourself a random MAC. </font><font style="vertical-align: inherit;">If you put it in </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">init.d</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , then the enemy will be completely confused, because every time we boot, our MAC will be different (works for any wired and wireless adapters, like </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ifconfig</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ).</font></font><br><pre> <code class="bash hljs"><span class="hljs-comment"><span class="hljs-comment">#  MAC: macchanger -r wlan0 #  MAC: macchanger -m 11:22:33:AA:BB:CC wlan0 #  MAC: macchanger -s wlan0</span></span></code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In Windows, you need to make some manipulations with the registry, but on this topic it is better to consult with Google. </font><font style="vertical-align: inherit;">(Readers, represented by </font></font><a href="https://habrahabr.ru/users/alexeywolf/" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">alexeywolf,</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> suggest a </font></font><a href="http://www.technitium.com/tmac/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TMAC</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tool </font><font style="vertical-align: inherit;">that does this automatically.)</font></font><br><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> WhooPS </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We did everything right and our access point uses impenetrable WPA2-PSK-CCMP with a 63-digit password from </font></font><code>/dev/urandom</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">is that enough? </font><font style="vertical-align: inherit;">No, if we have a WPS router, especially if it is old.</font></font><br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/961/77d/9cc/96177d9cc12c7de6663b40c7f75bfeb5.png"></div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The diagram above describes the process of connecting a client to an access point using a PIN code. PIN - 8 digits, which are usually pasted on the router itself. Clients that support WPS can connect to the network either with a regular WEP / WPA password or with a PIN, and entering the last client receives the network password in its pure form. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">By standard, the last digit in the PIN is a checksum, that is, it can be calculated from the remaining digits. Thus, if we wanted to go through all the possible combinations, it would have required 10 </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">7</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> attempts (at the bottom ‚Äî the number of possible characters (0-9 - ten), to the extent ‚Äî the length of the string) ‚Äî10 million, which is about 116 days, if we try one code per second. Typically, the speed is several times lower, so the selection would take more than a year.</font></font><br><img src="https://habrastorage.org/getpro/habr/post_images/4da/695/302/4da695302c43f317b2121adc5e04abff.png" align="right" alt=" WPS" title=" WPS"><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">However, the standard is a mistake. The authorization process takes place in several stages. If the PIN transmitted by us is correct, then the access point reports success. If the first four digits of the PIN are correct, and the digits 4-7 are not, then the access point will report this after we send the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M6</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> packet </font><font style="vertical-align: inherit;">. In the case of an error in the first four digits, we will know about it earlier - after the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M4</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> package </font><font style="vertical-align: inherit;">. This problem was found at the end of 2011 and is described </font></font><a href="https://sviehb.wordpress.com/2011/12/27/wi-fi-protected-setup-pin-brute-force-vulnerability/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Hot on the heels of the authors of the study was created </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reaver-wps</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , then published on </font></font><a href="https://code.google.com/p/reaver-wps/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Google Code</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . There you can also find a document describing the original vulnerability. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">So, let's say our PIN is </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">99741624</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . We are trying to connect using PIN</font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9974</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 0000 - we get a denial of authorization after the transfer of the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M6</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> packet </font><font style="vertical-align: inherit;">(since the first half of the code is correct). If we connect with 0000 </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1624</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - the failure will be after </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M4</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As you can see, the main problem is that we can learn about the correctness of one part of the code, even though the </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">second one contains an error</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . What does this give? Now, instead of 10 million combinations, we need to try only 10 </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">4</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> + 10 </font></font><sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3</font></font></sup><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> = 11 000. This is more than actually done not only in a week - in 15 hours, but usually faster.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Please note: the numbers for the selection are exactly 7, not 8, since the latter is a checksum and we count it ourselves, so it is not necessary to select it. </font><font style="vertical-align: inherit;">In the examples below, this is </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">#</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let's look again. </font><font style="vertical-align: inherit;">We start brute force with 0000000 #. </font><font style="vertical-align: inherit;">Failure after </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M4</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (error in the first 4 digits). </font><font style="vertical-align: inherit;">Change to 0001000 #. </font><font style="vertical-align: inherit;">Failure after </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M4</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">0002000 #. </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M4</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">We reach up to </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9974</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 000 #.</font></font> ABOUT!<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Failure after </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">M6</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">The first 4 digits are guessed. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Further - in the same way. </font><font style="vertical-align: inherit;">Having a half of the code gradually increase the second. </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9974</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 001 #. </font><font style="vertical-align: inherit;">Renouncement. </font><font style="vertical-align: inherit;">9974002 #. </font><font style="vertical-align: inherit;">Renouncement. </font><font style="vertical-align: inherit;">&lt;...&gt; </font></font><u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">99741624</font></font></u><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font> Accepted. <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This is the essence of </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Wi-Fi Unprotected Setup</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Wi-Fi Protected Setup.</font></font><br><br><img src="https://habrastorage.org/getpro/habr/post_images/6cf/bd3/6a0/6cfbd36a0e887ce77b2277c93dbdec74.jpg" height="250"><br><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Reaver </font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">And now we will check how conscientiously your access point performs its duties. </font><font style="vertical-align: inherit;">If you do not have a router with WPS - </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">you can always test your neighbor,</font></font></s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> this attack does not threaten you. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To exploit the vulnerability in WPS, </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kali</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> has several utilities, but in my opinion the most obvious and flexible one is that </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reaver</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font> Call syntax: <br><pre> <code class="bash hljs">reaver -i mon0 -c 5 -b AP_BSSID -va</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> In addition, we can specify: </font></font><br><br><ul><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-m OUR_MAC</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - if you changed the MAC address of your adapter (see above for MAC filtering), specify this parameter with a new (not factory) MAC.</font></font></li><li> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">-e ESSID</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - when attacking a hidden network, </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reaver</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> must know its name, not just the BSSID; </font><font style="vertical-align: inherit;">if the network sends beacons - the ESSID will be automatically obtained from them, but for hidden networks you must pass it explicitly.</font></font></li><li> <b>-p PIN</b> ‚Äî      8-  WPS,        (       - ).    ‚Äî     . </li><li> <b>-vv</b> ‚Äî   / ,      <b>M4</b>  <b>M6</b> .       . </li></ul><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reaver</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sorts through 11,000 combinations until it finds that the access point has accepted one of them. The brute force rate is highly dependent on the signal strength / distance to the base station and can vary from 3 to 30 per second. Usually one network takes up to 10-15 hours. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">You </font><font style="vertical-align: inherit;">can </font><font style="vertical-align: inherit;">interrupt </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reaver</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> using </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Ctrl + C</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , while it will save the current progress for this network and at restart it will start with an interrupted PIN. If you are working in the live mode (read only), then the session data can be copied from </font></font><code>/etc/reaver/</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to permanent media and written back on the next boot. Text files with the names of the view </font></font><code>AP_MAC.wpc</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and a list of all numbers for searching inside </font><font style="vertical-align: inherit;">are stored in this folder </font><font style="vertical-align: inherit;">(the first line is the number of the line with the PIN from which to start the search when restarting).</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">About WPS two years ago </font></font><a href="http://habrahabr.ru/company/xakep/blog/143834/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">wrote</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> on </font></font><a href="http://habrahabr.ru/post/151688/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Habr√©</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and not only, so you can easily find more information. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">( </font></font><a href="https://habrahabr.ru/users/mailbrush/" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mailbrush </font></font></a> <a href="http://habrahabr.ru/post/225483/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">advised</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> also to pay attention to </font></font><a href="https://github.com/bdpurcell/bully"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">bully</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , who is also in </font></font><i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Kali</font></font></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and performs a similar task.)</font></font><br><br><h5>  What to do? </h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To date, the only option is to disable WPS. </font><font style="vertical-align: inherit;">If you or your friends have difficulty in setting up the network (which is hard to believe), turn on WPS only at the time of connecting a new device. </font><font style="vertical-align: inherit;">True, not all routers / firmwares generally give this opportunity, but if I had not looked like that I would have changed for another.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">However, not everything is so bad. Newer firmware limits the rate of selection using rate limiting - after several unsuccessful authorization attempts, WPS is automatically disabled. Some models increase the shutdown time even more, if in a short interval more unsuccessful attempts were made to enter. Nevertheless, it is possible to rely on this only after a thorough check in your particular case - it may turn out that the switch-off time is short or it does not increase enough - remember that 11,000 combinations are very few and even making one attempt per minute for the whole range will go maximum 8 days. And while the PIN changes separately from the network password, so you can update the latter as often as you like, without complicating the PIN search.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">By the way, you can find experiments on the Web to bypass the blocking in time using exploits, forcing the router to reboot - while, of course, the WPS timeout is reset and you can continue the selection again. </font><font style="vertical-align: inherit;">So rely on "protection from WPS" is not worth it.</font></font><br><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Network enumeration </font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Finally a few words </font></font><s><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">about the eternal </font></font></s><font style="vertical-align: inherit;"></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reaver</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> alternatives </font><font style="vertical-align: inherit;">. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reaver</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> will try to attack any network that you pass to it as a BSSID parameter, but it may not support WPS ‚Äî in this case, the program will hang up </font></font><code>Waiting for beacon...</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and after half a minute will report that the network has not been detected. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">There are several ways to check which networks in the district support WPS.</font></font><br><br><ul><li>   <b>airodump-ng</b>    <b>WPS</b> ,    ,    (    ) </li><li> <b>wash -i mon0</b>      WPS-enabled ,    ,       <b>Ctrl+C</b> .    ,  ,    WPS,    (.  rate limiting ) </li><li> <b>iwlist wlan0 scan</b>         ,       WPS    </li><li> <b>wifite</b> ‚Äî      ;       ,   ,          .        :       WPS </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In addition, there is a very beloved by many </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">kismet</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (and analog for Macintosh - </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">KisMAC</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ), but in my opinion it is too sophisticated. In both, there is integration with GPS, which can be useful for those who explore networks over a large area (wardriving). </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">On this with the "cheat" methods of penetration everything. In the third part - about intercepting customers handshakes when connecting to the network and selecting passwords for WPA (2) using the CPU and GPU. </font></font><br><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Special thanks</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to comrade </font></font><a href="https://habrahabr.ru/users/chem_ua/" class="user_link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">chem_ua</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> for helpful remarks when reading the article. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Charts were drawn on </font></font><a href="http://gliffy.com/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">gliffy.com</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As usual, comments on the case are welcome.</font></font><br><br>  <b>Table of contents:</b> <br>  <b>1)</b> <a href="http://habrahabr.ru/post/224955/">materiel</a> <br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">2)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Kali. </font><font style="vertical-align: inherit;">Hiding SSID. </font><font style="vertical-align: inherit;">MAC filtering. </font><font style="vertical-align: inherit;">WPS </font></font><br> <b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">3) </font></font></b> <a href="http://habrahabr.ru/post/226431/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">WPA. </font><font style="vertical-align: inherit;">OpenCL / CUDA. </font><font style="vertical-align: inherit;">Pick statistics</font></font></a> </div><p>Source: <a href="https://habr.com/ru/post/225483/">https://habr.com/ru/post/225483/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../225471/index.html">Mover.io: service for cloud migrations</a></li>
<li><a href="../225473/index.html">Cellular automata with komonad</a></li>
<li><a href="../225477/index.html">Gamers are more educated and sociable than those who laugh at them</a></li>
<li><a href="../225479/index.html">M-LAG as an alternative to STP and stack</a></li>
<li><a href="../225481/index.html">Parsing the address bar (street [house]) using Golang and Postgis</a></li>
<li><a href="../225485/index.html">3D printer head. Three components and three sources. On the road to excellence</a></li>
<li><a href="../225487/index.html">High-frequency trading and everything you need to know about it. Part 2 (final)</a></li>
<li><a href="../225493/index.html">Phyode W / Me: sports bracelet with "health indicator"</a></li>
<li><a href="../225495/index.html">DevCon 2014: how it was (+ a lot of photos)</a></li>
<li><a href="../225499/index.html">Writing and processing music with Haskell</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>