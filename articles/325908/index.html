<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Neural networks in the fight against cancer</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Last year, Arthur Kadurin and I decided to join the new wave of neural network learning - to deep learning. It immediately became clear that machine l...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Neural networks in the fight against cancer</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/files/d79/61b/7ff/d7961b7fff0e4b4baf1c7a6cbdb1a67d.jpg" alt="image"></p><br><p>  Last year, Arthur Kadurin and I decided to join the new wave of neural network learning - to deep learning.  It immediately became clear that machine learning was practically not used in many areas, and we in turn understand how it can be applied.  It remained to find an interesting area and strong experts in it.  So we met the team from Insilico Medicine (resident of the BMT cluster of the Skolkovo Foundation) and the developers of the MIPT and decided to work together on the task of finding a cure for cancer. </p><br><p>  Below you will read a review of the article <a href="http://www.impactjournals.com/oncotarget/index.php%3Fjournal%3Doncotarget%26page%3Darticle%26op%3Dview%26path%3D14073">The cornucopia of meaningful leads: Applying deep adversarial autoencoders for new molecule development in oncology</a> , which my colleagues from Insilico Medicine and MIPT prepared for the American magazine Oncotarget, with an emphasis on the implementation of the proposed model in the tensorflow framework.  The initial task was as follows.  There are data of a type: substance, concentration, growth rate of cancer cells.  It is necessary to generate new substances that would stop the growth of the tumor at a certain concentration.  Dataset is available on the <a href="https://wiki.nci.nih.gov/display/NCIDTPdata/NCI-60%2BGrowth%2BInhibition%2BData">NCI Wiki</a> website. </p><a name="habracut"></a><br><p>  Let's describe the data in more detail. </p><br><p>  Substances are presented in the standard for bioinformatics form - SMILES, in fact, it is a unified way to record compounds in ASCII.  Unfortunately, there is no complete unification, different packages generate different SMILES.  We used those created using the <a href="http://www2.ccc.uni-erlangen.de/software/cactvs/">CACTVS</a> package.  More about this is written, for example, <a href="http://www.daylight.com/smiles/index.html">here</a> .  Each SMILES can be converted to a binary representation of the dimension 166: chemical fingerprint, Molecular ACCess System (MACCS).  Each bit in this view is the answer to the question about the corresponding molecule, MACCS keys are the set of corresponding questions.  Examples of questions: is there less than three oxygen atoms in a molecule?  Does the molecule have a ring of size three?  A more detailed description is <a href="http://www.dalkescientific.com/writings/NBN/fingerprints.html">here</a> . </p><br><p>  The growth index is defined as follows: </p><br><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><span class="noError" style="display: inline-block;">GI&nbsp;=&nbsp;\&nbsp;begin&nbsp;{cases}&nbsp;\&nbsp;frac&nbsp;{T_i&nbsp;-&nbsp;T_z}&nbsp;{C&nbsp;-&nbsp;T_Z},&nbsp;&amp;&nbsp;T_i&nbsp;\&nbsp;ge&nbsp;T_z&nbsp;\\&nbsp;\&nbsp;frac&nbsp;{T_i&nbsp;-&nbsp;T_z}&nbsp;{T_z},&nbsp;&amp;&nbsp;T_i&nbsp;&lt;T_z&nbsp;\&nbsp;end&nbsp;{cases},</span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> GI = \ begin {cases} \ frac {T_i - T_z} {C - T_Z}, & T_i \ ge T_z \\ \ frac {T_i - T_z} {T_z}, & T_i <T_z \ end {cases}, </script></p><br><p>  Where <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.359ex" height="2.419ex" viewBox="0 -780.1 1015.8 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-54" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-7A" x="826" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-2"> T_z </script>  - the initial size of the tumor, <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.157ex" height="2.419ex" viewBox="0 -780.1 928.8 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-54" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-69" x="826" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-3"> T_i </script>  - the size of the tumor after a certain time interval in the presence of the drug, <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.766ex" height="2.057ex" viewBox="0 -780.1 760.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-43" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-4"> C </script>  - tumor size in the control group without the addition of the drug.  Actually <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.998ex" height="2.057ex" viewBox="0 -780.1 1291 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-47" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-49" x="786" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-5"> GI </script>  shows how much slower a tumor grows or how quickly it diminishes. </p><br><p>  After the described processing, 78 728 triples of the fingerprint, log (concentration), GI type, describing 6252 molecules, are obtained.  To validate the model, we used binary representations for almost 100 million molecules from the Pubchem database ( <a href="https%25253A%25252F%25252Fpubchem.ncbi.nlm.nih.gov%25252F%26usg%3DAFQjCNH6jGl2oOwxzjhUMRFJZfHml-ISKw%26sig2%3Djf1H8ieiU-SFZXcGrbfHVQ">The PubChem Project</a> ). </p><br><p>  An example of the initial data obtained: </p><br><table><thead><tr><th>  Fingerprint </th><th>  Log (concentration) </th><th>  Growth inhibition percentage </th></tr></thead><tbody><tr><td>  000011100010 ... </td><td>  -five </td><td>  ten % </td></tr><tr><td>  00000110101 ... </td><td>  ‚Äì7 </td><td>  -15 % </td></tr><tr><td>  10010011000 ... </td><td>  ‚Äì4,8 </td><td>  75% </td></tr></tbody></table><br><h2 id="puti-resheniya">  Solutions </h2><br><h3 id="naivnyy-podhod">  Naive approach </h3><br><p>  The first approach that comes to mind is to train the regressor (for example, xgboost) to determine the growth index by a pair of fingerprint, log (concentration), and then sample such two from a large base and select the best ones. </p><br><p><img src="https://habrastorage.org/files/106/85e/2ca/10685e2ca7174fcf9125c92e4c26693e.png" alt="image"></p><br><p>  We could not bring such an approach to anything good. </p><br><h3 id="generativnyy-podhod">  Generative approach </h3><br><p>  Another option: learn how to generate pairs (fingerprint, concentration) and then look for similar molecules from a large compound base.  One of the first questions: how to compare different molecules?  Fortunately (?), We found out experimentally that in this case the Jacquard measure can be used, and for many applications, molecules with a Jacquard coefficient greater than 0.8 are already considered to be close. </p><br><p>  In addition to solving the problem as such, we pursued the goal of learning to use new generative neural network approaches.  Two modern generative models are known - VAE (variational autoencoder) and GAN (generative adversarial encoder).  Since both models have already been described several times on Habr√©, we confine ourselves to a short story about them. </p><br><p>  In the <a href="https://arxiv.org/abs/1606.05908">case of VAE</a> , an approximation problem is solved. <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.398ex" height="2.66ex" viewBox="-38.5 -832 1893.5 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex; margin-left: -0.089ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-70" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-28" x="503" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-78" x="893" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-29" x="1465" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-6"> p (x) </script>  as </p><br><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="35.113ex" height="2.66ex" viewBox="-38.5 -832 15118.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex; margin-left: -0.089ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-70" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-28" x="503" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-78" x="893" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-29" x="1465" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-3D" x="2132" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-69" x="3439" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6E" x="3784" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-74" x="4385" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-70" x="4746" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-28" x="5250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-78" x="5639" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6D" x="6462" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-69" x="7340" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-64" x="7686" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-7A" x="8209" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-3B" x="8678" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-74" x="9373" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-68" x="9734" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-65" x="10311" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-74" x="10777" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-61" x="11139" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-29" x="11668" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-70" x="12058" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-28" x="12561" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-7A" x="12951" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-29" x="13419" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-64" x="13809" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-7A" x="14332" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-2C" x="14801" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-7"> p (x) = \ int p (x \ mid z; \ theta) p (z) dz, </script></p><br><p>  Where <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-78" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-8"> x </script>  - input data, <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.088ex" height="1.455ex" viewBox="0 -520.7 468.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-7A" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-9"> z </script>  - latent view, and <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.912ex" height="2.057ex" viewBox="0 -780.1 2545.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-74" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-68" x="611" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-65" x="1188" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-74" x="1654" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-61" x="2016" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-10"> \ theta </script>  - model parameters. </p><br><p>  Standard VAE assumes that <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="17.071ex" height="2.66ex" viewBox="-38.5 -832 7350.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex; margin-left: -0.089ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-70" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-28" x="503" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-78" x="893" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6D" x="1715" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-69" x="2594" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-64" x="2939" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-7A" x="3463" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-3B" x="3931" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-74" x="4626" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-68" x="4988" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-65" x="5564" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-74" x="6031" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-61" x="6392" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-29" x="6922" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-11"> p (x \ mid z; \ theta) </script>  and <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.156ex" height="2.66ex" viewBox="-38.5 -832 1789.5 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex; margin-left: -0.089ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-70" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-28" x="503" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-7A" x="893" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-29" x="1361" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-12"> p (z) </script>  normal and brings <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.122ex" height="2.66ex" viewBox="0 -832 4788.7 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-66" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-28" x="550" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-7A" x="940" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-3B" x="1408" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-74" x="2103" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-68" x="2465" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-65" x="3041" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-74" x="3508" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-61" x="3869" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-29" x="4399" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-13"> f (z; \ theta) </script>  using a neural network with an autoencoder structure. </p><br><p>  Input data <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-78" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-14"> x </script>  served to the input of the encoder, the output of which is a normal distribution <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="25.915ex" height="2.66ex" viewBox="0 -832 11157.7 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-63" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-61" x="683" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6C" x="1213" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-4E" x="1511" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-28" x="2400" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6D" x="3039" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-75" x="3918" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-28" x="4490" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-78" x="4880" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-29" x="5452" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-2C" x="5842" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-53" x="6537" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-69" x="7182" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-67" x="7528" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6D" x="8008" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-61" x="8887" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-28" x="9416" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-78" x="9806" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-29" x="10378" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-29" x="10768" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-15"> {\ cal N} (\ mu (x), \ Sigma (x)) </script>  .  Then the vector is sampled from this distribution. <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.088ex" height="1.455ex" viewBox="0 -520.7 468.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-7A" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-16"> z </script>  which, in turn, is input to the decoder.  Outlet - vector <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.155ex" height="1.817ex" viewBox="0 -520.7 497.5 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-79" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-17"> y </script>  vector reconstruction <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-78" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-18"> x </script>  . </p><br><p>  When training a neural network, the average between the two loss functions is optimized: KL divergence between the distribution on the latent layer and <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.752ex" height="2.66ex" viewBox="0 -832 4629.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-63" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-61" x="683" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6C" x="1213" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-4E" x="1511" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-28" x="2400" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-30" x="2789" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-2C" x="3290" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-49" x="3735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-29" x="4239" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-19"> {\ cal N} (0, I) </script>  and reconstruction error - the distance between <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-78" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-20"> x </script>  and <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.155ex" height="1.817ex" viewBox="0 -520.7 497.5 782.1" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-79" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-21"> y </script>  . </p><br><p>  In the <a href="">case of a GAN,</a> two neural networks are trained: a generator and a discriminator.  The generator translates the latent variable <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.088ex" height="1.455ex" viewBox="0 -520.7 468.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-7A" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-22"> z </script>  sampled from prior distribution <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.156ex" height="2.66ex" viewBox="-38.5 -832 1789.5 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex; margin-left: -0.089ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-70" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-28" x="503" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-7A" x="893" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-29" x="1361" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-23"> p (z) </script>  , into the input data space, and the discriminator learns to distinguish the sampled data from the real data.  The problem can be formulated in game-theoretic form: </p><br><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="89.656ex" height="2.901ex" viewBox="0 -832 38602 1249" role="img" focusable="false" style="vertical-align: -0.969ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-69" x="1128" y="0"></use><g transform="translate(1474,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6E" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-47" x="849" y="-219"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6D" x="2980" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-61" x="3859" y="0"></use><g transform="translate(4388,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-44" x="809" y="-213"></use></g><g transform="translate(5646,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-74" x="1658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-68" x="2019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-62" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-62" x="3025" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-45" x="3455" y="0"></use><g transform="translate(4193,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-73" x="926" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-69" x="1395" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6D" x="1741" y="0"></use><g transform="translate(1852,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-70" x="0" y="0"></use><g transform="translate(356,-163)"><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6D" x="499" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-61" x="1378" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-74" x="1908" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-68" x="2269" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-72" x="2846" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6D" x="3297" y="0"></use><g transform="translate(2088,0)"><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-64" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-61" x="523" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-74" x="1053" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-61" x="1414" y="0"></use></g></g></g></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-5B" x="15279" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6C" x="15808" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6F" x="16106" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-67" x="16592" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-44" x="17072" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-28" x="17901" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-78" x="18290" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-29" x="18863" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-5D" x="19252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-2B" x="19753" y="0"></use><g transform="translate(20753,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6D" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-61" x="1128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-74" x="1658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-68" x="2019" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-62" x="2596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-62" x="3025" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-45" x="3455" y="0"></use><g transform="translate(4193,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-78" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-73" x="926" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-69" x="1395" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6D" x="1741" y="0"></use><g transform="translate(1852,0)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-70" x="0" y="0"></use><g transform="translate(356,-163)"><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6D" x="499" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-61" x="1378" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-74" x="1908" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-68" x="2269" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-72" x="2846" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6D" x="3297" y="0"></use><g transform="translate(2088,0)"><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-64" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-61" x="523" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-74" x="1053" y="0"></use><use transform="scale(0.5)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-61" x="1414" y="0"></use></g></g></g></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-5B" x="30386" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6C" x="30915" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6F" x="31213" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-67" x="31699" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-28" x="32179" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-31" x="32569" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-2212" x="33291" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-44" x="34292" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-28" x="35120" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-47" x="35510" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-28" x="36296" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-7A" x="36686" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-29" x="37154" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-29" x="37544" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-29" x="37933" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-5D" x="38323" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-24"> \ min_G \ max_D {\ mathbb E} _ {x \ sim p _ {\ mathrm {data}}} [\ log D (x)] + {\ mathbb E} _ {x \ sim p _ {\ mathrm {data} }} [\ log (1 - D (G (z)))] </script></p><br><p><br><img src="https://habrastorage.org/files/7e5/556/c9f/7e5556c9fe1a47b596014a8acdb18710.png" alt="image"></p><br><p>  Finally, the <a href="https://arxiv.org/abs/1511.05644">Adversarial Autoencoders</a> article introduces a mix of VAE and GAN models.  Just like in regular AE, input <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.33ex" height="1.455ex" viewBox="0 -520.7 572.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-78" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-25"> x </script>  served in the encoder, the output of which <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.088ex" height="1.455ex" viewBox="0 -520.7 468.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-7A" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-26"> z </script>  , in turn, goes to the input to the decoder.  The discriminator network learns to distinguish vector <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.083ex" height="1.455ex" viewBox="0 -520.7 466.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-65" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-27"> e </script>  sampled from <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.752ex" height="2.66ex" viewBox="0 -832 4629.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-63" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-61" x="683" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6C" x="1213" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-4E" x="1511" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-28" x="2400" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-30" x="2789" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-2C" x="3290" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-49" x="3735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-29" x="4239" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-28"> {\ cal N} (0, I) </script>  and vector <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.088ex" height="1.455ex" viewBox="0 -520.7 468.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-7A" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-29"> z </script>  .  As in the GAN, two loss functions are optimized: </p><br><ul><li>  Weights of the generator are optimized to ‚Äúdeceive‚Äù the discriminator: not to distinguish <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.083ex" height="1.455ex" viewBox="0 -520.7 466.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-65" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-30"> e </script>  from <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.088ex" height="1.455ex" viewBox="0 -520.7 468.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-7A" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-31"> z </script>  . </li><li>  Discriminator weights are optimized to distinguish <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.083ex" height="1.455ex" viewBox="0 -520.7 466.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-65" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-32"> e </script>  from <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-33-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.088ex" height="1.455ex" viewBox="0 -520.7 468.5 626.5" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-7A" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-33"> z </script>  . </li></ul><br><p>  This introduces an additional loss function - reconstruction error.  Optimization of loss functions occurs alternately.  For example, the first training cycle will look like this: train a discriminator on a mini-batch, train an encoder on the next mini-batch, and train an auto-encoder on a third mini-batch. </p><br><p><img src="https://habrastorage.org/files/53f/b9f/93d/53fb9f93d380425283fc1a54b03a4604.png" alt="image"></p><br><p>  The VAE and GAN models have recently become especially popular in image generation tasks, with models based on GAN showing themselves better in practice (for example, <a href="https://arxiv.org/abs/1701.00160">NIPS 2016 Tutorial: Generative Adversarial Networks</a> ). </p><br><p>  For this reason, and because of the simplicity of adding the growth index to the latent layer of the auto-encoder, we stopped at the last approach to solve a specific problem (we are waiting for the publication of our new article with a detailed comparison of different models).  In addition, in the solution of the problem, we could not find the hyperparameters of the standard GAN architecture with which it would work stably. </p><br><p>  The model to which we have come is as follows: </p><br><p><img src="https://habrastorage.org/files/00d/ab5/ddb/00dab5ddb04a4bf88bf73032ad909cf6.png" alt="image"></p><br><p>  In order for the concentration to influence the output of the encoder as little as possible, we added another loss function - manifold loss: </p><br><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-34-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="50.489ex" height="2.78ex" viewBox="0 -832 21738.2 1197.1" role="img" focusable="false" style="vertical-align: -0.848ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-73" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-75" x="719" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6D" x="1292" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6C" x="2420" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-69" x="2719" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6D" x="3064" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-69" x="3943" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-74" x="4288" y="0"></use><g transform="translate(4650,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-73" x="0" y="0"></use><g transform="translate(469,-150)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-31" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6C" x="854" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-65" x="1152" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-69" x="1619" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-3C" x="1964" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6A" x="2743" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6C" x="3509" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-65" x="3807" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6B" x="4274" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-31" x="8610" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-2212" x="9333" y="0"></use><g transform="translate(10333,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-53" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-43" x="867" y="-219"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-28" x="11585" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-45" x="11974" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-28" x="12739" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-46" x="13128" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-70" x="13878" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-2C" x="14381" y="0"></use><g transform="translate(14826,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-43" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-69" x="1011" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-29" x="15886" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-2C" x="16276" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-45" x="16721" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-28" x="17485" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-46" x="17875" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-70" x="18624" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-2C" x="19128" y="0"></use><g transform="translate(19573,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-43" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6A" x="1011" y="-213"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-29" x="20680" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-29" x="21070" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-2C" x="21459" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-34"> \ sum \ limits_ {1 \ le i <j \ le k} 1 - S_C (E (Fp, C_i), E (Fp, C_j)), </script></p><br><p>  Where <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-35-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.776ex" height="2.057ex" viewBox="0 -780.1 764.5 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-45" x="0" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-35"> E </script>  - encoder, and <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-36-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.369ex" height="2.419ex" viewBox="0 -780.1 1020 1041.5" role="img" focusable="false" style="vertical-align: -0.607ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-53" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-63" x="867" y="-213"></use></g></svg></span><script type="math/tex" id="MathJax-Element-36"> S_c </script>  - cosine measure. </p><br><p>  Finally, in the latent layer, we solve the regression problem: from the latent representation of the fingerprint and concentration, determine <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-37-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.998ex" height="2.057ex" viewBox="0 -780.1 1291 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-47" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-49" x="786" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-37"> GI </script>  by adding the corresponding loss function.  As a result, each step of training consists of five stages: </p><br><ol><li>  Learning discriminator weights (as in the GAN). </li><li>  Learning generator weights (as in GAN). </li><li>  Learning autoencoder, i.e. optimization of reconstruction errors. </li><li>  Regressor training. </li><li>  Optimization of the loss function - manifold loss. </li></ol><br><p>  The code for the entire learning process is <a href="https://github.com/spoilt333/onco-aae/blob/master/cornucopia/aae_v3.py">here</a> (at the moment we are continuing to experiment with the code and are going to upload an improved version in the near future). </p><br><p>  Let us consider in more detail the implementation of network architecture and metrics.  We separate the weights of each part of the network into a separate tf.name_scope in order to be able to optimize them separately.  Additionally, we isolate the concentration from the input layer into a separate variable and separately consider the reconstruction error for it. </p><br><p>  As usual, the network is a sequence of linear layers and activation functions.  For example, the encoder is arranged as follows ( <a href="https://github.com/spoilt333/onco-aae/blob/master/cornucopia/aae_v3.py">aae_v3.py</a> , lines 109-127): </p><br><pre><code class="python hljs"><span class="hljs-comment"><span class="hljs-comment"># Encoder net: 166+1-&gt;128-&gt;64-&gt;3+1 with tf.name_scope("encoder"): encoder = [self.visible_tensor] sizes = [self.input_space + 1, 128, 64, self.latent_space] for layer_number in xrange(encoder_layers): with tf.name_scope("encoder-%s" % layer_number): enc_l = layer_output(sizes[layer_number], sizes[layer_number + 1], encoder[-1], 'enc_l') encoder.append(enc_l) with tf.name_scope("encoder-fp"): self.encoded_fp = layer_output(sizes[-2], sizes[-1], encoder[-1], 'encoded_fp', batch_normed=False, activation_function=identity_function) with tf.name_scope("tgi-encoder"): self.encoded_tgi = layer_output(sizes[-2], 1, encoder[-1], 'encoded_tgi', batch_normed=False, activation_function=identity_function) self.encoded = tf.concat(1, [self.encoded_fp, self.encoded_tgi])</span></span></code> </pre> <br><p>  Discriminator loss function: </p><br><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-38-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="75.158ex" height="2.901ex" viewBox="0 -832 32359.6 1249" role="img" focusable="false" style="vertical-align: -0.969ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-63" x="1781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-31" x="2215" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6D" x="2715" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-73" x="3844" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-75" x="4313" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6D" x="4886" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6C" x="6014" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-69" x="6313" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6D" x="6658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-69" x="7537" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-74" x="7882" y="0"></use><g transform="translate(8244,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6D" x="663" y="499"></use><g transform="translate(469,-308)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-31" x="1124" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6C" x="10212" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-65" x="10510" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-66" x="10977" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-74" x="11527" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-5B" x="11889" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6C" x="12167" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6F" x="12466" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-67" x="12951" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-28" x="13432" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-44" x="13821" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-69" x="14650" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-73" x="14995" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-63" x="15465" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-28" x="15898" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-45" x="16288" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-28" x="17052" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-78" x="17442" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-29" x="18014" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-29" x="18404" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-29" x="18793" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-2B" x="19405" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6C" x="20406" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6F" x="20704" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-67" x="21190" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-28" x="21670" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-31" x="22060" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-2212" x="22782" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-44" x="23783" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-69" x="24612" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-73" x="24957" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-63" x="25427" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-28" x="25860" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-44" x="26250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-65" x="27078" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-63" x="27545" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-28" x="27978" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-7A" x="28368" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-29" x="28836" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-29" x="29226" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-72" x="29865" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-69" x="30317" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-67" x="30662" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-68" x="31143" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-74" x="31719" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-5D" x="32081" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-38"> \ frac {1} {m} \ sum \ limits_ {i = 1} ^ m \ left [log (Disc (E (x))) + log (1 - Disc (Dec (z)) \ right] </script></p><br><p>  To combat overflow, we consider sigmoid not immediately at the discriminator output, but directly inside the loss function.  In the code: </p><br><pre> <code class="python hljs">self.disc_loss = tf.reduce_mean(tf.nn.relu(self.disc_prior) - self.disc_prior + tf.log(<span class="hljs-number"><span class="hljs-number">1.0</span></span> +tf.exp(-tf.abs(self.disc_prior)))) + tf.reduce_mean(tf.nn.relu(self.disc_enc) + tf.log(<span class="hljs-number"><span class="hljs-number">1.0</span></span> + tf.exp(-tf.abs(self.disc_enc))))</code> </pre> <br><p>  Encoder loss function: </p><br><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-39-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="54.931ex" height="2.901ex" viewBox="0 -832 23650.6 1249" role="img" focusable="false" style="vertical-align: -0.969ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-66" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-72" x="800" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-61" x="1252" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-63" x="1781" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-31" x="2215" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6D" x="2715" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-73" x="3844" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-75" x="4313" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6D" x="4886" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6C" x="6014" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-69" x="6313" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6D" x="6658" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-69" x="7537" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-74" x="7882" y="0"></use><g transform="translate(8244,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6D" x="663" y="499"></use><g transform="translate(469,-308)"><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-3D" x="345" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-31" x="1124" y="0"></use></g></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6C" x="10212" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-65" x="10510" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-66" x="10977" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-74" x="11527" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-5B" x="11889" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-31" x="12167" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-2212" x="12890" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6C" x="13891" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6F" x="14189" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-67" x="14675" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-28" x="15155" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-44" x="15545" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-69" x="16373" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-73" x="16719" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-63" x="17188" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-28" x="17622" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-45" x="18011" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-28" x="18776" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-78" x="19165" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-29" x="19738" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-29" x="20127" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-29" x="20517" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-72" x="21156" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-69" x="21608" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-67" x="21953" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-68" x="22434" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-74" x="23010" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-5D" x="23372" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-39"> \ frac {1} {m} \ sum \ limits_ {i = 1} ^ m \ left [1-log (Disc (E (x))) \ right] </script></p><br><p>  In the code: </p><br><pre> <code class="python hljs">self.enc_fp_loss = tf.reduce_mean(tf.nn.relu(self.disc_enc) - self.disc_enc + tf.log(<span class="hljs-number"><span class="hljs-number">1.0</span></span> + tf.exp(-tf.abs(self.disc_enc))))</code> </pre> <br><p>  Autoencoder loss function: </p><br><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-40-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="54.133ex" height="2.66ex" viewBox="0 -832 23307.3 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-43" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-72" x="760" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6F" x="1212" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-73" x="1697" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-73" x="2167" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-45" x="2636" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6E" x="3401" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-74" x="4001" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-72" x="4363" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6F" x="4814" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-70" x="5300" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-79" x="5803" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-28" x="6301" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-44" x="6690" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-65" x="7519" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-63" x="7985" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-28" x="8419" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-45" x="8808" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-28" x="9573" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-78" x="9962" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-29" x="10535" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-29" x="10924" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-2C" x="11314" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-78" x="11759" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-29" x="12331" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-2B" x="12943" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-52" x="13944" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-4D" x="14703" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-53" x="15755" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-45" x="16400" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-28" x="17165" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-44" x="17554" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-65" x="18383" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-63" x="18849" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-28" x="19283" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-45" x="19672" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-28" x="20437" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-63" x="20826" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-29" x="21260" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-29" x="21649" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-2C" x="22039" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-63" x="22484" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-29" x="22917" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-40"> CrossEntropy (Dec (E (x)), x) + RMSE (Dec (E (c)), c) </script></p><br><p>  In the code: </p><br><pre> <code class="python hljs">self.dec_fp_loss = tf.reduce_mean(tf.nn.sigmoid_cross_entropy_with_logits(self.decoded_fp, self.fingerprint_tensor)) self.dec_conc_loss = tf.reduce_mean(tf.square(tf.sub(self.conc_tensor, self.decoded_conc))) self.dec_loss = self.dec_fp_loss + self.dec_conc_loss</code> </pre> <br><p>  Regressor: </p><br><p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-41-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="24.449ex" height="2.66ex" viewBox="0 -832 10526.7 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-52" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-4D" x="759" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-53" x="1811" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-45" x="2456" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-28" x="3221" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-65" x="3610" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6E" x="4077" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-63" x="4677" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6F" x="5111" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-64" x="5596" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-65" x="6120" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-64" x="6586" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-47" x="7110" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-49" x="7896" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-2C" x="8401" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-47" x="8846" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-49" x="9632" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-29" x="10137" y="0"></use></g></svg></span></div><script type="math/tex;mode=display" id="MathJax-Element-41"> RMSE (encoded GI, GI) </script></p><br><p>  In the code: </p><br><pre> <code class="python hljs">self.enc_tgi_loss = tf.reduce_mean(tf.square(tf.sub(self.tgi_tensor, self.encoded_tgi)))</code> </pre> <br><p>  Manifold loss in code: </p><br><pre> <code class="python hljs">fp_norms = tf.sqrt(tf.reduce_sum(tf.square(self.encoded_fp), keep_dims=<span class="hljs-keyword"><span class="hljs-keyword">True</span></span>, reduction_indices=[<span class="hljs-number"><span class="hljs-number">1</span></span>])) normalized_fp = tf.div(self.encoded_fp, fp_norms) cosines_fp = tf.matmul(normalized_fp, tf.transpose(normalized_fp)) self.manifold_cost = tf.reduce_mean(<span class="hljs-number"><span class="hljs-number">1</span></span> - tf.boolean_mask(cosines_fp, self.targets_tensor))</code> </pre> <br><p>  In our experiments, the network with different configurations behaved unstably.  To increase the stability before the main learning process, we repeated steps 1, 2 and 5 until the discriminator and the encoder reached a state of equilibrium: discriminator_loss &lt;0.7 and encoder_loss &lt;0.7. </p><br><h2 id="validaciya-modeli">  Model validation </h2><br><p>  After training, we generate a random sample of 1000 pairs (fingerprint, concentration) with the condition in a standard way for GAN. <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-42-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.675ex" height="2.057ex" viewBox="0 -780.1 3735 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-47" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-49" x="786" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-73" x="1541" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-69" x="2010" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6D" x="2356" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-30" x="3234" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-42"> GI \ sim 0 </script>  : </p><br><p><img src="https://habrastorage.org/files/490/b67/b23/490b67b2344b40b18c399a3a710a7683.png" alt="image"></p><br><p>  Serve in the latent layer prior distribution, and instead <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-43-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.998ex" height="2.057ex" viewBox="0 -780.1 1291 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-47" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-49" x="786" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-43"> GI </script>  - small numbers with normal noise <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-44-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.742ex" height="2.66ex" viewBox="0 -832 4625.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-63" x="250" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-61" x="683" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-6C" x="1213" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-4E" x="1511" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-28" x="2400" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-35" x="2789" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-2C" x="3290" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-31" x="3735" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMAIN-29" x="4235" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-44"> {\ cal N} (5, 1) </script>  (zeros serve badly because the function <math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-45-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.998ex" height="2.057ex" viewBox="0 -780.1 1291 885.9" role="img" focusable="false" style="vertical-align: -0.246ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-47" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/company/mailru/blog/325908/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhgAC91z7LGx1RwN8sSNNk8RPTVIsQ#MJMATHI-49" x="786" y="0"></use></g></svg></span><script type="math/tex" id="MathJax-Element-45"> GI </script>  at this point has a gap).  At the output, we obtained 32 probability vectors of fingerprint bits with a concentration of &lt;‚Äì5. </p><br><p>  Finally, it remains to find real molecules from a large base, similar to the vectors obtained.  There are at least three approaches: </p><br><ul><li>  calculate NLL (likelihood log); </li><li>  Sample from the obtained distributions as from the multidimensional Bernoulli distributions and calculate the Jaccard distance; </li><li>  just put a cutoff of 0.5 and calculate the distance Jacquard. </li></ul><br><p>  For each probability vector, we found the top 10 ‚Äúsimilar‚Äù molecules for each of the three approaches and obtained similar results. </p><br><h2 id="rezultat">  Result </h2><br><p>  As a result, we found 69 unique substances that were not in the training set.  According to data from <a href="https%25253A%25252F%25252Fpubchem.ncbi.nlm.nih.gov%25252F%26usg%3DAFQjCNH6jGl2oOwxzjhUMRFJZfHml-ISKw%26sig2%3Djf1H8ieiU-SFZXcGrbfHVQ">The PubChem Project</a> , about half of the substances are either already used against cancer, or have a proven effect against cancer.  We expect that the remaining half of the substances can also potentially fight cancer. </p><br><p>  Thus, a rather naive approach with relatively small input data allowed us to get a good result.  It is expected that many problems of bioinformatics can be solved by similar methods. </p><br><p>  Unfortunately, in each specific case, the competing networks behave differently and, if the hyper parameters are chosen incorrectly, they converge to the wrong decisions (the generator defeats the discriminator, or vice versa).  We are working to find more stable structures and learning methods. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/325908/">https://habr.com/ru/post/325908/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../325898/index.html">Excursion to the Glasgow Science Center - and about the development of the game on "Fixico"</a></li>
<li><a href="../325900/index.html">Unity3d / Android: check user on Node.JS own server</a></li>
<li><a href="../325902/index.html">Fintech: adapt or die</a></li>
<li><a href="../325904/index.html">rssh, or How to allow SCP, but disable SSH</a></li>
<li><a href="../325906/index.html">From idea to release in one bottle. Cloud Management Development Process - Visual Studio Team Services</a></li>
<li><a href="../325910/index.html">Collection and analysis of logs for beginners</a></li>
<li><a href="../325912/index.html">Caution: high voltage, or when tech support needs support</a></li>
<li><a href="../325916/index.html">Behind the closed door of the front of the EFS</a></li>
<li><a href="../325918/index.html">IP KVM do it yourself</a></li>
<li><a href="../325920/index.html">14 tools that will be useful for website promotion</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>