<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Why do routine work when it can be charged to a car?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Once again, revising the "Iron Man" with a friend, I was again saturated with the desire to become a superhero to create my own iron suit, or at least...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Why do routine work when it can be charged to a car?</h1><div class="post__text post__text-html js-mediator-article">  Once again, revising the "Iron Man" with a friend, I was again saturated with the desire to <s>become a superhero</s> to create my own iron suit, or <i>at least</i> Jarvis.  And suddenly I was visited by a brilliant idea. <br><br><div class="spoiler">  <b class="spoiler_title">Lyrical digression</b> <div class="spoiler_text">  A couple of days ago there was the European Cup 2015 European Cup match, which I turned on only for 70 minutes.  Yes, I watched the rest of the game, but still there was an unpleasant aftermath because I could see 70 minutes of excellent football only in the record (which, as you understand, is not at all), because I somehow forgot the fact that in summer there are official matches too.  Cry and that's enough. <br></div></div><br>  So, recently I started actively using the system calendar on a Mac, and I thought, why not add all Barca games to this very calendar? <br><br> <a href="http://habrahabr.ru/post/265393/"><img src="https://habrastorage.org/files/73a/b0b/f4c/73ab0bf4cd394168813bc95ef9793cd3.jpg"><br></a> <br><a name="habracut"></a><br><h2>  Terminal mac </h2><br>  So, you have to start somewhere.  Yeah, you need to understand how to create events in the Calendar using code, i.e.  we need Mac Calendar API.  First I got into the terminal, and typing <br><pre><code class="bash hljs">Mac:~ dima$ whatis calendar</code> </pre> <br>  we get several commands: <br><pre> <code class="bash hljs">Mac:~ dima$ whatis calendar cal(1), ncal(1) - displays a calendar and the date of easter calendar(1) - reminder service iwidgets_calendar(n), iwidgets::calendar(n) - Create and manipulate a monthly calendar widget_calendar(n) - widget::calendar Megawidget</code> </pre><br>  All these commands are relatively similar and have approximately the same functionality, displaying a calendar in various ways, including as a widget.  But this is not what we need, because we want to create a separate calendar with events. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      A little googling, I went out to the Mac script language - <b>AppleScript</b> , which contains some no API of all embedded applications in the format of so-called "dictionaries" (it is quite possible that Google was too clumsy, so I did not find anything better than <b>AppleScript</b> ). <br><br><h2>  Little appleScript </h2><br>  Having opened the script editor and studied the built-in ‚Äúdictionary‚Äù of commands a bit, occasionally <s>offering sacrifices to the search deities</s> using Google, I realized that it was quite possible to create an event (I really had to ‚Äúwake up‚Äù with this language, especially with dates): <br><pre> <code class="actionscript hljs"><span class="hljs-keyword"><span class="hljs-keyword">set</span></span> startDate to date <span class="hljs-string"><span class="hljs-string">", 25  2015 ., 0:00:00"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> endDate to date <span class="hljs-string"><span class="hljs-string">", 25  2015 ., 10:00:00"</span></span> tell application <span class="hljs-string"><span class="hljs-string">"Calendar"</span></span> tell calendar <span class="hljs-string"><span class="hljs-string">", "</span></span> make <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> event <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> properties {description:<span class="hljs-string"><span class="hljs-string">"Test"</span></span>, summary:<span class="hljs-string"><span class="hljs-string">"Something"</span></span>, start date:startDate, allday event:<span class="hljs-literal"><span class="hljs-literal">true</span></span>} end tell end tell</code> </pre><br>  Ok, let's fix the success, have a snack and go on. <br><br><h2>  Let's parse! </h2><br>  Open <b>Xamarin Studio</b> , install the <b>NuGet</b> HtmlAgillityPack package using the built-in context menu, and check if it appeared in Packages. <br><br> <a href=""><img src="https://habrastorage.org/files/85b/103/433/85b103433db74b4e86b3f23a2a632698.png"><br></a> <br> <a href=""><img src="https://habrastorage.org/files/0f7/0cd/79a/0f70cd79a54149788d4894eec2960f28.png"><br></a> <br> <a href=""><img src="https://habrastorage.org/files/c45/598/42f/c4559842fe4f4be3ac6ff7c71758de5f.png"><br></a> <br><br>  Do not forget to connect the installed package with the using directive and begin to write code.  Let's start with the class <b>SingleMatch</b> , in which we will keep all that we naparsim.  Create auto-implementable properties, since  we do not need here the execution logic, two constructors (with parameters and without) and override the standard for all classes method <b>ToString ()</b> . <br><br><div class="spoiler">  <b class="spoiler_title">SingleMatch.cs</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">barca_matches_to_the_calendar</span></span> { <span class="hljs-comment"><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment">   . </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> public class SingleMatch { </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment">    . </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;value&gt;</span></span></span><span class="hljs-comment">    </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;see cref="DateTime"/&gt;</span></span></span><span class="hljs-comment">.</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/value&gt;</span></span></span><span class="hljs-comment"> public DateTime StartTime { get; set; } </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment">  . </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;value&gt;</span></span></span><span class="hljs-comment"> .</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/value&gt;</span></span></span><span class="hljs-comment"> public string Tournament { get; set; } </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment">  -. </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;value&gt;</span></span></span><span class="hljs-comment">  - .</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/value&gt;</span></span></span><span class="hljs-comment"> public string Rival { get; set; } </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment">   ( /). </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;value&gt;</span></span></span><span class="hljs-comment"> (" "/"").</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/value&gt;</span></span></span><span class="hljs-comment"> public string Place { get; set; } </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment">    SingleMatch </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;see cref="barca_matches_to_the_calendar.SingleMatch"/&gt;</span></span></span><span class="hljs-comment"> class. </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> public SingleMatch() { StartTime = new DateTime(); Tournament = null; Rival = null; Place = null; } </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment">    SingleMatch </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;see cref="barca_matches_to_the_calendar.SingleMatch"/&gt;</span></span></span><span class="hljs-comment"> class. </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;param name="startTime"&gt;</span></span></span><span class="hljs-comment">  .</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/param&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;param name="tournament"&gt;</span></span></span><span class="hljs-comment">.</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/param&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;param name="rival"&gt;</span></span></span><span class="hljs-comment">.</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/param&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;param name="place"&gt;</span></span></span><span class="hljs-comment"> ( /).</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/param&gt;</span></span></span><span class="hljs-comment"> public SingleMatch(DateTime startTime, string tournament, string rival, string place) { StartTime = startTime; Tournament = tournament; Rival = rival; Place = place; } </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment">  a </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;see cref="System.String"/&gt;</span></span></span><span class="hljs-comment">,    </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment">  </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;see cref="barca_matches_to_the_calendar.SingleMatch"/&gt;</span></span></span><span class="hljs-comment">. </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;returns&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment">  a </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;see cref="System.String"/&gt;</span></span></span><span class="hljs-comment">,    </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment">  </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;see cref="barca_matches_to_the_calendar.SingleMatch"/&gt;</span></span></span><span class="hljs-comment">. </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/returns&gt;</span></span></span><span class="hljs-comment"> public override string ToString() { return string.Format("  ={0}, ={1}, ={2}, ={3}", StartTime, Tournament, Rival, Place); } } }</span></span></code> </pre><br></div></div><br>  Since  we have not one match, but several, we will keep them in the list.  But since we save the calendar of one selected FC, we will move its name to a separate property and create another class to store all matches. <br><br><div class="spoiler">  <b class="spoiler_title">Matches.cs</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">barca_matches_to_the_calendar</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">Matches</span></span> { <span class="hljs-comment"><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment">  . </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;value&gt;</span></span></span><span class="hljs-comment"> .</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/value&gt;</span></span></span><span class="hljs-comment"> public string NameFC { get; set; } </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment">    </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;value&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/value&gt;</span></span></span><span class="hljs-comment"> public List</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;SingleMatch&gt;</span></span></span><span class="hljs-comment"> ListMatches { get; set; } </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> Initializes a new instance of the </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;see cref="barca_matches_to_the_calendar.Matches"/&gt;</span></span></span><span class="hljs-comment"> class. </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> public Matches() { ListMatches = new List</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;SingleMatch&gt;</span></span></span><span class="hljs-comment">(); NameFC = null; } </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> Initializes a new instance of the </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;see cref="barca_matches_to_the_calendar.Matches"/&gt;</span></span></span><span class="hljs-comment"> class. </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;param name="nameFC"&gt;</span></span></span><span class="hljs-comment"> .</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/param&gt;</span></span></span><span class="hljs-comment"> public Matches(string nameFC) { ListMatches = new List</span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;SingleMatch&gt;</span></span></span><span class="hljs-comment">(); NameFC = nameFC; } </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment">  a </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;see cref="System.String"/&gt;</span></span></span><span class="hljs-comment">,    </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment">  </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;see cref="barca_matches_to_the_calendar.Matches"/&gt;</span></span></span><span class="hljs-comment">. </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/summary&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;returns&gt;</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment">  a </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;see cref="System.String"/&gt;</span></span></span><span class="hljs-comment">,    </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment">  </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;see cref="barca_matches_to_the_calendar.Matches"/&gt;</span></span></span><span class="hljs-comment">. </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">///</span></span></span><span class="hljs-comment"> </span><span class="hljs-doctag"><span class="hljs-comment"><span class="hljs-doctag">&lt;/returns&gt;</span></span></span><span class="hljs-comment"> public override string ToString() { return string.Format("  \"{0}\",  {1}", NameFC, ListMatches); } } }</span></span></code> </pre><br></div></div><br>  Well, actually the main class is <b>Program.cs</b> , in which we parse the specified site and save everything to a text file, from which we transfer all events to the calendar using <b>AppleScript</b> . <br><br><div class="spoiler">  <b class="spoiler_title">Program.cs</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> HtmlAgilityPack; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Linq; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">barca_matches_to_the_calendar</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">MainClass</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] args</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-comment"><span class="hljs-comment">//  ,    . string WebAddress = @"http://www.sports.ru/barcelona/calendar/"; //    -  - HtmlWeb WebGet = new HtmlWeb(); //  html-   . HtmlDocument htmlDoc = WebGet.Load(WebAddress); //     Matches MatchesFC = new Matches(); //    (   ) MatchesFC.NameFC = htmlDoc.DocumentNode. SelectSingleNode(".//*[@class='titleh2']"). FirstChild.InnerText.Replace("\r\n", ""); //           XPath-. HtmlNode Table = htmlDoc.DocumentNode.SelectSingleNode(".//*[@class='stat-table']/tbody"); //      -   "tr". IEnumerable&lt;HtmlNode&gt; rows = Table.Descendants().Where(x =&gt; x.Name == "tr"); foreach (var row in rows) { //      . HtmlNodeCollection cells = row.ChildNodes; //    SingleMatch,      . SingleMatch match = new SingleMatch(); //  ,       "|", //    TryParse    . DateTime time; DateTime.TryParse(cells[1].InnerText.Replace("|", " "), out time); match.StartTime = time; //    ,    . match.Tournament = cells[3].InnerText; //   ""      (" ") match.Rival = cells[5].InnerText.Replace(" ", ""); match.Place = cells[6].InnerText; //      . MatchesFC.ListMatches.Add(match); } //   . foreach (SingleMatch match in MatchesFC) { //             // (    ) string path = @"matches.txt"; //   using (StreamWriter file = new StreamWriter(path, true)) { file.WriteLine(match); } } Console.WriteLine("     !"); } } }</span></span></code> </pre><br></div></div><br>  Okay, the site is parsed, all matches are in a file in a convenient-readable format, back to <b>AppleScript</b> . <br><br>  (Somewhere here I wondered if there was a button for importing the entire calendar somewhere on the site or in the application. I downloaded the site application on the phone and found there an addition of a reminder about one match, but not all of them at once. Yes even if I found the import of the entire calendar of games at once, it is unlikely to stop, because this is not the <i>way of the Jedi!</i> ). <br><br><h2>  New - well forgotten old </h2><br>  Using Finder, open the file, parse it and pass it to the event creation function. <br><div class="spoiler">  <b class="spoiler_title">What came out of it</b> <div class="spoiler_text"><pre> <code class="actionscript hljs">tell application <span class="hljs-string"><span class="hljs-string">"Finder"</span></span> -- ,           (..    ) <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> Matches to paragraphs of (read (choose file <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> prompt <span class="hljs-string"><span class="hljs-string">" ,     "</span></span>)) repeat <span class="hljs-keyword"><span class="hljs-keyword">with</span></span> Match <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> Matches <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> length of Match <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> greater than <span class="hljs-number"><span class="hljs-number">0</span></span> then --     <span class="hljs-string"><span class="hljs-string">'='</span></span>, <span class="hljs-string"><span class="hljs-string">','</span></span>     <span class="hljs-string"><span class="hljs-string">'\n'</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span> AppleScript<span class="hljs-string"><span class="hljs-string">'s text item delimiters to {"=", ",", ASCII character 13} --      my CreateEvent(text item 2 of Match, text item 4 of Match, text item 6 of Match, text item 8 of Match, text item 10 of Match) end if end repeat end tell on CreateEvent(textDate, tournament, fc, rival, place) --       set startDate to the current date set the day of startDate to (text 1 thru 2 of textDate) set the month of startDate to (text 4 thru 5 of textDate) set the year of startDate to (text 7 thru 10 of textDate) set the hours of startDate to (text 12 thru 13 of textDate) set the minutes of startDate to (text 15 thru 16 of textDate) set the seconds of startDate to (text 18 thru 19 of textDate) --        set endDate to (startDate + 2 * hours) tell application "Calendar" create calendar with name "" tell calendar "" --     make new event with properties {description:"" &amp; fc &amp; " : " &amp; rival &amp; ". " &amp; place, summary:"", start date:startDate, end date:endDate} end tell end tell end CreateEvent</span></span></code> </pre><br></div></div><br>  But somewhere in the middle of writing this script, I <i>suddenly</i> discovered (at this point, readers who looked at all these difficulties with the question ‚ÄúWhy is it so difficult?‚Äù Sighed with relief) that there is such a calendar format - " <i>.ics"</i> , which swallows both <b>Mac Calendar</b> , and <b>Google Calendar</b> , and even <b>Outlook</b> , and, therefore, surely there is some <b>C #</b> library that allows you to save events to this very <i>".ics"</i> . <br><br><h2>  Just a little bit and our crutch bike is ready </h2><br>  By installing and connecting the <b>DDay.iCal</b> library, <b>we</b> will slightly change our <b>Program.cs</b> class: <br><div class="spoiler">  <b class="spoiler_title">Program.cs</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> HtmlAgilityPack; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Collections.Generic; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Linq; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> DDay.iCal; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> DDay.iCal.Serialization.iCalendar; <span class="hljs-keyword"><span class="hljs-keyword">using</span></span> System.Security.Cryptography; <span class="hljs-keyword"><span class="hljs-keyword">namespace</span></span> <span class="hljs-title"><span class="hljs-title">barca_matches_to_the_calendar</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">MainClass</span></span> { <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">Main</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params">[] args</span></span></span><span class="hljs-function">)</span></span> { <span class="hljs-comment"><span class="hljs-comment">//  ,    . string WebAddress = @"http://www.sports.ru/barcelona/calendar/"; //    -  - HtmlWeb WebGet = new HtmlWeb(); //  html-   . HtmlDocument htmlDoc = WebGet.Load(WebAddress); //     Matches MatchesFC = new Matches(); //    (   ) MatchesFC.NameFC = htmlDoc.DocumentNode. SelectSingleNode(".//*[@class='titleH1']"). FirstChild.InnerText.Replace("\r\n", ""); //           XPath-. HtmlNode Table = htmlDoc.DocumentNode.SelectSingleNode(".//*[@class='stat-table']/tbody"); //      -   "tr". IEnumerable&lt;HtmlNode&gt; rows = Table.Descendants().Where(x =&gt; x.Name == "tr"); foreach (var row in rows) { //      . HtmlNodeCollection cells = row.ChildNodes; //    SingleMatch,      . SingleMatch match = new SingleMatch(); //  ,       "|", //    TryParse    . DateTime time; DateTime.TryParse(cells[1].InnerText.Replace("|", " "), out time); match.StartTime = time; //    ,    . match.Tournament = cells[3].InnerText; //   ""      (" ") match.Rival = cells[5].InnerText.Replace(" ", ""); match.Place = cells[6].InnerText; //      . MatchesFC.ListMatches.Add(match); } //  ,     . iCalendar CalForMatches = new iCalendar { Method = "PUBLISH", Version = "2.0" }; //      Mac,      //   (..   Mac Calendar) CalForMatches.AddProperty("CALSCALE", "GREGORIAN"); CalForMatches.AddProperty("X-WR-CALNAME", "M  " + MatchesFC.NameFC); CalForMatches.AddProperty("X-WR-TIMEZONE", "Europe/Moscow"); CalForMatches.AddLocalTimeZone(); //   . foreach (SingleMatch match in MatchesFC.ListMatches) { Event newMatch = CalForMatches.Create&lt;Event&gt;(); newMatch.DTStart = new iCalDateTime(match.StartTime); newMatch.Duration = new TimeSpan(2, 30, 0); newMatch.Summary = string.Format("{0} : {1}", MatchesFC.NameFC, match.Rival); newMatch.Description = string.Format("{0}. {1} : {2}, {3}", match.Tournament, MatchesFC.NameFC, match.Rival, match.Place); //    ,      Alarm alarm = new Alarm(); alarm.Trigger = new Trigger(TimeSpan.FromMinutes(-10)); alarm.Description = "  "; alarm.AddProperty("ACTION", "DISPLAY"); newMatch.Alarms.Add(alarm); } //   . iCalendarSerializer serializer = new iCalendarSerializer(); serializer.Serialize(CalForMatches, MatchesFC.NameFC + ".ics"); Console.WriteLine("   " + Environment.NewLine); return; } } }</span></span></code> </pre><br></div></div><br>  Here the line deserves special attention. <pre> <code class="cs hljs">alarm.AddProperty(<span class="hljs-string"><span class="hljs-string">"ACTION"</span></span>, <span class="hljs-string"><span class="hljs-string">"DISPLAY"</span></span>);</code> </pre> <br>  Originally here was <pre> <code class="cs hljs">alarm.Action = AlarmAction.Display;</code> </pre>  because of which all the reminders did not want to be imported into the calendar just because the word <i>‚ÄúDisplay‚Äù</i> was not written in capital letters, but as an ordinary word and the poppy calendar could not recognize <i>this monstrous cryptocode</i> . <br><br><h2>  Feet <s>on the pedals</s> on crutches and go! </h2><br>  So, it turned out, the calendar of games is saved.  Create a new <b>iCloud</b> calendar (so that alerts come to all <i>devices</i> ), cross your fingers and import the calendar file into our new <b>iCloud</b> calendar: <br><br> <a href=""><img src="https://habrastorage.org/files/65c/8ff/861/65c8ff86115941e6850d71a308d58e5f.png"><br></a> <br><img src="https://habrastorage.org/files/9ad/8a6/ba9/9ad8a6ba90554885913175a4193e3a98.png"><br> <a href=""><img src="https://habrastorage.org/files/dcb/ac1/874/dcbac1874a444641ade01b37cb687758.png"><br></a> <br>  Hyp-hip-hurray, it remains to choose the appropriate color (there should be no problems here), and we received a schedule of games with reminders.  I hope now I will rarely miss the game. <br><br><h4>  Sources: </h4><br>  <a href="https://github.com/105th/Save-matches-to-calendar/">githab</a> <br><br><h4>  Resources used: </h4><br>  <a href="http://habrahabr.ru/post/23312/">AppleScript</a> <br>  <a href="http://habrahabr.ru/post/114772/">xpath expressions</a> <br>  <a href="https://github.com/mdavid/DDay-iCal-svn/tree/master/Examples/C%2523">DDay.iCal usage examples</a> <br>  <a href="http://www.codeproject.com/Articles/659019/Scraping-HTML-DOM-elements-using-HtmlAgilityPack-H">HtmlAgillityPack usage examples</a> <br><br>  <b>PS</b> Many of you may ask the question: <i>"The meaning of writing your own, if you already have one ready?"</i> <br>  Answer: I have never once parsed anything, but here is a convenient and interesting opportunity to try something new. </div><p>Source: <a href="https://habr.com/ru/post/265393/">https://habr.com/ru/post/265393/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../265383/index.html">To help the analyst: we write our automatic download of Yandex.Metrica reports using AWS for free</a></li>
<li><a href="../265385/index.html">Atlassian JIRA Service Desk: brief information and some tricks for usability (using sil-scripts and sql)</a></li>
<li><a href="../265387/index.html">Practice Mikrotik settings for dummies</a></li>
<li><a href="../265389/index.html">How to feed cats. Manual for programmers leading other programmers</a></li>
<li><a href="../265391/index.html">Ruby on Rails and interaction with REST Qiwi Shop</a></li>
<li><a href="../265395/index.html">Development of browser online games on meteor</a></li>
<li><a href="../265397/index.html">RailsClub 2015: Interview with Sam Pippen</a></li>
<li><a href="../265399/index.html">Riak and Riak Search Yokozuna: First acquaintance</a></li>
<li><a href="../265401/index.html">Scaling up to 24 controllers in the new ETERNUS DX storage system</a></li>
<li><a href="../265403/index.html">Autumn online courses from Computer Science Center and Academic University</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>