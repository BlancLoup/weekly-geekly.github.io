<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Attackers used stolen digital certificate for Duqu2 malicious campaign</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A few days ago, an executable PE file (driver) was received in our anti-virus laboratory, which contained a valid digital signature. We added it to th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Attackers used stolen digital certificate for Duqu2 malicious campaign</h1><div class="post__text post__text-html js-mediator-article">  A few days ago, an executable PE file (driver) was received in our anti-virus laboratory, which contained a valid digital signature.  We added it to the database as <b>Win64 / Duqu.AC.</b>  The certificate was issued by a well-known Taiwanese company <a href="https://ru.wikipedia.org/wiki/Foxconn">Foxconn</a> (Hon Hai Precision Industry Co.), which specializes in the production of electronics, and is also one of the largest companies engaged in the production of components of the flagship devices of such famous companies as Apple, Canon, Sony. <br><br><img src="https://habrastorage.org/files/572/dc8/671/572dc86718c24bffbff25c78f763b80a.jpg"><br><br>  Earlier we <a href="http://habrahabr.ru/company/eset/blog/260121/">wrote</a> about this malicious campaign, in which attackers used the new version of the state-sponsored malware Duqu (Duqu2, Duqu.B), as well as about other detections of this malware from our AV products.  The specified driver is small (27,448 bytes) and is used by attackers to manipulate network traffic at the <a href="https://ru.wikipedia.org/wiki/NDIS">NDIS</a> level in the compromised system. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><img src="https://habrastorage.org/files/d5f/cc6/bd8/d5fcc6bd869746e19fa220b867ca5185.png"><br>  Fig.  The name of the device object, as well as the symbolic link that the malicious driver creates in the system (infection indicator). <br><br>  Already from the information on the driver import (ndis.sys), it is clear that it specializes in working with network traffic at the NDIS level. <br><br><img src="https://habrastorage.org/files/1cd/1ab/e8d/1cd1abe8d1414441a82987922beab898.png"><br>  Fig.  Part of the imported Win64 / Duqu.AC functions. <br><br><img src="https://habrastorage.org/files/b25/8fd/224/b258fd224b9f4ea1921d4181c640431b.png"><br>  Fig.  Valid digital signature Win64 / Duqu.AC.  The compromised certificate was still valid. <br><br><img src="https://habrastorage.org/files/fb1/985/3f3/fb19853f35a64840bb53c5ef193063fe.png"><br>  Fig.  Properties of the malicious file. <br><br>  The theft of the digital certificate is related to the malicious campaign to spread Duqu2 with another malicious company spreading the famous <a href="http://download.esetnod32.ru/company/virlab/analytics/Stuxnet_Under_the_Microscope.pdf">worm Stuxnet</a> , its drivers also contained a digital signature, and the certificates were also stolen from technology companies: JMicron and Realtek.  Supplying a malicious driver with a digital signature is a one hundred percent solution to ensure that such a driver is loaded in a 64-bit version of Windows. <br><br>  The specified driver has the following prints: <br><br>  <b>MD5:</b> 92e724291056a5e30eca038ee637a23f <br>  <b>SHA1:</b> 478c076749bef74eaf9bed4af917aee228620b23 <br>  <b>SHA256:</b> bc4ae56434b45818f57724f4cd19354a13e5964fd097d1933a30e2e31c9bdfa5 </div><p>Source: <a href="https://habr.com/ru/post/260459/">https://habr.com/ru/post/260459/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../260449/index.html">Monitor real-time JavaScript timers</a></li>
<li><a href="../260451/index.html">Why Go surpasses mediocrity</a></li>
<li><a href="../260453/index.html">SAM solutions - complete order in IT infrastructure</a></li>
<li><a href="../260455/index.html">Oracle Database In-Memory</a></li>
<li><a href="../260457/index.html">Job Stories for Interface Design</a></li>
<li><a href="../260461/index.html">My first game development history</a></li>
<li><a href="../260463/index.html">Looking at the code with eyes closed</a></li>
<li><a href="../260467/index.html">Explosive GameDev. The history of my game</a></li>
<li><a href="../260469/index.html">Kolab Groupware (Part 1 - Overview)</a></li>
<li><a href="../260471/index.html">We use the built-in microcontroller in Intel Edison</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>