<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Zend_CodeGenerator Review</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="As many already know, Zend_CodeGenerator has appeared in beta 1.8 Zend_Framework 
 I wanted to be patient before the release of version 1.8, but I cou...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Zend_CodeGenerator Review</h1><div class="post__text post__text-html js-mediator-article"> As many already know, Zend_CodeGenerator has appeared in beta 1.8 Zend_Framework <br>  I wanted to be patient before the release of version 1.8, but I could not resist and decided to still try on the teeth. <br>  We will generate a form class based on the mysql table. <br>  It is really very convenient and saves us from sometimes routine work. <br><a name="habracut"></a><br>  First we need to consider the classes that we will use. <br><br>  To create a php file there is a class <br> <code>Zend_CodeGenerator_Php_File();</code> <br>  Its constructor accepts an array in which the classes in this file are specified.  For example, you can do this: <br><br><blockquote> <code><font color="black">$file = <font color="#0000ff">new</font> Zend_CodeGenerator_Php_File(array( <font color="#A31515">'classes'</font> =&gt; array($ <font color="#0000ff">class</font> )));</font> <br></code> </blockquote>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Where $ class is an instance of a class. <br>  Zend_CodeGenerator_Php_Class () <br><br>  There may be several classes in order to generate several classes; you should specify them in an array. <br><br>  But the coding standards for Zend_Framework say: <br><blockquote>  ‚ÄúOnly one class is allowed inside a single PHP file. <br>  Placing additional code in the file with the class is allowed, but not welcome.  In such files, two blank lines must separate the class and the additional PHP code. ‚Äù <br></blockquote><br>  This is a subjective matter and I would still generate one file for each class, <br>  So more clearly traced the structure of the application. <br><br>  So create a new class: <br><blockquote> <code><font color="black">$ <font color="#0000ff">class</font> = <font color="#0000ff">new</font> Zend_CodeGenerator_Php_Class();</font> <br></code> </blockquote><br><br>  The first method we need is setName (). <br>  the input parameter for it will be a string with a class. <br> <code>$class -&gt; setName('MyClass')</code> <br>  In order to specify from which class the generated class will be inherited we use the method <br><br><blockquote> <code><font color="black">$ <font color="#0000ff">class</font> -&gt;setExtendedClass( <font color="#A31515">'Myclass2'</font> )</font> <br></code> </blockquote><br><br>  Then we may need a dock block, <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">$docblock = <font color="#0000ff">new</font> Zend_CodeGenerator_Php_Docblock(array( <br> <font color="#A31515">'shortDescription'</font> =&gt; <font color="#A31515">'  '</font> , <br> <font color="#A31515">'longDescription'</font> =&gt; <font color="#A31515">'   Zend_CodeGenerator'</font> , <br> <font color="#A31515">'tags'</font> =&gt; array( <br> array( <br> <font color="#A31515">'name'</font> =&gt; <font color="#A31515">'version'</font> , <br> );</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br>  In the array, which is the input parameter, we specify <br>  'shortDescription' - a brief description of the class <br>  'longDescription' full class description <br><br>  In the tags array, we can specify tags for the docblock. <br>  'name' - tag name <br>  'description' - the text following it <br><br>  Then we need to declare the variables used in this class. <br>  This is the setProperties () method. Its day parameter is an array of variables, each new variable will be described in a new array. <br>  In which to specify the properties of the variable <br>  Or they can be described through the class Zend_CodeGenerator_Php_Parameter <br><br>  Suppose we need 2 variables: <br><br><blockquote> <code><font color="black">$vars =  array( <br> array( <br> <font color="#A31515">'name'</font> =&gt; 'name, <br> <font color="#A31515">'visibility'</font> =&gt; <font color="#A31515">'public'</font> , <br> <font color="#A31515">'defaultValue'</font> =&gt; '0', <br> ) <br> array( <br> <font color="#A31515">'name'</font> =&gt; '_table', <br> <font color="#A31515">'visibility'</font> =&gt; <font color="#A31515">'protected'</font> , <br> <font color="#A31515">'defaultValue'</font> =&gt; '1', <br> ) <br> ); <br></font> <br></code> </blockquote><br><br>  Or <br><blockquote> <code><font color="black">$var1 = Zend_CodeGenerator_Php_Parameter( <br> array( <br> <font color="#A31515">'name'</font> =&gt; ' <font color="#0000ff">var</font> ', <br> <font color="#A31515">'visibility'</font> =&gt; <font color="#A31515">'public'</font> , <br> <font color="#A31515">'defaultValue'</font> =&gt; '0', <br> ) <br> ); <br> $var2 = Zend_CodeGenerator_Php_Parameter( <br> array( <br> <font color="#A31515">'name'</font> =&gt; 'var2', <br> <font color="#A31515">'visibility'</font> =&gt; <font color="#A31515">'protected'</font> , <br> <font color="#A31515">'defaultValue'</font> =&gt; '1', <br> ) <br> ); <br> $vars =  array($var1, var2);</font> <br></code> </blockquote><br><br>  Name is the name of the variable. <br>  Visibility - access modifier <br>  Default value - the default values, if you do not specify this parameter, then the variable will be equal to null <br><br>  Now our class might look like this: <br><blockquote> <code><font color="black">$ <font color="#0000ff">class</font> = <font color="#0000ff">new</font> Zend_CodeGenerator_Php_Class(); <br> $ <font color="#0000ff">class</font> -&gt; setName( <font color="#A31515">'MyClass extends MyClass2'</font> ) -&gt; setProperties($vars) -&gt; setDocblock($docblock);</font> <br></code> </blockquote><br><br>  Of course, we will need to describe the methods of this class. <br>  To set the method is the method <br>  <code>setMethod()</code> or <br> <code>setMethods()</code> <br>  The only difference is in the number of methods we want to set, <code>setMethod()</code> accepts either an instance of the Zend_CodeGenerator_Php_Method class or an array that describes a method, <code>setMethods()</code> accepts an array that contains method objects, or a set of arrays. <br><br>  If you chose the first path, then it might look like this: <br><blockquote> <code><font color="black">$method = Zend_CodeGenerator_Php_Method(array( <br> <font color="#A31515">'name'</font> =&gt; <font color="#A31515">'myMethod'</font> , <br> <font color="#A31515">'body'</font> =&gt; <font color="#A31515">'echo "hello CodeGenerator"'</font> , <br> <font color="#A31515">'docblock'</font> =&gt; <font color="#0000ff">new</font> Zend_CodeGenerator_Php_Docblock(array( <br> <font color="#A31515">'shortDescription'</font> =&gt; <font color="#A31515">' '</font> , <br> <font color="#A31515">'tags'</font> =&gt; array( <br> <font color="#0000ff">new</font> Zend_CodeGenerator_Php_Docblock_Tag_Return(array( <br> <font color="#A31515">'datatype'</font> =&gt; <font color="#A31515">'string|null'</font> , <br> )), <br> ), <br> )), <br> )), <br> )); <br> <br> $ <font color="#0000ff">class</font> -&gt;setMethod($method);</font> <br></code> </blockquote><br><br>  If the second is possible and so: <br><br><blockquote> <code><font color="black">$ <font color="#0000ff">class</font> -&gt; setMethods(array( <br> array( <br> <font color="#A31515">'name'</font> =&gt; <font color="#A31515">'myMethod'</font> , <br> <font color="#A31515">'parameters'</font> =&gt; array( <br> array( <font color="#A31515">'name'</font> =&gt; <font color="#A31515">'myVar), <br> ), <br> '</font> body <font color="#A31515">'    =&gt; '</font> $ <font color="#0000ff">var</font> = <font color="#A31515">'hello world'</font> ; <font color="#A31515">' . "\n" . '</font> <font color="#0000ff">return</font> $ <font color="#0000ff">var</font> <font color="#A31515">', <br> '</font> docblock <font color="#A31515">'  =&gt; new Zend_CodeGenerator_Php_Docblock(array( <br> '</font> shortDescription <font color="#A31515">' =&gt; '</font>   <font color="#A31515">', <br> '</font> tags <font color="#A31515">'       =&gt; array( <br> new Zend_CodeGenerator_Php_Docblock_Tag_Param(array( <br> '</font> paramName <font color="#A31515">' =&gt; '</font> bar <font color="#A31515">', <br> '</font> datatype <font color="#A31515">' =&gt; '</font> <font color="#0000ff">string</font> <font color="#A31515">' <br> )), <br> new Zend_CodeGenerator_Php_Docblock_Tag_Return(array( <br> '</font> datatype <font color="#A31515">' =&gt; '</font> <font color="#0000ff">string</font> ', <br> )), <br> ), <br> )), <br> )</font> <br></code> </blockquote><br><br>  here 'name' is the name of the method <br>  'parameters' are incoming parameters, each new parameter is described by a new array, everything is exactly the same as for variables inside a class, and you can also use the Zend_CodeGenerator_Php_Parameter () class <br>  'body' is the body of the method where we put the code that will be executed inside the method in the bottom case it is, '$ var =' hello world ';'.  "\ n".  'return $ var', here it is worth noting that the code is not automatically formatted because you have to use "\ n" and "\ t" <br>  Docblocks in methods are specified the same as for classes. <br><br>  In the end, all that remains to be done is to generate the code and write it to a file. <br><blockquote> <code><font color="black">$code = $file-&gt;generate(); <br> file_put_contents( <font color="#A31515">'file.php'</font> , $code);</font> <br></code> </blockquote><br><br>  To do this, we use the standard php function - file_put_contents and the generate () method; <br>  Which is present in all the classes I described above in Zend_CodeGenerator <br>  If it is more convenient for you, you can generate each element in parts and write it to a file separately. <br><br>  Next, I will give a rather vivid example - a class that generates forms. <br><br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">&lt;?php <br> <font color="#0000ff">class</font> FormGenerator <br> { <br> <font color="#008000">/**</font> <br> <font color="#008000">*        mysql</font> <br> <font color="#008000">*  - input type  </font> <br> <font color="#008000">* */</font> <br> <font color="#0000ff">protected</font> $_values = array( <br> <font color="#A31515">'text'</font> =&gt; <font color="#A31515">'Textarea'</font> , <br> <font color="#A31515">'int'</font> =&gt; <font color="#A31515">'Text'</font> , <br> <font color="#A31515">'varchar'</font> =&gt; <font color="#A31515">'Text'</font> , <br> <font color="#A31515">'tinyint'</font> =&gt; <font color="#A31515">'CheckBox'</font> , <br> <font color="#A31515">'date'</font> =&gt; <font color="#A31515">'Text'</font> , <br> <font color="#A31515">'float'</font> =&gt; <font color="#A31515">'Text'</font> , <br> <font color="#A31515">'mediumint'</font> =&gt; <font color="#A31515">'Text'</font> , <br> ); <br> <font color="#008000">/**</font> <br> <font color="#008000">*    </font> <br> <font color="#008000">*   -   Zend_Db_Table</font> <br> <font color="#008000">* */</font> <br> <font color="#0000ff">public</font> <font color="#0000ff">function</font> generateForm(Zend_Db_Table $table) <br> { <br> <font color="#008000">//   </font> <br> $tableInfo = $table-&gt;info(); <br> <br> <font color="#008000">//  </font> <br> $className = <font color="#A31515">'Form_'</font> . ucfirst($tableInfo[ <font color="#A31515">'name'</font> ]); <br> <br> <font color="#008000">//     </font> <br> $folder = $_SERVER[ <font color="#A31515">'DOCUMENT_ROOT'</font> ] . <font color="#A31515">'/application/models/Form/'</font> ; <br> <br> <font color="#008000">//           </font> <br> $formClass = <font color="#0000ff">new</font> Zend_CodeGenerator_Php_Class(); <br> $formClass-&gt;setName($className); <br> $formClass-&gt;setExtendedClass( <font color="#A31515">'Zend_Form'</font> ); <br> <br> <font color="#008000">//  init</font> <br> $initMethodBody = <font color="#A31515">'parent::init(); <br> $helper = new Zend_View_Helper_Url(); <br> '</font> . <font color="#A31515">"\n\t\t"</font> ; <br> <br> <font color="#008000">//        generateElement()</font> <br> <font color="#0000ff">foreach</font> ($tableInfo[ <font color="#A31515">'metadata'</font> ] <font color="#0000ff">as</font> $field){ <br> Zend_Debug::dump($field); <br> $initMethodBody .= $ <font color="#0000ff">this</font> -&gt;generateElement($field[ <font color="#A31515">'COLUMN_NAME'</font> ], $field[ <font color="#A31515">'DATA_TYPE'</font> ]); <br> } <br> <br> <font color="#008000">//    submit</font> <br> $initMethodBody .= $ <font color="#0000ff">this</font> -&gt;generateSumitElement($tableInfo[ <font color="#A31515">'name'</font> ]); <br> $initMethod = <font color="#0000ff">new</font> Zend_CodeGenerator_Php_Method( <br> array( <br> <font color="#A31515">'name'</font> =&gt; <font color="#A31515">'init'</font> , <br> <font color="#A31515">'body'</font> =&gt;$initMethodBody <br> )); <br> <br> <font color="#008000">//    </font> <br> $formClass-&gt;setMethod($initMethod); <br> <br> <font color="#008000">//    </font> <br> $file = <font color="#0000ff">new</font> Zend_CodeGenerator_Php_File(array( <br> <font color="#A31515">'classes'</font> =&gt; array($formClass) <br> )); <br> <br> <font color="#008000">// </font> <br> $code = $file-&gt;generate(); <br> <br> <font color="#008000">//      </font> <br> <font color="#0000ff">if</font> (!file_exists($folder)) { <br> mkdir($folder); <br> } <br> <font color="#008000">//     </font> <br> file_put_contents($folder.ucfirst($tableInfo[ <font color="#A31515">'name'</font> ]) . <font color="#A31515">'.php'</font> , $code); <br> } <br> <br> <font color="#008000">/**</font> <br> <font color="#008000">*    </font> <br> <font color="#008000">*   -      mysql</font> <br> <font color="#008000">*   </font> <br> <font color="#008000">* */</font> <br> <font color="#0000ff">public</font> <font color="#0000ff">function</font> generateElement($name, $type) <br> { <br> $element = <font color="#A31515">'$'</font> . $name . <font color="#A31515">' = new Zend_Form_Element_'</font> . $ <font color="#0000ff">this</font> -&gt;_values[$type]. <font color="#A31515">"(\n\t\t"</font> <br> . <font color="#A31515">"'$name',"</font> . <font color="#A31515">" \n\t\t"</font> <br> . <font color="#A31515">"array("</font> <br> . <font color="#A31515">"'label' =&gt; '$name')); \n\t\t"</font> ; <br> <font color="#008000">//        Digits</font> <br> <font color="#0000ff">if</font> ($type == <font color="#A31515">'int'</font> || $type == <font color="#A31515">'tinyint'</font> || $type == <font color="#A31515">'mediumint'</font> ) { <br> $element .= <font color="#A31515">'$'</font> . $name . <font color="#A31515">'-&gt;addValidator("Digits", true);'</font> . <font color="#A31515">"\n\t\t"</font> ; <br> } <br> <br> <font color="#008000">//      StripTags</font> <br> <font color="#0000ff">if</font> ($ <font color="#0000ff">this</font> -&gt;_values[$type] == <font color="#A31515">'Textarea'</font> || $ <font color="#0000ff">this</font> -&gt;_values[$type] == <font color="#A31515">'Text'</font> ){ <br> $element .= <font color="#A31515">'$'</font> . $name . <font color="#A31515">'-&gt;addFilter("StripTags");'</font> . <font color="#A31515">"\n\t\t"</font> ; <br> } <br> <font color="#008000">//       StringTrim</font> <br> $element .= <font color="#A31515">'$'</font> . $name . <font color="#A31515">'-&gt;addFilter("StringTrim");'</font> . <font color="#A31515">"\n\t\t"</font> <br> . <font color="#A31515">'$this-&gt;addElement($'</font> . $name . <font color="#A31515">');'</font> . <font color="#A31515">"\n\n\t\t"</font> ; <br> <font color="#0000ff">return</font> $element; <br> } <br> <br> <font color="#008000">/**</font> <br> <font color="#008000">*   submit  </font> <br> <font color="#008000">*/</font> <br> <font color="#0000ff">public</font> <font color="#0000ff">function</font> generateSumitElement($name) <br> { <br> $element = <font color="#A31515">'$submit_'</font> . $name . <font color="#A31515">' = new Zend_Form_Element_Submit('</font> <br> . <font color="#A31515">"'submit_$name'"</font> . <font color="#A31515">"); \n\t\t"</font> <br> . <font color="#A31515">'$this-&gt;addElement($submit_'</font> . $name . <font color="#A31515">');'</font> ; <br> <font color="#0000ff">return</font> $element; <br> } <br> } <br></font> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  In general, there is a place where they can go wild, for example, if the data type in mysql is DATE, then you can bind it here, decorating it as a decorator, or make different validators for each data type.  Flight of fancy - not limited. <br><br>  In addition to forms, you can generate almost anything - controllers, models, thereby saving yourself from unnecessary work. <br>  Or use Zend_Tool + Zend_Application to generate the site structure and some of its classes from under the console of your operating system. <br>  Of course, the code generated in this way requires completion with a file, but still it will take less time than writing it from the very beginning. <br>  We are looking forward to the release of version 1.8, but for now we are dealing with innovations.  It seems to me that the developers of the Zend Framework in the release version will make a FormGenerator and many more goodies. <br><br>  PS: The author of the article is <a href="https://habrahabr.ru/users/gibbzy/" class="user_link">Gibbzy</a> . </div><p>Source: <a href="https://habr.com/ru/post/57609/">https://habr.com/ru/post/57609/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../57600/index.html">Small UserJS for Posters</a></li>
<li><a href="../57603/index.html">Interesting behavior Vkontakte</a></li>
<li><a href="../57605/index.html">Alternative DropCopy</a></li>
<li><a href="../57606/index.html">Announcement Defcon 17 CTF Qualifier</a></li>
<li><a href="../57607/index.html">Happiness is near - ExtJS 3 Designer is coming soon</a></li>
<li><a href="../57614/index.html">Megaphone has blocked some sim cards O'Light</a></li>
<li><a href="../57616/index.html">Photo report from the Imagine Cup 2009. Part One</a></li>
<li><a href="../57623/index.html">Do you have vision correction glasses and how often do you wear them?</a></li>
<li><a href="../57625/index.html">Let me be non orthodox</a></li>
<li><a href="../57626/index.html">Windows 7 RC came out</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>