<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Writing a class in php to interpret BrainLoller</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="(Example of a Brainloller code enlarged several times) 

 BrainLoller is a visual dialect of the Brainfuck language, in which character commands are r...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Writing a class in php to interpret BrainLoller</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/86e/319/f53/86e319f53a8ed3f8c918d565b29a4d5b.png"><br>  <font color="gray">(Example of a Brainloller code enlarged several times)</font> <br><br>  <b>BrainLoller</b> is a visual dialect of the Brainfuck language, in which character commands are replaced with pixels of different colors, readable from an image in * .png format. <br>  Brainloller was coined in 2005 by Lode Vandevenne. <br>  The colors of the teams were chosen as combinations of <b>0xFF</b> and <b>0x80</b> for three <b>RGB</b> components.  As a result, the following command table was obtained: <br><ul><li>  + = 0x00FF00 </li><li>  - = 0x008000 </li><li>  &gt; = 0xFF0000 </li><li>  &lt;= 0x800000 </li><li>  [= 0xFFFF00 </li><li>  ] = 0x808000 </li><li>  .  = 0x0000FF </li><li>  = 0x000080 </li></ul><br>  Two additional commands have also been added to <b>Brainloller</b> - <b>0x00FFFF</b> (turn the instruction pointer counterclockwise) and <b>0x008080</b> (turn clockwise).  Thus, the ‚Äúcode‚Äù can be written not in one line of pixels, but in a two-dimensional image.  Before starting the program execution, the instruction pointer is located in the upper left pixel and is directed to the right.  The image is processed pixel-by-pixel, after each command Brainfuck instructions instructions are shifted by one pixel in the direction in which it points.  Program execution ends as soon as the instruction pointer goes outside the image.  ( <a href="http://progopedia.ru/dialect/brainloller/">source</a> ) <br><br>  Unfortunately, the original set of tools for working with Brainloller was lost and we will try to fill the gap in this article) <br><a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h1>  Write class </h1><br>  To create a class, we need: <br><ul><li>  a test site that can execute php scripts (web host, local web server) </li><li>  GD library at the test site </li><li>  proper test image ( <img src="https://habrastorage.org/getpro/habr/post_images/dbd/65e/12d/dbd65e12d6e9d34e4b999b7252e10f98.png" alt="image">  save as hello-world.png) </li></ul><br>  Now we need some class for processing Brainfuck on php (there‚Äôs no need to fence bicycles, our class will simply turn the pixels into a set of ordinary Brainfuck commands (we will not consider the option when an infinite loop goes on the image)), for example, I saved this <a href="https://github.com/dotzero/BrainfuckInterpreter/blob/master/libs/brainfuck.php">one</a> and saved like brainfuck.class.php.  <font color="gray">This class issued a warning, so I recommend placing error suppression @ on line 79</font> <br>  You can proceed to coding.  We need to create a <b>brainloller.class.php</b> and <b>index.php</b> .  The first file will be the class that we are writing, the second will run it with a specific image. <br><br>  Now we proceed to the description of the class. <br>  Open brainloller.class.php and add <br><pre><code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BrainLoller</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> $picture; <span class="hljs-comment"><span class="hljs-comment">//    function __construct($picture){ //   $this-&gt;picture = imagecreatefrompng($picture); } function __destruct(){ imagedestroy($this-&gt;picture); //    } }</span></span></code> </pre> <br>  We create a class with a constructor and destructor in which we initialize the GD image.  The picture will be stored in $ picture. <br>  Now we need a function that will pass through the image getting the code, let's call it for example getCode (). <br>  After adding this function, the class will look like this. <br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> define(<span class="hljs-string"><span class="hljs-string">'DIRECTION_UP'</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); define(<span class="hljs-string"><span class="hljs-string">'DIRECTION_RIGHT'</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); define(<span class="hljs-string"><span class="hljs-string">'DIRECTION_DOWN'</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>); define(<span class="hljs-string"><span class="hljs-string">'DIRECTION_LEFT'</span></span>, <span class="hljs-number"><span class="hljs-number">3</span></span>); <span class="hljs-comment"><span class="hljs-comment">/*  - - 0 - - */</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BrainLoller</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> $picture; <span class="hljs-comment"><span class="hljs-comment">//  BrainLoller protected $pointer = DIRECTION_RIGHT; //       (0 = 'up', 1 = 'right', 2 = 'down', 3 = 'left') function __construct($picture){ //    $this-&gt;picture = imagecreatefrompng($picture); //    $size = getimagesize($picture); $this-&gt;size['w'] = $size[0]; $this-&gt;size['h'] = $size[1]; } public function getCode(){ $current_pixel = array(0, 0); //   (x, y) $this-&gt;pointer = DIRECTION_RIGHT; $code = ''; for(;;){ if($current_pixel[0] &gt; $this-&gt;size['w'] or $current_pixel[1] &gt; $this-&gt;size['h'] or $current_pixel[0] &lt; 0 or $current_pixel[1] &lt; 0) break; //        $pixel_color = imagecolorat($this-&gt;picture, $current_pixel[0], $current_pixel[1]); //    $pixel_color = array( ( ($pixel_color &gt;&gt; 16) &amp; 0xFF ), // Red ( ($pixel_color &gt;&gt; 8) &amp; 0xFF ), // Green ( $pixel_color &amp; 0xFF ), // Blue ); //      ,    ,      $code switch($pixel_color){ case array(0, 255, 0): // + $code .= '+'; break; case array(0, 128, 0): // - $code .= '-'; break; case array(255, 0, 0): // &gt; $code .= '&gt;'; break; case array(128, 0, 0): // &lt; $code .= '&lt;'; break; case array(255, 255, 0): // [ $code .= '['; break; case array(128, 128, 0): // ] $code .= ']'; break; case array(0, 0, 255): // . $code .= '.'; break; case array(0, 0, 128): // , $code .= ','; break; case array(0, 255, 255): // &lt;- if($this-&gt;pointer + 1 &gt; DIRECTION_LEFT) $this-&gt;pointer = 0; else $this-&gt;pointer += 1; break; case array(0, 128, 128): // -&gt; if($this-&gt;pointer - 1 &lt; DIRECTION_UP) $this-&gt;pointer = 3; else $this-&gt;pointer -= 1; break; } switch($this-&gt;pointer){ case DIRECTION_UP: $current_pixel[1] -= 1; break; case DIRECTION_RIGHT: $current_pixel[0] += 1; break; case DIRECTION_DOWN: $current_pixel[1] += 1; break; case DIRECTION_LEFT: $current_pixel[0] -= 1; break; } } return $code; } function __destruct(){ imagedestroy($this-&gt;picture); //    } }</span></span></code> </pre><br>  There is an infinite loop in the function that processes each pixel. <br>  First, we check if we have gone beyond the limits of the image, because by the condition the image output is the end of the program. <br>  Then we get the color of the pixel in the RGB format, and check which command it is attached to. <br>  If the color is attached to the brainfuck code command, then we add this command to the final listing code, if the color is a rotation command, then turn the pointer. <br>  Then looking at which direction the pointer is looking at - move the pixel address (move further in the direction of the pointer's look). <br>  When the cycle ends, it means that we have gone beyond the image and we need to return the resulting code for further interpretation by another class. <br><br>  Create a handler in <b>index.php</b> <br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-keyword"><span class="hljs-keyword">require</span></span> <span class="hljs-string"><span class="hljs-string">'brainloller.class.php'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">require</span></span> <span class="hljs-string"><span class="hljs-string">'brainfuck.class.php'</span></span>; $brainloller = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> BrainLoller(<span class="hljs-string"><span class="hljs-string">'hello-world.png'</span></span>); $brainfuck = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Brainfuck($brainloller-&gt;getCode(), <span class="hljs-number"><span class="hljs-number">1</span></span>); $brainfuck-&gt;run();</code> </pre><br>  Here we load both classes and create instances of them.  After that, we receive a brainfuck code from our class and pass it on to an interpretation to another class, from a third-party author <font color="gray">(Again, I recommend at least not reinventing bicycles, as much as possible to improve existing solutions if they are written correctly and the author goes to contact)</font> <br><br>  The final code can be <a href="https://github.com/Fedcomp/brainloller-php">uploaded to the githab.</a>  ( <a href="http://rghost.ru/21148691">mirror</a> ) <br><br><h1>  PS </h1><br>  <b>What else can you play with?</b> <br><ul><li>  Zayuzat new php 5.3 chip by making a static method that will return the code without creating a class (for example, BrainLoller :: getCode ('picture_url')) </li><li>  Make a threshold for the cycle so that it does not last forever (in some images you can never exit (you need to add a limit to for)) </li><li>  Make a class for creating BrainLoller images (for example, define a character that will expand the row pointer clockwise / Counterclockwise, and thus with a small remake of the brainfuck code you can directly turn the code into a picture and vice versa) </li><li>  Optimize this code (Surely you could write more compact) </li></ul></div><p>Source: <a href="https://habr.com/ru/post/128539/">https://habr.com/ru/post/128539/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../128534/index.html">Analysis of static C ++ code analysis tools</a></li>
<li><a href="../128535/index.html">Simple implementation of the long polling mechanism in PHP</a></li>
<li><a href="../128536/index.html">Text localization features</a></li>
<li><a href="../128537/index.html">Windows 8 as part of a new personal computing device concept</a></li>
<li><a href="../128538/index.html">Another Monad Guide (part 3: Monad Laws)</a></li>
<li><a href="../128541/index.html">Image enhancement based on Matlab frequency filtering</a></li>
<li><a href="../128543/index.html">Asynchronous unit testing for C ++</a></li>
<li><a href="../128545/index.html">Graduate and Postgraduate Studies in Japan</a></li>
<li><a href="../128546/index.html">ProfitConf - conference of web developers in Novosibirsk on September 25-26</a></li>
<li><a href="../128548/index.html">A dream to get to the states - how it came true ...</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>