<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Should you use Google AppEngine?</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Disclaimer : This article is not about "how smart I am and how stupid Google is." This article is about some non-obvious problems and features of Goog...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Should you use Google AppEngine?</h1><div class="post__text post__text-html js-mediator-article">  <b>Disclaimer</b> : This article is not about "how smart I am and how stupid Google is."  This article is about some non-obvious problems and features of Google AppEngine (GAE) that would be nice for those who want to start working with the ‚Äúevil empire‚Äù :-) <br><br><img src="http://pause.appspot.com/pause"><br>  Google has done a lot of great things - search, mail without spam ... Google gets a bunch of our private data, but we continue to use it because it works so well ... <br>  Some time in IT circles there was quite a bit of noise about AppEngine, and I decided to try working with him in my new project. <br><br>  I chose Python with the Google framework to get the best compatibility and speed.  I started with performance tests, and the results were ... <a name="habracut"></a>  somewhat disappointing. <br><table><tbody><tr><td>  <b>Test</b> </td><td>  <b>Requests per second</b> </td></tr><tr><td>  print 'Hello world' </td><td>  260 </td></tr><tr><td>  1 reading from Datastore, writing to Datastore </td><td>  38 </td></tr><tr><td>  1 reading from the Datastore </td><td>  60 </td></tr><tr><td>  10 readings from Datastore, 1 record </td><td>  20 </td></tr><tr><td>  1 reading from memcached, 1 writing to memcached </td><td>  80 </td></tr><tr><td>  1 reading from memcached </td><td>  120 </td></tr><tr><td>  Normal LAMP application, 6 SQL queries, <a href="http://3.14.by/">http://3.14.by/</a> </td><td>  240 on the Atom 330 server <br>  198 at shared hosting for $ 7 </td></tr></tbody></table><br>  The test was conducted on 20 parallel requests from two different servers on the same continent, the figures were average for 7 seconds of execution (later I hammered and 10 minutes each).  Some may say: ‚ÄúHey!  The results are not so bad, my [insert URL here] can process only 2 requests per second, so even 20-38 is not bad. ‚Äù  I would say that this is the simplest application of a couple of lines; in this application, you will need 5-25 requests for data per page.  Well, the classic LAMP Web applications that do not show 100 requests per second should be sent straight to the dump: crazy: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      In addition, in test 10 readings 1, the error 'Error: Server Error' fell off if more than 10 parallel requests were used (the internal error was 'too much contention on these datastore entities. Please try again') - one of the examples of unexpected exceptions on level ground. <br><br><h1>  Scalability </h1><br>  I expected that at some point GAE would distribute my application to more than 1 server (at least it should have been in theory).  However, after 10 minutes of stress testing and spending 10% of the daily quota on the CPU, the speed remained exactly the same.  Probably GAE does not scale applications so quickly. <br><br><h1>  Sources </h1><br>  quite simple: <br><blockquote>  from google.appengine.ext import db <br><br>  class Counter (db.Model): <br>  nick = db.StringProperty () <br>  count = db.IntegerProperty () <br><br>  res = Counter.gql ("WHERE nick = 'test3'") <br>  print 'Content-Type: text / html' <br>  print '' <br>  print '&lt;html&gt; &lt;body&gt; &lt;h1&gt; This is a datastore performance test &lt;/ h1&gt;' <br>  print 'it &lt;h2&gt; it reads a counter and it‚Äôs value in datastore &lt;/ h2&gt;' <br>  for v in res: <br>  v.count = v.count + 1 <br>  print 'New counter value:', v.count <br>  # v.put () <br>  print '&lt;/ body&gt; &lt;/ html&gt; <br></blockquote><br><br>  The application is flooded here: <a href="http://mafiazone-dev.appspot.com/">http://mafiazone-dev.appspot.com/</a> . <br><br>  In general, really, everything works as Google promises - speed does not depend on scale, slowly on a small scale, slowly and on a large one :-) Even one request for something that requires working with a Datastore or several Memcached - takes a lot of time .  Well, if you need to make several requests per page - your chances of seeing the exception will increase dramatically by timeout. <br><br>  Regular LAMP applications (like my home page) can easily serve 10'000'000 hits per day, and after tighter optimization, even 30'000'000 (an average of 500 hits per second at 8-10 peak hours).  Do many projects require at least 10% of this load?  And what if 0.01% of these requests fall off due to some kind of exception that you couldn‚Äôt or didn‚Äôt manage to process? <br><h1>  General list of problems in my opinion </h1><br>  If you are going to work with Google AppEngine, you need to keep in mind the following: <br><ul><li>  Any appeal to Datastore may accidentally fall off with a small chance.  Google says that the chance of this has decreased from 0.4% to 0.1, but it still remains.  Datastore was not designed as a classic database - response for the expected time is not guaranteed.  And you cannot handle all possible exceptions, since  All this requires CPU time, and it is limited. </li><li>  Memcached is not the memcached you are used to.  Here it is quite slow (hundreds of operations per second, instead of the usual tens of thousands). </li><li>  You will have to find a place to store static.  You can not distribute large files from GAE, and besides, it is not very fast and quite expensive. </li><li>  There are reviews that URLFetch is not reliable enough.  I think this will be fixed over time :-) </li><li>  You cannot select a datacenter.  For example, if you live in Europe, and GAE launches your application in the US, users will feel that everything is somewhat slow, and you cannot move the application to Europe.  It will transfer itself, but when it is not known.  Mine was not transferred after all my benchmarks. </li><li>  Google can serve an unlimited number of requests, but each request is at least 100-200ms, and your application will never ‚Äúfly‚Äù.  And do not forget that you need to write additional code to service new unexpected exception. </li><li>  Google assures that free limits will be enough for several million requests.  However, in my simplest examples I spent 0.65 CPU hours per 15k requests, i.e.  only 150k hits per day.  Accordingly, the paid service is somewhat more expensive than you can imagine.  Probably, these millions are achievable only on 100% static pages. </li><li>  Google may say a lot about the fact that this is an open-source solution, but it is not.  The key technologies are closed, and the SDK test server seems intentionally made super-braking (only 2 requests per second for Core2Duo 3.6Ghz).  So no competition, either reconcile with the service, or rewrite everything with 0. </li></ul><br><br><h1>  So that I want to see in GAE differently: </h1><br><ul><li>  Much more deterministic behavior.  If I go beyond the limits, I'd rather get a warning in the mail than throw an exception, which I potentially won't have time to handle. </li><li>  Datastore &amp; Memcached performance is much better.  Probably memcached is common here, and overwhelmed with requests, and therefore slowly ... </li><li>  Choice of data center </li><li>  Cluster-aware API.  It would be nice to have a small piece of very fast memory on the local server, with the event ‚Äúinitialize storage‚Äù and ‚Äúrelease storage‚Äù. </li></ul><br><br><h1>  More thoughts </h1><br>  Some time ago I was working with a very cool technology - everything was redundant and super-reliable, ‚Äúcloudy‚Äù, convenient API, but with it the rendering of the forum page took 4 seconds on a 4-processor server.  It was complete shit.  If the technology slows down or the user is not comfortable with it - this technology is complete crap.  Using technology just because ‚Äúit's cool‚Äù is somehow stupid. <br><h1>  Where Google App Engine can be used and where not </h1><br>  GAE is excellent for simple read-only (i.e., without complex database logic, small amounts of data) of applications WITHOUT peak loads (i.e., it may not be able to scale on the fly).  Your homepage will just fit perfectly on GAE with zero support costs. <br><br>  This is not suitable for complex applications, where there is a lot of logic, a lot of data on the screen, and there are occasionally shashdot / habr effects.  Google AppEngine may not be able to handle an unexpected peak of several hundred requests per second. <br><br><h1>  Conclusion </h1><br>  Does this all mean that progers and Goggle architects are stupid?  : crazy: Not at all, in fact, under such conditions it would be difficult to achieve the best.  It is really difficult to achieve unlimited scalability for applications that are not sharpened specifically for the cluster.  As a result, most applications will not be able to work properly on GAE. <br><br>  But if your application gets along well with the features and limitations of GAE, and you are satisfied with the performance and likelihood of errors - I think this will be the best solution for you. <br><br>  Lies <a href="http://3.14.by/ru/read/why-google-appengine-sucks">here</a> .  And <a href="http://3.14.by/en/read/why-google-appengine-sucks">then</a> - in English. </div><p>Source: <a href="https://habr.com/ru/post/70252/">https://habr.com/ru/post/70252/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../70245/index.html">Perpetual motion machine</a></li>
<li><a href="../70246/index.html">Introducing Adobe Pixel Bender (Part 1)</a></li>
<li><a href="../70249/index.html">Screwing ajax file uploads in asp.net mvc using jQuery plugins</a></li>
<li><a href="../70250/index.html">Rip patterns! The store is punished!</a></li>
<li><a href="../70251/index.html">You offer to do something that infuriates other sites. Money is good. The work is fiddling.</a></li>
<li><a href="../70254/index.html">Paint.net v3.5 Beta 1</a></li>
<li><a href="../70257/index.html">Milky Way</a></li>
<li><a href="../70259/index.html">Text-shadow property</a></li>
<li><a href="../70262/index.html">How I interview programmers</a></li>
<li><a href="../70264/index.html">How to make ice instantly!</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>