<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Countdown: a book about Stuxnet, malware researchers and vulnerable critical infrastructure</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Well, it's time to try yourself in the genre of the book review. The book Countdown to Zero Day: Stuxnet and the Launch of Worlds First Digital Weapon...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Countdown: a book about Stuxnet, malware researchers and vulnerable critical infrastructure</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/1e5/b33/4c0/1e5b334c03244ca5860fa565fac2459c.jpg" align="right">  Well, it's time to try yourself in the genre of the book review.  The book Countdown to Zero Day: Stuxnet and the Launch of Worlds First Digital Weapon journalist Kim Zetter, best known for her articles <a href="https://www.wired.com/author/KimZetter">in Wired magazine</a> , was published quite a long time ago, in November 2014, but has not been translated into Russian since. (available in English, for example, in Amazon in <a href="https://www.amazon.com/Countdown-Zero-Day-Stuxnet-Digital-ebook/dp/B00KEPLC08/ref%3Dsr_1_1_twi_kin_2%3Fie%3DUTF8%26qid%3D1474277353%26sr%3D8-1%26keywords%3Dcountdown%2Bto%2Bstuxnet">electronic form</a> ).  However, the matter is not in translation: the Stuxnet history can also be studied from open publications and research by security experts, but in this case you will receive a range of technical facts about malicious code, from which it is not so easy to put together the puzzle of the whole story. <br><br>  ‚ÄúCountdown‚Äù is a successful attempt to rise above the lines of code, to bring together everything that is known about the first and to this day the most large-scale specialized attack on industrial systems.  At the same time, the book does not replace facts with a drama and is as far as possible from fiction.  Its value is also in the fact that it shows the process of researching malicious code in a little more detail than usual: about half of the text is dedicated to this: from detecting code and identifying an attack, to analyzing zero-day vulnerabilities and, finally, analyzing modules that modify industrial controllers. <br><br>  Six years have passed since the discovery of Stuxnet, seven years since the beginning of the attack, more than ten, presumably from the beginning of development.  This is not the only cyber attack aimed at sabotage in industrial systems, but it still has no equal in complexity.  This is partly good news, but the reason is not the increased security of industrial systems, but rather the change of reference points from customers.  ‚ÄúCountdown‚Äù is a book about an attack, which was once called a ‚Äúblockbuster‚Äù of information security, but it is also a book about the work of researchers - those who analyze malicious code and design protection against it, regardless of the source of the attack and intentions. <br><a name="habracut"></a><br><h3>  Format </h3><br>  Kim Zetter almost immediately goes from describing events at the Iranian uranium enrichment factory, based on data from the international organization <a href="https://ru.wikipedia.org/wiki/%25D0%259C%25D0%25B5%25D0%25B6%25D0%25B4%25D1%2583%25D0%25BD%25D0%25B0%25D1%2580%25D0%25BE%25D0%25B4%25D0%25BD%25D0%25BE%25D0%25B5_%25D0%25B0%25D0%25B3%25D0%25B5%25D0%25BD%25D1%2582%25D1%2581%25D1%2582%25D0%25B2%25D0%25BE_%25D0%25BF%25D0%25BE_%25D0%25B0%25D1%2582%25D0%25BE%25D0%25BC%25D0%25BD%25D0%25BE%25D0%25B9_%25D1%258D%25D0%25BD%25D0%25B5%25D1%2580%25D0%25B3%25D0%25B8%25D0%25B8">IAEA</a> , to the detection of a malicious program by experts from the Belarusian company VirusBlokAda, and here Kim Zetter had to decide on the narrative format.  It is impossible to tell the story of Stuxnet without resorting to technical terms, but if you go deep into technology, there is a chance to lose a reader who is not related to the information security industry (that is, almost all readers).  At least at the beginning of the book, a sacrifice to an imaginary cyberpunk deity still has to be brought, and it looks like this: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Stuxnet used a zero-day vulnerability in Microsoft Windows, so it could be distributed on USB-drives.  And zero-day vulnerability is ... <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/482/754/0f5/4827540f5aa14d9abaef48b08c4f5bbd.jpg"></div><br><br>  To hide infected files on a flash drive, a rootkit was installed on the system, and the rootkit is ... <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/79f/f83/284/79ff8328428e42aeb8859d7b98356dd4.jpg"></div><br><br>  The malicious code was signed by digital certificates that were legitimate at that time, so that the installation was as transparent as possible to the user.  And digital certificates are ... <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/29b/42f/8c8/29b42f8c83064961ae404789a7a96840.jpg"></div><br><br>  And so on.  Since the book is based on numerous interviews with researchers, Kim Zetter eventually brings a significant part of the facts in the footnotes, they sometimes take up no less space than the chapter relating to them.  In the future, in the book, virtually all of the furious factology is there: you are given the choice to read the whole or skip the clarifications.  In the latter case, the perception of the plot does not suffer, and thanks to the footnotes with a huge number of references to sources, the book turns out to be equally attractive for techies and for humanities scholars. <br><br><h3>  Ziro day </h3><br>  To infect, Stuxnet used the zero-day vulnerability in Windows operating systems - at the time of detection (July 2010, a <a href="https://technet.microsoft.com/library/security/ms10-046">bulletin</a> on Technet) all current versions from XP to 7, 32 and 64-bit were exposed to it (Stuxnet attacked only 32-bit OS ).  The vulnerability allowed launching malicious code using a prepared .LNK file or .PIF file. If it was placed on a USB flash drive, the vulnerability was automatically activated.  It is this type of vulnerability allowed to attack the industrial system of critical importance, which is usually (but not necessarily) isolated from the network.  Subsequently, our experts published an <a href="https://securelist.ru/analysis/obzor/24277/stuxnet-pervye-zhertvy/">analysis of the</a> first victims of Stuxnet, through which successful attempts to reach the main goal were likely made.  The analysis became possible due to the preservation inside the malicious code of information about previously attacked systems. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/9e7/4ec/e83/9e74ece832754070b69446d3df72d857.png"></div><br><br>  Vulnerability was discovered only through the detection and investigation of Stuxnet.  The use of zero-day vulnerabilities has become a feature of complex attacks.  But over the past time, the situation has changed - not every successful targeted attack uses zero-days.  Effective exploration and exploration of potential victims makes the use of similar, very expensive and quickly disclosed tools optional.  Actually, in the Stuxnet investigation, the fact of using the zero-day vulnerability was established first of all, much more time and effort was needed for the analysis of the "payload". <br><br>  In addition to the LNK vulnerability, Stuxnet used the <a href="https://technet.microsoft.com/en-us/library/security/ms08-067.aspx">MS08-067</a> vulnerability and another zyrodey, a hole in the Print Spool Service system ( <a href="https://technet.microsoft.com/library/security/ms10-061">MS10-061</a> ).  Notably, the first vulnerability was also used by the <a href="https://en.wikipedia.org/wiki/Conficker">Conficker</a> worm, which caused a serious epidemic in 2008.  The strange purpose of this malware in the light of Stuxnet even led to speculations that it was some kind of test-drive technology in the real world, but in fact the connection between these two attacks looks dubious. <br><br><h3>  Attribution </h3><br>  Who stood on the attack of Stuxnet is not known for certain.  A significant part of Kim Zetter's book is devoted to attribution in its two senses: when the connection with some people, events or other attacks is derived from the malicious code, and when the ‚Äúauthors of the event‚Äù confirm the authorship of the attack.  With the second, in fact, everything is not very good: despite the mass of statements and arguments from various parties, it is impossible to reliably prove involvement in the development of Stuxnet of any country, and, most likely, the situation will not change for many years.  Here, the ‚ÄúCountdown‚Äù narrative loses a bit of rhythm, despite the equally painstaking work done by the author to collect data from various sources. <br><br>  But the attribution in the code analysis process is an interesting thing.  As one of the first examples, there is a line from the Stuxnet code: <br><br><pre><code class="hljs tex">b:<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">myrtus</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">src</span></span></span></span><span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">objfre</span></span></span></span>_w2k_x86<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">i</span></span></span></span>386<span class="hljs-tag"><span class="hljs-tag">\</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">guava</span></span></span></span>.pdb</code> </pre> <br>  If you temporarily distract from reverse engineering and study (for a change) the Old Testament, you can see in this line a reference to the Jewish holiday of Purim, which means it may be some kind of transparent hint at the authorship of the code.  What just do not have to do the researchers.  In fact, the presence in the code of the line with the original path to one of the files on the developer‚Äôs machine could have been left intentionally to confuse the traces.  Another version that ‚Äúmyrtus‚Äù is not at all ‚Äúmyrtle‚Äù and a hint, but just an abbreviation of ‚Äúmy remote terminal units‚Äù. <br><br><h3>  Followers </h3><br>  But evidence of a connection between Stuxnet and the later discovered attacks by Duqu and Flame was ample.  In the case of <a href="https://securelist.ru/blog/intsidenty/2172/duqu-faq/">Duqu</a> , the same platform was clearly used as for Stuxnet.  <a href="https://securelist.ru/blog/intsidenty/2962/flame-chasto-zadavaemy-e-voprosy/">Flame is</a> not related to the Stuxnet / Duqu codebase, but used the same vulnerabilities, including a hole in the Print Spool Service.  Both attacks were analyzed in as much detail as possible by the specialists of the Laboratory, and the book in the respective chapters uses information from interviews with our experts.  Curiously, Duqu and Flame had no destructive functions and were used primarily for cyber espionage.  Given the focus of almost all complex attacks since the discovery of Stuxnet, information is valued above sabotage.  This, however, does not mean that industrial facilities are now safe. <br><br><h3>  Imaginary complexity of critical infrastructure </h3><br>  Understanding exactly what Stuxnet's main goal was was not easy ‚Äî the researchers simply had no experience with SCADA systems.  The book describes in detail exactly how this part of the code was analyzed: Stuxnet, in the event of a system infection with a specific software, could control the controllers of a strictly specified model, and thus alter the rotation speed of the centrifuges (presumably) at the facility in Iran so that they would fail from excessive load.  Details of the logic of Stuxnet work in this direction was investigated by Symantec specialists (report in <a href="https://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/w32_stuxnet_dossier.pdf">PDF</a> ).  Interestingly, to detect attacks and protect computers even in the absence of (for several weeks) a patch for Microsoft's vulnerabilities, knowing what Stuxnet was doing was not necessary.  Such information is important only in the context of preparation for repelling future attacks of this type. <br><br>  Kim Zetter devotes a separate chapter to the safety of industrial IT systems in general.  Examples are given, albeit incomparable in scale to Stuxnet, sabotaging similar objects with the help of malicious code or by intercepting control systems.  The fact that the industrial infrastructure is already sufficiently computerized to be vulnerable, but still not sufficiently protected, has been known for a long time.  Alas, it is impossible to say that Stuxnet radically and irrevocably changed the situation for the better: very often the operators of critical objects rely on the isolation of control systems, and on the complexity of proprietary protocols.  There are also objective difficulties: a long cycle of equipment operation, specific requirements for hardware and software, the belonging of industrial IT systems and traditional computer infrastructure to different teams within one company, and inevitable problems at the interfaces.  However, Stuxnet clearly attracted the attention of cybersecurity researchers to the problem: since 2012, according to <a href="https://securelist.ru/analysis/obzor/28866/industrial-cybersecurity-threat-landscape/">our report</a> , the number of detected and closed vulnerabilities in specialized software has increased significantly.  On the other hand, the same report shows how the search through Shodan this year allows you to find more than 180,000 hosts with elements of SCADA-systems that are directly accessible through the network. <br><br><h3>  findings </h3><br>  In my opinion, the Stuxnet story, described in its most comprehensive manner in the book ‚ÄúCountdown to Zero Day‚Äù, allows us to draw several important conclusions that are relevant to attacks (and to protect against them) of today's day: <br><br>  - The authors of even the most advanced cyber attacks make mistakes.  Most likely, as a result of an erroneous action at a certain stage, there was a massive infection of thousands of systems in different countries, which made it possible to notice and analyze the malicious code (however, there is a version that this was done intentionally).  Moreover, for the first time, the Stuxnet sample was discovered due to a complaint about a computer that was constantly rebooting - something went wrong during the infection process.  Here lies the danger of developing dangerous cyber weapons: methods of attack sooner or later become widely known, and tools may fall into the wrong hands. <br><br>  - You can not rely on the complexity of systems and protocols.  The concept of security through obscurity was ultimately recognized as ineffective by Stuxnet.  Yes, it took a lot of manpower and resources to develop this attack (according to some estimates, from 5 to 30 developers and at least 6 months of work), and yes, at first the researchers faced difficulties in analyzing specialized code for the process control system.  The parallel experience of analyzing attacks on financial systems since last year shows that even the most complex systems can be hacked, and control over them can be used to cause damage. <br><br>  - The information security industry effectively fights complex attacks only when working together.  The study of Stuxnet, as well as Duqu and Flame, involved many vendors of security solutions and independent researchers.  Analyzing someone else's code is difficult and time-consuming, even for highly skilled professionals.  Stuxnet was one of the first examples when cooperation and public sharing of results allowed for faster research and development of protection.  Fortunately, this is not the last example, but the interaction of the ‚Äúsecurity men of the whole world‚Äù still needs to be worked on. <br><br>  - The history of complex and most destructive cyber attacks with the detection of Stuxnet has not ended, but has just begun.  Our <a href="https://apt.securelist.com/">map of advanced attacks</a> is a clear proof of this.  Although the theft of information is the priority objective of the attackers, it is impossible to forget about the protection of industrial systems and critical infrastructure - if only because even single successful operations at such facilities can lead to enormous damage.  Despite the complexity of industrial systems, resources are needed for their research from a security point of view and adequate protection methods. <br><br>  - And finally, being a cyber threat researcher is cool.  The book by Kim Zetter is a rare case when, in addition to the lines of code and conclusions, the work of security experts is shown in an accessible form by the example of a very real attack.  Such activities are very difficult to describe popularly, but, given the number of threats and their complexity, the maximum penetration of digital systems into our everyday life, we need to do this more and more often. <br><br>  <i>Disclaimer: This column is based on real events, but still reflects only the personal opinion of its author.</i>  <i>It may coincide with the position of Kaspersky Lab, or it may not coincide.</i>  <i>Then how lucky.</i> </div><p>Source: <a href="https://habr.com/ru/post/310398/">https://habr.com/ru/post/310398/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../310384/index.html">The Macro: Corporate Commerce Guide for Y Combinator Residents</a></li>
<li><a href="../310386/index.html">Improve the work of the largest media about online business with the help of a customized referral system</a></li>
<li><a href="../310390/index.html">Removing Service Routing Mess With Docker</a></li>
<li><a href="../310392/index.html">CTRL + G - hot key, completely changed the principle of my work</a></li>
<li><a href="../310396/index.html">Collaboration with documents: SharePoint 2016, Office Online and all-all-all. Part 1. What is it?</a></li>
<li><a href="../310402/index.html">Ontodia + Cach√© - an ontology visualizer for navigating InterSystems Cach√© stored entities</a></li>
<li><a href="../310404/index.html">How I Made a Game of Indians of Central America</a></li>
<li><a href="../310406/index.html">Many-to-many attitudes without a third table in PostgreSQL using Elixir Ecto</a></li>
<li><a href="../310414/index.html">A person. Michael Dell's dream come true</a></li>
<li><a href="../310418/index.html">101 ways of making RabbitMQ and a bit about pipeline architecture</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>