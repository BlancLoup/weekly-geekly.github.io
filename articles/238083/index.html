<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Automatic recovery of disk partitions using Ghost</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Virtually every new laptop now has a recovery system that works when the operating system fails to boot several times in a row. Great idea: a regular ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Automatic recovery of disk partitions using Ghost</h1><div class="post__text post__text-html js-mediator-article">  Virtually every new laptop now has a recovery system that works when the operating system fails to boot several times in a row.  Great idea: a regular user who does not go into the subtleties of his computer and operating system, is now free from the need to contact a service center, which saves him time and money. <br><br>  However, the implementation of this idea turned out to be such that it would have been better if the recovery system did not exist at all.  Firstly, with regular restoration, user data is lost, which, in principle, is expected.  Secondly, the recovery process is indecently time consuming.  On a computer with a hard drive in 1TB, the process went 8 hours and it is not known how long he would have walked if I had not interrupted him.  How to deal with this disgrace, you will learn under the cut. <br><a name="habracut"></a><br>  If you are regularly approached by relatives and friends who themselves are not able to roll out the image, with a request to reinstall the operating system, then here is the way out. <br>  It may also be interesting to incoming system administrators serving organizations with small networks, since  You can significantly save time on trips to these same organizations.  Now there are a huge number of parasitic programs that can transform the OS even in the absence of administrative rights, despite the presence of an antivirus. <br><br>  At first, I wanted to use Linux + dd to restore partitions, but refused this idea, because  dd creates too large images (even if archived) and the speed of backup \ recovery is much inferior, for obvious reasons, to software that file systems understand.  The choice fell on ghost (dos), because  It supports startup keys on the command line, which allows you to restore a partition with a single click. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Now how to do it all.  First of all, you need to determine the size of the partition under the system.  In my case, the hard drive was broken as follows: <br><br>  1. 50 GB for the main system. <br>  2. 20 GB under the partition for the image. <br>  3. The remaining space for data. <br><br>  The second partition was formatted in ntfs but was not mounted on the system, in order to avoid deleting the image.  The user folders were moved to the third section, so it turned out that after recovery, everything that was in ‚Äúmy documents‚Äù remained in place. <br><br>  So, after installing the system (win 7 in my case), software and disabling the second section, it was necessary to make a copy of the section, and to do this, run Ghost.  It turned out that the seven loader may well be loaded from diskette images and in some cases from cd / dvd images.  I downloaded the floppy image with dos-6.22 <a href="http://old-dos.ru/files/file_64.html">from here</a> .  Unpacked the image, created a new one, adding ghost.  You can download my image <a href="">from here</a> . <br><br>  The easiest way to boot from this image is to use the EasyBCD utility: <br><br><img src="https://habrastorage.org/files/de0/31e/59d/de031e59d498473da91a94a0aaff8f8e.jpg" alt="image"><br><br>  After the reboot, an additional item will appear in the boot menu with the name that was specified in EasyBCD when creating a new record.  Booting from this image, you can run ghost and make a backup of the system partition.  Suppose that the image is on the second partition and is called system.gho.  For automatic deployment, you need to prepare a second boot image of the floppy disk, which will differ from the first one only by the contents of the autoexec.bat file: <br><br><pre><code class="dos hljs">ghost.exe -clone,<span class="hljs-built_in"><span class="hljs-built_in">mode</span></span>=pload,src=<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">2</span></span>\system.gho:<span class="hljs-number"><span class="hljs-number">1</span></span>,dst=<span class="hljs-number"><span class="hljs-number">1</span></span>:<span class="hljs-number"><span class="hljs-number">1</span></span> -fx -sure -rb</code> </pre> <br><br>  This line is inserted at the end of the autoexec.bat file. <br>  Src key: <br>  1: 2 - the first disc, the second section <br>  system.gho: 1 - the name of the image and the partition inside the image. <br>  In this case, it is there alone, but it is possible to restore a specific partition from the image of the entire disk. <br>  Dst key <br>  1: 1 - the first section of the first disk. <br>  Key fx terminates the application after the end. <br>  The sure key allows you to perform a recovery in automatic mode, without answering questions like "Are you sure that ...?". <br>  The rb key restarts the computer after the application is shut down. <br><br>  Please note that my system is installed on the first partition, without creating a windows boot partition.  If there is a boot partition, then you must add 1 to the partition numbers in the startup parameters. <br><br>  Also in autoexec.bat before starting ghost, you can add protection from unwanted recovery, when the wrong item was selected in the boot menu. <br><pre> <code class="dos hljs"><span class="hljs-built_in"><span class="hljs-built_in">set</span></span> /P var="Destination Drive will be permanently overwritten. Proceed? (yes/no) : " <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> "<span class="hljs-variable"><span class="hljs-variable">%var%</span></span>"=="yes" <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span> /b <span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre><br>  If the floppy image has reboot.com, you can use it instead of exit. <br><br>  The second image must be added to the download in the same way as the first. </div><p>Source: <a href="https://habr.com/ru/post/238083/">https://habr.com/ru/post/238083/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../238071/index.html">About creating platformer on Unity. Part Three, the long-awaited</a></li>
<li><a href="../238073/index.html">Customs duties on the package still to be, and soon</a></li>
<li><a href="../238075/index.html">How does friendship begin with Active Directory</a></li>
<li><a href="../238077/index.html">Expandable mappings of any type of value without using macros</a></li>
<li><a href="../238079/index.html">Illusion of impressions: symbols of the future</a></li>
<li><a href="../238085/index.html">Panasonic's smart mirror gives tips on how it looks</a></li>
<li><a href="../238087/index.html">Why I wrote a plugin for Maven</a></li>
<li><a href="../238089/index.html">The main marketing chips in the SaaS project</a></li>
<li><a href="../238091/index.html">Memory addresses: physical, virtual, logical, linear, efficient, guest</a></li>
<li><a href="../238093/index.html">azexo</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>