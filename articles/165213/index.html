<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Touch-web: Swipe</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this post, we continue a series of articles on the development of web interfaces for touch devices. 

 Touchscreen smartphones are quite common and...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Touch-web: Swipe</h1><div class="post__text post__text-html js-mediator-article">  In this post, we continue a series of articles on the development of web interfaces for touch devices. <br><br>  Touchscreen smartphones are quite common and have become indispensable helpers for many of us.  Therefore, one can not ignore their features in the development of mobile web interfaces. <br>  Touch control is significantly different from the usual mouse control. <br>  The user interacts with the fingers of the screen itself.  And depending on what movements and how many fingers the user makes, the interface reacts differently: if you quickly touch the screen and release your finger, then click is triggered;  if you touched and ran your finger across the screen - scroll;  if held with two fingers - zoom;  and a great many other reaction options. <br><br>  Today we will talk about the swipe, in the common people - listals.  Swipe allows you to flip through the "pages" with the usual movement of your finger.  I will tell you how to correctly implement the swipe using the example of a news block on the main page of the Mail.Ru portal. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/storage2/c81/a8b/8a8/c81a8b8a80e00de7535321643c4584c7.jpg"><br><br><a name="habracut"></a><br><br>  Let's start with the key points that you need to pay attention to when developing listals: <br><ul><li>  First, you need to determine exactly what the user wants - turn the block page or scroll </li><li>  Secondly, you need to move the page when you move your finger behind it. </li><li>  Thirdly, if there is nowhere to scroll, you need to let the user understand </li><li>  Fourth, respond to touch only with the first finger </li><li>  And finally, turn the page in the right direction, when the user released his finger </li></ul><br><br><h4>  Touch events </h4><br>  The following events are implemented specifically for working with touch input devices in browsers: <br><ul><li>  touchstart - touched with a finger </li><li>  touchmove - finger up </li><li>  touchend - let go of your finger </li><li>  and touchcancel is almost like a touchend, but it happens at the moment when we did not let go of our finger, but we touch on another element.  For example, an incoming call was received, and the browser is no longer on the screen. </li></ul><br>  But some browsers on touch devices ‚Äî for example, WP IE ‚Äî do not support these events. <br><br>  In general, nothing would seem to interfere with imitating similar behavior through mouse events - like, for example, in desktop drag'n'drop: <br><ul><li>  touchstart - mousedown </li><li>  touchmove - mousemove </li><li>  touchend, touchcancel - mouseup </li></ul><br>  But mouse events in mobile browsers work rather strangely ¬¨‚Äì <br>  events occur only if there was a click (and then click first, and only then - mousedown, mousemove and mouseup). <br><br>  Because swipe is implemented only on touch-events. <br><br>  The touch-event contains useful information about touches: <br><ul><li>  touches - a collection of all touches that are currently happening </li><li>  changedTouches - touches for which there are changes, i.e.  directly those that caused the event </li><li>  targetTouches - touches associated with target events.  Touches that occurred inside the element on which the current listener is hung </li></ul><br>  Each touch is assigned a unique identifier.  In different browsers it can have different values, in some it is constantly incremented, in others it is reset when there are no more touches. <br><br>  Also, the touch object contains information about the coordinates relative to the viewport, the screen and the page. <br><br>  The logic is pretty simple: <br><br><h5>  Touchstart </h5><br><pre><code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/*   started (     swipe)  - touches.  swipe    toches  , ,    ,      . */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (e.touches.length != <span class="hljs-number"><span class="hljs-number">1</span></span> || started){ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-comment"><span class="hljs-comment">/*   detecting = true, ,    touchmove  ,      ‚Äî     ,       */</span></span> detecting = <span class="hljs-literal"><span class="hljs-literal">true</span></span>; <span class="hljs-comment"><span class="hljs-comment">//       touch = e.changedTouches[0]; x = touch.pageX; y = touch.pageY;</span></span></code> </pre> <br><br><h5>  Touchmove </h5><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">/*   :     started,  detecting,   .    */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!started &amp;&amp; !detecting){ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-comment"><span class="hljs-comment">/*            */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (detecting){ detect(); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (started){ draw(); } <span class="hljs-comment"><span class="hljs-comment">/*  */</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">detect</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span>{ <span class="hljs-comment"><span class="hljs-comment">/*      changedTouches.     , ,      .       */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (e.changedTouches.indexOf(touch) == <span class="hljs-number"><span class="hljs-number">-1</span></span>){ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span>; } <span class="hljs-comment"><span class="hljs-comment">/*     ,     ,      .      ,   , ,  . */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (abs(x - newX) &gt;= abs(y - newY)){ <span class="hljs-comment"><span class="hljs-comment">/*      ,   touchmove     (,  Android).    swipe         ‚Äì   */</span></span> e.preventDefault(); <span class="hljs-comment"><span class="hljs-comment">// ,    started = true; } //     , ..      detecting = false; } //      function draw(){ /*    ,      touchmove     */ e.preventDefault(); /*      changedTouches.     , ,      .       */ if (e.changedTouches.indexOf(touch) == -1){ return; } /*       .      ,   ¬´¬ª   */ delta = x ‚Äì newX; /*   ,          ¬´ ¬ª .  ,   ,     */ if (delta &gt; 0 &amp;&amp; !leftPage || delta &lt; 0 &amp;&amp; !rightPage){ delta = delta / 5; } //  ,     moveTo(delta); }</span></span></code> </pre><br><br><h5>  Touchend / Touchcancel </h5><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//   ,    if (e.changedTouches.indexOf(touch) == -1 || !started){ return; } /*    . ,      ,      ,    . */ e.preventDefault(); /* ,       */ swipeTo = delta &lt; 0 ? 'left' : 'right'; //  ,     swipe(swipeTo);</span></span></code> </pre><br>  The algorithm for working with events is quite simple.  It is easy to expand with new chips.  For example, if the user moved the page a small distance, return to the original state by touchend.  And if the user is very quickly held horizontally with a finger, but a value smaller than the threshold value for scrolling, it is still necessary to scroll. <br><br><h4>  Rendering </h4><br><img src="http://habrastorage.org/storage2/dcb/339/58d/dcb33958d691a56efe928dbfb3f54568.png"><br><br>  In order to make a sheetfinder, you need to arrange the pages in a row. <br><br><img src="http://habrastorage.org/storage2/d75/737/2eb/d757372eb98974a841ebbdbe257afeb1.png"><br><br>  Each of them must be a width of not more and not less than the parent. <br><br><img src="http://habrastorage.org/storage2/c3b/162/cea/c3b162cea2f5be3828769bc06518ac47.png"><br><br>  The central one is always visible, the left ones are shifted by 100% to the left, and the right ones - by 100% to the right. <br><br><img src="http://habrastorage.org/storage2/6a0/b1a/169/6a0b1a1696128bb007f231f3bb92224a.png"><br><br>  Many people want to use a table, but it does not fit for several reasons. <br>  To get the page width of 100% of the parent, you need to somehow set the width of the entire table to &lt;page count&gt; * 100%, and the page itself to 100% / &lt;page count&gt;.  Without additional JS-manipulations, this is impossible and threatens with errors and irregularities, as well as additional calculations. <br><br>  Making pages float'ami is also not an option, because  this will give an extra load on an already in many cases slow browser, even if you clean the stream. <br><br>  We chose another option: <br><br><pre> <code class="css hljs"><span class="hljs-selector-class"><span class="hljs-selector-class">.swipe</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">position</span></span>: relative; <span class="hljs-attribute"><span class="hljs-attribute">overflow</span></span>: hidden; <span class="hljs-attribute"><span class="hljs-attribute">height</span></span>: <span class="hljs-number"><span class="hljs-number">300px</span></span>; }</code> </pre><br>  The block wrapper indicated the height, position: relative and overflow: hidden, thus significantly reducing the load on the browser during rendering and calculations - we get a separate branch of the DOM tree inside the list, the browser does not recalculate other parts of the tree when it changes inside. <br><br><img src="http://habrastorage.org/storage2/253/500/8e7/2535008e753bf1d2115ec1ce894c2da5.png"><br><br>  Pages were divided into 3 logical groups: <br><ol><li>  pages left </li><li>  the central page is always the same </li><li>  and the pages on the right </li></ol><br><pre> <code class="css hljs"><span class="hljs-selector-class"><span class="hljs-selector-class">.swipe__page</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">overflow</span></span>: hidden; <span class="hljs-attribute"><span class="hljs-attribute">position</span></span>: absolute; <span class="hljs-attribute"><span class="hljs-attribute">left</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">top</span></span>: <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">width</span></span>: <span class="hljs-number"><span class="hljs-number">100%</span></span>; <span class="hljs-attribute"><span class="hljs-attribute">height</span></span>: <span class="hljs-number"><span class="hljs-number">100%</span></span>; }</code> </pre><br>  To speed up the rendering, you need to isolate the pages as much as possible from each other, because for each page position: absolute is indicated;  and corresponding coordinates and dimensions. <br><br><pre> <code class="css hljs"><span class="hljs-selector-class"><span class="hljs-selector-class">.swipe__page_animating</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">transition</span></span>: transform <span class="hljs-number"><span class="hljs-number">200ms</span></span> linear; }</code> </pre><br>  Next comes the question of shifting pages to the right and left. <br>  Pages are animated using CSS transition. <br>  If you animate left, it turns out very slowly.  Translate works much faster, and even faster - translate3d from CSS transformations. <br><br><pre> <code class="css hljs"><span class="hljs-selector-class"><span class="hljs-selector-class">.swipe__page_left</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">transform</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">translate</span></span>(-100%, 0); <span class="hljs-attribute"><span class="hljs-attribute">transform</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">translate3d</span></span>(-100%, 0, 0); } <span class="hljs-selector-class"><span class="hljs-selector-class">.swipe__page_center</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">transform</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">translate</span></span>(0, 0); <span class="hljs-attribute"><span class="hljs-attribute">transform</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">translate3d</span></span>(0, 0, 0); } <span class="hljs-selector-class"><span class="hljs-selector-class">.swipe__page_right</span></span> { <span class="hljs-attribute"><span class="hljs-attribute">transform</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">translate</span></span>(100%, 0); <span class="hljs-attribute"><span class="hljs-attribute">transform</span></span>: <span class="hljs-built_in"><span class="hljs-built_in">translate3d</span></span>(100%, 0, 0); }</code> </pre><br>  Therefore, all pages have left: 0 and both translate options - in case the browser does not support 3d transformations, with horizontal offset values ‚Äã‚Äãof 100%, 0 and 100% for left, center and right pages, respectively. <br><br><img src="http://habrastorage.org/storage2/480/575/24f/48057524f4d2d4d12269aba6f9ae0db3.png"><br><br>  Thus, we got the following: visible central page, and beyond the border of the visible part of the block there is a stack of pages on the left and a stack of pages on the right. <br><br><img src="http://habrastorage.org/storage2/44b/96e/f5a/44b96ef5a9ca2d49aa31cd3668eda56c.png"><br><br>  Three of all pages are selected: <br><ol><li>  central, visible </li><li>  next page left </li><li>  next page on the right </li></ol><br><img src="http://habrastorage.org/storage2/539/9da/b46/5399dab46f87bf60b15595b075b6035f.jpg"><br><br><pre> <code class="css hljs"><span class="hljs-selector-tag"><span class="hljs-selector-tag">transform</span></span>: <span class="hljs-selector-tag"><span class="hljs-selector-tag">translate</span></span>(<span class="hljs-selector-tag"><span class="hljs-selector-tag">delta</span></span>, 0);</code> </pre><br>  Initially, the swipe__page_animating class (adds a CSS transition) is not installed.  Upon the touchmove event, the page is set to the corresponding translate, with the horizontal offset value equal to the finger offset (or offset divided by the ‚Äúdrag coefficient‚Äù).  Those.  the page just moves with your finger. <br><br><img src="http://habrastorage.org/storage2/d7c/105/01b/d7c10501b337be269449587e17d1785f.jpg"><br><br>  In fact, everything is somewhat more complicated.  Three pages simultaneously move: the current visible, and the page to the left and right, which creates the effect of continuous tape.  Accordingly, for the right and left pages, the offset is equal to its width with the corresponding position of the sign (for the right - plus, for the left - minus) plus the offset of the finger. <br><br><img src="http://habrastorage.org/storage2/ea8/08b/b9c/ea808bb9c2b8c4d2480afe5cafe56d9e.png"><br><br>  On the event touchend or touchcancel, the pages are set to the swipe__page_animating class, which includes CSS animations, and the offset values ‚Äã‚Äãcorresponding to the final position ‚Äî either scroll through or set the initial values. <br><br><img src="http://habrastorage.org/storage2/80a/dad/9e7/80adad9e7508cbc36077edfa1dc46f4f.png"><br><br>  On the transitionend event, i.e.  at the end of the animation: <br><ul><li>  class swipe__page_animating is removed </li><li>  the ‚Äúnext‚Äù pages are selected again, the _left, _center, _right classes are switched according to the new position.  For example, if the user turned over to the left, then the central page becomes right, the left - central, the right one is simply put in the right, and the new ‚Äúnext‚Äù is selected from the left. </li><li>  the offsets set by the script are reset so that when the width of the entire page is changed - for example, when the device orientation changes - the block pages are automatically adapted by the browser to the new conditions </li><li>  cleared installed flags like started </li></ul><br>  Thus, the block is in the initial state and is ready to interact with the user. <br><br>  How to make it clear that the block can be flipped through - this is the topic of a separate report by the interface designer.  I can only say that there must be some kind of visual hint or other switching path. <br><br><img src="http://habrastorage.org/storage2/61f/989/09b/61f98909b382ad6ec1b9de6538cea819.jpg"><br><br>  For example, in the case of a news block, on the example of which I am talking about the swipe, we made the usual tabs.  The user can tap on the tab and turn the page.  Plus tab is also the title, making it clear which page is visible at the moment. <br><br>  This method is also good for compatibility with browsers that do not support touch-events.  For example, in WP IE, a user might as well use a news block as on other devices. <br><br>  That's all for today.  Questions and discussion are welcome. <br><br>  Yegor Dydykin, <br>  leader of the development team for the main Mail.Ru page and cross-portal projects </div><p>Source: <a href="https://habr.com/ru/post/165213/">https://habr.com/ru/post/165213/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../165199/index.html">Corning introduced an optical USB cable</a></li>
<li><a href="../165201/index.html">Many reasons to be a manager</a></li>
<li><a href="../165203/index.html">Tao development of reference documentation for IT-product</a></li>
<li><a href="../165207/index.html">Static IP address lifetime in Windows Azure</a></li>
<li><a href="../165209/index.html">Report of the analytical agency Gartner. Market "clouds" - forecast to 2015</a></li>
<li><a href="../165215/index.html">Stop unused hosts through CloudWatch</a></li>
<li><a href="../165221/index.html">Creating an interactive prototype with Fireworks and TAP (touch application prototyping)</a></li>
<li><a href="../165223/index.html">How do transactions work in Redis</a></li>
<li><a href="../165227/index.html">PowerShell Web Access: Configuring</a></li>
<li><a href="../165231/index.html">Microsoft R & D office robbed, only iPad tablets stolen</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>