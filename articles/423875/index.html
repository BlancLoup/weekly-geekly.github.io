<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Storage of a large number of files</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Good health, Habrazhiteli! In the process of working on a dating site project, it became necessary to organize the storage of user photos. According t...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Storage of a large number of files</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/ti/up/px/tiuppxliueu75a1ycliw537yw-k.jpeg" alt="image"><br><br>  Good health, Habrazhiteli!  In the process of working on a dating site project, it became necessary to organize the storage of user photos.  According to the terms of reference, the number of photos of one user is limited to 10 files.  But there may be tens of thousands of users.  Especially considering the fact that the project in its current form already exists from the beginning of the ‚Äúzero‚Äù.  That is, there are already thousands of users in the database.  Almost any file system, as far as I know, reacts very negatively to the large number of child nodes in the folder.  From experience, I can say that problems begin after 1000-1500 files / folders in the parent folder. <br><a name="habracut"></a><br>  <i>Disclaimer</i>  <i>I googled before writing the article and found several solutions to the issue under discussion (for example, <a href="https://habr.com/post/227855/">here</a> or <a href="https://habr.com/sandbox/51447/">here</a> ).</i>  <i>But I did not find a single solution that exactly corresponds to mine.</i>  <i>In addition, in this article I just share my own experience in solving the problem.</i> <br><br><h3>  Theory </h3><br>  In addition to the storage task as such, there was also a condition in the TK, according to which the ability to leave captions and photographs was needed.  Of course, without a database here is not enough.  That is, the first thing we do is create a table in which we prescribe the mapping of meta-data (signatures, titles, etc.) with files on the disk.  Each file corresponds to one line in the database.  Accordingly, each file has an identifier. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      A small digression.  Let's talk about autoincrement.  On a dating site there can be a dozen or two thousand users.  The question is how many users in general go through the project for all the time of its existence.  For example, the active audience of "dating-ru" is several hundred thousand.  However, just imagine how many users have retired during the lifetime of this project;  how many users have not been activated yet.  And now add our legislation, which obliges you to store information about users for at least six months ... Sooner or later, 4 of a billion <b>UNSIGNED INT</b> kopecks will run out.  By this best for the primary-key to take <b>BIGINT</b> . <br><br>  Now let's try to imagine a <b>BIGINT</b> number.  This is 8 bytes.  Each byte is from 0 to 255. 255 child nodes is quite normal for any file system.  That is, we take the file identifier in hexadecimal representation, break it into chunks of two characters each.  We use these chunks as folder names, the latter being the name of a physical file.  PROFIT! <br><br> <code>0f/65/84/10/67/68/19/ff.file</code> <br> <br>  Elegant and simple.  File extension here is not important.  Anyway, the file will be given to the script, which will give the browser in particular the MIME type, which we will also store in the database.  In addition, storing information about a file in the database allows you to override the path to it for the browser.  Let's say the file is actually located relative to the project directory along the path <code>/content/files/0f/65/84/10/67/68/19/ff.file</code> .  And in the database you can write him the URL, for example, <code>/content/users/678/files/somefile</code> .  SEO-Schnick now, probably, quite smiled.  All this allows us not to worry more about where to place the file physically. <br><br><h3>  Table in db </h3><br>  In addition to the identifier, MIME type, URL and physical location, we will store in the table md5 and sha1 files for screening out the same files if necessary.  Of course, we also need to store relationships with entities in this table.  Suppose the user ID to which the files belong.  And if the project is not very big, then in the same system we can store, say, photos of the goods.  By this, we will also store the name of the class of the entity to which the entry belongs. <br><br>  By the way, about the birds.  If you close the folder with .htaccess for external access, the file can only be obtained through a script.  And in the script it will be possible to determine access to the file.  Looking ahead a bit, I‚Äôll say that in my CMS (where the aforementioned project is being sawn) access is determined by basic user groups, of which I have 8 - guests, users, managers, admins, unactivated, blocked, remote and super admins.  A super admin can do absolutely everything, so he is not involved in the definition of access.  If the user has a super-admin flag, then he is super-admin.  It's simple.  That is, we will determine the accesses of the remaining seven groups.  Access is simple - either to give the file, or not to give.  Total, you can take the field type <b>TINYINT</b> . <br><br>  And one moment.  According to our legislation, we will have to physically store custom pictures.  That is, we need to somehow mark the pictures as deleted, instead of physically deleting.  It is most convenient to use a bit field for these purposes.  I usually use the <b>INT</b> type field in such cases.  So with a margin, so to speak.  Moreover, I have already established tradition to place the <b>DELETED</b> flag in the 5th bit from the end.  But it is not fundamentally the same. <br><br>  What we have in the end: <br><br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">create</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> <span class="hljs-string"><span class="hljs-string">`files`</span></span> ( <span class="hljs-string"><span class="hljs-string">`id`</span></span> <span class="hljs-built_in"><span class="hljs-built_in">bigint</span></span> <span class="hljs-keyword"><span class="hljs-keyword">not</span></span> <span class="hljs-literal"><span class="hljs-literal">null</span></span> auto_increment, <span class="hljs-comment"><span class="hljs-comment">--   `entity_type` char(32) not null default '', --   `entity` bigint null, -- ID  `mime` char(32) not null default '', -- MIME- `md5` char(32) not null default '', -- MD5 `sha1` char(40) not null default '', -- SHA1 `file` char(64) not null default '', --   `url` varchar(250) not null default '', -- URL `meta` text null, -- -   JSON    `size` bigint not null default '0', --  `created` datetime not null, --   `updated` datetime null, --   `access` tinyint not null default '0', --   `flags` int not null default '0', --  primary key (`id`), index (`entity_type`), index (`entity`), index (`mime`), index (`md5`), index (`sha1`), index (`url`) ) engine = InnoDB;</span></span></code> </pre> <br><h3>  Dispatcher class </h3><br>  Now we need to create a class with which we will upload files.  The class must provide the ability to create files, replace / change files, delete files.  In addition, it is worth considering two points.  First, the project can be transferred from server to server.  So in the class you need to define a property that contains the root directory of files.  Secondly, it will be very unpleasant if someone bangs a table in the database.  So you need to provide the ability to recover data.  With the first all in general is understandable.  As for data backup, we will only reserve something that cannot be restored. <br><br>  <b>ID</b> - restored from the physical location of the file <br>  <b>entity_type</b> - not recoverable <br>  <b>entity</b> - cannot be restored <br>  <b>mime</b> - restored using finfo extension <br>  <b>md5</b> - restored from the file itself <br>  <b>sha1</b> - restored from the file itself <br>  <b>file</b> - restored from the physical location of the file <br>  <b>url</b> - not restored <br>  <b>meta</b> - cannot be restored <br>  <b>size</b> - recovers from the file itself <br>  <b>created</b> - you can take information from the file <br>  <b>updated</b> - you can take information from a file <br>  <b>access</b> - not restored <br>  <b>flags</b> - cannot be restored <br><br>  Immediately you can drop the meta-information.  It is not critical for the functioning of the system.  And for more rapid recovery, you still need to save the MIME type.  Total: entity type, entity ID, MIME, URL, access, and flags.  In order to increase the reliability of the system, we will store backup information on each final folder separately in the folder itself. <br><br><div class="spoiler">  <b class="spoiler_title">Class code</b> <div class="spoiler_text"><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">BigFiles</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> FLAG_DELETED = <span class="hljs-number"><span class="hljs-number">0x08000000</span></span>; <span class="hljs-comment"><span class="hljs-comment">//    "" /** @var mysqli $_db */ protected $_db = null; protected $_webRoot = ''; protected $_realRoot = ''; function __construct(mysqli $db = null) { $this-&gt;_db = $db; } /** * /   URL- * @param string $v  * @return string */ public function webRoot($v = null) { if (!is_null($v)) { $this-&gt;_webRoot = $v; } return $this-&gt;_webRoot; } /** * /    * @param string $v  * @return string */ public function realRoot($v = null) { if (!is_null($v)) { $this-&gt;_realRoot = $v; } return $this-&gt;_realRoot; } /** *   * @param array $data   * @param string $url URL   * @param string $eType   * @param int $eID ID  * @param mixed $meta - * @param int $access  * @param int $flags  * @param int $fileID ID   * @return bool * @throws Exception */ public function upload(array $data, $url, $eType = '', $eID = null, $meta = null, $access = 127, $flags = 0, $fileID = 0) { $meta = is_array($meta) ? serialize($meta) : $meta; if (empty($data['tmp_name']) || empty($data['name'])) { $fid = intval($fileID); if (empty($fid)) { return false; } $meta = empty($meta) ? 'null' : "'" . $this-&gt;_db-&gt;real_escape_string($meta) . "'"; $q = "`meta`={$meta},`updated`=now()"; $this-&gt;_db-&gt;query("UPDATE `files` SET {$q} WHERE (`id` = {$fid}) AND (`entity_type` = '{$eType}')"); return $fid; } // File data $meta = empty($meta) ? 'null' : "'" . $this-&gt;_db-&gt;real_escape_string($meta) . "'"; $finfo = finfo_open(FILEINFO_MIME_TYPE); $mime = finfo_file($finfo , $data['tmp_name']); finfo_close($finfo); // FID, file name if (empty($fileID)) { $eID = empty($eID) ? 'null' : intval($eID); $q = &lt;&lt;&lt;sql insert into `files` set `mime` = '{$mime}', `entity` = {$eID}, `entityType` = '{$eType}', `created` = now(), `access` = {$access}, `flags` = {$flags} sql; $this-&gt;_db-&gt;query($q); $fid = $this-&gt;_db-&gt;insert_id; list($ffs, $fhn) = self::fid($fid); $url = $this-&gt;_webRoot . $url . '/' . $fid; $fdir = $this-&gt;_realRoot . $ffs; self::validateDir($fdir); $index = self::getIndex($fdir); $index[$fhn] = array($fhn, $mime, $url, ($eID == 'null' ? 0 : $eID), $access, $flags); self::setIndex($fdir, $index); $fname = $ffs . '/' . $fhn . '.file'; } else { $fid = intval($fileID); $fname = $this-&gt;fileName($fid); } // Move file $fdir = $this-&gt;_realRoot . $fname; if (!move_uploaded_file($data['tmp_name'], $fdir)) { throw new Exception('Upload error'); } $q = '`md5`=\'' . md5_file($fdir) . '\',`sha1`=\'' . sha1_file($fdir) . '\',' . '`size`=' . filesize($fdir) . ',`meta`=' . $meta . ',' . (empty($fileID) ? "`url`='{$url}',`file`='{$fname}'" : '`updated`=now()'); $this-&gt;_db-&gt;query("UPDATE `files` SET {$q} WHERE (`id` = {$fid}) AND (`entity_type` = '{$eType}')"); return $fid; } /** *   * @param string $url URL * @param string $basicGroup    * @throws Exception */ public function read($url, $basicGroup = 'anonimous') { if (!ctype_alnum(str_replace(array('/', '.', '-', '_'), '', $url))) { header('HTTP/1.1 400 Bad Request'); exit; } $url = $this-&gt;_db-&gt;real_escape_string($url); $q = "SELECT * FROM `files` WHERE `url` = '{$url}' ORDER BY `created` ASC"; if ($result = $this-&gt;_db-&gt;query($q)) { $vars = array(); $ints = array('id', 'entity', 'size', 'access', 'flags'); while ($row = $result-&gt;fetch_assoc()) { foreach ($ints as $i) { $row[$i] = intval($row[$i]); } $fid = $row['id']; $vars[$fid] = $row; } if (empty($vars)) { header('HTTP/1.1 404 Not Found'); exit; } $deleted = false; $access = true; $found = ''; $mime = ''; foreach ($vars as $fdata) { $flags = intval($fdata['flags']); $deleted = ($flags &amp; self::FLAG_DELETED) != 0; $access = self::granted($basicGroup, $fdata['access']); if (!$access || $deleted) { continue; } $found = $fdata['file']; $mime = $fdata['mime']; } if (empty($found)) { if ($deleted) { header('HTTP/1.1 410 Gone'); exit; } elseif (!$access) { header('HTTP/1.1 403 Forbidden'); exit; } } else { header('Content-type: ' . $mime . '; charset=utf-8'); readfile($this-&gt;_realRoot . $found); exit; } } header('HTTP/1.1 404 Not Found'); exit; } /** *   ()   * @param mixed $fid () * @return bool * @throws Exception */ public function delete($fid) { $fid = is_array($fid) ? implode(',', $fid) : $fid; $q = "delete from `table` where `id` in ({$fid})"; $this-&gt;_db-&gt;query($q); $result = true; foreach ($fid as $fid_i) { list($ffs, $fhn) = self::fid($fid_i); $fdir = $this-&gt;_realRoot . $ffs; $index = self::getIndex($fdir); unset($index[$fhn]); self::setIndex($fdir, $index); $result &amp;= unlink($fdir . '/'. $fhn . '.file'); } return $result; } /** *  ()  "" * @param int $fid () * @param bool $value   * @return bool */ public function setDeleted($fid, $value=true) { $fid = is_array($fid) ? implode(',', $fid) : $fid; $o = $value ? ' | ' . self::FLAG_DELETED : ' &amp; ' . (~self::FLAG_DELETED); $this-&gt;_db-&gt;query("update `files` set `flags` = `flags` {$o} where `id` in ({$fid})"); return true; } /** *   * @param int $fid  * @return string * @throws Exception */ public function fileName($fid) { list($ffs, $fhn) = self::fid($fid); self::validateDir($this-&gt;_realRoot . $ffs); return $ffs . '/' . $fhn . '.file'; } /** *   . *           . * @param int $fid   * @return array */ public static function fid($fid) { $ffs = str_split(str_pad(dechex($fid), 16, '0', STR_PAD_LEFT), 2); $fhn = array_pop($ffs); $ffs = implode('/', $ffs); return array($ffs, $fhn); } /** *    * @param string $f     * @return bool * @throws Exception */ public static function validateDir($f) { if (!is_dir($f)) { if (!mkdir($f, 0700, true)) { throw new Exception('cannot make dir: ' . $f); } } return true; } /** *    * @param string $f       * @return array */ public static function getIndex($f) { $index = array(); if (file_exists($f . '/.index')) { $_ = file($f . '/.index'); foreach ($_ as $_i) { $row = trim($_i); $row = explode('|', $row); array_walk($row, 'trim'); $rid = $row[0]; $index[$rid] = $row; } } return $index; } /** *    * @param string $f       * @param array $index    * @return bool */ public static function setIndex($f, array $index) { $_ = array(); foreach ($index as $row) { $_[] = implode('|', $row); } return file_put_contents($f . '/.index', implode("\r\n", $_)); } /** *   * @param string $group   (. ) * @param int $value   * @return bool */ public static function granted($group, $value=0) { $groups = array('anonimous', 'user', 'manager', 'admin', 'inactive', 'blocked', 'deleted'); if ($group == 'root') { return true; } foreach ($groups as $groupID =&gt; $groupName) { if ($groupName == $group) { return (((1 &lt;&lt; $groupID) &amp; $value) != 0); } } return false; } }</span></span></code> </pre> <br></div></div><br>  Consider some points: <br><br>  - <b>realRoot</b> - full path to the file system folder ending in a slash. <br>  - <b>webRoot</b> - path from the site root without a leading slash (see below why). <br>  - As a DBMS, I use the <b>MySQLi</b> extension. <br>  - In fact, in the <b>upload</b> method, the first argument passes information from the <b>$ _FILES array</b> . <br>  - If, when calling the <b>update</b> method, to transfer the ID of an existing file, it will be replaced if the input array in the <b>tmp_name</b> is non-empty. <br>  - You can remove and change the file flags for several pieces at once.  For this you need to transfer instead of the file identifier either an array with identifiers, or a string with them separated by commas. <br><br><h3>  Routing </h3><br>  Actually, it all comes down to several lines in htaccess in the site root (it is assumed that mod_rewrite is enabled): <br><br><pre> <code class="apache hljs"><span class="hljs-attribute"><span class="hljs-nomarkup"><span class="hljs-attribute"><span class="hljs-nomarkup">RewriteCond</span></span></span></span> <span class="hljs-variable"><span class="hljs-variable">%{REQUEST_URI}</span></span> ^/content/(.*)$ RewriteCond <span class="hljs-variable"><span class="hljs-variable">%{REQUEST_FILENAME}</span></span> !-f RewriteRule ^(.+)$ content/index.php?file=<span class="hljs-number"><span class="hljs-number">$1</span></span><span class="hljs-meta"><span class="hljs-meta"> [L,QSA]</span></span></code> </pre> <br>  ‚ÄúContent‚Äù is the folder in the root of the site in my case.  Needless to say, you can name the folder differently.  And of course, index.php itself, which in my case is stored in the content folder: <br><br><pre> <code class="php hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?php</span></span> $dbHost = <span class="hljs-string"><span class="hljs-string">'127.0.0.1'</span></span>; $dbUser = <span class="hljs-string"><span class="hljs-string">'user'</span></span>; $dbPass = <span class="hljs-string"><span class="hljs-string">'****'</span></span>; $dbName = <span class="hljs-string"><span class="hljs-string">'database'</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">empty</span></span>($_REQUEST[<span class="hljs-string"><span class="hljs-string">'file'</span></span>])) { header(<span class="hljs-string"><span class="hljs-string">'HTTP/1.1 400 Bad Request'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">exit</span></span>; } $userG = <span class="hljs-string"><span class="hljs-string">'anonimous'</span></span>; <span class="hljs-comment"><span class="hljs-comment">//      ;      $files = new BigFiles(new mysqli($dbHost,$dbUser,$dbPass,$dbName)); $files-&gt;realRoot(dirname(__FILE__).'/files/'); $files-&gt;read($_REQUEST['file'],$userG); } catch (Exception $e) { header('HTTP/1.1 500 Internal Error'); header('Content-Type: text/plain; charset=utf-8'); echo $e-&gt;getMessage(); exit; }</span></span></code> </pre><br>  Well, by itself, we close the file system itself from external access.  Put in the root of the <code>content/files</code> folder the <code>.htaccess</code> file with only one line: <br><br><pre> <code class="apache hljs"><span class="hljs-attribute"><span class="hljs-nomarkup"><span class="hljs-attribute"><span class="hljs-nomarkup">Deny</span></span></span></span> from <span class="hljs-literal"><span class="hljs-literal">all</span></span></code> </pre> <br><h3>  Total </h3><br>  This solution avoids the loss of file system performance due to an increase in the number of files.  At least troubles in the form of thousands of files in one folder can be precisely avoided.  And at the same time, we can organize and control access to files by human-readable addresses.  Plus compliance with our grim legislation.  Immediately make a reservation, this solution is NOT a complete way to protect content.  Remember: if something is played in the browser, it can be downloaded for free. </div><p>Source: <a href="https://habr.com/ru/post/423875/">https://habr.com/ru/post/423875/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../423865/index.html">Roskomnadzor publicly reported</a></li>
<li><a href="../423867/index.html">The founder of 3D printing studio - about his work</a></li>
<li><a href="../423869/index.html">The future of jobs. The main thing from the report of the World Economic Forum</a></li>
<li><a href="../423871/index.html">Solve a logical problem for students in SQL</a></li>
<li><a href="../423873/index.html">PICASO 3D Designer X 3D Printer Review</a></li>
<li><a href="../423877/index.html">October 29-31: create a production-ready Kubernetes cluster</a></li>
<li><a href="../423879/index.html">Is it easy to add new features to the old framework? Flour choice on example development SObjectizer-and</a></li>
<li><a href="../423881/index.html">What were the welders for optics (part two)</a></li>
<li><a href="../423885/index.html">Invitation to the light show and a bit of insight from the future site "Circle of Light" in Moscow</a></li>
<li><a href="../423889/index.html">My disappointment in software</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>