<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Port scanner in Rostelecom‚Äôs personal account</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Today, I accidentally discovered that the personal account of Rostelecom is engaged in a completely harmful activity, namely, it scans local services ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Port scanner in Rostelecom‚Äôs personal account</h1><div class="post__text post__text-html js-mediator-article"> Today, I accidentally discovered that the personal account of <a href="https://lk.rt.ru/">Rostelecom</a> is engaged in a completely harmful activity, namely, it scans local services on my computer.  Since it‚Äôs almost impossible to get sane information from Rostelecom, I decided to point out this problem on Habr√©, so that habrovans would be aware that we can expect very dubious behavior even from large and serious players. <br><br>  And now, the actual details. <br><a name="habracut"></a><br>  When I got to work in the morning, I found some wonderful lines from VNC in the system log: <br><br> <code>Connections: rejecting blacklisted connection: 127.0.0.1::22715</code> <br> <br>  Those.  someone from localhost trying to get on port 5900, then this is a virus or something else worse.  Of course, a cold sweat broke through me, and I went to look for this pest.  A quick analysis showed that the churning goes every 10 minutes and 11 attempts are made to connect.  It remains to find out who does it. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Once the connection is blocked, you need to make sure that someone is sitting on it.  The easiest way for me was to raise an intelligent tcp-server on a node that does nothing and just keeps the connection. <br><br><pre> <code class="javascript hljs">server.listen(<span class="hljs-number"><span class="hljs-number">5900</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{});</code> </pre> <br>  I looked at who connected there, it turned out that it was Firefox: <br><br><img src="https://habrastorage.org/webt/o5/pt/x0/o5ptx0guvbefcfn8ujqqmpf2lva.png"><br><br>  Then I went to find out which of the tabs or firefox extensions it does.  It turned out that neither about: peformance, nor about: networking do not show the process id that can make network requests.  But I found out that this is the main process of the browser, and not additional for tabs or extensions, which made it difficult to ascertain the pest (yes, I have a lot of tabs, as always, and finding the right one is hard enough). <br><br>  But with the help of patience, I found a wonderful tab, in the developer console of which there were wonderful lines: <br><br><img src="https://habrastorage.org/webt/ci/jp/0d/cijp0drgacwgwljovoo5g7qcz-o.png"><br><br>  And this tab was Personal Account of Rostelecom.  After that, it turned out that the requests are of the following form: <br><br><img src="https://habrastorage.org/webt/gl/_z/pf/gl_zpfvxmqjpzfi5rmvadsc03d0.png"><br><br>  14 enough interesting ports: <br><div class="scrollable-table"><table><tbody><tr><th>  Port </th><th>  Description </th></tr><tr><td>  5900 </td><td>  VNC </td></tr><tr><td>  6900 </td><td>  Bittorrent </td></tr><tr><td>  5650 </td><td>  Pizza trojan </td></tr><tr><td>  5931 </td><td>  ? </td></tr><tr><td>  5938 </td><td>  Teamviewer </td></tr><tr><td>  5939 </td><td>  ? </td></tr><tr><td>  3389 </td><td>  RDP </td></tr><tr><td>  8080 </td><td>  HTTP </td></tr><tr><td>  51 </td><td>  F ** k Lamers Backdoor </td></tr><tr><td>  443 </td><td>  Https </td></tr><tr><td>  80 </td><td>  HTTP </td></tr><tr><td>  22 </td><td>  Ssh </td></tr><tr><td>  445 </td><td>  SMB </td></tr><tr><td>  5985 </td><td>  Microsoft Windows Remote Management </td></tr></tbody></table></div><br>  Most ports are tools for remotely controlling a computer.  It turns out that further we should expect attempts to penetrate these ports from the outside.  Why can it be? <br><br>  I have the following options in my head: <br><br><ol><li>  My account has been hacked and an attempt is being made to find out the vulnerable computers and set the Trojan user on </li><li>  This is a conscious decision of Rostelecom and an attempt to do something bad to the user. </li><li>  This is a deliberate decision of Rostelecom and an attempt to collect user data. </li></ol><br>  In this case, my computer is not in the network of Rostelecom, so that these actions look very, very dirty. <br><br>  <b>UPD:</b> <a href="https://habr.com/ru/post/456558/">Supplement</a> from <a href="https://habr.com/ru/users/sashablashenkov/" class="user_link">sashablashenkov</a> <br><blockquote>  Judging by this page, this is some kind of Dynatrace Real user monitoring <br><br>  If you are a customer, go through every digital transaction.  No sampling of data, Dynatrace gives you a complete picture, from the frontend to the backend. <br>  Monitor user journeys <br>  Replay individual customer transactions for rapid problem handling <br>  Dynatrace provides a single problem notification <br>  Identify and resolve technical issues proactively <br><br>  But why does it scan ports - do not understand </blockquote><br><br>  UPD2: <a href="https://habr.com/ru/users/runalsh/" class="user_link">runalsh</a> <a href="https://habr.com/ru/post/456558/comments/">clarified</a> that this is not Dynatrace, but <a href="https://www.group-ib.com/">group-ib</a> <br><br>  More details.  The script is located at: <br><br> <code>https://lk.rt.ru/ruxitagentjs_ICA2SVfhqrux_10169190521113456.js</code> <br> <br>  Those.  these are not some external counters or analytics, but their own script. <br><br>  This script has been obfuscated and the function that accesses ports looks something like this: <br><br><pre> <code class="javascript hljs">Aa: <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> a = <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Tg(); <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Qh(a); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> e = <span class="hljs-number"><span class="hljs-number">0</span></span>; e &lt; <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Ye.length; e++) (<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">c, f</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (!dFN(f.Gg, c) || !dTjh() || dTwb() || dTdc()) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> e = (<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>).getTime(), g = dDmb(Oa(<span class="hljs-number"><span class="hljs-number">1939</span></span>), <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.location[Ma(<span class="hljs-number"><span class="hljs-number">1402</span></span>)] + $e(<span class="hljs-number"><span class="hljs-number">1358</span></span>) + c), k; g.then(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ clearTimeout(k); f.Ec(c, ua(<span class="hljs-number"><span class="hljs-number">1117</span></span>), (<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>).getTime() - e, a) }).then(<span class="hljs-keyword"><span class="hljs-keyword">void</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ clearTimeout(k); f.wc[c] ? <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span> f.wc[c] : f.Ec(c, Lb(<span class="hljs-number"><span class="hljs-number">1430</span></span>), (<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>).getTime() - e, a) }); k = G(<span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> (</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ f.wc[c] = !<span class="hljs-number"><span class="hljs-number">0</span></span>; g.te().abort(); f.Ec(c, Mc(<span class="hljs-number"><span class="hljs-number">1251</span></span>), (<span class="hljs-keyword"><span class="hljs-keyword">new</span></span> <span class="hljs-built_in"><span class="hljs-built_in">Date</span></span>).getTime() - e, a) }, f.$e || <span class="hljs-number"><span class="hljs-number">10000</span></span>) } }) (<span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Ye[e], <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>) },</code> </pre> <br>  In the Ye array, it contains 14 ports of data, which is initialized in this way: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.Ye = b[Uh(<span class="hljs-number"><span class="hljs-number">1218</span></span>)];</code> </pre> <br>  Those.  besides minification, in Rostelecom they also added obfuscation, which means they suspected that they were doing something that was not very good, and we should hide it. <br><br>  What to do next, I do not know.  It is clear that it is necessary to configure browsers to protect against this (surprisingly, for some reason, Firefox missed port 5900, although it decided to block others).  It makes no sense to write at Rostelecom, because the answers they have are always of the same type and do not differ in some rationality. <br><br>  But everyone else knows that port scanning can be not only on suspicious sites, but also such decent ones as Rostelecom. <br><br>  <b>Rostelecom <a href="https://info24.ru/news/rostelekom-obyasnil-zachem-skaniruet-kompjutery-klientov.html">answer</a> :</b> <br><blockquote>  The press service of Rostelecom reported that the script is used as an ‚Äúantifraud system to prevent online fraud‚Äù by analyzing the user session.  This system actually collects data on user activity and looks for "indicators of the compromise of their devices." <br><br>  The company explained that the anti-fraud system had to be introduced due to the recent attempts at fraud in respect of personal accounts of subscribers and bonus programs of Rostelecom. </blockquote></div><p>Source: <a href="https://habr.com/ru/post/456558/">https://habr.com/ru/post/456558/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../456542/index.html">Emoji in the interface of iOS applications and Apple requirements</a></li>
<li><a href="../456546/index.html">Improving the work of Wi-Fi. Part 3. Location of access points</a></li>
<li><a href="../45655/index.html">Google admitted in violation of the rules of the App Store</a></li>
<li><a href="../456554/index.html">Open Day of Netology "Professions Data Science"</a></li>
<li><a href="../456556/index.html">Nginx recipes: basic authorization with captcha</a></li>
<li><a href="../45656/index.html">As before laptops did - Toshiba Libretto 50ct (1997 onwards)</a></li>
<li><a href="../456562/index.html">The book "Probabilistic programming in Python: Bayesian inference and algorithms"</a></li>
<li><a href="../456564/index.html">List of users with weak passwords in MS SQL</a></li>
<li><a href="../45657/index.html">Gamebox - an arcade toy on JavaScript.</a></li>
<li><a href="../456570/index.html">This Friday, June 21, the anniversary DevConfX will be held; on June 22, exclusive workshops</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>