<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Python Selenium and Krisha.kz. First in Big Data</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Foreword 


 Studying something new is always interesting, it captures you completely, at least so. So this time, fascinated by the study of programmi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Python Selenium and Krisha.kz. First in Big Data</h1><div class="post__text post__text-html js-mediator-article"><h2 id="predislovie">  Foreword </h2><br><p>  Studying something new is always interesting, it captures you completely, at least so.  So this time, fascinated by the study of programming in Python, wondered where it could be used, except when creating a photoseparator (the article about him will be a little later) and the sales accounting program, and came across an article about big data (Big Data) .  Having studied the materials on Big Data, I realized that this direction is very promising and it is worth spending time studying it. </p><a name="habracut"></a><br><p>  After that, he began to study the inconceivable number of articles and, after reviewing a couple of dozen tutorial videos, reached the point at which new information was categorically not perceived, it was necessary to use the acquired skills and knowledge in practice.  Of course, there are ready-made datasets on the net, where you will be completely chewed on what to do, but for me there is little pleasure from such an activity, although you will definitely get the knowledge and experience.  But, if you start the path from scratch, i.e.  from data collection (hi-Web scrapping) to structuring the data for further analysis, I think this is more useful in terms of training and practical application. </p><br><h2 id="nachalo-puti">  The beginning of the way </h2><br><p>  The search for a suitable candidate (i.e. site) has begun.  After a brief search, he stopped at Market, OLX, Kolesa and Krisha.  A further criterion for site selection was the practical application of the results obtained during the analysis. </p><br><p>  Only one site Krisha.kz was suitable for this criterion.  Krisha.kz is a popular site where people from all over Kazakhstan submit ads for selling, buying or renting apartments, houses and offices, and on this site the largest number of ads.  Having fluently studied the ads on the site, I decided to concentrate on the ads for the sale of apartments in Astana in order to determine the following: </p><br><ol><li>  Problem houses, sign - the number of ads exceeds the average number of ads per house; </li><li>  Successful real estate companies, a sign - the number of published ads; </li><li>  Hidden entrepreneurs who resell apartments.  I think it would be useful for the tax authorities; </li><li>  Unscrupulous realtors who use other people's photos of apartments to attract customers.  I have to say right away that I had to abandon this idea due to limited resources, since I would have to keep a huge amount of photos, and I only have a laptop and home Internet. </li></ol><br><h2 id="sbor-informacii">  Collection of information </h2><br><p>  Having determined the main directions of the analysis, he began to collect information using Web scrapping.  Since I had not previously encountered the task of collecting data from the site, I turned to the indispensable assistant - Google.com.  A bunch of different libraries are offered for the Python programming language - BeutifulSoup, Urllib, Selenium, etc., but in some article on Habrahabr or github (useful sites for Russian speakers involved in programming) I came across a recommendation that Selenium would be better suited for Web Scrapping .  The benefit of installing libraries in Python is surprisingly simple and consists of typing commands on the command line ‚Äúpip install selenium‚Äù and that‚Äôs it, the library is installed. </p><br><p>  After two days of dancing with tambourines and searches in Google, we managed to create a script that collected ads that reflected: the date of the announcement, the price of the apartment, the number of rooms, the address of the house, the floor, who submitted the ad (the owner or the agency), the narrative (type of repair name of the residential complex) and the number of views. </p><br><p>  This information was sufficient for tasks 1 and 2, but task 3 required a phone number, which can be obtained only if you open the advertisement and click on the ‚ÄúShow phone‚Äù button, which complicated the task.  This problem was solved by viewing additional material in the internet and selenium documentation. </p><br><h2 id="vremya-neobhodimoe-dlya-sbora-informacii">  Time required to collect information </h2><br><p>  If you collect only basic information, without a phone number (about 23,000 - 27,000 ads only in Astana), then it takes from 1 to 2 hours, depending on the speed of the Internet provider, but getting a phone number takes much longer - from 24 hours. </p><br><p>  The launch of the script consisted in collecting information from the main page and opening a separate tab for each announcement of the apartment, while until the phone numbers from all the ads on the current page are opened and received, switching to the next page did not occur.  After dozens of script launches, the program was often closed urgently and you had to start the search from the beginning.  In this regard, there is a need to divide the information gathering stage into two sub-steps: </p><br><ol><li>  Collection of information without a phone number, but where indicated a separate link to the ad. </li><li>  Getting the phone number on the link to the announcement received in the first stage. <br>  After all these works we get an excel file of the following content: </li></ol><br><p><img src="https://habrastorage.org/webt/lr/tt/kw/lrttkw3dcmxzvzntbahk88adudm.png" alt="image"></p><br><p>  As you can see, we have not structured data.  Further, for analysis it is required to structure the data in such a way that each column contains only one information: </p><br><ol><li>  ‚ÄúRSS‚Äù column should be divided into 4 columns: number of rooms, apartment area, apartment floor, number of floors; </li><li>  ‚ÄúAdvertiser‚Äù column is divided into: who submitted the advertisement, and if this is an agency, then indicate the name of the agency; </li><li>  Street column: remove extra information about the intersection of streets and process in such a way as to get 2 columns: street name and house number </li><li>  ‚ÄúDescription‚Äù column select separate columns for: year of construction, district and name of the residential complex. </li></ol><br><h2 id="analiz">  Analysis </h2><br><h4 id="obzor-obyavleniy">  Browse ads </h4><br><p>  Having more structured information, we turn to data analysis.  First, we determine the main persons submitting ads on the site.  Below is a chart for ads from April 14.  till April 19  2018 </p><br><p><img src="https://habrastorage.org/webt/6u/hn/wc/6uhnwczmynwzea0h9ppba92y_wq.png" alt="image"></p><br><p>  Prior to this analysis, I assumed that the ads are served only by real estate agencies and apartment owners, but did not expect the presence on the site of representatives of developers and construction companies, although their share is less than 4% of all ads. </p><br><p>  Interestingly, even banks began to serve ads on the site.  Apparently, realize mortgage apartments. </p><br><p>  More than half of the ads - from real estate agencies.  Since the bulk of them duplicate the ads of apartment owners who have already been presented on the site, for further analysis, these data will be excluded.  However, this information will be used to determine a successful real estate agency based on the number of ads. </p><br><h4 id="problemnye-doma">  Distressed houses </h4><br><p>  To determine the problem house, it is necessary to determine the ratio of the number of ads in the house to the number of apartments in the house or in the residential complex, and compare this ratio with the average for the market.  But, if the data on the number of ads for the sale of apartments in a particular house are available in our database, then the total number of apartments in the house should be searched on other sites.  This work requires additional time, so we had to postpone this work for later, due to the lack of time. </p><br><h2 id="rielterskie-agentstva">  Real Estate Agencies </h2><br><p><img src="https://habrastorage.org/webt/8m/jb/h7/8mjbh7najy6lq8zuic0axcqtwkm.png" alt="image"></p><br><p>  This histogram reflects the number of submitted ads for the sale of apartments by real estate agencies in the period from April 14 to April 19, 2018 </p><br><p>  Most of the announcements were published by the ‚ÄúRealty‚Äù real estate agency, for a specified period the number of announcements was 1 929. Further, the real estate agencies such as ‚ÄúReal Price‚Äù, ‚ÄúVitrina‚Äù, ‚ÄúNovaya Ploshchadka‚Äù go on decreasing the number of announcements, they have more 500 listings </p><br><p> If we assume that the criterion of success in the real estate market in the field of real estate services is the number of advertisers (the more announcements, the greater the chances that the client will see them and contact the agency), then the undisputed leader is the Realtor Agency "Floor". </p><br><h2 id="rieltory-ili-skrytye-predprinimateli">  Realtors or hidden entrepreneurs? </h2><br><p><img src="https://habrastorage.org/webt/h7/lz/du/h7lzduarpg_va2hhbvb7ughwjyg.png" alt="image"></p><br><p>  This histogram shows the number of ads published from one phone number.  So the first column with the number ‚Äú2‚Äù shows that more than 1,460 people submitted more than 2 ads on the site. </p><br><p>  Many realtors, knowing about the negative attitude towards them, often serve ads as owners, as evidenced by the number and frequency of such ads. </p><br><p>  If I were a tax authority, I would first determine the TIN of the owners of the rooms, check the base for how much property was registered on it and the average tenure of the property, if the tenure is less than 1-2 years or he often buys and sells apartments for a short time at the same price (that is, supposedly without economic benefits), it is necessary to take a closer look at this owner. </p><br><h2 id="vyvod">  Conclusion </h2><br><p>  It should be noted that in this article the analysis of the data was superficial, and I was more eager to understand what difficulties and pitfalls could be encountered in obtaining and processing data, for example: </p><br><ol><li>  The lack of information to achieve the original goals, as for example in the case of the identification of problem homes. </li><li>  Limited time. </li><li>  It is necessary to precisely define the task and follow it.  During this analysis, we had to contend with an unbridled desire to look at everything from all sides, and ultimately a kind of struggle of ideas took place in my head. </li></ol><br><p>  Each considered question can be considered in more detail, for example, to determine the same problem houses not by the number of announcements, but by the frequency of their submission, but we will leave this for more inquisitive and people who have free time. </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/359459/">https://habr.com/ru/post/359459/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../359411/index.html">Open broadcast of the main hall RIT ++</a></li>
<li><a href="../359415/index.html">Adaptation of the blockchain to the Internet of things: the main problems</a></li>
<li><a href="../359429/index.html">Notes IoT provider. Zoo metering</a></li>
<li><a href="../359435/index.html">Yandex Blitz: machine learning</a></li>
<li><a href="../359451/index.html">Google I / O 2018 through the eyes of a mobile game developer + follow-up recommendations</a></li>
<li><a href="../359465/index.html">Riddles resume. Part 2. Font also matters.</a></li>
<li><a href="../359473/index.html">The digest of fresh materials from the world of the frontend for the last week ‚Ññ 316 (May 21 - 27, 2018)</a></li>
<li><a href="../359899/index.html">PHP Digest number 131 (May 13 - 27, 2018)</a></li>
<li><a href="../360329/index.html">Stephen Wolfram "Making Great Projects"</a></li>
<li><a href="../360491/index.html">Oil and gas dilemma: in search of alternative DBMS</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>