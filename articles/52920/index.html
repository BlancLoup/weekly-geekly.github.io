<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Writing a program for installing ringtones in Windows Mobile</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Windows Mobile, which is the fifth, and sixth, differs by far from the most convenient ringtone installation system. By the way, we past Palm Treo 650...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Writing a program for installing ringtones in Windows Mobile</h1><div class="post__text post__text-html js-mediator-article"><img src="http://pic.ipicture.ru/uploads/090225/ikWSSa0Y3x.jpg" align="left">  Windows Mobile, which is the fifth, and sixth, differs by far from the most convenient ringtone installation system.  By the way, we past Palm Treo 650 to us was even more nightmarish, but it's not about him.  Not only are we not allowed to put a melody on a group, so also all ringtones should be in the \ Windows \ Rings folder.  Yes, you can change through the registry, but this is ugly, and the problem with groups does not solve. <br><br>  <strong>What to do?</strong> <br><br>  At first, I turned my attention to something called <strong>PhotoContactsPro</strong> , which even mobile-review.com recommended in some of the articles as a good utility for setting ringtones on groups.  But here's a bad luck, this utility provides a whole shell for the phone, which I, for example, don‚Äôt need for nothing (and it also costs money).  When this shell is turned off, the assignment of melodies to the group, of course, is disabled. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Further, suddenly found the utility <strong>ToneManager</strong> .  The utility is good: small, free, does exactly what you need - hangs melodies in groups in Pocket Outlook.  But it works with exactly one folder (\ Windows \ Rings by default) and, unpleasantly, it does not know how to save its settings.  And to save the settings for such a program is extremely important, since everything that it does is put down melodies to contacts, I mean new contacts go through the forest until you start it again.  The author happily wrote in the release ‚Äúsorry, we will be saved in the next versions!‚Äù, But there is still no next version. <br><br>  Worn out with the search, I decided that this problem was an excellent reason to touch the Compact Framework and make my own utility. <br><br><blockquote>  <i>The author of the article is <a href="https://habrahabr.ru/users/wdk/" class="user_link">wdk</a> , but he, due to his karma, cannot publish the material.</i>  <i>If you liked the article, then help a good author to correct his karma and start writing useful articles.</i> <br></blockquote><br><a name="habracut"></a><br>  It turned out this: <br><div style="text-align:center;"><img src="http://s2.ipicture.ru/uploads/090219/a5QWZ511S5.png"></div><br><br>  <strong>What does it do?</strong> <br>  In principle, everything is clear from the screenshot.  You can choose a melody for a contact, for a group, for all contacts, you can wipe the global Windows ringtone with your melody (in Settings-&gt; Private-&gt; Phone).  You can choose melodies from wherever, including from a memory card.  Melodies are put on the list, the priority increases to the bottom. <br><br>  Works in WM5, WM6, tested on QVGA, VGA.  WM Smartphone does not want to work because of a couple of controls, there is something to think about.  The program also refused to work on the WM2003 emulator. <br><br>  Actually program: <a href="">werder.nm.ru/wToneManager_Installer.CAB</a> <br><br>  <strong>How does it work?</strong> <br>  Pulling contacts turned out to be very easy if you know about the build of <strong>Microsoft.WindowsMobile.PocketOutlook</strong> .  Create a Pocket Outlook session and, voila, everything you need is there: <br><br><blockquote><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">OutlookSession session = <font color="#0000ff">new</font> OutlookSession(); <br> ContactCollection contacts = session.Contacts.Items; <br> <br> <font color="#008000">// </font> <br> <font color="#0000ff">foreach</font> (Contact c <font color="#0000ff">in</font> contacts) <br> { <br> cbContacts.Items.Add(GetContactString(c)); <br> } <br> <br> <font color="#008000">// </font> <br> <font color="#0000ff">foreach</font> (Contact c <font color="#0000ff">in</font> contacts) <br> { <br> <font color="#0000ff">string</font> [] curCats = c.Categories.Split( <font color="#A31515">','</font> ); <br> <font color="#0000ff">foreach</font> ( <font color="#0000ff">string</font> cat <font color="#0000ff">in</font> curCats) <br> <font color="#0000ff">if</font> (!cbGroups.Items.Contains(cat) &amp;&amp; ! <font color="#2B91AF">String</font> .IsNullOrEmpty(cat.Trim())) <br> cbGroups.Items.Add(cat); <br> } <br> <br> <font color="#008000">//   ,   ,</font> <br> <font color="#008000">// Pocket Oulook    ,</font> <br> <font color="#008000">// foreach  </font> <br> <font color="#0000ff">for</font> ( <font color="#0000ff">int</font> i = 0; i &lt; contacts.Count; i++) <br> { <br> Contact c = contacts[i]; <br> c.RingTone = item.Tone; <br> c.Update(); <br> }</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  C playing melodies all the more interesting.  There are many ways to play a melody (wav, mp3, wma) in WM, and only one of them is good.  But first things first.  Method one is the standard PlaySound function from <strong>winmm.dll</strong> .  Needless to say that it can only play wav?  Therefore, we look in MSDN and find a great way - <strong>aygshell.dll</strong> library!  And mp3 is able to play, and the possibility of synchronous / asynchronous playback ... But here's a bad luck, it‚Äôs only in WM6, and the owners of devices on WM5 are mass, and I don‚Äôt want to offend them.  Looking further.  On the Internet, there are many tips to use the new <strong>SoundPlayer</strong> class from CF3.5.  I was ready to move to the third framework for the sake of this magical class, but what a surprise, this class refuses to play mp3, which is very strange. <br><br>  At this point, trying to play a melody with standard means got tired of it, and the thought appeared to use something third-party.  First, the choice fell on the <strong>FMOD</strong> library.  Impressed by the abundance of opportunities, a small wrapper was quickly written, it seemed to work and it was wonderful.  Until, while testing, a melody in the wma format was randomly chosen.  For unknown reasons, the WinOD FMOD version decisively refuses to play wma, although the developer claims the possibility. <br><br>  What remains?  He always stood modestly nearby and waited for attention to him.  Of course, this is <strong>Windows Media Player</strong> ! <br><br>  Connecting it is very simple - click Add Reference in the studio and find the% windir% \ System32 \ wmp.dll file.  Do not be afraid of the large size of this file, for our project will be attached to another library, Interop.WMPLib.dll, much smaller. <br><br>  It was much easier to play a melody in WMPLib than in the same FMOD: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="black">WMPLib.WindowsMediaPlayer wmp = <font color="#0000ff">new</font> WMPLib.WindowsMediaPlayer(); <br> <br> <font color="#008000">//      ,    ,     </font> <br> wmp.settings.setMode( <font color="#A31515">"Loop"</font> , <font color="#0000ff">false</font> ); <br> wmp.settings.volume = 100; <br> <br> <font color="#008000">//  </font> <br> wmp.URL = (cbTone.SelectedItem <font color="#0000ff">as</font> ListItem).Value; <br> wmp.controls.play();</font> <br> <br> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> </blockquote> <br><br>  As you can see, everything is extremely simple!  By the way, WMPLib turned out to be a very powerful library, a lot of events, playlists and many, many other things, but this is a topic for a separate article, and not just one. <br><br>  That's all, thank you for your attention, try, unsubscribe! <br><br> <a href="http://progg.ru/%25D0%259F%25D0%25B8%25D1%2588%25D0%25B5%25D0%25BC-%25D0%25BF%25D1%2580%25D0%25BE%25D0%25B3%25D1%2580%25D0%25B0%25D0%25BC%25D0%25BC%25D1%2583-%25D0%25B4%25D0%25BB%25D1%258F-%25D1%2583%25D1%2581%25D1%2582%25D0%25B0%25D0%25BD%25D0%25BE%25D0%25B2%25D0%25BA%25D0%25B8-%25D1%2580%25D0%25B8%25D0%25BD%25D0%25B3%25D1%2582%25D0%25BE%25D0%25BD%25D0%25BE%25D0%25B2-%25D0%25B2-Windows-Mobile"><img alt="Progg it" src="http://progg.ru/image.axd?url=http%3A%2F%2Fhabrahabr.ru%2Fblogs%2Fmobiledev%2F52920%2F"></a> <br></div><p>Source: <a href="https://habr.com/ru/post/52920/">https://habr.com/ru/post/52920/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../52909/index.html">We translate Cocoa to a web. 280 North's way.</a></li>
<li><a href="../52912/index.html">Russia has created a real combat robot to fight pirates</a></li>
<li><a href="../52914/index.html">Loudtalks Lite for Windows Mobile - turn your device into a walkie-talkie</a></li>
<li><a href="../52918/index.html">Getting Started - Part 4. Hardware Solutions (Part 2).</a></li>
<li><a href="../52919/index.html">Imagini: a little imagination = a lot of money</a></li>
<li><a href="../52921/index.html">ZumoDrive - now your iPhone can store up to 500 GB of music</a></li>
<li><a href="../52922/index.html">Toys are fashionable, stylish, fun!</a></li>
<li><a href="../52923/index.html">Do you click "preview" before posting a comment?</a></li>
<li><a href="../52924/index.html">Deferred: all the details</a></li>
<li><a href="../52927/index.html">Computer Science Student, Episode 6</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>