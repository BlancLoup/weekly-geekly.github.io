<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Deviation transformation and its use to determine the coordinate system for a set of distances</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 Applied mathematics can be considered as a set of tools that allow solving various problems arising in practice. In this article we wil...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Deviation transformation and its use to determine the coordinate system for a set of distances</h1><div class="post__text post__text-html js-mediator-article"><h2>  Introduction </h2><br>  Applied mathematics can be considered as a set of tools that allow solving various problems arising in practice.  In this article we will consider one of these tools - the <i>transformation of the deviation</i> applied to the analysis of the <a href="https://en.wikipedia.org/wiki/Euclidean_distance_matrix">matrix of Euclidean distances</a> .  The spectrum of the resulting matrix allows to judge the dimension of the source data and calculate the coordinates of the original points relative to its own center of coordinates. <br><br>  Suppose we have <b>n</b> &gt; 2 points and we know all the distances between them.  Potential dimensionality of space is <b>n-1</b> .  It is necessary to determine the space of a dimensionality given points, as well as the coordinates of points in this space. <br>  One of the indirect ways of determining the dimensionality of space based on the distance between points is the calculation of <a href="https://en.wikipedia.org/wiki/Distance_geometry">the Cayley-Menger determinant (KM)</a> .  However, this method is unsuitable for the analysis of spaces of large dimension. <br><a name="habracut"></a><br><h2>  1. Conversion deviation </h2><br>  So, we have at the input a certain symmetric matrix <b>M of</b> dimension <b>N</b> with zero trace (the elements of the main diagonal are equal to zero).  We need to define a transformation to some new matrix <b>U.</b>  The values ‚Äã‚Äãof the original matrix should be calculated from the new by the rules of the addition of distances: <br><br><img src="https://tex.s2cms.ru/svg/M_%7Bij%7D%3DU_%7Bii%7D%2BU_%7Bjj%7D-2U_%7Bij%7D%20%5Cquad%20(1.1)">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Then the values ‚Äã‚Äãof the matrix <b>M</b> can be expressed in terms of the spectrum <b>U</b> as a weighted sum of the difference of squares of the components of the eigenvectors: <br><br><img src="https://tex.s2cms.ru/svg/M_%7Bij%7D%3D%5Csum_%7Bk%7Ds_%7Bk%7D(x_%7Bik%7D-x_%7Bjk%7D)%5E2%20%5Cquad%20(1.2)"><br><br>  Here <img src="https://tex.s2cms.ru/svg/s_%7Bk%7D">  - a set of eigenvalues ‚Äã‚Äãof the matrix <b>U</b> , and <img src="https://tex.s2cms.ru/svg/x_%7Bik%7D">  - matrix of eigenvectors corresponding to eigenvalues.  The length of the vectors is normalized to 1. <br>  The general form of the matrix <b>U</b> , satisfying condition (1.1), is the expression: <br><br><img src="https://tex.s2cms.ru/svg/U(M)_%7Bij%7D%3D(V_%7Bi%7D%2BV_%7Bj%7D-M_%7Bij%7D-A)%2F2%20%5Cquad%20(1.3)"><br><br>  Here <img src="https://tex.s2cms.ru/svg/V_%7Bi%7D">  Is an arbitrary vector, and <img src="https://tex.s2cms.ru/svg/A">  Is an arbitrary constant.  To determine these values, you must specify additional conditions.  Such a condition is the requirement of the <i>Laplacian similarity of the</i> matrix <b>U.</b>  In the <a href="https://en.wikipedia.org/wiki/Laplacian_matrix">matrix of the Laplacian, the</a> elements of the main diagonal are equal to the sum of the elements of the corresponding column (row) with the opposite sign: <br><br><img src="https://tex.s2cms.ru/svg/U_%7Bii%7D%3D-%5Csum_%7Bj%7D%5E%7Bj%5Cneq%20i%7DU_%7Bij%7D%20%5Cquad%20(1.4)"><br><br>  Substituting (1.3) into (1.4) taking into account the symmetry of <b>M</b> , we obtain the identity: <br><br><img src="https://tex.s2cms.ru/svg/(A-V_i)n%3D%5Csum_%7Bj%7DV_j-%5Csum_%7Bj%7DM_%7Bij%7D%20%5Cquad%20(1.5)"><br><br>  from which we define the desired expressions for the vector and the constant: <br><br><img src="https://tex.s2cms.ru/svg/V_i%3D(1%2Fn)%5Csum_%7Bj%7DM_%7Bij%7D%3D%5Coverline%7BM_i%7D%20%5Cquad%20(1.6)"><br><img src="https://tex.s2cms.ru/svg/A%20%3D%20(1%2Fn)%5Csum_%7Bi%7DV_i%20%3D%20(1%2Fn%5E2)%5Csum_%7Bij%7DM_%7Bij%7D%3D%5Coverline%7BM_%7Bij%7D%7D%20%5Cquad%20(1.7)"><br><br>  Thus, the vector in (1.3) is the vector of the average values ‚Äã‚Äãof the row (column) of the original matrix (in terms of graphs, the mean cardinality / degree of the graph vertex), and the constant is the average value of the matrix as a whole (the average degree of the graph vertices): <br><br><img src="https://tex.s2cms.ru/svg/U(M)_%7Bij%7D%3D(%5Coverline%7BM_i%7D%2B%5Coverline%7BM_j%7D-%5Coverline%7BM_%7Bij%7D%7D-M_%7Bij%7D)%2F2%20%5Cquad%20(1.3')"><br><br>  The transformation (1.3 ') we called <i>the deviation transformation</i> , since it reflects the deviation (deviation) of the values ‚Äã‚Äãof the original matrix from the average values.  The result of the transformation will be called <i>the deviation matrix</i> . <br><br><h2>  2. Properties of the deviation matrix </h2><br>  The matrix is ‚Äã‚Äãdegenerate (zero determinant and one of the eigenvalues) is a consequence of the Laplacian requirement. <br>  The elements of the main diagonal of the deviation reflect the average values ‚Äã‚Äãof the original matrix: <br><br><img src="https://tex.s2cms.ru/svg/U(M)_%7Bii%7D%3D%5Coverline%7BM_i%7D-%5Coverline%7BM_%7Bij%7D%7D%2F2%20%5Cquad%20(2.1)"><br><br>  The deviation trace is associated with the average value of the initial matrix and can be expressed in terms of the sum of the eigenvalues: <br><br><img src="https://tex.s2cms.ru/svg/Tr(U)%3Dn%5Coverline%7BM_%7Bij%7D%7D%2F2%3D1%2F2%5Csum_%7Bi%7D%5Coverline%7BM_i%7D%3D%5Csum_%7Bi%7Ds_i%20%5Cquad%20(2.2)"><br><br>  The product of the eigenvalues ‚Äã‚Äãis proportional to the <i>potential</i> deviation - a non-zero <a href="https://en.wikipedia.org/wiki/Minor_(linear_algebra)">minor of the</a> matrix: <br><br><img src="https://tex.s2cms.ru/svg/P%3DM_%7Bii%7D(U)%3D1%2Fn%5Cprod_%7Bk%7Ds_k%20%5Cquad%20(2.3)"><br><br>  Deviation is reversible.  Based on the deviation matrix, you can restore the original: <br><br><img src="https://tex.s2cms.ru/svg/M_%7Bij%7D%3DU_%7Bii%7D%2BU_%7Bjj%7D-2U_%7Bij%7D%20%5Cquad%20(2.4)"><br><br>  Note that the deviation transform is abstract and is not associated precisely with the metric matrix.  Thus, the application of the deviation transform to the <a href="https://en.wikipedia.org/wiki/Resistance_distance">matrix of resistive distances</a> allows us to obtain the inverse matrix of the Laplacian from the conduction matrix.  That is, in the end, to restore the matrix of conductivity on the matrix of resistive distances. <br><br>  Next, we consider the application of the transformation of the deviation to the metric matrix (Euclidean distances). <br><br><h2>  3. Deviation of distances, own coordinate system </h2><br>  So, let at the entrance we have a set of points with given distances between them.  All distances are known ‚Äî between any pair ‚Äî the distance graph is complete.  Here we consider the direct problem - it is necessary to determine the dimension of the space to which the points and their coordinates in the given space belong. <br><br>  The initial set of distances is represented in the form of a symmetric matrix of <i>squares of distances</i> between points.  We denote this matrix as <b>D2</b> , where two means square.  The application of the deviation operation to the matrix of squares of distances gives the matrix of the deviation of distances <b>G</b> : <br><br><img src="https://tex.s2cms.ru/svg/G%3DU(D2)%20%5Cquad%20(3.1)"><br><br>  This matrix and its spectrum have remarkable properties.  Namely: <br><ul><li>  The number of nonzero eigenvalues ‚Äã‚Äã(the rank of the matrix) coincides with the dimension of the space in which the initial points are located. </li><li>  The values ‚Äã‚Äãof the eigenvectors are the coordinates of points in the new space. </li><li>  The symmetry of eigenvalues ‚Äã‚Äãreflects the symmetry of the relative position of points. </li></ul><br>  Thus, the spectrum of the distance deviation matrix determines <i>its own coordinate system of the</i> original set of points.  The weight of each coordinate is determined by the value of the spectrum (its own number).  The center of the new coordinate system is called the <a href="https://en.wikipedia.org/wiki/Centroid">centroid</a> .  On the main diagonal of the deviation matrix are located the squares of the distance from the centroid to the vertices: <br><br><img src="https://tex.s2cms.ru/svg/G_%7Bii%7D%3D%5Csum_%7Bk%7Ds_kx_%7Bik%7D%5E2%20%5Cquad%20(3.2)"><br><br>  The sum of all such distances (deviation trace) determines the average radius of the set <i>R2</i> .  This radius is equal to the sum of the spectrum values ‚Äã‚Äãand is related to the average value of the original distance matrix in accordance with formula (2.2): <br><br><img src="https://tex.s2cms.ru/svg/R2%3D%5Csum_%7Bi%7DG_%7Bii%7D%3D%5Csum_%7Bk%7Ds_k%3D(1%2F2n)%5Csum_%7Bij%7DD2_%7Bij%7D%20%5Cquad%20(3.3)"><br><br>  The centroid of the set minimizes the average dial radius.  That is, for any other position of the centroid, the average dialing radius will be more significant.  Adding the centroid itself to the original set of points does not change the spectrum, since the centroid of the new set coincides with the old one. <br><br><h2>  4. Spectra of some sets </h2><br><h3>  Spectra of three vertices (triangles) </h3><br>  So, we got a hammer in our hands.  Looking for nails. <br>  For one / two points, there is no special meaning to apply the deviation matrix.  Two non-identical points always belong to the same straight line, that is, one-dimensional space. <br>  But for three points options already appear.  The simplest case is the vertices of an equilateral triangle.  If the side length is 1, then the deviation matrix <img src="https://tex.s2cms.ru/svg/G_3(1%2C1%2C1)">  will look like: <br><br><img src="https://tex.s2cms.ru/svg/%5Cbegin%7Bbmatrix%7D%201%2F3%20%26%20-1%2F6%20%26%20-1%2F6%5C%5C%20-1%2F6%20%26%201%2F3%20%26%20-1%2F6%5C%5C%20-1%2F6%20%26%20-1%2F6%20%26%201%2F3%20%5Cend%7Bbmatrix%7D%20%5Cquad%20(3.2)"><br><br>  The trace of this matrix is ‚Äã‚Äã1, and the potential (1/3) ^ 2 - (1/6) ^ 2 = 1/9 - 1/36 = 1/12. <br>  Consider the spectrum (in brackets are the squares of the distances between the points): <br><br><img src="https://tex.s2cms.ru/svg/G_3(1%2C1%2C1)%3A%20s_i%2C%20x_%7Bij%7D%3D%5Cbegin%7Bbmatrix%7D%200.5%5C%5C0.5%20%5Cend%7Bbmatrix%7D%20%5Cbegin%7Bbmatrix%7D%20%5Csqrt%7B1%2F2%7D%20%26%20-%5Csqrt%7B1%2F2%7D%20%26%200%5C%5C%20%5C-%5Csqrt%7B1%2F6%7D%20%26%20-%5Csqrt%7B1%2F6%7D%20%26%20%5Csqrt%7B2%2F3%7D%20%5Cend%7Bbmatrix%7D%20%5Cquad%20(4.2)"><br><br>  Here, on the left, the eigenvalues ‚Äã‚Äãof the spectrum are shown, and on the right, the corresponding values ‚Äã‚Äãof the vectors (coordinates). <br>  We see that: <br><ul><li>  The spectrum has two meanings.  This is understandable - a non-degenerate triangle always belongs to a 2-dimensional space (plane). </li><li>  Both eigenvalues ‚Äã‚Äãare equal.  This is a consequence of the symmetry of an equilateral triangle. </li></ul><br>  Let's check the properties of the spectrum: the sum of the eigenvalues ‚Äã‚Äãis 1, the product is 1/2 * 1/2 = 1/4 = 1/12 * 3. That's right. <br><br>  In passing, we note that the spectrum of the three vertices is related to the area of ‚Äã‚Äãthe triangle formed by them (a kind of Heron's formula): <br><br><img src="https://tex.s2cms.ru/svg/S%5E2%3D3%2F4s_1s_2%20%5Cquad%20(4.3)"><br><br>  Accordingly, the square of the area of ‚Äã‚Äãan equilateral 1-triangle is 3/4 * 1/4 = 3/16. <br><br>  Moving on.  If the points belong to one straight line, then the spectrum should contain only one value. <br>  Calculate the value of the spectrum for the three points of the segment (two on the edges and one in the middle) <img src="https://tex.s2cms.ru/svg/G_3(1%2C1%2C4)">  .  We get: <br><br><img src="https://tex.s2cms.ru/svg/G_3(1%2C1%2C4)%3As_i%2C%20x_%7Bij%7D%3D%5Cbegin%7Bbmatrix%7D%202%20%5Cend%7Bbmatrix%7D%20%5Cbegin%7Bbmatrix%7D%20%5Csqrt%7B1%2F2%7D%20%26%200%20%26%20-%5Csqrt%7B1%2F2%7D%20%5Cend%7Bbmatrix%7D%20%5Cquad%20(4.4)"><br><br>  Indeed, the spectrum contains only one component.  The centroid is in the middle of the segment, as expected. <br><br>  Now we will ask a tricky question - what space does an impossible triangle belong to, that is, the one in which <a href="https://ru.wikipedia.org/wiki/%25D0%259D%25D0%25B5%25D1%2580%25D0%25B0%25D0%25B2%25D0%25B5%25D0%25BD%25D1%2581%25D1%2582%25D0%25B2%25D0%25BE_%25D1%2582%25D1%2580%25D0%25B5%25D1%2583%25D0%25B3%25D0%25BE%25D0%25BB%25D1%258C%25D0%25BD%25D0%25B8%25D0%25BA%25D0%25B0">the triangle inequality is</a> violated? <br><br><div class="spoiler">  <b class="spoiler_title">The answer is obvious to those who know it.</b> <div class="spoiler_text">  For the "triangle" type <img src="https://tex.s2cms.ru/svg/G_3(1%2C1%2C9)">  the spectrum will consist of two values ‚Äã‚Äã- one positive (4.5), and the other negative (-0.833). <br></div></div><br>  If the spectrum contains negative values, then this means that in a Euclidean space a set of points with such characteristics cannot be realized ‚Äî the coordinates of the points become imaginary.  You can use this spectrum property to check the validity of the distance matrix. <br><br><h2>  Respite </h2><br>  Let's pause and look around.  We defined the deviation transform and applied it to a matrix of squares of distances.  The resulting distance deviation matrix reflects the properties of the space of the original set of points. <br><br>  Numerically check the described properties for small matrices can be <a href="http://www.wolframalpha.com/">done</a> interactively using spreadsheets and the <a href="http://www.wolframalpha.com/">wolframalpha service</a> to calculate eigenvalues ‚Äã‚Äã/ vectors. <br><br>  If there are no large objections, then in the next article we will continue to consider the spectral properties of some standard sets of geometric points - gratings, figures, lines, and also look at the spectra of sets of figures. <br><br>  <a href="http://habrahabr.ru/post/262703/"><i>Continued ...</i></a> <br><cut></cut></div><p>Source: <a href="https://habr.com/ru/post/262601/">https://habr.com/ru/post/262601/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../262587/index.html">Report on the last meeting of Defcon Moscow</a></li>
<li><a href="../262589/index.html">Japanese fool</a></li>
<li><a href="../262593/index.html">Gaming News Digest: June</a></li>
<li><a href="../262595/index.html">Sentiment text analysis</a></li>
<li><a href="../262597/index.html">Cortana as a public analytics service and other announcements of the Microsoft World Partner Conference</a></li>
<li><a href="../262603/index.html">Writing a web service on Scalatra</a></li>
<li><a href="../262605/index.html">Migrate data from Oracle to PostgreSQL</a></li>
<li><a href="../262607/index.html">We give the right to choose access to the page using the Rules</a></li>
<li><a href="../262611/index.html">Mail.Ru Rating Launches Website Scan For Viruses</a></li>
<li><a href="../262613/index.html">Mail collector (making simple things difficult)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>