<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Explore Chinese routers on RT5350</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Once, lolipop bought a router on aliexpress. But not a simple router, but a very compact and cheap, with 2 Ethernet ports, USB, and even from a compan...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Explore Chinese routers on RT5350</h1><div class="post__text post__text-html js-mediator-article">  Once, <a href="http://habrahabr.ru/users/lolipop/" class="user_link">lolipop</a> bought a router on aliexpress.  But not a simple router, but a very compact and cheap, with 2 Ethernet ports, USB, and even from a company that sold its mp3 players in the Russian Federation in the early 2000s: Nexx WT1520H. <br><img src="https://habrastorage.org/getpro/habr/post_images/b78/24e/245/b7824e24579eecc6b5b9d5649bcfbb10.jpg" alt="image"><br>  Standard firmware, as almost always, was scarce, and, of course, I wanted to replace it with something more sane.  But bad luck - there are no alternative firmware for the router, and it is not clear how to flash it, because  no other firmware was received via the web interface, I had never seen a firmware header like this before, and didn‚Äôt find binwalk in it, so it was encrypted: <br><pre><code class="hljs ruby"><span class="hljs-number"><span class="hljs-number">00000000</span></span> <span class="hljs-number"><span class="hljs-number">32</span></span> <span class="hljs-number"><span class="hljs-number">33</span></span> <span class="hljs-number"><span class="hljs-number">35</span></span> <span class="hljs-number"><span class="hljs-number">30</span></span> <span class="hljs-number"><span class="hljs-number">6</span></span>b d9 <span class="hljs-number"><span class="hljs-number">39</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span> 0e <span class="hljs-number"><span class="hljs-number">02</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-params"><span class="hljs-params">|2350k.9.........|</span></span> <span class="hljs-number"><span class="hljs-number">00000010</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">00</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>e <span class="hljs-number"><span class="hljs-number">19</span></span> <span class="hljs-number"><span class="hljs-number">53</span></span> c5 <span class="hljs-params"><span class="hljs-params">|............&gt;.S.|</span></span> <span class="hljs-number"><span class="hljs-number">00000020</span></span> <span class="hljs-number"><span class="hljs-number">63</span></span> f5 <span class="hljs-number"><span class="hljs-number">51</span></span> <span class="hljs-number"><span class="hljs-number">9</span></span>f <span class="hljs-number"><span class="hljs-number">82</span></span> <span class="hljs-number"><span class="hljs-number">74</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>d <span class="hljs-number"><span class="hljs-number">03</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>e <span class="hljs-number"><span class="hljs-number">2</span></span>f <span class="hljs-number"><span class="hljs-number">1</span></span>f <span class="hljs-number"><span class="hljs-number">32</span></span> <span class="hljs-number"><span class="hljs-number">9</span></span>c <span class="hljs-number"><span class="hljs-number">4</span></span>a <span class="hljs-number"><span class="hljs-number">93</span></span> <span class="hljs-number"><span class="hljs-number">96</span></span> <span class="hljs-params"><span class="hljs-params">|cQ.t-../.2.J..|</span></span> <span class="hljs-number"><span class="hljs-number">00000030</span></span> <span class="hljs-number"><span class="hljs-number">15</span></span> <span class="hljs-number"><span class="hljs-number">82</span></span> <span class="hljs-number"><span class="hljs-number">23</span></span> d<span class="hljs-number"><span class="hljs-number">0</span></span> b2 <span class="hljs-number"><span class="hljs-number">7</span></span>e d7 <span class="hljs-number"><span class="hljs-number">1</span></span>b <span class="hljs-number"><span class="hljs-number">13</span></span> c3 <span class="hljs-number"><span class="hljs-number">1</span></span>b <span class="hljs-number"><span class="hljs-number">1</span></span>f <span class="hljs-number"><span class="hljs-number">06</span></span> fa f8 e<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-params"><span class="hljs-params">|..#..~..........|</span></span> <span class="hljs-number"><span class="hljs-number">00000040</span></span> bb <span class="hljs-number"><span class="hljs-number">43</span></span> <span class="hljs-number"><span class="hljs-number">9</span></span>b c6 ee fc <span class="hljs-number"><span class="hljs-number">4</span></span>b <span class="hljs-number"><span class="hljs-number">7</span></span>a e6 <span class="hljs-number"><span class="hljs-number">50</span></span> <span class="hljs-number"><span class="hljs-number">71</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>b f4 f3 <span class="hljs-number"><span class="hljs-number">95</span></span> c3 <span class="hljs-params"><span class="hljs-params">|.C....Kz.Pq+....|</span></span> <span class="hljs-number"><span class="hljs-number">00000050</span></span> <span class="hljs-number"><span class="hljs-number">63</span></span> d<span class="hljs-number"><span class="hljs-number">0</span></span> a3 <span class="hljs-number"><span class="hljs-number">9</span></span>c <span class="hljs-number"><span class="hljs-number">92</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>e <span class="hljs-number"><span class="hljs-number">16</span></span> c6 <span class="hljs-number"><span class="hljs-number">19</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>c <span class="hljs-number"><span class="hljs-number">4</span></span>a <span class="hljs-number"><span class="hljs-number">93</span></span> cb <span class="hljs-number"><span class="hljs-number">95</span></span> c3 <span class="hljs-number"><span class="hljs-number">63</span></span> <span class="hljs-params"><span class="hljs-params">|c.........J....c|</span></span> <span class="hljs-number"><span class="hljs-number">00000060</span></span> d2 <span class="hljs-number"><span class="hljs-number">9</span></span>b <span class="hljs-number"><span class="hljs-number">1</span></span>a f5 <span class="hljs-number"><span class="hljs-number">2</span></span>e <span class="hljs-number"><span class="hljs-number">16</span></span> c6 <span class="hljs-number"><span class="hljs-number">19</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span>c <span class="hljs-number"><span class="hljs-number">4</span></span>a <span class="hljs-number"><span class="hljs-number">93</span></span> f9 <span class="hljs-number"><span class="hljs-number">68</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span>c <span class="hljs-number"><span class="hljs-number">9</span></span>c <span class="hljs-number"><span class="hljs-number">73</span></span> <span class="hljs-params"><span class="hljs-params">|.........J..h&lt;.s|</span></span> <span class="hljs-number"><span class="hljs-number">00000070</span></span> <span class="hljs-number"><span class="hljs-number">14</span></span> <span class="hljs-number"><span class="hljs-number">63</span></span> d5 <span class="hljs-number"><span class="hljs-number">10</span></span> <span class="hljs-number"><span class="hljs-number">5</span></span>e d3 <span class="hljs-number"><span class="hljs-number">6</span></span>b <span class="hljs-number"><span class="hljs-number">25</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>b c2 <span class="hljs-number"><span class="hljs-number">2</span></span>e <span class="hljs-number"><span class="hljs-number">07</span></span> eb <span class="hljs-number"><span class="hljs-number">85</span></span> <span class="hljs-number"><span class="hljs-number">73</span></span> <span class="hljs-number"><span class="hljs-number">25</span></span> <span class="hljs-params"><span class="hljs-params">|.c..^.k%+.....s%|</span></span> <span class="hljs-number"><span class="hljs-number">000000</span></span>8<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">9</span></span>b <span class="hljs-number"><span class="hljs-number">6</span></span>b c<span class="hljs-number"><span class="hljs-number">0</span></span> f2 d8 <span class="hljs-number"><span class="hljs-number">9</span></span>b cf <span class="hljs-number"><span class="hljs-number">65</span></span> <span class="hljs-number"><span class="hljs-number">56</span></span> ac a9 c2 <span class="hljs-number"><span class="hljs-number">28</span></span> <span class="hljs-number"><span class="hljs-number">61</span></span> dd <span class="hljs-number"><span class="hljs-number">55</span></span> <span class="hljs-params"><span class="hljs-params">|.k.....eV...(aU|</span></span> <span class="hljs-number"><span class="hljs-number">000000</span></span>9<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">18</span></span> a4 <span class="hljs-number"><span class="hljs-number">5</span></span>b e9 ba <span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-number"><span class="hljs-number">93</span></span> ec <span class="hljs-number"><span class="hljs-number">30</span></span> <span class="hljs-number"><span class="hljs-number">76</span></span> <span class="hljs-number"><span class="hljs-number">4</span></span>f <span class="hljs-number"><span class="hljs-number">40</span></span> c1 f<span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-number"><span class="hljs-number">7</span></span>c cb <span class="hljs-params"><span class="hljs-params">|..[.....0vO@..|</span></span>.<span class="hljs-params"><span class="hljs-params">| 000000a0 36 d3 b3 93 fe 3d 6b 10 66 fa 43 39 f2 f6 c0 91 |</span></span><span class="hljs-number"><span class="hljs-number">6</span></span>....=kfC9....<span class="hljs-params"><span class="hljs-params">|</span></span></code> </pre> <br>  <a href="http://habrahabr.ru/users/lolipop/" class="user_link">lolipop</a> merged data from a flash drive through a programmer, and we started poking around at them. <a name="habracut"></a><br><br><h4>  Firmware study </h4><br>  For the entire process of initializing the hardware and running the programs, its own init is responsible - / sbin / rc.  This is such a combo abruptly busybox, which contains almost all the logic of the router: <br><div class="spoiler">  <b class="spoiler_title">Hidden text</b> <div class="spoiler_text"><pre> <code class="hljs mel">.<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E758</span></span> .globl start_services .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E758</span></span> start_services: # CODE XREF: main+<span class="hljs-number"><span class="hljs-number">14</span></span>C8p .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E758</span></span> # DATA XREF: main+<span class="hljs-number"><span class="hljs-number">14</span></span>C0o ... .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E758</span></span> .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E758</span></span> var_10 = <span class="hljs-number"><span class="hljs-number">-0x10</span></span> .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E758</span></span> var_8 = <span class="hljs-number"><span class="hljs-number">-8</span></span> .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E758</span></span> .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E758</span></span> li $gp, <span class="hljs-number"><span class="hljs-number">0x7EBF8</span></span> .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E760</span></span> addu $gp, $t9 .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E764</span></span> addiu $sp, <span class="hljs-number"><span class="hljs-number">-0x20</span></span> .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E768</span></span> sw $ra, <span class="hljs-number"><span class="hljs-number">0x20</span></span>+var_8($sp) .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E76</span></span>C sw $gp, <span class="hljs-number"><span class="hljs-number">0x20</span></span>+var_10($sp) .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E770</span></span> la $t9, start_syslog .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E774</span></span> nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E778</span></span> jalr $t9 ; start_syslog .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E77</span></span>C nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E780</span></span> lw $gp, <span class="hljs-number"><span class="hljs-number">0x20</span></span>+var_10($sp) .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E784</span></span> nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E788</span></span> la $t9, start_proftpd .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E78</span></span>C nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E790</span></span> jalr $t9 ; start_proftpd .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E794</span></span> nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E798</span></span> lw $gp, <span class="hljs-number"><span class="hljs-number">0x20</span></span>+var_10($sp) .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E79</span></span>C nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E7</span></span>A0 la $t9, start_telnetd .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E7</span></span>A4 nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E7</span></span>A8 jalr $t9 ; start_telnetd .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E7</span></span>AC nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E7</span></span>B0 lw $gp, <span class="hljs-number"><span class="hljs-number">0x20</span></span>+var_10($sp) .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E7</span></span>B4 nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E7</span></span>B8 la $t9, load_smb_driver .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E7</span></span>BC nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E7</span></span>C0 jalr $t9 ; load_smb_driver .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E7</span></span>C4 nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E7</span></span>C8 lw $gp, <span class="hljs-number"><span class="hljs-number">0x20</span></span>+var_10($sp) .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E7</span></span>CC nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E7</span></span>D0 la $t9, sys_led_init .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E7</span></span>D4 nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E7</span></span>D8 jalr $t9 ; sys_led_init .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E7</span></span>DC li $a0, <span class="hljs-number"><span class="hljs-number">2</span></span> .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E7</span></span>E0 lw $gp, <span class="hljs-number"><span class="hljs-number">0x20</span></span>+var_10($sp) .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E7</span></span>E4 nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E7</span></span>E8 la $t9, start_upnp .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E7</span></span>EC nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E7</span></span>F0 jalr $t9 ; start_upnp .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E7</span></span>F4 nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E7</span></span>F8 lw $gp, <span class="hljs-number"><span class="hljs-number">0x20</span></span>+var_10($sp) .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E7</span></span>FC nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E800</span></span> la $t9, start_dhcpd .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E804</span></span> nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E808</span></span> jalr $t9 ; start_dhcpd .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E80</span></span>C nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E810</span></span> lw $gp, <span class="hljs-number"><span class="hljs-number">0x20</span></span>+var_10($sp) .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E814</span></span> nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E818</span></span> la $t9, start_ntpc .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E81</span></span>C nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E820</span></span> jalr $t9 ; start_ntpc .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E824</span></span> nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E828</span></span> lw $gp, <span class="hljs-number"><span class="hljs-number">0x20</span></span>+var_10($sp) .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E82</span></span>C nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E830</span></span> la $t9, start_dns .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E834</span></span> nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E838</span></span> jalr $t9 ; start_dns .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E83</span></span>C nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E840</span></span> lw $gp, <span class="hljs-number"><span class="hljs-number">0x20</span></span>+var_10($sp) .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E844</span></span> nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E848</span></span> la $t9, start_ddns .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E84</span></span>C nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E850</span></span> jalr $t9 ; start_ddns .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E854</span></span> nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E858</span></span> lw $gp, <span class="hljs-number"><span class="hljs-number">0x20</span></span>+var_10($sp) .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E85</span></span>C nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E860</span></span> la $t9, start_igmp_proxy .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E864</span></span> nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E868</span></span> jalr $t9 ; start_igmp_proxy .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E86</span></span>C nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E870</span></span> lw $gp, <span class="hljs-number"><span class="hljs-number">0x20</span></span>+var_10($sp) .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E874</span></span> nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E878</span></span> la $t9, start_ipmac_bind .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E87</span></span>C nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E880</span></span> jalr $t9 ; start_ipmac_bind .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E884</span></span> nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E888</span></span> lw $gp, <span class="hljs-number"><span class="hljs-number">0x20</span></span>+var_10($sp) .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E88</span></span>C nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E890</span></span> la $t9, start_block_ipmac .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E894</span></span> nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E898</span></span> jalr $t9 ; start_block_ipmac .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E89</span></span>C nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E8</span></span>A0 lw $gp, <span class="hljs-number"><span class="hljs-number">0x20</span></span>+var_10($sp) .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E8</span></span>A4 nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E8</span></span>A8 la $t9, start_block_port .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E8</span></span>AC nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E8</span></span>B0 jalr $t9 ; start_block_port .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E8</span></span>B4 nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E8</span></span>B8 lw $gp, <span class="hljs-number"><span class="hljs-number">0x20</span></span>+var_10($sp) .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E8</span></span>BC nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E8</span></span>C0 la $t9, start_ddos .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E8</span></span>C4 nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E8</span></span>C8 jalr $t9 ; start_ddos .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E8</span></span>CC nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E8</span></span>D0 lw $gp, <span class="hljs-number"><span class="hljs-number">0x20</span></span>+var_10($sp) .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E8</span></span>D4 nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E8</span></span>D8 la $t9, start_monitor_rate .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E8</span></span>DC nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E8</span></span>E0 jalr $t9 ; start_monitor_rate .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E8</span></span>E4 nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E8</span></span>E8 lw $gp, <span class="hljs-number"><span class="hljs-number">0x20</span></span>+var_10($sp) .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E8</span></span>EC nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E8</span></span>F0 la $t9, start_upgraded .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E8</span></span>F4 nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E8</span></span>F8 jalr $t9 ; start_upgraded .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E8</span></span>FC nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E900</span></span> lw $gp, <span class="hljs-number"><span class="hljs-number">0x20</span></span>+var_10($sp) .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E904</span></span> nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E908</span></span> la $t9, start_conntrack_limit .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E90</span></span>C nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E910</span></span> jalr $t9 ; start_conntrack_limit .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E914</span></span> nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E918</span></span> lw $gp, <span class="hljs-number"><span class="hljs-number">0x20</span></span>+var_10($sp) .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E91</span></span>C nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E920</span></span> la $t9, start_macfilter .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E924</span></span> nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E928</span></span> jalr $t9 ; start_macfilter .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E92</span></span>C nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E930</span></span> lw $gp, <span class="hljs-number"><span class="hljs-number">0x20</span></span>+var_10($sp) .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E934</span></span> nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E938</span></span> la $t9, start_black_management .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E93</span></span>C nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E940</span></span> jalr $t9 ; start_black_management .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E944</span></span> nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E948</span></span> lw $gp, <span class="hljs-number"><span class="hljs-number">0x20</span></span>+var_10($sp) .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E94</span></span>C nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E950</span></span> la $t9, start_wlan_wps .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E954</span></span> nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E958</span></span> jalr $t9 ; start_wlan_wps .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E95</span></span>C nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E960</span></span> lw $gp, <span class="hljs-number"><span class="hljs-number">0x20</span></span>+var_10($sp) .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E964</span></span> nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E968</span></span> la $t9, start_trakerurl .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E96</span></span>C nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E970</span></span> jalr $t9 ; start_trakerurl .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E974</span></span> nop .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E978</span></span> lw $gp, <span class="hljs-number"><span class="hljs-number">0x20</span></span>+var_10($sp) .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E97</span></span>C lw $ra, <span class="hljs-number"><span class="hljs-number">0x20</span></span>+var_8($sp) .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E980</span></span> <span class="hljs-keyword"><span class="hljs-keyword">move</span></span> $v0, $zero .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E984</span></span> jr $ra .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E988</span></span> addiu $sp, <span class="hljs-number"><span class="hljs-number">0x20</span></span> .<span class="hljs-keyword"><span class="hljs-keyword">text</span></span>:<span class="hljs-number"><span class="hljs-number">0040E988</span></span> # End of function start_services</code> </pre> </div></div><br>  By deduction and nmap, it was found out that telnetd was launched on the router, which is accessible via the WAN interface!  Here it is!  However, it was impossible to log in either as the root user or as the admin user. <br>  As telnetd performs busybox.  Let's look at it (the login_main function): <br><br><img src="http://i.imgur.com/RyGwcg5.png" alt="image">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      T-aa-ak, now allows to enter a password, but the standard password "admin" is not accepted.  Interesting.  Look further: <br><br><img src="http://i.imgur.com/A7AMEkJ.png" alt="image"><br><br>  That's how it is!  Login nexxadmin, password y1n2inc.com0755, with access via WAN. <br>  There is mtd_write in the firmware, so nothing prevents us from pouring OpenWRT right into the flash right now, which was done by <a href="http://habrahabr.ru/users/lolipop/" class="user_link">lolipop</a> , but it was still interesting to reverse the encryption algorithm.  Unfortunately, my MIPS assembly skills in my head are clearly not enough, and I experienced great discomfort just by looking at all this code, so I ordered the same router for myself, and, oh, a miracle, after 2 months I had it. <br><br><h4>  We continue the study </h4><br><img src="http://i.imgur.com/idQLgwv.jpg" alt="image"><br>  <i>Only RX is connected, the ground is shared with a laptop by USB-powered.</i> <br><br>  The router can be updated either via the web interface or via tftp (which, again, listens to the WAN!).  The tftp daemon (upgraded from rc) seems to be broken, because  updating through it did not lead to updating the firmware in the router, although there were no errors.  It should be noted that updating firmware via tftp requires authentication with the same password as on the web interface, so it‚Äôs hard to call it backdoor, rather, it‚Äôs just an incorrectly configured service. <br><br>  I decided to investigate the firmware update through tftp. <br>  A simple upgrade via a standard tftp client resulted in ‚ÄúUpgrade not possible: Incorrect Password‚Äù from upgraded.  Let's take a look at it: <br><br><img src="http://i.imgur.com/fvpz50G.png" alt="image"><br><br>  Regular clients do not seem to be able to send tftp options, so I downloaded the <a href="http://tftpy.sourceforge.net/">tftpy</a> python library, modified one line in the sample client file, and it all worked: <br><pre> <code class="hljs mel">--- tftpy_client.py <span class="hljs-number"><span class="hljs-number">2014</span></span><span class="hljs-number"><span class="hljs-number">-09</span></span><span class="hljs-number"><span class="hljs-number">-30</span></span> <span class="hljs-number"><span class="hljs-number">21</span></span>:<span class="hljs-number"><span class="hljs-number">48</span></span>:<span class="hljs-number"><span class="hljs-number">57.375550027</span></span> +<span class="hljs-number"><span class="hljs-number">0400</span></span> +++ tftpy_client.py_ <span class="hljs-number"><span class="hljs-number">2014</span></span><span class="hljs-number"><span class="hljs-number">-09</span></span><span class="hljs-number"><span class="hljs-number">-30</span></span> <span class="hljs-number"><span class="hljs-number">21</span></span>:<span class="hljs-number"><span class="hljs-number">48</span></span>:<span class="hljs-number"><span class="hljs-number">50.355520342</span></span> +<span class="hljs-number"><span class="hljs-number">0400</span></span> @@ <span class="hljs-number"><span class="hljs-number">-83</span></span>,<span class="hljs-number"><span class="hljs-number">7</span></span> +<span class="hljs-number"><span class="hljs-number">83</span></span>,<span class="hljs-number"><span class="hljs-number">7</span></span> @@ progresshook = Progress(tftpy.<span class="hljs-keyword"><span class="hljs-keyword">log</span></span>.info).progresshook - tftp_options = {} + tftp_options = {<span class="hljs-string"><span class="hljs-string">'admin'</span></span>: <span class="hljs-string"><span class="hljs-string">''</span></span>} <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> options.blksize: tftp_options[<span class="hljs-string"><span class="hljs-string">'blksize'</span></span>] = <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>(options.blksize) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> options.tsize:</code> </pre> <br>  Fine!  Now it remains to deal with encryption firmware.  In rc, there is a decrypto function, it looks like this: <br><br><img src="http://i.imgur.com/SqyVPoY.png" alt="image"><br><br>  I could not find the key in the statics, so I started debugging.  To debug something on the device, of course, you must first build a debugger.  linux_server from IDA Pro is not built for MIPS (and the router is built on this architecture), so it was necessary to somehow build gdbserver as a router.  The router uses the old-age kernel 2.6.21 with uClibc 0.9.28.  First of all, I decided to use buildroot, so that he and the toolchain with uClibc assembled, and gdbserver statically.  Ok, everything is set up, it seems to start, however, when debugging via IDA Pro, the server is constantly crashing, some strange errors ptrace gives, well, I think you need to rebuild it with headers from the 2.6.21 kernel and with uClibc 0.9.28, t .to.  uClibc never promised binary compatibility.  On the Internet, I found the <a href="https://github.com/stevenylai/ralink_sdk">Ralink SDK</a> with the correct kernel version and uClibc.  The GDBServer compiled by this toolchain behaved one-to-one like the old one.  Unfortunately, IDA Pro has some incompatibility with gdbserver, which is running on MIPS.  Fortunately, gdbserver works fine with regular gdb compiled under mips (./configure --target mipsel-linux). <br>  I very rarely debug something in bare gdb, and convenient add-ins and scripts for it work only with x86 and ARM.  Fortunately, I found a <a href="https://github.com/zcutlip/gdbinit-mips">repository with .gdbinit for MIPS</a> , and the convenience of debugging has increased noticeably.  Everything happened like this: <br><br><img src="http://i.imgur.com/Ip9As13.png" alt="image"><br><br>  Ultimately, the key was found only a few lines above, which was to be expected: <br><br><img src="http://i.imgur.com/sDeBLH9.png" alt="image"><br><br>  After I wrote a script to decrypt the firmware, <a href="http://habrahabr.ru/users/lolipop/" class="user_link">lolipop</a> sent me another one with a similar header, but from another router.  The first 4 characters (magic) she had were R3G2.  Looking for this line in Google, it turned out that everything was already done before us, even as early as the beginning of 2013: ( <br>  In any decrypted firmware there is a line of Linux Kernel Image, which is always at the same offset.  This string is longer than the XOR key, which means that we do not need to get it from rc from different manufacturers, and we can simply ‚Äúfind‚Äù it from this string. <br><br>  But it is not enough just to unpack the firmware; you also need to pack it in order to be able to update it via the web interface.  As it turned out, the update function contains the checksum calculation of the firmware: <br><br><img src="http://i.imgur.com/ikPlfdl.png" alt="image"><br><br>  What looks like in C like this: <br><pre> <code class="hljs matlab"> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">i</span></span>=<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">i</span></span>&lt;f.len<span class="hljs-number"><span class="hljs-number">-1</span></span>; <span class="hljs-built_in"><span class="hljs-built_in">i</span></span>+=<span class="hljs-number"><span class="hljs-number">2</span></span>) { checksum += (data[<span class="hljs-built_in"><span class="hljs-built_in">i</span></span>+<span class="hljs-number"><span class="hljs-number">1</span></span>] &lt;&lt; <span class="hljs-number"><span class="hljs-number">8</span></span> ) | data[<span class="hljs-built_in"><span class="hljs-built_in">i</span></span>]; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (<span class="hljs-built_in"><span class="hljs-built_in">i</span></span> &lt; f.len) { checksum += data[<span class="hljs-built_in"><span class="hljs-built_in">i</span></span>]; printf(<span class="hljs-string"><span class="hljs-string">"Got odd byte: 0x%02X\n"</span></span>, data[<span class="hljs-built_in"><span class="hljs-built_in">i</span></span>]); <span class="hljs-built_in"><span class="hljs-built_in">i</span></span>+=<span class="hljs-number"><span class="hljs-number">1</span></span>; } checksum = checksum + (checksum &gt;&gt; <span class="hljs-number"><span class="hljs-number">16</span></span>) + <span class="hljs-number"><span class="hljs-number">0xffff</span></span>; checksum = ~(checksum + (checksum &gt;&gt; <span class="hljs-number"><span class="hljs-number">16</span></span>)) &amp; <span class="hljs-number"><span class="hljs-number">0xffff</span></span>; printf(<span class="hljs-string"><span class="hljs-string">"Checksum = 0x%04X\n"</span></span>, checksum); data[<span class="hljs-built_in"><span class="hljs-built_in">i</span></span>] = checksum &amp; <span class="hljs-number"><span class="hljs-number">0xFF</span></span>; data[<span class="hljs-built_in"><span class="hljs-built_in">i</span></span>+<span class="hljs-number"><span class="hljs-number">1</span></span>] = (checksum &gt;&gt; <span class="hljs-number"><span class="hljs-number">8</span></span>) &amp; <span class="hljs-number"><span class="hljs-number">0xFF</span></span>;</code> </pre> <br>  Now we have everything we need to upload any firmware via the web interface. <br><br><h4>  Links </h4>  <a href="https://github.com/kaechele/firmware-tools">Decrypt</a> <br>  <a href="https://forum.openwrt.org/viewtopic.php%3Fpid%3D198608">Cipher</a> <br><br><h4>  Conclusion </h4>  This method is suitable for many SoC RT5350 devices.  This is probably some kind of regular way to update the firmware from the SDK. <br>  Firmware with backdoor and such poor quality force the consumer to look for normally working software for the device.  <a href="http://habrahabr.ru/users/lolipop/" class="user_link">lolipop has</a> <a href="http://patchwork.openwrt.org/patch/6287/">added support for this device</a> in OpenWRT, and it will soon be added to Trunk.  Also, yesterday, the release of OpenWRT Barrier Breaker finally came out!  (Announcement on the site yet). <br>  That's how we live. </div><p>Source: <a href="https://habr.com/ru/post/238713/">https://habr.com/ru/post/238713/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../238703/index.html">And once again about GIL in Python</a></li>
<li><a href="../238705/index.html">Does Russia need the support of national software developers? Once upon a time in Russia</a></li>
<li><a href="../238707/index.html">Layfkhaki manual testing on mobile phones from 2GIS - Report from the conference SQA Days 15</a></li>
<li><a href="../238709/index.html">Get familiar with the WinJS library controls.</a></li>
<li><a href="../238711/index.html">ZeroNights 2014 - hackquest</a></li>
<li><a href="../238715/index.html">Charge me completely! Panacea for iPhone 5 / 5S owners</a></li>
<li><a href="../238721/index.html">This is Motorola Nexus 6: 5.9 inches and 3200 mAh</a></li>
<li><a href="../238723/index.html">HP offers free licenses of the Virtual Storage Appliance</a></li>
<li><a href="../238725/index.html">How to create viral content: a success formula</a></li>
<li><a href="../238727/index.html">Lost data among the "clouds"?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>