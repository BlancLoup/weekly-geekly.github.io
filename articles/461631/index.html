<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>17 ways to penetrate the company‚Äôs internal network</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Safety The word meaning the security of a person or organization from something / someone. In the era of cybersecurity, we are increasingly thinking n...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>17 ways to penetrate the company‚Äôs internal network</h1><div class="post__text post__text-html js-mediator-article"> <b>Safety</b>  The word meaning the security of a person or organization from something / someone.  In the era of <b>cybersecurity,</b> we are increasingly thinking not so much about how to protect ourselves physically, but about how to protect ourselves from external threats ( <b>cyber threats</b> ). <br><br>  Today we‚Äôll talk about how you can penetrate a modern corporate network, which is protected on the perimeter by various, even very good, means of network security, and most importantly, we‚Äôll talk about how to deal with this. <br><br><img src="https://habrastorage.org/webt/m_/su/lw/m_sulwcoiihsgxf7z0shbkdai_0.jpeg" alt="image">
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Let's look at a modern network that uses the latest technology in the field of security. <a name="habracut"></a><br><br><img src="https://habrastorage.org/webt/ux/vl/as/uxvlas8xqyrpyxak9rwnee2k_ze.jpeg" alt="image"><br><br>  You have a perimeter protected, there are various Firewalls, Next-Generation Firewalls and many other perimeter security tools. <br><br>  <b>What are the options for penetrating your corporate network and in which cases your Next-Generation Firewall will not help you in any way?</b> <br><br>  Think for a moment.  Try to answer this question, but I would like to give a few examples that can demonstrate that no matter how powerful, cool, widely advertised, that fall in the best squares, circles, Gartner, Forest curves and so on, the products you did not use, anyway There is the possibility of attackers attacking your corporate or departmental network, and therefore you need to look a little wider than the perimeter defense. <br><br>  So, one of the examples that Cisco has come across is the <b>use of DNS to steal information</b> . <br><br><img src="https://habrastorage.org/webt/w2/py/0o/w2py0oh5t8n0nveny4alr43kx4y.jpeg" alt="image"><br><br>  Typically, cybercriminals use the DNS protocol to either load some new modules or use DNS as an interaction between already installed modules inside a corporate / departmental network on infected computers with some ‚Äúcommand servers‚Äù.  In this case, the DNS protocol was used to leak information in the domain name.  According to statistics, most domains, third-level domain names contain no more than 25-30 characters, however, we see that on the right graph, our domain lengths are 200-230 characters. <br><br>  A person is not able to come up with this kind of domain.  He is not able to remember him either.  In its pure form, it is a kind of <b>‚Äúanomaly‚Äù</b> that can tell us that either domains are used for some marketing purposes, but usually these long ones are not even used for marketing purposes, or it is the actions of attackers.  And in this case, 1 of the DNS servers serving this malicious domain was used to ensure that the domain names containing sufficiently long text strings ( <b>231</b> characters) were decrypted and stolen credit card numbers were revealed in them.  As we understand, given that DNS is the de facto standard for the modern Internet, corporate or departmental networks, we <b>cannot</b> block DNS and even inspecting the DNS on the Firewall does not always help us, because in this case the attackers used a non-standard approach to circumvent perimeter protection. <br><br><img src="https://habrastorage.org/webt/fa/8y/fe/fa8yfea2q_2rpx7d8axqw2gqdte.gif" alt="image"><br><br>  <b>Another example</b> <br><br>  This is an illustration from a Cisco wireless network monitoring system.  You see the location of legally installed access points ( <b>green circles</b> ) on the map of the building, but note that here we see that there are unauthorized wireless access points ( <b>red circles</b> ), as well as wireless, unauthorized foreign clients who are trying to connect to a corporate wireless network ( <b>gray rectangles</b> ).  It is clear that this method of connection also bypasses the perimeter, also does not go through corporate Firewalls, and if access points were not protected, attackers could penetrate the corporate network bypassing the perimeter, bypassing the NG Firewalls standing on this same perimeter.  In addition, if an attacker can create a fake access point, then the client who connected to the access point may not even know about it, while the attacker can intercept data that is transmitted from the client.  It can be a smartphone, it can be a tablet, laptop or even a stationary computer that connected to an unauthorized, alien, fake access point and in this case, unfortunately, the Firewalls did not help us either. <br><br>  <b>Another example</b> <br><br>  Following this incident, Cisco substantially changed the security architecture of network equipment.  Hardware and software components were added that allow you to track bookmarks in the equipment, as well as prevent the appearance of these bookmarks, but at the beginning of the 2000s there were such examples. <br><br><img src="https://habrastorage.org/webt/ln/tw/mn/lntwmn9dcjqdkzxk_jhisdjhk-u.jpeg" alt="image"><br><br>  There were several of them that we managed to fix, and in this case we are faced with a situation where, as part of a certain delivery, the customer receives equipment with a pre-installed malicious code.  Since he initially trusts his supplier, he does not think about the need to check network equipment.  Verification can be done through software that the customer can download from the official website.  This is necessary in order to make sure that the equipment does not have any bookmarks and it does not steal information that is transmitted through a network device.  Also, there were several cases when administrators without a contract for technical support for the equipment they purchased, were forced to download new firmware from third-party sites.  This also led to the fact that these firmware contained malicious code that ‚Äúmirrored‚Äù all traffic and sent it to the attacker.  That is, in this case, we also understand that classic perimeter security tools cannot do anything about this, because the bookmarks are on the equipment <b>facing the</b> firewalls. <br><br>  You can recall a <b>more recent example</b> when Cisco (its division of Cisco Talos) discovered a threat called VPN-Filter, when attackers infected various network devices of various manufacturers (D-Link, Asus, etc.) and installed the corresponding malicious code on them, which also steal traffic and redirect it to attackers.  That is, underestimating this problem leads to the fact that the lower level of the network infrastructure remains completely unprotected and no firewalls, of course, help here, since network devices are located <b>before the</b> firewalls and they can transmit all traffic, especially if It is not encrypted, by intruders. <br><br><img src="https://habrastorage.org/webt/cr/vi/d9/crvid9exl_atyw0i1kjyl9zzhzs.jpeg" alt="image"><br><br>  <b>One more example</b> <br><br>  2 years ago (in 2017), attackers found a vulnerability on the web portal of one of the largest credit bureaus Equifax.  This vulnerability allowed to access the Web portal and execute some commands on it.  After identifying the vulnerability, the attackers launched an exploit and gained access to the system with administrative rights.  No data was stolen at that time.  That is, the attackers only tested the very possibility of working on the Web portal with administrative rights.  But then after about 2 months, a vulnerability that for some reason was not resolved was exploited. <br><br><img src="https://habrastorage.org/webt/ez/4r/cw/ez4rcwvv3o0i9y3vhdbl3ulln7u.jpeg" alt="image"><br><br>  Attackers entered the internal systems of the credit bureau and disguised their activities from network security.  First, due to the trusting relationship between the Web portal and internal servers, including database servers, the security system did not control the connection data in any way and allowed the attacker to enter the corporate network.  In addition, the attackers used an encrypted connection and it remained uncontrolled in terms of network security.  For several months, the attacker managed to steal information, as a result of which <b>more than 140 million</b> citizens of the United States, Great Britain and several other countries were affected whose data was stolen as a result of this attack, despite the availability of perimeter protection, which, unfortunately, in this case does not did not help. <br><br><img src="https://habrastorage.org/webt/mz/t_/ff/mzt_ffuypmiymssrrkja8wv-goa.jpeg" alt="image"><br><br>  <b>Another example</b> <br><br>  Another example occurred in the last year of 2018 when, in the two-week period between August 21 and September 5, a hacker group called Magic Art hacked British Airways‚Äôs servers and stole <b>380,000 customers'</b> data, including personal data and credit card information.  According to British Airways, about <b>half a million customers</b> suffered in <b>two weeks</b> . <br><br><img src="https://habrastorage.org/webt/mm/n3/-2/mmn3-2bgxlhwivebe4q5wiojyca.jpeg" alt="image"><br><br>  The most interesting thing is that the attackers did not even try to penetrate the corporate network!  They hacked into the airline‚Äôs website, replaced the script that collected customer data and forwarded this data to a malicious resource that was controlled by attackers.  Also, according to one version of this incident, it is considered that the attackers did not hack into the main site of British Airways, but its cached copy (CDN, used by communication providers to cache popular resources).  Thus, perimeter defense did not help to defend against this attack. <br><br><img src="https://habrastorage.org/webt/in/-n/k2/in-nk2vby33mwlcbmg376fghum4.jpeg" alt="image"><br><br>  <b>Another attack</b> , called the ‚Äúwater hole‚Äù, which was recorded some time ago by US law enforcement.  Attacks against a number of energy companies in the United States of America were recorded, and a very unconventional scheme was identified as part of the investigation, which, however, has since become quite popular. <br><br>  Why is it called a watering place? <br><br>  If we recall the life of animals (especially animals of Africa), then during a drought, many animals come to rare watering places that did not dry out during a drought and nature makes it so that the animals do not attack each other during a watering, but the fact is that just on the way to the watering place, predators very often wait for animals and eat them in order to feed themselves and their herds, prides and so on (depending on which predator we are talking about).  So the attackers took advantage of exactly the same strategy. <br>  Instead of breaking the victim companies, on which they focus their efforts, there can be many such companies (units, tens or even hundreds).  Sometimes it‚Äôs enough to hack just one software manufacturer, from the site of which then everyone starts to download software updates (new firmware, patches, updates or new software versions).  If the manufacturer was hacked, then along with these updates that are downloaded from his website, it is possible to place malicious code on the network of the victim company, which then makes it easier for hackers to develop a bridgehead inside the victim‚Äôs already compromised network.  That is, in such a roundabout way, but the hackers achieved their goal.  This kind of attack was recorded in 2016 in the United States of America.  After that, there were several similar scenarios.  Just recently (at the end of 2018), an attack was recorded on Asus, which distributed malicious updates from its website.  The same thing was done by Avast, which distributed an infected program for defragmenting and optimizing the operation of a Windows system called CCleaner.  This malicious campaign was detected and uncovered by Cisco Talos in 2017. <br><br>  These are all examples when it is far from always necessary to crack the victim‚Äôs company itself.  You can hack into the organizations serving it and due to some trusting relationships between the victim company and the hacked company, all communications between it are subject to less control and this is actively used by attackers. <br><br><img src="https://habrastorage.org/webt/ly/cb/uu/lycbuu8rv0vfa_828z_rhlpp0eg.jpeg" alt="image"><br><br>  <b>Finally, the last and one of the most recent examples.</b> <br><br>  On June 18, 2019, NASA's aerospace agency recorded and announced that hackers had already entered the internal network of one of its units (one of its laboratories) in April 2018.  That is, they for a long time went unnoticed and were able to steal more than 500 MB of data on the mission to Mars.  The most interesting thing that happened was due to the introduction of the Raspberry Pi hardware portable computer, which was installed on the NASA network and which stole information and transmitted it outside. <br><br>  <b>These examples all demonstrate very well that even the presence of very powerful, well-designed, well-designed perimeter defense systems does not guarantee that intruders will not penetrate.</b> <br><br><img src="https://habrastorage.org/webt/r5/zf/mo/r5zfmo58c_o9jh-anrkoiijxzb0.jpeg" alt="image"><br><br>  This is due to the fact that they have <b>17 channels of penetration into our organization</b> , some of which we have already watched. <br><br>  There are some channels that are beyond the scope of the review (for example, a regular VPN connection, or a site-to-site VPN with remote sites, or Remote Access VPN with remote users), but if there is a secure connection over it, in addition to completely legal traffic , can penetrate and malicious in the internal network of the company.  USB flash drives thrown in the parking lot in front of the organization‚Äôs entrance are also a favorite tool that cybercriminals use to bypass perimeter means of corporate information security or departmental information security, because such a USB stick is inserted into the computer and bypasses all perimeter protection means.  One can only hope that something more modern than the antivirus obsolete by ideology is installed on the computer, which does not see any targeted attacks aimed at organizing. <br><br>  Another example Cisco encountered two years ago. <br><br>  The CEO of a large Russian energy company ‚Äúinfected‚Äù on his home laptop with malicious code WannaCry.  This happened on Friday night, just as WannaCry began to spread around the world.  On Saturday morning, the director brought an infected laptop to work.  Well, where else to bring it?  There are no IT specialists at home, but they are at work. <br><br>  While these specialists, urgently called by the CEO, were driving to work, the malicious code managed to spread through the corporate network, because the CEO connected this laptop to the corporate network.  He connected automatically, after which even the corporate network isolated from the outside world suffered from WannaCry. <br><br>  It is clear that Cisco can have many more such examples when a high-ranking or authorized employee, manager, middle or senior manager brings a home device to work, which for some reason can be infected.  It may even be not only an employee.  It may be an auditor.  This may be a contractor who brings this kind of device as part of certain routine maintenance on the protected site.  For example, in 2003, it was because of the contractor who connected his laptop to the internal network at the Davis ‚Äì Besse nuclear power plant in the United States of America that the nuclear power plant was infected by the Conficker worm, which led to the shutdown of the reactor and a blackout on the entire east coast of the USA . <br><br>  Another example when they work with perimeter protection methods is developers who work on DevOps, who usually have their own ‚Äúrules of the game‚Äù, who like to work not on computers issued by the company, but on their laptops with their own software, which you can always put some means of protection and this is a kind of "entry point" into the corporate network, or the introduction of bookmarks in the software developed in the organization. <br><br>  Finally, we must not forget about the clouds. <br><br>  If your organization uses clouds extensively, no corporate perimeter protection will help.  It is necessary to expand the security system outside the perimeter and monitor the internal infrastructure. <br><br><img src="https://habrastorage.org/webt/zj/f3/cu/zjf3cuyuludi7gcxubpp_zpbke4.jpeg" alt="image"><br><br>  The NetFlow protocol, which was originally developed for Troubleshooting, to analyze network traffic statistics, will help in this, but due to its capabilities, especially due to the advanced features that exist in the ninth version of the NetFlow protocol, or in its standardized version of IPFIX, it is possible to answer questions who are interested from the point of view of information security (who ?, what ?, when?, how?, in what volume? carried out certain interactions).  Then, having imposed the appropriate decision-making algorithms on it, it becomes possible to draw conclusions about the presence of a particular threat, one or another anomaly, which may be interesting in the context of information security. <br><br><img src="https://habrastorage.org/webt/j5/yk/1q/j5yk1q55xgz-st6waesu3s4v_g0.jpeg" alt="image"><br><br>  One example of a solution that uses this particular design for informational purposes is the <b>Cisco Stealthwatch solution</b> . <br><br>  This is a solution that analyzes Flow protocols (not only NetFlow).  It can be sFlow, Jflow, IPFIX, NetStream - it doesn‚Äôt matter.  That is, this solution will work not only on the Cisco infrastructure, but also on the infrastructure of other vendors (including even Russian manufacturers that support the protocol with Flow), or when it is possible to transfer traffic via PAN, or Airspan to Cisco Stealthwatch and By analyzing the existing infrastructure, it is possible to identify certain anomalies, certain threats in the corporate or departmental network. <br><br>  One of the key differences between this approach and perimeter protection is that the administrator does not need to install separate sensors, separate taps in the control points of the network at control points.  Cisco is turning the existing network infrastructure into this kind of distributed monitoring system. <br><br><img src="https://habrastorage.org/webt/bj/cp/vk/bjcpvk5btd4wntv0ar_zhhp3w-o.jpeg" alt="image"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In its minimum solution, the Cisco stealthwatch consists of two components - Flow Collector, which collects data from devices supporting Flow protocols and a management console that is responsible for management, visualization, report generation, and so on. In those cases, if for some reason the device either does not support Flow, or support for enabling Flow leads to a significant processor load, you can use the so-called ‚ÄúFlow sensors‚Äù. This is a hardware or virtual solution that passes network traffic through itself, transmits it to NetFlow and transfers it to the Flow Collector. Thus, it is possible to connect some equipment to the Flow Sensor than connect the span port that initially does not support the Flow protocol and provide full and greater visibility of the internal network, not just its perimeter.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In addition to Flow sensors, there is also such a component as UDP Direcrot, which allows you to efficiently process data from remote sites. When there is a weak Internet channel between the remote site and headquarters, but NetFlow data must be transmitted, UDP Direcrot optimizes the transmission of such traffic.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In addition, Cisco has developed a special protocol nvzFlow, which allows you to integrate the network component with the host, and through the Network Visibility module, the module that is built into AnyConnect (this is a software security client that installs on Windows, Linux, Mac OS, iOS, Android, and so on ) Thanks to this, it became possible to translate the behavior of the node, the behavior of user applications into a protocol similar to NetFlow and to automatically correlate events that occur on nodes with events that occur at the network level, thereby improving the state of information security monitoring in a corporate or departmental network.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Another element that can send data to the Flow Collector is a proxy server, and thus you can correlate the network layer data that is obtained after analyzing NetFlow or other Flow protocols and the application layer that we receive from various proxy servers, thereby making it possible record the work of encryptors, interaction with command servers, network operation by the Tor network, and so on. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In order to collect evidence of unlawful activity, in order to store it, conduct an investigation, or transfer it to law enforcement, Cisco Stealthwatch solutions integrate with the Cisco Security Packet Analyzer component, which just stores all the information necessary for further investigation and interaction with law enforcement agencies.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The most interesting thing is that this solution works not only inside the corporate / departmental network, not only inside the data center, not only inside the industrial site (for example, in the automated process control system), but it can also work on various cloud platforms, thereby a single solution allows you to see different areas corporate or departmental network. To see anomalies in them, to see a threat and to signal accordingly and, if necessary, block these threats, relying not only on what passes through the corporate perimeter. If you notice some kind of flash drive, unprotected Wi-Fi, dropped Raspberry Pi into the corporate network and so on, the perimeter will not see this. This will see a Stealthwatch that properly monitors everything that passes through the network infrastructure.As if it were disguised as an attacker, it will always go through the switches and routers that we have located on the corporate or departmental network. He can‚Äôt bypass them in principle, and in this case Stealthwatch works, which sees all network traffic and, due to the imposition of a large number of different algorithms, can detect various anomalies or threats.</font></font><br><br>  It looks as follows. <br><br><img src="https://habrastorage.org/webt/ty/fb/w-/tyfbw-devedw1k7wihgp1j8ktw0.jpeg" alt="image"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The picture shows the top nodes that are fixed for a certain time interval. One of these nodes has the address 10.201.3.149. This is a workstation. It is in the user device group. It can be seen when and what activity occurred on this node. You can see which policies are applied to this node. It can be seen what kind of user is working on this node, for example due to integration with the Active directory. Thus, we know a specific user, a specific employee of the organization, who works at a particular moment on this host and this allows for more rapid investigation of incidents. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">But this is far from all that can be seen.</font></font><br><br><img src="https://habrastorage.org/webt/fg/li/lh/fglilh0buknhs2idcrhtwxvghpw.jpeg" alt="image"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Suppose we see events with a very high level of suspicion, the so-called "Concern Index" and want to get more detailed information about what is hidden behind this event. We want to get all associated connections associated with this threat of information leakage. </font></font><br><br><img src="https://habrastorage.org/webt/rl/3q/0b/rl3q0b1nxyfbirx62bjxmy7l7bm.jpeg" alt="image"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Having done this, it was discovered that the intruder uses the SSH protocol to capture data from the internal corporate network. Please note that while only about one gigabyte of data was sent from the attacker's site, more than 160 GB of data was received. It is possible that we are talking about an attacker who is trying to capture data that he manages to "reach out" and download it to his computer.</font></font> For what? <br><br><img src="https://habrastorage.org/webt/yn/2r/rx/yn2rrxor68mrbvwxpuyu61-t_pg.jpeg" alt="image"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Here Stealthwatch also helps. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In this case, it can be seen that the hacker "merges" the data through an HTTPS connection somewhere to an external host. That is, perhaps this is really an attacker who, as if recalling the story of Snowden, at the beginning copied to himself all the data that he could reach, and then he tries to transfer it outside the company. In the case of Snowden, he did this on external media, taking him outside the checkpoint. In the case of this case, the attacker is trying to "merge" the data via HTTPS out to some command server, to the cloud, or somewhere else. </font></font><br><br><img src="https://habrastorage.org/webt/kz/nl/il/kznlil571dn7ax3wiocrcpvn7n4.jpeg" alt="image"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Another example of how Cisco Stealthwatch can help. For example, the spread of worms or malicious code within the corporate network.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Usually, in order to fix this, you need to have agent / agents on the host. There may be an antivirus. It could be a class decision and an EDR (endpoint detection and response). It may be something else that, by analyzing the activity on the node, detects the actions of malicious code. But what should we do if we cannot install agents on the nodes (for example, these agents too ‚Äúeat up‚Äù processor power, or increase the load on it, or ‚Äúeat up‚Äù RAM)? The computer slows down and therefore does not want to put any protective agents on it (for example, in the data center). Or this is a segment on which you can‚Äôt put any protective agents at all. It can be an industrial segment (ACS TP), it can be a segment with operating systems for which protective agents have not been developed.</font></font> There can be many reasons.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In other words, in the absence of host protections, engineers remain blind. They have the only data source for detecting malicious activity - this is network traffic and Stealthwatch again helps here, which in this case recorded the actions of malicious code. Node scanning events are visible, and in the details of this event, you can see that this activity is inherent in the spread of worms over the network. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This can be visualized. </font></font><br><br><img src="https://habrastorage.org/webt/ug/fg/8g/ugfg8gdpaiwbr7ju5om6czpajog.jpeg" alt="image"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Vizit in this form.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Visualization is taking place and we can understand where the starting point was, who further came under the distribution and quickly localize the problem, preventing it from developing on our network, preventing the attacker from expanding the "bridgehead" in our corporate or departmental network. And what to do in situations where attackers begin to actively use encryption, as for example the case with Equifax?</font></font><br><br><img src="https://habrastorage.org/webt/qv/gy/rk/qvgyrk3ggbrejlie0pdj7f4lacg.gif" alt="image"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Unfortunately, according to Cisco statistics, cybercriminals over the past year have 3 times increased the number of malicious programs that they use for their activities, or rather, to hide it - encryption. It is known from theory that the ‚Äúcorrect‚Äù encryption algorithm cannot be hacked. In order to understand what is hidden inside the encrypted traffic, you must either decrypt it knowing the key, or try to decrypt it with various tricks, or by hacking it in the forehead, or using some vulnerabilities in cryptographic protocols. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In fact, it turned out that in practice there are other methods of analyzing encrypted traffic </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">without decrypting it</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. This method is simply called "machine learning." It turned out that if a very large amount of various traffic used by cybercriminals was applied to the input of a special classifier and trained to classify this kind of malicious action, even inside encrypted traffic that we cannot decrypt or decrypt, the system can </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">detect</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> with a very high degree of probability </font><font style="vertical-align: inherit;">malicious code inside encrypted traffic. </font></font><br><br><img src="https://habrastorage.org/webt/xi/jz/bo/xijzbomfdh90wtlax5wualhuo7e.jpeg" alt="image"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Please note the detection accuracy is </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">99.99%</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. False positives are hundredths of a percent. That is, based on the analysis of telemetry that Cisco receives from network equipment, even without any cryptographic transformations, it can be said that malicious activity is hidden inside this or that encrypted traffic and this allows more efficient monitoring of the internal infrastructure. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Today, many companies, many service applications are moving to the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">TLS 1.3 protocol.</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">which cannot be decrypted initially. That is, it is specially designed so that it is impossible to make even the legal Man In The Middle. This is done to ensure the privacy of user data. This user privacy, unfortunately, does not play into the hands, but against corporate security services, which earlier (before TLS 1.3) could still decrypt traffic on the perimeter using various SCAffolders, but now, unfortunately, do it already impossible. But the technology that is embedded in Cisco Stealthwatch called </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Encrypted Traffic Analytics</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> allows you to </font><font style="vertical-align: inherit;">understand what is inside </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">without decrypting traffic</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Of course, no one will understand what is written there.</font></font> It's impossible.<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cryptography works here. But you can understand the type of this traffic and if it is malicious, then make the appropriate decisions. </font></font><br><br><img src="https://habrastorage.org/webt/f-/vm/nu/f-vmnuzatmt0plcyalhpktpj5n8.jpeg" alt="image"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Here's what the Encrypted Traffic Analytics technology looks like. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It can be seen that information is being leaked (‚ÄúExfiltration‚Äù inscription - data leak) from a particular node, which a user by the name of Roland Torsiello is working on and the ‚ÄúEncrypted‚Äù mark is visible. This means traffic is encrypted. That is, despite the presence of encryption, it is still possible to record the fact of information leakage, that is, damage to the corporate resource. </font></font><br><br><img src="https://habrastorage.org/webt/wm/dv/hd/wmdvhdtksor_otem8gutv3sgozk.jpeg" alt="image"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I want to note that the Cisco Stealthwatch solution has a number of very important features. Important benefits.</font></font><br><br><ul><li> -,    <b> </b> ,             . </li><li> -,  <b>  </b>   . Cisco     ,         , Cisco       . </li><li>   <b>   </b> .        ,    ,      .      Flow            . </li><li>  And the most interesting.   ,   Cisco Stealthwatch     Cisco,      ,   <b>    Cisco</b> ,      .   , Cisco Vendor Agnostic (  ).    ¬´¬ª  .    Cisco,    Huawei,    Juniper, 3com, Hewlett,       , , Zelax,    . <b>  </b> ,     Flow,  SPAN/RSPAN       . </li></ul><br><img src="https://habrastorage.org/webt/yy/ry/vh/yyryvht4zquppb5yvl3si9xxvts.jpeg" alt="image"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">After some malicious activity was recorded, the question arises: ‚ÄúHow to block it?‚Äù. </font></font><br><br><img src="https://habrastorage.org/webt/ta/op/vd/taopvdixva1zreo0umtwmlwkvuw.jpeg" alt="image"><br><img src="https://habrastorage.org/webt/yb/g7/hc/ybg7hclq_uwiooys_z66ypis4xm.jpeg" alt="image"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In this case, the </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Cisco ISE (Identity Services Engine)</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> solution is very suitable </font><font style="vertical-align: inherit;">, which turns a network infrastructure that has already turned into a distributed attack detection system, and Cisco ISE turns it into a </font></font><b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">distributed firewall</font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. This is when each switch, each router, each access point is used as a decision point - ‚Äústart up or not start up?‚Äù, ‚ÄúStart up the user?‚Äù, ‚ÄúStart up the device?‚Äù, ‚ÄúStart up the application?‚Äù To the requested resource. Cisco ISE turns the existing infrastructure (and not only the origin of Cisco, this can be done on other vendors) into a distributed firewall. If NG Firewalls (for example, Cisco FirePower) and NGIPS (for example, Cisco Firepower IPS) are usually used on the perimeter, then you can use the Cisco Stealthwatch and Cisco ISE bundles in the internal network.</font></font><br><br><img src="https://habrastorage.org/webt/g5/jb/5i/g5jb5iwmtxc-jnge3canecbqh9m.jpeg" alt="image"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Together, they allow you to monitor and control access to the internal infrastructure, significantly reducing the attack area and, most importantly, that they can be integrated with perimeter defense tools and they have a single end-to-end security policy. </font><font style="vertical-align: inherit;">In the event that the Cisco solution is not on the perimeter, anyway, due to Cisco ISE, you can create a single end-to-end security policy, thereby increasing the security of corporate / departmental resources from the actions of attackers who have learned how to bypass the perimeter protection system in different ways. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Video presentation:</font></font><br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/kWWp9DT54tY" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Audio presentation: </font></font><br><br><div class="oembed"> <a href="https://soundcloud.com/babaika2504/17hack/s-vEJTG"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">https://soundcloud.com/babaika2504/17hack/s-vEJTG</font></font></a> </div><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> For all the information provided, many thanks to Cisco and </font></font><p> <a href="https://habr.com/ru/users/alukatsky/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Alexey Lukatsky</font></font></a> </p></div><p>Source: <a href="https://habr.com/ru/post/461631/">https://habr.com/ru/post/461631/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../46162/index.html">iQue Grill - grill with computer and built-in stereo system</a></li>
<li><a href="../461621/index.html">Is it hard to write your first VHDL program?</a></li>
<li><a href="../461623/index.html">How we made the engine and the game on it for a year and a half</a></li>
<li><a href="../461625/index.html">The digest of interesting materials for the mobile # 308 developer (on July 22 - 28)</a></li>
<li><a href="../461629/index.html">12 steps to find remote work</a></li>
<li><a href="../461633/index.html">Digital events in Moscow from July 29 to August 04</a></li>
<li><a href="../461637/index.html">Saudi prince plans to build a city of the future with artificial rain, smart systems and genetic medicine</a></li>
<li><a href="../46164/index.html">Internet in space</a></li>
<li><a href="../461641/index.html">Problem solving with pwnable.kr 11-coin1, 12-blackjack, 13-lotto. Errors in application logic</a></li>
<li><a href="../461643/index.html">How did you go to the Alfa Bank School of System Analysis?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>