<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Using GWT with Documentum & Webtop</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 In this article, I would like to talk about a small study on the crossover of GWT and Webtop. 
 First I will answer the legitimate ques...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Using GWT with Documentum & Webtop</h1><div class="post__text post__text-html js-mediator-article"><h4>  Introduction </h4><br>  In this article, I would like to talk about a small study on the crossover of GWT and Webtop. <br>  First I will answer the legitimate question: ‚ÄúWhy is this necessary?‚Äù.  I pursued several goals: <br>  1) Examine the GWT. <br>  2) To study in more detail the insides of WDK and Webtop. <br>  3) It is possible to find a way to create GWT components for the webtop. <br>  GWT was chosen because it allows you to quickly create UI and client-side Java code to programmers.  It also supports AJAX out of the box. <br>  It was the bundle with Webtop that was used, rather than creating your application from scratch, since it would take more time (Documentum session support, invention of action and precondition replacement) and would not allow using already written code on Webtop. <br><a name="habracut"></a><br><h4>  Border conditions </h4><br>  According to the logic of working with objects: <br>  CRUD, business transactions on objects. <br>  Ability to work with action and, as a result, Webtop's precondition.  Those.  A way to call the action and check the precondition for the action from the client must be provided. <br><br>  According to the contents of the objects: <br>  Maximum 100 attributes.  Maximum 100 repeating attribute values. <br><br>  By UI: <br>  GWT must be integrated into an existing solution on the Webtop.  At least at the level of a separate component.  Those.  It should be possible to call the GWT component from a simple Webtop component.  (The word ‚Äúcomponent‚Äù refers to the standard Webtop component) And there must also be a way to exit the GWT component back to its calling component. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Comment: <br>  Below are the main aspects of GWT that I will use.  I want to draw your attention to the fact that I will not consider in detail the work with each technology - the article is not about that.  If you want to read about something in more detail - links at the end of the article. <br><br><h4>  Ui </h4><br>  To create a UI, I first tried the simple GWT method - a la Swing, when widgets' are created directly in the code.  It turned out well - all the code in one file and it is immediately clear that where it is created.  But when the form becomes quite large (at least more than 100 lines) and many listeners of events appear on the form, the code becomes overloaded and difficult to read. <br>  In contrast to creating widgets from GWT code, there is another mechanism - UI Builder.  The main difference - the UI is described separately from the logic in the xml file.  Of the minuses of the UI Builder - not all widget's available in GWT are available in the UI Builder component palette.  I would even say that widget's support in the Window Builder is very limited.  So in the end, if you need to do something specific (at least add a column to the table), you will have to write code. <br><br><h4>  Receiving objects by the client </h4><br>  All work with Documentum objects will be performed through a call to server methods.  It remains only to determine how to organize this work.  The first obvious way is to use standard RPC from GWT.  We simply create the necessary service, which will be responsible for processing any database object ‚Äî for example, an employee service and an organization service for working with objects.  The objects in this case are the POJOs that are transferred between the client and the server.  In articles on GWT there is a note on how to organize work with Hibernate <a href="https://developers.google.com/web-toolkit/articles/using_gwt_with_hibernate%3Fhl%3Dru-RU">developers.google.com/web-toolkit/articles/using_gwt_with_hibernate?hl=en-RU</a> <br>  There is considered a similar way of communication.  The difference (besides being used by Hibernate) in the use of DTO is the data transfer object.  Following from the title and from the wiki, these are intermediate objects for transferring database entities to the client.  They are needed in order to minimize the sending of unnecessary data to the client.  Those.  there is an entity containing 100 attributes, but the client will only use 10. This is how a special DTO is created for the desired entity with these 10 fields. <br>  The advantages of this method are very simple to understand and implement. <br>  Cons - use DTO or, otherwise, the potential transfer of a large number of unnecessary attributes of the object to the client. <br>  The second way is Request Factory.  This is an alternative to RPC, designed just to perform CRUD operations on objects.  The main difference from a simple RPC call is that the objects on which operations take place are immediately separated into two categories ‚Äî the objects that the server manipulates and the presentation objects (inherited from EntityProxy) that the client manipulates.  In principle, proxy objects are nothing more than DTO.  Just in this case, the transformation of the main object in the DTO deals with GWT. <br>  Discussion on StackOverflow about RPC and RequestFactory <a href="http://stackoverflow.com/questions/4119867/when-should-i-use-requestfactory-vs-gwt-rpc">stackoverflow.com/questions/4119867/when-should-i-use-requestfactory-vs-gwt-rpc</a> <br>  The method is certainly interesting, but it requires writing additional code.  Besides, I didn‚Äôt like the implicit dependency between the methods inheriting from RequestContext and the objects that implement these methods, as well as between getter &amp; setters Proxy objects and the objects themselves.  Although for the first case GWT uses a validation module for RequestFactory which finds inconsistencies at compile time. <br><br><h4>  Passing parameters between Webtop and GWT </h4><br>  After searching, I found several ways to pass parameters to GWT - via JSP (inserting values ‚Äã‚Äãinto JS and then parsing), via url (parsing get request) and using a servlet that will return parameters. <br>  For Webtop, the JSP version is a good fit, since the component assumes the presence of a jsp page, which will just contain the parameter insertion code, and the component will allow forwarding these parameters in the JSP. <br>  To do this, in jsp you need to add this code: <br><pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="actionscript"><span class="actionscript"> </span><span class="hljs-keyword"><span class="actionscript"><span class="hljs-keyword">var</span></span></span><span class="actionscript"> wdk2gwt_param = </span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">'${wdk2gwtParam}'</span></span></span><span class="actionscript">; </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Here is described the JS variable wdk2gwt_param which will be assigned the value of the attribute wdk2gwtParam. <br><br>  And in the code components for writing parameters to write this: <br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@Override</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onRender</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ getPageContext().setAttribute(‚Äúwdk2gwtParam‚Äù, ‚Äú ‚Äù); <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>.onRender(); }</code> </pre><br>  Here, when displaying the page, we assign the wdk2gwtParam attribute, which was described above in jsp, value. <br><br>  To be able to exit a component, add an event handling method: <br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">onReturnClick</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Control control, ArgumentList list)</span></span></span><span class="hljs-function"> </span></span>{ setComponentReturn(); }</code> </pre><br>  Here the standard method of the component (setComponentReturn ()) is called, which allows you to return to the component that called it. <br><br>  And in the GWT above, use the following methods: <br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">native</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getParam</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-comment"><span class="hljs-function"><span class="hljs-comment">/*-{ return $wnd.wdk2gwt_param; }-*/</span></span></span></span>; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">native</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">callPostServerEvent</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span><span class="hljs-comment"><span class="hljs-function"><span class="hljs-comment">/*-{ $wnd.postServerEvent(null, null, null, ' onReturnClick ', null, null); }-*/</span></span></span></span>;</code> </pre><br><br>  Here is the standard way to call JS code from Java code.  In the getParam () method, it simply returns the value of the variable wdk2gwt_param (which was specified in jsp).  In the callPostServerEvent () method, the standard JS function WDK is used to call the component's methods.  In this case, the onReturnClick method, which was described above, is called.  For the JS function postServerEvent to work, it must first be defined.  To do this, the following tags must be specified in jsp: &lt;dmf: webform /&gt; and &lt;dmf: form&gt; <br>  In this regard, the full jsp code will look like this: <br><br><pre> <code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%@</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">page</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">contentType</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/html; charset=UTF-8"</span></span></span><span class="hljs-tag">%&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">%@</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">taglib</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">uri</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/WEB-INF/tlds/dmform_1_0.tld"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">prefix</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"dmf"</span></span></span><span class="hljs-tag">%&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dmf:webform</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">title</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">head</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dmf:form</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">type</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"text/javascript"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="actionscript"><span class="actionscript"> </span><span class="hljs-keyword"><span class="actionscript"><span class="hljs-keyword">var</span></span></span><span class="actionscript"> wdk2gwt_param = </span><span class="hljs-string"><span class="actionscript"><span class="hljs-string">'${wdk2gwtParam}'</span></span></span><span class="actionscript">; </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">language</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"javascript"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">src</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"/Webtop/ru.tim.gwt.correspondent.Correspondent/ru.tim.gwt.correspondent.Correspondent.nocache.js"</span></span></span><span class="hljs-tag">&gt;</span></span><span class="undefined"></span><span class="hljs-tag"><span class="undefined"></span><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">dmf:form</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br><h4>  Work with sessions </h4><br>  In work quality with Documentum sessions we will use SessionManagerHttpBinding.  It allows you to get an instance of the current user's IDfSessionManager.  From which you can get the session itself. <br><pre> <code class="java hljs">IDfSessionManager sessionManager = SessionManagerHttpBinding.getSessionManager(); IDfSession session = <span class="hljs-keyword"><span class="hljs-keyword">null</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">try</span></span> { session = sessionManager.getSession(SessionManagerHttpBinding.getCurrentDocbase()); } <span class="hljs-keyword"><span class="hljs-keyword">catch</span></span> (Exception e) { e.printStackTrace(); } <span class="hljs-keyword"><span class="hljs-keyword">finally</span></span> { sessionManager.release(session); }</code> </pre><br>  This code can be used in GWT servlets to retrieve and, subsequently, close the session.  Of course, you need to make the correct output in the log and add a null check before invoking sessionManager. <br><br><h4>  Execution of action WDK </h4><br>  It is necessary for performance of action and check of precondition.  Use case - check that the specified action with the listed parameters is executed and execute it. <br>  The first idea that came to mind is to conduct reverse engineering of form calls.  (There are no docks on the network).  Having rummaged in the code, traced a chain of method calls.  As a result, there is a lot to do to get the form and the context. <br>  The second option is AJAX using Documentum <a href="https://community.emc.com/docs/DOC-8012">community.emc.com/docs/DOC-8012</a> - the so-called inline calls. <br>  Those.  the point is to make a method in a component that will be called asynchronously from a client with parameters ‚Äî the name of action and the list of parameters of action.  And the result of the execution is returned to the client.  There is one note here: if the action of switching to other components is used in action: setComponentReturn, setComponentJump, setComponentNested (and possibly others), then there will be an error (Component Configuration Base has not been established) when re-requesting methods.  This is most likely due to the fact that the component has gone out of its current state (has switched to another component), but when asked for the server, the parameters indicate the already obsolete state of the component.  More precisely, the parameters specify a unique string within the current session, according to which the server restores the component state.  And this state is outdated. <br>  In principle, a more or less working solution has already been found.  But I also decided to check the onaction method of the Component class.  This is a method that performs all the action of its form (this can be noticed by the stack trace, if you set a break point in the action and call it).  To be precise, this method is called by all standard action control's forms.  This is an ordinary component method that can be called externally.  And this method supports inline calls.  So, to call this method, you need to give it the name action and parameters for it.  The first time the usual action is called, we get an error - the action must implement the IInlineCapableAction interface.  Having corrected it, it will turn out to successfully call action.  To transfer a value from action, use Map to return the value (6th parameter IActionExecution. Execute) and place the value with the key RESPONSE_DATA there. <br>  The complete code looks like this: <br>  Content xml with action description. <br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8" standalone="no"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">config</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">scope</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"test_action"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">params</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">param</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"test_param"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">required</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"false"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">params</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">execution</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ru.tim.wdk.test.TestAction"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">action</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">scope</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">config</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Note that the action takes the test_param parameter. <br>  The action method that will be called asynchronously. <br><pre> <code class="java hljs"> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">execute</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String actionName, IConfigElement config, ArgumentList args, Context context, Component component, Map resultMap)</span></span></span><span class="hljs-function"> </span></span>{ System.out.println(<span class="hljs-string"><span class="hljs-string">"Action param: "</span></span> + args.get(<span class="hljs-string"><span class="hljs-string">"test_param"</span></span>)); resultMap.put(<span class="hljs-string"><span class="hljs-string">"RESPONSE_DATA"</span></span>, <span class="hljs-string"><span class="hljs-string">"actionResultValue"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-keyword"><span class="hljs-keyword">true</span></span>; }</code> </pre><br>  The parameter test_param is displayed here.  Above it was described in xml.  To output the response, the response map is placed in the result map actionResultValue with the RESPONSE_DATA key.  RESPONSE_DATA - hard-coded response key for inline calls to action.  I found it when viewing the onaction method code.  When inline calling action from the handler class (CallbackDoneListenerWrapper), the value from the Map is taken using the RESPONSE_DATA key.  When sending a response to the client, the RESPONSE_DATA key is also used (the processInlineActionResponseData method in the Component class). <br>  The jsp part of the page with methods for sending and receiving the result of the action: <br><pre> <code class="javascript hljs">&lt;script type=<span class="hljs-string"><span class="hljs-string">"text/javascript"</span></span>&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">executeAction</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> prefs = InlineRequestEngine.getPreferences(InlineRequestType.JSON); prefs.setCallback(callBack); postInlineServerEvent(<span class="hljs-literal"><span class="hljs-literal">null</span></span>, prefs, <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-string"><span class="hljs-string">"onaction"</span></span>, <span class="hljs-string"><span class="hljs-string">"action"</span></span>, <span class="hljs-string"><span class="hljs-string">"test_action"</span></span>, <span class="hljs-string"><span class="hljs-string">"test_param"</span></span>, <span class="hljs-string"><span class="hljs-string">"test_param_value"</span></span>); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">callBack</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">data</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (isEventPostingLocked()) { releaseEventPostingLock(); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (data) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> result = data[<span class="hljs-string"><span class="hljs-string">'RESPONSE_DATA'</span></span>] <span class="hljs-built_in"><span class="hljs-built_in">window</span></span>.alert(result); } } &lt;<span class="hljs-regexp"><span class="hljs-regexp">/script&gt;</span></span></code> </pre><br>  The executeAction method performs an asynchronous request to the server to execute action.  The callBack function is used to process the response. <br>  In the postInlineServerEvent method, the execution method is called action - onaction.  With parameters - action, in the parameter the name of the called action is passed.  test_action - the name of the called action.  test_param - the name of the action parameter.  test_param_value is the parameter value.  If you need to add more parameters, they should be further listed in pairs - &lt;parameter name&gt;, &lt;parameter value&gt;. <br>  To use the action from GWT, you need to wrap the call to the postInlineServerEvent function from the GWT method, and setCallback to throw the GWT function as a parameter. <br>  It now remains to implement the precondition check method for the specified action. <br>  You can do this using the method in the component that will perform the precondition for the specified action.  The precondition itself must be performed using the ActionService.queryExecute function (strAction, args, context, component) <br><br><h4>  Environment setup </h4><br>  For convenient work with Webtop and Eclipse, let's create a Gwt project.  In the org.eclipse.wst.common.project.facet.core.xml project (located in the .settings folder in the project folder), add the following lines <br><pre> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">fixed</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">facet</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"jst.web"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">fixed</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">facet</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"java"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">fixed</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">facet</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wst.jsdt.web"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">installed</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">facet</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"java"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.6"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">installed</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">facet</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"jst.web"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2.5"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">installed</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">facet</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wst.jsdt.web"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag">/&gt;</span></span></code> </pre><br><br>  The result should be the following: <br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">faceted-project</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">fixed</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">facet</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"jst.utility"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">fixed</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">facet</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"java"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">fixed</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">facet</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"jst.web"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">fixed</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">facet</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wst.jsdt.web"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">installed</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">facet</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"java"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.6"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">installed</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">facet</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"jst.web"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2.5"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">installed</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">facet</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"wst.jsdt.web"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">installed</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">facet</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"jst.utility"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag">/&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">faceted-project</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br><br>  Here we have indicated that the project will be a web project and can be launched in Tomcat.  Add the Weptop and Web App Libraries folder to the Java Build Path window.  Set up the Deployment assembly to unload the gwt and webtop source folder of the project and the gwt and weptop web content folders. <br>  There is only one problem left - setting up web.xml to allow gwt to run separately from Webtop.  Since now web.xml includes configuration and servlet's gwt and servlet's webtop.  Alternatively, you can put all the settings in one web.xml Webtop and upload only it.  For gwt, leave only its settings.  Only you need to keep the correct order of uploading - first unload Webtop, and then gwt.  In this case, the data will not be overwritten. <br><br><h4>  Implementation </h4><br>  For testing, I made a small component that displays an object of a certain type and allows you to edit several single fields.  Sources can be downloaded from here <a href="">dl.dropbox.com/u/7519092/gwt2wdk.rar</a> (you need a Webtop to work) <br><br><h4>  Conclusion </h4><br>  The basics of interaction between GWT and Webtop turned out to be done.  But for the full implementation of the template component editing card, you need to do several things: <br>  1) Form with the choice of the object.  In Webtop, it is called selector. <br>  2) Widget's with action support, so that you can configure them to start the action, rather than writing code for it. <br>  3) Plug-in components for editing certain attributes.  For example, in Webtop, you can use them in the Properties component. <br>  Plus a few things about the GWT - checking input on the client side, the correct distinction between UI and events. <br><br><h4>  Links </h4><br>  RequestFactory Manual <a href="https://developers.google.com/web-toolkit/doc/latest/DevGuideRequestFactory%3Fhl%3Dru-RU">developers.google.com/web-toolkit/doc/latest/DevGuideRequestFactory?hl=en-EN#locators</a> <br>  RequestFactory Example (1) <a href="http://cleancodematters.wordpress.com/2011/06/04/tutorial-gwt-request-factory-part-i/">cleancodematters.wordpress.com/2011/06/04/tutorial-gwt-request-factory-part-i</a> <br>  RequestFactory Example (2) <a href="http://javaasylum.blogspot.com/2010/11/gwt-21-request-factory.html">javaasylum.blogspot.com/2010/11/gwt-21-request-factory.html</a> <br>  RequestFactory Example (3) <a href="http://turbomanage.wordpress.com/2011/03/25/using-gwt-requestfactory-with-objectify/">turbomanage.wordpress.com/2011/03/25/using-gwt-requestfactory-with-objectify</a> </div><p>Source: <a href="https://habr.com/ru/post/143437/">https://habr.com/ru/post/143437/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../143432/index.html">Apple intends to take the ultrabook market with lower prices for MacBook Air</a></li>
<li><a href="../143433/index.html">"The reverse side" of the Technology Forum 2012: how it works</a></li>
<li><a href="../143434/index.html">Sandbox with augmented reality from the University of California</a></li>
<li><a href="../143435/index.html">Lenovo will spend 800 million US dollars on the development of mobile devices</a></li>
<li><a href="../143436/index.html">The FBI wants to force Facebook, Skype, Google and others to leave backdoors in their products for surveillance and interception</a></li>
<li><a href="../143438/index.html">Ultramodem for ultrabook</a></li>
<li><a href="../143439/index.html">Simple, convenient - Mouse gestures</a></li>
<li><a href="../143440/index.html">Strange access bug to corporate google mail</a></li>
<li><a href="../143441/index.html">About code reuse</a></li>
<li><a href="../143443/index.html">An evening with Sinatra to create a TwitterBar service</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>