<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Where and how to get into embeddingings of graphs</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, Habr! 


 Three years ago on the site of Leonid Zhukov, I poked a link to the course of Jura Leskoveka cs224w Analysis of Networks and now we will...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Where and how to get into embeddingings of graphs</h1><div class="post__text post__text-html js-mediator-article"><p>  Hi, Habr! </p><br><p>  Three years ago on the site of <a href="http://leonidzhukov.net/hse/2014/socialnetworks/">Leonid Zhukov,</a> I poked a link to the course of Jura Leskoveka <a href="http://web.stanford.edu/class/cs224w/">cs224w Analysis of Networks</a> and now we will go along with everyone in our <a href="http://ods.ai/">cozy chat</a> channel # class_cs224w.  Immediately after the warm-up with <a href="https://mlcourse.ai/">an open course of machine learning</a> , which will begin in a few days. </p><br><p><img src="http://safronov.kiev.ua/ods/TimWalker.png" alt="image"></p><br><p>  <strong>Question:</strong> What do they recite? <br>  <strong>Answer:</strong> Modern mathematics.  We show an example of improving the process of IT-recruiting. </p><br><p>  Under the cat a reader is waiting for the story of how the project manager of discrete mathematics brought to the neural networks, why ERP implementers and product managers should read the Bioinformatics magazine, how the problem of recommending communications appeared, who needed graph embeddings, and where they came from. how to stop being afraid of questions about trees at interviews, and what it all may cost.  Let's go! <a name="habracut"></a></p><br><h2 id="plan-u-nas-takoy">  Our plan is: </h2><br><p>  1) <a href="https://habr.com/ru/company/ods/blog/418727/">What is cs224w</a> <br>  2) <a href="https://habr.com/ru/company/ods/blog/418727/">Check or go</a> <br>  3) <a href="https://habr.com/ru/company/ods/blog/418727/">How I got to it all</a> <br>  4) <a href="https://habr.com/ru/company/ods/blog/418727/">Why read Bioinformatics magazine</a> <br>  5) <a href="https://habr.com/ru/company/ods/blog/418727/">What is graph embeddings and where did they come from</a> <br>  6) <a href="https://habr.com/ru/company/ods/blog/418727/">Random tramp in the form of a matrix</a> <br>  7) <a href="https://habr.com/ru/company/ods/blog/418727/">Return of the random tramp and the power of ties</a> <br>  8) <a href="https://habr.com/ru/company/ods/blog/418727/">The path of the random tramp and the top in the vector</a> <br>  9) <a href="https://habr.com/ru/company/ods/blog/418727/">Our days are a random tramp for everyone</a> <br>  10) <a href="https://habr.com/ru/company/ods/blog/418727/">How and where to store such data and where to get it.</a> <br>  11) <a href="https://habr.com/ru/company/ods/blog/418727/">Why fear</a> <br>  12) <a href="https://habr.com/ru/company/ods/blog/418727/">Memo to the replicator</a> </p><br><h1 id="cs224w">  What is cs224w </h1><br><p>  The Course of Jure Leskoveka Analysis of Networks stands out in the pleiad of educational products from the Faculty of Computational Sciences at Stanford University.  The difference from the others is that the program covers a very wide range of issues.  It is an interdisciplinary character that makes adventure a challenge.  The prize is the universal language for describing complex systems - graph theory, which is proposed to be dealt with in ten weeks. </p><br><p><img src="https://mvideos.stanford.edu/Images/DestinyImages/Graduate%20Certificate%20Images/460X259/MiningMassiveDataSetsGraduateCertificate_Main.jpg" alt="image"></p><br><p>  The course does not cost itself that way, but opens the <a href="https://scpd.stanford.edu/public/category/courseCategoryCertificateProfile.do%3Fmethod%3Dload%26certificateId%3D10555807">Mining Massive Data Sets Graduate Certificate</a> program, in which there is still a lot of tasty. </p><br><p>  The second in the adventure is CS229 Machine Learning by Andrew Un, who does not need to advertise. </p><br><p>  This is followed by CS246 Mining Massive Data Sets Jure Leskoveka, in which wishing is invited to challenge MapReduce and Spark. </p><br><p>  Chris Manning completes the CS276 Information Retrieval and Web Search Banquet. </p><br><p>  As a bonus, CS246H Mining Massive Data Sets: Hadoop Labs is offered especially for those who were few.  Again, visiting Jura. </p><br><p>  In general, they promise that those who have gone through the program will acquire skills and knowledge sufficient to search for information on the Internet (without any Google and others like them). </p><br><h1 id="knowledge">  Ride or checkered </h1><br><p>  Once upon a time, my supervisor and mentor, at that time - the service station in the Ukrainian Nestl√©, explained to me, a young and ambitious person, who was trying to get an MBA to become even more famous, the truth that in the labor market people buy and sell experience and knowledge, and not diplomas and test results. </p><br><p>  The above specialization can be completed online for a symbolic $ 18,900. </p><br><p>  On average, an adventure takes 1-2 years, but no more than 3. To obtain a certificate, you must complete all courses with a grade of at least B (3.0). </p><br><p>  There is another way. </p><br><p>  All materials of the courses Jure Leskoveka are published openly and very quickly.  Therefore, those who wish can suffer at any convenient time, coordinating the load with their abilities.  Especially gifted I recommend to try the adventure mode "This is Stanford, honey!"  - passing parallel to the course - videos of lectures spread in a couple of days, additional literature is available immediately, homework and solutions open gradually. </p><br><p>  This season, after the end of the <a href="https://habr.com/company/ods/blog/344044/">Open Course of Machine Learning in Habr√©</a> , which is useful to pass as a warm-up, we will arrange a race in the dedicated channel # class_cs224w of the ods.ai chat. </p><br><p>  It is recommended to have the following skill set: </p><br><ul><li>  Basics of computational sciences at a level sufficient for writing non-trivial programs. </li><li>  Fundamentals of probability theory. </li><li>  Basics of linear algebra. </li></ul><br><h1 id="howigotthere">  How I got to it all </h1><br><p>  He lived for himself, did not hurt.  Led <a href="https://habr.com/company/sap/">SAP</a> implementation projects.  At times, he acted as a playing coach in his main specialization, and he turned the CRM nuts on.  You can say almost did not touch anyone.  Self-education involved.  At some point I decided to specialize in the field <a href="https://habr.com/company/ods/blog/344598/">of business transformation</a> (or making organizational changes).  The task of analyzing organizations before and after change is an important part of this work.  Knowing where and where to change - it helps a lot.  Understanding the connections between people is a significant success factor.  He spent several years studying the ‚Äúsoft‚Äù methodologies of research of organizations, but he couldn‚Äôt be satisfied with the question: ‚ÄúAnd who will fence whom: the chief accountant of the main account, or is everyone stronger?‚Äù  I have been asking myself for several years in a row.  Everything is looking for a way to measure for sure. </p><br><p>  The year 2014 was a turning point, when I gave up on MBA dreams and chose (here is the drum roll) again statistics and information management at the new University of Lisbon (the first and still healthy department of telecommunications of the non-existent Aviation and Space Systems Department of the Kiev Polytechnic) + Department of Communications at the military commissary). </p><br><p>  In the first semester of the second magistracy, I tried out the analysis of social networks - one of the applications of graph theory.  It was then that I found out that it‚Äôs what, it turns out, there are algorithms that solve problems like who will be friends with someone against the introduction of new technologies, but I didn‚Äôt know before and dried my head, analyzing people's connections in their mind - She really swells from this.  Quite by chance, it turned out that the analysis of networks, after the first steps, is a complete data digging and machine learning, then with a teacher, now without. </p><br><p>  At first, enough of the classics. </p><br><p> I wanted more.  In order to deal with embeddings (and work <a href="http://stanford.edu/~marinka/">Marinka Zhitnik</a> for my tasks), I had to delve into deep learning, in which <a href="https://habr.com/post/414165/">the Deep Learning course</a> helped me with my <a href="https://habr.com/post/414165/">fingers</a> .  Considering the speed with which the <a href="http://snap.stanford.edu/people.html">Leskoveka group</a> creates new knowledge, in order to solve administrative tasks automatically, it is enough just to follow their work. </p><br><h1 id="bioinformatics">  Why read Bioinformatics magazine </h1><br><p>  Team building is not an easy task.  Anyone with whom in one boat is not worth planting - one of the pressing issues.  Especially when the faces are new.  And the area is unfamiliar.  And to lead to distant shores you need not one boat, but a whole flotilla.  And on the way, close interaction is necessary both in the boats and between them.  Everyday <a href="https://habr.com/company/sap/">SAP</a> implementation, when the Customer needs to put the system configured for its specificity from a heap of modules, and the project plan consists of thousands of lines.  For all my work, I never hired anyone - they always gave out a team.  You are the project manager, you have the authority, and you‚Äôre going around.  Something like this.  Twisted. </p><br><blockquote>  <strong>Life example:</strong> <br><br>  I did not interview myself, but singled out timlids for this.  And for the resources - the demand from me.  And the integration of new team members is also the responsibility of the project manager.  I think many will agree that the better the list of candidates is prepared, the more pleasant the process for all participants.  This problem we consider in detail. </blockquote><p><br>  Natural laziness required - find a way to automate.  Found.  I share. </p><br><p>  A bit of management theory.  <a href="http://adizes.ru/adizes-methodology/">Adizes‚Äôs methodology is</a> based on a basic principle: organizations, like living organisms, have their own life cycle and demonstrate predictable and repetitive behavioral manifestations in the process of growth and aging.  At each stage of organizational development, the company expects a specific set of problems.  How well the management of the company copes with them, how successfully it implements the changes necessary for a healthy transition from stage to stage, and determines the ultimate success or failure of this organization. </p><br><p>  I have known about the ideas of Yitzhak Adizes for ten years and in many respects agree. </p><br><p>  Personality of employees - like vitamins - affect success in certain conditions.  There are examples of how successful executives, moving from one industry, failed to another.  It could be worse.  For example, Marissa Mayer, who ran a Google search, dropped Yahoo.  Warren Buffett says that he would hardly have been successful if he was born in Bangladesh.  The environment and the ways of interaction in it are an important factor. </p><br><p>  It would be good to predict complications before experiments on live, right? </p><br><p>  This is the outline of another Marinka Zhitnik research published in the journal Bioinformatics.  The task of predicting side effects with the joint use of drugs is mathematically close to the management.  All thanks to the universality of the graph language.  Consider it in more detail. </p><br><p><img src="http://snap.stanford.edu/decagon/polypharmacy-side-effect.png" alt="image"></p><br><p>  Decagon graph convolution network is a tool for predicting links in multimodal networks. </p><br><p>  The method consists in constructing a multimodal graph of protein-protein, drug-protein interactions, and side effects from a combination of drugs, which are represented by drug-drug-drug connections, where each of the side effects is a certain type of rib.  Decagon predicts a specific type of side effect, if any, which is manifested in the clinical picture. </p><br><p>  The figure shows an example of a side effect graph derived from genome and population data.  In total, there are 964 different types of side effects (indicated by ribs of type ri, i = 1, ..., 964).  Additional information in the model is presented in the form of vectors of properties of proteins and drugs. </p><br><p><img src="http://snap.stanford.edu/decagon/polypharmacy-graph.png" alt="image"></p><br><p>  For Ciprofloxacin (node ‚Äã‚ÄãC), highlighted neighbors in the graph reflect the effects on four proteins and three other drugs.  We see that Ciprofloxacin (node ‚Äã‚ÄãC), taken simultaneously with Doxycycline (node ‚Äã‚ÄãD) or Simvastatin (node ‚Äã‚ÄãS), increase the risk of a side effect expressed in slowing heart rate (side effect of r2 type), and the combination with Mupirocin (M) - increases the risk of gastrointestinal bleeding (side effect of type r1). </p><br><p>  Decagon predicts associations between drug pairs and side effects (shown in red) to identify side effects from a simultaneous dose, i.e.  those side effects that can not be associated with any of the drugs from the pair separately. </p><br><p>  Decagon graph convolutional neural network architecture: </p><br><p><img src="http://snap.stanford.edu/decagon/decagon-overview.png" alt="image"></p><br><p>  The model consists of two parts: </p><br><p>  Encoder: graph convolutional network (GCN) receiving graph and producing embeddings for nodes, <br>  Decoder: a tensor factorization model that uses these embeddings to identify side effects. </p><br><p>  More information can be found on <a href="http://snap.stanford.edu/decagon/">the project website</a> or below. </p><br><p>  Great, but how to fasten it to team building? </p><br><p><img src="https://habrastorage.org/getpro/habr/post_images/7fb/1cb/f48/7fb1cbf48ad27ac57e03e8abd59455e6.jpg" alt="image"></p><br><p>  <a href="https://habr.com/company/ods/blog/344598/">Something like that</a> . </p><br><p>  It is in order to feel comfortable in the field of research, similar to that described, and it is worth digging the granite of science.  However, it is possible to dig intensively - graph theory is actively developing.  That's why it is the point of progress - there are very few who are comfortable. </p><br><p>  To understand the details of the functioning of the Decagon, let's take a look at the history. </p><br><h1 id="linkprediction">  What is graph embeddingings and where did they come from </h1><br><p>  I happened to observe a change in the set of advanced methods for solving problems of predicting relationships on graphs over the past four years.  It was fun.  Almost like in a fairy tale - the further, the worse.  Evolution went along the path from the heuristics, which determined the environment for the top of the graph, to random vagrants, then spectral methods appeared (analysis of matrices), and now - neural networks. </p><br><blockquote>  <strong>We formulate the problem of predicting relationships:</strong> <br><br>  Consider a non-directed graph <math> </math> $ inline $ \ begin {align *} G (V, E) \ end {align *} $ inline $   where <br><math> </math> $ inline $ \ begin {align *} V \ end {align *} $ inline $   - many vertices <math> </math> $ inline $ \ begin {align *} v \ end {align *} $ inline $   , <br><math> </math> $ inline $ \ begin {align *} E \ end {align *} $ inline $   - many ribs <math> </math> $ inline $ \ begin {align *} e (u, v) \ end {align *} $ inline $   connecting vertices <math> </math> $ inline $ \ begin {align *} u \ end {align *} $ inline $   and <math> </math> $ inline $ \ begin {align *} v \ end {align *} $ inline $   . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Define the set of all possible edges. <math> </math> $ inline $ E ^ {\ diamond} $ inline $   its power <br><math> </math> $ inline $ \ begin {align *} | E ^ {\ diamond} |  &amp; = \ frac {| V | * (| V | - 1)} {2} \\ \ end {align *} $ inline $   where <br><math> </math> $ inline $ \ begin {align *} | V |  = n \ end {align *} $ inline $   - the number of vertices. <br><br>  Obviously, many non-existent edges can be expressed as <math> </math> $ inline $ \ begin {align *} \ overline {E} = E ^ {\ diamond} - E \ end {align *} $ inline $   . <br><br>  We assume that in the set <math> </math> $ inline $ \ begin {align *} \ overline {E} \ end {align *} $ inline $   there are missing links, or links that will appear in the future, and we want to find them. <br><br>  The solution is to define the function. <math> </math> $ inline $ \ begin {align *} D (u, v) \ end {align *} $ inline $   distance between the vertices of the graph, allowing for the structure of the graph <math> </math> $ inline $ \ begin {align *} G (t_0, t_0 ^ \ star) \ end {align *} $ inline $   given on the time interval <math> </math> $ inline $ \ begin {align *} (t_0, t_0 ^ \ star) \ end {align *} $ inline $   predict the appearance of ribs <math> </math> $ inline $ \ begin {align *} G (t_1, t_1 ^ \ star) \ end {align *} $ inline $   in the interval <math> </math> $ inline $ \ begin {align *} (t_1, t_1 ^ \ star) \ end {align *} $ inline $   . </blockquote><p><br>  <a href="http://arbor.ee.ntu.edu.tw/~brdai/papercollection/Bioinfo/dhaegn00.pdf">One of the first publications</a> that suggests moving from <a href="https://habr.com/company/ods/blog/325654/">clustering</a> to the problem of predicting relationships in the context of studying gene co-expression appeared in Bioinformatics in 2000 (as you might guess).  Already in 2003, <a href="http://snap.stanford.edu/class/cs224w-readings/nowell04linkprediction.pdf">an article by</a> John Kleinberg published <a href="http://snap.stanford.edu/class/cs224w-readings/nowell04linkprediction.pdf">an</a> overview of current methods for solving the problem of predicting connections in a social network.  His book " <a href="https://www.cs.cornell.edu/home/kleinber/networks-book/">Networks, Crowds, and Markets: Reasoning About a Highly Connected World</a> " is a textbook that is recommended to read during the cs224w course, most chapters are listed in the required reading section. </p><br><p>  The article can be considered a slice of knowledge in a narrow field, as we see, at first the range of methods was small and included: </p><br><ul><li>  <strong>Methods based on neighbors in the graph</strong> - and the most obvious of them is the number of common neighbors. </li></ul><br><blockquote>  <strong>We give a definition:</strong> <br><br>  Vertex <math> </math> $ inline $ u $ inline $   is a neighbor in the graph for the top <math> </math> $ inline $ v $ inline $   if edge <math> </math> $ inline $ e (u, v) \ in E $ inline $   . <br><br>  Denote <math> </math> $ inline $ \ Gamma (u) $ inline $   many vertex neighbors <math> </math> $ inline $ u $ inline $   , <br><br>  then the distance between the peaks <math> </math> $ inline $ u $ inline $   and <math> </math> $ inline $ v $ inline $   can be written as <br><br><math> </math> $ inline $ D_ {CN} (u, v) = \ Gamma (u) \ cap \ Gamma (v) $ inline $   . </blockquote><p><br>  It is intuitively clear that the greater the intersection of the sets of neighbors of two peaks, the more likely the connection between them is, for example, most new acquaintances are with friends of friends. </p><br><p>  More Advanced Heuristics - <a href="https://ru.wikipedia.org/wiki/%25D0%259A%25D0%25BE%25D1%258D%25D1%2584%25D1%2584%25D0%25B8%25D1%2586%25D0%25B8%25D0%25B5%25D0%25BD%25D1%2582_%25D0%2596%25D0%25B0%25D0%25BA%25D0%25BA%25D0%25B0%25D1%2580%25D0%25B0">Jacquard Ratio</a> <math> </math> $ inline $ D_J (u, v) = \ frac {\ Gamma (u) \ cap \ Gamma (v)} {\ Gamma (u) \ cup \ Gamma (v)} $ inline $   (who was already then one hundred years old) and recently (at that time) the proposed <a href="https://en.wikipedia.org/wiki/Adamic/Adar_index">distance of Adamyk / Adar</a> <math> </math> $ inline $ D_ {AA} (u, v) = \ sum_ {x \ in \ Gamma (u) \ cap \ Gamma (v)} \ frac {1} {\ log | \ Gamma (x) |} $ inline $   develop the idea through simple transformations. </p><br><ul><li>  <strong>Methods based on paths on a graph</strong> ‚Äî the idea is that the shortest path between two vertices on a graph corresponds to the chance of a connection between them ‚Äî the shorter the path, the higher the chance.  You can go further and take into account not only the shortest, but all other possible paths between pairs of vertices, for example, weighing the paths, as the <a href="https://en.wikipedia.org/wiki/Katz_centrality">Katz distance</a> does.  Even then, the expected path length of the random tramp is mentioned - the forerunner of the basis of the method of recommending friends to Facebook. </li></ul><br><blockquote>  <strong>Estimate the quality of the forecast:</strong> <br><br><ul><li>  For each pair of vertices <math> </math> $ inline $ (u, v) $ inline $   every non-existent edge <math> </math> $ inline $ e (u, v) \ in \ overline {E} $ inline $   calculate distance <math> </math> $ inline $ D (u, v) $ inline $   on the graph <math> </math> $ inline $ G (t_0, t_0 ^ \ star) $ inline $   . </li><li>  Sort pairs <math> </math> $ inline $ (u, v) $ inline $   descending distance <math> </math> $ inline $ D (u, v) $ inline $   . </li><li>  Will select <math> </math> $ inline $ m $ inline $   the pairs with the highest values ‚Äã‚Äãare our prediction. </li><li>  Let's see how many of the predicted edges appeared in <math> </math> $ inline $ G (t_1, t_1 ^ \ star) $ inline $   . </li></ul><br></blockquote><p><br>  It is important to remember that the number of common neighbors and the Adamik / Adar distance are powerful methods that determine the basic level of forecast quality for the linkage structure alone, and if your recommendation system shows a weaker result, then something is wrong. </p><br><p>  Generally, graph embeddings are a way of representing graphs compactly for machine learning tasks using the transform function <math> </math> $ inline $ \ begin {align *} \ phi: G (V, E) \ longmapsto \ mathbb {R} ^ d \ end {align *} $ inline $   . </p><br><p>  We considered several of these functions, the most effective of the first.  A broader list is described in the Kleinberg article.  As we see from the review, even then they began to use high-level methods, such as matrix decomposition, pre-clustering, and tools from the arsenal of computational linguistics.  Fifteen years ago, everything was just beginning.  Embeds were one-dimensional. </p><br><h1 id="randomwalker">  Random tramp in the form of a matrix </h1><br><p>  The next milestone on the way to the graph embedding was the development of random walk methods.  To invent and substantiate new formulas for calculating the distance, apparently, it became broke.  In some applications, it seems, you just have to rely on chance and trust the hobo. </p><br><blockquote>  <strong>We give a definition:</strong> <br><br>  Count adjacency matrix <math> </math> $ inline $ G $ inline $   with finite number of vertices <math> </math> $ inline $ n $ inline $   (numbered from 1 to <math> </math> $ inline $ n $ inline $   ) - this is a square matrix <math> </math> $ inline $ A $ inline $   size <math> </math> $ inline $ n \ times n $ inline $   in which the value of the element <math> </math> $ inline $ a_ {ij} $ inline $   equal to weight <math> </math> $ inline $ w_ {ij} $ inline $   ribs <math> </math> $ inline $ e (i, j) $ inline $   . <br><br>  <em><strong>Note:</strong> here we will deliberately move away from the previously used vertex indicators</em> <math> </math> <em>$ inline $ u, v $ inline $</em>   <em>and we will use the notation usual for linear algebra and in general in working with matrices</em> <math> </math> <em>$ inline $ i, j $ inline $</em>   <em>.</em> <br><br>  <strong>We illustrate the concepts considered:</strong> <br><br>  Let be <math> </math> $ inline $ G $ inline $   - four-vertex graph <math> </math> $ inline $ \ {A, B, C, D \} $ inline $   connected by ribs. <br><br>  In order to simplify the construction, let us assume that the edges of our graph are bidirectional, i.e. <math> </math> $ inline $ \ forall e (i, j) \ in E, \ exists e (j, i) \ in E \ land w_ {ij} = w_ {ji} $ inline $   . <br><br><math> </math> $ inline $ e (A, B), w_ {AB} = 1; \\ e (B, C), w_ {BC} = 2; \\ e (A, C), w_ {AC} = 3; \ \ e (B, C), w_ {BC} = 1. $ inline $ <br><br>  Draw the set of edges: <math> </math> $ inline $ e $ inline $   - blue, and <math> </math> $ inline $ \ overline {E} $ inline $   - green. <br><br><img src="http://safronov.kiev.ua/ods/EAndNotE.png" alt="image"><br><br><math> </math> $ inline $ \ begin {align *} A = \ left [\ begin {matrix} 0 &amp; 1 &amp; 3 &amp; 0 \\ 1 &amp; 0 &amp; 2 &amp; 1 \\ 3 &amp; 2 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 0 &amp; 0 \ end {matrix} \ right] \ end {align *} $ inline $ </blockquote><p><br>  Writing a graph in matrix form opens up interesting possibilities.  To demonstrate them, let's take a look at the work of Sergey Brin and Larry Page, and look at how PageRank works - the algorithm for ranking graph vertices, which is still an important part of Google search. </p><br><p>  PageRank - coined to search for the best pages on the Internet.  A page is considered good if other good pages value it (refer to it).  The more pages contain links to it, and the higher their ranking, the higher the PageRank for this page. </p><br><p>  Consider the interpretation of the method using <a href="https://ru.wikipedia.org/wiki/%25D0%25A6%25D0%25B5%25D0%25BF%25D1%258C_%25D0%259C%25D0%25B0%25D1%2580%25D0%25BA%25D0%25BE%25D0%25B2%25D0%25B0">Markov chains</a> . </p><br><blockquote>  <strong>We give a definition:</strong> <br><br>  The degree of the vertex (degree) - the power of the set of neighbors: <br><math> </math> $ inline $ d_i = | \ Gamma (i) | $ inline $   , <br><br>  There are in-degree and out-degree.  For our example, they are equivalent. <br><br>  We construct a weighted adjacency matrix, guided by the rule: <br><math> </math> $ inline $ \ begin {align *} M_ {ij} = \ left \ {\ begin {matrix} \ frac {1} {d_j} &amp; \ forall i, j \ iff i \ in \ Gamma (j), \\ 0 &amp; \ forall i, j \ iff i \ notin \ Gamma (j).  \ end {matrix} \ right. \ end {align *} $ inline $ <br><br><math> </math> $ inline $ \ begin {align *} M = \ left [\ begin {matrix} 0 &amp; \ frac {1} {3} &amp; \ frac {1} {2} &amp; 0 \\ \ frac {1} {2} &amp; 0 &amp; \ frac {1} {2} &amp; 1 \\ \ frac {1} {2} &amp; \ frac {1} {3} &amp; 0 &amp; 0 \\ 0 &amp; \ frac {1} {3} &amp; 0 &amp; 0 \ end {matrix} \ right] \ end {align *} $ inline $ <br><br>  Notice that the columns <math> </math> $ inline $ M $ inline $   must add up to 1 (i.e. <math> </math> $ inline $ M $ inline $   - "column <a href="https://ru.wikipedia.org/wiki/%25D0%25A1%25D1%2582%25D0%25BE%25D1%2585%25D0%25B0%25D1%2581%25D1%2582%25D0%25B8%25D1%2587%25D0%25B5%25D1%2581%25D0%25BA%25D0%25B0%25D1%258F_%25D0%25BC%25D0%25B0%25D1%2582%25D1%2580%25D0%25B8%25D1%2586%25D0%25B0">stochastic matrix</a> ").  The elements of each column give the probability of moving from the top. <math> </math> $ inline $ j $ inline $   in one of the adjacent vertices on the graph <math> </math> $ inline $ i \ in \ Gamma (j) $ inline $   . </blockquote><p><br>  Let be <math> </math> $ inline $ r_i $ inline $   will be the PageRank value for the top <math> </math> $ inline $ i $ inline $   , in which <math> </math> $ inline $ d_i $ inline $   outgoing edges.  Then we can express PageRank for her neighbor <math> </math> $ inline $ j $ inline $   as </p><br><p><math> </math> $$ display $$ r_j = \ sum_ {i \ to j} \ frac {r_i} {d_i} $$ display $$ </p><br><p>  So each of the neighbors <math> </math> $ inline $ i $ inline $   tops <math> </math> $ inline $ j $ inline $   contributes to its PageRank, and its size is directly proportional to the authority of the neighbor (i.e. its PageRank), and inversely proportional to the size of the neighbor's environment. </p><br><p>  We can and will keep the PageRank values ‚Äã‚Äãfor all vertices in the vector <math> </math> $ inline $ \ begin {align *} r = [r_1, r_2, ..., r_n] ^ T \ end {align *} $ inline $   - this will allow to write the equation compactly in the form of a scalar product: </p><br><p><math> </math> $$ display $$ r = Mr $$ display $$ </p><br><p>  Imagine a web surfer who spends an infinite amount of time on the Internet (which is not far from reality).  At any given time <math> </math> $ inline $ t $ inline $   it's on page <math> </math> $ inline $ i $ inline $   and at the moment <math> </math> $ inline $ t + 1 $ inline $   follows one of the links to one of the adjacent pages <math> </math> $ inline $ j \ in \ Gamma (i) $ inline $   , choosing it randomly, and all transitions are equally probable. </p><br><p>  Denote <math> </math> $ inline $ p (t) $ inline $   vector with the probability that the surfer is on the page <math> </math> $ inline $ i $ inline $   at the moment of time <math> </math> $ inline $ t $ inline $   . <math> </math> $ inline $ p (t) $ inline $   - probability distribution between pages, therefore the sum of elements is equal to 1. </p><br><p>  Recall that <math> </math> $ inline $ M_ {ij} $ inline $   - is the probability of transition from the top <math> </math> $ inline $ j $ inline $   to the top <math> </math> $ inline $ i $ inline $   given that the surfer is on top <math> </math> $ inline $ j $ inline $   and <math> </math> $ inline $ p_j (t) $ inline $   - the probability that it is on the page <math> </math> $ inline $ j $ inline $   in the moment <math> </math> $ inline $ t $ inline $   .  Therefore, for each vertex <math> </math> $ inline $ i $ inline $ </p><br><p><math> </math> $$ display $$ p_i (t + 1) = M_ {i1} p_1 (t) + M_ {i2} p_2 +.  .  .  + M_ {in} p_n (t) $$ display $$ </p><br><p>  and that means that </p><br><p><math> </math> $$ display $$ p (t + 1) = Mp (t) $$ display $$ </p><br><p>  If random walks ever reach a state in which <math> </math> $ inline $ p (t + 1) = p (t) $ inline $   then <math> </math> $ inline $ p (t) $ inline $   - <a href="https://ru.wikipedia.org/wiki/%25D0%25A1%25D1%2582%25D0%25B0%25D1%2586%25D0%25B8%25D0%25BE%25D0%25BD%25D0%25B0%25D1%2580%25D0%25BD%25D0%25BE%25D0%25B5_%25D1%2580%25D0%25B0%25D1%2581%25D0%25BF%25D1%2580%25D0%25B5%25D0%25B4%25D0%25B5%25D0%25BB%25D0%25B5%25D0%25BD%25D0%25B8%25D0%25B5">stationary distribution</a> .  Recall that the equation for PageRank in vector form <math> </math> $ inline $ r = Mr $ inline $   .  Conclusion - Vector <math> </math> $ inline $ r $ inline $   PageRank values ‚Äã‚Äãare the stationary distribution of the random tramp! </p><br><p>  In practice for <math> </math> $ inline $ r $ inline $   PageRank equation is often solved by a <a href="https://en.wikipedia.org/wiki/Power_iteration">power method</a> .  The idea is that we initialize the vector <math> </math> $ inline $ r ^ {(t0)} = [1 / n, 1 / n, ..., 1 / n] ^ T $ inline $   the same values ‚Äã‚Äãand consistently calculate <math> </math> $ inline $ r ^ {(t + 1)} = Mr ^ {(t)} $ inline $   for each <math> </math> $ inline $ t $ inline $   until the values ‚Äã‚Äãconverge, i.e. <math> </math> $ inline $ || r ^ {(t + 1)} - r ^ {(t)} || _1 &lt;\ epsilon $ inline $   where <math> </math> $ inline $ \ epsilon $ inline $   - allowable error.  (Note that <math> </math> $ inline $ || x || _1 = \ sum_ {k} | x_k | $ inline $   - this <math> </math> $ inline $ L_1 $ inline $   norm, or <a href="https://ru.wikipedia.org/wiki/%25D0%25A0%25D0%25B0%25D1%2581%25D1%2581%25D1%2582%25D0%25BE%25D1%258F%25D0%25BD%25D0%25B8%25D0%25B5_%25D0%25B3%25D0%25BE%25D1%2580%25D0%25BE%25D0%25B4%25D1%2581%25D0%25BA%25D0%25B8%25D1%2585_%25D0%25BA%25D0%25B2%25D0%25B0%25D1%2580%25D1%2582%25D0%25B0%25D0%25BB%25D0%25BE%25D0%25B2">Minkowski distance</a> ).  Then the values ‚Äã‚Äãof the vector <math> </math> $ inline $ r ^ {(t + 1)} $ inline $   and will be an estimate of page rank for vertices.  As a rule, 20-30 iterations are enough. </p><br><p>  Here, the memoras about solving problems by random search acquires new shades. </p><br><p><img src="https://pbs.twimg.com/media/DbIfkMnW4AEAz-1.jpg" alt="image"></p><br><p>  In the ‚Äúvanilla‚Äù form described, the method is sensitive to two problems: </p><br><ul><li>  T.N.  "spider nests" - vertices that link to themselves - leads to the fact that PageRank flows into them.  The whole.  And no one else gets it. </li><li>  Dead ends - vertices with only incoming edges - through them PageRank flows away from the system.  And ends at some point.  Vector <math> </math> $ inline $ r $ inline $   filled with zeros. </li></ul><br><p>  Bryn and Paige <a href="http://snap.stanford.edu/class/cs224w-readings/Brin98Anatomy.pdf">solved the</a> problem 20 years ago by issuing a stroller <del>  <a href="http://www.magnetreleasing.com/hobowithashotgun/">shotgun</a> </del>  teleport! </p><br><p>  Let our web surfer with probability <math> </math> $ inline $ \ beta $ inline $   selects the outgoing link, and with probability <math> </math> $ inline $ 1 - \ beta $ inline $   - Teleports to a randomly selected page.  Usually meaning <math> </math> $ inline $ 1 - \ beta \ approx 0.15 $ inline $   i.e.  our web surfer takes 5-7 steps between teleports.  Out of the impasse - always teleport.  The equation for PageRank takes the form: </p><br><p><math> </math> $$ display $$ r_j = \ sum_ {i \ to j} \ beta \ frac {r_i} {d_i} + (1- \ beta) \ frac {1} {n} $$ display $$ </p><br><p>  (this formulation assumes that there are no dead ends in the column) </p><br><p>  Like our previous matrix <math> </math> $ inline $ M $ inline $   we can define a new matrix </p><br><p><math> </math> $$ display $$ M ^ {\ star} = \ beta M + (1- \ beta) [1 / n] _ {n √ó n} $$ display $$ </p><br><p>  transition probabilities.  It remains to solve the equation <math> </math> $ inline $ r = M ^ {\ star} r $ inline $   in a similar way.  For the sake of preserving intrigue, I‚Äôll just say that the generalized algorithm is described on slides 37-38 in the 14th lecture of the 2017 cs224w course, in which Yura perfectly reveals all the details and shows how they use the method in Pinterest (it‚Äôs the main one in science) . </p><br><p>  Let us return to the managerial affairs.  What is the practical use of all these matrix operations? </p><br><blockquote>  <strong>Denote several tasks of the project manager:</strong> <br><br><ul><li>  Highlight key <a href="https://habr.com/company/ods/blog/344598/">stakeholders</a> ; </li><li>  Identify the links between the project participants; </li><li>  To pick up the participants of the groups that are most suitable for the teams. </li></ul><br></blockquote><p><br>  The first task is solved by constructing a link graph and applying classical PageRank.  For example, we <a href="http://safronov.kiev.ua/ods/vadym.safronov-ClintonEmails.html">caught Mr. Barack Obama</a> from a correspondence that Mrs. Hillary Clinton kindly shared while other methods did not give him enough attention. </p><br><p>  The remaining two will require modification of the algorithm. </p><br><h1 id="personalizedpagerank">  The return of the random tramp and the power of connections </h1><br><p>  In the real world, it took eight years. </p><br><p>  Recall that earlier our tramp with a teleport moved to a randomly selected vertex.  But what if we limit the number of possible displacements to a non-random sample by some criterion?  This was <a href="http://www.cs.cmu.edu/~htong/pdf/ICDM06_tong.pdf">done</a> in 2006 by fellow postgraduate colleagues Jura. </p><br><blockquote>  <strong>Let's improve our example:</strong> <br><br>  Suppose we know something about the vertices of the graph under consideration <math> </math> $ inline $ G $ inline $   some signs. <br><br>  For each vertex <math> </math> $ inline $ i $ inline $   set the vector from <math> </math> $ inline $ k $ inline $   properties <math> </math> $ inline $ f ^ {(i)} = [f_1, f_2, ..., f_k] ^ T $ inline $   . <br><br><img src="http://safronov.kiev.ua/ods/G_fi.png" alt="image"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Let the first of them </font></font><math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1000"><span class="MJXp-msubsup" id="MJXp-Span-1001"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1002" style="margin-right: 0.05em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">f </font></font></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1003" style="vertical-align: -0.4em;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">1</font></font></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-109-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-109">f_1 </script> </math><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> there will be, say, a favorite eye color. </font></font></blockquote><p><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Suppose that the reader has reached the highest ranks and he already has a team that is working on the creation of a new revolutionary product. </font><font style="vertical-align: inherit;">At some point there is a need to add one more player. </font><font style="vertical-align: inherit;">Assume that the pool of candidates is quite extensive (for example, our uncle works in a datasaentist factory). </font><font style="vertical-align: inherit;">In order to make life easier for our IT recruiter to create a list of those whom we invite to interview key team members (their time is also expensive) - we will solve it algorithmically.</font></font></p><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Suppose the question we asked is to prepare a list of candidates ranked according to the criterion of potential compatibility, the most suitable for our two players, </font></font><math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1004"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1005"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">A</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-110-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-110">A </script> </math>  and <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1006"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1007"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">C</font></font></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-111-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-111">C </script> </math> ‚Äî   . </p><br><p>  ,     ‚Äî    . </p><br><p>             - ,  Kaggle  Hackerrank,       ,     ,       (,     ). </p><br><blockquote> <strong> :</strong> <br><br>   <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1008"><span class="MJXp-msubsup" id="MJXp-Span-1009"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1010" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1011" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1012" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1013">x</span><span class="MJXp-mo" id="MJXp-Span-1014" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-112-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-112">S_k(x) </script> </math>   <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1015"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1016">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-113-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-113">x </script> </math>  <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1017"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1018">k</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-114-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-114"> k </script> </math> ,     <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1019"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1020">G</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-115-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-115">G</script> </math>  : <br><br><math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1021"><span class="MJXp-mi" id="MJXp-Span-1022">‚àÄ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1023">i</span><span class="MJXp-mo" id="MJXp-Span-1024" style="margin-left: 0.333em; margin-right: 0.333em;">‚àà</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1025">V</span><span class="MJXp-mo" id="MJXp-Span-1026" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1027">i</span><span class="MJXp-mo" id="MJXp-Span-1028" style="margin-left: 0.333em; margin-right: 0.333em;">‚àà</span><span class="MJXp-msubsup" id="MJXp-Span-1029"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1030" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1031" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1032" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1033">x</span><span class="MJXp-mo" id="MJXp-Span-1034" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mspace" id="MJXp-Span-1035" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-1036" style="margin-left: 0.333em; margin-right: 0.333em;">‚ü∫</span><span class="MJXp-mspace" id="MJXp-Span-1037" style="width: 0.278em; height: 0em;"></span><span class="MJXp-msubsup" id="MJXp-Span-1038"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1039" style="margin-right: 0.05em;">f</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1042"><span class="MJXp-mo" id="MJXp-Span-1043">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1044">i</span><span class="MJXp-mo" id="MJXp-Span-1045">)</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1040"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1041">k</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1046" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1047">x</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-116-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-116">\forall i \in V, i \in S_k(x) \iff f^{(i)}_{k} = x</script> </math></blockquote><p><br>      : </p><br><p><math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1048"><span class="MJXp-mtable" id="MJXp-Span-1049"><span><span class="MJXp-mtr" id="MJXp-Span-1050" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1051" style="text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-1052"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1053" style="margin-right: 0.05em;">M</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1057"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1058">p</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1054"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1055">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1056">j</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1059" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-1060"><span class="MJXp-mo" id="MJXp-Span-1061" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.133em;"><span class="MJXp-right MJXp-scale3" style="font-size: 5.533em; margin-left: -0.336em;">{</span></span><span class="MJXp-mtable" id="MJXp-Span-1062"><span><span class="MJXp-mtr" id="MJXp-Span-1063" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1064" style="text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1065">Œ≤</span><span class="MJXp-msubsup" id="MJXp-Span-1066"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1067" style="margin-right: 0.05em;">M</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1068" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1069">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1070">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-1071" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mfrac" id="MJXp-Span-1072" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-mn" id="MJXp-Span-1073">1</span><span class="MJXp-mo" id="MJXp-Span-1074">‚àí</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1075">Œ≤</span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1076"><span class="MJXp-mo" id="MJXp-Span-1077">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1078"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1079" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1080" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1081">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1082">x</span><span class="MJXp-mo" id="MJXp-Span-1083">)</span><span class="MJXp-mrow" id="MJXp-Span-1084"><span class="MJXp-mo" id="MJXp-Span-1085">|</span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-1086" style="padding-left: 1em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-1087">‚àÄ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1088">i</span><span class="MJXp-mo" id="MJXp-Span-1089" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1090">j</span><span class="MJXp-mspace" id="MJXp-Span-1091" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-1092" style="margin-left: 0.333em; margin-right: 0.333em;">‚ü∫</span><span class="MJXp-mspace" id="MJXp-Span-1093" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1094">i</span><span class="MJXp-mo" id="MJXp-Span-1095" style="margin-left: 0.333em; margin-right: 0.333em;">‚àà</span><span class="MJXp-msubsup" id="MJXp-Span-1096"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1097" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1098" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1099" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1100">x</span><span class="MJXp-mo" id="MJXp-Span-1101" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1102" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span><span class="MJXp-mtr" id="MJXp-Span-1103" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1104" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1105">Œ≤</span><span class="MJXp-msubsup" id="MJXp-Span-1106"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1107" style="margin-right: 0.05em;">M</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1108" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1109">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1110">j</span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-1111" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-1112">‚àÄ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1113">i</span><span class="MJXp-mo" id="MJXp-Span-1114" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1115">j</span><span class="MJXp-mspace" id="MJXp-Span-1116" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-1117" style="margin-left: 0.333em; margin-right: 0.333em;">‚ü∫</span><span class="MJXp-mspace" id="MJXp-Span-1118" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1119">i</span><span class="MJXp-mo" id="MJXp-Span-1120" style="margin-left: 0.333em; margin-right: 0.333em;">‚àâ</span><span class="MJXp-msubsup" id="MJXp-Span-1121"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1122" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1123" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1124" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1125">x</span><span class="MJXp-mo" id="MJXp-Span-1126" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1127" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1128" style="margin-left: 0em; margin-right: 0em;"></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-117-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-117">\begin{align*}M^{p}_{ij} = \left\{ \begin{matrix} \beta M_{ij} + \frac{1-\beta}{|S_k(x)|} & \forall i,j \iff i \in S_k(x), \\ \beta M_{ij} & \forall i,j \iff i \notin S_k(x). \end{matrix} \right.\end{align*}</script> </math></p><br><p>    <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1129"><span class="MJXp-mtable" id="MJXp-Span-1130"><span><span class="MJXp-mtr" id="MJXp-Span-1131" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1132" style="text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1133">r</span><span class="MJXp-mo" id="MJXp-Span-1134" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1135"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1136" style="margin-right: 0.05em;">M</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1137" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1138">p</span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1139">r</span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-118-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-118">\begin{align*} r = M^{p} r \end{align*}</script> </math>  <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1140"><span class="MJXp-mtable" id="MJXp-Span-1141"><span><span class="MJXp-mtr" id="MJXp-Span-1142" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1143" style="text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1144">r</span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-119-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-119">\begin{align*} r \end{align*}</script> </math> ,       .   <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1145"><span class="MJXp-mtable" id="MJXp-Span-1146"><span><span class="MJXp-mtr" id="MJXp-Span-1147" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1148" style="text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1149">r</span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-120-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-120">\begin{align*} r \end{align*}</script> </math>    PageRank      ‚Äî     .       ,   <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1150"><span class="MJXp-mtable" id="MJXp-Span-1151"><span><span class="MJXp-mtr" id="MJXp-Span-1152" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1153" style="text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1154">r</span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-121-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-121">\begin{align*} r \end{align*}</script> </math>    ‚Äî    . </p><br><p>       80%   Pinterest. </p><br><p>  ,  <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1155"><span class="MJXp-mtable" id="MJXp-Span-1156"><span><span class="MJXp-mtr" id="MJXp-Span-1157" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1158" style="text-align: right;"><span class="MJXp-mrow" id="MJXp-Span-1159"><span class="MJXp-mo" id="MJXp-Span-1160" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1161"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1162" style="margin-right: 0.05em;">S</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1163" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1164" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1165">x</span><span class="MJXp-mo" id="MJXp-Span-1166" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mrow" id="MJXp-Span-1167"><span class="MJXp-mo" id="MJXp-Span-1168" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mo" id="MJXp-Span-1169" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1170">1</span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-122-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-122">\begin{align*}|S_k(x)| = 1\end{align*}</script> </math> ,  Random Walks with Restarts ‚Äî         .               .       ,    /. </p><br><blockquote> <strong>  :</strong> <br><br> ,   <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1171"><span class="MJXp-mtable" id="MJXp-Span-1172"><span><span class="MJXp-mtr" id="MJXp-Span-1173" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1174" style="text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1175">e</span><span class="MJXp-mo" id="MJXp-Span-1176" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1177">i</span><span class="MJXp-mo" id="MJXp-Span-1178" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1179">j</span><span class="MJXp-mo" id="MJXp-Span-1180" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1181" style="margin-left: 0.333em; margin-right: 0.333em;">‚àà</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1182">E</span><span class="MJXp-mo" id="MJXp-Span-1183" style="margin-left: 0.333em; margin-right: 0.333em;">‚àà</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1184">G</span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-123-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-123">\begin{align*} e(i,j) \in E \in G \end{align*}</script> </math>     <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1185"><span class="MJXp-mtable" id="MJXp-Span-1186"><span><span class="MJXp-mtr" id="MJXp-Span-1187" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1188" style="text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-1189"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1190" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1191" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1192">j</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1193">i</span></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-124-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-124">\begin{align*}w_{ji}\end{align*}</script> </math>  . <br><br>      <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1194"><span class="MJXp-mtable" id="MJXp-Span-1195"><span><span class="MJXp-mtr" id="MJXp-Span-1196" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1197" style="text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-1198"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1199" style="margin-right: 0.05em;">M</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1200" style="vertical-align: 0.5em;">w</span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-125-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-125">\begin{align*}M^w\end{align*}</script> </math>  : <br><br><math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1201"><span class="MJXp-mtable" id="MJXp-Span-1202"><span><span class="MJXp-mtr" id="MJXp-Span-1203" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1204" style="text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-1205"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1206" style="margin-right: 0.05em;">M</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1210"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1211">w</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1207"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1208">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1209">j</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1212" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mrow" id="MJXp-Span-1213"><span class="MJXp-mo" id="MJXp-Span-1214" style="margin-left: 0em; margin-right: 0em; vertical-align: -1.133em;"><span class="MJXp-right MJXp-scale3" style="font-size: 5.533em; margin-left: -0.336em;">{</span></span><span class="MJXp-mtable" id="MJXp-Span-1215"><span><span class="MJXp-mtr" id="MJXp-Span-1216" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1217" style="text-align: center;"><span class="MJXp-mfrac" id="MJXp-Span-1218" style="vertical-align: 0.25em;"><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-1219"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1220" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1221" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1222">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1223">j</span></span></span></span><span class="MJXp-box" style="margin-top: -0.9em;"><span class="MJXp-denom"><span><span class="MJXp-rule" style="height: 1em; border-top: none; border-bottom: 1px solid; margin: 0.1em 0px;"></span></span><span><span class="MJXp-box MJXp-script"><span class="MJXp-msubsup" id="MJXp-Span-1224"><span class="MJXp-mo" id="MJXp-Span-1225" style="margin-right: 0.05em;">‚àë</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1226" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1227">j</span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1228"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1229" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1230" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1231">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1232">j</span></span></span></span></span></span></span></span></span><span class="MJXp-mtd" id="MJXp-Span-1233" style="padding-left: 1em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-1234">‚àÄ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1235">i</span><span class="MJXp-mo" id="MJXp-Span-1236" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1237">j</span><span class="MJXp-mspace" id="MJXp-Span-1238" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-1239" style="margin-left: 0.333em; margin-right: 0.333em;">‚ü∫</span><span class="MJXp-mspace" id="MJXp-Span-1240" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1241">e</span><span class="MJXp-mo" id="MJXp-Span-1242" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1243">i</span><span class="MJXp-mo" id="MJXp-Span-1244" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1245">j</span><span class="MJXp-mo" id="MJXp-Span-1246" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1247" style="margin-left: 0.333em; margin-right: 0.333em;">‚àà</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1248">E</span><span class="MJXp-mo" id="MJXp-Span-1249" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span><span class="MJXp-mtr" id="MJXp-Span-1250" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1251" style="padding-top: 0.4em; text-align: center;"><span class="MJXp-mn" id="MJXp-Span-1252">0</span></span><span class="MJXp-mtd" id="MJXp-Span-1253" style="padding-left: 1em; padding-top: 0.4em; text-align: center;"><span class="MJXp-mi" id="MJXp-Span-1254">‚àÄ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1255">i</span><span class="MJXp-mo" id="MJXp-Span-1256" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1257">j</span><span class="MJXp-mspace" id="MJXp-Span-1258" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-1259" style="margin-left: 0.333em; margin-right: 0.333em;">‚ü∫</span><span class="MJXp-mspace" id="MJXp-Span-1260" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1261">e</span><span class="MJXp-mo" id="MJXp-Span-1262" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1263">i</span><span class="MJXp-mo" id="MJXp-Span-1264" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1265">j</span><span class="MJXp-mo" id="MJXp-Span-1266" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1267" style="margin-left: 0.333em; margin-right: 0.333em;">‚àâ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1268">E</span><span class="MJXp-mo" id="MJXp-Span-1269" style="margin-left: 0em; margin-right: 0.222em;">.</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1270" style="margin-left: 0em; margin-right: 0em;"></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-126-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-126">\begin{align*}M^{w}_{ij} = \left\{ \begin{matrix} \frac{w_{ij}}{\sum_{j}w_{ij}} & \forall i,j \iff e(i,j) \in E, \\ 0 & \forall i,j \iff e(i,j) \notin E. \end{matrix} \right.\end{align*}</script> </math><br><br>     - ,    ! </blockquote><p><br>       ,     . </p><br><p>     Facebook  2011.         ,  ,     .                   (, ,    ). -     . </p><br><p><math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1271"><span class="MJXp-msubsup" id="MJXp-Span-1272"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1273" style="margin-right: 0.05em;">w</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1274" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1275">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1276">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-1277" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1278"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1279" style="margin-right: 0.05em;">f</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1280" style="vertical-align: 0.5em;">w</span></span><span class="MJXp-mo" id="MJXp-Span-1281" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1282">i</span><span class="MJXp-mo" id="MJXp-Span-1283" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1284">j</span><span class="MJXp-mo" id="MJXp-Span-1285" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1286" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1287"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1288" style="margin-right: 0.05em;">e</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1289" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1290">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-1291"><span class="MJXp-mo" id="MJXp-Span-1292" style="margin-right: 0.05em;">‚àë</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1293" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1294">z</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1295"><span class="MJXp-msubsup" id="MJXp-Span-1296"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1297" style="margin-right: 0.05em;">Œæ</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1298" style="vertical-align: -0.4em;">z</span></span><span class="MJXp-msubsup" id="MJXp-Span-1299"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1300" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1301" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1302">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1303">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-1304">[</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1305">z</span><span class="MJXp-mo" id="MJXp-Span-1306">]</span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1307" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-127-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex; mode=display" id="MathJax-Element-127"> w_{ij} = f^w(i,j) = e^{- \sum_{z}{\xi_z x_{ij}[z]}} ,</script> </math></p><br><p>  Where <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1308"><span class="MJXp-mtable" id="MJXp-Span-1309"><span><span class="MJXp-mtr" id="MJXp-Span-1310" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1311" style="text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-1312"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1313" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1314" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1315">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1316">j</span></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-128-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-128">\begin{align*}x_{ij} \end{align*}</script> </math> ‚Äî       , .. <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1317"><span class="MJXp-mtable" id="MJXp-Span-1318"><span><span class="MJXp-mtr" id="MJXp-Span-1319" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1320" style="text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-1321"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1322" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1323" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1324">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1325">j</span></span></span><span class="MJXp-mo" id="MJXp-Span-1326" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1327"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1328" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1329" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1330">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1331">i</span><span class="MJXp-mo" id="MJXp-Span-1332">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1333" style="margin-left: 0.267em; margin-right: 0.267em;">‚à™</span><span class="MJXp-msubsup" id="MJXp-Span-1334"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1335" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1336" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1337">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1338">j</span><span class="MJXp-mo" id="MJXp-Span-1339">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1340" style="margin-left: 0.267em; margin-right: 0.267em;">‚à™</span><span class="MJXp-msubsup" id="MJXp-Span-1341"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1342" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1343" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1344">e</span><span class="MJXp-mo" id="MJXp-Span-1345">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1346">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1347">j</span><span class="MJXp-mo" id="MJXp-Span-1348">)</span></span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-129-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-129">\begin{align*}x_{ij} = f^{(i)} \cup f^{(j)} \cup f^{e(ij)} \end{align*}</script> </math>  , but <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1349"><span class="MJXp-mtable" id="MJXp-Span-1350"><span><span class="MJXp-mtr" id="MJXp-Span-1351" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1352" style="text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1353">Œæ</span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-130-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-130">\begin{align*}\xi \end{align*}</script> </math> ‚Äî  ,     . </p><br><p>     <a href="https://habrahabr.ru/company/ods/blog/323890/"> </a> ,   ‚Äî   ,    <a href="https://mlcourse.ai/">   </a> ,     ,           <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1354"><span class="MJXp-msubsup" id="MJXp-Span-1355"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1356" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1357" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1358">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1359">j</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-131-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-131">x_{ij} </script> </math> ‚Äî  ,         . </p><br><p>     ? </p><br><p>  ,        ,      .  ,      . </p><br><p>    .      (   )       <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1360"><span class="MJXp-mtable" id="MJXp-Span-1361"><span><span class="MJXp-mtr" id="MJXp-Span-1362" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1363" style="text-align: right;"><span class="MJXp-mo" id="MJXp-Span-1364" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1365"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1366" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1367" style="vertical-align: -0.4em;">0</span></span><span class="MJXp-mo" id="MJXp-Span-1368" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1369"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1370" style="margin-right: 0.05em;">t</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-1372">‚ãÜ</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-1371">0</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1373" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-132-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-132">\begin{align*}(t_0, t_0^\star)\end{align*}</script> </math> (,   )       <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1374"><span class="MJXp-mtable" id="MJXp-Span-1375"><span><span class="MJXp-mtr" id="MJXp-Span-1376" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1377" style="text-align: right;"><span class="MJXp-mo" id="MJXp-Span-1378" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1379"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1380" style="margin-right: 0.05em;">t</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1381" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1382" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1383"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1384" style="margin-right: 0.05em;">t</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mo" id="MJXp-Span-1386">‚ãÜ</span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mn" id="MJXp-Span-1385">1</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1387" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-133-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-133">\begin{align*}(t_1, t_1^\star)\end{align*}</script> </math> ( ).    ,     ,  ,    .       <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1388"><span class="MJXp-msubsup" id="MJXp-Span-1389"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1390" style="margin-right: 0.05em;">X</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1391" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1392">‚ãÜ</span></span></span><span class="MJXp-mo" id="MJXp-Span-1393" style="margin-left: 0.333em; margin-right: 0.333em;">‚àà</span><span class="MJXp-msubsup" id="MJXp-Span-1394"><span class="MJXp-mrow" id="MJXp-Span-1395" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-1396">R</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1397" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1398">(</span><span class="MJXp-mn" id="MJXp-Span-1399">2</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1400">k</span><span class="MJXp-mo" id="MJXp-Span-1401">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1402">l</span><span class="MJXp-mo" id="MJXp-Span-1403">)</span><span class="MJXp-mo" id="MJXp-Span-1404">√ó</span><span class="MJXp-mrow" id="MJXp-Span-1405"><span class="MJXp-mo" id="MJXp-Span-1406">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1407">E</span><span class="MJXp-mrow" id="MJXp-Span-1408"><span class="MJXp-mo" id="MJXp-Span-1409">|</span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-134-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-134">X^{\star} \in \mathbb{R}^{(2k+l)\times|E|} </script> </math> (  ‚Äî  <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1410"><span class="MJXp-msubsup" id="MJXp-Span-1411"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1412" style="margin-right: 0.05em;">x</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1413" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1414">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1415">j</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-135-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-135">x_{ij} </script> </math>  , <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1416"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1417">k</span><span class="MJXp-mo" id="MJXp-Span-1418" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1419">l</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-136-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-136">k, l</script> </math> ‚Äî       <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1420"><span class="MJXp-msubsup" id="MJXp-Span-1421"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1422" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1423" style="vertical-align: 0.5em;"><span class="MJXp-mo" id="MJXp-Span-1424">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1425">i</span><span class="MJXp-mo" id="MJXp-Span-1426">)</span></span></span><span class="MJXp-mo" id="MJXp-Span-1427" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1428"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1429" style="margin-right: 0.05em;">f</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1430" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1431">e</span><span class="MJXp-mo" id="MJXp-Span-1432">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1433">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1434">j</span><span class="MJXp-mo" id="MJXp-Span-1435">)</span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-137-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-137">f^{(i)}, f^{e(ij)}</script> </math> , )   <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1436"><span class="MJXp-mtable" id="MJXp-Span-1437"><span><span class="MJXp-mtr" id="MJXp-Span-1438" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1439" style="text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1440">G</span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-138-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-138">\begin{align*}G \end{align*}</script> </math>    . </p><br><p>     . </p><br><p>    <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1441"><span class="MJXp-mtable" id="MJXp-Span-1442"><span><span class="MJXp-mtr" id="MJXp-Span-1443" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1444" style="text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1445">i</span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-139-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-139">\begin{align*} i\end{align*}</script> </math>  : </p><br><p> 1)    : </p><br><p><math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1446"><span class="MJXp-msubsup" id="MJXp-Span-1447"><span class="MJXp-mi" id="MJXp-Span-1448" style="margin-right: 0.05em;">Œì</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1449" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1450">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1451">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1452">f</span></span></span><span class="MJXp-mo" id="MJXp-Span-1453" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1454">i</span><span class="MJXp-mo" id="MJXp-Span-1455" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1456" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-1457"><span class=""><span class="MJXp-mo" id="MJXp-Span-1458" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">‚ãÉ</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1459" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1460">j</span><span class="MJXp-mo" id="MJXp-Span-1461">‚àà</span><span class="MJXp-mi" id="MJXp-Span-1462">Œì</span><span class="MJXp-mo" id="MJXp-Span-1463">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1464">i</span><span class="MJXp-mo" id="MJXp-Span-1465">)</span></span></span></span><span class="MJXp-mi" id="MJXp-Span-1466">Œì</span><span class="MJXp-mo" id="MJXp-Span-1467" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1468">j</span><span class="MJXp-mo" id="MJXp-Span-1469" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1470" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-mi" id="MJXp-Span-1471">Œì</span><span class="MJXp-mo" id="MJXp-Span-1472" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1473">i</span><span class="MJXp-mo" id="MJXp-Span-1474" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-140-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex; mode=display" id="MathJax-Element-140">\Gamma^{fof}(i) = \bigcup_{j \in \Gamma(i)} \Gamma(j) - \Gamma(i)</script> </math></p><br><p> 2)   - <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1475"><span class="MJXp-mtable" id="MJXp-Span-1476"><span><span class="MJXp-mtr" id="MJXp-Span-1477" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1478" style="text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-1479"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1480" style="margin-right: 0.05em;">G</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1481" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1482">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1483">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1484">f</span></span></span><span class="MJXp-mo" id="MJXp-Span-1485" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1486">i</span><span class="MJXp-mo" id="MJXp-Span-1487" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-141-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-141">\begin{align*} G^{fof}(i)\end{align*}</script> </math>      , <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1488"><span class="MJXp-mtable" id="MJXp-Span-1489"><span><span class="MJXp-mtr" id="MJXp-Span-1490" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1491" style="text-align: right;"><span class="MJXp-mi" id="MJXp-Span-1492">‚àÄ</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1493">e</span><span class="MJXp-mo" id="MJXp-Span-1494" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1495">x</span><span class="MJXp-mo" id="MJXp-Span-1496" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1497">y</span><span class="MJXp-mo" id="MJXp-Span-1498" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1499" style="margin-left: 0.333em; margin-right: 0.333em;">‚àà</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1500">E</span><span class="MJXp-mo" id="MJXp-Span-1501" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1502">e</span><span class="MJXp-mo" id="MJXp-Span-1503" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1504">x</span><span class="MJXp-mo" id="MJXp-Span-1505" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1506">y</span><span class="MJXp-mo" id="MJXp-Span-1507" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1508" style="margin-left: 0.333em; margin-right: 0.333em;">‚àà</span><span class="MJXp-msubsup" id="MJXp-Span-1509"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1510" style="margin-right: 0.05em;">G</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1511" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1512">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1513">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1514">f</span></span></span><span class="MJXp-mo" id="MJXp-Span-1515" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1516">i</span><span class="MJXp-mo" id="MJXp-Span-1517" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mspace" id="MJXp-Span-1518" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-1519" style="margin-left: 0.333em; margin-right: 0.333em;">‚ü∫</span><span class="MJXp-mspace" id="MJXp-Span-1520" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1521">x</span><span class="MJXp-mo" id="MJXp-Span-1522" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1523">y</span><span class="MJXp-mo" id="MJXp-Span-1524" style="margin-left: 0.333em; margin-right: 0.333em;">‚àà</span><span class="MJXp-msubsup" id="MJXp-Span-1525"><span class="MJXp-mi" id="MJXp-Span-1526" style="margin-right: 0.05em;">Œì</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1527" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1528">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1529">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1530">f</span></span></span><span class="MJXp-mo" id="MJXp-Span-1531" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1532">i</span><span class="MJXp-mo" id="MJXp-Span-1533" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1534" style="margin-left: 0.267em; margin-right: 0.267em;">‚à™</span><span class="MJXp-mi" id="MJXp-Span-1535">Œì</span><span class="MJXp-mo" id="MJXp-Span-1536" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1537">i</span><span class="MJXp-mo" id="MJXp-Span-1538" style="margin-left: 0em; margin-right: 0em;">)</span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-142-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-142">\begin{align*} \forall e(x,y) \in E, e(x, y) \in G^{fof}(i) \iff x, y \in \Gamma^{fof}(i) \cup \Gamma(i) \end{align*}</script> </math></p><br><p> 3)   , <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1539"><span class="MJXp-mtable" id="MJXp-Span-1540"><span><span class="MJXp-mtr" id="MJXp-Span-1541" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1542" style="text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-1543"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1544" style="margin-right: 0.05em;">D</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1545" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1546" style="margin-left: 0.111em; margin-right: 0.167em;">:</span><span class="MJXp-mo" id="MJXp-Span-1547" style="margin-left: 0em; margin-right: 0em;">{</span><span class="MJXp-msubsup" id="MJXp-Span-1548"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1549" style="margin-right: 0.05em;">d</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1550" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1551" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mo" id="MJXp-Span-1552" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1553" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1554" style="margin-left: 0em; margin-right: 0.222em;">.</span><span class="MJXp-mo" id="MJXp-Span-1555" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1556"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1557" style="margin-right: 0.05em;">d</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1558" style="vertical-align: -0.4em;">k</span></span><span class="MJXp-mo" id="MJXp-Span-1559" style="margin-left: 0em; margin-right: 0em;">}</span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-143-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-143">\begin{align*} D_i: \{d_1, ..., d_k \}\end{align*}</script> </math> ,     ‚Äî      , </p><br><p> 4)      <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1560"><span class="MJXp-mtable" id="MJXp-Span-1561"><span><span class="MJXp-mtr" id="MJXp-Span-1562" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1563" style="text-align: right;"><span class="MJXp-munderover" id="MJXp-Span-1564"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mo" id="MJXp-Span-1568" style="margin-right: 0px; margin-left: 0px;">¬Ø</span></span><span class=""><span class="MJXp-msubsup" id="MJXp-Span-1565"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1566" style="margin-right: 0.05em;">D</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1567" style="vertical-align: -0.4em;">i</span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1569" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1570"><span class="MJXp-mi" id="MJXp-Span-1571" style="margin-right: 0.05em;">Œì</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1572" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1573">f</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1574">o</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1575">f</span></span></span><span class="MJXp-mo" id="MJXp-Span-1576" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1577">i</span><span class="MJXp-mo" id="MJXp-Span-1578" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1579" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-1580"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1581" style="margin-right: 0.05em;">D</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1582" style="vertical-align: -0.4em;">i</span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-144-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-144">\begin{align*} \overline{D_i} = \Gamma^{fof}(i) - D_i\end{align*}</script> </math> ‚Äî      . </p><br><p><img src="http://safronov.kiev.ua/ods/cs224w_20141119p13.png" alt="image align = center"></p><br><p>   ‚Äî     <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1583"><span class="MJXp-mtable" id="MJXp-Span-1584"><span><span class="MJXp-mtr" id="MJXp-Span-1585" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1586" style="text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1587">Œæ</span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-145-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-145">\begin{align*} \xi \end{align*}</script> </math> ,       <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1588"><span class="MJXp-mtable" id="MJXp-Span-1589"><span><span class="MJXp-mtr" id="MJXp-Span-1590" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1591" style="text-align: right;"><span class="MJXp-msubsup" id="MJXp-Span-1592"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1593" style="margin-right: 0.05em;">D</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1594" style="vertical-align: -0.4em;">i</span></span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-146-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-146">\begin{align*} D_i\end{align*}</script> </math>     Personalized PageRank  <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1595"><span class="MJXp-mtable" id="MJXp-Span-1596"><span><span class="MJXp-mtr" id="MJXp-Span-1597" style="vertical-align: baseline;"><span class="MJXp-mtd" id="MJXp-Span-1598" style="text-align: right;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1599">i</span></span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-147-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-147">\begin{align*} i\end{align*}</script> </math> ,   . </p><br><p>     ,   : </p><br><p><math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1600"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1601">L</span><span class="MJXp-mo" id="MJXp-Span-1602" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-1603"><span class=""><span class="MJXp-mo" id="MJXp-Span-1604" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">‚àë</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1605" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1606">i</span></span></span></span><span class="MJXp-munderover" id="MJXp-Span-1607"><span class=""><span class="MJXp-mo" id="MJXp-Span-1608" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">‚àë</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1609" style="margin-left: 0px;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1610">d</span><span class="MJXp-mo" id="MJXp-Span-1611">‚àà</span><span class="MJXp-msubsup" id="MJXp-Span-1612"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1613" style="margin-right: 0.05em;">D</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1614" style="vertical-align: -0.4em;">i</span></span><span class="MJXp-mo" id="MJXp-Span-1615">,</span><span class="MJXp-munderover" id="MJXp-Span-1616"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mo" id="MJXp-Span-1618" style="margin-right: 0px; margin-left: 0px;">¬Ø</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1617">d</span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1619">‚àà</span><span class="MJXp-munderover" id="MJXp-Span-1620"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mo" id="MJXp-Span-1624" style="margin-right: 0px; margin-left: 0px;">¬Ø</span></span><span class=""><span class="MJXp-msubsup" id="MJXp-Span-1621"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1622" style="margin-right: 0.05em;">D</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1623" style="vertical-align: -0.4em;">i</span></span></span></span></span></span></span></span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1625">h</span><span class="MJXp-mo" id="MJXp-Span-1626" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-msubsup" id="MJXp-Span-1627"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1628" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1629" style="vertical-align: -0.4em;"><span class="MJXp-munderover" id="MJXp-Span-1630"><span><span class="MJXp-over"><span class=" MJXp-script"><span class="MJXp-mo" id="MJXp-Span-1632" style="margin-right: 0px; margin-left: 0px;">¬Ø</span></span><span class=""><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1631">d</span></span></span></span></span></span></span><span class="MJXp-mo" id="MJXp-Span-1633" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-1634"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1635" style="margin-right: 0.05em;">r</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1636" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1637">d</span></span></span><span class="MJXp-mo" id="MJXp-Span-1638" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1639" style="margin-left: 0.267em; margin-right: 0.267em;">+</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1640">Œª</span><span class="MJXp-mrow" id="MJXp-Span-1641"><span class="MJXp-mo" id="MJXp-Span-1642" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-1643"><span class="MJXp-mo" id="MJXp-Span-1644" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1645">Œæ</span><span class="MJXp-mrow" id="MJXp-Span-1646"><span class="MJXp-mo" id="MJXp-Span-1647" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1648"><span class="MJXp-mrow" id="MJXp-Span-1649" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-1650" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1651" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1652" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-148-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex; mode=display" id="MathJax-Element-148"> L = \sum_{i} \sum_{d \in D_i, \overline{d} \in \overline{D_i} } h(r_{\overline{d}} - r_{d}) + \lambda||\xi||^2,</script> </math></p><br><p>  Where <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1680"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1681">h</span><span class="MJXp-mo" id="MJXp-Span-1682" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1683">x</span><span class="MJXp-mo" id="MJXp-Span-1684" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1685" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-mn" id="MJXp-Span-1686">0</span><span class="MJXp-mspace" id="MJXp-Span-1687" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-1688" style="margin-left: 0.333em; margin-right: 0.333em;">‚ü∫</span><span class="MJXp-mspace" id="MJXp-Span-1689" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1690">x</span><span class="MJXp-mo" id="MJXp-Span-1691" style="margin-left: 0.333em; margin-right: 0.333em;">&lt;</span><span class="MJXp-mn" id="MJXp-Span-1692">0</span><span class="MJXp-mo" id="MJXp-Span-1693" style="margin-left: 0em; margin-right: 0.222em;">;</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1694">h</span><span class="MJXp-mo" id="MJXp-Span-1695" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1696">x</span><span class="MJXp-mo" id="MJXp-Span-1697" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1698" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1699"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1700" style="margin-right: 0.05em;">x</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1701" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mspace" id="MJXp-Span-1702" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mo" id="MJXp-Span-1703" style="margin-left: 0.333em; margin-right: 0.333em;">‚ü∫</span><span class="MJXp-mspace" id="MJXp-Span-1704" style="width: 0.278em; height: 0em;"></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1705">x</span><span class="MJXp-mo" id="MJXp-Span-1706" style="margin-left: 0.333em; margin-right: 0.333em;">‚©æ</span><span class="MJXp-mn" id="MJXp-Span-1707">0</span><span class="MJXp-mo" id="MJXp-Span-1708" style="margin-left: 0em; margin-right: 0.222em;">;</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-149-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-149">h(x) = 0\iff x <0; h(x) = x^2 \iff x\geqslant 0;</script> </math> ‚Äî    , <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1709"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1710">Œª</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-150-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-150">\lambda</script> </math> ‚Äî  <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1711"><span class="MJXp-msubsup" id="MJXp-Span-1712"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1713" style="margin-right: 0.05em;">L</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1714" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-151-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-151">L_2</script> </math>   <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1715"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1716">Œæ</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-152-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-152">\xi</script> </math>  , <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1717"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1718">r</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-153-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-153">r</script> </math> ‚Äî     <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1719"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1720">r</span><span class="MJXp-mo" id="MJXp-Span-1721" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-msubsup" id="MJXp-Span-1722"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1723" style="margin-right: 0.05em;">M</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1724" style="vertical-align: 0.5em;">w</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1725">r</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-154-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-154">r = M^wr</script> </math>  <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1726"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1727">r</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-155-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-155">r</script> </math>  -      <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1728"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1729">i</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-156-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-156">i</script> </math>  . </p><br><p>   ‚Äî      ,   PageRank,  .  ‚Äî  17-   2014 ,  9-27. </p><br><p>             cs224w. </p><br><h1 id="node2vec">        </h1><br><p>     ! </p><br><p> ,      ,         ,     .  ,     ,    ,      . </p><br><p>     ,         ,              . </p><br><p><img src="http://safronov.kiev.ua/ods/node2vec.png" alt="image"></p><br><p><br>           . </p><br><blockquote> <strong>,  :</strong> <br><br> 1)   (  ENC,     <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1730"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1731">u</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-157-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-157">u</script> </math>   <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1732"><span class="MJXp-msubsup" id="MJXp-Span-1733"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1734" style="margin-right: 0.05em;">z</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1735" style="vertical-align: -0.4em;">u</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-158-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-158">z_u</script> </math>  ); <br> 2)     (   ,       ); <br> 3)     , : <br><br><math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1736"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1737">s</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1738">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1739">m</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1740">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1741">l</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1742">a</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1743">r</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1744">i</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1745">t</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1746">y</span><span class="MJXp-mo" id="MJXp-Span-1747" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1748">u</span><span class="MJXp-mo" id="MJXp-Span-1749" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1750">v</span><span class="MJXp-mo" id="MJXp-Span-1751" style="margin-left: 0em; margin-right: 0em;">)</span><span class="MJXp-mo" id="MJXp-Span-1752" style="margin-left: 0.333em; margin-right: 0.333em;">‚âà</span><span class="MJXp-msubsup" id="MJXp-Span-1753"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1754" style="margin-right: 0.05em;">z</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1757"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1758">T</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1755"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1756">v</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1759"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1760" style="margin-right: 0.05em;">z</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1761" style="vertical-align: -0.4em;">v</span></span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-159-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex; mode=display" id="MathJax-Element-159">similarity(u,v) \approx z_{v}^{T} z_v</script> </math><br><br><img src="http://safronov.kiev.ua/ods/node2vec_embedding_tr.png" alt="image"></blockquote><p><br>    ,  ,    ,      .  ,        . </p><br><p> ,    ,    ? </p><br><p> ,  ,    ‚Äî               .       : </p><br><p><math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math MJXp-display" id="MJXp-Span-1762"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1763">L</span><span class="MJXp-mo" id="MJXp-Span-1764" style="margin-left: 0.333em; margin-right: 0.333em;">=</span><span class="MJXp-munderover" id="MJXp-Span-1765"><span class=""><span class="MJXp-mo" id="MJXp-Span-1766" style="margin-left: 0.111em; margin-right: 0.167em;"><span class="MJXp-largeop">‚àë</span></span></span><span class=" MJXp-script"><span class="MJXp-mrow" id="MJXp-Span-1767" style="margin-left: 0px;"><span class="MJXp-mo" id="MJXp-Span-1768">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1769">u</span><span class="MJXp-mo" id="MJXp-Span-1770">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1771">v</span><span class="MJXp-mo" id="MJXp-Span-1772">)</span><span class="MJXp-mo" id="MJXp-Span-1773">‚àà</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1774">V</span><span class="MJXp-mo" id="MJXp-Span-1775">√ó</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1776">V</span></span></span></span><span class="MJXp-mrow" id="MJXp-Span-1777"><span class="MJXp-mo" id="MJXp-Span-1778" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mrow" id="MJXp-Span-1779"><span class="MJXp-mo" id="MJXp-Span-1780" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1781"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1782" style="margin-right: 0.05em;">z</span><span class="MJXp-script-box" style="height: 1.86em; vertical-align: -0.64em;"><span class=" MJXp-script"><span><span style="margin-bottom: -0.25em;"><span class="MJXp-mrow" id="MJXp-Span-1785"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1786">T</span></span></span></span></span><span class=" MJXp-script"><span><span style="margin-top: -0.85em;"><span class="MJXp-mrow" id="MJXp-Span-1783"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1784">u</span></span></span></span></span></span></span><span class="MJXp-msubsup" id="MJXp-Span-1787"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1788" style="margin-right: 0.05em;">z</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1789" style="vertical-align: -0.4em;">v</span></span><span class="MJXp-mo" id="MJXp-Span-1790" style="margin-left: 0.267em; margin-right: 0.267em;">‚àí</span><span class="MJXp-msubsup" id="MJXp-Span-1791"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1792" style="margin-right: 0.05em;">A</span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1793" style="vertical-align: -0.4em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1794">u</span><span class="MJXp-mo" id="MJXp-Span-1795">,</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1796">v</span></span></span><span class="MJXp-mrow" id="MJXp-Span-1797"><span class="MJXp-mo" id="MJXp-Span-1798" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-msubsup" id="MJXp-Span-1799"><span class="MJXp-mrow" id="MJXp-Span-1800" style="margin-right: 0.05em;"><span class="MJXp-mo" id="MJXp-Span-1801" style="margin-left: 0.167em; margin-right: 0.167em;">|</span></span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1802" style="vertical-align: 0.5em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1803" style="margin-left: 0em; margin-right: 0.222em;">,</span></span></span><div class="MathJax_SVG_Display MathJax_SVG_Processing"><span class="MathJax_SVG" id="MathJax-Element-160-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span></div><script type="math/tex; mode=display" id="MathJax-Element-160">L = \sum_{(u,v) \in V \times V} || z_{u}^{T}z_v - A_{u,v}||^2,</script> </math></p><br><p>   (,  )  <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1804"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1805">Z</span><span class="MJXp-mo" id="MJXp-Span-1806" style="margin-left: 0.333em; margin-right: 0.333em;">‚àà</span><span class="MJXp-msubsup" id="MJXp-Span-1807"><span class="MJXp-mrow" id="MJXp-Span-1808" style="margin-right: 0.05em;"><span class="MJXp-mi undefined" id="MJXp-Span-1809">R</span></span><span class="MJXp-mrow MJXp-script" id="MJXp-Span-1810" style="vertical-align: 0.5em;"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1811">d</span><span class="MJXp-mo" id="MJXp-Span-1812">√ó</span><span class="MJXp-mrow" id="MJXp-Span-1813"><span class="MJXp-mo" id="MJXp-Span-1814">|</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1815">V</span><span class="MJXp-mrow" id="MJXp-Span-1816"><span class="MJXp-mo" id="MJXp-Span-1817">|</span></span></span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-161-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-161">Z \in \mathbb{R}^{d \times|V|}</script> </math> ,   <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1818"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1819">L</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-162-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-162">L</script> </math>  . </p><br><p>   ‚Äî   <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1820"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1821">N</span><span class="MJXp-mo" id="MJXp-Span-1822" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1823">v</span><span class="MJXp-mo" id="MJXp-Span-1824" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-163-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-163">N(v)</script> </math>   ,   . </p><br><p><img src="http://safronov.kiev.ua/ods/node2vec_neighborhood.png" alt="image"></p><br><p>       .  ,    ‚Äî <a href="http://www.perozzi.net/projects/deepwalk/">DeepWalk</a> .     ,              <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1825"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1826">v</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-164-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-164">v</script> </math> ,              word2vec. </p><br><p>     ,       ‚Äî   ‚Äî          .   word2vec   ,     .  ‚Äî ! </p><br><p>  DeepWalk       ‚Äî       ,       <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1827"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1828">M</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-165-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-165">M</script> </math> (  ,  <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1829"><span class="MJXp-msubsup" id="MJXp-Span-1830"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1831" style="margin-right: 0.05em;">M</span><span class="MJXp-mi MJXp-italic MJXp-script" id="MJXp-Span-1832" style="vertical-align: 0.5em;">w</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-166-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-166">M^w</script> </math> ). ,      ‚Äî       . </p><br><p>  ,   ,  <a href="https://habr.com/post/351454/"></a> <a href="http://haifux.org/lectures/79/random.pdf"> </a>  <a href="https://habr.com/post/419725/"> </a> .          . </p><br><blockquote> <em>¬´,      , , .    ,   ,    ‚Äî      ,    , ,    ‚Ä¶          ...¬ª</em> <br><br> <i>‚Äî   </i> </blockquote><p><br>            ¬´Black and White Noise¬ª ‚Äî  1995 <a href="https://en.wikipedia.org/wiki/George_Marsaglia"> </a>   -  ,             . </p><br><p>    <a href="http://snap.stanford.edu/node2vec/">node2vec</a> ,        ‚Äî  ,  ,         . ,   . </p><br><p> ,         <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1833"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1834">u</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-167-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-167">u</script> </math> ,    <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1835"><span class="MJXp-msubsup" id="MJXp-Span-1836"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1837" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1838" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-168-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-168">s_1</script> </math> ,  <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1839"><span class="MJXp-msubsup" id="MJXp-Span-1840"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1841" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1842" style="vertical-align: -0.4em;">2</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-169-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-169">s_2</script> </math>  and <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1843"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1844">w</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-170-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-170">w</script> </math> ‚Äî   ,  <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1845"><span class="MJXp-msubsup" id="MJXp-Span-1846"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1847" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1848" style="vertical-align: -0.4em;">3</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-171-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-171">s_3</script> </math> ‚Äî  .   ,        : 1)    <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1849"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1850">u</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-172-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-172">u</script> </math>  ; 2)        <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1851"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1852">u</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-173-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-173">u</script> </math> ,   ,    ; 3)   <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1853"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1854">u</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-174-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-174">u</script> </math>  . </p><br><p><img src="http://safronov.kiev.ua/ods/node2vec_strategy_cut.png" alt="image"></p><br><p> <strong>      :</strong> <br><math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1855"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1856">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-175-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-175">p</script> </math> ‚Äî      ; <br><math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1857"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1858">q</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-176-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-176">q</script> </math> ‚Äî        . </p><br><p>        : </p><br><p> ,     <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1859"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1860">w</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-177-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-177">w</script> </math>       <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1861"><span class="MJXp-msubsup" id="MJXp-Span-1862"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1863" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1864" style="vertical-align: -0.4em;">1</span></span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-178-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-178">s_1</script> </math>  .   <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1865"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1866">e</span><span class="MJXp-mo" id="MJXp-Span-1867" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1868">w</span><span class="MJXp-mo" id="MJXp-Span-1869" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1870"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1871" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1872" style="vertical-align: -0.4em;">1</span></span><span class="MJXp-mo" id="MJXp-Span-1873" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-179-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-179">e(w,s_1)</script> </math>    ( ) <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1874"><span class="MJXp-mn" id="MJXp-Span-1875">1</span><span class="MJXp-mrow" id="MJXp-Span-1876"><span class="MJXp-mo" id="MJXp-Span-1877" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1878">p</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-180-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-180">1/p</script> </math>  .   <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1879"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1880">e</span><span class="MJXp-mo" id="MJXp-Span-1881" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1882">w</span><span class="MJXp-mo" id="MJXp-Span-1883" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1884"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1885" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1886" style="vertical-align: -0.4em;">2</span></span><span class="MJXp-mo" id="MJXp-Span-1887" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-181-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-181">e(w,s_2)</script> </math>  - <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1888"><span class="MJXp-mn" id="MJXp-Span-1889">1</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-182-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-182">1</script> </math> (     ,   ,   <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1890"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1891">u</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-183-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-183">u</script> </math> ).     <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1892"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1893">u</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-184-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-184">u</script> </math>  <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1894"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1895">e</span><span class="MJXp-mo" id="MJXp-Span-1896" style="margin-left: 0em; margin-right: 0em;">(</span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1897">w</span><span class="MJXp-mo" id="MJXp-Span-1898" style="margin-left: 0em; margin-right: 0.222em;">,</span><span class="MJXp-msubsup" id="MJXp-Span-1899"><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1900" style="margin-right: 0.05em;">s</span><span class="MJXp-mn MJXp-script" id="MJXp-Span-1901" style="vertical-align: -0.4em;">3</span></span><span class="MJXp-mo" id="MJXp-Span-1902" style="margin-left: 0em; margin-right: 0em;">)</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-185-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-185">e(w,s_3)</script> </math>  - <math> <span class="MathJax_Preview" style="color: inherit;"><span class="MJXp-math" id="MJXp-Span-1903"><span class="MJXp-mn" id="MJXp-Span-1904">1</span><span class="MJXp-mrow" id="MJXp-Span-1905"><span class="MJXp-mo" id="MJXp-Span-1906" style="margin-left: 0.111em; margin-right: 0.111em;">/</span></span><span class="MJXp-mi MJXp-italic" id="MJXp-Span-1907">q</span></span></span><span class="MathJax_SVG MathJax_SVG_Processing" id="MathJax-Element-186-Frame" tabindex="0" style="font-size: 100%; display: inline-block;"></span><script type="math/tex" id="MathJax-Element-186">1/q</script> </math>  . </p><br><p>  ‚Äî   (    1),    . </p><br><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We are interested in the sequence of visited vertices - we will send it to word2vec ( </font></font><a href="http://mccormickml.com/2016/04/19/word2vec-tutorial-the-skip-gram-model/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">this article</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> will help you </font><a href="http://mccormickml.com/2016/04/19/word2vec-tutorial-the-skip-gram-model/"><font style="vertical-align: inherit;">to</font></a><font style="vertical-align: inherit;"> deal with it </font><font style="vertical-align: inherit;">, or lecture 8 of </font></font><a href="https://habr.com/post/414165/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the Deep Learning course on your fingers</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ). </font><font style="vertical-align: inherit;">Selection of strategies for the vagabond, optimal for solving specific problems - the area of ‚Äã‚Äãactive research. </font><font style="vertical-align: inherit;">For example, node2vec, with which we have become familiar, is a champion in the classification of vertices (for example, determining the toxicity of drugs, or gender / age / race of a social network member).</font></font></p><br><p> We will optimize the probability of the appearance of vertices on the tramp's path, the loss function </p><br><p><math> </math> $$ display $$ L = \ sum_ {u \ in V} \ sum_ {v \ in N_ {R} (u)} -log (P (v | z_u)) $$ display $$ </p><br><p>  in its explicit form, a rather expensive computational pleasure </p><br><p><math> </math> $$ display $$ L = \ sum_ {u \ in V} \ sum_ {v \ in N_ {R} (u)} -log (\ frac {e ^ {z_ {u} ^ {T} z_v}} { \ sum_ {n \ in V} e ^ {z_ {u} ^ {T} z_n}}), $$ display $$ </p><br><p>  which, by happy coincidence, is solved by <a href="http://mccormickml.com/2017/01/11/word2vec-tutorial-part-2-negative-sampling/">negative sampling</a> , since </p><br><p><math> </math> $$ display $$ log (\ frac {e ^ {z_ {u} ^ {T} z_v}} {\ sum_ {n \ in V} e ^ {z_ {u} ^ {T} z_n}}) \ approx log (\ sigma (z_ {u} ^ {T} z_v)) - \ sum_ {i = 1} ^ {k} log (\ sigma (z_ {u} ^ {T} z_ {n_i})), \\ where \, \, \, n_i \ sim P_V, \ sigma (x) = \ frac {1} {1 + e ^ {- x}}. $$ display $$ </p><br><p>  So, we figured out how to get a vector representation of the vertices.  In the bag! </p><br><p><img src="http://safronov.kiev.ua/ods/The_Mad_Hatter.jpg" alt="image"></p><br><blockquote>  <strong>How to prepare embeddings for ribs:</strong> <br><br>  We need to define an operator that allows for any pair of vertices <math> </math> $ inline $ u $ inline $   and <math> </math> $ inline $ v $ inline $   build vector representation <math> </math> $ inline $ z _ {(u, v)} = g (z_u, z_v) $ inline $   regardless of whether they are related on the graph.  Such an operator can be: <br><br>  a) arithmetic average: <math> </math> $ inline $ [z_u \ oplus z_v] _i = \ frac {z_u (i) + z_v (i)} {2} $ inline $   ; <br>  b) the work of Hadamard: <math> </math> $ inline $ [z_u \ odot z_v] _i = z_u (i) * z_v (i) $ inline $   ; <br>  c) weighted L1 norm: <math> </math> $ inline $ || z_u - z_v || _ {\ overline {1} i} = | z_u (i) - z_v (i) | $ inline $   ; <br>  d) weighted L2 norm: <math> </math> $ inline $ || z_u - z_v || _ {\ overline {2} i} = | z_u (i) - z_v (i) | ^ 2 $ inline $   . <br><br>  In experiments, the work of Hadamard behaves most steadily. <br><br>  <strong>Just in case, remember Free Lunch Theorem:</strong> <br><br>  No algorithm is universal - it is worth checking out a few methods. </blockquote><p><br>  The development of node2vec is the <a href="http://snap.stanford.edu/ohmnet/">OhmNet</a> project, which allows you to merge several graphs into a hierarchy and construct embeddingings of vertices for different levels of hierarchy.  It was originally designed to simulate the connections between proteins in different organs (and they behave differently depending on location). </p><br><p><img src="http://safronov.kiev.ua/ods/node2vec_ohmnet.png" alt="image"></p><br><p>  An astute reader here will see similarities with organizational structure and business processes. </p><br><p>  And we - let us return for example from the field of IT-recruiting - selection of candidates, the most suitable for the already established team.  Earlier we considered unimodal connection graphs of conditional datasaentists, obtained from the history of interaction (in a unimodal graph, vertices and relations are of one type).  In reality, the number of social circles in which an individual can be included is more than one. </p><br><p>  Suppose, in addition to the history of joint participation in competitions, we also collected information about how datasaientists communicated in our <a href="http://ods.ai/">cozy chat room</a> .  Now we have two connection graphs, and OhmNet is great for solving the problem of creating embeddings from several structures. </p><br><p>  Now - about the shortcomings of the methods built on shallow encoders - there is only one hidden layer inside word2vec, the weights of which are encoded.  At the output, we get a vertex-vector correspondence table.  All of these approaches have the following limitations: </p><br><ul><li>  Each vertex is encoded with a unique vector and the model does not imply the sharing of parameters; </li><li>  We can encode only those vertices that the model saw during training ‚Äî we cannot do anything for new vertices (except to re-train the encoder again); </li><li>  The vectors of vertex properties are not taken into account. </li></ul><br><p>  From the indicated deficiencies are free graph convolution networks.  We got to Decagon! </p><br><h1 id="GraphSAGE">  Our days are a random tramp for everyone </h1><br><p>  I was lucky to write the first trainee diploma about the tramp and protect it back in 2003, but I had to go through the classic way with deep learning to figure out what was under the hood.  And it's funny there. </p><br><p>  First, let's look at why standard deep learning methods are not suitable for graphs. </p><br><blockquote>  <strong>Counts are not seals for you!</strong> <br><br>  The modern set of deep learning tools (multilayer, convolutional, and recurrent networks) is optimized for solving problems on fairly simple data ‚Äî sequences and lattices.  Graph - the structure is more complicated.  One of the problems that will prevent us from taking the adjacency matrix and sending it to the neural network is <a href="https://ru.wikipedia.org/wiki/%25D0%2598%25D0%25B7%25D0%25BE%25D0%25BC%25D0%25BE%25D1%2580%25D1%2584%25D0%25B8%25D0%25B7%25D0%25BC_%25D0%25B3%25D1%2580%25D0%25B0%25D1%2584%25D0%25BE%25D0%25B2">isomorphism</a> . <br><br>  In our toy graph <math> </math> $ inline $ G $ inline $   consisting of vertices <math> </math> $ inline $ \ {A, B, C, D \} $ inline $   for constructing the adjacency matrix <math> </math> $ inline $ A $ inline $   , we assumed through numbering <math> </math> $ inline $ \ {1,2,3,4 \} $ inline $   .  It is easy to see that we can number vertices differently, for example <math> </math> $ inline $ \ {1,3,2,4 \} $ inline $   , or <math> </math> $ inline $ \ {4,1,3,2 \} $ inline $   - each time receiving a new adjacency matrix of the same graph. <br><br><math> </math> $ inline $ \ begin {align *} A = \ left [\ begin {matrix} 0 &amp; 1 &amp; 3 &amp; 0 \\ 1 &amp; 0 &amp; 2 &amp; 1 \\ 3 &amp; 2 &amp; 0 &amp; 0 \\ 0 &amp; 1 &amp; 0 &amp; 0 \ end {matrix} \ right], \, A ^ {\ {1,3,2,4 \}} = \ left [\ begin {matrix} 0 &amp; 3 &amp; 1 &amp; 0 \\ 3 &amp; 0 &amp; 2 &amp; 0 \\ 1 &amp; 2 &amp; 0 &amp; 1 \\ 0 &amp; 0 &amp; 1 &amp; 0 \ end {matrix} \ right], \, A ^ {\ {4,1,3,2 \}} = \ left [\ begin {matrix} 0 &amp; 1 &amp; 2 &amp; 1 \\ 1 &amp; 0 &amp; 0 &amp; 0 \\ 2 &amp; 0 &amp; 0 &amp; 3 \\ 1 &amp; 0 &amp; 3 &amp; 0 \ end {matrix} \ right].  \ end {align *} $ inline $ <br><br>  In the case of cats, our network would have to learn to recognize them with all possible permutations of rows and columns - that is also a problem.  As an exercise, try to change the numbering of the points in the picture below so that when they are connected in series, the cat will turn out. <br><br><img src="http://safronov.kiev.ua/ods/isomorphism.png" alt="image"></blockquote><p><br>  The next bad luck with graphs with ordinary neural networks is the standard input dimension.  When we work with images, we always normalize the size of the image in order to feed it to the input of the network - it is of a fixed size.  With graphs, such a focus will not work - the number of vertices can be arbitrary - to squeeze the connectivity matrix to a given dimension without losing information - that is another challenge. </p><br><p>  The solution is to build new architectures, inspired by the structure of the graphs. </p><br><p><img src="http://safronov.kiev.ua/ods/gcn_concept.png" alt="image"></p><br><p>  <strong>To do this, we use a simple two-step strategy:</strong> </p><br><ol><li>  For each vertex, we construct a computational graph using a tramp; </li><li>  Collect and transform information about neighbors. </li></ol><br><p>  Recall that the properties of the vertices we store in vectors <math> </math> $ inline $ f ^ {(u)} $ inline $   - matrix columns <math> </math> $ inline $ X \ in \ mathbb {R} ^ {k \ times | V |} $ inline $   and our task is for each vertex <math> </math> $ inline $ u $ inline $   collect properties of adjacent vertices <math> </math> $ inline $ f ^ {(v \ in N (u))} $ inline $   to get embedding vectors <math> </math> $ inline $ z_ {u} $ inline $   .  The computational graph can be of arbitrary depth.  Consider the option with two layers. </p><br><p><img src="http://safronov.kiev.ua/ods/gcn_concept1.png" alt="image"></p><br><p>  The zero layer is the properties of the vertices, the first is the intermediate aggregation using a certain function (indicated by a question mark), the second is the final aggregation, which produces the embeddingings vectors of interest. </p><br><p>  And what's in the boxes? </p><br><p>  In the <a href="https://arxiv.org/abs/1609.02907">simple case</a> - a layer of neurons and nonlinearity: </p><br><p><math> </math> $$ display $$ h ^ 0_v = x_v (= f ^ {(v)});  \\ h ^ k_v = \ sigma (W_k \ sum_ {u \ in N (v)} \ frac {h ^ {k-1} _v} {| N (v) |} + B_k h ^ {k-1} _v), \ forall k \ in \ {1, ..., K \}; \\ z_v = h ^ K_v, $$ display $$ </p><br><p>  Where <math> </math> $ inline $ w_k $ inline $   and <math> </math> $ inline $ b_k $ inline $   - model weights, which we will learn by gradient descent, using one of the considered loss functions, and <math> </math> $ inline $ \ sigma $ inline $   - non-linearity, for example RELU: <math> </math> $ inline $ \ sigma (x) = max (0, x) $ inline $   . </p><br><p>  And here we find ourselves at a crossroads - depending on the task at hand, we can: </p><br><ul><li>  study without a teacher and take advantage of any of the previously considered loss functions - vagrants, or ribs weight.  The weights obtained will be optimized so that the vectors of similar vertices are placed compactly; </li><li>  start training with a teacher, for example - solve the problem of classification, wondering if the drug will be toxic. </li></ul><br><p>  For the problem of binary classification, the loss function takes the form: </p><br><p><math> </math> $$ display $$ L = \ sum_ {v \ in V} y_v log (\ sigma (z_v ^ T \ theta)) + (1-y_v) log (1- \ sigma (z_v ^ T \ theta)), $ $ display $$ </p><br><p>  Where <math> </math> $ inline $ y_v $ inline $   - vertex class <math> </math> $ inline $ v $ inline $   , <math> </math> $ inline $ \ theta $ inline $   - vector of scales, and <math> </math> $ inline $ \ sigma $ inline $   - non-linearity, for example sigmoid: <math> </math> $ inline $ \ sigma (x) = \ frac {1} {1 + e ^ {- x}} $ inline $   . </p><br><p>  A trained reader here learns cross-entropy and logistic regression, and an unprepared one will think that it is worth going through <a href="https://mlcourse.ai/">an open machine learning course</a> to feel comfortable with the <a href="https://habrahabr.ru/company/ods/blog/322534/">task of classification</a> , <a href="https://habrahabr.ru/company/ods/blog/323890/">simple</a> , and <a href="https://habrahabr.ru/company/ods/blog/324402/">more advanced</a> algorithms for solving it (including <a href="https://habrahabr.ru/company/ods/blog/327250/">gradient boosting</a> ). </p><br><p>  And we will move on and consider the principle of operation of <a href="http://snap.stanford.edu/graphsage/">GraphSAGE</a> - the forerunner of Decagon. </p><br><p><img src="http://safronov.kiev.ua/ods/gcn_concept2.png" alt="image"></p><br><p>  For each vertex <math> </math> $ inline $ v $ inline $   we will aggregate information from neighbors <math> </math> $ inline $ u \ in N (v) $ inline $   and her. </p><br><p><math> </math> $$ display $$ h ^ k_v = \ sigma ([W_k \ cdot AGG (\ {h ^ {k-1} _u, \ forall u \ in N (v) \}), B_k h ^ {k-1} _v]), $$ display $$ </p><br><p>  Where <math> </math> $ inline $ AGG $ inline $   - generalized designation of the aggregation function - the main thing - differentiable. </p><br><p>  <strong>Averaging:</strong> take the weighted average of the neighbors </p><br><p><math> </math> $$ display $$ AGG = \ sum_ {u \ in N (v)} \ frac {h ^ {k-1} _u} {| N (v) |}. $$ display $$ </p><br><p>  <strong>Pulling:</strong> elementwise average / maximum value </p><br><p><math> </math> $$ display $$ AGG = \ gamma (\ {Qh ^ {k-1} _u, \ forall u \ in N (v) \}). $$ display $$ </p><br><p>  <strong>LSTM:</strong> shake up the environment (do not mix!) And run in <a href="https://ru.wikipedia.org/wiki/%25D0%2594%25D0%25BE%25D0%25BB%25D0%25B3%25D0%25B0%25D1%258F_%25D0%25BA%25D1%2580%25D0%25B0%25D1%2582%25D0%25BA%25D0%25BE%25D1%2581%25D1%2580%25D0%25BE%25D1%2587%25D0%25BD%25D0%25B0%25D1%258F_%25D0%25BF%25D0%25B0%25D0%25BC%25D1%258F%25D1%2582%25D1%258C">LSTM</a> </p><br><p><math> </math> $$ display $$ AGG = LSTM ([h ^ {k-1} _u, \ forall u \ in \ pi (N (v))]). $$ display $$ </p><br><p>  On Pinterest, for example, they stuffed multilayer <a href="https://ru.wikipedia.org/wiki/%25D0%259F%25D0%25B5%25D1%2580%25D1%2586%25D0%25B5%25D0%25BF%25D1%2582%25D1%2580%25D0%25BE%25D0%25BD">perceptrons into it</a> and rolled it into <a href="https://arxiv.org/abs/1806.01973">PinSAGE prod</a> . </p><br><p>  In solving the problem of predicting the functions of proteins in organs, the aggregator pooling and LSTM (which are forever) were especially notable.  Consider it in more detail and give an analogy with the processes of team building and IT-recruiting. </p><br><blockquote>  <strong>Let's draw obvious parallels:</strong> <br><br><ul><li>  Introductory: organ and protein, the goal - to determine the function performed by this protein in this organ. </li><li>  In the world of team building, introductory: project / division and specialist, the goal is to define a role in a team. </li></ul><br></blockquote><p><br>  With the development of technology and the growing amount of data on interactions between substances, marking them with the help of people is a task beyond what can be done.  It seems that <a href="https://ru.wikipedia.org/wiki/%25D0%25A2%25D0%25B5%25D1%2585%25D0%25BD%25D0%25BE%25D0%25BB%25D0%25BE%25D0%25B3%25D0%25B8%25D1%2587%25D0%25B5%25D1%2581%25D0%25BA%25D0%25B0%25D1%258F_%25D1%2581%25D0%25B8%25D0%25BD%25D0%25B3%25D1%2583%25D0%25BB%25D1%258F%25D1%2580%25D0%25BD%25D0%25BE%25D1%2581%25D1%2582%25D1%258C">technological singularity</a> has already begun in certain areas of knowledge.  For example, during one of my first presales, when we were selling a system for constructing shift schedules for several thousand support center employees, an assessment of complexity sunk into my head.  One manager can equalize the load taking into account the types of hiring (permanent / temporary) employees, years of service, necessary skills, and other things - manually - for no more than 30 people. </p><br><p>  In similar organs, proteins perform biologically similar functions. </p><br><p>  The task is to determine the probability of performing one of the many functions (multi-label node <br>  classification task) - one protein can fulfill several roles in different organs.  Solution - use graphs of interactions between proteins in different organs.  The properties of the peaks (proteins) will be their genetic structures and immunological signatures (these data are rather fragmentary and inaccessible for 42% of proteins).  We train the GraphSAGE graph convolutional network, and we learn the weights common to all vertices - now we know the generalized rules for the aggregation of information about neighbors. </p><br><p>  The resulting weights allow you to generate embeddings for previously unseen graphs! </p><br><p>  And this allows us to determine the function of proteins in previously unexplored organs, which is a breakthrough for medicine, since not all studies can be carried out, leaving the object alive.  This kind of information helps to develop new drugs of directional action, which is certainly great. </p><br><p>  Now we have dealt with the details necessary to understand the functioning of the Decagon.  Recall, the method consists in building a multimodal protein-protein, drug-protein interactions graph, and side effects from a combination of drugs, which are represented by drug-drug drug relationships, where each of the side effects is a certain type of rib.  Each of the side effects is modeled in isolation.  For each drug vertex, we build 964 (by the number of side effects) computational graphs. </p><br><p><img src="http://safronov.kiev.ua/ods/gcn_concept3.png" alt="image"></p><br><p>  Then, for each drug, a computational graph is constructed nonlinearly, combining the graphs obtained in the previous step with the drug-protein and protein-protein interaction graphs. </p><br><p><img src="http://safronov.kiev.ua/ods/gcn_concept4.png" alt="image"></p><br><p>  Formally, for each layer we compute </p><br><p><math> </math> $$ display $$ h ^ k_v = \ sigma (\ sum_rW ^ {k-1} _r (\ sum_ {u \ in N_r (v)} \ frac {h ^ {k-1} _u} {\ sqrt {| N_r (v) || N_r (u) |}} + \ frac {h ^ {k-1} _v} {| N_r (v) |})), $$ display $$ </p><br><p>  Where <math> </math> $ inline $ \ sigma $ inline $   - non-linearity, for example RELU.  As we see, Decagon used the simplest version of the graph convolutional network - a weighted sum.  Obviously, nothing prevents us from complicating the model, just like GraphSAGE.  The embeddingings of the vertices obtained on the final layer are fed to the input of the decoder, which returns the probabilities of the occurrence of each of the side effects when drugs are taken together. </p><br><p><img src="http://safronov.kiev.ua/ods/gcn_concept5.png" alt="image"></p><br><p>  Let's understand how this decoder functions. </p><br><p>  His task is to reconstruct the marked edges in the graph, relying on learned embeddingings.  Each type of edge is processed in its own way.  For each three parameters <math> </math> $ inline $ (u, r, v) $ inline $   The decoder calculates the function: </p><br><p><math> </math> $ inline $ \ begin {align *} g (u, r, v) = \ left \ {\ begin {matrix} z ‚Äã‚Äã^ T_uD_ {r_i} RD_ {r_i} z_j &amp; u, v - preparations;  \\ z ^ T_uM_rz_v &amp; u, v - drug \, and \, protein, \, or \, both \, proteins.  \ end {matrix} \ right. \ end {align *} $ inline $ </p><br><p>  and submits the result to a sigmoid to determine the probability of occurrence of an edge of a given type: </p><br><p><math> </math> $$ display $$ p ^ {uv} _ {r} = p ((u, r, v) \ in E) = \ sigma (g (u, r, v)), \ sigma (x) = \ frac {1} {1 + e ^ {- x}}. $$ display $$ </p><br><p>  So we have an end-to-end encoder-decoder model, in which there are four types of parameters: (i) <math> </math> $ inline $ W_r $ inline $   - weights of neural networks for the aggregation of each type of relationship in the graph, (ii) <math> </math> $ inline $ M_r $ inline $   - matrix of parameters of drug-protein and protein-protein relations, (iii) <math> </math> $ inline $ r $ inline $   - the general matrix of parameters of side effects, and (iv) <math> </math> $ inline $ D_ {r_i} $ inline $   - matrix parameters of each side effect. </p><br><p>  All these parameters are learned by gradient descent using the cross-entropy loss function and negative sampling to select non-existent edges. </p><br><p>  Here you can breathe out - the next update of the tip of progress is expected in six months. </p><br><p>  Summing up all the above, in complex systems with a bunch of interrelations that we model using graphs, the characteristic features are clearly manifested: 1) homophilia - like - attracts;  and 2) the old rule ‚ÄúTell me who your friend is and I will tell you who you are‚Äù is still relevant.  It's great that in order to curb all this riot of connections, now you no longer need to burn nerve cells, but you can just take and count. </p><br><h1 id="toolset">  How and where to store such data and where to get it. </h1><br><p>  Briefly - in RAM - so faster. </p><br><p>  My personal position regarding the processing of graphs in RAM on one machine is related to the fact that the size of structured data (namely, we build graphs from them) grows more slowly than the amount of available RAM for reasonable money.  For example, all genome research conducted by humankind from the <a href="https://en.wikipedia.org/wiki/GenBank">GenBank database will</a> fit in 1 TB, and a car with such a memory size now costs about the same as a golf class car - a working tool for a sales representative driving through pharmacies.  Cluster computations are great, but distributed triad counting for a large graph due to the need to coordinate and collect computation results takes <a href="https://arxiv.org/abs/1606.07550">several times (if not an order of magnitude)</a> more time than the same operation in SNAP with commensurate computing power. </p><br><p>  Consider a few tools available today and ways to work. </p><br><p>  A sufficiently detailed description of possible constructions of points and lines in the <a href="">eponymous work</a> gives those involved in the creation of the first graph database <a href="https://neo4j.com/">Neo4j</a> , in which the model of a graph with properties (property graph) is implemented. </p><br><p><img src="http://safronov.kiev.ua/ods/constructionsFromDotsAndLines.png" alt="image"></p><br><p>  This approach allows you to build a multimodal graph in which many different entities can be linked by different types of links.  The working task that the teacher addressed immediately was to link together (i) business processes, (ii) relations between employees, and (iii) a project plan in which pieces of work ‚Äî separate tasks ‚Äî somehow affect the first two.  It was possible to search for the answer independently. </p><br><p>  An alternative example of such data is the article itself and all those involved in it: </p><br><p><img src="http://safronov.kiev.ua/ods/propertyGraph.png" alt="image"></p><br><p>  In addition, the contribution of Neo4j to the industry is to create a declarative <a href="https://www.opencypher.org/">Cypher</a> language that implements a graph model with properties and operates in a form similar to SQL, with the following data types: vertices, relationships, dictionaries, lists, integers, floating point, and binary numbers, and lines.  An example of a query returning a list of films with Nicole Kidman: </p><br><pre><code class="hljs ruby">MATCH (<span class="hljs-symbol"><span class="hljs-symbol">nicole:</span></span>Actor {<span class="hljs-symbol"><span class="hljs-symbol">name:</span></span> <span class="hljs-string"><span class="hljs-string">'Nicole Kidman'</span></span>})-[<span class="hljs-symbol"><span class="hljs-symbol">:ACTED_IN</span></span>]-&gt;(<span class="hljs-symbol"><span class="hljs-symbol">movie:</span></span>Movie) WHERE movie.year &lt; $yearParameter RETURN movie</code> </pre> <br><p>  Neo4j with <a href="https://stackoverflow.com/questions/36361120/set-up-in-memory-database-instance-of-neo4j/36437239">crutches</a> can be made to work in memory. </p><br><p>  It is also worth mentioning <a href="https://gephi.org/">Gephi</a> - a convenient means of visualization and layout of graphs on the plane - the first network analysis tool from personally tested.  With a stretch we can assume that in Gephi it is possible to implement a graph with the properties of vertices and edges, though it will not be very convenient to work with it, and the set of algorithms for analysis is limited.  This does not detract from the merits of the package - for me it is in the first place in a series of visualization tools.  Having mastered the internal format of <a href="https://gephi.org/gexf/format/">GEXF</a> data <a href="https://gephi.org/gexf/format/">storage</a> , you can create impressive images.  Attracts the ability to easily export to the web, as well - the ability to set properties for vertices and edges in time and get <a href="https://www.youtube.com/watch%3Fv%3DpfZXcKAgLi0">intricate animations</a> as a result - built the routes of traveling salesmen from these sales.  All thanks to the layout of graphs on the map according to the coordinates of the vertices - the standard part of the package. </p><br><p>  Now I spend most of my research analytically, drawing pictures at the finish. </p><br><p>  My search for tools and data processing methods in complexly coupled systems continues.  Three years ago I found a solution for working with multimodal graphs.  The <a href="http://snap.stanford.edu/">SNAP</a> Jura Leskoveka Library is a tool that he developed for himself and has already measured a lot of things for him.  I use <a href="http://snap.stanford.edu/snappy/index.html">Snap.py</a> - the version for Python (a proxy for SNAP functions implemented in C ++) and a set of about three hundred available operations is enough for me in most cases. </p><br><p>  Recently Marinka Zhitnik released <a href="http://snap.stanford.edu/mambo/">MAMBO</a> - a set of tools (inside - SNAP) for working with multimodal networks and a tutorial in the form of a series of Jupyter notebooks with an exemplary analysis of genetic mutations. </p><br><p>  Finally, there is a <a href="https://www.youtube.com/playlist%3Flist%3DPLkzo92owKnVwCuJeNPcC7J_v4eT5_s6-d">SAP HANA Graph</a> - everything inside ML, SQL, OpenCypher is everything your heart desires. </p><br><p>  In favor of SAP HANA, the fact that digging is likely to result in well-structured transaction data from ERP, and clean data is worth a lot.  Another plus is the powerful tools for searching sub-graphs using predetermined patterns ‚Äî a useful and difficult task, which I have not seen in other packages and used <a href="https://www.weizmann.ac.il/mcb/UriAlon/download/network-motif-software">specialized programs</a> .  A free license for a developer provides a base of 1 GB in size - just enough to play around with fairly large networks.  Funny challenge - a set of analytical algorithms out of the box - small, PageRank will need to be implemented independently.  To do this, you need to master <a href="https://help.sap.com/viewer/f381aa9c4b99457fb3c6b53a2fd29c02/2.0.00/en-US/47b72452f48f4ca490fbffcb5ca31f92.html">GraphScript</a> - a new programming language, but these are trifles.  As my slalom trainer said, for the master it is dust! </p><br><p>  Now about where to get the data in order to build graphs out of them.  Some ideas: </p><br><ul><li>  Public university repositories: Stanford - <a href="http://snap.stanford.edu/data/index.html">General</a> and <a href="http://snap.stanford.edu/biodata/">Biomedical</a> , <a href="https://icon.colorado.edu/">Colorado</a> ; </li><li>  Combine the project plan with the organizational structure and risk register; </li><li>  Identify the links between product structure, technology, and user requirements; </li><li>  Conduct a <a href="https://habr.com/company/ods/blog/344598/">sociographic study</a> in a team; </li><li>  Come up with something of their own, inspired by <a href="http://snap.stanford.edu/class/cs224w-2017/projects.html">last year's</a> course <a href="http://snap.stanford.edu/class/cs224w-2017/projects.html">projects</a> cs224w. </li></ul><br><h1 id="beware">  What to fear </h1><br><p>  You could say there will be a final warning about the risks associated with this party. </p><br><p><img src="http://safronov.kiev.ua/ods/tea.png" alt="image"></p><br><p>  As you understand, ladies and gentlemen, the task of the program is to reflect the state of affairs at the cutting edge of progress in a very productive and generously funded research group.  It's like <a href="http://leningrad.top/">Leningrad</a> , only about modern mathematics.  Possible side effects: </p><br><ol><li>  <a href="https://ru.wikipedia.org/wiki/%25D0%25AD%25D1%2584%25D1%2584%25D0%25B5%25D0%25BA%25D1%2582_%25D0%2594%25D0%25B0%25D0%25BD%25D0%25BD%25D0%25B8%25D0%25BD%25D0%25B3%25D0%25B0_%25E2%2580%2594_%25D0%259A%25D1%2580%25D1%258E%25D0%25B3%25D0%25B5%25D1%2580%25D0%25B0">Dunning-Kruger</a> , modified, without a novice euphoria and a plateau of excellence.  Leskoveka try catch up. </li><li>  Boredom in the province by the sea.  Of the 400 people in the course given by the apparat, they were forced to write a project, and to pass the exam in the first session during my second magistracy, one and a half counters went.  The teachers in their research activities remained at the level of modularity and centrality measures.  On mitapakh about the python and the data is also sad.  In general, if you do not know how to entertain yourself, I warned. </li><li>  Pride in Slavic accent in English. </li></ol><br><h1 id="reproduce">  Memo to the replicator </h1><br><p>  Hi, replicator! </p><br><p>  In the adventure that Jura Leskovek gave us, you will need free time.  The course consists of 20 lectures, four houses, each of which is recommended to allocate about 20 hours of recommended literature, as well as - an extensive list of additional materials that will allow you to make a first impression of the state of affairs on the cutting edge of progress in any of the topics covered. </p><br><p>  To perform tasks it is strongly recommended to use the SNAP library (in a sense, the whole course can be considered as an overview of its capabilities). </p><br><p>  In addition, you can try to implement your own project or write a tutorial on the topic you like. </p><br><div class="spoiler">  <b class="spoiler_title">Lecture summary for 2017:</b> <div class="spoiler_text"><p>  <strong>1. Introduction and structure of graphs</strong> <br>  Network analysis is a universal language for describing complex systems and now is the time to deal with it.  The course focuses on three areas: network properties, models, and algorithms.  Let's start with the way objects are represented: nodes, edges, and how they are organized. </p><br><p>  <strong>2. World Wide Web and a random graph model</strong> <br>  We will find out why the Internet is like a butterfly, and we will get acquainted with the concept of strongly related components.  How to measure the network - the basic properties: the distribution of the degrees of the nodes, the length of the path, and the coefficient of clustering.  And get acquainted with the model of the random graph Erdosh-Rainey. </p><br><p>  <strong>3. The phenomenon of the small world</strong> <br>  We measure the basic properties of a random graph.  Let's compare it with real networks.  Let's talk about the number of Erdos and how small the world is.  Recall Stanley Milgram and about six handshakes.  Finally, let us describe everything that happens mathematically (the Watts-Strogatts model). </p><br><p>  <strong>4. Decentralized search in the small world and peer networks</strong> <br>  How to navigate a distributed network.  And how the torrents work.  Putting it all together - properties, models, and algorithms. </p><br><p>  <strong>5. Social network analysis applications</strong> <br>  Measures of centrality.  People on the Internet - as who estimates whom.  The effect of similarity.  Status.  Theory of structural balance. </p><br><p>  <strong>6. Networks with different edges</strong> <br>  Balance in networks.  Mutual likes and status.  How to feed the trolls. </p><br><p>  <strong>7. Cascades: Solution-based Models.</strong> <br>  Distribution in networks: diffusion of innovations, network effects, epidemics.  Model of collective action.  Solutions and game theory in networks. </p><br><p>  <strong>8. Cascades: Probabilistic Information Distribution Models</strong> <br>  Patterns of spreading epidemics based on random trees.  The spread of sores.  Independent cascades.  Mechanics of viral marketing.  Let's model interactions between infections. </p><br><p>  <strong>9. Maximize Impact</strong> <br>  How to create large cascades.  But in general, how difficult is the task?  Results of the experiments. </p><br><p>  <strong>10. Detection of infection</strong> <br>  What is common in contagion and news.  How to be aware of the most interesting.  And where to place the sensors in the water. </p><br><p>  <strong>11. Power law and preferred connection</strong> <br>  Network growth process.  Scale-invariant networks.  Mathematics power distribution function.  Consequences: network stability.  The model of preferred joining - the rich get richer. </p><br><p>  <strong>12. Models of growing networks</strong> <br>  We measure tails: exponential versus power.  The evolution of social networks.  View of all this from the height of bird flight. </p><br><p>  <strong>13. Kronecker graphs</strong> <br>  We continue the flight.  Forest fire model.  Recursive generation of graphs.  Stochastic Kronecker graphs.  Experiments with real networks. </p><br><p>  <strong>14. Linkage Analysis: HITS and PageRank</strong> <br>  How to organize the Internet?  Hubs and Authorities.  The find of Sergey Brin and Larry Page.  Drunk tramp with teleport.  How to make recommendations - Pinterest experience. </p><br><p>  <strong>15. Strength of weak connections and community structure in networks</strong> <br>  Triads and information flows.  How to highlight the community?  Girvana-Newman Method.  Modularity. </p><br><p>  <strong>16. Community Discovery: Spectral Clustering</strong> <br>  Welcome to the matrix!  Search for the optimal section.  Motifs (graphlets).  Food chains.  Gene expression. </p><br><p>  <strong>17. Biological networks</strong> <br>  Protein interactions.  Identification of chains of painful reactions.  Determination of molecular attributes, such as protein functions in cells.  What are the genes doing?  Hang tags. </p><br><p>  <strong>18. Intersecting communities in networks</strong> <br>  Different social circles.  From clusters to intersecting communities. </p><br><p>  <strong>19. Studying representations on graphs</strong> <br>  Automatic formation of features is just a holiday for the lazy.  Graph Embeddings.  Node2vec.  From individual graphs to complex hierarchical structures, OhmNet. </p><br><p>  <strong>20. Networks: a couple of fun</strong> <br>  The life cycle of an abstract community member.  And how to manage the behavior of communities with badges. </p></div></div><br><p>  I think, after immersing in the theory of graphs, the questions about trees will no longer be terrible.  However, this is only the opinion of an amateur who has never been interviewed by a developer once in his life. </p></div><p>Source: <a href="https://habr.com/ru/post/418727/">https://habr.com/ru/post/418727/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../418715/index.html">How effective is the procfs virtual file system and can it be optimized?</a></li>
<li><a href="../418717/index.html">Ghosts in Unicode</a></li>
<li><a href="../418721/index.html">Legends of virus construction: the beginning of the war</a></li>
<li><a href="../418723/index.html">AndroidX patch</a></li>
<li><a href="../418725/index.html">Magic constant</a></li>
<li><a href="../418729/index.html">All that you have asked for a long time, in one release - CLion 2018.2</a></li>
<li><a href="../418735/index.html">Focusing on ownership</a></li>
<li><a href="../418737/index.html">Laser ablation, tellurite glass and Er2O3 dopant</a></li>
<li><a href="../418739/index.html">Center for Additive Technology: Industrial 3D Printers 3D Systems, Stratasys, SLM, EOS</a></li>
<li><a href="../418743/index.html">The history of first place on the ML Boot Camp VI</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>