<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>SWEET32 attack: Researchers have discovered a new way to crack the 3DES and Blowfish ciphers</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Information security researchers Karthikeyan Bhargavan and Ga√´tan Leuren developed an attack on the 3DES and Blowfish ciphers. For example, it can be ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>SWEET32 attack: Researchers have discovered a new way to crack the 3DES and Blowfish ciphers</h1><div class="post__text post__text-html js-mediator-article"> <a href="https://habrahabr.ru/company/pt/blog/308746/"><img src="https://habrastorage.org/files/0fb/db6/e1c/0fbdb6e1cb9e401cba43656dbcd1a9d4.png"></a> <br><br>  Information security researchers Karthikeyan Bhargavan and Ga√´tan Leuren developed an attack on the 3DES and Blowfish ciphers.  For example, it can be used to authenticate cookies from encrypted 3DES HTTPS traffic, as well as recover user names and passwords from Blowfish-encrypted traffic transmitted via VPN. <br><br>  The attack, called SWEET32, is dedicated to a separate <a href="https://sweet32.info/">website</a> , the researchers plan to present its details and a demo video at the ACM Conference on Computer and Communications Security, which will be held next month in Austria.  We have collected the currently known information in our material. <a name="habracut"></a>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h3>  What is the problem </h3><br>  Cryptographic protocols like TLS, SSH, IPsec and OpenVPN use block encryption algorithms (AES, Triple-DES, Blowfish).  Thus, the data transmitted between the client and the server is encrypted.  The data is divided into blocks of fixed length, each of which is encrypted separately.  Older ciphers like Triple-DES and Blowfish use a block size of 64 bits, and AES uses a block size of 128 bits. <br><br>  The short block length makes the cipher vulnerable to " <a href="https://ru.wikipedia.org/wiki/%25D0%2590%25D1%2582%25D0%25B0%25D0%25BA%25D0%25B0_%25C2%25AB%25D0%25B4%25D0%25BD%25D0%25B5%25D0%25B9_%25D1%2580%25D0%25BE%25D0%25B6%25D0%25B4%25D0%25B5%25D0%25BD%25D0%25B8%25D1%258F%25C2%25BB">birthday attacks</a> ".  Researchers claim that such attacks are found for 64-bit ciphers of the TLS and OpenVPN protocols.  Such encryption algorithms are used by a huge amount of resources on the Internet. <br><br>  SWEET32 is a collision search attack in block-coupling mode using CBC feedback.  For example, an attacker who can monitor long-existing Triple-DES HTTPS connections between the browser and the site has the ability to restore HTTP cookies ‚Äî you will need to save 785 gigabytes of traffic. <br><br><img src="https://habrastorage.org/files/e15/c5f/d2a/e15c5fd2a05649679c15c68e55359e45.png"><br>  <i>Interception of secure traffic</i> <br><br>  In practice, this allows decrypting HTTPS connections - provided that the authentication token is transmitted in each request.  Due to the fact that it is possible to predict the contents of the message headers (or the possibility of their control), an attacker can generate a large number of requests with some predictive data in the answers and, as a result, try to decrypt the necessary sessions and find out the token. <br><br>  During the PoC attack, the researchers managed to do it in less than two days using a special JavaScript code to generate traffic. <br><br>  In terms of computational complexity, the SWEET32 attack is comparable to the recent attacks on the RC4 cipher.  In addition, the researchers were able to carry out similar attacks on VPN-sessions using 64-bit ciphers - for example, in practice this situation can occur in the case of the use of OpenVPN, which is configured to use Blowfish. <br><br><h3>  How serious is all </h3><br>  An important requirement for an attack is the need to send a large number of requests using the same TLS connection - this is a serious deterrent to the practical implementation of such attacks.  Thus, an attacker must find a client and server that not only communicate, for example, using Triple-DES, but also exchange a large number of HTTP requests within a single TLS connection without releasing new keys. <br><br>  This situation is possible - it all depends on the server, since all the tested browsers (Firefox, Chrome, Opera) use the TLS connection as long as the server keeps it open.  In turn, many HTTP servers close a TLS connection when a certain limit of transmitted traffic is reached, even if it remains active.  For example, Apache and Nginx limit the number of requests that can be sent within a single connection, the number 100. But, for example, IIS does not have such limits when using the standard settings. <br><br>  As a result, the total number of servers that accept a large number of requests over a single connection remains large, the researchers write.  The researchers scanned the web servers from the Alexa directory - the cipherscan tool was used for this.  It turned out that 86% supporting TLS include Triple-DES as one of the used ciphers. <br><br>  11483 different HTTPS severs were identified, 226 (1.9%) of which are communicating with clients using Triple-DES.  72 of these servers (0.6% of the total) kept the connection open for at least 800 thousand requests.  This means that the duration of the test attack does not indicate its unrealizability - about 0.6% of HTTPS connections on the Internet are vulnerable to it. <br><br><h3>  Poc attack </h3><br>  Below is the SWEET32 attack code.  For its implementation, web workers generating XmlHttpRequests are used. <br><br>  Content of attack.html file: <br><br><pre><code class="html hljs xml"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span><span class="javascript"><span class="javascript"> </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">var</span></span></span><span class="javascript"> W = </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">new</span></span></span><span class="javascript"> </span><span class="hljs-built_in"><span class="javascript"><span class="hljs-built_in">Array</span></span></span><span class="javascript">; </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">for</span></span></span><span class="javascript"> (</span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">var</span></span></span><span class="javascript"> i=</span><span class="hljs-number"><span class="javascript"><span class="hljs-number">0</span></span></span><span class="javascript">; i&lt;</span><span class="hljs-number"><span class="javascript"><span class="hljs-number">8</span></span></span><span class="javascript">; i++) { </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">var</span></span></span><span class="javascript"> x = </span><span class="hljs-keyword"><span class="javascript"><span class="hljs-keyword">new</span></span></span><span class="javascript"> Worker(</span><span class="hljs-string"><span class="javascript"><span class="hljs-string">"worker.js"</span></span></span><span class="javascript">); W.push(x); } </span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">script</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">body</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">html</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br>  Worker.js file: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> url = <span class="hljs-string"><span class="hljs-string">"https://10.0.0.1/index.html"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> xhr = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> XMLHttpRequest; <span class="hljs-comment"><span class="hljs-comment">// Expand URL to ~4kB using a query string // Alternatively, force a large cookie url += "?"; var x = 10000000; for (var i=0; i&lt;=500; i++) { url += x++; } while(true) { xhr.open("HEAD", url, false); xhr.withCredentials = true; xhr.send(); xhr.abort(); }</span></span></code> </pre><br>  During the experiment, the "capture" of encrypted packets was performed using tcpdump, and a C ++ program using libpcap was used to extract the ciphertext blocks. <br><br>  In cases of attacks on HTTPS and VPN, each request is sent in a separate encrypted entry containing plain text in a fixed position.  This allows an attacker to know which ciphertext block a ciphertext block belongs to (and, for example, assign a cookie appropriately before the blocking limit).  After saving the required amount of traffic, the C ++ program sorts the ciphertext blocks to detect collisions.  It took about four hours for the decryption of the saved traffic from the researchers. <br><br><h3>  How to protect </h3><br>  The researchers recommend not using the 64-bit ‚Äúlegacy-cipher‚Äù block encryption.  If for some reason this is not possible, then the probability of its success can be reduced as follows: <br><br>  Web servers and VPNs should be configured with a preference for 128-bit ciphers.  According to researchers, about 1.1% percent of the 100,000 most popular Alexa sites and 0.5% of the million most popular support AES, but prefer to use 3DES. <br><br>  Web browsers should use 3DES as a ‚Äúfallback-only‚Äù cipher to avoid a situation in which it is used to communicate with servers that support AES. <br><br>  TLS-libraries and applications should limit the length of TLS-sessions for 64-bit ciphers.  This can be done with the help of the re-connection mechanism. <br><br>  OpenVPN users can change the cipher used from the ‚Äúdefault‚Äù Blowfish to AES.  If this cannot be done, then it is necessary to force the re-release of keys using the reneg-bytes 64000000 function. </div><p>Source: <a href="https://habr.com/ru/post/308746/">https://habr.com/ru/post/308746/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../308732/index.html">Why shadow copies do not save most encryptors</a></li>
<li><a href="../308734/index.html">Rewriting Clojure test scripts in 24 hours</a></li>
<li><a href="../308738/index.html">Why do banks, regulators and payment systems have their own cryptocurrency</a></li>
<li><a href="../308740/index.html">Configuring MongoDB ShardedCluster with X.509 Authentication</a></li>
<li><a href="../308742/index.html">Scalable solutions for EMV and mobile NFC payments in closed networks</a></li>
<li><a href="../308748/index.html">Published program Droidcon Moscow 2016</a></li>
<li><a href="../308750/index.html">Visual monitoring of the server infrastructure based on Nagios + Grafana</a></li>
<li><a href="../308752/index.html">Computer Science for Postgres Indexes</a></li>
<li><a href="../308754/index.html">Java benchmarks: random patterns and regular results</a></li>
<li><a href="../308756/index.html">Project Life in Production: Operational Tips</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>