<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Basics of dealing with implicit code duplication</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Code with the same structure in two or more places is a sure sign of the need for refactoring. If you need to change something in one place, then, mos...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Basics of dealing with implicit code duplication</h1><div class="post__text post__text-html js-mediator-article">  Code with the same structure in two or more places is a sure sign of the need for refactoring.  If you need to change something in one place, then, most likely, you should also do <b>the same</b> in other places.  But there is a probability close to 100% not to find these places or simply forget for them. <br><br>  Most understand that repeated repetition of the code (or copy-paste) in the example below is evil: <br><a name="habracut"></a><br><pre><code class="java hljs"><span class="hljs-comment"><span class="hljs-comment">// //    -  // void DrawCircle(int x, int y, int radius) { ///       (x, y)  radius } ‚Ä¶ DrawCircle(getScreenMetrics().width / 2, getScreenMetrics().height / 2, 100500); DrawCircle(getScreenMetrics().width / 2, getScreenMetrics().height / 2, 100600);</span></span></code> </pre> <br><br>  The most obvious way out is to put the coordinates of the center of the circle in separate variables: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="java hljs">ScreenMetrics metrics = getScreenMetrics(); <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> centerX = metrics.width / <span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> centerY = metrics.height / <span class="hljs-number"><span class="hljs-number">2</span></span>; DrawCircle(centerX, centerY, <span class="hljs-number"><span class="hljs-number">100</span></span>); DrawCircle(centerX, centerY, <span class="hljs-number"><span class="hljs-number">200</span></span>);</code> </pre><br><br>  In the example above, duplication is eliminated in two seconds <s>, because the example is sucked from the finger</s> , because the expressions defining the coordinates of the center of the circles completely coincide: <br><br><pre> <code class="java hljs">getScreenMetrics().width / <span class="hljs-number"><span class="hljs-number">2</span></span>, getScreenMetrics().height / <span class="hljs-number"><span class="hljs-number">2</span></span></code> </pre><br><br>  At the same time, not all developers are able to recognize and eliminate implicit code duplication. <br><br>  Take for example a kind of mobile application that interacts with the server API and <br>  Allows an authorized user to view and upload photos: <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-function">HttpResponse </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">login</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String email, String password)</span></span></span><span class="hljs-function"> </span></span>{ HttpRequest request = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpRequest(); request.setMethod(‚ÄúGET‚Äù); request.setContentType(<span class="hljs-string"><span class="hljs-string">"application/x-www-form-urlencoded"</span></span>); String parameters = <span class="hljs-string"><span class="hljs-string">"?login="</span></span> + login + <span class="hljs-string"><span class="hljs-string">"&amp;password="</span></span> + password; String uri = <span class="hljs-string"><span class="hljs-string">"https://mycoolsite.com/api/login"</span></span> + parameters; request.setUrl(uri); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> request.execute(); } ... <span class="hljs-function"><span class="hljs-function">HttpResponse </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getPhotos</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> userId)</span></span></span><span class="hljs-function"> </span></span>{ String uri = <span class="hljs-string"><span class="hljs-string">"https://mycoolsite.com/api/get_photos?user_id="</span></span> + user_id; HttpRequest request = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpRequest(); request.setMethod(<span class="hljs-string"><span class="hljs-string">"GET"</span></span>); request.setUrl(uri); request.setContentType(<span class="hljs-string"><span class="hljs-string">"application/x-www-form-urlencoded"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> request.execute(); } ‚Ä¶ <span class="hljs-function"><span class="hljs-function">bool </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">uploadPhoto</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bitmap photo, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> user_id)</span></span></span><span class="hljs-function"> </span></span>{ HttpRequest request = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpRequest(); HttpBody body = convertBitmapToHttpBody(photo); request.setUrl(<span class="hljs-string"><span class="hljs-string">"https://mycoolsite.com/api/upload_photo?user_id="</span></span> + user_id); request.setMethod(<span class="hljs-string"><span class="hljs-string">"POST"</span></span>); request.setContentType(‚Äúmultipart/form-data‚Äù); request.setHttpBody(body); HttpResponse response = request.execute(); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> (response.getStatusCode()== <span class="hljs-number"><span class="hljs-number">200</span></span>); }</code> </pre><br><br>  ... and another 100,500 similar methods totaling the same number of API calls. <br><br>  What happens if mycoolsite.com moves to awesome.net?  We'll have to look for the entire project calls request.execute () and edit the line.  And somewhere you will surely forget to correct the URL or just be sealed.  As a result, spend a lot of time, send a ‚Äúcorrected‚Äù build to the customer closer to night, but the next day SUDDENLY get a bug report: ‚ÄúPhotos upload stopped working‚Äù, for example. <br><br>  If you do not write the code immediately "in the forehead," and <s>go to smoke,</s> stop and think a little, then you will notice that all three methods above do almost the same thing: <br><ul><li>  create an instance of the HttpRequest class </li><li>  set the necessary properties to the instance (HTTP method, content type) </li><li>  set URL with parameters </li><li>  optional: add binary data requests to the body. </li></ul><br><br>  First of all, you should put the common code into separate methods: <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> HttpRequest </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createGetRequest</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ HttpRequest request = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpRequest(); request.setMethod(<span class="hljs-string"><span class="hljs-string">"GET"</span></span>); request.setContentType(<span class="hljs-string"><span class="hljs-string">"application/x-www-form-urlencoded"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> request; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> HttpRequest </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createPostRequest</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ HttpRequest request = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HttpRequest() request.setMethod(<span class="hljs-string"><span class="hljs-string">"POST"</span></span>); request.setContentType(<span class="hljs-string"><span class="hljs-string">"multipart/form-data"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> request; }</code> </pre><br><br>  Special attention should be paid to the transfer of parameters and the formation of the request URI. <br>  The initial version of the code uses string concatenation: <br><br><pre> <code class="java hljs">String uri = <span class="hljs-string"><span class="hljs-string">"https://mycoolsite.com/api/get_photos?user_id="</span></span> + user_id;</code> </pre><br><br>  That is, for each request you need to form a URI string, and this is also a duplication of the code. <br>  and is fraught with problems when making changes.  API root address and parameter adding <br>  The URI should be kept in one place. <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String API_BASE_URL = <span class="hljs-string"><span class="hljs-string">"https://mycoolsite.com/api/"</span></span>;</code> </pre><br><br>  Before forming the request URI, we will collect all the parameters and their values ‚Äã‚Äãin the Map: <br><br><pre> <code class="java hljs">Map params = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HashMap&lt;String, String&gt;(); ... <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addParam</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Map&lt;String, String&gt; params, String param, String value)</span></span></span><span class="hljs-function"> </span></span>{ params.put(param, value); } <span class="hljs-comment"><span class="hljs-comment">//       public void addParam(Map&lt;String, String&gt; params, String param, int value) { params.put(param, String.valueOf(value)); }</span></span></code> </pre><br><br>  Now, to generate the full URI of the request, we will write the following code: <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getUri</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String path, Map&lt;String, String&gt; params)</span></span></span><span class="hljs-function"> </span></span>{ StringBuilder query = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"?"</span></span>); Iterator iterator = params.allKeys().iterator(); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (iterator.hasNext()) { String paramName = iterator.next(); query.add(paramName + <span class="hljs-string"><span class="hljs-string">"="</span></span> + params.get(paramName)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (iterator.hasNext()) { query.add(<span class="hljs-string"><span class="hljs-string">"&amp;"</span></span>); } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> API_BASE_URL + path + result.toString(); }</code> </pre><br><br>  So, to execute the request to the server, we need: <br><br><ul><li>  create request object: </li></ul><br><br><pre> <code class="java hljs">HttpRequest request = createGetRequest(); <span class="hljs-comment"><span class="hljs-comment">//  createPostRequest,    </span></span></code> </pre><br><br><ul><li>  generate request URI: </li></ul><br><br><pre> <code class="java hljs">Map params = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HashMap&lt;String, String&gt;(); ... addParam(params, <span class="hljs-string"><span class="hljs-string">"user_id"</span></span>, userId); <span class="hljs-comment"><span class="hljs-comment">// ,  userId   String uri = getUri("get_photos"); //   : https://mycoolsite.com/api/get_photos?user_id=%user_id%</span></span></code> </pre><br><br>  Now you can make a request to the server, get an answer, and then do anything you like with it: <br><br><pre> <code class="java hljs">request.setUrl(uri); HttpResponse response = request.execute();</code> </pre><br><br>  Now we put all this stuff into a separate class.  We will also inherit this class from <br>  HttpRequest, because in some cases we need to use its methods. <br><br>  We get about the following code: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MyRequest</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">HttRrequest</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String API_BASE_URL = <span class="hljs-string"><span class="hljs-string">"https://mycoolsite.com/api/"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> Map&lt;String, String&gt; mParameters; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MyRequest</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>(); mParameters = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> HashMap&lt;String, String&gt;(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> MyRequest </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createGetRequest</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ MyRequest request = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MyRequest(); request.setMethod(<span class="hljs-string"><span class="hljs-string">"GET"</span></span>); request.setContentType(<span class="hljs-string"><span class="hljs-string">"application/x-www-form-urlencoded"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> request; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">static</span></span></span><span class="hljs-function"> MyRequest </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">createPostRequest</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ MyRequest request = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MyRequest() request.setMethod(<span class="hljs-string"><span class="hljs-string">"POST"</span></span>); request.setContentType(<span class="hljs-string"><span class="hljs-string">"multipart/form-data"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> request; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addParam</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String name, String value)</span></span></span><span class="hljs-function"> </span></span>{ mParameters.put(name, value); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">addParam</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String name, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> value)</span></span></span><span class="hljs-function"> </span></span>{ addParam(name, String.valueOf(value)); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> HttpResponse </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">send</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String path)</span></span></span><span class="hljs-function"> </span></span>{ String uri = API_BASE_URL + <span class="hljs-function"><span class="hljs-function">path </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getParametersString</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span></span>; setUrl(uri); execute(); } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getParametersString</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ StringBuilder result = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> StringBuilder(<span class="hljs-string"><span class="hljs-string">"?"</span></span>); Iterator iterator = mParameters.allKeys().iterator(); <span class="hljs-keyword"><span class="hljs-keyword">while</span></span> (iterator.hasNext()) { String paramName = iterator.next(); result.add(paramName + <span class="hljs-string"><span class="hljs-string">"="</span></span> + mParameters.get(paramName)); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (iterator.hasNext()) { result.add(<span class="hljs-string"><span class="hljs-string">"&amp;"</span></span>); } } <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> result.toString(); } }</code> </pre><br><br>  Now the code of the API calls will look like this: <br><br><pre> <code class="java hljs"><span class="hljs-function"><span class="hljs-function">HttpResponse </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">login</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String login, String password)</span></span></span><span class="hljs-function"> </span></span>{ MyRequest request = MyRequest.createGetRequest(); request.addParam(<span class="hljs-string"><span class="hljs-string">"login"</span></span>, login); request.addParam(<span class="hljs-string"><span class="hljs-string">"password"</span></span>, password); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> request.send(<span class="hljs-string"><span class="hljs-string">"login"</span></span>); } <span class="hljs-function"><span class="hljs-function">HttpResponse </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getPhotos</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> userId)</span></span></span><span class="hljs-function"> </span></span>{ MyRequest request = MyRequest.createGetRequest(); request.addParam(<span class="hljs-string"><span class="hljs-string">"user_id"</span></span>, userId); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> request.send(<span class="hljs-string"><span class="hljs-string">"get_photos"</span></span>); } <span class="hljs-function"><span class="hljs-function">HttpResponse </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">uploadPhoto</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(Bitmap photo, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> userId)</span></span></span><span class="hljs-function"> </span></span>{ MyRequest request = MyRequest.createPostRequest(); request.addParam(‚Äúuser_id‚Äù, userId); request.setHttpBody(convertBitmapToHttpBody(photo)); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> request.send(‚Äúupload_photo‚Äù); }</code> </pre><br><br>  As you can see, the login, getPhotos and uploadPhoto methods have become shorter, simpler and clearer. <br><br>  This was an example of non-trivial, multi-step refactoring.  As a result, a new class MyRequest appeared, which is a wrapper over the system HttpRequest, <s>with a preference and courtesans</s> with the ability to set query parameters and a couple of other pleasant trifles.  You can also notice how the methods of specific API calls have become smaller, simpler and clearer.  Add a new challenge is almost no difficulty. <br><br>  This refactoring takes a couple of hours more time than adding another API call using copy-paste method.  But in the future, a few minutes, not days, will be spent on making changes and debugging. <br><br>  Naturally, the resulting code is far from perfect, but still it is much better than before refactoring, and this is already a big <br>  a step forward, with a little blood.  In the future, if there is time, this code can and should be improved. <br><br>  Moral: noticed duplication - eliminate it <b>immediately</b> .  Save a lot of time and nerves in the future. <br>  At the same time, eliminating the "complex" duplication, take the time to re-design a small part of the project, <br>  do not write the code immediately. <br><br>  Read more in the <a href="http://www.books.ru/books/refaktoring-uluchshenie-sushchestvuyushchego-koda-fail-pdf-552092/%3Fshow%3D1">book on Fowler refactoring</a> . <br><br>  <b>I would be glad to constructive criticism, suggestions and additions to the article.</b>  <b>Thanks for attention!</b> </div><p>Source: <a href="https://habr.com/ru/post/197932/">https://habr.com/ru/post/197932/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../197920/index.html">What is the Entity System Framework and why is it needed in game devs?</a></li>
<li><a href="../197924/index.html">October 21-22, we invite you to Tizen Hackathon in Yaroslavl</a></li>
<li><a href="../197926/index.html">Java vs go</a></li>
<li><a href="../197928/index.html">HTML Form Validator</a></li>
<li><a href="../197930/index.html">Play RSS with PlayFramework 2.2 and Scala</a></li>
<li><a href="../197934/index.html">Using the service Corp2World, sending "messages to the world" from 1C</a></li>
<li><a href="../197936/index.html">Lexand A802 review: 8-inch tablet with non-standard "iron"</a></li>
<li><a href="../197938/index.html">Emergency satellite decommissioning: scenarios</a></li>
<li><a href="../197940/index.html">Java Stored Procedure in Oracle Subd. By Example of Forming a PDF File</a></li>
<li><a href="../197942/index.html">Development of a fuzzy neural network NEFClass M</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>