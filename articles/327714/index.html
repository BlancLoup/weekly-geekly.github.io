<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Training with reinforcements on the example of the game "tic-tac-toe"</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Tic-tac-toe is a game studied far and wide, and the development of AI for it can be reduced to organizing the decision tree described in Wikipedia . T...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Training with reinforcements on the example of the game "tic-tac-toe"</h1><div class="post__text post__text-html js-mediator-article">  Tic-tac-toe is a game studied far and wide, and the development of AI for it can be reduced to organizing the decision tree described in <a href="https://ru.wikipedia.org/wiki/%25D0%259A%25D1%2580%25D0%25B5%25D1%2581%25D1%2582%25D0%25B8%25D0%25BA%25D0%25B8-%25D0%25BD%25D0%25BE%25D0%25BB%25D0%25B8%25D0%25BA%25D0%25B8">Wikipedia</a> .  This article will consider the solution of the game through training with reinforcement and approximation of the value functions. <br><a name="habracut"></a><br><h2>  Prep </h2><br>  We accept the following rules: <br><br><ul><li>  The agent goes first and plays "crosses". </li><li>  The agent will only make decisions with maximum value. </li><li>  With a 5% chance the agent will make probing decisions. </li><li>  Only if the agent wins, he gets a reward. </li></ul><br>  The next step is to prepare the value function for the agent.  In our case, the value function will be the state table of the game, in which a value from 0 to 1 will indicate that a particular state is ‚Äúbetter‚Äù than another.  Initially, we set in our table that all winning combinations (three crosses in a row, column or diagonally) give a probability equal to 1. Similarly, all the states with three zeros are 0. For all other states, the probability is 0.5. <br><br><div style="text-align:center;"><img src="https://habrastorage.org/files/864/20f/2d1/86420f2d10474e48bcf1d775dc121fbc.jpg" alt="image"></div><br>  In order to simplify the compilation of a probability table, we assume that <p><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_SVG_Display" style="text-align: center;"><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;><msup><mn>3</mn><mn>9</mn></msup><mo>=</mo><mn>19683</mn></math>" role="presentation" style="font-size: 100%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.127ex" height="2.539ex" viewBox="0 -987.6 4791 1093.4" role="img" focusable="false" style="vertical-align: -0.246ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/327714/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjcNq0zTxaKSkQOpj7ZRvFKDnhVpQ#MJMAIN-33" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/327714/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjcNq0zTxaKSkQOpj7ZRvFKDnhVpQ#MJMAIN-39" x="707" y="583"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/327714/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjcNq0zTxaKSkQOpj7ZRvFKDnhVpQ#MJMAIN-3D" x="1232" y="0"></use><g transform="translate(2288,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/327714/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjcNq0zTxaKSkQOpj7ZRvFKDnhVpQ#MJMAIN-31"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/327714/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjcNq0zTxaKSkQOpj7ZRvFKDnhVpQ#MJMAIN-39" x="500" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/327714/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjcNq0zTxaKSkQOpj7ZRvFKDnhVpQ#MJMAIN-36" x="1001" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/327714/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjcNq0zTxaKSkQOpj7ZRvFKDnhVpQ#MJMAIN-38" x="1501" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/327714/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjcNq0zTxaKSkQOpj7ZRvFKDnhVpQ#MJMAIN-33" x="2002" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mn>3</mn><mn>9</mn></msup><mo>=</mo><mn>19683</mn></math></span></span></div><script type="math/tex;mode=display" id="MathJax-Element-1"> 3 ^ 9 = 19683 </script></p>  states.  Of course, half of these combinations is impossible, but the code was not optimized for the purpose. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <div class="spoiler">  <b class="spoiler_title">Probability table initialization code</b> <div class="spoiler_text"><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">float</span></span> V[<span class="hljs-number"><span class="hljs-number">19683</span></span>]; <span class="hljs-comment"><span class="hljs-comment">//------- void setV(int a1,int a2,int a3,int b1,int b2,int b3,int c1,int c2,int c3,float v) { int num; num = ((((((((a1*3)+a2)*3+a3)*3+b1)*3+b2)*3+b3)*3+c1)*3+c2)*3+c3; V[num] = v; } //------- for (int i1=0;i1&lt;3;i1++) for (int i2=0;i2&lt;3;i2++) for (int i3=0;i3&lt;3;i3++) for (int i4=0;i4&lt;3;i4++) for (int i5=0;i5&lt;3;i5++) for (int i6=0;i6&lt;3;i6++) for (int i7=0;i7&lt;3;i7++) for (int i8=0;i8&lt;3;i8++) for (int i9=0;i9&lt;3;i9++) { setV(i1,i2,i3,i4,i5,i6,i7,i8,i9,0.5); if (i1==i2 &amp;&amp; i2==i3 &amp;&amp; i3==1) setV(i1,i2,i3,i4,i5,i6,i7,i8,i9,1); if (i4==i5 &amp;&amp; i5==i6 &amp;&amp; i6==1) setV(i1,i2,i3,i4,i5,i6,i7,i8,i9,1); if (i7==i8 &amp;&amp; i8==i9 &amp;&amp; i9==1) setV(i1,i2,i3,i4,i5,i6,i7,i8,i9,1); if (i1==i5 &amp;&amp; i5==i9 &amp;&amp; i9==1) setV(i1,i2,i3,i4,i5,i6,i7,i8,i9,1); if (i7==i5 &amp;&amp; i5==i3 &amp;&amp; i3==1) setV(i1,i2,i3,i4,i5,i6,i7,i8,i9,1); if (i1==i4 &amp;&amp; i4==i7 &amp;&amp; i7==1) setV(i1,i2,i3,i4,i5,i6,i7,i8,i9,1); if (i2==i5 &amp;&amp; i5==i8 &amp;&amp; i8==1) setV(i1,i2,i3,i4,i5,i6,i7,i8,i9,1); if (i3==i6 &amp;&amp; i6==i9 &amp;&amp; i9==1) setV(i1,i2,i3,i4,i5,i6,i7,i8,i9,1); if (i1==i2 &amp;&amp; i2==i3 &amp;&amp; i3==2) setV(i1,i2,i3,i4,i5,i6,i7,i8,i9,0); if (i4==i5 &amp;&amp; i5==i6 &amp;&amp; i6==2) setV(i1,i2,i3,i4,i5,i6,i7,i8,i9,0); if (i7==i8 &amp;&amp; i8==i9 &amp;&amp; i9==2) setV(i1,i2,i3,i4,i5,i6,i7,i8,i9,0); if (i1==i5 &amp;&amp; i5==i9 &amp;&amp; i9==2) setV(i1,i2,i3,i4,i5,i6,i7,i8,i9,0); if (i7==i5 &amp;&amp; i5==i3 &amp;&amp; i3==2) setV(i1,i2,i3,i4,i5,i6,i7,i8,i9,0); if (i1==i4 &amp;&amp; i4==i7 &amp;&amp; i7==2) setV(i1,i2,i3,i4,i5,i6,i7,i8,i9,0); if (i2==i5 &amp;&amp; i5==i8 &amp;&amp; i8==2) setV(i1,i2,i3,i4,i5,i6,i7,i8,i9,0); if (i3==i6 &amp;&amp; i6==i9 &amp;&amp; i9==2) setV(i1,i2,i3,i4,i5,i6,i7,i8,i9,0); }</span></span></code> </pre> <br></div></div><br><h2>  Course of the game </h2><br>  Opponent will be a person who accordingly will play for zeroes and periodically succumb.  During the game, there will be a change in the value of its states.  In order to properly evaluate the actions of the agent, it is necessary to record the sequence of those states that he chose and at the end of the game to recalculate them.  The formula for calculating the value of V (s) will be as follows: <br><br><math></math><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo><mo>+</mo><mi>A</mi><mo>&amp;#x2217;</mo><mo stretchy=&quot;false&quot;>[</mo><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><msup><mi>s</mi><mo>&amp;#x2032;</mo></msup><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2212;</mo><mi>V</mi><mo stretchy=&quot;false&quot;>(</mo><mi>s</mi><mo stretchy=&quot;false&quot;>)</mo><mo stretchy=&quot;false&quot;>]</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="33.443ex" height="2.66ex" viewBox="0 -832 14399.2 1145.2" role="img" focusable="false" style="vertical-align: -0.728ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/327714/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjcNq0zTxaKSkQOpj7ZRvFKDnhVpQ#MJMATHI-56" x="0" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/327714/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjcNq0zTxaKSkQOpj7ZRvFKDnhVpQ#MJMAIN-28" x="769" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/327714/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjcNq0zTxaKSkQOpj7ZRvFKDnhVpQ#MJMATHI-73" x="1159" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/327714/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjcNq0zTxaKSkQOpj7ZRvFKDnhVpQ#MJMAIN-29" x="1628" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/327714/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjcNq0zTxaKSkQOpj7ZRvFKDnhVpQ#MJMAIN-3D" x="2295" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/327714/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjcNq0zTxaKSkQOpj7ZRvFKDnhVpQ#MJMATHI-56" x="3352" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/327714/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjcNq0zTxaKSkQOpj7ZRvFKDnhVpQ#MJMAIN-28" x="4121" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/327714/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjcNq0zTxaKSkQOpj7ZRvFKDnhVpQ#MJMATHI-73" x="4511" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/327714/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjcNq0zTxaKSkQOpj7ZRvFKDnhVpQ#MJMAIN-29" x="4980" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/327714/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjcNq0zTxaKSkQOpj7ZRvFKDnhVpQ#MJMAIN-2B" x="5592" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/327714/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjcNq0zTxaKSkQOpj7ZRvFKDnhVpQ#MJMATHI-41" x="6593" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/327714/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjcNq0zTxaKSkQOpj7ZRvFKDnhVpQ#MJMAIN-2217" x="7565" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/327714/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjcNq0zTxaKSkQOpj7ZRvFKDnhVpQ#MJMAIN-5B" x="8288" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/327714/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjcNq0zTxaKSkQOpj7ZRvFKDnhVpQ#MJMATHI-56" x="8566" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/327714/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjcNq0zTxaKSkQOpj7ZRvFKDnhVpQ#MJMAIN-28" x="9336" y="0"></use><g transform="translate(9725,0)"><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/327714/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjcNq0zTxaKSkQOpj7ZRvFKDnhVpQ#MJMATHI-73" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/327714/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjcNq0zTxaKSkQOpj7ZRvFKDnhVpQ#MJMAIN-2032" x="663" y="513"></use></g><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/327714/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjcNq0zTxaKSkQOpj7ZRvFKDnhVpQ#MJMAIN-29" x="10490" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/327714/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjcNq0zTxaKSkQOpj7ZRvFKDnhVpQ#MJMAIN-2212" x="11101" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/327714/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjcNq0zTxaKSkQOpj7ZRvFKDnhVpQ#MJMATHI-56" x="12102" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/327714/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjcNq0zTxaKSkQOpj7ZRvFKDnhVpQ#MJMAIN-28" x="12872" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/327714/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjcNq0zTxaKSkQOpj7ZRvFKDnhVpQ#MJMATHI-73" x="13261" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/327714/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjcNq0zTxaKSkQOpj7ZRvFKDnhVpQ#MJMAIN-29" x="13731" y="0"></use><use xlink:href="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://habr.com/ru/post/327714/&amp;xid=17259,15700023,15700186,15700190,15700248,15700253&amp;usg=ALkJrhjcNq0zTxaKSkQOpj7ZRvFKDnhVpQ#MJMAIN-5D" x="14120" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>V</mi><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo><mo>=</mo><mi>V</mi><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo><mo>+</mo><mi>A</mi><mo>‚àó</mo><mo stretchy="false">[</mo><mi>V</mi><mo stretchy="false">(</mo><msup><mi>s</mi><mo>‚Ä≤</mo></msup><mo stretchy="false">)</mo><mo>‚àí</mo><mi>V</mi><mo stretchy="false">(</mo><mi>s</mi><mo stretchy="false">)</mo><mo stretchy="false">]</mo></math></span></span><script type="math/tex" id="MathJax-Element-2"> V (s) = V (s) + A * [V (s') - V (s)] </script>  , <br><br>  where A is the size of the step affecting the speed of learning.  V (s') - the value of the action at the end of the game (1 - if won, 0 - otherwise). <br><br>  The size of the step affects whether the opponent‚Äôs strategy changes or not.  If you need to take into account the variability of the strategy, then you need to leave the step size constant.  Otherwise, if the step is reduced to zero, the agent will stop his training. <br><br>  The use of probing moves (having no high value) allows you to check conditions that, because of the high value of other moves, would never have been fulfilled, which gives a small chance of changing the strategy to a winning side. <br><br><div class="spoiler">  <b class="spoiler_title">Agent Selection Code</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">stepAI</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">void</span></span></span></span><span class="hljs-function"><span class="hljs-params">)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> flag; c_var=<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;<span class="hljs-number"><span class="hljs-number">19683</span></span>;i++) { flag=<span class="hljs-number"><span class="hljs-number">0</span></span>; readMap(i); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> j=<span class="hljs-number"><span class="hljs-number">1</span></span>; j&lt;<span class="hljs-number"><span class="hljs-number">10</span></span>;j++) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (rm[j]!=m[j]) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ((m[j]==<span class="hljs-number"><span class="hljs-number">0</span></span>) &amp;&amp; (rm[j]==<span class="hljs-number"><span class="hljs-number">1</span></span>)) flag++; <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> flag+=<span class="hljs-number"><span class="hljs-number">2</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (flag==<span class="hljs-number"><span class="hljs-number">1</span></span>) { var[c_var]=i; c_var++; } } <span class="hljs-keyword"><span class="hljs-keyword">float</span></span> v_max; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> v_num_max; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (random(<span class="hljs-number"><span class="hljs-number">100</span></span>)&lt;<span class="hljs-number"><span class="hljs-number">5</span></span>) v_num_max=random(c_var); <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { v_max = V[var[<span class="hljs-number"><span class="hljs-number">0</span></span>]]; v_num_max = <span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (c_var&gt;<span class="hljs-number"><span class="hljs-number">1</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i=<span class="hljs-number"><span class="hljs-number">1</span></span>;i&lt;c_var;i++) <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (V[var[i]]&gt;v_max) v_num_max = i; } steps++; steps_m[steps]=var[v_num_max]; readMap(var[v_num_max]); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i=<span class="hljs-number"><span class="hljs-number">1</span></span>;i&lt;<span class="hljs-number"><span class="hljs-number">10</span></span>;i++) m[i]=rm[i]; paintMap(); }</code> </pre><br></div></div><br><br>  In the above located code, possible moves are selected (states in which elements are identical to the current state of the field, and there is one more cross).  Then, either an arbitrary move (with a probability of 5%) or a ‚Äúgreedy‚Äù move (with maximum value) is selected from the obtained states.  At the end of the selection, this move is recorded in a separate array of moves made. <br><br>  At the end of the game, there is a recalculation of the value of the moves made, as already mentioned. <br><br><div class="spoiler">  <b class="spoiler_title">Value Recalculation</b> <div class="spoiler_text"><pre> <code class="cpp hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">learnAI</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> res)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> i=<span class="hljs-number"><span class="hljs-number">0</span></span>;i&lt;steps;i++) V[steps_m[i]] += A * (res - V[steps_m[i]]); A -= <span class="hljs-number"><span class="hljs-number">0.01</span></span>; }</code> </pre> <br></div></div><br><h2>  Total </h2><br>  ‚Üí <a href="https://drive.google.com/open%3Fid%3D0B8TY2qJHQb66OHl4UmVyNlFDRXM">Program and project in C ++ Builder 6</a> <br><br>  In this example, one aspect of reinforcement learning was briefly reviewed.  If the agent usually contacts the environment, then in this example the training was carried out with the opponent player.  Although this example is quite simple, it may seem that this method in other examples will be very limited than it really is. <br><br><h2>  Used Books </h2><br>  Training with reinforcements / R.S.Sutton, E.G. Barto - Moscow: BINOM.  Laboratory of knowledge, 2014 </div><p>Source: <a href="https://habr.com/ru/post/327714/">https://habr.com/ru/post/327714/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../327702/index.html">So why all the same need Refresh tokens in OAuth?</a></li>
<li><a href="../327704/index.html">Computer vision on the example of an application for IKEA. Part 1</a></li>
<li><a href="../327706/index.html">Calculate the residence of passengers of the ship (with accuracy to the house)</a></li>
<li><a href="../327708/index.html">Release Rust 1.17</a></li>
<li><a href="../327710/index.html">GitLab 9.1 Released: Service Desk, Burndown Charts and Canary Deployments</a></li>
<li><a href="../327718/index.html">Speed ‚Äã‚Äãis everything! SSD only! Experience mClouds.ru</a></li>
<li><a href="../327720/index.html">It is not so easy to take and expand the channels of communication.</a></li>
<li><a href="../327722/index.html">Finding similar names using MySQL + PHP</a></li>
<li><a href="../327724/index.html">UC, API and AI: Where Business Communication Services Go</a></li>
<li><a href="../327728/index.html">Unix and Linux Initialization Systems after SysV</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>