<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Immersing in templates and taming Windows GPO</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In the next article from the cycle "admin summary" I would like to refresh in my memory a few nuances of using group policies. At the same time we hav...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Immersing in templates and taming Windows GPO</h1><div class="post__text post__text-html js-mediator-article"><p><img src="https://habrastorage.org/webt/hc/um/st/hcumstxyqohfl1zavw6txkg6tns.jpeg"></p><br><p>  In the next article from the cycle "admin summary" I would like to refresh in my memory a few nuances of using group policies.  At the same time we have fun with the creation of our templates and with the automation of working with these same policies. <a name="habracut"></a></p><br><h1 id="osvezhaem-pamyat">  Refreshing memory </h1><br><p>  I will not tell you what group policies are, and I‚Äôll dwell only on the main points that should be borne in mind when working with them. </p><br><p>  In addition to domain systems, there are local group policies in Windows systems - you can manage them using the <strong>gpedit.msc</strong> snap-in on Professional and higher edition systems.  It is often assumed that without a domain, you can configure local group policies only for all users on the computer.  This is not entirely true - with the release of Windows Vista, it became possible to use multiple local group policies or <strong>MLGPO</strong> .  This mechanism allows you to configure individual policies for different users. </p><br><p>  You can reach it via the mmc console call: when adding the ‚ÄúManage Group Policy Objects‚Äù snap-in, click the Browse button.  Further, on the ‚ÄúUsers‚Äù tab, you can already select a specific user or the ‚ÄúAdministrators‚Äù and ‚ÄúNon-Administrators‚Äù groups.  Unfortunately, management for a group of users is not implemented. </p><br><p><img src="https://habrastorage.org/webt/wy/gg/ii/wyggiiokcpv3qxpqy0yiwnwv1lk.jpeg"><br>  <em>Manage Group Policy for individual users.</em> </p><br><blockquote>  It also happened that on a stand-alone terminal server, Active Directory was deployed only in order for an individual user to configure the driver behavior for EasyPrint.  Do not do it this way. </blockquote><p>  When adding domain group policies, it is worth remembering the order in which they are applied - the policy applied by the latter will have the highest priority (and often asked during interviews). </p><br><p>  So, suppose that we have a computer in the domain and four group policies: local on this computer;  the policy on the unit in which the computer is located;  policy on the domain and policy on the forest.  The order of their application will be as follows: </p><br><ol><li>  Local Group Policy. </li><li>  Group Policy Site. </li><li>  Group Policy Domain. </li><li>  Group policy upper divisions. </li><li>  Group Policy Subsidiary. </li></ol><br><p>  That is, the closer to the object, the more priority, with the exception of the local group policy.  If you need to disable the application of higher-level policies, then set the inheritance lock. </p><br><p><img src="https://habrastorage.org/webt/eg/kv/wf/egkvwfroern2arrfmrirdictu2k.jpeg"><br>  <em>Blocking inheritance</em> </p><br><p>  Any group policy can be divided into two configurations - the user and the computer.  Usually, policies with computer settings are assigned to the department where the computers are located.  A policy with user settings - on users. </p><br><p>  If you need to apply the computer settings to the division with users and vice versa, use the so-called closure group policy.  For example, such a setting is useful when you need to apply specific policies to users to work on terminal servers. </p><br><p>  The operation of the circuit is configured directly in the policy - "Computer Setup - Administrative Templates - System - Processing Mode of the closure of the user group policy."  More details about the mechanism have already been written in the <a href="https://habrahabr.ru/post/122668/">article about using Merge \ Replace in a GPO</a> .  I will only add that the closure mode of group policy is also a frequent question at the interview. </p><br><p><img src="https://habrastorage.org/webt/mo/cw/lj/mocwljnlu7ma2km8jdvnubki0tk.jpeg"><br>  <em>Configuring closure group policy.</em> </p><br><p>  Physically, domain group policies are located in the <strong>SYSVOL</strong> folder on domain controllers.  The folder is replicated between controllers.  Each group policy looks like a folder with a name in the form of a GUID. </p><br><p><img src="https://habrastorage.org/webt/7u/ll/ny/7ullnylhoixdoyvt4qrracyuo3y.jpeg"><br>  <em>Group domain policies.</em> </p><br><p>  The filtering rules that are configured through the Group Policy Editor correspond to the settings of the NTFS rights to the corresponding subfolder. </p><br><blockquote>  Speaking about the filtering rules, we cannot but mention the MS16-072 update, which ‚Äúbroke‚Äù group policies.  Now, in order for the filtering rules to work, you need to add a ‚Äúread‚Äù rule to each filter, but not ‚Äúapply‚Äù to the Domain Computers group. </blockquote><p>  In each folder with Group Policy, there are subfolders <strong>Machine</strong> and <strong>User</strong> , corresponding to the settings of the user and the computer.  If you delve into the subfolders, you can easily understand the structure of group policy: </p><br><ul><li>  At the root of the folder is a <strong>GPT.ini</strong> file with Group Policy settings, such as its name. </li><li>  In the Machine and User subfolders, the <strong>registry.pol</strong> files are located with the settings of the corresponding registry branches. </li><li>  Along the Microsoft \ Windows NT \ SecEdit path, you can find the security configuration template - <strong>GptTmpl.inf</strong> . </li><li>  In the Preferences subfolder are group policy preferences, which are subfolders with xml files. </li><li>  The Applications subfolders contain distributions for deployment through group policies. </li><li>  The Scripts folder contains scripts on the logon \ logoff for the user and startup \ shutdown for the computer. </li><li>  In the Documents and Settings folder there are settings for redirecting user folders. </li><li>  Finally, the Adm folder contains outdated Group Policy templates. </li></ul><br><p>  More information about the structure can be found in the material <a href="https://blogs.technet.microsoft.com/musings_of_a_technical_tam/2012/02/13/group-policy-basics-part-1-understanding-the-structure-of-a-group-policy-object/">Group Policy Basics</a> , so let's go straight to the templates. </p><br><h1 id="administrativnye-shablony">  Administrative Templates </h1><br><p>  In essence, administrative templates are special files with instructions on how to change the client registry ( <strong>HKCU</strong> or <strong>HKLM</strong> branches <strong>)</strong> and settings for displaying the parameters to be changed through the ‚ÄúGroup Policy Management‚Äù.  In principle, the registry can be changed through the ‚ÄúGroup Policy Preferences‚Äù.  But the difference here is not only in the beautiful interface. </p><br><table><tbody><tr><td width="120">  Registry change method </td><td>  How it behaves when deleting a policy with standard settings </td><td>  Is it possible to change the parameter manually </td><td>  Is it possible to change the parameter through the application </td></tr><tr><td>  Templates </td><td>  The registry value is restored to the default value if the default settings are in the template </td><td>  - </td><td>  - </td></tr><tr><td>  Policy preferences </td><td>  Registry Parameter Does Not Change </td><td>  + </td><td>  + </td></tr></tbody></table><br><p>  <em>Comparison of group policy preferences and administrative templates.</em> </p><br><p>  In other words, registry configuration through group policy templates is more restrictive.  Whereas the setting through group policy preferences is reminiscent of the periodic use of the reg file.  Of course, preferences allow not only changing registry settings, but also quite flexible settings.  That and valuable. </p><br><blockquote>  This is relevant when changing the Policies branch, and the custom application must store its settings in the registry.  Simply changing the settings through Preferences and Templates will work in a similar way, only templates can be more convenient. </blockquote><p>  Before the advent of Windows Vista \ 2008, only the .adm standard was taken as a template for group policies.  Being with a simple structure that was easy to edit by hand, this standard also had several disadvantages: </p><br><ul><li>  For each language, you had to create a separate template file. </li><li>  The template file was physically located in the group policy folder.  When using the same template, it was saved to each folder, which increased the space and time of replication. </li><li>  Multi-string and QWORD parameters were not supported. </li></ul><br><p>  To replace the outdated standard, a new one has appeared.  New templates are two files: the template itself, not dependent on the language - .admx and the language ‚Äúpackage‚Äù to it - the .adml file.  Now the templates can be ‚Äúput‚Äù in the central repository, and access it without generating identical files in the SYSVOL folder. </p><br><p>  Not without a fly in the ointment - now the contents of the file is a popular XML format in the industry.  And creating new templates in notebook has become less convenient. </p><br><p>  Under most of the parameters that may be needed, the templates already exist.  In addition, many application manufacturers release their administrative templates.  Here are some examples: </p><br><ul><li>  <a href="https://www.microsoft.com/en-us/download/details.aspx%3Fid%3D49030">MS Office 2016</a> . </li><li>  <a href="https://addons.mozilla.org/ru/firefox/addon/gpo-support-for-firefox-and-th/">Firefox and Thunderbird</a> . </li><li>  <a href="https://support.google.com/chrome/a/answer/187202%3Fhl%3Dru">Google Chrome</a> . </li><li>  <a href="https://www.adobe.com/devnet-docs/acrobatetk/tools/AdminGuide/gpo.html">Adobe Acrobat and Reader</a> . </li><li>  <a href="https://getadmx.com/">Catalog of</a> <a href="https://getadmx.com/">templates for various software</a> . </li></ul><br><p>  If there is a need to develop and implement your administrative template, then the simplest option is to create the old .adm file and convert it to admx with a special <a href="https://www.microsoft.com/en-us/download/details.aspx%3Fid%3D15058">utility</a> .  The more difficult option is to start right away with .admx. </p><br><h1 id="sozdaem-svoy-shablon">  Create your template </h1><br><p>  To begin with, let's take a simple example.  Create a group policy template that allows us to turn on and off the display of hidden and system files, and at the same time the display of extensions. </p><br><blockquote>  I‚Äôll say at once that this can be turned through the ‚ÄúGroup Policy Preferences‚Äù ‚Äîin the control panel settings ‚Äî the folder options.  But we are not looking for easy ways and at the same time we do not want the display parameters to be changed manually. </blockquote><p>  Three keys in the registry answer for the parameters we need: </p><br><ul><li>  Software \ Microsoft \ Windows \ CurrentVersion \ Explorer \ Advanced \ Hidden. </li><li>  Software \ Microsoft \ Windows \ CurrentVersion \ Explorer \ Advanced \ HideFileExt. </li><li>  Software \ Microsoft \ Windows \ CurrentVersion \ Explorer \ Advanced \ ShowSuperHidden. </li></ul><br><div class="spoiler">  <b class="spoiler_title">The contents of the ADM-template, which we analyze below, under the spoiler.</b> <div class="spoiler_text"><pre><code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">CLASS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">USER</span></span> CATEGORY !!ShowExplorer <span class="hljs-keyword"><span class="hljs-keyword">POLICY</span></span> !!ShowHiddenFiles KEYNAME "Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" <span class="hljs-keyword"><span class="hljs-keyword">EXPLAIN</span></span> !!ShowHiddenFilesExplanation VALUENAME "Hidden" VALUEON <span class="hljs-type"><span class="hljs-type">NUMERIC</span></span> "1" VALUEOFF <span class="hljs-type"><span class="hljs-type">NUMERIC</span></span> "2" <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> <span class="hljs-keyword"><span class="hljs-keyword">POLICY</span></span> <span class="hljs-keyword"><span class="hljs-keyword">POLICY</span></span> !!ShowFileExtensions KEYNAME "Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" <span class="hljs-keyword"><span class="hljs-keyword">EXPLAIN</span></span> !!ShowFileExtensionsExplanation VALUENAME "HideFileExt" VALUEON <span class="hljs-type"><span class="hljs-type">NUMERIC</span></span> "0" VALUEOFF <span class="hljs-type"><span class="hljs-type">NUMERIC</span></span> "1" <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> <span class="hljs-keyword"><span class="hljs-keyword">POLICY</span></span> <span class="hljs-keyword"><span class="hljs-keyword">POLICY</span></span> !!ShowSuperHiddenFiles KEYNAME "Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced" <span class="hljs-keyword"><span class="hljs-keyword">EXPLAIN</span></span> !!ShowSuperHiddenFilesExplanation VALUENAME "ShowSuperHidden" VALUEON <span class="hljs-type"><span class="hljs-type">NUMERIC</span></span> "1" VALUEOFF <span class="hljs-type"><span class="hljs-type">NUMERIC</span></span> "0" <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> <span class="hljs-keyword"><span class="hljs-keyword">POLICY</span></span> <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> CATEGORY [strings] ShowExplorer="   " ShowHiddenFiles="  " ShowHiddenFilesExplanation="   ,     ." ShowSuperHiddenFiles="  " ShowSuperHiddenFilesExplanation="   ,     " ShowFileExtensions="  " ShowFileExtensionsExplanation="   ,     "</code> </pre> </div></div><br><p>  Let us examine the syntax of the file in more detail. </p><br><ul><li>  <strong>CLASS.</strong>  It may take the value USER or MACHINE - depending on the class, the registry branch of HKCU or HKLM will change accordingly. </li><li>  <strong>CATEGORY</strong> .  A string specifying the name of the policy ‚Äúfolder‚Äù. </li><li>  <strong>POLICY</strong> .  The line sets the name of a specific policy - we will have three of them. </li><li>  <strong>KEYNAME</strong> .  Registry path to changeable parameters. </li><li>  <strong>EXPLAIN</strong> .  A ‚Äúvariable‚Äù reference with an explanation of the setting. </li><li>  <strong>VALUENAME</strong> .  The name of the parameter to be changed in the registry. </li><li>  <strong>VALUEON</strong> ** VALUEOFF **.  The value that the parameter will take when it is turned on and off in the policy. </li><li>  <strong>[strings]</strong> .  The section with the values ‚Äã‚Äãof variables that I used for text strings.  You can not use them, but then there may be problems due to the Russian language. </li></ul><br><p>  In addition to the options involved, there are others, for example: </p><br><ul><li>  <strong>EDITTEXT</strong> .  Text field for input. </li><li>  <strong>NUMERIC</strong> .  The field for entering numbers. </li><li>  <strong>CHECKBOX</strong> .  List where you can tick parameters. </li><li>  <strong>COMBOBOX</strong> .  List with "switch" </li><li>  <strong>DROPDOWNLIST</strong> .  Drop-down list. </li><li>  <strong>LISTBOX</strong> .  List to enter multiple items. </li></ul><br><p>  More information about all the parameters can be found in the MSDN <a href="https://msdn.microsoft.com/en-us/library/aa372405(v%3Dvs.85).aspx">ADM Format</a> section. </p><br><p>  Installing a new template is not easy, but very simple - just right-click on the ‚ÄúAdministrative templates‚Äù item, select ‚ÄúAdd and remove templates‚Äù and add our newly created template. </p><br><p><img src="https://habrastorage.org/webt/ac/mo/qk/acmoqk2eorm9eqaynudmwjht90u.jpeg"><br>  <em>Added template.</em> </p><br><p>  After the template is installed, it will be displayed in the ‚ÄúClassic Administrative Templates‚Äù branch. </p><br><p><img src="https://habrastorage.org/webt/ws/sb/2l/wssb2l8ohpmrdkiwo2h4ok7yag8.jpeg"></p><br><p>  Now you can convert our template to .admx using the <strong>faAdmxConv</strong> utility from <a href="https://www.microsoft.com/en-us/download/details.aspx%3Fid%3D15058">ADMX Migrator</a> . </p><br><p><img src="https://habrastorage.org/webt/cr/3y/3u/cr3y3uqauco1dzgffgk9qxkqcqo.jpeg"><br>  <em>Convert the template.</em> </p><br><p>  After converting, the resulting .admx template and the Ru-ru folder with the .adml localization file need to be copied to the% Systemroot% \ PolicyDefinitions folder for local policy or to the Sysvol \ PolicyDefinitions folder on the domain controller. </p><br><p><img src="https://habrastorage.org/webt/10/aq/yg/10aqygl6gsxccj6993hpvp26rrk.jpeg"><br>  <em>Installed .admx template.</em> </p><br><div class="spoiler">  <b class="spoiler_title">Full listing of the resulting template and localization file under the spoiler.</b> <div class="spoiler_text"><p>  Template: </p><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">policyDefinitions</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">revision</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">schemaVersion</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">policyNamespaces</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">target</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">prefix</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"fullarmor"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">namespace</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"FullArmor.6fb075d6-ddee-4302-9d06-50c4d83e1910"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">using</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">prefix</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"windows"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">namespace</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Microsoft.Policies.Windows"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">policyNamespaces</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">supersededAdm</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">fileName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"E:\1\explorer.adm"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">resources</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">minRequiredRevision</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">supportedOn</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">definitions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">definition</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"SUPPORTED_NotSpecified"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">displayName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"$(string.ADMXMigrator_NoSupportedOn)"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">definitions</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">supportedOn</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">categories</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">category</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ShowExplorer"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">displayName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"$(string.ShowExplorer)"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">categories</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">policies</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">policy</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ShowHiddenFiles"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"User"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">displayName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"$(string.ShowHiddenFiles)"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">explainText</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"$(string.ShowHiddenFilesExplanation)"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">presentation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"$(presentation.ShowHiddenFiles)"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">valueName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Hidden"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">parentCategory</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ref</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ShowExplorer"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">supportedOn</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ref</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"SUPPORTED_NotSpecified"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">enabledValue</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">decimal</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">enabledValue</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">disabledValue</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">decimal</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">disabledValue</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">policy</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">policy</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ShowFileExtensions"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"User"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">displayName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"$(string.ShowFileExtensions)"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">explainText</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"$(string.ShowFileExtensionsExplanation)"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">presentation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"$(presentation.ShowFileExtensions)"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">valueName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"HideFileExt"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">parentCategory</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ref</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ShowExplorer"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">supportedOn</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ref</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"SUPPORTED_NotSpecified"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">enabledValue</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">decimal</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">enabledValue</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">disabledValue</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">decimal</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">disabledValue</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">policy</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">policy</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">name</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ShowSuperHiddenFiles"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">class</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"User"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">displayName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"$(string.ShowSuperHiddenFiles)"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">explainText</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"$(string.ShowSuperHiddenFilesExplanation)"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">presentation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"$(presentation.ShowSuperHiddenFiles)"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">key</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"Software\Microsoft\Windows\CurrentVersion\Explorer\Advanced"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">valueName</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ShowSuperHidden"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">parentCategory</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ref</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ShowExplorer"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">supportedOn</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">ref</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"SUPPORTED_NotSpecified"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">enabledValue</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">decimal</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">enabledValue</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">disabledValue</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">decimal</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">value</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"0"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">disabledValue</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">policy</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">policies</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">policyDefinitions</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> <br><p>  Localization file: </p><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">policyDefinitionResources</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">revision</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">schemaVersion</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"1.0"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">displayName</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">displayName</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span><span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">description</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">resources</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">stringTable</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ShowExplorer"</span></span></span><span class="hljs-tag">&gt;</span></span>   <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ShowHiddenFiles"</span></span></span><span class="hljs-tag">&gt;</span></span>  <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ShowHiddenFilesExplanation"</span></span></span><span class="hljs-tag">&gt;</span></span>   ,     .<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ShowSuperHiddenFiles"</span></span></span><span class="hljs-tag">&gt;</span></span>  <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ShowSuperHiddenFilesExplanation"</span></span></span><span class="hljs-tag">&gt;</span></span>   ,     <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ShowFileExtensions"</span></span></span><span class="hljs-tag">&gt;</span></span>  <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ShowFileExtensionsExplanation"</span></span></span><span class="hljs-tag">&gt;</span></span>   ,     <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ADMXMigrator_UnresolvedString"</span></span></span><span class="hljs-tag">&gt;</span></span>ADMX Migrator encountered a string that is not present in the source ADM string table.<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ADMXMigrator_NoSupportedOn"</span></span></span><span class="hljs-tag">&gt;</span></span>ADMX Migrator encountered a policy that does not have a supportedOn value.<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">string</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">stringTable</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">presentationTable</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">presentation</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ShowHiddenFiles"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">presentation</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ShowFileExtensions"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">presentation</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">id</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"ShowSuperHiddenFiles"</span></span></span><span class="hljs-tag"> /&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">presentationTable</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">resources</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">policyDefinitionResources</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre> </div></div><br><p>  Indeed, the xml in the new format is read a little worse than the old .adm.  To facilitate the work with the new format in the ADMX Migrator package there is the utility <strong>faAdmxEditor.msc</strong> .  In addition to this utility, there are <a href="https://gallery.technet.microsoft.com/scriptcenter/8c703a2e-4685-4093-a1fc-dec107c53d13">scripts</a> for converting reg-files into templates, and third-party paid utilities. </p><br><p>  Of course, you can do without this and that and figure it out yourself - I will leave it as a homework.  Fortunately, MSDN has a detailed description of the <a href="https://msdn.microsoft.com/en-us/library/cc232739.aspx">XML schema</a> , and there are some good materials with examples on the web.  For example, <a href="http://www.oszone.net/14741/admin_templates">Administrative Group Policy Templates</a> . </p><br><p>  We now turn to automation. </p><br><h1 id="avtomaticheskoe-upravlenie">  Automatic control </h1><br><p>  Working with group policies from the command line is pretty dreary.  There are three main tools. </p><br><p>  <strong>PowerShell</strong> .  There are a set of <a href="https://technet.microsoft.com/ru-ru/library/hh967461(v%3Dwps.630).aspx">cmdlets</a> for backing up, restoring, and managing group policies.  Creating new policies is limited - you can only change the registry.  However, in most cases this is enough.  As an example, create a group policy that disables the automatic update of Adobe Reader DC. </p><br><p>  The <strong>bUpdater</strong> registry <strong>key</strong> in the [HKEY_LOCAL_MACHINE \ SOFTWARE \ Policies \ Adobe \ Acrobat Reader \ DC \ FeatureLockDown] branch is responsible for disabling automatic updating.  By setting the parameter to 0, we will disable the option. </p><br><p>  Creating a group policy on PowerShell will look like this: </p><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">Import</span></span>-module -<span class="hljs-type"><span class="hljs-type">Name</span></span> GroupPolicy <span class="hljs-keyword"><span class="hljs-keyword">Write</span></span>-Host "      Adobe_Reader_disable_autoupdate" <span class="hljs-built_in"><span class="hljs-built_in">New</span></span>-GPO -<span class="hljs-type"><span class="hljs-type">Name</span></span> Adobe_Reader_disable_autoupdate <span class="hljs-keyword"><span class="hljs-keyword">Write</span></span>-Host "    " <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span>-GPRegistryValue -<span class="hljs-type"><span class="hljs-type">Name</span></span> "Adobe_Reader_disable_autoupdate" -key "HKLM\SOFTWARE\Policies\Adobe\Acrobat Reader\DC\FeatureLockDown" -ValueName bUpdater -TypeDWord -<span class="hljs-keyword"><span class="hljs-keyword">value</span></span> <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Write</span></span>-Host "     OU" <span class="hljs-keyword"><span class="hljs-keyword">Set</span></span>-GPLink -<span class="hljs-type"><span class="hljs-type">Name</span></span> Adobe_Reader_disable_autoupdate -Target "ou=Computers,dc=domain,dc=com" -LinkEnabled Yes</code> </pre> <br><p><img src="https://habrastorage.org/webt/nn/sw/7c/nnsw7cgeldvq-mt-tdp8ugxcfsi.jpeg"></p><br><p>  <em>Newly created group policy.</em> </p><br><p>  A complete list and description of cmdlets are available in Technet <a href="https://technet.microsoft.com/ru-ru/library/hh967461(v%3Dwps.630).aspx">Group Policy Cmdlets in Windows PowerShell</a> . </p><br><p>  <strong>COM interface to GPMC</strong> (Group Policy Management Console).  The method allows you to do a lot with policies in any programming language that supports COM interfaces.  Unfortunately, he has not gained popularity and there are few examples on the net, despite the rich <a href="https://msdn.microsoft.com/en-us/library/aa814147(v%3Dvs.85).aspx">description of interface methods</a> on the MSDN portal.  A few examples of use are available for <a href="https://gallery.technet.microsoft.com/group-policy-management-17a5f840">download</a> in the Technet Gallery. </p><br><p>  <strong>LGPO.exe.</strong>  Not so long ago, Microsoft replaced the set of utilities for working with local group policies with a single utility.  You can download it on the official <a href="https://www.microsoft.com/en-us/download/details.aspx%3Fid%3D55319">website</a> .  The utility is convenient for copying and deploying local group policies.  MLGPO support has been announced.  You can also create your own policies.  The program is also convenient for creating and modifying registry.pol registry files.  For example, we‚Äôll change the local group policy by adding the disabling update of the unfortunate Acrobat Reader DC to it. </p><br><p>  Make a backup of the local group policy with the command </p><br><pre> <code class="bash hljs">lgpo.exe /b C:\Temp /n <span class="hljs-string"><span class="hljs-string">"Backup"</span></span></code> </pre> <br><p>  In the folder C: \ Temp, a sub-folder will appear with the GUID structure similar to domain group policies: </p><br><p>  Now we will deploy registry.pol to a text file: </p><br><pre> <code class="bash hljs">LGPO.exe /parse /m C:\temp\{GUID}\DomainSysvol\GPO\Machine\registry.pol &gt;&gt; reg.txt</code> </pre> <br><p>  The syntax of the text file is obvious.  Add the registry values ‚Äã‚Äãto it to disable the automatic update of "Acrobat": </p><br><p><img src="https://habrastorage.org/webt/yb/sk/jv/ybskjvynfgmovylsj7ihmnlh8ge.png"><br>  <em>Added registry key to file.</em> </p><br><p>  Now it remains to wrap our reg.txt back to registry.pol and import the changed file back to the local group policy: </p><br><pre> <code class="bash hljs">LGPO.exe /r C:\Temp\reg.txt /w C:\Temp\registry.pol LGPO.exe /m C:\Temp\registry.pol‚Äã</code> </pre> <br><p>  Of course, all these frauds can be wrapped in one script and used to massively change the local group policy with the usual tool for running commands on remote computers.  More information about the methods of launching commands can be found in our article <a href="https://habrahabr.ru/company/pc-administrator/blog/342428/">"1000 ++ way to run commands on a remote computer</a> . <a href="https://habrahabr.ru/company/pc-administrator/blog/342428/">"</a> </p><br><p>  Of course, knowing the structure of the domain group policy, nothing prevents you from making a convenient tool for you to create and manage policies.  <strong>Share in the comments, do you have your own ways to customize the registry of user machines?</strong> </p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/351152/">https://habr.com/ru/post/351152/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../351142/index.html">What makes an owl in ZeroNights 2017 Crackme # 3?</a></li>
<li><a href="../351144/index.html">About life, freedom and the pursuit of happiness user API</a></li>
<li><a href="../351146/index.html">Notes on meeting VR platform requirements</a></li>
<li><a href="../351148/index.html">Richard Hamming: Chapter 5. The History of Computers ‚Äî A Practical Application</a></li>
<li><a href="../351150/index.html">Web-based devices</a></li>
<li><a href="../351154/index.html">How to take the right person to the team - preparing for the interview</a></li>
<li><a href="../351156/index.html">No need to complicate! Or how can redpolitika help promote your solutions to users?</a></li>
<li><a href="../351158/index.html">Family tree inside git</a></li>
<li><a href="../351160/index.html">#PostgreSQL. We accelerate the deployment seven times with the help of "multithreads"</a></li>
<li><a href="../351162/index.html">Alexey Ragozin on Java Mission Control on jug.msk.ru</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>