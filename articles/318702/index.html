<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Turn your smartphone into an IoT sensor using Bluemix. Application Development Example</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Bluemix is ‚Äã‚Äãa powerful platform that allows you to quickly, easily create, deploy and administer applications in the cloud. Bluemix is ‚Äã‚Äãan implement...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Turn your smartphone into an IoT sensor using Bluemix. Application Development Example</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/4b5/35f/c2f/4b535fc2f6df4e4cb7e9f3e1cf60082b.png"><br><br>  Bluemix is ‚Äã‚Äãa powerful platform that allows you to quickly, easily create, deploy and administer applications in the cloud.  Bluemix is ‚Äã‚Äãan implementation of the IBM Open Cloud Architecture based on Cloud Foundry open source platform-as-a-service (PaaS). <br><br>  Using this platform and the IBM Watson IoT Paltform service, you can develop a Bluemix application that will allow you to process, visualize and store data received from a smartphone.  This article shows how an ordinary smartphone can be turned into a reliable sensor connected to a network. <br><a name="habracut"></a><br>  What is needed for application development? 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      1. Account in Bluemix (it is <a href="https://developer.ibm.com/sso/bmregistration%3Flang%3Dru_RU%26ca%3Ddwrussia-_-bluemix-_-iot-mobile-phone-iot-device-bluemix-apps-trs-_-article">possible to register</a> for free trial use).  Also, <a href="https://www.ibm.com/marketplace/cloud/developer-program/us/en-us/%3Fcm_sp%3Ddwrussia-premium-_-iot-mobile-phone-iot-device-bluemix-apps-trs-_-article">developerWorks Premium</a> members receive a one-year subscription to IBM Bluemix, plus credits of $ 240 to work with cloud technologies in Bluemix. <br>  2. You also need to download and install <a href="https://www.ng.bluemix.net/docs/starters/install_cli.html">the Cloud Foundry command line interface</a> . <br>  3. Smartphone with Android OS or iOS. <br><br><img src="https://habrastorage.org/files/f53/82d/61f/f5382d61f7ea4d6084c6e0837eb99f89.png"><br><br>  Immediately after receiving all of the above, you can start working on creating an IoT application in Bluemix.  To do this, use the Node-RED mechanism.  With it, you can, for example, create the Internet of Things service in order to send MQTT messages to the IBM IoT server in the cloud, as well as receive messages from the server. <br><br>  The algorithm of action is as follows: <br><br>  1. <a href="http://www.bluemix.net/%3Fcm_mmc%3Ddwrussia-_-bluemix-_-iot-mobile-phone-iot-device-bluemix-apps-trs-_-article">Log in to Bluemix with your account</a> (or <a href="https://developer.ibm.com/sso/bmregistration%3Flang%3Dru_RU%26amp%3Bca%3Ddwrussia-_-bluemix-_-iot-mobile-phone-iot-device-bluemix-apps-trs-_-article">register for a free trial</a> ). <br>  2. Select Catalog. <br>  3. Click on the Internet of Things Platform Starter. <br>  4. Specify the name of your application.  This name will also be used as the host name, so it must be unique in Bluemix, for example, iot &lt;your_name&gt;.  This example uses the name <code>iotdemodaniel4</code> . <br><br><img src="https://habrastorage.org/files/f53/82d/61f/f5382d61f7ea4d6084c6e0837eb99f89.png"><br><br>  5. Click the Create button. <br>  6. On the toolbar, select Dashboard and click on the created application (Cloud Foundry or CF APP). <br>  7. Click on the Add a Service or API button. <br>  8. In the left navigation area, select Internet of Things to filter the list of available services.  Select the Internet of Things Platform service. <br><br><img src="https://habrastorage.org/files/407/d75/b3b/407d75b3bb4043c1b4d913e69c7dcf1d.png"><br><br>  9. Leave all default values ‚Äã‚Äãand press the Create button. <br>  10. Now we see a message with the Restage button.  Click this button to update the application. <br><br>  Add devices that send MQTT messages to the IoT server <br><br>  1. On the Bluemix Dashboard, select the application and the new service. <br>  2. On the page of this service, click on the Launch Dashboard button. <br><br><br><img src="https://habrastorage.org/files/804/221/3a7/8042213a73dd4ddebd98cebd709e727f.png"><br><br>  After that, the IBM Internet of Things server panel, a service independent of Bluemix, immediately appears.  An application is assigned an Organization ID.  It will be needed for the development of a mobile application.  Below you can see the identifier with a value of 1xuhbp. <br><br><img src="https://habrastorage.org/files/d69/7c8/f19/d697c8f19a6645ad900e43ea43c2f448.png"><br><br>  In the left menu that appears when you hover the mouse over it, select Devices.  After that, select Add a device and click the Create device type button.  You can have several types of devices, and the devices themselves can be many.  The device type in this case is a group of devices with common characteristics.  They may have the same sensors or some other elements.  In the current case, the device type must be Android.  This type must be used for the application that we will use later. <br><br><img src="https://habrastorage.org/files/bb6/d95/84b/bb6d9584b2a9456e88027e43e35cb765.png"><br><br>  Click the Next button.  After this, a page appears where you can enter various information about the device, including the serial number or model.  In the demo example, we will not enter this data, so just click Next and then again.  After that you should return to the Add Device dialog. <br><br>  Again, click the Next button, where we specify the device ID.  This may be, for example, the MAC address of the smartphone.  It must be unique.  The example shows an address of type "112233445566". <br><br>  Leave the Meta Data field blank and click the Next button.  We also leave the Authentication token field blank and click Next again. <br><br>  Specify the value of the authentication token.  It is better to remember or write it down, because it will be needed later.  Click Next. <br><br><img src="https://habrastorage.org/files/c11/db9/a55/c11db9a5512142a8acef6feb0a6e6d10.png"><br><br>  Click, as proposed, Add, after which we see the generated device. <br><br><img src="https://habrastorage.org/files/7d4/1c1/281/7d41c128168a428b84eae273bbd0e8af.png"><br><br>  Close the dialog box.  After that, we can send MQTT messages from the device to the IBM IoT server. <br><br><h3>  Install and configure the application for Android </h3><br><br>  In order for the smartphone to read and send sensor readings, you must use the IoT Starter for Android app.  The source code can be obtained <a href="https://github.com/ibm-messaging/iot-starter-for-android">here</a> . <br><br>  1. After that, the phone needs to go to the Settings&gt; Security menu and, on behalf of the device administrator, allow the installation of applications from unknown sources.  To do this, put a mark in the Unknown sources field.  Now it is possible to install .apk files not only from Google Play. <br>  2. Open the browser in the phone and enter the following address: <br>  <a href="https://ibm.box.com/v/iotstarterapp">ibm.box.com/v/iotstarterapp</a> <br><br>  Redirecting to <a href="https://m.box.com/">m.box.com</a> and to the iot-starter_501.apk file <br><br><img src="https://hsto.org/files/774/b6b/525/774b6b525b384e37b4adebe4ab55bfbe.jpg" alt="image"><br><br>  3. Click Download; <br>  4. Using the file manager, look for the file in the Downloads directory; <br>  5. In the same directory, click on the iot-starter_501.apk file and click Install. <br><br><img src="https://habrastorage.org/files/e84/713/3fc/e847133fcac54b3388981dd0f8ba7f47.jpg"><br><br>  The IoT Starter application after all the above actions will be installed on your Android device. <br><br>  After that, you need to perform another important step - to configure the application for Android. <br><br>  1. Run the IoT Starter app. <br>  2. Specify the following parameters: <br><br>  ‚Ä¢ Organization: The organization identifier that was displayed on the IBM IoT server (it was listed at the beginning of the ‚ÄúAdding a device that will send MQTT messages to the IoT server‚Äù step).  In this guide, this identifier is set to y6spgy. <br>  ‚Ä¢ Device ID: The device ID that you specified at the end of the ‚ÄúAdd a device that will send MQTT messages to the IoT server‚Äù step.  In this manual, this parameter has the value 112233445566. <br>  ‚Ä¢ Auth Token: The authorization token that you specified during the "Adding a device that will send MQTT messages to the IoT server." <br><br><img src="https://habrastorage.org/files/124/a2b/c4d/124a2bc4dde1488a99ed81efc48fcbcf.png"><br><br>  3. Click on the Activate Sensor button, after which the application will start collecting acceleration sensor readings on the smartphone, sending the collected information to the IBM IoT server.  The application also displays information about the accelerometer and the number of received or sent messages. <br><br><img src="https://habrastorage.org/files/e1c/370/b5c/e1c370b5c65b40cb801f2eb5cec07a53.jpg"><br><br>  We check the sending of messages from the smartphone to the IoT server <br><br>  1. Open the IBM IoT server page for the organization on the computer (this data was specified in the step ‚ÄúAdding a device that will send MQTT messages to the IoT server‚Äù); <br>  2. On the Devices tab, an Android OS device is already displayed. <br><br><img src="https://habrastorage.org/files/da4/920/dd2/da4920dd2afb44c2b8d319c6418fc9e4.png"><br><br>  3. Click on the device identifier, then a window should appear with messages from the smartphone.  For information about events, click on it. <br><br><img src="https://habrastorage.org/files/7d4/1c1/281/7d41c128168a428b84eae273bbd0e8af.png"><br><br>  Messages from the smartphone are sent in JSON format.  They contain information about acceleration and position.  You can now work with message data in a Bluemix environment. <br><br><h3>  We process messages in the stream Node-RED </h3><br><br>  In this section, we improve the Bluemix IoT application using the Node_RED stream to process messages from the smartphone and send messages back to the smartphone.  The phone will respond by changing the background color of the application. <br><br>  Node-RED is a visual tool that simplifies the transmission and processing of messages on the Internet of things. <br><br>  You can run the application <a href="http://iotdemodaniel4.mybluemix.net/%3Fcm_mc_uid%3D96791531106413875542414%26cm_mc_sid_50200000%3D1478191357">here</a> . <br><br>  1. Open Bluemix, select the Dashboard and on the Bluemix Dashboard and see if the Bluemix IoT application is running (created in step 1). <br>  2. Open &lt;&lt;your application_name&gt; .mybluemix.net in your browser, where is the name of the Bluemix IoT application created in step 1. In the Node-RED editor for the Bluemix application, click the Go to your Node-RED flow editor button. <br><br><img src="https://habrastorage.org/files/57d/3cf/dc5/57d3cfdc56114f638040e7d62e6babdd.png"><br><br>  3. The editor opens with an example stream. <br><br><img src="https://habrastorage.org/files/125/914/208/1259142080d246559eb198c16a8f7ae0.png"><br><br>  Using the drag-and-drop method in the editor, we begin to construct the message flow.  You can create such a stream yourself by importing the code below.  Before this, it is necessary to remove all existing nodes by deleting them using the Delete key. <br><br>  4. Copy <a href="https://ibm.box.com/v/iotstarterNodeRedCode">this code</a> and paste it into a text editor. <br>  5. In a text editor, see if all the code is in one line.  If not, delete all line breaks.  Copy the string to the clipboard. <br>  6. In the Node-RED editor, press Ctrl-I to open the Import Nodes dialog box.  Insert the code and click OK. <br><br><img src="https://habrastorage.org/files/9e6/b24/f15/9e6b24f1516e47a0b551e05e75722937.png"><br><br>  7. Now you need to adapt the stream to your specific parameters.  The only meaningful parameter is the Device ID.  Double click on the IBM IoT App out node.  In the pop-up window, enter the device ID that was used previously (for example, 112233445566), and click OK. <br>  8. In the editor, click Deploy.  The stream should immediately become active. <br>  9. Move the smartphone, turning and tilting it.  At this time, the background should change its color in response to a change in the orientation of the Z axis. <br>  10. In the Node-RED editor, click on the rectangle next to the msg.payload node.  After that, click on the debug tab to debug.  Here we should see the messages sent from the phone in JSON format. <br><br><img src="https://habrastorage.org/files/b44/5bf/365/b445bf3652fb424d95b6debe3dda6123.png"><br><br>  11. Explore the stream by double clicking on the calc color node.  This allows you to calculate color values ‚Äã‚Äãbased on incoming position values ‚Äã‚Äãrelative to the Z axis, sending the calculation results as JSON data. <br><br><img src="https://habrastorage.org/files/1cc/07d/d82/1cc07dd82406478baf1e73fa7a729c60.png"><br><br><h3>  Create a Bluemix application to visualize sensor readings. </h3><br><br>  This is the final stage, during which we will create in Bluemix an additional application that receives a message from an IoT smartphone.  The data will be visualized. <br><br>  1. Download the <a href="">iot-visualization-0.2.0.zip</a> file from the <a href="https://github.com/ibm-messaging/iot-visualization/">iot-visualization</a> project in Github.  Unpack this archive. <br>  2. Open Bluemix and select the Dashboard. <br>  3. Click the Create App button. <br>  4. Select WEB as an application type. <br>  5. Choose the SDK for Node.js. <br>  6. Click the Continue button and specify the name of the application.  As before, the name must be unique in Bluemix, because it is used as the host name.  Enter something like iotvisualizer &lt;your_name&gt; and click Finish. <br>  7. After a few seconds, the message Your app is running should come. <br>  8. In the directory where the iot-visualization-0.1.0.zip archive is unpacked, look for the manifest.yml file and open it in a text editor.  Change the host and name parameters to the selected application name.  Save the file. <br><br><img src="https://habrastorage.org/files/ea2/4f3/51c/ea24f351cebe410a976903618a60ce10.jpg"><br><br>  9. Open a command prompt window and go to the directory where iot-visualization-0.1.0.zip archive is unpacked. <br>  10. Run the following Cloud Foundry commands: <br>  cf api <a href="https://api.ng.bluemix.net/">api.ng.bluemix.net</a> <br>  cf login -u &lt;your_bluemix_login_id&gt; <br>  The cf login command is only required when you first use the cloud foundry command line tool.  You may also need to enter your password in Bluemix.  If you have more than one Bluemix organization (as opposed to the default settings), you will need to select one of them. <br><br>  11. Deploy the application to Bluemix by running the following command: <br><br>  cf push &lt;your_application_name&gt; <br><br>  This command takes parameters from the manifest.yml file and then loads the code into Bluemix.  After a while you should see something like this: <br><br>  Ok <br><br>  App was started using this command 'node app.js'. <br><br>  12. On the Bluemix Dashboard, open the Overview page for your application.  Click on the Bind a service or API button. <br><br><img src="https://habrastorage.org/files/4a0/1f4/595/4a01f4595f5c4e9c9d8d3da97087b041.jpg"><br><br>  13. Select the Internet of Things service, which was defined at the stage ‚ÄúCreating an IoT application in Bluemix‚Äù.  Click Restage to update the application.  The application can now receive messages from the IBM IoT server. <br>  14. To check the visualization application, open the page http: //.mybluemix.net in the browser <br>  15. In the Device drop-down menu, select the device identifier. <br><br><img src="https://habrastorage.org/files/b0c/e1f/f0d/b0ce1ff0d411420985eb78cfd4a31468.jpg"><br><br>  As you can see, creating an application that turns an ordinary smartphone into an IoT device is not so difficult if using Bluemix.  In this environment, you can create much more complex and functional applications than what was shown above. </div><p>Source: <a href="https://habr.com/ru/post/318702/">https://habr.com/ru/post/318702/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../318688/index.html">December digest of grocery design: Book Atomic Design, Adobe XD for Windows and UX-trends of 2017</a></li>
<li><a href="../318692/index.html">2FA in Oracle ApEx</a></li>
<li><a href="../318694/index.html">VPN in 60 seconds</a></li>
<li><a href="../318698/index.html">PHPMailer and SwiftMailer execution of arbitrary code vulnerabilities</a></li>
<li><a href="../318700/index.html">Snake. The development of the genre</a></li>
<li><a href="../318704/index.html">Laravel Dusk is close</a></li>
<li><a href="../318706/index.html">Everything you wanted to know about financial bots</a></li>
<li><a href="../318710/index.html">Virtual office for real work</a></li>
<li><a href="../318712/index.html">Gigabyte history</a></li>
<li><a href="../318714/index.html">Legal risks of investing in startups of companies in the USA and Israel</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>