<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Latest SAP Security News</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Over the past month, several significant events have occurred in the field of SAP security, which I would like to talk about. 

 First, two major secu...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Latest SAP Security News</h1><div class="post__text post__text-html js-mediator-article">  Over the past month, several significant events have occurred in the field of SAP security, which I would like to talk about. <br><br>  First, two major security conferences were held, where the SAP security topic was touched on: BlackHat and Defcon.  We (experts from <a href="http://dsecrg.ru/">the</a> Digital Security research <a href="http://dsecrg.ru/">laboratory</a> ) participated in both events: with a report on SAP at BlackHat and with a report on VMware at Defcon.  I mention here a report on VMware, as this presentation confirms that the protection of SAP systems is not only the security of the SAP applications themselves, but also the rest of the infrastructure. <br><br><a name="habracut"></a><h4>  1. Vulnerabilities in VMware on Defcon </h4><br>  This study was conducted during the penetration testing of the SAP landscape.  While our team focused, of course, on SAP applications, Alexander Minozhenko drew attention to the fact that SAP systems were installed on the VMware ESXi platform.  That is, even if all the SAP applications in this system were protected, the attacker could still take control of all the systems, gaining access to the ESXi - vSphere management console.  Therefore, he was puzzled by the search for a way of unauthorized access to all virtual machines - and found such a method through a number of security holes, including zero-day vulnerabilities. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Details can be found in the <a href="http://erpscan.com/wp-content/uploads/2012/08/VMWARE_DEFCON.pdf">presentation</a> (in English). <br><br><h4>  2. BlackHat Presentation on XXE Tunneling in SAP </h4><br>  On BlackHat, we talked about SSRF (Server Side Request Forgery class attacks, fake server response) attacks and gave a large number of examples of these attacks.  As for SAP, we have demonstrated an example of a targeted attack with the sequential use of a number of vulnerabilities: <br><br><ul><li>  Unauthorized access to the service Dilbertmsg </li><li>  XXE Tunneling (tunneling TCP packets through XML) </li><li>  Storing variables in XML in RWX memory </li><li>  SAP Kernel buffer overflow </li></ul><br>  A large amount of information is available on this attack on the Web, from our reports to articles in the press and even a video interview: <br><br><ul><li>  <a href="http://erpscan.com/wp-content/uploads/2012/08/SSRF-vs-business-critical-applications.-XXE-Tunelling-in-SAP.pdf">Presentation</a> </li><li>  <a href="http://erpscan.com/wp-content/uploads/2012/08/SSRF-vs-Businness-critical-applications-whitepaper.pdf">Report</a> </li><li>  <a href="http://www.infosecisland.com/videos-view/22045-BlackHat-2012-Alexander-Polyakov-on-New-SAP-Vulnerabilities.html">Video on InfosecIsland</a> </li><li>  <a href="http://www.darkreading.com/security/news/240004610/hiding-sap-attacks-in-plain-sight.html">Article on DarkReading</a> </li></ul><br>  We also wrote a XXE scanner that helps exploit XXE vulnerabilities.  Soon we will release and publish its beta version. <br><br><h4>  3. Presentation by Martin Gallo on Defcon, dedicated to the SAP DIAG protocol reversing </h4><br>  Martin Gallo from CoreSecurity talked about decompression and fuzzing of the DIAG protocol.  Many of his discoveries were published earlier, but now he has <a href="http://www.hakim.ws/DEFCONXX/Speaker%2520Presentations/Gallo/DEFCON-20-Gallo-Uncovering-SAP-Vulnerabilities.pdf">published</a> details of buffer overflow vulnerabilities in the DIAG protocol.  Using these vulnerabilities, an anonymous attacker could conduct a DoS attack.  One of the demonstrated vulnerabilities could also lead to code execution.  True, the trace in the system must be set to level 3, and this is not very popular in industrial systems. <br><br><h4>  4. Remote command injection in SAP </h4><br>  As readers already know, in the middle of each month, SAP publishes a list of commendations to security researchers who find vulnerabilities in SAP products.  Researchers have the right to publish the details of the discovered vulnerabilities on their websites three months later, so that companies that care about their security can install patches. <br><br>  What can happen to those who do not install patches on time is clear from this note. <br><br>  Colleagues from Context IS have <a href="http://www.contextis.com/research/blog/sap4/">posted</a> details of the command deployment vulnerability in the SAP HostControl service.  They say that "this vulnerability allows 100% reliable execution of arbitrary code on behalf of an SAP administrator without authentication." <br><br>  The fact is that using a SOAP request with the GetDatabaseStatus SAP HostControl command, performed anonymously in the case of default settings (however, if you work on the system settings, you can disable this function, like many others), you can implement the command that the application will execute command line dbmsrv.exe, which, in turn, will cause dbmcli.exe with parameters obtained from a SOAP request.  Thus, you can execute any command in the OS. <br><br>  The most interesting thing is that (as we told in the <a href="http://erpscan.ru/wp-content/uploads/2012/06/%25D0%2591%25D0%25B5%25D0%25B7%25D0%25BE%25D0%25BF%25D0%25B0%25D1%2581%25D0%25BD%25D0%25BE%25D1%2581%25D1%2582%25D1%258C-SAP-%25D0%25B2-%25D1%2586%25D0%25B8%25D1%2584%25D1%2580%25D0%25B0%25D1%2585-%25D1%2580%25D0%25B5%25D0%25B7%25D1%2583%25D0%25BB%25D1%258C%25D1%2582%25D0%25B0%25D1%2582%25D1%258B-%25D0%25B3%25D0%25BB%25D0%25BE%25D0%25B1%25D0%25B0%25D0%25BB%25D1%258C%25D0%25BD%25D0%25BE%25D0%25B3%25D0%25BE-%25D0%25B8%25D1%2581%25D1%2581%25D0%25BB%25D0%25B5%25D0%25B4%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D1%258F-2007-2011.pdf">SAP Security in Figures</a> report), many companies leave open access to this service from the Internet.  Speaking of numbers, 10% of companies using SAP around the world allow remote access to SAP HostControl.  What will happen to these companies if cyber fraudsters use this security hole, I think, it‚Äôs easy to imagine. <br><br>  As for protection, this problem can be corrected using SAP Note 1341333. However, in order to protect SAP HostControl from other similar attacks and from problems related to information disclosure, I recommend also setting service / protectedwebmethods = SDEFA parameter.  It will protect this service from some methods that need to be protected from remote calls.  Read more <a href="http://www.saptechies.com/extended-security-settings-sapstartsrv/">here</a> . <br><br>  After that, it is advisable to check the possibility of remote calls using an automatic tool. <br><br><h4>  5. Remote code execution in SAP Crystal Reports and SAP BusinessObjects from ZDI </h4><br>  ZDI published the details of two vulnerabilities in <a href="http://www.zerodayinitiative.com/advisories/ZDI-12-139">SAP Crystal Reports</a> and <a href="http://www.zerodayinitiative.com/advisories/ZDI-12-138/">SAP BusinessObjects</a> .  The source says: ‚ÄúThis bug allows an attacker to remotely execute arbitrary code in vulnerable SAP Crystal Reports systems.  Authentication for operation is not required. "  The vulnerability is already <a href="https://service.sap.com/sap/support/notes/1662272">closed by</a> SAP, and it is somewhat more difficult to exploit than a typical buffer overflow, since this service listens to a random port, so an attacker must first determine if the service is in the system. <br><br>  Regarding the second vulnerability in SAP Business Objects FI-CO, its operation requires the participation of a legitimate user.  CVSSv2 - 7.5 critical, patch can be downloaded <a href="https://service.sap.com/sap/support/notes/1685003">here</a> . <br><br><h4>  6. August Security Updates </h4><br>  New security updates from SAP have been released with 8 <a href="http://scn.sap.com/docs/DOC-8218">thanks from</a> outside researchers, but I‚Äôll tell about them later. </div><p>Source: <a href="https://habr.com/ru/post/150164/">https://habr.com/ru/post/150164/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../150157/index.html">The court of South Korea has banned the sale of Apple devices and Samsung</a></li>
<li><a href="../150158/index.html">The ATP ‚ÄúPrav.ru‚Äù application for iOS - development challenges and ways to solve them</a></li>
<li><a href="../150159/index.html">Announced by Xiaomi MI2</a></li>
<li><a href="../150161/index.html">Synology Announces DiskStation DS213 +</a></li>
<li><a href="../150163/index.html">Creating phpBB forums in the cloud in minutes</a></li>
<li><a href="../150165/index.html">Applications for Windows Phone 7, without which you can not do</a></li>
<li><a href="../150166/index.html">Google Teachers Academy in Moscow</a></li>
<li><a href="../150167/index.html">S01.22. 3.5 billion years shelf life</a></li>
<li><a href="../150168/index.html">Unity Unite: Nobody will embrace the immense!</a></li>
<li><a href="../150169/index.html">Our way through the thorns to the stars. The history of past greatness and dreams of the future ...</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>