<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Vacation Where? When? R</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="While outside the window is the temperature on the way to the next record, it is interesting to see which temperatures have occurred at any time inter...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Vacation Where? When? R</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/files/738/db5/b99/738db5b9970a4ac5bd810e68eda8a313.png" alt="image" align="left">  While outside the window is the temperature on the way to the next record, it is interesting to see which temperatures have occurred at any time interval, for any years over the past few decades, at 30,000 points around the world.  But it may not be miscalculated with the days of vacation, and take them on those days when there is some kind of "statistical advantage" in the chosen location due to warm weather, or maybe cold, by evaluating it visually on any of the three types of diagrams.  Well, or you can just rotate the globe, visually assess the variety of temperatures and "how beautiful this world is." <br><a name="habracut"></a><br><br><h4>  <b>Data collection</b> </h4><br>  Data sources were data from weather stations located around the world, the results of which are also provided to the <i>National Oceanic and Atmospheric Administration (NOAA</i> ), <a href="http://www.noaa.gov/">on the site of</a> which there is an archive of readings of these stations from 1901 on all ( more than 30 000) stations existing during this time, currently there are about 14 000 actual stations. Access to data is provided via <i>ftp</i> , there are quite a lot of different data (there are average daily and more frequent data, data in each file and  They are measured by temperature, humidity, precipitation, wind, etc.); I will use only the data on average daily temperature. <br>  The data for each year for each station is an archived text file with delimiters.  The total number of files on this resource, about 700,000, it was possible to download them all, the approximate download time would be about two days and would require about 200 GB of disk space, but I do not see the need for this, since the download time for one unit of data ( one station in one year) is less than 0.2 seconds, so for the vast majority of requests (5-10 stations, in 5-10 years) the waiting time is no more than a minute, therefore online access.  Each station has a synoptic index (unique code), name, and coordinates.  Unfortunately, the names of the stations are not always informative, but in most cases it is the nearest settlement, in other cases - the airport located nearby.  Many stations were closed or vice versa opened recently, so for some years there may be gaps.  After selecting the time interval of interest, sampling is performed on this range, charting and displaying averaged data on the globe and on the map. <br><br><h4>  <b>Display on the globe and on the map</b> </h4><br>  The <i>threejs</i> package is used to display data on a rotating globe.  For rendering it is possible to use a graphic format - <i>jpeg</i> file (in geographic projection on the <i>WGS84</i> ellipsoid) or by generating the object.  In this case, a ready <i>jpeg</i> file is used - the land cover of the <i>Blue Marble Next Generation</i> dataset <a href="http://www.nasa.gov/">from</a> <i>NASA's</i> <a href="http://www.nasa.gov/">site</a> dated August 2004 (8 km resolution per pixel).  As a result, since one parameter can be displayed on the globe, the average (median) temperature is displayed on it (both by year and by interval of days).  On the globe, for a specific point, a bar of a certain color, height and thickness is displayed, in my case all these parameters are used to display the averaged temperature over all years over the entire time interval of interest relative to all selected stations, scaling is used in the case of bar sizes and transition in color from blue to red for temperatures (that is, for stations with averaged temperatures (-10 ¬∞, -5 ¬∞, + 7 ¬∞, + 10 ¬∞, + 30 ¬∞) the blue bar with the minimum height and thickness will be for the weather station from -10 ¬∞, the red bar with   Maximum Feed-height thickness for a weather station to be + 30 ¬∞, and the size and color of the remaining stations in proportion calculated with respect to these extreme values). <br>  In addition to these bars, curves from one point (Moscow) are also indicated, they show the trajectories to the selected stations, the thickness and color of these curves are also scaled relative to temperature.  The display of these curves clearly shows both the distance and the average temperature.  Also, in addition to the data on the globe (which can be rotated and increased), this information (average temperature, distance, and colors used) are given in the adjacent table (Fig. 1).  Also, in addition to the globe, the same averaged data is shown on a flat <i>Google</i> map ( <i>Map</i> tab). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  <b>Charts, static and interactive</b> </h4><br>  The graphical web interface is traditionally the <s>annoying</s> user-friendly <i>shiny-dashboard</i> interface, in which, as seen in the screenshots, parameters are selected in the sidebar, and the main one uses the tabbed panel. <br><img src="https://habrastorage.org/files/72a/b94/b7e/72ab94b7e8274ffeb5bfc05a94f4e8af.png" alt="image"><br>  Fig.  1. Main window <br><br>  In addition to the data on the first tab (on the globe) (which are averaged and do not carry additional information), it is more interesting to look at the variation and temperature dynamics both over the years and relative to each other, the following charts are used for this (tabs), all panel diagrams : <br>  - <i>Time series (Fig. 2)</i> - regular time series, where on each panel (meteorological station) archive years are colored, and the black bold curve is averaged over these years (the figure shows an interactive diagram, the hovering shows a legend by historical temperatures (sorted ) for each day) <br><img src="https://habrastorage.org/files/eb5/e3f/234/eb5e3f234e564287869e11f2f83b7718.png" alt="image"><br>  Fig.2.  Time series chart <br><br>  - <i>Boxsplot, scale diagram (Fig. 3)</i> - in this case, every day is considered as atomic and this diagram shows the spread of values ‚Äã‚Äãon a specific date for all selected years <br><img src="https://habrastorage.org/files/778/673/c55/778673c553024ed6a8b64d7a5ec03e43.png" alt="image"><br>  Fig.3.  Span diagram (boxsplat, box with mustache) <br><br>  - <i>Densities (Fig. 4)</i> - a diagram of temperature densities for selected stations, where the years are already shown on the panels, it clearly shows both the ratios of temperatures by stations and the dynamics of time (by years) <br><img src="https://habrastorage.org/files/8d0/faa/b18/8d0faab18c5c4691805931b46b6c3f4e.png" alt="image"><br>  Fig.4.  Density chart <br><br>  In addition to the static <i>ggplot2</i> charts, by <i>checking the</i> checkbox <i>‚Äúinteractive charts‚Äù the</i> charts are converted to interactive charts that show the legend by hovering, the charts themselves can be enlarged, reduced, moved axes.  To do this, transfer existing <i>ggplot2</i> objects into a direct interactive mapping, using the <i>plotly</i> package. <br><br><h4>  <b>Preservation</b> </h4><br>  To save all the results, it is possible to unload all the charts and tables in the <i>html</i> format and / or <i>docx</i> ( <i>Report</i> tab).  To do this, select the desired format and save the file.  Here integration with <i>markdown is used</i> , for this purpose <i>Rmarkdown</i> file layout is <i>used</i> , which contains both plain text and R function call. <br><br><h4>  <b>Conclusion</b> </h4><br>  As a result, because of my desire to get a ‚Äústatistical advantage‚Äù in choosing the optimal vacation days, it turned out a tool where you can look at the historical temperatures of any interval of days almost anywhere in the world, and evaluate whether there is some globally local warming .  Traditionally, thanks to R, all this was implemented fairly quickly and simply. </div><p>Source: <a href="https://habr.com/ru/post/273563/">https://habr.com/ru/post/273563/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../273553/index.html">Comparison of css-frameworks / libraries on a live example. Part 1</a></li>
<li><a href="../273555/index.html">Forgotten word: environment</a></li>
<li><a href="../273557/index.html">The digest of interesting materials from the world of web development and IT for the last week No. 190 (December 13 - 20, 2015)</a></li>
<li><a href="../273559/index.html">The future of p2p payments: when the smartphone replaces cash</a></li>
<li><a href="../273561/index.html">Welcome to the Russian-language site for developers on Rust</a></li>
<li><a href="../273567/index.html">Push notifications in Firefox 44 and up</a></li>
<li><a href="../273569/index.html">Unit Tests in ABAP. Part two. Rake</a></li>
<li><a href="../273571/index.html">Time Division Multiplexing (TDM) in the management of a critical project resource</a></li>
<li><a href="../273573/index.html">Use the comet server to implement a simple chat.</a></li>
<li><a href="../273575/index.html">Temperature control in the data center: why it is sometimes possible and hotter</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>