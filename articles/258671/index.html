<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How I use the traits</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Recently, several people asked me to talk about the use of traits in a new project that I am writing. At about the same time, Rafael Doms showed me hi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How I use the traits</h1><div class="post__text post__text-html js-mediator-article">  Recently, several people asked me to talk about the use of traits in a new project that I am writing.  At about the same time, Rafael Doms showed me his new speech about complex cognitive processes that we do not notice.  Since our brain is a big bag that mixes everything, the result is a post that tries to cover how I use the traits, and how I decide where they are needed. <br><br><h4>  Impact vs Abstraction </h4><br>  The first thing you have to do is go read the <a href="http://thinkrelevance.com/blog/2013/04/04/abstraction-or-leverage">‚ÄúAbstraction or Leverage‚Äù</a> post <a href="http://thinkrelevance.com/blog/2013/04/04/abstraction-or-leverage">from Michael Nigard</a> .  This is a great article. <br><br>  If you have little time, the main point of the post is that parts of the code <i>(functions, classes, methods, etc.)</i> can be intended either for abstraction or for impact.  Difference in: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  <b>The abstraction</b> contains a high-level conceptual code that allows you to work with it more succinctly with another code. </li><li>  <b>Impact</b> contains code, changes in which affect only a certain part. </li></ul><a name="habracut"></a><br>  A common abstraction is the <a href="http://habrahabr.ru/post/248505/">repository</a> pattern: you do not know how the object is stored or where you do not care.  Details lie <i>outside</i> the Repository concept. <br><br>  The overall impact will be something like the base controller class in your framework.  It does not hide the implementation, just adds some cool features that facilitate the work. <br><br>  The aforementioned post says that both abstractions and impacts are good.  But abstraction is a little better, because it always gives you the opportunity to influence, and the impact does not give you abstraction.  However, I would like to add that good abstraction is more labor-intensive to create and not at all levels possible.  So this is a compromise. <br><br><h4>  How is this related to traits? </h4><br>  Some features of a language are better than others in creating either an impact or an abstraction.  Interfaces, for example, are great at helping us build and apply abstractions. <br><br>  Inheritance, on the other hand, is great at providing exposure.  It allows us to redefine parts of the parent code without having to copy or extract each method, use class code (but not necessarily abstract) several times.  So, answering the initial question, when can I use traits? <br><br>  I use traits when I want to create an impact, not an abstraction. <br><br>  Sometimes. <br><br><h4>  Sometimes? </h4><br>  Benjamin Eberle made a good argument that the <a href="http://www.whitewashing.de/2013/04/12/traits_are_static_access.html">traits have basically the same problems as static access</a> .  You cannot replace or redefine them; they are frankly difficult to test. <br><br>  But still static methods are useful.  If you have one stateless function and you do not want to replace it with another implementation, then there is nothing wrong with making it static.  Named constructors (you rarely want an empty object) or getting an array / result of mathematical operations with well-defined input / output, stateless, deterministic: all this is interesting for you.  The static state, not the methods, is the real evil. <br><br>  Traits have about the same limitations, plus they can only be used inside a class.  They are more global than object. <br><br>  This gives treits an additional feature: they can work (read and write) with the internal state of the class in which they are mixed.  In some cases this makes them more suitable than static methods. <br><br>  For example, I often use the generation of domain events in essence: <br><br><pre><code class="php hljs"><span class="hljs-keyword"><span class="hljs-keyword">trait</span></span> GeneratesDomainEvents { <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> $events = []; <span class="hljs-keyword"><span class="hljs-keyword">protected</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">raise</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(DomainEvent $event)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;events[] = $event; } <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">releaseEvents</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ $pendingEvents = <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;events; <span class="hljs-keyword"><span class="hljs-keyword">$this</span></span>-&gt;events = []; <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> $pendingEvents; } }</code> </pre> <br>  We can <a href="https://gist.github.com/rosstuck/09804eed5fb9020a1ff0">refactor and turn this code into an abstraction</a> , but it will still be a good example of how traits can work with the local state of an object, in contrast to static methods.  We do not want to work with an array of events blindly or move it from the object.  Perhaps we don‚Äôt want to add another abstraction inside the model, and we, of course, don‚Äôt want to copy-paste this sample code everywhere.  And here again treits will help us. <br><br>  Other practical examples are custom logging of functions, a dump of several properties at once, or general iterative / search logic.  We could solve all these tasks by the parent class, but let's talk about this a bit later. <br><br>  So, traits are a good substitute in such cases, but this does not mean that static methods are useless.  In fact, I still prefer to use static methods in cases where you do not need to change the internal state of the object, because it is always safer.  Static methods are also much more convenient in testing, do not require a mock class. <br><br>  Creating statements is a good example of those cases where I prefer static methods, despite the fact that they can usually be put into traits.  I find that <code>Assertion::positiveNumber($int)</code> gives me the above benefits and it's easier for me to understand what the called class does. <br><br>  If you have similar methods of statements, there is always a temptation to turn them into treits, but such code is already beginning to ‚Äúsmack‚Äù.  Perhaps the method requires several parameters and you are tired of transmitting them.  Perhaps checking <code>$this-&gt;foo</code> requires the value of <code>$this-&gt;bar</code> .  In any of these cases, class refactoring will be the best alternative.  Remember, it is always better if the impact gives way to abstraction. <br><br>  So I declare: I use traits when I want an impact that requires access to the internal state of the object. <br><br><h4>  Parent classes </h4><br>  All that we have listed can also be implemented through inheritance.  In <code>EventGeneratingEntity</code> perhaps this approach would be even better, since the <a href="http://3v4l.org/M80Zl">array of events will indeed be individual</a> .  However, traits allow multiple inheritance instead of a single base class.  In addition to the feature set, are there any good arguments for this approach? <br><br>  Other things being equal, I would be guided by a rule like "Is-A vs. Has-A".  Of course, this is not an exact rule, because <i>traits are not a composition</i> , but a reasonable guideline. <br><br>  In other words, parent classes should be used for functions that are inherent in an object.  Parent classes convey to other developers well the meaning of the code: ‚ÄúAn employee is a person.‚Äù  If we need an impact, this does not mean that the code should not be communicative. <br><br>  For other non-core object functionality <i>(logging, events, etc.),</i> traits are a suitable tool.  They do not define the nature of the class, it is ancillary functions, or better yet, an implementation detail.  Everything that you get from a trait should be in the service of the main goal of the object, the traits should not be an important part of the functionality. <br><br>  So, in the case of generating events, I still prefer the treit, because the creation of events is an auxiliary functionality. <br><br><h4>  Interfaces </h4><br>  I rarely (if at all) extend the class or create a treyte without creating an interface. <br><br>  If you follow this rule, you will find that the traits well complement the principles of interface separation.  It is easy to define an interface for additional functionality and to make a simple implementation in the default byte. <br><br>  This allows the target class to implement its own version of the interface or use the default treit for unimportant cases.  If your choice is templates and forcing a poor abstraction, traits can be a powerful ally. <br><br>  And yet, if you have only one class implementing the interface in the code and you do not plan to change this, then implement the functionality directly in it, do not worry about the traits.  This will make your code more readable and supported. <br><br><h4>  When I do not use traits </h4><br>  Honestly, I don‚Äôt use treits quite often, maybe once in a few months I create a treit with constant work on projects.  All this heuristics, which I have outlined (impact requiring access to the internal state), is extremely niche.  If you use them too often, you may need to take a step back and review your programming style.  There is a good chance that thousands of classes are just waiting to be realized. <br><br>  There are several places where I don‚Äôt like to use traits due to style preferences: <br><br><ul><li>  If the code you are working with is just a couple of getters and setters, I would not bother.  The IDE can be a good trump card here, and adding a trait will only leave behind a decrease in readability. </li><li>  Do not use traits for dependency injection.  Not so much because of the characteristics of the traits, but rather because of the characteristics of the dependency setters, I am opposed to this. </li><li>  I don't like the use of traits in large public APIs or large pieces of functionality.  Skip the step and go directly to the abstraction. </li></ul><br>  And finally, it should be remembered that treitures do not imply abstraction and they are not a composition, but still have the right to take a place among your instruments.  They are useful for providing default impact with smaller implementation or duplication of code.  Always be ready to reorganize them for better abstraction, as soon as you feel the signs of the code ‚Äúwith the smell.‚Äù </div><p>Source: <a href="https://habr.com/ru/post/258671/">https://habr.com/ru/post/258671/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../258659/index.html">Notifications can help you know your audience better + news + cool</a></li>
<li><a href="../258661/index.html">Introducing OsmocomBB: 0x02 Hardware</a></li>
<li><a href="../258663/index.html">PENTESTIT ethical hacking and penetration testing courses</a></li>
<li><a href="../258665/index.html">The digest of interesting materials from the world of web development and IT for the last week? 161 (May 18 - 24, 2015)</a></li>
<li><a href="../258667/index.html">Metaprogramming: what it is and how it should be</a></li>
<li><a href="../258673/index.html">Choosing ciphersuites for TLS and Logjam vulnerability. Yandex experience</a></li>
<li><a href="../258675/index.html">Moscow hackathon for machine learning - June 6-7, at the Microsoft office on Krylatskoe</a></li>
<li><a href="../258677/index.html">How to build a smart home</a></li>
<li><a href="../258679/index.html">Restaurant Automation: 24 interesting tools</a></li>
<li><a href="../258681/index.html">Earn in cyber war</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>