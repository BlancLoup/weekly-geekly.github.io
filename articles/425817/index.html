<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Drag & Drop in your iOS apps</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The Drag & Drop mechanism, working in iOS 11 and iOS 12 , is a way to graphically asynchronously copy or move data both within one application and bet...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Drag & Drop in your iOS apps</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/gb/xu/dt/gbxudtvrfs8biaj5tlzkpjjjwe4.png"><br><br>  The <code>Drag &amp; Drop</code> mechanism, working in <code>iOS 11</code> and <code>iOS 12</code> , is a way to graphically asynchronously copy or move data both within one application and between different applications.  Although this technology is about 30 years old, it has literally become a ‚Äúbreakthrough‚Äù technology on <code>iOS</code> due to the fact that when dragging and dropping something in <code>iOS</code> , <code>multitouch</code> allows you to freely interact with the rest of the system and collect data for resetting from different applications. <br><a name="habracut"></a><br>  <code>iOS</code> makes it possible to capture multiple items at once.  Moreover, they do not have to be easily accessible for selection: you can take the first object, then go to another application and grab something else - all the objects will be collected in a ‚Äústack‚Äù under your finger.  Then call the universal dock on the screen, open any application there and capture the third object, then go to the screen with applications running and, without releasing the objects, drop them into one of the open programs.  Such freedom of action is possible on the <code>iPad</code> , on the <code>iPhone</code> , the range of <code>Drag &amp; Drop</code> in <code>iOS</code> limited to the scope of one application. <br><br>  Most popular applications ( <code>Safary</code> , <code>Chrome</code> , <code>IbisPaint X</code> , <code>Mail</code> , <code>Photos</code> , <code>Files</code> , etc.) already have <code>Drag &amp; Drop</code> .  In addition, <code>Apple</code> provided developers with a very simple and intuitive <code>API</code> for embedding the <code>Drag &amp; Drop</code> mechanism in your application.  The <code>Drag &amp; Drop</code> mechanism, like the gestures, works on <b><font color="#0000FF">UIView</font></b> and uses the concept of ‚Äúinteractions‚Äù <b><font color="#0000FF">Interactions</font></b> , which are a bit like gestures, so you can think of the <code>Drag &amp; Drop</code> mechanism as just a really powerful gesture. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      It, as well as gestures, is very easy to integrate into your application.  Especially if your application uses the <b><font color="#0000FF">UITableView</font></b> table or the <b><font color="#0000FF">UICollectionView</font></b> collection, since for them <code>API Drag &amp; Drop</code> improved and raised to a higher level of abstraction in the sense that the <code>Collection View</code> itself helps you with the <b><font color="#0000FF">indexPath</font></b> of the collection item that you want to drag. <code>Drag</code> .  It knows where your finger is and interprets it as the <b><font color="#0000FF">indexPath</font></b> of a collection item that you are dragging <code>Drag</code> at the moment or as the <b><font color="#0000FF">indexPath</font></b> of a collection item where you <code>Drop</code> something <code>Drop</code> .  So the <code>Collection View</code> collection provides you with <b><font color="#0000FF">indexPath</font></b> , but otherwise it‚Äôs absolutely the same <code>API Drag &amp; Drop</code> as for a regular <b><font color="#0000FF">UIView</font></b> . <br><br>  The <code>Drag &amp; Drop</code> process on <code>iOS</code> has 4 different phases: <br><br><h2>  Lift </h2><br>  <b>Lift</b> is when the user performs a <b><font color="#FF00FF">long press</font></b> gesture, indicating an element that will be ‚Äúdragged and dropped.‚Äù  At this moment, a very lightweight so-called ‚Äúpreview‚Äù ( <code>lift preview</code> ) of the specified element is formed, and then the user begins to drag ( <code>Dragging</code> ) his fingers. <br><br><img src="https://habrastorage.org/webt/t6/sw/tw/t6swtwdee7kasyvqq_od3ipzlxy.png" width="600" height="450"><br><br><h2>  Drag (dragging) </h2><br>  <b>Drag</b> (dragging) - this is when the user moves the object along the surface of the screen.  During this phase, a ‚Äúpreview‚Äù ( <code>lift preview</code> ) for this object can be modified (a green plus sign "+" or another sign appears) ... <br><br><img src="https://habrastorage.org/webt/07/yo/4x/07yo4x4yua4zelwculog6eng9aw.png" width="600" height="450"><br><br>  ... some interaction with the system is also allowed: you can click on some other object and add it to the current ‚Äúdrag and drop‚Äù session: <br><br><img src="https://habrastorage.org/webt/yb/bx/wi/ybbxwiqe6-226ipfjmkzmpymkva.png" width="600" height="450"><br><br><h2>  Drop </h2><br>  <b>Drop</b> occurs when the user lifts a finger.  At this point, two things can happen: either the <code>Drag</code> object will be destroyed, or the <code>Drop</code> object will be reset at the destination. <br><br><img src="https://habrastorage.org/webt/iv/b1/4z/ivb14zogie89jntnkfsxmuubvd0.png" width="600" height="450"><br><br><h2>  Data Transfer </h2><br>  If the Drag drag and drop process was not canceled and <b>Drop</b> was ‚Äúreset‚Äù, then <b>Data Transfer</b> (data transfer) occurs, at which the ‚Äúreset point‚Äù requests data from the ‚Äúsource‚Äù, and asynchronous data transfer occurs. <br><br>  In this tutorial, using the Picture Gallery demo application borrowed <a href="https://bestkora.com/IosDeveloper/zadanie-5-stanford-cs-193p-fall-2017-galereya-izobrazhenij-image-gallery-reshenie-obyazatelnyh-punktov/">from homework from the Stanford CS193P course</a> , we will show how easy it is to embed the <code>Drag &amp; Drop</code> mechanism into your <code>iOS</code> app. <br>  We will endow the <code>Collection View</code> collection with the ability to fill ourselves with images OUTSIDE, as well as reorganize the elements INSIDE yourself using the <code>Drag &amp; Drop</code> mechanism.  In addition, this mechanism will be used to reset unnecessary elements of the <code>Collection View</code> into a ‚Äútrash can‚Äù, which is a common <b><font color="#0000FF">UIView</font></b> and is represented by a button on the navigation bar.  We can also share images from other applications, such as <code>Notes</code> or <code>Notability</code> or <code>Mail</code> or the Photo Library ( <code>Photo</code> ), using the <code>Drag &amp; Drop</code> mechanism. <br><br>  But before focusing on the implementation of the <code>Drag &amp; Drop</code> mechanism in the demo application ‚ÄúGallery of Images‚Äù, I will briefly go through its main components. <br><br><h1>  Features of the ‚ÄúImage Gallery‚Äù demo application </h1><br>  The user interface ( <code>UI</code> ) of the Image Gallery application is very simple.  This is the ‚Äúscreen capture‚Äù <code>Image Gallery Collection View Controller</code> inserted into the <code>Navigation Controller</code> : <br><br><img src="https://habrastorage.org/webt/rz/gl/o6/rzglo69owhktzl8vcstcosf5rdi.png"><br><br>  The central part of the application is of course the <code>Image Gallery Collection View Controller</code> , which is supported by the <b><font color="#0000FF">ImageGalleryCollectionViewController</font></b> class with the Image Gallery Model as a variable <b><font color="#0000FF">var imageGallery = ImageGallery ()</font></b> : <br><br><img src="https://habrastorage.org/webt/na/f2/1r/naf21rpv6pxjnht1bk02mowhgoi.png"><br><br>  The model is represented by a <b><font color="#0000FF">struct ImageGallery</font></b> containing an array of images <b><font color="#0000FF">images</font></b> , in which each image is described by a <b><font color="#0000FF">struct ImageModel</font></b> structure that contains the <code>URL</code> <b><font color="#0000FF">url of</font></b> the image location (we are not going to store the image itself) and its aspect ratio <b><font color="#0000FF">aspectRatio</font></b> : <br><br><img src="https://habrastorage.org/webt/bp/0b/6_/bp0b6_kh3bgocgc4zlnjrocmk2q.png"><br><br>  Our <b><font color="#0000FF">ImageGalleryCollectionViewController</font></b> implements the <b><font color="#0000FF">DataSource</font></b> protocol: <br><br><img src="https://habrastorage.org/webt/ka/vr/gj/kavrgjqaraoqv4sva-aqhffwvhu.png"><br><br>  The user cell of the cell collection contains the image <b><font color="#0000FF">imageView: UIImageView!</font></b>  and <b><font color="#0000FF">spinner</font></b> activity indicator <b><font color="#0000FF">: UIActivityIndicatorView!</font></b>  and is supported by the custom <code>subclass</code> <b><font color="#0000FF">ImageCollectionViewCell of the UICollectionViewCell</font></b> class: <br><br><img src="https://habrastorage.org/webt/cu/hs/1l/cuhs1ljdvbara4u2_ndq3y_sfxw.png"><br><br>  <code>Public API</code> of the <b><font color="#0000FF">ImageCollectionViewCell</font></b> class is the <b><font color="#0000FF">imageURL</font></b> image <b><font color="#0000FF">URL</font></b> .  As soon as we install it, our <code>UI</code> updated, that is, the data for the image on this <b><font color="#0000FF">imageURL</font></b> is selected asynchronously and displayed in a cell.  While data is being sampled from the network, the <b><font color="#0000FF">spinner</font></b> activity indicator is working, indicating that we are in the process of retrieving data. <br><br>  I use the global global queue <b><font color="#0000FF">(qos: .userInitiated)</font></b> with the <b><font color="#0000FF">qos</font></b> argument ‚Äúquality of service‚Äù, which is set to <b><font color="#0000FF">.uInIniatediated</font></b> , because I select data at the user's request: <br><br><img src="https://habrastorage.org/webt/0q/aq/2-/0qaq2-uakbn1zou8ilh7pcvysxy.png"><br><br>  Every time you use your own variables inside the closure, in our case it is <b><font color="#0000FF">imageView</font></b> and <b><font color="#0000FF">imageURL</font></b> , the compiler forces you to set <b><font color="#0000FF">self.</font></b>  so you ask yourself: ‚ÄúIsn‚Äôt there a‚Äú cyclic memory reference ‚Äù( <code>memory cycle</code> )?‚Äù We don‚Äôt have an explicit ‚Äúcycling memory reference‚Äù ( <code>memory cycle</code> ), because <b><font color="#0000FF">self</font></b> itself does not have a pointer to this closure. <br><br>  However, in the case of multithreading, you must take into account that the <b><font color="#0000FF">cells</font></b> in the <code>Collection View</code> collection are reusable thanks to the <b><font color="#0000FF">dequeueReusableCell</font></b> method.  Each time a cell (new or reused) hits the screen, the image is launched asynchronously from the network (the <b><font color="#0000FF">spinner of the spinner</font></b> activity indicator is spinning at this time). <br><br>  Once the download is complete and the image is received, the <code>UI</code> this collection cell is updated.  But we don‚Äôt wait for the image to load, we continue to scroll through the collection and the collection cell that we‚Äôve noticed goes off the screen without updating our <code>UI</code> .  However, a new image should appear from below, and the same cell that has left the screen will be reused, but for another image, which may load quickly and update the <code>UI</code> .  At this time, the image download previously launched in this cell will return and the screen will be updated, which will lead to an incorrect result.  This is because we are running different things working on the network in different threads.  They return at different times. <br><br>  How can we fix the situation? <br>  Within the framework of the <b><font color="#0000FF">GCD</font></b> mechanism we use, we cannot cancel the loading of the image of the cell leaving the screen, but we can, when our <b><font color="#0000FF">imageData</font></b> data come from the network, check the <code>URL</code> <b><font color="#0000FF">url</font></b> that caused the download of this data and compare it with what the user wants to have in this cell at the moment, that is, <b><font color="#0000FF">imageURL</font></b> .  If they do not match, then we will not update the <code>UI</code> cell and wait for the image data we need: <br><br><img src="https://habrastorage.org/webt/01/xl/-v/01xl-vqsde3rlqyus1f7tksacja.png"><br><br>  This seemingly absurd line of code <b><font color="#0000FF">url == self.imageURL</font></b> makes everything work properly in a multi-threaded environment that requires non-standard imagination.  The fact is that some things in multithreaded programming occur in a different order than the written code. <br><br>  If the image data could not be sampled, an image is generated with an error message in the form of an ‚ÄúError‚Äù string and an Emodji with a ‚Äúfrowning face‚Äù.  Just the empty space in our <code>Collection View</code> can confuse the user a bit: <br><br><img src="https://habrastorage.org/webt/7m/zh/dt/7mzhdt1eo0tedkkrolp6osiidhu.png"><br><br>  We would not like the image with the error message to repeat the <b><font color="#0000FF">aspectRatio of</font></b> this erroneous image, because in this case the text along with the emoji will stretch or shrink.  We would like it to be neutral - square, that is, it would have an aspect ratio of <b><font color="#0000FF">aspectRatio</font></b> close to 1.0. <br><br><img src="https://habrastorage.org/webt/7b/rj/ve/7brjvesx81juxpsgnkevsnvge_u.png"><br><br>  We must report this request to our <code>Controller</code> so that it corrects the aspect ratio of its <b><font color="#0000FF">aspectRatio</font></b> for the corresponding <b><font color="#0000FF">indexPath</font></b> in its <b><font color="#0000FF">ImageGallery</font></b> <b><font color="#0000FF">model</font></b> .  This is an interesting task, there are many ways to solve it, and we will choose the easiest of them - using <b><font color="#0000FF">Optional</font></b> closure <b><font color="#0000FF">var changeAspectRatio: (() -&gt; Void)?</font></b>  .  It can be <b><font color="#0000FF">nil</font></b> and need not be installed if there is no need for it: <br><br><img src="https://habrastorage.org/webt/8v/5q/wy/8v5qwyzl2_-dju1qfotj7i9nem4.png"><br><br>  When I call the closure <b><font color="#0000FF">changeAspectRatio? ()</font></b> In the case of an erroneous sample of data, I use the <b><font color="#0000FF">Optional</font></b> chain.  Now anyone who is interested in some kind of setting when receiving an erroneous image can set this closure to something specific.  And that is what we do in our <code>Controller</code> in the <b><font color="#0000FF">cellForItemAt</font></b> method: <br><br><img src="https://habrastorage.org/webt/uv/ee/mi/uveemimakh506que35eaasanjbi.png"><br><br>  Details can be found <a href="https://bestkora.com/IosDeveloper/zadanie-5-stanford-cs-193p-fall-2017-galereya-izobrazhenij-image-gallery-reshenie-obyazatelnyh-punktov/">here</a> . <br><br>  To display images with the correct <b><font color="#0000FF">aspectRatio,</font></b> use the <b><font color="#0000FF">sizeForItemAt</font></b> delegate's <b><font color="#0000FF">UICollectionViewDelegateFlowLayout method</font></b> : <br><br><img src="https://habrastorage.org/webt/ys/v7/nz/ysv7nzh7rus7hnowtqyocbevwai.png"><br><br>  In addition to the <code>Collection View</code> image <code>Collection View</code> , on our <code>UI</code> we placed the <code>Bar Button</code> with a custom <b><font color="#0000FF">GarbageView</font></b> image, containing the ‚Äútrash can‚Äù as a <b><font color="#0000FF">subview</font></b> on the navigation bar: <br><br><img src="https://habrastorage.org/webt/1h/eo/uu/1heouudwoicj6qyjrckscada9ug.png"><br><br>  In this picture, the background colors for the <b><font color="#0000FF">GarbageView</font></b> itself and the <b><font color="#0000FF">UIButton</font></b> buttons with the image of a "trash can" (actually there is a transparent background) are specially changed so that you can see that the user who "dumps" the Gallery images into the "trash can", Much more room to maneuver when ‚Äúdropping‚Äù <b>Drop</b> than just a ‚Äútrash can‚Äù icon. <br>  The <b><font color="#0000FF">GarbageView</font></b> class <b><font color="#0000FF">has</font></b> two initializers and both use the <b><font color="#0000FF">setup ()</font></b> method: <br><br><img src="https://habrastorage.org/webt/xj/_t/es/xj_tesvqnjlk9yxbxnrvrvc_6w8.png"><br><br>  In the <b><font color="#0000FF">setup ()</font></b> method, I also add the <b><font color="#0000FF">myButton</font></b> button as a <b>subview</b> with the image of a "trash can" taken from the standard <code>Bar Button</code> <code>Trash</code> button: <br><br><img src="https://habrastorage.org/webt/if/s5/3c/ifs53cvfeaggqwtrlshju1g5qwc.png"><br><br>  I set the transparent background for the <b><font color="#0000FF">GarbageView</font></b> : <br><br><img src="https://habrastorage.org/webt/g_/9y/af/g_9yafe1tu_pz4vx6_wan3tarv0.png"><br><br>  The size of the garbage bin and its location will be determined in the <b><font color="#0000FF">layoutSubviews ()</font></b> method of the <b><font color="#0000FF">UIView</font></b> class, depending on the <b><font color="#0000FF">bounds of</font></b> this <b><font color="#0000FF">UIView</font></b> : <br><br><img src="https://habrastorage.org/webt/zf/ll/jb/zflljbnvhfenkfx0o2ge8iy2q2k.png"><br><br>  This is the initial version of the ‚ÄúImage Gallery‚Äù demo, and is located on <b><code><a href="https://github.com/BestKora/Article-Drag-Drop">Github</a></code></b> in the <u><code>ImageGallery_beginning</code></u> folder.  If you launch this version of the Image Gallery application, you will see the result of the application‚Äôs work on the test data, which we will subsequently delete and fill in the Image Gallery only OTHER: <br><br><img src="https://habrastorage.org/webt/w9/jn/y4/w9jny4yxwtmeemq8cqkqhbirvoy.png"><br><br>  The plan for implementing the <code>Drag &amp; Drop</code> mechanism in our application is as follows: <br><br><ol><li>  First, we will give our collection of Images of the <code>Collection View</code> ability to drag <code>Drag</code> <b><font color="#0000FF">UIImage</font></b> from outside both locally and from it, </li><li>  then we will teach our collection of <code>Collection View</code> images to take drag-drawn <code>Drag</code> from outside or locally <b><font color="#0000FF">UIImage</font></b> images, </li><li>  we will also teach our <b><font color="#0000FF">GarbageView</font></b> with the ‚Äútrash can‚Äù button to take ‚ÄúUpper‚Äù images from the local <code>Collection View</code> and remove them from the <code>Collection View</code> collection. </li></ol><br><br>  If you go through to the end of this tutorial and make all the necessary code changes, you will receive the final version of the ‚ÄúImage Gallery‚Äù demo application, which has <code>Drag &amp; Drop</code> mechanism implemented.  It is located on <b><code><a href="https://github.com/BestKora/Article-Drag-Drop">Github</a></code></b> in the <u><code>ImageGallery_finished</code></u> folder. <br><br>  The efficiency of the <code>Drag &amp; Drop</code> mechanism in your <code>Collection View</code> ensured by two new delegates. <br>  The <u>first delegate's</u> methods <u>, <b><font color="#0000FF">dragDelegate</font></b> , are</u> configured to initialize and customize the drag-and-drop <code>Drags</code> . <br>  The methods of the &lt;u second delegate, <b><font color="#0000FF">dropDelegate</font></b> , complete the Drag-and-Drop drags and, basically, provide data transfer ( <code>Data transfer</code> ) and custom animation settings for <code>Drop</code> , as well as other similar things. <br><br>  It is important to note that both of these protocols are completely independent.  You can use one or another protocol if you need only <code>Drag</code> dragging or <code>Drop</code> , but you can use both protocols at the same time and drag <code>Drag</code> and drop <code>Drop</code> , which opens up additional functionality. <code>Drag &amp; Drop</code> mechanism for changing the order of elements in your <code>Collection View</code> . <br><br><h1>  Dragging <code>Drag</code> Elements From <code>Collection View</code> </h1><br>  Implementing the <code>Drag</code> protocol is very simple, and the first thing you should always do is install yourself, <b><font color="#0000FF">self</font></b> , as a delegate to <b><font color="#0000FF">dragDelegate</font></b> : <br><br><img src="https://habrastorage.org/webt/mt/jw/dq/mtjwdqjahnvyzwjd0hz9cra47mg.png"><br><br>  And, of course, at the very top of the <b><font color="#0000FF">ImageGalleryCollectionViewController</font></b> class <b><font color="#0000FF">,</font></b> you should say that ‚ÄúYes‚Äù, we implement the <b><font color="#0000FF">UICollectionViewDragDelegate</font></b> protocol: <br><br><img src="https://habrastorage.org/webt/ie/ue/xv/ieuexvbtxfan-uouzv4cvxpjw20.png"><br><br>  As soon as we do this, the compiler starts to ‚Äúcomplain‚Äù, we click on the red circle and we are asked: ‚ÄúDo you want to add the mandatory methods of the <b><font color="#0000FF">UICollectionViewDragDelegate</font></b> protocol?‚Äù <br>  I answer: ‚ÄúOf course I want!‚Äù And click on the <code>Fix</code> button: <br><br><img src="https://habrastorage.org/webt/6d/24/it/6d24itltj_buh2uwe3fbgkh8my8.png"><br><br>  The only mandatory method of the <b><font color="#0000FF">UICollectionViewDragDelegate</font></b> protocol is the <b><font color="#0000FF">itemsForBeginning</font></b> method, which tells <code>Drag</code> system WHAT we are dragging.  The <b><font color="#0000FF">itemsForBeginning</font></b> method <b><font color="#0000FF">is</font></b> called when the user starts dragging a cell of the cell collection. <br><br>  Notice that the <code>Collection View</code> added an <b><font color="#0000FF">indexPath</font></b> to this method.  This will tell us which element of the collection, which <b><font color="#0000FF">indexPath</font></b> , we are going to ‚Äúdrag‚Äù.  This is really very convenient for us, since it is up to the application to take responsibility for using the <b><font color="#0000FF">session</font></b> and <b><font color="#0000FF">indexPath</font></b> arguments to <b><font color="#0000FF">figure</font></b> out how to handle this Drag dragging. <br><br>  If the <b><font color="#0000FF">[UIDragItems]</font></b> array of the <b><font color="#0000FF">‚Äúovertightened</font></b> ‚Äù elements is returned, <code>Drag</code> dragging is initialized; if the empty array <b><font color="#0000FF">[] is</font></b> returned, the <code>Drag</code> dragging is ignored. <br><br>  I will create a small <b><font color="#0000FF">private</font></b> function <b><font color="#0000FF">dragItems (at: indexPath)</font></b> with an argument <b><font color="#0000FF">indexPath</font></b> .  It returns the array we need <b><font color="#0000FF">[UIDragItem]</font></b> . <br><br><img src="https://habrastorage.org/webt/_y/iv/86/_yiv869sqaamn_ytg22fg89iez0.png"><br><br>  What does a drag-and-drop <b><font color="#0000FF">UIDragItem look like</font></b> ? <br>  It has only one very IMPORTANT thing called <b><font color="#0000FF">itemProvider</font></b> .  <b><font color="#0000FF">itemProvider</font></b> is just something that can provide data that will be dragged. <br><br>  And you have the right to ask: ‚ÄúWhat about the‚Äú dragging ‚Äùof an <b><font color="#0000FF">UIDragItem</font></b> item that simply has no data?‚Äù The item that you want to drag may not have data, for example, because creating this data is a costly operation.  This may be an <b><font color="#0000FF">image</font></b> or something that requires downloading data from the Internet.  Remarkably, the <code>Drag &amp; Drop</code> operation is completely asynchronous.  When you start Drag dragging, it‚Äôs really a very lightweight object ( <code>lift preview</code> ), you drag it everywhere, and nothing happens during that dragging.  But as soon as you ‚Äúdrop‚Äù <code>Drop</code> your object somewhere, then being an <b><font color="#0000FF">ItemProvider</font></b> , you really should supply your ‚Äúdragged‚Äù and ‚Äúthrown‚Äù object with real data, even if it takes a certain amount of time. <br><br>  Fortunately, there are many built-in <b><font color="#0000FF">itemProviders</font></b> .  These are classes that already exist in <code>iOS</code> and that are <b><font color="#0000FF">itemPoviders</font></b> , such as <code>NSString</code> , for example, which allows you to drag text without fonts.  Of course, this is a <b><font color="#0000FF">UIImage</font></b> image.  You can select and drag <b><font color="#0000FF">UIImages</font></b> everywhere.  <b><font color="#0000FF">NSURL</font></b> class, which is absolutely wonderful.  You can go to the <code>Web</code> page, select the <code>URL</code> and ‚Äúthrow‚Äù it wherever you want.  This may be a link to the article or the <code>URL</code> for the image, as it will be in our demo.  These are the color classes of <b><font color="#0000FF">UIColor</font></b> , the <b><font color="#0000FF">MKMapItem</font></b> map <b><font color="#0000FF">element</font></b> , the <b><font color="#0000FF">CNContact</font></b> contact from the address book, a lot of things you can select and drag.  All of them are <b><font color="#0000FF">itemProviders</font></b> . <br><br>  We're going to drag a <b><font color="#0000FF">UIImage</font></b> image.  It is in the <code>Collection View</code> cell with the <b><font color="#0000FF">indexPath</font></b> , which helps me to select a <b><font color="#0000FF">cell</font></b> , get an <code>Outlet</code> <b><font color="#0000FF">imageView</font></b> from it and get its <b><font color="#0000FF">image</font></b> . <br><br>  Let's express this idea in a couple of lines of code. <br>  First, I query my <code>Collection View</code> about the cell <b><font color="#0000FF">cell</font></b> for the <b><font color="#0000FF">item</font></b> element corresponding to this <b><font color="#0000FF">indexPath</font></b> . <br><br><img src="https://habrastorage.org/webt/ho/zi/gp/hozigp41-y0-3cfa525umwojyu4.png"><br><br>  The <b><font color="#0000FF">cellForItem</font></b> method <b><font color="#0000FF">(at: IndexPath)</font></b> for the <code>Collection View</code> only works for visible ( <code>visible</code> ) cells, but, of course, it will work in our case, because I‚Äôm dragging the <code>Drag</code> item on the screen and it is visible. <br><br>  So, I received a "draggable" cell <b><font color="#0000FF">cell</font></b> . <br>  Next, I use the <b><font color="#0000FF">as</font></b> operator <b><font color="#0000FF">?</font></b>  to this cell so that it has the TYPE of my custom <code>subclass</code> .  And if it works, then I get an <code>Outlet</code> <b><font color="#0000FF">imageView</font></b> , from which I take its <b><font color="#0000FF">image</font></b> .  I just captured the image <b><font color="#0000FF">image</font></b> for this <b><font color="#0000FF">indexPath</font></b> . <br><br>  Now that I have an <b><font color="#0000FF">image</font></b> , all I need to do is create one of these <b><font color="#0000FF">UIDragItems</font></b> , using the resulting image <b><font color="#0000FF">image</font></b> as <b><font color="#0000FF">itemProvider</font></b> , that is, the thing that provides us with data. <br>  I can create <b><font color="#0000FF">dragItem</font></b> with the <b><font color="#0000FF">UIDragItem</font></b> constructor, which takes as an argument <b><font color="#0000FF">itemProvider</font></b> : <br><br><img src="https://habrastorage.org/webt/to/zb/gt/tozbgtxocfrgoaqofvn9jgf9yeo.png"><br><br>  Then we create an <b><font color="#0000FF">itemProvider</font></b> for the image <b><font color="#0000FF">image</font></b> also using the constructor <b><font color="#0000FF">NSItemProvider</font></b> .  There are several constructors for <b><font color="#0000FF">NSItemProvider</font></b> , but among them there is one really remarkable - <b><font color="#0000FF">NSItemProvider (object: NSItemProviderWriting)</font></b> : <br><br><img src="https://habrastorage.org/webt/ey/21/cq/ey21cq0iq5riml7pfrye4gcnmi8.png"><br><br>  To this constructor <b><font color="#0000FF">NSItemProvider,</font></b> you simply give an <b><font color="#0000FF">object</font></b> an <b><font color="#0000FF">object</font></b> , and it knows how to make an <b><font color="#0000FF">itemProvider</font></b> out of it.  As such an <b><font color="#0000FF">object,</font></b> I give the image the image <b><font color="#0000FF">image</font></b> that I received from the cell of the <b><font color="#0000FF">cell</font></b> and get the <b><font color="#0000FF">itemProvider</font></b> for the <b><font color="#0000FF">UIImage</font></b> . <br>  And it's all.  We created <b><font color="#0000FF">dragItem</font></b> and should return it as an array having one element. <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">But before I return the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dragItem</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , I'm going to do one more thing, namely, set the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localObject</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> variable </font><font style="vertical-align: inherit;">for the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dragItem</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> equal to the resulting image </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">image</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><img src="https://habrastorage.org/webt/sh/h0/cz/shh0czt4sxjd7ienvsl2slz8yju.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">What does this mean? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If you drag and drop </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">locally, that is, inside your application, then you do not need to go through all this code associated with </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">itemProvider</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , through asynchronous data retrieval. You do not need to do this, you just need to take </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localObject</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and use it. This is a kind of ‚Äúshort circuit‚Äù with a local ‚Äúdrag and drop‚Äù </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The code we write will work when ‚Äúdragging‚Äù</font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">beyond our collection </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to other applications, but if we ‚Äúdrag and drop‚Äù </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">locally, we can use </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localObject</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Next, I return an array consisting of a single </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dragItem</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> element </font><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Incidentally, if I could not get for some reason </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">image</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> for this cell </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cell</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , I return empty array </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[]</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , this means that the "drag" </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is canceled. </font></font><br><br><img src="https://habrastorage.org/webt/4b/uk/o3/4buko3fve2swk7wr7d_oy5sflma.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In addition to the local object </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localObject</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , you can remember the local context </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localContext</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> for our </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">session </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">session</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . In our case, it will be a collectionView </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">collection.</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and it is useful to us afterwards: </font></font><br><br><img src="https://habrastorage.org/webt/o_/gi/tk/o_gitkbwnnbcevnxwcwm6obckwk.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Having "drag and drop" </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, you can add more items </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">items</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to this "drag and drop", just doing the gesture </font></font><b><font color="#FF00FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tap</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> on them. As a result, you can drag a </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">lot of items at once. And it is easy to implement using another method delegate </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UICollectionViewDragDelegate</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , very similar to the method </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">itemsForVeginning</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , a method called </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">itemsForAddingTo</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . The </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">itemsForAddingTo</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> method </font><font style="vertical-align: inherit;">looks exactly the same as the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">itemsForVeginning</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> method </font><font style="vertical-align: inherit;">, and returns exactly the same thing, because it also gives us the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">of what the user ‚Äútapped‚Äù on during the ‚Äúdrag </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and </font><font style="vertical-align: inherit;">drop‚Äù process </font><font style="vertical-align: inherit;">, and it is enough for me to get an </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">image</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> from the cell where the user ‚Äútapped‚Äù and return it. </font></font><br><br><img src="https://habrastorage.org/webt/u-/hc/9d/u-hc9dnk3001qhkra-et6oycphi.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Returning an empty </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[]</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> array </font><font style="vertical-align: inherit;">from the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">itemsForAddingTo</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> method </font><font style="vertical-align: inherit;">causes the </font></font><b><font color="#FF00FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tap</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> gesture to </font><font style="vertical-align: inherit;">be interpreted in the usual way, that is, as the choice of this </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cell</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">And that‚Äôs all we need to drag and drop </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Run the application. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I select the ‚ÄúVenice‚Äù image, hold it for a while and start moving ... </font></font><br><br><img src="https://habrastorage.org/webt/p7/ne/9z/p7ne9zdwnirsf2uxjogvflrqwao.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... and we can actually drag this image into the app</font></font><code>Photos</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, as you see a green plus sign "+" in the upper left corner of the "drag and drop" image. </font><font style="vertical-align: inherit;">I can perform a </font></font><b><font color="#FF00FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">tap</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> gesture </font><font style="vertical-align: inherit;">on one more image of "Artik" from the collection </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... </font></font><br><br><img src="https://habrastorage.org/webt/cg/sj/om/cgsjomxtwxyzqxg-wxvqxz4huqi.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... and now we can already throw two images into the application </font></font><code>Photos</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br><br><img src="https://habrastorage.org/webt/bk/xk/ud/bkxkud6ggdorw2d1yayjmatnsf4.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Since the application </font></font><code>Photos</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">has a mechanism already built in </font></font><code>Drag &amp; Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, everything works fine, and this is cool. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">So, I have to ‚Äúovertighten‚Äù </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and ‚Äúreset‚Äù the </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gallery image to other applications, I did not have to do much in my application, except for the delivery of the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">image</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> as an array </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[UIDragItem]</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font><font style="vertical-align: inherit;">This is one of the many great features of the mechanism.</font></font><code>Drag &amp; Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - it is very easy to make it work in both directions. </font></font><br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reset of </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">images In a collection</font></font><code>Collection View</code> </h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now we need to make a </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">part for my collection </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">so that we can ‚Äúdrop‚Äù </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">any ‚Äúdraggable‚Äù images INSIDE of this collection. </font><font style="vertical-align: inherit;">‚ÄúDragged‚Äù image can ‚Äúcome‚Äù both from outside and directly from inside of this collection. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To do this, we do the same thing done to delegate </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dragDelegate</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , ie make ourselves, </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the self</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , delegate </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dropDelegate</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in the method of </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the viewDidLoad</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/5q/wv/mf/5qwvmfjuyh74sfxzwcw7_0gikec.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Again, we have to climb to the top of our class </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ImageGalleryCollectionViewController</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and verify protocol implementation </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UICollectionViewDropDelegate</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br><br><img src="https://habrastorage.org/webt/wc/ww/7p/wcww7pgfia3xxwe63teews1e9de.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As soon as we added our new protocol, the compiler again began to ‚Äúcomplain‚Äù that we did not implement this protocol. We click on the button </font></font><code>Fix</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, and before us appear the mandatory methods of this protocol. In this case, we are told that we must implement the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">performDrop</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> method </font><font style="vertical-align: inherit;">: </font></font><br><br><img src="https://habrastorage.org/webt/ll/9t/k4/ll9tk4goht7nfa-gnifnq8iaoto.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We must do this, otherwise a ‚Äúreset‚Äù will not occur </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. In fact, I'm going to implement the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">performDrop</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> method </font><font style="vertical-align: inherit;">last, because there are a couple of other highly recommended </font></font><code>Apple</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">methods that need to be implemented for the </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">part. These are </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">canHandle</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dropSessionDidUpdate</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br><br><img src="https://habrastorage.org/webt/jd/ce/ve/jdcevehobhr1k7wwvc1iaem-w80.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If we implement these two methods, then we can get a small green plus sign ‚Äú+‚Äù when we drag images OUTSIDE onto our collection </font></font><code>ollection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, and besides, we will not try to dump something we do not understand. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let's implement </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">canHandle</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . You have a version of the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">canHandle</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> method </font><font style="vertical-align: inherit;">that is intended for the collection </font></font><code>ollection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. But this method </font></font><code>ollection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">looks exactly the same as a similar method for a regular </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , there is no </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . We just need to return </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">session.canLoadObjects (ofClass: UIImage.self)</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , which means that I accept the ‚Äúreset‚Äù of the objects of this class PAS in my collection </font></font><code>ollection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">:</font></font><br><br><img src="https://habrastorage.org/webt/0j/tz/ze/0jtzzen649jj7z58-3tiq_ehrvs.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">But this is not enough to ‚Äúdump‚Äù the </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">image into my collection </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OUTSIDE. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If an </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">image is </font><font style="vertical-align: inherit;">dumped </font><font style="vertical-align: inherit;">INSIDE a collection </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, when a user reorganizes his own elements of </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">items</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> using a mechanism </font></font><code>Drag &amp; Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, then a single </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIImage</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> image is </font><b><font color="#0000FF"><font style="vertical-align: inherit;">enough</font></font></b><font style="vertical-align: inherit;"> , and the implementation of the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">canHandle</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> method </font><font style="vertical-align: inherit;">will look like this. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">But if the </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">image </font><font style="vertical-align: inherit;">‚Äúdumping‚Äù </font><font style="vertical-align: inherit;">happens EXTERNAL, then we need to process only those ‚Äúdrag and drop‚Äù </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">that represent the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIImage</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> image </font><font style="vertical-align: inherit;">along with </font></font><code>URL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">for this image, since we are not going to store the </font><b><font color="#0000FF"><font style="vertical-align: inherit;">UIImage</font></font></b><font style="vertical-align: inherit;"> images </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">directly</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in the model. In this case, I will return </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">true</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">canHandle</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> method </font><font style="vertical-align: inherit;">only if a pair of </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">session.canLoadObjects</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> conditions </font><b><font color="#0000FF"><font style="vertical-align: inherit;">(ofClass: NSURL.self) &amp;&amp; session.canLoadObjects (ofClass: UIImage.self)</font></font></b><font style="vertical-align: inherit;"> are </font><font style="vertical-align: inherit;">simultaneously executed </font><b><font color="#0000FF"><font style="vertical-align: inherit;">&amp;</font></font></b><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/yj/dt/qn/yjdtqnmmxq0olgilbz1ifa5mdt8.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">it remains for me to determine whether I am dealing with a "reset" From outside or inside. I'll do it with the help of calculated constants </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">isself</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , for the calculation of which I can use such a thing in </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the session </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the session</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , both its local </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">session </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localDragSession</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . This local </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">session in turn has a local context </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localContext</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If you remember, we set this local context in the method</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">itemsForVeginning</font></font></font></b> <code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> delegate</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> UICollectionViewDragDelegate</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br><br><img src="https://habrastorage.org/webt/o_/gi/tk/o_gitkbwnnbcevnxwcwm6obckwk.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I will examine the local context of</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> localContext</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> for equality to my</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> collectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . True TYPE for</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> localContext</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> will be</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Any</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and I need to make a "casting" of TYPE</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Any</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> with the help of the</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> as</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> operator</font><b><font color="#0000FF"><font style="vertical-align: inherit;"> ? UICollectionView</font></font></b><font style="vertical-align: inherit;"> :</font></font><br><br><img src="https://habrastorage.org/webt/kc/zk/nt/kczknt6xiau08k5d06xu40akoyu.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If the local context</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (session.localDragSession? .LocalContext as? UICollectionView)</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is equal to my</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> collectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , then the calculated variable</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> isSelf</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> true</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and there is a local "reset" INSIDE my collection. If this equality is violated, then we are dealing with a "reset" </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">EXTERNAL. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">canHandle</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> method </font><font style="vertical-align: inherit;">reports that we can only handle this kind of ‚Äúdrag and drop‚Äù </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">onto our collection </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Otherwise, it doesn‚Äôt make sense at all to talk about ‚Äúdumping‚Äù </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If we continue ‚Äúresetting‚Äù </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, then even before the user lifts his fingers from the screen and a real ‚Äúreset‚Äù occurs </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, we must inform the </font><font style="vertical-align: inherit;">delegate </font><b><font color="#0000FF"><font style="vertical-align: inherit;">UICollectionViewDropDelegate</font></font></b><font style="vertical-align: inherit;"> about the </font><b><font color="#0000FF"><font style="vertical-align: inherit;">UIDropProposal</font></font></b><font style="vertical-align: inherit;"> proposal </font><font style="vertical-align: inherit;">to perform a reset </font></font><code>iOS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">using the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dropSessionDidUpdate</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> method </font><font style="vertical-align: inherit;">.</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"></font></font></b><font style="vertical-align: inherit;"></font><b><font color="#0000FF"><font style="vertical-align: inherit;"></font></font></b><font style="vertical-align: inherit;"></font><code>Drop</code><font style="vertical-align: inherit;"></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In this method, we must return a </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">clause that can have the values </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.copy</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> or </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.move</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> or </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.cancel</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> or </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.forbidden</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> for the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">operation</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> argument </font><font style="vertical-align: inherit;">. And these are all the possibilities that we have in the usual case when dealing with the usual </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">But the collection </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">goes further and offers to return the specialized </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UICollectionViewDropProposal clause</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , which is </font></font><code>subclass</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">of the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIDropProposal</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> class </font><font style="vertical-align: inherit;">and allows, in addition to the operation </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">operation,</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to specify an additional </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">intent</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> parameter </font><font style="vertical-align: inherit;">for the collection </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Parameter</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The intent</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tells the collection</font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">whether we want the ‚Äúreset‚Äù element to be placed inside an already existing</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cell</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> or whether we want to add a new</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cell.</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> See the difference? In the case of a collection,</font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">we must report our intent</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> intent</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In our case, we always want to add a new cell, so you will see what our</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> intent</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> parameter is equal to</font><font style="vertical-align: inherit;">.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Select the second constructor for the</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> UICollectionViewDropProposal</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br><br><img src="https://habrastorage.org/webt/ab/vh/-p/abvh-pb04qje37u4jjgveja3lgu.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In our case, we always want to add a new cell and the</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> intent</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> parameter</font><font style="vertical-align: inherit;">will take the value</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .insertAtDestinationIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> as opposed to</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.insertIntoDestinationIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><img src="https://habrastorage.org/webt/yg/t0/xi/ygt0xirvwaucl9zvuvuxvvil2cu.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I again used the calculated</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> isSelf</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> constant</font><font style="vertical-align: inherit;">, and if this is a</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> self-</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> reorganization, then I perform a</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .move</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> move</font><font style="vertical-align: inherit;">, otherwise I do a copy of</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .copy</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . In both cases, we use</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .insertAtDestinationIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , that is, inserting new</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cells</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">So far I have not implemented the</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> performDrop</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> method</font><font style="vertical-align: inherit;">, but let's take a look at what the collection can already do</font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">with this small piece of information that we provided to it.</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I am dragging an image out</font></font><code>Safari</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">with a search engine</font></font><code>Google</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, and this image has a green "+" sign on top, indicating that our Gallery of Images is ready not only to receive and copy this image along with it </font></font><code>URL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, but also to provide a place inside the collection </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br><br><img src="https://habrastorage.org/webt/ia/gy/gv/iagygvechjnwsm-tfvduwi0pc1o.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I can click on a couple more images in </font></font><code>Safari</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, and ‚ÄúDragged‚Äù images will already be 3: </font></font><br><br><img src="https://habrastorage.org/webt/kd/ca/7s/kdca7sflzfrbbsbtmnk8_zbueqm.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">But if I lift my finger and ‚Äúdrop‚Äù </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">these images, they will not be placed in our Gallery, but will simply return to their former places, because we have not yet implemented the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">performDrop</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> method </font><font style="vertical-align: inherit;">. </font></font><br><br><img src="https://habrastorage.org/webt/5v/e4/me/5ve4me_unk6t-azl6fhatljzgxs.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">You could see that the collection </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">already knows what I want to do. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The collection </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is absolutely wonderful thing for the mechanism.</font></font><code>Drag &amp; Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, it has very powerful functionality for this. We barely touched it, having written 4 lines of code, and it already advanced far enough in the perception of ‚Äúreset‚Äù </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let's go back to the code and implement the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">performDrop</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> method </font><font style="vertical-align: inherit;">. </font></font><br><br><img src="https://habrastorage.org/webt/i0/cc/es/i0ccescpyvub0pclhjyzcbdcu7o.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In this method, we will not be able to do with 4 lines of code, because the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">performDrop</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> method </font><b><font color="#0000FF"><font style="vertical-align: inherit;">is a</font></font></b><font style="vertical-align: inherit;"> bit more complicated, but not too complicated. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">When a ‚Äúreset‚Äù occurs </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, then in the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">performDrop</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> method </font><font style="vertical-align: inherit;">we have to update our Model, which is </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imageGallery</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Image </font><b><font color="#0000FF"><font style="vertical-align: inherit;">Gallery</font></font></b><font style="vertical-align: inherit;"> with a list of images </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">images</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and we need to update our collectionView visual </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">collection</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We have two different ‚Äúreset‚Äù scenarios </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If there is a ‚Äúreset‚Äù </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">from my </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">collectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , then I need to ‚Äúreset‚Äù the </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">collection item at the new location and remove it from the old location, because in this case I move ( </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.move</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) this collection item. This is a trivial task. </font><b><font color="#0000FF"><font style="vertical-align: inherit;">If</font></font></b></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> there is a ‚Äúreset‚Äù </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">from another application, we must use the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">itemProvider</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> property of the </font><font style="vertical-align: inherit;">‚Äúdrag and drop‚Äù </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">item</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> element </font><font style="vertical-align: inherit;">to select data. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">When we perform a ‚Äúreset‚Äù </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in the collectionView </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">collection</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , the collection provides us with the coordinator </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coordinator</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. The first and most important thing that the coordinator </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coordinator</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> tells us </font><font style="vertical-align: inherit;">is the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">destinationIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , that is </font><font style="vertical-align: inherit;">, the destination-point </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> of the ‚Äúreset‚Äù </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, that is, where we will be ‚Äúreset‚Äù. </font></font><br><br><img src="https://habrastorage.org/webt/mp/mt/wk/mpmtwkebx7beyw5ge72gt19xt7k.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">But </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">destinationIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> can be equal to </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nil</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , since you can drag the ‚Äúdumped‚Äù image to a part of the collection </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">that is not between any existing </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cells</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , so that it may well be </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nil</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . If this is the situation, then I create an </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> with the 0th </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">item</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> element </font><font style="vertical-align: inherit;">in the 0th section of the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">section</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><img src="https://habrastorage.org/webt/qd/ei/me/qdeimejhoj1v0pkgml2xtog1jke.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I could choose any other </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , but this </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> I will use by default. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now we know where we are going to ‚Äúdump‚Äù </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. We must go through all the ‚Äúreset‚Äù elements of </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coordinator.items</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> provided by the coordinator </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coordinator</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Each </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">item</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> from this list has the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UICollectionViewDropItem</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> TYPE </font><font style="vertical-align: inherit;">and can provide us with very interesting pieces of information. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For example, if I can get the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sourceIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> from </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">item.sourceIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , then I‚Äôll know for sure that this ‚Äúdrag and drop‚Äù </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is done from myself, </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, and the source of the drag </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is the collection item with the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> equal to </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sourceIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/y2/3d/2u/y23d2u0pmf1pnasfw2khu9htji4.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I don‚Äôt even have to look at </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localContext</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in this case to find out that this ‚Äúdrag and drop‚Äù was done INSIDE the collectionView </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">collection</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font> Great! <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now I know the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sourceIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> source </font><font style="vertical-align: inherit;">and destination-point </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">destinationIndexPath</font></font></font></b> <code>Drag &amp; Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and the task becomes trivial. All I need to do is update the Model so that the source and destination point are swapped, and then update the collectionView </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">collection</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to remove the collection item from </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sourceIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and add it to the collection from </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">destinationIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Our local case is the simplest one, because in this case the mechanism </font></font><code>Drag &amp; Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">works not just in the same application, but also in the same collectionView </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">collection</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and I can get all the necessary information using the coordinator </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coordinator</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Let's implement this simplest local case: </font></font><br><br><img src="https://habrastorage.org/webt/1m/uu/4r/1muu4rnsxmehwuyybyspei14bvo.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In our case, I don‚Äôt even need the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localObject</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , which I ‚Äúhid‚Äù earlier when I created the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dragItem</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and which I can now borrow from the ‚Äúdrag and drop‚Äù </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">item</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in the </font><b><font color="#0000FF"><font style="vertical-align: inherit;">item</font></font></b><font style="vertical-align: inherit;"> collection </font><font style="vertical-align: inherit;">in the form </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">item.localObject</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . We will need it when ‚Äúdumping‚Äù </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">images into the ‚Äútrash can‚Äù, which is in the same application, but is not the same collectionView </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">collection</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Now two </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IndexPathes are</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> enough for me </font><font style="vertical-align: inherit;">: the source </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sourceIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and the destination point </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">destinationIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I get the information first</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imageInfo</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> about the image in the old place from the Model, removing it from there. And then insert into an array of</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> images</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> of my models</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> imageGallery</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> information</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> imageInfo</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> an image with a new index</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> destinationIndexPath.item</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . This is how I updated my Model:</font></font><br><br><img src="https://habrastorage.org/webt/pk/bk/ny/pkbknyitrog4kq40dcs7sfpxk0g.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now I have to update the collection</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> collection</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> itself</font><font style="vertical-align: inherit;">. It is important to understand that I do not want to overload all the data in my collection</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> collectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> using</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> reloadData ()</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in the middle of the "drag and drop" process</font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, because it resets the whole "world" of our gallery of images, which is very bad, I do not. Instead, I'm going to remove and insert items.</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">items</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> separately:</font></font><br><br><img src="https://habrastorage.org/webt/1-/xa/jg/1-xajgm6ru3uwhqh53w4tf7tblu.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I deleted the item in a collection</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> collectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> with</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> sourceIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and insert a new item in the collection with</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> destinationIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It looks as though this code works fine, but in reality, this code may ‚Äúcrash‚Äù your application. The reason is that you make numerous changes to your collectionView</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> collection</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and in this case, each step of the collection change must be normally synchronized with the Model, which in our case is not respected, since we perform both operations at the same time: delete and insert. Therefore, collection</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> collectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">will be at some point in a non-synchronized state with the Model. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">But there is a really cool way to get around this, which is that the collection view </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">collection</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> has a method called </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">performBatchUpdates</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> that has a closure ( </font></font><code>closure</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) and within that closure I can place any number of these </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deleteItems</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">insertItems</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">moveItems</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and all I want: </font></font><br><br><img src="https://habrastorage.org/webt/6b/w_/6n/6bw_6nemnuzuv8xowkmmpt4yumw.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now, </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">deleteItems</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">insertItems</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> will be executed as a single operation, and there will never be a lack of synchronization of your Model with the collectionView </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">collection</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">And finally, the last thing we need to do is to ask the coordinator </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coordinator to</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> perform and animate the ‚Äúreset‚Äù itself </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br><br><img src="https://habrastorage.org/webt/7k/qr/1u/7kqr1uatpcgzp8vim6hsf1-o_lo.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As soon as you lift your finger off the screen, the image moves, everything happens at the same time: ‚Äúreset‚Äù, the image disappears in one place and appearance in another. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let's try to move the ‚ÄúVenice‚Äù test image in our Image Gallery to the end of the first row ... </font></font><br><br><img src="https://habrastorage.org/webt/gy/k4/ci/gyk4ci8msjogcvzo4hb8iqt2atq.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... and ‚Äúreset‚Äù it: </font></font><br><br><img src="https://habrastorage.org/webt/kb/a0/mv/kba0mvrjzqyf_wf1y8b0j5h27oy.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As we wanted, it was placed at the end of the first row.</font></font><br>  Hooray!  Everything is working! <br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now let us deal NOT with the local case, that is, when the ‚Äúreset‚Äù element comes OUTSIDE, that is, from another application. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To do this, we write </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">else</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in the code </font><font style="vertical-align: inherit;">with respect to </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sourceIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . If we do not have </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sourceIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , then this means that the ‚Äúreset‚Äù item came from somewhere OUTSIDE and we will have to enable data transfer using the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">itemProver</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> reset item </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">item.dragItem.itemProvider</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> element </font><font style="vertical-align: inherit;">: </font></font><br><br><img src="https://habrastorage.org/webt/wh/-9/gd/wh-9gdfe_e52v_9-wc-mf6o-7co.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If you ‚Äúdrag </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and </font><font style="vertical-align: inherit;">drop‚Äù </font><font style="vertical-align: inherit;">EITHER and ‚Äúdrop‚Äù "</font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Does this information become available instantly? No, you select data from the ‚Äúdragged‚Äù thing ASYNCHRONOUS. But what if the sample takes 10 seconds? What will the collection do at this time </font></font><code>ollection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">? In addition, the data may not come at all in the order in which we requested it. To manage this is not at all easy, and </font><font style="vertical-align: inherit;">in this case it </font></font><code>Apple</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">proposed a </font></font><code>ollection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">completely new technology for using substitutes </font></font><code>Placeholders</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">You place a </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">substitute </font><font style="vertical-align: inherit;">in your collection </font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, and the collection </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">manages it all for you, so all you have to do when the data is finally selected is to ask the substitute to </font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">call its context </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">placeholderContext</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and inform him that you received the information. Then update your Model and the context of the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">placeholderContext</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> AUTOMATICALLY swap a cell </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cell</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> with a placeholder </font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">for one of your cells </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cells</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , which corresponds to the type of data you received. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We perform all of these actions by creating a </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">placeholderContext placeholder</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> context </font><font style="vertical-align: inherit;">that controls the placeholder </font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and which you get from the coordinator </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coordinator</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> by asking to ‚Äúreset‚Äù </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">item</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> element </font><font style="vertical-align: inherit;">on the placeholder </font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I will use the initializer for the </font><b><font color="#0000FF"><font style="vertical-align: inherit;">placeholderContext placeholder</font></font></b><font style="vertical-align: inherit;"> context</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, which ‚Äúthrows‚Äù </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dragItem</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to a </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UICollectionViewDropPlaceholder</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/xh/lo/gk/xhlogk8aee_nhrukgwbtq0m8nae.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The object I'm going to ‚Äúdrop‚Äù </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">is </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">item.dragItem</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , where </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">item</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">for</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> element of the </font><font style="vertical-align: inherit;">loop, since we can ‚Äúthrow‚Äù </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">many </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coordinator.items</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> objects </font><font style="vertical-align: inherit;">. We ‚Äúthrow‚Äù them one by one. So </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">item.dragItem</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is what we ‚Äúdrag‚Äù </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and ‚Äúthrow‚Äù </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. The next argument to this function is the placeholder, and I will create it using the initializer </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UICollectionViewDropPlaceholder</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/hg/yu/jk/hgyujkpqodrfosah0opsrwwc-t0.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In order to do this, I need to know WHERE I am going to insert the placeholder</font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, that is, </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">insertionIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , as well as the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reuseIdentifier</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cell </font><b><font color="#0000FF"><font style="vertical-align: inherit;">identifier</font></font></b><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">insertionIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> argument </font><font style="vertical-align: inherit;">is obviously equal to </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">destinationIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , this is the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to accommodate the ‚Äúdrag and drop‚Äù object, it is calculated at the very beginning of the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">performDropWith</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> method </font><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now look at the reuse cell </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">identifier of the reuseIdentifier</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . You need to decide what type of cell </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cell</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> is your a placeholder </font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. The coordinator </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">coordinator</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> does not have a ‚Äúpre </font><font style="vertical-align: inherit;">-assembled </font><font style="vertical-align: inherit;">‚Äù </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cell</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> for the locator.</font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. It is YOU who must decide on this </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cell</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Therefore, a reuse cell </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">identifier reuseIdentifiercell is requested</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> with yours </font></font><code>storyboard</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">so that it can be used as a PROTOTYPE. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I will call it ‚ÄúDropPlaceholderCell‚Äù, but in principle, I could call it whatever you like. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This is just a String </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">string</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , which I am going to use on mine </font></font><code>storyboard</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to create this thing. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Go back to ours </font></font><code>storyboard</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and create a cell </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cell</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> for the placeholder </font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. To do this, we just need to select a collection </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and inspect it. In the very first field, </font></font><code>Items</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I change </font></font><code>1</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to</font></font><code>2</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. This immediately creates a second cell for us, which is an exact copy of the first one. </font></font><br><br><img src="https://habrastorage.org/webt/df/go/ke/dfgokefx6miugtxs8ee0_jl1zsk.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Select our new cell </font></font><code>ImageCell</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, set the identifier ‚Äú </font></font><code>DropPlaceholderCell</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">‚Äù, remove all </font></font><code>UI</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">elements </font><font style="vertical-align: inherit;">from there </font><font style="vertical-align: inherit;">, including </font></font><code>Image View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, since this PROTOTYPE is used when the image has not yet arrived. Add a new activity indicator from the Objects Palette </font></font><code>Activity Indicator</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">; it will rotate, making it clear to users that I am expecting some ‚Äúdiscarded‚Äù data. Also change the background color </font></font><code>Background</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to understand that when "Reset" from the outside image works exactly this cell </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cell</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> as prototypes: </font></font><br><br><img src="https://habrastorage.org/webt/ur/gi/72/urgi728r6j2a1d2z0tf_4k-er1a.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">addition of a new cell type must not be </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ImageCollectionVewCell</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">because there will be no images in it. I will make this cell a regular cell of the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIollectionCiewCell</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> TYPE </font><font style="vertical-align: inherit;">, since we do not need any </font></font><code>Outlets</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">control: </font></font><br><br><img src="https://habrastorage.org/webt/sg/d8/ya/sgd8ya2342bd0lgk9fl172j-8pi.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let's configure the activity indicator </font></font><code>Activity Indicator</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">so that it starts animating from the very beginning, and I wouldn‚Äôt have to write anything in the code to run it. To do this, click on the options </font></font><code>Animating</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br><br><img src="https://habrastorage.org/webt/qm/de/hq/qmdehqmwsuzn_dt8fkbjdoclkss.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">And that's all. So, we made all the settings for this cell </font></font><code>DropPlaceholderCell</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, go back to our code. Now we have an excellent replacement locator </font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, ready to </font><font style="vertical-align: inherit;">go </font><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">All that is left for us to do is receive the data, and when the data is received, we simply say about this context </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">placeholderontext</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and it swaps the placeholder</font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and our ‚Äúnative‚Äù data cell, and we will make changes in the Model. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I'm going to ‚Äúload‚Äù the ONE object that my </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">item</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> will be </font><font style="vertical-align: inherit;">using the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">loadObject</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> method </font><b><font color="#0000FF"><font style="vertical-align: inherit;">(ofClass: UIImage.self)</font></font></b><font style="vertical-align: inherit;"> (singular). I use the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">item.dragItem.itemProvider</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> code </font><font style="vertical-align: inherit;">with the </font><b><font color="#0000FF"><font style="vertical-align: inherit;">itemProvider</font></font></b><font style="vertical-align: inherit;"> provider </font><font style="vertical-align: inherit;">, which will provide me with </font><b><font color="#0000FF"><font style="vertical-align: inherit;">item</font></font></b><font style="vertical-align: inherit;"> element </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ASYNCHRONOUS</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> data </font><font style="vertical-align: inherit;">. It is clear that if </font><b><font color="#0000FF"><font style="vertical-align: inherit;">iitemProvider was</font></font></b><font style="vertical-align: inherit;"> connected </font><font style="vertical-align: inherit;">, then the object of ‚Äúreset‚Äù </font><b><font color="#0000FF"><font style="vertical-align: inherit;">iitem</font></font></b><font style="vertical-align: inherit;"> we get outside of this application. The following is the </font><b><font color="#0000FF"><font style="vertical-align: inherit;">loadObject</font></font></b><font style="vertical-align: inherit;"> method </font><b><font color="#0000FF"><font style="vertical-align: inherit;">(oflass: UIImage.self)</font></font></b><font style="vertical-align: inherit;"> (in the singular): </font><font style="vertical-align: inherit;">This particular closure is NOT executed on</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"></font></font></b><font style="vertical-align: inherit;"></font><b><font color="#0000FF"><font style="vertical-align: inherit;"></font></font></b><font style="vertical-align: inherit;"></font><b><font color="#0000FF"><font style="vertical-align: inherit;"></font></font></b><font style="vertical-align: inherit;"></font><b><font color="#0000FF"><font style="vertical-align: inherit;"></font></font></b><font style="vertical-align: inherit;"></font><br><br><img src="https://habrastorage.org/webt/bv/pl/fj/bvplfjtt-wlffytoqky4jxcbxco.png"><br><br><font style="vertical-align: inherit;"></font><code>main queue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. And, unfortunately, we had to switch to </font></font><code>main queue</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">using </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DispatchQueue.main.async {}</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in order to ‚Äúcatch‚Äù the aspect ratio of the image in the local variable </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aspectRatio</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We really entered two local variables </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imageURL</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aspectRatio</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ... </font></font><br><br><img src="https://habrastorage.org/webt/vc/k3/vg/vck3vgqg7grejo8tj2ojbdnfdny.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... and will ‚Äúcatch‚Äù them when loading the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">image</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font><b><font color="#0000FF"><font style="vertical-align: inherit;">image </font></font></b></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">url</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> URL </font><font style="vertical-align: inherit;">: </font></font><br><br><img src="https://habrastorage.org/webt/jc/ui/yk/jcuiyk3c1zcz4wmkeafkpmkdvqq.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If both local variables </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imageURL</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aspectRatio are</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> not </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nil</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , we will ask for the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">placeholderConttext placeholder</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> context </font><font style="vertical-align: inherit;">using the </font><b><font color="#0000FF"><font style="vertical-align: inherit;">commitInsertion</font></font></b><font style="vertical-align: inherit;"> method</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">give us the opportunity to change our Model </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imageGallery</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/z6/hm/8w/z6hm8w4jnyrwxgx2g8v9sfnfiuq.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In this expression, we have </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">insertionIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> - this is the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to insert, and we change our Model </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imageGallery</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . This is all we need to do, and this method AUTOMATICALLY replaces the placeholder </font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">with a </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cell</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> by calling the normal </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cellForItemAt</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> method </font><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Note that </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">insertionIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> can be very different from </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">destinationIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font> Why?<font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Because data sampling may take 10 seconds, of course, unlikely, but it may take 10 seconds. During this time in the collection </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">can very much happen. New cells can be added </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cells</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , everything happens fairly quickly. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ALWAYS use </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">insertionIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and ONLY </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">insertionIndexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , to update your Model. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How do we update our model? </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We insert into the array </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imageGallery.images</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> structure </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imagemodel</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , composed of the aspect ratio </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aspectRatio</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and image URL </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imageURL</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , who gave us back the corresponding </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">by provider</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">This updates our </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ImageGallery</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> model </font><font style="vertical-align: inherit;">, and the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">commitInsertion</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> method </font><font style="vertical-align: inherit;">does the rest for us. No more do you need to do anything extra, no inserts, delete rows, none of this. And, of course, since we are in a closure, we need to add </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self.</font></font></font></b>  . <br><br><img src="https://habrastorage.org/webt/rm/ff/nx/rmffnxnhy_1k1ukzub6ni468z6g.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If we are for some reason not able to get the aspect ratio </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">aspectRatio</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><code>URL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">image </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imageURL</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> from the corresponding </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">by provider</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , an error might have been received </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">error</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> instead </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">by provider</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , we have to let them know the context </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">placeholderContext</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , you need to destroy this a placeholder </font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, because we are all the same, we can not to get other data: </font></font><br><br><img src="https://habrastorage.org/webt/gw/tm/jj/gwtmjjywumpq4o7czavwnrcweay.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It is necessary to keep in mind one particularity </font></font><code>URLs</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">that comes from places like </font></font><code>Google</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, in fact, they need minor transformations to get a ‚Äúclean‚Äù</font></font><code>URL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">for the image. How this problem is solved can be seen in this demo application in a file </font></font><code>Utilities.swift</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">on </font></font><a href="https://github.com/BestKora/Article-Drag-Drop"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Github</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Therefore, when retrieving an </font></font><code>URL</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">image, we use the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imageURL</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> property </font><font style="vertical-align: inherit;">from the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">URL</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> class </font><font style="vertical-align: inherit;">: </font></font><br><br><img src="https://habrastorage.org/webt/v5/cq/dc/v5cqdcxzqnwybov4eiklwlkt2o8.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">And this is all that needs to be done to take something from the outside on the collection </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let's see it in action. We start simultaneously in a multitasking mode our demo application </font></font><code>ImageGallery</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and </font></font><code>Safari</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">with a search engine </font></font><code>Google</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. In </font></font><code>Google</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">we are looking for images on the theme "Dawn" (sunrise). In </font></font><code>Safari</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">already built</font></font><code>Drag &amp; Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">mechanism, so we can select one of these images, hold it for a long time, move it a little and drag it to our Gallery of Images. </font></font><br><br><img src="https://habrastorage.org/webt/au/t9/wk/aut9wky03l29lkgj9g7l1ulifmc.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The presence of a green plus sign "+" indicates that our application is ready to accept a third-party image and copy it into its collection at the location specified by the user. After we ‚Äúreset‚Äù it, it takes some time to load the image, and at that time it works </font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br><br><img src="https://habrastorage.org/webt/ge/e-/n0/gee-n08qnm7zc5ofbgr3e4o8df8.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">After the download is complete, the ‚Äúdiscarded‚Äù image is placed in the right place, and </font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">disappears: </font></font><br><br><img src="https://habrastorage.org/webt/m8/rb/nq/m8rbnqvi2x0s3as4w_fzpjpltae.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We can continue ‚Äúresetting‚Äù the images and placing them in our collections of even more images: </font></font><br><br><img src="https://habrastorage.org/webt/x8/np/bq/x8npbqpkm9af1_ybkxhw13kjhug.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">After the "reset" work </font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">: </font></font><br><br><img src="https://habrastorage.org/webt/b2/lq/hb/b2lqhbg6smc2mvvvjp0copbvfmu.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As a result, our Image Gallery is filled with new images:</font></font><br><br><img src="https://habrastorage.org/webt/lf/jl/mq/lfjlmqca5iqv26l0woi-htqldcq.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now that it's clear that we are able to receive images OUTSIDE, we no longer need test images and we remove them: </font></font><br><br><img src="https://habrastorage.org/webt/bv/0t/az/bv0tazx3cjushm1rkcfalu-m1au.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Our </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">viewDidLoad</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> becomes very simple: in it we make ours </font></font><code>Controller</code> <code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">delegate and add the </font></font><b><font color="#FF00FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">pinch</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> gesture </font><b><font color="#FF00FF"><font style="vertical-align: inherit;">recognizer</font></font></b><font style="vertical-align: inherit;"> , which controls the number of images on the line: </font></font><br><br><img src="https://habrastorage.org/webt/ei/fo/1b/eifo1bz0szfk12tuqfseh5fser8.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Of course , we can add a cache for </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imageCache</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> images </font><font style="vertical-align: inherit;">: </font></font><br><br><img src="https://habrastorage.org/webt/f4/oi/ql/f4oiql_gjnka7racbmkrts7mbja.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We will fill </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imageCache</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> when ‚Äúreset‚Äù </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">performDrop</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> method </font><font style="vertical-align: inherit;">... </font></font><br><br><img src="https://habrastorage.org/webt/xy/hc/bt/xyhcbtodifjiqgd5norskny9cge.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and when sampling from the ‚Äúnetwork‚Äù in the custom </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ImageCollectionViewCell</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> class </font><font style="vertical-align: inherit;">: </font></font><br><br><img src="https://habrastorage.org/webt/nk/sl/2s/nksl2sw3dujz-_z7fmp55zixfzi.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">And </font><font style="vertical-align: inherit;">we will </font><font style="vertical-align: inherit;">use the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imageCache</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> cache </font><font style="vertical-align: inherit;">when playing the cell</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">cell of</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> our Image Gallery in user class</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ImageCollectionViewCell</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br><br><img src="https://habrastorage.org/webt/-5/ar/zo/-5arzoeghtoj_ckv-ezxhpu403c.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now we start with an empty collection ...</font></font><br><br><img src="https://habrastorage.org/webt/rl/bq/vn/rlbqvnpsww27j5xbryp9vlgng1a.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... then we "throw" a new image on our collection ...</font></font><br><br><img src="https://habrastorage.org/webt/9j/7o/es/9j7oesf_b-rk-dj-s9ysujlkte0.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... image loading takes place and it</font></font><code>Placeholder</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">works ...</font></font><br><br><img src="https://habrastorage.org/webt/tg/s7/6t/tgs76tffgkarqkpzhamq97ebvio.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... and the image appears in the right place:</font></font><br><br><img src="https://habrastorage.org/webt/ps/uy/z8/psuyz8apr4zpulpgpl5z-hsegfy.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">We continue to fill our collection OUTSIDE: It</font></font><br><br><img src="https://habrastorage.org/webt/it/ve/_y/itve_yuqqnffh8zyzlpmj_vvske.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">comes loading images and</font></font><code>Placeholders</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">working ...</font></font><br><br><img src="https://habrastorage.org/webt/li/rx/wd/lirxwd74znfsvgrtjkpg3gfvl8u.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">And images appear in the right place:</font></font><br><br><img src="https://habrastorage.org/webt/uq/j0/as/uqj0asiyqcpqosl8x-3akydb3x0.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">So, we can do a lot with our Image Gallery: fill it with EXTERNAL, reorganize the elements INSIDE, share images with other applications niyami.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">It remains for us to teach her to get rid of unnecessary images by "resetting" them.</font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in the trash can presented on the navigation bar on the right. </font><font style="vertical-align: inherit;">As described in the ‚ÄúImage Gallery‚Äù demo application features section, the trash can is represented by the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GabageView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> class </font><font style="vertical-align: inherit;">, which inherits from </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIView,</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and we have to teach it to take images from our collection </font></font><code>ollection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font><br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Reset </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Gallery images into the trash can.</font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Right off the bat - in the quarry. I will add a </font><font style="vertical-align: inherit;">‚Äúinteraction‚Äù </font><b><font color="#0000FF"><font style="vertical-align: inherit;">interaction</font></font></b><font style="vertical-align: inherit;"> to the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GabageView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and this will be a </font><b><font color="#0000FF"><font style="vertical-align: inherit;">UIDropInteraction</font></font></b><font style="vertical-align: inherit;"> , as I try to get a ‚Äúreset‚Äù of </font><font style="vertical-align: inherit;">some thing. All we have to provide this </font><b><font color="#0000FF"><font style="vertical-align: inherit;">UIDropInteraction</font></font></b><font style="vertical-align: inherit;"> is the delegate </font><b><font color="#0000FF"><font style="vertical-align: inherit;">delegate</font></font></b><font style="vertical-align: inherit;"> , and I‚Äôm going to assign myself, </font><b><font color="#0000FF"><font style="vertical-align: inherit;">self</font></font></b><font style="vertical-align: inherit;"> , to this delegate </font><b><font color="#0000FF"><font style="vertical-align: inherit;">delegate</font></font></b><font style="vertical-align: inherit;"> : </font><font style="vertical-align: inherit;">Naturally, our </font><b><font color="#0000FF"><font style="vertical-align: inherit;">GabageView</font></font></b><font style="vertical-align: inherit;"> class </font><font style="vertical-align: inherit;">must confirm that we are implementing the </font><b><font color="#0000FF"><font style="vertical-align: inherit;">UIDropInteractionDelegate</font></font></b><font style="vertical-align: inherit;"> protocol </font><font style="vertical-align: inherit;">: </font><font style="vertical-align: inherit;">All we need to do to make it work </font><font style="vertical-align: inherit;">, This is to implement the methods already known to us </font><b><font color="#0000FF"><font style="vertical-align: inherit;">canHandle</font></font></b><font style="vertical-align: inherit;"> ,</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"></font></font></b><font style="vertical-align: inherit;"></font><b><font color="#0000FF"><font style="vertical-align: inherit;"></font></font></b><font style="vertical-align: inherit;"></font><code>Drop</code><font style="vertical-align: inherit;"></font><b><font color="#0000FF"><font style="vertical-align: inherit;"></font></font></b><font style="vertical-align: inherit;"></font><b><font color="#0000FF"><font style="vertical-align: inherit;"></font></font></b><font style="vertical-align: inherit;"></font><b><font color="#0000FF"><font style="vertical-align: inherit;"></font></font></b><font style="vertical-align: inherit;"></font><b><font color="#0000FF"><font style="vertical-align: inherit;"></font></font></b><font style="vertical-align: inherit;"></font><br><br><img src="https://habrastorage.org/webt/mm/tq/xn/mmtqxnmypbysaik9fjd3r2amrlg.png"><br><br><font style="vertical-align: inherit;"></font><b><font color="#0000FF"><font style="vertical-align: inherit;"></font></font></b><font style="vertical-align: inherit;"></font><b><font color="#0000FF"><font style="vertical-align: inherit;"></font></font></b><font style="vertical-align: inherit;"></font><br><br><img src="https://habrastorage.org/webt/nv/xy/vw/nvxyvwya12ggtiznb1byxq5vorm.png"><br><br><font style="vertical-align: inherit;"></font><code>Drop</code><font style="vertical-align: inherit;"></font><b><font color="#0000FF"><font style="vertical-align: inherit;"></font></font></b><font style="vertical-align: inherit;"></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sessionDidUpdate</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> performDrop</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><img src="https://habrastorage.org/webt/jg/m9/ol/jgm9olzkrnv_fmu0mwesx91dvsq.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">However, unlike similar methods for the collection</font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, we do not have any additional information in the form of the</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> drop-</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> point</font><b><font color="#0000FF"><font style="vertical-align: inherit;"> indexPath</font></font></b><font style="vertical-align: inherit;"> .</font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let's implement these methods.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Inside the</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> canHandle</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> method</font><font style="vertical-align: inherit;">, only ‚Äúdrag and drop‚Äù will be processed</font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, which are</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> UIImage</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> images</font><font style="vertical-align: inherit;">. Therefore, I will return</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> true</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> only if</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> session.canLoadObjects (ofClass: UIImage.self)</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br><br><img src="https://habrastorage.org/webt/if/z7/yo/ifz7yoibzsugla3mj7kat1cylt8.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In the</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> canHandle</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> method</font><b><font color="#0000FF"><font style="vertical-align: inherit;"> ,</font></font></b><font style="vertical-align: inherit;"> in essence, you simply report that if the "drag and drop" object is not a</font><b><font color="#0000FF"><font style="vertical-align: inherit;"> UIImage</font></font></b><font style="vertical-align: inherit;"> image</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">then it does not make sense to continue dropping the Drop and invoking subsequent methods. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If the "drag and drop" object is a </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIImage</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> image </font><font style="vertical-align: inherit;">, then we will execute the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sessionDidUpdate</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> method </font><font style="vertical-align: inherit;">. All we need to do in this method is to return our </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">reset request</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to </font><b><font color="#0000FF"><font style="vertical-align: inherit;">UIDropProposal</font></font></b></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . And I am ready to accept only the ‚Äúdrag and drop‚Äù LOCALLY object of the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIImage</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> image </font><b><font color="#0000FF"><font style="vertical-align: inherit;">TYPE</font></font></b><font style="vertical-align: inherit;"> , which can be ‚Äúdumped‚Äù </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">anywhere inside my </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GarbageView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . My </font></font><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GarbageView</font></font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> will not interact with images dumped EXIT. Therefore, I analyze using the variable </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">session.localDragSession</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, whether there is a local ‚Äúdrop‚Äù </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, and return the ‚Äúreset‚Äù clause in the form of the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIDropProposal</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> constructor </font><font style="vertical-align: inherit;">with the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">operation</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> argument set </font><font style="vertical-align: inherit;">to </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.copy</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , because ALWAYS LOCAL drag and drop </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in my application will come from the collection </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. If there is a ‚Äúdrag </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and </font><font style="vertical-align: inherit;">drop‚Äù </font><font style="vertical-align: inherit;">and ‚Äúreset‚Äù </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">OUTSIDE, then I return the ‚Äúreset‚Äù clause in the form of the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIDropProposal</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> constructor </font><font style="vertical-align: inherit;">with the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">operation</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> argument set </font><font style="vertical-align: inherit;">to </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.fobbiden</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , that is, ‚Äúforbidden‚Äù and we will get the sign of the ‚Äúreset‚Äù prohibition instead of the green plus sign . </font></font><br><br><img src="https://habrastorage.org/webt/ii/vd/wy/iivdwy9av6cxwzjkeay9kf87lby.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Copying </font><b><font color="#0000FF"><font style="vertical-align: inherit;">UIImage</font></font></b><font style="vertical-align: inherit;"> image</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, we will simulate reducing its scale to almost 0, and when the ‚Äúreset‚Äù happens, we will remove this image from the collection </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In order to create the illusion of ‚Äúdiscarding and disappearing‚Äù images in the ‚Äútrash can‚Äù for the user, we use the new </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">previewForDropping</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> method for us </font><font style="vertical-align: inherit;">, which allows redirecting the ‚Äúdumping‚Äù </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to another place and at the same time transforming the ‚Äúdiscarded‚Äù object during animation: </font></font><br><br><img src="https://habrastorage.org/webt/e7/ej/zb/e7ejzbhlfzjxrkxsjupt9hiewz4.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> With this method, using the initializer </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIDragPreviewTarget,</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> we will get a new </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">preView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> for the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">target</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> object to be dropped </font><font style="vertical-align: inherit;">and redirect it using the </font><b><font color="#0000FF"><font style="vertical-align: inherit;">retargetedPreview</font></font></b><font style="vertical-align: inherit;"> method </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">to a new place, to the ‚Äútrash can‚Äù, with its scale decreasing to almost zero: </font></font><br><br><img src="https://habrastorage.org/webt/bu/zp/av/buzpavo-rn6n2eoeztccvman6r0.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If the user lifted his finger up, then a ‚Äúreset‚Äù occurs </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, and I (like </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GarbageView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ) receive the message </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">performDrop</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . In the message </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">performDrop</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> we perform the actual "reset" </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. Honestly, the </font><font style="vertical-align: inherit;">image </font><font style="vertical-align: inherit;">itself, discarded on the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GarbageView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , no longer interests us, since we will make it almost invisible, most likely the fact that the ‚Äúreset‚Äù is complete </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">will signal that we remove this image from the collection </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. In order to do this, we need to know the collection itself </font><font style="vertical-align: inherit;">and </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">collection</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dumped image in it. Where can we get them from? </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Because the process </font></font><code>Drag &amp; Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">takes place in a single application, it is available to us all the local: local </font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">session </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localDragSession</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> our </font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">session </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the session</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , the local context </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localContext</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , which is our collection of </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">sollectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and local object </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localObject</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , which we can do by itself is reset image </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">image</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> from "Gallery" or </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">indexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Because of this we can get in the method </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">performDrop</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> class </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">GarbageView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> collection </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">collection</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and using it</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dataSource</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> how</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ImageGalleryCollectionViewController</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and Model</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> imageGallery</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> our</font></font><code>Controller</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, we can get an array of images of</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> images</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> TYPE [ImageModel]:</font></font><br><br><img src="https://habrastorage.org/webt/3t/tj/kr/3ttjkr1cuyqxh4v3islcmsofjhy.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">With the help of the local</font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">session</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> localDragSession</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> our</font></font><code>Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">session</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> session</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> we were able to get all the "drag" on</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> GarbageView</font></font></font></b> <code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> elements of</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> items</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and there may be a lot, as we know, and all of them are images of our</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> collectionView collection</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Creating the</font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">elements of</font><font style="vertical-align: inherit;">our collection's</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dragItems</font></font></font></b><font style="vertical-align: inherit;"></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , we provided for each ‚Äúovertightened‚Äù</font></font><code>Drag</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">element.</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">dragItem</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> local object</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> localObject</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , who is the image of</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> image</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , but it is we do not come in handy during internal reorganization collection</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> CollectionView</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , but the "reset" Image Galleries "trash can" we desperately need in the local facility</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> localObject</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> "drag" object</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dragItem</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , after all this time we do not have a coordinator</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> coordinator</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> who so generously shares information about what is happening in the collectionView</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> collection</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Therefore, we want the local object</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> localObject to</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> be the</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> indexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in the image array</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> images of</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> our Model</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imageGallery</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . Make the necessary changes in the method</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> dragItems (at indexPath: IndexPath)</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> class</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ImageGalleryCollectionViewController</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> :</font></font><br><br><img src="https://habrastorage.org/webt/le/iy/hz/leiyhzxv04brlhk6nlhpakw4bek.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now we can take every "pretaskivaemogo" element</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> item</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> it</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> localObject</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , which is the index</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> indexPath</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> in the image array</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> images</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> of our models</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> imagegallery</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , and send it to the array indexes</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> indexes</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and array</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> indexPahes</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> delete images:</font></font><br><br><img src="https://habrastorage.org/webt/ci/cf/uo/cicfuo7gxvbmh7ddvjj2maorfog.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Knowing the index array</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> indexes</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and array</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> indexPahes</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> delete images in the method</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> performBatchUpdates</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">collection </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">collection</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> we remove all deleted images from Models </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">images</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and from the collection of </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">collection</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/2t/49/i4/2t49i4wwgqlz-vqqpalim8m4h4u.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Run the application, fill the gallery with new images: </font></font><br><br><img src="https://habrastorage.org/webt/vj/kb/v5/vjkbv5nwenjhacglkmksbto5jh0.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Select a pair of images that we want to remove from our gallery ... </font></font><br><br><img src="https://habrastorage.org/webt/cm/-e/t1/cm-et1fd2cp7pext2src2vddkmm.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... "throw" them on the icon with the "garbage bin" ... </font></font><br><br><img src="https://habrastorage.org/webt/yw/l3/ue/ywl3ue6tusekuyqvpjv3n4pn1xy.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">They reduced almost to 0 ... </font></font><br><br><img src="https://habrastorage.org/webt/14/6r/nd/146rndccir7ou4z5zitpj9gv4ek.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... and disappear from the collection </font></font><code>Collection View</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, hiding in the "garbage can":</font></font><br><br><img src="https://habrastorage.org/webt/1x/b_/zw/1xb_zw27xn-2yp7lb7tvlpgm_fc.png"><br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Saving images between runs. </font></font></h1><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To save the Gallery of images between launches, we will use </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserDefaults</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , first converting our Model into a </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">format. To do this, we add </font><b><font color="#0000FF"><font style="vertical-align: inherit;">var defailts</font></font></b><font style="vertical-align: inherit;"> ... </font><font style="vertical-align: inherit;">... </font><font style="vertical-align: inherit;">to our </font></font><code>Controller</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">variable </font><font style="vertical-align: inherit;">, </font><font style="vertical-align: inherit;">and the </font><b><font color="#0000FF"><font style="vertical-align: inherit;">Codable</font></font></b><font style="vertical-align: inherit;"> protocol </font><font style="vertical-align: inherit;">in the </font><b><font color="#0000FF"><font style="vertical-align: inherit;">ImageGallery</font></font></b><font style="vertical-align: inherit;"> and </font><b><font color="#0000FF"><font style="vertical-align: inherit;">ImageModel </font></font></b><b><font color="#0000FF"><font style="vertical-align: inherit;">structures</font></font></b><font style="vertical-align: inherit;"> : </font><b><font color="#0000FF"><font style="vertical-align: inherit;">String</font></font></b><font style="vertical-align: inherit;"> strings </font><font style="vertical-align: inherit;">, </font><b><font color="#0000FF"><font style="vertical-align: inherit;">Array</font></font></b><font style="vertical-align: inherit;"> , </font><b><font color="#0000FF"><font style="vertical-align: inherit;">URL</font></font></b><font style="vertical-align: inherit;"> and </font><b><font color="#0000FF"><font style="vertical-align: inherit;">Double</font></font></b><font style="vertical-align: inherit;"> arrays </font><font style="vertical-align: inherit;">already implement the </font><b><font color="#0000FF"><font style="vertical-align: inherit;">Codable</font></font></b><font style="vertical-align: inherit;"> protocol </font><font style="vertical-align: inherit;">, so we don‚Äôt have to do anything else to make the encoding work and decoding for the ImageGallery </font><b><font color="#0000FF"><font style="vertical-align: inherit;">model</font></font></b><font style="vertical-align: inherit;"> in the </font><font style="vertical-align: inherit;">format.</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"></font></font></b><font style="vertical-align: inherit;"></font><br><br><img src="https://habrastorage.org/webt/wy/cg/vy/wycgvy5krdrmfiugzp9dgykaphe.png"><br><br><font style="vertical-align: inherit;"></font><b><font color="#0000FF"><font style="vertical-align: inherit;"></font></font></b><font style="vertical-align: inherit;"></font><b><font color="#0000FF"><font style="vertical-align: inherit;"></font></font></b><font style="vertical-align: inherit;"></font><b><font color="#0000FF"><font style="vertical-align: inherit;"></font></font></b><font style="vertical-align: inherit;"></font><br><br><img src="https://habrastorage.org/webt/j2/vv/w6/j2vvw62tiuud6eidtx1n9ipeq0w.png"><br><br><font style="vertical-align: inherit;"></font><b><font color="#0000FF"><font style="vertical-align: inherit;"></font></font></b><font style="vertical-align: inherit;"></font><b><font color="#0000FF"><font style="vertical-align: inherit;"></font></font></b><font style="vertical-align: inherit;"></font><b><font color="#0000FF"><font style="vertical-align: inherit;"></font></font></b><font style="vertical-align: inherit;"></font><b><font color="#0000FF"><font style="vertical-align: inherit;"></font></font></b><font style="vertical-align: inherit;"></font><b><font color="#0000FF"><font style="vertical-align: inherit;"></font></font></b><font style="vertical-align: inherit;"></font><b><font color="#0000FF"><font style="vertical-align: inherit;"></font></font></b><font style="vertical-align: inherit;"></font><code>JSON</code><font style="vertical-align: inherit;"></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">How do we get a </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">version of </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ImageGallery</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ? </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To do this, we create a calculated variable </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">var json</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , which returns the result of an attempt to convert itself, </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , using </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JSONEncoder.encode ()</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to the </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">format: </font></font><br><br><img src="https://habrastorage.org/webt/f6/o3/hz/f6o3hzee-7hryaxadmzf--0jeym.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">And that is all. Either </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Data</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> data will be returned </font><font style="vertical-align: inherit;">as a result of the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> conversion </font><font style="vertical-align: inherit;">to the format </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, or </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nil</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> if this conversion cannot be performed, although the latter never happens because this TYPE is 100% </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Encodable</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . The </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Optional </font></font></font></b><font style="vertical-align: inherit;"></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">json</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> variable is used </font><font style="vertical-align: inherit;">simply for symmetry reasons.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now we have a way to convert the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ImageGallery model</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> to the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Data</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> format </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. At the same time </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">json</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> variable </font><font style="vertical-align: inherit;">has TYPE </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Data?</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> which can be memorized in </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserDefaults</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now imagine that somehow we managed to get </font><b><font color="#0000FF"><font style="vertical-align: inherit;">json</font></font></b></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> data </font><font style="vertical-align: inherit;">, and I would like to recreate our Model, an instance of the </font><b><font color="#0000FF"><font style="vertical-align: inherit;">ImageGallery</font></font></b><font style="vertical-align: inherit;"> structure, from them </font><font style="vertical-align: inherit;">. To do this, it is very easy to write an INITIALIZER for </font><b><font color="#0000FF"><font style="vertical-align: inherit;">ImageGallery</font></font></b><font style="vertical-align: inherit;"> , whose input argument is </font><b><font color="#0000FF"><font style="vertical-align: inherit;">json</font></font></b><font style="vertical-align: inherit;"> data </font><font style="vertical-align: inherit;">. This initializer will be a ‚Äúfalling‚Äù initializer (</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"></font></font></b><font style="vertical-align: inherit;"></font><b><font color="#0000FF"><font style="vertical-align: inherit;"></font></font></b><font style="vertical-align: inherit;"></font><b><font color="#0000FF"><font style="vertical-align: inherit;"></font></font></b><font style="vertical-align: inherit;"></font><code>JSON</code><font style="vertical-align: inherit;"></font><b><font color="#0000FF"><font style="vertical-align: inherit;"></font></font></b><font style="vertical-align: inherit;"></font><code>failable</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">). If it fails to initialize, then it ‚Äúfalls‚Äù and returns </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nil</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/g7/0n/l4/g70nl4mxpadtrajaq7y-ec4f6bw.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I just get the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">newValue</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> value </font><font style="vertical-align: inherit;">using the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">JSONDecoder</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> decoder </font><font style="vertical-align: inherit;">, trying to decode the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">json</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> data </font><font style="vertical-align: inherit;">that is sent to my initializer, and then assign it to </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">self</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If I managed to do this, then I get a new instance of </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">ImageGallery</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , but if my attempt fails, then I return </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">nil</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> , because my initialization failed. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">I must say that here we have a lot more reasons to ‚Äúfail‚Äù ( </font></font><code>fail</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), because it is quite possible that the </font><b><font color="#0000FF"><font style="vertical-align: inherit;">json</font></font></b></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> data</font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">may be corrupted or empty, all of which can lead to the ‚Äúfall‚Äù ( </font></font><code>fail</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">) of the initializer. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Now we can implement the READ </font></font><code>JSON</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">data and recovery model </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imagegallery</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> the method </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">viewWillAppear</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> our </font></font><code>Controller</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... </font></font><br><br><img src="https://habrastorage.org/webt/gw/n2/u-/gwn2u-zkggggk2vuwfi-czhycdq.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">... as well as an entry in the observer </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">didSet {}</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> properties </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">imagegallery</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> : </font></font><br><br><img src="https://habrastorage.org/webt/-g/bc/yz/-gbcyzh4t5innabrtcbxdmdh3wq.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let's run the application and fill our gallery of images: </font></font><br><br><img src="https://habrastorage.org/webt/le/t5/wr/let5wryw9nwf-ahnij7f_wltztc.png"><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If we close the application and open it again, we can see our previous gallery images, which is stored in </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UserDefaults</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Conclusion </font></font></h1><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In this article, using the example of a very simple demo of the Gallery of images, it is shown how easy it is to embed technology </font></font><code>Drag &amp; Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">in an </font></font><code>iOS</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">application. This allowed us to fully edit the Gallery of Images, "throwing" there new images from other applications, moving existing ones and removing unnecessary ones. And also distribute images accumulated in the Gallery to other applications. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Of course, we would like to create many such thematic pictorial collections of images and save them directly on the iPad or on iCloud Drive. This can be done if each such Gallery is interpreted as a permanently stored </font><b><font color="#0000FF"><font style="vertical-align: inherit;">UIDocument</font></font></b><font style="vertical-align: inherit;"> document </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">.</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">This interpretation will allow us to rise to the next level of abstraction and create an application that works with documents. </font><font style="vertical-align: inherit;">In such an application, your documents will be shown by the </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">DocumentBrowserViewController</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> component </font><font style="vertical-align: inherit;">, which is very similar to the application </font></font><code>Files</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">It allows you to create </font></font><b><font color="#0000FF"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">UIDocument</font></font></font></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> documents </font><font style="vertical-align: inherit;">of the ‚ÄúGallery of Images‚Äù type both on your </font></font><code>iPad</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and on </font></font><code>iCloud Drive</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">, as well as select the necessary document for viewing and editing. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">But this is the subject of the next article. </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PS The code of the demo application before the implementation of the mechanism </font></font><code>Drag &amp; Drop</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">and after is on </font></font><b><a href="https://github.com/BestKora/Article-Drag-Drop"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Github</font></font></a></b><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><br></div><p>Source: <a href="https://habr.com/ru/post/425817/">https://habr.com/ru/post/425817/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../425807/index.html">The complexity of the systems and methods of "struggle" with it</a></li>
<li><a href="../425809/index.html">Learn programming languages ‚Äã‚Äãin the process: software developer about complex projects</a></li>
<li><a href="../425811/index.html">Another problem with MacBook Pro displays</a></li>
<li><a href="../425813/index.html">CICD: Seamless Deploy on Distributed Cluster Systems without Downtime</a></li>
<li><a href="../425815/index.html">Who does not need SEO, how to choose an optimizer and check its work</a></li>
<li><a href="../425819/index.html">GitLab 11.3 released with Maven repository and protected environments</a></li>
<li><a href="../425821/index.html">How to become a React developer in 2018</a></li>
<li><a href="../425823/index.html">IPO 2018 statistics: attracted $ 45 billion, Dropbox raised less money than pharmaceutical companies and real estate sellers</a></li>
<li><a href="../425825/index.html">How I created an online casino</a></li>
<li><a href="../425827/index.html">Google+ lesson: projects should be monitored so that the boundaries between the interests of users in real life are respected and online</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>