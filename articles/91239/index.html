<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Java assembler, meta-programming and JPA</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="In this topic I want to share the first experience on writing a code generation system on the fly. The code implements some of the ideas described in ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Java assembler, meta-programming and JPA</h1><div class="post__text post__text-html js-mediator-article">  In this topic I want to share the first experience on writing a code generation system on the fly.  The code implements some of the ideas described <a href="http://habrahabr.ru/blogs/java/90528/">in the previous topic</a> , and the code itself is used in one old, but working <a href="https://sourceforge.net/projects/arpsite/">site management system</a> . <br><br>  Brief statement of the problem: <br><ul><li>  There is a set of virtual "classes" in the concept of a business user.  For example, ‚Äúsite‚Äù, ‚Äúfolder‚Äù, ‚Äúnews‚Äù, etc.  Each of these classes has a set of fields (attributes). </li><li>  So far, we have no class inheritance, and the fields are limited to primitive String / Integer / Long / Enum / Boolean, even without multiple, but with possible default values </li><li>  Each class is recorded in a separate table, for example, objects_sites, objects_news, objects_folder, etc.  The table always contains the object ID, as well as columns for fields. </li><li>  We need to make the download of these objects work through JPA (Hibernate), using the necessary caching / transactions / Lazy-loading and other goodies that JPA gives us. </li></ul><br>  To perform this task was used: <br><ul><li>  As databases - MySQL 5.0, InnoDB, three database schemas (different types may lie in different schemes to separate system types from user ones) </li><li>  Sun JDK 6.0 </li><li>  <a href="http://tomcat.apache.org/tomcat-6.0-doc/">Tomcat 6</a> + <a href="http://wiki.jotm.ow2.org/xwiki/bin/view/News/JOTM_2_1_9">JOTM 2.1.9</a> + <a href="http://in.relation.to/Bloggers/Hibernate350FinalRelease">Hibernate 3.5.0-Final</a> ( <a href="http://arpsite.svn.sourceforge.net/viewvc/arpsite/trunk/modules/bundles/hibernate-core-patched/">patched</a> ) </li><li>  To create classes, we used a bunch of <a href="http://cglib.sourceforge.net/">CGLib 2.2</a> (included in Hibernate) and <a href="http://asm.ow2.org/">ASM 3.2</a> (Hibernate includes 3.1) </li></ul><br><a name="habracut"></a><br><h5>  Metamodel </h5><br>  Where to begin.  It all starts with the construction of the object meta-model (not to be confused with the business model).  So far it has been decided to dwell on the following model: <br><pre> - Configuration (complex types)
 - Type
  - Simple Type (simpletypetype - string / long / int / enum, enum class)
  - ComplexType (attributes, some properties)
 - Attribute (name, type, some properties, some JPA properties)
</pre><br>  At the same time, for testing and, in general, for beauty, a class was made that allows building this configuration from XML Schema (the ideology of which was taken as the basis).  For example from this: <br> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="utf-8"</font> ? <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:schema</font> <font color="#ff0000">xmlns:xs</font> <font color="#0000ff">="http://www.w3.org/2001/XMLSchema"</font> <font color="#ff0000">xmlns:meta</font> <font color="#0000ff">="http://www.arptek.ru/core/meta"</font> <font color="#ff0000">targetNamespace</font> <font color="#0000ff">="http://www.arptek.ru/core/meta/test"</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:complexType</font> <font color="#ff0000">name</font> <font color="#0000ff">="Test"</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:annotation</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:appinfo</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">meta:java.interface</font> <font color="#0000ff">&gt;</font> ru.arptek.meta.SomeInterface <font color="#0000ff">&lt;/</font> <font color="#800000">meta:java.interface</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:appinfo</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:annotation</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:sequence</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="id"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:int"</font> <font color="#ff0000">meta:jpa</font> . <font color="#ff0000">Id</font> <font color="#0000ff">="true"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="string"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:string"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="boolean"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:boolean"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="integer"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:int"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="long"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:long"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:sequence</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:complexType</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:schema</font> <font color="#0000ff">&gt;</font> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> <blockquote><ol><li> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="utf-8"</font> ? <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:schema</font> <font color="#ff0000">xmlns:xs</font> <font color="#0000ff">="http://www.w3.org/2001/XMLSchema"</font> <font color="#ff0000">xmlns:meta</font> <font color="#0000ff">="http://www.arptek.ru/core/meta"</font> <font color="#ff0000">targetNamespace</font> <font color="#0000ff">="http://www.arptek.ru/core/meta/test"</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:complexType</font> <font color="#ff0000">name</font> <font color="#0000ff">="Test"</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:annotation</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:appinfo</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">meta:java.interface</font> <font color="#0000ff">&gt;</font> ru.arptek.meta.SomeInterface <font color="#0000ff">&lt;/</font> <font color="#800000">meta:java.interface</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:appinfo</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:annotation</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:sequence</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="id"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:int"</font> <font color="#ff0000">meta:jpa</font> . <font color="#ff0000">Id</font> <font color="#0000ff">="true"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="string"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:string"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="boolean"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:boolean"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="integer"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:int"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="long"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:long"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:sequence</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:complexType</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:schema</font> <font color="#0000ff">&gt;</font> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> </li> <li> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="utf-8"</font> ? <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:schema</font> <font color="#ff0000">xmlns:xs</font> <font color="#0000ff">="http://www.w3.org/2001/XMLSchema"</font> <font color="#ff0000">xmlns:meta</font> <font color="#0000ff">="http://www.arptek.ru/core/meta"</font> <font color="#ff0000">targetNamespace</font> <font color="#0000ff">="http://www.arptek.ru/core/meta/test"</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:complexType</font> <font color="#ff0000">name</font> <font color="#0000ff">="Test"</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:annotation</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:appinfo</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">meta:java.interface</font> <font color="#0000ff">&gt;</font> ru.arptek.meta.SomeInterface <font color="#0000ff">&lt;/</font> <font color="#800000">meta:java.interface</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:appinfo</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:annotation</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:sequence</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="id"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:int"</font> <font color="#ff0000">meta:jpa</font> . <font color="#ff0000">Id</font> <font color="#0000ff">="true"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="string"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:string"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="boolean"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:boolean"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="integer"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:int"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="long"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:long"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:sequence</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:complexType</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:schema</font> <font color="#0000ff">&gt;</font> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> </li> <li> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="utf-8"</font> ? <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:schema</font> <font color="#ff0000">xmlns:xs</font> <font color="#0000ff">="http://www.w3.org/2001/XMLSchema"</font> <font color="#ff0000">xmlns:meta</font> <font color="#0000ff">="http://www.arptek.ru/core/meta"</font> <font color="#ff0000">targetNamespace</font> <font color="#0000ff">="http://www.arptek.ru/core/meta/test"</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:complexType</font> <font color="#ff0000">name</font> <font color="#0000ff">="Test"</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:annotation</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:appinfo</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">meta:java.interface</font> <font color="#0000ff">&gt;</font> ru.arptek.meta.SomeInterface <font color="#0000ff">&lt;/</font> <font color="#800000">meta:java.interface</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:appinfo</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:annotation</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:sequence</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="id"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:int"</font> <font color="#ff0000">meta:jpa</font> . <font color="#ff0000">Id</font> <font color="#0000ff">="true"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="string"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:string"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="boolean"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:boolean"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="integer"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:int"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="long"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:long"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:sequence</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:complexType</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:schema</font> <font color="#0000ff">&gt;</font> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> </li> <li></li><li> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="utf-8"</font> ? <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:schema</font> <font color="#ff0000">xmlns:xs</font> <font color="#0000ff">="http://www.w3.org/2001/XMLSchema"</font> <font color="#ff0000">xmlns:meta</font> <font color="#0000ff">="http://www.arptek.ru/core/meta"</font> <font color="#ff0000">targetNamespace</font> <font color="#0000ff">="http://www.arptek.ru/core/meta/test"</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:complexType</font> <font color="#ff0000">name</font> <font color="#0000ff">="Test"</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:annotation</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:appinfo</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">meta:java.interface</font> <font color="#0000ff">&gt;</font> ru.arptek.meta.SomeInterface <font color="#0000ff">&lt;/</font> <font color="#800000">meta:java.interface</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:appinfo</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:annotation</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:sequence</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="id"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:int"</font> <font color="#ff0000">meta:jpa</font> . <font color="#ff0000">Id</font> <font color="#0000ff">="true"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="string"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:string"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="boolean"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:boolean"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="integer"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:int"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="long"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:long"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:sequence</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:complexType</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:schema</font> <font color="#0000ff">&gt;</font> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> </li> <li> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="utf-8"</font> ? <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:schema</font> <font color="#ff0000">xmlns:xs</font> <font color="#0000ff">="http://www.w3.org/2001/XMLSchema"</font> <font color="#ff0000">xmlns:meta</font> <font color="#0000ff">="http://www.arptek.ru/core/meta"</font> <font color="#ff0000">targetNamespace</font> <font color="#0000ff">="http://www.arptek.ru/core/meta/test"</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:complexType</font> <font color="#ff0000">name</font> <font color="#0000ff">="Test"</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:annotation</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:appinfo</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">meta:java.interface</font> <font color="#0000ff">&gt;</font> ru.arptek.meta.SomeInterface <font color="#0000ff">&lt;/</font> <font color="#800000">meta:java.interface</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:appinfo</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:annotation</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:sequence</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="id"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:int"</font> <font color="#ff0000">meta:jpa</font> . <font color="#ff0000">Id</font> <font color="#0000ff">="true"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="string"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:string"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="boolean"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:boolean"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="integer"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:int"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="long"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:long"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:sequence</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:complexType</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:schema</font> <font color="#0000ff">&gt;</font> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> </li> <li> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="utf-8"</font> ? <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:schema</font> <font color="#ff0000">xmlns:xs</font> <font color="#0000ff">="http://www.w3.org/2001/XMLSchema"</font> <font color="#ff0000">xmlns:meta</font> <font color="#0000ff">="http://www.arptek.ru/core/meta"</font> <font color="#ff0000">targetNamespace</font> <font color="#0000ff">="http://www.arptek.ru/core/meta/test"</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:complexType</font> <font color="#ff0000">name</font> <font color="#0000ff">="Test"</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:annotation</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:appinfo</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">meta:java.interface</font> <font color="#0000ff">&gt;</font> ru.arptek.meta.SomeInterface <font color="#0000ff">&lt;/</font> <font color="#800000">meta:java.interface</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:appinfo</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:annotation</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:sequence</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="id"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:int"</font> <font color="#ff0000">meta:jpa</font> . <font color="#ff0000">Id</font> <font color="#0000ff">="true"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="string"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:string"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="boolean"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:boolean"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="integer"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:int"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="long"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:long"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:sequence</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:complexType</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:schema</font> <font color="#0000ff">&gt;</font> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> </li> <li> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="utf-8"</font> ? <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:schema</font> <font color="#ff0000">xmlns:xs</font> <font color="#0000ff">="http://www.w3.org/2001/XMLSchema"</font> <font color="#ff0000">xmlns:meta</font> <font color="#0000ff">="http://www.arptek.ru/core/meta"</font> <font color="#ff0000">targetNamespace</font> <font color="#0000ff">="http://www.arptek.ru/core/meta/test"</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:complexType</font> <font color="#ff0000">name</font> <font color="#0000ff">="Test"</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:annotation</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:appinfo</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">meta:java.interface</font> <font color="#0000ff">&gt;</font> ru.arptek.meta.SomeInterface <font color="#0000ff">&lt;/</font> <font color="#800000">meta:java.interface</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:appinfo</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:annotation</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:sequence</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="id"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:int"</font> <font color="#ff0000">meta:jpa</font> . <font color="#ff0000">Id</font> <font color="#0000ff">="true"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="string"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:string"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="boolean"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:boolean"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="integer"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:int"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="long"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:long"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:sequence</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:complexType</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:schema</font> <font color="#0000ff">&gt;</font> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> </li> <li> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="utf-8"</font> ? <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:schema</font> <font color="#ff0000">xmlns:xs</font> <font color="#0000ff">="http://www.w3.org/2001/XMLSchema"</font> <font color="#ff0000">xmlns:meta</font> <font color="#0000ff">="http://www.arptek.ru/core/meta"</font> <font color="#ff0000">targetNamespace</font> <font color="#0000ff">="http://www.arptek.ru/core/meta/test"</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:complexType</font> <font color="#ff0000">name</font> <font color="#0000ff">="Test"</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:annotation</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:appinfo</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">meta:java.interface</font> <font color="#0000ff">&gt;</font> ru.arptek.meta.SomeInterface <font color="#0000ff">&lt;/</font> <font color="#800000">meta:java.interface</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:appinfo</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:annotation</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:sequence</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="id"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:int"</font> <font color="#ff0000">meta:jpa</font> . <font color="#ff0000">Id</font> <font color="#0000ff">="true"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="string"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:string"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="boolean"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:boolean"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="integer"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:int"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="long"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:long"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:sequence</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:complexType</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:schema</font> <font color="#0000ff">&gt;</font> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> </li> <li> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="utf-8"</font> ? <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:schema</font> <font color="#ff0000">xmlns:xs</font> <font color="#0000ff">="http://www.w3.org/2001/XMLSchema"</font> <font color="#ff0000">xmlns:meta</font> <font color="#0000ff">="http://www.arptek.ru/core/meta"</font> <font color="#ff0000">targetNamespace</font> <font color="#0000ff">="http://www.arptek.ru/core/meta/test"</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:complexType</font> <font color="#ff0000">name</font> <font color="#0000ff">="Test"</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:annotation</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:appinfo</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">meta:java.interface</font> <font color="#0000ff">&gt;</font> ru.arptek.meta.SomeInterface <font color="#0000ff">&lt;/</font> <font color="#800000">meta:java.interface</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:appinfo</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:annotation</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:sequence</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="id"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:int"</font> <font color="#ff0000">meta:jpa</font> . <font color="#ff0000">Id</font> <font color="#0000ff">="true"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="string"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:string"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="boolean"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:boolean"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="integer"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:int"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="long"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:long"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:sequence</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:complexType</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:schema</font> <font color="#0000ff">&gt;</font> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> </li> <li> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="utf-8"</font> ? <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:schema</font> <font color="#ff0000">xmlns:xs</font> <font color="#0000ff">="http://www.w3.org/2001/XMLSchema"</font> <font color="#ff0000">xmlns:meta</font> <font color="#0000ff">="http://www.arptek.ru/core/meta"</font> <font color="#ff0000">targetNamespace</font> <font color="#0000ff">="http://www.arptek.ru/core/meta/test"</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:complexType</font> <font color="#ff0000">name</font> <font color="#0000ff">="Test"</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:annotation</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:appinfo</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">meta:java.interface</font> <font color="#0000ff">&gt;</font> ru.arptek.meta.SomeInterface <font color="#0000ff">&lt;/</font> <font color="#800000">meta:java.interface</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:appinfo</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:annotation</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:sequence</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="id"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:int"</font> <font color="#ff0000">meta:jpa</font> . <font color="#ff0000">Id</font> <font color="#0000ff">="true"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="string"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:string"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="boolean"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:boolean"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="integer"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:int"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="long"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:long"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:sequence</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:complexType</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:schema</font> <font color="#0000ff">&gt;</font> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> </li> <li> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="utf-8"</font> ? <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:schema</font> <font color="#ff0000">xmlns:xs</font> <font color="#0000ff">="http://www.w3.org/2001/XMLSchema"</font> <font color="#ff0000">xmlns:meta</font> <font color="#0000ff">="http://www.arptek.ru/core/meta"</font> <font color="#ff0000">targetNamespace</font> <font color="#0000ff">="http://www.arptek.ru/core/meta/test"</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:complexType</font> <font color="#ff0000">name</font> <font color="#0000ff">="Test"</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:annotation</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:appinfo</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">meta:java.interface</font> <font color="#0000ff">&gt;</font> ru.arptek.meta.SomeInterface <font color="#0000ff">&lt;/</font> <font color="#800000">meta:java.interface</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:appinfo</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:annotation</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:sequence</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="id"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:int"</font> <font color="#ff0000">meta:jpa</font> . <font color="#ff0000">Id</font> <font color="#0000ff">="true"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="string"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:string"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="boolean"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:boolean"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="integer"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:int"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="long"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:long"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:sequence</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:complexType</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:schema</font> <font color="#0000ff">&gt;</font> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> </li> <li></li><li> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="utf-8"</font> ? <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:schema</font> <font color="#ff0000">xmlns:xs</font> <font color="#0000ff">="http://www.w3.org/2001/XMLSchema"</font> <font color="#ff0000">xmlns:meta</font> <font color="#0000ff">="http://www.arptek.ru/core/meta"</font> <font color="#ff0000">targetNamespace</font> <font color="#0000ff">="http://www.arptek.ru/core/meta/test"</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:complexType</font> <font color="#ff0000">name</font> <font color="#0000ff">="Test"</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:annotation</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:appinfo</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">meta:java.interface</font> <font color="#0000ff">&gt;</font> ru.arptek.meta.SomeInterface <font color="#0000ff">&lt;/</font> <font color="#800000">meta:java.interface</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:appinfo</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:annotation</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:sequence</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="id"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:int"</font> <font color="#ff0000">meta:jpa</font> . <font color="#ff0000">Id</font> <font color="#0000ff">="true"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="string"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:string"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="boolean"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:boolean"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="integer"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:int"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="long"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:long"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:sequence</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:complexType</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:schema</font> <font color="#0000ff">&gt;</font> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> </li> <li> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="utf-8"</font> ? <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:schema</font> <font color="#ff0000">xmlns:xs</font> <font color="#0000ff">="http://www.w3.org/2001/XMLSchema"</font> <font color="#ff0000">xmlns:meta</font> <font color="#0000ff">="http://www.arptek.ru/core/meta"</font> <font color="#ff0000">targetNamespace</font> <font color="#0000ff">="http://www.arptek.ru/core/meta/test"</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:complexType</font> <font color="#ff0000">name</font> <font color="#0000ff">="Test"</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:annotation</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:appinfo</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">meta:java.interface</font> <font color="#0000ff">&gt;</font> ru.arptek.meta.SomeInterface <font color="#0000ff">&lt;/</font> <font color="#800000">meta:java.interface</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:appinfo</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:annotation</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:sequence</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="id"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:int"</font> <font color="#ff0000">meta:jpa</font> . <font color="#ff0000">Id</font> <font color="#0000ff">="true"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="string"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:string"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="boolean"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:boolean"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="integer"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:int"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="long"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:long"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:sequence</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:complexType</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:schema</font> <font color="#0000ff">&gt;</font> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> </li> <li> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="utf-8"</font> ? <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:schema</font> <font color="#ff0000">xmlns:xs</font> <font color="#0000ff">="http://www.w3.org/2001/XMLSchema"</font> <font color="#ff0000">xmlns:meta</font> <font color="#0000ff">="http://www.arptek.ru/core/meta"</font> <font color="#ff0000">targetNamespace</font> <font color="#0000ff">="http://www.arptek.ru/core/meta/test"</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:complexType</font> <font color="#ff0000">name</font> <font color="#0000ff">="Test"</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:annotation</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:appinfo</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">meta:java.interface</font> <font color="#0000ff">&gt;</font> ru.arptek.meta.SomeInterface <font color="#0000ff">&lt;/</font> <font color="#800000">meta:java.interface</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:appinfo</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:annotation</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:sequence</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="id"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:int"</font> <font color="#ff0000">meta:jpa</font> . <font color="#ff0000">Id</font> <font color="#0000ff">="true"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="string"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:string"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="boolean"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:boolean"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="integer"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:int"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="long"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:long"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:sequence</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:complexType</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:schema</font> <font color="#0000ff">&gt;</font> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> </li> <li> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="utf-8"</font> ? <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:schema</font> <font color="#ff0000">xmlns:xs</font> <font color="#0000ff">="http://www.w3.org/2001/XMLSchema"</font> <font color="#ff0000">xmlns:meta</font> <font color="#0000ff">="http://www.arptek.ru/core/meta"</font> <font color="#ff0000">targetNamespace</font> <font color="#0000ff">="http://www.arptek.ru/core/meta/test"</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:complexType</font> <font color="#ff0000">name</font> <font color="#0000ff">="Test"</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:annotation</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:appinfo</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">meta:java.interface</font> <font color="#0000ff">&gt;</font> ru.arptek.meta.SomeInterface <font color="#0000ff">&lt;/</font> <font color="#800000">meta:java.interface</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:appinfo</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:annotation</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:sequence</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="id"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:int"</font> <font color="#ff0000">meta:jpa</font> . <font color="#ff0000">Id</font> <font color="#0000ff">="true"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="string"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:string"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="boolean"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:boolean"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="integer"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:int"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="long"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:long"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:sequence</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:complexType</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:schema</font> <font color="#0000ff">&gt;</font> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> </li> <li> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="utf-8"</font> ? <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:schema</font> <font color="#ff0000">xmlns:xs</font> <font color="#0000ff">="http://www.w3.org/2001/XMLSchema"</font> <font color="#ff0000">xmlns:meta</font> <font color="#0000ff">="http://www.arptek.ru/core/meta"</font> <font color="#ff0000">targetNamespace</font> <font color="#0000ff">="http://www.arptek.ru/core/meta/test"</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:complexType</font> <font color="#ff0000">name</font> <font color="#0000ff">="Test"</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:annotation</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:appinfo</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">meta:java.interface</font> <font color="#0000ff">&gt;</font> ru.arptek.meta.SomeInterface <font color="#0000ff">&lt;/</font> <font color="#800000">meta:java.interface</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:appinfo</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:annotation</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:sequence</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="id"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:int"</font> <font color="#ff0000">meta:jpa</font> . <font color="#ff0000">Id</font> <font color="#0000ff">="true"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="string"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:string"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="boolean"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:boolean"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="integer"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:int"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="long"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:long"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:sequence</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:complexType</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:schema</font> <font color="#0000ff">&gt;</font> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> </li> <li> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="utf-8"</font> ? <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:schema</font> <font color="#ff0000">xmlns:xs</font> <font color="#0000ff">="http://www.w3.org/2001/XMLSchema"</font> <font color="#ff0000">xmlns:meta</font> <font color="#0000ff">="http://www.arptek.ru/core/meta"</font> <font color="#ff0000">targetNamespace</font> <font color="#0000ff">="http://www.arptek.ru/core/meta/test"</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:complexType</font> <font color="#ff0000">name</font> <font color="#0000ff">="Test"</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:annotation</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:appinfo</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">meta:java.interface</font> <font color="#0000ff">&gt;</font> ru.arptek.meta.SomeInterface <font color="#0000ff">&lt;/</font> <font color="#800000">meta:java.interface</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:appinfo</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:annotation</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:sequence</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="id"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:int"</font> <font color="#ff0000">meta:jpa</font> . <font color="#ff0000">Id</font> <font color="#0000ff">="true"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="string"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:string"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="boolean"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:boolean"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="integer"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:int"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="long"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:long"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:sequence</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:complexType</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:schema</font> <font color="#0000ff">&gt;</font> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> </li> <li></li><li> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="utf-8"</font> ? <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:schema</font> <font color="#ff0000">xmlns:xs</font> <font color="#0000ff">="http://www.w3.org/2001/XMLSchema"</font> <font color="#ff0000">xmlns:meta</font> <font color="#0000ff">="http://www.arptek.ru/core/meta"</font> <font color="#ff0000">targetNamespace</font> <font color="#0000ff">="http://www.arptek.ru/core/meta/test"</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:complexType</font> <font color="#ff0000">name</font> <font color="#0000ff">="Test"</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:annotation</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:appinfo</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">meta:java.interface</font> <font color="#0000ff">&gt;</font> ru.arptek.meta.SomeInterface <font color="#0000ff">&lt;/</font> <font color="#800000">meta:java.interface</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:appinfo</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:annotation</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:sequence</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="id"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:int"</font> <font color="#ff0000">meta:jpa</font> . <font color="#ff0000">Id</font> <font color="#0000ff">="true"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="string"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:string"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="boolean"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:boolean"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="integer"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:int"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="long"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:long"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:sequence</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:complexType</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:schema</font> <font color="#0000ff">&gt;</font> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> <br></code></code> </li> </ol> <code><code><font color="gray"><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="utf-8"</font> ? <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:schema</font> <font color="#ff0000">xmlns:xs</font> <font color="#0000ff">="http://www.w3.org/2001/XMLSchema"</font> <font color="#ff0000">xmlns:meta</font> <font color="#0000ff">="http://www.arptek.ru/core/meta"</font> <font color="#ff0000">targetNamespace</font> <font color="#0000ff">="http://www.arptek.ru/core/meta/test"</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:complexType</font> <font color="#ff0000">name</font> <font color="#0000ff">="Test"</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:annotation</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:appinfo</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">meta:java.interface</font> <font color="#0000ff">&gt;</font> ru.arptek.meta.SomeInterface <font color="#0000ff">&lt;/</font> <font color="#800000">meta:java.interface</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:appinfo</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:annotation</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:sequence</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="id"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:int"</font> <font color="#ff0000">meta:jpa</font> . <font color="#ff0000">Id</font> <font color="#0000ff">="true"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="string"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:string"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="boolean"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:boolean"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="integer"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:int"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="long"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:long"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:sequence</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:complexType</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:schema</font> <font color="#0000ff">&gt;</font> * This source code was highlighted with <font color="gray">Source Code Highlighter</font> . <br></font></code></code> </blockquote> <code><code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a> <font color="#0000ff">&lt;?</font> <font color="#800000">xml</font> <font color="#ff0000">version</font> <font color="#0000ff">="1.0"</font> <font color="#ff0000">encoding</font> <font color="#0000ff">="utf-8"</font> ? <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:schema</font> <font color="#ff0000">xmlns:xs</font> <font color="#0000ff">="http://www.w3.org/2001/XMLSchema"</font> <font color="#ff0000">xmlns:meta</font> <font color="#0000ff">="http://www.arptek.ru/core/meta"</font> <font color="#ff0000">targetNamespace</font> <font color="#0000ff">="http://www.arptek.ru/core/meta/test"</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:complexType</font> <font color="#ff0000">name</font> <font color="#0000ff">="Test"</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:annotation</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:appinfo</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">meta:java.interface</font> <font color="#0000ff">&gt;</font> ru.arptek.meta.SomeInterface <font color="#0000ff">&lt;/</font> <font color="#800000">meta:java.interface</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:appinfo</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:annotation</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:sequence</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="id"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:int"</font> <font color="#ff0000">meta:jpa</font> . <font color="#ff0000">Id</font> <font color="#0000ff">="true"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="string"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:string"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="boolean"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:boolean"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="integer"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:int"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;</font> <font color="#800000">xs:element</font> <font color="#ff0000">name</font> <font color="#0000ff">="long"</font> <font color="#ff0000">type</font> <font color="#0000ff">="xs:long"</font> <font color="#0000ff">/&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:sequence</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:complexType</font> <font color="#0000ff">&gt;</font> <font color="#0000ff">&lt;/</font> <font color="#800000">xs:schema</font> <font color="#0000ff">&gt;</font> <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font></code> <br></code> <br>  By the way, pay attention to the use of additional attributes and elements in the namespace "http: // www.arptek.ru/core/meta".  This is the only way - additional attributes should always be in a separate namespace, and elements should be placed in xs: annotation / xs: appinfo in general.  The code that converts this scheme into a configuration can be seen <a href="">here</a> . <br><br><h5>  Bean Class Generation </h5><br>  The generation code performs three tasks: <br><ul><li>  Generates get / set methods for all attributes, taking into account the necessary types.  This is needed to access data from both Hibernate and the code that knows about the structure of specific types. </li><li>  It also generates internal fields Fields, instances of which are placed in the collection for each object.  As a result, you can work with the list of fields without knowing in advance exactly which fields the object has.  This is convenient for writing object editors (one for almost all types). </li><li>  Also, the code must not forget to provide annotations for correct operation of JPA. </li></ul><br>  Some notes before starting the code: <br><ul><li>  Java is a bytecode runtime.  Bytecode is the only code that the Java machine understands (almost).  It is written in binary form in the class files (* .class).  It is usually obtained from Java files (* .java) that are compiled into byte-code with the javac compiler. </li><li>  Byte code is a set of instructions that control the operation of the <a href="http://www.osp.ru/os/1999/01/179635/_p1.html">stack machine</a> .  Instructions include loading local variables, constants, class fields to the stack, operations on them (arithmetic, logical, type conversions), calling class methods and interfaces. </li><li>  Any operation is performed on what is already on the stack.  Do you want to add two numbers?  they must be pushed onto the stack.  Call an object method?  The object reference and its parameters must be pushed onto the stack. </li><li>  Complex objects are placed in the "heap", and only a pointer to the object is put on the stack.  Hope you learned C / C ++ well :-) </li></ul><br>  We need to know how to perform simple operations that correspond to a particular Java code in assembly language.  For example, the command <br><pre>  return this.a; </pre><br>  should be converted to the following code: <br><pre>     0 aload_0
     1 getfield classname.a
     4 lreturn
</pre><br>  In this case, the specific opcodes depend on which types have arguments.  For int / boolean / long, different opcodes are used.  But the good thing is that CGLib and ASM hide from us these particular features of the Java machine implementation and control themselves which types have arguments and which opcodes to use.  For example, if we define a variable: <br><pre>  ce.declare_field (Constants.ACC_PROTECTED, fieldName, type, null); </pre><br>  That CGLib / ASM will remember its type, and when we will generate code using the commands <br><pre>     codeEmitter.load_this (); 
     codeEmitter.getfield (constantName); 
     codeEmitter.return_value (); 
</pre><br>  The generated code will have exactly those operands that work with the type of variable we specified.  So, the return value of the class field was higher.  More precisely, this code can be divided into two parts.  Putting a field value on the stack: <br><pre>     codeEmitter.load_this (); 
     codeEmitter.getfield (constantName); 
</pre><br>  and return the top value of the stack: <br><pre>     codeEmitter.return_value (); 
</pre><br>  Putting the first function argument to the stack (for further assignment to something): <br><pre>     codeEmitter.load_arg (0);
</pre><br>  BUT!  The problem is that when performing the putfield operation, there must be a value at the top of the stack, and below - a reference to the object that owns the field.  Therefore, we first get a reference to the object, then add the argument to the stack, and only then assign the value to the field: <br><pre>          codeEmitter.load_this (); 
          codeEmitter.load_arg (0); 
          codeEmitter.putfield (fieldName); 
          codeEmitter.return_value (); 
</pre><br>  Method call  For this, the stack must contain a link to the object and arguments (arguments from above): <br><pre>                 codeEmitter.invoke_virtual (parentClass, new Signature (
                         getterName, fieldValueType, TYPES_EMPTY));
</pre><br>  In this case, invoke_static is used to call static methods, invoke_interface is used to call methods that are defined in the interface (parentClass interface), and invoke_special is used to call a constructor (where the method name is "&lt;init&gt;").  By the way, the creation of an object and the call of a constructor are different operations, and they may well be separated by something.  For example, creating a LinkedHashMap: <br><pre>         Local local = e.make_local (TYPE_LINKED_HASH_MAP);<font></font>
<font></font>
         e.new_instance (TYPE_LINKED_HASH_MAP);
         e.dup ();
         e.push (fieldClasses.size ());
         e.push (10);
         e.push (1f);
         e.invoke_constructor (TYPE_LINKED_HASH_MAP, SIG_MAP_INIT_INT_FLOAT);
         e.store_local (local);
</pre><br>  Prepare a local variable where we will store the map.  After that we create a new object in the heap (we allocate memory to it).  Next, we duplicate the top argument of the stack with the dup () operation - since after the constructor call, one of the links will go away, and we still need to save the value.  We also push the constructor call arguments to the stack (strictly observing the type, autoconversion int-&gt; float will not work here), and call the constructor using the invoke_constructor (it will be converted to invoke_special).  In the last line - save the result in a local variable.  After that, our stack is empty. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      So, class generation: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  ClassWriter cw = <font color="#0000ff">new</font> DebuggingClassWriter ( </li><li>  ClassWriter.COMPUTE_FRAMES); </li><li>  ClassEmitter ce = <font color="#0000ff">new</font> ClassEmitter (cw); </li><li></li><li>  Type [] interfaces = getInterfacesTypes (complexType); </li><li></li><li>  ce.begin_class (Constants.V1_6, Constants.ACC_PUBLIC, className, </li><li>  Type.getType (complexType.getSuperClass ()), interfaces, </li><li>  Constants.SOURCE_FILE); </li><li></li><li>  <font color="#0000ff">if</font> (complexType.isJpaEntity ()) { </li><li>  ce.visitAnnotation (ANNOTATION_DESCRIPTOR_ENTITY, <font color="#0000ff">true</font> ) </li><li>  .visitEnd (); </li><li>  } </li><li></li><li>  <font color="#0000ff">if</font> (StringUtils.isNotEmpty (complexType.getJpaTableName ())) { </li><li>  final AnnotationVisitor av = ce.visitAnnotation ( </li><li>  ANNOTATION_DESCRIPTOR_TABLE, <font color="#0000ff">true</font> ); </li><li>  av.visit ( <font color="#A31515">"name"</font> , complexType.getJpaTableName ()); </li><li>  av.visitEnd (); </li><li>  } </li><li></li><li>  { </li><li>  <font color="#0000ff">if</font> (options.generateFieldAccessors) { </li><li>  final String fieldsMapFieldName = <font color="#A31515">"$ fields $"</font> ; </li><li></li><li>  ce.declare_field (Constants.ACC_PRIVATE </li><li>  |  Constants.ACC_FINAL, fieldsMapFieldName, </li><li>  TYPE_MAP, <font color="#0000ff">null</font> ); </li><li></li><li>  generateConstructorWithFieldsInit (mainClass, ce, </li><li>  fieldClasses, fieldsMapFieldName); </li><li>  generateGetFieldsMethod (ce, fieldsMapFieldName); </li><li>  generateGetFieldMethod (ce, fieldsMapFieldName); </li><li>  } <font color="#0000ff">else</font> { </li><li>  EmitUtils.null_constructor (ce); </li><li>  } </li><li></li><li>  <font color="#0000ff">for</font> (Attribute attribute: complexType.getAttributes ()) { </li><li>  processAttribute (ce, attribute); </li><li>  } </li><li>  } </li><li>  ce.end_class (); </li><li></li><li>  { </li><li>  <font color="#0000ff">byte</font> [] bs = cw.toByteArray (); </li><li>  log.info ( <font color="#A31515">"Generated class '"</font> + className + <font color="#A31515">"' of"</font> + bs.length </li><li>  + <font color="#A31515">"bytes"</font> ); </li><li>  result.put (className, bs); </li><li>  } </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br>  The first and last lines organize the ClassEmitter -&gt; ClassWriter -&gt; ByteArrayOutputStream -&gt; bytes chain.  When generating class code, we use ClassEmitter, for methods - CodeEmitter, and for annotations - there is no such thing and AnnotationVisitor is used (it is important not to forget to close it also via visitEnd ()). <br><br>  To create a class, select the name, version, parent class, interfaces, etc., as if we are writing a regular class, but in a different language.  It is necessary, however, not to forget that, unlike normal Java-code, such code can be compiled, but not earned - because you forgot something or did not do so.  For example, you forgot to add a return code from the procedure ... the class will be generated, but it will not work.  That is, errors in such code cannot be traced at the compilation stage and it is necessary to do test cases.  Although those who are already ready to accept the assembler already know about it :) <br><br>  Lines 11‚Äì21 add to the JPA class the annotation <a href="https://habrahabr.ru/users/entity/" class="user_link">Entity</a> and <a href="https://habrahabr.ru/users/table/" class="user_link">Table</a> .  An important note that could save me a lot of time - the visitAnnotation method accepts a string, but not the name of the annotation class, but its description in the internal Java format.  For example, for javax.persistence.Entity this will be ‚ÄúLjavax / persistence / Entity;‚Äù.  But they can be easily obtained using the Type class (it is used almost in every line): <br>  <font color="Teal">1</font> <font color="Blue">private</font> <font color="Blue">static</font> <font color="Blue">final</font> String ANNOTATION_DESCRIPTOR_ENTITY = Type.getType ( <br>  <font color="Teal">2</font> Entity.  <font color="Blue">class</font> ) .getDescriptor (); <br><br>  Line 36 is needed to add a simple constructor (another case a bit later).  Well, in loop 39-41, we add new fields, get / set methods, and default constants for each attribute: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">if</font> (attribute.getType () instanceof EmptyType) </li><li>  <font color="#0000ff">return</font> ; </li><li></li><li>  String fieldName = attribute.getFieldName (); </li><li>  String getterName = attribute.getGetterName (); </li><li>  String setterName = attribute.getSetterName (); </li><li></li><li>  final String javaMethodNamePart = WordUtils.capitalize ( </li><li>  attribute.getAttrName (), <font color="#0000ff">new</font> <font color="#0000ff">char</font> [] { <font color="#A31515">'_'</font> }). replace ( <font color="#A31515">"_"</font> , <font color="#A31515">""</font> ); </li><li></li><li>  final Type type = getTypeFromXmlSchemaTypeName (attribute.getType ()); </li><li></li><li>  <font color="#0000ff">if</font> (fieldName == <font color="#0000ff">null</font> ) </li><li>  fieldName = <font color="#A31515">"m $"</font> + StringUtils.uncapitalize (javaMethodNamePart); </li><li>  <font color="#0000ff">if</font> (getterName == <font color="#0000ff">null</font> ) </li><li>  getterName = <font color="#A31515">"get"</font> + javaMethodNamePart; </li><li>  <font color="#0000ff">if</font> (setterName == <font color="#0000ff">null</font> ) </li><li>  setterName = <font color="#A31515">"set"</font> + javaMethodNamePart; </li><li></li><li>  final boolean jpaId = attribute.isJpaId (); </li><li></li><li>  final String strDefaultValue; </li><li>  <font color="#0000ff">if</font> (! jpaId) { </li><li>  strDefaultValue = attribute.getStrDefaultValue (); </li><li>  } <font color="#0000ff">else</font> { </li><li>  strDefaultValue = <font color="#0000ff">null</font> ; </li><li>  } </li><li></li><li>  <font color="#0000ff">if</font> (strDefaultValue == <font color="#0000ff">null</font> ) { </li><li>  ce.declare_field (Constants.ACC_PRIVATE, fieldName, type, <font color="#0000ff">null</font> ); </li><li></li><li>  { </li><li>  <font color="#008000">// create getter</font> </li><li>  CodeEmitter codeEmitter = ce.begin_method (Constants.ACC_PUBLIC, </li><li>  <font color="#0000ff">new</font> Signature (getterName, type, TYPES_EMPTY), </li><li>  TYPES_EMPTY); </li><li></li><li>  proceedAttributeJpaColumnName (attribute, codeEmitter); </li><li>  proceedAttributeJpaLob (attribute, codeEmitter); </li><li>  proceedAttributeJpaId (attribute, codeEmitter); </li><li></li><li>  codeEmitter.load_this (); </li><li>  codeEmitter.getfield (fieldName); </li><li>  codeEmitter.return_value (); </li><li>  codeEmitter.end_method (); </li><li>  } </li><li></li><li>  { </li><li>  <font color="#008000">// create null safe setter</font> </li><li>  CodeEmitter codeEmitter = ce.begin_method (Constants.ACC_PUBLIC, </li><li>  <font color="#0000ff">new</font> Signature (setterName, Type.VOID_TYPE, </li><li>  <font color="#0000ff">new</font> Type [] {type}), TYPES_EMPTY); </li><li>  codeEmitter.load_this (); </li><li>  codeEmitter.load_arg (0); </li><li>  codeEmitter.putfield (fieldName); </li><li>  codeEmitter.return_value (); </li><li>  codeEmitter.end_method (); </li><li>  } </li><li>  } <font color="#0000ff">else</font> { </li><li>  final Object defaultValue = toValue (type, strDefaultValue); </li><li>  final String constantName = <font color="#A31515">"DEFAULT_"</font> + fieldName; </li><li></li><li>  ce.declare_field (Constants.ACC_PROTECTED | Constants.ACC_FINAL </li><li>  |  Constants.ACC_STATIC, constantName, type, <font color="#0000ff">null</font> ); </li><li></li><li>  { </li><li>  CodeEmitter staticHook = ce.getStaticHook (); </li><li>  EmitUtils.push_object (staticHook, defaultValue); </li><li>  staticHook.putfield (constantName); </li><li>  } </li><li></li><li>  ce.declare_field (Constants.ACC_PROTECTED, fieldName, type, <font color="#0000ff">null</font> ); </li><li></li><li>  { </li><li>  <font color="#008000">// create getter</font> </li><li>  final Signature signature = <font color="#0000ff">new</font> Signature (getterName, type, </li><li>  TYPES_EMPTY); </li><li>  final CodeEmitter codeEmitter = ce.begin_method ( </li><li>  Constants.ACC_PUBLIC, signature, TYPES_EMPTY); </li><li></li><li>  proceedAttributeJpaColumnName (attribute, codeEmitter); </li><li>  proceedAttributeJpaLob (attribute, codeEmitter); </li><li></li><li>  codeEmitter.load_this (); </li><li>  codeEmitter.getfield (fieldName); </li><li></li><li>  Label ifNull = codeEmitter.make_label (); </li><li></li><li>  codeEmitter.ifnull (ifNull); </li><li>  { </li><li>  codeEmitter.load_this (); </li><li>  codeEmitter.getfield (fieldName); </li><li>  codeEmitter.return_value (); </li><li>  } </li><li>  codeEmitter.mark (ifNull); </li><li>  { </li><li>  codeEmitter.load_this (); </li><li>  codeEmitter.getfield (constantName); </li><li>  codeEmitter.return_value (); </li><li>  } </li><li>  codeEmitter.end_method (); </li><li>  } </li><li></li><li>  { </li><li>  <font color="#008000">// create setter</font> </li><li>  final Signature signature = <font color="#0000ff">new</font> Signature (setterName, </li><li>  Type.VOID_TYPE, <font color="#0000ff">new</font> Type [] {type}); </li><li>  final CodeEmitter codeEmitter = ce.begin_method ( </li><li>  Constants.ACC_PUBLIC, signature, TYPES_EMPTY); </li><li></li><li>  codeEmitter.load_this (); </li><li>  codeEmitter.load_arg (0); </li><li>  codeEmitter.putfield (fieldName); </li><li>  codeEmitter.return_value (); </li><li>  codeEmitter.end_method (); </li><li>  } </li><li></li><li>  } </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br>  Check 1-2 is needed in case the field is ‚Äúempty‚Äù.  Such fields allow you to include an attribute in a class that will not be stored in the same table, and, for example, will manage its own state.  In lines 4-18, the variables are initialized and future names for internal variables and methods are defined.  Note that for methods and variables that are generated by a computer, it is customary to use the "$" sign, whereas in custom code it is recommended to avoid it.  Of course, get / set methods are left without this sign, since they will be called from Hibernate and business code. <br><br>  For JPA ID, the default values ‚Äã‚Äãare not used, so just in case we check that it was not set, in lines 23-27.  The code generation for the case when the default value is set and not is different.  The case when it is not there is, of course, simpler and more straightforward - the field itself is added to the class in line 30, the get method in lines 32-46, set - 48-58. <br><br>  The default case requires: <br><ul><li>  Define a constant with a default value (lines 60-61) </li><li>  Moreover, for complex types (and Boolean / Integer / Long applies to them), you need to use static code to initialize constants.  When we write ordinary code it is not necessary - because the compiler does it for us.  But here you need to do it manually.  In lines 66-70, we add new lines to StaticHook.  Then, when we finish working with the class, all the lines from the StaticHook will be transferred to the class static initialization block (well, almost ... those interested in the details can disassemble and see what is actually happening there.) </li><li>  The set method is fairly simple (lines 104-116) </li><li>  But in the get method I added a branch.  It may not be - if you initialize variables in the class constructor with default values ‚Äã‚Äã(how to work with the constructor, below).  But I would like that if the variable inside the class is set to null, then the value of the constant would be returned.  To organize branching, we create a new link (label).  According to it, we will make the transition if the value is zero.  Then use the conditional branch command (line 89).  Once again - we do not check the condition right now - we add a check of this condition to the method code.  If the condition is fulfilled, a transition occurs to the point in the code that is marked with a mark (line 95).  If not done, the regular 91-93 branch is executed.  In addition, each of the code execution branches contains the return code of the resulting value. </li></ul><br><br><h5>  Access to a set of fields </h5><br>  The code above successfully (hopefully) generated a ‚Äúbin‚Äù - a class with fields and get / set methods.  But still it is necessary to combine two methods: getField (name) and getFields ().  These methods should give access to the object's fields through the collection, but there should not be any reflection in order not to slow down the system by calling the native-methods. <br>  To do this, for each object attribute, we will additionally generate a class that contains two methods ‚Äî getValue () and setValue (), which delegate these calls to the main class.  The generation of such a class is quite simple, but interesting because now the class constructor is not empty, but takes a single parameter - a reference to the parent object: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  final String holderFieldName = <font color="#A31515">"$ parent $"</font> ; </li><li></li><li>  ce.declare_field (Constants.ACC_PRIVATE | Constants.ACC_FINAL, </li><li>  holderFieldName, parentClass, <font color="#0000ff">null</font> ); </li><li></li><li>  { </li><li>  CodeEmitter e = ce.begin_method (Constants.ACC_PUBLIC, </li><li>  <font color="#0000ff">new</font> Signature ( <font color="#A31515">"&lt;init&gt;"</font> , Type.VOID_TYPE, </li><li>  <font color="#0000ff">new</font> Type [] {parentClass}), <font color="#0000ff">null</font> ); </li><li>  e.load_this (); </li><li>  e.super_invoke_constructor (); </li><li></li><li>  e.load_this (); </li><li>  e.load_arg (0); </li><li>  e.putfield (holderFieldName); </li><li></li><li>  e.return_value (); </li><li>  e.end_method (); </li><li>  } </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br><br>  The link itself is stored in the $ parent $ variable.  The get / set methods are made quite simple: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  { </li><li>  <font color="#008000">// create getter</font> </li><li>  CodeEmitter codeEmitter = ce.begin_method (Constants.ACC_PUBLIC, </li><li>  <font color="#0000ff">new</font> Signature ( <font color="#A31515">"getValue"</font> , fieldValueType, TYPES_EMPTY), </li><li>  TYPES_EMPTY); </li><li></li><li>  codeEmitter.load_this (); </li><li>  codeEmitter.getfield (holderFieldName); </li><li></li><li>  codeEmitter.invoke_virtual (parentClass, <font color="#0000ff">new</font> Signature ( </li><li>  getterName, fieldValueType, TYPES_EMPTY)); </li><li></li><li>  codeEmitter.return_value (); </li><li>  codeEmitter.end_method (); </li><li>  } </li><li></li><li>  { </li><li>  <font color="#008000">// create null safe setter</font> </li><li>  CodeEmitter codeEmitter = ce.begin_method (Constants.ACC_PUBLIC, </li><li>  <font color="#0000ff">new</font> Signature ( <font color="#A31515">"setValue"</font> , Type.VOID_TYPE, </li><li>  <font color="#0000ff">new</font> Type [] {fieldValueType}), TYPES_EMPTY); </li><li>  codeEmitter.load_this (); </li><li>  codeEmitter.getfield (holderFieldName); </li><li>  codeEmitter.load_arg (0); </li><li></li><li>  codeEmitter.invoke_virtual (parentClass, <font color="#0000ff">new</font> Signature ( </li><li>  setterName, Type.VOID_TYPE, </li><li>  <font color="#0000ff">new</font> Type [] {fieldValueType})); </li><li></li><li>  codeEmitter.return_value (); </li><li>  codeEmitter.end_method (); </li><li>  } </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br><br>  These classes for each attribute are generated in a loop and stored in Map &lt;Attribute, String = class name&gt;: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  ClassWriter cw = <font color="#0000ff">new</font> DebuggingClassWriter ( </li><li>  ClassWriter.COMPUTE_FRAMES); </li><li>  ClassEmitter ce = <font color="#0000ff">new</font> ClassEmitter (cw); </li><li></li><li>  String fieldClassName = processAttributeField (className, </li><li>  mainClass, ce, attribute); </li><li></li><li>  fieldClasses.put (attribute, ce.getClassType ()); </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br><br>  What for?  So that later in the constructor of the parent class, create instances of the child objects and place them in the internal field $ fields $: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">public</font> <font color="#0000ff">void</font> generateConstructorWithFieldsInit (final Type mainClass, </li><li>  ClassEmitter ce, Map &lt;Attribute, Type&gt; fieldClasses, </li><li>  final String fieldsMapFieldName) { </li><li>  CodeEmitter e = ce.begin_method (Constants.ACC_PUBLIC, TypeUtils </li><li>  .parseConstructor ( <font color="#A31515">""</font> ), <font color="#0000ff">null</font> ); </li><li>  e.load_this (); </li><li>  e.super_invoke_constructor (); </li><li></li><li>  Local local = e.make_local (TYPE_LINKED_HASH_MAP); </li><li></li><li>  e.new_instance (TYPE_LINKED_HASH_MAP); </li><li>  e.dup (); </li><li>  e.push (fieldClasses.size ()); </li><li>  e.push (1f); </li><li>  e.invoke_constructor (TYPE_LINKED_HASH_MAP, SIG_MAP_INIT_INT_FLOAT); </li><li>  e.store_local (local); </li><li></li><li>  <font color="#0000ff">for</font> (Entry &lt;Attribute, Type&gt; fieldTypes: fieldClasses.entrySet ()) { </li><li>  e.load_local (local); </li><li>  e.push (fieldTypes.getKey (). getAttrName ()); </li><li></li><li>  <font color="#008000">// = new &lt;...&gt; Field (this);</font> </li><li>  e.new_instance (fieldTypes.getValue ()); </li><li>  e.dup (); </li><li>  e.load_this (); </li><li>  e.invoke_constructor (fieldTypes.getValue (), <font color="#0000ff">new</font> Signature ( <font color="#A31515">"&lt;init&gt;"</font> , </li><li>  Type.VOID_TYPE, <font color="#0000ff">new</font> Type [] {mainClass})); </li><li></li><li>  <font color="#008000">// $ fields $ .put (fieldName, field);</font> </li><li>  e.invoke_virtual (TYPE_LINKED_HASH_MAP, SIG_MAP_PUT); </li><li>  } </li><li></li><li>  e.load_this (); </li><li>  e.load_local (local); </li><li>  e.invoke_static (TYPE_COLLECTIONS, SIG_COLLECTIONS_UNMODIFIABLEMAP); </li><li>  e.putfield (fieldsMapFieldName); </li><li></li><li>  e.return_value (); </li><li>  e.end_method (); </li><li>  } </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br><br>  In the first lines, we create LinkedHashMap (with the parameterization using Generic, we hammer - it is almost not in the assembler).  Then we fill it with child fields Fields, well, then, just in case, we wrap it in Collections.unmodifiableMap and save the final field.  By the way, notice that the last method is called using invoke_static, and even the constructor is completed with the return_value operation, although it returns VOID in accordance with the specification (lines 4-5). <br><br>  And finally, we will create the getField (name) and getFields () methods, not forgetting to provide them with <a href="https://habrahabr.ru/users/transient/" class="user_link">Transient</a> annotation, so that the JPA does not think that these are object fields: <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">public</font> <font color="#0000ff">void</font> generateGetFieldMethod (ClassEmitter ce, </li><li>  final String fieldsMapFieldName) { </li><li>  CodeEmitter e = ce.begin_method (Constants.ACC_PUBLIC, </li><li>  SIG_FIELDSHOLDER_GETFIELD, <font color="#0000ff">null</font> ); </li><li>  e.visitAnnotation (ANNOTATION_DESCRIPTOR_TRANSIENT, <font color="#0000ff">true</font> ) .visitEnd (); </li><li></li><li>  e.load_this (); </li><li>  e.getfield (fieldsMapFieldName); </li><li></li><li>  e.load_arg (0); </li><li></li><li>  e.checkcast (TYPE_OBJECT); </li><li>  e.invoke_interface (TYPE_MAP, SIG_MAP_GET); </li><li>  e.checkcast (TYPE_FIELD); </li><li></li><li>  e.return_value (); </li><li>  e.end_method (); </li><li>  } </li><li></li><li>  <font color="#0000ff">public</font> <font color="#0000ff">void</font> generateGetFieldsMethod (ClassEmitter ce, </li><li>  final String fieldsMapFieldName) { </li><li>  CodeEmitter e = ce.begin_method (Constants.ACC_PUBLIC, </li><li>  SIG_FIELDSHOLDER_GETFIELDS, <font color="#0000ff">null</font> ); </li><li>  e.visitAnnotation (ANNOTATION_DESCRIPTOR_TRANSIENT, <font color="#0000ff">true</font> ) .visitEnd (); </li><li></li><li>  e.load_this (); </li><li>  e.getfield (fieldsMapFieldName); </li><li>  e.return_value (); </li><li>  e.end_method (); </li><li>  } </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br><br><h5>  Loading derived classes </h5><br>  After generating byte [] for each class you need to load them into memory.  This is done by defining your ClassLoader (or you can save it to disk and load it from there using some URLClass Loader): <br><blockquote> <code><a href="http://virtser.net/blog/post/source-code-highlighter.aspx"></a></code> <ol><li>  <font color="#0000ff">protected</font> Map &lt;String, Class &lt;? &gt;&gt; loadClasses ( </li><li>  final Map &lt;String, <font color="#0000ff">byte</font> []&gt; generated) { </li><li></li><li>  final Thread currentThread = Thread.currentThread (); </li><li>  final ClassLoader classLoader = currentThread.getContextClassLoader (); </li><li>  final Map &lt;String, Class &lt;? &gt;&gt; classes = <font color="#0000ff">new</font> ClassLoader (classLoader) { </li><li>  <font color="#0000ff">protected</font> Map &lt;String, Class &lt;? &gt;&gt; loadClasses () { </li><li>  Map &lt;String, Class &lt;? &gt;&gt; result = <font color="#0000ff">new</font> LinkedHashMap &lt;String, Class &lt;? &gt;&gt; ( </li><li>  generated.size ()); </li><li>  <font color="#0000ff">for</font> (Entry &lt;String, <font color="#0000ff">byte</font> []&gt; entry: generated.entrySet ()) { </li><li>  final String className = entry.getKey (); </li><li>  final <font color="#0000ff">byte</font> [] byteCode = entry.getValue (); </li><li></li><li>  log.info ( <font color="#A31515">"Defining class"</font> + className + <font color="#A31515">"..."</font> ); </li><li>  final Class &lt;?&gt; cls = defineClass (className, byteCode, 0, </li><li>  byteCode.length); </li><li>  result.put (cls.getName (), cls); </li><li>  } </li><li></li><li>  <font color="#0000ff">return</font> result; </li><li>  } </li><li>  } .loadClasses (); </li><li>  <font color="#0000ff">return</font> classes; </li><li>  } </li></ol>  <font color="gray">* This source code was highlighted with <font color="gray">Source Code Highlighter</font> .</font> </blockquote><br>  By the way, you should not forget about this ClassLoader - you will need it later to load these classes into Hibernate, because it will not work if the current ClassLoader cannot load those classes that are passed to it as parameters. <br><br><h5>  Use in practice </h5><br>  Some links that may be interesting for further study: <br><ul><li>  <a href="">Example of real class configuration</a> </li><li>  <a href="">The class responsible for converting the configuration into meta-configuration, generating classes and creating an entityclass collection</a> </li><li>  <a href="">Class responsible for loading the EntityFactory</a> </li><li>  <a href="">The class responsible for loading classes from the database through JPA</a> </li><li>  <a href="http://fvl.fizteh.ru/">An example of a site that works on this engine</a> (not mine :)) </li></ul><br><h5>  As a result </h5><br><ul><li>  Hibernate is now handling data.  He cares about loading and saving.  There is support for batch operations for downloading, support for caches and transactions.  Smaller bikes are always good. </li><li>  Hibernate is also caching (albeit based on our clustered soft reference cache).  You can monitor the status of caches from JConsole. </li><li>  Productivity increased due to optimization of data loading (possibly batch-loading from the database of several objects at once with one SQL) </li><li>  Business code has become much easier and more pleasant to write :) </li></ul></div><p>Source: <a href="https://habr.com/ru/post/91239/">https://habr.com/ru/post/91239/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../91231/index.html">We draw HabraLogo</a></li>
<li><a href="../91232/index.html">How to solder the broken leg of the processor</a></li>
<li><a href="../91233/index.html">Why Magento?</a></li>
<li><a href="../91234/index.html">Overview of the Universal Huntkey Laptop Charger</a></li>
<li><a href="../91237/index.html">Billion edits on Wikipedia</a></li>
<li><a href="../91240/index.html">SleepPy Patterns (for N900) - Do you sleep well at night, as it always seemed to you?</a></li>
<li><a href="../91241/index.html">Binding of the data model to the javascript view</a></li>
<li><a href="../91242/index.html">Trimino</a></li>
<li><a href="../91244/index.html">Visualization of site activity using codeswarm</a></li>
<li><a href="../91246/index.html">Thin clients: how to buy them</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>