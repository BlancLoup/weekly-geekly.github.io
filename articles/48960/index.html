<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Run VMware Player as Windows Service</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Do you have a desire to run Vmware as a background process on a Windows computer? 
 None of the following is endorsed by VMware. This guide only descr...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Run VMware Player as Windows Service</h1><div class="post__text post__text-html js-mediator-article">  Do you have a desire to run Vmware as a background process on a Windows computer? <br>  None of the following is endorsed by VMware.  This guide only describes my way to using VMware Player. <br><br><ol><li>  Create a virtual machine </li><li>  Install VMware Player </li><li>  Creating a VMware Player service </li><li>  Running virtual machines on Windows startup </li></ol><br><br>  <i>Translator: The next paragraph was added after questions appeared in the comments about why all this is necessary.</i> <i><br></i>  <i>What could be the gain of this method?</i>  <i>I did not check it, but I think that the gain in disk space and system resources (the distribution kit of the second server weighs about 600 MB, and the last player weighs more than three times less).</i>  <i>Just remember that the server until recently, lagged behind the support of fresh generations of virtual machines.</i> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br><br><h2>  1.1 Creating a virtual machine </h2><br><br>  Use <a href="http://www.vmware.com/products">VMWare products</a> to create virtual machines.  I used <a href="http://www.vmware.com/products/ws/">Workstation</a> version 5.5 because it creates 5th generation virtual machines.  If you use another VMware product, make sure that your product will create a virtual machine that is compatible with <a href="http://www.vmware.com/products/player/">VMWare Player</a> . <br><br>  <i>(Translator's note: The easiest way to use is VMWare Server 2.0, which is completely free, along with VMWare Player. But, of course, you can also create a virtual machine on a modern version of Workstation 6.5)</i> <br><br>  (VMware Player will be used to start the virtual machine (as this is a free product!). <br>  I also run VMware ACE as a service using the same methods as in the case of VMware Player. <br><br>  The fifth generation of virtual machines allows you to automatically scale the virtual mic's RAM memory taking into account the available physical memory; all you need to do is add a few parameters to the Vmx file. <br><br><h5>  memsize = "2048" <br>  MemAllowAutoScaleDown = "TRUE" </h5><br><br>  In this case, VM (virtual machine) will dispose of 2 GB of RAM, if any.  On machines with less than 2 GB of RAM, the player will automatically adjust the amount of used, taking into account the available RAM.  Memsize 2048 is not the limit.  If you have more than 2 GB of memory installed, simply increase this number. <br>  As far as I know, this is an undocumented function.  I found this in a vmx file of a single virtual machine supplied by VMware. <br><br><h2>  1.2 Installing VMware Player </h2><br><br>  On the machine on which the service will be executed (hereinafter referred to as the ‚Äútarget machine‚Äù), install VMware Player.  This example uses version 1.0.1.  Player cannot coexist with other VMware products on the same computer, so the target machine must be different from the machine when the virtual machine was created. <br>  <i>(Translator's note: I mean a separate installation of the player, if you do not have a Workstation installed, which includes the player. You can also just delete the VMWare Server from the computer after creating the virtual machine)</i> <i><br></i> <br><br><h2>  1.3 Creating VMWare Player Service </h2><br><br>  Find copies of instsrv.exe and Srvany.exe from the corresponding Windows Resource Kit.  For example, I used the Windows 2003 Resource Kit.  Copy instsrv.exe and Srvany.exe to% SYSTEMROOT% on the target machine. <br>  Copy the virtual machine files to a directory on the target computer.  Not all files are needed, I only copied the files, as shown below. <br><img src="https://habrastorage.org/getpro/geektimes/post_images/4a8/20b/e63/4a820be63ef5589780759c65a739eecc.png" alt="image"><br><br>  Add fields to the Vmx file so that VMware Player suppressed all ‚ÄúOk‚Äù messages generated by the user interface and did not show the user the interface. <br><br><h5>  server.vmx <br>  ‚Ä¶‚Ä¶ <br>  hints.hideAll = "TRUE" <br>  msg.noOk = "TRUE" <br>  ... ... </h5><br><br>  The Hints.hideAll parameter was mentioned in the VMware article - At Your Service!  in June 2004.  The Msg.noOk parameter was found in the VMware forums. <br>  Create the VirtualServer service on the target machine using instsrv.exe. <br>  instsrv VirtualServer "% SYSTEMROOT% \ System32 \ srvany.exe" <br>  Add registry keys for Srvany.exe so that it runs vmplayer.exe with your virtual machine.  For a detailed explanation of how to create custom services in Windows, see the Knowledge Base article How to create a custom service. <br><br><h5>  VirtualServer.reg <br>  Windows Registry Editor Version 5.00 <br>  [HKEY_LOCAL_MACHINE \ SYSTEM \ CurrentControlSet \ Services \ VirtualServer \ Parameters] <br>  "Application" = "\" C: \\\\ Program Files \\\ VMware \\\\ VMware Player \\\\ vmplayer.exe \ "" <br>  "AppParameters" = "\" C: \\\\ VirtualServer \\\\ server.vmx \ "" <br>  "AppDirectory" = "\" C: \\\\ VirtualServre \\\\\ "" " </h5><br><br>  To use another Vmware product, such as ACE, change the value of the ‚ÄúApplication‚Äù key. <br>  To use another virtual machine, change the value of ‚ÄúAppParameters‚Äù. <br><br>  Create a virtual machine startup batch file called start-vm.bat. This script first checks if the virtual machine files are installed and that the service is not running.  It then kills all old VMware processes and eliminates various state files since the last virtual machine startup.  At the end, the virtual machine service starts. <br><br><h5>  :: <br>  :: start-vm.bat <br>  :: <br>  :: If it doesn't start it <br>  if not exist C: \ VirtualServer goto noServer <br>  :: If the service is already running, then skip starting it <br>  net start |  grep -q -i "VirtualServer" <br>  if% ERRORLEVEL% == 0 goto noServer <br>  :: To make sure that the process is dead <br>  taskkill / F / IM vmplayer.exe <br>  taskkill / F / IM vmware-vmx.exe <br>  :: Remove * .lck, * .vmss from the grid directory <br>  del "C: \ VirtualServer \ *. lck" <br>  del "C: \ VirtualServer \ *. vmss" <br>  del "C: \ VirtualServer \ *. vmem" <br>  :: Start the server service <br>  net start VirtualServer <br>  : noServer </h5><br><br>  Create a batch file to stop the virtual machine called stop-vm.bat.  The virtual service stop script kills any VMware processes associated with the running virtual machine. <br><br><h5>  :: <br>  :: stop-vm.bat <br>  :: <br>  :: If it doesn't start it <br>  if not exist C: \ VirtualServer goto noServer <br>  :: Start the service <br>  net stop VirtualServer <br>  :: Force kill the processes <br>  taskkill / F / IM vmplayer.exe <br>  taskkill / F / IM vmware-vmx.exe <br>  : noServer </h5><br><br>  Important: the virtual machine should be in normal after hard closing.  Destroying the virtual machine process is the same as if you pulled the power cord out of a socket on a physical computer.  If the state of the virtual machine does not matter, then you can use the nonpersistent disk function.  Since the disk contents do not change while the virtual machine is running, this termination of the process will not affect the state of the virtual disk. <br><br><h2>  1.4 Starting Virtual Machines at Windows Startup </h2><br><br>  Place the startup script in% SYSTEMROOT% \ System32 \ GroupPolicy \ Machine \ Scripts \ Startup.  For this example, the startup script is the start-vm.bat file. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/4fa/076/b3a/4fa076b3a6bc2d65cf48732483c57da6.png" alt="image"><br><br>  On the target machine, make start-vm.bat start at system start-up by adding it to the autorun list of group policy.  gpedit.msc is a group policy editor.  Run the gpedit.msc command to open the Group Policy Editor (Translator‚Äôs Note: Start - Run menu) .. <br><br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/6b6/c10/f29/6b6c10f292dc5b371a0048e7dad79e05.png" alt="image"><br><br>  In the "Scripts (Startup / Shutdown)" section of the Group Policy Editor, open the Startup Properties window. Click the "Add" button and enter the name of the virtual machine launch script. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/725/b6a/579/725b6a579c758fb6d6486f81c0862b2a.png" alt="image"><br><br>  Perform steps 1-3 for Group Policy Shutdown, but use stop-vm.bat as the completion script.  Adding a Shutdown group policy is not strictly required, but it may be important to start stop-vm.bat if it contains more commands than just completing the virtual machine process. <br>  Everything.  Use. </div><p>Source: <a href="https://habr.com/ru/post/48960/">https://habr.com/ru/post/48960/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../48952/index.html">Ruby && Python && Perl && PHP && Ruby1.9</a></li>
<li><a href="../48953/index.html">Federal Online Exam - bugs and features</a></li>
<li><a href="../48954/index.html">Working with the clipboard in Linux: theory and practice</a></li>
<li><a href="../48955/index.html">Subtleties of routing in the Zend Framework</a></li>
<li><a href="../48956/index.html">InTV.ru: painless video viewing</a></li>
<li><a href="../48961/index.html">Let's beat Ruby together! Drop six</a></li>
<li><a href="../48963/index.html">Ribbon? It's simple! or working with cascading style sheets (CSS) in Qt</a></li>
<li><a href="../48968/index.html">IE8: the most complete description of innovations for the programmer (and not only)</a></li>
<li><a href="../48970/index.html">Search for menu functions in the program</a></li>
<li><a href="../48971/index.html">Is it easy to be young?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>