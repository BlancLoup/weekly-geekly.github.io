<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Natural animation in interfaces</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Fig. 0. KDPV 


 Animation in the interface makes it obvious to change its state. For example, if unsuccessful, a long form is scrolled to an incorrec...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Natural animation in interfaces</h1><div class="post__text post__text-html js-mediator-article"><p></p><div style="text-align:center;"><img src="https://tex.s2cms.ru/svg/%5Cbegin%7Btikzpicture%7D%0A%5Cdef%5Ct%7B0%7D%0A%5Cdef%5Cr%7B3.1415%7D%0A%5Cbegin%7Baxis%7D%5Bwidth%3D12cm%2Cheight%3D7cm%2C%0A%20%20%20%20ticks%3Dnone%2C%0A%20%20%20%20xmin%3D-0.5%2C%20xmax%3D3.8%2C%0A%20%20%20%20axis%20y%20line%3Dleft%2Caxis%20x%20line%3Dbottom%2C%0A%20%20%20%20xlabel%3D%24t%24%2Cylabel%3D%24x%24%2C%20%0Aevery%20axis%20x%20label%2F.style%3D%7Bat%3D%7B(current%20axis.south%20east)%7D%2Canchor%3Dsouth%7D%2C%0Aevery%20axis%20y%20label%2F.style%3D%7Bat%3D%7B(current%20axis.north%20west)%7D%2Canchor%3Dwest%7D%2C%0Aenlargelimits%3Dtrue%2Cmark%20size%3D1%0A%20%20%20%20%5D%0A%5Caddplot%5Bsmooth%2Cblue%2Cdomain%3D%5Ct%3A%5Cr%2Csamples%3D80%5D%20%7B1-cos(deg(x*3))%7D%3B%0A%5Caddplot%5Bmark%3D*%5D%20coordinates%20%7B(%5Ct%2C0)%7D%3B%0A%5Caddplot%5Bmark%3D*%5D%20coordinates%20%7B(%5Cr%2C2)%7D%3B%0A%5Cend%7Baxis%7D%0A%5Cend%7Btikzpicture%7D" alt="\ begin {tikzpicture} \ def \ t {0} \ def \ r {3.1415} \ begin {axis} [width = 12cm, height = 7cm, ticks = none, xmin = -0.5, xmax = 3.8, axis y line = left, axis x line = bottom, xlabel = $ t $, ylabel = $ x $, every axis x label / .style = {at = {(current axis.south east)}, anchor = south}, every axis y label /.style= subatt= ((current axis.north west)}, anchor = west}, enlargelimits = true, mark size = 1] \ addplot [smooth, blue, domain = \ t: \ r, samples = 80] {1-cos (deg (x * 3))}; \ addplot [mark = *] coordinates {(\ t, 0)}; \ addplot [mark = *] coordinates {(\ r, 2)}; \ end {axis} \ end {tikzpicture}"></div><p></p><br><p>  <font color="#666"><em>Fig.</em></font>  <font color="#666"><em>0. KDPV</em></font> </p><br><p>  Animation in the interface makes it obvious to change its state.  For example, if unsuccessful, a long form is scrolled to an incorrectly filled field.  Or an enlarged photo pushes the surrounding elements apart. </p><br><p>  Without animation, it is harder to perceive sudden and sudden changes.  However, the animation should be short and unobtrusive, so as not to disturb the user. </p><br><p>  Animation seems natural when it repeats the usual movement of objects around the world.  Under the cut, I'll tell you how I did the animation based on physical laws.  See the <a href="https://parpalak.github.io/demo/sin-animate.html">finished result on the demo page</a> (there one block follows another while moving the mouse). <br><a name="habracut"></a></p><br><h2>  Remember the physics </h2><br><p> Moving objects is described by changing the <em>x</em> coordinates over time <em>t</em> .  If you try to pick up the function <em>x</em> ( <em>t</em> ) "by eye", you will spend a lot of time achieving smooth and natural movement.  What to choose?  Hyperbole?  Parabola?  Where to move it?  How to turn? </p><br><p>  For examples of movement it is best to turn to the objects of the surrounding world.  The mathematical law of their movement is dictated by physics.  Push the bar lying on the table.  It travels a certain distance, slowing down by the action of friction.  In a good approximation, the force of dry sliding friction is constant, and the dependence <em>x</em> ( <em>t</em> ) turns out to be a parabola.  This slowdown can be used if the animation object has already moved at the initial moment. </p><br><p></p><div style="text-align:center;"><img src="https://tex.s2cms.ru/svg/%5Cbegin%7Btikzpicture%7D%0A%5Cdef%5Ct%7B0%7D%0A%5Cdef%5Cr%7B3.4%7D%0A%5Cbegin%7Baxis%7D%5Bwidth%3D10cm%2Cheight%3D7cm%2C%0A%20%20%20%20ticks%3Dnone%2C%0A%20%20%20%20xmin%3D-0%2C%20xmax%3D3.8%2C%0A%20%20%20%20axis%20y%20line%3Dleft%2Caxis%20x%20line%3Dbottom%2C%0A%20%20%20%20xlabel%3D%24t%24%2Cylabel%3D%24x%24%2C%20%0Aevery%20axis%20x%20label%2F.style%3D%7Bat%3D%7B(current%20axis.south%20east)%7D%2Canchor%3Dsouth%7D%2C%0Aevery%20axis%20y%20label%2F.style%3D%7Bat%3D%7B(current%20axis.north%20west)%7D%2Canchor%3Dwest%7D%2C%0Aenlargelimits%3Dtrue%2Cmark%20size%3D1%0A%20%20%20%20%5D%0A%5Caddplot%5Bsmooth%2Cblue%2Cdomain%3D%5Ct%3A%5Cr%2Csamples%3D80%5D%7B-(x-%5Cr)%5E2%7D%20node%5Bpos%3D0.75%2Cblack%2Canchor%3Dsouth%20east%2Cinner%20sep%3D2pt%5D%7B%24x%3DA%2BBt%2BCt%5E2%24%7D%3B%0A%5Caddplot%5Bdashed%2Cdomain%3D%5Cr-0.7%3A%5Cr%2Csamples%3D2%5D%7B0%7D%3B%0A%5Caddplot%5Bmark%3D*%5D%20coordinates%20%7B(%5Ct%2C-%5Cr*%5Cr)%7D%3B%0A%5Caddplot%5Bmark%3D*%2Cgreen!50!black%5D%20coordinates%20%7B(%5Cr%2C0)%7D%20node%5Bpin%3D-90%3A%7B%5Cscriptsize%7B%5Ctext%7B%D0%BF%D0%BB%D0%B0%D0%B2%D0%BD%D0%B0%D1%8F%20%D0%BE%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0%20%3A)%7D%7D%7D%5D%7B%7D%3B%0A%5Cend%7Baxis%7D%0A%5Cend%7Btikzpicture%7D" alt="\ begin {tikzpicture} \ def \ t {0} \ def \ r {3.4} \ begin {axis} [width = 10cm, height = 7cm, ticks = none, xmin = -0, xmax = 3.8, axis y line = left, axis x line = bottom, xlabel = $ t $, ylabel = $ x $, every axis x label / .style = {at = {(current axis.south east)}, anchor = south}, every axis y label /.style= subatt= ((current axis.north west)}, anchor = west}, enlargelimits = true, mark size = 1] \ addplot [smooth, blue, domain = \ t: \ r, samples = 80] {- (x- \ r) ^ 2} node [pos = 0.75, black, anchor = south east, inner sep = 2pt] {$ x = A + Bt + Ct ^ 2 $}; \ addplot [dashed, domain = \ r-0.7: \ r, samples = 2] {0}; \ addplot [mark = *] coordinates {(\ t, - \ r * \ r)}; \ addplot [mark = *, green! 50! black] coordinates {(\ r, 0)} node [pin = -90: {\ scriptsize {\ text {soft stop:)}}}] {}; \ end {axis} \ end {tikzpicture}"></div><p></p><br><p>  <font color="#666"><em>Fig.</em></font>  <font color="#666"><em>1. Braking by dry friction on a parabola</em></font> </p><br><p>  The force of viscous friction is proportional to the speed of the body.  In this case, the body will move to the stopping point exponentially for an infinitely long time.  If the exhibitor is distorted in order to limit the time of movement, such animation will seem unnatural.  Due to difficulties in stopping at a reasonable time, one should not use the model of viscous friction only if the simulation of viscous friction itself is not the goal. </p><br><p></p><div style="text-align:center;"><img src="https://tex.s2cms.ru/svg/%5Cbegin%7Btikzpicture%7D%0A%5Cdef%5Ct%7B0%7D%0A%5Cdef%5Cr%7B3.8%7D%0A%5Cbegin%7Baxis%7D%5Bwidth%3D10cm%2Cheight%3D7cm%2C%0A%20%20%20%20ticks%3Dnone%2C%0A%20%20%20%20xmin%3D-0%2C%20xmax%3D3.8%2C%0A%20%20%20%20axis%20y%20line%3Dleft%2Caxis%20x%20line%3Dbottom%2C%0A%20%20%20%20xlabel%3D%24t%24%2Cylabel%3D%24x%24%2C%20%0Aevery%20axis%20x%20label%2F.style%3D%7Bat%3D%7B(current%20axis.south%20east)%7D%2Canchor%3Dsouth%7D%2C%0Aevery%20axis%20y%20label%2F.style%3D%7Bat%3D%7B(current%20axis.north%20west)%7D%2Canchor%3Dwest%7D%2C%0Aenlargelimits%3Dtrue%2Cmark%20size%3D1%0A%20%20%20%20%5D%0A%5Caddplot%5Bsmooth%2Cblue%2Cdomain%3D%5Ct%3A%5Cr%2Csamples%3D80%5D%20%7B1-exp(-x*1.0)%7D%20node%5Bpos%3D0.45%2Cblack%2Canchor%3Dsouth%20east%2Cinner%20sep%3D2pt%5D%7B%24x%3DA-Be%5E%7B-%5Calpha%20t%7D%24%7D%3B%0A%5Caddplot%5Bdashed%2Cdomain%3D%5Ct%3A%5Cr%2Csamples%3D2%5D%7B1%7D%3B%0A%5Caddplot%5Bmark%3D*%5D%20coordinates%20%7B(%5Ct%2C0)%7D%3B%0A%5Caddplot%5Bred!80!black%5D%20coordinates%20%7B(3.4%2C1)%7D%20node%5Bpin%3D-90%3A%7B%5Cscriptsize%7B%5Ctext%7B%D0%BD%D0%B5%20%D0%BE%D1%81%D1%82%D0%B0%D0%BD%D0%B0%D0%B2%D0%BB%D0%B8%D0%B2%D0%B0%D0%B5%D1%82%D1%81%D1%8F%20%3A(%7D%7D%7D%5D%7B%7D%20%3B%0A%5Cend%7Baxis%7D%0A%5Cend%7Btikzpicture%7D" alt="\ begin {tikzpicture} \ def \ t {0} \ def \ r {3.8} \ begin {axis} [width = 10cm, height = 7cm, ticks = none, xmin = -0, xmax = 3.8, axis y line = left, axis x line = bottom, xlabel = $ t $, ylabel = $ x $, every axis x label / .style = {at = {(current axis.south east)}, anchor = south}, every axis y label /.style= subatt= ((current axis.north west)}, anchor = west}, enlargelimits = true, mark size = 1] \ addplot [smooth, blue, domain = \ t: \ r, samples = 80] {1-exp (-x * 1.0)} node [pos = 0.45, black, anchor = south east, inner sep = 2pt] {$ x = A-Be ^ {- \ alpha t} $}; \ addplot [dashed, domain = \ t: \ r, samples = 2] {1}; \ addplot [mark = *] coordinates {(\ t, 0)}; \ addplot [red! 80! black] coordinates {(3.4,1)} node [pin = -90: {\ scriptsize {\ text {does not stop: (}}}] {}; \ end {axis} \ end { tikzpicture}"></div><p></p><br><p>  <font color="#666"><em>Fig.</em></font>  <font color="#666"><em>2. Braking exponentially in a viscous medium</em></font> </p><br><p>  The pendulum deviated from the equilibrium position (or the weight on the spring) smoothly picks up speed, passes the equilibrium position and smoothly slows down.  Then the movement is repeated in the opposite direction, and so on to infinity (if there is no friction).  The schedule of such movement is a sinusoid.  Periodic repetition is not particularly interesting to us, but the movement of the pendulum between the extreme points is smooth and natural. </p><br><p></p><div style="text-align:center;"><img src="https://tex.s2cms.ru/svg/%5Cbegin%7Btikzpicture%7D%0A%5Cdef%5Ct%7B0%7D%0A%5Cdef%5Cr%7B3.1415%7D%0A%5Cbegin%7Baxis%7D%5Bwidth%3D10cm%2Cheight%3D7cm%2C%0A%20%20%20%20ticks%3Dnone%2Cmark%20size%3D1%2C%0A%20%20%20%20xmin%3D-0.5%2C%20xmax%3D3.6%2C%0A%20%20%20%20axis%20y%20line%3Dleft%2Caxis%20x%20line%3Dbottom%2C%0A%20%20%20%20xlabel%3D%24t%24%2Cylabel%3D%24x%24%2C%20%0Aevery%20axis%20x%20label%2F.style%3D%7Bat%3D%7B(current%20axis.south%20east)%7D%2Canchor%3Dsouth%7D%2C%0Aevery%20axis%20y%20label%2F.style%3D%7Bat%3D%7B(current%20axis.north%20west)%7D%2Canchor%3Dwest%7D%2C%0Aenlargelimits%3Dtrue%0A%20%20%20%20%5D%0A%5Caddplot%5Bsmooth%2Cblue%2Cdomain%3D%5Ct%3A%5Cr%2Csamples%3D80%5D%20%7B1-cos(deg(x))%7D%20node%5Bpos%3D0.52%2Cblack%2Canchor%3Dsouth%20east%2Cinner%20sep%3D2pt%5D%7B%24x%3DA-B%5Ccos%5Comega%20t%24%7D%3B%0A%5Caddplot%5Bdashed%2Cdomain%3D%5Ct%3A%5Ct%2B0.6%2Csamples%3D2%5D%20%7B1-cos(deg(%5Ct))%7D%3B%0A%5Caddplot%5Bdashed%2Cdomain%3D%5Cr-0.6%3A%5Cr%2Csamples%3D2%5D%20%7B1-cos(deg(%5Cr))%7D%3B%0A%5Caddplot%5Bmark%3D*%2Cgreen!50!black%5D%20coordinates%20%7B(%5Ct%2C0)%7D%20node%5Bpin%3D90%3A%7B%5Cscriptsize%7B%5Ctext%7B%D0%BF%D0%BB%D0%B0%D0%B2%D0%BD%D1%8B%D0%B9%20%D0%B7%D0%B0%D0%BF%D1%83%D1%81%D0%BA%20%3A)%7D%7D%7D%5D%7B%7D%3B%0A%5Caddplot%5Bmark%3D*%2Cgreen!50!black%5D%20coordinates%20%7B(%5Cr%2C2)%7D%20node%5Bpin%3D-90%3A%7B%5Cscriptsize%7B%5Ctext%7B%5Cquad%20%D0%BF%D0%BB%D0%B0%D0%B2%D0%BD%D0%B0%D1%8F%20%D0%BE%D1%81%D1%82%D0%B0%D0%BD%D0%BE%D0%B2%D0%BA%D0%B0%20%3A)%7D%7D%7D%5D%7B%7D%3B%0A%5Cend%7Baxis%7D%0A%5Cend%7Btikzpicture%7D" alt="\ begin {tikzpicture} \ def \ t {0} \ def \ r {3.1415} \ begin {axis} [width = 10cm, height = 7cm, ticks = none, mark size = 1, xmin = -0.5, xmax = 3.6 , axis y line = left, axis x line = bottom, xlabel = $ t $, ylabel = $ x $, every axis x label / .style = {at = {(current axis.south east)}, anchor = south} , every axis y label / .style = {at = {(current axis.north west)}, anchor = west}, enlargelimits = true] \ addplot [smooth, blue, domain = \ t: \ r, samples = 80] {1-cos (deg (x))} node [pos = 0.52, black, anchor = south east, inner sep = 2pt] {$ x = AB \ cos \ omega t $}; \ addplot [dashed, domain = \ t: \ t + 0.6, samples = 2] {1-cos (deg (\ t))}; \ addplot [dashed, domain = \ r-0.6: \ r, samples = 2] {1-cos (deg (\ r))}; \ addplot [mark = *, green! 50! black] coordinates {(\ t, 0)} node [pin = 90: {\ scriptsize {\ text {soft start:)}}}] {}; \ addplot [mark = *, green! 50! black] coordinates {(\ r, 2)} node [pin = -90: {\ scriptsize {\ text {\ quad smooth stop:)}}}] {}; \ end {axis} \ end {tikzpicture}"></div><p></p><br><p>  <font color="#666"><em>Fig.</em></font>  <font color="#666"><em>3. The motion of the pendulum in a sinusoid between the extreme points</em></font> </p><br><p>  In JS-libraries and CSS there are <a href="http://easings.net/ru">presets of easing-functions</a> for creating special effects.  Almost all blanks should be used in special cases with caution.  Only a sinusoid is more or less universal. </p><br><p>  First, the sinusoidal trajectory translates the body from one resting position to another.  Secondly, the duration of such a movement is half the period.  Movement is time limited.  Duration does not depend on external circumstances and initial conditions.  It depends only on the properties of the system itself and is determined by the ratio of stiffness and inertia. </p><br><p>  Usually I choose the duration of the animation on a sine wave of 200 milliseconds.  Such a duration is several times longer than the human response time.  The animation is well marked, but does not have time to annoy. </p><br><p>  Let's learn how to conduct a sinusoidal trajectory according to the initial conditions, the time of movement and the stop point. </p><br><h2>  How to draw a sine wave through two points </h2><br><p>  Let the body rest at the initial and final moment of time.  Then the tangents to the graph at the points <em>t</em> <sub>1</sub> and <em>t</em> <sub>2 are</sub> horizontal, and the graph itself is the half-period of the sinusoid. </p><br><p></p><div style="text-align:center;"><img src="https://tex.s2cms.ru/svg/%5Cbegin%7Btikzpicture%7D%0A%5Cdef%5Ct%7B0%7D%0A%5Cdef%5Cr%7B3.1415%7D%0A%5Cbegin%7Baxis%7D%5B%0A%20%20%20%20ticks%3Dnone%2C%0A%20%20%20%20xmin%3D-1%2C%20xmax%3D4.5%2C%0A%20%20%20%20axis%20y%20line%3Dleft%2Caxis%20x%20line%3Dbottom%2C%0A%20%20%20%20xlabel%3D%24t%24%2Cylabel%3D%24x%24%2C%20%0Aevery%20axis%20x%20label%2F.style%3D%7Bat%3D%7B(current%20axis.south%20east)%7D%2Canchor%3Dsouth%7D%2C%0Aevery%20axis%20y%20label%2F.style%3D%7Bat%3D%7B(current%20axis.north%20west)%7D%2Canchor%3Dwest%7D%2C%0Aenlargelimits%3Dtrue%0A%20%20%20%20%5D%0A%20%20%20%20%5Caddplot%5Bsmooth%2Cblue%2Cdomain%3D%5Ct%3A%5Cr%2Csamples%3D80%5D%20%0A%20%20%20%20%20%20%20%20%7B1-cos(deg(x))%7D%3B%0A%20%20%20%20%5Caddplot%5Bdashed%2Cdomain%3D%5Ct%3A%5Ct%2B1%2Csamples%3D2%5D%20%0A%20%20%20%20%20%20%20%20%7B1-cos(deg(%5Ct))%7D%3B%0A%20%20%20%20%5Caddplot%5Bdashed%2Cdomain%3D%5Cr-1%3A%5Cr%2Csamples%3D2%5D%20%0A%20%20%20%20%20%20%20%20%7B1-cos(deg(%5Cr))%7D%3B%0A%5Caddplot%5Bmark%3D*%2Cmark%20size%3D1%5D%20coordinates%20%7B(%5Ct%2C0)%7D%20node%5Bpin%3D95%3A%7B%24(t_1%2Cx_1)%24%7D%5D%7B%7D%20%3B%0A%5Caddplot%5Bmark%3D*%2Cmark%20size%3D1%5D%20coordinates%20%7B(%5Cr%2C2)%7D%20node%5Bpin%3D-85%3A%7B%24(t_2%2Cx_2)%24%7D%5D%7B%7D%20%3B%0A%5Cend%7Baxis%7D%0A%5Cend%7Btikzpicture%7D" alt="\ begin {tikzpicture} \ def \ t {0} \ def \ r {3.1415} \ begin {axis} [ticks = none, xmin = -1, xmax = 4.5, axis y line = left, x axis = bottom, xlabel = $ t $, ylabel = $ x $, every axis x label / .style = {at = {(current axis.south east)}, anchor = south}, every axis y label / .style = {at = { (current axis.north west)}, anchor = west}, enlargelimits = true] \ addplot [smooth, blue, domain = \ t: \ r, samples = 80] {1-cos (deg (x))}; \ addplot [dashed, domain = \ t: \ t + 1, samples = 2] {1-cos (deg (\ t))}; \ addplot [dashed, domain = \ r-1: \ r, samples = 2] {1-cos (deg (\ r))}; \ addplot [mark = *, mark size = 1] coordinates {(\ t, 0)} node [pin = 95: {$ (t_1, x_1) $}] {}; \ addplot [mark = *, mark size = 1] coordinates {(\ r, 2)} node [pin = -85: {$ (t_2, x_2) $}] {}; \ end {axis} \ end {tikzpicture}"></div><p></p><br><p>  <font color="#666"><em>Fig.</em></font>  <font color="#666"><em>4. Schedule of movement between two positions of rest</em></font> </p><br><p>  The equation describing the half-period of a sinusoid is easy to choose: </p><br><p></p><div style="text-align:center;"><img src="https://tex.s2cms.ru/svg/x(t)%3Dx_1%2B%7Bx_2-x_1%5Cover%202%7D%5Cleft%5B1%20-%20%5Ccos%5Cleft(%5Cpi%7Bt-t_1%5Cover%20t_2-t_1%7D%5Cright)%5Cright%5D." alt="x (t) = x_1 + {x_2-x_1 \ over 2} \ left [1 - \ cos \ left (\ pi {t-t_1 \ over t_2-t_1} \ right) \ right]."></div><p></p><br><p>  After the end of one animation, we can start another one again using this formula.  But what if the new animation should start before the old one is over?  To ensure smooth movement, we stop the current animation (blue line) and start a new animation (red line) with a non-zero initial speed: </p><br><p></p><div style="text-align:center;"><img src="https://tex.s2cms.ru/svg/%5Cbegin%7Btikzpicture%7D%0A%5Cdef%5Ctgnt%7B0.7%7D%0A%5Cdef%5Ct%7B0%7D%0A%5Cdef%5Cr%7B3.1415%7D%0A%5Cdef%5Ctb%7B1%7D%0A%5Cdef%5Crb%7B%5Cr%2B%5Ctb%7D%0A%5Cdef%5Cdx%7B1.27%7D%0A%5Cbegin%7Baxis%7D%5B%0A%20%20%20%20ticks%3Dnone%2C%0A%20%20%20%20xmin%3D-1%2C%20xmax%3D4.9%2C%0A%20%20%20%20axis%20y%20line%3Dleft%2Caxis%20x%20line%3Dbottom%2C%0A%20%20%20%20xlabel%3D%24t%24%2Cylabel%3D%24x%24%2C%20%0Aevery%20axis%20x%20label%2F.style%3D%7Bat%3D%7B(current%20axis.south%20east)%7D%2Canchor%3Dsouth%7D%2C%0Aevery%20axis%20y%20label%2F.style%3D%7Bat%3D%7B(current%20axis.north%20west)%7D%2Canchor%3Dwest%7D%2C%0Aenlargelimits%3Dtrue%2Cmark%20size%3D1%0A%20%20%20%20%5D%0A%20%20%20%20%5Caddplot%5Bsmooth%2Cblue%2Cdomain%3D%5Ct%3A%5Ctb%2Csamples%3D80%5D%20%0A%20%20%20%20%20%20%20%20%7B-cos(deg(x))%2B1%7D%3B%0A%20%20%20%20%5Caddplot%5Bsmooth%2Cdotted%2Cblue%2Cdomain%3D%5Ctb%3A%5Cr%2Csamples%3D10%5D%20%0A%20%20%20%20%20%20%20%20%7B-cos(deg(x))%2B1%7D%3B%0A%20%20%20%20%5Caddplot%5Bblue%2Cdashed%2C%0A%20%20%20%20%20%20%20%20%20domain%3D%5Ct%3A%5Ct%2B%5Ctgnt%2Csamples%3D2%5D%20%0A%20%20%20%20%20%20%20%20%7B-cos(deg(%5Ct))%2B1%7D%3B%0A%20%20%20%20%5Caddplot%5Bsmooth%2Cthick%2Cred%2Cdomain%3D%5Ctb%3A%5Crb%2Csamples%3D80%5D%20%0A%20%20%20%20%20%20%20%20%7B-1.5*cos(deg(1%2B0.69*(x-%5Ctb)))%2B%5Cdx%7D%3B%0A%20%20%20%20%5Caddplot%5Bdashed%2Cred%2Cdomain%3D%5Ctb-%5Ctgnt%3A%5Ctb%2B%5Ctgnt%2Csamples%3D2%5D%20%0A%20%20%20%20%20%20%20%20%7B-1.5*cos(deg(%5Ctb))%2B%5Cdx%2Bsin(deg(%5Ctb))*(x-%5Ctb)%7D%3B%0A%20%20%20%20%5Caddplot%5Bdashed%2Cred%2Cdomain%3D%5Crb-%5Ctgnt%3A%5Crb%2Csamples%3D2%5D%20%0A%20%20%20%20%20%20%20%20%7B1.5%2B%5Cdx%7D%3B%0A%5Caddplot%5Bmark%3D*%5D%20coordinates%20%7B(%5Ct%2C0)%7D%3B%0A%5Caddplot%5Bmark%3D*%5D%20coordinates%20%7B(%5Ctb%2C1-cos(deg(%5Ctb)))%7D%20node%5Bpin%3D-85%3A%7B%24(t_1%2Cx_1)%24%7D%5D%7B%7D%20%3B%0A%5Caddplot%5Bmark%3D*%5D%20coordinates%20%7B(%5Cr%2C2)%7D%3B%0A%5Caddplot%5Bmark%3D*%5D%20coordinates%20%7B(%5Crb%2C1.5%2B%5Cdx)%7D%20node%5Bpin%3D-85%3A%7B%24(t_2%2Cx_2)%24%7D%5D%7B%7D%20%3B%0A%5Cend%7Baxis%7D%0A%5Cend%7Btikzpicture%7D" alt="\ begin {tikzpicture} \ def \ tgnt {0.7} \ def \ t {0} \ def \ r {3.1415} \ def \ tb {1} \ def \ rb {\ r + \ tb} \ def \ dx {1.27} \ begin {axis} [ticks = none, xmin = -1, xmax = 4.9, axis y line = left, axis x line = bottom, xlabel = $ t $, ylabel = $ x $, every axis x label / .style = {at = {(current axis.south east)}, anchor = south}, every axis y label / .style = {at = {(current axis.north west)}, anchor = west}, enlargelimits = true, mark size = 1] \ addplot [smooth, blue, domain = \ t: \ tb, samples = 80] {-cos (deg (x)) + 1}; \ addplot [smooth, dotted, blue, domain = \ tb: \ r, samples = 10] {-cos (deg (x)) + 1}; \ addplot [blue, dashed, domain = \ t: \ t + \ tgnt, samples = 2] {-cos (deg (\ t)) + 1}; \ addplot [smooth, thick, red, domain = \ tb: \ rb, samples = 80] {-1.5 * cos (deg (1 + 0.69 * (x- \ tb))) + \ dx}; \ addplot [dashed, red, domain = \ tb- \ tgnt: \ tb + \ tgnt, samples = 2] {-1.5 * cos (deg (\ tb)) + \ dx + sin (deg (\ tb)) * ( x- \ tb)}; \ addplot [dashed, red, domain = \ rb- \ tgnt: \ rb, samples = 2] {1.5+ \ dx}; \ addplot [mark = *] coordinates {(\ t, 0)}; \ addplot [mark = *] coordinates {(\ tb, 1-cos (deg (\ tb)))} node [pin = -85: {$ (t_1, x_1) $}] {}; \ addplot [mark = *] coordinates {(\ r, 2)}; \ addplot [mark = *] coordinates {(\ rb, 1.5 + \ dx)} node [pin = -85: {$ (t_2, x_2) $}] {}; \ end {axis} \ end {tikzpicture}"></div><p></p><br><p>  <font color="#666"><em>Fig.</em></font>  <font color="#666"><em>5. The schedule of movement with a non-zero initial speed</em></font> </p><br><p>  Without mathematical calculations, it is impossible to write a formula corresponding to the red line.  Let's do this calculation. </p><br><p>  The family of all possible sine waves is described by the equation </p><br><p><img align="right" src="https://tex.s2cms.ru/svg/(1)"></p><div style="text-align:center;"><img src="https://tex.s2cms.ru/svg/f(t)%3DA%5Ccos%5Comega%20(t-t_2)%2BB%5Csin%5Comega%20(t-t_2)%2BC" alt="f (t) = A \ cos \ omega (t-t_2) + B \ sin \ omega (t-t_2) + C"></div><p></p><br><p>  with four unknown parameters <em>A</em> , <em>B</em> , <em>C</em> and <img src="https://tex.s2cms.ru/svg/%5Comega%3E0" alt="\ omega &amp; gt; 0">  .  I shifted the beginning of the time report to the point <em>t</em> <sub>2</sub> in order to immediately get rid of the second term.  Indeed, the derivative <img src="https://tex.s2cms.ru/svg/f'(t_2)%3DB%5Comega" alt="f '(t_2) = B \ omega">  must be zero because the tangent at <em>t</em> <sub>2 is</sub> horizontal.  This is possible when <em>B</em> = 0. </p><br><p>  Because <img src="https://tex.s2cms.ru/svg/f(t_2)%3Dx_2" alt="f (t_2) = x_2">  then substituting <img src="https://tex.s2cms.ru/svg/t%3Dt_2" alt="t = t_2">  in (1), we get <img src="https://tex.s2cms.ru/svg/f(t_2)%3DA%2BC" alt="f (t_2) = A + C">  .  From here we exclude <em>C</em> : </p><br><p></p><div style="text-align:center;"><img src="https://tex.s2cms.ru/svg/f(t)%3Dx_2%20%2B%20A%5Cleft%5B%5Ccos%5Comega%20(t-t_2)-1%5Cright%5D." alt="f (t) = x_2 + A \ left [\ cos \ omega (t-t_2) -1 \ right]."></div><p></p><br><p>  Differentiate to find speed </p><br><br><p></p><div style="text-align:center;"><img src="https://tex.s2cms.ru/svg/f'(t)%3D-A%5C%2C%5Comega%5Csin%5Comega%20(t-t_2)." alt="f '(t) = - A \, \ omega \ sin \ omega (t-t_2)."></div><p></p><br><p>  We know the position <em>x</em> <sub>1</sub> and velocity <em>v</em> at the initial moment of time: </p><br><p></p><div style="text-align:center;"><img src="https://tex.s2cms.ru/svg/%5Cbegin%7Bcases%7D%0Ax_1%5C!%5C!%5C!%5C!%5C!%26%3Dx_2%2BA%5Cleft%5B%5Ccos%5Comega(t_1-t_2)-1%5Cright%5D%2C%5C%5C%0Av%5C!%5C!%5C!%5C!%5C!%26%3D-A%5C%2C%5Comega%5Csin%5Comega(t_1-t_2).%0A%5Cend%7Bcases%7D" alt="\ begin {cases} x_1 \! \! \! \! \! &amp; amp; = x_2 + A \ left [\ cos \ omega (t_1-t_2) -1 \ right], \\ v \! \! \! \ ! \! &amp; amp; = - A \, \ omega \ sin \ omega (t_1-t_2). \ end {cases}"></div><p></p><br><p>  From this system of equations, you need to find <em>A</em> and <img src="https://tex.s2cms.ru/svg/%5Comega" alt="\ omega">  .  It's time to introduce a new variable <img src="https://tex.s2cms.ru/svg/k%3D%5Comega(t_2-t_1)" alt="k = \ omega (t_2-t_1)">  instead <img src="https://tex.s2cms.ru/svg/%5Comega" alt="\ omega">  .  Its meaning is the phase difference of the sinusoid at the start and end point.  For example, for the graph in fig.  four <img src="https://tex.s2cms.ru/svg/k%3D%5Cpi" alt="k = \ pi">  because on the gap <img src="https://tex.s2cms.ru/svg/(t_1%2Ct_2)" alt="(t_1, t_2)">  Fits half the sinusoid.  In fig.  five <img src="https://tex.s2cms.ru/svg/k%3C%5Cpi" alt="k &amp; lt; \ pi">  , because <img src="https://tex.s2cms.ru/svg/t_2-t_1" alt="t_2-t_1">  less than half the period. </p><br><p>  After substitution and small transformations, we arrive at the system </p><br><p></p><div style="text-align:center;"><img src="https://tex.s2cms.ru/svg/%5Cbegin%7Bcases%7D%0Ax_2-x_1%26%3DA%5Cleft(1-%5Ccos%20k%5Cright)%2C%5C%5C%0Av(t_2-t_1)%5C!%5C!%5C!%5C!%26%3DA%5C%2Ck%5Csin%20k.%0A%5Cend%7Bcases%7D" alt="\ begin {cases} x_2-x_1 &amp; amp; = A \ left (1- \ cos k \ right), \\ v (t_2-t_1) \! \! \! \! &amp; amp; = A \, k \ sin k. \ end {cases}"></div><p></p><br><p>  Let us divide by first the first equation by the second: </p><br><p></p><div style="text-align:center;"><img src="https://tex.s2cms.ru/svg/%7Bx_2-x_1%5Cover%20v(t_2-t_1)%7D%3D%7B1-%5Ccos%20k%5Cover%20k%5Csin%20k%7D%5Cquad%0A%5CRightarrow%5Cquad%7B1-%5Ccos%20k%5Cover%5Csin%20k%7D%3D%5Calpha%20k%2C%5Cquad%5Ctext%7B%D0%B3%D0%B4%D0%B5%7D%0A%5C%20%5Calpha%3D%7Bx_2-x_1%5Cover%20v(t_2-t_1)%7D." alt="{x_2-x_1 \ over v (t_2-t_1)} = {1- \ cos k \ over k \ sin k} \ quad \ Rightarrow \ quad {1- \ cos k \ over \ sin k} = \ alpha k, \ quad \ text {where} \ \ alpha = {x_2-x_1 \ over v (t_2-t_1)}."></div><p></p><br><p>  Parameter <img src="https://tex.s2cms.ru/svg/%5Calpha" alt="\ alpha">  on the right side is known in advance.  It determines the desired nature of the movement.  If a <img src="https://tex.s2cms.ru/svg/%5Calpha%5Cgg1" alt="\ alpha \ gg1">  , then the initial speed is small, the body must first accelerate.  If a <img src="https://tex.s2cms.ru/svg/%5Calpha%5Cll1" alt="\ alpha \ ll1">  , the initial speed is great, the body should slow down. </p><br><p>  Trigonometric functions on the left side are reduced to the half-angle tangent.  As a result, we have a nonlinear equation for <em>k</em> : </p><br><p><img align="right" src="https://tex.s2cms.ru/svg/(2)"></p><div style="text-align:center;"><img src="https://tex.s2cms.ru/svg/%5Ctext%7Btg%7D%5C%2C%7Bk%5Cover2%7D%3D%5Calpha%20k." alt="\ text {tg} \, {k \ over2} = \ alpha k."></div><p></p><br><p>  Analyze its solutions can be on the graph.  Draw a graph of the left and right side for some values ‚Äã‚Äãof the parameter <img src="https://tex.s2cms.ru/svg/%5Calpha" alt="\ alpha">  : </p><br><p></p><div style="text-align:center;"><img src="https://tex.s2cms.ru/svg/%5Cbegin%7Btikzpicture%7D%5Csmall%0A%5Cdef%5Caa%7B1.5%7D%0A%5Cdef%5Cab%7B0.3%7D%0A%5Cdef%5Cac%7B-0.5%7D%0A%5Cbegin%7Baxis%7D%5Blegend%20pos%3Dsouth%20east%2Cmark%20size%3D1%2Csamples%3D2%2C%0A%20%20%20%20restrict%20y%20to%20domain%3D-8%3A8%2C%0A%20%20%20%20width%3D12cm%2C%20height%3D250pt%2C%0A%20%20%20%20xmin%3D-10.5%2C%20xmax%3D10.5%2C%0A%20%20%20%20ytick%3D%7B-6%2C-3%2C...%2C6%7D%2C%0A%20%20%20%20xtick%3D%7B-9.4247%2C-3.1416%2C...%2C10%7D%2C%0A%20%20%20%20xticklabels%3D%7B%24-%7B3%5Cpi%7D%24%2C%24-%7B%5Cpi%7D%24%2C%24%7B%5Cpi%7D%24%2C%24%7B3%5Cpi%7D%24%7D%2C%0A%20%20%20%20axis%20x%20line%3Dcenter%2C%0A%20%20%20%20axis%20y%20line%3Dcenter%2C%0A%20%20%20%20xlabel%3D%24k%24%5D%0A%5Caddplot%5Bblue!70!black%2Cdomain%3D-9.4247%3A9.4247%2Csemithick%2Csamples%3D802%5D%7Btan(deg(x%2F2))%7D%3B%0A%5Caddplot%5Bred%5D%7B%5Caa*x%7D%3B%0A%5Caddplot%5Bgreen!70!black%2Cdomain%3D-9.4247%3A9.4247%5D%7B%5Cab*x%7D%3B%0A%5Caddplot%5Bolive%2Cdomain%3D-9.4247%3A9.4247%5D%7B%5Cac*x%7D%3B%0A%5Caddplot%5Bmark%3D*%5D%20coordinates%20%7B(2.65%2C3.97)%7D%20node%5Banchor%3Dwest%5D%7B%24A%24%7D%3B%0A%5Caddplot%5Bmark%3D*%5D%20coordinates%20%7B(8.69%2C2.61)%7D%20node%5Banchor%3Dwest%5D%7B%24B%24%7D%3B%0A%5Caddplot%5Bmark%3D*%5D%20coordinates%20%7B(4.06%2C-2.03)%7D%20node%5Banchor%3Dwest%5D%7B%24C%24%7D%3B%0A%5Clegend%7B%24%5Ctext%7Btg%7D%5C%2Ck%2F2%24%2C%24%5Caa%5C%2Ck%24%2C%24%5Cab%5C%2Ck%24%2C%24%5Cac%5C%2Ck%24%7D%0A%5Cend%7Baxis%7D%0A%5Cend%7Btikzpicture%7D" alt="\ begin {tikzpicture} \ small \ def \ aa {1.5} \ def \ ab {0.3} \ def \ ac {-0.5} \ begin {axis} [legend pos = south east, mark size = 1, samples = 2, restrict y to domain = -8: 8, width = 12cm, height = 250pt, xmin = -10.5, xmax = 10.5, ytick = {- 6, -3, ..., 6}, xtick = {- 9.4247, - 3.1416, ..., 10}, xticklabels = {$ - {3 \ pi} $, $ - {\ pi} $, $ {\ pi} $, $ {3 \ pi} $}, axis x line = center , axis y line = center, xlabel = $ k $] \ addplot [blue! 70! black, domain = -9.4247: 9.4247, semithick, samples = 802] {tan (deg (x / 2))}; \ addplot [red] {\ aa * x}; \ addplot [green! 70! black, domain = -9.4247: 9.4247] {\ ab * x}; \ addplot [olive, domain = -9.4247: 9.4247] {\ ac * x}; \ addplot [mark = *] coordinates {(2.65,3.97)} node [anchor = west] {$ A $}; \ addplot [mark = *] coordinates {(8.69,2.61)} node [anchor = west] {$ B $}; \ addplot [mark = *] coordinates {(4.06, -2.03)} node [anchor = west] {$ C $}; \ legend {$ \ text {tg} \, k / 2 $, $ \ aa \, k $, $ \ ab \, k $, $ \ ac \, k $} \ end {axis} \ end {tikzpicture}"></div><p></p><br><p>  <font color="#666"><em>Fig.</em></font>  <font color="#666"><em>6. Graphic solution of equation (2)</em></font> </p><br><p>  Let's discuss the resulting solutions. </p><br><ol><li><p>  Consider point <em>A.</em>  This solution exists when <img src="https://tex.s2cms.ru/svg/%5Calpha%3E1%2F2" alt="\ alpha &amp; gt; 1/2">  and corresponds to that shown in Figure 5: <img src="https://tex.s2cms.ru/svg/%5Cbegin%7Btikzpicture%7D%0A%5Cdef%5Ct%7B1%7D%0A%5Cdef%5Cr%7B3.1415%7D%0A%5Cbegin%7Baxis%7D%5Bwidth%3D1.9cm%2Cheight%3D2cm%2Chide%20axis%2Cticks%3Dnone%2C%0A%20xmin%3D%5Ct%2Cxmax%3D%5Cr%2Cmark%20size%3D0.3%5D%0A%5Caddplot%5Bsmooth%2Cblue%2Cdomain%3D%5Ct%3A%5Cr%2Csamples%3D80%5D%20%7B-cos(deg(x))%7D%3B%0A%5Caddplot%5Bmark%3D*%5D%20coordinates%20%7B(%5Ct%2C-cos(deg(x)))%7D%3B%0A%5Caddplot%5Bmark%3D*%5D%20coordinates%20%7B(%5Cr%2C-cos(deg(x)))%7D%3B%0A%5Cend%7Baxis%7D%0A%5Cend%7Btikzpicture%7D" alt="\ begin {tikzpicture} \ def \ t {1} \ def \ r {3.1415} \ begin {axis} [width = 1.9cm, height = 2cm, hide axis, ticks = x, xmin = \ t, xmax = \ r , mark size = 0.3] \ addplot [smooth, blue, domain = \ t: \ r, samples = 80] {-cos (deg (x))}; \ addplot [mark = *] coordinates {(\ t, -cos (deg (x)))}; \ addplot [mark = *] coordinates {(\ r, -cos (deg (x)))}; \ end {axis} \ end {tikzpicture}">  .  As was expected, <img src="https://tex.s2cms.ru/svg/k%3C%5Cpi" alt="k &amp; lt; \ pi">  .  In the zero speed limit <img src="https://tex.s2cms.ru/svg/%5Calpha%5Cto%5Cinfty" alt="\ alpha \ to \ infty">  , the red line will coincide with the axis of ordinates, the point A will go along the tangent to infinity.  In this limit <img src="https://tex.s2cms.ru/svg/k%5Cto%5Cpi" alt="k \ to \ pi">  .  So far everything is going right. </p><br></li><li><p>  Point <em>C</em> corresponds to the value <img src="https://tex.s2cms.ru/svg/%5Calpha%3C0" alt="\ alpha &amp; lt; 0">  .  This happens when the body moves forward at the first moment of time, and you have to move backwards.  Now <img src="https://tex.s2cms.ru/svg/%5Cpi%3Ck%3C2%5Cpi" alt="\ pi &amp; lt; k &amp; lt; 2 \ pi">  .  Movement is described by a fragment of a sinusoid, larger than a half-period, but smaller than the period: <br><img src="https://tex.s2cms.ru/svg/%5Cbegin%7Btikzpicture%7D%0A%5Cdef%5Ct%7B-1.7%7D%0A%5Cdef%5Cr%7B3.1415%7D%0A%5Cbegin%7Baxis%7D%5Bwidth%3D2.2cm%2Cheight%3D2cm%2Chide%20axis%2Cticks%3Dnone%2C%0A%20xmin%3D%5Ct%2Cxmax%3D%5Cr%2Cmark%20size%3D0.3%5D%0A%5Caddplot%5Bsmooth%2Cblue%2Cdomain%3D%5Ct%3A%5Cr%2Csamples%3D80%5D%20%7Bcos(deg(x))%7D%3B%0A%5Caddplot%5Bmark%3D*%5D%20coordinates%20%7B(%5Ct%2Ccos(deg(x)))%7D%3B%0A%5Caddplot%5Bmark%3D*%5D%20coordinates%20%7B(%5Cr%2Ccos(deg(x)))%7D%3B%0A%5Cend%7Baxis%7D%0A%5Cend%7Btikzpicture%7D" alt="\ begin {tikzpicture} \ def \ t {-1.7} \ def \ r {3.1415} \ begin {axis} [width = 2.2cm, height = 2cm, hide axis, ticks = x, xmin = \ t, xmax = \ r, mark size = 0.3] \ addplot [smooth, blue, domain = \ t: \ r, samples = 80] {cos (deg (x))}; \ addplot [mark = *] coordinates {(\ t, cos (deg (x)))}; \ addplot [mark = *] coordinates {(\ r, cos (deg (x)))}; \ end {axis} \ end {tikzpicture}">  .  The body slows down, stops, moves backwards and stops at the required place. </p><br></li><li><p>  From the graph you can see that when <img src="https://tex.s2cms.ru/svg/0%3C%5Calpha%3C1%2F2" alt="0 &amp; lt; \ alpha &amp; lt; 1/2">  point <em>B</em> falls into range <img src="https://tex.s2cms.ru/svg/2%5Cpi%3Ck%3C3%5Cpi" alt="2 \ pi &amp; lt; k &amp; lt; 3 \ pi">  .  The body will pass along a sinusoid more than the full period of oscillations <img src="https://tex.s2cms.ru/svg/%5Cbegin%7Btikzpicture%7D%0A%5Cdef%5Ct%7B-1.6%7D%0A%5Cdef%5Cr%7B2*3.1415%7D%0A%5Cbegin%7Baxis%7D%5Bwidth%3D2.5cm%2Cheight%3D2cm%2Chide%20axis%2Cticks%3Dnone%2C%0A%20xmin%3D%5Ct%2Cxmax%3D%5Cr%2Cmark%20size%3D0.3%5D%0A%5Caddplot%5Bsmooth%2Cblue%2Cdomain%3D%5Ct%3A%5Cr%2Csamples%3D80%5D%20%7Bcos(deg(x))%7D%3B%0A%5Caddplot%5Bmark%3D*%5D%20coordinates%20%7B(%5Ct%2Ccos(deg(x)))%7D%3B%0A%5Caddplot%5Bmark%3D*%5D%20coordinates%20%7B(%5Cr%2Ccos(deg(x)))%7D%3B%0A%5Cend%7Baxis%7D%0A%5Cend%7Btikzpicture%7D" alt="\ begin {tikzpicture} \ def \ t {-1.6} \ def \ r {2 * 3.1415} \ begin {axis} [width = 2.5cm, height = 2cm, hide axis, ticks = none, xmin = \ t, xmax = \ r, mark size = 0.3] \ addplot [smooth, blue, domain = \ t: \ r, samples = 80] {cos (deg (x))}; \ addplot [mark = *] coordinates {(\ t, cos (deg (x)))}; \ addplot [mark = *] coordinates {(\ r, cos (deg (x)))}; \ end {axis} \ end {tikzpicture}">  .  The reason for such a strange decision is that the stopping point is too close compared to the characteristic distance <em>v</em> ( <em>t</em> <sub>2</sub> - <em>t</em> <sub>1</sub> ).  Therefore, to hold a sine wave without an additional stop and return will not work. </p><br></li></ol><br><p></p><div class="spoiler">  <b class="spoiler_title">Pro quantum mechanics</b> <div class="spoiler_text">  Equations similar to (2) arise when solving problems of quantum mechanics about the energy levels of particles in rectangular potential wells.  There you have to sew, for example, a sine wave and an exponent.  The condition of the absence of kinks gives similar equations with an infinite number of roots. </div></div><p></p><br><h2>  Approximate solution </h2><br><p>  We solved the mathematical problem of carrying out a sinusoid, but life didn‚Äôt become easier.  First, to determine the parameters of the sine wave, it is necessary to solve the nonlinear equation (2).  Hi, iterative methods!  Secondly, the equation has an infinite number of solutions, and the required solution does not always exist. </p><br><p>  These difficulties arose from the fact that we fixed the duration of the animation at exactly 200 milliseconds.  However, nothing terrible will happen if the animation lasts for, say, 180 milliseconds.  Or even 250 milliseconds.  It is more important for us to stop at a given place, and we sacrifice the exact duration of the animation to simplify the calculations. </p><br><p>  Weaken the requirements for the duration of the animation, we will do the trick.  Suppose we have an approximate solution <img src="https://tex.s2cms.ru/svg/k'" alt="k '">  nonlinear equation (2).  It is an exact solution to an equation with a different parameter. </p><br><p></p><div style="text-align:center;"><img src="https://tex.s2cms.ru/svg/%5Calpha'%3D%7B1%5Cover%20k'%7D%5C%2C%5Ctext%7Btg%7D%7Bk'%5Cover%202%7D%2C" alt="\ alpha '= {1 \ over k'} \, \ text {tg} {k '\ over 2},"></div><p></p><br><p>  It corresponds to another time of the end of the animation: </p><br><p></p><div style="text-align:center;"><img src="https://tex.s2cms.ru/svg/t_2'%3Dt_1%2B%7Bx_2-x_1%5Cover%20v%5Calpha'%7D." alt="t_2 '= t_1 + {x_2-x_1 \ over v \ alpha'}."></div><p></p><br><p>  Now the unknown parameters of the trajectory <em>A</em> and <img src="https://tex.s2cms.ru/svg/%5Comega" alt="\ omega">  elementary express through <img src="https://tex.s2cms.ru/svg/k'" alt="k '">  and <img src="https://tex.s2cms.ru/svg/%5Calpha'" alt="\ alpha '">  . </p><br><p>  I selected an approximation suitable for our purposes to equation (2): </p><br><p></p><div style="text-align:center;"><img src="https://tex.s2cms.ru/svg/%7B1%5Cover%202%5Calpha%7D%5Capprox1-%5Cleft(%7Bk%5Cover%5Cpi%7D%5Cright)%5E2." alt="{1 \ over 2 \ alpha} \ approx1- \ left ({k \ over \ pi} \ right) ^ 2."></div><p></p><br><p>  The blue solid line corresponds to the exact equation (2), and the red dotted line corresponds to its approximation: </p><br><p></p><div style="text-align:center;"><img src="https://tex.s2cms.ru/svg/%5Cbegin%7Btikzpicture%7D%5Csmall%0A%5Cbegin%7Baxis%7D%5Blegend%20pos%3Dsouth%20east%2C%0A%20%20%20%20restrict%20y%20to%20domain%3D-8%3A8%2C%0A%20%20%20%20width%3D12cm%2C%0A%20%20%20%20xmin%3D-7.3%2C%20xmax%3D7.3%2C%0A%20%20%20%20ytick%3D%7B-6%2C-3%2C...%2C6%7D%2C%0A%20%20%20%20xtick%3D%7B-6.2832%2C-3.1416%2C...%2C10%7D%2C%0A%20%20%20%20xticklabels%3D%7B%24-%7B2%5Cpi%7D%24%2C%24-%7B%5Cpi%7D%24%2C%240%24%2C%24%7B%5Cpi%7D%24%2C%24%7B2%5Cpi%7D%24%7D%2C%0A%20%20%20%20axis%20x%20line%3Dcenter%2Caxis%20y%20line%3Dcenter%2C%0A%20%20%20%20xlabel%3D%24k%24%2Cylabel%3D%24%5Calpha%24%5D%0A%5Caddplot%5Bsmooth%2Csamples%3D580%2Cblue!70!black%2Cdomain%3D-7%3A7%5D%7Btan(deg(x%2F2))%2Fx%7D%3B%0A%5Caddplot%5Bsmooth%2Csamples%3D580%2Cred%2Cdashed%2Cdomain%3D-7%3A7%5D%7B0.5%2F(1%20-%20(x%2Fpi)%5E2)%7D%3B%0A%5Clegend%7B%24(1%2Fk)%5C%2C%5Ctext%7Btg%7D%5C%2Ck%2F2%24%2C%240.5%2F%5C!%5Cleft%5B1%20-%20(%7Bk%2F%5Cpi%7D)%5E2%5Cright%5D%24%7D%0A%5Cend%7Baxis%7D%0A%5Cend%7Btikzpicture%7D" alt="\ begin {tikzpicture} \ small \ begin {axis} [legend pos = south east, restrict y to domain = -8: 8, width = 12cm, xmin = -7.3, xmax = 7.3, ytick = {- 6, -3 , ..., 6}, xtick = {- 6.2832, -3.1416, ..., 10}, xticklabels = {$ - {2 \ pi} $, $ - {\ pi} $, $ 0 $, $ {\ pi} $, $ {2 \ pi} $}, axis x line = center, axis y line = center, xlabel = $ k $, ylabel = $ \ alpha $] \ addplot [smooth, samples = 580, blue! 70 ! black, domain = -7: 7] {tan (deg (x / 2)) / x}; \ addplot [smooth, samples = 580, red, dashed, domain = -7: 7] {0.5 / (1 - (x / pi) ^ 2)}; \ legend {$ (1 / k) \, \ text {tg} \, k / 2 $, $ 0.5 / \! \ left [1 - ({k / \ pi}) ^ 2 \ right] $} \ end { axis} \ end {tikzpicture}"></div><p></p><br><p>  <font color="#666"><em>Fig.</em></font>  <font color="#666"><em>7. Comparison of the exact relation (2) and its approximation</em></font> </p><br><p>  And in the case of <img src="https://tex.s2cms.ru/svg/0%3C%5Calpha%3C1%2F2" alt="0 &amp; lt; \ alpha &amp; lt; 1/2">  I suggest to take <img src="https://tex.s2cms.ru/svg/%5Calpha'" alt="\ alpha '">  slightly more than 1/2, and shorten the animation time to avoid bounces and returns. </p><br><h2>  Application </h2><br><p>  The code and spherical usage example is <a href="https://parpalak.github.io/demo/sin-animate.html">on the demo page</a> .  Move your mouse and see how the black block follows the orange. </p><br><p>  The described scheme is used in the finished product.  I developed it for synchronous scrolling of the source code and a preview in the <a href="https://upmath.me/">markdown and latex math text editor</a> . </p><br><p>  The idea and the initial implementation found <a href="https://markdown-it.github.io/">on the demo page js-parser markdown-it</a> .  In their version, the animation turned out torn and braking.  There are several reasons for this: </p><br><ol><li> A linear function is used for the animation: <code>$(...).stop(true).animate({scrollTop: ...}, 100, 'linear')</code> .  Instead of smooth graphics it turns out broken. </li><li>  Animation via <code>jQuery().stop().animate()</code> slows down compared to <code>requestAnimationFrame()</code> . </li><li>  To avoid a drop in performance, <code>onscroll</code> events are <code>onscroll</code> , the next more often than 50 milliseconds.  In my version there is no such problem.  Sequential <code>onscroll</code> events adjust the position of the breakpoint and do not slow down the animation. </li></ol><br><p>  In order to achieve high-quality animation that is important for a product, I worked out a calculation method based on physical equations, and implemented it through a special browser <code>requestAnimationFrame()</code> method.  The method works well with any scrolling: the PageUp / PageDown keys, through moving the scroll bars, mouse wheel, touchpad, touchscreen. </p><br><p></p><div class="spoiler">  <b class="spoiler_title">The source of the post and pictures</b> <div class="spoiler_text">  I typed this post in the mentioned editor.  I spread the <a href="">source code</a> , maybe someone can use the tex code of the graphs. </div></div><p></p></div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/283284/">https://habr.com/ru/post/283284/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../283274/index.html">There are no hares under Android - the history of creation</a></li>
<li><a href="../283276/index.html">Veeam Backup & Replication: workaround for one problem with backup job metadata</a></li>
<li><a href="../283278/index.html">[PF] Print PDF under .NET, vector approach, theory</a></li>
<li><a href="../283280/index.html">Product design digest, April 2016</a></li>
<li><a href="../283282/index.html">Drupal: ajax_facets and history API</a></li>
<li><a href="../283286/index.html">Happy Birthday, Edsger Vibe Dijkstra«É</a></li>
<li><a href="../283288/index.html">Kui releases while hot - pre-release testing version 0.4.1</a></li>
<li><a href="../283290/index.html">Stop repeating the "ponderous"</a></li>
<li><a href="../283294/index.html">Test. Checking the entry point in an arbitrary polygon</a></li>
<li><a href="../283296/index.html">PornHub launches Bug Bounty public program</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>