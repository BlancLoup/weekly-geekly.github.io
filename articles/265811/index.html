<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Say a word about poor XWiki</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Prologue. 

 " If you are polite , 
 Say: "Hello." 
 And if they answer you: "No", 
 Restrain your passion! "(C) 

 Once ... when once again, while pe...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Say a word about poor XWiki</h1><div class="post__text post__text-html js-mediator-article"> <b>Prologue.</b> <br><br>  " <a href="http://www.world-art.ru/lyric/lyric.php%3Fid%3D4260">If you are polite</a> , <br>  Say: "Hello." <br>  And if they answer you: "No", <br>  Restrain your passion! "(C) <br><br>  Once ... when once again, while performing routine work, you will waste time remembering which of the project options and for what reason changes were made in the calculations, design or text ... o User - know that <b>it‚Äôs time</b> for you <b>to combat Passion for Structuring!</b>  Structuring, or the strategy of organizing disparate information, rests on the capabilities and abilities of a particular person, whose productivity depends entirely on the tools he uses for these purposes, be it a notebook or an <a href="https://ru.wikipedia.org/wiki/%25D0%2590%25D0%25B2%25D1%2582%25D0%25BE%25D0%25BC%25D0%25B0%25D1%2582%25D0%25B8%25D0%25B7%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25BD%25D0%25B0%25D1%258F_%25D1%2581%25D0%25B8%25D1%2581%25D1%2582%25D0%25B5%25D0%25BC%25D0%25B0_%25D1%2583%25D0%25BF%25D1%2580%25D0%25B0%25D0%25B2%25D0%25BB%25D0%25B5%25D0%25BD%25D0%25B8%25D1%258F">automated control system</a> . 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Today, there are a huge number of such tools that directly and indirectly solve this problem, with varying degrees of efficiency, but in my opinion, the future behind products integrates not only the input, sorting, presentation and data design tools, but also contains analytics and programming tools and search.  XWiki, as a representative of such a direction, will be devoted to sowing an article, which will include a review, installation and configuration of a wiki engine, which will be interesting both for beginners and advanced users. <br><br>  Welcome to Cut (caution - traffic, pictures) <br><a name="habracut"></a><br>  <b>Exposition</b> <br><br>  There is almost nothing about the <a href="http://www.xwiki.org/xwiki/bin/view/Main/WebHome">XWiki</a> wiki engine in the Russian-speaking segment of the Internet, except general information and a couple of manuals, which in my opinion is absolutely wrong, because it is a great tool and helper, with its pluses and minuses, of course.  XWiki is a second-generation wiki engine characterized by the ability to structure information and programmatic access to the wiki database.  Written in Java, the license of the <a href="https://ru.wikipedia.org/wiki/GNU_Lesser_General_Public_License">LGPL</a> distribution, the functionality includes a blog, <a href="https://ru.wikipedia.org/wiki/API">API</a> tools, comments, <a href="https://ru.wikipedia.org/wiki/LDAP">LDAP authentication</a> , page export to PDF.  Used by many companies around the world.  25 interface languages, including Russian.  Also in more detail anyone can <a href="http://www.wikimatrix.org/compare/DokuWiki%2BMediaWiki%2BXWiki">compare on wikimatrix</a> with the most common wiki engines in RuNet: <a href="https://www.dokuwiki.org/dokuwiki">DokuWiki</a> and <a href="https://www.mediawiki.org/wiki/MediaWiki">MediaWiki</a> . <br><br>  <b>Outset</b> <br><br>  Download the latest, at the time of this writing, version of XWiki 7.1.2 at the following link: <a href="http://enterprise.xwiki.org/xwiki/bin/view/Main/Download">http://enterprise.xwiki.org/xwiki/bin/view/Main/Download</a> <br><br>  Installation options support: Windows, Debian, web container (web server) - * .war, multisystem format - *. Jar and a portable version of the wiki based on the Jetty + HSQLDB combination, which, IMHO, is most convenient for user setup / operation in both Windows and Linux.  About her and will be discussed. <br><br>  In order to install Xwiki, it is necessary that Java be installed on the system, as well as unpack files from the ZIP archive to the root of the disk (it is also recommended to rename the folder to a shorter path, like so: " <i>D: \ xwiki-7.1.2</i> ").  Start is carried out by the <i>start_xwiki.bat</i> file in which all necessary settings are already registered. <br><br> <a href=""><img alt="01.  " src="https://habrastorage.org/getpro/habr/post_images/b1f/85a/f97/b1f85af977fd841a0ac52902e283c4eb.jpg" title="01. console window"></a> <br><br>  Now we need to open a web browser window (the console window is absolutely not recommended to close), and enter the specified URL from the console, in our case it is: <a href="http://panther.itme.info/">panther.itme.info</a> : 8080 / xwiki / bin / view / Main / <br><br>  Here it is also worth adding that the default port from which XWiki starts is 8080, if for one reason or another it is busy with you, you can change it by editing <i>start_xwiki.bat</i> using Notepad. <br><br>  After loading the following window will open in the browser: <br><br> <a href=""><img alt="02.  .  " src="https://habrastorage.org/getpro/habr/post_images/f33/4dc/8c7/f334dc8c73e7c88d3babc27fa10ba01a.jpg" title="02. First launch. Common window"></a> <br><br>  Of the interesting things here, the link to the guide in English is <a href="http://enterprise.xwiki.org/xwiki/bin/view/GettingStarted/WebHome%3Fversion%3D7.1.2">Documentation</a> , but we will be interested in something completely different, namely, in the upper right corner click on the <i>Log-in</i> and enter to enter the admin area: <br><br>  Login: Admin <br>  Password: admin <br><br>  It is worth noting that in this place the register matters! <br><br> <a href=""><img alt="03.  " height="1134" src="https://habrastorage.org/getpro/habr/post_images/ff1/1b6/a8f/ff11b6a8f3749c0043a7da94beefce9f.jpg" title="03. Editing gadgets" width="1262"></a> <br><br>  Here I want to dwell on the following: <br>  1. Side panels acquired additional functionality that is configured by the User. <br>  2. The <a href="http://enterprise.xwiki.org/xwiki/bin/view/Main/Features">functionality</a> in XWiki allows you to edit not only text on pages, using a regular or <a href="https://ru.wikipedia.org/wiki/WYSIWYG">WYSIWYG</a> editor, displaying it in columns using the editing of the Inline form, but also inserting gadgets on the page.  A gadget in XWiki is Macro that is displayed in a certain area, i.e.  calling one or a sequence of commands, in particular, it can be a link to another page or even a blog feed, a tag cloud, forms for sending messages, etc.  etc. <br><br>  Macros in XWiki are essentially the <a href="http://rendering.xwiki.org/xwiki/bin/view/Main/ExtendingMacro">basis of this engine</a> , it is thanks to them that the User can customize almost everything, be it: his own mini-application, the appearance of pages and panels, or the integration of his own extension (plug-in). <br><br>  <b>Development</b> <br><br>  Here you need to digress a bit and talk about the organizational structure of XWiki, namely about the life cycle of <a href="http://platform.xwiki.org/xwiki/bin/view/Features/DocumentLifecycle">wiki pages</a> .  Here there is one subtlety, namely: The user can create the <i>Page</i> and <i>Space</i> , and if everything is more or less clear with the <i>Page</i> 's, then when creating the <i>Space</i> , the Header of the area is created, inside which the <i>Page</i> machine will be created with the name <i>WebHome</i> , but it will be displayed everywhere is the title of the area, and the addressing will be on <i>WebHome,</i> which can create some difficulties when linking to the page.  At the same time there are no restrictions on the level of investments that can be made both to Space and to Page. <br><br>  Macros. <br><br>  First you need to select a page to edit and enter the editor. <br><br> <a href="http://platform.xwiki.org/xwiki/bin/view/Features/PageEditing"><img src="https://habrastorage.org/getpro/habr/post_images/bbf/18a/a52/bbf18aa524d71efd4ff6f95a7213736a.png"></a> <a href="http://platform.xwiki.org/xwiki/bin/view/Features/PageEditing"><img src="https://habrastorage.org/getpro/habr/post_images/609/884/5b0/6098845b0afb0374522ac23fe6eb6770.png"></a> <br><br>  Then it is necessary to type either the macro itself in text mode, along with the parameters, or, using the graphical interface, select the required macro from the list. <br><br> <a href="http://platform.xwiki.org/xwiki/bin/view/Features/WysiwygEditor"><img src="https://habrastorage.org/getpro/habr/post_images/b9a/ab4/552/b9aab4552fa036528d0164ab676f225d.png"></a> <br> <a href="http://platform.xwiki.org/xwiki/bin/view/Features/WysiwygEditor"><img src="https://habrastorage.org/getpro/habr/post_images/2bc/eb0/d14/2bceb0d14ac501b2e14bd1a341788752.png"></a> <br><br>  and fill in the required fields: <br><br> <a href="http://platform.xwiki.org/xwiki/bin/view/Features/WysiwygEditor"><img src="https://habrastorage.org/getpro/habr/post_images/28b/7d0/4c7/28b7d04c75dc4fb8c97332ebcd9df837.png"></a> <br><br>  But it was all the lyrics, let's move on to practice and we begin with the interface settings.  To do this, click on the Panels icon in the left pane and launch <i>Panel Wizard</i> in the page that opens.  You will see the administrator settings interface, opened in the <i>Panel Wizard</i> tab.  An alternative and basic way to go to the XWiki settings is to click on the arrow in the top drop-down list next to <i>Home</i> and select <i>Administer Wiki</i> . <br><br> <a href=""><img alt="04.  " src="https://habrastorage.org/getpro/habr/post_images/bc2/c55/048/bc2c55048edd1d6bc3ab5fd8e4062770.jpg" title="04. customize panels"></a> <br><br>  The tab on the settings page of the <i>Page Layout</i> panel allows you to customize the location, number and width of the columns of our wiki.  The adjacent side of the <i>Panel List</i> tab includes applications (macros), which can be located on our fields, while they include a preview window, as well as control elements for enabling / excluding and editing content and functions.  Preview for the corresponding applications, which are in the form of buttons and functionality in the fields, is turned off.  In order to customize the functionality of the application - you need to click on <i>Edit</i> , to delete the macro - click on <i>Delete</i> , to remove / place the application / functionality on the panel - drag using the <a href="https://ru.wikipedia.org/wiki/Drag-and-drop">Drag and Drop</a> method. <br><br>  Now we will make the right navigation pane, to do this, remove the <i>Quick Links</i> and <i>My Recent Modifications</i> from the right pane and add <i>Tag Cloud, Navigation</i> and <i>Create Page</i> , click on <i>Save the New Layout</i> and go to the <i>Navigation</i> edit and paste the following code that will make our surfing more convenient: <br><br><div class="spoiler">  <b class="spoiler_title">code for content</b> <div class="spoiler_text"><pre><code class="hljs swift">{{velocity}} #panelheader($services.localization.render('xe.panels.navigation')) ## <span class="hljs-type"><span class="hljs-type">Escape</span></span> special characters <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> macro parameter values. #<span class="hljs-keyword"><span class="hljs-keyword">set</span></span> ($openToDoc = $doc.documentReference.<span class="hljs-built_in"><span class="hljs-built_in">toString</span></span>().replaceAll('([~<span class="hljs-string"><span class="hljs-string">"])', '~$1')) {{documentTree showSpaces="</span></span><span class="hljs-literal"><span class="hljs-literal">false</span></span><span class="hljs-string"><span class="hljs-string">" showWikis="</span></span><span class="hljs-literal"><span class="hljs-literal">true</span></span><span class="hljs-string"><span class="hljs-string">" showTranslations="</span></span><span class="hljs-literal"><span class="hljs-literal">false</span></span><span class="hljs-string"><span class="hljs-string">" showAttachments="</span></span><span class="hljs-literal"><span class="hljs-literal">true</span></span><span class="hljs-string"><span class="hljs-string">" showChildDocuments="</span></span><span class="hljs-literal"><span class="hljs-literal">true</span></span><span class="hljs-string"><span class="hljs-string">" compact="</span></span><span class="hljs-literal"><span class="hljs-literal">true</span></span><span class="hljs-string"><span class="hljs-string">" openTo="</span></span>document:$openToDoc<span class="hljs-string"><span class="hljs-string">" /}} #panelfooter() {{/velocity}}</span></span></code> </pre> <br></div></div><br><br>  What does this give us?  This gives the mapping a tree structure for navigating between attachments, <i>Pages</i> and <i>Spaces</i> , without displaying additional distracting information.  Now it‚Äôs time to bring in colors to our new site and get away from the flat interface.  To do this, select the <i>Presentation</i> item in the <i>LOOK &amp; FEEL</i> menu <i>.</i>  Here we change <i>Icon Theme</i> to <i>Silk</i> and <i>Color Theme</i> to <i>Garden</i> . <br><br>  Voila <br><br><img alt="05.  " src="https://habrastorage.org/getpro/habr/post_images/7a8/101/ab0/7a8101ab02c01a7ff0754061da1cd73b.jpg" title="05. appearance"><br><br>  Now it's time to think about media tools, namely, what kind of blog without a gallery and graphics?  Unfortunately, XWiki has no built-in gallery, so you have to work hard to install and configure <i>Extensions</i> . To do this, go to the <i>EXTENSION MANAGER</i> menu item <i>Add Extensions</i> .  Here you can install the necessary add-ons from the web repository, in this case we will be interested in the <a href="http://extensions.xwiki.org/xwiki/bin/view/Extension/Lightbox%2BMacro">Lightbox Macro</a> plug-in, with which you can conveniently organize a slide show, as well as combine pictures into groups.  To install, enter the word lightbox in the search bar and click install in the result of the search. <br><br> <a href=""><img alt="06.  " src="https://habrastorage.org/getpro/habr/post_images/06b/9f3/f0c/06b9f3f0ccd1d2e94b723a7571e8de02.jpg" title="06. macro installation"></a> <br><br> <a href="http://extensions.xwiki.org/xwiki/bin/view/Extension/Lightbox%2BMacro"><img src="https://habrastorage.org/getpro/habr/post_images/7af/c55/8cd/7afc558cd0abc951ea2c55c1ac415ee6.png"></a> <br><br>  Now go to the main page of our XWiki and here in the <i>Navigation</i> panel we will find 2 new <i>Space Lightbox</i> and <i>LightboxMacro</i> .  So it's time to apply the macro to the business, for this we create a test <i>Space</i> under the name Test page and in the Attachments tab we upload pictures for testing the gallery, in our case these will be photos from the day of the celebration of May 9, 2014 taken on an unremarkable china phone on Android Jiayu G3. <br><br><div class="spoiler">  <b class="spoiler_title">Gallery code</b> <div class="spoiler_text"><pre> <code class="hljs smalltalk">{{velocity}} <span class="hljs-symbol"><span class="hljs-symbol">#set</span></span>(<span class="hljs-string"><span class="hljs-string">$m</span></span>yArray=<span class="hljs-string"><span class="hljs-string">$d</span></span>oc.<span class="hljs-type"><span class="hljs-type">AttachmentList</span></span>) <span class="hljs-symbol"><span class="hljs-symbol">#set</span></span>(<span class="hljs-string"><span class="hljs-string">$m</span></span>yArray=<span class="hljs-string"><span class="hljs-string">$s</span></span>orttool.sort(<span class="hljs-string"><span class="hljs-string">$m</span></span>yArray, <span class="hljs-string"><span class="hljs-string">'filename'</span></span>)) <span class="hljs-symbol"><span class="hljs-symbol">#foreach</span></span> (<span class="hljs-string"><span class="hljs-string">$i</span></span>tem in <span class="hljs-string"><span class="hljs-string">$m</span></span>yArray)<span class="hljs-symbol"><span class="hljs-symbol">#if</span></span>(<span class="hljs-string"><span class="hljs-string">$i</span></span>tem.isImage()){{lightbox image=<span class="hljs-string"><span class="hljs-string">$i</span></span>tem.filename title=<span class="hljs-comment"><span class="hljs-comment">"Hello"</span></span> width=<span class="hljs-comment"><span class="hljs-comment">"20%"</span></span> group=<span class="hljs-comment"><span class="hljs-comment">"d1"</span></span> height=<span class="hljs-comment"><span class="hljs-comment">"20%"</span></span>/}}<span class="hljs-symbol"><span class="hljs-symbol">#end</span></span><span class="hljs-symbol"><span class="hljs-symbol">#end</span></span> {{/velocity}}</code> </pre><br></div></div><br><br>  The text of the code is interpreted as follows: a list of attachments is placed on the $ myArray array on the page, then sorted by name (for those cases if the downloaded files from the camera were downloaded to each other, but at the same time the date and time of the shooting were stored in the file name, or at least numbering sequence pictures).  After that, for each attachment, if it is an image, a miniature is displayed with a height of 20% of the original.  Here you also need to say that the macro parameters include the following items: <br><br><table><tbody><tr><th>  Param </th><th>  Description </th></tr><tr><td>  image (required) </td><td>  An url or the attached image file.  For example, "cat.jpg" or "xwiki: Space.Page@cat.jpg" or " <a href="http://www.google.com/logos/wateronmoon09-hp.gif%2522">www.google.com/logos/wateronmoon09-hp.gif"</a> </td></tr><tr><td>  title </td><td>  A short description </td></tr><tr><td>  width </td><td>  The width of the image. </td></tr><tr><td>  height </td><td>  The height of the image. </td></tr><tr><td>  group </td><td>  A string that identify.  A group of images can be viewed as a series of slides. </td></tr></tbody></table> <a href=""><img alt="07.  " src="https://habrastorage.org/getpro/habr/post_images/72a/2a1/83d/72a2a183d40c76a23db600da0ad258b2.jpg" title="07. Gallery preview"></a> <br><br>  What is convenient this macro?  The fact that automates the process of displaying attachments, regardless of how many, what images and under what name were loaded.  You can also click on any of the thumbnails and in the pop-up window you will see the photo you like, which is also an undoubted advantage.  But in this case the spoon of tar will be the fact that in the pop-up window the image will be opened in its original size, which is not always convenient, especially if this resolution exceeds the working resolution of the monitor screen.  In this case, do the following: <br>  1. Follow the link to the Macro Lightbox page; <br>  2. Click on the arrow of the <i>Edit</i> menu and in the drop-down list that appears, select <i>Objects</i> ; <br>  3. In the new window, go to the code by <i>expanding the</i> lists of <i>Objects of type XWiki.JavaScriptExtension (1)</i> and <i>Objects of type XWiki.StyleSheetExtension (1)</i> ; <br>  4. Now we make the following changes to the JS code: <br><br><div class="spoiler">  <b class="spoiler_title">JS code changes</b> <div class="spoiler_text">  + resizeSpeed: 10, // controls the image resizing animations (1 = slowest and 10 = fastest) <br>  ... <br>  + var maxheight = 640; <br>  + if (imgPreloader.height&gt; maxheight) <br>  + { <br>  + var scale = imgPreloader.height / maxheight <br>  + imgPreloader.height = maxheight; <br>  + imgPreloader.width = imgPreloader.width / scale; <br>  +} <br>  ... <br></div></div><br><br><div class="spoiler">  <b class="spoiler_title">Full code with fixes</b> <div class="spoiler_text"><pre> // ------------------------------------------------ ----------------------------
 //
 // Lightbox v2.04
 // by Lokesh Dhakar - http://www.lokeshdhakar.com
 //
 // Licensed under the Creative Commons Attribution 2.5 License - http://creativecommons.org/licenses/by/2.5/
 // - Free for use in both personal and commercial projects
 // - Attribution requires leaving the name, author link, and the license info intact.
 //
 // Cleaned up using jslint.
 // ------------------------------------------------ ----------------------------------
 / * global LightboxOptions, Lightbox, Builder, Class, Prototype, $, $$, $ w, Effect * /
 LightboxOptions = Object.extend ({
 fileLoadingImage: '$ doc.getAttachmentURL ("loading.gif")',
 fileBottomNavCloseImage: '$ doc.getAttachmentURL ("closelabel.gif")',
 overlayOpacity: 0.8, // controls transparency of shadow overlay
 animate: true, // toggles resizing animations
 resizeSpeed: 10, // controls the image resizing animations (1 = slowest and 10 = fastest)
 borderSize: 10, // if you adjust the padding in the CSS,
 // When grouping images this is used to write: Image # of #.
 // Change it for non-english localization
 labelImage: "Image",
 labelOf: "of"
 }, window.LightboxOptions ||  {});
 // ------------------------------------------------ -----------------------------------
 var Lightbox = Class.create ();
 Lightbox.prototype = {
 imageArray: [],
 activeImage: undefined
 // initialize ()
 // Constructor runs on completion of the DOM loading.  Calls updateImageList and then
 // the function inserts html
 // overlay and the image container.
 //
 initialize: function () {
 this.updateImageList ();
 this.keyboardAction = this.keyboardAction.bindAsEventListener (this);
 if (LightboxOptions.resizeSpeed&gt; 10) {
 LightboxOptions.resizeSpeed ‚Äã‚Äã= 10;
 }
 if (LightboxOptions.resizeSpeed ‚Äã‚Äã&lt;1) {
 LightboxOptions.resizeSpeed ‚Äã‚Äã= 1;
 }
 this.resizeDuration = LightboxOptions.animate?  ((11 - LightboxOptions.resizeSpeed) * 0.15): 0;
 this.overlayDuration = LightboxOptions.animate?  0.2: 0;  // shadow fade in / out duration
 // When the lightbox starts up the current image dimension.
 // If animations are turned off
 // white 250 by 250 box.
 var size = (LightboxOptions.animate? 250: 1) + 'px';
 // This is what it looks like:
 //
 // &lt;div id = "overlay"&gt; &lt;/ div&gt;
 // &lt;div id = "lightbox"&gt;
 // &lt;div id = "outerImageContainer"&gt;
 // &lt;div id = "imageContainer"&gt;
 // &lt;img id = "lightboxImage"&gt;
 // &lt;div style = "" id = "hoverNav"&gt;
 // &lt;a href="#" id="prevLink"&gt; &lt;/a&gt;
 // &lt;a href="#" id="nextLink"&gt; &lt;/a&gt;
 // &lt;/ div&gt;
 // &lt;div id = "loading"&gt;
 // &lt;a href="#" id="loadingLink"&gt;
 // &lt;img src = "images / loading.gif"&gt;
 // &lt;/a&gt;
 // &lt;/ div&gt;
 // &lt;/ div&gt;
 // &lt;/ div&gt;
 // &lt;div id = "imageDataContainer"&gt;
 // &lt;div id = "imageData"&gt;
 // &lt;div id = "imageDetails"&gt;
 // &lt;span id = "caption"&gt; &lt;/ span&gt;
 // &lt;span id = "numberDisplay"&gt; &lt;/ span&gt;
 // &lt;/ div&gt;
 // &lt;div id = "bottomNav"&gt;
 // &lt;a href="#" id="bottomNavClose"&gt;
 // &lt;img src = "images / close.gif"&gt;
 // &lt;/a&gt;
 // &lt;/ div&gt;
 // &lt;/ div&gt;
 // &lt;/ div&gt;
 // &lt;/ div&gt;
 var objBody = $$ ('body') [0];
 objBody.appendChild (Builder.node ('div', {id: 'overlay'}));
 objBody.appendChild (Builder.node ('div', {id: 'lightbox'}, [
   Builder.node ('div', {id: 'outerImageContainer'},
       Builder.node ('div', {id: 'imageContainer'}, [
           Builder.node ('img', {id: 'lightboxImage'}),
           Builder.node ('div', {id: 'hoverNav'}, [
               Builder.node ('a', {id: 'prevLink', href: '#'}),
               Builder.node ('a', {id: 'nextLink', href: '#'})
           ])
           Builder.node ('div', {id: 'loading'},
               Builder.node ('a', {id: 'loadingLink', href: '#'},
                   Builder.node ('img', {src: LightboxOptions.fileLoadingImage})
               )
           )
       ])
   ),
   Builder.node ('div', {id: 'imageDataContainer'},
       Builder.node ('div', {id: 'imageData'}, [
           Builder.node ('div', {id: 'imageDetails'}, [
               Builder.node ('span', {id: 'caption'}),
               Builder.node ('span', {id: 'numberDisplay'})
           ])
           Builder.node ('div', {id: 'bottomNav'},
               Builder.node ('a', {id: 'bottomNavClose', href: '#'},
                   Builder.node ('img', {src: LightboxOptions.fileBottomNavCloseImage})
               )
           )
       ])
   )
 ]));
 $ ('overlay'). hide (). observe ('click', (function () {
 this.end ();
 }). bind (this));
 $ ('lightbox'). hide (). observe ('click', (function (event) {
 if (event.element (). id == 'lightbox') {
 this.end ();
 }
 }). bind (this));
 $ ('outerImageContainer'). setStyle ({width: size, height: size});
 $ ('prevLink'). observe ('click', (function (event) {
 event.stop ();
 this.changeImage (this.activeImage - 1);
 }). bindAsEventListener (this));
 $ ('nextLink'). observe ('click', (function (event) {
 event.stop ();
 this.changeImage (this.activeImage + 1);
 }). bindAsEventListener (this));
 $ ('loadingLink'). observe ('click', (function (event) {
 event.stop ();
 this.end ();
 }). bind (this));
 $ ('bottomNavClose'). observe ('click', (function (event) {
 event.stop ();
 this.end ();
 }). bind (this));
 var th = this;
 (function () {
   var ids =
       'overlay lightbox outerImageContainer imageContainer lightboxImage hoverNav prevLink nextLink loading loadingLink' +
       'imageDataContainer imageData imageDetails caption numberDisplay bottomNav bottomNavClose';
   $ w (ids) .each (function (id) {
 th [id] = $ (id);
 });
 }). defer ();
 },
 //
 // updateImageList ()
 // Loops through anchor tags
 // events to appropriate links.  You can rerun after dynamically adding images w / ajax.
 //
 updateImageList: function () {
 this.updateImageList = Prototype.emptyFunction;
 document.observe ('click', (function (event) {
   var target = event.findElement ('a [rel ^ = lightbox]') ||  event.findElement ('area [rel ^ = lightbox]');
   if (target) {
       event.stop ();
       this.start (target);
   }
 }). bind (this));
 },
 //
 // start ()
 // Display overlay and lightbox.  If image is part of a set, add siblings to imageArray.
 //
 start: function (imageLink) {
 $$ ('select', 'object', 'embed'). each (function (node) {
 node.style.visibility = 'hidden';
 });
 // stretch overlay to fill page and fade in
 var arrayPageSize = this.getPageSize ();
 $ ('overlay'). setStyle ({width: arrayPageSize [0] + 'px', height: arrayPageSize [1] + 'px'});
 var effect = new Effect.Appear (this.overlay, {duration: this.overlayDuration, from: 0.0, to: LightboxOptions.overlayOpacity});
 this.imageArray = [];
 var imageNum = 0;
 if ((imageLink.rel == 'lightbox')) {
   // if image is set, add image to imageArray
   this.imageArray.push ([imageLink.href, imageLink.title]);
 } else {
   // if image is part of a set ..
   this.imageArray =
       $$ (imageLink.tagName + '[href] [rel = "' + imageLink.rel + '"]').
       collect (function (anchor) {
 return [anchor.href, anchor.title];
 }).
       uniq ();
   while (this.imageArray [imageNum] [0]! = imageLink.href) {
 imageNum ++;
 }
 }
 // calculate top and left offset for the lightbox
 var arrayPageScroll = document.viewport.getScrollOffsets ();
 var lightboxTop = arrayPageScroll [1] + (document.viewport.getHeight () / 10);
 var lightboxLeft = arrayPageScroll [0];
 this.lightbox.setStyle ({top: lightboxTop + 'px', left: lightboxLeft + 'px'}). show ();
 this.changeImage (imageNum);
 },
 //
 // changeImage ()
 // Hide most elements and preload image in preparation for resizing image container.
 //
 changeImage: function (imageNum) {
 this.activeImage = imageNum;  // update global var
 // hide elements during transition
 if (LightboxOptions.animate) {
 this.loading.show ();
 }
 this.lightboxImage.hide ();
 this.hoverNav.hide ();
 this.prevLink.hide ();
 this.nextLink.hide ();
 // HACK: Opera9 does not currently support scriptaculous opacity and appear fx
 this.imageDataContainer.setStyle ({opacity: 0.0001});
 this.numberDisplay.hide ();
 var imgPreloader = new Image ();
 // once image is preloaded, resize image container
 imgPreloader.onload = (function () {
   var maxheight = 640;
   if (imgPreloader.height&gt; maxheight)
     {
     var scale = imgPreloader.height / maxheight
     imgPreloader.height = maxheight;
     imgPreloader.width = imgPreloader.width / scale;
      }<font></font>
       <font></font>
   this.lightboxImage.src = this.imageArray [this.activeImage] [0];
   this.resizeImageContainer (imgPreloader.width, imgPreloader.height);
 }). bind (this);
 imgPreloader.src = this.imageArray [this.activeImage] [0];
 },
 //
 // resizeImageContainer ()
 //
 resizeImageContainer: function (imgWidth, imgHeight) {
 // get current width and height
 var widthCurrent = this.outerImageContainer.getWidth ();
 var heightCurrent = this.outerImageContainer.getHeight ();
 // get new width and height
 var widthNew = (imgWidth + LightboxOptions.borderSize * 2);
 var heightNew = (imgHeight + LightboxOptions.borderSize * 2);
 // scalars based on old to new
 var xScale = (widthNew / widthCurrent) * 100;
 var yScale = (heightNew / heightCurrent) * 100;
 // calculate the size difference between the necessary and old image
 var wDiff = widthCurrent - widthNew;
 var hDiff = heightCurrent - heightNew;
 if (hDiff! = 0) {
 var scaleXEffect = new Effect.Scale (this.outerImageContainer, yScale, {scaleX: false, duration: this.resizeDuration, queue: 'front'});
 }
 if (wDiff! = 0) {
 var scaleYEffect = new Effect.Scale (this.outerImageContainer, xScale, {scaleY: false, duration: this.resizeDuration, delay: this.resizeDuration});
 }
 // if there is a transition, it‚Äôs necessary,
 // do a quick pause to prevent image flicker.
 var timeout = 0;
 if ((hDiff == 0) &amp;&amp; (wDiff == 0)) {
   timeout = 100;
   if (Prototype.Browser.IE) {
 timeout = 250;
 }
 }
 (function () {
   this.prevLink.setStyle ({height: imgHeight + 'px'});
   this.nextLink.setStyle ({height: imgHeight + 'px'});
   this.imageDataContainer.setStyle ({width: widthNew + 'px'});
   this.showImage ();
 }). bind (this) .delay (timeout / 1000);
 },
 //
 // showImage ()
 // Display image and begin preloading neighbors.
 //
 showImage: function () {
 this.loading.hide ();
 var effectAppear = new Effect.Appear (this.lightboxImage, {
   duration: this.resizeDuration,
   queue: 'end',
   afterFinish: (function () {
 this.updateDetails ();
 }). bind (this)
 });
 this.preloadNeighborImages ();
 },
 //
 // updateDetails ()
 // Display caption, image number, and bottom nav.
 //
 updateDetails: function () {
 // if caption is not null
 if (this.imageArray [this.activeImage] [1]! = "") {
   this.caption.update (this.imageArray [this.activeImage] [1]). show ();
 }
 // if image is part of set display 'Image x of x'
 if (this.imageArray.length&gt; 1) {
   this.numberDisplay.update (LightboxOptions.labelImage + '' + (this.activeImage + 1) + '' + LightboxOptions.labelOf + '' + this.imageArray.length) .show ();
 }
 var effectParallel = new Effect.Parallel (
   [
 new Effect.SlideDown (this.imageDataContainer, {sync: true, duration: this.resizeDuration, from: 0.0, to: 1.0}),
       new Effect.Appear (this.imageDataContainer, {sync: true, duration: this.resizeDuration})
   ],
   {
       duration: this.resizeDuration,
       afterFinish: (function () {
      // update overlay size and update nav
      var arrayPageSize = this.getPageSize ();
      this.overlay.setStyle ({height: arrayPageSize [1] + 'px'});
      this.updateNav ();
       }). bind (this)
   }
 );
 },
 //
 // updateNav ()
 // Display appropriate previous and next hover navigation.
 //
 updateNav: function () {
 this.hoverNav.show ();      
 // if not first image in set, display prev image button
 if (this.activeImage&gt; 0) {
 this.prevLink.show ();
 }
 // if not last image in set, display next image button
 if (this.activeImage &lt;(this.imageArray.length - 1)) {
 this.nextLink.show ();
 }
 this.enableKeyboardNav ();
 },
 //
 // enableKeyboardNav ()
 //
 enableKeyboardNav: function () {
 document.observe ('keydown', this.keyboardAction);
 },
 //
 // disableKeyboardNav ()
 //
 disableKeyboardNav: function () {
 document.stopObserving ('keydown', this.keyboardAction);
 },
 //
 // keyboardAction ()
 //
 keyboardAction: function (event) {
 var keycode = event.keyCode;
 var escapeKey;
 if (event.DOM_VK_ESCAPE) {// mozilla
   escapeKey = event.DOM_VK_ESCAPE;
 } else {// ie
   escapeKey = 27;
 }
 var key = String.fromCharCode (keycode) .toLowerCase ();
 if (key.match (/ x | o | c /) || (keycode == escapeKey)) {// close lightbox
   this.end ();
 } else if ((key == 'p') || (keycode == 37)) {// display previous image
   if (this.activeImage! = 0) {
       this.disableKeyboardNav ();
       this.changeImage (this.activeImage - 1);
   }
 } else if ((key == 'n') || (keycode == 39)) {// display next image
   if (this.activeImage! = (this.imageArray.length - 1)) {
       this.disableKeyboardNav ();
       this.changeImage (this.activeImage + 1);
   }
 }
 },
 //
 // preloadNeighborImages ()
 // Preload previous and next images.
 //
 preloadNeighborImages: function () {
 var preloadNextImage, preloadPrevImage;
 if (this.imageArray.length&gt; this.activeImage + 1) {
   preloadNextImage = new Image ();
   preloadNextImage.src = this.imageArray [this.activeImage + 1] [0];
 }
 if (this.activeImage&gt; 0) {
   preloadPrevImage = new Image ();
   preloadPrevImage.src = this.imageArray [this.activeImage - 1] [0];
 }
 },
 //
 // end ()
 //
 end: function () {
 this.disableKeyboardNav ();
 this.lightbox.hide ();
 var effectFade = new Effect.Fade (this.overlay, {duration: this.overlayDuration});
 $$ ('select', 'object', 'embed'). each (function (node) {
 node.style.visibility = 'visible';
 });
 },
 //
 // getPageSize ()
 //
 getPageSize: function () {
 var xScroll, yScroll, pageHeight, pageWidth, windowWidth, windowHeight;
 if (window.innerHeight &amp;&amp; window.scrollMaxY) { 
 xScroll = window.innerWidth + window.scrollMaxX;
 yScroll = window.innerHeight + window.scrollMaxY;
 } else if (document.body.scrollHeight&gt; document.body.offsetHeight) {// all but Explorer Mac
 xScroll = document.body.scrollWidth;
 yScroll = document.body.scrollHeight;
 } else {// Explorer Mac ... would also work in Explorer 6 Strict, Mozilla and Safari
 xScroll = document.body.offsetWidth;
 yScroll = document.body.offsetHeight;
 }
 if (self.innerHeight) {// all except Explorer
 if (document.documentElement.clientWidth) {
 windowWidth = document.documentElement.clientWidth;
 } else {
 windowWidth = self.innerWidth;
 }
 windowHeight = self.innerHeight;
 } else if (document.documentElement &amp;&amp; document.documentElement.clientHeight) {// Explorer 6 Strict Mode
 windowWidth = document.documentElement.clientWidth;
 windowHeight = document.documentElement.clientHeight;
 } else if (document.body) {// other Explorers
 windowWidth = document.body.clientWidth;
 windowHeight = document.body.clientHeight;
 } 
 // for small pages with the viewport
 if (yScroll &lt;windowHeight) {
 pageHeight = windowHeight;
 } else {
 pageHeight = yScroll;
 }
 // for the viewport
 if (xScroll &lt;windowWidth) { 
 pageWidth = xScroll; 
 } else {
 pageWidth = windowWidth;
 }
 return [pageWidth, pageHeight];
 }
 };
 document.observe ('dom: loaded', function () {
 var lightbox = new Lightbox ();
 });<font></font>
<font></font>
</pre><br></div></div><br><br>  Now rule Objects of type XWiki.StyleSheetExtension (1) <br><br><div class="spoiler">  <b class="spoiler_title">Changes in XWiki.Style</b> <div class="spoiler_text">  we change <br>  - # lightbox {position: absolute;  left: 0;  width: 100%;  z-index: 1001;  text-align: center;  line-height: 0;} # lightbox img {width: auto;  height: auto;} # lightbox a img {border: none;  } <br><br>  on <br><br>  + # lightbox {position: absolute;  left: 0;  width: 100%;  z-index: 1001;  text-align: center;  line-height: 0;} # lightbox img {max-height: 640px;} # lightbox a img {border: none;  } <br></div></div><br><br><div class="spoiler">  <b class="spoiler_title">Final XWiki.Style</b> <div class="spoiler_text">  #lightbox { <br>  position: absolute; <br>  left: 0; <br>  width: 100%; <br>  z-index: 1001; <br>  text-align: center; <br>  line-height: 0; <br>  } <br>  #lightbox img {max-height: 640px;} <br>  #lightbox a img {border: none;  } <br>  #outerImageContainer { <br>  position: relative; <br>  background-color: #fff; <br>  width: 250px; <br>  height: 250px; <br>  margin: 0 auto; <br>  } <br>  #imageContainer { <br>  padding: 10px; <br>  } <br>  #loading { <br>  position: absolute; <br>  top: 40%; <br>  left: 0%; <br>  height: 25%; <br>  width: 100%; <br>  text-align: center; <br>  line-height: 0; <br>  } <br>  #hoverNav { <br>  position: absolute; <br>  top: 0; <br>  left: 0; <br>  height: 100%; <br>  width: 100%; <br>  z-index: 10; <br>  } <br>  #imageContainer&gt; #hoverNav { <br>  left: 0; <br>  } <br>  #hoverNav a { <br>  outline: none; <br>  } <br>  #prevLink, #nextLink { <br>  width: 49%; <br>  height: 100%; <br>  background-image: url (data: image / gif; base64, AAAA);  / * Trick IE into showing hover * / <br>  display: block; <br>  } <br>  #prevLink { <br>  left: 0; <br>  float: left; <br>  } <br>  #nextLink { <br>  right: 0; <br>  float: right; <br>  } <br>  #prevLink: hover, #prevLink: visited: hover { <br>  background: url ($ doc.getAttachmentURL ("prevlabel.gif")) left 15% no-repeat; <br>  } <br>  #nextLink: hover, #nextLink: visited: hover { <br>  background: url ($ doc.getAttachmentURL ("nextlabel.gif")) right 15% no-repeat; <br>  } <br>  #imageDataContainer { <br>  font: 10px Verdana, Helvetica, sans-serif; <br>  background-color: #fff; <br>  margin: 0 auto; <br>  line-height: 1.4em; <br>  overflow: auto; <br>  width: 100%; <br>  } <br>  #imageData { <br>  padding: 0 10px; <br>  color: # 666; <br>  } <br>  #imageData #imageDetails { <br>  width: 70%; <br>  float: left; <br>  text-align: left; <br>  } <br>  #imageData #caption { <br>  font-weight: bold; <br>  } <br>  #imageData #numberDisplay { <br>  display: block; <br>  clear: left; <br>  padding-bottom: 1.0em; <br>  } <br>  #imageData #bottomNavClose { <br>  width: 66px; <br>  float: right; <br>  padding-bottom: 0.7em; <br>  outline: none; <br>  } <br>  #overlay { <br>  position: absolute; <br>  top: 0; <br>  left: 0; <br>  z-index: 90; <br>  width: 100%; <br>  height: 500px; <br>  background-color: # 000; <br>  } <br>  / * IE7 hack * / <br>  * + html #overlay { <br>  position: fixed; <br>  } <br></div></div><br><br>  So what has been changed here?  XWiki.Style transfers the image dimensions to the JS code, and then scaling it to a height of 640 pixels (but you can also change the value at any time to fit you), this is because my wife has a laptop display with a resolution of 1360x768 pixels.  How to do so from the OS to get user permission to the code - I do not know.  Warning further comments on the quality of edits in the code - these edits were made by me on the basis of the knowledge gained in school during computer lessons in QBasic 4.5 and Borland Pascal 7.0. <br><br>  <b>Climax</b> <br><br>  Now we have a wiki engine including functionality: <br>  - Blog; <br>  - WYSIWIG editor; <br>  - Image galleries; <br>  - Ability to edit and create new macros; <br>  - The ability to program and support the syntax of popular wiki engines; <br>  - <a href="https://network.xwiki.com/xwiki/bin/view/DocXE51En/OfficeImporter">Integration with Open Office</a> (!) ( <a href="http://extensions.xwiki.org/xwiki/bin/view/Extension/Office%2BImporter%2BApplication">Although for this you need to install and start the service</a> or use <a href="http://extensions.xwiki.org/xwiki/bin/view/Extension/Office%2BImporter%2BApplication">crutches</a> ); <br><br>  Here's what I got as an example of a test corporate site: <br> <a href=""><img alt="08.  " src="https://habrastorage.org/getpro/habr/post_images/b10/d07/976/b10d0797657818fbd9234bf6c5888f90.jpg" title="08. Sample site"></a> <br><br><h4>  To be continued... </h4></div><p>Source: <a href="https://habr.com/ru/post/265811/">https://habr.com/ru/post/265811/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../265801/index.html">Webpack for Single Page App</a></li>
<li><a href="../265803/index.html">Samsung SSDs high capacity for servers</a></li>
<li><a href="../265805/index.html">gRPC - framework for remote procedure call from Google</a></li>
<li><a href="../265807/index.html">About duplicating web map tiles</a></li>
<li><a href="../265809/index.html">How to make tetris for half a year on cocos2dx</a></li>
<li><a href="../265813/index.html">Translation of Richard Bartle's book Designing Virtual Worlds. Chapter 1. Basics</a></li>
<li><a href="../265815/index.html">[libGDX] Experience developing a game using Box2D</a></li>
<li><a href="../265817/index.html">1C: Summer School 2015 - how to organize a "smart" vacation for young programmers - part 1. Who and what he studied, daily routine, carrot and carrot</a></li>
<li><a href="../265819/index.html">RAD Studio 10 Seattle Release</a></li>
<li><a href="../265823/index.html">Chameleon Launcher Open Clone</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>