<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Resurrection D-Link DWL-2100AP</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I work in a small Internet service provider in the region, including in the private sector. Wi-Fi with directional antennas and access points on both ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Resurrection D-Link DWL-2100AP</h1><div class="post__text post__text-html js-mediator-article">  I work in a small Internet service provider in the region, including in the private sector.  Wi-Fi with directional antennas and access points on both sides (in WDS and ‚Äúclient‚Äù modes) was chosen as the last mile technology.  Energy supply in the private sector leaves much to be desired - the tension jumps and quite often disappears completely.  Of course, such conditions affect the equipment extremely negatively - the points often fail, and many of them fall out in a cyclic reboot due to failures in the firmware.  There are a couple of dozens of such points.  The bosses decided that repairing the points would eventually cost more than buying new ones.  But it's a pity when so much equipment is dead weight, but it can still serve the motherland. <br><br> <a href=""><img src="http://s004.radikal.ru/i206/1002/87/36049832d0e4t.jpg"></a> <br><br><a name="habracut"></a><br><h4>  Autopsy </h4><br>  Having developed a point, I found two groups of contact pads on the board.  One of them looked like a JTAG connector, the other was not signed, but I assumed that it could be an RS-232 interface.  The Internet has confirmed my assumption, besides there was a pinout of conclusions. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     <a href=""><img src="http://s12.radikal.ru/i185/1002/fb/aa3c81a8c73at.jpg"></a> <a href="http://radikal.ru/F/s55.radikal.ru/i148/1002/0d/a7702b84f422.png.html"><img src="http://s55.radikal.ru/i148/1002/0d/a7702b84f422t.jpg"></a> <br><br>  To connect these pins to the computer, we need a level converter - a MAX232 chip (or any similar, with the index 232).  Happy owners of laptops without COM ports can purchase and send out a data cable for old Siemens phones (models from c62 and earlier).  Such a cable can be soldered directly to the connector on the access point board without assembling converters.  I will not consider this option, since I don‚Äôt have a cable, but by going as far as you can find the necessary information yourself. <br><br>  The converter will also require five capacitors - four capacitors with a capacity of 10 ŒºF and one with a capacity of 1 ŒºF.  Here is its diagram (by the way, the typical scheme for using MAX232): <br><br> <a href="http://www.radikal.ru/"><img src="http://s001.radikal.ru/i194/1002/c2/24a8250aa174.png"></a> <br><br>  My converter looks much more complicated than it should, since I collected it much earlier and for other purposes.  On the breadboard, there are two MAX232 microcircuits and some more ‚Äúredundant‚Äù elements.  Also, for convenience, when connecting, I placed the DB-9 "mother" connector on the board: <br><br> <a href=""><img src="https://habrastorage.org/getpro/geektimes/post_images/153/aef/620/153aef6204576a5f132832345a27106a.jpg"></a> <a href=""><img src="http://s13.radikal.ru/i186/1002/f6/06d85fe262a1t.jpg"></a> <a href=""><img src="http://s43.radikal.ru/i101/1002/2e/f2c2c35f1da9t.jpg"></a> <a href=""><img src="https://habrastorage.org/getpro/geektimes/post_images/0f2/494/458/0f249445877a226bfff5ca3b6cf5bb13.jpg"></a> <br><br>  We solder the wires TX, RX and ground from the converter directly to the access point board. <br><br><h4>  Loading </h4><br>  Open any terminal program (I use PuTTY, but HyperTerminal will do) and set up a serial port connection (COM1 or COM2) with parameters: speed 9600 bps, 8 data bits, 1 stop bit, parity disabled, flow control - disabled.  We connect a point and a converter to the configured port.  By energizing the converter and the point, you should see that the point loading process is displayed in the terminal program window - memory testing, search and firmware download.  If this does not happen - check the converter, also try swapping the wires soldered to TX and RX. <br><br> <a href=""><img src="http://s006.radikal.ru/i213/1002/e1/ff194fe58651t.jpg"></a> <a href=""><img src="https://habrastorage.org/getpro/geektimes/post_images/d96/d0a/da0/d96d0ada0f767c1c302ce9df28b375c1.jpg"></a> <br><br>  To restore the firmware, we need a TFTP server (tftpd), an FTP server (Small HTTP Server or FileZilla) and a <a href="http://rghost.ru/1029539">set of working firmware files (apimg1, art, backup, apcfg, apcfg.bak)</a> . <br><br>  By default, the address of the access point in recovery mode is 192.168.1.20.  Configure the ip-address of the computer as 192.168.1.1 with the mask 255.255.255.0 and connect it to the access point.  Restart the point with the ‚ÄúReset‚Äù button.  Immediately after the lines appeared in the terminal stating that the loader is testing the memory, repeatedly press the ESC key until the loader gives us the following invitation: <br><br> <code>[Boot]:</code> <br> <br>  Now we can see and change the settings of the bootloader and the access point itself.  The full list of commands is displayed if you enter the "?"  and press enter.  Change settings is made with the command "c".  Output current - the command "p".  From the help we learn that the bootloader can run the firmware from local memory (tffs) and through TFTP.  This is what we need.  Enter the ‚Äúc‚Äù command and in turn define the bootloader settings: <br><br> <a href=""><img src="http://s005.radikal.ru/i209/1002/1b/806c4d91834et.jpg"></a> <br><br> <code>boot device : ae1 <br> processor number: 0 <br> host name : <br> file name : art <br> inet on ethernet (e) : 192.168.1.20:0xffffff00 <br> inet on backplane (b) : <br> host inet (h) : 192.168.1.1 (ip    TFTP-) <br> gateway inet (g) : <br> user (u) : <br> ftp password (pw) : <br> flags (f) : 0x80 <br> target name (tn) : <br> startup script (s) : <br> other (o): ae</code> <br> <br>  We configure TFTPd so that its root directory points directly to the folder with the unzipped firmware files.  Enter the command "@" and press Enter.  If everything is configured correctly, the bootloader will download and download the art file.  After that, we will see the VxWorks operating system shell. <br><br><h4>  Firmware </h4><br>  Press Enter to open the invitation.  Now we will configure the FTP server.  It should also point to the firmware files.  In addition, in the settings of the ftp-server, you need to add a user, under which we will upload files, for example - guest with a password of 12345. <br><br>  To begin, initialize the flash-memory (i.e., re-create the access point file system, while removing the firmware and configuration). <br><br>  In the terminal, enter the following command: <br><br> <code>diskInit "/fl"</code> <br> <br>  In case of success, the terminal will issue a result code 0x0.  We continue: <br><br> <code>hostAdd "pc", "192.168.1.1" <br> netDevCreate "pc:", "pc", 1 <br> cd "pc:" <br> iam "guest", "12345"</code> <br> <br>  Now check if the FTP server is working.  Enter the ls command.  If the team issued a list of firmware files lying on the ftp server, copy them to the flash-memory of the point: <br><br> <code>copy "pc:/apimg1", "/fl/apimg1" <br> copy "pc:/apcfg", "/fl/apcfg" <br> copy "pc:/apcfg.bak", "/fl/apcfg.bak" <br> copy "pc:/art", "/fl/art" <br> copy "pc:/backup", "/fl/backup"</code> <br> <br>  After each command, the system should return the code 0x0 and the size of the recorded file.  Reboot the access point and call the boot loader prompt, as we did at the beginning.  Here are the bootloader settings in the initial state: <br><br> <code>boot device : tffs0 <br> processor number: 0 <br> host name : <br> file name : /fl/apimg1 <br> inet on ethernet (e) : 192.168.1.20:0xffffff00 <br> inet on backplane (b) : <br> host inet (h) : . <br> gateway inet (g) : <br> user (u) : <br> ftp password (pw) : <br> flags (f) : 0x0 <br> target name (tn) : <br> startup script (s) : <br> other (o): ae</code> <br> <br>  The next operation is not necessary, but my point refused to load until I did it.  Turning off the power point, hold down the Reset button, turn on the power and wait until the point shows in the terminal that the factory settings were reset: "resetting to factory config".  Release the reset. <br><br>  That's all.  After a reboot, the point will start in normal mode and after downloading it will be accessible from the outside by the factory IP address: 192.168.0.50. <br><br><h4>  Notes </h4><br>  If the bootloader displays ‚ÄúboardData checksum error‚Äù, you should do the following operation before downloading VxWorks.  At the bootloader's invitation, enter the ‚ÄúB‚Äù command (input of the ‚Äúboard‚Äù settings) and go over all items with the Enter key, without entering anything else.  This should be done with great care.  If you suspect that an error has occurred - do it again without rebooting. </div><p>Source: <a href="https://habr.com/ru/post/85134/">https://habr.com/ru/post/85134/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../85128/index.html">Bleeding ASUS WL 500G Premium</a></li>
<li><a href="../85129/index.html">Phantom Keystroker V2 is absolutely useless, but extremely funny!</a></li>
<li><a href="../85130/index.html">Will the Russian government support online media?</a></li>
<li><a href="../85131/index.html">Integration plan for a new job</a></li>
<li><a href="../85132/index.html">Official Internet premiere of the national sitcom</a></li>
<li><a href="../85137/index.html">Design pattern "Bridge" / "Bridge"</a></li>
<li><a href="../85140/index.html">IP addresses of the zone RU / SU</a></li>
<li><a href="../85142/index.html">Ureadahead and self-assembly core</a></li>
<li><a href="../85144/index.html">Free field game</a></li>
<li><a href="../85148/index.html">The most popular "engines" were the slowest</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>