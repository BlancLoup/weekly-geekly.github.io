<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Database Connection Dialog</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 Quite often, a programmer working with a relational database has a problem how to make the connection setup convenient for the end user...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Database Connection Dialog</h1><div class="post__text post__text-html js-mediator-article"><h4>  Introduction </h4><br>  Quite often, a programmer working with a relational database has a problem how to make the connection setup convenient for the end user.  Someone stores the connection string directly in NameApp.exe.config, this is of course inconvenient, since in order to change the connection, you have to edit the file with your hands.  Most developers write their own classes and create forms for editing the connection string directly in the application.  This is a good way, if you have already spent your time on it, but if you start from scratch, you hardly want to spend several hours creating a connection dialog box. <a name="habracut"></a><br>  I work in VS2010 and I like the studio connection window, it looks like this (hereinafter, we will discuss the SQL Server Data Provider): <br><br><img src="https://habrastorage.org/getpro/habr/post_images/695/995/3a0/6959953a0cc369d7dc37423ba5ca9a61.jpg" alt="image"><br><br>  Why not use this form in your applications? <br>  The main advantage of this dialogue form is that it is possible to choose a SQL Server available on the network and a database that corresponds to the server. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Getting started </h4><br>  A little search, it turns out that we are interested in Microsoft Data Connection Dialog <s>(who would have thought?)</s> .  Great, spend another five minutes and in the msdn archives we find the <a href="http://archive.msdn.microsoft.com/Connection/Release/ProjectReleases.aspx%3FReleaseId%3D3863">source code and documentation</a> for the project.  This could have been the end of the article, because the documentation describes everything very well and affordably, but let's continue. <br><br><h4>  We connect </h4><br>  We create a new project, specify the target platform .NET Framework 4.0 (Client Profie <b>will not work!</b> ), Throw the button and the textbox on the form. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b1e/c79/220/b1ec79220058fee60fdaa83168bb3fba.png" alt="image"><br><br>  Next, we add two DataConnectionConfiguration.cs and IDataConnectionConfiguration.cs files from the ... ConnectionDialog \ Sample \ project with msdn to our project.  In the first - the class that implements the list of data providers and saving the selected (saves in xml), the second - respectively, the interface class.  You also need two libraries: Microsoft.Data.ConnectionUI and Microsoft.Data.ConnectionUI.Dialog, you can take them from the folder ... ConnectionDialog \ ConnectionDialogUI \ bin \ Debug (Release) \, having previously built the project.  This is what should happen: <br><br><img src="http://i077.radikal.ru/1301/3c/56f9d9cc78f3.jpg" alt="image"><br><br><h4>  We use </h4><br>  Now go to the code.  In order to use the dialog box, you must initialize the DataConnectionDialog class and get the connection to the database from the ConnectionString property. <br>  Let's write a simple function that brings up a dialog box and, when you click the OK button, returns a connection string: <br><br><pre><code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">GetConnectionString</span></span></span><span class="hljs-function">(</span><span class="hljs-params"></span><span class="hljs-function"><span class="hljs-params"></span>)</span></span> { <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> connectionString = <span class="hljs-literal"><span class="hljs-literal">null</span></span>; DataConnectionDialog dcd = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DataConnectionDialog(); DataConnectionConfiguration dcs = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> DataConnectionConfiguration(<span class="hljs-literal"><span class="hljs-literal">null</span></span>); dcs.LoadConfiguration(dcd); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (DataConnectionDialog.Show(dcd) == DialogResult.OK) connectionString = dcd.ConnectionString; dcs.SaveConfiguration(dcd); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> connectionString; }</code> </pre> <br><br>  Now use this function in the button1 handler. <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">private</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">button1_Click</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">object</span></span></span></span><span class="hljs-function"><span class="hljs-params"> sender, EventArgs e</span></span></span><span class="hljs-function">)</span></span> { textBox1.Text = GetConnectionString(); }</code> </pre> <br><br>  We start the project, press the button, select the supplier, specify the server and database, click OK and see the connection string to the database in the textbox. <br><br><img src="http://i077.radikal.ru/1301/cf/225c1bff2e9f.png" alt="image"><br><br><h4>  Conclusion </h4><br>  The only drawback is that you will not see the great and mighty in the dialog box.  For this, you will have to manually localize the forms and the Strings.resx file in the ConnectionUIDialog project.  You can take the project localized by me <a href="http://rghost.ru/43364913">here</a> (project VS2010 SP1). </div><p>Source: <a href="https://habr.com/ru/post/167067/">https://habr.com/ru/post/167067/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../167057/index.html">WindowsAndroid allows you to run Android 4.0 ICS as a Windows application</a></li>
<li><a href="../167059/index.html">Scrum - real experience in methodology</a></li>
<li><a href="../167061/index.html">Remember the real world</a></li>
<li><a href="../167063/index.html">Selectel Cloud - About Super Habraeffect, Small Optimization, and Costs for 2 Years</a></li>
<li><a href="../167065/index.html">Publish to Azure Blob Storage with Shared Access Signature</a></li>
<li><a href="../167071/index.html">Headphones Monster DNA: a comparative review on the background of Beats Solo HD</a></li>
<li><a href="../167073/index.html">THL A1 - budget smartphone with IPS screen</a></li>
<li><a href="../167075/index.html">The use of procedural generators in creating content for real-time 3D applications: Part 1. Oil Rush</a></li>
<li><a href="../167083/index.html">Winter Rating</a></li>
<li><a href="../167085/index.html">The power of CSS will help you take shape, SVG!</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>