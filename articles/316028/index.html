<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Lean Manufacturing at an Advertising Agency: Robotize the daily routine work of employees with AutoIt</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It all started with the task of creating a report on mutual settlements with customers and suppliers. There was a prospect to collect all the data by ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Lean Manufacturing at an Advertising Agency: Robotize the daily routine work of employees with AutoIt</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/f0f/a93/f85/f0fa93f85fdc958ea9d63e2c26fb9ff0.jpg" alt="image"><br><br>  It all started with the task of creating a report on mutual settlements with customers and suppliers.  There was a prospect to collect all the data by hand.  A whole department of 7 girls did not know how to approach this, given that the base consisted of more than 180 thousand lines and was maintained in MS Access. <a name="habracut"></a><br><br><h5>  <b>What are we talking about</b> </h5><br>  In one large advertising agency there is a ‚Äúzoo‚Äù.  In the sense of the "zoo" of various information systems, which were created over the years by the staff themselves, trying to somehow automate the manual work.  This article will focus on automating the work of the Media Acquisition Control Department (abbreviated as ‚ÄúCC‚Äù).  This is the unit controlling which site how much money is paid and whether there are overpayments / underpayments.  Important people for business, to put it simply.  It so happened that since 2010, this department has its own database of these transactions, closing documents and contracts.  The database was created by an advanced manager, so it was originally created on Access 2007, with a bunch of macros, but without forms.  Data storage is of course in the database file itself. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      It all started with the task that the accounting department set for the short-circuit: upload information on all closing documents within a certain period.  Roughly speaking, I needed a sign of 20 columns, including the number and date of the contract with the supplier, the status of payments for the project, the presence of acts and the like.  An ordinary report that could turn the lives of 7 employees of the KZ department into hell.  And the thing is that when you try to unload the necessary information, the database is hopelessly hung.  Access plates were not designed to display tens of thousands of records.  The engine did not anticipate queries with a dozen LEFT JOINs.  Indices did not help.  The head of the department came to work every day, opened the base and could not even approach the manual reunion of a tablet of a couple of tens of thousands of lines.  Bookkeeping, meanwhile, set a fairly tight deadline and waited for data.  Employees, leaving their children and husbands, were preparing to spend the night in the office. <br><br><h5>  <b>Lean</b> </h5><br>  After such a sad introduction, let's talk a little about theory and control.  So, the advertising agency sells the service.  Not an advertisement.  Advertising is only a subject for conversation, something we can do well.  But they pay us for what we will quickly and within the framework of the commission do for the client all the dirty work and even better than he expects.  The client also expects rational proposals from us to improve his campaigns, on the best ways to achieve his indicators.  Those indicators with which he reports to his leadership.  It goes without saying that the client expects perfect document flow, flawless closures and phenomenal accuracy in meeting deadlines on them.  Returning to our girls, I still do not understand how they provided all this with the help of a normal base on a normal accessory.  But that's not the point.  In short, quality service takes time.  And here we will deal a little with the concept of lean production, since it is in practice directly related to the problem being analyzed here. <br><br>  Lean manufacturing (in English, ‚Äúlean‚Äù), in simple terms, is a way of producing a product in which the share of losses tends to zero.  This concept is a creative redevelopment of Toyota‚Äôs experience.  The basic idea is to identify losses in typical areas such as defective products, unjustified delays in warehouses, over-processing, downtime, shrinkage / outflow, and so on.  According to <a href="http://www.vedomosti.ru/management/articles/2016/11/17/665256-sistemu-berezhlivogo-proizvodstva">some sources</a> , the savings from the introduction of the concept of lean in large enterprises amount to billions of rubles.  You ask me, what does this have to do with a service company, such as an advertising agency?  The most direct. <br><br>  We sell the service.  For quality service takes time.  Time and people are our resource.  And if people sit for days and copy-paste in ekselki, then this is a loss.  Losses of time and, over time, of people.  Inefficient production service, if you want.  It is calculated by multiplying the hourly wage rate by the number of hours spent unnecessarily.  Suppose an employee of the purchasing control department receives conditional 40 thousand rubles a month for 160 hours of work.  Or 250 rubles per hour.  She instead of clicking on one button and get the desired report in 1 minute, copy-paste within a couple of weeks.  And not one employee, but the whole department: 250 (rate) x 8 (hours per day) x 10 (working days) x 7 (girls).  We get 140 thousand rubles spent on copy-paste.  Losses for quality service are generally difficult to calculate, because when a report is compiled by copy-paste, the rest of the work is either worth it or it becomes unclear how. <br><br><h5>  <b>Half-speed solution accelerating manual work</b> </h5><br>  Let's move from theory to practice.  So, there is a task not feasible with standard tools: unload a report.  In addition, in the future there is a need to somehow put the process of creating a report on the stream, and preferably by the procurement control department itself.  Below is a description of the decision, however, I would not want it to be perceived as a ready-made recipe from <a href="http://toster.ru/">the Toaster</a> , but rather as a concept for working with all such tasks.  Even more.  Ideally, it would be necessary to analyze all the processes of the company and identify the steps that can be automated using the model proposed below. <br><br>  To solve the above two tasks, we needed: <a href="https://www.microsoft.com/ru-ru/download/details.aspx%253Fid%253D29062">MS SQL Server 2012 Express</a> , <a href="http://autoit-script.ru/">AutoIt</a> , <a href="https://habrahabr.ru/post/271019/">PowerQuery</a> . <br><br>  Since Access does not allow you to make complex queries from tables containing hundreds of thousands of rows, it was decided to use heavy artillery, namely MS SQL Server 2012 Express.  The base installation is described in sufficient detail by the vendor, so I will not dwell on this.  From Access, the corresponding tables (in which the data for the report) were exported manually through an ODBC connection <a href="https://msdn.microsoft.com/en-us/library/ms811006.aspx">previously created</a> : <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/6c2/da4/a76/6c2da4a76e48c7854673ce5187e64b85.jpg"></div><br>  Next, we hung the indexes on all the tables we exported, which made it possible to increase the query processing speed by 4-6 times: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/91a/660/449/91a660449957c119cd5f7c2744f981dc.jpg"></div><br>  Then they wrote a multi-line query with a bunch of LEFT JOIN, GROUP BY and WHERE.  I will not give details here, but they are not significant.  Principle is important.  After processing the request, do Ctrl + a (select all results).  Next, go to the pre-prepared exelcuka and paste the data Ctrl + v.  We put in order the formats, save, send to the accounting department The process took not two weeks, but 10 minutes.  But one problem: only a very well-trained specialist can fulfill it.  And any problems (for example, the error of exporting the table due to the date in the wrong format) turn into <a href="https://msdn.microsoft.com/ru-ru/library/ms140052.aspx">those still dances with a tambourine</a> (any format errors are solved through export to Excel and import it already in MS SQL).  In short, these crutches had to be automated. <br><br><h5>  <b>The right decision with AutoIt</b> </h5><br>  And here comes the all-powerful AutoIt.  This is an extremely potential thing if the company has at least dozens of employees.  There are a number of actions that a certain percentage of people perform: open timeshits on time, run the development / debugging environment (IDE + base + window with git + backup done), open the accounting system for the desired list of projects and similar things, which seem to be minor, but Dozens of minutes of working time are consumed by hundreds of people.  In sum, this turns out to be a huge waste in vain, which can be quite entrusted to a software robot.  But back to our problem. <br><br>  So, it is necessary to automate the process described above, and there should be only two actions: start the process, get the finished report.  It would be possible to write a certain program that connects first to Access, unloads data from it, then fills it in MS SQL and runs the necessary query, the results of which are then unloaded into the resulting Excel.  It would take weeks of development, catching bugs.  It was decided to use a ready-made application infrastructure, which will be managed by the AutoIt script.  Uploading the finished report was entrusted to PowerQuery, since it was sharpened for such tasks. <br><br>  In order for everything to work, it was necessary to make a macro in the source Access file in advance, which exports the data to MS SQL: <br><br><pre><code class="hljs vhdl">Public <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span> TransferKz() '      MSSQL '   Dim Tables(<span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">To</span></span> <span class="hljs-number"><span class="hljs-number">11</span></span>) As <span class="hljs-built_in"><span class="hljs-built_in">String</span></span> Dim i As <span class="hljs-built_in"><span class="hljs-built_in">Integer</span></span> Tables(<span class="hljs-number"><span class="hljs-number">1</span></span>) = <span class="hljs-string"><span class="hljs-string">"table1"</span></span> Tables(<span class="hljs-number"><span class="hljs-number">2</span></span>) = <span class="hljs-string"><span class="hljs-string">" table2"</span></span> Tables(<span class="hljs-number"><span class="hljs-number">3</span></span>) = <span class="hljs-string"><span class="hljs-string">" table3"</span></span> '‚Ä¶ <span class="hljs-keyword"><span class="hljs-keyword">For</span></span> i = <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">To</span></span> <span class="hljs-number"><span class="hljs-number">11</span></span> DoCmd.TransferDatabase acExport, <span class="hljs-string"><span class="hljs-string">"ODBC Database"</span></span>, <span class="hljs-string"><span class="hljs-string">"ODBC;DSN=kz;"</span></span>, acTable, Tables(i), Tables(i) <span class="hljs-keyword"><span class="hljs-keyword">Next</span></span> i MsgBox <span class="hljs-string"><span class="hljs-string">"Tables exported"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">End</span></span> <span class="hljs-keyword"><span class="hljs-keyword">Function</span></span></code> </pre> <br>  In addition, an Excel file has been prepared in advance that contains the PowerQuery model, which unloads the necessary data from the database.  Here this model will not be considered.  But you can get acquainted with the principles of PowerQuery <a href="https://habrahabr.ru/post/271019/">here</a> and <a href="https://habrahabr.ru/post/311600/">here</a> . <br><br>  When you run the AutoIt script, the following happens: <br><br><ol><li>  A window is displayed with a warning that you cannot touch the keyboard and mouse while the script is running: <br><br>  MsgBox (0, "We are starting", "During the work of the script, you should not press any buttons and open windows. It is better to just move away from the computer for 1-2 minutes." <br><br></li><li>  A MS Access file is copied containing the data we need: <br><br><pre> <code class="hljs perl">FileCopy($file_path_from, $file_path_to, $FC_OVERWRITE + $FC_CREATEPATH)</code> </pre><br></li><li>  MS SQL Management Studio starts: <br><br><pre> <code class="hljs lisp">Run($ssms_path) WinWaitActive(<span class="hljs-string"><span class="hljs-string">"  "</span></span>) Send($sql_server_address &amp; <span class="hljs-string"><span class="hljs-string">"{ENTER}"</span></span>) WinWaitActive(<span class="hljs-string"><span class="hljs-string">"Microsoft SQL Server Management Studio"</span></span>)</code> </pre><br></li><li>  All tables in the short-circuit database are deleted.  $ small_sleep - a variable containing the pause time before the commands.  It is necessary because  otherwise, applications sometimes do not have time to finally work out the command before running the following: <br><br><pre> <code class="hljs lisp">Send(<span class="hljs-string"><span class="hljs-string">"^{o}"</span></span>) Sleep($small_sleep) Send($sql_dir &amp; $sql_file_Query_drop_tables) Sleep($small_sleep) Send(<span class="hljs-string"><span class="hljs-string">"{ENTER}"</span></span>) Sleep($small_sleep) Send(<span class="hljs-string"><span class="hljs-string">"{F5}"</span></span>) Sleep($small_sleep) <span class="hljs-comment"><span class="hljs-comment">;    Send("^{F4}{TAB}{ENTER}")</span></span></code> </pre><br></li><li>  The Access file received in step 2 is launched: <br><br><pre> <code class="hljs vhdl">;  <span class="hljs-keyword"><span class="hljs-keyword">Access</span></span>        Run( $db_path &amp; <span class="hljs-string"><span class="hljs-string">" /x TransferKz"</span></span> ) ; : ¬´Tables exported¬ª WinWaitActive(<span class="hljs-string"><span class="hljs-string">"[CLASS:#32770]"</span></span>) ;  <span class="hljs-keyword"><span class="hljs-keyword">Access</span></span> Send(<span class="hljs-string"><span class="hljs-string">"!+{F4}"</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>)</code> </pre><br></li><li>  Create indexes on the tables just exported: <br><br><pre> <code class="hljs perl">;   ,    WinActivate(<span class="hljs-string"><span class="hljs-string">"Solution1 - Microsoft SQL Server Management Studio"</span></span>) Send(<span class="hljs-string"><span class="hljs-string">"^{o}"</span></span>) Sleep($small_sleep) Send($sql_file_indexes) Sleep($small_sleep) Send(<span class="hljs-string"><span class="hljs-string">"{ENTER}"</span></span>) Sleep($small_sleep) Send(<span class="hljs-string"><span class="hljs-string">"{F5}"</span></span>) Sleep($small_sleep) ;  MSSQL Management Studio Send(<span class="hljs-string"><span class="hljs-string">"!+{F4}"</span></span>,<span class="hljs-number"><span class="hljs-number">0</span></span>)</code> </pre><br></li><li>  Excel starts up containing the model for uploading data from MS SQl we need: <br><br><pre> <code class="hljs lisp">ShellExecute($file_ excel)</code> </pre> </li></ol><br>  The AutoIt script is finished.  Now you just need to click on the ‚ÄúUpdate‚Äù button in the open Excel file and wait for the required report to be received.  The time it takes to complete the script from a mouse click to a report upload - 3.5 minutes of which 2 are pauses between steps. <br><br><h5>  <b>findings</b> </h5><br>  As casually mentioned above, we worked through the issue of solving the problem in the following ways: by radically rewriting the base of the purchasing control department from scratch, or by moving the tables to MS SQL and continuing to use MS Access as a frontend.  The main obstacle to the implementation of these plans is time.  Yes, you can make a base on 1C, having spent on it two or three months, money for the developer.  1C is not suitable for a holistic solution of accounting and workflow in our agency.  Another system was chosen, so somehow or other we will have to redo everything from scratch soon on a new platform.  The implementation of the above set of methods took 3 days.  2 of which were spent on testing an already running system and debugging a query in MS SQL.  No professional developer had a hand in the code above.  Everything was done on their own, in their free time from other projects.  The company stayed with their money.  Time is saved for something more useful than copy-paste.  Lean manufacturing in action. </div><p>Source: <a href="https://habr.com/ru/post/316028/">https://habr.com/ru/post/316028/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../316014/index.html">The traveling salesman task by the Little method in C ++</a></li>
<li><a href="../316016/index.html">Swift String Validating or simple validation of strings to meet criteria.</a></li>
<li><a href="../316020/index.html">Promotion of mobile games in the Asian market. Interview with Ilya Salamatov, 101XP</a></li>
<li><a href="../316022/index.html">Autumn in indie game markets</a></li>
<li><a href="../316024/index.html">Beginner's Guide to VR Developers</a></li>
<li><a href="../316030/index.html">Universal Auto Designer</a></li>
<li><a href="../316032/index.html">data.table: we squeeze out the maximum speed when working with data in the R language</a></li>
<li><a href="../316036/index.html">On the impact of full-page writes</a></li>
<li><a href="../316038/index.html">News Yii 2. ‚Ññ1</a></li>
<li><a href="../316040/index.html">New survey ‚ÄúState of the Nation of Developers‚Äù by Vision Mobile</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>