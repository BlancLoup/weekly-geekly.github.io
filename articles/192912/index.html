<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Convert image to ANSI</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I do not know how interesting this will be to someone, but the other day I decided to play around and do the following: 

 Given: Picture (for example...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Convert image to ANSI</h1><div class="post__text post__text-html js-mediator-article">  I do not know how interesting this will be to someone, but the other day I decided to play around and do the following: <br><br>  Given: Picture (for example, BMP) 640 by 400, font 8 by 16 <br><br>  Necessary: ‚Äã‚ÄãTranslate it into ANSI pseudographics in standard 80 by 25 characters, characters and background can be of any color (true color). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/392/e7b/b76/392e7bb76f24230f03e19338a3358d64.png" alt="image"><br><br>  Thanks to very good comments, I updated the version: <a href="">link</a> <br>  With it you get something like this: <img src="https://habrastorage.org/getpro/habr/post_images/985/e42/17a/985e4217a647997d33d274be732ad9ac.png" alt="image"><br><br><a name="habracut"></a><br>  It is worth mentioning here that the ‚Äútrue‚Äù EGA text mode with 16 colors will not suit us, as it will turn out too ugly due to the low resolution and large size of characters.  The second argument: the task is not to bring the picture as close as possible to its symbolic representation, since then it would be possible to reduce the font, increase the resolution, etc.  The task - to make just such a filter, which is described above. <br><br>  For what I publish it here: it seemed to me that it would be useful for novice programmers to practice understanding the algorithm, so I marked this material as a tutorial. <br><br>  To implement, we will need some kind of library for working with graphics, which can getpixel and putpixel, that is, read the color of the pixel from the screen and draw the pixel with the specified color on the screen.  I use an old but proven Allegro library (www.allegro.cc), which is easy to use and also allows you to work in different operating systems (even in MSDOS!). <br><br>  But enough words, it's time to work. <br><br><pre><code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> size_x=<span class="hljs-number"><span class="hljs-number">640</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> size_y=<span class="hljs-number"><span class="hljs-number">400</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> ascii_x=<span class="hljs-number"><span class="hljs-number">80</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">const</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> ascii_y=<span class="hljs-number"><span class="hljs-number">25</span></span>;</code> </pre> <br><br>  Set the constants responsible for the size of the image and the size of its textual representation. <br><br><pre> <code class="cpp hljs"><span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> cx=<span class="hljs-number"><span class="hljs-number">0</span></span>;cx&lt;ascii_x;cx++) <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(<span class="hljs-keyword"><span class="hljs-keyword">int</span></span> cy=<span class="hljs-number"><span class="hljs-number">0</span></span>;cy&lt;ascii_y;cy++){ <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> fullr=<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> fullg=<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> fullb=<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> pixels=<span class="hljs-number"><span class="hljs-number">0</span></span>; <span class="hljs-comment"><span class="hljs-comment">//find background color for(int i=0;i&lt;size_x/ascii_x;i++) for(int j=0;j&lt;size_y/ascii_y;j++){ int col=getpixel(pic,i+cx*size_x/ascii_x,j+cy*size_y/ascii_y); int r=getr(col); int g=getg(col); int b=getb(col); fullr+=r;fullg+=g;fullb+=b; pixels++; } fullr/=pixels;fullg/=pixels;fullb/=pixels;</span></span></code> </pre><br><br>  We start the main loop in which we sequentially find each character from 80 to 25 matrices.  The next cycle is for each pixel of that area of ‚Äã‚Äãthe picture that corresponds to the given symbol from this matrix on the screen.  As it is easy to figure out, this area is 640/80 = 8 by 400/25 = 16 pixels.  Here it is useful to remember that this is exactly equal to the size of our font. <br><br>  In this second cycle, our task is to find the average color, which we will set as the background color of our ANSI character.  It is very simple to do this: we spread the color on the R, G, B components and calculate the average for each of them. <br><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//find ascii and its color int rms=100000000; for(int curch=1;curch&lt;256;curch++){ //loop over ASCII table int charr=0; int charg=0; int charb=0; //find char color pixels=0; //number of pixels for char for(i=0;i&lt;size_x/ascii_x;i++) for(int j=0;j&lt;size_y/ascii_y;j++){ int col=getpixel(pic,i+cx*size_x/ascii_x,j+cy*size_y/ascii_y); int r=getr(col); int g=getg(col); int b=getb(col); int colch=getpixel(font,i+(curch%32)*8,j+(curch/32)*16); int rc=getr(colch); int gc=getg(colch); int bc=getb(colch); if(rc!=0&amp;&amp;gc!=0&amp;&amp;bc!=0){ //get actual char pixels only charr+=r; charg+=g; charb+=b; pixels++; } } if(pixels!=0){ charr/=pixels;charg/=pixels;charb/=pixels; }</span></span></code> </pre><br><br>  Next is more interesting.  We have to insert another cycle - for each character from the ASCII table (there are 256 of them).  I take them from a black and white picture with a font, that is, theoretically, there can be any 8 by 16 images as a symbol.  It should be noted that in this place you can limit yourself to only one area of ‚Äã‚Äãcharacters (for example, Cyrillic), which will greatly affect the result. <br><br>  In the above code snippet we find the color of the symbol.  To do this, we consider the amount as above, but with a slight change: the pixels are taken according to the mask, which is the current character from the font.  Thus, the second ‚Äúaverage color‚Äù corresponds only to the pixels with which the symbol itself will be drawn. <br><br>  It is also worth noting that the number of such pixels can be zero (for example, the symbol 32 is a space).  With this you need to be careful. <br><br><pre> <code class="cpp hljs"><span class="hljs-comment"><span class="hljs-comment">//find rms int currms=0; for(i=0;i&lt;size_x/ascii_x;i++) for(int j=0;j&lt;size_y/ascii_y;j++){ int col=getpixel(pic,i+cx*size_x/ascii_x,j+cy*size_y/ascii_y); int r=getr(col); int g=getg(col); int b=getb(col); int rr=0,gg=0,bb=0; int colch=getpixel(font,i+(curch%32)*8,j+(curch/32)*16); int rc=getr(colch); int gc=getg(colch); int bc=getb(colch); if(rc!=0&amp;&amp;gc!=0&amp;&amp;bc!=0){ //char pixel rr=charr; gg=charg; bb=charb; } else{ //back pixel rr=fullr; gg=fullg; bb=fullb; } currms+=sqrt((r-rr)*(r-rr)+(g-gg)*(g-gg)+(b-bb)*(b-bb)); } if(currms&lt;rms){ //find minimal rms findr=charr; findg=charg; findb=charb; findch=curch; rms=currms; if(DEBUG)printf("!!!%d %d\n",currms, curch); } else if(DEBUG)printf("%d %d\n",currms, curch); } //find char</span></span></code> </pre><br><br>  Well, finally, they came to the salt itself.  In this piece of code, we once again traverse the pixels of the specified image area and assume the RMS (standard deviation) of all three color components from the background color or symbol (depending on whether the pixel is on the background or on the symbol).  Total RMS and will be a criterion of how well this symbol fits well with this area of ‚Äã‚Äãthe picture. <br><br>  This is followed by the output to the screen (in two modes - with the background and without ( <a href="">example</a> )), but we will not dwell on it, since everything is self-evident. <br><br><img src="http://habrastorage.org/getpro/habr/post_images/854/984/ec4/854984ec47b098fe99f312db664f9659.png" alt="image"><br><br>  The program and source code can be downloaded here: <a href="">dimouse.ru/data/ansiconv.rar</a> (130 Kb). <br><br>  How about drawing this thing in text mode?  As you can see, the program creates a file with the results (except for the new bmp) - ascii.  There for each character its value is stored in the ASCII table, its color and the color of its background.  I use <a href="http://pdcurses.sourceforge.net/">pdcurses.sourceforge.net</a> for text mode (write in the comments if you know something better!), But this library, although it is a wrapper over SDL (in any case, the Windows version is for sure) cannot display colors anymore 16: heavy legacy of antiquity.  As you probably remember, PDCurses originates from the famous Interactive Fiction game <a href="http://en.wikipedia.org/wiki/Curses_(video_game)">Curses</a> .  But one friend wrote an improvement to this library and posted it here: <a href="http://www.projectpluto.com/win32a.htm">www.projectpluto.com/win32a.htm</a> <br><br>  Unfortunately, it is impossible to use the bitmap font in it, only the system font (but you can choose any), which spoils the impression a bit.  But the task can also be considered completed. <br><br>  A program for reading ascii can be downloaded here: <a href="">dimouse.ru/data/ascii.rar</a> (70 Kb). </div><p>Source: <a href="https://habr.com/ru/post/192912/">https://habr.com/ru/post/192912/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../192896/index.html">How not to free the Internet</a></li>
<li><a href="../192900/index.html">Live bifidoprogram</a></li>
<li><a href="../192902/index.html">Snippets for Chrome DevTools</a></li>
<li><a href="../192906/index.html">IFA 2013. New to Philips. Acoustics and TVs</a></li>
<li><a href="../192908/index.html">Glory to the epigones, or the Great against the best</a></li>
<li><a href="../192914/index.html">Mailpile's Paypal wallet has been frozen for 24 hours.</a></li>
<li><a href="../192918/index.html">The digest of interesting materials from the world of web development and IT for the last week No. 73 (September 1‚Äî7, 2013)</a></li>
<li><a href="../192920/index.html">Regular expression parsing</a></li>
<li><a href="../192922/index.html">LADEE lunar machine successfully launched + NASA account appeared in Instagram</a></li>
<li><a href="../192924/index.html">Dash: Design "Create a robot" for adults</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>