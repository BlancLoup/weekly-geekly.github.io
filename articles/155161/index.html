<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Sparkfun.com FREE day or * what do you think of recaptcha *</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Inspiration 

 While 55% hate ... 

 And I chose the "other". Because I love. But not for what I consider more convenient than others, but for the fac...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Sparkfun.com FREE day or * what do you think of recaptcha *</h1><div class="post__text post__text-html js-mediator-article">  <a href="http://habrahabr.ru/post/155151/">Inspiration</a> <br><br>  While 55% hate ... <br><br>  And I chose the "other".  Because I love.  But not for what I consider more convenient than others, but for the fact that ... <br><a name="habracut"></a><br>  Once a year, the American company sparkfun.com, well known to every DIY-ps, holds (almost) a lottery.  For the last, or, as the parachutists say, the last time they did it was January 10th of this year.  The essence is simple - you go to the site and within a certain time you solve those same hated recaptchas.  Some device randomly chooses one of the guessed captcha and gives the author a certificate for $ 100 - with this money you can order anything on sparkfan, only delivery is paid.  That is absolutely honest giv-evay. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      And so, in the 9th Colorado time, a lot of people from all over the world sit down to guess the recaptcha.  The site immediately falls.  A stub is placed in its place, which apologizes for the inaccessibility of the store and throws you onto a separate page to solve the captchas.  In fact, there, in Colorado, people do not sit and do not laugh at razgadyvalschikami, and struggles to overcome this habraeffekt. <br><br>  I won - after half an hour driving in the recaptcha: <br><br><img src="https://habrastorage.org/storage2/cce/b5e/ff2/cceb5eff2d7f653d6b9eb424a4c63fda.jpg"><br><br>  Imagine how many people have already thrown to read and shit in my karma.  Now delicious for the most persistent.  Translation of the report from the sparkfan site: <br><br><h4>  Free day report </h4><br>  January 12, 2012 <br><img src="https://habrastorage.org/storage2/769/214/28e/76921428e38b686450d67fe0c64254cc.jpg"><br><br>  Again, January and another Free Day.  Whether you won or lost, we hope everyone enjoyed it.  Oh, we got a ton of pleasure in arranging it - that's for sure! <br><br>  Numbers: <br>  Some numbers, then I will tell you how we organized it. <br><ul><li>  <b>6,437,592 right decisions</b> recaptcha.  This does not include those attempts in which the recaptcha was solved incorrectly, as well as those that were registered by pressing the GO button without filling in the answer field </li><li>  If we assume that the average person spends 4 seconds on captcha, <b>7 188 hours</b> were spent <b>on</b> everything, i.e.  about <b>10 months</b> time! </li><li>  Each captcha was processed by the sparkfan server - i.e.  300 captums per second for 355 minutes - when we handed out money </li><li>  <b>32,137 Unique visitors</b> to the site (according to Analytics reports).  With a certain margin of error is the number of players. </li><li>  On average, <b>each filled 208 captchas</b> .  Knowing what a captcha is is dofiga! </li><li>  <b>704,617 page views</b> during the day </li><li>  <b>2000 promo codes</b> were distributed, of which <b>473 were signed on the same day</b> .  The first order went into delivery at 10:45, i.e.  less than 2 hours after the start of the event </li><li>  We issued promo codes about <b>once every 5.6 minutes.</b> </li><li>  On this day, <b>7,776 accounts</b> were registered </li></ul><br><h4>  More numbers for those in the subject. </h4><br><ul><li>  At the maximum, our MySQL processed <b>13,380 requests per second.</b> </li><li>  The maximum bandwidth of our network was <b>1,214.35Mb / s</b> </li><li>  The maximum channel width to the provider reached a <b>little over 76M.b / s</b> </li><li>  At the maximum we had <b>84,220 active TCP connections</b> . </li><li>  We banned <b>32 bots</b> . </li><li>  We put an external site redirecting too much traffic to it (Sorry, <a href="https://cosm.com/">Pachube</a> !) </li></ul><br><br><img src="https://habrastorage.org/storage2/587/698/02c/58769802cb0dcebeee0493fc9be1902a.jpg"><br><br><h4>  The actual installation that was used </h4><br>  As we did this - again, for geeks.  If you participated in the first two promotions, you might have noticed that the promotion went much better this year.  If we exclude the fact that the site choked in the first minutes, when the largest influx of participants went, the site responded to itself quite well, while it actually handled huge traffic.  What has changed compared to previous years? <br>  We pulled some software and hard to our servers.  Now we have a couple of fat web servers, each with 16 cores and 32 gigabytes of RAM, and we have hard-load load balancers. <br>  Plus, we optimized our own code for working with our hardware, changed some open-source software.  We also migrated from Apache to Nginx, where PHP-FPM handled all the processing.  Before all this, Tarnish Varnish is still caching everything that comes out - which turned out to be awesome for the promotion. <br>  Also, in past years, we noticed that most often lags were caused by MySQL brakes, well, we backed it in some places with MongoDB.  For some (especially hierarchical data) this made sense.  This helped us really quickly show the page.  Unfortunately, because of a small bug in the PHP Mongo driver, we got a gag in the first minutes of the action. <br>  Previously, we all gave all the content directly from our server.  When the load is normal, this is OK - the pages load normally and the channel we eat is small.  Naturally, during the Free Day, everything changes.  This year we have all the static content hung on the Amazon Cloudfront.  Cloudfront is such a global CDN that sits on top of the well-known S3 store and loads content from regional servers to users all over the world.  In this case, of course, the burden falls on them, not on us.  But this does not save much either.  Those 76Mb / s, which we passed through our servers - it was basically gzip-packed text. <br><br><h4>  Geiger counter? </h4><br><img src="https://habrastorage.org/storage2/a37/3af/c56/a373afc5667f41bf63c4d6bb96ee0b8d.png"><br>  Well, what.  Anyone familiar with computer science will tell you that the random numbers that the computer generates are actually pseudo-random numbers.  They can be predicted - even if there is 1 chance out of a million in success, it is still a chance.  So how do we build an absolutely random system? <br>  We chose <a href="https://www.sparkfun.com/products/10742">a geiger counter</a> to measure background radiation.  The counter pulls the controller's foot down each time it sees a charged particle - it happens absolutely exactly at random.  We installed our Ethernet Pro to monitor these interruptions and send a byte to the daemon sitting on one of the web servers, so that it would notify the next guessed captcha about the victory. <br><br>  Here is the code for dunya: <br><br><pre><code class="hljs dos">#include &lt;Ethernet.h&gt; #include &lt;SFEbarGraph.h&gt; #include &lt;SPI.h&gt; // Default 'ino MAC address byte mac[] = { <span class="hljs-number"><span class="hljs-number">0</span></span>xDE, <span class="hljs-number"><span class="hljs-number">0</span></span>xAD, <span class="hljs-number"><span class="hljs-number">0</span></span>xBE, <span class="hljs-number"><span class="hljs-number">0</span></span>xEF, <span class="hljs-number"><span class="hljs-number">0</span></span>xFE, <span class="hljs-number"><span class="hljs-number">0</span></span>xED }; byte ip[] = { <span class="hljs-number"><span class="hljs-number">192</span></span>, <span class="hljs-number"><span class="hljs-number">168</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span> }; int up = <span class="hljs-number"><span class="hljs-number">8</span></span>; int down = <span class="hljs-number"><span class="hljs-number">7</span></span>; int upstate = <span class="hljs-number"><span class="hljs-number">0</span></span>; int downstate = <span class="hljs-number"><span class="hljs-number">0</span></span>; // <span class="hljs-built_in"><span class="hljs-built_in">replace</span></span> with your server byte server[] = { <span class="hljs-number"><span class="hljs-number">192</span></span>, <span class="hljs-number"><span class="hljs-number">168</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span> }; EthernetClient client; SFEbarGraph BG; volatile int counter = <span class="hljs-number"><span class="hljs-number">0</span></span>; int oldcount = <span class="hljs-number"><span class="hljs-number">0</span></span>; int target = <span class="hljs-number"><span class="hljs-number">8</span></span>; int multiplier = <span class="hljs-number"><span class="hljs-number">2</span></span>; void setup() { BG.begin(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">9</span></span>); // Interrupt from the Geiger tube attachInterrupt(<span class="hljs-number"><span class="hljs-number">0</span></span>, detect, RISING); Serial.begin(<span class="hljs-number"><span class="hljs-number">9600</span></span>); Ethernet.begin(mac, ip); // <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> up buttons pinMode(up, INPUT); digitalWrite(up, HIGH); pinMode(down, INPUT); digitalWrite(down, HIGH); delay(<span class="hljs-number"><span class="hljs-number">1000</span></span>); } void loop() { // read up button <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(LOW == digitalRead(up)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span> == upstate) { target++; redraw(); upstate = <span class="hljs-number"><span class="hljs-number">1</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { upstate = <span class="hljs-number"><span class="hljs-number">0</span></span>; } // read down button <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(LOW == digitalRead(down)) { <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(<span class="hljs-number"><span class="hljs-number">0</span></span> == downstate) { target--; redraw(); downstate = <span class="hljs-number"><span class="hljs-number">1</span></span>; } } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { downstate = <span class="hljs-number"><span class="hljs-number">0</span></span>; } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(counter == oldcount) { delay(<span class="hljs-number"><span class="hljs-number">1</span></span>); return; } oldcount = counter; // handle wins <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(counter &gt;= target) { win(); counter = <span class="hljs-number"><span class="hljs-number">0</span></span>; oldcount = <span class="hljs-number"><span class="hljs-number">0</span></span>; return; } redraw(); } // <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> the interrupt void detect() { counter++; } void redraw() { // boundaries <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(target &gt; (<span class="hljs-number"><span class="hljs-number">30</span></span> / multiplier)) target = (<span class="hljs-number"><span class="hljs-number">30</span></span> / multiplier); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span>(target &lt; <span class="hljs-number"><span class="hljs-number">1</span></span>) target = <span class="hljs-number"><span class="hljs-number">1</span></span>; BG.clear(); BG.send(); BG.barGraph(counter * multiplier, target * multiplier); } void win() { Serial.println("WINNER"); <span class="hljs-keyword"><span class="hljs-keyword">for</span></span>(int i = target * multiplier; i &gt;= <span class="hljs-number"><span class="hljs-number">0</span></span>; i--) { BG.barGraph(i, target * multiplier); delay(<span class="hljs-number"><span class="hljs-number">35</span></span>); } <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> ( ! client.connected()) { Serial.println("connecting..."); <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (client.connect(server, <span class="hljs-number"><span class="hljs-number">5555</span></span>)) { Serial.println("connected"); } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { Serial.println("connection failed"); } } // <span class="hljs-built_in"><span class="hljs-built_in">Print</span></span> a <span class="hljs-number"><span class="hljs-number">1</span></span> to the Ethernet server <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> every win client.<span class="hljs-built_in"><span class="hljs-built_in">print</span></span>("<span class="hljs-number"><span class="hljs-number">1</span></span>"); }</code> </pre> <br><br>  Well, to close the topic, here's <a href="https://github.com/benlemasurier/meltdown">the bit server code</a> that Ben wrote to handle hundreds of requests per second.  He tested it on load up to 600 thousand requests per second. <br><br>  Well, who knows English - do not deny yourself the pleasure of reading the comments on <a href="http://www.sparkfun.com/news/781">this</a> post and watch the <a href="http://www.sparkfun.com/news/834">video</a> .  There you will find out if the people love captcha. <br><br><img src="https://habrastorage.org/storage2/45f/93c/cac/45f93ccacf34986c3f1f0a181afa9438.png"><br><br>  From the translator and the author of the post: the translation is quite free - do not judge.  The mood is that either this way or that way. </div><p>Source: <a href="https://habr.com/ru/post/155161/">https://habr.com/ru/post/155161/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../155147/index.html">How much do top bloggers make money?</a></li>
<li><a href="../155151/index.html">How do you feel about recaptcha?</a></li>
<li><a href="../155153/index.html">Rails Rumble Experience</a></li>
<li><a href="../155155/index.html">Seven inches from Google</a></li>
<li><a href="../155157/index.html">Fronteers 2012 - the best client development conference, part 1</a></li>
<li><a href="../155163/index.html">One of the biggest VCS providers on Beanstalk is on its side.</a></li>
<li><a href="../155165/index.html">How to grow a program from a prototype</a></li>
<li><a href="../155167/index.html">Internet Explorer 10 for Windows 7 mid November</a></li>
<li><a href="../155171/index.html">Ubuntu is blocked in the Orenburg region</a></li>
<li><a href="../155173/index.html">Periodic sending of messages</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>