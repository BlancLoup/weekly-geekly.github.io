<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>LINQ converter between roman and arabic numbers</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="It turned out that he was sorting out LINQ with students, and with schoolchildren a transformation between the Roman and Arabic number systems. As a r...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>LINQ converter between roman and arabic numbers</h1><div class="post__text post__text-html js-mediator-article">  It turned out that he was sorting out LINQ with students, and with schoolchildren a transformation between the Roman and Arabic number systems.  As a result, the thoughts got lost and an interesting converter code turned out, which is a pity to bury in local archives.  An example will fit in as an exercise for understanding LINQ. <br><br>  So, we need a dictionary that matches the elements of Roman numbers with Arabic. <br><a name="habracut"></a><br><pre><code class="cs hljs">Dictionary&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>&gt; ra = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Dictionary&lt;<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">string</span></span>&gt; { { <span class="hljs-number"><span class="hljs-number">1000</span></span>, <span class="hljs-string"><span class="hljs-string">"M"</span></span> }, { <span class="hljs-number"><span class="hljs-number">900</span></span>, <span class="hljs-string"><span class="hljs-string">"CM"</span></span> }, { <span class="hljs-number"><span class="hljs-number">500</span></span>, <span class="hljs-string"><span class="hljs-string">"D"</span></span> }, { <span class="hljs-number"><span class="hljs-number">400</span></span>, <span class="hljs-string"><span class="hljs-string">"CD"</span></span> }, { <span class="hljs-number"><span class="hljs-number">100</span></span>, <span class="hljs-string"><span class="hljs-string">"C"</span></span> }, { <span class="hljs-number"><span class="hljs-number">90</span></span> , <span class="hljs-string"><span class="hljs-string">"XC"</span></span> }, { <span class="hljs-number"><span class="hljs-number">50</span></span> , <span class="hljs-string"><span class="hljs-string">"L"</span></span> }, { <span class="hljs-number"><span class="hljs-number">40</span></span> , <span class="hljs-string"><span class="hljs-string">"XL"</span></span> }, { <span class="hljs-number"><span class="hljs-number">10</span></span> , <span class="hljs-string"><span class="hljs-string">"X"</span></span> }, { <span class="hljs-number"><span class="hljs-number">9</span></span> , <span class="hljs-string"><span class="hljs-string">"IX"</span></span> }, { <span class="hljs-number"><span class="hljs-number">5</span></span> , <span class="hljs-string"><span class="hljs-string">"V"</span></span> }, { <span class="hljs-number"><span class="hljs-number">4</span></span> , <span class="hljs-string"><span class="hljs-string">"IV"</span></span> }, { <span class="hljs-number"><span class="hljs-number">1</span></span> , <span class="hljs-string"><span class="hljs-string">"I"</span></span> } };</code> </pre> <br>  Using this dictionary you can write converters from Roman to Arabic notation and back.  For brevity and beauty, we will not process preconditions.  For Arabic numerals, the allowable range is defined as [1.4000).  And Roman numerals must be correct and converted to upper case. <br><br><h4>  Arab to Roman Converter </h4><br>  Parsing numbers start with large numbers.  The keys in the dictionary are ordered in descending order.  Looking through them in a given order, we find the first key with a value of no more than a convertible number (Where operator).  In the dictionary, this number is associated with the letter combination of the Roman numeral system.  We glue the found letter combination with the recursively converted remainder of the number (Select operator).  The first result will be the desired representation of a number in Roman notation (operator FirstOrDefault). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ToRoman</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> number</span></span></span><span class="hljs-function">)</span></span> =&gt; ra .Where(d =&gt; number &gt;= d.Key) .Select(d =&gt; d.Value + ToRoman(number - d.Key)) .FirstOrDefault();</code> </pre><br><h4>  Converter from roman to arab </h4><br>  Analysis of the Roman number is from left to right.  We look through all the alphabetic combinations from the dictionary to the beginning of the converted string number.StartsWith (d.Value).  If there is a match, the key field will contain a numeric value corresponding to an alphabetic combination.  The resulting value is summed with the recursively processed remaining line. <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ToArabic</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> number</span></span></span><span class="hljs-function">)</span></span> =&gt; number.Length == <span class="hljs-number"><span class="hljs-number">0</span></span> ? <span class="hljs-number"><span class="hljs-number">0</span></span> : ra .Where(d =&gt; number.StartsWith(d.Value)) .Select(d =&gt; d.Key + ToArabic(number.Substring(d.Value.Length))) .FirstOrDefault();</code> </pre><br><div class="spoiler">  <b class="spoiler_title">Ready class for copy-pasting v1</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">RomanNum</span></span> { <span class="hljs-comment"><span class="hljs-comment">// (c) 2015, Alexey Danov | THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY ... static Dictionary&lt;int, string&gt; ra = new Dictionary&lt;int, string&gt; { { 1000, "M" }, { 900, "CM" }, { 500, "D" }, { 400, "CD" }, { 100, "C" }, { 90 , "XC" }, { 50 , "L" }, { 40 , "XL" }, { 10 , "X" }, { 9 , "IX" }, { 5 , "V" }, { 4 , "IV" }, { 1 , "I" } }; public static string ToRoman(int number) =&gt; ra .Where(d =&gt; number &gt;= d.Key) .Select(d =&gt; d.Value + ToRoman(number - d.Key)) .FirstOrDefault(); public static int ToArabic(string number) =&gt; number.Length == 0 ? 0 : ra .Where(d =&gt; number.StartsWith(d.Value)) .Select(d =&gt; d.Key + ToArabic(number.Substring(d.Value.Length))) .First(); }</span></span></code> </pre></div></div><br>  On this one could stop.  But it turns out that the number 499 can be written in five ways: CDXCIX, LDVLIV, XDIX, VDIV or ID.  For a short record can be used not specified in the dictionary combinations.  You can expand the dictionary, and you can build on only the original letters IVXLCDM, which correspond to the numbers (1,5,10,50,100,500,1000). <br><br>  In order to upgrade the skills of the .Net mage VC-level (VC == 95), the dictionary will be automatically generated.  And the resulting code can be used to test the skills of reading someone else's code on the entrance tests to the .Net school of IC-level magicians. <br><br><h4>  Converter from roman to arabic with strapping </h4><br>  To generate a dictionary, we had to use an external variable.  Further the code without comments. <br><br><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">int</span></span> o = <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">string</span></span> w = <span class="hljs-string"><span class="hljs-string">"IVXLCDM"</span></span>; Dictionary&lt;<span class="hljs-keyword"><span class="hljs-keyword">char</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>&gt; ra = w.ToDictionary(ch =&gt; ch, ch =&gt; (o = (<span class="hljs-string"><span class="hljs-string">""</span></span> + o)[<span class="hljs-number"><span class="hljs-number">0</span></span>] == <span class="hljs-string"><span class="hljs-string">'1'</span></span> ? o * <span class="hljs-number"><span class="hljs-number">2</span></span> : o * <span class="hljs-number"><span class="hljs-number">5</span></span>) / <span class="hljs-number"><span class="hljs-number">2</span></span>); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ToArabic</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">string</span></span></span></span><span class="hljs-function"><span class="hljs-params"> num</span></span></span><span class="hljs-function">)</span></span> =&gt; num.Select((c, i) =&gt; ++i &lt; num.Length &amp;&amp; ra[c] &lt; ra[num[i]] ? -ra[c] : ra[c]).Sum();</code> </pre><br><h4>  Arab to Roman converter with strapping </h4><br>  But for the transfer to the Roman system for brevity, it took a couple of auxiliary functions.  You can include them in the function itself, but you get a jumble. <br><br><pre> <code class="cs hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">W</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> k, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> l = </span></span><span class="hljs-number"><span class="hljs-function"><span class="hljs-params"><span class="hljs-number">1</span></span></span></span></span><span class="hljs-function">)</span></span> =&gt; w.Substring(k, l); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">R</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">char</span></span></span></span><span class="hljs-function"><span class="hljs-params"> m, </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> k</span></span></span><span class="hljs-function">)</span></span> =&gt; m == <span class="hljs-string"><span class="hljs-string">'9'</span></span> ? W(k<span class="hljs-number"><span class="hljs-number">-2</span></span>)+W(k) : m == <span class="hljs-string"><span class="hljs-string">'5'</span></span> ? W(k<span class="hljs-number"><span class="hljs-number">-1</span></span>) : m == <span class="hljs-string"><span class="hljs-string">'4'</span></span> ? W(k<span class="hljs-number"><span class="hljs-number">-2</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>) : W(k<span class="hljs-number"><span class="hljs-number">-2</span></span>); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">string</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">ToRoman</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> num</span></span></span><span class="hljs-function">)</span></span> =&gt; num &lt; <span class="hljs-number"><span class="hljs-number">1</span></span> ? <span class="hljs-string"><span class="hljs-string">""</span></span> : (<span class="hljs-keyword"><span class="hljs-keyword">from</span></span> z <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-string"><span class="hljs-string">"000100101"</span></span>.Split(<span class="hljs-string"><span class="hljs-string">'1'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">from</span></span> m <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> <span class="hljs-string"><span class="hljs-string">"9541"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">select</span></span> m + z) .Where(z =&gt; num &gt;= (o = <span class="hljs-keyword"><span class="hljs-keyword">int</span></span>.Parse(z))) .Select(z =&gt; R(z[<span class="hljs-number"><span class="hljs-number">0</span></span>], z.Length * <span class="hljs-number"><span class="hljs-number">2</span></span>)).First() + ToRoman(num - o);</code> </pre><br><br><div class="spoiler">  <b class="spoiler_title">Ready class for copy-pasting v2</b> <div class="spoiler_text"><pre> <code class="cs hljs"><span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">class</span></span> <span class="hljs-title"><span class="hljs-title">RomanNumEx</span></span> { <span class="hljs-comment"><span class="hljs-comment">// (c) 2015, Alexey Danov | THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY ... static int o = 1; static string w = "IVXLCDM"; static Dictionary&lt;char, int&gt; ra = w.ToDictionary(ch =&gt; ch, ch =&gt; (o = ("" + o)[0] == '1' ? o * 2 : o * 5) / 2); public static int ToArabic(string num) =&gt; num .Select((c, i) =&gt; ++i &lt; num.Length &amp;&amp; ra[c] &lt; ra[num[i]] ? -ra[c] : ra[c]).Sum(); static string W(int k, int l = 1) =&gt; w.Substring(k, l); static string R(char m, int k) =&gt; m == '9' ? W(k-2)+W(k) : m == '5' ? W(k-1) : m == '4' ? W(k-2, 2) : W(k-2); public static string ToRoman(int num) =&gt; num &lt; 1 ? "" : (from z in "000100101".Split('1') from m in "9541" select m + z) .Where(z =&gt; num &gt;= (o = int.Parse(z))) .Select(z =&gt; R(z[0], z.Length * 2)).First() + ToRoman(num - o); }</span></span></code> </pre></div></div><br>  These examples are far from optimal in terms of speed, but they can be used.  And above all, in learning the basics of LINQ. </div><p>Source: <a href="https://habr.com/ru/post/271035/">https://habr.com/ru/post/271035/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../271021/index.html">Why does WhatsApp collect and store confidential information about the user and their conversations?</a></li>
<li><a href="../271023/index.html">Data transfer to Russia. Short FAQ on Misconceptions</a></li>
<li><a href="../271025/index.html">Spring 4 MVC, Hibernate: many to many association</a></li>
<li><a href="../271031/index.html">VK Open Api CSRF vulnerability, which allows to get Access Tokens of third-party sites that use authorization via VK</a></li>
<li><a href="../271033/index.html">How to implement a SOAP service for working with Google tables through SQL</a></li>
<li><a href="../271037/index.html">EMC ViPR 2.1: Third Platform Data Management</a></li>
<li><a href="../271039/index.html">Overview of Cisco UCS Initial Setup</a></li>
<li><a href="../271041/index.html">We invite you to a meeting on web development on December 2</a></li>
<li><a href="../271043/index.html">Isilon.Next - how Big Data storage has become larger, cloudier and softer *</a></li>
<li><a href="../271045/index.html">Zotero: optimizing the storage and use of scientific literature</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>