<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Project RetroGSM, or how to surprise your grandmother</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="First look at the teaser: 

 (if suddenly Vimeo refuses to work, link) 
 ‚ÄúFirst was the idea,‚Äù as the forgotten file says in a text editor. Indeed, th...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Project RetroGSM, or how to surprise your grandmother</h1><div class="post__text post__text-html js-mediator-article">  First look at the teaser: <br><iframe src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://player.vimeo.com/video/53191882&amp;xid=25657,15700022,15700186,15700190,15700253,15700256,15700259&amp;usg=ALkJrhg9LmXyOuNX7Lb5lsy2UJkhxsbe7w" width="560" height="315" frameborder="0" title="promoproject3" webkitallowfullscreen="" mozallowfullscreen="" allowfullscreen=""></iframe><br>  (if suddenly Vimeo refuses to work, <a href="http://vimeo.com/53191882">link)</a> <br><a name="habracut"></a>  ‚ÄúFirst was the idea,‚Äù as the forgotten file says in a text editor.  Indeed, the idea was.  It was studied, thought over, and then - r-time - and something similar was found already implemented on one American site.  However, this did not prevent its implementation, but in some ways even simplified it. <br><br><img src="https://habrastorage.org/storage2/082/78f/cd3/08278fcd365c58850f95275b0c8efbd2.jpg"><img src="https://habrastorage.org/storage2/454/8f4/eac/4548f4eac4e4a8e545dc297823a694ef.jpg"><br>  <sup><i>The unspoken laws of the Pin-Up genre required that the "main" should be demonstrated only by hint, and not directly.</i></sup> <br>  <sup><i>Western Electric advertises its telephones.</i></sup>  <sup><i>‚ÄúPut it together and call it anywhere.‚Äù</i></sup> <br>  It all started a long time ago, when half-naked girls in stockings just started to appear in advertising, and the word <i>reliability</i> was often mentioned in telephone advertising.  These devices, with their only function, changed the culture, becoming quite romantic witnesses of the era. <br>  So, to remind her, I decided to make a phone.  It would seem that in this such?  And, most importantly, why do this, another bike?  However, we will leave these questions for later. <br><br><h4>  Making a rich inner world, or - body </h4><br>  Many people who decide to make a device face the problem of the case, and often a good deal remains to lie on the table in the form of a layout, gradually dissolving into new developments, becoming a donor of parts.  Or gathering dust in the closet, being little adapted for use.  To prevent this, a strategic decision was made ‚Äî to start with a hull selection.  And since we make the phone, then the body must be appropriate.  However, ordering casting on three-dimensional models is ideologically correct, but expensive in 2012, so we'll manage with a donor.  As a donor, we got a telephone with a dial plate made in Poland by FeTap-611.  It just so happened that he was in good condition, suitable for modification. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/storage2/394/929/ba1/394929ba1c212ad661703808327a1f3c.png"><br><br>  The details of the circuit were taken out of it, but the board was left on which the switch was soldered under the tube, as well as the native mechanical bell (Fig.4).  The photo already shows a small fee, about it a little later. <br><br><img src="https://habrastorage.org/storage2/5f1/e47/25a/5f1e4725a97193a2fb14a390fda10805.jpg"><br><br><h4>  Heart module </h4><br>  In fact, the scheme of the device is simple, but the question arose behind its heart - the module of cellular communication.  The option of using the fillings of the old Siemens phone was considered, since they are controlled by simple AT-commands, but later, by the will of fate, who left me to study in Finland for six months, I got the opportunity to order goods from Ebay and wait only two weeks while having fun from joining the mail.  What I just did not order ... But the main thing I received in the first place was the prototyping fee and the Siemens TC35i GSM module.  In fig.  5 shows a general view of the board.  It comes bundled with an antenna and a board for connecting an audio headset. <br><br><img src="https://habrastorage.org/storage2/46a/8ca/6f7/46a8ca6f71be43a4d8f2629399dfb9bd.png"><br><br>  The MAX232 chip is soldered on the board for matching levels with a COM port.  After trying on all this inside the phone, it became clear that I just would not get off with jumpers to the controller.  I had to unplug the module, evaporate the connector of the cable, since it was not found on sale during the next trip to the Motherland.  It was something with a burning textolite from an overheated soldering iron tip, but everything ended well.  The second board lost all the sockets and connectors, and was soldered directly to the twisted cord of the handset.  By the way, an electret microphone was installed in the phone, and there was no need to invent anything to get the desired signal level for the gsm module.  The speaker also earned immediately and as it should. <br><br>  To connect the connector of the cable and the controller, an attempt was first made to solder the wires directly to the contacts with a step of 0.5 mm.  However, this design was not reliable.  In the end, I decided to make an additional fee, the so-called breakout.  After etching and soldering the main connector, I still could not figure out in advance what I would need, and that I would have to transfer the SIM card connector to the cable, and this led to some chaos from MGTF.  In Figure 6 you can see how it all looked at the crucial moment of verification after assembly.  The SIM card is still on the back of the breakout card. <br><br><img src="https://habrastorage.org/storage2/351/5fd/49e/3515fd49eb2baecfdf853f50ef575eff.jpg"><br>  <sup><i>AT ... OK!</i></sup> <br><br><h4>  Call </h4><br>  Remember, I left a regular mechanical bell?  The time has come and let it go!  But how to make a 3.6 volt lithium battery with variables 25 √∑ 30 V?  Thanks to SparkFun, who did it before me, and put everything in open access.  A DC-DC converter was assembled on an MC34063 microcircuit with a typical switching circuit, and through long experiments with coils, resistors and capacitors, I got 30 VDC output.  However, further it is necessary to make an alternating current out of this!  The driver of the engine, H-bridge, L298B comes to the rescue.  It is supplied with two power supplies - for the control circuit U <sub>c</sub> , and the switched voltage U <sub>comm</sub> .  Two inputs, in the presence of permissive logical units, commute two outputs to + U <sub>comm</sub> or to ground.  At the same time, U <sub>comm</sub> can be down to ... it is necessary to look in the specification for a specific revision. <br><br><img src="https://habrastorage.org/storage2/66c/8be/61d/66c8be61d350c7b4e302756a39d365e9.jpg"><br><br>  As a frequency generator, an old good LA7 chip is used, which generates a burst of pulses with a frequency of 20-30 Hz with a duration of about 1 second with a break of about 1.5 seconds.  Who wants the top five, can calculate the duty ratio.  Frequency parameters are set by tuning resistors.  In order that all this does not eat up the battery during idle time, the entire bell unit is connected to a signal from the controller via the field effect transistor.  The whole circuit consumes about 0.4 A during a call.  The capacitor is needed to smooth out the voltage drop during a call on.  It is recommended to choose the frequency of the call to achieve the resonance frequency of the call itself, and then it will ring louder.  The prototype board was used, since there was no iron, ferric chloride, drilling machine and textolite at hand, for obvious reasons I will not show the other side, however, the layout with copper patches connected in three holes is very convenient, although it was not done without MGTF.  To think about tracing were printed sheets depicting mockup. <br><br><img src="https://habrastorage.org/storage2/39b/7ef/10c/39b7ef10c93674934dc31aecfad2af43.jpg"><br><br><h4>  Controller </h4><br>  A small "disclaimer for srach in the comments" for those who earn money for the assembler and C.  I appreciate my time, and in this case I chose the platform, God forgive me, Arduino as the controlling controller.  She allowed to quickly issue a working device, and special speed here and was not required. <br><br><img src="https://habrastorage.org/storage2/fbe/87f/dc4/fbe87fdc4e267f562f6a8626afe9b46e.jpg"><br><br>  The redundancy of the main board was solved by ordering the Arduino-mini module, which is the most compact, carried by the Atmega328 microcontroller and has nothing superfluous.  After testing the pieces of the sketch responsible for reading the controls (lifting the tube, dialing the number, communicating with the gsm module), all of this was assembled into a single sketch.  In principle, there was nothing difficult here, a program method was used to suppress contact bounce.  The internal pull-up resistors of the controller are enough for confident operation. <br><br><h4>  Nutrition </h4><br>  It is the most difficult stage, as it turned out.  The task was to make it all mobile, respectively, on the battery.  To simplify your life, a li-ion rechargeable battery without protection was ordered, as well as a holder for it (size 18650) and a protection board that disconnects the consumer when the battery voltage drops to 3 V. Despite the comments on the forum of the famous Chinese online store, were quite bearable.  Later on the self-made stand I measured the capacity of the batteries, and it turned out to be no less than 90% of the promised.  Maybe I'm just lucky. <br><br><img src="https://habrastorage.org/storage2/4c9/397/fa1/4c9397fa1b01ffdd022fc13bc58bcb8d.jpg"><br><br>  There are two difficulties: <br>  - when an incoming call, a sharply increased current cut down the protection, perhaps this is its feature, but rather a bug, and as a result, the module lost contact with the network. <br>  - the controller ate together with the module an inadmissible 60 √∑ 100 mA.  According to calculations, in this situation the battery will not last long. <br>  The first problem was solved by including a call scheme to bypass the protection.  This is not very good, but I am very tired of messing around with the choice of battery overload protection controllers.  In theory, if the controller is de-energized, then it will not start the call, that is, it will not open the field effect transistor.  It did not work out to simulate this situation, but soon, probably, in a week, I still wait for the battery to discharge ... <br>  The second problem was solved by carefully reading the documentation for the gsm-module.  Using the AT + CFUN = 0 command, the module is put into a sleep state.  Consumption is reduced from 10 mA to 3 mA (typical values).  However, he is in touch with the base station, and can wake up from an incoming call, or a built-in alarm clock.  To wake up the modem, you need to put the RTS line on the ground. <br>  The power consumption of the controller was decided by a thoughtful reading of the datasheet and an example found on the network.  The controller is put into a sleep state if within 10 seconds no manipulations are made with it and the handset is placed on the device.  He wakes up on a falling front on pins having an interrupt vector, one ‚Äúwatches‚Äù the tube lifting, the second one follows the RING line of the gsm module. <br>  As a result, the total consumption decreased to 0.5 √∑ 1 mA in idle mode, according to my avometer.  Talk time rarely rises to 100 mA, I think it is because of good network coverage. <br>  The battery is charged from the purchased module of the charger on the controller TP4056, its scheme is simple, several resistors, at the input 5 √∑ 7 V, two operation indication LEDs.  To connect the power supply in the technological opening of the telephone apparatus, a male connector is arranged, which is conveniently closed with a lid. <br><br><img src="https://habrastorage.org/storage2/993/4a4/e62/9934a4e62ae9fe5518234f7b0059e435.jpg"><br><br><h4>  Cloudberries for dessert </h4><br>  What do we still lack?  Of course, alarms that the module has successfully connected to the network and is ready to call.  To do this, we connect one of the pins going to the speaker with the controller through a resistor and send a ‚Äúbeep‚Äù to the standard for the ATC frequency corresponding to the ‚ÄúATC answer‚Äù signal at the moment of lifting the handset after passing the module registration check in the GSM network. <br>  Also added some special features to reinitialize the modem or disconnect it from the network, if necessary.  All this is done by dialing a three-digit service number.  In response, the controller beeps into a special tube.  sequence.  If the number was dialed more than 7, then the first "8" is replaced by "+" to correctly dial the number. <br><br><h4>  Assembly </h4><br>  It is time to collect everything in the case.  The battery holder, the bell board, the module were fixed on a strong double-sided tape on foamed polyethylene.  Keeps well, but washing off his glue is not the most pleasant thing. <br>  It was possible to assemble everything without an auxiliary board with dialer connectors, etc., but the wires turned out decently.  Part of their number has increased due to the need to output the serial port of the controller and the module to the technological niche at the bottom of the device for diagnosing the device and updating the firmware, which also houses the SIM card connector.  Bluetooth?  No, thanks, that's enough for us. <br><br><img src="https://habrastorage.org/storage2/096/668/aeb/096668aeb99de0708b4bb23756427b1c.jpg"><br><br>  Indecently rolled up with red, not blue tape - protection and battery charging boards.  No, they are not heated enough to take this into account. <br><br><img src="https://habrastorage.org/storage2/4cf/1dd/ed0/4cf1dded0ac276b8b0db4549d7b19458.jpg"><br><br><img src="https://habrastorage.org/storage2/569/004/378/56900437821a1aadd519dbbd10fb7eb0.jpg"><br><br>  Solemn assembly and screwing up the last screw, and ... here, the main tool for entertainment and "trolling" passers-by and cafeteria visitors.  Only the antenna gives it out, but what kind of people make their eyes when they hear a dial tone! <br><br><img src="https://habrastorage.org/storage2/105/6cd/5b3/1056cd5b3c82a15d94625306d0276ab1.jpg"><br><br><h4>  Project Characteristics </h4><div class="spoiler">  <b class="spoiler_title">expand</b> <div class="spoiler_text">  The cost of parts was about 3000 rubles. <br>  It was unknown how long it took, but you can make it a month on weekends, if you do not meet a special rake and buy everything in advance. <br>  Block diagram of the device stuffing: <br><br><img src="https://habrastorage.org/storage2/912/ae5/8f2/912ae58f24374d2e63c55d7b65346adf.jpg"><br><br></div></div><br><h4>  Plans </h4><br>  Finalize the service numbers of the device.  Add the ability to manage the phone book, although the ability to call the numbers from the book on the SIM-card is already there.  As well as the ability to dial the last number dialed.  If suddenly someone ever wants to do something similar - make a printed circuit board.  I beg you. <br><br><h4>  Afterword </h4><br>  I want to say thanks: <br>  to all those who did not send me ahead of time to the mental hospital; <br>  Comrade Pasha, who made the first call from the next room of our apartment on Teknologiapuistonkatu;  partners in the shooting of the video, ‚ÄúBrynze‚Äù for the once delicious pasties. <br>  And, finally, the photo awards for those who read to the end. <br><img src="https://habrastorage.org/storage2/82e/407/a22/82e407a2229732c52782008e6bbcb152.jpg"><br></div><p>Source: <a href="https://habr.com/ru/post/158109/">https://habr.com/ru/post/158109/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../158095/index.html">Ten rules calm development</a></li>
<li><a href="../158097/index.html">USPS lifts a ban on shipping lithium batteries</a></li>
<li><a href="../158099/index.html">W.Script languages. Part 2 - high-level languages, or why are we in the C ++ corporation</a></li>
<li><a href="../158101/index.html">Retina website optimization tools</a></li>
<li><a href="../158107/index.html">Problems in the library of Django forms on the example of the phone entry field</a></li>
<li><a href="../158113/index.html">Pro user interface and one mouse button</a></li>
<li><a href="../158115/index.html">What's wrong with Google+</a></li>
<li><a href="../158117/index.html">Canonical decided to create a game development team.</a></li>
<li><a href="../158119/index.html">We work with SteamWorks. Part 2</a></li>
<li><a href="../158123/index.html">Lumix LX7 vs Nokia 808 PureView vs iPhone 4s</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>