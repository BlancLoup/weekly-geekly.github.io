<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>All about collections in Oracle</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The article has a pretty thesis style. More detailed content can be found in the video attached at the bottom of the article recording a lecture on Or...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>All about collections in Oracle</h1><div class="post__text post__text-html js-mediator-article">  <em>The article has a pretty thesis style.</em>  <em>More detailed content can be found in the video attached at the bottom of the article recording a lecture on Oracle collections.</em> <br><br>  Collections are present in one form or another in most programming languages ‚Äã‚Äãand everywhere have a similar essence in terms of use.  Namely, they allow you to store a set of objects of the same type and to carry out any actions over the entire set, or to carry out similar actions with all elements of the set in a loop. <br><br>  In the same way, collections are used in Oracle. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  <b>The content of the article</b> </h4><br><ul><li>  <a href="https://habr.com/ru/post/254355/">Pl / sql Collections Overview</a> </li><li>  <a href="https://habr.com/ru/post/254355/">Types of collections</a> </li><li>  <a href="https://habr.com/ru/post/254355/">Associative array</a> </li><li>  <a href="https://habr.com/ru/post/254355/">Varray</a> </li><li>  <a href="https://habr.com/ru/post/254355/">Nested table</a> </li><li>  <a href="https://habr.com/ru/post/254355/">Set operations with nested tables</a> </li><li>  <a href="https://habr.com/ru/post/254355/">Logical operations with collections</a> </li><li>  <a href="https://habr.com/ru/post/254355/">Collection methods</a> <ul><li>  <a href="https://habr.com/ru/post/254355/">Delete</a> </li><li>  <a href="https://habr.com/ru/post/254355/">Trim</a> </li><li>  <a href="https://habr.com/ru/post/254355/">Extend</a> </li><li>  <a href="https://habr.com/ru/post/254355/">Exists</a> </li><li>  <a href="https://habr.com/ru/post/254355/">First and Last</a> </li><li>  <a href="https://habr.com/ru/post/254355/">Count</a> </li><li>  <a href="https://habr.com/ru/post/254355/">Limit</a> </li><li>  <a href="https://habr.com/ru/post/254355/">Prior and Next</a> </li></ul></li><li>  <a href="https://habr.com/ru/post/254355/">Bulk collect</a> </li><li>  <a href="https://habr.com/ru/post/254355/">Forall cycle</a> <br><ul><li>  <a href="https://habr.com/ru/post/254355/">Exceptions in forall</a> </li></ul></li><li>  <a href="https://habr.com/ru/post/254355/">Collection exceptions</a> </li><li>  <a href="https://habr.com/ru/post/254355/">DBMS_SESSION.FREE_UNUSED_USER_MEMORY</a> </li></ul><br><a name="habracut"></a><br><a name="One"></a><h5>  <b>Pl / sql Collections Overview</b> </h5><br><ul><li>  Creating a collection takes place in two stages. <ol><li>  First we declare the type (type) of the collection (the constructions assoc_array_type_def, varray_type_def and nested_table_type_def will be given later) <br><br><img src="https://habrastorage.org/files/f6b/0a0/bf9/f6b0a0bf9b84467d805019fa949a7b75.png"></li><li>  Then we declare a variable of this type. </li></ol></li><li>  The call to the collection item has the following syntax: <pre><code class="sql hljs">variable_name(index)</code> </pre> </li><li>  Variables of the collection type can be NULL (and the elements of the collections themselves, too). </li><li>  Multidimensional collections are possible (collections of collections) </li></ul><br><br><a name="Two"></a><h5>  <b>Types of collections</b> </h5><br><table><tbody><tr><th>  Collection type </th><th>  Amount of elements </th><th>  Index type </th><th>  Dense or sparse </th><th>  Without initialization </th><th>  Where is announced </th><th>  Use in SQL </th></tr><tr><td>  Associative array <br>  (index by table) </td><td>  Not set </td><td>  String <br>  Pls_integer </td><td>  Dense and sparse </td><td>  Empty </td><td>  PL / SQL block <br>  Package </td><td>  Not </td></tr><tr><td>  Varray <br>  (variable-size array) </td><td>  Set </td><td>  Integer </td><td>  Only dense </td><td>  Null </td><td>  PL / SQL block <br>  Package <br>  Schema level </td><td>  Only defined at the schema level </td></tr><tr><td>  Nested table </td><td>  Not set </td><td>  Integer </td><td>  When you create a dense, may become rarefied </td><td>  Null </td><td>  PL / SQL block <br>  Package <br>  Schema level </td><td>  Only defined at the schema level </td></tr></tbody></table><br>  The density of the collection means that there are no gaps, empty spaces between the elements of the collection.  Some collections, as can be seen from the table, can be sparse ‚Äî that is,  may have gaps between elements.  This means that in the collection, for example, there may be elements with index 1 and 4, and with index 2 and 3 there are no elements.  In this case, the memory slots for the 2nd and 3rd elements will exist and will belong to the collection (in the case of nested table), but not contain objects and an attempt to read the contents of these elements will cause an error no_data_found. <br>  Details can be found in the video lecture at the end of the article. <br><br><a name="Three"></a><h5>  <b>Associative array</b> </h5><br><br>  Also called index by table or pl / sql table. <br>  The type is described as follows (assoc_array_type_def) :. <br><img src="https://habrastorage.org/files/d27/7fb/53d/d277fb53d52048a4b6bd46beba651cd8.png"><br><ul><li>  Key-value pair set </li><li>  Data is stored in sorted by key order. </li><li>  Does not support DML operations (cannot participate in selects, cannot be stored in tables) </li><li>  When declared as a constant, it must be immediately initialized by the function. </li><li>  The order of the elements in an associative array with a string index depends on the NLS_SORT and NLS_COMP parameters. </li><li>  You cannot declare a type at the schema level, but you can in the package </li><li>  Does not have a constructor </li><li>  The index can not be null (but allows an empty string - details and a link to the example in the first comment) </li><li>  Datatype is any data type except ref cursor </li></ul><br><br>  <b>Used for:</b> <br><ul><li>  For keeping small reference tables in memory </li><li>  To pass as a collection parameter </li></ul><br><br>  <b>Restrictions:</b> <br>  When changing the NLS_SORT and NLS_COMP parameters during a session after filling in the associative array, we can get unexpected results of calls to the methods first, last, next, previous.  There may also be problems when passing an associative array as a parameter to another database with different settings NLS_SORT and NLS_COMP <br><br><a name="Four"></a><h5>  <b>Varray</b> </h5><br>  It is an array of sequentially stored items. <br><img src="https://habrastorage.org/files/8a9/56b/78e/8a956b78e35149239301d312e6b60feb.png"><br><br>  The type is described as follows (varay_type_def): <br><img src="https://habrastorage.org/files/7d6/27f/381/7d627f3814914ea7a8432ddfe73773b6.png"><br><br><ul><li>  The size is set when creating </li><li>  Indexed from 1 </li><li>  Initialized by the constructor. <br><pre> <code class="sql hljs">collection_type ( [ value [, value ]... ] )</code> </pre> </li><li>  If no parameters are passed to the constructor, an empty collection is returned. </li><li>  Datatype is any data type except ref cursor </li></ul><br><br>  <b>Used if:</b> <br><ul><li>  We know the maximum possible number of elements. </li><li>  Access to elements sequential </li></ul><br><br>  <b>Restrictions:</b> <br>  The maximum size is 2,147,483,647 items <br><br><a name="Five"></a><h5>  <b>Nested table</b> </h5><br>  The type is described as follows (nested_table_type_def): <br><img src="https://habrastorage.org/files/8d4/4a3/922/8d44a39225f440faa46444b6b9a3db78.png"><br><br><ul><li>  Collection size changes dynamically </li><li>  It may be in a discharged state, as shown in the picture. <br>  &lt; <img src="//habrastorage.org/files/8f1/3a8/e2d/8f13a8e2d08a493b99a38693da9ef25e.png"></li><li>  Initialized by the constructor. <br><pre> <code class="sql hljs">collection_type ( [ value [, value ]... ] )</code> </pre> </li><li>  If no parameters are passed to the constructor, an empty collection is returned. </li><li>  Datatype is any data type except ref cursor </li><li>  If it contains only one scalar value, then the column name is Column_Value <br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">column_value</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span>(nested_table)</code> </pre> <br>  In the comments to this article they suggest a more preferable option - it is more universal, it allows not only a scalar value in the table: <br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">value</span></span>(t) x <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span>(nested_table) t</code> </pre> </li><li>  If no parameters are passed to the constructor, an empty collection is returned. </li></ul><br><br><a name="Six"></a><h5>  <b>Set operations with nested tables</b> </h5><br>  Operations are possible only with <b>nested table</b> collections.  Both collections involved in the operation must be of the same type. <br>  The result of the operation is also a collection of <b>nested table</b> . <br><br><table><tbody><tr><th>  Operation </th><th>  Description </th></tr><tr><td>  MULTISET UNION </td><td>  Returns the union of two collections </td></tr><tr><td>  MULTISET UNION DISTINCT </td><td>  Returns the union of two collections with distinction (removes doubles) </td></tr><tr><td>  MULTISET INTERSECT </td><td>  Returns the intersection of two collections. </td></tr><tr><td>  MULTISET INTERSECT DISTINCT </td><td>  Returns the intersection of two collections with distinction (removes doubles) </td></tr><tr><td>  SET </td><td>  Returns a collection with distinction (i.e., a collection without duplicates) </td></tr><tr><td>  MULTISET EXCEPT </td><td>  Returns the difference of two collections. </td></tr><tr><td>  MULTISET EXCEPT DISTINCT </td><td>  Returns the difference of two collections with distinction (removes doubles) </td></tr></tbody></table><br><div class="spoiler">  <b class="spoiler_title">Small example</b> <div class="spoiler_text">  A small example (note the result of the <b>MULTISET EXCEPT DISTINCT</b> operation) <br><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TYPE</span></span> nested_typ <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OF</span></span> <span class="hljs-built_in"><span class="hljs-built_in">NUMBER</span></span>; nt1 nested_typ := nested_typ(1,2,3); nt2 nested_typ := nested_typ(3,2,1); nt3 nested_typ := nested_typ(2,3,1,3); nt4 nested_typ := nested_typ(1,2,4); answer nested_typ; <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> answer := nt1 <span class="hljs-keyword"><span class="hljs-keyword">MULTISET</span></span> <span class="hljs-keyword"><span class="hljs-keyword">UNION</span></span> nt4; answer := nt1 MULTISET UNION nt3; answer := nt1 MULTISET UNION DISTINCT nt3; answer := nt2 MULTISET INTERSECT nt3; answer := nt2 MULTISET INTERSECT DISTINCT nt3; answer := <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span>(nt3); answer := nt3 MULTISET EXCEPT nt2; answer := nt3 MULTISET EXCEPT DISTINCT nt2; <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>;</code> </pre><br><br>  <b>Result:</b> <br><pre> <code class="sql hljs">nt1 MULTISET UNION nt4: 1 2 3 1 2 4 nt1 MULTISET UNION nt3: 1 2 3 2 3 1 3 nt1 MULTISET UNION DISTINCT nt3: 1 2 3 nt2 MULTISET INTERSECT nt3: 3 2 1 nt2 MULTISET INTERSECT DISTINCT nt3: 3 2 1 <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span>(nt3): <span class="hljs-number"><span class="hljs-number">2</span></span> <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-number"><span class="hljs-number">1</span></span> nt3 <span class="hljs-keyword"><span class="hljs-keyword">MULTISET</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EXCEPT</span></span> nt2: <span class="hljs-number"><span class="hljs-number">3</span></span> nt3 <span class="hljs-keyword"><span class="hljs-keyword">MULTISET</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EXCEPT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">DISTINCT</span></span> nt2: <span class="hljs-keyword"><span class="hljs-keyword">empty</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span></code> </pre><br></div></div><br><br><a name="Seven"></a><h5>  <b>Logical operations with collections</b> </h5><br><table><tbody><tr><th>  Operation </th><th>  Description </th></tr><tr><td>  IS NULL (IS NOT NULL) </td><td>  Compares the collection with a NULL value. </td></tr><tr><td>  Comparison = </td><td>  Two nested table collections can be compared if they are of the same type and do not contain records of the record type.  They are equal if they have the same sets of elements (regardless of the order in which the elements inside the collection are stored) </td></tr><tr><td>  IN </td><td>  Compares the collection with those listed in brackets. </td></tr><tr><td>  SUBMULTISET OF </td><td>  Checks if a collection is a subset of another collection. </td></tr><tr><td>  MEMBER OF </td><td>  Checks if a particular item (object) is part of a collection. </td></tr><tr><td>  IS A SET </td><td>  Checks if the collection contains duplicates </td></tr><tr><td>  IS EMPTY </td><td>  Checks if the collection is empty </td></tr></tbody></table><br><br><div class="spoiler">  <b class="spoiler_title">A small example of the use of logical operations with collections</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TYPE</span></span> nested_typ <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OF</span></span> <span class="hljs-built_in"><span class="hljs-built_in">NUMBER</span></span>; nt1 nested_typ := nested_typ(1, 2, 3); nt2 nested_typ := nested_typ(3, 2, 1); nt3 nested_typ := nested_typ(2, 3, 1, 3); nt4 nested_typ := nested_typ(); <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span> nt1 = nt2 <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> DBMS_OUTPUT.PUT_LINE(<span class="hljs-string"><span class="hljs-string">'nt1 = nt2'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span>; IF (nt1 IN (nt2, nt3, nt4)) THEN DBMS_OUTPUT.PUT_LINE('nt1 IN (nt2,nt3,nt4)'); <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span>; IF (nt1 SUBMULTISET OF nt3) THEN DBMS_OUTPUT.PUT_LINE('nt1 SUBMULTISET OF nt3'); <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span>; IF (3 MEMBER OF nt3) THEN DBMS_OUTPUT.PUT_LINE('3 MEMBER OF nt3'); <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span>; IF (nt3 IS NOT A <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">THEN</span></span> DBMS_OUTPUT.PUT_LINE(<span class="hljs-string"><span class="hljs-string">'nt3 IS NOT A SET'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span>; IF (nt4 IS EMPTY) THEN DBMS_OUTPUT.PUT_LINE('nt4 IS EMPTY'); <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> <span class="hljs-keyword"><span class="hljs-keyword">IF</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>;</code> </pre><br><br>  <b>Result:</b> <br><pre> <code class="sql hljs">nt1 = nt2 nt1 IN (nt2,nt3,nt4) nt1 SUBMULTISET OF nt3 3 MEMBER OF nt3 nt3 IS NOT A <span class="hljs-keyword"><span class="hljs-keyword">SET</span></span> nt4 <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">EMPTY</span></span></code> </pre><br></div></div><br><br><a name="Eight"></a><h5>  <b>Collection methods</b> </h5><br>  Method call syntax: <pre> <code class="sql hljs">collection_name.method</code> </pre> <br><table><tbody><tr><th>  Method </th><th>  Type of </th><th>  Description </th><th>  Index by table </th><th>  Varray </th><th>  Nested table </th></tr><tr><td>  DELETE </td><td>  Procedure </td><td>  Removes items from the collection. </td><td>  Yes </td><td>  Only version without parameters </td><td>  Yes </td></tr><tr><td>  TRIM </td><td>  Procedure </td><td>  Removes items from the end of the collection (works with the internal size of the collection) </td><td>  Not </td><td>  Yes </td><td>  Yes </td></tr><tr><td>  EXTEND </td><td>  Procedure </td><td>  Adds items to the end of the collection. </td><td>  Not </td><td>  Yes </td><td>  Yes </td></tr><tr><td>  EXISTS </td><td>  Function </td><td>  Returns TRUE if the item is in the collection. </td><td>  Yes </td><td>  Yes </td><td>  Yes </td></tr><tr><td>  FIRST </td><td>  Function </td><td>  Returns the first index in the collection. </td><td>  Yes </td><td>  Yes </td><td>  Yes </td></tr><tr><td>  LAST </td><td>  Function </td><td>  Returns the last index in the collection. </td><td>  Yes </td><td>  Yes </td><td>  Yes </td></tr><tr><td>  COUNT </td><td>  Function </td><td>  Returns the number of items in the collection. </td><td>  Yes </td><td>  Yes </td><td>  Yes </td></tr><tr><td>  LIMIT </td><td>  Function </td><td>  Returns the maximum number of items the collection can store. </td><td>  Not </td><td>  Yes </td><td>  Not </td></tr><tr><td>  PRIOR </td><td>  Function </td><td>  Returns the index of the previous item in the collection. </td><td>  Yes </td><td>  Yes </td><td>  Yes </td></tr><tr><td>  NEXT </td><td>  Function </td><td>  Returns the index of the next item in the collection. </td><td>  Yes </td><td>  Yes </td><td>  Yes </td></tr></tbody></table><br><br><a name="Nine"></a><h6>  <b>Delete</b> </h6><h6><ul><li>  Delete deletes all items.  Immediately clears the memory allocated to store these items. </li><li>  Delete (n) deletes the element with index n.  Memory does not free.  The element can be restored (ie, set a new one) and it will occupy the same memory as the previous one. </li><li>  Delete (n, m) deletes items with indices in the interval n..m </li><li>  If there is no item to delete in the collection, it does nothing. </li><li>  For varray collections, only the version of the method is available without parameters. </li></ul><br><br><div class="spoiler">  <b class="spoiler_title">Usage example</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TYPE</span></span> nt_type <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OF</span></span> <span class="hljs-built_in"><span class="hljs-built_in">NUMBER</span></span>; nt nt_type := nt_type(11, 22, 33, 44, 55, 66); <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> nt.DELETE(<span class="hljs-number"><span class="hljs-number">2</span></span>); <span class="hljs-comment"><span class="hljs-comment">--    nt(2) := 2222; --  2-  nt.DELETE(2, 4); --    2-  4- nt(3) := 3333; --  3-  nt.DELETE; --    END;</span></span></code> </pre><br>  <b>Results:</b> <br><pre> <code class="sql hljs">beginning: 11 22 33 44 55 66 after <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span>(<span class="hljs-number"><span class="hljs-number">2</span></span>): <span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-number"><span class="hljs-number">33</span></span> <span class="hljs-number"><span class="hljs-number">44</span></span> <span class="hljs-number"><span class="hljs-number">55</span></span> <span class="hljs-number"><span class="hljs-number">66</span></span> <span class="hljs-keyword"><span class="hljs-keyword">after</span></span> nt(<span class="hljs-number"><span class="hljs-number">2</span></span>) := <span class="hljs-number"><span class="hljs-number">2222</span></span>: <span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-number"><span class="hljs-number">2222</span></span> <span class="hljs-number"><span class="hljs-number">33</span></span> <span class="hljs-number"><span class="hljs-number">44</span></span> <span class="hljs-number"><span class="hljs-number">55</span></span> <span class="hljs-number"><span class="hljs-number">66</span></span> <span class="hljs-keyword"><span class="hljs-keyword">after</span></span> <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span>(<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">4</span></span>): <span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-number"><span class="hljs-number">55</span></span> <span class="hljs-number"><span class="hljs-number">66</span></span> <span class="hljs-keyword"><span class="hljs-keyword">after</span></span> nt(<span class="hljs-number"><span class="hljs-number">3</span></span>) := <span class="hljs-number"><span class="hljs-number">3333</span></span>: <span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-number"><span class="hljs-number">3333</span></span> <span class="hljs-number"><span class="hljs-number">55</span></span> <span class="hljs-number"><span class="hljs-number">66</span></span> <span class="hljs-keyword"><span class="hljs-keyword">after</span></span> <span class="hljs-keyword"><span class="hljs-keyword">delete</span></span>: <span class="hljs-keyword"><span class="hljs-keyword">empty</span></span> <span class="hljs-keyword"><span class="hljs-keyword">set</span></span></code> </pre><br></div></div><br><br><a name="Ten"></a></h6><h6>  <b>Trim</b> </h6><br><ul><li>  Trim () - removes one item at the end of the collection.  If the item does not exist, throws an exception SUBSCRIPT_BEYOND_COUNT </li><li>  Trim (n) - removes n elements at the end of the collection.  If the items are less than n, an exception is thrown SUBSCRIPT_BEYOND_COUNT </li><li>  Works with the internal size of the collection.  Those.  if the last element was deleted using Delete, the Trim () call will delete the element that was previously deleted. </li><li>  Immediately clears the memory allocated for storing these items. </li><li>  It is better not to use in combination with Delete () </li></ul><br><br><div class="spoiler">  <b class="spoiler_title">Usage example</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TYPE</span></span> nt_type <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OF</span></span> <span class="hljs-built_in"><span class="hljs-built_in">NUMBER</span></span>; nt nt_type := nt_type(11, 22, 33, 44, 55, 66); <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> nt.TRIM; <span class="hljs-comment"><span class="hljs-comment">-- Trim last element nt.DELETE(4); -- Delete fourth element nt.TRIM(2); -- Trim last two elements END;</span></span></code> </pre><br>  <b>Result:</b> <br><pre> <code class="sql hljs">beginning: 11 22 33 44 55 66 after TRIM: 11 22 33 44 55 after <span class="hljs-keyword"><span class="hljs-keyword">DELETE</span></span>(<span class="hljs-number"><span class="hljs-number">4</span></span>): <span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-number"><span class="hljs-number">22</span></span> <span class="hljs-number"><span class="hljs-number">33</span></span> <span class="hljs-number"><span class="hljs-number">55</span></span> <span class="hljs-keyword"><span class="hljs-keyword">after</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TRIM</span></span>(<span class="hljs-number"><span class="hljs-number">2</span></span>): <span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-number"><span class="hljs-number">22</span></span> <span class="hljs-number"><span class="hljs-number">33</span></span></code> </pre><br></div></div><br><br><a name="Eleven"></a><h6>  <b>Extend</b> </h6><br><ul><li>  EXTEND adds a single item with a null value to the end of the collection. </li><li>  EXTEND (n) adds n items with a null value to the end of the collection. </li><li>  EXTEND (n, i) adds n copies of the item with index i to the end of the collection.  If the collection has a NOT NULL constraint, only this form can be used. </li><li>  If the elements were previously deleted using the Delete method, Extend will not use the memory cells stored in the collection, but will add a new element (will allocate a new memory) </li></ul><br><br><div class="spoiler">  <b class="spoiler_title">Usage example</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TYPE</span></span> nt_type <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OF</span></span> <span class="hljs-built_in"><span class="hljs-built_in">NUMBER</span></span>; nt nt_type := nt_type(11, 22, 33); <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> nt.EXTEND(<span class="hljs-number"><span class="hljs-number">2</span></span>, <span class="hljs-number"><span class="hljs-number">1</span></span>); <span class="hljs-comment"><span class="hljs-comment">-- Append two copies of first element nt.DELETE(5); -- Delete fifth element nt.EXTEND; -- Append one null element END;</span></span></code> </pre><br>  <b>Result:</b> <br><pre> <code class="sql hljs">beginning: 11 22 33 after EXTEND(2,1): 11 22 33 11 11 after <span class="hljs-keyword"><span class="hljs-keyword">DELETE</span></span>(<span class="hljs-number"><span class="hljs-number">5</span></span>): <span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-number"><span class="hljs-number">22</span></span> <span class="hljs-number"><span class="hljs-number">33</span></span> <span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-keyword"><span class="hljs-keyword">after</span></span> EXTEND: <span class="hljs-number"><span class="hljs-number">11</span></span> <span class="hljs-number"><span class="hljs-number">22</span></span> <span class="hljs-number"><span class="hljs-number">33</span></span> <span class="hljs-number"><span class="hljs-number">11</span></span></code> </pre><br></div></div><br><br><a name="Twelve"></a><h6>  <b>Exists</b> </h6><br><ul><li>  For deleted items, returns false. </li><li>  Returns false when going beyond the boundaries </li></ul><br><div class="spoiler">  <b class="spoiler_title">Usage example</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TYPE</span></span> NumList <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OF</span></span> <span class="hljs-built_in"><span class="hljs-built_in">INTEGER</span></span>; n NumList := NumList(1, 3, 5, 7); <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> n.DELETE(<span class="hljs-number"><span class="hljs-number">2</span></span>); <span class="hljs-comment"><span class="hljs-comment">-- Delete second element FOR i IN 1 .. 6 LOOP IF n.EXISTS(i) THEN DBMS_OUTPUT.PUT_LINE('n('||i||') = ' || n(i)); ELSE DBMS_OUTPUT.PUT_LINE('n('||i||') does not exist'); END IF; END LOOP; END;</span></span></code> </pre><br></div></div><br><br><a name="Thirteen"></a><h6>  <b>First and Last</b> </h6><br><ul><li>  For varray, First always returns one, Last always returns the same value as Count. </li></ul><br><div class="spoiler">  <b class="spoiler_title">Usage example</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TYPE</span></span> aa_type_str <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OF</span></span> <span class="hljs-built_in"><span class="hljs-built_in">INTEGER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INDEX</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> VARCHAR2(<span class="hljs-number"><span class="hljs-number">10</span></span>); aa_str aa_type_str; <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> aa_str(<span class="hljs-string"><span class="hljs-string">'Z'</span></span>) := <span class="hljs-number"><span class="hljs-number">26</span></span>; aa_str('A') := 1; aa_str('K') := 11; aa_str('R') := 18; DBMS_OUTPUT.PUT_LINE('Before deletions:'); DBMS_OUTPUT.PUT_LINE('FIRST = ' || aa_str.FIRST); DBMS_OUTPUT.PUT_LINE('LAST = ' || aa_str.LAST); aa_str.DELETE('A'); aa_str.DELETE('Z'); DBMS_OUTPUT.PUT_LINE('After deletions:'); DBMS_OUTPUT.PUT_LINE('FIRST = ' || aa_str.FIRST); DBMS_OUTPUT.PUT_LINE('LAST = ' || aa_str.LAST); <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>;</code> </pre><br>  <b>Result:</b> <br><pre> <code class="sql hljs">Before deletions: FIRST = A LAST = Z After deletions: FIRST = K LAST = R</code> </pre><br></div></div><br><br><a name="Fourteen"></a><h6>  <b>Count</b> </h6><br><div class="spoiler">  <b class="spoiler_title">Usage example</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TYPE</span></span> NumList <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">VARRAY</span></span>(<span class="hljs-number"><span class="hljs-number">10</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">OF</span></span> <span class="hljs-built_in"><span class="hljs-built_in">INTEGER</span></span>; n NumList := NumList(1, 3, 5, 7); <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> DBMS_OUTPUT.PUT(<span class="hljs-string"><span class="hljs-string">'n.COUNT = '</span></span> || n.COUNT || <span class="hljs-string"><span class="hljs-string">', '</span></span>); DBMS_OUTPUT.PUT_LINE('n.LAST = ' || n.LAST); n.EXTEND(3); DBMS_OUTPUT.PUT('n.COUNT = ' || n.COUNT || ', '); DBMS_OUTPUT.PUT_LINE('n.LAST = ' || n.LAST); n.TRIM(5); DBMS_OUTPUT.PUT('n.COUNT = ' || n.COUNT || ', '); DBMS_OUTPUT.PUT_LINE('n.LAST = ' || n.LAST); <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>;</code> </pre><br>  <b>Result</b> <br><pre> <code class="sql hljs">n.COUNT = 4, n.LAST = 4 n.COUNT = 7, n.LAST = 7 n.COUNT = 2, n.LAST = 2</code> </pre><br></div></div><br><br><a name="Fifteen"></a><h6>  <b>Limit</b> </h6><br><ul><li>  For varray, returns the maximum allowed number of items in the collection, for other collections, returns null </li></ul><br><div class="spoiler">  <b class="spoiler_title">Usage example</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TYPE</span></span> aa_type <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OF</span></span> <span class="hljs-built_in"><span class="hljs-built_in">INTEGER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INDEX</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> PLS_INTEGER; aa aa_type; <span class="hljs-comment"><span class="hljs-comment">-- associative array TYPE va_type IS VARRAY(4) OF INTEGER; va va_type := va_type(2, 4); -- varray TYPE nt_type IS TABLE OF INTEGER; nt nt_type := nt_type(1, 3, 5); -- nested table BEGIN aa(1) := 3; aa(2) := 6; aa(3) := 9; aa(4) := 12; DBMS_OUTPUT.PUT_LINE('aa.COUNT = ' || aa.count); DBMS_OUTPUT.PUT_LINE('aa.LIMIT = ' || aa.limit); DBMS_OUTPUT.PUT_LINE('va.COUNT = ' || va.count); DBMS_OUTPUT.PUT_LINE('va.LIMIT = ' || va.limit); DBMS_OUTPUT.PUT_LINE('nt.COUNT = ' || nt.count); DBMS_OUTPUT.PUT_LINE('nt.LIMIT = ' || nt.limit); END;</span></span></code> </pre><br>  <b>Result:</b> <br><pre> <code class="sql hljs">aa.COUNT = 4 aa.LIMIT = va.COUNT = 2 va.LIMIT = 4 nt.COUNT = 3 nt.LIMIT =</code> </pre><br></div></div><br><br><a name="Sixteen"></a><h6>  <b>Prior and Next</b> </h6><br><ul><li>  Allow you to navigate the collection </li><li>  Return the index of the previous / next element (or null if there is no element) </li></ul><br><div class="spoiler">  <b class="spoiler_title">Usage example</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TYPE</span></span> nt_type <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OF</span></span> <span class="hljs-built_in"><span class="hljs-built_in">NUMBER</span></span>; nt nt_type := nt_type(18, NULL, 36, 45, 54, 63); <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> nt.DELETE(<span class="hljs-number"><span class="hljs-number">4</span></span>); DBMS_OUTPUT.PUT_LINE('nt(4) was deleted.'); FOR i IN 1 .. 7 LOOP DBMS_OUTPUT.PUT('nt.PRIOR(' || i || ') = '); print(nt.PRIOR(i)); DBMS_OUTPUT.PUT('nt.NEXT(' || i || ') = '); print(nt.NEXT(i)); <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LOOP</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>;</code> </pre><br>  <b>Result:</b> <br><pre> <code class="sql hljs">nt(4) was deleted. nt.PRIOR(1) = nt.NEXT(1) = 2 nt.PRIOR(2) = 1 nt.NEXT(2) = 3 nt.PRIOR(3) = 2 nt.NEXT(3) = 5 nt.PRIOR(4) = 3 nt.NEXT(4) = 5 nt.PRIOR(5) = 3 nt.NEXT(5) = 6 nt.PRIOR(6) = 5 nt.NEXT(6) = nt.PRIOR(7) = 6 nt.NEXT(7) =</code> </pre><br></div></div><br><br><a name="Seventeen"></a><h5>  <b>Bulk collect</b> </h5><br><ul><li>  Returns the results of an sql operator in PL / SQL in batches, not one by one </li><li>  SELECT BULK COLLECT INTO </li><li>  FETCH BULK COLLECT INTO [LIMIT] </li><li>  RETURNING BULK COLLECT INTO </li><li>  Does not work with associative arrays (except those indexed by pls_integer) </li></ul><br><br><div class="spoiler">  <b class="spoiler_title">Usage example</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TYPE</span></span> NumTab <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OF</span></span> employees.employee_id%<span class="hljs-keyword"><span class="hljs-keyword">TYPE</span></span>; TYPE NameTab IS TABLE OF employees.last_name%TYPE; CURSOR c1 IS <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> employee_id,last_name <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> salary &gt; <span class="hljs-number"><span class="hljs-number">10000</span></span> <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> last_name; enums NumTab; names NameTab; <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">SELECT</span></span> employee_id, last_name <span class="hljs-keyword"><span class="hljs-keyword">BULK</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COLLECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> enums, <span class="hljs-keyword"><span class="hljs-keyword">names</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> employees <span class="hljs-keyword"><span class="hljs-keyword">ORDER</span></span> <span class="hljs-keyword"><span class="hljs-keyword">BY</span></span> employee_id; OPEN c1; LOOP FETCH c1 BULK COLLECT INTO enums, names LIMIT 10; EXIT WHEN names.COUNT = 0; do_something(); <span class="hljs-keyword"><span class="hljs-keyword">END</span></span> <span class="hljs-keyword"><span class="hljs-keyword">LOOP</span></span>; CLOSE c1; <span class="hljs-keyword"><span class="hljs-keyword">DELETE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> emp_temp <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> department_id = <span class="hljs-number"><span class="hljs-number">30</span></span> <span class="hljs-keyword"><span class="hljs-keyword">RETURNING</span></span> employee_id, last_name <span class="hljs-keyword"><span class="hljs-keyword">BULK</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COLLECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> enums, <span class="hljs-keyword"><span class="hljs-keyword">names</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>;</code> </pre><br></div></div><br><br><a name="Eighteen"></a><h5>  <b>Forall cycle</b> </h5><br><ul><li>  sends DML statements from PL / SQL to SQL in batches, rather than one by one </li><li>  may contain only one DML statement </li><li>  For discharged collections the following form is used: <br><pre> <code class="sql hljs">FORALL i IN INDICES OF cust_tab</code> </pre>  (the construction does not work for associative arrays indexed by strings) </li><li>  it is convenient to work with sparse collections (or with part of the collection) using index collections (of pls_integer).  Usage example: <br><pre> <code class="sql hljs">FORALL i IN VALUES OF rejected_order_tab</code> </pre> </li><li>  Some details of the work of forall can be found in this article <a href="http://habrahabr.ru/post/125893/">habrahabr.ru/post/125893</a> </li></ul><br><br><ul><li>  <b>SQL% BULK_ROWCOUNT</b> - collection, contains the number of rows affected by each dml statement </li><li>  <b>SQL% ROWCOUNT</b> - the total number of rows affected by the dml statements in the forall loop </li></ul><br><br><div class="spoiler">  <b class="spoiler_title">Usage example</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TYPE</span></span> NumList <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OF</span></span> <span class="hljs-built_in"><span class="hljs-built_in">NUMBER</span></span>; depts NumList := NumList(10, 20, 30); TYPE enum_t IS TABLE OF employees.employee_id%TYPE; e_ids enum_t; TYPE dept_t IS TABLE OF employees.department_id%TYPE; d_ids dept_t; <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FORALL</span></span> j <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> depts.FIRST .. depts.LAST <span class="hljs-keyword"><span class="hljs-keyword">DELETE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">FROM</span></span> emp_temp <span class="hljs-keyword"><span class="hljs-keyword">WHERE</span></span> department_id = depts(j) <span class="hljs-keyword"><span class="hljs-keyword">RETURNING</span></span> employee_id, department_id <span class="hljs-keyword"><span class="hljs-keyword">BULK</span></span> <span class="hljs-keyword"><span class="hljs-keyword">COLLECT</span></span> <span class="hljs-keyword"><span class="hljs-keyword">INTO</span></span> e_ids, d_ids; <span class="hljs-keyword"><span class="hljs-keyword">END</span></span>;</code> </pre><br></div></div><br><br><a name="Nineteen"></a><h6>  <b>Exceptions in forall</b> </h6><br><ul><li>  When an exception occurs in any of the dml statements in the loop, the transaction is completely rolled back. </li><li>  If you describe an error handler, you can fix successfully executed dml statements in it (these are the statements that were executed before the exception occurred). </li><li>  Design <pre> <code class="sql hljs">FORALL j IN collection.FIRST.. collection.LAST SAVE EXCEPTIONS</code> </pre> <br>  ORA-24381 is generated at the end if exceptions occurred in the loop </li><li>  SQL% BULK_EXCEPTIONS - a collection containing information about all exceptions generated during the execution of a loop <br>  .Count <br>  .ERROR_INDEX - index value of j at which the exception occurred (sql% bulk_exception (i) .error_index) <br>  .ERROR_CODE - error code.  Error information can be retrieved using the sqlerrm function: SQLERRM (- (SQL% BULK_EXCEPTIONS (i) .ERROR_CODE)) </li></ul><br><br><a name="Twenty"></a><h5>  <b>Collection exceptions</b> </h5><br><ul><li>  <b>COLLECTION_IS_NULL</b> - an attempt to work with an uninitialized collection </li><li>  <b>NO_DATA_FOUND</b> - attempt to read deleted item </li><li>  <b>SUBSCRIPT_BEYOND_COUNT</b> - going beyond the boundaries of the collection </li><li>  <b>SUBSCRIPT_OUTSIDE_LIMIT</b> - index out of range </li><li>  <b>VALUE_ERROR</b> - the index is null or not converted to an integer </li></ul><br><br><div class="spoiler">  <b class="spoiler_title">Examples of situations that throw exceptions</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">DECLARE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TYPE</span></span> NumList <span class="hljs-keyword"><span class="hljs-keyword">IS</span></span> <span class="hljs-keyword"><span class="hljs-keyword">TABLE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">OF</span></span> <span class="hljs-built_in"><span class="hljs-built_in">NUMBER</span></span>; nums NumList; <span class="hljs-keyword"><span class="hljs-keyword">BEGIN</span></span> nums(<span class="hljs-number"><span class="hljs-number">1</span></span>) := <span class="hljs-number"><span class="hljs-number">1</span></span>; <span class="hljs-comment"><span class="hljs-comment">-- raises COLLECTION_IS_NULL nums := NumList(1, 2); nums(NULL) := 3; -- raises VALUE_ERROR nums(0) := 3; -- raises SUBSCRIPT_BEYOND_COUNT nums(3) := 3; --raises SUBSCRIPT_OUTSIDE_LIMIT nums.Delete(1); IF nums(1) = 1 THEN ... -- raises NO_DATA_FOUND END;</span></span></code> </pre><br></div></div><br><br><a name="TwentyOne"></a><h5>  <b>DBMS_SESSION.FREE_UNUSED_USER_MEMORY</b> </h5><br><br><ul><li>  The DBMS_SESSION.FREE_UNUSED_USER_MEMORY procedure returns unused more memory to the system. </li><li>  Oracle documentation recommends using the procedure ‚Äúrarely and wisely‚Äù. </li><li>  In case of connection in <b>Dedicated Server</b> mode, a call to this procedure returns unused PGA memory to the operating system. </li><li>  If connected in <b>Shared Server</b> mode, calling this procedure returns unused memory to the <b>Shared Pool.</b> </li></ul><br><br>  <b>When it is necessary to free memory:</b> <br><ul><li>  Large sorts when the entire sort_area_size area is used </li><li>  Compiling large PL / SQL packages, procedures, or functions </li><li>  Storing large amounts of data in PL / SQL index tables </li></ul><br><br><div class="spoiler">  <b class="spoiler_title">Usage example</b> <div class="spoiler_text"><pre> <code class="sql hljs"><span class="hljs-keyword"><span class="hljs-keyword">CREATE</span></span> <span class="hljs-keyword"><span class="hljs-keyword">PACKAGE</span></span> foobar <span class="hljs-keyword"><span class="hljs-keyword">type</span></span> number_idx_tbl <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">table</span></span> <span class="hljs-keyword"><span class="hljs-keyword">of</span></span> <span class="hljs-built_in"><span class="hljs-built_in">number</span></span> indexed <span class="hljs-keyword"><span class="hljs-keyword">by</span></span> binary_integer; store1_table number_idx_tbl; <span class="hljs-comment"><span class="hljs-comment">-- PL/SQL indexed table store2_table number_idx_tbl; -- PL/SQL indexed table store3_table number_idx_tbl; -- PL/SQL indexed table ... END; -- end of foobar DECLARE ... empty_table number_idx_tbl; -- uninitialized ("empty") version BEGIN FOR i in 1..1000000 loop store1_table(i) := i; -- load data END LOOP; ... store1_table := empty_table; -- "truncate" the indexed table ... - dbms_session.free_unused_user_memory; -- give memory back to system store1_table(1) := 100; -- index tables still declared; store2_table(2) := 200; -- but truncated. ... END;</span></span></code> </pre><br></div></div><br><br>  A video recording of the lecture, based on which this article was written: <br><br><iframe width="560" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/y6aTJBHNgBQ%3Ffeature%3Doembed&amp;xid=17259,15700023,15700186,15700191,15700253&amp;usg=ALkJrhjSloBAewEA3vD8z5X9XtLWn1Df2g" frameborder="0" allowfullscreen=""></iframe><br><br>  A variety of other Oracle-related videos can be found on this channel: <br>  <a href="http://www.youtube.com/c/MoscowDevelopmentTeam">www.youtube.com/c/MoscowDevelopmentTeam</a> <br><br><h1>  <b>Other Oracle Articles</b> </h1><br>  <a href="http://habrahabr.ru/post/256655/">All about triggers in Oracle</a> </div><p>Source: <a href="https://habr.com/ru/post/254355/">https://habr.com/ru/post/254355/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../254343/index.html">Daniil Dubrovkin: "Open source does not mean that it is free and that it does not belong to anyone."</a></li>
<li><a href="../254345/index.html">New in Wolfram Language: WikipediaData feature for integrating with Wikipedia and processing its data</a></li>
<li><a href="../254349/index.html">How the process in Data Science works</a></li>
<li><a href="../254351/index.html">How to catch what is not. Part Three: Who are the judges?</a></li>
<li><a href="../254353/index.html">Optimization Planning with Unity</a></li>
<li><a href="../254357/index.html">Basket for product catalog (minibasket.js)</a></li>
<li><a href="../254361/index.html">Indoor "GPS" with an accuracy of -2 cm</a></li>
<li><a href="../254363/index.html">Analysis of the tasks of the first qualifying round of the Russian Code Cup 2015</a></li>
<li><a href="../254365/index.html">Correct insertion of C ++ preprocessor definitions in CMake</a></li>
<li><a href="../254367/index.html">See you at EMC Technology Day # 3</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>