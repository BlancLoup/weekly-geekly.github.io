<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Wkhtmltopdf + Node.JS</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Creating pdf documents is a fairly common task. It is successfully coped with by a whole family of libraries, which allow literally ‚Äúassemble‚Äù pdf in ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Wkhtmltopdf + Node.JS</h1><div class="post__text post__text-html js-mediator-article">  Creating pdf documents is a fairly common task.  It is successfully coped with by a whole family of libraries, which allow literally ‚Äúassemble‚Äù pdf in parts or fill it in on the basis of a previously prepared template.  This approach is reliable, because  we can count on the fact that, having changed the text of one inscription, pagination on some pages will not disappear.  On the other hand, adding new pages to pdf takes some time for the developer and, the more different visual elements, the more time it takes. <br><br>  However, there is another way to create pdf documents: converting from some markup language using the appropriate tool.  This method will be effective and take less time to make changes to pdf, if the selected tool works quite predictably.  There are several similar solutions, but in our project we chose <a href="http://wkhtmltopdf.org/">Wkhtmltopdf</a> , which generates a pdf document from HTML.  After a year of using this tool, I can say that the choice was made right, because  all needs were covered with head. <br><br>  In this article I want to share libraries that allow you to simplify the work with wkhtmltopdf in Node.JS. <br><a name="habracut"></a><br>  Currently there are several packages in npm that allow you to integrate wkhtmltopdf.  However, they have their disadvantages: <br><ol><li>  All options to wkhtmltopdf are passed as an object.  The wkhtmltopdf has a lot of options and you need to constantly run between the documentation and the code to form the correct object, so I would like to have hints from the IDE when completing the options. </li><li>  Not all wkhtmltopdf functionality is covered by most libraries.  For example, not everywhere there is the possibility of generating pdf documents from several HTML sources or it is not possible to configure the generated table of contents (table of contents) </li></ol>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      As a result, <a href="https://www.npmjs.com/package/wkhtmltopdf-nodejs-options-wrapper">wkhtmltopdf-nodejs-options-wrapper</a> libraries were developed, which is a wrapper for wkhtmltopdf parameters, and <a href="https://www.npmjs.com/package/wkhtmltopdf-nodejs-pdfapi">wkhtmltopdf-nodejs-pdfapi</a> , intended for creating pdf documents. <br><br>  Consider an example of their use: <br><br><pre><code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> wkhtmlToPdfOptions = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'wkhtmltopdf-nodejs-options-wrapper'</span></span>), PdfApi = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'wkhtmltopdf-nodejs-pdfapi'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> pdfApi = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> PdfApi(), request = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> wkhtmlToPdfOptions.CreateRequest(); <span class="hljs-comment"><span class="hljs-comment">//    var googlePage = new wkhtmlToPdfOptions.Page(); googlePage.setInput('http://google.com'); //    var habrPage = new wkhtmlToPdfOptions.Page(); habrPage.setInput('http://habrahabr.ru'); habrPage.getOptions().setZoom(0.5); //   50% request.addPage(googlePage); request.addPage(habrPage); request.getGlobalOptions().setImageDpi(300); //     300dpi request.getHeadersAndFooterOptions().setFooterCenter('Footer text'); //      // createPdf    pdf   promise pdfApi.createPdf(request, 'result.pdf') .then(function(data, debug) { console.log('Pdf  '); }, function(data, debug) { console.log(' : ' + data); });</span></span></code> </pre> <br><br>  As you can see from the example, to create a pdf document, you must create a <b>CreateRequest</b> object, fill it with the necessary data and transfer it to <b>pdfApi</b> . <br><br>  IDE (WebStorm in my case) tells you which methods you can use: <img src="https://habrastorage.org/files/a95/62e/c5d/a9562ec5df894a9bb4d6c68f184161c3" alt="image"><br><br><img src="https://habrastorage.org/files/e3a/d35/f45/e3ad35f45d7b463b8bef7d332d52778c"><br><br>  This functionality is already enough for use on the server, but it would be even more useful to be able to start creating pdf from the client.  To do this, we need to have a web service that would accept requests and give ready-made pdf files. <br><br>  As such a service, you can use the WebSocket server <a href="https://www.npmjs.com/package/wkhtmltopdf-nodejs-ws-server">wkhtmltopdf-nodejs-ws-server</a> , which can be easily launched as follows: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> WsServer = <span class="hljs-built_in"><span class="hljs-built_in">require</span></span>(<span class="hljs-string"><span class="hljs-string">'wkhtmltopdf-nodejs-ws-server'</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> server = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> WsServer(<span class="hljs-number"><span class="hljs-number">3000</span></span>); <span class="hljs-comment"><span class="hljs-comment">// &lt;-   ""    *:3000 server.start();</span></span></code> </pre><br>  Client code may look like this: <br><br><pre> <code class="javascript hljs"><span class="hljs-comment"><span class="hljs-comment">//  webpack  browserify,      &lt;b&gt;require&lt;/b&gt; var wkhtmlToPdf = require('wkhtmltopdf-nodejs-options-wrapper'), io = require('socket.io-client'); var socket = io('http://ip__:3000'); var page = new wkhtmlToPdf.Page(), request = new wkhtmlToPdf.CreateRequest(); page.setInput('http://google.com'); //  pdf     request.addPage(page); request.getGlobalOptions().setPageSize('Letter'); socket.on('pdf:create:success', function(response) { console.log('Pdf created: http://ip__:3000/result_' + response.handle + '.pdf'); }); socket.on('pdf:create:fail', function(response) { console.log('Pdf creation failed!'); console.log(response); }); socket.emit('create', request.toObject());</span></span></code> </pre><br><br>  Everything.  This is enough to create pdf documents. <br><br>  I hope npm packages and examples given in the article will be useful. <br><br>  Thanks for attention. <br><br>  PS Documentation: <a href="https://github.com/GrizliK1988/wkhtmltopdf-nodejs-options-wrapper">wkhtmltopdf-nodejs-options-wrapper</a> , <a href="https://github.com/GrizliK1988/wkhtmltopdf-nodejs-pdfapi">wkhtmltopdf-nodejs-pdfapi</a> , <a href="https://github.com/GrizliK1988/wkhtmltopdf-nodejs-ws-server">wkhtmltopdf-nodejs-ws-server</a> </div><p>Source: <a href="https://habr.com/ru/post/266171/">https://habr.com/ru/post/266171/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../266157/index.html">KolibriOS Digest # 9: Summer Harvest</a></li>
<li><a href="../266159/index.html">If not Liferay then what? GateIn?</a></li>
<li><a href="../266161/index.html">Django 1.9 will receive a new design admin</a></li>
<li><a href="../266163/index.html">Performance Comparison of C ++ and C #</a></li>
<li><a href="../266169/index.html">PBX-Sphere Online - How We Did It</a></li>
<li><a href="../266173/index.html">ReCaptcha in phpMyAdmin - activation, traversal and fix</a></li>
<li><a href="../266175/index.html">A monkey with a violin, or how I unexpectedly saved 790 rubles with the help of Fiddler</a></li>
<li><a href="../266199/index.html">Visualization of static and dynamic networks on R, part 4</a></li>
<li><a href="../266237/index.html">Guide to the implementation of 2D platformer (the end)</a></li>
<li><a href="../266285/index.html">Visualization of static and dynamic networks on R, part 5</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>