<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Slightly more adaptive site on 1C-Bitrix, analogue of visibility classes from bootstrap</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="As we all know, from April 21, 2015, Google will pessimize sites that are unsuitable for viewing on mobile devices when ranking. CSS frameworks like B...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Slightly more adaptive site on 1C-Bitrix, analogue of visibility classes from bootstrap</h1><div class="post__text post__text-html js-mediator-article">  As we all know, from April 21, 2015, Google will pessimize sites that are unsuitable for viewing on mobile devices when ranking.  CSS frameworks like Bootstrap, CMS settings, in particular, 1C-BEAS of the latest versions help fight many troubles.  But they all do not solve another, very important problem: it is not enough just to hide unnecessary content on certain devices, you need to prevent it from loading. <br><br>  In this article I will talk about the extension of the site management that I wrote for 1C-Bitrix, which solves the problem announced above. <br><a name="habracut"></a><br>  Google itself gives preference to responsive sites; one site is better than two identical in content but different in form.  For studios and their clients, adaptive sites are also attractive from an economic point of view, an adaptive site will be cheaper in development and support than a dial-up and mobile version. <br><br>  So, we have a site on 1C-Bitrix, an integrated layout on Bootstrap3 and a desire to help your mobile users. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Previously, to achieve a more or less decent-looking, adaptive version of the site, layout designers and content managers used remarkable visibility classes ".hidden-lg, .hidden-md, .hidden-sm, and .hidden-xs".  This is enough to hide unnecessary blocks on those or other user screen resolutions. <br><br>  - ‚ÄúBut what about the resources?‚Äù Pictures and js were both loaded and loaded onto user devices.  Sometimes these are megabytes of unnecessary traffic, and if we talk about mobile users, then expensive and slow traffic.  Here, of course, you can brush it off - ‚Äúthere is a tag and checks in js!‚Äù, But we understand that the same content manager is not able to solve the problem with the help of these tools. <br><br>  Reflecting on this, I came to the conclusion that classes of visibility are, of course, a good thing, but you need to make some more effective tool.  The tool should allow you to cancel the download of any content on the user's device, in other words, the server itself should not give a specific piece of code so that it is not loaded by the user.  At the same time, the tool should be as simple as possible, as visibility classes. <br><br>  I started by searching for solutions that would allow us to determine the mobile user ‚Äústill on the fly‚Äù, and not during the page rendering.  This solution was the PHP library Mobile Detect (link in the basement).  This PHP library allows you to determine the user of the smartphone / tablet / desktop, and also gives a lot of background information on the device user who came to the site.  From the whole variety of the library, I chose only one method; he answered the question: ‚Äúis this a mobile user or not?‚Äù  Of course, it was possible to isolate more and tablets, but I grabbed them in a heap with smartphones. <br><br>  A start has been made, we can separate mobile users from desktop, then we need to make the tool itself. <br>  This is where the 1C-Bitrix API comes to the rescue, and specifically the OnEndBufferContent event (link in the basement).  The method is called when displaying buffered content and allows them to manipulate. <br><br>  Things are easy, we intercept the OnEndBufferContent event, connect the Mobile Detect library and find out if we are mobile.  Further, depending on the answer, we throw out unnecessary blocks from the content, and transfer the rest to the user's output. <br><br>  For content managers, I made the simplest version of the page layout.  Content wrapped in &lt;lg&gt; &lt;/ lg&gt; will only be displayed on desktops, and &lt;xs&gt; &lt;/ xs&gt; only on mobile devices.  Clear, simple and effective.  Naturally, when catching unwanted blocks, the markup tags &lt;lg&gt; &lt;/ lg&gt; &lt;xs&gt; &lt;/ xs&gt; are cut out from the code, which makes it possible not to harm the layout semantics. <br><br>  This could have been finished, but the project has a lot of studio, copying the code back and forth is inconvenient + you need to somehow be updated.  Therefore, I wrapped my work in a module, and then in a separate extension for the Marketplace.  During the work on the extension, it acquired the instructions for use, displayed in the administrative panel, as well as the API method that answers the same question ‚Äúmobile?‚Äù.  The last innovation allows you to use the module when writing your components and templates to them, here the flight of fancy is limitless, the component templates can be transformed and adjusted to the user, and most importantly, the whole thing is perfectly friendly with the built-in cache Bitrix. <br><br>  As a result, I managed to create a fast and simple analogue of the visibility classes for 1C-Bitrix UT.  The solution not only allows you to hide and display content for different types of users, but also significantly saves traffic, reduces page load time, unloads the processor of mobile devices without rendering js sliders that are complex and unnecessary on mobile phones and other delights of desktop versions of the site. <br><br>  A couple of screenshots of what happened: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/356/e3e/b8a/356e3eb8a57cc7869d23d356b543cad0.png"><br><br><img src="https://habrastorage.org/getpro/habr/post_images/f88/8f5/116/f888f5116ad678d6df936666eec66e36.png"><br><br><h4>  Materials used to create the solution </h4><br><ul><li>  <a href="http://mobiledetect.net/">PHP library "Mobile Detect"</a> </li><li>  <a href="http://dev.1c-bitrix.ru/api_help/main/events/onendbuffercontent.php">OnEndBufferContent API Bitrix</a> </li><li>  <a href="http://marketplace.1c-bitrix.ru/solutions/klondike.mobilefriendly/">Solution in the market</a> </li></ul></div><p>Source: <a href="https://habr.com/ru/post/262533/">https://habr.com/ru/post/262533/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../262523/index.html">Visual Studio Code - code editor for Linux, OS X and Windows</a></li>
<li><a href="../262525/index.html">How we ensured communication at the summits of the SCO and BRICS</a></li>
<li><a href="../262527/index.html">How to make Jenkins make your life easier and become happy</a></li>
<li><a href="../262529/index.html">Experience of development and design on AngularJS</a></li>
<li><a href="../262531/index.html">My system for testing and improving the quality of a GSM gateway, part one: functional and circuit level</a></li>
<li><a href="../262535/index.html">Vulnerabilities of security systems of the Ministry of Defense, FSB, FSIN, NPP, metro and federal highways</a></li>
<li><a href="../262539/index.html">How bot-to-bot can replace APIs in the near future</a></li>
<li><a href="../262541/index.html">Effective work with SQLite on the example of ICQ</a></li>
<li><a href="../262543/index.html">How to solve the entrance exam to the Yandex Data Analysis School</a></li>
<li><a href="../262545/index.html">We use CSS Flexible Box Layout Module. Part 1: Introduction</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>