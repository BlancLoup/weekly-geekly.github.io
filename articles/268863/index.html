<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Google Cloud Endpoints in Java: A Guide. part 1</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Google Cloud Endpoints is an add-on to Google App Engine (GAE) for creating APIs for web and mobile applications, making development easier and includ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Google Cloud Endpoints in Java: A Guide. part 1</h1><div class="post__text post__text-html js-mediator-article">  Google Cloud Endpoints is an add-on to Google App Engine (GAE) for creating APIs for web and mobile applications, making development easier and including out-of-box protection against DoS attacks, OAuth 2.0 authentication, a web interface for testing APIs, SSL, automatic scalability (the site will not fall under the habr effect), and the ability to use the services available on the Google App Engine (sending and receiving email and XMPP messages, downloading data from the Internet (URL Fetch service), scheduled tasks (Task Queues and Scheduled Tasks) and others.) <br><br>  GAE is free within the framework of the initial quotas, which allow you to try and test the service, and also to ensure the free operation of a website that does not have large loads.  At exhaustion of quotas service becomes paid. <br><br>  The idea of ‚Äã‚Äãthe service is that it does all or most of the work of the system administrator, plus some of the work of the programmer.  This service may be of interest to startups, as it allows small forces and in a short time to launch a working project. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The <a href="https://github.com/objectify/objectify">Objectify</a> framework provides convenient tools for working with the database built into GAE, and the <a href="https://github.com/maximepvrt/angular-google-gapi">angular-google-gapi module</a> for connecting a web application to AngularJS with user authorization. <br><br>  There are a lot of pictures and text under the cut, and it is assumed that the reader is familiar with Java Servlets. <br><a name="habracut"></a><br><h1>  check in </h1><br>  First you need to create a project on GAE.  This will require a google account.  You can use the existing one or create a new one.  Google policy allows the creation of multiple accounts for one person.  Google warns when an application requests user information (OAuth consent screen), then information about the application can transfer information about the developer, including his email address, and this is not any email address, but the account @ gmail.com under which they work with GAE, so it‚Äôs probably worth starting separate accounts for different projects, since Google Chrome allows you to switch between them conveniently. <br><br>  Go to the Google developer console: <a href="https://console.developers.google.com/">console.developers.google.com</a> and log in using the selected Google account, click "Create an empty project", select the project name and project ID.  The project will be available at http: // {project ID} .appspot.com <br><br>  For example: hello-habrahabr-api.appspot.com <br><br>  ID must be unique.  Moreover, if {project ID} @ gmail.com is busy, then this ID will already be marked as ‚Äúbusy‚Äù for GAE.  That is, you can create {project ID} .appspot.com and {project ID} @ gmail.com at the same time. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/cb8/2d6/74f/cb82d674f246cea7a37dd0f4e0b73215.png"><br><br>  After the project is created, it will be available in the developer console: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d6b/252/204/d6b2522047434e90ad76b073c801ef65.png"><br><br>  For this tutorial, we will create two projects in the Google Developer Console: hello-habrahabr-api.appspot.com, which will be the API (Google Endpoints itself), and hello-habrahabr-webapp.appspot.com, on which we will host the web client.  I do this for clarity, the separation of fronend and backend could be created on the same domain. <br><br>  In the developer‚Äôs console of our Cloud Endpoints project hello-habrahabr-api.appspot.com, select APIs &amp; auth&gt; Credentials&gt; Add Credentials&gt; OAuth 2.0 Client ID&gt; Configure consent screen from the menu. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/15f/013/5ad/15f0135addbd5363e2ab7d8c8d6fca3c.png"><br><br>  In the settings, the developer's email address is automatically inserted, we also indicate the name of the application (Product name) (mandatory), and (optionally) the web page address, logo and other data. <br><br>  In the menu, select APIs &amp; auth&gt; Credentials&gt; Add Credentials&gt; OAuth 2.0 Client ID and specify the type of application for which we create the client ID.  In this guide, we will look at creating a web application, so we select the Web application, and click ‚ÄúCreate‚Äù. <br><br>  We indicate: <br><br>  - web application name (any) <br><br>  - domain (s) from which Javascript can access the API (Authorized JavaScript origins) it can be any domain.  It is possible the same on which Cloud Endpoints works.  It should be borne in mind that Cloud Endpoints does not work on the user's domain yet, only on .appspot.com.  But a web application that accesses the API can work on any domain. <br><br>  - Authorized redirect URIs: do not use <br><br>  Click ‚ÄúCreate‚Äù, we get ‚Äúclient ID‚Äù and ‚Äúclient secret‚Äù - we will need them for the web application. <br><br><h1>  Preparation and adjustment of the working environment. </h1><br>  We will need: <br><br>  <i>1. Java 7</i> (Java 8 is not yet GAE supported) <br><br>  Java installation: <a href="http://www.java.com/en/download/manual_java7.jsp">www.java.com/en/download/manual_java7.jsp</a> <br><br>  For Ubuntu / Debian: <br><br><pre><code class="bash hljs">sudo add-apt-repository ppa:webupd8team/java sudo apt-get update &amp;&amp; sudo apt-get install oracle-java7-installer</code> </pre> <br>  <i>2. Maven</i> <br><br>  Installation: <a href="http://maven.apache.org/install.html">maven.apache.org/install.html</a> <br><br>  On Linux (latest version 3.3.3): <br><br><pre> <code class="bash hljs">sudo mkdir /usr/<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/apache-maven/ <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> /usr/<span class="hljs-built_in"><span class="hljs-built_in">local</span></span>/apache-maven &amp;&amp; sudo wget http://www.eu.apache.org/dist/maven/maven-3/3.3.3/binaries/apache-maven-3.3.3-bin.tar.gz &amp;&amp; sudo tar xvf apache-maven-3.3.3-bin.tar.gz <span class="hljs-built_in"><span class="hljs-built_in">echo</span></span> <span class="hljs-string"><span class="hljs-string">'export M2_HOME=/usr/local/apache-maven/apache-maven-3.3.3'</span></span> &gt;&gt; ~/.bashrc <span class="hljs-built_in"><span class="hljs-built_in">source</span></span> ~/.bashrc</code> </pre><br>  For Ubuntu / Debian (version 3.0.5 is now on depositories): <br><br><pre> <code class="bash hljs">sudo apt-get install maven</code> </pre><br>  Check the version of Maven and Java: <br><br><pre> <code class="bash hljs">maven -version</code> </pre><br>  <i>3. IDE or code editor</i> - to taste.  Eclipse and IntelliJ IDEA Ultimate have plugins for working with GAE, but testing offline on your machine for Cloud Endpoints will not work anyway (although the documentation indicates what it should), so you need to use separate projects to separate the code in the development and running system. or use the opportunity provided by GAE to work with different versions of the project. <br><br>  Instead of GAE-plugins, it is easier and more convenient (IMHO) to use Maven on the command line, so IntelliJ IDEA Community Edtion is quite suitable - there is a built-in terminal, and that‚Äôs all you need.  You can install <a href="https://marketplace.eclipse.org/content/tm-terminal">TM Terminal</a> in Eclipse. <br><br>  <i>4. Google App Engine SDK</i> .  If necessary, you can download it <a href="https://cloud.google.com/appengine/downloads">here</a> . <br><br><pre> <code class="bash hljs">mkdir ~/GAE-SDK &amp;&amp; <span class="hljs-built_in"><span class="hljs-built_in">cd</span></span> ~/GAE-SDK wget https://storage.googleapis.com/appengine-sdks/featured/appengine-java-sdk-1.9.27.zip &amp;&amp; unzip appengine-java-sdk-1.9.27.zip</code> </pre><br>  But when using Maven, it downloads the Google App Engine SDK automatically. <br><br><h1>  Create the backend base </h1><br>  Go to the directory in which we will create the project directory.  Avoid directories with non-standard characters in the name and a very long path, this can cause errors in Maven. <br><br>  To create a project blank, use Maven and <a href="http://mvnrepository.com/artifact/com.google.appengine.archetypes/endpoints-skeleton-archetype">Endpoints Skeleton Archetype</a> : <br><br><pre> <code class="bash hljs">mvn archetype:generate -Dappengine-version=1.9.27 -Dfilter=com.google.appengine.archetypes:</code> </pre><br>  Enter ‚Äú2‚Äù (select <code>2: remote -&gt; com.google.appengine.archetypes:endpoints-skeleton-archetype (A skeleton project using Cloud Endpoints with Google App Engine Java)</code> ). <br><br>  Select the version (by default - the last). <br><br>  Define value for property 'groupId': - enter groupId, this is the unique identifier of our application, following the <a href="https://maven.apache.org/guides/mini/guide-naming-conventions.html">Maven Guide to naming conventions on groupId, artifactId and version</a> - as a rule, the domain name is used in the reverse order, but taking into account the valid symbols <a href="https://docs.oracle.com/javase/tutorial/java/package/namingpkgs.html">package name rules</a> - then in my case, instead of com.appspot.hello-habrahabr-api, you must enter com.appspot.hellohabrahabrapi or com.appspot.hello_habrahabr_api (I chose the latter). <br><br>  Define value for property 'artifactId' - enter the short name of the project, for example hello-habrahabr-api (here hyphen is allowed).  This will be the name of the .war (.jar) file without the version number (the file name will be hello-habrahabr-api- {version number} .war). <br><br>  Define value for property 'version' - enter the version number, for GAE the version number should be without points, for example, not 1.0.3, but 1-0-3.  This is due to the fact that on GAE versions of the project are available at the address of the form {version number. {Project ID} .appspot.com. <br><br>  Also, GAE uses the format {instance number. {Standard version}. {Project ID} .appspot.com - therefore, it is recommended to start the version name with a letter, for example, v-1-0 or ver-1-0, to distinguish the instance running . <br><br>  For this reason, the default option offered by Maven - 1.0-SNAPSHOT - is better to replace the format that is suitable for GAE standards. <br><br>  Define value for property 'package' - usually accept the default proposed (will meet the groupId). <br><br>  Confirm the selected settings: Y (yes, by default). <br><br>  If everything is done correctly, we get a message about a successful build: <br><br><pre> <code class="bash hljs">[INFO] ------------------------------------------------------------------------ [INFO] BUILD SUCCESS [INFO] ------------------------------------------------------------------------ [INFO] Total time: 03:08 min [INFO] Finished at: 2015-10-06T02:42:33+03:00 [INFO] Final Memory: 16M/108M [INFO] ------------------------------------------------------------------------</code> </pre><br>  Maven will create a folder whose name will meet artifactId with project files.  The folder has the following structure: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/539/258/611/539258611f15a56d5d6bed6118f42fd9.png"><br><br><h2>  pom.xml </h2><br>  First we need to edit pom.xml which contains the Maven settings for our project.  In the code: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">properties</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">app.id</span></span></span><span class="hljs-tag">&gt;</span></span>your-app-id<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">app.id</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">app.version</span></span></span><span class="hljs-tag">&gt;</span></span>1<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">app.version</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">properties</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  <code>your-app-id</code> should be replaced with {project ID}, in my case, this is hello-habrahabr-api (note: if you don‚Äôt see the Services API at ... / _ ah / api / explorer, you may have forgotten to replace app.id) and &lt;app.version&gt; ver-1-0 &lt;/app.version&gt; are aligned with ver-1-0 <br><br>  AT <br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">prerequisites</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">maven</span></span></span><span class="hljs-tag">&gt;</span></span>3.1.0<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">maven</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">prerequisites</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  We prescribe the version of Maven that we have installed, in my case I replace 3.1.0 with 3.3.3. <br><br><h2>  src / main / webapp / WEB-INF / appengine-web.xml </h2><br>  In src / main / webapp / WEB-INF / appengine-web.xml: <br><br><pre> <code class="xml hljs"><span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">application</span></span></span><span class="hljs-tag">&gt;</span></span>${app.id}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">application</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span>${app.version}<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">version</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  {app.id} and {app.version} are replaced accordingly with {project ID} and version (needs to be replaced, automatically from pom.xml it will not take the value). <br><br>  We collect the project: <br><br><pre> <code class="bash hljs">mvn clean install</code> </pre><br>  If the build was unsuccessful, look for errors in the settings.  If - successful, upload the project to GAE: <br><br><pre> <code class="bash hljs">mvn appengine:update</code> </pre><br>  When you first start, Maven will download the Google App Engine SDK, and save it to ~ / .m2 / repository / com / google / appengine / appengine-java-sdk / {version number} (on Linux). <br><br>  Also, when you first start from the console, you will need to log in to GAE, a dialog will open in the browser window: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/de7/820/60f/de782060fbe8bb8ce04fc2449a145083.png"><br><br>  When you click on the button, in a new window, the code appears that needs to be copied and entered into the console. <br><br>  User authentication tokens are stored in ~ / .appcfg_oauth2_tokens_java.  If you get the message 404 when you try to login, it does not exist (app_id = u '{your-app-ID}') - this is probably due to the fact that you were logged in under a different account.  Rename (or delete) this file and try again. <br><br>  If the mvn appengine: update command is executed successfully (‚ÄúBUILD SUCCESS‚Äù), then the initial settings have been made successfully. <br><br>  There was a bug when downloading in version 1.9.21, which could be fixed as follows: in pom.xml in all local we replace appengine.version with appengine.sdk.version (see <a href="https://code.google.com/p/googleappengine/issues/detail%3Fid%3D12009">code.google.com/p/googleappengine/issues/detail ? id = 12009</a> ) In the current version (1.9.27), the bug does not appear, but knowing just in case will not hurt. <br><br>  In version 1.9.27 at boot you can get the message: <br><br><pre> <code class="bash hljs">******************************************************** The API version <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> this SDK is no longer supported on the server! ----------- Latest SDK: Release: 1.9.27 Timestamp: Tue Aug 18 21:28:24 IDT 2015 API versions: [1] ----------- Your SDK: Release: 1.9.27 Timestamp: Wed Sep 02 23:29:33 IDT 2015 API versions: [1.0] ----------- Please visit https://developers.google.com/appengine/downloads <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> the latest SDK. ********************************************************</code> </pre><br>  Despite this warning, the download should succeed. <br><br><h1>  Configure Git to GAE </h1><br>  On GAE it is possible to place a free private Git repository for your code.  The repository is only a repository, the code is not deployed from it, the .war file is executed on the server which was compiled and loaded using Maven. <br><br>  First, we initialize the git repository in the project directory: <br><br><pre> <code class="bash hljs">git init git add src/ pom.xml README.md git commit -a</code> </pre><br>  Go to the developer console: <a href="https://console.developers.google.com/project">console.developers.google.com/project</a> , and select our project. <br><br>  Select in the menu: Source code&gt; Browse.  The site will offer to create a Git repository.  Click ‚ÄúGet started‚Äù <br><br><img src="https://habrastorage.org/getpro/habr/post_images/09d/6b6/672/09d6b667204c8bc92dd892fc64fe4ffd.png"><br><br>  You can copy the code from an existing repository to Github or Bitbucket, download (push) code from your computer, or clone (clone) the project code from GAE to your computer.  Choose "push".  We receive instructions: <br><br>  <i>1. Install Google Cloud SDK</i> <br><br>  Installation <a href="https://cloud.google.com/sdk/">Instructions</a> .  For Linux / Mac OS X: <br><br><pre> <code class="bash hljs">curl https://sdk.cloud.google.com | bash <span class="hljs-comment"><span class="hljs-comment">#         exec -l $SHELL gcloud init #           Google,        </span></span></code> </pre><br><img src="https://habrastorage.org/getpro/habr/post_images/e30/c5b/113/e30c5b11358945ed442292cd540eb4af.png"><br><br>  In the future, the settings can be changed with the command: gcloud config. <br><br>  Show settings: <br><pre> <code class="bash hljs">gcloud config list</code> </pre><br>  Edit settings: <br><pre> <code class="bash hljs">gcloud config <span class="hljs-built_in"><span class="hljs-built_in">set</span></span></code> </pre><br>  Erase Google Cloud SDK settings: <br><pre> <code class="bash hljs">gcloud config <span class="hljs-built_in"><span class="hljs-built_in">unset</span></span></code> </pre><br>  For example: <br><br>  gcloud config unset account - erase account in settings <br><br>  gcloud config unset project - erase the project name in the settings <br><br>  <i>2. We perform authentication</i> <br><br>  On Linux / Mac OS X: <br><pre> <code class="bash hljs">gcloud auth login <span class="hljs-comment"><span class="hljs-comment">#           Google git config credential.helper gcloud.sh</span></span></code> </pre><br>  <i>3. Add a remote git repository GAE</i> <br><br>  git remote add google <a href="https://source.developers.google.com/p/">source.developers.google.com/p</a> {project ID} / <br><br><pre> <code class="bash hljs">git remote add google https://source.developers.google.com/p/hello-habrahabr-api/</code> </pre><br>  <i>4. Upload to remote repository</i> <br><br><pre> <code class="bash hljs">git push --all google</code> </pre><br>  To clone the repository from the GAE cloud to a local machine, we need: <br><br>  Install Google Cloud SDK as above. <br><br>  Perform authentication: <br><br><pre> <code class="bash hljs">gcloud auth login</code> </pre><br>  Clone the repository to a local machine (the instructions on the site suggesting gcloud init {project ID} for this purpose are outdated): <br><br><pre> <code class="bash hljs">gcloud <span class="hljs-built_in"><span class="hljs-built_in">source</span></span> repos <span class="hljs-built_in"><span class="hljs-built_in">clone</span></span> default {ID }</code> </pre><br>  Go to the created directory, write and commit the code in the local repository, and <br><br><pre> <code class="bash hljs">git push -u google master</code> </pre><br>  To automate the work, you can use the following script (something like commit.push.build.and.upload.sh): <br><br><pre> <code class="bash hljs">mvn clean git add * <span class="hljs-comment"><span class="hljs-comment">#   .gitignore git commit -a git push --all google # mvn install mvn appengine:update</span></span></code> </pre><br>  If you have to switch between projects, a script should be placed in the project directory for quick and easy change of settings (set.account.sh): <br><br><pre> <code class="bash hljs">gcloud config <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> account <span class="hljs-string"><span class="hljs-string">"{  @mgmail.com}"</span></span> gcloud config <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> project <span class="hljs-string"><span class="hljs-string">"{ ID}"</span></span> gcloud config list rm ~/.appcfg_oauth2_tokens_java</code> </pre><br><h1>  Getting to writing API </h1><br>  Launch your favorite editor or IDE. <br><br>  For IntelliJ IDEA: <br><br>  To work with GAE, we need Maven version 3.1.0 and higher, in IntelliJ IDEA, it is now the default 3.0.5.  If necessary, we change, indicating the directory in which we have the latest version of Maven installed, for example /usr/local/apache-maven/apache-maven-3.3.3 (you can check it with the command: echo $ M2_HOME). <br><br>  inport project -&gt; specify the project directory -&gt; Import project from external model -&gt; Maven -&gt; you can leave the default settings -&gt; Import Project -&gt; specify the SDK (Java 1.7) -&gt; Finish. <br><br>  First of all, let's look at how WEB-INF / web.xml looks.  In our case: <br><br><pre> <code class="xml hljs"><span class="hljs-meta"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8" standalone="no"?&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">web-app</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://java.sun.com/xml/ns/javaee"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:web</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xmlns:xsi</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">version</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"2.5"</span></span></span><span class="hljs-tag"> </span><span class="hljs-attr"><span class="hljs-tag"><span class="hljs-attr">xsi:schemaLocation</span></span></span><span class="hljs-tag">=</span><span class="hljs-string"><span class="hljs-tag"><span class="hljs-string">"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet-name</span></span></span><span class="hljs-tag">&gt;</span></span>SystemServiceServlet<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet-name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet-class</span></span></span><span class="hljs-tag">&gt;</span></span>com.google.api.server.spi.SystemServiceServlet<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet-class</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">init-param</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">param-name</span></span></span><span class="hljs-tag">&gt;</span></span>services<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">param-name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">param-value</span></span></span><span class="hljs-tag">&gt;</span></span>com.appspot.hello_habrahabr_api.YourFirstAPI<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">param-value</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">init-param</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet-mapping</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet-name</span></span></span><span class="hljs-tag">&gt;</span></span>SystemServiceServlet<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet-name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url-pattern</span></span></span><span class="hljs-tag">&gt;</span></span>/_ah/spi/*<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">url-pattern</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet-mapping</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">welcome-file-list</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">welcome-file</span></span></span><span class="hljs-tag">&gt;</span></span>index.html<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">welcome-file</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">welcome-file-list</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">web-app</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Note that all requests to the API are sent to: / _ah / spi / * and are processed by the com.google.api.server.spi.SystemServiceServlet (SystemServiceServlet) servlet. <br><br>  One of the main "chips" Cloud Endpoints - a web interface for testing API (API Explorer) is available at {project ID} .appspot.com / _ah / api / explorer. <br><br>  To model the data received and issued by the API used JavaBean, i.e.  eligible classes: <br><br>  * public (public) constructor without parameters.  In this case, the constructor must be specified in an explicit form, although in the examples on Google it is missed, but in practice it does not work without a constructor. <br><br>  * all properties of the class are private, access via get / set (for boolean, getter must also begin with get, and not as generated by the IDE). <br><br>  * class must be serializable (you can omit it explicitly). <br><br>  Create two classes: <br><br>  UserForm.java: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.appspot.hello_habrahabr_api; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">UserForm</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String name; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> age; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> ishuman; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">UserForm</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> name; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String name)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.name = name; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getAge</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> age; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setAge</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> age)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.age = age; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getIshuman</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> ishuman; } <span class="hljs-comment"><span class="hljs-comment">// not just ishuman() for boolean // as will be created using getters and setters generation // in IntelliJ IDEA and Eclipse public void setIshuman(boolean ishuman) { this.ishuman = ishuman; } }</span></span></code> </pre><br>  And MessageToUser.java: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.appspot.hello_habrahabr_api; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">MessageToUser</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String name; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> String message; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">int</span></span> usernumber; <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">boolean</span></span> isregistered; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">MessageToUser</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> name; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setName</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String name)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.name = name; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> String </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getMessage</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> message; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setMessage</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(String message)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.message = message; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">int</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getUsernumber</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> usernumber; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">void</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">setUsernumber</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(</span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">int</span></span></span></span><span class="hljs-function"><span class="hljs-params"> usernumber)</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">this</span></span>.usernumber = usernumber; } <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> </span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">boolean</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getIsregistered</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> isregistered; } <span class="hljs-comment"><span class="hljs-comment">// not "isregistered()" as suggested by IDE's getter/setter generator public void setIsregistered(boolean isregistered) { this.isregistered = isregistered; } }</span></span></code> </pre><br>  Now we write class for the first API method.  Edit YourFirstApi.java, and paste the following code there: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.appspot.hello_habrahabr_api; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.api.server.spi.config.Api; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.api.server.spi.config.ApiMethod; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.api.server.spi.config.ApiMethod.HttpMethod; <span class="hljs-meta"><span class="hljs-meta">@Api</span></span>( name = <span class="hljs-string"><span class="hljs-string">"myApi"</span></span>, version = <span class="hljs-string"><span class="hljs-string">"v1"</span></span>, scopes = {Constants.EMAIL_SCOPE}, description = <span class="hljs-string"><span class="hljs-string">"first API for this application."</span></span> ) <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">YourFirstAPI</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-meta"><span class="hljs-meta">@ApiMethod</span></span>( name = <span class="hljs-string"><span class="hljs-string">"register"</span></span>, path = <span class="hljs-string"><span class="hljs-string">"register"</span></span>, httpMethod = HttpMethod.POST ) <span class="hljs-meta"><span class="hljs-meta">@SuppressWarnings</span></span>(<span class="hljs-string"><span class="hljs-string">"unused"</span></span>) <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">public</span></span></span><span class="hljs-function"> MessageToUser </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">userInfo</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">( </span></span><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-params"><span class="hljs-keyword">final</span></span></span></span><span class="hljs-function"><span class="hljs-params"> UserForm userForm )</span></span></span><span class="hljs-function"> </span></span>{ MessageToUser messageToUser = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> MessageToUser(); messageToUser.setMessage(<span class="hljs-string"><span class="hljs-string">"Hi, "</span></span> + userForm.getName() + <span class="hljs-string"><span class="hljs-string">", you are registered on our site"</span></span>); messageToUser.setUsernumber(<span class="hljs-number"><span class="hljs-number">1</span></span>); messageToUser.setIsregistered(<span class="hljs-keyword"><span class="hljs-keyword">true</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> messageToUser; } }</code> </pre><br><h1>  API web interface (APIs Explorer) </h1><br><br>  Now deploy (mvn clean install &amp;&amp; mvn appengine: update) and open in the web browser the address https: // {project ID} .appspot.com / _ah / api / explorer, in my case <a href="https://hello-habrahabr-api.appspot.com/_ah/api/explorer">hello-habrahabr-api.appspot.com / _ah / api / explorer</a> . <br><br><img src="https://habrastorage.org/getpro/habr/post_images/4d1/6a1/4a0/4d16a14a00578a76008cb1d765d15627.png"><br><br>  We click on the name of our API (if we create several classes in <a href="https://habrahabr.ru/users/api/" class="user_link">Api</a> annotation - there will be several) and see the methods contained in this API (class methods with the @ApiMethod annotation): <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b65/dcf/3ce/b65dcf3ceb3956c821c45e211fb705b8.png"><br><br>  By clicking on the field ‚ÄúRequest body‚Äù we can fill in the request data received by the api-method: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/db8/f0b/628/db8f0b62806a4689f68c630e12f91a84.png"><br><br>  Then we can choose ‚ÄúAutorize and execute‚Äù - and then we will need to pass authorization using Google account (@ gmail.com) or choose ‚ÄúExecute without OAuth‚Äù, because our API does not use authorization at all, we will see identical results with authorization and without: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/ea8/a18/ebd/ea8a18ebdaf0076bf3bcafcdeb821711.png"><br><br>  "- Show headers -" is clickable in Response. <br><br><h1>  Logging </h1><br>  Logs are available at: console.developers.google.com/project/ Your project ID} / logs. <br><br>  Settings in the /src/main/webapp/WEB-INF/logging.properties file and /src/main/webapp/WEB-INF/appengine-web.xml. <br><br>  In order for our class to issue messages to the log, you need a class API: <br><br>  one. <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> java.util.logging.Logger;</code> </pre><br>  2 <br><br><pre> <code class="java hljs"><span class="hljs-meta"><span class="hljs-meta">@SuppressWarnings</span></span>(<span class="hljs-string"><span class="hljs-string">"unused"</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">private</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> Logger LOG = Logger.getLogger({ }.class.getName());</code> </pre><br><br>  3. In the method add: <br><br><pre> <code class="java hljs">LOG.info(<span class="hljs-string"><span class="hljs-string">""</span></span>);</code> </pre><br><img src="https://habrastorage.org/getpro/habr/post_images/9d3/a2d/a72/9d3a2da7208fb8a032e4ebd234b27c71.png"><br><br><h1>  Authorize OAuth 2.0 using your google account (@ gmail.com) </h1><br>  In Constants.java add: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.api.server.spi.Constant</code> </pre><br>  and <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String API_EXPLORER_CLIENT_ID = Constant.API_EXPLORER_CLIENT_ID</code> </pre><br>  This is necessary for testing OAuth-protected API methods in APIs Explorer. <br><br>  Our Constants.java will look like this: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.appspot.hello_habrahabr_api; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.api.server.spi.Constant; <span class="hljs-comment"><span class="hljs-comment">/** * Contains the client IDs and scopes for allowed clients consuming your API. */</span></span> <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Constants</span></span></span><span class="hljs-class"> </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String WEB_CLIENT_ID = <span class="hljs-string"><span class="hljs-string">"replace this with your web client ID"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String ANDROID_CLIENT_ID = <span class="hljs-string"><span class="hljs-string">"replace this with your Android client ID"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String IOS_CLIENT_ID = <span class="hljs-string"><span class="hljs-string">"replace this with your iOS client ID"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String ANDROID_AUDIENCE = WEB_CLIENT_ID; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String EMAIL_SCOPE = <span class="hljs-string"><span class="hljs-string">"https://www.googleapis.com/auth/userinfo.email"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">public</span></span> <span class="hljs-keyword"><span class="hljs-keyword">static</span></span> <span class="hljs-keyword"><span class="hljs-keyword">final</span></span> String API_EXPLORER_CLIENT_ID = Constant.API_EXPLORER_CLIENT_ID; }</code> </pre><br>  Now create a new class: <br><br><pre> <code class="java hljs"><span class="hljs-keyword"><span class="hljs-keyword">package</span></span> com.appspot.hello_habrahabr_api; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.api.server.spi.config.Api; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.api.server.spi.config.ApiMethod; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.api.server.spi.config.ApiMethod.HttpMethod; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.api.server.spi.response.UnauthorizedException; <span class="hljs-keyword"><span class="hljs-keyword">import</span></span> com.google.appengine.api.users.User; <span class="hljs-comment"><span class="hljs-comment">// https://cloud.google.com/appengine/docs/java/javadoc/index?com/google/appengine/api/users/User.html import java.util.logging.Logger; @Api( name = "oAuth2Api", // The api name must match '[az]+[A-Za-z0-9]*' version = "v1", description = "API using OAuth2" ) public class OAuth2Api { @SuppressWarnings("unused") private static final Logger LOG = Logger.getLogger(OAuth2Api.class.getName()); @ApiMethod( name = "getUserInfo", path = "getuserinfo", httpMethod = HttpMethod.POST ) @SuppressWarnings("unused") public User getUserInfo(User user) throws UnauthorizedException { if (user == null) { LOG.warning("[warning] User not logged in"); throw new UnauthorizedException("Authorization required"); } return user; } }</span></span></code> </pre><br>  And write it in the init-param of the SystemServiceServlet servlet in web.xml: <br><br><pre> <code class="xml hljs"> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet-name</span></span></span><span class="hljs-tag">&gt;</span></span>SystemServiceServlet<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet-name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet-class</span></span></span><span class="hljs-tag">&gt;</span></span>com.google.api.server.spi.SystemServiceServlet<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet-class</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">init-param</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">param-name</span></span></span><span class="hljs-tag">&gt;</span></span>services<span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">param-name</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">param-value</span></span></span><span class="hljs-tag">&gt;</span></span> com.appspot.hello_habrahabr_api.YourFirstAPI, com.appspot.hello_habrahabr_api.OAuth2Api <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">param-value</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">init-param</span></span></span><span class="hljs-tag">&gt;</span></span> <span class="hljs-tag"><span class="hljs-tag">&lt;/</span><span class="hljs-name"><span class="hljs-tag"><span class="hljs-name">servlet</span></span></span><span class="hljs-tag">&gt;</span></span></code> </pre><br>  Deploy the project, and see API Explorer: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/e27/1b4/119/e271b41191f20dfaf4375d481e91e925.png"><br><br>  We see a new API in the list by clicking on it we see a list of its methods. <br><br>  Click on the method name: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/b75/6c1/fbb/b756c1fbb7cac2a7f3fd918c58dfb798.png"><br><br>  Now, if we click "Execute without OAuth" we get an Exception: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7e2/0da/807/7e20da8078537272e9974048a16f3ee7.png"><br><br>  If you click ‚ÄúAutorize and execute‚Äù - you need to log in using your Google account.  In Response, we get email, nickname, and userId (a unique Google user number). <br><br>  The class object com.google.appengine.api.users.User is supplied by GAE and contains information about the current user, if the user is not authorized, correspondingly null.  Thus, we can perform authorization using the Google Account login-password. <br><br>  As mentioned on Habr√© ( <a href="http://habrahabr.ru/company/pushall/blog/268267/">Sometimes less is better - why only Google authorization ?</a> , <a href="http://habrahabr.ru/post/268253/">Usability of authorization forms</a> ) a project can do without its own processing of logins and passwords. <br><br>  In my opinion, this is the right approach, primarily from a security point of view.  Naturally, we can do "registration" on the site after entering additional information, payment, etc. <br><br>  <i>Creating a frontend on AngularJS will be covered in the next article.</i> <br><br>  UPD: <br>  continued: <br>  <a href="http://habrahabr.ru/post/270459/">Google Cloud Endpoints in Java: A Guide.</a>  <a href="http://habrahabr.ru/post/270459/">Part 2 (Frontend)</a> <br>  <a href="http://habrahabr.ru/post/271385/">Google Cloud Endpoints in Java: A Guide.</a>  <a href="http://habrahabr.ru/post/271385/">part 3</a> <br>  <a href="http://habrahabr.ru/post/274239/">Working with the database in Google App Engine / Google Cloud Endpoints in Java: Objectify framework</a> <br>  <a href="http://habrahabr.ru/post/275211/">Google Cloud Storage with Java: images and other files in the clouds</a> </div><p>Source: <a href="https://habr.com/ru/post/268863/">https://habr.com/ru/post/268863/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../268851/index.html">Using readable and writable images in OpenCL 2.0</a></li>
<li><a href="../268853/index.html">Office as Platform Release 7 - Manage Office 365 and SharePoint Online via PowerShell</a></li>
<li><a href="../268855/index.html">Introducing 3CX Phone System v14 SP1 with many new features.</a></li>
<li><a href="../268857/index.html">How I monitored Avito by SMS</a></li>
<li><a href="../268859/index.html">The nuances of ESXi, FlexFabric, 10 Gbit and NFS bundles</a></li>
<li><a href="../268865/index.html">How business works with IaaS</a></li>
<li><a href="../268867/index.html">New GUI for Postgresql</a></li>
<li><a href="../268871/index.html">Composer - the right way</a></li>
<li><a href="../268875/index.html">Thoughts of a cyber-criminal: what does he look for and why has he chosen your enterprise?</a></li>
<li><a href="../268877/index.html">Thematic Cartography: Common Questions</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>