<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How to make Python functions even better</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Actually, the title of this wonderful article from Jeff Knapp (Jeff Knupp), the author of the book " Writing Idiomatic Python " fully reflects its ess...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How to make Python functions even better</h1><div class="post__text post__text-html js-mediator-article">  Actually, the title of this wonderful article from Jeff Knapp (Jeff Knupp), the author of the book " <a href="https://www.amazon.com/Writing-Idiomatic-Python-Jeff-Knupp/dp/1482374811/">Writing Idiomatic Python</a> " fully reflects its essence.  Read carefully and feel free to comment. <br><br>  Since we really didn‚Äôt want to leave an important term in the text in Latin, we allowed ourselves to translate the word ‚Äúdocstring‚Äù as ‚Äúprestring‚Äù, finding this <a href="http://slusar.su/izuchaem-python-9-funkcii/">term</a> in <a href="https://ru.hexlet.io/courses/advanced_python/lessons/python-doctest/theory_unit">several</a> <a href="https://gitter.im/allure-framework/allure-core/archives/2017/02/15">Russian-language</a> <a href="http://citforum.ru/programming/python/introspec.shtml">sources</a> . <br><a name="habracut"></a><br>  In Python, as in most modern programming languages, the function is the main method of abstraction and encapsulation.  You, being a developer, have probably written hundreds of functions.  But the functions of functions - is different.  Moreover, if you write "bad" functions, it will immediately affect readability and support for your code.  So, what is a ‚Äúbad‚Äù function, and more importantly, how to make it a ‚Äúgood‚Äù one? <br><br><h3>  Freshen up the topic </h3><br>  Mathematics is replete with functions, although it is difficult to recall them.  So let's go back to our favorite discipline: analysis.  You've probably seen formulas like <code>f(x) = 2x + 3</code> .  This is a function called <code>f</code> , which takes an argument <code>x</code> , and then "returns" twice <code>x + 3</code> .  Although it is not too similar to the functions we are used to in Python, it is completely analogous to the following code: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">f</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(x)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> <span class="hljs-number"><span class="hljs-number">2</span></span>*x + <span class="hljs-number"><span class="hljs-number">3</span></span></code> </pre> <br>  Functions have long existed in mathematics, but in computer science they are completely transformed.  However, this power is not given in vain: various pitfalls have to be passed.  Let's discuss what a ‚Äúgood‚Äù function should be, and which ‚Äúbells‚Äù are characteristic of functions that may require refactoring. <br><br><h3>  Secrets of good function </h3><br>  What distinguishes a ‚Äúgood‚Äù Python function from a mediocre one?  You will be surprised how many interpretations allow the word "good."  In this article, I will consider the Python function "good" if it satisfies <i>most of the</i> items in the following list (it is sometimes impossible to complete all items for a particular function): <br><br><ul><li>  She clearly named </li><li>  Complies with the principle of sole responsibility </li><li>  Contains dokstroka </li><li>  Returns value </li><li>  Consists of no more than 50 lines </li><li>  She is idempotent and, if possible, clean. </li></ul><br>  To many of you, these requirements may seem overly harsh.  However, I promise: if your functions comply with these rules, it will turn out so beautiful that even a unicorn will pierce a tear.  Below I will devote a section to each of the elements in the above list, and then complete the story by telling how they are in harmony with each other and help create good functions. <br><br>  <b>Naming</b> <br><br>  Here is my favorite quote on this topic, often mistakenly attributed to Donald, and actually owned by <a href="https://martinfowler.com/bliki/TwoHardThings.html">Phil Carlton</a> : <br><blockquote>  There are two difficulties in computer science: cache invalidation and naming. </blockquote>  No matter how silly it sounds, naming is really a complicated thing.  Here is an example of a ‚Äúbad‚Äù function name: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">get_knn_from_df</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(df)</span></span></span><span class="hljs-function">:</span></span></code> </pre> <br>  Now bad names come across to me almost everywhere, but this example is taken from the field of Data Science (more precisely, machine learning), where practitioners usually write code in a Jupyter notebook, and then try to assemble a digestible program from these cells. <br><br>  The first problem with the name of this function is that it uses abbreviations.  <b>It is better to use complete English words, rather than abbreviations and not well-known abbreviations</b> .  The only reason you want to shorten words is not to waste energy on typing extra text, but <i>in any modern editor there is an auto-completion function</i> , so you have to type the full name of the function just once.  The abbreviation is a problem, because it is often specific to the subject area.  In the code above, <code>knn</code> means ‚ÄúK-nearest neighbors,‚Äù and <code>df</code> means ‚ÄúDataFrame,‚Äù a data structure commonly used in the <a href="https://pandas.pydata.org/">pandas</a> library.  If the code is read by a programmer who does not know these abbreviations, he will understand almost nothing in the name of the function. <br><br>  There are two smaller faults in the name of this function.  First, the word <code>"get"</code> redundant.  In most well-named functions, it is immediately clear that this function returns something, which is specifically reflected in the name.  The <code>from_d</code> f element is also not needed.  Either in the function docstring, or (if it is on the periphery), the type of the parameter will be described in the type annotation, if this information <i>is not so obvious from the name of the parameter</i> . <br><br>  So how do we rename this function?  Simply: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">k_nearest_neighbors</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(dataframe)</span></span></span><span class="hljs-function">:</span></span></code> </pre> <br>  Now, even to a non-expert, it is clear what is calculated in this function, and the name of the parameter <code>(dataframe)</code> leaves no doubt what argument should be passed to it. <br><br><h3>  Sole responsibility </h3><br>  Developing the thought of Bob Martin, I will say that the <a href="https://ru.wikipedia.org/wiki/%25D0%259F%25D1%2580%25D0%25B8%25D0%25BD%25D1%2586%25D0%25B8%25D0%25BF_%25D0%25B5%25D0%25B4%25D0%25B8%25D0%25BD%25D1%2581%25D1%2582%25D0%25B2%25D0%25B5%25D0%25BD%25D0%25BD%25D0%25BE%25D0%25B9_%25D0%25BE%25D1%2582%25D0%25B2%25D0%25B5%25D1%2582%25D1%2581%25D1%2582%25D0%25B2%25D0%25B5%25D0%25BD%25D0%25BD%25D0%25BE%25D1%2581%25D1%2582%25D0%25B8">principle of sole responsibility</a> concerns functions no less than classes and modules (of which Mr. Martin originally wrote).  According to this principle (in our case) the function should have the sole responsibility.  That is, she must do one and only one thing.  One of the most compelling arguments in favor of this: if the function does only one thing, then it will have to be rewritten in one case: if this very thing has to be done in a new way.  It also becomes clear when the function can be removed;  if, making changes somewhere else, we realize that the only duty of the function is no longer relevant, then we will just get rid of it. <br><br>  Here it is better to give an example.  Here is a function that does more than one ‚Äúthing‚Äù: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">calculate_and</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">print_stats</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(list_of_numbers)</span></span></span><span class="hljs-function">:</span></span> sum = sum(list_of_numbers) mean = statistics.mean(list_of_numbers) median = statistics.median(list_of_numbers) mode = statistics.mode(list_of_numbers) print(<span class="hljs-string"><span class="hljs-string">'-----------------Stats-----------------'</span></span>) print(<span class="hljs-string"><span class="hljs-string">'SUM: {}'</span></span>.format(sum) print(<span class="hljs-string"><span class="hljs-string">'MEAN: {}'</span></span>.format(mean) print(<span class="hljs-string"><span class="hljs-string">'MEDIAN: {}'</span></span>.format(median) print(<span class="hljs-string"><span class="hljs-string">'MODE: {}'</span></span>.format(mode)</code> </pre> <br>  Namely two: calculates a set of statistical data about the list of numbers and outputs them to <code>STDOUT</code> .  The function violates the rule: there must be only one specific reason why it might need to be changed.  In this case, there are two obvious reasons why this will be needed: either you need to calculate new or other statistics, or you need to change the output format.  Therefore, it is better to rewrite this function as two separate functions: one will perform the calculations and return their results, and the other will accept these results and output them to the console.  <i>The function (or rather, the presence of its two duties) with the giblets gives the word <b>and</b> in its name</i> . <br><br>  Such a division also seriously simplifies the testing of a function, but also allows not only splitting it into two functions within the same module, but even spreading these two functions into completely different modules, if appropriate.  This further contributes to cleaner testing and simplifies code maintenance. <br><br>  In fact, functions that perform exactly two things are rare.  More often you come across functions that do much, much more operations.  Again, for reasons of readability and testability, such ‚Äúmulti-station‚Äù functions should be split into single-task, each of which contains a single aspect of the work. <br><br><h3>  Strings </h3><br>  It would seem that everyone is aware that there is a <a href="https://www.python.org/dev/peps/pep-0008/">PEP-8</a> document, where recommendations are made on the style of Python code, but there are much fewer among us who know <a href="https://www.python.org/dev/peps/pep-0257/">PEP-257</a> , in which the same recommendations are given about doctrines.  In order not to retell the contents of PEP-257, I refer you to this document yourself - read in your free time.  However, his main ideas are: <br><br><ul><li>  For each function, a pre-string is needed. </li><li>  It should follow grammar and punctuation;  write complete sentences </li><li>  The dstring starts with a brief (in one sentence) description of what the function does. </li><li>  The docstring is formulated in a prescriptive rather than descriptive style. </li></ul><br>  All these items are easy to follow when writing functions.  Simply writing dokstrok should become a habit, and, try to write them before proceeding to the code of the function itself.  If you are unable to write a clear document that characterizes a function, this is a good reason to wonder why you are writing this function at all. <br><br><h3>  Return values </h3><br>  Functions can (and <i>should</i> ) <i>be</i> interpreted as small self-sufficient programs.  They take some input in the form of parameters and return the result.  Parameters, of course, are optional.  <i>But return values ‚Äã‚Äãare required in terms of Python internals</i> .  If you even try to write a function that does not return values, you cannot.  If the function does not even return values, the Python interpreter will ‚Äúforce‚Äù it to return <code>None</code> .  Do not believe?  Try it yourself: <br><br><pre> <code class="python hljs">‚ùØ python3 Python <span class="hljs-number"><span class="hljs-number">3.7</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> (default, Jul <span class="hljs-number"><span class="hljs-number">23</span></span> <span class="hljs-number"><span class="hljs-number">2018</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>:<span class="hljs-number"><span class="hljs-number">22</span></span>:<span class="hljs-number"><span class="hljs-number">55</span></span>) [Clang <span class="hljs-number"><span class="hljs-number">9.1</span></span><span class="hljs-number"><span class="hljs-number">.0</span></span> (clang<span class="hljs-number"><span class="hljs-number">-902.0</span></span><span class="hljs-number"><span class="hljs-number">.39</span></span><span class="hljs-number"><span class="hljs-number">.2</span></span>)] on darwin Type <span class="hljs-string"><span class="hljs-string">"help"</span></span>, <span class="hljs-string"><span class="hljs-string">"copyright"</span></span>, <span class="hljs-string"><span class="hljs-string">"credits"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">or</span></span> <span class="hljs-string"><span class="hljs-string">"license"</span></span> <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> more information. &gt;&gt;&gt; <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">add</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(a, b)</span></span></span><span class="hljs-function">:</span></span> ... print(a + b) ... &gt;&gt;&gt; b = add(<span class="hljs-number"><span class="hljs-number">1</span></span>, <span class="hljs-number"><span class="hljs-number">2</span></span>) <span class="hljs-number"><span class="hljs-number">3</span></span> &gt;&gt;&gt; b &gt;&gt;&gt; b <span class="hljs-keyword"><span class="hljs-keyword">is</span></span> <span class="hljs-keyword"><span class="hljs-keyword">None</span></span> <span class="hljs-keyword"><span class="hljs-keyword">True</span></span></code> </pre> <br>  As you can see, the value of <code>b</code> is essentially <code>None</code> .  So, even if you write a function without a return statement, it will still return something.  And should.  After all, this is a small program, right?  How useful are the programs from which there is no conclusion - and therefore it is impossible to judge whether this program was executed correctly?  But most importantly - how are you going to <i>test</i> such a program? <br><br>  I‚Äôm not even afraid to say the following: each function must return a useful value, at least for the sake of testability.  The code I write must be tested (this is not discussed).  Just imagine how clumsy the testing of the above <code>add</code> function can turn out (hint: you will have to redirect the I / O, after which soon everything will go awry).  In addition, by returning a value, we can perform chaining of methods and, therefore, write code like this: <br><br><pre> <code class="python hljs"><span class="hljs-keyword"><span class="hljs-keyword">with</span></span> open(<span class="hljs-string"><span class="hljs-string">'foo.txt'</span></span>, <span class="hljs-string"><span class="hljs-string">'r'</span></span>) <span class="hljs-keyword"><span class="hljs-keyword">as</span></span> input_file: <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> line <span class="hljs-keyword"><span class="hljs-keyword">in</span></span> input_file: <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> line.strip().lower().endswith(<span class="hljs-string"><span class="hljs-string">'cat'</span></span>): <span class="hljs-comment"><span class="hljs-comment"># ...     - </span></span></code> </pre> <br>  The line <code>if line.strip().lower().endswith('cat'):</code> works because each of the string methods ( <code>strip()</code> , <code>lower()</code> , <code>endswith()</code> ) returns a string as a result of a function call. <br><br>  Here are some common arguments that a programmer can give you, explaining why a function written by him does not return a value: <br><blockquote>  ‚ÄúIt‚Äôs just [some kind of I / O operation, for example, storing a value in a database].  I cannot return anything useful here. ‚Äù </blockquote>  I do not agree.  The function may return True if the operation completed successfully. <br><blockquote>  "Here we change one of the available parameters, use it as a reference parameter." "" </blockquote>  Here are two comments.  First, try with all your might not to do so.  Secondly, supplying the function with any argument only in order to find out that it has changed is surprising at best, and at worst simply dangerous.  Instead, as with working with string methods, try to return a new instance of the parameter, which already reflects the changes applied to it.  Even if this cannot be done, since the creation of a copy of some parameter is associated with excessive costs, you can still roll back to the option ‚ÄúReturn <code>True</code> if the operation was completed successfully‚Äù suggested above. <br><blockquote>  ‚ÄúI need to return multiple values.  There is no such unique value that in this case it would be advisable to return. " </blockquote>  This argument is a bit contrived, but I have heard it.  The answer, of course, is just that the author wanted to do - but did not know how: <i>use a tuple to return several values</i> . <br><br>  Finally, the strongest argument in favor of the fact that it is better to return a useful value in any case ‚Äî that the caller can always ignore these values ‚Äã‚Äãwith full authority.  In short, returning a value from a function is almost certainly a sensible idea, and it is highly unlikely that we will damage anything in this way, even in established code bases. <br><br><h3>  Function length </h3><br>  I have repeatedly admitted that quite stupid.  I can simultaneously hold about three things in my head.  If you let me read the 200-line function and ask what it does, I probably will stare at it for at least 10 seconds.  <b>The length of a function directly affects its readability and, therefore, support</b> .  So try to keep your functions short.  50 lines is a value taken completely from the ceiling, but it seems reasonable to me.  (I hope) that most of the functions that you have to write will be much shorter. <br><br>  If the function complies with the principle of sole responsibility, then it is likely to be sufficiently brief.  If she is reading or idempotent (we'll talk about it) below - then, probably, she will also be short.  All these ideas are harmoniously combined with each other and help to write good, clean code. <br><br>  So what to do if your function is too long?  <b>REFACTIVE!</b>  You probably have to refactor all the time, even if you don't know the term.  <a href="https://ru.wikipedia.org/wiki/%25D0%25A0%25D0%25B5%25D1%2584%25D0%25B0%25D0%25BA%25D1%2582%25D0%25BE%25D1%2580%25D0%25B8%25D0%25BD%25D0%25B3">Refactoring</a> is simply changing the structure of a program, without changing its behavior.  Therefore, extracting several lines of code from a long function and turning them into an independent function is one of the types of refactoring.  It turns out that this is also the most common and fastest way to productively shorten long functions.  Since you give these new functions the proper names, the code you get is much easier to read.  I wrote a whole book on refactoring (in fact, I am constantly engaged in it), so I won't go into details here.  Just know that if you have too long a function, then it should be refactored. <br><br><h3>  Idempotency and functional purity </h3><br>  The title of this section may seem slightly intimidating, but conceptually the section is simple.  An idempotent function with the same set of arguments always returns the same value, no matter how many times it is called.  The result does not depend on non-local variables, the variability of the arguments, or on any data coming from the input / output streams.  The following function <code>add_three(number)</code> idempotent: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">add_three</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(number)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">""" ** + 3."""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> number + <span class="hljs-number"><span class="hljs-number">3</span></span></code> </pre> <br>  No matter how many times we call <code>add_three(7)</code> , the answer will always be 10. And here's another case ‚Äî a function that is not idempotent: <br><br><pre> <code class="python hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">add_three</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">""" 3 + ,  ."""</span></span> number = int(input(<span class="hljs-string"><span class="hljs-string">'Enter a number: '</span></span>)) <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> number + <span class="hljs-number"><span class="hljs-number">3</span></span></code> </pre> <br>  This frankly contrived function is not idempotent, since the return value of the function depends on the input / output, namely, on the number entered by the user.  Of course, with different calls to <code>add_three()</code> returned values ‚Äã‚Äãwill be different.  If we call this function twice, the user can enter 3 in the first case, and 7 in the second, and then the two <code>add_three()</code> calls return 6 and 10, respectively. <br><br>  Outside of programming, there are also examples of idempotency - for example, the ‚Äúup‚Äù button on the elevator is arranged according to this principle.  By pressing it for the first time, we ‚Äúnotify‚Äù the elevator that we want to rise.  Since the button is idempotent, then no matter how much you press it later, nothing terrible will happen.  The result will always be the same. <br><br><h3>  Why idempotency is so important </h3><br>  Testability and ease of support.  Idempotent functions are easy to test, since they are guaranteed to, in any case, return the same result if called with the same arguments.  Testing boils down to checking that with various calls the function always returns the expected value.  Moreover, these tests will be fast: the speed of tests is an important issue that is often overlooked in unit testing.  And refactoring when working with idempotent functions is generally an easy walk.  No matter how you change the code outside the function, the result of calling it with the same arguments will always be the same. <br><br><h3>  What is a ‚Äúclean‚Äù function? </h3><br>  In functional programming, a function is considered pure if it is, <i>firstly</i> , idempotent, and <i>, secondly</i> , it does not cause observable <b>side effects</b> .  Do not forget: a function is idempotent if it always returns the same result with a specific set of arguments.  However, this does not mean that the function cannot affect other components ‚Äî for example, non-local variables or input / output streams.  For example, if the idempotent version of the above function <code>add_three(number)</code> output the result to the console, and only then return it, it would still be considered idempotent, since when it accesses the I / O stream, this access operation does not affect the value returned by from function.  A <code>print()</code> call is simply a <i>side effect</i> : the interaction with the rest of the program or system itself, along with the return of the value. <br><br>  Let's develop our example with <code>add_three(number)</code> little.  You can write the following code to determine how many times <code>add_three(number)</code> was called: <br><br><pre> <code class="python hljs">add_three_calls = <span class="hljs-number"><span class="hljs-number">0</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">add_three</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(number)</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">""" ** + 3."""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">global</span></span> add_three_calls print(<span class="hljs-string"><span class="hljs-string">f'Returning </span><span class="hljs-subst"><span class="hljs-string"><span class="hljs-subst">{number + </span></span><span class="hljs-number"><span class="hljs-string"><span class="hljs-subst"><span class="hljs-number">3</span></span></span></span><span class="hljs-string"><span class="hljs-subst">}</span></span></span><span class="hljs-string">'</span></span>) add_three_calls += <span class="hljs-number"><span class="hljs-number">1</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> number + <span class="hljs-number"><span class="hljs-number">3</span></span> <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">def</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">num_calls</span></span></span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">()</span></span></span><span class="hljs-function">:</span></span> <span class="hljs-string"><span class="hljs-string">""",     *add_three*."""</span></span> <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> add_three_calls</code> </pre> <br>  Now we perform output to the console (this is a side effect) and change the non-local variable (another side effect), but since neither the one or the other does not affect the value returned by the function, it is still idempotent. <br><br>  Pure function has no side effects.  It not only does not use any "external data" when calculating the value, but does not interact with the rest of the program / system, it only calculates and returns the specified value.  Consequently, although our new definition of <code>add_three(number)</code> remains idempotent, this function is no longer pure. <br><br>  In pure functions, there are no logging instructions or <code>print()</code> calls.  When working, they do not access the database and do not use Internet connections.  Do not apply to non-local variables and do not change them.  <b>And do not cause other non-pure functions</b> . <br><br>  In short, they do not have an ‚Äúeerie long-range action‚Äù, in the words of Einstein (but in the context of informatics, not physics).  They do not in any way alter the rest of the program or system.  In <a href="https://ru.wikipedia.org/wiki/%25D0%2598%25D0%25BC%25D0%25BF%25D0%25B5%25D1%2580%25D0%25B0%25D1%2582%25D0%25B8%25D0%25B2%25D0%25BD%25D0%25BE%25D0%25B5_%25D0%25BF%25D1%2580%25D0%25BE%25D0%25B3%25D1%2580%25D0%25B0%25D0%25BC%25D0%25BC%25D0%25B8%25D1%2580%25D0%25BE%25D0%25B2%25D0%25B0%25D0%25BD%25D0%25B8%25D0%25B5">imperative programming</a> (which is what you are doing when writing code in Python), such functions are the safest.  They are known for their testability and ease of support;  Moreover, since they are idempotent, testing of such functions is guaranteed to be as fast as execution.  The tests themselves are also simple: you don‚Äôt have to connect to the database or imitate any external resources, prepare the initial configuration of the code, and you don‚Äôt need to clean anything up after the work is done. <br><br>  To be honest, idempotency and purity are very desirable, but not necessary.  ,         ,     ,     . , ,  ,    ,         .  ,        ,           . <br><br><h3>  Conclusion </h3><br>  That's all. ,     ‚Äì   .          . ,   .    ‚Äì    !          . ,  ,   ,       ¬´ ¬ª.     . </div><p>Source: <a href="https://habr.com/ru/post/426381/">https://habr.com/ru/post/426381/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../426371/index.html">Audio Digest: 17 materials and practical guides on professional acoustics</a></li>
<li><a href="../426373/index.html">Build functions in the console. Part 1</a></li>
<li><a href="../426375/index.html">Technology analysis: where to start work on the patent landscape</a></li>
<li><a href="../426377/index.html">Play using math graphs instead of graphs</a></li>
<li><a href="../426379/index.html">Deliverance from illusions</a></li>
<li><a href="../426385/index.html">Why you should not learn academic English</a></li>
<li><a href="../426387/index.html">Graphics in Julia. Strange patterns, the reflection of a triangle from a straight line and the construction of the normals of a spherical cat in a vacuum</a></li>
<li><a href="../426389/index.html">The digest of fresh materials from the world of the frontend for the last week ‚Ññ334 (October 7 - 14, 2018)</a></li>
<li><a href="../426391/index.html">PHP Digest number 141 (October 1 - 15, 2018)</a></li>
<li><a href="../426395/index.html">The duty for goods from foreign online stores will be charged at the time of purchase.</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>