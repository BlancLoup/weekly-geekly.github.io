<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How the NSA implemented a bookmark in a pseudo-random number generator</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Based on this article. 

 The NSA generator is based on elliptic curves. Do not be afraid of them, especially since the essence of the algorithm and b...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How the NSA implemented a bookmark in a pseudo-random number generator</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/aec/5b1/b83/aec5b1b83caf7a62de53637e1bec63f9.png" align="right"><br>  Based on <a href="http://habrahabr.ru/post/200686/">this</a> article. <br><br>  The NSA generator is based on elliptic curves.  Do not be afraid of them, especially since the essence of the algorithm and bookmarks can be described in simpler words.  It will be no more difficult than to understand how the <a href="http://ru.wikipedia.org/wiki/%25D0%259F%25D1%2580%25D0%25BE%25D1%2582%25D0%25BE%25D0%25BA%25D0%25BE%25D0%25BB_%25D0%2594%25D0%25B8%25D1%2584%25D1%2584%25D0%25B8_%25E2%2580%2594_%25D0%25A5%25D0%25B5%25D0%25BB%25D0%25BB%25D0%25BC%25D0%25B0%25D0%25BD%25D0%25B0">Diffie - Hellman</a> protocol works. <br><a name="habracut"></a><br><br><br clear="all"><h4>  Algorithm </h4>  (translation of <a href="http://crypto.stackexchange.com/questions/10417/explaining-weakness-of-dual-ec-drbg-to-wider-audience">this</a> material) <br><ol><li>  It suggests that we take a prime number <b>p</b> and two numbers <b>g</b> , <b>h</b> which are both less than <b>p</b> . </li><li>  Tells us that his state at any time can be described by a positive number <b>s</b> less than <b>p</b> </li><li>  To execute one step of the algorithm, you need to set <b>r = g <sup>s</sup> (mod <i>p</i> )</b> , <b>s ‚Ä≤ = g <sup>r</sup> (mod <i>p</i> )</b> </li><li>  The current state is set to <b>s ‚Ä≤</b> </li><li>  The output of the algorithm is <b>t = h <sup>r</sup> (mod <i>p</i> )</b> </li></ol>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h4>  Bookmark </h4><br><br>  A bookmark is a secret number <b>e</b> such that <b>g = h <sup>e</sup> (mod <i>p</i> )</b> . <br>  The NSA, which developed the algorithm, chose the numbers <b>g</b> <b>h</b> by generating random <b>h</b> and <b>e</b> and setting <b>g = h <sup>e</sup> (mod <i>p</i> )</b> .  and then publishing <b>g, h, p</b> but keeping <b><i>e</i></b> . <br><br><h4>  How to use the bookmark </h4><br><br>  Suppose the NSA has learned one of the states <b>t of the</b> generator.  This may be, for example, an <a href="http://en.wikipedia.org/wiki/Initialization_vector">IV</a> symmetric algorithm that is transmitted over an open channel.  Or salt. <br>  And now focus pokus <br><br>  <b>t</b> <sup>e</sup> = (h <sup>r</sup> ) <sup>e</sup> = h <sup>re</sup> = (h <sup>e</sup> ) <sup>r</sup> = g <sup>r</sup> = <b>s ‚Ä≤</b> (mod <i>p</i> ). <br><br>  and <b>s ‚Ä≤</b> is the next state of the algorithm.  Q.E.D. <br><br>  Such pies. <br><br>  In the original, P is a curve, G, H are two points.  The modular exponentiation operation is replaced by multiplication </div><p>Source: <a href="https://habr.com/ru/post/200858/">https://habr.com/ru/post/200858/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../200846/index.html">The long Gantt road in TeamLab Office. The story from the first persons</a></li>
<li><a href="../200850/index.html">ShotSpotter: Acoustic Surveillance System in Washington, DC localized 39,000 shots since 2006</a></li>
<li><a href="../200852/index.html">Remote debugging of web applications in the cloud with Visual Studio 2013</a></li>
<li><a href="../200854/index.html">We study netfilter: we write our match-module based on xt_string to search for several patterns</a></li>
<li><a href="../200856/index.html">India launched a satellite into Mars orbit</a></li>
<li><a href="../200866/index.html">Advanced chat on Node.JS</a></li>
<li><a href="../200868/index.html">SRVCC technology in 4th generation mobile networks</a></li>
<li><a href="../200870/index.html">RabbitMQ tutorial 3 - Publish / Subscribe</a></li>
<li><a href="../200872/index.html">Integration of LMS Moodle and Microsoft Active Directory. Part 1</a></li>
<li><a href="../200874/index.html">Immersive Mode (dive mode) in Android 4.4 KitKat</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>