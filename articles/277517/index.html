<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>How I transferred the working Ubuntu MATE 14.04 system to a new SSD disk</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Somehow, while working, I noticed that my personal laptop on the i5, with 8 gigabytes of RAM on Linux, is inferior to the service, less powerful, "hor...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>How I transferred the working Ubuntu MATE 14.04 system to a new SSD disk</h1><div class="post__text post__text-html js-mediator-article">  Somehow, while working, I noticed that my personal laptop on the i5, with 8 gigabytes of RAM on Linux, is inferior to the service, less powerful, "horse." <br><br>  It was decided to make a ‚Äúknight's move‚Äù: instead of the old SATA HDD, a new SSD was purchased.  Admins are essentially lazy creatures, and I was no exception.  Remembering everything that was done anew, building up your working environment, did not want to say anything at all, and transferring the operating system was the least trouble-free option in my case.  So let's get started. <br><a name="habracut"></a><br>  In the laptop, through the adapter controller in the DVD-drive slot, a second new 60 GB SSD-drive was installed, defined in the system as / dev / sdb. <br><br>  On the old 320 GB HDD / dev / sda disk there were three sections: / dev / sda1 (swap - previously disabled), / dev / sda2 (/ root partition), / dev / sda3 (/ home).  <b>The total volume of all data on all sections occupied about 50 GB.</b> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Booted into LiveUSB mode, on Ubuntu MATE 14.04 with usb-stick.  Gparted created the sdb1 partition on the SSD disk.  Flags are not set.  Enter privileged root mode: <br><br><pre><code class="hljs matlab">sudo -<span class="hljs-built_in"><span class="hljs-built_in">i</span></span></code> </pre> <br>  Check if there is support for TRIM: <br><br><pre> <code class="hljs perl">hdparm -I /dev/sdb | <span class="hljs-keyword"><span class="hljs-keyword">grep</span></span> -i trim</code> </pre><br>  * Data Set Management TRIM supported (limit 1 block). <br><br>  The listing output means that TRIM support is and is active. <br><br>  Check the alignment of sections: <br><br><pre> <code class="hljs pgsql">parted /dev/sdb align-<span class="hljs-keyword"><span class="hljs-keyword">check</span></span> opt <span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre><br>  If 1 is aligned or 1 aligned, then everything is fine. <br><br>  Create mount point directories: <br><br><pre> <code class="hljs dos"><span class="hljs-built_in"><span class="hljs-built_in">mkdir</span></span> /mnt/{sda2,sda3,sdb1}</code> </pre><br>  We mount the necessary sections: <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">mount</span></span> /dev/sdb1 /mnt/sdb1 mount /dev/sda2 /mnt/sda2</code> </pre><br>  We transfer, synchronizing data from the root partition: <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">rsync</span></span> -qaHEAXh /mnt/sda2/* /mnt/sdb1</code> </pre><br>  Where: <br>  -q - reduce the level of details <br>  -a - archive mode <br>  -H - keep hard links <br>  -E - save file executables <br>  -A - save ACLs <br>  -X - save extended attributes <br>  -h - output numbers in an easily perceived format <br><br>  Mount the partition with the user directory and also transfer data from it: <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">mount</span></span> /dev/sda3 /mnt/sda3 rsync -qaHEAXh /mnt/sda3/* /mnt/sdb1/home</code> </pre><br>  For greater safety from random errors, unmount the partitions of the original HDD disk: <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">umount</span></span> /mnt/sda2 umount /mnt/sda3</code> </pre><br>  Mount the file systems of the native OS to which the data was transferred: <br><br><pre> <code class="hljs perl">mount --<span class="hljs-keyword"><span class="hljs-keyword">bind</span></span> /proc /mnt/sdb1/proc mount --<span class="hljs-keyword"><span class="hljs-keyword">bind</span></span> /dev /mnt/sdb1/dev mount --<span class="hljs-keyword"><span class="hljs-keyword">bind</span></span> /sys /mnt/sdb1/sys</code> </pre><br>  Use the chroot operation to change the working root directory to the one into which we transfer data: <br><br><pre> <code class="hljs perl"><span class="hljs-keyword"><span class="hljs-keyword">chroot</span></span> /mnt/sdb1</code> </pre><br>  Back up one of the configuration files with information about file systems: <br><br><pre> <code class="hljs">cp /etc/fstab{,.bak}</code> </pre><br>  Add the current UUID of the sdb1 partition to fstab: <br><br><pre> <code class="hljs pgsql">ls -l /dev/disk/<span class="hljs-keyword"><span class="hljs-keyword">by</span></span>-<span class="hljs-type"><span class="hljs-type">uuid</span></span> |grep sdb &gt;&gt; /etc/fstab</code> </pre><br>  Editing fstab: <br><br><pre> <code class="hljs nginx"><span class="hljs-attribute"><span class="hljs-attribute">nano</span></span> /etc/fstab</code> </pre><br>  And we bring it to an approximate form: <br><br>  # / was on / dev / sdb1 during installation <br>  UUID = c45939b4-3a58-4873-aa6e-247746hgftb5 / ext4 errors = remount-ro 0 1 <br><br>  where UUID = sdb1 value <br><br>  Update the Linux bootloader configuration file: <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">update</span></span>-grub</code> </pre><br>  Check whether the UUID values ‚Äã‚Äãof the section are set correctly in the grub.cfg configuration file: <br><br><pre> <code class="hljs pgsql">cat /boot/grub/grub.cfg | grep ¬´<span class="hljs-type"><span class="hljs-type">uuid</span></span> sda2¬ª</code> </pre><br>  where instead of ‚Äúuuid sda2‚Äù substitute your uuid partition value.  I still have the old values, therefore: <br><br>  Exit the chroot: <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">exit</span></span></code> </pre><br>  Unmount the file systems: <br><br><pre> <code class="hljs mel">umount /mnt/sdb1/sys umount /mnt/sdb1/dev umount /mnt/sdb1/<span class="hljs-keyword"><span class="hljs-keyword">proc</span></span></code> </pre><br>  In grub.cfg, we change all the old uuid values ‚Äã‚Äãof the sda2 partition to the new uuid values ‚Äã‚Äãof the sdb1 partition.  It was easier for me to do this.  You can do it your way. <br><br>  We put the mysql server, in which there is the replace utility (any password, the same one, is not useful): <br><br><pre> <code class="hljs pgsql">apt-<span class="hljs-keyword"><span class="hljs-keyword">get</span></span> install mysql-<span class="hljs-keyword"><span class="hljs-keyword">server</span></span><span class="hljs-number"><span class="hljs-number">-5.5</span></span></code> </pre><br>  Change UUIDs: <br><br><pre> <code class="hljs sql"><span class="hljs-keyword"><span class="hljs-keyword">replace</span></span> <span class="hljs-string"><span class="hljs-string">'old_uuid'</span></span> <span class="hljs-string"><span class="hljs-string">'new_uuid'</span></span> <span class="hljs-comment"><span class="hljs-comment">-- /mnt/sdb1/boot/grub/grub.cfg</span></span></code> </pre><br>  where old_uuid and new_uuid, old and new values ‚Äã‚Äãrespectively. <br><br>  Check if the values ‚Äã‚Äãhave changed in grub.cfg: <br><br><pre> <code class="hljs pgsql">cat /mnt/sdb1/boot/grub/grub.cfg | grep ¬´<span class="hljs-type"><span class="hljs-type">uuid</span></span> sdb1¬ª</code> </pre><br>  Re-mount file systems and chroot-name: <br><br><pre> <code class="hljs perl">mount --<span class="hljs-keyword"><span class="hljs-keyword">bind</span></span> /proc /mnt/sdb1/proc mount --<span class="hljs-keyword"><span class="hljs-keyword">bind</span></span> /dev /mnt/sdb1/dev mount --<span class="hljs-keyword"><span class="hljs-keyword">bind</span></span> /sys /mnt/sdb1/sys <span class="hljs-keyword"><span class="hljs-keyword">chroot</span></span> /mnt/sdb1</code> </pre><br>  Install the bootloader on sdb itself: <br><br><pre> <code class="hljs sql">grub-<span class="hljs-keyword"><span class="hljs-keyword">install</span></span> /dev/sdb</code> </pre><br>  Exit the chroot: <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">exit</span></span></code> </pre><br>  Unmount everything mounted: <br><br><pre> <code class="hljs mel">umount /mnt/sdb1/sys umount /mnt/sdb1/dev umount /mnt/sdb1/<span class="hljs-keyword"><span class="hljs-keyword">proc</span></span> umount /mnt/sdb1</code> </pre><br>  Exit from root privileged mode: <br><br><pre> <code class="hljs pgsql"><span class="hljs-keyword"><span class="hljs-keyword">exit</span></span></code> </pre><br>  Reboot to the new system.  When rebooting into the BIOS, do not forget to select and install the boot from the new device. </div><p>Source: <a href="https://habr.com/ru/post/277517/">https://habr.com/ru/post/277517/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../277505/index.html">9 secrets of online payments. Part 2: regular payments</a></li>
<li><a href="../277509/index.html">Material on working with Apache Lucene and creating a simple fuzzy search</a></li>
<li><a href="../277511/index.html">List of machine learning resources. Part 1</a></li>
<li><a href="../277513/index.html">Rip network dictionaries using Node.js, part 2: dynamic pages; connect nw.js</a></li>
<li><a href="../277515/index.html">Creating a system of placing objects by level using the blueprint editor</a></li>
<li><a href="../277519/index.html">About MongoDB Online University</a></li>
<li><a href="../277521/index.html">Setting Safebrowsing from Yandex to Firefox</a></li>
<li><a href="../277525/index.html">Bidirectional rendering with diacritics support</a></li>
<li><a href="../277527/index.html">The benefits of big data technology in everyday life</a></li>
<li><a href="../277529/index.html">Fake Novella: a small game, the development of which taught me a lot and another ban from Google</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>