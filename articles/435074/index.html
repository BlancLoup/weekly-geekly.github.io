<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Vulnerabilities of Kyivstar: 1) analysis of the previous post about passwords + 2) info about purchases passing through the services of Kyivstar</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hey. I am the one who six months ago received the logins and passwords of Kyivstar from such important services as: JIRA, Amazon Web Services, Apple D...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Vulnerabilities of Kyivstar: 1) analysis of the previous post about passwords + 2) info about purchases passing through the services of Kyivstar</h1><div class="post__text post__text-html js-mediator-article">  Hey.  I am the one who six months ago received the logins and passwords of Kyivstar from such important services as: JIRA, Amazon Web Services, Apple Developer, Google Developer, Bitbucket and many others, wrote them through Bug Bounty and received <s><abbr title="$ 50 I did not take">$ 50</abbr></s> various comments on the repost of my publication . <br><br>  For example: <br><br><ul><li>  Actually, Habr, 33 thousand views, 188 comments: <a href="https://habr.com/post/418591/">Bug Bounty Kyivstar: a reward for admin access to Jira, AWS, Apple, Google Developer, Bitbucket services - $ 50</a> </li><li>  AIN.UA, 12 thousand views: <a href="https://ain.ua/2018/07/31/kyivstar-bug-bounty/">Tester got access to Kyivstar corporate services.</a>  <a href="https://ain.ua/2018/07/31/kyivstar-bug-bounty/">He was offered only $ 50</a> </li><li>  ITC.ua, 350 comments: <a href="https://itc.ua/news/kievstar-zaplatil-polzovatelyu-50-za-naydennyie-paroli-k-korporativnyim-sistemam-tot-ostalsya-nedovolen/">Kyivstar offered the user $ 50 for the found passwords to corporate systems, he was not satisfied</a> </li><li>  Ebanoe.IT, 26 thousand views, 169 comments: <a href="https://ebanoe.it/2018/08/08/hacker-per-50-dollars/">Hacker was given a handout of $ 50 for a found vulnerability in Kyivstar</a> </li></ul><br>  Thank you for your support and comments!  Voting results: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/webt/nw/td/td/nwtdtdkdwdmjmbufp36mqgtod9q.png"><br><a name="habracut"></a><br>  For some reason I did not respond to some comments, but I cannot but answer now. <br><br>  Let me remind you that I accidentally received a letter with bookmarks from the Kyivstar employee‚Äôs working browser.  I opened all 113 bookmarks in turn and found a file with the names of services, logins and passwords, and other information among them.  Yes, the file was on Google Docs with ‚ÄúFor All‚Äù access rights. <br><br><div class="spoiler">  <b class="spoiler_title">I had concerns in their future reaction to the report, so</b> <div class="spoiler_text">  First, I told Bugcrowd to urgently change their passwords.  I was told that they know about indexing files from a post on <a href="https://habr.com/post/416219">Habr√©</a> and have already closed such files everywhere. <br><br>  I indicated that they had not closed, and sent screenshots, where it is clear that I could enter randomly into their accounts. <br><br>  Then I was asked how I received such data, and I indicated how (received by e-mail). <br><br>  Then they asked how I could receive such an e-mail - and I replied that I was lucky, or simply the employee was sealed when she sent the bookmarks to herself (as it turned out). <br><br>  During the correspondence, my signal was assigned the highest priority - P1 (Sensitive Data Exposure: Critically Sensitive Data - Password Disclosure), within which payments range from $ 1000 to $ 3000 (and you can also add Mobile + WEB apps). <br><br><img src="https://habrastorage.org/webt/su/q8/x8/suq8x8-d_ugsnghp1ga50wna6s8.png" alt="image"><br>  Well, then you know. <br></div></div><br>  When my colleague Yegor Papyshev shared his <a href="https://www.facebook.com/photo.php%3Ffbid%3D984002965103065%26set%3Da.296052180564817%26type%3D3%26permPage%3D1">opinion</a> on Facebook, it was unpleasant to hear how another respected person (Vladimir Styran, information security specialist - CISSP, CISA, OSCP, CEH), was negatively disposed to the situation, and wrote to Egor that he was not knows the details and did not understand the situation. <br><br>  At the same time, Vladimir himself did not understand the situation.  Here is his mocking post: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/facebook.com/connect/xd_arbiter/r/vy-MhgbfL4v.js?version=44#channel=f39757118521754&amp;origin=https" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br><br>  I will translate and comment on the last few points: <br><br><ul><li>  <i>If you do not know that the support of the broker, through which you told the vendor a bug, could actually appeal against the amount of the payment, because in general this is one of his roles in your trilateral relations, this is called lohanut.</i>  - The support Bugcrowd in correspondence with me has repeatedly supported my opinion and the opinion of the majority that Kyivstar is wrong and should have paid more.  "Broker" could not affect the operator.  And I was not stuck here. </li><li>  <i>If you begin to threaten the vendor of Full Disclosure in the event of no increase in payments, this is called extortion or blackmail.</i>  <i>But most likely it will be called extortion, because there is no article for blackmail in the code.</i>  - There was no blackmail and extortion.  There was no threat.  Vladimir would have known about this if he had read that report.  That is characteristic, my account on Bugcrowd was blocked (it is not scary) not immediately after the post on Habr√©, but about a week later, just at the same time as his other caustic post in FB. </li><li>  <i>If you don't have a bug, you read about it on Habr√©, you told about it on your Facebook page to get N likes and + M followers, then you are a blogger and there is nothing to be proud of.</i>  - There is nothing to add. </li></ul><br>  However, as I know, Vladimir participated in the launch of the Bug Bounty company Kyivstar, so I admit that he has a blurred eye. <br><br>  Go ahead.  A simple example: Apple Developer, you saw screenshots of their console in my post. <br>  In the file with passwords there were still lines and columns, and specifically Apple indicated the following: Last modified - 05/18/2016. <br><br>  Those.  The last time the Apple developer account data was edited back in May of 2016, more than a year before I received the letter and found the link in it.  Which, again, is confirmed by the fact that I was able to log in with the specified password. <br><br>  Thus, speaking of the security of business processes in Kyivstar, we can summarize: <br><br><ul><li>  moreover, logins and passwords were stored (or stored?) on an external shared Google Docs resource with ‚ÄúFor all‚Äù access rights, </li><li>  not only does not require two-factor authentication for entry, </li><li>  not only that many passwords were dictionary and easily selectable and looked like (changed) upsups92, suchapassword, DigitTeam2017, Digital2016, Kyivstardigteam2017, ks-anya $ bd2016, KSDigit2018, </li><li>  so these passwords have not changed yet for more than a year. </li></ul><br>  What else.  Many did not understand why such a strange amount of $ 5,800 was indicated, why not exactly $ 6,000 exactly, why not just a million dollars?  ‚ÄúIn his opinion, only the official cost of accounts exceeds $ 5,800.‚Äù <br><br>  The answer to this question was from the very beginning on Habr√©, they simply did not notice it: <br><br><blockquote> <a href=""><img src="https://habrastorage.org/webt/fm/0q/c8/fm0qc8hw5bbxyflrmt0rsd0wfmm.png"></a> <br>  <i>(to enlarge the image, open it in a new tab)</i> </blockquote><br>  The key here is " <b>open it in a new tab</b> " - when you click on the image ( <a href="">direct link</a> ), the full picture opens, where other columns are also visible: Last modified, Paid till (date), Need till (date), Project (as in ASUP), Type of payment, Cost, Currency. <br><br>  By simply summing up the numbers from the ‚ÄúCost‚Äù column, I obtained a figure of $ 5800 - this is the official (and not the cost I‚Äôve thought of) accounts in the listed services, which I indicated in the report on Bugcrowd. <br><br>  I didn‚Äôt ask or demand this amount, or any other amount, as <a href="https://habr.com/users/soultan/" class="user_link">Soultan did</a> then, but compared their indicated reward of $ 50 with the <u>minimum</u> possible damage - simply speaking, with the loss of access to services, for the purchase of which they spent&gt; $ 5800. <br><br>  Further. <br><br><blockquote>  If anyone is interested, not so long ago, the Kyivstar BugBounty program was closed completely (not a private mode, but it was closed), and an employee of Soultan, who responded to comments here, recently left Kyivstar. <br><br>  By the way, in the comments under his farewell record of leaving the company he writes ‚ÄúGood luck, Vitaly!‚Äù An employee, who sent that ill-fated e-mail.  So it goes. </blockquote><br>  I added the information outlined above with a small update to the original post.  I do not gloat over this.  They made a mistake then - perhaps they are paying the price. <br><br>  <a href="https://habr.com/users/pyrk2142/" class="user_link">pyrk2142</a> in the comments <a href="https://habr.com/post/418591/">asked</a> : <br><blockquote>  This is quite unexpected.  It turns out that the information <a href="https://kyivstar.ua/ru/bugbounty">is</a> no longer relevant here? </blockquote><br>  And now I can say that yes, the information on Bug Bounty Kyivstar is irrelevant: I found the opportunity to receive information about the purchases of people passing through Kyivstar payment services, even if they are not its customers.  <b>I gave the company a second chance - but she did not use it</b> . <br><br>  So, the info about purchases passing through Kyivstar services, using even non-customer‚Äôs cards. <br><br>  During testing of an application by one company, I discovered that Kyivstar acts as a payment provider in the framework of cooperation with Visa QR Payments - mVisa - payments using a QR code go through <a href="https://qrpayments.kyivstar.ua/">qrpayments.kyivstar.ua</a> . <br><br>  These are transactions of clients in such points of sale, as, for example: <br><br><ul><li>  Crema Caffe, Kyiv, </li><li>  Smachno, Kyiv, </li><li>  Third Floor Cafe, Kyiv - the first and most often operations were here.  Apparently, this is a cafe on the 3rd floor in the Kyivstar office, where they started testing QR payments; </li><li>  Auchan, Kyev, </li><li>  Auchan, Lviv, </li><li>  Auchan, Dnipropetrovska - Auchan hypermarket chain (Ukraine); </li><li>  mVisa merchant; </li><li>  GIVC, Kiev - Main Information and Information Center, Main Information and Computing Center, Kiev.  Here there are accruals and payments for the majority of utility payments of residents of Kiev; </li><li>  GERC, Odesa - GERC, City Single Settlement Center, Odessa.  Similar to the GIVTS above, only the coverage is even greater: the site is intended not only for the population of Odessa, but also for such cities as: Kiev, Belgorod-Dniester, Reni, Chernomorsk and Yuzhny; </li><li>  and so forth </li></ul><br>  An example of the data obtained: <br><br><pre><code class="json hljs">{<span class="hljs-attr"><span class="hljs-attr">"Id"</span></span>:<span class="hljs-number"><span class="hljs-number">1305</span></span> Date:<span class="hljs-string"><span class="hljs-string">"2018-10-05T15:15:42.3921295"</span></span> State:<span class="hljs-number"><span class="hljs-number">0</span></span> Amount:<span class="hljs-number"><span class="hljs-number">-1278.8100</span></span> TipsAmount:<span class="hljs-number"><span class="hljs-number">0.0000</span></span> Currency:<span class="hljs-string"><span class="hljs-string">"UAH"</span></span> MerchantName:<span class="hljs-string"><span class="hljs-string">"Auchan"</span></span> MerchantCity:<span class="hljs-string"><span class="hljs-string">"Lviv"</span></span> MerchantId:<span class="hljs-string"><span class="hljs-string">"4109499405597549"</span></span> ApprovalCode:<span class="hljs-string"><span class="hljs-string">"516634"</span></span> ReferenceNumber:<span class="hljs-string"><span class="hljs-string">""</span></span> CardNumber:<span class="hljs-string"><span class="hljs-string">"5375XXXXXXXX3858"</span></span>} {<span class="hljs-attr"><span class="hljs-attr">"Id"</span></span>:<span class="hljs-number"><span class="hljs-number">1308</span></span> Date:<span class="hljs-string"><span class="hljs-string">"2018-10-06T12:43:31.1179667"</span></span> State:<span class="hljs-number"><span class="hljs-number">3</span></span> Amount:<span class="hljs-number"><span class="hljs-number">-4192.9700</span></span> TipsAmount:<span class="hljs-number"><span class="hljs-number">0.0000</span></span> Currency:<span class="hljs-string"><span class="hljs-string">"UAH"</span></span> MerchantName:<span class="hljs-string"><span class="hljs-string">"Auchan"</span></span> MerchantCity:<span class="hljs-string"><span class="hljs-string">"Kyev"</span></span> MerchantId:<span class="hljs-string"><span class="hljs-string">"4109494835704666"</span></span> ApprovalCode:<span class="hljs-string"><span class="hljs-string">""</span></span> ReferenceNumber:<span class="hljs-string"><span class="hljs-string">"827991150697"</span></span> CardNumber:<span class="hljs-string"><span class="hljs-string">"4824XXXXXXXX6937"</span></span>} {<span class="hljs-attr"><span class="hljs-attr">"Id"</span></span>:<span class="hljs-number"><span class="hljs-number">1702</span></span> Date:<span class="hljs-string"><span class="hljs-string">"2018-12-06T18:40:02.657213"</span></span> State:<span class="hljs-number"><span class="hljs-number">3</span></span> Amount:<span class="hljs-number"><span class="hljs-number">-81.0000</span></span> TipsAmount:<span class="hljs-number"><span class="hljs-number">0.0000</span></span> Currency:<span class="hljs-string"><span class="hljs-string">"UAH"</span></span> MerchantName:<span class="hljs-string"><span class="hljs-string">"GIVC"</span></span> MerchantCity:<span class="hljs-string"><span class="hljs-string">"Kiev"</span></span> MerchantId:<span class="hljs-string"><span class="hljs-string">"4109499632222754"</span></span> ApprovalCode:<span class="hljs-string"><span class="hljs-string">"605231"</span></span> ReferenceNumber:<span class="hljs-string"><span class="hljs-string">"834091189417"</span></span> CardNumber:<span class="hljs-string"><span class="hljs-string">"5168XXXXXXXX9997"</span></span>}</code> </pre> <br>  The service responded to requests only with the correct "Authorization" and "Map-AuthToken", the last of which contained those encoded in Base64 <code>{"alg":"RS256","kid":"33E283272B0433E283281FF404CA6F031E28320","typ":"JWT"}{"http://schemas.xmlsoap.org/ws/2005/05/identity/claims/mobilephone":"0800300466", "http://schemas.lime-systems.com/identity/claims/authId":"1199333", "http://schemas.lime-systems.com/identity/claims/userId":"25046", "http://schemas.lime-systems.com/identity/claims/deviceId":"12342", "nbf":1541370000, "exp":1541380001, "iat":1541390001, "iss":"http://localhost", "aud":"http://localhost"}</code> and other data. <br><br>  But despite the need for the request to have the correct parameters specified above, once having received the Map-AuthToken, then it was possible to perform GET requests to the address of the form <a href="https://qrpayments.kyivstar.ua/map/api/consumers/">https://qrpayments.kyivstar.ua/map/api/consumers/</a> many times. <br><br>  And although in the period since the launch, April 16, 2017, not many operations have been carried out (~ 2000 pieces) and the data obtained themselves are not critical, this situation is alarming: <br>  even if you do not use Kyivstar, but simply pay at the <s>U Uchan</s> store with a <b>B</b> <s>ank</s> bank card, hackers can hack the <s>K</s> <b>C</b> provider and get information about you. <br><br>  In the field of payment cards, there is a situation that fits the description: a single point of compromise - this could be a terminal, an ATM, a trading company, an acquirer, a processing center through which there were thefts from different cards of different customers. <br><br>  Transferring the situation to this mobile operator: hacking one service, you can get information from several. <br><br><hr><br>  Before publishing this material, I gave Kievstar a second chance - I sent three letters to bounty@kyivstar.net, which is listed on their <a href="https://kyivstar.ua/ru/bugbounty">special page</a> : December 17th, December 20th and December 27th, all working days. <br><br>  I sent, just in case, from a box that was not specified in a situation with leaked passwords.  Letters received, but no feedback, even an automatic response, was not followed. <br><br>  As you understand, the vulnerability is not covered, so I can‚Äôt give more details.  However, everything is clear. <br><br><img src="https://habrastorage.org/webt/mu/by/mi/mubymis2rkzw5mhfwlviucfin9a.png"></div><p>Source: <a href="https://habr.com/ru/post/435074/">https://habr.com/ru/post/435074/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../435060/index.html">2018 was the year of the scooter. What's next?</a></li>
<li><a href="../435062/index.html">Guide: Thymeleaf + Spring. Part 1</a></li>
<li><a href="../435064/index.html">Ride on Xiaomi Vacuum Cleaner</a></li>
<li><a href="../435070/index.html">Introduction to Layer 3 Firewall MikroTik</a></li>
<li><a href="../435072/index.html">8-bit analog memory for working with neural networks</a></li>
<li><a href="../435076/index.html">How marketers working with Google monetize our discomfort</a></li>
<li><a href="../435078/index.html">What if artificial intelligence makes actors immortal?</a></li>
<li><a href="../435080/index.html">Guide: Thymeleaf + Spring. Part 2</a></li>
<li><a href="../435082/index.html">Silicon Valley Yoda</a></li>
<li><a href="../435084/index.html">How to work with async / await in JavaScript cycles</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>