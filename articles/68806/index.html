<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Doctrine and sorting for many-to-one communication</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="For a long time I have been using a bunch of Zend Framework and Doctrine and there was a lack of sorting for the collections obtained by the link. It ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Doctrine and sorting for many-to-one communication</h1><div class="post__text post__text-html js-mediator-article">  For a long time I have been using a bunch of Zend Framework and Doctrine and there was a lack of sorting for the collections obtained by the link.  It turned out that it is easy to implement. <br><br>  Later in one of the projects created by the company in which I work, a similar method was found, but, alas, it was not clear whether it was leaked from the Doctrine developers or was created in the depths of my team.  Confused by the fact that the code snippet found was written for a DBMS that is not used in our company. <a name="habracut"></a><br><br>  All manipulations were made on version 1.1.3, but should bear fruit when using earlier versions of Doctrine. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      The method is to edit a single file.  Yes, making modifications to the code of a third-party library is not good, but, unfortunately, at the moment there is no other way out.  Or was I looking bad? <br><br>  Open the Doctrine / Relation.php file and find the place to describe the array of definitions: <br><br><blockquote>  protected $ definition = array (...); <br></blockquote><br>  Add another key / value pair: <br><br><blockquote>  'order' =&gt; null, <br></blockquote><br>  This is necessary due to the fact that Doctrine, on the basis of this array, makes a list of definitions passed to its classes specified during the formation of links. <br><br>  We find the definition of the getRelationDql function and add the code to implement sorting.  Thus, the function will be as follows: <br><br><blockquote><pre> public function getRelationDql ($ count)
 {
     $ component = $ this-&gt; getTable () -&gt; getComponentName ();

     $ dql = 'FROM'.  $ component
           .  'WHERE'.  $ component.  '.'  .  $ this-&gt; definition ['foreign']
           .  'IN ('. Substr (str_repeat ('?,', $ count), 0, -2). ')';

     if (! empty ($ this-&gt; definition ['order']))
     {
         $ dql. = 'ORDER BY'.  $ this-&gt; definition ['order'];
     }

     return $ dql;
 }
</pre></blockquote><br>  Those.  we indicate the need for sorting in case it is defined in the link description.  It is in this code fragment that ORDER BY can take other forms for different SQL dialects. <br><br>  It remains to define the relationship to specify the sort: <br><br><blockquote>  $ this-&gt; hasMany ('Products', array ('local' =&gt; 'id', 'foreign' =&gt; 'category_id', 'order' =&gt; 'position desc')); <br></blockquote><br>  Thus, the collections are sorted for the connection of many to one, which was what was required to receive.  I hope that the article will be useful to someone. </div><p>Source: <a href="https://habr.com/ru/post/68806/">https://habr.com/ru/post/68806/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../68796/index.html">Unobvious feature in variable syntax</a></li>
<li><a href="../68797/index.html">Biztimes - business magazine for entrepreneurs</a></li>
<li><a href="../68799/index.html">Skype <-> SIP gateway for SIPNET users</a></li>
<li><a href="../68802/index.html">Here are the three main sauces of media professionals. Which one do you prefer?</a></li>
<li><a href="../68805/index.html">Home server: Zotac IONITX-A and CFI-A8989 chassis</a></li>
<li><a href="../68807/index.html">VKontakte bought VK.COM domain and starts the extension to the west</a></li>
<li><a href="../68808/index.html">Who owns the Runet? 2 schemes from Kommersant</a></li>
<li><a href="../68812/index.html">UFO flew to Google ...</a></li>
<li><a href="../68813/index.html">Mozilla Test Pilot's first test</a></li>
<li><a href="../68816/index.html">Fulfillment of assigned tasks</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>