<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Mouse Wheel Speed ‚Äã‚ÄãCounter</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="I must say that the post about the wheel speed counter squirrel I have already read. I had a similar task for a long time - it was curious how much my...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Mouse Wheel Speed ‚Äã‚ÄãCounter</h1><div class="post__text post__text-html js-mediator-article">  I must say that the post about <a href="http://habrahabr.ru/post/159177/">the wheel speed counter squirrel</a> I have already read.  I had a similar task for a long time - it was curious how much my little mouse (normal, live, not computer!) Runs and with what speed. <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/90d/847/904/90d847904c29ee550b88ad65e48af20e.jpg" alt="image"><br><br>  Only I decided not to reinvent the wheel and took the old unnecessary speedometer from the bike, which ideally performs these functions. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      For a month, the mouse ran for about 100 km, but I wanted to know in detail - how many exactly did he run on each of the days, at what time of the day is he more active, how does his activity change during his life?  The speed I was already slightly worried - it is almost always 1-1.5 km / h.  Typical pointless, but interesting task, as I like. <br><a name="habracut"></a><br>  For all this, the data from the cell must somehow be sent to the server.  In theory, everything is simple - you need a microcontroller, yes a reed switch that counts wheel revolutions, but the cell often moves around the room, so the option with wires disappears immediately.  I also didn‚Äôt want to mess with the radio, and the necessary components were not at hand.  And then it dawned on me - I already have a self-made remote control receiver, which is visible from anywhere in the room and <a href="http://habrahabr.ru/post/160469/">connected to the network of my ‚Äúsmart home‚Äù</a> - so why not use IR signals?  Of the parts, you do not need anything extra except the IR LED. <br><br>  As a microcontroller, I took ATMEGA8A, which I am used to.  First of all, the question arose - would she have enough power, and how quickly would she put the battery in?  Immediately I started watching the datasheet - the eighth ‚Äúmega‚Äù with the ‚ÄúA‚Äù index can work with a wide voltage range of 2.7V-5.5V, which allows using a battery like CR2032 or CR2025.  The current consumed in the deepest sleep mode is only 0.5 micro amperes.  A microcontroller can wake up from this mode by using external interrupts INT0 and INT1, to which I decided to hang the reed switch and a single button, as well as an asynchronous timer, which will be needed to periodically send data.  For the latter, it is necessary to set the external quartz to 32768 Hz, at the maximum divider the microcontroller will wake up every 8 seconds, which is rarely enough.  I decided to send the data about once every three minutes. <br><br>  I would like to somehow control the battery charge, so I decided to use an analog-to-digital converter to measure the voltage.  ATMEGA8 allows you to measure it against 2.56 volts.  Using a voltage divider from two identical resistors, you can get exactly half of the voltage that we have on the battery, and we will measure it and send it every half hour. <br><br>  This is how a very simple device gradually acquires a bunch of components.  It is also necessary to forget the usual LED.  Having understood all this, I quickly sketched the device board: <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/e46/214/db3/e46214db34913e91471aad9fc105c333.png" alt="image"><br><br>  Soon the device itself was ready in two copies (I have two cells and two mice): <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/2e4/05b/a62/2e405ba620f0af36c434bfc819b7413c.jpg" alt="image"><br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/5f6/39a/847/5f639a847617b1eb3a7c8750104303c9.jpg" alt="image"><br><br>  I decided to put two batteries in there at once, they fit in perfectly. <br><br>  Once installed on the cells, it looked something like this: <br><br> <a href=""><img src="https://habrastorage.org/getpro/geektimes/post_images/538/3c2/a4b/5383c2a4bda965851bdb087898ec6f19.jpg" alt="image"></a> <br><br>  I decided to install this case on a height, so as not to accidentally block the back of the chair.  The important point is to protect the wires from mice. <br><br>  Then it was up to writing software.  With the firmware everything was quite simple - the device should almost always sleep.  By external interruption to add momentum.  To interrupt the timer, count the time, every three minutes, send the number of revolutions passed and save it to the EEPROM (will I suddenly pull out the battery?), And when the button is pressed, do it right away - for checking. <br><br>  For data transmission, I took the most common remote control protocol, RC-5, for which I already had code for both the receiver and the transmitter (commanded by the TV / receiver from a computer), it transmits four bytes of data.  To me, this is exactly: one byte is the number of the wheel / battery, two bytes is the number of revolutions / voltage on the battery, and one byte is the checksum.  To distinguish my signals from the signals of the consoles themselves, I only changed the duration of the starting signals. <br><br>  Slightly finalized my software on a PC and ... <br><br> <a href=""><img src="https://habrastorage.org/getpro/geektimes/post_images/bc0/4ad/70f/bc04ad70fc3a4b049ca535fc1d67f76c.png" alt="image"></a> <br><br>  The data from the mice have already gone :) Then it remained to write only a few bash-scripts to send them to the server.  For processing and drawing graphs, I took RRDtool already familiar to me: <br><br> <a href=""><img src="https://habrastorage.org/getpro/geektimes/post_images/7cf/497/d40/7cf497d409381d227bd2c029c60cf033.png" alt="image"></a> <br><br>  On this graph you can see how many meters each of the mice ran at intervals of one hour.  They are now competing with me :) The voltage on the batteries stopped falling rapidly after increasing the resistor rating on the divider and wiping the board off the flux :) <br><br>  Actually graphics: <a href="http://clusterrr.com/sensors/w/">clusterrr.com/sensors/w</a> <br>  Battery voltage charts: <a href="http://clusterrr.com/sensors/v/">clusterrr.com/sensors/v</a> <br>  Endomondo account Pinky Mysh: <a href="http://www.endomondo.com/profile/8088037">www.endomondo.com/profile/8088037</a> <br>  Twitter mouse Pinky: <a href="http://twitter.com/pinky__mouse">twitter.com/pinky__mouse</a> = Oo = <br>  And his <a href="http://vk.com/id185163744">contact</a> : <a href="http://vk.com/id185163744">vk.com/id185163744</a> <br><br>  Pinky sends you hello to all: <br><br><img src="https://habrastorage.org/getpro/geektimes/post_images/f4a/2d8/1c2/f4a2d81c2f02a9dd5cec7baadd828b63.jpg" alt="image"><br><br>  PS Jokes about generating electricity at the expense of mice, I was already pretty bored, every first one tells me about it. <br>  PPS I'm not crazy, I am having so much fun. </div><p>Source: <a href="https://habr.com/ru/post/165269/">https://habr.com/ru/post/165269/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../165257/index.html">Confirmed certificates from Coursera</a></li>
<li><a href="../165259/index.html">New rumors of a cheaper version of the iPhone</a></li>
<li><a href="../165261/index.html">Microsoft Research demonstrated the game project IllumiRoom</a></li>
<li><a href="../165263/index.html">The tale continues ... The structure of Homo informaticus</a></li>
<li><a href="../165265/index.html">Microsoft HDInsight. The cloudy (and not only) future of Hadoop</a></li>
<li><a href="../165273/index.html">Seven years of WPF: what has changed?</a></li>
<li><a href="../165275/index.html">The key difference between AngularJS and Knockout</a></li>
<li><a href="../165277/index.html">Latest news from KickStarter: the best of 2012 (in the form of infographics)</a></li>
<li><a href="../165279/index.html">A bit about creating demos, part 1</a></li>
<li><a href="../165283/index.html">Data Mining: Primary data processing using DBMS. Part 3 (Pivot Tables)</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>