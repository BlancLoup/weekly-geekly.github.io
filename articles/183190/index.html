<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>ICQ, new features - new holes</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello, dear friend, I will immediately ask for your forgiveness, since it is always difficult for me to write an introduction and therefore it will be...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>ICQ, new features - new holes</h1><div class="post__text post__text-html js-mediator-article">  Hello, dear friend, I will immediately ask for your forgiveness, since it is always difficult for me to write an introduction and therefore it will be a little liquid. <br><br>  So: <br><br>  As the time shows, in ICQ, with the introduction of a new function, a new security breach opens, take at least this article: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      <a href="http://www.xakep.ru/magazine/xa/098/082/1.asp"><b>‚ÄúHtml injection on icq.com pages‚Äù</b></a> <br><br>  Taking it as a basis, I began my research. <br><br>  <b>What is new in ICQ?</b> <br><br>  Attentive users will easily answer this question: ‚Äúlinking the ICQ number to your mobile phone number‚Äù. <br><br>  <b>But what functions at the same time appeared:</b> <br><br>  - Password recovery via code sent to mobile. <br>  - Login (login to ICQ) via code sent to mobile. <br>  - Registration of a new user through the code sent to the mobile. <br><br>  I started of course with password recovery. <a name="habracut"></a><br><br>  When entering the phone number <a href="https://www.icq.com/password/">associated</a> with the ICQ number on the password recovery page <a href="https://www.icq.com/password/">www.icq.com/password,</a> we see a page where we will be asked to enter the code that came to the mobile, as well as the new password. <br><br>  The address of this page looks like this: <br><br><pre><code class="php hljs">https:<span class="hljs-comment"><span class="hljs-comment">//www.icq.com/password/resetcode/D5DCBDBAF629FE4A07FB8C790E9F9A6535A1FD2DCD78093E71C892844953EC82/ru</span></span></code> </pre> <br><br>  This link lives about 24 hours. <br><br>  The most important link piece consists of two parts: <br><br>  - The first is either an encrypted session or the number itself: <br><br><pre> <code class="xml hljs"> D5DCBDBAF629FE4A07FB8C790E9F9A65</code> </pre> <br><br>  - The second is generally incomprehensible, which absolutely does not affect anything.  This piece can be replaced with any set of letters and numbers, or even simply cut: <br><br><pre> <code class="xml hljs"> 35A1FD2DCD78093E71C892844953EC82</code> </pre> <br><br>  Now back to the fact that the link lives for about a day ... <br><br>  When recovering the password through the mobile, we receive a code consisting of FIVE DIGITAL! <br><br>  The first tests showed that there were no restrictions on entering the code, but this was a bit erroneous.  When you enter the wrong code, the answer page contained a picture of a funny snail and the inscription ‚ÄúThe link you are using is outdated ...‚Äù <br><br><img src="https://habrastorage.org/getpro/habr/post_images/7f7/1b3/507/7f71b3507ccbe7d409bfac5db822aba6.png" alt="image"><br><br>  When entering the correct code, the answer page informed us that the password was successfully changed: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/d3f/ece/8db/d3fece8db3c17cd9b0bd9185bca78d43.png" alt="image"><br><br>  Entering the code manually in the browser, the ban could not be achieved, but after automating this process, I saw that the ban occurred after five attempts, it was a ban on entering the code from one IP and the link did not die.  When bathing, the answer page contained a cow and the inscription ‚ÄúUnfortunately, you too often repeat the same type of action.  Try it less often. ‚Äù <br><br><img src="https://habrastorage.org/storage2/d38/8a1/63e/d388a163e261b366e02bb97f9a35f954.png" alt="image"><br><br>  Without thinking, I turned to my friend and he implemented this vulnerability in the software, which he affectionately called " <b>5digger</b> ", then you will find out why ... The software worked through a proxy and therefore banned by IP we were not afraid;) <br><br>  So, we have a rather serious hole, but how do we find out the victim's phone number?  Above this, we had a little thought. <br><br>  The program that helped us gathering the database of numbers and contents from their ‚Äúinfo‚Äù helped us.  It is called ‚ÄúICQ Search Info‚Äù by <b>.fry.</b> This program somehow, in some incomprehensible way, saw the phone numbers of the owners, which they indicated in their information and which are hidden by default. <br><br>  We immediately began to scan the five digits.  As a result, we got a small base <b>uin; phone</b> .  Unfortunately for us, it contained a bunch of garbage, as well as real numbers of the owners, but not attached to their ICQ number. <br><br>  Since we are lazy people, I began to look for a form through which it was possible to check the number on registration in ICQ.  However banal it may be, this was the registration form: <a href="http://www.icq.com/join/ru">www.icq.com/join/ru</a> <br><br>  With a simple query, I was able to quickly check my numbers: <br><br><pre> <code class="php hljs">GET http:<span class="hljs-comment"><span class="hljs-comment">//icq.com/join/send_sms_code/ru?msisdn=&lt;phone&gt;</span></span></code> </pre> <br><br>  The server response if the number is not registered in icq contained the following character set: <br><br><pre> <code class="php hljs"><span class="hljs-string"><span class="hljs-string">"status"</span></span>:<span class="hljs-number"><span class="hljs-number">200</span></span>,<span class="hljs-string"><span class="hljs-string">"statusText"</span></span>:<span class="hljs-string"><span class="hljs-string">"Ok"</span></span></code> </pre> <br><br>  Having received a 100% valid uin base <b>,</b> I set to work on the <b>phone</b> .  To begin with, I deleted all the lines containing Russian numbers, namely those starting with (+7) <br><br>  The victims were the former ICQ admins and their friends with phone numbers starting at (+9725), as well as simply the numbers of unknown foreigners, I want to note that the original database contained a little less than 10 lines ... <br><br>  As soon as we changed the password on the first admin number, which turned out to be Avi Zrachya's number (this is the former ICQ administrator from Israel), namely 34567, we saw that in his contact list there was just an incredible order ... Mostly his contact list consisted of his colleagues and friends.  In this case, all the nicknames from the "info" were replaced with real names and surnames, as well as in many of the numbers in the "additional information" which he personally filled out, he could see the phone number.  I was particularly pleased with the group ‚Äú <b>Asechka.ru</b> ‚Äù, where there were several of my comrades, and also the group ‚Äú <b>Hackers</b> ‚Äù, where there was a notorious crate xT. <br><br>  As a result, I pulled out all the phone numbers and checked them in the way already described above and added to my base, this was not the end.  It turned out that all admins had a contact list in approximately the same condition and from each of them we were able to pull out new unique phone numbers.  I think our further actions and results should not be described to you as everyone can guess without it.  I want to add only that all the numbers used were quickly returned to their owners, and this made up a rather large percentage ... This vulnerability was very funny fixed.  To begin with, it was forbidden to change the password, and also to recover the password for numbers below 7 digits (six and five characters).  And then when you enter the wrong code, the inscription "wrong code" began to appear and the ban was no longer on IP, but on entering the code from a specific link. <br><br>  <b>Now back to some fun thing I noticed.</b> <br><br>  Remember the request I used to check the numbers for registration?  So, the limit on sending SMS to one number was not!  This feature was immediately implemented in the flooder of mobile phones.  The software worked for about two weeks, and then the limit was set for sending SMS. <br><br>  <b>We continue!</b> <br><br>  Again, there was no limit to enter the confirmation code and at the same time it was possible to register huge amounts of numbers without entering a captcha, and without having access to the phone specified during registration.  For this, it was necessary to collect only a variable when sending SMS, which is called <b>"transid"</b> ie  to collect a sheet of the form <b>phone; transid</b> , and then just pull in (select) the codes on this sheet and gradually register the numbers.  This vulnerability is possible and is now, because at the time of writing this article I did not check it. <br><br>  <b>Now I will tell you about the login function through the code sent to the mobile</b> <br><br>  When entering the code through the site, I sent either five or six-digit confirmation code and trying to pick it up was a little hemorrhoid, considering that I already found the same function only in a slightly different place.  In the ICQ 7M and ICQ 8 clients there is this function and when you enter the mobile, 4 character code is sent there, having chosen which, you will get all the variables for the login, I don‚Äôt remember exactly all their names, I only remember the main <b>‚Äúsessionid‚Äù</b> .  This vulnerability was not implemented, since they could not figure out the signature of the requests, but it would be funny if on the same day, in the info of several dozen ‚Äúelite‚Äù numbers, a comic inscription appeared: ‚Äú <b>Hacked by Gay Nork Crew special for Asechka.ru</b> ‚Äù <br><br>  <b>And finally, another fun feature</b> <br><br>  If you try to log in from a mobile number unregistered in ICQ, the code will be sent and the new number will be registered.  So what am I doing all this for? <br><br>  As soon as this function was introduced, it worked like this: this four-digit code was set as a password.  But it did not last long, from about December 2012 to the end of January 2013, can you imagine how many numbers were registered in this way? <br><br>  After a bit of thinking, I made up such a logical chain: if the number is registered in this way and has such a password, it means it is not used from the moment of registration ‚Üí if the number is not used from the moment of registration, the date of the last change of information about the number was about the same as the date of registration! <br><br>  Fortunately, the same ICQ Search Info harvester collected bases of the form <b>uin; last profile update</b> , collecting the base of such numbers, I went over passwords from the range 0000-9999 and saw pretty nice numbers ... <br><br>  At the moment, if the number is registered in this way, then the password is not set.  You can enter such a number using the same one-time four-digit codes or simply setting a password by going through the ‚Äúpassword recovery‚Äù procedure via a mobile phone. <br><br>  These are the interesting things that have opened innovations in ICQ and I think this kind of vulnerability is quite common.  If suddenly your service has these functions, then be sure to check them for "lice". </div><p>Source: <a href="https://habr.com/ru/post/183190/">https://habr.com/ru/post/183190/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../183176/index.html">IPv6 practice</a></li>
<li><a href="../183182/index.html">Yandex on the draft law on arbitrary blocking of sites: continued</a></li>
<li><a href="../183184/index.html">USB support in KolibriOS: what's inside? Part 2: Basics of working with host controllers</a></li>
<li><a href="../183186/index.html">Free course of 11 lectures on marketing, sales and customer service in a web-studio / agency</a></li>
<li><a href="../183188/index.html">Patterns of JavaScript modules in Impress for node.js and browsers</a></li>
<li><a href="../183192/index.html">When the race is not over. Oppo find 5</a></li>
<li><a href="../183200/index.html">Version 1.8.1.0 ‚ÄúDakar‚Äù: update of cases, import of contacts from 1C, acceleration and connection of tables, new in accounting, templates and call center</a></li>
<li><a href="../183202/index.html">Mass mailing from the console using mutt</a></li>
<li><a href="../183204/index.html">Transaction support, test environment and other convenient add-ins over commons-dbutils</a></li>
<li><a href="../183206/index.html">Six tips for building websites for a multilingual audience from Google Web Studio</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>