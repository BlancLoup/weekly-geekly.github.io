<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Identify anomalies using user behavior analysis</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Over the past 10 years, Security Information Center (SOC) and analysts have operated with such concepts as Indicators of Compromise (IoC), signatures,...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Identify anomalies using user behavior analysis</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/uz/1t/uf/uz1tuffsq-s0k91k1lzdoekw4v0.jpeg" alt="image"><br><br>  Over the past 10 years, Security Information Center (SOC) and analysts have operated with such concepts as Indicators of Compromise (IoC), signatures, threshold (based) signs of penetration or penetration attempts in an attempt to keep up with the pace of ever-changing threats.  It was a losing confrontation. <br><a name="habracut"></a><br>  At the same time, attackers have become increasingly effective in hiding their activities.  Disguise techniques have made traditional signature and threshold detective measures virtually useless. <br><br>  In response, the information security industry saw a new demand for behavioral analysis <a href="https://www.varonis.com/ru/user-behavior-analytics">(User Behavior Analytics, UBA)</a> , which looks for activity patterns and mathematically significant deviations in user behavior (using suspicious applications, file search operations) based on historical source data. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      You can often hear the question of what distinguishes UBA from traditional approaches based on SIEM. <br><br>  <b>Build on previous behavior.</b> <br><br>  In our opinion, the answer is history.  There is an old saying that says: "If you do not remember the past, you will be doomed to repeat it."  The same can be said about the traditional SIEM approach, which consists in real-time monitoring of many unrelated events: deleting or copying files, unsuccessful login attempts, malware signatures, or an excessive number of connection requests from a specific IP address. <br><br>  Of course, you need to keep track of ‚Äúraw‚Äù events from various systems, but statistics and SIEM snapshots without context are unreliable signals of what is actually happening.  We call this a false positive when the SIEM system notifies of an incident where it is not there.  At some point you end up pursuing the same false positives and, even worse, start to ignore them all together. <br><br>  How many events indicate an incident when a user deletes or copies data?  How many failed login attempts for this user are an anomaly?  When should I pay attention to user activity in a rarely used folder? <br>  The key decision to be taken for any event notification is the correct threshold for separating the normal from the abnormal. <br><br>  Often there are dozens, if not hundreds or thousands of applications, and user activity in an enterprise.  Each event associated with them has a unique purpose, a set of thresholds, signatures, and alerts for tuning and monitoring.  An approach with brute force leads to the creation of rules that are not based on accumulated data, but on unique, seemingly correct settings for this particular case.  Such rules generate endless reports and flashing dashboards, which in turn require a team of people to sift out ‚Äúfake news‚Äù. <br><br>  This dilemma on how to set a threshold led information security researchers to a statistical approach, where thresholds are based on analyzing user behavior in the real world or infrastructure. <br><br>  The key difference between UBA and monitoring methods based on static thresholds is that the first trigger decision is controlled by mathematical models and statistical analysis, which is better able to recognize true anomalies, ultimately reducing false alarms.  Some examples of behavioral incident notifications are: <br><br><ul><li>  notification when the user worked with information that was rarely used at an unusual time of day - 4AM and day - Sunday, and then sent an email to a mailbox belonging to a foreign provider; </li><li>  Notification when a user generates unsuccessful login events at a time when it usually does not work; </li><li>  notification when a user copies files from another user's home directory, and then transfers these files to a USB drive. </li></ul><br>  <b><a href="https://www.varonis.com/ru/user-behavior-analytics">UBA</a> rule example</b> <br><br>  The reason why UBA is so effective is that it does not depend only on signature or static threshold analytics. <br><br>  Let's look at this with an example. <br><br>  In the company, the security department was asked to monitor the email activity of all of its 1,000 employees.  Impossible?  - Maybe. <br><br>  We can understand the essence of the problem, focusing only on 5 users (0.5% of all users).  First, we apply traditional analytics and review their email activity (below) for a week. <br><br><img src="https://habrastorage.org/webt/0o/wt/fi/0owtfiasiy-me7vjinkmglv-zbo.jpeg" alt="image"><br><br>  By reviewing this report, you can decide to investigate the activity of users who sent more emails, right? <br><br>  You will quickly find out that Molly, who sent 90 emails on Friday, is associated with the marketing team, and her job is related to sending materials to customers by email in a day. <br>  False direction! <br><br>  Then you decide to take as a threshold the average number of emails sent by all users for each day.  For the data above, the average email sent by the user on any given day is 17. <br><br>  If you created a rule that notifies when a user sends more than 17 emails per day, you would receive 6 warnings during this time period.  Four of these warnings will take you back to Molly. <br><br><img src="https://habrastorage.org/webt/zd/2o/bp/zd2obpopvmjq7nn8szw-ej6kzh4.jpeg" alt="image"><br><br>  This threshold is clearly too sensitive.  You need a different strategy than the average for all users on a particular day - a vertical column. <br><br>  The UBA anomaly detection algorithm looks at each user every day and records information about its activities.  This historical information is accompanied by a number of attributes: in the afternoon, time, number of events, type of events, and others, and is stored in the system, so basic statistics can be created. <br><br>  UBA is a tool that runs reports, calculates the average values ‚Äã‚Äãof the parameters and the standard deviations from them for each user while comparing it with similar ones and pointing out users who really stand out from the rest.  It should also be noted that UBA calculates average values ‚Äã‚Äãof parameters, standard deviations and other statistics dynamically over time, so that they reflect possible shifts in historical trends. <br><br>  Consider an example of a possible behavioral rule: A warning when a user deviates significantly from his usual activity when sending emails. <br><br>  This could be more accurately translated as ‚Äúnotification when a user deviates by two or more standard deviations from the mean‚Äù (column AVG + 2SD). <br><br><img src="https://habrastorage.org/webt/d3/vl/cu/d3vlcu0m8bt-ihlthyctudpw22o.jpeg" alt="image"><br><br>  Obviously, this is not exactly what is being done in practice - there are better statistical tests and more comprehensive analysis that can be performed. <br><br>  More importantly, by analyzing the behavior of a user or users within, say, the same Active Directory (or OU) groups, UBA can more accurately find true anomalies. </div><p>Source: <a href="https://habr.com/ru/post/347232/">https://habr.com/ru/post/347232/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../347220/index.html">Microchip implantation: myths and reality</a></li>
<li><a href="../347222/index.html">Postgres logging experience</a></li>
<li><a href="../347224/index.html">PBX in the container. Asterisk 14 + Nginx + Freepbx 14 + srtp on Centos 7 in Proxmox VE 4 lxc container</a></li>
<li><a href="../347226/index.html">Cool internship</a></li>
<li><a href="../347230/index.html">Five major trends in the development of the Internet of Things in 2018</a></li>
<li><a href="../347234/index.html">Thinking in HTML</a></li>
<li><a href="../347236/index.html">InfoWatch Group of Companies has summed up the year</a></li>
<li><a href="../347238/index.html">What's new for mobile developers in Visual Studio 15.6 Preview</a></li>
<li><a href="../347242/index.html">Apply the KISS principle to the design principles themselves.</a></li>
<li><a href="../347244/index.html">What engineers read GridGain. Books for those interested in In-Memory Computing</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>