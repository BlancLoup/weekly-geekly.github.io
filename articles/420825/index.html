<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Today will be the first match between OpenAI and Dota 2 professionals (people won). Understanding how the bot works</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="[UPD 2] The Pain Gaming team won OpenAI Five. The match lasted 53 minutes and ended with a score of 45-41 for frags in favor of bots. You can watch ga...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Today will be the first match between OpenAI and Dota 2 professionals (people won). Understanding how the bot works</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/webt/x6/8r/os/x68rosdnvtg9n0t351wvjgxhfpi.jpeg"><br><br>  <b>[UPD 2] The Pain Gaming team won OpenAI Five.</b>  <b>The match lasted 53 minutes and ended with a score of 45-41 for frags in favor of bots.</b>  <b>You can <a href="https://www.twitch.tv/videos/300513157">watch</a> game recording <a href="https://www.twitch.tv/videos/300513157">on Twitch here</a> .</b>  <b>Beginning at 7:38:00</b> <br><br>  Tonight, August 22, before the start of the next day of the playoffs of The International, the first demonstration match between professional players and the OpenAI Five bot will take place as part of the show activities.  Information about the matches appeared on the official website of Dota 2 in the section <a href="http://www.dota2.com/international/schedule/6/0/%3Fl%3Drussian">with the schedule of the playoff games</a> The International.  In total, OpenAI will play three matches in three days with pro-players. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Significantly, this event is that a year ago, the bot already ‚Äúmassacred‚Äù Daniel Ishutin in the confrontation of <a href="https://youtu.be/wiOopO9jTZw%3Ft%3D8m38s">1x1 solo mid mirror SF</a> , and a <a href="https://habr.com/post/419407/">few weeks ago he overcame the ‚Äúhodgepodge‚Äù</a> of commentators and former pro-players. <br><br>  This time, the development of a company sponsored by Ilon Mask and other prominent businessmen from the IT sector will meet with a more serious opponent: The International gathers the best teams in the world every year, so bots will not be easy.  While the development team did not report whether all the old restrictions on peaks and mechanics that were relevant in the game against people at the beginning of the month, would be in effect, but they are worth recalling. <br><br><div class="spoiler">  <b class="spoiler_title">So, the old rules are as follows:</b> <div class="spoiler_text"><ul><li>  pool of 18 heroes in Random Draft mode (Ax, Crystal Maiden, Death Prophet, Earthshaker, Gyrocopter, Lich, Lion, Necrophos, Queen of Pain, Razor, Riki, Shadow Fiend, Slark, Sniper, Sven, Tidehunter, Viper, or Witch Doctor); </li><li>  without Divine Rapier, Bottle; </li><li>  without controlled beings and illusions; </li><li>  match with five couriers (they can not scout and tank); </li><li>  without using a scan. </li></ul><br></div></div><br>  In the comments to our <a href="https://habr.com/post/419407/">previous publication</a> on this topic a lot of controversy flared up about the methods of teaching neural networks.  This time we brought some visual materials about how the OpenAI bot works and how it looks from the point of view of people. <br><a name="habracut"></a><br>  The developers stated that due to serious computing power, a huge number of records and the ability to run training in several streams, OpenAI imitated up to 180 years of continuous play in Dota 2 daily. Obviously, the learning ability of this AI is many orders of magnitude lower than that of not the most ‚Äúsmart‚Äù ‚ÄúAnimals, not to mention dogs or higher primates, to which man belongs. <br><br>  For learning the OpenAI team used their own development called <a href="https://gym.openai.com/">Gym</a> ( <a href="https://github.com/openai/gym">repository on github</a> , official <a href="https://gym.openai.com/docs/">documentation</a> ).  This "rocking chair" is compatible with any public library, for example TensorFlow or Theano.  In the training of neural networks within the Gym, the classic agent-environment loop is used: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/xn/tq/ug/xntquget_vw7-kkqmzrvwkslffu.png"></div><br><br>  The developers claim that anyone can use the Gym to train their neural network to play classic Atari 2600 titles or other relatively easy-to-understand projects.  It is obvious that the speed of learning directly depends on the amount of resources involved in this.  As an example, the OpenAI developers <a href="https://blog.openai.com/learning-montezumas-revenge-from-a-single-demonstration/">taught the neural network to play Montezuma's Revenge</a> . <br><br>  But the greatest interest for us are the second and fourth stages - action and analysis of the result (awards for action).  And in the context of Dota 2, the level of variation just rolls over, and actions initially rated by a bot as ‚Äúcorrect‚Äù in the long run can lead to loss. <br><br><h3>  How the OpenAI team taught AI to play Dota 2 in terms of hardware </h3><br>  To the question of teaching OpenAI to the game in Dota 2 the development team approached more than seriously.  You can <a href="https://blog.openai.com/openai-five/">read the</a> full official report in the project's blog <a href="https://blog.openai.com/openai-five/">here</a> , we will give the main excerpts on the technical part and implementation without marketing and other curtsies. <br><br>  The commentators of the last publication were most interested in the power consumed by the OpenAI neural network for training.  It is obvious that the Ryzen couple could not manage it there, especially in the context of imitation of 180 years of playing on the real day.  At the same time, the bot for Dota 2 is not a bot for the Quake level shooter, which the user <a href="https://habr.com/users/yea/" class="user_link">yea</a> very clearly noted in response to one of the skeptics: <br><br><blockquote>  It seems to me that you are just poorly aware of the dimensions of the tactical scope in DotA, because you are not very familiar with the game itself.  There are no chances to make bots without the involvement of neural networks, limiting ourselves to at least some reasonable computing resources.  Seriously.  This is not Quake, where you can be a full oak in terms of tactics, compensating for this with superhumanly quick shots at the turnips from the rails.  Ideal in terms of reaction and mechanical skills, bots who cannot play with five of them and do not ‚Äúfeel the map‚Äù are doomed against any skilled meat players. <br><br>  In addition, DotA is a game with incomplete information, and this dramatically complicates the task.  The task ‚Äúwhat to do when I see an enemy‚Äù is much simpler than the task ‚Äúwhat to do when enemies are not visible‚Äù - not only for cars, but also for people. </blockquote><br>  This was clearly understood by the developers of OpenAI, so that thousands of virtual machines were involved at the same time to train bots.  Specifically, these figures are provided by the official project blog for learning the 1x1 Solo Mid bot, which is able to defeat Daniel Ishutin in mid, with some limitations, and for learning a full-fledged team for the 5x5 game: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/ap/pf/2f/appf2fn0p2lyzyngfsikv4inxgw.png"></div><br>  This is not a decimal point.  For learning OpenAI in 5x5 mode, <b>128 thousand Google Cloud processor cores</b> are constantly used.  But this is not the whole thing.  Since machine vision is used in the training of the OpenAI bot (which we'll talk about a little later), another 256 GPU PID NVIDIA ( <a href="https://images.nvidia.com/content/tesla/pdf/nvidia-tesla-p100-PCIe-datasheet.pdf">Tesla accelerator</a> ) appears in this monstrous configuration. <br><br>  According to the official NVIDIA brochure, the P100 has the following characteristics: <br><br><div style="text-align:center;"><img src="https://habrastorage.org/webt/eg/62/4l/eg624ldvbgluz5wpul8jhxbykjm.png"></div><br><br>  The official cost of one P100 Tesla 12 GB PCI-E is about $ 5800, the Tesla P100 SXM2 16GB starts at $ 9,400.  In OpenAI, the older model SXM2 is used.  We need video cards not for rendering ‚Äúgraphics‚Äù on virtual machines, but for processing and calculating data that constantly comes from all the running batches.  To handle this stream, the team had to deploy a whole system of nodes, within which the P100 Tesla operates.  Video cards process and calculate the data obtained, in order to then produce the result averaged over all batches and compare it with past OpenAI indicators. <br><br>  Such capacities allow simulating neural networks at about 60 batches per minute, for each of which the neural network analyzes about 1.04 million agent-environment cycles, mentioned earlier. <br><br><h3>  How OpenAI sees the game </h3><br>  Money - dust, if you have it of course.  Even the most approximate estimates of the cost of a single day of training OpenAI cause a light shock, and the heat generated on Google Cloud servers is enough to heat a small city.  But much more interesting is how OpenAI ‚Äúsees‚Äù the game. <br><br>  It is clear that graphic rendering is not necessary for bots, but such powers are not just used.  The bot in its actions relies on the <a href="https://developer.valvesoftware.com/wiki/Dota_Bot_Scripting">standard Valve API for bots</a> , through which the neural network receives a stream of data about the surrounding space.  The API is needed in order to run the data through a single-layer <a href="http://colah.github.io/posts/2015-08-Understanding-LSTMs/">LSTM-network</a> of 1024 blocks and receive, as a result, short-term solutions that are consistent with the long-term strategies that the neural network has. <br><br>  LSTM networks determine the priority of tasks for the bot "here and now", and in accordance with the long-term model of the behavior of the neural network, the most advantageous action is chosen.  For example, bots willingly concentrate on the last-hit creeps for earning gold and experience, which is consistent with the model for obtaining long-term benefits in the form of objects and the subsequent advantage of the game. <br><br>  According to information from the developers, all batches occur with the drawing of events on a map with a frequency of 30 FPS.  The OpenAI neural network constantly analyzes each frame through LSTM, based on the result of which it makes further decisions.  At the same time, the bot has its own priorities: all possible interactions with the environment through specially selected areas of the bot are 800x800 squares divided into 64 100x100 cells (the in-game range and movement values ‚Äã‚Äãare taken as the most careful analysis), and the square size is 8x8 ).  Here's how the bot partially "sees" the game on one particular frame: <br><br><img src="https://habrastorage.org/webt/rg/6e/xn/rg6exnzgkzaoauez-muzklv2iq0.png"><br>  <i>A complete constructor with the ability to switch actions, estimate the size of squares and other "twist settings" options is available in the official developers blog in the <b>Model structure</b> section <b>.</b></i> <br><br>  And this is how the visualization of the LSTM network operation looks like in terms of predicting game events in real time: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/iV4wd2zekJk" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  In addition to LSTM and assessing the situation ‚Äúhere and now‚Äù, the OpenAI bot constantly uses a ‚Äúforecasting‚Äù grid and setting its own priorities.  This is how it looks for people: <br><br><img src="https://habrastorage.org/webt/re/g2/fh/reg2fhpjhlg569vyge6osnxp9r4.png"><br><br>  Green square - the area of ‚Äã‚Äãthe highest priority and the current action of the bot (attack, movement, and so on), Light green square has a lower priority, but the bot can switch to this sector at any time.  Two more gray squares - zones of potential activity, if nothing changes. <br><br>  See how the bot "sees" the game and makes decisions based on these four zones can be seen on the video below: <br><br><iframe width="560" height="315" src="https://www.youtube.com/embed/pNfV5nQXVCQ" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe><br>  It is worth noting that the priority areas of the bot are not always close to the character model.  When hauling on a map, all four squares are easily shifted over several screens from the current position of the bot, that is, OpenAI simultaneously analyzes the entire game space for the availability and expediency of any actions, and not just one screen. <br><br>  OpenAI constantly plays with itself.  At the same time, 80% of bots are trained, and 20% use already developed tactics and strategies.  This approach allows neural networks to learn from their own mistakes, finding vulnerable patterns in their own behavior and at the same time consolidate successful behaviors. <br><br><h3>  Tomorrow.  People professionals against the car </h3><br>  Instead, the result is to return to the topic of tomorrow's confrontation between professional players and OpenAI. <br><br>  While the details are unknown, however, we can confidently say that the neural networks will have a hard time.  Unlike its past opponents, OpenAI will face the best of the best, and the ability to maneuver and teamwork within the show match will allow people to reach their full potential.  The Solo Mid 1x1 format is, of course, extremely entertaining, but it does not reveal the whole essence of the game and is extremely intolerant of the micro-mistakes that people often make. <br><br>  The whole question is how seriously the professionals will take this confrontation.  When any additional information appears, the publication will be updated. </div><p>Source: <a href="https://habr.com/ru/post/420825/">https://habr.com/ru/post/420825/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../420811/index.html">Decentralized messenger and new generation telephone network</a></li>
<li><a href="../420813/index.html">Behind the scenes of the network in Kubernetes</a></li>
<li><a href="../420815/index.html">How ‚Äúdecoding of the digital world‚Äù exploded the hall: top 10 reports DotNext 2018 Piter</a></li>
<li><a href="../420819/index.html">Top 10 Python tools for machine learning and data-science</a></li>
<li><a href="../420821/index.html">Rule 10: 1 in programming and writing</a></li>
<li><a href="../420827/index.html">Create a simple maven project using Java EE + WildFly10 + JPA (Hibernate) + Postgresql + EJB + IntelliJ IDEA</a></li>
<li><a href="../420829/index.html">Job System. Review on the other hand</a></li>
<li><a href="../420831/index.html">Apparatus for the issuance of cookies "Cooker 3000"</a></li>
<li><a href="../420833/index.html">The main mistakes monetization of the application [and how to fix them]</a></li>
<li><a href="../420835/index.html">"Kalashnikov" showed the concept of a combat robot and electric motorcycle for the civilian market</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>