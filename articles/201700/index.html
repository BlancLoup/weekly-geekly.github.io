<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>API Development for the SolidWorks 2012 Software Package. Part 1</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="The SolidWorks API (Application Programming Interface) is an interface that allows you to develop custom applications for the SolidWorks system. The A...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>API Development for the SolidWorks 2012 Software Package. Part 1</h1><div class="post__text post__text-html js-mediator-article">  The SolidWorks API (Application Programming Interface) is an interface that allows you to develop custom applications for the SolidWorks system.  The API contains many functions that can be called from Microsoft Visual Basic, Microsoft Visual C ++, Microsoft Visual Studio, or from SolidWorks macro files.  These features provide the programmer with direct access to SolidWorks functionality. <br><br>  Using API applications, you can solve many different tasks, such as: integrating SolidWorks with other software packages, developing specialized modules that add additional functionality to the basic SolidWorks capabilities, and various other tasks.  API - applications allow you to get a lot of configurations of one part or assembly, thereby winning a huge amount of time when making design decisions. <br><br>  API development can be done at the macro creation level in SolidWorks, or at the level of an individual application written in C # or VisualBasic.  All dynamic libraries required for working with API applications are automatically installed with SolidWorks.  As a rule, if you need to develop a full-fledged application, for geometric constructions it is more convenient to use the program code recorded in the SolidWorks macro.  To start working with macros, it is necessary to display the Macro toolbar in the SolidWorks software package. <br><a name="habracut"></a><br><h4>  Creating a new macro and its implementation </h4><br><h5>  The steps to create a macro in SolidWorks. </h5><br>  1. Before you start recording a macro, you need to create a new part (assembly) file. <br>  2. To start recording a macro in the Macro panel, click on Record / Pause Macro, after which each construction or change of the property will be recorded in the macro file. <br>  3. Next, we carry out all the constructions that should be displayed in the program code of the macro. <br>  4. After that, stop the recording by clicking "Stop macro recording".  A window will appear in which you need to specify the physical path of the macro file on the hard disk and specify the format in which it will be recorded. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h6>  Formats in which a macro can be saved: </h6><br>  ‚Ä¢ VBA - a simplified implementation of the Visual Basic programming language built into the Microsoft Office product line. <br>  ‚Ä¢ VSTA VB - the macro will be saved in program code in Visual Basic.  VSTA - application functionality extension tools based on .NET. <br>  ‚Ä¢ VSTA C # - the macro will be saved in the program code in C #. <br>  In order to execute the recorded macro, click on the ‚ÄúRun macro‚Äù button in the ‚ÄúMacro‚Äù panel, after which the ‚ÄúOpen‚Äù window will appear. <br><br><h4>  Macro editing </h4><br>  In order to edit the created macro, you must click on the "Edit Macro" panel in the "Macro" panel, then in the appeared window specify the location of the macro file on the hard disk and its format.  To edit the macro (VB, C #), use the Visual Studio for Applications (VSTA) toolkit.  VSTA automatically starts after selecting a macro for editing.  The VSTA window displays the generated code of the edited macro. <br><br>  With this tool, you can make changes to the generated code and re-save the macro.  It should be noted that in the Project Explorer window there are already links to all the necessary dynamic libraries. <br><br><h4>  Creating an application in Visual Studio </h4><br><h5>  Reference to libraries </h5><br>  API - application can be developed directly in Visual Studio, using the program code generated when recording a macro. <br><br>  In order to connect dynamic libraries for working with the API interface, in the Solution Explorer window, right-click on the References tab and select the ‚ÄúAdd link‚Äù item in the pop-up menu.  After that, the Add Link menu will appear, in which we select the COM tab and add the following libraries: SolidWorks2010 Type Library, SolidWorks2010 Constant Type Library, SolidWorks.Interop.swocommands.dll.  Next, you need in the application itself in the classes where it is needed (that is, in those that will use the program code associated with working in SolidWorks) connect the appropriate namespaces. <br><br><h5>  Create part file </h5><br>  To stop recording a macro and save it, click Stop Macro Recording and specify the save path.  The result is a generated C # code that we can use in our Windows Form application.  However, you need to add some code to the project to create a new part file.  The code snippet looks like this: <br><br><pre><code class="cs hljs">Document = <span class="hljs-string"><span class="hljs-string">"C:\\ProgramData\\SolidWorks\\SolidWorks 2010\\templates\\ .asmdot"</span></span>; swModelDoc = (ModelDoc2)swApp.OpenDoc6(document, (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)swDocumentTypes_e.swDocASSEMBLY, (<span class="hljs-keyword"><span class="hljs-keyword">int</span></span>)swOpenDocOptions_e.swOpenDocOptions_Silent, <span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-keyword"><span class="hljs-keyword">ref</span></span> errors, <span class="hljs-keyword"><span class="hljs-keyword">ref</span></span> warnings);</code> </pre> <br><br><h5>  The main methods, changing the formal parameters of which may affect the geometry of this model model </h5><br>  ‚Ä¢ The InsertSketch method of the SketchManager class is used to add a sketch in the active plane.  As a formal parameter takes the value of type bool.  Before creating a new sketch, you should select the plane on which it will be placed. <br><br><pre> <code class="cs hljs">boolstatus = swDoc.Extension.SelectByID2(<span class="hljs-string"><span class="hljs-string">""</span></span>, <span class="hljs-string"><span class="hljs-string">"PLANE"</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-literal"><span class="hljs-literal">false</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-literal"><span class="hljs-literal">null</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>); swDoc.SketchManager.InsertSketch(<span class="hljs-literal"><span class="hljs-literal">true</span></span>);</code> </pre><br>  ‚Ä¢ The CreateLine method of the SketchManager class is used to create a new sketch line in the sketch editing mode.  It takes 6 formal parameters - the coordinates of the end and the starting point of the line.  Similar to the CreateLine method, there are methods for creating other sketch elements.  An example of using the CreateLine method: <br><br><pre> <code class="cs hljs">skSegment= ((SketchSegment) (swDoc.SketchManager.CreateLine (<span class="hljs-number"><span class="hljs-number">0.116812</span></span>, <span class="hljs-number"><span class="hljs-number">0.026916</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>, <span class="hljs-number"><span class="hljs-number">0.149183</span></span>, <span class="hljs-number"><span class="hljs-number">0.026916</span></span>, <span class="hljs-number"><span class="hljs-number">0.000000</span></span>)));</code> </pre><br>  ‚Ä¢ The swDoc class EditDimensionProperties method is used to edit the properties of the applied size.  Accepts many formal parameters, each of which is responsible for a certain state of a size property. <br>  ‚Ä¢ The AddDimension method of the swDoc class serves to create a new size and takes the coordinates of the size boundary points as formal parameters.  For proper use, you must explicitly cast to the DisplayDimension type. </div><p>Source: <a href="https://habr.com/ru/post/201700/">https://habr.com/ru/post/201700/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../201688/index.html">Autorun Yandex.Disk as systemd service in Fedora 19</a></li>
<li><a href="../201692/index.html">Postmorthem: how to manage to make 14 mistakes, having developed one social game</a></li>
<li><a href="../201694/index.html">Performance comparison of various encryption systems for linux</a></li>
<li><a href="../201696/index.html">Anonymous chat TorChat and its improvement</a></li>
<li><a href="../201698/index.html">Scalable NAS</a></li>
<li><a href="../201702/index.html">How-to: robots and brokerage trading system APIs</a></li>
<li><a href="../201704/index.html">Android - iOS - Android</a></li>
<li><a href="../201710/index.html">Google Chrome blocks third-party extensions</a></li>
<li><a href="../201712/index.html">Features of creating a wholesale online clothing store / shoes</a></li>
<li><a href="../201714/index.html">IT service performance audit. New opportunity for service companies</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>