<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Sandbox Wars - Part 1</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="A warning 
 The article describes the adventures of a friend of mine . 

 Prehistory 
 Events take place in the days of the distant third year. 

 I l...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Sandbox Wars - Part 1</h1><div class="post__text post__text-html js-mediator-article"><h4>  A warning </h4><br>  The article describes the adventures of <a title="Y_my_podrugi_s_e__ mate" href="http://lurkmore.ru/%25D0%25A3_%25D0%25BC%25D0%25BE%25D0%25B5%25D0%25B9_%25D0%25BF%25D0%25BE%25D0%25B4%25D1%2580%25D1%2583%25D0%25B3%25D0%25B8_%25D1%2581_%25D0%25B5%25D1%2591_%25D0%25BF%25D0%25B0%25D1%2580%25D0%25BD%25D0%25B5%25D0%25BC">a friend of mine</a> . <br><br><h4>  Prehistory </h4><br>  Events take place in the days of the <s>distant</s> third year. <br><br>  I lived in a student dormitory in the same room with a first-year neighbor, who, like me, studied at the VMC and was interested in information technology.  For definiteness, I will call him N. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <a name="habracut"></a><br>  He loved this comrade to engage in minor network hooliganism, such as finding someone to have a simple password for VKontakte and changing the avatar, or writing something vulgar in the status.  I did not approve of it, but did nothing.  In addition, he had less theoretical knowledge than is needed for such actions, so he used at most ready-made programs, with a poor understanding of how they work - I did not approve of it even more. <br><br>  I myself was not a guru either, but at least I tried to study theory before using the ‚Äúmagic‚Äù scripts and programs.  Well, and directed his activities more in a constructive, not destructive way. <br><br>  And I considered myself to be sufficiently protected from network attacks, because I know the basics of computer literacy, I don‚Äôt put my date of birth or phone number as passwords, I update the OS in time, I don‚Äôt launch anything from the Internet. <br><br>  And then, one day, he sends me an email and slyly lybitsya.  And in the letter is a file, and in the file is a label with the majority of my passwords.  The most valuable passwords (to mail and domains) were not there, but I still have batthert, because how is it - I did everything right, and here is such a failure, and I do not even know where I have a problem, and what needs to be fixed !  I ask him, he refuses to explain where and how he got them. <br><br>  The analysis showed that the set of passwords sent to me coincides with the set of passwords stored in Opera Wand, I put the master password on Wand in the opera.  I change all the passwords, download the Cure It Live CD, reboot the computer, run a full scan.  Night passes - no viruses detected.  I download a similar product from the Kaspersky Lab - the result is the same.  The idea comes that he could use the Live CD to steal the wand.dat - the disk is not encrypted.  N says that I didn‚Äôt guess, but just in case I put the password in the BIOS to boot and to change the boot media.  A terrible revenge plan is born in my head (especially since my hands were itching for a long time to do something like that, but they were holding back moral standards - and there seems to be an excuse: "he first began").  I record a Live CD with some kind of mini-Linux, I test it on my computer, everything works.  I google an arrangement of key files of Windows. <br><br>  The next day, while N is taking the exam, I close in the room, boot up his PC from the Live CD prepared on the eve.  I copy the% AppData% directory to my USB flash drive, I also copy the SAM and SYSTEM registry files, and turn off the PC. <br><br>  On my computer, I decipher the passwords from his Opera Wand, the password from the mail is also there.  One of them coincides with his password on the entrance to Windows. <br><br>  Also in the mailbox using the search for the words ‚Äúpassword‚Äù, ‚Äúpassword‚Äù I find the passwords from the services that send the password in the open form to the mail after each change. <br><br>  I am writing him a response letter with his passwords.  After a short time, I get disconnected from ICQ and Jabber.  Realizing that he also has a database of my Miranda, I recover passwords for all used IM protocols, and I put a base encryption plugin for Miranda. <br><br>  After several hours of negotiations, agree on the exchange of information about the methods of "hacking".  It turned out that a few weeks ago, while I was away from the computer, I copied my% APPDATA% onto a USB flash drive.  And that day I decided to go through this directory with decoder programs.  It turned out that while I was considering some complicated options, he just picked up and copied the directory - where is it much easier?  Since then, my computer is blocked after two minutes of inactivity, as well as manually, when I do not forget. <br><br>  This incident had no effect on good-neighborly relations, since no one used other people's passwords for bad purposes, and both of them only got too much experience.  In addition, they agreed not to use physical access to the neighbor‚Äôs computer in the future, because it will no longer bring experience, and protecting the PC from physical access is already beyond what we are interested in. <br><br><h4>  Story </h4><br>  A month has passed.  And again, I see how N learned the password from the email of his classmate, and, with worthy use of perseverance, resets her password to a contact and writes everything on her behalf on the wall, in messages to friends, etc.  She recovers VKontakte password via mail, and he changes it back.  She doesn‚Äôt guess the password to change the mail (there‚Äôs no excuse for this either). <br><br>  And my hands were itching again to do something bad, and here again there is a moral justification - N himself offends the illiterate, it means that if I get access to his passwords, there will be nothing bad in it. <br><br>  Since we agreed not to use physical access to the computer, and also because it would not be interesting to repeat the focus from the Live CD, we need a less trivial way. <br><br>  A glance falls on a pair of switches and a bunch of wires through which the Internet works in our room. <br><br><h2>  Network infrastructure modification </h2><br>  Initially, the network configuration was as follows: <br><img src="https://habrastorage.org/storage/7b7d52cb/5f3fb32e/40c2a51f/b6369179.png"><br><br>  IP addresses are static, N goes to the Internet through the gateway 10.25.6.1.  I am sitting at a separate router for experiments.  Thus, I have a network of 192.168.0.0/24 to host the necessary machines. <br><br>  First of all, you need a router that will be used by the victim instead of the provider.  Of course, there is no possibility to single out a separate machine, so I do everything in VirtualBox. <br><br>  The internal IP address for the virtual router will be 10.25.6.1 (since the victim will connect to this address), what to do with the external one?  It cannot receive the Internet from the provider router, so then the address ranges of the external and internal networks will be the same.  Let the external interface connect it to my private network: 192.168.0.0/24. <br><br>  In summary: Debian is installed in Debian, the internal interface address is 10.25.6.1, the external one is 192.168.0.u.  We configure NAT on it. <br><br>  Since there is actually only one network adapter on the laptop inside which VirtualBox is running, you'll have to cheat.  In the virtual machine settings, we will bridge both virtual machine interfaces with a single real machine interface.  Thus, two logical networks now coexist in the same hardware segment: 192.168.0.0/24 and fake 10.25.6.0/24.  On an ongoing basis, this is not worth doing, but in this case nothing terrible happened. <br><br>  We also create another virtual machine, which will play the role of the victim until everything is debugged, we also connect it to the same internal network in bridge mode. <br><br>  Now the network looks like this (the red arrows show the packet route from the virtual victim to the Internet): <br><img src="https://habrastorage.org/storage/1d85f8e2/13ac0238/b06c9b26/06c78224.png"><br><br>  For a real victim, instead of the first two arrows, there will be one arrow directly to the switch - this will happen if you switch the wire N from the room switch to your own, and the victim will notice only a short break in communication. <br><br>  You can see a lot of things at once, for which networkers will probably hang me: <br><ul><li>  One switch is used in two logical networks, and, as a result, the packet passes through this switch twice.  That is, the path with self-intersection is obtained. </li><li>  The package, during its journey, passes through two different networks 10.25.6.0/24, first through the fake network, then through the real </li><li>  traceroute from the victim to any server on the Internet will show the address 10.25.6.1 twice, an extremely unusual situation </li></ul><br><br>  To check, we run on the victim vkontakte.ru, on the tcpdump router, and see the following: <br><img src="https://habrastorage.org/storage/5ae89699/ae8502a1/3040b067/e0fe1566.png"><br><br>  Turning off the victim virtual machine, switching the cable N from the main switch to your own one, in a few seconds we get VKontakte cookies.  Having entered the cookies into your browser, we end the session (here you could behave more carefully, but to hell with it!).  A few minutes later the password from VKontakte is received. <br><br>  Network layout in a ‚Äúcombat‚Äù state: <br><img src="https://habrastorage.org/storage/8cd6c574/ba547295/2a48de80/4b9bd443.png"><br><br>  But just listening to the traffic will not do anything, most sites transmit passwords via https protocol, so the maximum that I get is a password from VKontakte, which he will then recover via email, something more interesting is needed. <br><br><h4>  findings </h4><ul><li> use the BIOS password, or data encryption on the hard drive (TrueCrypt) </li><li>  short time to turn on the computer lock on inactivity </li><li>  Webmasters: do not transmit important data via http, use encryption.  Durov, do you hear? </li><li>  Users: do not use sites that transmit your passwords via http </li><li>  Do not be ‚Äúbad guys‚Äù, maybe your neighbor is just waiting for a reason </li></ul><br><br><h4>  Continuation </h4><br>  <a href="http://habrahabr.ru/blogs/infosecurity/111714/">HTTPS bypass</a> </div><p>Source: <a href="https://habr.com/ru/post/111489/">https://habr.com/ru/post/111489/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../111481/index.html">The concept of a web project or why we kill our ideas?</a></li>
<li><a href="../111482/index.html">The stage of preparation of the project in theory</a></li>
<li><a href="../111486/index.html">We create Web Services on the Oracle WebLogic Server platform, we test with SoapUI</a></li>
<li><a href="../111487/index.html">A spam counter appeared on the web - Spam Clock</a></li>
<li><a href="../111488/index.html">Hacker demonstrated "cloud" software for hacking WiFi-networks at the Black Hat conference</a></li>
<li><a href="../111491/index.html">Tablets with CES. Summary table</a></li>
<li><a href="../111493/index.html">Use Android Search Dialog. Part 2 - Recent Query Suggestions</a></li>
<li><a href="../111495/index.html">Battery HTC Evo has saved the life of a parking attendant from Atlanta</a></li>
<li><a href="../111497/index.html">Closed testing Civilization World announced by Sid Meier</a></li>
<li><a href="../111498/index.html">About what bumps I filled. Part two</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>