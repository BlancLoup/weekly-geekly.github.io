<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Getting started with AppCmd</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Push 
 The reason for writing the translation was the fact that, in my opinion, many Windows users are so used to the GUI that they sometimes forget a...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Getting started with AppCmd</h1><div class="post__text post__text-html js-mediator-article"><h4>  Push </h4><br>  The reason for writing the translation was the fact that, in my opinion, many Windows users are so used to the GUI that they sometimes forget about the existence of the command line.  But it is the command line that allows you to automate many processes in a short period of time.  Certainly the command line is not perfect, but sometimes it is this that allows you to simplify communication with those.  support, and reduce kilometer screenshots, to several lines of code. <br><a name="habracut"></a><br><h4>  Introduction </h4><br>  The AppCmd ‚Äã‚Äãcommand is a separate standalone tool for managing IIS 7. It implements all the basic server management functionality using a set of objects that can be controlled via the command line. <br>  AppCmd ‚Äã‚Äãallows you to easily manage a server without using a graphical interface and easily automates server management without writing code. <br>  Here are the few things you can do with AppCmd: <br><ul><li>  Create and configure sites, applications, application pools and virtual directories. </li><li>  Stop and start sites, re-launch application pool. </li><li>  Get a list of running workflows and monitor the requests that are executed. </li><li>  Search, manage, export and import IIS and ASP.NET configuration. </li></ul><br>  AppCmd ‚Äã‚Äãalso allows server administrators to easily perform complex management tasks by combining several AppCmd.exe commands, or using output in other programs. <br><br><h4>  How to use AppCmd.exe </h4><br>  AppCmd.exe is built on top of high-level management objects, such as a site and an application.  These objects provide methods that can be used to perform various actions on these objects, and object instances provide properties for reading and tuning. <br>  For example, a site object provides methods for outputting, creating, deleting instances of a site (these are standard methods that are present in most objects), there are still methods for starting and stopping a site.  Each site instance contains properties such as name, id, etc.  they can be viewed as well as searched for them.  The result of each such command is always a list of object instances. <br>  Note: AppCmd.exe is located in the <code>%systemroot%\system32\inetsrv\</code> directory.  Due to the fact that this path is not registered in the PATH, you must use the full path to the command when executing, for example: " <code>%systemroot%\system32\inetsrv\AppCmd.exe list sites</code> ".  However, you can add this path to your PATH yourself and use the command directly from anywhere. <br>  The command runs with one of the supported control objects and optional parameters to clarify the command: <br> <code>APPCMD &lt;COMMAND&gt; &lt;OBJECT&gt; &lt;ID&gt; [/parameter1:value1]*</code> <br>  Where &lt;COMMAND&gt; is one of the commands supported by &lt;OBJECT&gt;.  Most objects support a basic set of commands: <br><ul><li>  LIST displays a list of objects.  The optional &lt;ID&gt; can specify an object to display.  One or several parameters can specify the values ‚Äã‚Äãof the properties by which the objects will be searched. </li><li>  ADD creates a new object listing the property values ‚Äã‚Äãthat will be set at the time of creation. </li><li>  DELETE deletes the object with the specified &lt;ID&gt;. </li><li>  SET changes the property value to the object specified by &lt;ID&gt;. </li></ul><br>  Many objects support additional commands, such as START and STOP for the site. <br>  For example, now AppCmd ‚Äã‚Äãsupports the following list of objects: <br><table><tbody><tr><th>  <b>An object</b> </th><th>  <b>Description</b> </th></tr><tr><td>  Site </td><td>  Site management </td></tr><tr><td>  App </td><td>  Application Management </td></tr><tr><td>  Vdir </td><td>  Virtual Directory Management </td></tr><tr><td>  Apppool </td><td>  Manage application pool </td></tr><tr><td>  Config </td><td>  Configuration management </td></tr><tr><td>  Backup </td><td>  Configuration Backup Management </td></tr><tr><td>  WP </td><td>  Workflow Management </td></tr><tr><td>  Request </td><td>  Manage Active HTTP Requests </td></tr><tr><td>  Module </td><td>  Server Module Management </td></tr><tr><td>  Trace </td><td>  Manage server trace logs </td></tr></tbody></table><br>  Where &lt;ID&gt; is the instance ID of the object you want to specify for the command.  The format of the identifier depends on the type of object.  For example, for the object, site is the name of the site; for the application object, the application path is used; for the application pool, the name of the pool. <br>  Where [/ parameter: value] * can be omitted or contain several parameters that affect the behavior of the command.  Each command supports a different set of parameters, depending on the type of object.  Usually, commands that search for objects, or change properties of an object, can specify property names as parameters. <br>  The utility itself supports several parameters that affect the behavior in general, and do not depend on some types of objects.  All of them are listed at the beginning of the help, which can be obtained by executing " <code>AppCmd.exe /?</code> ", And contains parameters such as <code>/text</code> , <code>/config</code> and <code>/xml</code> to control the output and <code>/commit</code> to determine the level in the hierarchy, where the changes in the configuration will be tried on. <br><br><h4>  We work with help </h4><br>  AppCmd ‚Äã‚Äãprovides a convenient system for providing help, which can be obtained for all supported object types and commands.  There are three types of help for the types of information requested. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  general information </h5><br>  General information shows available objects as well as general parameters.  To get general information, just dial: <br><pre> <code class="dos hljs">APPCMD /?</code> </pre><br>  Conclusion: <br><pre> <code class="dos hljs">General purpose IIS command line administration tool. APPCMD &lt;COMMAND&gt; &lt;OBJECT&gt; &lt;ID&gt; &lt; /parameter1:value1 ... &gt; Supported object types: SITE Administration of virtual sites APP Administration of applications ...</code> </pre><br><h5>  Object Information </h5><br>  Object information shows a list of commands available to a particular type of object. <br> <code>APPCMD &lt;OBJECT&gt; /?</code> <br>  Where <code>&lt;OBJECT&gt;</code> name of one of the supported objects.  For example, the command for displaying information on the site object will look like this: <br><pre> <code class="dos hljs">APPCMD site /?</code> </pre><br><br><h5>  Team information </h5><br>  Information on the command contains information on the syntax that is defined for each command, and includes the available parameters and examples of common tasks.  To see this reference, run: <br><pre> <code class="dos hljs">APPCMD &lt;COMMAND&gt; &lt;OBJECT&gt; /?</code> </pre><br>  For example, to see information on the LIST command for an APP object type, run: <br><pre> <code class="dos hljs">APPCMD list app /?</code> </pre><br><br><h4>  Search for objects </h4><br>  The LIST command is very versatile and is supported by all types of objects.  The purpose of the command is to search for instances of objects by a given criterion.  The output of the command is a list of instances of objects that you can view, examine the values ‚Äã‚Äãof properties, and export them for later creation on other servers.  Or use with another program to perform actions on them. <br><br><h5>  Output all objects </h5><br>  The simplest thing is to invoke the LIST command without parameters, this will output all instances of objects on the server: <br><pre> <code class="dos hljs">APPCMD list &lt;OBJECT&gt;</code> </pre><br>  For example, to view all sites on a server, use the following command. <br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD list sites</code> </pre><br>  The output will contain the following: <br><pre> <code class="dos hljs">SITE "Default Web Site" (id:<span class="hljs-number"><span class="hljs-number">1</span></span>,bindings:HTTP/*:<span class="hljs-number"><span class="hljs-number">80</span></span>:,state:Started) SITE "Site1" (id:<span class="hljs-number"><span class="hljs-number">2</span></span>,bindings:http/*:<span class="hljs-number"><span class="hljs-number">81</span></span>:,state:Started) SITE "Site2" (id:<span class="hljs-number"><span class="hljs-number">3</span></span>,bindings:http/*:<span class="hljs-number"><span class="hljs-number">82</span></span>:,state:Stopped)</code> </pre><br>  By default, each following object is shown on a separate line and contains an identifier (such as the ‚ÄúDefault Web Site‚Äù) and one or more relevant properties (such as ID, binding, and state) <br><h5>  Output a specific object </h5><br>  The LIST command can be used to search for an instance of an object with a specific object name using the following plan command <br><pre> <code class="dos hljs">APPCMD list &lt;OBJECT&gt; &lt;ID&gt;</code> </pre><br>  For example, to find a site with a unique identifier "Default Web Site", use the following line: <br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD list site "Default Web Site"</code> </pre><br><h5>  Object output by criterion </h5><br>  To find all objects that meet the specified criteria, specify one or more parameters that contain the required values ‚Äã‚Äãfor the search.  For example, the following command searches for all sites that are stopped: <br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD list sites /state:Stopped</code> </pre><br>  You can specify any number of property-value pairs, and the command will return all objects that satisfy all the specified criteria.  For example, the following command will find all sites that are simultaneously stopped and at the same time configured not to start automatically. <br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD list sites /serverAutoStart:false /state:Stopped</code> </pre><br><h4>  Facility management </h4><br>  In addition to the List, most objects support the ADD, SET, and DELETE commands. <br><br><h5>  Adding a new object </h5><br>  The ADD command creates a new instance of the object.  For example, this command creates a new site: <br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD add site /name:MyNewSite /bindings:"http/*:<span class="hljs-number"><span class="hljs-number">81</span></span>:" /physicalPath:"C:\MyNewSite"</code> </pre><br>  Depending on the object, some parameters may be required, and some may not. <br>  If the required parameter is not specified, an error will be returned. <br>  The help command will show which parameters are required.  For example, use the following command to see which parameters are required when creating a site: <br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD add site /?</code> </pre><br><h5>  Modifying an existing object </h5><br>  The SET command changes one or more properties of the specified object instance.  This command requires an object instance identifier to be specified.  For example, to change the ID property of the ‚ÄúDefault Web Site‚Äù, use the following command: <br>  % systemroot% \ system32 \ inetsrv \ APPCMD set site "Default Web Site" / id: 200 <br>  The syntax for calling information can also be used to view a list of properties that can be changed on a specific object.  For example, to see the properties supported by the "Default Web Site" type: <br><pre> <code class="dos hljs"> <span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\<span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> site "Default Web Site" /?</code> </pre><br><h5>  Deleting Objects </h5><br>  The DELETE command deletes an object instance.  Like SET, this command must pass an object identifier.  For example, use the following command to delete a site called ‚ÄúMyNewSite‚Äù: <br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\<span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD delete site "MyNewSite"</code> </pre><br><h4>  Backup Management </h4><br>  AppCmd ‚Äã‚Äãallows you to create or restore backup copies of server configurations.  You can use this to restore random changes to the server configuration, and roll back the configuration to a state in which the server was stable.  It is considered good practice to make backups before changing the configuration, or installing components that change it.  Each such copy contains the current ApplicationHost.config of the root configuration file, as well as other server settings, like FTP and administration tool settings. <br>  To back up, use the BACKUP object's ADD command. <br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD add backup BACKUP object "<span class="hljs-number"><span class="hljs-number">20060519</span></span>T172530" added</code> </pre><br>  This backup with an automatically generated name, which contains the date and time of the backup. <br>  You can also specify a specific backup name, for example, as follows: <br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD add backup MyBackup BACKUP object "MyBackup" added</code> </pre><br>  You can view the backup list using the LIST command: <br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD list backups BACKUP "<span class="hljs-number"><span class="hljs-number">20060519</span></span>T172530" BACKUP "MyBackup"</code> </pre><br>  And finally, to restore from a backup, use the RESTORE command along with the name of the backup: <br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD <span class="hljs-built_in"><span class="hljs-built_in">restore</span></span> backup "MyBackup" Restored configuration from backup "MyBackup"</code> </pre><br>  Restore from backup stops the server and restores the full configuration as of the date when the backup was made. <br>  In Windows 2008 and Windows Vista SP1 operating systems, AppCmd ‚Äã‚Äãwill be able to work with periodic backups performed by the system service.  These backups are available in the list of all backups that were received by the AppCmd ‚Äã‚Äãcommand and are available for rollback in the same way as the others. <br>  For a detailed study of managing backups using AppCmd, you can read <a href="http://mvolo.com/blogs/serverside/archive/2007/03/18/Most-Important-AppCmd-Commands_3A00_-Backing-up-and-restoring-IIS7-configuration.aspx">here.</a> <br><br><h4>  Working with Sites, Applications, Virtual Folders and Application Pools </h4><br>  Creating and managing sites, applications, virtual directories are the most common tasks faced by the administrator.  IIS 7 and higher adhere to a more strict hierarchy than previous versions, now the hierarchy looks like this: <br><ol><li>  <b>Website</b> .  The website accepts requests for a specific associated endpoint defined by the IP address and host header.  For example, the following URL represents a site <a href="http://www.mysite.com/">associated</a> with port 81: <a href="http://www.mysite.com/">www.mysite.com</a> : 81 <br>  The website contains one or more applications. </li><li>  <b>Application</b>  The application is definitely in its virtual path along with the site namespace.  For example, an application with a virtual path / app1 can be represented by the following URL <a href="http://www.mysite.com/">www.mysite.com</a> : 81 / app1 <br>  The application belongs to the application pool. <br>  The application contains one or more virtual directories. </li><li>  <b>A virtual directory</b> is represented by its virtual path along with the application space.  For example, a virtual directory with a virtual path / vdir1 might have the following URL <a href="http://www.mysite.com/">www.mysite.com</a> : 81 / app1 / vdir1. <br>  The virtual directory indicates the physical location on the disk. </li></ol><br>  This hierarchy is different from the one in IIS 6, where the Web site could contain a mixture of virtual directories and applications, and the applications were just specially marked virtual directories. <br>  <b>Application pool</b>  An application pool is defined by a group of settings for a workflow that performs request processing for applications in this application pool.  The application pool is not part of the site-application-directory hierarchy.  Each application is defined by a pool in which it will work, otherwise the application will work in the application pool defined by default. <br>  An application pool is defined by settings such as the number of worker processes, the load version of the CLR, the type of integration, the account under which the process will be executed, and the restart settings of the process. <br>  By default, IIS 7 and above are installed with the Default Web Site Web site, which listens on port 80, and which has no restrictions on the address and host header.  The site contains a root application, and this application has a root virtual directory.  There is also the application pool "DefaultAppPool", which is used as a default application pool for all applications created. <br>  This command will display all sites, including the Default Web Site. <br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD list sites SITE "Default Web Site" (id:<span class="hljs-number"><span class="hljs-number">1</span></span>,bindings:HTTP/*:<span class="hljs-number"><span class="hljs-number">80</span></span>:,state:Started)</code> </pre><br>  Let's look at the applications that belong to the Default Web Site, for this we specify the site.name property in the application output command: <br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD list apps /site.name:"Default Web Site" APP "Default Web Site/" (applicationPool:DefaultAppPool)</code> </pre><br>  A similar command will show all the virtual directories contained in the application of "Default Web Site /", for this we specify the app.name property in the command listing virtual directories. <br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD list vdirs /app.name:"Default Web Site/" VDIR "Default Web Site/" (physicalPath:C:\inetpub\wwwroot)</code> </pre><br>  Finally, let's review the list of application pools: <br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD list apppools APPPOOL "DefaultAppPool" (MgdVersion:v2.<span class="hljs-number"><span class="hljs-number">0</span></span>,MgdMode:Integrated,state:Started) APPPOOL "Classic .<span class="hljs-built_in"><span class="hljs-built_in">NET</span></span> AppPool" (MgdVersion:v2.<span class="hljs-number"><span class="hljs-number">0</span></span>,MgdMode:ISAPI,state:Started)</code> </pre><br><h5>  Creation of sites, applications, virtual directories, application pools </h5><br>  Now we will create a website called ‚ÄúMySite‚Äù and Id 2, which will listen on port 81 for all IP addresses and host headers. <br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD add site /name:MySite /id:<span class="hljs-number"><span class="hljs-number">2</span></span> /bindings:http/*:<span class="hljs-number"><span class="hljs-number">81</span></span>: /physicalPath:C:\inetpub\mysite SITE object "MySite" added APP object "MySite/" added VDIR object "MySite/" added</code> </pre><br>  The name parameter must be specified in order to create a website.  The Id parameter is optional; in this case, AppCmd ‚Äã‚Äãwill generate the next available Id for the new site.  We also specified the binding and the physical path, which will be described below.  You can also specify additional parameters to assign values ‚Äã‚Äãto them. <br>  The bindings property uses the protocol / bindingInformation format, where bindingInformation is a protocol.  FTP uses the following IP format: PORT: HOSTHEADER.  You can specify multiple bindings using a comma for the binding between different values. <br>  We also specified the physicalPath property for the site.  Since the site itself does not have a physical path, this short form is used to create the root application, and the root virtual directory associated with the specified physical directory. <br>  If you do not specify the physical path - the site will be created without applications;  The application and virtual directory will need to be created explicitly. <br>  Well, move on and create the following application for our site: <br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD add app /site.name:MySite /<span class="hljs-built_in"><span class="hljs-built_in">path</span></span>:/app1 /physicalPath:C:\inetpub\mysite\app1 APP object "MySite/app1" added VDIR object "MySite/app1/" added</code> </pre><br>  The team created a new virtual directory "/ app1" for the application created earlier, a virtual directory pointing to "C: \ inetpub \ mysite \ app1".  The required path parameter defines the virtual path of the new application, and the required site.name parameter defines the site to which this application will belong.  The optional parameter physicalPath is a short form, very similar to the one for the site, which creates the root virtual directory along with the application. <br>  If you do not specify physicalPath, or add another virtual directory with a command such as the following: <br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD add vdir /app.name:"MySite/app1" /<span class="hljs-built_in"><span class="hljs-built_in">path</span></span>:/vdir1 /physicalPath:C:\inetpub\mysite\app1\vdir1 VDIR object "MySite/app1/vdir1" added</code> </pre><br>  then this command will create a new virtual directory, with the virtual path "/ vdir1" referring to the application created earlier and pointing to "C: \ inetpub \ mysite \ app1 \ vdir1" the required path defines the virtual path of the new virtual directory and the required app.name identifies the application to which this virtual directory will belong.  The physicalPath parameter points to the physical path to which the virtual directory will be associated. <br>  Finally, let's create a new application pool: <br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD add apppool /name:MyAppPool APPPOOL object "MyAppPool" added</code> </pre><br>  This command creates a new application pool called MyAppPool. <br>  For a more detailed study of sites, applications, virtual directories in IIS 7 and the various features available through AppCmd, you can contact <a href="http://mvolo.com/blogs/serverside/archive/2007/07/12/Creating-IIS7-sites_2C00_-applications_2C00_-and-virtual-directories.aspx">here.</a> <br><br><h5>  Configure sites, applications, virtual directories, and application pools. </h5><br>  Previously, we created a new website, added several applications and virtual directories.  Now we will use AppCmd ‚Äã‚Äãto change some properties of these objects.  All AppCmd ‚Äã‚Äãobjects support the following syntax for setting properties: <br><pre> <code class="dos hljs">APPCMD <span class="hljs-built_in"><span class="hljs-built_in">SET</span></span> &lt;OBJECT&gt; &lt;ID&gt; [/property:value]*</code> </pre><br>  First, let's see which applications are available on the server: <br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD list apps APP "Default Web Site/" (applicationPool:DefaultAppPool) APP "MySite/" (applicationPool:DefaultAppPool) APP "MySite/app1" (applicationPool:DefaultAppPool)</code> </pre><br>  Remember the two applications created earlier under the MySite website.  Both of these applications are configured to use the DefaultAppPool application pool.  Let's change the applicationPool property of our root MySite application / so that it uses the new application pool created earlier with the name MyAppPool <br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> app "MySite/" /applicationPool:MyAppPool APP object "MySite/" changed</code> </pre><br>  Thus, we changed the value of the applicationPool property of our application ‚ÄúMySite /‚Äù, and easily transferred our application to a new application pool. <br>  The purpose of such a transfer is that we can now change several parameters of the launch of the workflow with which our application will work, so that we can change some properties of the application pool ‚ÄúMyAppPool‚Äù.  Before changing it is useful, look at the available properties and their current values.  We can view the properties in detail like this: <br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD list apppool "MyAppPool" /text:* APPPOOL APPPOOL.NAME: MyAppPool managedPipelineMode: Integrated managedRuntimeVersion: v2.<span class="hljs-number"><span class="hljs-number">0</span></span> state: Started [add] name:"MyAppPool" queueLength:"<span class="hljs-number"><span class="hljs-number">1000</span></span>" autoStart:"true" enable32BitAppOnWin64:"false" managedRuntimeVersion:"v2.<span class="hljs-number"><span class="hljs-number">0</span></span>"&lt;identifier&gt; managedPipelineMode:"Integrated" passAnonymousToken:"true" [processModel] identityType:"NetworkService" userName:"" password:"" ... pingingEnabled:"true" ...</code> </pre><br><br>  Here are some of these properties.  The full list is not shown here. <br>  We are interested in the managedRuntimeVersion property, the value of which we will change to ‚Äúv1.1‚Äù in order to run our application in the application pool with asp.net v1.1.  Here is this command: <br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> apppool "MyAppPool" /managedRuntimeVersion:v1.<span class="hljs-number"><span class="hljs-number">1</span></span> APPPOOL object "MyAppPool" changed</code> </pre><br>  You can see above that there are properties available, and some of them are nested in another element.  For example, the process property is nested in processModel.  If you want to change the attached property, specify it completely like this: <br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> apppool "MyAppPool" /processModel.pingingEnabled:false</code> </pre><br><h5>  Other configuration items </h5><br>  Additionally, to control configuration properties using AppCmd ‚Äã‚Äãobjects, you can expose values ‚Äã‚Äãto any properties in any configuration section, including those that are AppCmd ‚Äã‚Äãobjects.  More on this will be discussed in the section "Working with Configuration". <br>  getting server status <br>  AppCmd ‚Äã‚Äãprovides an opportunity to get various information about server operation, including: <br><ul><li>  site status </li><li>  application pool status </li><li>  active server workflows </li><li>  current requests </li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In addition, some objects provide commands that allow you to monitor the running time status. </font><font style="vertical-align: inherit;">Commands like site object STOP, or application pool object RECYCLE.</font></font><br><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> View site and application pool </font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The state of the site and application pool is reflected in the state property of each object. </font><font style="vertical-align: inherit;">When we get a list of sites and application pools, the status is displayed on the standard output.</font></font> For example: <br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD list apppools DefaultAppPool APPPOOL "DefaultAppPool" (MgdVersion:v2.<span class="hljs-number"><span class="hljs-number">0</span></span>,MgdMode:Integrated,state:Started)</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The state property can be used when searching for sites or application pools that are currently in a particular state. </font><font style="vertical-align: inherit;">For example, to find all running application pools:</font></font><br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD list apppools /state:started APPPOOL "DefaultAppPool" (MgdVersion:v2.<span class="hljs-number"><span class="hljs-number">0</span></span>,MgdMode:Integrated,state:Started) APPPOOL "Classic .<span class="hljs-built_in"><span class="hljs-built_in">NET</span></span> AppPool" (MgdVersion:v2.<span class="hljs-number"><span class="hljs-number">0</span></span>,MgdMode:ISAPI,state:Started)</code> </pre><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> View workflows </font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Use the WP object to get a list of running workflows. </font></font><br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD list wp WP "<span class="hljs-number"><span class="hljs-number">3577</span></span>" (apppool:DefaultAppPool)</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Each WP object has an apppool.name property, which allows you to get all the workflows serving a specific application pool: </font></font><br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD list wp /apppool.name:DefaultAppPool WP "<span class="hljs-number"><span class="hljs-number">3577</span></span>" (apppool:DefaultAppPool)</code> </pre><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Examine current queries </font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The Request object allows you to examine the current requests processed by the server: </font></font><br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD list requests REQUEST "fb0000008000000e" (url:GET /wait.aspx?<span class="hljs-built_in"><span class="hljs-built_in">time</span></span>=<span class="hljs-number"><span class="hljs-number">10000</span></span>,<span class="hljs-built_in"><span class="hljs-built_in">time</span></span>:<span class="hljs-number"><span class="hljs-number">4276</span></span> msec,client:localhost)</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The list of requests can be filtered by criteria such as a site, application pool, workflow, or URL using the appropriate property as a filter. </font></font><br>  Here are some examples: <br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD list request /apppool.name:DefaultAppPool <span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD list requests /wp.name:<span class="hljs-number"><span class="hljs-number">3567</span></span> <span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD list requests /site.id:<span class="hljs-number"><span class="hljs-number">1</span></span></code> </pre><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Work with configuration </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">IIS 7 and later has an XML-based hierarchical configuration system, similar to the ASP.NET configuration system, which stores the server configuration in schematized XML sections. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The configuration can be at the server level in the ApplicationHost.config file or in the Web.config file that comes with the application. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AppCmd ‚Äã‚Äãallows you to fully view and change the configuration from the command line using the config object. </font><font style="vertical-align: inherit;">AppCmd ‚Äã‚Äãalso provides such useful functions as reading, locking, unlocking, searching.</font></font><br><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> View configuration </font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AppCmd ‚Äã‚Äãworks with configuration at the level of configuration sections. </font><font style="vertical-align: inherit;">Each section describes server functionality and may contain one or more items and collections. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The configuration can be set for any URL namespace, for example, for a site, application, or link. </font><font style="vertical-align: inherit;">Configuration parameters are set at a higher level, inherited at all lower levels, unless they are redefined at lower levels. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To view the effective configuration for a specific level, use the LIST command of the Config object, for example:</font></font><br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD list config &lt;URL&gt; /section:SectionName</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">where &lt;URL&gt; is the configuration path to be read. </font><font style="vertical-align: inherit;">For example, "Default Web Site /" or "Default Web Site / app1 / hello.html". </font><font style="vertical-align: inherit;">If nothing is specified, the server level configuration will be read. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For a detailed study of the hierarchy and how to build a configuration for use with AppCmd ‚Äã‚Äãand in other programs, you can read </font></font><a href="http://mvolo.com/blogs/serverside/archive/2007/07/21/Anatomy-of-an-IIS7-configuration-path.aspx"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> . </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The section parameter indicates the section to be read. </font><font style="vertical-align: inherit;">If you do not specify, then the entire configuration will be displayed, acting at the specified URL. </font><font style="vertical-align: inherit;">For example, the following command will show the entire configuration applied for the Default Web Site root application:</font></font><br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD list config "Default Web Site/"</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> To show a specific section and use the following command: </font></font><br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD list config "Default Web Site/" /section:aspx &lt;system.webServer&gt; &lt;asp&gt; &lt;session /&gt; &lt;comPlus /&gt; &lt;cache /&gt; &lt;limits /&gt; &lt;/asp&gt; &lt;/system.webServer&gt;</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">By default, AppCmd ‚Äã‚Äãshows a configuration that is explicitly set. </font><font style="vertical-align: inherit;">If you want to see the calculated configuration, including the inherited configuration, specify the / config: * parameter</font></font><br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD list config "Default Web Site/" /section:asp /config:*</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> To view the list of available sections use the following command: </font></font><br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD list config /section:?</code> </pre><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Editing configuration properties </font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In AppCmd, each section is represented by a configuration object that contains properties that correspond to the configuration section. </font><font style="vertical-align: inherit;">Use the SET command to change these properties. </font><font style="vertical-align: inherit;">The syntax is: </font></font><br> <code>APPCMD set config &lt;URL&gt; /section:SectionName [ /property:value ]+</code> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">&lt;URL&gt; is an optional parameter; it defines the configuration path to which these changes will be applied. </font><font style="vertical-align: inherit;">If not specified, the changes will be applied at the server level. </font><font style="vertical-align: inherit;">And will be inherited by all other URLs. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The section parameter is required, it defines the section to be edited. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For example, you can set the appAllowClientDebug property of the asp section for </font></font><a href="http://localhost/app1"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">localhost / app1</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> as follows:</font></font><br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> config "http://localhost/app1" /section:asp /appAllowClientDebug:false CONFIG object "asp" changed</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> You can set the property nested under the element of the configuration section using this element with the path specified: </font></font><br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> config "http://localhost/app1" /section:asp /limits.requestQueueMax:<span class="hljs-number"><span class="hljs-number">4000</span></span> CONFIG object "asp" changed</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Specify several properties on the same command line to edit several values ‚Äã‚Äãat once within the same section. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To view all the properties that can be edited within one section, use the command:</font></font><br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> config /section:asp /?</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Note: the asp section is closed for editing by default, so executing this command will return a lock violation error. </font><font style="vertical-align: inherit;">But you can first remove the lock by adjusting the configuration at the server level, omitting &lt;URL&gt;, or transfer them to the place of the server level tags using </font></font><code>/commit: apphost</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">. </font><font style="vertical-align: inherit;">See the configuration control layout later in the article.</font></font><br><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Editing configuration collections </font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AppCmd ‚Äã‚Äãprovides the ability to edit configuration collections. A configuration collection can contain several elements ‚Äî for example, the </font></font><code>system.webServer/modules</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">section contains a list of modules that will be executed on the server. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To change a property in a list item, you need to concretize the collection item using the item index, along with an indication of the path. An index is an expression that uses the value of keys to point to a specific item in a collection. The index has the following format: The </font></font><br> <code>[key1='value1',key2='value2',...]</code> <br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">number of keys required to specify a particular element depends on the type of collection, but in most cases one is enough. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For example, to change the type of a property on a collection item with the key name equal to "FormsAuthentication" run:</font></font><br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> config /section:system.webServer/modules /[name='FormsAuthentication'].<span class="hljs-built_in"><span class="hljs-built_in">type</span></span>:System.Web.Security.FormsAuthenticationModule</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">To add a new item to the collection, add a "+" sign to the beginning of the item name. </font><font style="vertical-align: inherit;">Instead of an index, list the values ‚Äã‚Äãfor each property. </font><font style="vertical-align: inherit;">And yet, non-key properties can also be included in the collection index. </font><font style="vertical-align: inherit;">For example, you can add a new item to the list of modules:</font></font><br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> config /section:system.webServer/modules /+[name='MyModule',<span class="hljs-built_in"><span class="hljs-built_in">type</span></span>='MyType']</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> To remove an item from the list - it is necessary to indicate at the beginning the "-" </font></font><br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> config /section:system.webServer/modules /-[name='MyModule']</code> </pre><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Control of setting location </font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The configuration system is hierarchical, and allows changes to be recorded at various levels starting from the server level ( </font></font><code>ApplicationHost.config</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">), ending with the provided file of </font></font><code>web.config</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the site, application, virtual directory. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">When a change is written to any level, this change is inherited by all URLs that are lower than this level. For example, a change made to the </font></font><code>Web.config</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">root site will be applied to the entire site. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">By default, AppCmd ‚Äã‚Äãwrites changes at the level that was selected for the change. For example, if you change the value for "Default Web Site /," the change will be written to the Web.config file located in the root of the site.</font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">However, it is possible to change it at a higher level, and apply this change on a set of URLs using the location tag. </font><font style="vertical-align: inherit;">For example, an application may contain a configuration that is applicable on one of the application directories. </font><font style="vertical-align: inherit;">AppCmd ‚Äã‚Äãprovides this capability using the commit parameter. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The commit parameter can have the following values:</font></font><br><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> (omitted) is the default value, changes are applied at the same level at which they are set. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The url is the same as the default. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> site - changes are written to the root web.config of the site </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> app - changes are written to the root of the application in Web.config. </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> apphost - changes are written at the server level in applicationHost.config </font></font></li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> &lt;PATH&gt; - changes are written to the specified file. </font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For example, this command will disable the ability to view the contents of the directory in the application and record the changes at </font></font><code>web.config</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">the site level:</font></font><br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD <span class="hljs-built_in"><span class="hljs-built_in">set</span></span> config http://localhost/app1/ /section:directoryBrowse /enabled:false /commit:site</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">You can read more about configuring IIS and storing changes </font></font><a href="http://mvolo.com/blogs/serverside/archive/2007/07/21/Anatomy-of-an-IIS7-configuration-path.aspx"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> .</font></font><br><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Locking and unlocking configuration </font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The configuration system allows you to block a section on one of the levels, preventing them from changing at lower levels. </font><font style="vertical-align: inherit;">This can be used to prevent the application from changing the settings that the administrator wants to apply on the entire server. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">By default, most of the IIS settings are exposed, for editing at the server level. </font><font style="vertical-align: inherit;">To be able to edit them, you need to open them. </font><font style="vertical-align: inherit;">AppCmd ‚Äã‚Äãprovides this feature:</font></font><br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD unlock config /section:asp</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> and vice versa, to close the possibility of changes: </font></font><br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD lock config /section:asp</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Keep in mind that when you close a section, some applications may already have changes in that section, which will result in an error accessing a section that is closed. </font></font><br><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Configuration Search </font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AppCmd ‚Äã‚Äãcan search in the presented hierarchy of configurations for all sections in which a particular property changes or has a specified value. </font><font style="vertical-align: inherit;">The ability to search for a configuration can be used to search for any function that has been enabled, or to make sure that the requirements of the current environment are met. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Find on the server all the places where the configuration is defined as follows:</font></font><br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD search config</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> To search for all places for a given configuration path where the settings of a given site change, add a path: </font></font><br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD search config "Default Web Site/"</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> In order to find all the configurations where the given section changes: </font></font><br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD search config "Default Web Site/" /section:directoryBrowse</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> To find the places where the value of a specific section property changes: </font></font><br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD search config "Default Web Site/" /section:directoryBrowse /enabled</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Finally, to find all the places where the property is set to the specified value: </font></font><br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD search config "Default Web Site/" /section:directoryBrowse /enabled:true</code> </pre><br><h4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Work with output </font></font></h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">You mentioned earlier that the output of the LIST command is a list of object instances. </font><font style="vertical-align: inherit;">AppCmd ‚Äã‚Äãallows you to use different types of output that allow you to control the level of detail on the output objects.</font></font><br><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Standard output </font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Let's see the output of the LIST command for sites. </font><font style="vertical-align: inherit;">By default, AppCmd ‚Äã‚Äãuses a compact output format:</font></font><br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD list sites SITE "Default Web Site" (id:<span class="hljs-number"><span class="hljs-number">1</span></span>,bindings:HTTP/*:<span class="hljs-number"><span class="hljs-number">80</span></span>:,state:Started) SITE "Site1" (id:<span class="hljs-number"><span class="hljs-number">2</span></span>,bindings:http/*:<span class="hljs-number"><span class="hljs-number">81</span></span>:,state:Started) SITE "Site2" (id:<span class="hljs-number"><span class="hljs-number">3</span></span>,bindings:http/*:<span class="hljs-number"><span class="hljs-number">82</span></span>:,state:Stopped)</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">With this output, each object is displayed in one line, and contains information about the type (SITE), identifier ("Default Web Site"). </font><font style="vertical-align: inherit;">Several common or important properties are also found in the output (id, bindings, and state of the site object)</font></font><br><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Detailed output </font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Most objects support significantly more properties than those found in standard output. </font><font style="vertical-align: inherit;">To view all the properties of an object, you must specify the text: * parameter, and the properties of each instance will appear in the tree format:</font></font><br><pre> <code class="dos hljs">APPCMD list site "Default Web Site" /text:* SITE SITE.NAME: Default Web Site SITE.ID: <span class="hljs-number"><span class="hljs-number">2</span></span> bindings: http/*:<span class="hljs-number"><span class="hljs-number">80</span></span>: state: Started ...</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> In the example above, the output was truncated, the actual output contains many more lines. </font></font><br><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Output for other command line utilities </font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">AppCmd ‚Äã‚Äãprovides the ability to display only the value of a given property, each instance. </font><font style="vertical-align: inherit;">Set the property value in the text: parameter. </font><font style="vertical-align: inherit;">For example, the following command will return the virtual directories of all applications, show only the physicalPath property of each element:</font></font><br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD list vdirs /text:physicalPath C:\inetpub\wwwroot C:\inetpub\vdir1 D:\vdir2</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Of course, you can show any specific property of the listed object types. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Sometimes very successfully, you can use the output of AppCmd ‚Äã‚Äãwith other existing commands and shell commands, such as for and findstr.exe. </font><font style="vertical-align: inherit;">These commands work better if the objects of interest are located on a separate line. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">As an example, imagine a command that generates the contents of each IIS virtual directory. </font><font style="vertical-align: inherit;">This command requires a list of physical paths of each virtual directory to be entered, and execute DIR, each such directory to use FOR to loop through them.</font></font><br><pre> <code class="dos hljs"><span class="hljs-keyword"><span class="hljs-keyword">FOR</span></span> /F %f <span class="hljs-keyword"><span class="hljs-keyword">IN</span></span> ('<span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD list vdir /text:physicalPath') <span class="hljs-keyword"><span class="hljs-keyword">DO</span></span> <span class="hljs-keyword"><span class="hljs-keyword">CALL</span></span> <span class="hljs-built_in"><span class="hljs-built_in">DIR</span></span> %f</code> </pre><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> Configuration output </font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Objects contain configuration data that is part of the corresponding configuration section. </font><font style="vertical-align: inherit;">The Config object is the main example of this, and is the usual wrapper over the IIS configuration system. </font><font style="vertical-align: inherit;">Any object returned by the config command is a configuration section. </font><font style="vertical-align: inherit;">Other objects, such as a site, contain configuration information in the form of their properties. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">If you want to display the configuration information of the returned objects in XML format - use the config parameter. </font><font style="vertical-align: inherit;">To show the XML configuration for the site, use:</font></font><br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD list site "Default Web Site" /config &lt;site name="Default Web Site" id="<span class="hljs-number"><span class="hljs-number">1</span></span>"&gt; &lt;bindings&gt; &lt;binding protocol="HTTP" bindingInformation="*:<span class="hljs-number"><span class="hljs-number">80</span></span>:" /&gt; ...</code> </pre><br><h5><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> XML output </font></font></h5><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">The command also maintains its own xml output format, which generates the generated xml for the objects returned by the command. </font><font style="vertical-align: inherit;">This opens up interesting possibilities for us, which distinguishes from all other command line utilities presented to us earlier by the IIS team.</font></font><br><ul><li>    .      ,     AppCmd,     .           . </li><li>    .          (,  10 000 )     -     ,   .         XML,      . </li><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Export data to other programs. </font><font style="vertical-align: inherit;">The AppCmd ‚Äã‚ÄãXML data format allows them to be used in other programs for processing or creating reports. </font><font style="vertical-align: inherit;">For example, AppCmd ‚Äã‚Äãcan be used with xslt conversion to generate an html report, import it into SQL server for further processing, or use ADO.NET for program processing.</font></font></li></ul><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> The following command lists the sites in xml format: </font></font><br><pre> <code class="dos hljs"><span class="hljs-variable"><span class="hljs-variable">%systemroot%</span></span>\system32\inetsrv\APPCMD list sites /xml</code> </pre><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">For more in-depth study you can read </font></font><a href="http://mvolo.com/blogs/serverside/archive/2007/06/19/Do-complex-IIS-management-tasks-easily-with-AppCmd-command-piping.aspx"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here.</font></font></a> <br><br><h4>  Total </h4><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">In this review, we introduced you to various actionable commands available in the AppCmd ‚Äã‚ÄãIIS 7 and higher command. </font></font><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">You can also get acquainted with various ways of managing the server using the command line </font></font><a href="http://mvolo.com/blogs/serverside/archive/tags/AppCmd/default.aspx"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">here.</font></font></a> </div><p>Source: <a href="https://habr.com/ru/post/145476/">https://habr.com/ru/post/145476/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../145467/index.html">Fundamentals of the approach to the construction of universal intelligence. Part 2</a></li>
<li><a href="../145468/index.html">Great review: Android applications for EURO 2012</a></li>
<li><a href="../145469/index.html">New map in API 2GIS and online version</a></li>
<li><a href="../145473/index.html">Cisco UCS Blade: a new approach to building a data center</a></li>
<li><a href="../145475/index.html">What is the most programming?</a></li>
<li><a href="../145478/index.html">Windows on Macs: Not so rare</a></li>
<li><a href="../145479/index.html">Digital startups. Interview with Gaidar Magdanurov</a></li>
<li><a href="../145481/index.html">If you believe in copyright, then there is no God</a></li>
<li><a href="../145482/index.html">Some statistics WP7 applications for the Russian and English markets</a></li>
<li><a href="../145484/index.html">How to find an email marketing team</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>