<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Calling web services and web architecture methods.net</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="This note describes how easy it is to call a .Net web service (written, for example, in an asp.net project) using the jQuery library. I had a little d...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Calling web services and web architecture methods.net</h1><div class="post__text post__text-html js-mediator-article">  This note describes how easy it is to call a .Net web service (written, for example, in an asp.net project) using the jQuery library.  I had a little doubt about where to put this note, here or on the .Net blog, and finally decided that the topic of the note is more about jQuery and its features than the topic of .Net programming. <br><br>  So, let's begin. <br><a name="habracut"></a><br><h1>  .Net </h1><br><blockquote>  Performance tested on .net framework 3.5, in versions .net below 3.0, this example may not work. <br></blockquote><br>  The first thing you need to know the features of web services written in .net.  For information, it is better to contact the source and in our case it will be ScottGu, the architect of .Net.  His blog has a wonderful article ‚ÄúJSON Hijacking and How ASP.NET AJAX 1.0 Avoids these Attacks‚Äù. <br><br>  <a href="http://weblogs.asp.net/scottgu/archive/2007/04/04/json-hijacking-and-how-asp-net-ajax-1-0-mitigates-these-attacks.aspx">weblogs.asp.net/scottgu/archive/2007/04/04/json-hijacking-and-how-asp-net-ajax-1-0-mitigates-these-attacks.aspx</a> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      This article describes the requirements and conditions for calling methods marked with the [WebMethod] attribute that the AJAX.NET architecture also performs. <br><br>  Conditions, in fact, only two: <br>  - use only POST requests; <br>  - the request should contain the following header <br>  Content-Type: application / json;  charset = utf-8. <br><br><h1>  Web service </h1><br>  First, let's write a simple web service that receives the login text and returns the boolean value of whether or not the login is in the database. <br><blockquote>  <font color="black">[WebMethod]</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">public</font> <font color="#0000ff">bool</font> CheckLogin ( <font color="#0000ff">string</font> login)</font> <font color="black"><br></font>  <font color="black">{</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">bool</font> result = <font color="#0000ff">false</font> ;</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">if</font> (login.Length&gt; 0)</font> <font color="black"><br></font>  <font color="black">{</font> <font color="black"><br></font>  <font color="black">ORMDataContext db = ORMDataContext.GetDB ();</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">var</font> user = BisORM.User.GetUser (login);</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">if</font> (user! = <font color="#0000ff">null</font> )</font> <font color="black"><br></font>  <font color="black">{</font> <font color="black"><br></font>  <font color="black">result = <font color="#0000ff">true</font> ;</font> <font color="black"><br></font>  <font color="black">}</font> <font color="black"><br></font>  <font color="black">}</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">return</font> result;</font> <font color="black"><br></font>  <font color="black">}</font> <font color="black"><br></font>  <font color="gray">* This source code was highlighted with <a href="http://poison.qsh.ru/"><font color="gray">Source Code Highlighter</font></a> .</font> </blockquote><br><br>  As you can see, this method is very simple; it uses Linq to SQL and the generated ORM (ORMDataContext) to determine if the login passed in the database. <br><br><h1>  jQuery </h1><br>  There are several functions for working with ajax in jQuery, one of which just fits all our requirements.  This is a function of $ .ajax.  I will not dwell on the description of this function and all its parameters, this data can be easily found on the official project website in the <a href="http://docs.jquery.com/">documentation</a> section.  Define the following javascript helper function: <br><blockquote>  <font color="black"><font color="#0000ff">function</font> ExecuteService ( <font color="#0000ff">params</font> , url, callbackSuccess, callbackError)</font> <font color="black"><br></font>  <font color="black">{</font> <font color="black"><br></font>  <font color="black">$ .ajax ({</font> <font color="black"><br></font>  <font color="black">type: <font color="#A31515">"POST"</font> ,</font> <font color="black"><br></font>  <font color="black">url: url,</font> <font color="black"><br></font>  <font color="black">contentType: <font color="#A31515">‚Äúapplication / json;</font></font>  <font color="black"><font color="#A31515">charset = utf-8 "</font> ,</font> <font color="black"><br></font>  <font color="black">dataType: <font color="#A31515">‚Äújson‚Äù</font> ,</font> <font color="black"><br></font>  <font color="black">data: <font color="#0000ff">params</font> ,</font> <font color="black"><br></font>  <font color="black">success: callbackSuccess,</font> <font color="black"><br></font>  <font color="black">error: callbackError</font> <font color="black"><br></font>  <font color="black">});</font> <font color="black"><br></font>  <font color="black">}</font> <font color="gray">* This source code was highlighted with <a href="http://poison.qsh.ru/"><font color="gray">Source Code Highlighter</font></a> .</font> </blockquote><br><br>  The ExecuteService function accepts the following parameters: <br>  - params - JSON string with parameters that must be passed to call the web service; <br>  - url - the full address of the web service with the web method; <br>  - callbackSuccess - the function that will be called when the web method is successful; <br>  - callbackError - the function that will be called when an error occurs during the execution of the web method. <br><br>  It should be noted that one parameter with the result of the web method in the format of a JSON string will be passed to callbackSuccess, and three parameters will be passed to the callbackError: <br>  - a copy of the request; <br>  - text message; <br>  - description of the error. <br><br>  As you can see, ExecuteService fulfills all the requirements for the query that .Net puts forward and which were described above: a post-request is formed, the desired value is assigned to the ‚ÄúcontentType‚Äù header. <br><br><h1>  Using </h1><br>  Now, finally, let's write the code that interacts with our web service via jQuery: <br><blockquote>  <font color="black"><font color="#0000ff">function</font> CheckLogin (input, callbackResult, callbackError)</font> <font color="black"><br></font>  <font color="black">{</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">var</font> login = $ (input) [0] .value;</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">if</font> (login.length&gt; 0)</font> <font color="black"><br></font>  <font color="black">{</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">var</font> <font color="#0000ff">params</font> = <font color="#A31515">"{login: '"</font> + login + <font color="#A31515">"'}"</font> ;</font> <font color="black"><br></font>  <font color="black">ExecuteService (</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">params</font> ,</font> <font color="black"><br></font>  <font color="black"><font color="#A31515">"LoginService.asmx / CheckLogin"</font> ,</font> <font color="black"><br></font>  <font color="black">callbackResult,</font> <font color="black"><br></font>  <font color="black">callbackError</font> <font color="black"><br></font>  <font color="black">);</font> <font color="black"><br></font>  <font color="black">}</font> <font color="black"><br></font>  <font color="black">}</font> <font color="black"><br></font>  <font color="gray">* This source code was highlighted with <a href="http://poison.qsh.ru/"><font color="gray">Source Code Highlighter</font></a> .</font> </blockquote><br><br>  The CheckLogin JS function accepts through the textbox id parameters (in the form of "#id"), into which the login is entered, as well as two functions that determine what to do when receiving the result and when an error occurs.  Notice the code <br><br>  var params = "{login: '" + login + "'}"; <br><br>  - this is the formation of a JSON string to transfer the parameter to our web method, which, I recall, is defined as: <br><br>  public bool CheckLogin (string login) <br><br><blockquote>  It should be noted that in the case when your web method does not accept any parameters, you need to write var params = "{}"; but not var params = "";.  You should also know that at least in Firefox it is permissible to pass {login: ‚Äútest‚Äù}, but in IE it will not work, so you need to use single quotes {login: 'test'} <br></blockquote><br>  We also define functions for passing callbackResult, callbackError: <br><blockquote>  <font color="black"><font color="#0000ff">function</font> onCheckLogin (msg)</font> <font color="black"><br></font>  <font color="black">{</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">if</font> (msg.d)</font> <font color="black"><br></font>  <font color="black">{</font> <font color="black"><br></font>  <font color="black">$ ( <font color="#A31515">"#loginState"</font> ) .text ( <font color="#A31515">"OK"</font> ) .css ( <font color="#A31515">"color"</font> , <font color="#A31515">"green"</font> );</font> <font color="black"><br></font>  <font color="black">}</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">else</font></font> <font color="black"><br></font>  <font color="black">{</font> <font color="black"><br></font>  <font color="black">$ ( <font color="#A31515">"#loginState"</font> ) .text ( <font color="#A31515">"Invalid login"</font> ) .css ( <font color="#A31515">"color"</font> , <font color="#A31515">"red"</font> );</font> <font color="black"><br></font>  <font color="black">}</font> <font color="black"><br></font>  <font color="black">}</font> <font color="black"><br></font>  <font color="black"><font color="#0000ff">function</font> onError (XMLHttpRequest, textStatus, errorThrown)</font> <font color="black"><br></font>  <font color="black">{</font> <font color="black"><br></font>  <font color="black">$ ( <font color="#A31515">"#loginMessage"</font> ) .text ( <font color="#A31515">"Error performing an AJAX request. Try reloading the page."</font> );</font> <font color="black"><br></font>  <font color="black">}</font> <font color="gray">* This source code was highlighted with <a href="http://poison.qsh.ru/"><font color="gray">Source Code Highlighter</font></a> .</font> </blockquote><br><br>  Pay attention to msg.d.  This is where the value that will return after the execution of the web method will lie.  It is also necessary to clarify that #loginState is the id of the element, to display the result of checking the login, and #loginMessage is the id of the element, to display an error message. <br>  Finally, we come to the final touch, we connect to the textbox a focus loss event handler: <br><blockquote>  <font color="black">$ ( <font color="#A31515">"#txtLogin"</font> ) .blur ( <font color="#0000ff">function</font> () {CheckLogin ( <font color="#A31515">"#txtLogin"</font> , onCheckLogin, onError);}))</font> <font color="gray">* This is a code that was highlighted with <a href="http://poison.qsh.ru/"><font color="gray">Source Code Highlighter</font></a> .</font> </blockquote><br><br>  As you can see from the code, using the jQuery functions, the OnBlur event handler is registered for the control, which is declared as <br><blockquote>  <font color="black"><font color="#0000ff">&lt;</font> <font color="#800000">input</font> <font color="#ff0000">id</font> <font color="#0000ff">= "txtLogin"</font> <font color="#ff0000">type</font> <font color="#0000ff">= "text"</font> <font color="#0000ff">/&gt;</font></font> <font color="gray">* <a href="http://poison.qsh.ru/"><font color="gray">Source Code Highlighter</font></a> .</font> </blockquote><br><br>  Now, when the user enters the login text in the input field and moves to another element, for example to enter a password, a request will be automatically sent to the web server to determine the correctness of the login entry. <br><br><h1>  Conclusion </h1><br>  jQuery makes it very easy to access any .Net web services and web methods.  In this note, the requirements for such requests were defined and a function was implemented that transparently calls .Net methods accepting only the url and parameters.  An example of the use of this function for the automatic validation of usernames entered by the user was also considered. <br><br>  PS: in addition, you can read the following article on this topic (only for .Net blog subscribers) <br>  ajax.net vs jquery.ajax <br>  <a href="http://habrahabr.ru/blog/net/44190.html">habrahabr.ru/blog/net/44190.html</a> </div><p>Source: <a href="https://habr.com/ru/post/27054/">https://habr.com/ru/post/27054/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../270527/index.html">Official Firebird 3.0 Release Candidate 1 and Beta Documentation for Firebird 3.0</a></li>
<li><a href="../270529/index.html">As we wrote AI for the Jackal, and why he has schizophrenia</a></li>
<li><a href="../27053/index.html">A descendant of the "obscene" Trojan or how they steal FTP passwords.</a></li>
<li><a href="../270531/index.html">About Parboiled (Part 2)</a></li>
<li><a href="../270537/index.html">How I became an android developer without a core education, simultaneously hindering concrete</a></li>
<li><a href="../270541/index.html">How to calculate the range of communication equipment Ubiquiti. New version of the calculator AirLink</a></li>
<li><a href="../270543/index.html">TensorFlow: Google's machine learning, now smarter for everyone</a></li>
<li><a href="../270545/index.html">Declarative C ++ programming</a></li>
<li><a href="../270547/index.html">Hidden dependencies as a design ‚Äúsmell‚Äù</a></li>
<li><a href="../270549/index.html">How we moved the disk space of hundreds of bank branches to a single storage system in Moscow without losing LAN speeds in the field</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>