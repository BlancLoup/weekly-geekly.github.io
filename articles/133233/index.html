<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>A simple way to transfer tabular data from PHP to Excel</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="By writing this topic I pushed one note about generating xls in PHP . 
 The method presented in that note is really very simple, but may not always be...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>A simple way to transfer tabular data from PHP to Excel</h1><div class="post__text post__text-html js-mediator-article"> By writing this topic I pushed one note <a href="http://habrahabr.ru/blogs/php/133093/">about generating xls in PHP</a> . <br>  The method presented in that note is really very simple, but may not always be convenient. <br>  There are many other ways to transfer tabular data from PHP to Excel, I will describe the one that seemed to me the most simple and functional.  It should be especially noted that I‚Äôm not talking about generating the xls file, but only inviting the user to open the data with Excel so that users who are not experienced in programming will not notice fraud. <br><a name="habracut"></a><br>  So, the first thing to do is to place on our page a link to the script that generates the following headings: <br> <code>header("Pragma: public"); <br> header("Expires: 0"); <br> header("Cache-Control: must-revalidate, post-check=0, pre-check=0"); <br> header("Cache-Control: private", false); <br> header("Content-Type: application/x-msexcel"); <br> header("Content-Disposition: attachment; filename=\"" . iconv('UTF-8', 'CP1251', $object-&gt;getFileName()) . "\";"); <br> header("Content-Transfer-Encoding: binary"); <br> header("Content-Length: " . $object-&gt;getFileSize()); <br></code> <br>  $ object is a spherical object in a vacuum that each reader realizes in the way he likes.  The purpose of getFileName () and getFileSize () getters is clear from the names.  It is worth highlighting one non-obvious nuance (thanks to <a href="http://habrahabr.ru/users/savostin/">savostin</a> for reminding about this) - getFileName () can of course return any file name, but if you want the browser to suggest opening the received content in Excel, then the file extension should be xls. <br>  I haven‚Äôt told anything new yet, all of this has been invented before me, however, as well as what will be described below. <br>  As was rightly noted in the comments on the note <a href="http://habrahabr.ru/blogs/php/133093/">about xls generation in PHP</a> , Excel works much faster with XML.  But the most important advantage, perhaps, is still not in speed, but in much wider possibilities.  I will not go deeper into the wilds, but will only give a simple example, and a link to a detailed description of all the tags. <br><br>  So, after the headers are generated, we need to give the user the actual data.  I usually wrap the table generation in a separate method: <br> <code>echo $object-&gt;getContent(); <br></code> <br>  And I generate the table using Smarty: <br><pre> &lt;? xml version = "1.0"?&gt;
 &lt;? mso-application progid = "Excel.Sheet"?&gt;
 &lt;Workbook xmlns = "urn: schemas-microsoft-com: office: spreadsheet" xmlns: o = "urn: schemas-microsoft-com: office: office" xmlns: x = "urn: schemas-microsoft-com: office: excel "xmlns: ss =" urn: schemas-microsoft-com: office: spreadsheet "xmlns: html =" http://www.w3.org/TR/REC-html40 "&gt;
	 &lt;Styles&gt;
  		 &lt;Style ss: ID = "bold"&gt;
			 &lt;Font ss: Bold = "1" /&gt;
		 &lt;/ Style&gt;
 	 &lt;/ Styles&gt; 
	 &lt;Worksheet ss: Name = "WorksheetName"&gt;
		 &lt;Table&gt;
			 &lt;Row&gt;
				 {foreach from = $ data.header item = caption}
					 &lt;Cell ss: StyleID = "bold"&gt; &lt;Data ss: Type = "String"&gt; {$ caption.columnName} &lt;/ Data&gt; &lt;/ Cell&gt;
				 {/ foreach}
			 &lt;/ Row&gt; 
			 {foreach from = $ data.content item = row}	
				 &lt;Row&gt;
					 {foreach from = $ row item = col}
						 &lt;Cell&gt; &lt;Data ss: Type = "String"&gt; {$ col} &lt;/ Data&gt; &lt;/ Cell&gt;
					 {/ foreach}
				 &lt;/ Row&gt;
			 {/ foreach}
		 &lt;/ Table&gt;
	 &lt;/ Worksheet&gt;
 &lt;/ Workbook&gt;
</pre><br>  As can be seen from the code, an array of $ data containing two arrays is passed to the template - the table header row and the data itself. <br>  It is worth noting that using a template engine only for generating XML is somewhat expensive, and you can get XML in many other ways.  In my particular case, the generation of XML is just a small bun in a large project, where you can‚Äôt do without a template engine. <br><br>  As an example, I gave a simple table, if you wish, you can manipulate a much larger number of attributes.  This is especially nice if you consider that no third-party libraries are required for implementation. <br>  The described method has been working on one project for several years and no user has yet suspected that the data it opens is not an MS Office document. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      You can read more about the XML structure used in MS Excel in <a href="http://msdn.microsoft.com/en-us/library/aa140062%2528v%3Doffice.10%2529.aspx">MSDN XML Spreadsheet Reference</a> </div><p>Source: <a href="https://habr.com/ru/post/133233/">https://habr.com/ru/post/133233/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../133221/index.html">MTS subscribers, change the password from the Internet Assistant</a></li>
<li><a href="../133227/index.html">Yahoo has disabled Site Explorer</a></li>
<li><a href="../133229/index.html">Agile in customized web development</a></li>
<li><a href="../133230/index.html">Facebook is preparing its own phone</a></li>
<li><a href="../133231/index.html">Google Reader and the non-working Share button in the record</a></li>
<li><a href="../133234/index.html">Spam in October 2011: Elections - Elections, Spammers - ...</a></li>
<li><a href="../133235/index.html">Writing a modular application on .Net Framework</a></li>
<li><a href="../133236/index.html">Normal offline documentation</a></li>
<li><a href="../133237/index.html">Little known Java features</a></li>
<li><a href="../133239/index.html">Caching images on the SD card</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>