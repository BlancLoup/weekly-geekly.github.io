<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Determination of physical constants with the help of STM32 and LED</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Introduction 
 A LED is a semiconductor device that emits electromagnetic waves of the visible or close range. His work is based on the effect of char...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Determination of physical constants with the help of STM32 and LED</h1><div class="post__text post__text-html js-mediator-article"><h4>  Introduction </h4><br>  A LED is a semiconductor device that emits electromagnetic waves of the visible or close range.  His work is based on the effect of charge carrier recombination in a semiconductor transition with the emission of photons (a full theoretical explanation can be found in the relevant books on physics, it is not described here).  The basic electrical and optical properties (for a given construction) are determined by the fundamental physical constants, the indirect measurement of which I will describe in this article.  Namely, as a result, the value of the elementary charge (electron charge) and the Planck constant are determined. <br><br>  I have long wanted to study microcontrollers and understand programming for them, so I decided to do such an experiment.  His results were successfully presented as a question of choice in the physics exam a couple of weeks ago. <br><a name="habracut"></a><br><h4>  Microcontroller selection </h4><br>  Since such an idea came to me shortly before the exam, it was necessary to figure out and implement a ready-made working scheme in just a couple of days.  I used to have absolutely no experience with microcontrollers, so I chose information from various articles and forums.  As a result, I stopped on the 32-bit ARM Cortex family from ST - STM32.  There is a rather large assortment of debug boards on such controllers that contain the most necessary things in a convenient form: the processor itself, a simple strapping, a USB debugger (STLink).  I took the basic <a href="http://www.st.com/web/catalog/tools/FM116/SC959/SS1532/PF250863">STM32VLDISCOVERY</a> based on the <a href="http://www.st.com/web/en/catalog/mmc/FM141/SC1169/SS1031/LN775/PF216844">STM32F100RB</a> controller.  Key features: 8 KB of RAM, 128 KB of Flash, 24 MHz by default, all ADC / DAC, timers, dozens of GPIO pins, as well as other interfaces.  Programs are usually written in C, although of course both assembler and C ++ are possible. <br><br><h4>  Connect and get started </h4><br>  I didn‚Äôt manage to start this device under Linux at the time (then it really worked), so I used the <a href="http://www.coocox.org/coocox_coide.htm">CooCox CoIDE</a> environment for Windows - it has ready-made settings and an example for just such a debugging board like mine.  Actually, there were no problems with the connection or with the compilation in it - everything worked right away. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      To control the processor and peripherals, there is a sufficient choice of libraries: CMSIS from ARM and ST, StdPeriph from ST, library from CooCox and others.  In general, now the use of CMSIS seems to be the most correct and even simple for me: it provides definitions of the structures and constants used that correspond to the datasheet.  However, since the writing of this project was happening in a hurry, I did not even notice how I used all three of these libraries there :) Of course, knowing the internal structure, you can quite easily transfer all this to the basic CMSIS.  Tutorials for the start of development for STM32 and so lacking, so I will not dwell on this anymore. <br><br><h4>  Schematic diagram </h4><br>  Since the Discovery board is powered by USB (5 V, as well as a 3.3 V stabilizer), the measuring part of the circuit is powered from the same source.  Of the additional details - 3 resistors, 1 capacitor, 1 transistor, and of course the LEDs.  The electrical circuit is very simple, and I soldered it in a mounted manner - everything kept on the conclusions of the elements: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/adf/8f5/d5d/adf8f5d5d445a017bc68f391af994f0e.jpg" alt="image"><br><br>  Here, the switch figuratively indicates the connection to the pin of the controller, to which 0 or 1 is applied. A pull-up to 5 V is used, since  in spite of the fact that most pins support the supply of 5 V to them, they can only issue 3.3.  Here, respectively, at zero on the pin, the voltage will be 0, and at one - almost 5 V. The capacitor provides a smooth increase and decrease in voltage for a few seconds.  The pins labeled "ADC" are connected to any two inputs of the microcontroller's ADC, and provide a measurement of both voltage and current of the LED: <img src="https://habrastorage.org/getpro/habr/post_images/650/37a/3e9/65037a3e98871b9f886a94e509b8b148.png" alt="image"><br><br><h4>  Indication </h4><br>  Of course, you can simply send all the data to a computer, and then process it there, but I wanted to display information on the spot.  For this, I used the usual two-line text display like this: <img src="https://habrastorage.org/getpro/habr/post_images/ad9/a4e/0fa/ad9a4e0fab5566c6ac64f60141b32001.jpg" alt="image"><br>  To transfer data to it, 6 GPIO pins are sufficient, and from the software side, the fastest way is to use any library.  I took the driver for HD44780 (this is the controller in the display), which connects to CooCox directly from the menu.  It‚Äôs also easy to write such a driver (which I, by the way, did later), but longer. <br><br><h4>  Measurements </h4><br>  From the theory of semiconductors it is known (you can read in textbooks) that for small values ‚Äã‚Äãof the current through the pn junction, as far as saturation is far away, the dependence of the current on voltage is exponential: <img src="https://habrastorage.org/getpro/habr/post_images/c89/7a9/807/c897a9807d61de129984fd9c608d9880.png" alt="image">  , where I is the current through the transition, I <sub>0</sub> is the current of electrons or holes in the absence of voltage, e is the electron charge, V is the voltage at the transition, k <sub>b</sub> is the Boltzmann constant, T is the temperature.  The last approximate equality is true almost exactly even for sufficiently small voltages (tenths of a volt). <br><br>  For sufficiently large values ‚Äã‚Äãof the current, when saturation occurs, the diode can be represented as a series-connected constant voltage drop (equal to the potential transition barrier) and a resistor, which corresponds to the resistance of the semiconductor and the contacts.  The potential barrier of the transition in the case of the LED corresponds to the energy of the emitted photons, i.e. <img src="https://habrastorage.org/getpro/habr/post_images/99a/3b7/284/99a3b728465072bcb18554fd5856f571.png" alt="image">  , where V <sub>0</sub> is the transition voltage, h is Planck's constant, c is the speed of light, <img src="https://habrastorage.org/getpro/habr/post_images/2ee/c8e/494/2eec8e4946ad56ca6bab6e2b7770e899.png" alt="image">  - The radiation wavelength of the LED.  Actually, it is the LED (and not the usual diode) that is needed to determine the wavelength.  I took these data from datasheets to LEDs, although in general it can be measured at home - I saw several articles on the creation of a spectrometer based on a CD / DVD disc. <br><br>  The microcontroller also measures the current-voltage characteristics of the LED, namely, its two sections: low currents and relatively large ones.  Measurements are made automatically after pressing the button, when the current increases to 25 milliamperes, and then when it decreases, it returns to zero.  For the sections of interest, the CVC controller then calculates the coefficients using the least squares method, and the required constants are obtained from them by simple arithmetic operations. <br><br>  Typical view of the linear section of the IVC: <img src="https://habrastorage.org/getpro/habr/post_images/c07/90d/284/c0790d284594ccef0050b102444e4476.png" alt="image"><br><br>  And exponential: <img src="https://habrastorage.org/getpro/habr/post_images/697/270/2da/6972702daac080d0cf7597018003de79.png" alt="image"><br><br>  As a result, the values ‚Äã‚Äãof the determined constants turned out to be very close to real: e = 1.54 * 10 <sup>-19</sup> C, h = 5.72 * 10 <sup>-34</sup> J * s (average for all available LEDs, a large enough spread). <br><br><h4>  Programming </h4><br>  I would not like to dwell a lot on writing the code in this case, since a significant part of it, which is responsible for interacting with the periphery, is taken from various articles and tutorials - this is why various libraries are used, and not one :) The article without this turned out to be quite voluminous .  Perhaps in the near future I will write a more programming-oriented article, already on a different project based on the same microcontroller. <br><br>  The entire project (source, CooCox service files, a small report) can be viewed or downloaded at <a href="https://hg.plav.in/stm32_ledcvc/file/">hg.plav.in/stm32_ledcvc/file</a> (the report is in the <a href="https://hg.plav.in/stm32_ledcvc/file/tip/report">report</a> folder). <br><br><h4>  Conclusion </h4><br>  Initially, the goals of this project were achieved: I began to understand the programming of microcontrollers, and also told a question about the choice on the exam :) Of course, some things could be improved or done differently.  For example, a smooth change in voltage could be done through a microcontroller DAC, and not a gradual charging of a capacitor ‚Äî then it would be possible to get along with fewer additional details.  And the use of a resistor with a rating of more than 27 Ohms would give more accurate measurements in the range of small currents - but at first I did not plan such measurements, and then it was too late to rework the circuit.  By the way, such more accurate measurements may allow for temperature measurement (and in the above scheme, the error would be about + -30 degrees, or even more). <br><br>  If there are any questions on any part, or there are things that I would like to see in the article related to STM32 programming - write :) </div><p>Source: <a href="https://habr.com/ru/post/211402/">https://habr.com/ru/post/211402/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../211386/index.html">Pebble 2.0 and Pebble AppStore release</a></li>
<li><a href="../211388/index.html">Search for routes for 1 person-month</a></li>
<li><a href="../211394/index.html">Satya Nadella officially became the CEO of Microsoft. Bill Gates resigned as chairman of the board</a></li>
<li><a href="../211396/index.html">Firefox 27 release</a></li>
<li><a href="../211400/index.html">Motorola Moto G - for beginners and budget</a></li>
<li><a href="../211404/index.html">Interesting moments in C # Part 2</a></li>
<li><a href="../211406/index.html">Google and Cisco have signed an agreement to avoid patent disputes.</a></li>
<li><a href="../211408/index.html">In-App Payment now for the Asha platform</a></li>
<li><a href="../211410/index.html">Facebook turned 10 years old</a></li>
<li><a href="../211416/index.html">Using a 3D printer, a material is created that is lighter than water and has the strength of steel</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>