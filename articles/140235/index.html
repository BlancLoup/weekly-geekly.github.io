<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>We display text on HTML5 Canvas</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="HTML5 Canvas is a very extensive topic with many ‚Äúgoodies‚Äù, many of which have already been written and will be written. Therefore, I want to tell a l...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>We display text on HTML5 Canvas</h1><div class="post__text post__text-html js-mediator-article">  HTML5 Canvas is a very extensive topic with many ‚Äúgoodies‚Äù, many of which have already been written and will be written.  Therefore, I want to tell a little in this article, only about one small, and how at first glance it may seem a banal topic - working with text.  I want to show that it is almost as possible to work with it as with plain text on the web, i.e.  position, overlay styles and gradients, and write multi-line sentences easily and without problems. <br><a name="habracut"></a><br><br><h4>  Plain text </h4><br>  To display plain text, you can use the two context functions <b>fillText ()</b> and <b>strokeText ()</b> . <br>  These functions take three required parameters: the text itself and the X and Y coordinates, i.e.  its location, and the last one is optional: the maximum text width, if you specify the maximum text width less than the actual width, the text will be compressed to the width you specified.  I do not advise you to set the maximum width, because when compressed, it also becomes a bad form.  Instead of such compression, I recommend transferring text to a new line, there is no standard function for this, but I will give an example of how this is easily implemented. <br>  If you simply display the text using such functions, then such text will be small and nondescript.  We can fix this by giving it a font in the <b>font</b> context variable.  The font is set, as well as in CSS ([font style] [font weight] [font size] [font face]).  Example: <br><br><pre><code class="javascript hljs">ctx.fillStyle = <span class="hljs-string"><span class="hljs-string">"#00F"</span></span>; ctx.strokeStyle = <span class="hljs-string"><span class="hljs-string">"#F00"</span></span>; ctx.font = <span class="hljs-string"><span class="hljs-string">"italic 30pt Arial"</span></span>; ctx.fillText(<span class="hljs-string"><span class="hljs-string">"Fill text"</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">50</span></span>); ctx.font = <span class="hljs-string"><span class="hljs-string">'bold 30px sans-serif'</span></span>; ctx.strokeText(<span class="hljs-string"><span class="hljs-string">"Stroke text"</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>);</code> </pre> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <img src="https://habrastorage.org/getpro/habr/post_images/6d2/5a2/2d1/6d25a22d13977d823e31ab3fb93655d6.png" alt="image"><br><br>  <a href="http://naxel.github.com/demos/canvas/text/simple-text.html">Demo</a> <br><br><h4>  Text layout </h4><br>  There are two standard ways of positioning text relative to its location: vertical and horizontal. <br>  Vertical positioning is set using textBaseline, it is set to one of the possible options: <b>top, hanging, middle, alphabetic, ideographic</b> and <b>bottom</b> . <br><br><pre> <code class="javascript hljs"> ctx.textBaseline = <span class="hljs-string"><span class="hljs-string">"bottom"</span></span>; ctx.fillText(<span class="hljs-string"><span class="hljs-string">"bottom"</span></span>, <span class="hljs-number"><span class="hljs-number">400</span></span>, <span class="hljs-number"><span class="hljs-number">75</span></span>);</code> </pre><br><br><img src="https://habrastorage.org/getpro/habr/post_images/5f9/b6f/6f8/5f9b6f6f84cae304a89bdb388fdf5bf5.png" alt="image"><br><br>  <a href="http://naxel.github.com/demos/canvas/text/text-baseline.html">Demo</a> <br><br>  And horizontally with textAlign, one of the following parameters can be: <b>center, start, end, left, right</b> . <br><br><pre> <code class="javascript hljs"> context.textAlign = <span class="hljs-string"><span class="hljs-string">"center"</span></span>; ctx.textBaseline = <span class="hljs-string"><span class="hljs-string">"bottom"</span></span>; context.fillText(<span class="hljs-string"><span class="hljs-string">"center"</span></span>, <span class="hljs-number"><span class="hljs-number">250</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>);</code> </pre><br><br><img src="https://habrastorage.org/getpro/habr/post_images/1ff/276/350/1ff276350602e3805d745541565e2bd4.png" alt="image"><br><br>  <a href="http://naxel.github.com/demos/canvas/text/text-align.html">Demo</a> <br><br>  These methods are far from ideal, and with the help of them it is sometimes difficult to position the text, since you want it for you.  Below I will describe the way how you can use your positioning, even multi-line text. <br><br>  Stylization <br>  The simplest way we can stylize a text is to give it a color.  The color is set using <b>fillStyle</b> to set the fill color and <b>strokeStyle</b> to set the stroke color. <br>  Just as in CSS3, you can add shadows to text in the canvas.  This is done with: <b>shadowColor</b> - setting the color of the shadow, <b>shadowOffsetX</b> and <b>shadowOffsetY</b> - setting the indent and shadowBlur - setting the blur of the shadow. <br><br><pre> <code class="javascript hljs"> ctx.shadowColor = <span class="hljs-string"><span class="hljs-string">"#F00"</span></span>; ctx.shadowOffsetX = <span class="hljs-number"><span class="hljs-number">5</span></span>; ctx.shadowOffsetY = <span class="hljs-number"><span class="hljs-number">5</span></span>; ctx.shadowBlur = <span class="hljs-number"><span class="hljs-number">5</span></span>; ctx.strokeText(<span class="hljs-string"><span class="hljs-string">"Shadow text"</span></span>, <span class="hljs-number"><span class="hljs-number">20</span></span>, <span class="hljs-number"><span class="hljs-number">100</span></span>);</code> </pre><br><br><img src="https://habrastorage.org/getpro/habr/post_images/4f7/737/c9c/4f7737c9c2fdf287266fa6186a185fe5.png" alt="image"><br><br>  Gradients for text are also supported.  The gradient itself is created using the <b>createLinearGradient</b> () function.  And with the help of the <b>addColorStop</b> () function, the colors and their positions in it are set.  The text is filled with a gradient as well as a solid color with <b>fillStyle</b> and <b>strokeStyle</b> . <br><br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> gradient = ctx.createLinearGradient(<span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">0</span></span>, <span class="hljs-number"><span class="hljs-number">60</span></span>); gradient.addColorStop(<span class="hljs-number"><span class="hljs-number">0.0</span></span>, <span class="hljs-string"><span class="hljs-string">'rgba(0, 0, 255, 1)'</span></span>); gradient.addColorStop(<span class="hljs-number"><span class="hljs-number">0.3</span></span>, <span class="hljs-string"><span class="hljs-string">'rgba(128, 0, 255, 0.6)'</span></span>); gradient.addColorStop(<span class="hljs-number"><span class="hljs-number">0.6</span></span>, <span class="hljs-string"><span class="hljs-string">'rgba(0, 0, 255, 0.4)'</span></span>); gradient.addColorStop(<span class="hljs-number"><span class="hljs-number">1.0</span></span>, <span class="hljs-string"><span class="hljs-string">'rgba(0, 255, 0, 0.2)'</span></span>); ctx.fillStyle = gradient;</code> </pre><br><br><img src="https://habrastorage.org/getpro/habr/post_images/3b3/5ff/c31/3b35ffc31447d7d848df489cd732c8eb.png" alt="image"><br><br>  In addition to the usual fill and fill with a gradient, you can also fill it with some kind of texture.  To do this, before the start of the text output image texture.  And then using <b>createPattern</b> () to create a texture based on it.  You can set the image to be repeated or not. <br><br><pre> <code class="javascript hljs"> <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> pattern = ctx.createPattern(img, <span class="hljs-string"><span class="hljs-string">'repeat'</span></span>); ctx.fillStyle = pattern;</code> </pre><br><br><img src="https://habrastorage.org/getpro/habr/post_images/e66/4bd/3ba/e664bd3babea8bcad4b4f4f417b8b33d.png" alt="image"><br><br>  <a href="http://naxel.github.com/demos/canvas/text/style.html">Demo</a> <br><br><h4>  Text Width and Multiline Text </h4><br><br>  Suppose you need to write a text on the canvas of unlimited length, whether it is one word or several sentences.  If you write it as it is, i.e.  insert all the text into <b>fillText</b> (), then only that part will be visible on the screen that does not exceed the width of the canvas in its width.  Those.  if the width of the canvas is 400 pixels, then you will not miss the text that goes beyond its width.  In order to make multi-line text you need to be contrived.  But the algorithm is simple.  First, we calculate the width of the text, compare it with the maximum width of the area where we want to display this text.  If the width of the text does not exceed that width, then print the text, and if it exceeds, then break the text in the most convenient way for you, I prefer to break into spaces. <br>  In order to calculate the width of the text, you can use the <b>measureText</b> () function, which gives the width of the text in the object form (unfortunately this function does not give the height of the text, I hope this feature will be added, but for now it will have to be calculated in other ways, exactly later in the article) . <br>  Example: <br><br><pre> <code class="javascript hljs"><span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">wrapText</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">context, text, marginLeft, marginTop, maxWidth, lineHeight</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> words = text.split(<span class="hljs-string"><span class="hljs-string">" "</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> countWords = words.length; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> line = <span class="hljs-string"><span class="hljs-string">""</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">for</span></span> (<span class="hljs-keyword"><span class="hljs-keyword">var</span></span> n = <span class="hljs-number"><span class="hljs-number">0</span></span>; n &lt; countWords; n++) { <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> testLine = line + words[n] + <span class="hljs-string"><span class="hljs-string">" "</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> testWidth = context.measureText(testLine).width; <span class="hljs-keyword"><span class="hljs-keyword">if</span></span> (testWidth &gt; maxWidth) { context.fillText(line, marginLeft, marginTop); line = words[n] + <span class="hljs-string"><span class="hljs-string">" "</span></span>; marginTop += lineHeight; } <span class="hljs-keyword"><span class="hljs-keyword">else</span></span> { line = testLine; } } context.fillText(line, marginLeft, marginTop); } <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> canvas = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.getElementById(<span class="hljs-string"><span class="hljs-string">"canvas"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> context = canvas.getContext(<span class="hljs-string"><span class="hljs-string">"2d"</span></span>); <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> maxWidth = <span class="hljs-number"><span class="hljs-number">400</span></span>; <span class="hljs-comment"><span class="hljs-comment">// ,    var lineHeight = 25; /*    ,    ,       */ var marginLeft = 20; var marginTop = 40; var text = "       ,       , " + "     .         , " + " ,   ,      ,      ." + "  ,     ."; context.font = "16pt Calibri"; context.fillStyle = "#000"; wrapText(context, text, marginLeft, marginTop, maxWidth, lineHeight);</span></span></code> </pre><br><br><img src="https://habrastorage.org/getpro/habr/post_images/da5/c04/379/da5c04379ea1206fb681172f18118378.png" alt="image"><br><br>  <a href="http://naxel.github.com/demos/canvas/text/wrap.html">Demo</a> <br><br>  It seems that everything is fine, you do not need to set the coordinates of the text, whether you manually calculate the text by the width or not.  Almost everything is automated and looks good, but still a small nuance, the height of the text is hard-coded, so when changing the font or size you have to manually adjust the height of the text each time (in the example, the variable <b>lineHeight</b> ). <br><br><h4>  Determine the height of the text </h4><br><br>  When working with text on the canvas, neither the <b>measureText</b> () function, nor any other, allows us to determine the height of the text.  You can still cope with this misfortune, the solution to this problem that I want to offer you is not very beautiful, but it still works. <br>  When we set the text style (font size and style) in the <b>font</b> , we set it in the same style, as we would set it in CSS.  Fonts and their sizes, of course, if such a font is available in canvas, then it will also be available in regular styles. <br>  And so, the idea is this: we have the size and type of the font in the <b>font</b> variable, we create a new element in the DOM, put the text there, and set the styles from that variable.  Next, using <b>offsetHeight,</b> we get the height of the element, which will be the height of our text.  After that, we can safely remove this element from the DOM. <br>  An example of the implementation of this idea: <br><br><pre> <code class="javascript hljs"><span class="hljs-keyword"><span class="hljs-keyword">var</span></span> text = <span class="hljs-string"><span class="hljs-string">"        ."</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> marginLeft = canvas.width - context.measureText(text).width; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> marginTop = canvas.height - getFontHeight(context.font); context.fillText(text, marginLeft, marginTop); <span class="hljs-function"><span class="hljs-keyword"><span class="hljs-function"><span class="hljs-keyword">function</span></span></span><span class="hljs-function"> </span><span class="hljs-title"><span class="hljs-function"><span class="hljs-title">getFontHeight</span></span></span><span class="hljs-function">(</span><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">font</span></span></span><span class="hljs-function">) </span></span>{ <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> parent = <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.createElement(<span class="hljs-string"><span class="hljs-string">"span"</span></span>); parent.appendChild(<span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.createTextNode(<span class="hljs-string"><span class="hljs-string">"height"</span></span>)); <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.body.appendChild(parent); parent.style.cssText = <span class="hljs-string"><span class="hljs-string">"font: "</span></span> + font + <span class="hljs-string"><span class="hljs-string">"; white-space: nowrap; display: inline;"</span></span>; <span class="hljs-keyword"><span class="hljs-keyword">var</span></span> height = parent.offsetHeight; <span class="hljs-built_in"><span class="hljs-built_in">document</span></span>.body.removeChild(parent); <span class="hljs-keyword"><span class="hljs-keyword">return</span></span> height; }</code> </pre><br><br>  Result: <br><br><img src="https://habrastorage.org/getpro/habr/post_images/0c8/267/d79/0c8267d794785732bf6be54481d2f6a1.png" alt="image"><br><br>  <a href="http://naxel.github.com/demos/canvas/text/position.html">Demo</a> <br><br>  I would be glad if someone offers a more beautiful or correct option to get the height of the text. <br>  Thank. </div><p>Source: <a href="https://habr.com/ru/post/140235/">https://habr.com/ru/post/140235/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../140230/index.html">2GIS API. New organizations every day-2</a></li>
<li><a href="../140231/index.html">Inside Evernote Peek: How We Implemented Application Management with iPad 2 Cover</a></li>
<li><a href="../140232/index.html">What could you do if you were Google and you had their databases?</a></li>
<li><a href="../140233/index.html">6 more startups that will receive grants from Milner and Durov</a></li>
<li><a href="../140234/index.html">Website layout (Kohana + Bootstrap + HTML5)</a></li>
<li><a href="../140236/index.html">Export VK friends to Google Contacts</a></li>
<li><a href="../140237/index.html">Norman Jude's Open Lecture ‚ÄúCreating the Future Today: The Role of Innovation and Young Innovators in the Modern World‚Äù</a></li>
<li><a href="../140238/index.html">Training course "Interfaces for iPhones"</a></li>
<li><a href="../140240/index.html">Zentyal - all-in-one server for SMB</a></li>
<li><a href="../140241/index.html">Plotter from the designer FISCHERTECHNIK</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>