<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>String distribution and access to Teradata (Primary Index)</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Previous Post: What is Teradata? 

 How does Teradata distribute strings? 



- Teradata uses a hashing algorithm for randomly distributing table rows...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>String distribution and access to Teradata (Primary Index)</h1><div class="post__text post__text-html js-mediator-article">  <i>Previous Post:</i> <a href="http://habrahabr.ru/post/209078/">What is Teradata?</a> <br><br>  How does Teradata distribute strings? <br><br><ul><li>  Teradata uses a hashing algorithm for randomly distributing table rows between AMPs (advantages: distribution is the same, regardless of the amount of data, and depends on the content of the row, not the demographics of the data) </li><li>  Primary Index determines whether the rows of the table are evenly or unevenly distributed between AMPs. </li><li>  A uniform distribution of the rows of the table leads to a uniform load distribution. </li><li>  Each AMP is responsible only for its own subset of rows of each table. </li><li>  Strings are placed in an irregular manner (advantages: support for maintaining order is not required, order is not dependent on any submitted query) </li></ul>
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <h5>  Primary Key (PK) vs.  Primary Index (PI) </h5><br>  <b>Primary Key</b> (primary key) - this is the convention of the relational model, which uniquely identifies each line. <br>  <b>The Primary Index</b> is a Teradata convention, which defines the distribution of rows and access. <br>  A well-designed database contains tables in which PI is the same as PK, as well as tables in which PI is defined in columns other than PK and may affect access paths. <br><a name="habracut"></a><br><table><tbody><tr><th>  Primary Key (PK) </th><th>  Primary Index (PI) </th></tr><tr><td>  Logical data modeling concept </td><td>  Mechanism for row allocation and access </td></tr><tr><td>  Teradata does not need a PK definition </td><td>  The table must necessarily have one PI </td></tr><tr><td>  No limit on the number of columns </td><td>  Can be from 1 to 64 columns </td></tr><tr><td>  PK is defined in a logical data model. </td><td>  PI is defined when the table is created. </td></tr><tr><td>  Value must be unique </td><td>  The value does not have to be unique </td></tr><tr><td>  Uniqueness identifies each line </td><td>  Used to place a string in AMP </td></tr><tr><td>  Values ‚Äã‚Äãshould not change </td><td>  Values ‚Äã‚Äãare subject to change (updated) </td></tr><tr><td>  Cannot be null </td><td>  May be NULL </td></tr><tr><td>  Not applicable to the access path </td><td>  Determines the most efficient access path. </td></tr><tr><td>  Selected for logical correctness </td><td>  Selected for the physical performance of the compound values </td></tr></tbody></table><br>  There are two types of PIs: <b>UPI</b> (Unique Primary Index) and <b>NUPI</b> (Non-Unique Primary Index).  When using UPI, lines are distributed evenly among AMPs, and when using NUPI, lines with the same index values ‚Äã‚Äãbelong to the same AMP-y. <br><br>  Creating tables with UPI and NUPI: <br><br><pre><code class="sql hljs">CEATE TABLE Table1 ( Col1 INTEGER, Col2 INTEGER ) UNIQUE PRIMARY INDEX (Col1);</code> </pre> <br><br><pre> <code class="sql hljs">CEATE TABLE Table2 ( Col1 INTEGER, Col2 INTEGER ) PRIMARY INDEX (Col2);</code> </pre> <br><br><h5>  Hash allocation of strings </h5><br>  The Primary Index value is passed to the hashing algorithm, which ensures uniform distribution of unique values ‚Äã‚Äãamong all AMPs.  The algorithm produces a 32-bit hash value.  The first 16 bits (Hash Bucket Number) are used as a pointer to a hash map (Hash Map).  Hash values ‚Äã‚Äãare calculated using a hashing algorithm.  The hash card is uniquely configured for each system; it is an array that binds the DSW (statistics key) to a specific AMP.  Two systems with the same number of AMPs will have the same hash card.  Changing the number of AMPs in the system requires changes in the hash map. <br><br><h5>  NoPI Table </h5><br>  <b>NoPI-</b> table is a <a href="http://habrahabr.ru/company/teradata/blog/209208/">table without Primary Index</a> (feature of the 13th version of Teradata).  In this case, new rows are always added to the end of the table and are never added to the middle of the hash sequence. <br>  Rows will also be distributed between AMPs.  A new random code will determine which AMPs will receive strings or groups of strings.  Within AMP, rows are simply added to the end of the table.  They will have a unique identifier, which increases the uniqueness of the value. <br><br>  Benefits: <br>  The table will reduce the offset in intermediate tables ETL (Extract, Transform, Load ‚Äî Extract, transform, load) that do not have a Primary Index. <br>  Downloads (FastLoad and TPump Array Insert) in the NoPI intermediate table are faster. <br><br><h5>  PPI and MLPPI </h5><br>  <b>PPI</b> (Partitioned Primary Index) is a partitioning mechanism that is used to improve performance for large tables when sending queries that specify a range limit. <br>  Data distribution using PPI is based on PI: Primary Index -&gt; Hash value -&gt; AMP definition, which will get the string.  With NPPI (No Partitioned Primary Index), the rows in the AMP are arranged in the order of the hash rows.  When using PPI, strings are first arranged by partitions, and then in the order of the hash strings. <br><br>  <b>MLPPI</b> (Multi-Level Partitioned Primary Index) allows for multipartitioning or the use of an uncompressed Join Index.  In multilevel partitioning, each partitioning level is determined independently using the <b>RANGE_N</b> or <b>CASE_N expressions</b> . <br><br>  The goal of partitioning (partitioning) is to reduce the load on the system if the data in the table is rarely or even never updated (for example, various logs). <br><br>  <b>PS</b> <br>  Just today, we published an article <a href="http://habrahabr.ru/company/teradata/blog/209208/">Physical Design of Storage Structures in the Teradata DBMS on the Teradata</a> blog, so I will not write about the <b>Secondary Index</b> . <br>  I hope the company will continue the regular series of articles, and I will not have to translate the documentation from English. </div><p>Source: <a href="https://habr.com/ru/post/209166/">https://habr.com/ru/post/209166/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../209154/index.html">Sha512 support in wsse-authentication-bundle from Escape Studios, Symfony2</a></li>
<li><a href="../209156/index.html">Customs moved to action</a></li>
<li><a href="../209158/index.html">Homemade tablet on the Raspberry Pi</a></li>
<li><a href="../209160/index.html">Control of cable operator‚Äôs cable facilities</a></li>
<li><a href="../209162/index.html">Fujitsu webinar "Portfolio of services for IT infrastructures"</a></li>
<li><a href="../209170/index.html">"Data center for beginners" or criteria for evaluating the project of an effective data center</a></li>
<li><a href="../209178/index.html">Hole VKontakte, leakage of users' personal data</a></li>
<li><a href="../209180/index.html">Google Nexus 7 Review (2013)</a></li>
<li><a href="../209182/index.html">About stable data center wetting</a></li>
<li><a href="../209184/index.html">Embedded Sphinx, or search on a router</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>