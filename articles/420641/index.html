<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Technical support 3CX responds: backup and restore 3CX from the command line</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Starting from 3CX v15.5 SP1, we added two console utilities for backing up and restoring PBX configuration. They are used primarily in automation scri...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Technical support 3CX responds: backup and restore 3CX from the command line</h1><div class="post__text post__text-html js-mediator-article">  Starting from 3CX v15.5 SP1, we added two console utilities for backing up and restoring PBX configuration.  They are used primarily in automation scripts, or if there is no access to the server interface. <br><br>  If you are servicing a large number of cloud instances of 3CX, the automatic backup script is very convenient, because  works from a single console, without requiring login to the management interface of each server.  Console utilities are available in both the 3CX version for Linux and for Windows. <a name="habracut"></a><br><br><h2>  BackupCMD command </h2><br>  BackupCMD - console backup command.  It has the following parameters: 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
    <ul><li>  l, --log = VALUE, the name or path of the log file <br></li><li>  f, --file = VALUE, the name or path of the zip file of the archive is a required parameter <br></li><li>  o, --options = VALUE, Backup options (what is backed up) is a required parameter <br></li></ul><br><ul><li>  c, --cfg = VALUE, full path to the configuration file <br></li><li>  h, --help, show help (list of these parameters) <br></li><li>  --pwd = Value, archive encryption password (v15.5 SP2 and higher) <br></li></ul><br><h3>  Use of parameters </h3><br>  If you specify only the file name (the --file parameter), the backup will be created in the location specified in the 3CX control interface.  The storage location can be a local folder, an FTP server or Google Drive.  But if the parameter specifies the full path to the file, it is used, and the settings in the interface are ignored. <br><br>  If the log file parameter is not specified, the file is created in the default location C: \ Program Files \ 3CX Phone System \ Instance1 \ Binbackup.log (Windows) or /var/lib/3cxpbx/Instance1/Bin/backup.log (Linux) .  If only the file name is specified in the parameter, it will be used in the default location.  And if the full path is specified, it overrides the default location of the log file (you can only specify a local path). <br><br>  Please note that when launching the system backup script, the ‚Äúphones system‚Äù user should have the right to write to the backup folder. <br><br>  The --cfg parameter is used only if the BackupCMD utility is launched from a folder other than the default folder (for example, from your utility folder).  In this case, the parameter value is set as follows: <br><br><ul><li>  C: \ Program Files \ 3CX Phone System \ Instance1 \ Bin \ BackupCmd.exe.config (Windows) <br></li><li>  /var/lib/3cxpbx/Instance1/Bin/BackupCmd.exe.config (Linux) <br></li></ul><br><h3>  Windows Backup </h3><br><ol><li>  Run the command prompt as administrator and type: cd C: \ Program Files \ 3CX Phone System \ Instance1 \ Bin <br></li><li>  To display help, type: BackupCmd.exe --help <br></li><li>  An example of a full backup command: BackupCmd.exe --file = backuptest.zip --options = ALL --log = backuptest.log <br></li><li>  An example of a backup call history command, license and FQDN: BackupCmd.exe --file = backuptest.zip --options = CH, LIC, FQDN --log = backuptest.log <br></li></ol><br><h3>  Linux Backup </h3><br>  Commands are executed by the user ‚Äúphones system‚Äù with sudo privileges: <br><br><ol><li>  Run Terminal and type: cd / var / lib / 3cxpbx / Instance1 / Bin / <br></li><li>  To display help, type: sudo -u phonesystem / usr / sbin / 3CXBackupCmd --help <br></li><li>  An example of a full backup command is: sudo -u phonesystem / usr / sbin / 3CXBackupCmd - file = backuptest.zip - options - ALL - log = / tmp / backuptest.log <br></li><li>  Example of the call history, license and FQDN backup command: sudo -u phonesystem / usr / sbin / 3CXBackupCmd --file = backuptest.zip --options = CH, LIC, FQDN --log = / tmp / backuptest.log <br></li></ol><br><img src="https://habrastorage.org/getpro/habr/post_images/457/223/ebf/457223ebfcf20bde745ce47bb27469df.png"><br><br><h2>  RestoreCMD command </h2><br>  RestoreCMD is a console command for restoring a 3CX server backup.  It has the following parameters: <br><br><ul><li>  -l, --log = VALUE, the name or path of the log file <br></li><li>  -f, --file = VALUE, the name or path of the zip file of the archive is a required parameter <br></li><li>  -c, --cfg = VALUE, full path to the configuration file <br></li><li>  -h, --help, show help (list of these parameters) <br></li><li>  --pwd = Value, archive decryption password (v15.5 SP2 and higher) <br></li><li>  --failover, failsafe mode (3CX services do not start after recovery) <br></li></ul><br><h3>  Use of parameters </h3><br>  When specifying only the file name (the --file argument), the backup is searched for in the location specified in the 3CX control interface.  But if the parameter specifies the full path to the file, it is used, and the settings in the interface are ignored. <br><br>  If no log file option is specified, the file is not created.  If only the file name is specified in the parameter, the file will be created in the default location C: \ Program Files \ 3CX Phone System \ Instance1 \ Binbackup.log (Windows) or /var/lib/3cxpbx/Instance1/Bin/backup.log (Linux ).  And if you specify the full path, a log file is created along this path. <br><br>  The --cfg option is used only if the RestoreCMD utility is not running from the default folder.  In this case, the parameter is set as follows: <br><br><ul><li>  C: \ Program Files \ 3CX Phone System \ Instance1 \ Bin \ RestoreCmd.exe.config (Windows) <br></li><li>  /var/lib/3cxpbx/Instance1/Bin/RestoreCmd.exe.config (Linux) <br></li></ul><br><h3>  Windows Recovery </h3><br><ol><li>  Run the command prompt as administrator and type: cd C: \ Program Files \ 3CX Phone System \ Instance1 \ Bin <br></li><li>  To display help, type: RestoreCmd.exe --help <br></li><li>  Sample 3CX server recovery command: RestoreCmd.exe --file = restoretest.zip --log = restoretest.log <br></li><li>  Example of a failover node restore command: RestoreCmd.exe --file = restoretest.zip --failover --log = restoretest.log <br></li></ol><br><h3>  Linux Recovery </h3><br>  Commands are executed by the user ‚Äúphones system‚Äù with sudo privileges: <br><br><ol><li>  Run Terminal and type: cd / var / lib / 3cxpbx / Instance1 / Bin / <br></li><li>  To display help, type: sudo -u phonesystem / usr / sbin / 3CXRestoreCmd --help <br></li><li>  Example restore command: sudo -u phonesystem / usr / sbin / 3CXRestoreCmd - file = restoretest.zip - log = / tmp / restoretest.log <br></li><li>  Sample failover node restore command: sudo -u phonesystem / usr / sbin / 3CXRestoreCmd --file = restoretest.zip --failover --log = / tmp / restoretest.log <br></li></ol></div><p>Source: <a href="https://habr.com/ru/post/420641/">https://habr.com/ru/post/420641/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../420631/index.html">We are not afraid of "clouds"</a></li>
<li><a href="../420633/index.html">We write GeoIP exporter for Prometheus with visualizations in Grafana in 15 minutes</a></li>
<li><a href="../420635/index.html">AI, practical course. The basic model of recognition of emotions in images</a></li>
<li><a href="../420637/index.html">WANHAO D9 / 300 3D Printer Review: Video</a></li>
<li><a href="../420639/index.html">Akka antipatterns: too many actors</a></li>
<li><a href="../420643/index.html">Almost everything is the same, only 10 times cheaper</a></li>
<li><a href="../420645/index.html">Realistic hiring practice for engineers</a></li>
<li><a href="../420647/index.html">Why video game characters almost never undress</a></li>
<li><a href="../420651/index.html">Scientists have unearthed information about the unpleasant precedent associated with climate change</a></li>
<li><a href="../420653/index.html">Five things to do to build a home on Mars</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>