<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Under the black flag post, or As I did not put your video course on the tracker</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, Habr! In difficult times we live, do not you? People are selfish, do not recognize the value of other people's work, they like to come to everythi...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Under the black flag post, or As I did not put your video course on the tracker</h1><div class="post__text post__text-html js-mediator-article"><div style="text-align:center;"><img src="https://habrastorage.org/webt/gd/zm/dn/gdzmdnntaat9zilg5nsvqcto5yg.jpeg" alt="captain_flint.jpg"></div><br>  Hi, Habr!  In difficult times we live, do not you?  People are selfish, do not recognize the value of other people's work, they like to come to everything at once ready.  Intellectual property for many in general looks like nothing more than a bureaucratic joke: ‚ÄúHow can this be so? Information should be free, because this is IN-FOR-MA-CI-I !!! 11‚Äù.  I agree, ideally it is.  These are your anarchies, the rebel sentiments and the philosophy of underground hackers / pirates, guarding the rights of the common people, are not alien to me.  But the paradox is that true justice is also to repay everyone for their work and services, so in most cases piracy is an antagonistic enterprise.  But here the policy of providing services for the protection of intellectual property, offered by such a wonderful vendor as InfoProtector, caused me righteous anger. <br><br>  Under the cut, the story of how I acquired a paid video course, fell into the sediment after realizing that I could not save videos from it for re-viewing in the future, I got angry at those who scrapped this quasi-protective software (which, ruthlessly lays and eats a lot of machine resources) and decided to restore justice a little ... Without breaking the law, of course.  Amen. <br><a name="habracut"></a><blockquote>  <b>DISCLAIMER.</b>  All of the following is published for research purposes and is intended to perform an educational function only.  The author is not responsible for the misuse of information from this post and in no case does not call to perceive it as a "guide to action." </blockquote><br><h3>  <font color="#4682b4">How it was</font> </h3><br>  I had a free weekend, and I decided to post honestly earned XXXX p.  at 5-hour video course.  We call it the ‚ÄúRefresher course for the catering worker‚Äù so that there are no parallels.  In general, I am not a supporter of perception of information through video tutorials (oh, very counterproductive), but I could not resist right here - I fell victim to colorful advertising banners. <br><br>  I paid for it, I received a letter to the mail containing links to download materials, invented (links) by the randomizer of InfoProtector and spat out onto a nearby CDN.  In the body of the letter - thanks to the author for the acquisition and registration key, which offered to activate the purchase. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Download the archive.  In the archive folder.  In the folder executable file.  <s>In the executable file is an egg.</s>  I run exe'shnik - here I have been given the whole truth, which in a free retelling sounds something like this (read in a nasal voice): <br><blockquote>  <i>The video information protection mechanism of InfoProtector Company has been applied to this video course;</i>  <i>Internet access is required</i> <i>for the first launch</i> (read ‚Äúproduct activation‚Äù) <i>;</i>  <i>viewing videos is only possible from our program, from our player;</i>  <i>video course installation is possible only on two computers</i> (the video course is tied to the OS / hardware environment configuration, as it turns out later). </blockquote><br>  Here at this moment I was a little upset.  That is, not only did they call me a dishonest person, who would just be able to deprive someone else's work of monetization, but also the course for which I had laid out a decent amount would be available to me only before reinstalling the system. <br><br>  "That will not do," I decided, and began a series of experiments. <br><br><h3>  <font color="#4682b4">Restrictions imposed by InfoProtector</font> </h3><br>  In order not to waste time, for a start I turned to the world wide web to find out what people had already dug up about the mechanism of protection of these guys (all the details of the work of protection, of course, are not disclosed). <br><br>  What was possible to learn: <br><br><ol><li>  The activation key is generated randomly when paying for the course and is used to be an authenticated server, which, if successful, sends the client an AES key to decrypt the video materials available from under the company's custom player.  Reversing the application for a long time and the most time-consuming (that is, it is inappropriate for this kind of task), so I decided to leave this way. </li><li>  The use of screen recording tools is mercilessly blocked in a number of areas: the player and any screen capturer cannot be simultaneously launched on the same host, since the program will detect running processes with their metadata: window title names;  description of executable files;  names of vendors embedded in exe's capture apps;  even the browser opened on the page, in the title of which there is the word ‚ÄúFraps‚Äù, for example, is also subject to alert and shutdown of the player. </li><li>  Sandboxes, virtual machines and streaming of content from remote connections (rdesktop, RAdmin, TeamViewer) is also not an option - not for years does clever software know how to identify them, suicide at every opportunity. </li></ol><br>  But despite the last two points, the screen recording remains the most realistic attack vector, which can be implemented in several ways: <br><br><ol><li>  Find a capture program that does not contain beacon words in its name / manufacturer / description that InfoProtector does not know, and which, therefore, the latter will not trigger.  Cons: long, boring and not a fact that, in principle, doable. </li><li>  Find an open-source product with the necessary functionality, and compile your version of the screen hijacker, replacing in the source code all that the protection of InfoProtector in theory may seem suspicious.  Cons: long, boring, time consuming (usually such projects are rather cumbersome, consist of hundreds (?) Of files and have heaps of dependencies in the source code, so just <i>Ctrl-H</i> does not roll, you don‚Äôt need to edit mimikatz so that Windows Defender will not be trimmed). </li><li>  Write your solution on something scripted so as not to risk with a compiled executable file of unknown nature (it is not known what this infection will say), implementing the trivial functionality of quickly taking screenshots from the selected screen area (good, InfoProtector allows it), and separately write sound track, which also turned out to be legitimate and as simple as possible. </li></ol><br>  Minuses of the third item was not found, so you can proceed. <br><br><h3>  <font color="#4682b4">Screenshot the whole world</font> </h3><br>  First: let's figure out how to automate the process of creating a cloud of screenshots using a script.  Of course, this: Python, and more <a href="https://pypi.org/project/opencv-python/">OpenCV</a> , and more <a href="https://pypi.org/project/mss/">MSS</a> , and more <a href="https://pypi.org/project/Pillow/">PIL</a> . <br><br>  The process is extremely simple: <br><br><ol><li>  Set the size of the player window equal to the resolution of the output video that we would like to have (it is logical to take into account the space for the script controls - a window with a terminal, for example, which should not fall into the recording area).  This can be done with <a href="http://www.brianapps.net/sizer/">such a</a> wonderful software. </li><li>  Place the player window in such a position as to find which it would be easiest to explain to the script - the lower right corner of the screen (I think the reference system associated with the screen borders is the most convenient option). </li><li>  Let's add a script already written (which will be a little lower) to take screenshots of this area. </li><li>  Do not touch this clumsy system during the whole video playback. </li></ol><br>  Script under spoiler: <br><br><div class="spoiler">  <b class="spoiler_title">fckInfoprotector.py</b> <div class="spoiler_text"><pre><code class="python">#!/usr/bin/env python3
# -*- coding: utf-8 -*-

# Usage: python3 fckInfoprotector.py &lt;WIDTH&gt; &lt;HEIGHT&gt;

import sys

import numpy as np
import cv2
from mss.windows import MSS as mss
from PIL import Image


class Capturer:

	def __init__(self, w, h, resolution='1080p', fps=24.975):
		if resolution == '1080p':
			self.monitor = {
				'top': 1080 - h,
				'left': 1920 - w,
				'width': w,
				'height': h
			}

		elif resolution == '1440p':
			self.monitor = {
				'top': 1440 - h,
				'left': 2560 - w,
				'width': w,
				'height': h
			}

		else:
			raise ValueError('Unsupported monitor resolution')

		self.sct = mss()

		self.vid = cv2.VideoWriter(
			'output.avi',
			cv2.VideoWriter_fourcc(*'XVID'),
			fps=fps,
			frameSize=(
				self.monitor['width'],
				self.monitor['height']
			)
		)

	def mainloop(self):
		while True:
			sct_img = self.sct.grab(self.monitor)
			sct_img_size = (sct_img.width, sct_img.height)

			img = Image.frombytes(
				'RGB',
				sct_img_size,
				sct_img.rgb
			)

			frame = cv2.cvtColor(
				np.array(img),
				cv2.COLOR_BGR2RGB
			)

			self.vid.write(frame)


if __name__ == '__main__':
	if len(sys.argv) != 3:
		print(f'Usage: {sys.argv[0]} &lt;WIDTH&gt; &lt;HEIGHT&gt;')
		sys.exit()

	w, h = (int(x) for x in sys.argv[1:3])
	capturer = Capturer(w, h, fps=50.0)

	try:
		capturer.mainloop()
	except KeyboardInterrupt:
		print('Interrupted')
</code></pre><br>
</div></div><br>
<h3><font color="#4682b4"> </font></h3><br>
   : Windows     .<br>
<br>
 Windows 7:  -&gt;   -&gt;    -&gt;  -&gt;  -&gt;      ¬´ ¬ª:<br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/qm/z6/4u/qmz64unk8ocgkiwkfy2pd0ga83m.png" alt="1.png"></div><br>
              ,     :<br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/gt/fz/-d/gtfz-df-ay4lb9qjvq7sr5a5jwg.png" alt="2.png"></div><br>
<br>
<h3><font color="#4682b4">   </font></h3><br>
 ,      ,    .         <a href="http://www.virtualdub.org/">VirtualDub</a>.<br>
<br>
 :<br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/te/zg/ks/tezgksjfonqkw5vxiqi74xjjcqq.png" alt="3.png"></div><br>
 :<br>
<br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/e0/sd/cw/e0sdcw5kzwmzmh6xywxjmdk8i3w.png" alt="4.png"></div><br>
  , . .      . ,          ,     50- (    ,  )  <math></math><img src="https://habrastorage.org/getpro/habr/formulas/6d6/a4f/78f/6d6a4f78fbacd6edecc018ce8ad3e364.svg" alt="$X$" data-tex="inline">,  <math></math><img src="https://habrastorage.org/getpro/habr/formulas/6d6/a4f/78f/6d6a4f78fbacd6edecc018ce8ad3e364.svg" alt="$X$" data-tex="inline">   :<br>
<p></p><p><math></math><img src="https://habrastorage.org/getpro/habr/formulas/9f5/fe9/789/9f5fe97891d9d8647560c647cf31cec0.svg" alt="$X=captured\_video\_duration\times 50\div original\_video\_duration$" data-tex="display"></p><br>
<div style="text-align:center;"><img src="https://habrastorage.org/webt/r4/ji/gr/r4jigrpjbl-pcvb1ixet7dwq2qg.png" alt="5.png"></div><br>
,          ,    .<br>
<br>
      <b>F7</b>!    .<br>
<br>
<h3><font color="#4682b4"> </font></h3><br>
     ?  .<br>
<br>
-,          ,          .              -,     ,             . ,     .<br>
<br>
-,      :       (     NVIDIA,     !),    ,  ,      ,    ,     ¬´¬ª,      ?<br>
<br>
-,  : ¬´  DVD-     !¬ª. ,  .        ,    ,    ( ),       ,      .<br>
<br>
     :    ,       ,          -,      (,  ),  ,      . ,       ().<br>
<br>
      ,         ,    ‚Äì .<br>
<br>
-,  !</div><p>Source: <a href="https://habr.com/ru/post/449970/">https://habr.com/ru/post/449970/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../449960/index.html">Sources of inspiration when developing under UDB</a></li>
<li><a href="../449964/index.html">Test drive nanoCAD SPDS Construction site 8. Part 2</a></li>
<li><a href="../449966/index.html">Tables in Figma. Data Grid Design by One Component</a></li>
<li><a href="../449968/index.html">Redmadrobot discusses AppsConf 2019: video</a></li>
<li><a href="../44997/index.html">Improving my health helps</a></li>
<li><a href="../449974/index.html">Netramesh - lightweight service mesh solution</a></li>
<li><a href="../449976/index.html">Multi-threaded associative containers in C ++. Yandex report</a></li>
<li><a href="../449978/index.html">Igor Antarov from Moscow Tesla Club fights with 20 Tesla and electric car myths</a></li>
<li><a href="../44998/index.html">Yandex. Search Tabs</a></li>
<li><a href="../449990/index.html">How to make friends latex, formulas and Habr?</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>