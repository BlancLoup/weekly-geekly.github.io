<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Security system sites SANTI</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hi, Habr. With this post, I would like to tell you about my Open-source web-antivirus project for SANTI websites, about what has already been realized...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Security system sites SANTI</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/b47/2de/282/b472de2827658e101532b7532fb60243.png" alt="antivirus for SANTI sites" align="left">  Hi, Habr.  With this post, I would like to tell you about my Open-source web-antivirus project for <a href="http://santivi.com/">SANTI</a> websites, about what has already been realized and what plans for the future.  But the main task is to get feedback, which will serve for further development. <a name="habracut"></a><br><br>  I'll start with the lyrics, as it was based on.  Millions of sites are hacked each year, from business card sites and entertainment sites to public Internet portals.  The goal of all hackers is to use the visitors of the sites and get the benefit, to use the resources of the hacked sites.  For example, when sites are hacked, viruses (exploits) are introduced into them by using iframe inserts that infect the computer of the site visitor, and then extort money, or steal victim's financial information and withdraw money from their bank accounts.  Everybody suffers from these criminal activities - both the visitor and the site that was hacked.  As a result of the ‚Äúpest‚Äù actions, there is an opportunity to lose the files and database of the site, get under the blocking of search engines, and then blocking with desktop antiviruses, lose precious traffic and the face of the company. <br><br>  Alas, when developing websites, many web developers do not always conduct code security audits, and often they simply lack qualifications in this area, while popular CMSs are under scrutiny by hackers and the result is massive hacks.  In addition to the vulnerabilities of the site itself, there are often leaks of access to servers with site files.  To protect their sites, owners need to hire security specialists, programmers, administrators and constantly monitor the integrity of the Internet project and its protection.  But only a few companies can afford it, and millions of sites on popular CMS and their visitors remain vulnerable. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Over the past 10 years, working in various web studios, I have faced the problems of hacking hundreds of sites, these were usually projects without administration and maintenance, sites running all well-known CMSok.  The need to create a system for monitoring the integrity of sites and their automatic protection of the vital in the air has long been accumulating ideas and thoughts, and this year I finally decided to implement this tool. <br><br><h4>  What should be the site security system? </h4><br>  Starting work on SANTI, several prerequisites were laid down: <br><ul><li>  The system should be autonomous and put turnkey on sites, without using third-party servers to work with the contents of the web-project; </li><li>  Simplest usability; </li><li>  Secure web-interface; </li><li>  Getting started in one and a half clicks - downloaded, configured; </li><li>  Open source; </li><li>  Freedom to choose the necessary tools; </li><li>  Support tools for webmasters; </li><li>  Automatic monitoring and protection; </li><li>  Instant notification of the owner of the threat to the site; </li><li>  Community help for users; </li><li>  Updated; </li></ul><br>  The resulting system today satisfies all the conditions set for it and is being improved. <br><br><h4>  Current system functionality </h4><br>  For three months from the first publication of SANTI on the Internet and its presentation on the popular forums of the Runet, SANTI acquired an interesting functionality, an invaluable feedback was collected, on the basis of which the SANTI version 0.5 was already released. <br><br>  The basic part of the system - <b>Autopilot</b> , this PHP scripts are automatically triggered on schedule.  For ease of use, the remote CRON server SANTI is ON / OFF and works, but in the settings you can activate the local CRON and configure the launch of autopilots manually on your CRON server, links to autopilot are visible. <br><br>  Implemented the following autopilots: <br><ul><li>  <b>File autopilot</b> - a tool for monitoring site files and notification in case of changes.  The script creates an image of the site files when the anti-virus is first run - it remembers the CRC of files, size, date of change, rights.  If the file has changed / deleted / added - the file autopilot reports detailed information to the site owner. </li><li>  <b>Autopilot backing up site files</b> - saving all files in a gzip archive with saving chmod files.  When restoring from this archive - the rights to folders and files are also restored, based on the <a href="http://alfaungzipper.com/ru/">AlfaUngzipper</a> tool.  Backup is possible both on the server with the site and in the Yandex.Disk cloud. </li><li>  <b>Autopilot backup of the site database</b> - saving the site database dump to both the local server and Yandex.Disk.  The tool was created based on the open source <a href="http://sypex.net/ru/products/dumper/about">Sypex Dumper</a> tool. </li><li>  <b>Autopilot for search engine scanning</b> - checks the site in Yandex and Google for blocking due to the harmfulness of the site, when blocking is detected, the user is notified to SANTI. </li><li><img src="https://habrastorage.org/getpro/habr/post_images/f49/ed8/874/f49ed8874474477288ab7322e5a8de5b.jpg" alt="Site checking with desktop antiviruses" align="right">  <b>Autopilot site checking for desktop antivirus</b> - regular checking the site for the detection of malicious inserts desktop antivirus, such as Kaspersky Antivirus, NOD, Avast, etc., more than 30 antivirus.  When malware is detected, a notification and report is provided on which files pose a threat and in the opinion of which of the antiviruses. </li><li>  <b>SANTI</b> - SANTI <b>autopilot protects</b> itself for interference with files and, if detected, removes itself and restores it to its original appearance. </li></ul><br><img src="https://habrastorage.org/getpro/habr/post_images/af9/227/470/af9227470738f3982ee0bc4c7da18fc7.png" alt="Autopilot site protection"><br><br>  <b>The SANTI ‚ÄúManual‚Äù section</b> allows you to use the tools to check and treat the site in real time, without waiting for the autopilot to trigger. <br><br>  <b>Utilities</b> - SANTI section, which includes a set of various tools to ensure the security of the site and help the Webmaster, this section is constantly updated with new tools.  Already implemented utilities: <br><ul><li>  <b>Password generator</b> is a classic that is often not at hand, and there is not enough imagination to generate a password that is resistant to cracking; </li><li>  <b>Date-file search</b> is a tool that more than once rescued when searching for malware after infecting a site, it allows you to specify the time interval for changing files, set a filter for which files we are looking for, or which ones we exclude.  The result of his work is a list of files changed / uploaded at a specified time interval; </li><li>  <b>Search and removal of malicious inserts</b> - a tool for searching inserts in files by start / end mask, supports two modes - search / delete inserts; </li><li>  <b>.ftpaccess configurator</b> - on hosting servers that use FTP servers based on ProFTPD, Pure-FTP, it is possible to control access via FTP by configuring the file .ftpaccess (IP restrictions, IP exceptions, etc.), this tool helps to generate the stuffing of this file; </li><li>  <b>Backup and recovery</b> - everything is clear, a tool to backup the site, or restore an earlier version of the site, allows you to set backup options, such as: exclusion formats, file sizes, backup path, archive name. </li><li>  <b>PHP info</b> is a funny utility, of course, but the frequency of its use among all utilities is maximum.  Displays information about the server. </li><li>  <b>News</b> - RSS reader of SANTI news and Internet security news, the latest are taken from the highly respected <a href="http://www.securitylab.ru/">SecurityLab</a> RSS feeds and with their permission! </li><li>  <b>File</b> editor - editor of files that were detected by a file scanner, date-search, and malicious inserts search.  Implemented on the basis of ACE Editor, works with different encodings, the definition of the file type and the corresponding syntax highlighting will appear in the new release, as well as the highlighting of the malicious code. </li><li>  <b>.htaccess site blocking</b> is one of your favorite tools, blocking a site during a site treatment or attack is organized by introducing the RewriteRule redirection rule into the .htaccess file on the site stub, a cap is also included in the SANTI kit, the SANTI folder is ignored so that you can disable the blocking and work with him. </li></ul><br><div style="text-align:center;"><img src="https://habrastorage.org/getpro/habr/post_images/ed8/5a6/5b1/ed85a65b1cb09bc130ab701a80f72c61.jpg" alt="SANTI Utilities"></div><br><br><h4>  What else is interesting and special? </h4><br>  When you first log in to SANTI, the user goes through the settings dialog, which I tried to ease with hints, validators and explanations.  In the dialog, all notification settings are configured, here you can register an account on the SMS gateway and enable this feature.  Upon completion of the settings, SANTI creates its image and a snapshot of the files for self-defense, a snapshot of the site files for the file autopilot, starts self-defense. <br><br>  The SANTI interface requires authorization, is protected from brute force by the restriction on the number of login attempts.  When entering the control panel, SANTI checks for a new version of the antivirus and, if necessary, notifies the user that a update is required.  At the start, the RSS feed of the new antivirus events is downloaded. <br><br>  If the SMS service is connected for notifications from autopilots, then the account balance is displayed in the interface. <br><br>  Under the hood: UI - CSS Bootstrap, adapted for tablets, PHP + JS. <br><br>  In order to facilitate and speed up the installation of the web antivirus, I decided to stop using MySQL, SQLite and stopped at an old library called <a href="http://lukeplant.me.uk/resources/flatfile/">PHP Flatfile package</a> , all data is stored in text files with TAB delimiters.  For the chosen approach it can be possible to kick in, but so far I have not been disappointed in the choice. <br><br>  SANTI has an online consultant, through which the user of the system can contact any security specialist from the web-antivirus community for advice. <br><br><h4>  What's next? </h4><br>  There are many plans and ideas for future releases: <br><ul><li>  The development of malware search by signatures is actively underway; </li><li>  Preparing the system for the possibility of free localization into other languages; </li><li>  Autopilot scans the search engines for new pages in the issue (the appearance of doorways); </li><li>  Autopilot detect changes in the site database; </li><li>  Detection of mobile traffic overflow; </li><li>  Add multi-type trap files for remote monitoring; </li><li>  There is a global refactoring and code optimization, because  the current version of the antivirus, it is more a prototype assembled from developments and research that have accumulated over the years; </li><li>  Tester hosting; </li><li>  Site security instructions and a smart helper when hacking a site; </li><li>  SQL injection interceptor; </li></ul><br>  The list can be continued for a long time and it will only expand in the future. <br><br>  For now.  I would very much like to find like-minded people in the field of security of websites, developers and welcome to the community in Habr√©. <br><br>  We welcome any feedback, waiting for your comments and suggestions.  Thank!  Soon we will be back with a new post. <br><br>  References: <br>  SANTI website - <a href="http://santivi.com/">http://santivi.com</a> <br>  Download SANTI - <a href="http://santivi.com/skachat">http://santivi.com/skachat/</a> <br>  Demo of the penultimate version of SANTI - <a href="http://demo.santivi.com/santi/">http://demo.santivi.com/santi/</a> <br>  Community and support - <a href="http://forum.santivi.com/">http://forum.santivi.com</a> </div><p>Source: <a href="https://habr.com/ru/post/202976/">https://habr.com/ru/post/202976/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../202966/index.html">Light and color: the basics of the basics</a></li>
<li><a href="../202968/index.html">DIY dimmer: a guide to the components</a></li>
<li><a href="../202970/index.html">Months search for a bug that was not. And in simple words about high frequency trading.</a></li>
<li><a href="../202972/index.html">Winamp death survey</a></li>
<li><a href="../202974/index.html">Arcade trash machine</a></li>
<li><a href="../202980/index.html">The story of one failure</a></li>
<li><a href="../202984/index.html">Being a middle manager is not a problem if you are ready for it.</a></li>
<li><a href="../202986/index.html">Interview with the founder of the company with an estimate of 2'000'000'000 $. Stepan Pachikov about his unsuccessful experience in the high-tech business: ‚ÄúDo not put money on your own business‚Äù</a></li>
<li><a href="../202988/index.html">Essay on "How to become a programmer?"</a></li>
<li><a href="../202990/index.html">Bitcasa cloud storage introduced API for developers</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>