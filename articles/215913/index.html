<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Flappy Bot for Flappy Bird</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Crazy game. What lad did not hear about Flappy Bird? About 50,000 dollars in revenue per day? The game is dedicated to financial reports, fun songs, y...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Flappy Bot for Flappy Bird</h1><div class="post__text post__text-html js-mediator-article"><img src="https://habrastorage.org/getpro/habr/post_images/4cd/34d/d71/4cd34dd71a8ca8b994ba6b571a51ee5b.jpg" alt="image"><br>  Crazy game.  What lad did not hear about Flappy Bird?  About 50,000 dollars in revenue per day?  The game is dedicated to financial reports, fun songs, yellow articles and research.  The Chinese guys even invented a <a href="https://www.youtube.com/watch%3Fv%3Dn_nGNvkrOlU">mechanical robot, chasing a bird</a> . <br>  Oh, and I installed the app on my favorite 2007 iPhone.  At my age, you look at the download slider and think. <i>But aren't</i> you downloading the <i>latest app in your life?</i> <br>  Yes.  I chased the bird for about 20 minutes. I could not get past the 10th tower.  Played another ten minutes.  Oh, the 22 towers are my ceiling.  Nerves to hell. <br>  And we decided with a friend Cyril to create our own ro-bot.  To score the Chinese tanks, as Ostap said. <br><br>  Read how it was and see what happened. <br>  Under the button three-kilobyte text and minute video. <br><a name="habracut"></a><br><br><h4>  Half franc coin </h4><br>  First of all, our robot is not mechanical.  Pressing the screen can be simulated not by a mechanical stick, but by an electric charge.  We stick a coin to the iPad screen.  To the coin we put a blue tape with a wire.  You feed a wire on a wire on the wire - the iPad is triggered by pressing.  In this place you have to say the clever words of the <i>capacitive screen</i> and it is important to shake your head. <br><img src="https://habrastorage.org/getpro/habr/post_images/3a4/b21/3e3/3a4b213e37211f08e43fdbfcd6dd65ff.jpg" alt="image"><br>  Of course, no photographer from me. 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      To control the current need an iPhone.  He shoots a video game running on an iPad, recognizes the point in time when he has to tap the game screen and sends a signal to a coin.  How?  By audio wire.  We generate a signal with a frequency of 20 kHz and a duration of 20 milliseconds.  You can play a wav file, and it is better to simulate a signal programmatically, or more accurately.  However, the delay from the beginning of the <i>PI-and-and-and-and-and-and</i> command until the simulated depression is 100-110 milliseconds.  Remember this number. <br><br>  Sample code?  God, this is more boring than ORT news, today without a code, ok? <br><br>  So the signal from the iPhone through the audio output runs to the capacitor, the capacitor is wired to our coin - voila, the circuit works. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/a58/c77/f34/a58c77f340fa2e8302f1e1ee592ec879.jpg" alt="image"><br><br>  Repeat our plan <br><br><ul><li>  On the iPad, we launch the game Flappy Bird. </li><li>  We stick a coin to the iPad screen </li><li>  Coin connects to capacitor </li><li>  Condenser connects to iPhone audio input </li><li>  On the iPhone, we write a program that, through a video camera, watches the game on the iPad and sends a beep-command. <i>Press, Maleshkin!</i> </li><li>  The capacitor sends a current to the coin, the coin simulates a click on the iPad </li><li>  The bird obediently jumps </li></ul><br><br>  According to the scheme, according to the specifications of semiconductors and other electro-technical knick-knacks, Kirill can answer.  But he will not answer, modest.  There are few knick-knacks on the board, sometimes they weakly beat them with an electric current if you want to touch them. <br><div class="spoiler">  <b class="spoiler_title">For those who fumble in electrical engineering</b> <div class="spoiler_text">  Of course, no this is not a capacitor. <br><br><img src="https://habrastorage.org/getpro/habr/post_images/f1a/430/c49/f1a430c497acf127043b2769c55415e5.jpg" alt="image"><br>  When an audio signal with a level&gt; = 1V pnp transistor opens and supplies a logical "1" to the input of the first inverter, causing a change in the polarity of the two-gate FET transistor. <br><br>  Opening the FET connects a coin ‚Äúin the air‚Äù to the ground, increasing the capacitance measured by the screen to the level it takes to be touched.  The capacity of the gate-drain channel in the closed state is 5pF.  The transistor is mounted directly on the coin to reduce the parasitic capacitance of the connecting wires. <br>  The attempts to connect the coin to the transistor with shielded cable that preceded this decision were unsuccessful. <br><br>  Not shown in the diagram: the board ground is connected to the tablet ground with an audio cable. <br></div></div><br><br><h4>  Xerox Box </h4><br>  The mini studio for the robot was made from used boxes.  The box was split, piled on its side, and a game iPad with a pre-glued coin was carefully laid on the bottom.  In the ceiling of the box, they made a hole for the iPhone video camera and put the phone on top, so that the camera could see the game screen of the underlying iPad.  Uh-f, be patient, soon the end. <br><br>  Under the iPad, I had to put the book <i>Bakhvalov's Numerical Modeling</i> so that the game screen completely filled the video frame. <br>  Everything. <br><br><h4>  Recognition of the playing field, birds and pillars </h4><br>  Here it is simple. <br>  To begin with, I made a screenshot of the game and in Photoshop I measured with a pipette the color intensity of the blue background, the red beak of the bird and the green, like a bottle of Absinthe, pillars. <br><br>  Since the corners of the field are almost straight, catching the black frame is not difficult.  Run the entire array of 1280 720 points of the video buffer is not necessary.  I let the diagonals from the four corners to find the first point of the game screen.  This is approximately 5,000 comparison operations for each angle.  Penny. <br><br>  Yes!  I completely forgot. <br><br>  What video mode to choose on our iPhone?  requires a good frequency. <br><br>  I tried Low-video mode.  192 by 144 pixels.  Frequency - 20 frames per second.  No good. <br>  Standard video capture 480 by 360 points.  Gives a frequency of 30 frames per second.  Better, but not enough. <br>  But the direct search of video modes finds 60 frames per second at a video resolution of 1280 by 720. The search method is taken from stackoverflow.com. <br><br>  P-paradoxically it turns out - the higher the resolution, the more often the frames.  What did you want from Steve Jobs?  He also did not present such surprises. <br><br><div class="spoiler">  <b class="spoiler_title">For those who fumbles in iOS</b> <div class="spoiler_text"><pre><code class="objectivec hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">@implementation</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ViewController</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AVCaptureDevice</span></span></span><span class="hljs-class"> *</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">cam</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">static</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">AVCaptureSession</span></span></span><span class="hljs-class"> *</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">sess</span></span></span><span class="hljs-class">; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">const</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">float</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">requiredFps</span></span></span><span class="hljs-class"> = 60.0</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">f</span></span></span><span class="hljs-class">; - (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">void</span></span></span><span class="hljs-class">)</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">viewDidLoad</span></span></span><span class="hljs-class"> </span></span>{ [<span class="hljs-keyword"><span class="hljs-keyword">super</span></span> viewDidLoad]; <span class="hljs-comment"><span class="hljs-comment">// Do any additional setup after loading the view, typically from a nib. sess = [AVCaptureSession new]; cam = [AVCaptureDevice defaultDeviceWithMediaType:AVMediaTypeVideo]; NSError *err = nil; AVCaptureDeviceInput *input = [[AVCaptureDeviceInput alloc] initWithDevice:cam error:&amp;err]; if (err) { NSLog(@"Failed to create AVCaptureDeviceInput: %@", err.description); } [sess addInput:input]; AVCaptureDeviceFormat *bestFmt = nil; int64_t bestDim = 0; CMTime tfps = CMTimeMake(10, 10 * requiredFps); for (AVCaptureDeviceFormat *fmt in cam.formats) { NSLog(@"Format: %@", fmt); for (AVFrameRateRange *fps in fmt.videoSupportedFrameRateRanges) { if (fps.maxFrameRate &gt;= requiredFps) { if (CMFormatDescriptionGetMediaSubType(fmt.formatDescription) == kCVPixelFormatType_420YpCbCr8BiPlanarFullRange) { CMVideoDimensions dimensions = CMVideoFormatDescriptionGetDimensions(fmt.formatDescription); int64_t sq = dimensions.height * dimensions.width; if (sq &gt; bestDim) { bestDim = sq; bestFmt = fmt; } } } } } if (bestFmt) { if ( [cam lockForConfiguration:&amp;err] ) { NSLog(@"Selected format: %@", bestFmt); cam.activeFormat = bestFmt; cam.activeVideoMaxFrameDuration = tfps; [cam unlockForConfiguration]; } else { NSLog(@"Failed to lock camera config: %@", err.description); } } else { NSLog(@"Failed to find a %f FPS format", requiredFps); } AVCaptureVideoDataOutput *output = [AVCaptureVideoDataOutput new]; [sess addOutput:output]; dispatch_queue_t queue; queue = dispatch_queue_create("cameraQueue", NULL); [output setSampleBufferDelegate:self queue:queue]; [output setVideoSettings:[NSDictionary dictionaryWithObject:[NSNumber numberWithInt:kCVPixelFormatType_32BGRA] forKey:(id)kCVPixelBufferPixelFormatTypeKey]]; [self.view bringSubviewToFront:cameraReal]; cameraReal.transform =CGAffineTransformMakeRotation(M_PI_2); // [sess startRunning]; turn on/off when view appear/disappear } - (void)viewWillDisappear:(BOOL)animated { [sess stopRunning]; [super viewWillDisappear:animated]; } - (void)viewWillAppear:(BOOL)animated { [sess startRunning]; [super viewWillAppear:animated]; }</span></span></code> </pre> <br></div></div><br><br>  I finish.  White crosses on the video marked the corners of the border of the playing field.  I calculate every time, although it is not necessary.  The bird is marked with a red cross, I am sure to calculate these parameters every measure.  Knowing the time, knowing the coordinates of the bird is easy to calculate its speed.  It is also easy to calculate the speed of the bird's jump after pressing and the acceleration of free fall.  2000 pixels per second per second, Vietnamese love round numbers)) <br><br>  Why know the speed?  Due to the delay of the pressing command of 110 milliseconds.  It is necessary to calculate the parabola of the movement of the bird to peep in advance. <br><br>  The algorithm is not yet perfect, since it was created during today's Friday. <br>  But our bird takes 100 pillars quite often.  Twice in the evening I was able to, gold, and not a bird. <br><br>  I think it is easy to bring this case to 1000 and calm down. <br><br>  Enjoy all. <br><br><iframe width="420" height="315" src="https://translate.googleusercontent.com/translate_c?depth=1&amp;rurl=translate.google.com&amp;sl=ru&amp;sp=nmt4&amp;tl=en&amp;u=https://www.youtube.com/embed/GCZ7EzafgQ4%3Ffeature%3Doembed&amp;xid=17259,15700019,15700186,15700191,15700253&amp;usg=ALkJrhiWXbE_pdZLduSe1iMPGsBixlc8iw" frameborder="0" allowfullscreen=""></iframe><br><br><h4>  Attention advertising </h4><br>  Of course, I wrote my clone of this game.  Nobody downloads the game, it is secret, but especially for you, dear readers, I give a link to the <a href="https://itunes.apple.com/ru/app/winter-jumping/id822259330%3Fmt%3D8">Winter Jumping</a> app. <br>  In honor of the birthday, it is free and without advertising. <br><br><h4>  thank </h4><br>  Thanks for attention. </div><p>Source: <a href="https://habr.com/ru/post/215913/">https://habr.com/ru/post/215913/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../215901/index.html">NASA: 715 new planets found, 4 of them may be suitable for life</a></li>
<li><a href="../215905/index.html">Signed Distance Field or how to make a vector out of raster</a></li>
<li><a href="../215907/index.html">Simple strategy game 2048</a></li>
<li><a href="../215909/index.html">The Chinese lunar rover ‚ÄúYuytu‚Äù successfully ‚Äúwoke up‚Äù after the third moon night</a></li>
<li><a href="../215911/index.html">Once again about dial gauges (and completely without MK)</a></li>
<li><a href="../215921/index.html">Chameleon virus spreads via WiFi networks as a common cold among people</a></li>
<li><a href="../215923/index.html">OpenCV participates in Google Summer of Code 2014</a></li>
<li><a href="../215925/index.html">"A pleasant-2", or what is behind the "Faces"</a></li>
<li><a href="../215927/index.html">Popcorn Time closed due to "the threat of legal persecution and backstage fraud"</a></li>
<li><a href="../215929/index.html">Holland approved operator-independent SIM cards</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>