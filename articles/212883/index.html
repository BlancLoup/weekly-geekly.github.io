<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Declarative event binding / handling</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="Hello! I want to show my piece of CoffeeScript for declarative subscription and event handling. 

 Prehistory 
 I have 5 years of engineering experien...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Declarative event binding / handling</h1><div class="post__text post__text-html js-mediator-article">  Hello!  I want to show my piece of CoffeeScript for declarative subscription and event handling. <br><br><h4>  Prehistory </h4><br>  I have 5 years of engineering experience that includes .NET (+ forms, + WPF, + .NET MVC), Java (+ Swing, + Tapestry5, + Groovy), JavaScript (+ CoffeeScript, + Node). <br><br>  Last year I actively write my own one-page web application that works without rebooting, (which will be discussed in future releases).  The entire dynamic part of the user interface is created on the client, only data comes from the server.  As often happens in UI, I am dealing with a component tree.  Of course, for organizing the interaction of the tree, I need a mechanism for sending and processing events.  I decided to write my own, and not to use Backbone, or something from Google Closure.  In any case, I had the experience of implementing the Etude Listener (Listener pattern). 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
      Class IspuscatorEvents of the first version If you wanted to listen to him - just wrote you down into an array of listeners.  When the event ‚ÄúCh‚Äù occurred, he went around the array, and searched for listeners with the ‚ÄúNAC‚Äù method, and called it.  Like in Swing / .NET. <br><br>  Everything worked fine for a small number of Heaters.  With the growth of the system came the problem of overlapping event names between different Spots.  The subscriber carried out the same method ‚Äúnch‚Äù, even if the ‚ÄúH‚Äù came from different Emitters.  Then it was more familiar to JS, EventEmitter, as in jQuery / NodeJS.  I will not particularly delay ... <br><br><a name="habracut"></a><br><h4>  SuperEmitter </h4><br>  Now I am working with a tabular view of the tree ‚Äúemitter -&gt; events -&gt; reactions‚Äù.  Example: <br><pre><code class="coffeescript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Brain</span></span></span><span class="hljs-class"> </span><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">extends</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">SuperEmitter</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">event_table</span></span></span><span class="hljs-class">: [ #    [ '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ear</span></span></span><span class="hljs-class">' , [ [ '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">snake_heard</span></span></span><span class="hljs-class">' , [ '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">emit_adrenaline</span></span></span><span class="hljs-class">' '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">look_around</span></span></span><span class="hljs-class">' ] ] ] ] [ '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">eye</span></span></span><span class="hljs-class">' , [ [ '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">food_spotted</span></span></span><span class="hljs-class">' , [ '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">emit_noradrenaline</span></span></span><span class="hljs-class">' '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">hunt</span></span></span><span class="hljs-class">' '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">emit_endorphins</span></span></span><span class="hljs-class">' ] ] [ '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">predator_spotted</span></span></span><span class="hljs-class">', [ '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">emit_cortisol</span></span></span><span class="hljs-class">' '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">emit_adrenaline</span></span></span><span class="hljs-class">' '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">run</span></span></span><span class="hljs-class">' ] ] ] ] [ '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">nose</span></span></span><span class="hljs-class">', [ [ '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">food_smelled</span></span></span><span class="hljs-class">' , [ '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">look_around</span></span></span><span class="hljs-class">' ] ] [ '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">blood_smelled</span></span></span><span class="hljs-class">' , [ '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">emit_adrenaline</span></span></span><span class="hljs-class">' '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">look_around</span></span></span><span class="hljs-class">' ] ] ] ] ] # </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">constructor</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">and</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">instance</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">members</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">constructor</span></span></span><span class="hljs-class"> = -&gt; @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ear</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Ear</span></span></span><span class="hljs-class">() @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">eye</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Eye</span></span></span><span class="hljs-class">() @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">nose</span></span></span><span class="hljs-class"> = </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Nose</span></span></span><span class="hljs-class">() # </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">methods</span></span></span><span class="hljs-class">: </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">emit_adrenaline</span></span></span><span class="hljs-class">: -&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">emit_cortisol</span></span></span><span class="hljs-class">: -&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">emit_endorphins</span></span></span><span class="hljs-class">: -&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">hunt</span></span></span><span class="hljs-class">: -&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">look_around</span></span></span><span class="hljs-class">: -&gt; </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">new</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Brain</span></span></span><span class="hljs-class">().</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bind_events</span></span></span><span class="hljs-class">()</span></span></code> </pre> <br>  Instead: <br><pre> <code class="coffeescript hljs"><span class="hljs-class"><span class="hljs-keyword"><span class="hljs-class"><span class="hljs-keyword">class</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">Brain</span></span></span><span class="hljs-class"> </span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">bind_events</span></span></span><span class="hljs-class">: -&gt; @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">ear</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">on</span></span></span><span class="hljs-class"> '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">snake_heard</span></span></span><span class="hljs-class">', (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">...) =&gt; #   @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">emit_adrenaline</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">...) #    @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">look_around</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">...) @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">eye</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">on</span></span></span><span class="hljs-class"> '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">food_spotted</span></span></span><span class="hljs-class">', (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">...) =&gt; @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">emit_noradrenaline</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">...) @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">hunt</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">...) @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">emit_endorphins</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">...) @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">eye</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">on</span></span></span><span class="hljs-class"> '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">predator_spotted</span></span></span><span class="hljs-class">', (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">...) =&gt; @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">emit_cortisol</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">...) @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">emit_adrenaline</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">...) @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">run</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">...) @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">nose</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">on</span></span></span><span class="hljs-class"> '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">food_smelled</span></span></span><span class="hljs-class">', (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">...) =&gt; @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">look_around</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">...) @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">nose</span></span></span><span class="hljs-class">.</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">on</span></span></span><span class="hljs-class"> '</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">blood_smelled</span></span></span><span class="hljs-class">', (</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">...) =&gt; @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">emit_adrenaline</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">...) @</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">look_around</span></span></span><span class="hljs-class">(</span><span class="hljs-title"><span class="hljs-class"><span class="hljs-title">args</span></span></span><span class="hljs-class">...) #  ..</span></span></code> </pre><br><br>  This is my <a href="https://github.com/ognivo/super-emitter">ognivo / super-emitter library</a> .  It allows you to remove the entire connective code, and focus on sources, events and reactions.  Code less, it is cleaner, more granular.  The format allows you to see where the sequence of answers comes from. <br>  Moreover, a table is data, and with it you can do everything you can do with data.  Compare, glue, clone, and so on. <br><br><h4>  Demo </h4><br>  <a href="http://ognivo.github.io/">Demo online</a> .  This is from the demo folder in the repo.  You can clone the repo, you can run <pre> <code class="hljs coffeescript"><span class="hljs-built_in"><span class="hljs-built_in">npm</span></span> install <span class="hljs-keyword"><span class="hljs-keyword">super</span></span>-emitter</code> </pre>  .  I want to make a larger demo, but so far with time. <br><br><h4>  Release and receive events </h4><br>  SuperEmitter is implemented as a class.  It has an emit method through which the event is fired and its arguments are passed.  Arguments must be packed into an array when called, which highlights them visually.  The function subscribed to the event takes arguments through the usual list of parameters. <br><br><pre> <code class="coffeescript hljs">brain = <span class="hljs-keyword"><span class="hljs-keyword">new</span></span> Brain() brain.bind_events() brain.emit(<span class="hljs-string"><span class="hljs-string">'adrenaline'</span></span>) brain.emit(<span class="hljs-string"><span class="hljs-string">'adrenaline'</span></span>, [dosage_ml = <span class="hljs-number"><span class="hljs-number">300</span></span>, noradrenaline = <span class="hljs-literal"><span class="hljs-literal">true</span></span>]) brain.<span class="hljs-literal"><span class="hljs-literal">on</span></span> <span class="hljs-string"><span class="hljs-string">'adrenaline'</span></span>, <span class="hljs-function"><span class="hljs-params"><span class="hljs-function"><span class="hljs-params">(dosage_ml, noradrenaline)</span></span></span><span class="hljs-function"> -&gt;</span></span> <span class="hljs-built_in"><span class="hljs-built_in">console</span></span>.log <span class="hljs-string"><span class="hljs-string">"I'm running from something"</span></span> <span class="hljs-comment"><span class="hljs-comment"># OR methods class Brain extends SuperEmitter emit_adrenaline: (dosage_ml = 10, noradrenaline = true) -&gt; @emit('adrenaline, [dosage_ml, noradrenaline]) receive_adrenaline: (dosage, noradrenaline) -&gt; if noradrenaline console.log "I will fight to death" else console.log "Let's get outta here"</span></span></code> </pre><br><br><h4>  Requirements </h4><br>  The instance to which you subscribe must have an ‚Äúon‚Äù method with a signature (is there a Russian word?) Event_name, callback.  Suitable jQuery wrappers, KineticJS shapes (shapes), instances of the class SuperEmitter. <br><br>  The standard method for DOM components addEventListener has the same signature, so nothing complicated with it either.  Once I had to subscribe to popstate from the window, respectively, everything was decided window.on = window.addEventListener. <br><br><h4>  What not </h4><br>  There is no ascent and interception of events.  I don‚Äôt see any reasons yet, I like that for each level of the component hierarchy I see all the events that go through it. <br><br>  I will be glad to criticism, praise and additions. <br>  ZY: I intentionally chose the word emitter, and not the source. </div><p>Source: <a href="https://habr.com/ru/post/212883/">https://habr.com/ru/post/212883/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../212873/index.html">Mobile application development. Why is this business?</a></li>
<li><a href="../212875/index.html">How we test advertising technologies of Yandex, and how to learn it</a></li>
<li><a href="../212877/index.html">We use WEBKit instead of IE in Visual Basic.net applications.</a></li>
<li><a href="../212879/index.html">x3650 M4 - do you need HD?</a></li>
<li><a href="../212881/index.html">Documentation Development with DocBook</a></li>
<li><a href="../212885/index.html">Problem 10 million connections</a></li>
<li><a href="../212887/index.html">Keep the roots (to the 80th anniversary of Nicklaus Wirth)</a></li>
<li><a href="../212889/index.html">Javascript: autocorrection timers</a></li>
<li><a href="../212891/index.html">Ubiquiti AirGrid M5 HP 27dBi - Expansion of a network bridge. Personal experience</a></li>
<li><a href="../212893/index.html">From bubble sorting to genetic algorithms</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>