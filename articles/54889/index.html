<!doctype html>
<html class="no-js" lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-134931760-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-134931760-1');
  </script>

  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>Building regexp on input lines S1..SN</title>
  <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  <meta name="description" content="That quite recently I ran into a problem, according to which I couldn‚Äôt dig, not that of any libraries, but even theories or algorithms. Because time ...">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="stylesheet" href="../../css/main.css">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="../../js/vendors/jquery-3.3.1.min.js"><\/script>')</script>

  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({
            google_ad_client: "ca-pub-6974184241884155",
            enable_page_level_ads: true
       });
  </script>
</head>

<body>
  <!--[if lte IE 9]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience and security.</p>
  <![endif]-->
  <header class="page-header js-page-header">
    <a class="page-header-logo-container" href="https://weekly-geekly.github.io/index.html"></a>
    <div class="page-header-text">Geekly Articles each Day</div>
  </header>
  <nav class="page-headings-container js-page-headings-container"></nav>
  <div class="tools-bar js-tools-bar">
    <!-- <a href="../../search.html" title="Search">üîé</a> -->
    <a class="js-list-of-headings-button" data-state="closed" href="#" title="Headings">üìú</a>
    <a class="js-go-to-top-button" href="#" title="Go to Top">‚¨ÜÔ∏è</a>
    <a class="js-go-to-bottom-button" href="#" title="Go to Bottom">‚¨áÔ∏è</a>
  </div>
  <a href="http://bit.ly/donateToWeeklyGeekly" class="donate-btn">DONATE</a>
  <section class="page js-page"><h1>Building regexp on input lines S1..SN</h1><div class="post__text post__text-html js-mediator-article">  That quite recently I ran into a problem, according to which I couldn‚Äôt dig, not that of any libraries, but even theories or algorithms.  Because  time was running out, he decided to deal with the task himself.  He wrote an article for those who will face a similar task in the future, and interesting criticism.  How would you solve this problem? <br><br><h4>  So, the task ... </h4><br>  At the input of the algorithm there is a set of strings S1..SN.  It is required, according to the given lines, to construct such a minimal regular expression R, so that R (Si) = true, i [1, N] (N is of the order of several thousand). <br>  <i>The requirement of minimality is not strict, and it is not required to prove the minimality of the constructed regexp.</i>  <i>If the lines S1..SN have some similar structure, then regexp should detect this structure.</i>  <i>The standard assignment to the programmer is moderately specified, but also with some discretion.</i> <br><a name="habracut"></a><br><h4>  Algorithm of the decision ... </h4><br><ol><li>  Find the smallest regular expression for the strings S1 and S2: <br><ul><li>  We add characters of the beginning and end of each line to each line, it turns out S1 = ^ S1 $ </li><li>  We are looking for the maximum common substring for S1 and S2.  Let this U be the maximum common substring for S1, S2.  (There are several well-known <a href="http://ru.wikipedia.org/wiki/%25D0%259D%25D0%25B0%25D0%25B8%25D0%25B1%25D0%25BE%25D0%25BB%25D1%258C%25D1%2588%25D0%25B0%25D1%258F_%25D0%25BE%25D0%25B1%25D1%2589%25D0%25B0%25D1%258F_%25D0%25BF%25D0%25BE%25D0%25B4%25D1%2581%25D1%2582%25D1%2580%25D0%25BE%25D0%25BA%25D0%25B0">algorithms for finding the maximum common substring</a> , and if you have the means, you can buy <a href="http://cbcsrv.watson.ibm.com/Tspd.html">IBM's Teiresias algorithm</a> ) </li><li>  So  it turns out that the substring U divides each of the lines S1 and S2 into 2 parts - left and right: <br> <code>S1: S1L || U || S1R <br> S2: S2L || U || S2R</code> <br>  where SiL and SiR are the left and right substrings of the strings S1 and S2. <br></li><li>  As can be seen, recursion with a binary tree suggests itself.  We put the string U in the root of the tree.  If both strings S1L and S2L are non-empty, then create a left descendant and run a comparison for them.  Similarly for right substrings. <br> <code>U <br> / \ <br> UL UR</code> <br> </li><li>  If at some stage the common substrings are not found (or it is short, 1-2 characters), then put the ". *" In the current node and exit the last recursive call.  This is a very rude expression, but it is suitable for my task.  At this step there is a lot of room for the optimization of the algorithm for your needs. <br></li><li>  After the tree is built, by symmetric traversal we get the desired regular expression SX for S1 and S2 (You may have to add the beginning and end of the expression again, because in some cases they turn into ". *") <br></li></ul><br></li><li>  Comparing the resulting SX string with S3 using the same algorithm, we get SX - a regular expression for the first 3 lines. <br></li><li>  By induction over all strings, we get R = SX the desired regular expression. <br></li></ol><br><br>  <b>UPD</b> <i>Example ...</i> <i><br></i>  <i>Let's take as an example links to some articles of habr:</i> 
      <br>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <ins class="adsbygoogle"
          style="display:block; text-align:center;"
          data-ad-layout="in-article"
          data-ad-format="fluid"
          data-ad-client="ca-pub-6974184241884155"
          data-ad-slot="8945601208"></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      <br>
     <code>S1=http://habrahabr.ru/blogs/edu_2_0/40236/ true <br> S2=http://habrahabr.ru/blogs/microsites/40089/ true <br> S3=http://habrahabr.ru/blogs/google_chrome/38748/ true <br> S4=http://habrahabr.ru/blogs/show/37839/ true <br> S5=http://nikolaikopernik.habrahabr.ru/blog/54889/ true <br> S6=http://habrahabr.ru/blogs/telecom/39902/ true <br> ----------------- <br> REGEXP = ^http://.*habrahabr.ru/blog.*/$ <br> SIZE : 6 <br> TIME : 0.0070 s</code> <br> <br>  <i>The example is made in Java.</i>  <i>I tested it on 6000 lines - I built regexp for 2 seconds.</i> <br><br>  <b>UPD</b> <i>Algorithm is implemented and works.</i>  <i>It builds sufficiently specified regular expressions on decent amounts of data for a reasonable time.</i>  <i>Criticize and use.</i> <br><br>  <b>UPD</b> <i>Let me explain why this may be necessary and why a simple union ^ (S1 | .. | SN) $ does not roll.</i>  <i>Imagine that the system works with a stream of lines F1, F2, F3, ... All the lines of similar structure (for example, urls).</i>  <i>Some lines are ‚Äúgood‚Äù, others are ‚Äúnot good‚Äù :) And checking for ‚Äúgoodness‚Äù is a very expensive operation.</i>  <i>So, from the general stream of lines after long checks, it was found out that the lines S1..SN are ‚Äúgood‚Äù lines.</i>  <i>In the system, the assumption is valid that if the line Fi has a similar structure with the lines S1..SN, then with a high degree of probability it will be ‚Äúgood‚Äù.</i>  <i>This is what regexp is built on based on N lines - so that only by the appearance of the line to determine its ‚Äúgoodness‚Äù :) I hope I didn‚Äôt be too smart with the description :)</i> </div><p>Source: <a href="https://habr.com/ru/post/54889/">https://habr.com/ru/post/54889/</a></p>
<section class="more-articles-navigation-panel js-more-articles-navigation-panel">
<h4>More articles:</h4>
<nav class="list-of-articles-container js-list-of-articles-container"><ul class="list-of-pages js-list-of-pages">
<li><a href="../54880/index.html">VSTO and CAB: Integrating .NET applications in Microsoft Word</a></li>
<li><a href="../54881/index.html">Project Idea Generator</a></li>
<li><a href="../54882/index.html">Do you model classes (UML) before you start developing? (PHP only please!)</a></li>
<li><a href="../54886/index.html">Publishing your own book: from A to Z</a></li>
<li><a href="../54887/index.html">DaisyDisk. chamomile with apple.</a></li>
<li><a href="../54893/index.html">Gnome 2.26 released</a></li>
<li><a href="../54894/index.html">Have you ever paid for web services?</a></li>
<li><a href="../54897/index.html">Sensors in the automotive industry, year 1982</a></li>
<li><a href="../54899/index.html">Habraotchet # 2 with MIX 09 from Las Vegas about what is happening in the corridors of the conference</a></li>
<li><a href="../54901/index.html">Stunning photographs of Earth and space with a camera for ¬£ 56</a></li>
</ul></nav>
</section><br />
<a href="../../allArticles.html"><strong>All Articles</strong></a>
<script src="../../js/main.js"></script>

<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
  (function (d, w, c) {
      (w[c] = w[c] || []).push(function() {
          try {
              w.yaCounter52496797 = new Ya.Metrika({
                  id:52496797,
                  clickmap:true,
                  trackLinks:true,
                  accurateTrackBounce:true,
                  webvisor:true
              });
          } catch(e) { }
      });

      var n = d.getElementsByTagName("script")[0],
          s = d.createElement("script"),
          f = function () { n.parentNode.insertBefore(s, n); };
      s.type = "text/javascript";
      s.async = true;
      s.src = "https://mc.yandex.ru/metrika/watch.js";

      if (w.opera == "[object Opera]") {
          d.addEventListener("DOMContentLoaded", f, false);
      } else { f(); }
  })(document, window, "yandex_metrika_callbacks");
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/52496797" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

<!-- Google Analytics -->
  <script>
    window.ga = function () { ga.q.push(arguments) }; ga.q = []; ga.l = +new Date;
    ga('create', 'UA-134931760-1', 'auto'); ga('send', 'pageview')
  </script>
  <script src="https://www.google-analytics.com/analytics.js" async defer></script>

</section>

  <footer class="page-footer">
    <div class="page-footer-legal-info-container page-footer-element">
      <p>
        Weekly-Geekly | <span class="page-footer-legal-info-year js-page-footer-legal-info-year">2019</span>
      </p>
    </div>
    <div class="page-footer-counters-container page-footer-element">
      <a class="page-footer-counter-clustrmap" href='#'  title='Visit tracker'><img src='https://clustrmaps.com/map_v2.png?cl=698e5a&w=271&t=t&d=6iCFw7uJz0zcOaoxz5k5PcLCJUzv2WG8G5V8M3U6Rc4&co=3a3a3a&ct=ffffff'/></a>
    </div>
  </footer>
</body>

</html>